<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pcbi.1010025.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9007392</article-id>
    <article-id pub-id-type="pmid">35363784</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010025</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-21-01867</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Connective Tissue Cells</subject>
                <subj-group>
                  <subject>Fibroblasts</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Biological Tissue</subject>
            <subj-group>
              <subject>Connective Tissue</subject>
              <subj-group>
                <subject>Connective Tissue Cells</subject>
                <subj-group>
                  <subject>Fibroblasts</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Biological Tissue</subject>
            <subj-group>
              <subject>Connective Tissue</subject>
              <subj-group>
                <subject>Connective Tissue Cells</subject>
                <subj-group>
                  <subject>Fibroblasts</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Glial Cells</subject>
                <subj-group>
                  <subject>Microglial Cells</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Data Visualization</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Brain</subject>
            <subj-group>
              <subject>Prefrontal Cortex</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Brain</subject>
            <subj-group>
              <subject>Prefrontal Cortex</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
              <subj-group>
                <subject>Clustering Algorithms</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
            <subj-group>
              <subject>Clustering Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cell Processes</subject>
            <subj-group>
              <subject>Cellular Stress Responses</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Marker Genes</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Marker Genes</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Non-linear archetypal analysis of single-cell RNA-seq data by deep autoencoders</article-title>
      <alt-title alt-title-type="running-head">Non-linear archetypal analysis of scRNA-seq data</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7389-1519</contrib-id>
        <name>
          <surname>Wang</surname>
          <given-names>Yuge</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1195-9607</contrib-id>
        <name>
          <surname>Zhao</surname>
          <given-names>Hongyu</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Biostatistics, Yale School of Public Health, New Haven, Connecticut, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Program of Computational Biology and Bioinformatics, Yale University, New Haven, Connecticut, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Department of Genetics, Yale School of Medicine, New Haven, Connecticut, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Li</surname>
          <given-names>Mingyao</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Pennsylvania, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>hongyu.zhao@yale.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <volume>18</volume>
    <issue>4</issue>
    <elocation-id>e1010025</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>10</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>3</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 Wang, Zhao</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Wang, Zhao</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1010025.pdf"/>
    <abstract>
      <p>Advances in single-cell RNA sequencing (scRNA-seq) have led to successes in discovering novel cell types and understanding cellular heterogeneity among complex cell populations through cluster analysis. However, cluster analysis is not able to reveal continuous spectrum of states and underlying gene expression programs (GEPs) shared across cell types. We introduce scAAnet, an autoencoder for single-cell non-linear archetypal analysis, to identify GEPs and infer the relative activity of each GEP across cells. We use a count distribution-based loss term to account for the sparsity and overdispersion of the raw count data and add an archetypal constraint to the loss function of scAAnet. We first show that scAAnet outperforms existing methods for archetypal analysis across different metrics through simulations. We then demonstrate the ability of scAAnet to extract biologically meaningful GEPs using publicly available scRNA-seq datasets including a pancreatic islet dataset, a lung idiopathic pulmonary fibrosis dataset and a prefrontal cortex dataset.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Single-cell RNA sequencing (scRNA-seq) techniques enable the profiling of gene expression at the single-cell level, and thus make it possible to uncover the cellular heterogeneity in a complex cell population which is composed of multiple cell types. Due to the complexity of biological system, different cell types may share underlying gene expression programs (GEPs) at different levels. However, such shared patterns are difficult to study by traditional cluster analysis. Based on the assumption that the expression profile of each cell results from a non-linear combination of multiple GEPs, we develop scAAnet, a deep learning model for non-linear archetypal decomposition of scRNA-seq data. We demonstrate that scAAnet is able to both achieve better decomposition performance in simulated data and identify biologically meaningful GEPs that are either cell-type-specific or disease-enriched in three real scRNA-seq datasets. To help interpret results from scAAnet, we also provide downstream analysis tools for the identification of program-specific marker genes. We expect scAAnet can be applied to explore GEPs shared across cells when scRNA-seq is used to study a complex disease or biological system.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004543</institution-id>
            <institution>China Scholarship Council</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7389-1519</contrib-id>
          <name>
            <surname>Wang</surname>
            <given-names>Yuge</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R56 AG074015</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1195-9607</contrib-id>
          <name>
            <surname>Zhao</surname>
            <given-names>Hongyu</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01 GM134005</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1195-9607</contrib-id>
          <name>
            <surname>Zhao</surname>
            <given-names>Hongyu</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>P50 CA196530</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1195-9607</contrib-id>
          <name>
            <surname>Zhao</surname>
            <given-names>Hongyu</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>Y.W. was supported by the Yale World Scholars Program (<ext-link xlink:href="https://medicine.yale.edu/bbs/training/initiatives/csc/" ext-link-type="uri">https://medicine.yale.edu/bbs/training/initiatives/csc/</ext-link>) sponsored by the China Scholarship Council. This research was supported in part by NIH R56 AG074015, R01 GM134005, and P50 CA196530 to H.Z. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="10"/>
      <table-count count="1"/>
      <page-count count="31"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2022-04-13</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The scRNA-seq datasets analyzed in this manuscript are all publicly available. The human pancreatic islet dataset was downloaded from the Gene Expression Omnibus (GEO) under accession code GSM2230757. The IPF lung data was downloaded from GEO under accession code GSE136831. The prefrontal cortex dataset was downloaded from Synapse (<ext-link xlink:href="https://www.synapse.org/#" ext-link-type="uri">https://www.synapse.org/#</ext-link>!Synapse:syn18485175). A Python implementation of scAAnet can be found on GitHub at <ext-link xlink:href="https://github.com/AprilYuge/scAAnet" ext-link-type="uri">https://github.com/AprilYuge/scAAnet</ext-link>. Implementation instructions, related tutorials, and analysis code for generating results in this paper are also available at the same GitHub page.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The scRNA-seq datasets analyzed in this manuscript are all publicly available. The human pancreatic islet dataset was downloaded from the Gene Expression Omnibus (GEO) under accession code GSM2230757. The IPF lung data was downloaded from GEO under accession code GSE136831. The prefrontal cortex dataset was downloaded from Synapse (<ext-link xlink:href="https://www.synapse.org/#" ext-link-type="uri">https://www.synapse.org/#</ext-link>!Synapse:syn18485175). A Python implementation of scAAnet can be found on GitHub at <ext-link xlink:href="https://github.com/AprilYuge/scAAnet" ext-link-type="uri">https://github.com/AprilYuge/scAAnet</ext-link>. Implementation instructions, related tutorials, and analysis code for generating results in this paper are also available at the same GitHub page.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic toggle="yes">PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Single-cell RNA sequencing (scRNA-seq) has enabled the profiling of RNA expression in tens of thousands of individual cells and is now regarded as the gold standard for defining cell states in a mixed cell population [<xref rid="pcbi.1010025.ref001" ref-type="bibr">1</xref>]. The identification of cell states is usually realized by cluster analysis, where cells from a given scRNA-seq dataset are grouped into clusters based on the cell-cell similarity in expression profiles. Many downstream analyses including differential gene expression, gene co-expression network, and pathway enrichment can be performed based on these identified cell clusters. Cluster analysis only assigns each cell to a specific cluster and implicitly assumes that cells from the same cluster are homogeneous and their expression profiles are randomly distributed around a mean expression level. However, recent studies [<xref rid="pcbi.1010025.ref002" ref-type="bibr">2</xref>,<xref rid="pcbi.1010025.ref003" ref-type="bibr">3</xref>] have suggested that some cell populations are better described as a continuous spectrum of states rather than discreate cell clusters, but cluster analysis cannot capture continuous changes of cell states among cell populations and possible sharing of GEPs between different cell clusters.</p>
    <p>Archetypal analysis [<xref rid="pcbi.1010025.ref004" ref-type="bibr">4</xref>], a type of unsupervised learning method (mathematical details about archetypal analysis can be found in <xref rid="pcbi.1010025.s054" ref-type="supplementary-material">S1 Text</xref>), can be utilized to study the expression profile as a mixture of GEPs and to properly identify those GEPs. Unlike cluster analysis which groups observations into distinct clusters, archetypal analysis finds some extremal points (archetypes) in the multidimensional data. By performing archetypal analysis, a given dataset is assumed to be a superposition of various populations or mechanisms and each observation is represented as a convex combination of archetypes. In the context of scRNA-seq, this is equivalent to decomposing each cell’s expression profile into a convex combination of GEPs. Decomposition through archetypal analysis can help us understand the organization of cells, uncover heterogeneity, and study the functional identities within cell populations. All the downstream analyses can be performed based on GEPs similar to those performed on distinct cell clusters. For example, we can identify top genes with high expression levels in each GEP or differentially expressed genes (DEGs) among GEPs. Furthermore, if we have pre-labeled clinically meaningful cell types or disease groups, we can study how the relative activity of GEPs differs among those biological states and identify interesting GEPs relevant to a specific cell type or disease.</p>
    <p>The traditional archetypal analysis is linear and can be solved by an alternating constrained least squares algorithm [<xref rid="pcbi.1010025.ref004" ref-type="bibr">4</xref>]. Since archetypes are ‘pure’ types in the observed data, their values should be non-negative in the context of scRNA-seq data because the expression levels are non-negative. Linear archetypal analysis decomposes an observed expression profile matrix into the multiplication of two low-rank and non-negative matrices. One matrix is a GEP matrix, representing the bases of a low-dimensional space. The other matrix is a usage matrix, storing the linear coefficients of the bases and representing how much each GEP is used across cells. The main limitation of this procedure results from the assumption that signals can be linearly reconstructed. However, genes work coordinately with each other in a complex way and an observed expression profile is more likely generated non-linearly from the combination of GEPs. Therefore, linear archetypal analysis may not uncover the underlying GEPs and reveal the heterogeneity of the usage of those GEPs within cell populations.</p>
    <p>Non-linear archetypal analysis methods have been proposed based on kernelization, such as kernel principal convex hull analysis [<xref rid="pcbi.1010025.ref005" ref-type="bibr">5</xref>]. However, there is no guarantee that kernel-based transformation makes data well-approximated by a simplex. A relatively new framework for non-linear archetypal analysis borrows ideas from the field of deep learning. Theoretically, neural networks can closely approximate any linear or non-linear functions [<xref rid="pcbi.1010025.ref006" ref-type="bibr">6</xref>,<xref rid="pcbi.1010025.ref007" ref-type="bibr">7</xref>] which makes deep learning-based approaches advantageous over kernelization-based methods. Specifically, we consider using an autoencoder [<xref rid="pcbi.1010025.ref008" ref-type="bibr">8</xref>], an artificial neural network for unsupervised learning, to perform non-linear archetypal analysis on scRNA-seq data. On the one hand, autoencoders have been utilized to perform non-linear archetypal analysis on images in computer science, such as AAnet [<xref rid="pcbi.1010025.ref009" ref-type="bibr">9</xref>] and DeepAA [<xref rid="pcbi.1010025.ref010" ref-type="bibr">10</xref>]. On the other hand, autoencoder-based models including scVI [<xref rid="pcbi.1010025.ref011" ref-type="bibr">11</xref>] and DCA [<xref rid="pcbi.1010025.ref012" ref-type="bibr">12</xref>] have been applied to process scRNA-seq data and have gained success in tasks including batch effect removal, denoising, dimensionality reduction, and differential expression analysis. However, the existing methods either are not designed specifically for analyzing scRNA-seq data or do not constrain the distance between archetypes and observed data in the latent space, which is one of the assumptions of archetypal analysis.</p>
    <p>To take into consideration both the non-linearity and the count structure in scRNA-seq data, we design a new autoencoder-based method to perform non-linear archetypal analysis called scAAnet. Moreover, we provide a regression-based method to perform DEG test among identified GEPs using results from scAAnet. We will introduce the structure of scAAnet and evaluate its performance against competing methods using simulated datasets. We will also illustrate the ability of scAAnet to identify and interpret GEPs in real scRNA-seq data by applying it to a pancreatic islet dataset [<xref rid="pcbi.1010025.ref013" ref-type="bibr">13</xref>], a lung idiopathic pulmonary fibrosis (IPF) dataset [<xref rid="pcbi.1010025.ref014" ref-type="bibr">14</xref>], and a prefrontal cortex dataset composed of patients with varying degree of Alzheimer’s disease (AD) pathology [<xref rid="pcbi.1010025.ref015" ref-type="bibr">15</xref>].</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>Overview of scAAnet</title>
      <p>Autoencoders can be used for non-linear decomposition of a dataset. Here, we introduce how scAAnet is designed based on an autoencoder to perform non-linear archetypal analysis of count scRNA-seq data (<xref rid="pcbi.1010025.g001" ref-type="fig">Fig 1</xref>). The structure of scAAnet is mainly composed of two parts, an encoder part and a decoder part. The role of the encoder part is to perform a non-linear decomposition of the data by mapping data from a high-dimensional space to a much lower-dimensional space (latent space). The role of the decoder part is to non-linearly reconstruct the data in the original feature space.</p>
      <fig position="float" id="pcbi.1010025.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010025.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Structure of scAAnet for non-linear archetypal analysis with a ZINB reconstruction loss.</title>
          <p>NLL: Negative log-likelihood.</p>
        </caption>
        <graphic xlink:href="pcbi.1010025.g001" position="float"/>
      </fig>
      <p>The output of the encoder side, matrix <italic toggle="yes">A</italic>, is a latent representation of the data and each row represents a cell usage vector. Therefore, matrix <italic toggle="yes">A</italic> should be non-negative with row sum being 1. This constraint can be easily achieved by applying Softmax transformation on the output of the encoder. The other challenge is to make inferred archetypes tight to the data in the latent space. We solve this by setting the positions of archetypes (<italic toggle="yes">Z</italic><sup><italic toggle="yes">fix</italic></sup>) in the latent space and penalize the distance between the preset archetypes and inferred archetypes in the latent space. A similar idea was used in DeepAA [<xref rid="pcbi.1010025.ref010" ref-type="bibr">10</xref>]. Basically, archetypes are set so that the centroid of the simplex formed by these archetypes is the origin in the latent space and the distances between any two adjacent archetypes are the same. Moreover, we make the encoder not only output the coefficient matrix <italic toggle="yes">A</italic> but also another coefficient matrix <italic toggle="yes">B</italic><sup><italic toggle="yes">T</italic></sup> and we add an archetypal loss to make sure the archetypes are as close to the convex hull of data as possible in the latent space (Methods and <xref rid="pcbi.1010025.s054" ref-type="supplementary-material">S1 Text</xref> section 1).</p>
      <p>Usually, mean squared error (MSE) is used as the reconstruction loss for data decomposition methods like archetypal analysis and the underlying assumption is that data values are normally distributed. However, this is not the case for scRNA-seq data which are count data with a large proportion of zeros. To account for the count structure and overdispersion of scRNA-seq, we use a zero-inflated negative binomial (ZINB) distribution to model the observed expression data so that the corresponding reconstruction error is given based on the negative log-likelihood (Methods). What is shown in <xref rid="pcbi.1010025.g001" ref-type="fig">Fig 1</xref> is the case for ZINB distributions which have three parameter sets: scaled mean <italic toggle="yes">μ</italic>, dropout probability <italic toggle="yes">π</italic>, and dispersion <italic toggle="yes">θ</italic>. Apart from ZINB, we also provide users with three other distribution choices including Poisson, zero-inflated Poisson (ZIP), and negative binomial (NB). The parameters for these four distributions are shown in <xref rid="pcbi.1010025.t001" ref-type="table">Table 1</xref>.</p>
      <table-wrap position="float" id="pcbi.1010025.t001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010025.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Parameters for different distributions.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1010025.t001" id="pcbi.1010025.t001g" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Distribution</th>
                <th align="center" rowspan="1" colspan="1">Parameters</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Poisson</td>
                <td align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">μ</italic>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ZIP</td>
                <td align="center" rowspan="1" colspan="1"><italic toggle="yes">μ</italic>,<italic toggle="yes">π</italic></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">NB</td>
                <td align="center" rowspan="1" colspan="1"><italic toggle="yes">μ</italic>,<italic toggle="yes">θ</italic></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ZINB</td>
                <td align="center" rowspan="1" colspan="1"><italic toggle="yes">μ</italic>,<italic toggle="yes">θ</italic>,<italic toggle="yes">π</italic></td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>The total loss of scAAnet is composed of both the archetypal loss and the reconstruction loss and one can change the relative weight of the two losses. Through simulation studies we found that the performance of scAAnet was robust to the change of the weight around 1, so we set the relative weight of the archetypal loss as 1 by default (see <xref rid="pcbi.1010025.s054" ref-type="supplementary-material">S1 Text</xref> section 2 for more discussion).</p>
      <p>There are two matrices we are interested in when applying scAAnet to scRNA-seq data. The first matrix is a usage matrix which contains the coefficients of the archetypal decomposition of all cells. This matrix is the <italic toggle="yes">A</italic> matrix generated by the encoder. The second one is a GEP (archetype) matrix with each row corresponding to a GEP in the feature space. Values in a GEP vector represent the relative gene expression levels in that GEP. This matrix can be obtained by feeding decoder 1 with <italic toggle="yes">I</italic><sub><italic toggle="yes">K</italic></sub><italic toggle="yes">Z</italic><sup><italic toggle="yes">fix</italic></sup> where <italic toggle="yes">I</italic><sub><italic toggle="yes">K</italic></sub> is a K-dimensional identity matrix.</p>
    </sec>
    <sec id="sec004">
      <title>Simulation study</title>
      <p>We simulated synthetic scRNA-seq data under the framework of Splatter [<xref rid="pcbi.1010025.ref016" ref-type="bibr">16</xref>] using four archetypes, and ran scAAnet and four competing methods including non-negative matrix factorization (NMF) [<xref rid="pcbi.1010025.ref017" ref-type="bibr">17</xref>], scVI [<xref rid="pcbi.1010025.ref011" ref-type="bibr">11</xref>], LDVAE [<xref rid="pcbi.1010025.ref018" ref-type="bibr">18</xref>] and AAnet [<xref rid="pcbi.1010025.ref009" ref-type="bibr">9</xref>] to infer both GEPs and cell usage vectors. Here, NMF was used to perform linear archetypal analysis. LDVAE is a linearly decoded version of scVI. Details for competing methods are provided in the Methods. We implemented scAAnet with all the four choices of distribution-based reconstruction loss terms. We used one hidden layer with 128 neurons for each encoder and decoder. The batch size was 64 and 200 epochs were run with early stopping if the training did not improve for 100 epochs. We used <italic toggle="yes">K</italic> = 4 to train scAAnet on simulated data. Note that in real data, it would be impossible for us to know the true number of archetypes and we propose to select <italic toggle="yes">K</italic> based on the stability of both inferred usage and GEP matrices (Methods). As shown in <xref rid="pcbi.1010025.s001" ref-type="supplementary-material">S1 Fig</xref>, we were able to select <italic toggle="yes">K</italic> = 4 for simulated data after considering model stability in general. We also explored the robustness of scAAnet to misspecified <italic toggle="yes">K</italic> in <xref rid="pcbi.1010025.s054" ref-type="supplementary-material">S1 Text</xref> section 3. We used MSE to quantify the accuracy of cell usage inference and reconstruction errors, where reconstruction errors were calculated between the inferred scaled mean and the true scaled mean expression levels. The accuracy of GEP inference was measured by the Pearson correlation between inferred GEP vectors and the truth. Benchmarking results from datasets that were simulated under NB and ZINB distributions are shown in Figs <xref rid="pcbi.1010025.g002" ref-type="fig">2</xref> and <xref rid="pcbi.1010025.s001" ref-type="supplementary-material">S1</xref>, where <italic toggle="yes">λ</italic> is a parameter used in the simulation process to introduce dropout (Methods). The accuracy of inferred cell usages was higher for scAAnet with count distribution-based error terms, especially when ZINB distributions were used. The worst performance was observed for scAAnet with MSE loss which suggests that MSE is not a good choice for measuring the reconstruction error of count scRNA-seq data. Figures in the second column further show that scAAnet achieves the best performance on the inference of GEPs regardless of distribution used to calculate the error term in the loss function. In <xref rid="pcbi.1010025.s026" ref-type="supplementary-material">S26A Fig</xref>, we also observed close resemblance between inferred GEP and true GEP by plotting heatmaps of normalized gene scores using the top 20 DEGs in each GEP. Moreover, we observed better performance of scAAnet relative to the other methods consistently across different signal-to-noise ratio levels. Furthermore, almost all methods had a very low reconstruction MSE with the exception of LDVAE, which had the largest reconstruction errors (last column in <xref rid="pcbi.1010025.g002" ref-type="fig">Fig 2</xref> and <xref rid="pcbi.1010025.s001" ref-type="supplementary-material">S1 Fig</xref>). When the dropout proportion became higher in the datasets that followed ZINB distributions, similar trend was consistently observed (<xref rid="pcbi.1010025.s002" ref-type="supplementary-material">S2 Fig</xref>).</p>
      <fig position="float" id="pcbi.1010025.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010025.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Performance of scAAnet and other methods on simulated scRNA-seq datasets.</title>
          <p>(a) Results from datasets that were simulated under NB distributions. Figures from left to right are MSE between inferred cell usages and true usages of the 4 GEPs, Pearson correlation between inferred GEPs and true GEPs, and MSE between reconstructed scaled means and true means. (b) Similar results from datasets that were simulated under the ZINB distribution (<italic toggle="yes">λ</italic> = 0.3). Error bars around the means were drawn with 95% confidence interval. D.E.: differential expression.</p>
        </caption>
        <graphic xlink:href="pcbi.1010025.g002" position="float"/>
      </fig>
      <p>To show that the existing models for non-linear archetypal analysis, including scVI, LDVAE and AAnet, do not guarantee that the inferred archetypes are tight to the observed data points, we visualized archetypal space of each method including scAAnet by a fast-interpolation-based multidimensional scaling (MDS) (Figs <xref rid="pcbi.1010025.g003" ref-type="fig">3</xref> and <xref rid="pcbi.1010025.s003" ref-type="supplementary-material">S3</xref>). Briefly, MDS is performed on archetypes in the original space and then the coordinates of each data point are derived from linear interpolation among coordinates of the archetypes in a low-dimensional MDS space using the coefficients of archetypes learned by each method. Among the four models, the inferred archetypes from scAAnet were the tightest to the data points in the archetypal space, where the four archetypes were tightly located at the corners of the data points. However, for the other three models, there was much space between archetypes and data points, especially for AAnet. This indicates that these models do not satisfy the assumption of archetypal analysis that archetypes are extrema in the data space and should resemble the observed data points. Moreover, we can see that for scVI, although the four inferred archetypes were not very far from the data, the inferred usage of GEP 2 and GEP 4 (as shown by the color of true cell usage) did not correspond to any of the four underlying GEPs.</p>
      <fig position="float" id="pcbi.1010025.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010025.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>MDS interpolation visualization of archetypal space.</title>
          <p>(a) MDS visualization of archetypal space recovered from LDVAE. (b) MDS visualization of archetypal space recovered from scVI. (c) MDS visualization of archetypal space recovered from AAnet. (d) MDS visualization of archetypal space recovered from scAAnet using ZINB loss. Red dots are the locations of the inferred archetypes. Figures in each column are colored by the true cell usage of the corresponding archetype (GEP). Similar results of scAAnet using other distribution-based loss terms can be found in <xref rid="pcbi.1010025.s002" ref-type="supplementary-material">S2 Fig</xref>.</p>
        </caption>
        <graphic xlink:href="pcbi.1010025.g003" position="float"/>
      </fig>
      <p>These figures help explain why scVI, LDVAE, and AAnet had relatively good reconstruction but poor decomposition performance. A common goal of these three models is to find a convex hull of a dataset in a transformed low-dimensional space, but there could be multiple convex hulls as long as the data points are included inside the convex hull. Although scVI, LDVAE, and AAnet were designed to find such a convex hull, none of them guarantees that the found convex hull is the closest one to the data. In other words, a good convex hull should be formed by archetypes located near corners of a dataset. Our proposed scAAnet model realizes this by using the archetypal constraint to penalize the distance between archetypes and data points in the latent space.</p>
      <p>After getting the decomposition results from scAAnet, an interesting question to ask is to identify GEP-specific marker genes which are upregulated in a GEP compared to others. Since archetypal analysis is unlike cluster analysis where cells are assigned to unique cell clusters, we cannot do two-sample-based tests (e.g., two-sample t test and Wilcoxon rank-sum test) as we do for identifying DEGs among cell clusters. Although we can naively assign each cell to the GEP on which it has the largest usage, it may cause loss of information as the expression profile of each cell can be a mixture of multiple GEPs. Thus, we designed a DEG test accompanying archetypal analysis results from scAAnet based on marginal negative binomial regressions (Methods). Briefly, we use cell usage for each GEP as a continuous variable in the regression model and make the count expression data for each gene as an outcome variable. To show the superiority of using the continuous usage variable to infer GEP-specific DEGs over using the discrete group assignment, we compared the performance of our negative binomial regression model with different predictors using simulated scRNA-seq data.</p>
      <p>The median of the area under the curve (AUC) values was consistently higher when we used usage instead of discrete group assignment over different signal-to-noise ratio levels and different distributions (<xref rid="pcbi.1010025.g004" ref-type="fig">Fig 4</xref>). As expected, both methods achieved higher AUC values as the signal-to-noise ratio increased because it is easier to identify DEGs when the true mean differential expression fold change was larger. Since adjusted statistical significance level of 0.05 is commonly used as a cutoff to select significant DEGs, we specifically calculated true positive rates (TPRs) and false positive rates (FPRs) for both methods using this cutoff (<xref rid="pcbi.1010025.s004" ref-type="supplementary-material">S4 Fig</xref>). Using continuous usage variable resulted in both higher true positive rates and higher false positive rates. This suggests that our model achieved higher sensitivity but relatively lower specificity and our model is less conservative compared to the model using group assignment.</p>
      <fig position="float" id="pcbi.1010025.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010025.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Comparisons of DEG identifications between using continuous usages and discrete group assignment.</title>
          <p>(a) ROC AUC results for datasets simulated under NB distributions. (b) Results for datasets simulated under ZINB distributions with <italic toggle="yes">λ</italic> = 0.3. (c) Results for datasets simulated under ZINB distributions with <italic toggle="yes">λ</italic> = 0.1. (d) Results for datasets simulated under ZINB distributions with <italic toggle="yes">λ</italic> = 0.0. The values of ROC AUC were calculated across different signal-to-noise ratio levels. Each box and whisker plot was plotted based on ten simulated datasets. Central lines represent medians, boxes represent the interquartile range (IQR), and the upper/lower whisker represents the largest/smallest value no further than 1.5 × IQR. ROC: receiver operating characteristic; AUC: area under curve.</p>
        </caption>
        <graphic xlink:href="pcbi.1010025.g004" position="float"/>
      </fig>
      <p>We explored the potential of scAAnet on data simulated purely from one GEP in <xref rid="pcbi.1010025.s054" ref-type="supplementary-material">S1 Text</xref> section 4 and on developmental data simulated under linear and bifurcating trajectories in <xref rid="pcbi.1010025.s054" ref-type="supplementary-material">S1 Text</xref> section 5.</p>
    </sec>
    <sec id="sec005">
      <title>Application of scAAnet to a pancreatic islet dataset</title>
      <p>Although scAAnet was designed to identify GEPs in heterogenous cell populations without categorically delimited cell state boundaries, we still anticipate that scAAnet is able to capture such discrete cell population structures. We applied scAAnet to a pancreatic islet dataset [<xref rid="pcbi.1010025.ref013" ref-type="bibr">13</xref>] in which 10 distinct cell clusters were well-defined (<xref rid="pcbi.1010025.g005" ref-type="fig">Fig 5A</xref>). The number of archetypes and the choice of distribution used for computing the reconstruction error were determined by model stability (Methods and <xref rid="pcbi.1010025.s005" ref-type="supplementary-material">S5 Fig</xref>). We used outputs from scAAnet with K = 10 and ZINB-based error term as the results of the pancreatic islet dataset. As shown in the two-dimensional MDS plots based on results from scAAnet (<xref rid="pcbi.1010025.s006" ref-type="supplementary-material">S6 Fig</xref>), the inferred archetypes were tight to the data in the archetypal space. Since scAAnet belongs to a broader category of decomposition methods, instead of conducting principal component analysis (PCA) and using top PCs to perform Uniform Manifold Approximation and Projection (UMAP), we can use the decomposed usage matrix as a low-dimensional representation of the observed expression profile. The UMAP generated from using the usage matrix (<xref rid="pcbi.1010025.g005" ref-type="fig">Fig 5A</xref> middle) preserved the known cell clusters. Furthermore, we can see similar structure of cell clusters in the UMAP generated from the reconstructed expression profile (<xref rid="pcbi.1010025.g005" ref-type="fig">Fig 5A</xref> right). We also applied NMF to this dataset using K = 10 for comparison. However, results were not satisfactory (see <xref rid="pcbi.1010025.s054" ref-type="supplementary-material">S1 Text</xref> section 6 for more discussion). Based on inferred cell usage, most of the 10 GEPs had one-to-one correspondence with annotated cell clusters (<xref rid="pcbi.1010025.g005" ref-type="fig">Fig 5B–5D</xref>). For epsilon cells, the rarest cell type (13 cells) in this dataset, there did not exist any inferred GEPs that uniquely corresponded to them. However, signals from both GEP 3 and GEP 5 were detected in epsilon cells (<xref rid="pcbi.1010025.g005" ref-type="fig">Fig 5D</xref>), indicating the similarity between epsilon cells and gamma cells as well as delta cells, respectively. Note that these cell types are all endocrine cell types in pancreas.</p>
      <fig position="float" id="pcbi.1010025.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010025.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>scAAnet identified archetypes with correspondence to known cell types in the pancreatic islet dataset.</title>
          <p>(a) The UMAP visualization using the top 35 PCs of the observed scRNA-seq data (left), using the inferred cell usage matrix from the encoder (middle), and using the reconstructed expression profile from the output layer of scAAnet (right). UMAPs are colored by 10 known cell clusters. The average Silhouette scores for the three UMAPs are 0.604, 0.398 and 0.613, respectively. Black dots are locations of cells that have the largest usage of the corresponding GEP (marked in Arabic numerals). (b) UMAPs from the observed data colored by inferred cell usage for each GEP. (c) Heatmap showing the usage of all GEPs (rows) in all cells (columns). Cells are ordered by hierarchical clustering. (d) Heatmap showing the percentage of cells with usage &gt; 25% of each GEP (rows) in each cell type (columns). Colors in c and d are coded in the same way as those in a. (e) Normalized gene scores (Methods) of known markers (columns) in each GEP (rows). (f) Mean z-scores of known markers (columns) in each cell cluster (rows).</p>
        </caption>
        <graphic xlink:href="pcbi.1010025.g005" position="float"/>
      </fig>
      <p>As the correspondence between GEPs and cell clusters was established based on cell usage, we further looked into the inferred GEP matrix to see if known marker genes had higher gene scores in the corresponding GEP. Marker genes were selected based on published papers and were validated in this dataset (<xref rid="pcbi.1010025.g005" ref-type="fig">Fig 5F</xref>). For example, GCG, INS, PPY, and SST are endocrine markers that are highly expressed in alpha, beta, gamma, and delta cells, respectively [<xref rid="pcbi.1010025.ref019" ref-type="bibr">19</xref>,<xref rid="pcbi.1010025.ref020" ref-type="bibr">20</xref>]. KRT19 and CPA1 are exocrine markers that are expressed in ductal and acinar cells, respectively [<xref rid="pcbi.1010025.ref021" ref-type="bibr">21</xref>]. While PDGFRB is a marker of stellate cells [<xref rid="pcbi.1010025.ref022" ref-type="bibr">22</xref>] and VWF a marker of endothelial cells [<xref rid="pcbi.1010025.ref023" ref-type="bibr">23</xref>]. The normalized gene score of each selected marker gene was high in the GEP that had correspondence with the cell type that it was linked to (<xref rid="pcbi.1010025.g005" ref-type="fig">Fig 5E</xref>), confirming the consistency between annotated cell clusters and inferred GEPs. We also identified top genes for each GEP by fitting a Gamma distribution to the normalized gene scores (Methods). The top genes for each GEP are listed in <xref rid="pcbi.1010025.s027" ref-type="supplementary-material">S1 Table</xref> and the prementioned marker genes all showed up in the top gene list of the corresponding cell types.</p>
      <p>Among all the cell types, the population of beta cells was the only one that was mapped onto more than one GEP, including GEP 2 and GEP 7 (<xref rid="pcbi.1010025.g005" ref-type="fig">Fig 5B–5D</xref>). To uncover the biological characteristics of the two GEPs, we performed DEG tests on beta cells for GEP 2 and GEP 7 separately. We identified 26 and 84 significantly upregulated genes specific to GEP 2 (<xref rid="pcbi.1010025.s028" ref-type="supplementary-material">S2 Table</xref>) and GEP 7 (<xref rid="pcbi.1010025.s029" ref-type="supplementary-material">S3 Table</xref>), respectively (Bonferroni adjusted p-value &lt; 0.05). The top 20 upregulated DEGs (normalized gene scores in <xref rid="pcbi.1010025.s026" ref-type="supplementary-material">S26B Fig</xref>) with the smallest adjusted p-values are plotted in <xref rid="pcbi.1010025.g006" ref-type="fig">Fig 6B and 6D</xref> in which cells are ordered by the inferred cell usage. The expression pattern of those identified DEGs covaried with the inferred cell usage. For GEP 2, we found that several genes among the top 20 upregulated DEGs are functional beta genes (e.g., IAPP, CHGA, MAFA, and ABCC8). For GEP 7, some identified top genes are related to endoplasmic reticulum (ER) stress, including HERPUD1, HSPA5, DDIT3, and PPP1R15A [<xref rid="pcbi.1010025.ref024" ref-type="bibr">24</xref>].</p>
      <fig position="float" id="pcbi.1010025.g006">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010025.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Enriched GO terms and top DEGs of GEP 2 and GEP 7 in the pancreatic islet dataset.</title>
          <p>(a) The top 10 enriched GO biological process terms using 26 significantly upregulated genes of GEP 2. (b) The expression levels of the top 20 DEGs of GEP 2 with the largest z-scores from the DEG test covaried with the inferred usage of GEP 2. (c) The top 10 enriched GO biological process terms using 84 significantly upregulated genes of GEP 7. (d) The top 20 DEGs of GEP 7 with the largest z-scores. Cells in b and d were sorted in increasing order based on the inferred cell usage of GEP 2 and GEP 7, respectively.</p>
        </caption>
        <graphic xlink:href="pcbi.1010025.g006" position="float"/>
      </fig>
      <p>Moreover, we performed gene set enrichment analysis on all upregulated DEGs of GEP 2 and GEP 7 separately. Enriched Gene Ontology (GO) terms for GEP 2 are related to functions of beta cells (<xref rid="pcbi.1010025.g006" ref-type="fig">Fig 6A</xref> and <xref rid="pcbi.1010025.s030" ref-type="supplementary-material">S4 Table</xref>), including peptide hormone secretion and insulin secretion. This result is consistent with the finding that many functional beta genes were identified in the top upregulated genes of GEP 2. GEP 7 is most significantly enriched for gene sets related to stress response (<xref rid="pcbi.1010025.g006" ref-type="fig">Fig 6C</xref> and <xref rid="pcbi.1010025.s031" ref-type="supplementary-material">S5 Table</xref>), among which the top three are response to ER stress, cellular response to topologically incorrect protein, and stress response to metal ion. We also conducted enrichment analysis using the Reactome database (<xref rid="pcbi.1010025.s007" ref-type="supplementary-material">S7 Fig</xref>, <xref rid="pcbi.1010025.s032" ref-type="supplementary-material">S6</xref> and <xref rid="pcbi.1010025.s033" ref-type="supplementary-material">S7</xref> Tables). The top three terms enriched for GEP 2 are gluconeogenesis, glucose metabolism, and regulation of gene expression in beta cells. For GEP 7, terms similar to those identified in the GO enrichment results showed up in the top terms of Reactome results, including cellular response to external stimuli and Unfolded Protein Response. Results from Reactome further confirmed the biological features of GEP 2 and GEP 7.</p>
      <p>To show the robustness of scAAnet, we further applied it to beta cells only and identified two GEPs (<xref rid="pcbi.1010025.s034" ref-type="supplementary-material">S8A and S8B Fig</xref>). We found high correlation (03C1 <italic toggle="yes">ρ</italic> = 0.98) between the first GEP and GEP 2 identified using the entire data, and high correlation (<italic toggle="yes">ρ</italic> = 0.99) between the second GEP and GEP 7 identified using the entire data (<xref rid="pcbi.1010025.s034" ref-type="supplementary-material">S8C Fig</xref>). We also performed DEG tests for the two GEPs and identified 35 and 130 upregulated DEGs, respectively (<xref rid="pcbi.1010025.s034" ref-type="supplementary-material">S8</xref> and <xref rid="pcbi.1010025.s035" ref-type="supplementary-material">S9</xref> Tables). The 35 DEGs covered 25 out of 26 DEGs identified in GEP 2 and the 130 DEGs covered 82 out of 84 DEGs in GEP 7. Moreover, the top enriched GO terms of the two GEPs showed that one of them is responsible for the function of beta cells as GEP 2, while the other is involved in stress response as GEP 7 (<xref rid="pcbi.1010025.s034" ref-type="supplementary-material">S8D and S8E Fig</xref>).</p>
    </sec>
    <sec id="sec006">
      <title>Application of scAAnet to an IPF Lung Dataset</title>
      <p>IPF is a chronic and progressive lung disease characterized with scarring in distal lungs. Patients with IPF often suffer from shortness of breath and a persistent dry cough [<xref rid="pcbi.1010025.ref025" ref-type="bibr">25</xref>]. Although the scale of IPF studies is increasing, the cellular and molecular determinants of IPF remain largely unknown. The accumulation of myofibroblasts in lungs of IPF patients has been observed, where myofibroblasts are involved in the inflammatory response to injury by secreting cytokines [<xref rid="pcbi.1010025.ref026" ref-type="bibr">26</xref>,<xref rid="pcbi.1010025.ref027" ref-type="bibr">27</xref>]. It is known that myofibroblasts are differentiated from fibroblasts, which synthesize the extracellular matrix and collagen. Therefore, it is interesting to study this specific cell population in IPF lungs. We applied our model to a lung scRNA-seq dataset [<xref rid="pcbi.1010025.ref014" ref-type="bibr">14</xref>] by specifically selecting myofibroblasts and fibroblasts. The dataset contained cells from 32 IPF, 18 chronic obstructive pulmonary disease (COPD), and 28 control lungs. Again, the number of archetypes and the choice of distribution used for the loss term were determined by model stability. Results with K = 3 and NB distributions were the most stable and achieved relatively low reconstruction error (<xref rid="pcbi.1010025.s009" ref-type="supplementary-material">S9 Fig</xref>), so we will present results obtained under this setting.</p>
      <p>Fibroblasts and myofibroblasts are next to each without any gaps in the UMAP (<xref rid="pcbi.1010025.g007" ref-type="fig">Fig 7A and 7B</xref>) which confirms that these two cell types are biologically related and this cell population is suitable for archetypal analysis. The three inferred GEPs are located near the corners of the UMAP and this is consistent with the assumption of archetypal analysis that archetypes are extrema in a dataset. Among the three GEPs, GEP 1 is a fibroblast-specific GEP, while GEP 2 and 3 are myofibroblast-specific (<xref rid="pcbi.1010025.g007" ref-type="fig">Fig 7C–7E</xref> and <xref rid="pcbi.1010025.s010" ref-type="supplementary-material">S10 Fig</xref>). GEP 3 is the one not only cell-type-specific but also disease-related. Among fibroblasts, the inferred usage of GEP 3 in IPF is significantly higher than that in both COPD (adjusted p-value = 1.79×10<sup>−15</sup>) and Controls (adjusted p-value = 7.13×10<sup>−41</sup>) (<xref rid="pcbi.1010025.g007" ref-type="fig">Fig 7F</xref>), while the difference between COPD and Controls is not significant for GEP 3 (adjusted p-value = 1.00). We identified 21, 47, and 16 top genes for GEP 1, 2, and 3, respectively (<xref rid="pcbi.1010025.s036" ref-type="supplementary-material">S10 Table</xref>), based on the normalized gene scores. Among the 21 top genes in GEP 1, there are some genes known to express highly in fibroblasts, such as PLA2G2A, MFAP5, and PI16 [<xref rid="pcbi.1010025.ref014" ref-type="bibr">14</xref>,<xref rid="pcbi.1010025.ref028" ref-type="bibr">28</xref>]. In the meantime, SCN7A, NEBL and ITGA8 showed up in the 47 top genes for GEP 2, which are marker genes for myofibroblasts [<xref rid="pcbi.1010025.ref029" ref-type="bibr">29</xref>]. This suggests GEP 1 and GEP 2 are programs that are typical in fibroblasts and myofibroblasts, respectively. In contrast, GEP 3 is more likely to be a program specific to IPF patients in myofibroblasts.</p>
      <fig position="float" id="pcbi.1010025.g007">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010025.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>scAAnet identified 3 GEPs in the lung fibroblast and myofibroblast cells.</title>
          <p>(a) The UMAP visualization (Methods) of observed scRNA-seq data colored by cell types. (b) The UMAP visualization of observed scRNA-seq data colored by disease groups. Black dots in a and b are locations of cells that have the largest usage of the corresponding GEP (marked in Arabic numerals). (c) UMAPs colored by inferred cell usage for each GEP. (d) Heatmap showing the usage of all GEPs (rows) in all cells (columns). Cells are ordered by hierarchical clustering. (e) Heatmap showing the percentage of cells with usage &gt; 25% of each GEP (rows) in each cell type and disease group (columns). Colors of cell types and disease groups in d and e are coded in the same way as colors in a and b. (f) Box and whisker plot of the usage of each GEP in cells of fibroblast (top) and myofibroblast (bottom), colored by disease groups (colors are coded in the same way as in b). Central lines represent medians, boxes represent the IQR, and whiskers represent the 5th and 95th quantiles.</p>
        </caption>
        <graphic xlink:href="pcbi.1010025.g007" position="float"/>
      </fig>
      <p>To further investigate the differences among the three GEPs, especially for GEP 3, we conducted DEG tests for the three programs separately using marginal negative binomial regressions. We focused on the upregulated DEGs whose expression levels were positively related with the inferred cell usage of each GEP (Figs <xref rid="pcbi.1010025.g008" ref-type="fig">8B, 8D, 8F</xref>, and <xref rid="pcbi.1010025.s026" ref-type="supplementary-material">S26C</xref>). The number of upregulated DEGs in GEP 1, 2, and 3 were 234, 494, and 287, respectively (<xref rid="pcbi.1010025.s037" ref-type="supplementary-material">S11</xref>–<xref rid="pcbi.1010025.s039" ref-type="supplementary-material">S13</xref> Tables). Among the top 20 upregulated DEGs in GEP 3, we observed markers of epithelial mesenchymal transitions such as COL1A1, COL1A3, FN1, and TNC [<xref rid="pcbi.1010025.ref030" ref-type="bibr">30</xref>]. Then, we used these upregulated DEGs to conduct gene set enrichment analysis for each GEP separately. Analysis on GEP 1 returned 137 enriched GO biological processes (<xref rid="pcbi.1010025.g008" ref-type="fig">Fig 8A</xref> and <xref rid="pcbi.1010025.s040" ref-type="supplementary-material">S14 Table</xref>) among which the top one with the smallest p-value is external encapsulation structure organization (p-value = 4.16×10<sup>−7</sup> and adjusted p-value = 4.17×10<sup>−4</sup>). Enriched GO terms for GEP 2 contained many that are related to cell adhesion, migration and tube development (<xref rid="pcbi.1010025.g008" ref-type="fig">Fig 8B</xref> and <xref rid="pcbi.1010025.s041" ref-type="supplementary-material">S15 Table</xref>). Part of the enriched terms in GEP 3 are similar to those identified in GEP 2, while we also identified biological processes related to external encapsulating structure organization, connective tissue development, and collagen fibril organization (<xref rid="pcbi.1010025.g008" ref-type="fig">Fig 8E</xref> and <xref rid="pcbi.1010025.s042" ref-type="supplementary-material">S16 Table</xref>). Apart from using the GO biological process database, we conducted enrichment analysis using the Reactome database (<xref rid="pcbi.1010025.s043" ref-type="supplementary-material">S17</xref>–<xref rid="pcbi.1010025.s045" ref-type="supplementary-material">S19</xref> Tables). Among the top enriched terms, similar pathways were identified which confirmed our results (<xref rid="pcbi.1010025.s011" ref-type="supplementary-material">S11 Fig</xref>).</p>
      <fig position="float" id="pcbi.1010025.g008">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010025.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>Enriched GO terms and top DEGs of GEPs in the lung fibroblast and myofibroblast cells.</title>
          <p>(a) The top 10 enriched GO terms using upregulated DEGs in GEP 1. (b) The expression levels of the top 20 DEGs of GEP 1 covaried with the inferred usage of GEP 1. (c) The top 10 enriched GO terms using upregulated DEGs in GEP 2. (d) The expression levels of the top 20 DEGs of GEP 2 covaried with the inferred usage of GEP 2. (e) The op 10 enriched GO terms using upregulated DEGs in GEP 3. (f) The expression levels of the top 20 DEGs of GEP 3 covaried with the inferred usage of GEP 3. Top 20 genes in b, d and f were selected based on their z-scores. Cells in b, d and f were sorted by increasing order of the inferred cell usage of GEP 1, GEP 2 and GEP 3, respectively. Colors of cell types and disease groups in b, d and f are coded in the same way as colors in <xref rid="pcbi.1010025.g007" ref-type="fig">Fig 7a and 7b</xref>, respectively.</p>
        </caption>
        <graphic xlink:href="pcbi.1010025.g008" position="float"/>
      </fig>
    </sec>
    <sec id="sec007">
      <title>Application of scAAnet to microglia in a prefrontal cortex dataset</title>
      <p>AD is a slowly progressing and incurable neurodegenerative disorder affecting millions of people around the world, but little is known about the molecular complexity of AD [<xref rid="pcbi.1010025.ref031" ref-type="bibr">31</xref>]. Microglia are the intrinsic macrophages of the central nervous system and have been found to be involved in AD pathogenesis through neuroinflammation [<xref rid="pcbi.1010025.ref032" ref-type="bibr">32</xref>]. Mathy et al. [<xref rid="pcbi.1010025.ref015" ref-type="bibr">15</xref>] published the first single-cell-level study of AD pathology in 2019. The study analyzed 48 prefrontal cortex brain specimens selected from the Religious Orders Study and Memory and Aging Project (ROSMAP), among which 24 individuals were defined as AD-pathology and 24 as no-pathology based on the levels of <italic toggle="yes">β</italic>-amyloid (A<italic toggle="yes">β</italic>) and other pathological hallmarks. The paper discovered four subclusters within microglia, among which Mic1 was found to be both AD-pathology and female enriched (<xref rid="pcbi.1010025.g009" ref-type="fig">Fig 9A–9C</xref>). We applied scAAnet with Poisson distribution-based reconstruction loss to 1,920 microglial cells in this dataset and identified four GEPs that had close correspondence with the four subclusters (<xref rid="pcbi.1010025.g009" ref-type="fig">Fig 9D</xref>). From MDS visualization (<xref rid="pcbi.1010025.s012" ref-type="supplementary-material">S12 Fig</xref>), we can observe that each microglia subcluster was enriched at the corresponding corner of the simplex. We performed DEG tests for each GEP (<xref rid="pcbi.1010025.s046" ref-type="supplementary-material">S20</xref>–<xref rid="pcbi.1010025.s049" ref-type="supplementary-material">S23</xref> Tables, normalized gene scores in <xref rid="pcbi.1010025.s026" ref-type="supplementary-material">S26D Fig</xref>) and the correspondence was further confirmed by the enrichment analysis between the DEGs of each GEP across sets of marker genes of the four microglia subclusters (<xref rid="pcbi.1010025.g009" ref-type="fig">Fig 9E</xref> and <xref rid="pcbi.1010025.s050" ref-type="supplementary-material">S24 Table</xref>), which were provided by the original paper. As we can tell, GEP 1, 2, 3, and 4 are mostly enriched in Mic0, Mic3, Mic2, and Mic1, respectively.</p>
      <fig position="float" id="pcbi.1010025.g009">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010025.g009</object-id>
        <label>Fig 9</label>
        <caption>
          <title>scAAnet identified 4 GEPs using microglia in the prefrontal cortex dataset.</title>
          <p>(a) UMAP of the observed scRNA-seq data colored by microglia subclusters. (b) UMAP of the observed scRNA-seq data colored by AD pathology group. (c) UMAP of the observed scRNA-seq data colored by sex. Microglia subclusters, AD pathology group and sex are provided by the original paper. Black dots in a, b and c are locations of cells that have the largest usage of the corresponding GEP (marked in Arabic numerals). (d) UMAPs colored by inferred cell usage for each GEP. (e) Heatmap showing the enrichment of identified DEGs in each GEP across sets of marker genes of the four microglia subclusters. Colors are negative log of adjusted p-values from hypergeometric tests. P-values were adjusted by Bonferroni over all GEPs and subclusters. (f) Heatmap showing the percentage of cells with usage &gt; 25% of each GEP (rows) in each subcluster and AD group (columns). (g) Heatmap showing the percentage of cells with usage &gt; 25% of each GEP (rows) in each subcluster and sex (columns). Colors of subclusters, AD group and sex in f and g are coded in the same way as colors in a, b and c.</p>
        </caption>
        <graphic xlink:href="pcbi.1010025.g009" position="float"/>
      </fig>
      <p>Then, we investigated whether the overall usage of the four GEPs differs between AD-pathology and no-pathology group (Figs <xref rid="pcbi.1010025.g009" ref-type="fig">9F</xref> and <xref rid="pcbi.1010025.s013" ref-type="supplementary-material">S13A</xref>), and between females and males in each microglia subcluster (Figs <xref rid="pcbi.1010025.g009" ref-type="fig">9G</xref> and <xref rid="pcbi.1010025.s013" ref-type="supplementary-material">S13B</xref>). Among all the subclusters, we observed clear distinction between the two AD groups or the two sex groups in the percentage of cells that used GEP 2 and GEP 4 in Mic1 (<xref rid="pcbi.1010025.g009" ref-type="fig">Fig 9F and 9G</xref>), the only subcluster in microglia that was AD-pathology-associated [<xref rid="pcbi.1010025.ref015" ref-type="bibr">15</xref>]. Since GEP 4 was found to be mostly enriched in Mic1, it was not surprising that there were more cells using GEP 4 in the AD-pathology or the female group than in the non-pathology or the male group. Moreover, we found that about 58.8% of Mic1 cells in the non-pathology group used GEP 2, while the percentage was only 19.6% in the AD-pathology group. In the meantime, about 58.2% of Mic1 cells from males used GEP 2, while only 25.4% of Mic1 cells from females used GEP 2.</p>
      <p>To study the biological functions underlying each GEP, we conducted gene set enrichment analysis using significantly upregulated DEGs in each GEP and identified 65, 108, and 86 enriched GO terms for GEP 2, 3, and 4, respectively (<xref rid="pcbi.1010025.s051" ref-type="supplementary-material">S25</xref>–<xref rid="pcbi.1010025.s053" ref-type="supplementary-material">S27</xref> Tables). GEP 2 was found to be involved in biological processes that are related to regulation of phosphorylation and protein modification (<xref rid="pcbi.1010025.g010" ref-type="fig">Fig 10A and 10B</xref>), while GEP 4 was characterized by protein targeting to membrane, RNA catabolic process, and protein localization to ER (<xref rid="pcbi.1010025.g010" ref-type="fig">Fig 10C</xref>). Furthermore, we found many ribosomal protein coding genes (RPS6, RPS11, RPS15, RPS19, RPS20, RPS24, RPL13, RPL19, RPL23A, RPL28, RPL32, PRL35, PRL37A, and RPLP2) among the top 20 upregulated DEGs in GEP 4 (<xref rid="pcbi.1010025.g010" ref-type="fig">Fig 10D</xref>). This is consistent with the finding that ribosomal dysfunction might be a crucial event in AD [<xref rid="pcbi.1010025.ref033" ref-type="bibr">33</xref>]. Besides, APOE was the gene with the third largest z-score among all the DEGs in GEP 4 and APOE can influence the onset of A<italic toggle="yes">β</italic> deposition [<xref rid="pcbi.1010025.ref034" ref-type="bibr">34</xref>,<xref rid="pcbi.1010025.ref035" ref-type="bibr">35</xref>], which indicates the importance of GEP 4 in AD pathology.</p>
      <fig position="float" id="pcbi.1010025.g010">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010025.g010</object-id>
        <label>Fig 10</label>
        <caption>
          <title>Enriched GO terms and top DEGs of GEP 2 and GEP 4 in the prefrontal cortex dataset.</title>
          <p>(a) The top 10 enriched GO biological process terms using upregulated DEGs in GEP 2. (b) The expression levels of the top 20 DEGs with the largest z-scores covaried with the inferred usage of GEP 2. (c) The top 10 enriched GO biological process terms using upregulated DEGs in GEP 4. (d) The expression levels of the top 20 DEGs of GEP4 covaried with the inferred usage of GEP 4. Cells in b and d were sorted by increasing order of the inferred cell usage of GEP 2 and GEP 4, respectively.</p>
        </caption>
        <graphic xlink:href="pcbi.1010025.g010" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec008">
    <title>Discussion</title>
    <p>Traditional cluster analysis on scRNA-seq data groups mixed cell populations into discrete cell clusters, which does not consider the continuous changes of cell states and possible sharing of GEPs among those cell clusters (see <xref rid="pcbi.1010025.s054" ref-type="supplementary-material">S1 Text</xref> section 7 for discussion on the level of sharing in the three real datasets). Therefore, archetypal analysis can be a more effective way to model the observed expression profile as a convex combination of GEPs, as this allows the utilization of more than one GEP in a single cell and the sharing of the same GEP among cells [<xref rid="pcbi.1010025.ref003" ref-type="bibr">3</xref>]. PCA is another commonly used data decomposition method for dimensionality reduction of scRNA-seq data [<xref rid="pcbi.1010025.ref036" ref-type="bibr">36</xref>]. The difference between archetypal analysis and PCA comes from the non-negativity of the two low-rank matrices and the convexity. The convexity ensures that elements in the usage/coefficient vector of a cell are non-negative and sum to 1. Those elements can be interpreted as how much a cell ‘uses’ different GEPs or the relative activity of GEPs in a cell. Moreover, the inferred archetypes are some ‘pure’ types or extrema of the real data, while principal components are not required to resemble ‘pure’ types in the data and their elements can be either positive or negative. Therefore, archetypal analysis adds to more interpretability than PCA and suits the mixture property of expression data better than cluster analysis.</p>
    <p>Here, we present scAAnet, an autoencoder-based model for non-linear archetypal analysis designed specifically for scRNA-seq data. There are mainly three advantages of scAAnet over the existing methods for archetypal analysis. First, scAAnet is able to perform non-linear decomposition in the case where data are not generated linearly, such as features in high-dimensional biological systems. Second, we measure the reconstruction error by modeling scRNA-seq data using count distributions. We showed that count distribution-based loss led to more accurate results than MSE using synthetic scRNA-seq data. Third, we added an archetypal constraint in the loss function to decrease the distance between archetypes and data points in the latent space. We compared scAAnet against some existing methods that can perform archetypal analysis and showed that it is important to impose the archetypal constraint to find the tightest GEPs. It is worth mentioning that if we replace all non-linear activation functions by identity functions and remove the hidden layer in all decoders/encoders, scAAnet would perform linear archetypal decomposition on count data. This is equivalent to one group of methods based on topic models [<xref rid="pcbi.1010025.ref037" ref-type="bibr">37</xref>,<xref rid="pcbi.1010025.ref038" ref-type="bibr">38</xref>], such as latent semantic indexing [<xref rid="pcbi.1010025.ref039" ref-type="bibr">39</xref>] and latent Dirichlet allocation [<xref rid="pcbi.1010025.ref040" ref-type="bibr">40</xref>].</p>
    <p>We applied scAAnet to three real datasets to showcase the ability of scAAnet to identify biologically meaningful GEPs and illustrate how results from scAAnet can be used for downstream analysis such as identifying program-specific DEGs and gene set enrichment analysis. The first dataset is a pancreatic islet dataset [<xref rid="pcbi.1010025.ref013" ref-type="bibr">13</xref>] where 10 cell types were clearly defined and categorically delimited in UMAP visualization. We found a good correspondence between GEPs identified by scAAnet and the 10 well studied cell types. Besides, beta cells were related to two distinct GEPs, among which one was responsible for beta cell functions and the other was linked to ER stress response. The results are consistent with findings in published papers [<xref rid="pcbi.1010025.ref013" ref-type="bibr">13</xref>,<xref rid="pcbi.1010025.ref041" ref-type="bibr">41</xref>]. However, in the original paper, the authors detected these two ‘subtypes’ through a more exploratory type of analyses. More specifically, they performed PCA on beta cells and found genes positively correlated with the value of PC1 were functional beta genes and genes negatively correlated with the value of PC1 were involved in the stress response. We think the benefit of our method is that it provides a more systematic and principled way of identifying the heterogeneity within a cell type. The second dataset is an IPF lung dataset. We identified three GEPs using fibroblasts and myofibroblasts and showed that GEP 3 was an IPF-related archetype with higher signals in myofibroblasts. GEP 3 was not only related to cell migration and adhesion, but also involved in collagen fibril and extracellular matrix organization, suggesting its potential role in pulmonary fibrosis [<xref rid="pcbi.1010025.ref042" ref-type="bibr">42</xref>,<xref rid="pcbi.1010025.ref043" ref-type="bibr">43</xref>]. Note that in the original paper of this dataset, two pseudotime-based archetypes were identified within myofibroblasts and fibroblasts separately, and myofibroblasts ordered towards the end of the trajectory were found to be enriched in IPF lungs [<xref rid="pcbi.1010025.ref014" ref-type="bibr">14</xref>]. Therefore, scAAnet was not only able to recover the trajectory-based archetype that was both IPF and myofibroblast enriched, but also identify one more archetype in fibroblasts, suggesting the potential of scAAnet on trajectory-based analysis at a higher resolution. The third dataset is a prefrontal cortex dataset from patients with varying degree of AD pathology. We identified four GEPs using microglia and illustrated the close connection between them and the four microglia subclusters presented in the original paper [<xref rid="pcbi.1010025.ref015" ref-type="bibr">15</xref>]. Our approach showed that Mic1’s association with AD pathology resulted from both the higher activity level of GEP 4 and the lower activity level of GEP 2, demonstrating the ability of scAAnet to reveal cellular heterogeneity at a higher resolution.</p>
    <p>There are some limitations and practical issues of scAAnet. First, although scAAnet is able to deliver similar results to cluster analysis on a cell population which contain categorically delimited cell types, we still recommend not to apply scAAnet directly to such a scRNA-seq dataset. This is because scAAnet is a deep learning-based method that involves stochastic training and many hyperparameters and it will take more resources to run compared with traditional cluster analysis. Instead, we recommend users to run scAAnet on a subset of cell types that are likely to involve shared programs (UMAP visualization and pre-clustering combined with domain knowledge can be used to determine this) or are of particular interest to researchers. Second, the number of archetypes (K) for scAAnet is provided by users and since archetypal analysis is unsupervised, there is no universally definitive criteria to choose the value of K. In practice, we run scAAnet with a set of different Ks and select the one that is reasonably stable with relatively low reconstruction error (Methods). Then, we can vary K around the choice and to see if approximately the same core set of GEPs are identified. Third, the current version of scAAnet is designed for identifying GEPs using single-cell transcriptomic data, but with the recent advances in single-cell multi-omics sequencing technologies [<xref rid="pcbi.1010025.ref044" ref-type="bibr">44</xref>–<xref rid="pcbi.1010025.ref048" ref-type="bibr">48</xref>], more simultaneously measured multi-omics data from single cells will be available and scAAnet can be extended to infer GEPs based on multiple modalities jointly. Fourth, although we have shown the potential of scAAnet on trajectory analysis when the topology is simple (e.g. linear or bifurcation), scAAnet cannot replace state-of-the-art trajectory inference methods because most developmental data contain a more complex topology (e.g. multifurcation or circular) [<xref rid="pcbi.1010025.ref049" ref-type="bibr">49</xref>]. Encompassing such data within a simplex would result in loss of resolution. Therefore, we recommend using scAAnet as a complement for trajectory analysis when the topology is simple, or data are measured within a relatively short developmental period.</p>
    <p>Altogether, scAAnet enables the non-linear decomposition of scRNA-seq data and identification of expression programs in mixed cell populations, especially when cell types are related and are not categorically delimited. The latent representation (the usage matrix) of scRNA-seq data can be used as an effective baseline for various visualization tools such as tSNE [<xref rid="pcbi.1010025.ref050" ref-type="bibr">50</xref>,<xref rid="pcbi.1010025.ref051" ref-type="bibr">51</xref>] and UMAP [<xref rid="pcbi.1010025.ref052" ref-type="bibr">52</xref>,<xref rid="pcbi.1010025.ref053" ref-type="bibr">53</xref>]. We also provide accompanying downstream analysis tools such as top gene identification and DEG tests to help interpret the results from scAAnet. We expect this method can be used as an alternative to cluster analysis in analyzing scRNA-seq data when researchers want to explore shared programs among different cell states.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec009">
    <title>Methods</title>
    <sec id="sec010">
      <title>Design of scAAnet</title>
      <p><underline>Architecture and model formulation</underline>: scAAnet models count scRNA-seq data with ZINB distributions, so the outputs include not only the mean <italic toggle="yes">μ</italic>, but also the dispersion <italic toggle="yes">θ</italic> and dropout probability <italic toggle="yes">π</italic>. We present the architecture of scAAnet in the following specifications for cell <italic toggle="yes">i</italic>:
<disp-formula id="pcbi.1010025.e001"><alternatives><graphic xlink:href="pcbi.1010025.e001.jpg" id="pcbi.1010025.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1010025.e002"><alternatives><graphic xlink:href="pcbi.1010025.e002.jpg" id="pcbi.1010025.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1010025.e003"><alternatives><graphic xlink:href="pcbi.1010025.e003.jpg" id="pcbi.1010025.e003g" position="anchor"/><mml:math id="M3" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msup></mml:math></alternatives><label>(1)</label></disp-formula>
<disp-formula id="pcbi.1010025.e004"><alternatives><graphic xlink:href="pcbi.1010025.e004.jpg" id="pcbi.1010025.e004g" position="anchor"/><mml:math id="M4" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1010025.e005"><alternatives><graphic xlink:href="pcbi.1010025.e005.jpg" id="pcbi.1010025.e005g" position="anchor"/><mml:math id="M5" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1010025.e006"><alternatives><graphic xlink:href="pcbi.1010025.e006.jpg" id="pcbi.1010025.e006g" position="anchor"/><mml:math id="M6" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></disp-formula></p>
      <p>where <inline-formula id="pcbi.1010025.e007"><alternatives><graphic xlink:href="pcbi.1010025.e007.jpg" id="pcbi.1010025.e007g" position="anchor"/><mml:math id="M7" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1010025.e008"><alternatives><graphic xlink:href="pcbi.1010025.e008.jpg" id="pcbi.1010025.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> represent two non-linear transformations through the encoder side, and <inline-formula id="pcbi.1010025.e009"><alternatives><graphic xlink:href="pcbi.1010025.e009.jpg" id="pcbi.1010025.e009g" position="anchor"/><mml:math id="M9" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1010025.e010"><alternatives><graphic xlink:href="pcbi.1010025.e010.jpg" id="pcbi.1010025.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> are decoder neural networks that map the latent representations to the mean, the dispersion, and the dropout probability parameter, respectively. Encoder <italic toggle="yes">E</italic><sub><italic toggle="yes">a</italic></sub> and <italic toggle="yes">E</italic><sub><italic toggle="yes">b</italic></sub> are designed to share the same set of layers except for the last one. Similarly, decoder <italic toggle="yes">D</italic><sub><italic toggle="yes">θ</italic></sub> and <italic toggle="yes">D</italic><sub><italic toggle="yes">π</italic></sub> also share the same set of layers before their respective output layer. The input to scAAnet includes <inline-formula id="pcbi.1010025.e011"><alternatives><graphic xlink:href="pcbi.1010025.e011.jpg" id="pcbi.1010025.e011g" position="anchor"/><mml:math id="M11" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <italic toggle="yes">l</italic><sub><italic toggle="yes">i</italic></sub>, where <italic toggle="yes">l</italic><sub><italic toggle="yes">i</italic></sub> is library size of cell <italic toggle="yes">i</italic> calculated by the total number of counts and <inline-formula id="pcbi.1010025.e012"><alternatives><graphic xlink:href="pcbi.1010025.e012.jpg" id="pcbi.1010025.e012g" position="anchor"/><mml:math id="M12" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the expression profile of cell <italic toggle="yes">i</italic> normalized by the library size. In the above formulation, <italic toggle="yes">a</italic><sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">b</italic><sub><italic toggle="yes">i</italic></sub> are two latent vectors generated from the encoders. Here, <italic toggle="yes">a</italic><sub><italic toggle="yes">i</italic></sub> is a usage vector that is used as the input for decoders to estimate the three parameters of the ZINB distribution, while <italic toggle="yes">b</italic><sub><italic toggle="yes">i</italic></sub> is an auxiliary vector that helps constrain the distance between archetypes and data points in the latent space. Moreover, we set positions for archetypes in the latent space in matrix <italic toggle="yes">Z</italic><sup><italic toggle="yes">fix</italic></sup> and by multiplying <italic toggle="yes">a</italic><sub><italic toggle="yes">i</italic></sub> with <italic toggle="yes">Z</italic><sup><italic toggle="yes">fix</italic></sup>, we can get locations of data points relative to the preset archetypes (<italic toggle="yes">e</italic><sub><italic toggle="yes">i</italic></sub>). This information is used for constructing an archetypal constraint in the loss function.</p>
      <p>The activation functions chosen for the layers that output mean, dispersion, and dropout probability are Softmax, softplus, and sigmoid, respectively. Softmax transformation is applied to the outputs from encoders and a leaky ReLU activation is used for other hidden layers.</p>
      <p>To increase flexibility, scAAnet allows users to choose from Poisson, ZI-Poisson, and NB distributions apart from ZINB distributions. In addition, users are able to choose whether the dispersion parameter is both cell and gene specific or constant across cells for the same gene.</p>
      <p><underline>Construction of loss function</underline>: The loss function of scAAnet consists of two parts, a reconstruction error term and an archetypal constraint. Since we model count scRNA-seq data using ZINB distributions, the reconstruction error is quantified by the negative log-likelihood (NLL) of ZINB distributions using the three parameters estimated by scAAnet:
<disp-formula id="pcbi.1010025.e013"><alternatives><graphic xlink:href="pcbi.1010025.e013.jpg" id="pcbi.1010025.e013g" position="anchor"/><mml:math id="M13" display="block" overflow="scroll"><mml:mi>R</mml:mi><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mstyle><mml:mrow><mml:mi>N</mml:mi><mml:mi>L</mml:mi><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives><label>(2)</label></disp-formula>
where <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub> is the unnormalized raw count data. The archetypal constraint of scAAnet is represented as the Frobenius norm between two matrices:
<disp-formula id="pcbi.1010025.e014"><alternatives><graphic xlink:href="pcbi.1010025.e014.jpg" id="pcbi.1010025.e014g" position="anchor"/><mml:math id="M14" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>ι</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>E</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives><label>(3)</label></disp-formula></p>
      <p>In this term, we multiply the auxiliary matrix <italic toggle="yes">B</italic> (the <italic toggle="yes">i</italic>th column is <italic toggle="yes">b</italic><sub><italic toggle="yes">i</italic></sub>) with the computed locations of data points relative to <italic toggle="yes">Z</italic><sup><italic toggle="yes">fix</italic></sup> (<italic toggle="yes">E</italic>, whose <italic toggle="yes">i</italic>th row is <italic toggle="yes">e</italic><sub><italic toggle="yes">i</italic></sub>) to get the inferred locations of archetypes. Then, we indirectly constrain the distance between archetypes and the data in the latent space by penalizing the distance between preset archetypes and inferred archetypes.</p>
      <p><underline>Algorithm</underline>: We train scAAnet using the following algorithm:</p>
      <p><bold>Algorithm 1</bold> Training of scAAnet</p>
      <p><bold>Input</bold>: raw count scRNA-seq data <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub>, <italic toggle="yes">i</italic> = 1,…,<italic toggle="yes">n</italic>; number of archetypes <italic toggle="yes">K</italic>; maximum epoch number <italic toggle="yes">E</italic>; batch size <italic toggle="yes">b</italic>; number of warm-ups <italic toggle="yes">W</italic>.</p>
      <p><bold>Output</bold>: usage <italic toggle="yes">a</italic><sub><italic toggle="yes">i</italic></sub>, <italic toggle="yes">i</italic> = 1,…,<italic toggle="yes">n</italic>; archetypes <italic toggle="yes">z</italic><sub><italic toggle="yes">k</italic></sub>, <italic toggle="yes">k</italic> = 1,…,<italic toggle="yes">K</italic>; reconstructed expression profile <inline-formula id="pcbi.1010025.e015"><alternatives><graphic xlink:href="pcbi.1010025.e015.jpg" id="pcbi.1010025.e015g" position="anchor"/><mml:math id="M15" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></alternatives></inline-formula>
<italic toggle="yes">i</italic> = 1,…,<italic toggle="yes">n</italic>.</p>
      <p><bold>Init</bold>: initialize network parameters using Xavier normal initializer and <italic toggle="yes">Z</italic><sup><italic toggle="yes">fix</italic></sup></p>
      <p specific-use="line"><bold>for</bold><italic toggle="yes">m</italic> = 1 to <italic toggle="yes">E</italic>
<bold>do # iterate through</bold>
<italic toggle="yes">E</italic>
<bold>epochs</bold></p>
      <p specific-use="line"> <bold>for</bold>
<italic toggle="yes">q</italic> = 1 to ceiling(<italic toggle="yes">n/b</italic>) <bold>do # iterate through mini-batches</bold></p>
      <p specific-use="line"> sample a mini-batch of size <italic toggle="yes">b</italic></p>
      <p specific-use="line"> calculate loss <inline-formula id="pcbi.1010025.e016"><alternatives><graphic xlink:href="pcbi.1010025.e016.jpg" id="pcbi.1010025.e016g" position="anchor"/><mml:math id="M16" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula></p>
      <p specific-use="line"> <bold>if <italic toggle="yes">m</italic>≤<italic toggle="yes">W</italic> then</bold></p>
      <p specific-use="line">  update network parameters through backpropagation using the RMSprop optimizer</p>
      <p specific-use="line"> <bold>else</bold></p>
      <p specific-use="line">  update network parameters and <italic toggle="yes">Z</italic><sup><italic toggle="yes">fix</italic></sup> through backpropagation using the RMSprop optimizer</p>
      <p specific-use="line"> <bold>end if</bold></p>
      <p specific-use="line"> <bold>end for</bold></p>
      <p specific-use="line"> <bold>if</bold> the early stopping criterion is satisfied <bold>then</bold></p>
      <p specific-use="line"> break</p>
      <p specific-use="line">
        <bold>end for</bold>
      </p>
      <p specific-use="line"><bold>for</bold><italic toggle="yes">i</italic> = 1 to n <bold>do</bold></p>
      <p specific-use="line">
        <inline-formula id="pcbi.1010025.e017">
          <alternatives>
            <graphic xlink:href="pcbi.1010025.e017.jpg" id="pcbi.1010025.e017g" position="anchor"/>
            <mml:math id="M17" display="inline" overflow="scroll">
              <mml:msub>
                <mml:mrow>
                  <mml:mi>a</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>f</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>E</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:msub>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mover accent="true">
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                      </mml:mrow>
                      <mml:mo>¯</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:math>
          </alternatives>
        </inline-formula>
      </p>
      <p specific-use="line">
        <inline-formula id="pcbi.1010025.e018">
          <alternatives>
            <graphic xlink:href="pcbi.1010025.e018.jpg" id="pcbi.1010025.e018g" position="anchor"/>
            <mml:math id="M18" display="inline" overflow="scroll">
              <mml:msub>
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                    </mml:mrow>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>f</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>μ</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:msub>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>a</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>Z</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>f</mml:mi>
                    <mml:mi>i</mml:mi>
                    <mml:mi>x</mml:mi>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
              <mml:mo>)</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>l</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:math>
          </alternatives>
        </inline-formula>
      </p>
      <p specific-use="line">
        <bold>end for</bold>
      </p>
      <p specific-use="line"><bold>for</bold> k = 1 to K <bold>do</bold></p>
      <p specific-use="line">
        <inline-formula id="pcbi.1010025.e019">
          <alternatives>
            <graphic xlink:href="pcbi.1010025.e019.jpg" id="pcbi.1010025.e019g" position="anchor"/>
            <mml:math id="M19" display="inline" overflow="scroll">
              <mml:msub>
                <mml:mrow>
                  <mml:mi>z</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>f</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>μ</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:msub>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>Z</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>f</mml:mi>
                    <mml:mi>i</mml:mi>
                    <mml:mi>x</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:math>
          </alternatives>
        </inline-formula>
      </p>
      <p specific-use="line">
        <bold>end for</bold>
      </p>
      <p>The initial learning rate used by scAAnet is 0.01 and we reduce the learning rate by a factor of 0.5 if the loss does not improve in a given number of epochs (by default, 10). The minimum learning rate can be reduced to is 0.001. We also adopt an early stopping approach, in which training is stopped if the loss does not improve in a given number of epochs (set to 100) and the model weights are restored from the best epoch.</p>
      <p>Although the locations of the archetypes in the latent space are set in the beginning, our algorithm allows <italic toggle="yes">Z</italic><sup><italic toggle="yes">fix</italic></sup> to be trainable after a warm-up period to make the shape of latent space more flexible to the input data. We found that scAAnet achieved a good balance between the accuracy of cell usage inference and the accuracy of GEP inference on simulated data after a warm-up period of 20 (<xref rid="pcbi.1010025.s014" ref-type="supplementary-material">S14 Fig</xref>). After 20, the performance was relatively robust as the number of warm-up periods increased. Therefore, we set the warm-up period to be 20 as the default value and adopt this strategy in real data analysis.</p>
    </sec>
    <sec id="sec011">
      <title>Description and implementation details of methods</title>
      <p><underline>NMF [<xref rid="pcbi.1010025.ref017" ref-type="bibr">17</xref>]</underline>: NMF was implemented through function non_negative_factorization in the Python library scikit-learn (version 0.23.2). The expression profile of each cell was normalized by the total counts before performing NMF. Apart from the maximum iteration number, which was set as 400, all the other parameters were set as their default values.</p>
      <p><underline>AAnet</underline> [<xref rid="pcbi.1010025.ref009" ref-type="bibr">9</xref>]: AAnet (version 0.1.0) was downloaded from <ext-link xlink:href="https://github.com/KrishnaswamyLab/AAnet" ext-link-type="uri">https://github.com/KrishnaswamyLab/AAnet</ext-link>. AAnet is an autoencoder neural network designed for non-linear archetypal analysis. AAnet forces the sum of loadings of data onto archetypes to be 1 by introducing a novel regularization on the middle layer, but the reconstruction error used by AAnet is still MSE. The expression count data need to be normalized before applying the AAnet model. According to the instruction of AAnet, we normalized data first by total counts and then applied a square root transformation. Parameters we chose for batch size, hidden layer size, and number of batches were 64, 128, and 10,000, respectively.</p>
      <p><underline>scVI</underline> [<xref rid="pcbi.1010025.ref011" ref-type="bibr">11</xref>]: scVI (version 0.9.0a2) was downloaded from <ext-link xlink:href="https://github.com/YosefLab/scvi-tools" ext-link-type="uri">https://github.com/YosefLab/scvi-tools</ext-link>. scVI is a deep generative model based on a variational autoencoder. The expression profile of each cell is modeled as a sample that follows a ZINB distribution and a latent embedding vector can be inferred by the encoder of scVI. The loss function of scVI is composed of two parts. The first part is the expectation of the logarithm of the conditional probability of the expression profile given the latent vector. The second part is the Kullback–Leibler divergence between a standard normal distribution and the inferred distribution of each latent vector. The latent vector is modeled as a normally distributed random vector in the traditional scVI, but it can be set to follow a logistic normal distribution to make it positive and sum to 1. In this case, scVI can be utilized to mimic the behavior of archetypal analysis. Since scVI models scRNA-seq data with a ZINB distribution, we do not need to perform any normalization on the raw count data. Parameters we used for batch size, hidden layer size, and the maximum epoch number were 64, 128, and 200, respectively.</p>
      <p><underline>LDVAE [<xref rid="pcbi.1010025.ref018" ref-type="bibr">18</xref>]</underline>: LDVAE was developed based on the framework of scVI and it is incorporated in the same Python package of scVI. Compared to scVI, LDVAE provides interpretability and enables identification of gene programs by replacing the non-linear decoder with a linear reconstruction function, while keeping a non-linear inference model on the encoder side. Similar to scVI, we used raw count data without any normalization as the input for LDVAE and we used the same set of parameters as scVI.</p>
    </sec>
    <sec id="sec012">
      <title>Simulation of synthetic single-cell RNA-seq data</title>
      <p>We simulated synthetic scRNA-seq datasets using Splatter’s [<xref rid="pcbi.1010025.ref016" ref-type="bibr">16</xref>] framework which is based on negative binomial distributions (equivalent to Gamma-Poisson hierarchical models). We reimplemented Splatter in Python tailored to our needs for archetypal analysis. For all simulated datasets, 4 GEPs were generated, which formed a 3-simplex with 4 vertices. The usage of these 4 GEPs for each cell was sampled from the simplex using a Dirichlet distribution. About 50% of the samples were generated from the boundary of the simplex by randomly setting one of the usages to be zero followed by normalization. The purpose of this construction is to allow the existence of cells that don’t contain all the GEPs and to show scAAnet is able to handle such cells (see <xref rid="pcbi.1010025.s054" ref-type="supplementary-material">S1 Text</xref> section 8 for more discussion). Each dataset contained 2,000 genes and 3,000 cells. In each GEP, the proportion of DEGs among all the 2,000 genes was set to 10% and overlap of DEG sets among GEPs was allowed. The differential expression ratios for those genes were sampled from a log-normal distribution with the scale parameter as 1.0, and the location parameter as either 1.0, 0.75, or 0.5 to mimic different signal-to-noise ratios. For each signal-to-noise level, ten datasets were randomly generated. Other Splatter parameters were the same as those used in Kotliar et al. [<xref rid="pcbi.1010025.ref003" ref-type="bibr">3</xref>] and they were inferred by Splatter from 8,000 cells of the organoid dataset in Quadrato et al. [<xref rid="pcbi.1010025.ref054" ref-type="bibr">54</xref>]. Furthermore, we generated synthetic datasets that follow ZINB distribution by introducing a parameter <italic toggle="yes">λ</italic> to control the dropout ratio. For cell <italic toggle="yes">i</italic> and gene <italic toggle="yes">j</italic>, its dropout probability is defined as
<disp-formula id="pcbi.1010025.e020"><alternatives><graphic xlink:href="pcbi.1010025.e020.jpg" id="pcbi.1010025.e020g" position="anchor"/><mml:math id="M20" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives><label>(4)</label></disp-formula>
where <italic toggle="yes">μ</italic><sub><italic toggle="yes">ij</italic></sub> is the mean expression level drawn from a Gamma distribution and such a relationship was used in a previous scRNA-seq study [<xref rid="pcbi.1010025.ref055" ref-type="bibr">55</xref>]. The values of <italic toggle="yes">λ</italic> we chose were 0.3, 0.1, and 0.01. The dropout proportions in simulated datasets under different scenarios are shown in <xref rid="pcbi.1010025.s015" ref-type="supplementary-material">S15 Fig</xref> where Inf means NB distributions. With decreasing <italic toggle="yes">λ</italic>, the dropout proportion goes up.</p>
    </sec>
    <sec id="sec013">
      <title>Single-cell RNA-seq data preprocessing</title>
      <p>We used the Python library Scanpy [<xref rid="pcbi.1010025.ref056" ref-type="bibr">56</xref>] (version 1.7.2) to perform all the preprocessing and visualization of scRNA-seq data. Details for each dataset are provided below.</p>
      <p><underline>The pancreatic islet dataset [<xref rid="pcbi.1010025.ref013" ref-type="bibr">13</xref>]</underline>: This human scRNA-seq dataset contained 1,937 cells and 20,125 genes. We filtered out genes with non-zero expression in fewer than 3 cells and genes whose mean expression levels were lower than 0.001 across all cells before normalization. This dataset was prelabeled with a total of 14 cell types. We calculated the number of cells in each cell cluster and deleted cells whose cluster had fewer than 15 cells. One exception was for epsilon cells. There were only 13 of them but we decided to keep them because this cell type is an endocrine cell type along with other four cell types (alpha, beta, gamma, delta). The final dataset analyzed contained 1,908 cells and 14,739 genes. We then selected top 2,000 highly variable genes (HVGs) based on the pipeline in Scanpy for scAAnet. HVGs were selected by first modeling the relationship between mean and dispersion of all genes across cells. Genes with higher dispersion compared to genes with similar mean expression would be regarded as HVGs [<xref rid="pcbi.1010025.ref057" ref-type="bibr">57</xref>].</p>
      <p><underline>The lung IPF dataset [<xref rid="pcbi.1010025.ref014" ref-type="bibr">14</xref>]</underline>: The entire lung IPF data contained 312,928 cells which were classified into 38 discrete cell types and 45,947 unique transcripts. Here, we only used cells that were annotated as fibroblast or myofibroblast because these two cell types were closely related so that they were suitable for archetypal analysis. We filtered out genes with non-zero expression in fewer than 10 cells and mean expression lower than 0.001. We also removed mitochondrial genes. The filtered dataset had 6,166 fibroblast and myofibroblast cells and 25,431 features. We then selected top 1,500 HVGs from this dataset for analysis according to the original paper.</p>
      <p><underline>The prefrontal cortex dataset [<xref rid="pcbi.1010025.ref015" ref-type="bibr">15</xref>]</underline>: We downloaded the filtered dataset provided by the paper, which contained 70,634 cells and 17,926 genes. We selected 1,920 microglial cells based on the provided cell label and top 2,000 HVGs for further analysis.</p>
    </sec>
    <sec id="sec014">
      <title>UMAP visualization</title>
      <p>We used UMAP [<xref rid="pcbi.1010025.ref052" ref-type="bibr">52</xref>,<xref rid="pcbi.1010025.ref053" ref-type="bibr">53</xref>] for the visualization of scRNA-seq datasets. Before applying UMAP, we ran a number of steps to prepare the data. First, cells were normalized by library size to a target sum of 10,000 counts. Then, they were log-transformed after adding one pseudo count. In the next step, the total counts per cell (and the percentage of mitochondrial genes for the lung dataset) were regressed out and the expression of each gene was scaled across cells with absolute values larger than 10 being clipped. Next, PCA was performed to reduce the dimensionality and top PCs were used to construct a neighborhood graph with a fixed size of local neighborhood. Last, the neighborhood graph was used to generate a two-dimensional UMAP. Details for each dataset are provided below.</p>
      <p><underline>The pancreatic islet dataset [<xref rid="pcbi.1010025.ref013" ref-type="bibr">13</xref>]</underline>: The number of top PCs we used for this dataset was 35 with default number of neighbors as 15. Apart from generating UMAP for the original expression profile using PCA, we also generated UMAPs based on the inferred usage matrix and on the reconstructed expression profile. For the former one, the neighborhood graph was constructed using the usage matrix instead of top PCs and the number of neighbors was 20. For the latter one, we repeated the previously described pipeline using the reconstructed matrix and the number of neighbors was also 20.</p>
      <p><underline>The lung IPF dataset [<xref rid="pcbi.1010025.ref014" ref-type="bibr">14</xref>]</underline>: After generating the UMAP based on the pipeline, we continued to conduct the following steps according to the original paper [<xref rid="pcbi.1010025.ref014" ref-type="bibr">14</xref>] of this dataset. The Louvain [<xref rid="pcbi.1010025.ref058" ref-type="bibr">58</xref>] clustering was run on the constructed neighborhood (resolution = 0.45). Then, partition-based graph abstraction [<xref rid="pcbi.1010025.ref059" ref-type="bibr">59</xref>] (PAGA) was used to quantify the connectivity among Louvain clusters and a diffusion map [<xref rid="pcbi.1010025.ref060" ref-type="bibr">60</xref>,<xref rid="pcbi.1010025.ref061" ref-type="bibr">61</xref>] was calculated using the top 5 PCs. Next, a new neighborhood graph was constructed with the neighborhood size as 80 using the diffusion map. Finally, a UMAP was generated on this new graph using PAGA as initial embedding positions (spread = 0.8).</p>
      <p><underline>The prefrontal cortex dataset [<xref rid="pcbi.1010025.ref015" ref-type="bibr">15</xref>]</underline>: We used top 10 PCs as in the original paper with default number of neighbors as 15 to generate the two-dimensional UMAP coordinates.</p>
    </sec>
    <sec id="sec015">
      <title>Selection of number of archetypes (K)</title>
      <p>Note that there is no universally definitive way to select the number of archetypes (K), but we still use some criteria to help the selection process. Generally speaking, we select K based on both the reconstruction error and stability of decomposition. For stability, we can assess both the stability of archetype inference and the stability of cell usage inference. To select K, we ran scAAnet 30 times using different random seeds for each candidate K. Candidate Ks are chosen from a reasonably wide range.</p>
      <p>The reconstruction error is obtained from the first term in the loss function of scAAnet (<xref rid="pcbi.1010025.e013" ref-type="disp-formula">Eq 2</xref>), which is the negative log-likelihood of a chosen count distribution. To evaluate the stability of cell usage inference under different numbers of archetypes, we use a similar method adopted from Brunet et al. [<xref rid="pcbi.1010025.ref062" ref-type="bibr">62</xref>]. For a cell usage inference result, we can assign each cell to a dominant archetype based on its maximum cell usage. Across all 30 repeats, we can calculate the proportion that each pair of cells are assigned to the same archetype to get a consensus matrix C. The entries of C range from 0 to 1 and indicate the probability that two cells are assigned to the same archetype. If a K delivers stable cell usage results over 30 repeats, we expect entries of C are close to 0 or 1. To assess the stability of archetype inference under different numbers of archetypes, we borrow the idea from Kotliar et al. [<xref rid="pcbi.1010025.ref003" ref-type="bibr">3</xref>]. Under a given K, we concatenate 30 archetype matrices inferred using different random states. Then, we perform K-means clustering on the 30K archetypes and use Euclidean distance silhouette score to quantify the robustness of archetype inference across 30 repeats.</p>
    </sec>
    <sec id="sec016">
      <title>Identification of top genes for archetypes</title>
      <p>The first interesting question to be asked is what the dominating or top genes for each inferred GEP are. Here, we adopt a similar approach proposed by Gonzalez-Blas et al. [<xref rid="pcbi.1010025.ref063" ref-type="bibr">63</xref>] to identify top gene sets. After getting the archetype matrix <italic toggle="yes">Z</italic> from scAAnet, we can calculate gene scores across GEPs for each gene using the following equation:
<disp-formula id="pcbi.1010025.e021"><alternatives><graphic xlink:href="pcbi.1010025.e021.jpg" id="pcbi.1010025.e021g" position="anchor"/><mml:math id="M21" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math></alternatives><label>(5)</label></disp-formula>
where <italic toggle="yes">Z</italic><sub><italic toggle="yes">gk</italic></sub> is the scaled mean of gene <italic toggle="yes">g</italic> in GEP <italic toggle="yes">k</italic> and <italic toggle="yes">K</italic> is the total number of archetypes. Then, we normalize the gene score to make it fall between 0 and 1:
<disp-formula id="pcbi.1010025.e022"><alternatives><graphic xlink:href="pcbi.1010025.e022.jpg" id="pcbi.1010025.e022g" position="anchor"/><mml:math id="M22" display="block" overflow="scroll"><mml:mi>N</mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi mathvariant="normal">j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi mathvariant="normal">j</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi mathvariant="normal">j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math></alternatives><label>(6)</label></disp-formula></p>
      <p>The next step is to identify the top gene set for each GEP based on normalized gene scores. A Gamma distribution can be fitted to the gene scores and a cutoff will be set based on a user-given probability threshold (default is 0.975). Any genes with normalized gene scores larger than the cutoff are collected into the top gene set for that GEP.</p>
    </sec>
    <sec id="sec017">
      <title>Differentially expressed gene (DEG) test for archetypes</title>
      <p>We designed a test for identifying archetype-specific DEGs. The test is based on marginal negative-binomial (NB) regression where we regress the count data of each gene <italic toggle="yes">g</italic> onto the usage vector of each GEP <italic toggle="yes">k</italic> across all the cells and using the log transformed total counts (library size) as the offset. The equation of our regression model is:
<disp-formula id="pcbi.1010025.e023"><alternatives><graphic xlink:href="pcbi.1010025.e023.jpg" id="pcbi.1010025.e023g" position="anchor"/><mml:math id="M23" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>.</mml:mo></mml:math></alternatives></disp-formula>
where <italic toggle="yes">x</italic><sub><italic toggle="yes">ig</italic></sub> is the raw count of gene <italic toggle="yes">g</italic> in cell <italic toggle="yes">i</italic>, <italic toggle="yes">U</italic><sub><italic toggle="yes">ik</italic></sub> is the inferred cell usage of GEP <italic toggle="yes">k</italic> in cell <italic toggle="yes">i</italic> and <italic toggle="yes">l</italic><sub><italic toggle="yes">i</italic></sub> is the library size of cell <italic toggle="yes">i</italic>.</p>
      <p>Multiple comparison adjustment like Bonferroni correction or Benjamini–Hochberg procedure can be performed after testing all the candidate genes. Two options of NB regression are provided in our test. The first one is the general NB regression with variance being <inline-formula id="pcbi.1010025.e024"><alternatives><graphic xlink:href="pcbi.1010025.e024.jpg" id="pcbi.1010025.e024g" position="anchor"/><mml:math id="M24" display="inline" overflow="scroll"><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>, where <italic toggle="yes">μ</italic> is the mean and <italic toggle="yes">θ</italic> is the dispersion parameter. The value of <italic toggle="yes">θ</italic> in the Python implementation of NB regression will be truncated if it’s less than 0.5 or larger than 100. The second option is naïve NB regression where variance is equal to <italic toggle="yes">μ</italic>+<italic toggle="yes">μ</italic><sup>2</sup>. The second option is computationally more efficient without much loss of inference accuracy (<xref rid="pcbi.1010025.s016" ref-type="supplementary-material">S16 Fig</xref>).</p>
      <p>To assess the performance of our DEG test using the continuous usage variable, we simulated datasets following similar steps as described in the first section in Methods. The only difference was that instead of allowing different GEPs to have the same gene as their DEG, one gene could only appear as a DEG for one GEP. This simulation design was intentionally used to facilitate the assessment and model comparison.</p>
    </sec>
    <sec id="sec018">
      <title>Gene set enrichment analysis</title>
      <p>We performed gene set enrichment analysis for the upregulated DEGs identified in GEPs using hypergeometric tests. Gene sets including GO biological process [<xref rid="pcbi.1010025.ref064" ref-type="bibr">64</xref>,<xref rid="pcbi.1010025.ref065" ref-type="bibr">65</xref>] and Reactome [<xref rid="pcbi.1010025.ref066" ref-type="bibr">66</xref>] (version 7.4) were downloaded from the Molecular Signatures Database [<xref rid="pcbi.1010025.ref067" ref-type="bibr">67</xref>,<xref rid="pcbi.1010025.ref068" ref-type="bibr">68</xref>] (MSigDB). We tested for these two databases separately on each GEP and p values were adjusted by the Benjamini–Hochberg procedure. The cutoff for adjusted p-values was chose at 0.05.</p>
    </sec>
  </sec>
  <sec id="sec019" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1010025.s001" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>Selection of K in a simulated dataset.</title>
        <p>(a) Stability of usage, (b) stability of archetypes and (c) reconstruction loss across different Ks for four count distributions. (d) Distance matrix showing archetype stability under K = 2–5. The darker the color the smaller the distance. (e) Consensus clustering matrices showing the usage stability under K = 2–5. The warmer the color the large the similarity.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s002" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>Performance of scAAnet and other methods on synthetic scRNA-seq datasets in all settings.</title>
        <p>(a) Results from datasets that were simulated under NB distributions. (b) Results under ZINB distributions with <italic toggle="yes">λ</italic> = 0.3. (c) Results under ZINB distributions with <italic toggle="yes">λ</italic> = 0.1. (d) Results under ZINB distributions with <italic toggle="yes">λ</italic> = 0.01. For each panel, figures from left to right are MSE between inferred cell usages and true usages of the 4 GEPs, Pearson correlation between inferred GEPs and true GEPs, and MSE between reconstructed scaled means and true means. Each box and whisker plot was plotted based on ten simulated datasets. Central lines represent medians, boxes represent the IQR, and the upper/lower whisker represents the largest/smallest value no further than 1.5 × IQR. D.E.: differential expression.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s003" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>MDS interpolation visualization of archetypal space recovered from scAAnet.</title>
        <p>(a) scAAnet with MSE, (b) scAAnet with Poisson, (c) scAAnet with ZIP, and (d) scAAnet with NB distributions as the reconstruction error term. Red dots are the locations of archetypes. Figures in each column are colored by the true cell usage of the corresponding archetype (GEP).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s004" position="float" content-type="local-data">
      <label>S4 Fig</label>
      <caption>
        <title>Comparison of DEG test results between using continuous usages and discreate group assignment on synthetic scRNA-seq datasets.</title>
        <p>(a) Datasets were simulated under NB, (b) ZINB with <italic toggle="yes">λ</italic> = 0.3, (c) ZINB with <italic toggle="yes">λ</italic> = 0.1, and (d) ZINB with <italic toggle="yes">λ</italic> = 0.01. For each panel, figures from left to right are TPR at q-value &lt; 0.05 and FPR at q-value &lt; 0.05 calculated across different signal-to-noise ratio levels. Bonferroni correction was used to obtain q-values. Each box and whisker plot was plotted based on ten simulated datasets. Central lines represent medians, boxes represent the IQR, and the upper/lower whisker represents the largest/smallest value no further than 1.5 × IQR. TPR: true positive rate; FPR: false positive rate.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s005" position="float" content-type="local-data">
      <label>S5 Fig</label>
      <caption>
        <title>Selection of K in the pancreatic islet dataset.</title>
        <p>(a) Stability of usage, (b) stability of archetypes and (c) reconstruction loss across different Ks for four count distributions. (d) Consensus clustering matrices showing the usage stability under K = 8–12. The warmer the color the large the similarity.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s005.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s006" position="float" content-type="local-data">
      <label>S6 Fig</label>
      <caption>
        <title>MDS visualization of archetypal space in the pancreatic islet dataset.</title>
        <p>(a) MDS visualization colored by cell types. Locations of inferred archetypes are shown as black dots. (b) MDS visualization colored by the inferred usage of the ten GEPs. Locations of inferred archetypes are shown as red dots.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s007" position="float" content-type="local-data">
      <label>S7 Fig</label>
      <caption>
        <title>REACTOME enrichment results of the two GEPs related to beta cells in the pancreatic islet dataset.</title>
        <p>(a) Top enriched terms identified using significantly upregulated genes in GEP 2. (b) Top 10 enriched terms identified using significantly upregulated genes in GEP 7.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s007.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s008" position="float" content-type="local-data">
      <label>S8 Fig</label>
      <caption>
        <title>scAAnet is able to identify two GEPs using beta cells only that are similar to GEP 2 and GEP 7 identified in the pancreatic islet dataset.</title>
        <p>(a) The UMAP visualization of the pancreatic islet scRNA-seq dataset, with beta cells highlighted in red. Black dots are locations of cells that have the largest usage of the 2 GEPs (marked in Arabic numerals). (b) UMAPs colored by inferred cell usage for each GEP. (c) Heatmap showing the Pearson correlations among GEP 1 and GEP 2 identified using beta cells only and GEP 2 and GEP 7 identified using the entire dataset. (d) The top 10 enriched GO biological process terms using 35 significantly upregulated genes of GEP 1. (e) The top 10 enriched GO biological process terms using 130 significantly upregulated genes of GEP 2.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s008.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s009" position="float" content-type="local-data">
      <label>S9 Fig</label>
      <caption>
        <title>Selection of K in the lung fibroblast and myofibroblast cells.</title>
        <p>(a) Stability of usage, (b) stability of archetypes and (c) reconstruction loss across different Ks for four count distributions. (d) Consensus clustering matrices showing the usage stability under K = 2–5. The warmer the color the large the similarity.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s009.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s010" position="float" content-type="local-data">
      <label>S10 Fig</label>
      <caption>
        <title>MDS visualization of archetypal space in the lung fibroblast and myofibroblast cells.</title>
        <p>(a) MDS visualization colored by cell types. (b) MDS visualization colored by disease groups. Locations of inferred archetypes in a and b are shown as black dots. (c) MDS visualization colored by the inferred usage of the three GEPs. Locations of inferred archetypes are shown as red dots.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s010.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s011" position="float" content-type="local-data">
      <label>S11 Fig</label>
      <caption>
        <title>REACTOME enrichment results of the three GEPs in the lung fibroblast and myofibroblast cells.</title>
        <p>(a) Top enriched terms significantly upregulated genes in GEP 1, (b) GEP 2 and (c) GEP 3, respectively.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s011.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s012" position="float" content-type="local-data">
      <label>S12 Fig</label>
      <caption>
        <title>MDS visualization of archetypal space of microglial cells in the prefrontal cortex dataset.</title>
        <p>(a) MDS visualization colored by subclusters. (b) MDS visualization colored by AD pathology groups. (c) MDS visualization colored by sexes. Locations of inferred archetypes in a, b and c are shown as black dots. (d) MDS visualization colored by the inferred usage of the four GEPs. Locations of inferred archetypes are shown as red dots.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s012.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s013" position="float" content-type="local-data">
      <label>S13 Fig</label>
      <caption>
        <title>Sex and AD group differences in cell usage of 4 GEPs in each Microglia subcluster.</title>
        <p>Box and whisker plot of the usage of each GEP in cells of subcluster Mic0, Mic1, Mic2, and Mic3 (from top to bottom), colored by (a) AD pathology group and by (b) sex, respectively. Central lines represent medians, boxes represent the IQR, and whiskers represent the 5th and 95th quantiles.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s013.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s014" position="float" content-type="local-data">
      <label>S14 Fig</label>
      <caption>
        <title>Performance of scAAnet over increasing number of warm-up.</title>
        <p>(a) Cell usage inference performance. MSE between inferred usage and true usage was calculated. (b) GEP inference performance. Pearson correlations between inferred GEPs and true GEPs were calculated. For both a and b, red dashed lines are vertical lines plotted at the number of warm-up periods being 20. Ticks along x-axis are numbers of warm-up periods (0, 5, 10, 20, 30, 40, 50, 70, 100, 150, and 200). The total number of epochs was fixed at 200 in this experiment, so if the number of warm-up period is 200, it means <italic toggle="yes">Z</italic><sup><italic toggle="yes">fix</italic></sup> is not allowed to be trainable.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s014.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s015" position="float" content-type="local-data">
      <label>S15 Fig</label>
      <caption>
        <title>Dropout proportions of synthetic scRNA-seq datasets across different values of <italic toggle="yes">λ</italic> and mean D.E. log2 fold change of GEP-specific genes.</title>
        <p>Each box and whisker plot was plotted based on ten simulated datasets. Central lines represent medians, boxes represent the interquartile range (IQR), and the upper/lower whisker represents the largest/smallest value no further than 1.5 × IQR. D.E.: differential expression.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s015.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s016" position="float" content-type="local-data">
      <label>S16 Fig</label>
      <caption>
        <title>Comparison of DEG test results among different regression models on synthetic scRNA-seq datasets.</title>
        <p>(a) Datasets were simulated under NB, (b) ZINB with <italic toggle="yes">λ</italic> = 0.3, (c) ZINB with <italic toggle="yes">λ</italic> = 0.1, and (d) ZINB with <italic toggle="yes">λ</italic> = 0.01. For each panel, figures from left to right are TPR at q-value &lt; 0.05 and FPR at q-value &lt; 0.05 calculated across different signal-to-noise ratio levels. Bonferroni correction was used to obtain q-values. Each box and whisker plot was plotted based on ten simulated datasets. Central lines represent medians, boxes represent the IQR, and the upper/lower whisker represents the largest/smallest value no further than 1.5 × IQR. TPR: true positive rate; FPR: false positive rate; AUC: area under curve.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s016.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s017" position="float" content-type="local-data">
      <label>S17 Fig</label>
      <caption>
        <title>Influence of relative weight of the archetypal loss on scAAnet.</title>
        <p>(a) Change of the archetypal loss. (b) Change of the reconstruction loss. (c) Change of the total loss. (d) Performance on cell usage inference across different weights. (e) Performance on GEP inference across different weights. (f) Performance on reconstruction accuracy across different weights.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s017.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s018" position="float" content-type="local-data">
      <label>S18 Fig</label>
      <caption>
        <title>Robustness of scAAnet to misspecified K in a simulated dataset.</title>
        <p>(a) Correlation heatmap between pairs of archetypes inferred using K = 3 and K = 4 (left), and between inferred using K = 5 and K = 4 (right). (b) UMAPs colored by the inferred GEP usage. From top to bottom are results based on K being 3, 4, and 5, respectively. Orange arrows indicate the progression of GEPs as K increases.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s018.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s019" position="float" content-type="local-data">
      <label>S19 Fig</label>
      <caption>
        <title>Robustness of scAAnet to misspecified K across all simulation settings.</title>
        <p>Each bar represents a simulation setting where ten repeated experiments were run under different seeds. The percentage on the y-axis was calculated as the number of experiments where GEPs inferred under K = 3 constituted a perfect subset of GEPs inferred under K = 4 divided by ten. A perfect subset was defined as no overlaps among the GEPs inferred under K = 4 that had the largest correlations with the GEPs inferred under K = 3.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s019.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s020" position="float" content-type="local-data">
      <label>S20 Fig</label>
      <caption>
        <title>Performance of scAAnet and other methods on datasets simulated with no shared GEPs.</title>
        <p>(a) Results from datasets that were simulated under NB distributions. (b) Results under ZINB distributions with <italic toggle="yes">λ</italic> = 0.3. (c) Results under ZINB distributions with <italic toggle="yes">λ</italic> = 0.1. (d) Results under ZINB distributions with <italic toggle="yes">λ</italic> = 0.01. Other details are the same as <xref rid="pcbi.1010025.s002" ref-type="supplementary-material">S2 Fig</xref>.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s020.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s021" position="float" content-type="local-data">
      <label>S21 Fig</label>
      <caption>
        <title>scAAnet identified GEPs corresponding to milestones in simulated trajectory-based data.</title>
        <p>(a) Linear trajectory with three milestones colored by inferred GEP usage. (b) Bifurcation trajectory with four milestones colored by inferred GEP usage. Milestones are marked as black dots and backbone of the trajectory is shown in black curves.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s021.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s022" position="float" content-type="local-data">
      <label>S22 Fig</label>
      <caption>
        <title>UMAP visualization using NMF results on the pancreatic islet dataset.</title>
        <p>From left to right are UMAPs plotted using the top 35 PCs of the observed scRNA-seq data, using the inferred cell usage matrix, and using the reconstructed expression matrix. UMAPs are colored by 10 known cell clusters. Black dots are locations of cells that have the largest usage of the corresponding GEP (marked in Arabic numerals).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s022.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s023" position="float" content-type="local-data">
      <label>S23 Fig</label>
      <caption>
        <title>UMAP visualization using NMF results on microglial cells in the prefrontal cortex dataset.</title>
        <p>(a) UMAP colored by microglia subclusters. Black dots are locations of cells that have the largest usage of the corresponding GEP (marked in Arabic numerals). (b) UMAPs colored by the inferred usage of each GEP.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s023.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s024" position="float" content-type="local-data">
      <label>S24 Fig</label>
      <caption>
        <title>The level of sharing of GEPs in the real data.</title>
        <p>Barplots showing the distribution of the largest inferred usage across cells grouped by annotated clusters in the pancreas islet dataset (a), the lung fibroblasts and myofibroblasts (b), and the microglial cells (c).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s024.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s025" position="float" content-type="local-data">
      <label>S25 Fig</label>
      <caption>
        <title>The level of sparsity of inferred usage in the real data.</title>
        <p>Barplots showing the distribution of the smallest inferred usage across cells grouped by annotated clusters in the pancreas islet dataset (a), the lung fibroblasts and myofibroblasts (b), and the microglial cells (c).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s025.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s026" position="float" content-type="local-data">
      <label>S26 Fig</label>
      <caption>
        <title>Heatmaps of normalized gene scores of the top 20 DEGs across different GEPs.</title>
        <p>(a) In a simulated dataset, where top is from the true GEP matrix and bottom is from the inferred the GEP matrix (rearranged GEPs to match the order of true GEPs by Pearson correlation); (b) in the pancreatic islet dataset (where the bottom if a subset of the top figure without IAPP for a better resolution); (c) in the lung dataset; (d) in the prefrontal cortex dataset.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s026.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s027" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>Top genes identified in each GEP in the pancreatic islet dataset.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s027.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s028" position="float" content-type="local-data">
      <label>S2 Table</label>
      <caption>
        <title>Upregulated DEGs (adjusted p-value &lt; 0.05) of GEP 2 in the pancreatic islet dataset.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s028.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s029" position="float" content-type="local-data">
      <label>S3 Table</label>
      <caption>
        <title>Upregulated DEGs (adjusted p-value &lt; 0.05) of GEP 7 in the pancreatic islet dataset.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s029.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s030" position="float" content-type="local-data">
      <label>S4 Table</label>
      <caption>
        <title>Enriched GO terms of GEP 2 in the pancreatic islet dataset.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s030.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s031" position="float" content-type="local-data">
      <label>S5 Table</label>
      <caption>
        <title>Enriched GO terms of GEP 7 in the pancreatic islet dataset.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s031.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s032" position="float" content-type="local-data">
      <label>S6 Table</label>
      <caption>
        <title>Enriched Reactome terms of GEP 2 in the pancreatic islet dataset.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s032.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s033" position="float" content-type="local-data">
      <label>S7 Table</label>
      <caption>
        <title>Enriched Reactome terms of GEP 7 in the pancreatic islet dataset.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s033.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s034" position="float" content-type="local-data">
      <label>S8 Table</label>
      <caption>
        <title>Upregulated DEGs (adjusted p-value &lt; 0.05) of GEP 1 identified only using beta cells in the pancreatic islet dataset.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s034.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s035" position="float" content-type="local-data">
      <label>S9 Table</label>
      <caption>
        <title>Upregulated DEGs (adjusted p-value &lt; 0.05) of GEP 2 identified only using beta cells in the pancreatic islet dataset.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s035.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s036" position="float" content-type="local-data">
      <label>S10 Table</label>
      <caption>
        <title>Top genes identified in each GEP in lung fibroblasts and myofibroblasts.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s036.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s037" position="float" content-type="local-data">
      <label>S11 Table</label>
      <caption>
        <title>Upregulated DEGs (adjusted p-value &lt; 0.05) of GEP 1 in lung fibroblasts and myofibroblasts.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s037.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s038" position="float" content-type="local-data">
      <label>S12 Table</label>
      <caption>
        <title>Upregulated DEGs (adjusted p-value &lt; 0.05) of GEP 2 in lung fibroblasts and myofibroblasts.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s038.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s039" position="float" content-type="local-data">
      <label>S13 Table</label>
      <caption>
        <title>Upregulated DEGs (adjusted p-value &lt; 0.05) of GEP 3 in lung fibroblasts and myofibroblasts.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s039.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s040" position="float" content-type="local-data">
      <label>S14 Table</label>
      <caption>
        <title>Enriched GO terms of GEP 1 in lung fibroblasts and myofibroblasts.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s040.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s041" position="float" content-type="local-data">
      <label>S15 Table</label>
      <caption>
        <title>Enriched GO terms of GEP 2 in lung fibroblasts and myofibroblasts.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s041.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s042" position="float" content-type="local-data">
      <label>S16 Table</label>
      <caption>
        <title>Enriched GO terms of GEP 3 in the lung fibroblasts and myofibroblasts.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s042.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s043" position="float" content-type="local-data">
      <label>S17 Table</label>
      <caption>
        <title>Enriched Reactome terms of GEP 1 in lung fibroblasts and myofibroblasts.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s043.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s044" position="float" content-type="local-data">
      <label>S18 Table</label>
      <caption>
        <title>Enriched Reactome terms of GEP 2 in lung fibroblasts and myofibroblasts.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s044.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s045" position="float" content-type="local-data">
      <label>S19 Table</label>
      <caption>
        <title>Enriched Reactome terms of GEP 3 in the lung fibroblasts and myofibroblasts.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s045.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s046" position="float" content-type="local-data">
      <label>S20 Table</label>
      <caption>
        <title>Upregulated DEGs (adjusted p-value &lt; 0.05) of GEP 1 in the microglia of the prefrontal cortex dataset.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s046.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s047" position="float" content-type="local-data">
      <label>S21 Table</label>
      <caption>
        <title>Upregulated DEGs (adjusted p-value &lt; 0.05) of GEP 2 in the microglia of the prefrontal cortex dataset.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s047.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s048" position="float" content-type="local-data">
      <label>S22 Table</label>
      <caption>
        <title>Upregulated DEGs (adjusted p-value &lt; 0.05) of GEP 3 in the microglia of the prefrontal cortex dataset.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s048.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s049" position="float" content-type="local-data">
      <label>S23 Table</label>
      <caption>
        <title>Upregulated DEGs (adjusted p-value &lt; 0.05) of GEP 4 in the microglia of the prefrontal cortex dataset.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s049.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s050" position="float" content-type="local-data">
      <label>S24 Table</label>
      <caption>
        <title>Enrichment of GEP-specific DEGs across sets of makers of the four microglia subclusters.</title>
        <p>For each GEP, microglia subcluster with the lowest p-value is highlighted in red.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s050.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s051" position="float" content-type="local-data">
      <label>S25 Table</label>
      <caption>
        <title>Enriched GO terms of GEP 2 in the microglia of the prefrontal cortex dataset.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s051.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s052" position="float" content-type="local-data">
      <label>S26 Table</label>
      <caption>
        <title>Enriched GO terms of GEP 3 in the microglia of the prefrontal cortex dataset.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s052.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s053" position="float" content-type="local-data">
      <label>S27 Table</label>
      <caption>
        <title>Enriched GO terms of GEP 4 in the microglia of the prefrontal cortex dataset.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s053.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s054" position="float" content-type="local-data">
      <label>S1 Text</label>
      <caption>
        <title>Supplementary notes for methods and additional results.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s054.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010025.s055" position="float" content-type="local-data">
      <label>S1 Data</label>
      <caption>
        <title>Supplementary data of numerical values underlying main figures.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1010025.s055.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1010025.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Tammela</surname><given-names>T</given-names></name>, <name><surname>Sage</surname><given-names>J</given-names></name>. <article-title>Investigating tumor heterogeneity in mouse models</article-title>. <source>Annual Review of Cancer Biology</source>. <year>2020</year>;<volume>4</volume>:<fpage>99</fpage>–<lpage>119</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1146/annurev-cancerbio-030419-033413</pub-id><?supplied-pmid 34164589?><pub-id pub-id-type="pmid">34164589</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Azizi</surname><given-names>E</given-names></name>, <name><surname>Carr</surname><given-names>AJ</given-names></name>, <name><surname>Plitas</surname><given-names>G</given-names></name>, <name><surname>Cornish</surname><given-names>AE</given-names></name>, <name><surname>Konopacki</surname><given-names>C</given-names></name>, <name><surname>Prabhakaran</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Single-cell map of diverse immune phenotypes in the breast tumor microenvironment</article-title>. <source>Cell</source>. <year>2018</year>;<volume>174</volume>(<issue>5</issue>):<fpage>1293</fpage>–<lpage>308. e36</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2018.05.060</pub-id><?supplied-pmid 29961579?><pub-id pub-id-type="pmid">29961579</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Kotliar</surname><given-names>D</given-names></name>, <name><surname>Veres</surname><given-names>A</given-names></name>, <name><surname>Nagy</surname><given-names>MA</given-names></name>, <name><surname>Tabrizi</surname><given-names>S</given-names></name>, <name><surname>Hodis</surname><given-names>E</given-names></name>, <name><surname>Melton</surname><given-names>DA</given-names></name>, <etal>et al</etal>. <article-title>Identifying gene expression programs of cell-type identity and cellular activity with single-cell RNA-Seq</article-title>. <source>Elife</source>. <year>2019</year>;<volume>8</volume>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7554/eLife.43803</pub-id><?supplied-pmid 31282856?><pub-id pub-id-type="pmid">31282856</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Cutler</surname><given-names>A</given-names></name>, <name><surname>Breiman</surname><given-names>L</given-names></name>. <article-title>Archetypal Analysis</article-title>. <source>Technometrics</source>. <year>1994</year>;<volume>36</volume>(<issue>4</issue>):<fpage>338</fpage>–<lpage>47</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Mørup</surname><given-names>M</given-names></name>, <name><surname>Hansen</surname><given-names>LK</given-names></name>. <article-title>Archetypal analysis for machine learning and data mining</article-title>. <source>Neurocomputing</source>. <year>2012</year>;<volume>80</volume>:<fpage>54</fpage>–<lpage>63</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Csáji</surname><given-names>BC</given-names></name>. <article-title>Approximation with artificial neural networks</article-title>. <source>Faculty of Sciences, Etvs Lornd University, Hungary</source>. <year>2001</year>;<volume>24</volume>(<issue>48</issue>):<fpage>7</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref007">
      <label>7</label>
      <mixed-citation publication-type="book"><name><surname>Nielsen</surname><given-names>MA</given-names></name>. <source>Neural networks and deep learning:</source><publisher-name>Determination press</publisher-name><publisher-loc>San Francisco, CA</publisher-loc>; <year>2015</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Kramer</surname><given-names>MA</given-names></name>. <article-title>Nonlinear principal component analysis using autoassociative neural networks</article-title>. <source>AIChE journal</source>. <year>1991</year>;<volume>37</volume>(<issue>2</issue>):<fpage>233</fpage>–<lpage>43</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref009">
      <label>9</label>
      <mixed-citation publication-type="book"><name><surname>van Dijk</surname><given-names>D</given-names></name>, <name><surname>Burkhardt</surname><given-names>DB</given-names></name>, <name><surname>Amodio</surname><given-names>M</given-names></name>, <name><surname>Tong</surname><given-names>A</given-names></name>, <name><surname>Wolf</surname><given-names>G</given-names></name>, <name><surname>Krishnaswamy</surname><given-names>S</given-names></name>, editors. <part-title>Finding archetypal spaces using neural networks</part-title>. <source>2019 IEEE International Conference on Big Data (Big Data)</source>; <year>2019</year>: <publisher-name>IEEE</publisher-name>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Keller</surname><given-names>SM</given-names></name>, <name><surname>Samarin</surname><given-names>M</given-names></name>, <name><surname>Torres</surname><given-names>FA</given-names></name>, <name><surname>Wieser</surname><given-names>M</given-names></name>, <name><surname>Roth</surname><given-names>V</given-names></name>. <article-title>Learning extremal representations with deep archetypal analysis</article-title>. <source>International Journal of Computer Vision</source>. <year>2021</year>;<volume>129</volume>(<issue>4</issue>):<fpage>805</fpage>–<lpage>20</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s11263-020-01390-3</pub-id><?supplied-pmid 34720403?><pub-id pub-id-type="pmid">34720403</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Lopez</surname><given-names>R</given-names></name>, <name><surname>Regier</surname><given-names>J</given-names></name>, <name><surname>Cole</surname><given-names>MB</given-names></name>, <name><surname>Jordan</surname><given-names>MI</given-names></name>, <name><surname>Yosef</surname><given-names>N</given-names></name>. <article-title>Deep generative modeling for single-cell transcriptomics</article-title>. <source>Nat Methods</source>. <year>2018</year>;<volume>15</volume>(<issue>12</issue>):<fpage>1053</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41592-018-0229-2</pub-id><?supplied-pmid 30504886?><pub-id pub-id-type="pmid">30504886</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Eraslan</surname><given-names>G</given-names></name>, <name><surname>Simon</surname><given-names>LM</given-names></name>, <name><surname>Mircea</surname><given-names>M</given-names></name>, <name><surname>Mueller</surname><given-names>NS</given-names></name>, <name><surname>Theis</surname><given-names>FJ</given-names></name>. <article-title>Single-cell RNA-seq denoising using a deep count autoencoder</article-title>. <source>Nat Commun</source>. <year>2019</year>;<volume>10</volume>(<issue>1</issue>):<fpage>390</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-018-07931-2</pub-id><?supplied-pmid 30674886?><pub-id pub-id-type="pmid">30674886</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Baron</surname><given-names>M</given-names></name>, <name><surname>Veres</surname><given-names>A</given-names></name>, <name><surname>Wolock</surname><given-names>SL</given-names></name>, <name><surname>Faust</surname><given-names>AL</given-names></name>, <name><surname>Gaujoux</surname><given-names>R</given-names></name>, <name><surname>Vetere</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter-and intra-cell population structure</article-title>. <source>Cell systems</source>. <year>2016</year>;<volume>3</volume>(<issue>4</issue>):<fpage>346</fpage>–<lpage>60. e4</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cels.2016.08.011</pub-id><?supplied-pmid 27667365?><pub-id pub-id-type="pmid">27667365</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Adams</surname><given-names>TS</given-names></name>, <name><surname>Schupp</surname><given-names>JC</given-names></name>, <name><surname>Poli</surname><given-names>S</given-names></name>, <name><surname>Ayaub</surname><given-names>EA</given-names></name>, <name><surname>Neumark</surname><given-names>N</given-names></name>, <name><surname>Ahangari</surname><given-names>F</given-names></name>, <etal>et al</etal>. <article-title>Single-cell RNA-seq reveals ectopic and aberrant lung-resident cell populations in idiopathic pulmonary fibrosis</article-title>. <source>Science advances</source>. <year>2020</year>;<volume>6</volume>(<issue>28</issue>):<fpage>eaba1983</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/sciadv.aba1983</pub-id><?supplied-pmid 32832599?><pub-id pub-id-type="pmid">32832599</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Mathys</surname><given-names>H</given-names></name>, <name><surname>Davila-Velderrain</surname><given-names>J</given-names></name>, <name><surname>Peng</surname><given-names>Z</given-names></name>, <name><surname>Gao</surname><given-names>F</given-names></name>, <name><surname>Mohammadi</surname><given-names>S</given-names></name>, <name><surname>Young</surname><given-names>JZ</given-names></name>, <etal>et al</etal>. <article-title>Single-cell transcriptomic analysis of Alzheimer’s disease</article-title>. <source>Nature</source>. <year>2019</year>;<volume>570</volume>(<issue>7761</issue>):<fpage>332</fpage>–<lpage>7</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41586-019-1195-2</pub-id><?supplied-pmid 31042697?><pub-id pub-id-type="pmid">31042697</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Zappia</surname><given-names>L</given-names></name>, <name><surname>Phipson</surname><given-names>B</given-names></name>, <name><surname>Oshlack</surname><given-names>A</given-names></name>. <article-title>Splatter: simulation of single-cell RNA sequencing data</article-title>. <source>Genome biology</source>. <year>2017</year>;<volume>18</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>15</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-016-1139-1</pub-id><?supplied-pmid 28077169?><pub-id pub-id-type="pmid">28077169</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>DD</given-names></name>, <name><surname>Seung</surname><given-names>HS</given-names></name>. <article-title>Learning the parts of objects by non-negative matrix factorization</article-title>. <source>Nature</source>. <year>1999</year>;<volume>401</volume>(<issue>6755</issue>):<fpage>788</fpage>–<lpage>91</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/44565</pub-id><?supplied-pmid 10548103?><pub-id pub-id-type="pmid">10548103</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Svensson</surname><given-names>V</given-names></name>, <name><surname>Gayoso</surname><given-names>A</given-names></name>, <name><surname>Yosef</surname><given-names>N</given-names></name>, <name><surname>Pachter</surname><given-names>L</given-names></name>. <article-title>Interpretable factor models of single-cell RNA-seq via variational autoencoders</article-title>. <source>Bioinformatics</source>. <year>2020</year>;<volume>36</volume>(<issue>11</issue>):<fpage>3418</fpage>–<lpage>21</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btaa169</pub-id><?supplied-pmid 32176273?><pub-id pub-id-type="pmid">32176273</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>J</given-names></name>, <name><surname>Klughammer</surname><given-names>J</given-names></name>, <name><surname>Farlik</surname><given-names>M</given-names></name>, <name><surname>Penz</surname><given-names>T</given-names></name>, <name><surname>Spittler</surname><given-names>A</given-names></name>, <name><surname>Barbieux</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Single-cell transcriptomes reveal characteristic features of human pancreatic islet cell types</article-title>. <source>EMBO reports</source>. <year>2016</year>;<volume>17</volume>(<issue>2</issue>):<fpage>178</fpage>–<lpage>87</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.15252/embr.201540946</pub-id><?supplied-pmid 26691212?><pub-id pub-id-type="pmid">26691212</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>YJ</given-names></name>, <name><surname>Schug</surname><given-names>J</given-names></name>, <name><surname>Won</surname><given-names>K-J</given-names></name>, <name><surname>Liu</surname><given-names>C</given-names></name>, <name><surname>Naji</surname><given-names>A</given-names></name>, <name><surname>Avrahami</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Single-cell transcriptomics of the human endocrine pancreas</article-title>. <source>Diabetes</source>. <year>2016</year>;<volume>65</volume>(<issue>10</issue>):<fpage>3028</fpage>–<lpage>38</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.2337/db16-0405</pub-id><?supplied-pmid 27364731?><pub-id pub-id-type="pmid">27364731</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Qadir</surname><given-names>MMF</given-names></name>, <name><surname>Álvarez-Cubela</surname><given-names>S</given-names></name>, <name><surname>Klein</surname><given-names>D</given-names></name>, <name><surname>van Dijk</surname><given-names>J</given-names></name>, <name><surname>Muñiz-Anquela</surname><given-names>R</given-names></name>, <name><surname>Moreno-Hernández</surname><given-names>YB</given-names></name>, <etal>et al</etal>. <article-title>Single-cell resolution analysis of the human pancreatic ductal progenitor cell niche</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2020</year>;<volume>117</volume>(<issue>20</issue>):<fpage>10876</fpage>–<lpage>87</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1918314117</pub-id><?supplied-pmid 32354994?><pub-id pub-id-type="pmid">32354994</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Pinzani</surname><given-names>M.</given-names></name><article-title>PDGF and signal transduction in hepatic stellate cells</article-title>. <source>Front Biosci</source>. <year>2002</year>;<volume>7</volume>(<issue>d1720-d1</issue>):<fpage>2002</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.2741/A875</pub-id><?supplied-pmid 12133817?><pub-id pub-id-type="pmid">12133817</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Reininger</surname><given-names>A.</given-names></name><article-title>Function of von Willebrand factor in haemostasis and thrombosis</article-title>. <source>Haemophilia</source>. <year>2008</year>;<volume>14</volume>:<fpage>11</fpage>–<lpage>26</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/j.1365-2516.2008.01848.x</pub-id><?supplied-pmid 18786007?><pub-id pub-id-type="pmid">18786007</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Sharma</surname><given-names>RB</given-names></name>, <name><surname>O’Donnell</surname><given-names>AC</given-names></name>, <name><surname>Stamateris</surname><given-names>RE</given-names></name>, <name><surname>Ha</surname><given-names>B</given-names></name>, <name><surname>McCloskey</surname><given-names>KM</given-names></name>, <name><surname>Reynolds</surname><given-names>PR</given-names></name>, <etal>et al</etal>. <article-title>Insulin demand regulates β cell number via the unfolded protein response</article-title>. <source>The Journal of clinical investigation</source>. <year>2015</year>;<volume>125</volume>(<issue>10</issue>):<fpage>3831</fpage>–<lpage>46</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1172/JCI79264</pub-id><?supplied-pmid 26389675?><pub-id pub-id-type="pmid">26389675</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Lederer</surname><given-names>DJ</given-names></name>, <name><surname>Martinez</surname><given-names>FJ</given-names></name>. <article-title>Idiopathic pulmonary fibrosis</article-title>. <source>New England Journal of Medicine</source>. <year>2018</year>;<volume>378</volume>(<issue>19</issue>):<fpage>1811</fpage>–<lpage>23</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Moore</surname><given-names>MW</given-names></name>, <name><surname>Herzog</surname><given-names>EL</given-names></name>. <article-title>Regulation and relevance of myofibroblast responses in idiopathic pulmonary fibrosis</article-title>. <source>Current pathobiology reports</source>. <year>2013</year>;<volume>1</volume>(<issue>3</issue>):<fpage>199</fpage>–<lpage>208</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s40139-013-0017-8</pub-id><?supplied-pmid 25705577?><pub-id pub-id-type="pmid">25705577</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Pardo</surname><given-names>A</given-names></name>, <name><surname>Selman</surname><given-names>M</given-names></name>. <article-title>Lung fibroblasts, aging, and idiopathic pulmonary fibrosis.</article-title><source>Annals of the American Thoracic Society</source>. <year>2016</year>;<volume>13</volume>(<issue>Supplement 5</issue>):<fpage>S417</fpage>–<lpage>S21</lpage>.<pub-id pub-id-type="pmid">28005427</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Singhmar</surname><given-names>P</given-names></name>, <name><surname>Ma</surname><given-names>J</given-names></name>, <name><surname>Huo</surname><given-names>X</given-names></name>, <name><surname>Peng</surname><given-names>B</given-names></name>, <name><surname>Heijnen</surname><given-names>CJ</given-names></name>, <name><surname>Kavelaars</surname><given-names>A</given-names></name>. <article-title>The fibroblast-derived protein PI16 controls neuropathic pain</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2020</year>;<volume>117</volume>(<issue>10</issue>):<fpage>5463</fpage>–<lpage>71</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1913444117</pub-id><?supplied-pmid 32079726?><pub-id pub-id-type="pmid">32079726</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Green</surname><given-names>J</given-names></name>, <name><surname>Endale</surname><given-names>M</given-names></name>, <name><surname>Auer</surname><given-names>H</given-names></name>, <name><surname>Perl</surname><given-names>A-KT</given-names></name>. <article-title>Diversity of interstitial lung fibroblasts is regulated by platelet-derived growth factor receptor α kinase activity</article-title>. <source>American journal of respiratory cell and molecular biology</source>. <year>2016</year>;<volume>54</volume>(<issue>4</issue>):<fpage>532</fpage>–<lpage>45</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1165/rcmb.2015-0095OC</pub-id><?supplied-pmid 26414960?><pub-id pub-id-type="pmid">26414960</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Zeisberg</surname><given-names>M</given-names></name>, <name><surname>Neilson</surname><given-names>EG</given-names></name>. <article-title>Biomarkers for epithelial-mesenchymal transitions</article-title>. <source>The Journal of clinical investigation</source>. <year>2009</year>;<volume>119</volume>(<issue>6</issue>):<fpage>1429</fpage>–<lpage>37</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1172/JCI36183</pub-id><?supplied-pmid 19487819?><pub-id pub-id-type="pmid">19487819</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Masters</surname><given-names>CL</given-names></name>, <name><surname>Bateman</surname><given-names>R</given-names></name>, <name><surname>Blennow</surname><given-names>K</given-names></name>, <name><surname>Rowe</surname><given-names>CC</given-names></name>, <name><surname>Sperling</surname><given-names>RA</given-names></name>, <name><surname>Cummings</surname><given-names>JL</given-names></name>. <article-title>Alzheimer’s disease.</article-title><source>Nature Reviews Disease Primers</source>. <year>2015</year>;<volume>1</volume>(<issue>1</issue>):<fpage>15056</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Heneka</surname><given-names>MT</given-names></name>, <name><surname>Carson</surname><given-names>MJ</given-names></name>, <name><surname>El Khoury</surname><given-names>J</given-names></name>, <name><surname>Landreth</surname><given-names>GE</given-names></name>, <name><surname>Brosseron</surname><given-names>F</given-names></name>, <name><surname>Feinstein</surname><given-names>DL</given-names></name>, <etal>et al</etal>. <article-title>Neuroinflammation in Alzheimer’s disease</article-title>. <source>The Lancet Neurology</source>. <year>2015</year>;<volume>14</volume>(<issue>4</issue>):<fpage>388</fpage>–<lpage>405</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/S1474-4422(15)70016-5</pub-id><?supplied-pmid 25792098?><pub-id pub-id-type="pmid">25792098</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Ding</surname><given-names>Q</given-names></name>, <name><surname>Markesbery</surname><given-names>WR</given-names></name>, <name><surname>Chen</surname><given-names>Q</given-names></name>, <name><surname>Li</surname><given-names>F</given-names></name>, <name><surname>Keller</surname><given-names>JN</given-names></name>. <article-title>Ribosome dysfunction is an early event in Alzheimer’s disease</article-title>. <source>Journal of Neuroscience</source>. <year>2005</year>;<volume>25</volume>(<issue>40</issue>):<fpage>9171</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3040-05.2005</pub-id><?supplied-pmid 16207876?><pub-id pub-id-type="pmid">16207876</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Kim</surname><given-names>J</given-names></name>, <name><surname>Basak</surname><given-names>JM</given-names></name>, <name><surname>Holtzman</surname><given-names>DM</given-names></name>. <article-title>The role of apolipoprotein E in Alzheimer’s disease</article-title>. <source>Neuron</source>. <year>2009</year>;<volume>63</volume>(<issue>3</issue>):<fpage>287</fpage>–<lpage>303</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.neuron.2009.06.026</pub-id><?supplied-pmid 19679070?><pub-id pub-id-type="pmid">19679070</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Yamazaki</surname><given-names>Y</given-names></name>, <name><surname>Zhao</surname><given-names>N</given-names></name>, <name><surname>Caulfield</surname><given-names>TR</given-names></name>, <name><surname>Liu</surname><given-names>C-C</given-names></name>, <name><surname>Bu</surname><given-names>G</given-names></name>. <article-title>Apolipoprotein E and Alzheimer disease: pathobiology and targeting strategies</article-title>. <source>Nature Reviews Neurology</source>. <year>2019</year>;<volume>15</volume>(<issue>9</issue>):<fpage>501</fpage>–<lpage>18</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41582-019-0228-7</pub-id><?supplied-pmid 31367008?><pub-id pub-id-type="pmid">31367008</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Tsuyuzaki</surname><given-names>K</given-names></name>, <name><surname>Sato</surname><given-names>H</given-names></name>, <name><surname>Sato</surname><given-names>K</given-names></name>, <name><surname>Nikaido</surname><given-names>I</given-names></name>. <article-title>Benchmarking principal component analysis for large-scale single-cell RNA-sequencing</article-title>. <source>Genome biology</source>. <year>2020</year>;<volume>21</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>17</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-019-1900-3</pub-id><?supplied-pmid 31955711?><pub-id pub-id-type="pmid">31955711</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref037">
      <label>37</label>
      <mixed-citation publication-type="book"><name><surname>Blei</surname><given-names>DM</given-names></name>, <name><surname>Lafferty</surname><given-names>JD</given-names></name>. <part-title>Topic models</part-title>. <source>Text mining</source>: <publisher-name>Chapman and Hall/CRC</publisher-name>; <year>2009</year>. p. <fpage>101</fpage>–<lpage>24</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Blei</surname><given-names>DM</given-names></name>. <article-title>Probabilistic topic models</article-title>. <source>Communications of the ACM</source>. <year>2012</year>;<volume>55</volume>(<issue>4</issue>):<fpage>77</fpage>–<lpage>84</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref039">
      <label>39</label>
      <mixed-citation publication-type="other">Hofmann T, editor Probabilistic latent semantic indexing. Proceedings of the 22nd annual international ACM SIGIR conference on Research and development in information retrieval; 1999.</mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Blei</surname><given-names>DM</given-names></name>, <name><surname>Ng</surname><given-names>AY</given-names></name>, <name><surname>Jordan</surname><given-names>MI</given-names></name>. <article-title>Latent dirichlet allocation</article-title>. <source>the Journal of machine Learning research</source>. <year>2003</year>;<volume>3</volume>:<fpage>993</fpage>–<lpage>1022</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Volchuk</surname><given-names>A</given-names></name>, <name><surname>Ron</surname><given-names>D</given-names></name>. <article-title>The endoplasmic reticulum stress response in the pancreatic β-cell.</article-title><source>Diabetes, Obesity and Metabolism</source>. <year>2010</year>;<volume>12</volume>:<fpage>48</fpage>–<lpage>57</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/j.1463-1326.2010.01271.x</pub-id><?supplied-pmid 21029300?><pub-id pub-id-type="pmid">21029300</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Raghu</surname><given-names>G</given-names></name>, <name><surname>Striker</surname><given-names>LJ</given-names></name>, <name><surname>Hudson</surname><given-names>LD</given-names></name>, <name><surname>Striker</surname><given-names>GE</given-names></name>. <article-title>Extracellular matrix in normal and fibrotic human lungs</article-title>. <source>American Review of Respiratory Disease</source>. <year>1985</year>;<volume>131</volume>(<issue>2</issue>):<fpage>281</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1164/arrd.1985.131.2.281</pub-id><?supplied-pmid 3882034?><pub-id pub-id-type="pmid">3882034</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Kuhn</surname><given-names>C</given-names></name>, <name><surname>McDonald</surname><given-names>J</given-names></name>. <article-title>The roles of the myofibroblast in idiopathic pulmonary fibrosis. Ultrastructural and immunohistochemical features of sites of active extracellular matrix synthesis</article-title>. <source>The American journal of pathology</source>. <year>1991</year>;<volume>138</volume>(<issue>5</issue>):<fpage>1257</fpage>. <?supplied-pmid 2024710?><pub-id pub-id-type="pmid">2024710</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Peterson</surname><given-names>VM</given-names></name>, <name><surname>Zhang</surname><given-names>KX</given-names></name>, <name><surname>Kumar</surname><given-names>N</given-names></name>, <name><surname>Wong</surname><given-names>J</given-names></name>, <name><surname>Li</surname><given-names>L</given-names></name>, <name><surname>Wilson</surname><given-names>DC</given-names></name>, <etal>et al</etal>. <article-title>Multiplexed quantification of proteins and transcripts in single cells</article-title>. <source>Nature biotechnology</source>. <year>2017</year>;<volume>35</volume>(<issue>10</issue>):<fpage>936</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.3973</pub-id><?supplied-pmid 28854175?><pub-id pub-id-type="pmid">28854175</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Stoeckius</surname><given-names>M</given-names></name>, <name><surname>Hafemeister</surname><given-names>C</given-names></name>, <name><surname>Stephenson</surname><given-names>W</given-names></name>, <name><surname>Houck-Loomis</surname><given-names>B</given-names></name>, <name><surname>Chattopadhyay</surname><given-names>PK</given-names></name>, <name><surname>Swerdlow</surname><given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Simultaneous epitope and transcriptome measurement in single cells</article-title>. <source>Nature methods</source>. <year>2017</year>;<volume>14</volume>(<issue>9</issue>):<fpage>865</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nmeth.4380</pub-id><?supplied-pmid 28759029?><pub-id pub-id-type="pmid">28759029</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Cao</surname><given-names>J</given-names></name>, <name><surname>Cusanovich</surname><given-names>DA</given-names></name>, <name><surname>Ramani</surname><given-names>V</given-names></name>, <name><surname>Aghamirzaie</surname><given-names>D</given-names></name>, <name><surname>Pliner</surname><given-names>HA</given-names></name>, <name><surname>Hill</surname><given-names>AJ</given-names></name>, <etal>et al</etal>. <article-title>Joint profiling of chromatin accessibility and gene expression in thousands of single cells</article-title>. <source>Science</source>. <year>2018</year>;<volume>361</volume>(<issue>6409</issue>):<fpage>1380</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.aau0730</pub-id><?supplied-pmid 30166440?><pub-id pub-id-type="pmid">30166440</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>S</given-names></name>, <name><surname>Lake</surname><given-names>BB</given-names></name>, <name><surname>Zhang</surname><given-names>K</given-names></name>. <article-title>High-throughput sequencing of the transcriptome and chromatin accessibility in the same cell</article-title>. <source>Nature biotechnology</source>. <year>2019</year>;<volume>37</volume>(<issue>12</issue>):<fpage>1452</fpage>–<lpage>7</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41587-019-0290-0</pub-id><?supplied-pmid 31611697?><pub-id pub-id-type="pmid">31611697</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Ma</surname><given-names>S</given-names></name>, <name><surname>Zhang</surname><given-names>B</given-names></name>, <name><surname>LaFave</surname><given-names>LM</given-names></name>, <name><surname>Earl</surname><given-names>AS</given-names></name>, <name><surname>Chiang</surname><given-names>Z</given-names></name>, <name><surname>Hu</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Chromatin potential identified by shared single-cell profiling of RNA and chromatin</article-title>. <source>Cell</source>. <year>2020</year>;<volume>183</volume>(<issue>4</issue>):<fpage>1103</fpage>–<lpage>16. e20</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2020.09.056</pub-id><?supplied-pmid 33098772?><pub-id pub-id-type="pmid">33098772</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Saelens</surname><given-names>W</given-names></name>, <name><surname>Cannoodt</surname><given-names>R</given-names></name>, <name><surname>Todorov</surname><given-names>H</given-names></name>, <name><surname>Saeys</surname><given-names>Y</given-names></name>. <article-title>A comparison of single-cell trajectory inference methods</article-title>. <source>Nature biotechnology</source>. <year>2019</year>;<volume>37</volume>(<issue>5</issue>):<fpage>547</fpage>–<lpage>54</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41587-019-0071-9</pub-id><?supplied-pmid 30936559?><pub-id pub-id-type="pmid">30936559</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref050">
      <label>50</label>
      <mixed-citation publication-type="book"><name><surname>Hinton</surname><given-names>G</given-names></name>, <name><surname>Roweis</surname><given-names>ST</given-names></name>, editors. <source>Stochastic neighbor embedding</source>. <publisher-name>NIPS</publisher-name>; <year>2002</year>: Citeseer.</mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Van der Maaten</surname><given-names>L</given-names></name>, <name><surname>Hinton</surname><given-names>G</given-names></name>. <article-title>Visualizing data using t-SNE</article-title>. <source>Journal of machine learning research</source>. <year>2008</year>;<volume>9</volume>(<issue>11</issue>).</mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>McInnes</surname><given-names>L</given-names></name>, <name><surname>Healy</surname><given-names>J</given-names></name>, <name><surname>Melville</surname><given-names>J</given-names></name>. <article-title>Umap: Uniform manifold approximation and projection for dimension reduction</article-title>. <source>arXiv preprint</source> arXiv:180203426. <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Becht</surname><given-names>E</given-names></name>, <name><surname>McInnes</surname><given-names>L</given-names></name>, <name><surname>Healy</surname><given-names>J</given-names></name>, <name><surname>Dutertre</surname><given-names>C-A</given-names></name>, <name><surname>Kwok</surname><given-names>IW</given-names></name>, <name><surname>Ng</surname><given-names>LG</given-names></name>, <etal>et al</etal>. <article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title>. <source>Nature biotechnology</source>. <year>2019</year>;<volume>37</volume>(<issue>1</issue>):<fpage>38</fpage>–<lpage>44</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Quadrato</surname><given-names>G</given-names></name>, <name><surname>Nguyen</surname><given-names>T</given-names></name>, <name><surname>Macosko</surname><given-names>EZ</given-names></name>, <name><surname>Sherwood</surname><given-names>JL</given-names></name>, <name><surname>Yang</surname><given-names>SM</given-names></name>, <name><surname>Berger</surname><given-names>DR</given-names></name>, <etal>et al</etal>. <article-title>Cell diversity and network dynamics in photosensitive human brain organoids</article-title>. <source>Nature</source>. <year>2017</year>;<volume>545</volume>(<issue>7652</issue>):<fpage>48</fpage>–<lpage>53</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature22047</pub-id><?supplied-pmid 28445462?><pub-id pub-id-type="pmid">28445462</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Pierson</surname><given-names>E</given-names></name>, <name><surname>Yau</surname><given-names>C</given-names></name>. <article-title>ZIFA: Dimensionality reduction for zero-inflated single-cell gene expression analysis</article-title>. <source>Genome biology</source>. <year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>10</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-015-0805-z</pub-id><?supplied-pmid 26527291?><pub-id pub-id-type="pmid">25583448</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Wolf</surname><given-names>FA</given-names></name>, <name><surname>Angerer</surname><given-names>P</given-names></name>, <name><surname>Theis</surname><given-names>FJ</given-names></name>. <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome biology</source>. <year>2018</year>;<volume>19</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-017-1381-1</pub-id><?supplied-pmid 29301551?><pub-id pub-id-type="pmid">29301551</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Satija</surname><given-names>R</given-names></name>, <name><surname>Farrell</surname><given-names>JA</given-names></name>, <name><surname>Gennert</surname><given-names>D</given-names></name>, <name><surname>Schier</surname><given-names>AF</given-names></name>, <name><surname>Regev</surname><given-names>A</given-names></name>. <article-title>Spatial reconstruction of single-cell gene expression data</article-title>. <source>Nature biotechnology</source>. <year>2015</year>;<volume>33</volume>(<issue>5</issue>):<fpage>495</fpage>–<lpage>502</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.3192</pub-id><?supplied-pmid 25867923?><pub-id pub-id-type="pmid">25867923</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Blondel</surname><given-names>VD</given-names></name>, <name><surname>Guillaume</surname><given-names>J-L</given-names></name>, <name><surname>Lambiotte</surname><given-names>R</given-names></name>, <name><surname>Lefebvre</surname><given-names>E</given-names></name>. <article-title>Fast unfolding of communities in large networks</article-title>. <source>Journal of statistical mechanics: theory and experiment</source>. <year>2008</year>;<volume>2008</volume>(<issue>10</issue>):<fpage>P10008</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref059">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>Wolf</surname><given-names>FA</given-names></name>, <name><surname>Hamey</surname><given-names>FK</given-names></name>, <name><surname>Plass</surname><given-names>M</given-names></name>, <name><surname>Solana</surname><given-names>J</given-names></name>, <name><surname>Dahlin</surname><given-names>JS</given-names></name>, <name><surname>Göttgens</surname><given-names>B</given-names></name>, <etal>et al</etal>. <article-title>PAGA: graph abstraction reconciles clustering with trajectory inference through a topology preserving map of single cells</article-title>. <source>Genome biology</source>. <year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s13059-018-1612-0</pub-id><?supplied-pmid 30606230?><pub-id pub-id-type="pmid">30606230</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref060">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Coifman</surname><given-names>RR</given-names></name>, <name><surname>Lafon</surname><given-names>S</given-names></name>, <name><surname>Lee</surname><given-names>AB</given-names></name>, <name><surname>Maggioni</surname><given-names>M</given-names></name>, <name><surname>Nadler</surname><given-names>B</given-names></name>, <name><surname>Warner</surname><given-names>F</given-names></name>, <etal>et al</etal>. <article-title>Geometric diffusions as a tool for harmonic analysis and structure definition of data: Diffusion maps</article-title>. <source>Proceedings of the national academy of sciences</source>. <year>2005</year>;<volume>102</volume>(<issue>21</issue>):<fpage>7426</fpage>–<lpage>31</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.0500334102</pub-id><?supplied-pmid 15899970?><pub-id pub-id-type="pmid">15899970</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref061">
      <label>61</label>
      <mixed-citation publication-type="journal"><name><surname>Haghverdi</surname><given-names>L</given-names></name>, <name><surname>Buettner</surname><given-names>F</given-names></name>, <name><surname>Theis</surname><given-names>FJ</given-names></name>. <article-title>Diffusion maps for high-dimensional single-cell analysis of differentiation data</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>18</issue>):<fpage>2989</fpage>–<lpage>98</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btv325</pub-id><?supplied-pmid 26002886?><pub-id pub-id-type="pmid">26002886</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref062">
      <label>62</label>
      <mixed-citation publication-type="journal"><name><surname>Brunet</surname><given-names>J-P</given-names></name>, <name><surname>Tamayo</surname><given-names>P</given-names></name>, <name><surname>Golub</surname><given-names>TR</given-names></name>, <name><surname>Mesirov</surname><given-names>JP</given-names></name>. <article-title>Metagenes and molecular pattern discovery using matrix factorization</article-title>. <source>Proceedings of the national academy of sciences</source>. <year>2004</year>;<volume>101</volume>(<issue>12</issue>):<fpage>4164</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.0308531101</pub-id><?supplied-pmid 15016911?><pub-id pub-id-type="pmid">15016911</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>González-Blas</surname><given-names>CB</given-names></name>, <name><surname>Minnoye</surname><given-names>L</given-names></name>, <name><surname>Papasokrati</surname><given-names>D</given-names></name>, <name><surname>Aibar</surname><given-names>S</given-names></name>, <name><surname>Hulselmans</surname><given-names>G</given-names></name>, <name><surname>Christiaens</surname><given-names>V</given-names></name>, <etal>et al</etal>. <article-title>cisTopic: cis-regulatory topic modeling on single-cell ATAC-seq data</article-title>. <source>Nature methods</source>. <year>2019</year>;<volume>16</volume>(<issue>5</issue>):<fpage>397</fpage>–<lpage>400</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41592-019-0367-1</pub-id><?supplied-pmid 30962623?><pub-id pub-id-type="pmid">30962623</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref064">
      <label>64</label>
      <mixed-citation publication-type="journal"><article-title>The Gene Ontology resource: enriching a GOld mine</article-title>. <source>Nucleic Acids Research</source>. <year>2021</year>;<volume>49</volume>(<issue>D1</issue>):<fpage>D325</fpage>–<lpage>D34</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkaa1113</pub-id><?supplied-pmid 33290552?><pub-id pub-id-type="pmid">33290552</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref065">
      <label>65</label>
      <mixed-citation publication-type="journal"><name><surname>Ashburner</surname><given-names>M</given-names></name>, <name><surname>Ball</surname><given-names>CA</given-names></name>, <name><surname>Blake</surname><given-names>JA</given-names></name>, <name><surname>Botstein</surname><given-names>D</given-names></name>, <name><surname>Butler</surname><given-names>H</given-names></name>, <name><surname>Cherry</surname><given-names>JM</given-names></name>, <etal>et al</etal>. <article-title>Gene ontology: tool for the unification of biology</article-title>. <source>Nature genetics</source>. <year>2000</year>;<volume>25</volume>(<issue>1</issue>):<fpage>25</fpage>–<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/75556</pub-id><?supplied-pmid 10802651?><pub-id pub-id-type="pmid">10802651</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref066">
      <label>66</label>
      <mixed-citation publication-type="journal"><name><surname>Fabregat</surname><given-names>A</given-names></name>, <name><surname>Jupe</surname><given-names>S</given-names></name>, <name><surname>Matthews</surname><given-names>L</given-names></name>, <name><surname>Sidiropoulos</surname><given-names>K</given-names></name>, <name><surname>Gillespie</surname><given-names>M</given-names></name>, <name><surname>Garapati</surname><given-names>P</given-names></name>, <etal>et al</etal>. <article-title>The reactome pathway knowledgebase</article-title>. <source>Nucleic acids research</source>. <year>2018</year>;<volume>46</volume>(<issue>D1</issue>):<fpage>D649</fpage>–<lpage>D55</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkx1132</pub-id><?supplied-pmid 29145629?><pub-id pub-id-type="pmid">29145629</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref067">
      <label>67</label>
      <mixed-citation publication-type="journal"><name><surname>Subramanian</surname><given-names>A</given-names></name>, <name><surname>Tamayo</surname><given-names>P</given-names></name>, <name><surname>Mootha</surname><given-names>VK</given-names></name>, <name><surname>Mukherjee</surname><given-names>S</given-names></name>, <name><surname>Ebert</surname><given-names>BL</given-names></name>, <name><surname>Gillette</surname><given-names>MA</given-names></name>, <etal>et al</etal>. <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2005</year>;<volume>102</volume>(<issue>43</issue>):<fpage>15545</fpage>–<lpage>50</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id><?supplied-pmid 16199517?><pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010025.ref068">
      <label>68</label>
      <mixed-citation publication-type="journal"><name><surname>Liberzon</surname><given-names>A</given-names></name>, <name><surname>Birger</surname><given-names>C</given-names></name>, <name><surname>Thorvaldsdóttir</surname><given-names>H</given-names></name>, <name><surname>Ghandi</surname><given-names>M</given-names></name>, <name><surname>Mesirov</surname><given-names>JP</given-names></name>, <name><surname>Tamayo</surname><given-names>P</given-names></name>. <article-title>The molecular signatures database hallmark gene set collection</article-title>. <source>Cell systems</source>. <year>2015</year>;<volume>1</volume>(<issue>6</issue>):<fpage>417</fpage>–<lpage>25</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cels.2015.12.004</pub-id><?supplied-pmid 26771021?><pub-id pub-id-type="pmid">26771021</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pcbi.1010025.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010025.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Mingyao</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Ma, Li</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Ma, Li</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010025" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">8 Dec 2021</named-content>
    </p>
    <p>Dear Prof. Zhao,</p>
    <p>Thank you very much for submitting your manuscript "Non-linear archetypal analysis of single-cell RNA-seq data by deep autoencoders" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Mingyao Li</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Jian Ma</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: Please see attached file.</p>
    <p>Reviewer #2: In this manuscript, Wang and Zhao propose scAAnet, a deep autoencoder for non-linear archetypal analysis of single-cell RNA-seq data. Building on the assumption that the expression profile of each cell results from a non-linear combination of multiple gene expression programs (GEPs), scAAnet aims to detect GEPs and infer the relative activity of each GEP across cells. There are many merits in this work. The manuscript is well organized and clearly written. The methods are innovative and clearly presented, based on conceptually reasonable assumptions. The simulations were carefully designed and novel biological insights revealed from applications to several real datasets.</p>
    <p>I have two relatively major comments. First, scAAnet assumes that cell types share some GEPs. While this is conceptually justifiable, can the authors quantify the level of shared GEPs in real data, or evaluate how would scAAnet perform if the cells don’t share GEPs in the extreme case? Second, scAAnet needs to preset archetype. It is unclear how to preset the values. How would scAAnet’s performance vary with different hyperparameter choices. In the pseudo codes, there seems a warm up period where the Z^fix will be updated simultaneously. However, if that is the case, it seems that Eq (<xref rid="pcbi.1010025.e014" ref-type="disp-formula">3</xref>) on page 32 is no longer identifiable?</p>
    <p>I have some additional minor comments.</p>
    <p>1. Can GEPs be used to infer cell types? Would it be possible to use the inferred mixture of GEPs to infer cell type?</p>
    <p>2. GEPs identified in real data show their values in revealing underlying latent factors, pathways or network. I assume other scRNA-seq methods can also be used for similar purposes, in more convoluted manners, for example, by first clustering the cells and then performing analysis based on cell type differentially expressed genes? Presumably, without the meaningful reduction into GEPs, alternative methods that do not summarize data into GEPs would provide much noisier conclusions? The authors can consider trying competing methods on some of their real datasets.</p>
    <p>3. The authors showed that shared pattern across cell types/disease can be obtained from inferred GEPs. But we can also analyze the cell type marker genes/ disease marker genes and compare the similarity of marker genes in different cell types/ diseases. What will be the benefit of scAAnet if the GEP analysis eventually goes back to GEP marker gene analysis?</p>
    <p>Reviewer #3: The paper proposes an interesting model for understanding the gene expression programs underlying cells from a population with continuous cell states. The nonnegativity and convexity required in archetypal decomposition enable ease of interpretation. Compared with linear archetypal decomposition by NMF, scAAnet incorporates nonlinearity naturally through an autoencoder.</p>
    <p>- The paper has discussed several conceptual advantages of scAAnet including nonlinearity and the inclusion of the archetypal constraint. While it is clear the method achieves better results on the simulated data, I was wondering if some comparison can be performed on any of the real data examples, in particular with NMF based methods. Does the nonlinearity allow scAAnet to capture different biological signals? Some comparison will help practitioners better understand the utility of the method, given scAAnet comes with additional computational cost.</p>
    <p>- The paper has explained how to choose K, the number of archetypes, through stability criteria. How robust is the method to actually misspecified K? It is a point worth investigating at least on simulated data.</p>
    <p>- The archetypal constraint assumes all cells lie in a tight convex hull in the latent space, which seems a bit restrictive to me. For example, many developmental data have trajectories with bifurcation structure. It would be great if the authors could provide more discussion on the feasibility of this assumption.</p>
    <p>- Related to the question above, one could imagine increasing K or using a larger convex hull would accommodate for more general shapes. In this sense, is there some trade-off involved in the use of archetypal constraint loss? Usually when different losses are combined, they are weighed differently with tuning parameters. Does the relative weight of reconstruction loss vs. archetypal loss affect any part of the results?</p>
    <p>- It is stated that in simulation 50% of the samples were generated from the boundary of the simplex, which seems a bit contrived. What is the purpose of this construction? Would it be more realistic to include some outliers outside this simplex?</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: <bold>No: </bold>The method is on GitHub but "Analysis codes for generating results in this paper are available upon request by email." It would be good if these are published as well.</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email>figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
    <supplementary-material id="pcbi.1010025.s056" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">R1.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1010025.s056.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1010025.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010025.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010025" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">8 Feb 2022</named-content>
    </p>
    <supplementary-material id="pcbi.1010025.s057" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Response to reviewers.docx</named-content></p>
      </caption>
      <media xlink:href="pcbi.1010025.s057.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1010025.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010025.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Mingyao</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Ma, Li</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Ma, Li</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010025" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">4 Mar 2022</named-content>
    </p>
    <p>Dear Prof. Zhao,</p>
    <p>Thank you very much for submitting your manuscript "Non-linear archetypal analysis of single-cell RNA-seq data by deep autoencoders" for consideration at PLOS Computational Biology. As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. The reviewers appreciated the attention to an important topic. Based on the reviews, we are likely to accept this manuscript for publication, providing that you modify the manuscript according to the review recommendations.</p>
    <p>Please prepare and submit your revised manuscript within 30 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to all review comments, and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Thank you again for your submission to our journal. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Mingyao Li</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Jian Ma</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors have addressed most of my comments. I would like to see a few supplementary figures added to improve the interpretation of the GEPs.</p>
    <p>Specifically, regarding the inferred GEP matrix. The GEPs corresponds to the archetypes, which, as the authors describe, represent “pure types or extrema of the real data”.</p>
    <p>In the pancreatic data set, most cell types are primarily associated with one GEP, to the extent that we might even annotate that GEP using the cell type name. Epsilon cells are associated with GEP 3 (gamma) and GEP 5(delta), and the authors provide the interpretation that Epsilon cells are similar to both gamma and delta cells.</p>
    <p>How does one interpret that the beta cells having very high usage of either GEP2 or GEP7? The authors compared GEP2 and GEP7 and concluded that these contain different top genes, and the genes are associated with different GO terms. Does this suggest that there are two different subtypes of beta cells, one subtype resembling archetype 2 and another resembling archetype7?</p>
    <p>The authors provide in Fig 10 the top 20 DEGs for GEP2 and GEP 7. But lacking an overlap between the top 20 genes does not directly reflect how much GEP2 and GEP7 differ. Can the authors provide a heatmap for the GEP matrix (as described on Line 178-179)? The usage of the GEPs are visualized (for example, in Fig 5c). There are 2000 HVGs from 1937 cells, so the GEP matrix is not much larger than the GEP usage matrix. A heatmap can provide a rather straightforward view of the GEPs, and help the reader interpret the GEPs, in addition to the top DEG and GO analysis that the authors already provide.</p>
    <p>It would be useful to add these in supplementary figures:</p>
    <p>• For the simulated data, heatmaps of the true GEP matrix and the inferred GEP matrix(after re-arranging the GEPs to best match the true order)</p>
    <p>• For the real data sets, heatmaps of the inferred GEP matrix</p>
    <p>Minor:</p>
    <p>The DEG test for archetypes</p>
    <p>Line 799 : is $m_i$ the library size? To be consistent with the notation used earlier, maybe it’s better to use $l_i$ again.</p>
    <p>In the results for the lung fibroblast and myofibroblast cells: “GEP 3 is the one not only cell-type-specific but also disease-related.” However, Fig 7 seems to suggest that in Myofibroblasts, both GEP2 and GEP3 usage are disease related?</p>
    <p>Reviewer #2: The authors have carefully addressed all my comments. I have no additional suggestions.</p>
    <p>Reviewer #3: The authors have addressed all my comments.</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: No</p>
    <p>Figure Files:</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link xlink:href="https://pacev2.apexcovantage.com" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>Data Requirements:</p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>Reproducibility:</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
    <p>References:</p>
    <p>Review your reference list to ensure that it is complete and correct. If you have cited papers that have been retracted, please include the rationale for doing so in the manuscript text, or remove these references and replace them with relevant current references. Any changes to the reference list should be mentioned in the rebuttal letter that accompanies your revised manuscript.</p>
    <p>
      <italic toggle="yes">If you need to cite a retracted article, indicate the article’s retracted status in the References list and also include a citation and full reference for the retraction notice.</italic>
    </p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1010025.r004">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010025.r004</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 1</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010025" id="rel-obj004" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">12 Mar 2022</named-content>
    </p>
    <supplementary-material id="pcbi.1010025.s058" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Response to reviewers.docx</named-content></p>
      </caption>
      <media xlink:href="pcbi.1010025.s058.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1010025.r005" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010025.r005</article-id>
    <title-group>
      <article-title>Decision Letter 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Mingyao</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Ma, Li</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Ma, Li</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010025" id="rel-obj005" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">15 Mar 2022</named-content>
    </p>
    <p>Dear Prof. Zhao,</p>
    <p>We are pleased to inform you that your manuscript 'Non-linear archetypal analysis of single-cell RNA-seq data by deep autoencoders' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Mingyao Li</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Jian Ma</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1010025.r006" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010025.r006</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Mingyao</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2022 Ma, Li</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Ma, Li</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010025" id="rel-obj006" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">25 Mar 2022</named-content>
    </p>
    <p>PCOMPBIOL-D-21-01867R2 </p>
    <p>Non-linear archetypal analysis of single-cell RNA-seq data by deep autoencoders</p>
    <p>Dear Dr Zhao,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Zsofia Freund</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link xlink:href="http://ploscompbiol.org" ext-link-type="uri">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
