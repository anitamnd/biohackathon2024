<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8097687</article-id>
    <article-id pub-id-type="pmid">32976553</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa835</article-id>
    <article-id pub-id-type="publisher-id">btaa835</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PBSIM2: a simulator for long-read sequencers with a novel generative model of quality scores</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ono</surname>
          <given-names>Yukiteru</given-names>
        </name>
        <aff><institution>Department of Computational Biology and Medical Sciences, Graduate School of Frontier Sciences, University of Tokyo</institution>, Kashiwa 277-8561, <country country="JP">Japan</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Asai</surname>
          <given-names>Kiyoshi</given-names>
        </name>
        <aff><institution>Department of Computational Biology and Medical Sciences, Graduate School of Frontier Sciences, University of Tokyo</institution>, Kashiwa 277-8561, <country country="JP">Japan</country></aff>
        <aff><institution>Artificial Intelligence Research Center (AIRC), National Institute of Advanced Industrial Science and Technology (AIST)</institution>, Tokyo 135–0064, <country country="JP">Japan</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9466-1034</contrib-id>
        <name>
          <surname>Hamada</surname>
          <given-names>Michiaki</given-names>
        </name>
        <xref rid="btaa835-cor1" ref-type="corresp"/>
        <aff><institution>Department of Electrical Engineering and Bioscience, Faculty of Science and Engineering, Waseda University</institution>, Tokyo 169–8555, <country country="JP">Japan</country></aff>
        <aff><institution>Computational Bio Big-Data Open Innovation Laboratory (CBBD-OIL), National Institute of Advanced Industrial Science and Technology (AIST)</institution>, Tokyo 169–8555, <country country="JP">Japan</country></aff>
        <aff><institution>Institute for Medical-oriented Structural Biology, Waseda University</institution>, Tokyo 162–8480, <country country="JP">Japan</country></aff>
        <aff><institution>Graduate School of Medicine, Nippon Medical School</institution>, Tokyo 113–8602, <country country="JP">Japan</country></aff>
        <!--mhamada@waseda.jp-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Peter</surname>
          <given-names>Robinson</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btaa835-cor1">To whom correspondence should be addressed. <email>mhamada@waseda.jp</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-09-25">
      <day>25</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <volume>37</volume>
    <issue>5</issue>
    <fpage>589</fpage>
    <lpage>595</lpage>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>20</day>
        <month>8</month>
        <year>2020</year>
      </date>
      <date date-type="editorial-decision">
        <day>08</day>
        <month>9</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>9</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa835.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Recent advances in high-throughput long-read sequencers, such as PacBio and Oxford Nanopore sequencers, produce longer reads with more errors than short-read sequencers. In addition to the high error rates of reads, non-uniformity of errors leads to difficulties in various downstream analyses using long reads. Many useful simulators, which characterize long-read error patterns and simulate them, have been developed. However, there is still room for improvement in the simulation of the non-uniformity of errors.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>To capture characteristics of errors in reads for long-read sequencers, here, we introduce a generative model for quality scores, in which a hidden Markov Model with a latest model selection method, called factorized information criteria, is utilized. We evaluated our developed simulator from various points, indicating that our simulator successfully simulates reads that are consistent with real reads.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The source codes of PBSIM2 are freely available from <ext-link xlink:href="https://github.com/yukiteruono/pbsim2" ext-link-type="uri">https://github.com/yukiteruono/pbsim2</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>MEXT KAKENHI</institution>
          </institution-wrap>
        </funding-source>
        <award-id>JP24680031</award-id>
        <award-id>JP16H05879</award-id>
        <award-id>JP20H00624</award-id>
        <award-id>JP16H06279</award-id>
        <award-id>JP25240044</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>High-throughput DNA sequencing technology has markedly changed the style of biological research, from hypothesis-driven biology to data-driven biology. Notably, recent advances in <italic toggle="yes">long</italic>-read sequencers, including Pacific Biosciences (PacBio) and Oxford Nanopore Technologies (Nanopore), have accelerated studies on the genome (<xref rid="btaa835-B4" ref-type="bibr">Bowden <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa835-B5" ref-type="bibr">Chaisson <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btaa835-B7" ref-type="bibr">Dilthey <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa835-B14" ref-type="bibr">Jain <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btaa835-B16" ref-type="bibr">Korlach <italic toggle="yes">et al.</italic>, 2017</xref>), epigenome (<xref rid="btaa835-B26" ref-type="bibr">Simpson <italic toggle="yes">et al.</italic>, 2017</xref>) and transcriptome (<xref rid="btaa835-B30" ref-type="bibr">Weirather <italic toggle="yes">et al.</italic>, 2017</xref>), among others (<xref rid="btaa835-B21" ref-type="bibr">Mantere <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa835-B28" ref-type="bibr">van Dijk <italic toggle="yes">et al.</italic>, 2018</xref>).</p>
    <p>It is known that reads generated by long-read sequencers include more errors than those generated by short-read sequencers (e.g. Illumina HiSeq), and many tools and algorithms that specifically target long-read sequencers have been developed (<xref rid="btaa835-B2" ref-type="bibr">Amarasinghe <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btaa835-B20" ref-type="bibr">Makałowski and Shabardina, 2019</xref>; <xref rid="btaa835-B25" ref-type="bibr">Sedlazeck <italic toggle="yes">et al.</italic>, 2018</xref>). However, in the development of tools/algorithms for long-read sequencers, it is generally difficult to evaluate those using real data. This is because real data that meets the necessary conditions cannot always be prepared; in addition, the true error information of real data is not easy to obtain. Therefore, simulators that generate reads with error information, such as alignments between reads and the reference sequences, are useful for the evaluation of new tools/algorithms (see <xref rid="btaa835-B1" ref-type="bibr">Alosaimi <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btaa835-B9" ref-type="bibr">Escalona <italic toggle="yes">et al.</italic>, 2016</xref>) for comprehensive reviews of read simulators.) Moreover, these simulators are useful for experimental design such as estimating the depth coverage required for genome assembly and variant detection. To make this possible, it is crucial to be able to properly simulate the characteristics of real reads, especially the characteristics of errors.</p>
    <p>PacBio sequencers have lesser systematic (or context-specific) errors (e.g. errors in high- and low-GC regions and at homopolymer runs) than that of short-read sequencers, such as Illumina (<xref rid="btaa835-B8" ref-type="bibr">Eid <italic toggle="yes">et al.</italic>, 2009</xref>; <xref rid="btaa835-B17" ref-type="bibr">Laehnemann <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa835-B24" ref-type="bibr">Ross <italic toggle="yes">et al.</italic>, 2013</xref>). In contrast, it has been reported that PacBio reads have regional bias of error distribution within the reads, and very low-quality regions are sometimes observed (e.g. see Myers’ report, <ext-link xlink:href="https://dazzlerblog.wordpress.com/2015/11/06/" ext-link-type="uri">https://dazzlerblog.wordpress.com/2015/11/06/</ext-link>). Low-quality regions are caused by chimeras and undetected adapter sequences, as well as non-uniformity of errors. <xref rid="btaa835-F1" ref-type="fig">Figure 1</xref> clearly shows the non-uniformity of quality scores, with the distributions of accuracy of 800 bp disjoint intervals in reads (Here, quality scores are used instead of actual errors, because it is difficult to obtain the true error information for reads, especially long reads. Note that the quality score is logarithmically related to error probability; <xref rid="btaa835-B6" ref-type="bibr">Cock <italic toggle="yes">et al.</italic>, 2010</xref>.). ‘Random models’ randomly generate quality scores according to real frequencies of quality scores, leading to a normal distribution of quality scores. When compared with random models, the distributions of real reads have broader accuracy ranges of 800 bp interval, especially for low read accuracy. Our previously developed simulator, PBSIM (<xref rid="btaa835-B22" ref-type="bibr">Ono <italic toggle="yes">et al.</italic>, 2013</xref>), employs a random model (<xref rid="btaa835-B8" ref-type="bibr">Eid <italic toggle="yes">et al.</italic>, 2009</xref>), and the reads generated by it are simpler and easier to handle than real reads; this is a problem when evaluating the tools/algorithms for long-read sequencers.
</p>
    <fig position="float" id="btaa835-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Non-uniformity of quality scores for real and simulated reads. After grouping reads by their accuracy, reads were segmented into 800 bp disjoint intervals, and accuracy of each interval was computed from quality scores. Each graph shows the distribution of averaged accuracy of 800 bp intervals, where colors of plotted lines represent read groups (e.g. ‘Acc.78’ refers to a read group with an accuracy of 77.5–78.4%). In random models, a house-made program randomly sampled quality scores according to the quality score distribution of each accuracy of real reads</p>
      </caption>
      <graphic xlink:href="btaa835f1" position="float"/>
    </fig>
    <p>Currently, there are several simulators that generate long reads (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> for summary). With regard to simulation of low-quality regions, NanoSim (<xref rid="btaa835-B33" ref-type="bibr">Yang <italic toggle="yes">et al.</italic>, 2017</xref>) generates a set of read profiles from alignment-based analysis, and simulates low-quality regions using the profiles. PaSS (<xref rid="btaa835-B35" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2019</xref>) adopts preset high error rates for both ends of the reads, to simulate low-quality regions. Badread (<xref rid="btaa835-B31" ref-type="bibr">Wick, 2019</xref>) can introduce chimeras, adapter sequences, low-quality regions and low-complex repetitive sequences into simulated reads. However, there is still room for improvement in the simulation of the non-uniformity of errors (or quality scores).</p>
    <p>To simulate the non-uniformity of quality scores, in this study, we developed a generative model for quality scores, based on a hidden Markov model (HMM) in combination with latest model selection criteria. Our computational experiments show that PBSIM2, the new version of PBSIM, simulates reads that have a tendency similar to real reads.</p>
    <p>This article is organized as follows: In Section 2, after introducing a novel generative model for quality scores, we describe the detailed design of PBSIM2. In Section 3, we report comprehensive evaluations of PBSIM2 and related discussions. PBSIM2 newly added the function to simulate Nanopore reads, whereas it removed the function to simulate circular consensus sequencing (CCS also known as HiFi) reads. This is because the average accuracy of CCS exceeds 99%, which is outside the purpose of PBSIM to simulate error-prone reads. PBSIM2 is freely available from <ext-link xlink:href="https://github.com/yukiteruono/pbsim2" ext-link-type="uri">https://github.com/yukiteruono/pbsim2</ext-link>, and it will be useful for various studies using long reads.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Datasets for long-read sequencers</title>
      <p>In this study, we utilized various types of datasets for PacBio (seven datasets of CLR) and Nanopore sequencers (nine datasets), as summarized in <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2 and S3</xref>, respectively.</p>
    </sec>
    <sec>
      <title>2.2 Basic statistics of long reads</title>
      <p>To learn the features of long reads, we obtained basic statistics, such as read length, accuracy distribution and quality score distribution, from the real reads in <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2 and S3</xref>. As shown in <xref rid="btaa835-F2" ref-type="fig">Figure 2</xref>, in PacBio, quality score distributions are very similar within the same chemistry. Conversely, Nanopore has a wider range and more diverse distribution of quality scores than those of PacBio.
</p>
      <fig position="float" id="btaa835-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Quality score distributions of real reads. The frequency of quality scores was counted for each of the datasets in <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2 and S3</xref>. Colors of plotted lines represent datasets. Dataset name is species (e.g. <italic toggle="yes">E.coli</italic>_K12) + chemistry (e.g. P4C2). The horizontal axis is PHRED33 quality score defined in terms of the estimated error probability (e.g. quality scores 4, 7 and 10 represent error probabilities of 40%, 20% and 10%, respectively; <xref rid="btaa835-B6" ref-type="bibr">Cock <italic toggle="yes">et al.</italic>, 2010</xref>)</p>
        </caption>
        <graphic xlink:href="btaa835f2" position="float"/>
      </fig>
      <p>Additionally, we conducted local alignments of real and simulated reads to reference sequences, and got error rates from the alignment results for several analyses. These local alignments were executed by LAST version 1047 (Kiełbasa <italic toggle="yes">et al.</italic>, 2011). Alignments were filtered using <monospace>last-map-probs</monospace>. <monospace>lastal</monospace> was executed with parameters trained by <monospace>last-train</monospace> (<xref rid="btaa835-B13" ref-type="bibr">Hamada <italic toggle="yes">et al.</italic>, 2017</xref>) and <monospace>‘-m100 -j7’. lastdb, last-train,</monospace> and <monospace>last-map-probs</monospace> were executed using the default parameters.</p>
    </sec>
    <sec>
      <title>2.3 Generative model for quality scores</title>
      <p>To construct a generative model for quality scores, we employed a HMM, which generates observed data from hidden states that follow the Markov model. Note that HMMs are utilized in many bioinformatics tools (e.g. <xref rid="btaa835-B34" ref-type="bibr">Yoon, 2009</xref>). In our HMM, the emission probability distributions from each hidden state are provided by a categorical distribution, whose output is one of the quality scores. It should be emphasized that the parameters in categorical distribution with hidden states are different from each other.</p>
      <p>In conventional HMM, the number of hidden states should be provided beforehand. In this study, we utilized HMM with the latest model selection criteria, called factorized information criteria (FIC-HMM; <xref rid="btaa835-B12" ref-type="bibr">Hamada <italic toggle="yes">et al.</italic>, 2015</xref>). This method is theoretically sound, enabling us to train not only parameters in HMM but also the number of hidden states (<xref rid="btaa835-B11" ref-type="bibr">Fujimaki and Hayashi, 2012</xref>).</p>
      <p>In this study, we adopted the model whose (lower bound of) FIC is maximum among five trials with different initial parameters, because FIC-HMM affects local optimal solutions in their training. The models were trained for each read accuracy of each chemistry (e.g. for 80% accuracy, training data comprise a read group with an accuracy of 79.5–80.4%). For read accuracy with insufficient training data, constant quality scores that match the accuracy were used.</p>
    </sec>
    <sec>
      <title>2.4 Detailed design of PBSIM2</title>
      <p>Given a reference sequence, PBSIM2 generates FASTQ file (<xref rid="btaa835-B6" ref-type="bibr">Cock <italic toggle="yes">et al.</italic>, 2010</xref>), including reads with quality scores, where the generative process is summarized as follows:
</p>
      <list list-type="order">
        <list-item>
          <p>Determine read length according to the read length distribution in Section 2.4.1.</p>
        </list-item>
        <list-item>
          <p>Determine read accuracy according to the read accuracy distribution in Section 2.4.2.</p>
        </list-item>
        <list-item>
          <p>Generate quality scores of each position in the read using the generative model, which was trained for each read accuracy of each chemistry.</p>
        </list-item>
        <list-item>
          <p>Sample a random position from the reference sequence and cut out a nucleotide sequence of the read length.</p>
        </list-item>
        <list-item>
          <p>Introduce errors (substitution, insertion and deletion) into the nucleotide sequence according to a quality score at each position of the read and the ratio of error types as described in Section 2.4.3.</p>
        </list-item>
      </list>
      <sec>
        <title>2.4.1 Read length distribution</title>
        <p>On both PacBio and Nanopore sequencers, we utilized gamma distribution for read length, although log-normal distribution was employed in the previous version of PBSIM. This is because gamma distribution is more suitable than log-normal distribution for latest real datasets of both PacBio and Nanopore in our preliminary experiments (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). Note that DAZZ_DB/simulator ( <ext-link xlink:href="https://github.com/thegenemyers/DAZZ_DB/blob/master/simulator.c" ext-link-type="uri">https://github.com/thegenemyers/DAZZ_DB/blob/master/simulator.c</ext-link>), SimLoRD (<xref rid="btaa835-B27" ref-type="bibr">Stöcker <italic toggle="yes">et al.</italic>, 2016</xref>), and NPBSS (<xref rid="btaa835-B29" ref-type="bibr">Wei and Zhang, 2018</xref>) employ log-normal distribution for PacBio; SiLiCO (<xref rid="btaa835-B3" ref-type="bibr">Baker <italic toggle="yes">et al.</italic>, 2016</xref>) employs log-normal distribution for PacBio, as well as gamma distribution for Nanopore; DeepSimulator1.5 (<xref rid="btaa835-B19" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2020</xref>) employs beta, exponential and mixed gamma distribution for Nanopore; and Badread employs gamma distribution for both PacBio and Nanopore.</p>
        <p>The distribution is defined by:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>/</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>Γ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo>θ</mml:mo><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>where shape and scale parameters (<italic toggle="yes">k</italic> and <italic toggle="yes">θ</italic>) are determined by averaged length and SD of reads in each dataset, respectively, which can be specified by the user as input parameters. PBSIM2 computes probability mass in each length, between the maximum and minimum length.</p>
      </sec>
      <sec>
        <title>2.4.2 Read accuracy distribution</title>
        <p>Both PacBio and Nanopore sequencers utilize exponential distributions for read accuracy, although normal distribution has been employed in the previous version of PBSIM. In other simulators, Badread employs beta distribution for both PacBio and Nanopore. Our preliminary experiments indicated that exponential distribution was more suitable than any other distribution for latest real datasets of both PacBio and Nanopore (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>).</p>
        <p>Precisely, we define read accuracy distribution by:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msubsup><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>where
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>exp</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>0.22</mml:mn><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>and the minimum and maximum of accuracy are determined by averaged accuracy of reads, which can be specified by the user as input parameters. PBSIM2 computes probability mass in each accuracy between the maximum and minimum accuracy.</p>
      </sec>
      <sec>
        <title>2.4.3 Simulation of errors</title>
        <p>A nucleotide sequence of a read is uniformly sampled from the reference sequence, and errors are introduced into the sequence as follows: For each position of the read, all error types (substitution, insertion and deletion) are introduced according to quality score at that position. In the previous version of PBSIM, deletion rate is uniform throughout all positions of every simulated read, but the latest datasets show that the rates of all error types are related to the quality scores (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S16</xref>). All error rates are calculated from quality scores and the ratio of error types given by the user. With regard to a deletion, there is no quality score for the deletion itself; thus, the quality score of the 5’neighbor is used. As in the previous version of PBSIM, half of the inserted nucleotides are chosen to be the same as their following nucleotides, and the other half are randomly chosen.</p>
      </sec>
      <sec>
        <title>2.4.4 Sampling-based simulation</title>
        <p>Sampling-based simulation implemented in PBSIM can also be used in PBSIM2. In this simulation, the length and quality scores of a read are randomly sampled from real data provided by the user. Subsequently, a nucleotide sequence is randomly extracted from the reference sequence, and errors are introduced in the same way as described in Section 2.4.3.</p>
      </sec>
    </sec>
    <sec>
      <title>2.5 Execution of other simulators</title>
      <p>To evaluate the ability of PBSIM2 to simulate the non-uniformity of real reads, we conducted simulations using other simulators and observed their non-uniformity. For NPBSS, we simulated PacBio CLR using the default error model. For PaSS, we simulated PacBio CLR using a prepared profile (sim.config). For LongISLND (<xref rid="btaa835-B18" ref-type="bibr">Lau <italic toggle="yes">et al.</italic>, 2016</xref>), we built models from real reads and simulated PacBio CLR using the models. For Badread, we built models from real reads and simulated PacBio CLR and Nanopore reads using the models. For DeepSimulator1.5, we simulated Nanopore fast5 using context-independent kmer pore model and basecalled using Guppy.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Result and discussion</title>
    <sec>
      <title>3.1 CPU time and memory consumption</title>
      <p>For each simulator, CPU time and maximum memory usage were measured for generating a total of 100 Mb of reads. NPBSS was executed on a Windows system equipped with Intel(R) Core(TM) CPU(i7-8565U@1.80 GHz). The others were executed on the National Institute of Genetics supercomputer system. The execution of DeepSimulator1.5 included basecalling by Guppy and checking read accuracy by Minimap2, and used ‘-c 8’ option (CPU number). Results are shown in <xref rid="btaa835-T1" ref-type="table">Table 1</xref>. PBSIM is the fastest and consumes minimal memory, which enables users to simulate reads on their laptops.
</p>
      <table-wrap position="float" id="btaa835-T1">
        <label>Table 1.</label>
        <caption>
          <p>CPU time and maximum memory for each simulator</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Simulator</th>
              <th rowspan="1" colspan="1">CPU time (s)</th>
              <th rowspan="1" colspan="1">Maximum memory (Gb)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">PBSIM</td>
              <td rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1">0.2</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PBSIM2 (this work)</td>
              <td rowspan="1" colspan="1">7</td>
              <td rowspan="1" colspan="1">0.2</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">LongISLND</td>
              <td rowspan="1" colspan="1">565</td>
              <td rowspan="1" colspan="1">26.7</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">NPBSS</td>
              <td rowspan="1" colspan="1">1024</td>
              <td rowspan="1" colspan="1">0.1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">DeepSimulator1.5</td>
              <td rowspan="1" colspan="1">113 344</td>
              <td rowspan="1" colspan="1">15.3</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PaSS</td>
              <td rowspan="1" colspan="1">14</td>
              <td rowspan="1" colspan="1">0.8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Badread</td>
              <td rowspan="1" colspan="1">1498</td>
              <td rowspan="1" colspan="1">3.5</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic toggle="yes">Note</italic>: CPU time and maximum memory usage were measured for generating a total of 100 Mb of reads. NPBSS was executed on a Windows system equipped with Intel(R) Core(TM) CPU(i7-8565U@1.80 GHz). The others were executed on the National Institute of Genetics supercomputer system. The execution of DeepSimulator1.5 included basecalling by Guppy and assessing read accuracy by Minimap2; when using ‘-c 8’ option (CPU number), wall-clock time was 20 662 s.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>3.2 Evaluation of a generative model of quality scores</title>
      <p>To evaluate PBSIM2 that implemented a novel generative model of quality scores trained using FIC-HMM, we compared simulated reads of PBSIM2 with real reads in terms of non-uniformity of quality scores. PBSIM2 simulated reads with the same parameters (e.g. mean and SD of read length and accuracy) as real reads. We also evaluated simulated reads of Markov Model (MM), because in Nanopore sequencing, the raw current signal is mainly influenced by 5- or 6-mer that occupies the pore simultaneously (<xref rid="btaa835-B23" ref-type="bibr">Rang <italic toggle="yes">et al.</italic>, 2018</xref>), and <xref rid="btaa835-B10" ref-type="bibr">Faucon <italic toggle="yes">et al.</italic> (2017)</xref> showed that the strongest feature for predicting the accuracy of each k-mer was the accuracy of neighboring k-mers, one step away. MM generates quality scores by first- and second-order MM (referred to as ‘1st-order MM’ and ‘2nd-order MM’, respectively) of transition probabilities of quality scores of real reads.</p>
      <p>It is clear that the non-uniformity of simulated reads of PBSIM2 is sufficiently similar to that of real reads in both PacBio and Nanopore (<xref rid="btaa835-F3" ref-type="fig">Fig. 3</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S3 and S4</xref> show graphs of all the interval sizes). <xref rid="btaa835-F3" ref-type="fig">Figure 3b</xref> also indicates that 1st-order MM is able to simulate the non-uniformity, as well as PBSIM2 in Nanopore. We utilized the Kullback–Leibler (KL) divergence for observing similarity between non-uniformity (see <xref rid="btaa835-F3" ref-type="fig">Fig. 3</xref>). For <italic toggle="yes">P</italic> (real distribution) and <italic toggle="yes">Q</italic> (simulated distribution), the KL divergence from <italic toggle="yes">Q</italic> to <italic toggle="yes">P</italic> is defined to be;
<disp-formula id="E4"><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mtext>log</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <fig position="float" id="btaa835-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Simulation of non-uniformity of quality scores and evaluation by KL divergence. Each graph shows distributions of accuracy of 800 bp disjoint intervals in reads in the same way as <xref rid="btaa835-F1" ref-type="fig">Figure 1</xref>. Read groups (e.g. Acc.78) with insufficient data are not shown in the graphs. PBSIM2, the new version of PBSIM, generated reads using model-based simulation. ‘1st-order MM’, our in-house software tool, generated quality scores for each read group, by a 1st-order MM of transition probabilities of the quality score of real reads. Badread built a model and generated reads. DeepSimulator1.5 generated Nanopore fast5 using context-independent kmer pore model and basecalled using Guppy. KL divergence of distribution of accuracy of fixed size (50, 100, 200, 400, 800, 1600 and 3200 bp) intervals between real and simulated reads. Upper-limit value of KL divergence was 10</p>
        </caption>
        <graphic xlink:href="btaa835f3" position="float"/>
      </fig>
      <p><xref rid="btaa835-F4" ref-type="fig">Figure 4</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref> show that features of the transition probability matrix are clearly different between PacBio and Nanopore, and the transition ranges in Nanopore are narrower than those in PacBio. Thus, MM is successful in Nanopore. Furthermore <xref rid="btaa835-F5" ref-type="fig">Figures 5</xref>, <xref rid="btaa835-F6" ref-type="fig">6</xref> and Supplementary Figures S6 and S7 show that in FIC-HMM, the transition ranges of states in Nanopore are narrower than those in PacBio, and the emission ranges of states in Nanopore are narrower and simpler than those in PacBio. These observations in MM and FIC-HMM are consistent. We decoded training data for FIC-HMM into states using the Viterbi algorithm, and examined continuous length of state (e.g. if the same state is lined up five times in a row, the continuous length is 5). <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S8</xref> shows that the continuous length of state in PacBio is longer than that in Nanopore. In both PacBio and Nanopore R9.5, 2nd-order MM was a slightly better simulation than 1st-order MM (Supplementary Figs S9–12). However, in Nanopore R10.3, they were almost the same (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S13 and S14</xref>).
</p>
      <fig position="float" id="btaa835-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Transition probability matrixes of quality scores of real reads. The vertical and horizontal axes are PHRED33 quality scores defined in terms of the estimated error probability (e.g. quality score 4, 7 and 10 represent error probabilities of 40%, 20% and 10%, respectively; <xref rid="btaa835-B6" ref-type="bibr">Cock <italic toggle="yes">et al.</italic>, 2010</xref>). Quality scores on the vertical axis transition to ones on the horizontal axis. The sum of transition probabilities on each quality score of the vertical axis is 100%. These are matrixes of ‘Acc84’, denoting a read group whose accuracy is 83.5–84.4%. In Nanopore matrix, quality scores above 25 are not displayed</p>
        </caption>
        <graphic xlink:href="btaa835f4" position="float"/>
      </fig>
      <fig position="float" id="btaa835-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Transition probability matrixes of states of FIC-HMM. The vertical and horizontal axes represent states of FIC-HMM, which are sorted in order of increasing averaged quality score emitted by them. States on the vertical axis transition to ones on the horizontal axis. The sum of transition probabilities on each state of the vertical axis is 100%. These are matrixes of ‘Acc84’, a read group with an accuracy of 83.5–84.4%</p>
        </caption>
        <graphic xlink:href="btaa835f5" position="float"/>
      </fig>
      <fig position="float" id="btaa835-F6">
        <label>Fig. 6.</label>
        <caption>
          <p>Emission probability matrixes of states of FIC-HMM. The vertical axis represents states of FIC-HMM, which are sorted in order of increasing averaged quality score emitted by them. The horizontal axis is PHRED33 quality score defined in terms of the estimated error probability (e.g. quality scores of 4, 7 and 10 represent error probability of 40%, 20% and 10%, respectively; <xref rid="btaa835-B6" ref-type="bibr">Cock <italic toggle="yes">et al.</italic>, 2010</xref>). States on the vertical axis emit quality scores on the horizontal axis. The sum of emission probabilities on each state of vertical axis is 100%. These are matrixes of ‘Acc84’, a read group with an accuracy of 83.5–84.4%. In the matrix of Nanopore, quality scores above 25 are not displayed</p>
        </caption>
        <graphic xlink:href="btaa835f6" position="float"/>
      </fig>
      <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S9–14</xref> also show comparisons with other long-read simulators. In simulation of PacBio reads, PBSIM2 is able to simulate the non-uniformity of real reads more than that of any other simulator (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10</xref>). Even in the simulation of Nanopore reads, PBSIM2 is one of the best simulators for overall read accuracy, but at 86–90% read accuracy of <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12</xref> and at 84–88% of <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S14</xref>, DeepSimulator1.5 is the best. However, DeepSimulator1.5 has narrow ranges of read accuracy.</p>
    </sec>
    <sec>
      <title>3.3 Correlation between read length and accuracy</title>
      <p>The previous version of PBSIM was unable to simulate realistic correlation between length and accuracy for each read (<xref rid="btaa835-B27" ref-type="bibr">Stöcker <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa835-B29" ref-type="bibr">Wei and Zhang, 2018</xref>). As shown in <xref rid="btaa835-F7" ref-type="fig">Figure 7</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S15</xref>, PBSIM2 is able to simulate realistic correlations. This improvement was mainly due to change in read accuracy distribution, as mentioned in Section 2.4.2.
</p>
      <fig position="float" id="btaa835-F7">
        <label>Fig. 7.</label>
        <caption>
          <p>Correlation between read length and accuracy for each read of PacBio P6–C4 for <italic toggle="yes">E.coli</italic> K12 MG1655. Accuracy of each read was calculated from quality scores. PBSIM and PBSIM2 simulated reads with the same parameters (e.g. mean and SD of read length and accuracy) as real reads. Colors indicate the varying frequencies of each cell</p>
        </caption>
        <graphic xlink:href="btaa835f7" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.4 Relationship between error rate and quality scores</title>
      <p>In the previous version of PBSIM, the relationship between error rate and quality score deviated from the correct one with increasing quality score (<xref rid="btaa835-B29" ref-type="bibr">Wei and Zhang, 2018</xref>). As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S16</xref>, the relationship is improved by changing the deletion rate, as mentioned in Section 2.4.3.</p>
    </sec>
    <sec>
      <title>3.5 Nucleotide sequence-based error model</title>
      <p>Using nucleotide sequence context (or k-mer)-based error models, generated from alignment-based analysis of real reads, several simulators are able to simulate features of real reads, such as error length (<xref rid="btaa835-B10" ref-type="bibr">Faucon <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btaa835-B18" ref-type="bibr">Lau <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa835-B31" ref-type="bibr">Wick, 2019</xref>; <xref rid="btaa835-B35" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2019</xref>). Thus, we investigated 6-mer error bias by analyzing alignments of reads to the reference sequences. As shown in Supplementary Figures S17 and S18, we observed that PacBio reads had small 6-mer bias, whereas Nanopore reads had significant 6-mer bias, which is consistent with a previous study (<xref rid="btaa835-B10" ref-type="bibr">Faucon <italic toggle="yes">et al.</italic>, 2017</xref>). It has been reported that homopolymers are difficult to be called accurately by base-callers; therefore, many deletions occur at homopolymers in read sequence of Nanopore (<xref rid="btaa835-B23" ref-type="bibr">Rang <italic toggle="yes">et al.</italic>, 2018</xref>). Concurrent with this report, we observed high deletion rate at homopolymers in Nanopore (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S4–6</xref>). We also observed that insertion and deletion (indels) were longer in Nanopore (R9.5) than those in PacBio (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S19a</xref> and b). Recently, the latest Nanopore chemistry, R10, has improved resolution of homopolymeric regions (<xref rid="btaa835-B2" ref-type="bibr">Amarasinghe <italic toggle="yes">et al.</italic>, 2020</xref>). Actually, indels are shorter in R10 than those in R9, and the indel length distribution becomes similar to that of PBSIM2 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S19b</xref> and c), compared with PBSIM. In contrast, with regard to 6-mer error bias, R10 shows features similar to those of R9 (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S18</xref>). Although it may be necessary to simulate 6-mer error bias, especially homopolymer-specific error, to simulate Nanopore reads accurately, this version of PBSIM2 does not address this issue because, as mentioned earlier, Nanopore R10 has improved for homopolymer, and basecalling software is improving for homopolymer basecalling (<xref rid="btaa835-B32" ref-type="bibr">Wick <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
    </sec>
    <sec>
      <title>3.6 Future directions</title>
      <p>In addition to the low-quality regions, artifacts such as chimeras and adapter sequences are frequently observed in long reads (see Myers’ report, <ext-link xlink:href="https://dazzlerblog.wordpress.com/2017/04/22/1344/" ext-link-type="uri">https://dazzlerblog.wordpress.com/2017/04/22/1344/</ext-link>). These errors are the major cause of poor genome assembly. Badread has previously simulated these errors, and we also plan to implement similar functions in the next version of PBSIM.</p>
      <p>After PacBio Sequel sequencer, quality code is a fixed value and does not represent the actual error rate, so in this study, only RS II CLR was used as training data for quality scores. PBSIM2 is targeted at error-prone reads, so we are unsure if it can properly simulate HiFi reads. However, if a generative model of quality scores is created using the error information obtained from the alignment of reads to the reference sequences instead of the quality score, the latest PacBio Sequel II data can be used as the training data of FIC-HMM. Even though there are many problems, such as handling unaligned regions or regions where it is difficult to obtain accurate error information, including low-quality regions, learning alignment by FIC-HMM is expected to significantly improve the error model of long reads.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>In this study, we proposed a novel simulator for long reads produced by PacBio and Nanopore sequencers, in which a novel generative model for quality scores is employed.</p>
    <p>One of the novel points in this study was introducing a generative model of quality scores, based on a HMM with a model selection procedure. Our experiments showed that the generative model simulates quality scores that are more consistent with real reads of PacBio and Nanopore than other existing simulators.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btaa835_Supplementary_Data</label>
      <media xlink:href="btaa835_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We would like to extend our gratitude to Dr Martin Frith for his valuable comments on the article. Computations in this study were partially performed on the supercomputer systems at the ROIS National Institute of Genetics.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported, in part, by MEXT KAKENHI [grants JP24680031, JP16H05879 and JP20H00624 to M.H. and JP16H06279 and JP25240044 to M.H. and K.A.].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa835-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alosaimi</surname>
 <given-names>S.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2020</year>) 
<article-title>A broad survey of DNA sequence data simulation tools</article-title>. <source>Brief. Funct. Genomics</source>, <volume>19</volume>, <fpage>49</fpage>–<lpage>59</lpage>.<pub-id pub-id-type="pmid">31867604</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amarasinghe</surname>
 <given-names>S.L.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2020</year>) 
<article-title>Opportunities and challenges in long-read sequencing data analysis</article-title>. <source>Genome Biol</source>., <volume>21</volume>, <fpage>1</fpage>–<lpage>16</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa835-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baker</surname>
 <given-names>E.A.G.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2016</year>) 
<article-title>Silico: a simulator of long read sequencing in PacBio and Oxford Nanopore</article-title>. <source>BioRxiv</source>, <fpage>076901</fpage>.</mixed-citation>
    </ref>
    <ref id="btaa835-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bowden</surname>
 <given-names>R.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2019</year>) 
<article-title>Sequencing of human genomes with nanopore technology</article-title>. <source>Nat. Commun</source>., <volume>10</volume>, <fpage>1</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">30602773</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chaisson</surname>
 <given-names>M.J.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2015</year>) 
<article-title>Resolving the complexity of the human genome using single-molecule sequencing</article-title>. <source>Nature</source>, <volume>517</volume>, <fpage>608</fpage>–<lpage>611</lpage>.<pub-id pub-id-type="pmid">25383537</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cock</surname>
 <given-names>P.J.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2010</year>) 
<article-title>The sanger FASTQ file format for sequences with quality scores, and the Solexa/Illumina FASTQ variants</article-title>. <source>Nucleic Acids Res</source>., <volume>38</volume>, <fpage>1767</fpage>–<lpage>1771</lpage>.<pub-id pub-id-type="pmid">20015970</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dilthey</surname>
 <given-names>A.T.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2019</year>) 
<article-title>Strain-level metagenomic assignment and compositional estimation for long reads with Metamaps</article-title>. <source>Nat. Commun</source>., <volume>10</volume>, <fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">30602773</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eid</surname>
 <given-names>J.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2009</year>) 
<article-title>Real-time DNA sequencing from single polymerase molecules</article-title>. <source>Science</source>, <volume>323</volume>, <fpage>133</fpage>–<lpage>138</lpage>.<pub-id pub-id-type="pmid">19023044</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Escalona</surname>
 <given-names>M.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2016</year>) 
<article-title>A comparison of tools for the simulation of genomic next-generation sequencing data</article-title>. <source>Nat. Rev. Genet</source>., <volume>17</volume>, <fpage>459</fpage>–<lpage>469</lpage>.<pub-id pub-id-type="pmid">27320129</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B10">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Faucon</surname>
 <given-names>P.C.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2017</year>) SNaResim: synthetic nanopore read simulator. In <italic toggle="yes">2017 IEEE International Conference on Healthcare Informatics (ICHI)</italic>, pp <fpage>338</fpage>–<lpage>344</lpage>. IEEE, arXiv Preprint arXiv, and BioRxiv.</mixed-citation>
    </ref>
    <ref id="btaa835-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fujimaki</surname>
 <given-names>R.</given-names></string-name>, <string-name><surname>Hayashi</surname><given-names>K.</given-names></string-name></person-group> (<year>2012</year>) 
<article-title>Factorized asymptotic Bayesian hidden Markov models</article-title>. <source>arXiv Preprint arXiv:1206.4679</source>.</mixed-citation>
    </ref>
    <ref id="btaa835-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hamada</surname>
 <given-names>M.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2015</year>) 
<article-title>Learning chromatin states with factorized information criteria</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>2426</fpage>–<lpage>2433</lpage>.<pub-id pub-id-type="pmid">25810430</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hamada</surname>
 <given-names>M.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2017</year>) 
<article-title>Training alignment parameters for arbitrary sequencers with last-train</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>926</fpage>–<lpage>928</lpage>.<pub-id pub-id-type="pmid">28039163</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jain</surname>
 <given-names>M.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2018</year>) 
<article-title>Nanopore sequencing and assembly of a human genome with ultra-long reads</article-title>. <source>Nat. Biotechnol</source>., <volume>36</volume>, <fpage>338</fpage>–<lpage>345</lpage>.<pub-id pub-id-type="pmid">29431738</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiełbasa</surname>
 <given-names>S.M.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2011</year>) 
<article-title>Adaptive seeds tame genomic sequence comparison</article-title>. <source>Genome Res</source>., <volume>21</volume>, <fpage>487</fpage>–<lpage>493</lpage>.<pub-id pub-id-type="pmid">21209072</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Korlach</surname>
 <given-names>J.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2017</year>) 
<article-title>De novo PacBio long-read and phased avian genome assemblies correct and add to genes important in neuroscience research</article-title>. <source>BioRxiv</source>, <fpage>103911</fpage>.</mixed-citation>
    </ref>
    <ref id="btaa835-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Laehnemann</surname>
 <given-names>D.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2016</year>) 
<article-title>Denoising DNA deep sequencing data-high-throughput sequencing errors and their correction</article-title>. <source>Brief. Bioinform</source>., <volume>17</volume>, <fpage>154</fpage>–<lpage>179</lpage>.<pub-id pub-id-type="pmid">26026159</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lau</surname>
 <given-names>B.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2016</year>) 
<article-title>Longislnd: in silico sequencing of lengthy and noisy datatypes</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>3829</fpage>–<lpage>3832</lpage>.<pub-id pub-id-type="pmid">27667791</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>
 <given-names>Y.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2020</year>) 
<article-title>Deepsimulator1. 5: a more powerful, quicker and lighter simulator for nanopore sequencing</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>2578</fpage>–<lpage>2580</lpage>.<pub-id pub-id-type="pmid">31913436</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Makałowski</surname>
 <given-names>W.</given-names></string-name>, <string-name><surname>Shabardina</surname><given-names>V.</given-names></string-name></person-group> (<year>2019</year>) 
<article-title>Bioinformatics of nanopore sequencing</article-title>. <source>J. Hum. Genet</source>., <bold>65</bold>, <fpage>1</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">30390021</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mantere</surname>
 <given-names>T.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2019</year>) 
<article-title>Long-read sequencing emerging in medical genetics</article-title>. <source>Front. Genet</source>., <volume>10</volume>, <fpage>426</fpage>.<pub-id pub-id-type="pmid">31134132</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ono</surname>
 <given-names>Y.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2013</year>) 
<article-title>PBSIM: PacBio reads simulator-toward accurate genome assembly</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>119</fpage>–<lpage>121</lpage>.<pub-id pub-id-type="pmid">23129296</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rang</surname>
 <given-names>F.J.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2018</year>) 
<article-title>From squiggle to basepair: computational approaches for improving nanopore sequencing read accuracy</article-title>. <source>Genome Biol</source>., <volume>19</volume>, <fpage>90</fpage>.<pub-id pub-id-type="pmid">30005597</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ross</surname>
 <given-names>M.G.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2013</year>) 
<article-title>Characterizing and measuring bias in sequence data</article-title>. <source>Genome Biol</source>., <volume>14</volume>, <fpage>R51</fpage>.<pub-id pub-id-type="pmid">23718773</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sedlazeck</surname>
 <given-names>F.J.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2018</year>) 
<article-title>Piercing the dark matter: bioinformatics of long-range sequencing and mapping</article-title>. <source>Nat. Rev. Genet</source>., <volume>19</volume>, <fpage>329</fpage>–<lpage>346</lpage>.<pub-id pub-id-type="pmid">29599501</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Simpson</surname>
 <given-names>J.T.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2017</year>) 
<article-title>Detecting DNA cytosine methylation using nanopore sequencing</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>407</fpage>–<lpage>410</lpage>.<pub-id pub-id-type="pmid">28218898</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stöcker</surname>
 <given-names>B.K.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2016</year>) 
<article-title>SimLoRD: simulation of long read data</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>2704</fpage>–<lpage>2706</lpage>.<pub-id pub-id-type="pmid">27166244</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Dijk</surname>
 <given-names>E.L.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2018</year>) 
<article-title>The third revolution in sequencing technology</article-title>. <source>Trends Genet</source>., <volume>34</volume>, <fpage>666</fpage>–<lpage>681</lpage>.<pub-id pub-id-type="pmid">29941292</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wei</surname>
 <given-names>Z.-G.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>S.-W.</given-names></string-name></person-group> (<year>2018</year>) 
<article-title>NPBSS: a new PacBio sequencing simulator for generating the continuous long reads with an empirical model</article-title>. <source>BMC Bioinformatics</source>, <volume>19</volume>, <fpage>177</fpage>.<pub-id pub-id-type="pmid">29788930</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weirather</surname>
 <given-names>J.L.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2017</year>) 
<article-title>Comprehensive comparison of Pacific Biosciences and Oxford Nanopore Technologies and their applications to transcriptome analysis</article-title>. <source>F1000Res</source>., <volume>6</volume>, <fpage>100</fpage>.<pub-id pub-id-type="pmid">28868132</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wick</surname>
 <given-names>R.</given-names></string-name></person-group> (<year>2019</year>) 
<article-title>Badread: simulation of error-prone long reads</article-title>. <source>J. Open Source Softw</source>., <volume>4</volume>, <fpage>1316</fpage>.</mixed-citation>
    </ref>
    <ref id="btaa835-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wick</surname>
 <given-names>R.R.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2019</year>) 
<article-title>Performance of neural network basecalling tools for Oxford Nanopore sequencing</article-title>. <source>Genome Biol</source>., <volume>20</volume>, <fpage>129</fpage>.<pub-id pub-id-type="pmid">31234903</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname>
 <given-names>C.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2017</year>) 
<article-title>NanoSim: nanopore sequence read simulator based on statistical characterization</article-title>. <source>GigaScience</source>, <volume>6</volume>, <fpage>1</fpage>–<lpage>6</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa835-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yoon</surname>
 <given-names>B.-J.</given-names></string-name></person-group> (<year>2009</year>) 
<article-title>Hidden Markov models and their applications in biological sequence analysis</article-title>. <source>Curr. Genomics</source>, <volume>10</volume>, <fpage>402</fpage>–<lpage>415</lpage>.<pub-id pub-id-type="pmid">20190955</pub-id></mixed-citation>
    </ref>
    <ref id="btaa835-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname>
 <given-names>W.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2019</year>) 
<article-title>PaSS: a sequencing simulator for PacBio sequencing</article-title>. <source>BMC Bioinformatics</source>, <volume>20</volume>, <fpage>1</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">30606105</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
