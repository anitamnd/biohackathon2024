<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7014741</article-id>
    <article-id pub-id-type="publisher-id">6528</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-020-6528-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Compacta: a fast contig clustering tool for de novo assembled transcriptomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Razo-Mendivil</surname>
          <given-names>Fernando G.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Martínez</surname>
          <given-names>Octavio</given-names>
        </name>
        <address>
          <email>octavio.martinez@cinvestav.mx</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7846-6124</contrib-id>
        <name>
          <surname>Hayano-Kanashiro</surname>
          <given-names>Corina</given-names>
        </name>
        <address>
          <email>angela.hayano@unison.mx</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2193 1646</institution-id><institution-id institution-id-type="GRID">grid.11893.32</institution-id><institution>Departamento de Investigaciones Científicas y Tecnológicas de la Universidad de Sonora, </institution><institution>Universidad de Sonora, </institution></institution-wrap>Hermosillo, Mexico </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2165 8782</institution-id><institution-id institution-id-type="GRID">grid.418275.d</institution-id><institution>Unidad de Genómica Avanzada (Langebio), </institution><institution>Centro de Investigacíon y de Estudios Avanzados del Instituto Politécnico Nacional (Cinvestav), </institution></institution-wrap>Irapuato, Gto Mexico </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>148</elocation-id>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>10</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>1</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">RNA-Seq is the preferred method to explore transcriptomes and to estimate differential gene expression. When an organism has a well-characterized and annotated genome, reads obtained from RNA-Seq experiments can be directly mapped to that genome to estimate the number of transcripts present and relative expression levels of these transcripts. However, for unknown genomes, de novo assembly of RNA-Seq reads must be performed to generate a set of contigs that represents the transcriptome. These contig sets contain multiple transcripts, including immature mRNAs, spliced transcripts and allele variants, as well as products of close paralogs or gene families that can be difficult to distinguish. Thus, tools are needed to select a set of less redundant contigs to represent the transcriptome for downstream analyses. Here we describe the development of <italic>Compacta</italic> to produce contig sets from de novo assemblies.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2"><italic>Compacta</italic> is a fast and flexible computational tool that allows selection of a representative set of contigs from de novo assemblies. Using a graph-based algorithm, <italic>Compacta</italic> groups contigs into clusters based on the proportion of shared reads. The user can determine the minimum coverage of the contigs to be clustered, as well as a threshold for the proportion of shared reads in the clustered contigs, thus providing a dynamic range of transcriptome compression that can be adapted according to experimental aims. We compared the performance of <italic>Compacta</italic> against state of the art clustering algorithms on assemblies from Arabidopsis, mouse and mango, and found that <italic>Compacta</italic> yielded more rapid results and had competitive precision and recall ratios. We describe and demonstrate a pipeline to tailor <italic>Compacta</italic> parameters to specific experimental aims.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3"><italic>Compacta</italic> is a fast and flexible algorithm for the determination of optimum contig sets that represent the transcriptome for downstream analyses.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>RNA-Seq</kwd>
      <kwd>de novo assembly</kwd>
      <kwd>Corset</kwd>
      <kwd>Grouper</kwd>
      <kwd>Transcriptomics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Consorcio de Fundaciones PRODUCE</institution>
        </funding-source>
        <award-id>A/GTO/RGAG-2014-076</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par9">RNA-Seq is the most frequently used method to explore transcriptomes, i.e., sets of mRNA molecules expressed in a cell, tissue, organ or whole organism under particular conditions [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. To generate samples for RNA-Seq, mRNA isolated from a given sample is converted to circular DNA (cDNA) that includes a mixture of fragments. The cDNA is sequenced to obtain ‘reads’ that represent parts of the original mRNA molecules. When a sample genome is known, the reads can be mapped to a reference sequence to reconstruct the transcripts and estimate their relative abundance.</p>
    <p id="Par10">However, when no genome is available, reads must be assembled de novo before attempting to reconstruct the expressed transcripts and estimate their relative abundance. Transcriptome assemblers including <italic>Trinity</italic> [<xref ref-type="bibr" rid="CR3">3</xref>], <italic>Soap</italic> de novo [<xref ref-type="bibr" rid="CR4">4</xref>], <italic>ABySS</italic> [<xref ref-type="bibr" rid="CR5">5</xref>] or <italic>Spades</italic> [<xref ref-type="bibr" rid="CR6">6</xref>], among others, perform this assembly to generate ‘contigs’ - sequences arising from reads that overlap or by the use of ‘Brujin graphs’ [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p id="Par11">De novo assembly of eukaryotic transcriptomes is challenging both due to dataset size that can include billions of reads and the difficulties in identifying alternatively spliced variants [<xref ref-type="bibr" rid="CR7">7</xref>], alternative gene alleles [<xref ref-type="bibr" rid="CR8">8</xref>], small variants within a gene family [<xref ref-type="bibr" rid="CR5">5</xref>] or close gene paralogs [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. This assembly problem is exacerbated by temporal transcription, wherein significant parts of the genome, both coding and non-coding segments, are transcribed only at specific points during development or under specific conditions [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. Moreover, a large fraction of reads can belong to nascent RNAs, and thus include introns that could contribute to many contigs in the assembly [<xref ref-type="bibr" rid="CR13">13</xref>]. As a result, transcriptome assemblies typically produce very large contig sets that in some cases are many-fold larger than the number of genes in the entire species genome. For example, de novo assembly of the transcriptome for the polychaete annelid <italic>Platynereis dumerilii</italic> using <italic>Trinity</italic> gave a set of 273,087 non-redundant contigs, which were identified through a pipeline that included sequence homology to only 17,213 genes [<xref ref-type="bibr" rid="CR14">14</xref>], nearly 16-fold fewer than the number of contigs.</p>
    <p id="Par12">Transcriptome assemblers output many contigs that reflect the diversity found in the original mixture of mRNA molecules. However, for downstream analyses, these large contig collections must be culled to yield a smaller and more tractable set, which ideally groups contigs into transcripts produced by the same gene. Methods to group contigs can involve the use of sequence information, such as <italic>cd-hit-est</italic> [<xref ref-type="bibr" rid="CR15">15</xref>], or use only the information about which reads map to each contig. The two main programs using the second approach are <italic>Corset</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] and <italic>Grouper</italic> [<xref ref-type="bibr" rid="CR17">17</xref>].</p>
    <p id="Par13"><italic>Corset</italic> takes the set of reads and hierarchically clusters the contigs based on the proportion of shared reads. The program first filters out contigs that have a low number of mapped reads (<italic>&lt;</italic> 10 by default) and then cluster contigs based on shared reads, while separating contigs having different expression patterns between samples. This approach thus avoids placing two or more paralogs or alternatively spliced forms into the same cluster through the use of a likelihood ratio test across groups of samples having a fixed <italic>P</italic> value threshold of approximately 10<sup>− 5</sup>. A distance threshold for clustering can be set by the user, but the default value of 0.3 is equivalent to sharing of 70% of the reads between two entities, i.e., original contigs or clusters already obtained by the algorithm. The number of shared reads is also updated at each iteration and clustering of a contig set stops when either all the contigs have been grouped into a single cluster or the current minimum distance increases above the distance threshold.</p>
    <p id="Par14">The <italic>Corset</italic> algorithm has two disadvantages: First, it uses a fixed number of reads to assess contig coverage, disregarding contig and read lengths; Second, and perhaps more importantly, the <italic>Corset</italic> algorithm depends heavily on results of a likelihood ratio test to segregate into clusters those contigs that could be the product of two different genes. The nature and number of conditions used to obtain different transcriptome samples can be unpredictable and, in principle, extremely diverse. However, <italic>Corset</italic> output depends on these conditions and thus groups working with the same organism could conceivably obtain significantly different sets of clusters to represent the transcriptome. Also, for annotation of ongoing eukaryotic genome projects, an equimolar mixture of RNA from different tissues of the same species is sequenced [<xref ref-type="bibr" rid="CR18">18</xref>]; in these cases the approach used by <italic>Corset</italic> that segregates contigs from the same gene is not useful because only one ‘condition’ is used and thus a maximum likelihood test cannot be performed.</p>
    <p id="Par15"><italic>Grouper</italic> is another algorithm that generates contig clusters based on shared reads. Similar to <italic>Corset</italic>, outputs generated by the <italic>Grouper</italic> algorithm exclude contigs having fewer than 10 reads; this threshold cannot be modified by the user. Also, like <italic>Corset</italic>, <italic>Grouper</italic> uses a likelihood ratio test of expression estimates that vary significantly across conditions to separate contigs under the assumption that such contigs arose from different paralogous genes. Optional <italic>Grouper</italic> filters allow information for ‘orphan’ reads (when paired reads are used), whereas the ‘min-cut’ filter uses the likelihood ratio test to completely separate contigs, thus avoiding long path joining. Interestingly, <italic>Grouper</italic> does not have a user adjustable threshold for weight (or distance) by which contigs are clustered and instead relies only on the abovementioned filters to cluster or segregate contigs. <italic>Grouper</italic> also has an associated module to label (annotate) clusters using information from a closely related genome.</p>
    <p id="Par16"><italic>Grouper</italic> shares the same disadvantages with <italic>Corset</italic>, i.e., the program uses an arbitrary minimum number of reads to consider whether a contig is valid (in <italic>Grouper</italic> the user cannot modify this value) and contig segregation depends on the RNA-Seq experimental conditions.</p>
    <p id="Par17">The ideal behavior for an algorithm to cluster contigs obtained by de novo assembly of a transcriptome would be to output a group of clusters (contig sets) that perfectly represent actual gene expression, i.e., a set wherein the relationship between cluster and gene is one to one. There are strong arguments concerning the impossibility of obtaining such an ‘ideal’ algorithm in the absence of detailed knowledge about the genome sequence in question and using only the information given by multi-mapping files that relate reads to contigs. In mathematical terms, we have an identifiability problem, meaning that different sets of parameters (genes) can give a set of reads having identical statistical profiles (number of reads per contigs), making it impossible to determine the set of genes that generated the output. As clearly demonstrated by [<xref ref-type="bibr" rid="CR19">19</xref>], to correctly identify transcripts based entirely on RNA-Seq data, at minimum gene-boundary data are needed, and data concerning transcription start sites, splice junctions and polyadenylation sites are also useful. As noted by Boley et al. [<xref ref-type="bibr" rid="CR19">19</xref>], “This means that it is not always possible to positively identify alternative transcript isoforms, even as the read depth approaches infinity”. Confronted with the problem of clustering contigs from an unknown genome, we have no information concerning factors such as genome size and complexity [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>], allele and gene copy variations [<xref ref-type="bibr" rid="CR22">22</xref>] or variations in exon-intron architecture [<xref ref-type="bibr" rid="CR23">23</xref>]. Under this scenario, the best use of information from de novo assembly is formation of a contig cluster that can be used to identify the core set of expressed genes that allows the most effective comparison of the relative expression of such entities based on the design of the RNA-Seq experiment.</p>
    <p id="Par18">With the aim of reducing the complexity of RNA-Seq data analyses, we present <italic>Compacta</italic>, a fast, flexible, and computationally efficient way to group contigs obtained from de novo assembly into clusters to represent the core set of genes expressed in a given experiment as well as to allow identification of gene sets and enhance statistical power for detection of differential expression. The algorithm depends on only two parameters: filtering of low coverage contigs based on effective coverage and clustering strength. After running <italic>Compacta</italic>, a single contig, representing each cluster obtained, can be used for downstream analyses for gene identification and detection of differential gene expression.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par19"><italic>Compacta</italic> is designed to reduce the number of contigs to a smaller set of representative sequences while preserving the information about relative expression given by read abundance. Its output can be used for downstream analyses to identify contigs and differential gene expression patterns.</p>
    <p id="Par20">Prior to using <italic>Compacta</italic>, transcriptomes must be assembled de novo using tools such as <italic>Trinity</italic> [<xref ref-type="bibr" rid="CR3">3</xref>], <italic>Soap</italic> de novo [<xref ref-type="bibr" rid="CR4">4</xref>] or <italic>Spades</italic> [<xref ref-type="bibr" rid="CR6">6</xref>]. Sequencing reads are then mapped back to the assembled transcriptome using alignment-based software such as <italic>Bowtie2</italic> [<xref ref-type="bibr" rid="CR24">24</xref>] or <italic>Hisat2</italic> [<xref ref-type="bibr" rid="CR25">25</xref>] to obtain a multi-mapped binary file in the ‘BAM’ format [<xref ref-type="bibr" rid="CR26">26</xref>]. BAM files are the initial input for Compacta and contain information about the contig set given by the assembler as well as the reads that map to each set.</p>
    <p id="Par21"><italic>Compacta</italic> has two core parameters, −d = <italic>d</italic>, a threshold for when two contigs belong to the same cluster, and -l = <italic>l</italic>, the threshold needed for the minimum effective coverage for a contig to enter the clustering algorithm. The value for <italic>d</italic> ranges between zero and one and controls the extent of clustering. When <italic>d</italic> = 0<italic>.</italic>3, for example, all pairs of contigs sharing 30% or more of the reads that reference the contig having fewer reads will be clustered into a single entity. Meanwhile, <italic>l</italic> = 2 implies that only those contigs having a total coverage that is twice the contig length in terms of sequencing read lengths will enter into the clustering process. Default values for these two parameters are <italic>d</italic> = 0<italic>.</italic>3 and <italic>l</italic> = 2, which are determined in the input as “-d 0.3 -l 2”. In addition to file locations, <italic>Compacta</italic> includes options for number and names of samples and experimental groups, as well as options that allow parallelization of part of the algorithm.</p>
    <p id="Par22"><italic>Compacta</italic> output comprises files that: (i) define the obtained clusters as sets of the original contigs; (ii) give the number of reads (raw count) of each cluster for each sample input; and (iii) describe the type of clusters obtained. The following list describes the parameters of the Compacta algorithm.
<list list-type="order"><list-item><p id="Par23"><bold>Input.</bold> A set of BAM files and <italic>Compacta</italic> options. BAM file data are parsed for the next step. The sample origin of reads is preserved for inclusion in the output.</p></list-item><list-item><p id="Par24"><bold>Graph computation.</bold> From sets of <italic>c</italic> contigs and <italic>r</italic> reads in BAM files, <italic>Compacta</italic> creates an undirected graph with <italic>c</italic> vertices corresponding to contigs and <italic>c</italic>(<italic>c</italic> − 1)<italic>/</italic>2 connections (edges) between vertices. The weight, <italic>w</italic><sub><italic>ij</italic></sub>, of an edge connecting contigs <italic>i</italic> and <italic>j</italic>; <italic>i</italic>
<sup><italic>−</italic></sup>
<italic>j</italic>, is calculated
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {w}_{ij}=\frac{R_{ij}}{\mathit{\min}\left({R}_j\right)} $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:msub><mml:mi>w</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mrow><mml:mo mathvariant="italic">min</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12864_2020_6528_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list>where <italic>R</italic><sub><italic>i</italic></sub> and <italic>R</italic><sub><italic>j</italic></sub> are the number of reads that independently map to contigs <italic>i</italic> and <italic>j</italic>, respectively, while <italic>R</italic><sub><italic>ij</italic></sub> is the total number of reads that map to both contigs <italic>i</italic> and <italic>j</italic>; i.e., <italic>R</italic><sub><italic>ij</italic></sub> is the number of reads shared by contigs <italic>i</italic> and <italic>j</italic>. This function is well defined since min (<italic>R</italic><sub><italic>i</italic></sub><italic>,R</italic><sub><italic>j</italic></sub>) <italic>&gt;</italic> 0. The weight of an edge, <italic>w</italic><sub><italic>ij</italic></sub>, ranges from zero, when the edge contigs share no sequencing reads indicating no similarity (disconnected contigs), to one, indicating that one of the contigs is a proper subset of the other.
<list list-type="order"><list-item><p id="Par25"><bold>Filtering of low evidence contigs.</bold> The value <italic>c</italic><sub><italic>i</italic></sub> is defined as the length of contig <italic>i</italic> and <italic>s</italic><sub><italic>i</italic></sub> is the sum of the lengths of all reads that map to that contig. If <italic>s</italic><sub><italic>i</italic></sub> <italic>&lt;</italic> (<italic>l</italic> × <italic>c</italic><sub><italic>i</italic></sub>), where <italic>l</italic> is the parameter ‘-l’ input by the user, the contig <italic>i</italic> is disconnected from any other vertices in the graph and will be reported as a ‘low evidence contig’. Disconnection of contig <italic>i</italic> implies setting all weights <italic>w</italic><sub><italic>ij</italic></sub> = 0 for all values of <italic>j</italic>, in turn implying that when the set of contigs considered in subsequent algorithm steps fulfill the condition <italic>s</italic><sub><italic>i</italic></sub> ≥ (<italic>l</italic> × <italic>c</italic><sub><italic>i</italic></sub>), they are considered to be contigs with sufficient evidence of expression.</p></list-item><list-item><p id="Par26"><bold>Pre-cluster detection.</bold> Connected contigs (vertices) are detected and isolated sub-graphs are marked as ‘pre-clusters’ that are each loaded into a heap structure self-ordered by edge weight, ensuring that the first value in the heap is always the edge having the heaviest weight, i.e., the largest value of <italic>w</italic><sub><italic>ij</italic></sub>.</p></list-item><list-item><p id="Par27"><bold>Clustering.</bold><italic>Compacta</italic> processes each pre-cluster using an agglomerative algorithm. At each iteration, the algorithm selects the edge having the highest weight and, if this weight is above the defined threshold <italic>d</italic> (parameter input as -d), the nodes are grouped into a new entity. In this scenario, weights, <italic>w</italic><sub><italic>ij</italic></sub>, are re-calculated for the new conformation of the pre-cluster and the process is repeated until the first edge in the heap has a weight that is less than the threshold <italic>d</italic> or all its contigs are clustered together. The final content of the heap structure, which can contain one or more clusters, goes to the output.</p></list-item><list-item><p id="Par28"><bold>Output.</bold> Once <italic>Compacta</italic> processes all pre-clusters, it produces files that include the description of each cluster (sets of the original contigs), as well as lists indicating which contig could represent each one of the clusters, either by being the longest contig in the cluster or the one that has the largest number of reads mapping to it.</p></list-item></list></p>
    <p id="Par29">In summary, from BAM files containing the information of the original contigs and reads mapping to them, <italic>Compacta</italic> produces a set of representative contigs for use in downstream analyses.</p>
    <sec id="Sec3">
      <title>Algorithm implications</title>
      <p id="Par30">As with other software designed to reduce transcriptome complexity, such as <italic>Corset</italic> or <italic>Grouper</italic>, <italic>Compacta</italic> uses a graphical approach that ignores nucleotide sequence and considers contigs only as sets of sequencing reads. Two contigs, <italic>i</italic> and <italic>j</italic>, will be connected in the graph if they share some reads, i.e., if their intersection is not empty and <italic>w</italic><sub><italic>ij</italic></sub> <italic>&gt;</italic> 0. In step (2) of the algorithm, the graph is constructed. Even when in principle all pair comparisons between contigs must be performed, only the ones for which the weights are larger than zero (<italic>w</italic><sub><italic>ij</italic></sub> <italic>&gt;</italic> 0) need to be stored and analyzed downstream. The logic behind weight calculation is that contigs sharing a large proportion of reads will also be ‘alike’ at the sequence level, allowing read position within contigs to be disregarded. Thus, if <italic>w</italic><sub><italic>ij</italic></sub> = 0 we will consider that the corresponding contigs are completely unrelated, whereas <italic>w</italic><sub><italic>ij</italic></sub> = 1 means that the smaller contig is a proper subset of the second, or, when they are the same size, they will be some permutation of the positions of the same reads.</p>
      <p id="Par31">In step (3) of the algorithm, <italic>Compacta</italic> uses effective contig coverage, expressed as the number of times that the full-length contig is covered by reads, as a measure to detect and discard low evidence contigs. The user controls the strength of filtering via parameter <italic>l</italic>; By setting <italic>l</italic> = 3, for example, only those contigs having sufficient numbers of reads to cover the contig length three times will pass the filter and continue for downstream analysis. This parameter allows the user to limit the subset of contigs of interest. Thus, if only those genes having high expression levels are relevant, <italic>l</italic> can be set to a high value. Filtered contigs are not discarded, but are included in the output in which they are identified as ‘low evidence singletons’. In contrast, <italic>Corset</italic> and <italic>Grouper</italic> allow selection of contigs only through a fixed threshold in the number of reads that map to each contig, independently of contig length. In <italic>Corset</italic> this threshold can be changed by the user and by default is set to 10, while in <italic>Grouper</italic> the threshold is fixed as 10 reads. However, a fixed threshold number of reads is inadequate to judge contigs having different lengths. For example, consider the situation in which reads of 250 bp are used and a contig of length 750 bp is produced by 9 overlapping reads. Here, the effective contig coverage is (250 × 9)<italic>/</italic>750 = 3, and <italic>Compacta</italic> will reasonably pass such a highly covered contig for any value of <italic>l</italic> ≤ 3, whereas <italic>Corset</italic> and <italic>Grouper</italic> would discard such a contig considering it as ‘low coverage’, and thus it would not appear in the output.</p>
      <p id="Par32">The graph constituted by all contig pairs having <italic>w</italic><sub><italic>ij</italic></sub> <italic>&gt;</italic> 0 are input into the fourth step of the algorithm, ‘pre-cluster detection’. Here a pre-cluster is defined as a set of inter-connected contigs, or, in graph theory terms, as a ‘connected graph’ [<xref ref-type="bibr" rid="CR27">27</xref>]. In simple terms, in a pre-cluster there is a path that connects, either directly or indirectly, all contigs that form such a structure. If a pre-cluster graph is plotted, it is possible to go from any of the contigs to any other contig by following a path. An important computational advantage of <italic>Compacta</italic> is that each pre-cluster is loaded into a self-ordered heap structure, in which the first edge always has the largest <italic>w</italic><sub><italic>ij</italic></sub> value. This heap structure is similar to ordered binary trees, and can save considerable time [<xref ref-type="bibr" rid="CR28">28</xref>], because arrays having millions of components are not sorted at each iteration.</p>
      <p id="Par33">The core of the <italic>Compacta</italic> algorithm is step (5), involving agglomerative clustering of connected contigs or ‘pre-clusters’ that can be performed in parallel. The processing of each pre-cluster is independent of other data, and thus its clustering can be sent as an independent thread, making optimal use of computer resources. With the same goal, sets of pre-clusters could be distributed to independent nodes in computer clusters. Clustering of a pre-cluster structure proceeds by grouping into a single entity pairs of sets having weight <italic>w</italic><sub><italic>ij</italic></sub> that surpass the threshold <italic>d</italic> input by the user. Given that the pre-cluster is loaded into a self-ordered heap, the algorithm needs only to analyze the first element of the heap, thus saving valuable time. Clustering of two entities, <italic>i</italic> and <italic>j</italic> (that could be original contigs or previously identified clusters), happens only if <italic>w</italic><sub><italic>ij</italic></sub> ≥ <italic>d</italic> and in that case both entities are grouped together, after which weights between the new entity and all those in the pre-cluster are re-calculated and the algorithm iterated. In the opposite case, such as when <italic>w</italic><sub><italic>ij</italic></sub> <italic>&lt; d</italic> during the iterations, the entire content of the heap is sent to the output, including the definitions of clusters and the number of reads that map to them. This process guarantees that the number of entities in the output is smaller than or at most equal to the number of input contigs. A simple example of this process is presented in Section 1 of Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      <p id="Par34">Any contig clustering algorithm that does not use direct sequence information but instead uses a graphical approach must have a parameter homolog to the weight threshold <italic>d</italic> used by <italic>Compacta</italic>. For example, in <italic>Corset</italic> and <italic>Grouper</italic> this homolog parameter is the distance between contigs, which is simply the inverse additive of <italic>Compacta d</italic>, i.e., 1 − <italic>d</italic> for the threshold and 1 − <italic>w</italic><sub><italic>ij</italic></sub> for the weights, which in these programs are conceptualized as distances. In addition to the criterion used to filter ‘low evidence contigs’ as mentioned earlier, computational implementation of <italic>Compacta</italic> differs from those in <italic>Corset</italic> and <italic>Grouper</italic> in the use of efficient self-sorting heap structures to dynamically store pre-clusters, which in turn allows the clustering step of <italic>Compacta</italic> to be fully parallelized or distributed, thus making optimum use of computer resources, including multi-core clusters.</p>
      <p id="Par35">Another substantial way that <italic>Compacta</italic> differs from <italic>Corset</italic> and <italic>Grouper</italic> is that <italic>Compacta</italic> uses no computational methods to determine if two contigs were the product of transcription from ‘the same gene’, whereas both <italic>Corset</italic> and <italic>Grouper</italic> attempt to estimate and consider contig origin. In our opinion, in the absence of genomic information, accurate prediction of whether two contigs are the product of: a) different alleles of the same gene, b) alternative splicing forms produced from the same gene or c) two highly similar genes (close paralogs or two close members of the same gene family) is essentially impossible due to the high diversity and conformations of eukaryotic genomes.</p>
      <p id="Par36"><italic>Compacta</italic> will be particularly useful when no genome is available for a given organism, and the researcher wants to: a) Have a core set of sequences representing the major expressed genes that allows putative identification via comparisons with well-known orthologs; and b) Perform differential expression analysis of core genes expressed in the transcriptome. To achieve these aims, the ability to downsize the potentially very large number of contigs given by the assembler into a smaller and more manageable set of representative sequences is valuable.</p>
    </sec>
    <sec id="Sec4">
      <title>Adjusting <italic>Compacta</italic> to assembly complexity</title>
      <p id="Par37">RNA-Seq experiments capture many transcript types such as nascent or pre-mature RNAs [<xref ref-type="bibr" rid="CR13">13</xref>] or non-coding sequences like long non-coding RNAs [<xref ref-type="bibr" rid="CR29">29</xref>]. In fact, the ratio of transcribed non-coding to coding sequences can vary enormously; in humans this ratio is 47:1, but in nematodes is only 1.3:1 [<xref ref-type="bibr" rid="CR30">30</xref>]. The assembly process is likely to yield many related contigs that represent transcription variants of the same gene as alternative splicing forms, alleles, or products of the transcription of close paralogs of the same gene or gene family. Here we discuss the features that Compacta offers to reduce assembly complexity in a general framework.</p>
      <p id="Par38">Given a particular assembly, say <bold>t</bold>, consisting of a group of <italic>c</italic> contigs and <italic>r</italic> reads related by multi-mapping files (‘BAM’ files), we can use <italic>Compacta</italic> to reduce the set of c contigs to a smaller set of <italic>z</italic> representative clusters such that <italic>z</italic> ≤ <italic>c</italic>. Apart from filtering low-evidence contigs with the parameter -l = <italic>l</italic>, the number of clusters given by the algorithm is a function only of the parameter <italic>d</italic> –the threshold for clustering contigs into clusters, say <italic>f</italic>(<bold>t</bold><italic>,d</italic>) = <italic>z</italic>, or simply <italic>f</italic>(<italic>c,d</italic>) = <italic>z</italic>, considering only the number of input contigs, <italic>c</italic>, and the number of clusters output, <italic>z</italic>. By setting <italic>d</italic> = 0 we will cluster all contigs that share one or more reads, because in that case all contig pairs {<italic>i,j</italic>} that fulfill <italic>R</italic><sub><italic>ij</italic></sub> <italic>&gt;</italic> 0 will give a weight <italic>w</italic><sub><italic>ij</italic></sub> <italic>&gt;</italic> 0 and thus be clustered together, giving the smallest number of clusters in the output. The number of clusters resulting from that operation can be termed <italic>z</italic><sub><italic>min</italic></sub>, where <italic>f</italic>(<italic>c,d</italic> = 0) = <italic>z</italic><sub><italic>min</italic></sub>, which represents the maximum assembly reduction that can be achieved by the algorithm. By clustering all contigs with the slightest evidence of sequence similarity (i.e., one or more shared reads) we can group all alleles, alternative splicing variants and close paralogs genes into a single cluster. However, using this approach we could also group into a single cluster transcripts produced by different genes that share sequence motifs that expand in sequence length beyond the length of a single read. Under the same experimental conditions, and with high sequencing depth, we can assume that read length will have a strong effect in determining the value of <italic>z</italic><sub><italic>min</italic></sub>; short reads will cause <italic>z</italic><sub><italic>min</italic></sub> to be smaller than when long reads are used. On the other hand, if <italic>d</italic> is set to 1, we will ask the algorithm to group only contigs that share all reads of the smaller contig, because in order to have <italic>w</italic><sub><italic>ij</italic></sub> = <italic>R</italic><sub><italic>ij</italic></sub><italic>/</italic>min (<italic>R</italic><sub><italic>i</italic></sub><italic>,R</italic><sub><italic>j</italic></sub>) = 1 we must have <italic>R</italic><sub><italic>ij</italic></sub> = <italic>R</italic><sub><italic>i</italic></sub> or <italic>R</italic><sub><italic>ij</italic></sub> = <italic>R</italic><sub><italic>j</italic></sub>. In that case, we will have a maximum number of clusters in the output, where <italic>f</italic>(<italic>c,d</italic> = 1) = <italic>z</italic><sub><italic>max</italic></sub>, such that <italic>Compacta</italic> will cluster only those contigs that are proper subsets of the longest contig in the group (pre-cluster) and will likely produce clusters containing only highly similar gene alleles, splicing forms that share most exons in the genes, or very close paralogs. Taken together, from this analysis we can conclude that <italic>f</italic>(<italic>c,d</italic>) = <italic>z</italic> is a non-decreasing function of <italic>d</italic> with domain in the interval [0<italic>,</italic>1] for <italic>d</italic> and co-domain in [<italic>z</italic><sub><italic>min</italic></sub><italic>,z</italic><sub><italic>max</italic></sub>] for <italic>z</italic>. The fact that <italic>f</italic>(<italic>c,d</italic>) = <italic>z</italic> is non-decreasing follows from the fact that a larger value of <italic>d</italic> can only increase the number of output clusters, <italic>z</italic>, given that the clustering algorithm will be more stringent, i.e., if <italic>d</italic><sub>1</sub> <italic>&lt; d</italic><sub>2</sub> then <italic>f</italic>(<italic>c,d</italic><sub>1</sub>) ≤ <italic>f</italic>(<italic>c,d</italic><sub>2</sub>). Due to the speed of <italic>Compacta</italic>, performing two runs with extreme values, <italic>d</italic> = 0 and <italic>d</italic> = 1, to obtain the values of <italic>z</italic><sub><italic>min</italic></sub> and <italic>z</italic><sub><italic>max</italic></sub> for a particular assembly is not computationally expensive. Having the range of possible <italic>z</italic> values allows the researcher to fix a target value <italic>z</italic><sup>∗</sup>, <italic>z</italic><sub><italic>min</italic></sub> ≤ <italic>z</italic><sup>∗</sup> ≤ <italic>z</italic><sub><italic>max</italic></sub>, and, using a numerical method, obtain the value of <italic>d</italic> (e.g., <italic>d</italic><sup>∗</sup>), such that <italic>f</italic>(<italic>c,d</italic><sup>∗</sup>) ≈ <italic>z</italic><sup>∗</sup> by performing a set of Compacta runs.</p>
    </sec>
    <sec id="Sec5">
      <title>Source data and software evaluation</title>
      <p id="Par39">Three RNA-Seq datasets from Arabidopsis (<italic>Arabidopsis thaliana</italic>), mango (<italic>Mangifera indica</italic>) and mouse (<italic>Mus musculus</italic>) were processed to compare <italic>Compacta</italic> with other clustering tools.</p>
      <p id="Par40">In Table <xref rid="Tab1" ref-type="table">1</xref> the ‘Source’ column provides the reference for the corresponding dataset; the column ‘Accession’ shows accession identifiers for data deposited in the Sequence Read Archive [<xref ref-type="bibr" rid="CR34">34</xref>] of GenBank; the column ‘Reads (Gb)’ indicates the approximate giga base pairs of raw data; and ‘Contigs’ shows the number of contigs obtained from the assembly. The Arabidopsis and mouse datasets were assembled de novo using the <italic>Trinity</italic> assembler version 2.4.0 with default parameters, whereas the mango dataset assembly generated by <italic>Trinity</italic> was kindly provided by Dr. Miguel A. Hernández Oñate [<xref ref-type="bibr" rid="CR32">32</xref>].
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Data sources. Sources and characteristics of the RNA-Seq data used in this study</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Organism</th><th>Source</th><th>Accession</th><th>Reads (Gb)</th><th>Contigs</th></tr></thead><tbody><tr><td>Arabidopsis</td><td>[<xref ref-type="bibr" rid="CR31">31</xref>]</td><td>ERP016911</td><td>36.0</td><td>106,895</td></tr><tr><td>Mango</td><td>[<xref ref-type="bibr" rid="CR32">32</xref>]</td><td>SRP043494</td><td>62.5</td><td>107,744</td></tr><tr><td>Mouse</td><td>[<xref ref-type="bibr" rid="CR33">33</xref>]</td><td>PRJNA474181</td><td>41.0</td><td>327,616</td></tr></tbody></table></table-wrap></p>
      <p id="Par41"><italic>Compacta</italic>, <italic>Corset</italic> and <italic>Grouper</italic> were run with default parameters using as input the contigs for each assembly obtained from the sources shown in Table <xref rid="Tab1" ref-type="table">1</xref> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).
<fig id="Fig1"><label>Fig. 1</label><caption><p>Execution time for <italic>Compacta, Corset</italic> and <italic>Grouper</italic> in three assemblies. Bar diagram of running time in hours for <italic>Compacta</italic>, <italic>Corset</italic> and <italic>Grouper</italic> algorithms to analyze assemblies from Arabidopsis, mango and mouse. Numbers in the upper bars for <italic>Corset</italic> and <italic>Grouper</italic> are the number of rounds that the execution took for the corresponding program compared with the <italic>Compacta</italic> execution time</p></caption><graphic xlink:href="12864_2020_6528_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par42">Results shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref> were obtained using Arabidopsis assembly contigs (see Table <xref rid="Tab1" ref-type="table">1</xref>) and performing repeated runs of <italic>Compacta</italic> using different values of the <italic>d</italic> parameter, whereas all contigs from such assemblies were identified by comparing those sequences using stringent <italic>BLAST</italic> parameters [<xref ref-type="bibr" rid="CR35">35</xref>] with the set of all possible Arabidopsis transcripts. Details of this analysis are given in Section 3 of Additional file <xref rid="MOESM1" ref-type="media">1</xref>.
<fig id="Fig2"><label>Fig. 2</label><caption><p><italic>Compacta</italic> results for the Arabidopsis assembly. Values for <italic>d</italic> are displayed on the <italic>X</italic>-axis and the <italic>Y</italic>-axis shows the percentage of clusters (<italic>z</italic>; red line), number of Arabidopsis sequences identified (<italic>n</italic><sub><italic>As</italic></sub>; blue dotted line) and efficiency (<italic>Ef = n</italic><sub><italic>As</italic></sub><italic>/z</italic>; green dashed line) as a function of <italic>d</italic></p></caption><graphic xlink:href="12864_2020_6528_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par43">Results presented in Fig. <xref rid="Fig3" ref-type="fig">3</xref> were obtained by running <italic>CD-HIT</italic>, <italic>Compacta</italic>, <italic>Corset</italic>, <italic>Grouper</italic> and the clustering facility of the <italic>Trinity</italic> suite on the contigs from assemblies of the Arabidopsis and mouse datasets (Table <xref rid="Tab1" ref-type="table">1</xref>); details of these experiments as well as additional analyses are given in Sections 2 and 3 of Additional file <xref rid="MOESM1" ref-type="media">1</xref>.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Estimated Recall and Precision of 5 programs in two assemblies. Bar plots for Recall (upper) and Precision (lower) of 5 de novo assembly clustering algorithms applied to two assemblies, Arabidopsis (left) and mouse (right)</p></caption><graphic xlink:href="12864_2020_6528_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Results and discussion</title>
    <sec id="Sec7">
      <title><italic>Compacta</italic> is faster than clustering alternatives</title>
      <p id="Par44">To evaluate the absolute and relative execution time for <italic>Compacta</italic>, <italic>Corset</italic> and <italic>Grouper</italic> we used three transcriptomes from Arabidopsis, mango (<italic>Mangifera indica</italic>) and mouse (<italic>Mus musculus</italic>) assembled de novo that included 106,895, 107,744 and 327,616 contigs, respectively. All three algorithms were run with default parameters and the run time for each program with each assembly was obtained (Fig. <xref rid="Fig1" ref-type="fig">1</xref>; see Material and Methods for details). Table <xref rid="Tab2" ref-type="table">2</xref> shows the number of clusters output by <italic>Compacta</italic>, <italic>Corset</italic> and <italic>Grouper</italic> for the Arabidopsis, mouse and mango datasets. <italic>Compacta</italic> produced a larger number of contigs in the Arabidopsis and mouse real datasets, and the smaller number of contigs for the mango dataset and the simulated datasets of Arabidopsis and mouse. This reflects the fact that <italic>Corset</italic> and <italic>Grouper</italic> do not include contigs with low coverage in their output, while <italic>Compacta</italic> includes contigs with low coverage as single contig clusters.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Number of representative contigs selected by each algorithm from each transcriptome when run with default parameters</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2"/><th colspan="2">Arabidopsis</th><th colspan="2">Mouse</th><th>Mango</th></tr><tr><th>Real</th><th>Simulated</th><th>Real</th><th>Simulated</th><th>Real</th></tr></thead><tbody><tr><td>Compacta</td><td>33,542</td><td>21,518</td><td>223,169</td><td>19,844</td><td>28,356</td></tr><tr><td>Corset</td><td>27,080</td><td>26,414</td><td>95,079</td><td>23,716</td><td>38,448</td></tr><tr><td>Grouper</td><td>27,949</td><td>23,026</td><td>57,501</td><td>18,652</td><td>38,063</td></tr></tbody></table></table-wrap></p>
      <p id="Par45">In Fig. <xref rid="Fig1" ref-type="fig">1</xref> the bar height corresponds to the run time for each program (bar group; <italic>X</italic>-axis) operating on the three assemblies that are denoted by different colors. The numbers above the bars for “Corset” and “Grouper” groups give the time taken by the program divided by the time taken by <italic>Compacta</italic> to analyze the same assembly. For example, the number 28 above the red bar for the “Corset” group indicates that <italic>Corset</italic> took approximately 28-fold more time to finish the run for the Arabidopsis assembly than <italic>Compacta</italic> (26<italic>.</italic>6186 <italic>h/</italic>0<italic>.</italic>9675 <italic>h</italic> ≈ 28).</p>
      <p id="Par46"><italic>Compacta</italic> was approximately 28-, 25- and 197-fold faster than <italic>Corset</italic> for the Arabidopsis, mango and mouse assemblies, respectively. The differences in execution time could be attributed to two factors: First, <italic>Corset</italic> uses a statistical formula to try to evaluate the gene of origin for each contig and <italic>Compacta</italic> does not; and Second, <italic>Compacta</italic> uses auto-sorting heaps, whereas <italic>Corset</italic> sorts all remaining contigs pairs in each iteration. A basic agglomerative clustering algorithm, such as that implemented for <italic>Corset</italic>, has a computation time of <italic>O</italic>(<italic>n</italic><sup>3</sup>) and slows as the input size increases, as demonstrated by [<xref ref-type="bibr" rid="CR28">28</xref>]. As mentioned above, <italic>Compacta</italic> uses an agglomerative algorithm with a heap that auto-sorts elements upon insertion and deletion that reduces computation time up to <italic>O</italic>(<italic>n</italic><sup>2</sup> log<italic>n</italic>) [<xref ref-type="bibr" rid="CR28">28</xref>], which is considerably faster than the other algorithms, particularly when the size of the input data increases. Although <italic>Compacta</italic> may not always be faster than <italic>Corset</italic> for all possible assemblies, we predict that <italic>Compacta</italic> will be at least 10 times faster than <italic>Corset</italic> for any complex assembly from eukaryotic organisms. This prediction is based not only on our experimental results (Fig. <xref rid="Fig1" ref-type="fig">1</xref>), but also in the fundamentally more efficient way in which <italic>Compacta</italic> handles contig clustering by avoiding sorting the pre-cluster structure at each iteration, which adds significantly to the <italic>Corset</italic> run time.</p>
      <p id="Par47">On the other hand, in comparing <italic>Grouper</italic> and <italic>Compacta</italic> we see that <italic>Compacta</italic> is faster than <italic>Grouper</italic> for the mango and mouse assemblies by 15- and 340-fold, respectively, but slower for the Arabidopsis assembly for which <italic>Compacta</italic> took 0.9675 h and Grouper took only 0.1332 h, a ratio of ≈ 0<italic>.</italic>1 in favor of <italic>Grouper</italic>. The difference seen between <italic>Grouper</italic> and <italic>Compacta</italic> in processing the Arabidopsis assembly is due to <italic>Grouper</italic>’s use of equivalence files, which are simpler to parse and contain less information than the BAM files used by <italic>Compacta</italic>. However, for larger and more complex assemblies, such as those for mango and mouse, input file parsing represents a much small fraction of the total processing time, such that <italic>Compacta</italic> is faster than <italic>Grouper</italic> (c.f., <italic>Compacta</italic> was 340-fold faster than <italic>Grouper</italic> for the mouse assembly; last bar in Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Moreover, <italic>Grouper</italic> relies on a Stoer–Wagner min-cut function that is repeatedly executed with a computation time of <italic>O</italic> (<italic>mn</italic> + <italic>n</italic><sup>2</sup> log<italic>n</italic>) [<xref ref-type="bibr" rid="CR36">36</xref>], whereas <italic>Compacta</italic> uses the auto-sorting heap that has an execution time of <italic>O</italic>(<italic>n</italic><sup>2</sup> log<italic>n</italic>) [<xref ref-type="bibr" rid="CR28">28</xref>]. Conservatively, <italic>Compacta</italic> is at least 10-fold faster than <italic>Grouper</italic> for clustering complex eukaryotic assemblies.</p>
    </sec>
    <sec id="Sec8">
      <title><italic>Compacta</italic> adaptability to RNA-Seq objectives</title>
      <p id="Par48">As shown above, <italic>Compacta</italic> can be adjusted through the <italic>d</italic> parameter to give a number of clusters within the range [<italic>z</italic><sub><italic>min</italic></sub><italic>,z</italic><sub><italic>max</italic></sub>], where <italic>z</italic><sub><italic>min</italic></sub> corresponds to <italic>d</italic> = 0 and <italic>z</italic><sub><italic>max</italic></sub> corresponds to <italic>d</italic> = 1. Here we demonstrate and discuss the consequences of selecting particular values for <italic>d</italic> to adjust the clustering results according to the particular aims of an RNA-Seq experiment. Because <italic>Compacta</italic> is fast, runs can be performed for a grid of <italic>d</italic> values and the results can be used for downstream analyses to identify genes and detect differential expression. Compared with the costs of RNA-Seq library construction and sequencing, the costs for bioinformatic analyses are negligible such that more time can be spent to perform such analyses to obtain optimum information from the data. Each <italic>d</italic> value gives <italic>z</italic> clusters, and the researcher can then select <italic>z</italic> contigs (one for each cluster) and use tools such as <italic>BLAST</italic> [<xref ref-type="bibr" rid="CR35">35</xref>] to identify representative contigs in the transcriptome of a related species, or <italic>BUSCO</italic> [<xref ref-type="bibr" rid="CR37">37</xref>] to assess contig set completeness. Test runs of differential expression programs, such as <italic>edgeR</italic> [<xref ref-type="bibr" rid="CR38">38</xref>], can be performed with each representative set of contigs to evaluate the suitability of the results for achieving the particular aims of an RNA-Seq experiment. Here we show results obtained by running <italic>Compacta</italic> with the Arabidopsis assembly that generated the speed test results (Fig. <xref rid="Fig1" ref-type="fig">1</xref>; see Source data and Software evaluation and Section 3 of Additional file <xref rid="MOESM1" ref-type="media">1</xref> for details).</p>
      <p id="Par49">The Arabidopsis assembly resulted in 106,895 contigs that were sent as a query to a <italic>BLAST</italic> database containing the full Arabidopsis cDNA set, which comprises 41,671 different sequences. <italic>BLAST</italic> hits were filtered by coverture, bit score and E-value giving a total of 23,607 significant concordances. The Arabidopsis assembly was run through <italic>Compacta</italic> using a grid of <italic>d</italic> values and with the parameter <italic>l</italic> set to its default value of 2 (for details see Section 3 of Additional file <xref rid="MOESM1" ref-type="media">1</xref>).</p>
      <p id="Par50">Table <xref rid="Tab3" ref-type="table">3</xref> shows that the dynamic range of <italic>Compacta</italic> for this assembly goes from <italic>z</italic><sub><italic>min</italic></sub> = 13,770 clusters when <italic>d</italic> = 0 to <italic>z</italic><sub><italic>max</italic></sub> = 103,262 clusters when <italic>d</italic> = 1; a 7.5-fold change between the maximum and minimum values. By taking the largest contig as representative of each cluster, the number of distinct Arabidopsis sequences identified (column <italic>n</italic><sub><italic>As</italic></sub> in Table <xref rid="Tab3" ref-type="table">3</xref>) varies from a minimum of 3344 when <italic>d</italic> = 0 to a maximum of 23,607 for <italic>d</italic> = 1. This latter value corresponds to the total number of Arabidopsis sequences identified in the entire assembly. The ratio between the maximum and minimum of Arabidopsis sequences identified is 23,607 / 3344 ≈ 7, which is similar to the ratio <italic>z</italic><sub><italic>max</italic></sub><italic>/z</italic><sub><italic>min</italic></sub> of ≈ 7.5 However, we will see that the proportion of changes in the number of clusters and identified sequences do not follow a linear function of <italic>d</italic>.
<table-wrap id="Tab3"><label>Table 3</label><caption><p><italic>Compacta</italic> results for the Arabidopsis assembly. <italic>d</italic> - Parameter value, <italic>z</italic> - Number of clusters (representative contigs), <italic>n</italic><sub><italic>As</italic></sub> - Number of Arabidopsis sequences identified</p></caption><table frame="hsides" rules="groups"><thead><tr><th><italic>d</italic></th><th/><th><italic>z</italic></th><th><italic>n</italic><sub><italic>AS</italic></sub></th></tr></thead><tbody><tr><td>0.000</td><td/><td>13,770</td><td>3344</td></tr><tr><td>0.035</td><td><italic>(d</italic><sub><italic>l</italic></sub><italic>)</italic></td><td>28,704</td><td>18,381</td></tr><tr><td>0.500</td><td/><td>34,860</td><td>20,455</td></tr><tr><td>0.955</td><td><italic>(d</italic><sub><italic>r</italic></sub><italic>)</italic></td><td>40,656</td><td>21,254</td></tr><tr><td>1.000</td><td/><td>103,262</td><td>23,607</td></tr></tbody></table></table-wrap></p>
      <p id="Par51">The percentages of clusters, <italic>z</italic>, number of identified sequences, <italic>n</italic><sub><italic>As</italic></sub>, and clustering efficiency, <italic>Ef</italic>, defined as <italic>Ef</italic> = <italic>n</italic><sub><italic>As</italic></sub><italic>/z</italic>, are estimated as curve functions of <italic>d</italic>, which again does not have a linear relationship as shown by the grey dashed line with slope 10 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Nevertheless, these three curvilinear functions show a relatively small slope (≈ 0) for <italic>d</italic> values between 0.1 and 0.9, whereas in the left and right hand extremes the three functions show sudden slope changes; from very high to relatively low near <italic>d</italic> = 0<italic>.</italic>035 and, conversely, from a relatively low to a very high slope near <italic>d</italic> = 0<italic>.</italic>955 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>; see Table <xref rid="Tab3" ref-type="table">3</xref> for the estimated values at these critical points). Although generalizations cannot be made based on this one example, it is reasonable to assume that for almost all assemblies the values for number of clusters, identified sequences and efficiency will be non-linear functions of <italic>d</italic> having two critical points at which a sudden slope change at <italic>d</italic><sub><italic>l</italic></sub> ≈ 0 and <italic>d</italic><sub><italic>r</italic></sub> ≈ 1 and a relatively flat change (low slope) around <italic>d</italic> = 0<italic>.</italic>5 occur. The values for <italic>d</italic><sub><italic>l</italic></sub> and <italic>d</italic><sub><italic>r</italic></sub> are shown in Table <xref rid="Tab3" ref-type="table">3</xref> for the Arabidopsis assembly, and these values can be easily estimated for any particular assembly.</p>
      <p id="Par52">The curves for the Arabidopsis assembly show that there will be an unavoidable loss of accuracy in the analysis of assemblies obtained de novo from RNA-Seq experiments (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). This inaccuracy results from not taking into account genome architecture, which in turn can confound identification of the gene from which each transcript originated to create multiple putative transcripts of which an unknown proportion could be artifacts, i.e., transcripts that do not exist physiologically. Fortunately, clustering assemblies to reduce this complexity can address the problem.</p>
      <p id="Par53">In the following discussion we will assume that the researcher has putatively identified all original contigs, has determined the approximate points <italic>d</italic><sub><italic>l</italic></sub><italic>, d</italic><sub><italic>r</italic></sub> for the assembly of interest, has obtained sets of representative contigs at <italic>d</italic> equal to 0<italic>, d</italic><sub><italic>l</italic></sub><italic>,</italic> 0<italic>.</italic>5<italic>, d</italic><sub><italic>r</italic></sub> and 1, and performed differential expression analyses for all <italic>d</italic> values shown above. We will be looking for a ‘Goldilocks’ point for <italic>d</italic> where there are not ‘too few’ or ‘too many’ contigs to obtain biologically relevant knowledge from our data.</p>
      <p id="Par54">Analyses of a representative set of contigs at <italic>d</italic> = 0 will give the minimum resolution of the assembly, because all representative contigs at that point represent completely independent ‘genes’ or ‘gene families’ and consequently the number of identified sequences will be a minimum (Fig. <xref rid="Fig2" ref-type="fig">2</xref>; blue dotted line). Based on this selection, all reads mapping to the contigs will have a unique hit, and thus the statistical power of detection of differentially expressed entities will be a maximum, because reads are not shared between the entities analyzed. Aside from other considerations, the differential expression analysis at <italic>d</italic> = 0 has the advantage of displaying a broad scenario; entities that are differentially expressed will show sets of genes that are surely affected by experimental conditions, even if many splicing variants and other similar transcripts are grouped and represented by a single transcript.</p>
      <p id="Par55">However, for many purposes, the number of representative sequences at <italic>d</italic> = 0 will be ‘too few’ and further analyses will be needed to improve accuracy.</p>
      <p id="Par56">On the other extreme, at <italic>d</italic> = 1, we have the largest number of representative contigs, and consequently the largest number of identified sequences (Fig. <xref rid="Fig2" ref-type="fig">2</xref>; dotted blue line). However, the procedure efficiency is lowest at this point (Fig. <xref rid="Fig2" ref-type="fig">2</xref>; dashed green line), meaning that many contigs represent the same identified sequence (<italic>Ef</italic> = <italic>n</italic><sub><italic>As</italic></sub><italic>/z</italic> is at its minimum), and thus very little advantage is gained from the clustering procedure, because many representative sequences will be redundant and characterize the same gene. At this point, the statistical power is also reduced because fewer reads map to each individual contig when compared with the other extreme (i.e., <italic>d</italic> = 0). Thus, <italic>d</italic> = 1 will give us ‘too many’ contigs.</p>
      <p id="Par57">Examining the point around which <italic>d</italic> = <italic>d</italic><sub><italic>l</italic></sub> for the Arabidopsis assembly gives <italic>d</italic> ≈ 0<italic>.</italic>035 (Table <xref rid="Tab3" ref-type="table">3</xref>). At approximately this point the curves for <italic>z,n</italic><sub><italic>As</italic></sub> and <italic>Ef</italic> show a sudden slope change, going from a sharp increase to a more steady state that will continue for values of <italic>d &gt; d</italic><sub><italic>l</italic></sub> and up to <italic>d &lt; d</italic><sub><italic>r</italic></sub>. The <italic>d</italic><sub><italic>l</italic></sub> point gives large increases in the number of contigs, <italic>z</italic>, and identified sequences, <italic>n</italic><sub><italic>As</italic></sub>, when compared with the point at <italic>d</italic> = 0, say ∆<italic>z</italic>(<italic>d</italic>) = <italic>z</italic>(<italic>d</italic> = <italic>d</italic><sub><italic>l</italic></sub>) − <italic>z</italic>(<italic>d</italic> = 0) = 28,704–13,770 = 14,934 (≈ 15% of increment), ∆<italic>n</italic><sub><italic>As</italic></sub>(<italic>d</italic>) = <italic>n</italic><sub><italic>As</italic></sub>(<italic>d</italic> = <italic>d</italic><sub><italic>l</italic></sub>) − <italic>n</italic><sub><italic>As</italic></sub>(<italic>d</italic> = 0) = 18,381–3344 = 15,037 (≈ 65% of increment; see Table <xref rid="Tab3" ref-type="table">3</xref> and Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Also near <italic>d</italic> = <italic>d</italic><sub><italic>l</italic></sub>, at <italic>d</italic> = 0<italic>.</italic>05, we obtain the maximum efficiency, max (<italic>Ef</italic>) = 18,381<italic>/</italic>19962 ≈ 0<italic>.</italic>92 (see Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Section 3 of Additional file <xref rid="MOESM1" ref-type="media">1</xref> for details). In the context of information content, the d value at which max (<italic>Ef</italic>) is reached is optimal; i.e., we will not have ‘too few’ or ‘too many’ contigs to represent assembly diversity and thus this point is the ‘Goldilocks point on <italic>d</italic>’. If the differential expression of the representative contigs at max (<italic>Ef</italic>) is satisfactory for the aims of the RNA-Seq experiment, the analysis at this point could be reported as the final result.</p>
      <p id="Par58">The pipeline sketched here to obtain an optimum point for the parameter <italic>d</italic> that corresponds to the maximum efficiency, max (<italic>Ef</italic>), can be easily performed with an assembly obtained from any RNA-Seq experiment. In general, the most complex decision for the researcher is selection of a well-known and closest organism with which to suitably compare the organism under study. When such selection is done, a simple <italic>BLAST</italic> experiment using all contigs from the assembly as queries and the full transcriptome of the known organism as the target can be easily performed (details of this procedure are presented in Section 3 of Additional file <xref rid="MOESM1" ref-type="media">1</xref> for the Arabidopsis assembly). Alternatively, or additionally, the researcher could perform a BUSCO experiment (see [<xref ref-type="bibr" rid="CR35">35</xref>] and the website with [<xref ref-type="bibr" rid="CR37">37</xref>]). The general lines of the procedure are, first, to obtain all <italic>BUSCO</italic> terms that correspond to all contigs in the assembly, and upon gathering these terms, use the sets of representative contigs obtained with <italic>Compacta</italic> with a grid of <italic>d</italic> values. As with <italic>BLAST</italic>, with <italic>BUSCO</italic> we can obtain a point <italic>d</italic> that will correspond to the maximum efficiency, max (<italic>Ef</italic>), but in this case the <italic>Ef</italic> for each value of <italic>d</italic> is defined as the number of <italic>BUSCO</italic> terms found over the number of contigs. An additional advantage of the <italic>BUSCO</italic> approach is that the terms found will generally have straightforward biological interpretations, which is useful for understanding differential expression analyses.</p>
    </sec>
    <sec id="Sec9">
      <title>Comparing <italic>Compacta</italic> with other clustering tools</title>
      <p id="Par59"><italic>Compacta</italic> does not directly use sequence information (as do tools like <italic>CD-HIT</italic> [<xref ref-type="bibr" rid="CR15">15</xref>]) but instead uses reads that are shared between contigs. It also does not use statistical approaches to try to determine the gene of origin for each contig (as do <italic>Corset</italic> or <italic>Grouper</italic>), and as such is not fully comparable with all clustering tools. However, we did perform various comparisons and the results are summarized below, with details and other analyses presented in Section 2 of Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      <p id="Par60">An ideal clustering algorithm for assemblies will correctly identify all contigs that arise from transcription of the same locus and cluster all of these contigs together. On the other hand, contigs arising from transcripts originating from different loci will always belong to different clusters. However, two kinds of errors, false positives (where two contigs from different loci are clustered together) and false negatives (where two contigs that belong to the same locus are not clustered together) can occur.</p>
      <p id="Par61">In Table <xref rid="Tab4" ref-type="table">4</xref> we present four possibilities for the classification of contig pairs, and the frequency of each one of the cases (in each of the 4 cells of the table) is represented by <italic>a, b, c</italic> and <italic>d</italic>, whereas the sum of the frequencies, <italic>a</italic> + <italic>b</italic> + <italic>c</italic> + <italic>d</italic>, gives the total number of pair-wise contig comparisons. A perfect clustering algorithm will have <italic>b</italic> = 0 and <italic>c</italic> = 0, and we can define two metrics to measure an algorithm behavior, termed ‘Recall’, <italic>R</italic> = <italic>a/</italic>(<italic>a</italic> + <italic>c</italic>) and ‘Precision’, <italic>P</italic> = <italic>a/</italic>(<italic>a</italic> + <italic>b</italic>). Clearly, the perfect algorithm will have <italic>R</italic> = 1 and <italic>P</italic> = 1, whereas <italic>R &lt;</italic> 1 imply the existence of false negatives (<italic>c &gt;</italic> 0) and <italic>P &lt;</italic> 1 implies the existence of false positives (<italic>b &gt;</italic> 0).
<table-wrap id="Tab4"><label>Table 4</label><caption><p>Case classification for contig pairs after clustering. <italic>a, b, c</italic> and <italic>d</italic> are frequencies resulting from a clustering experiment</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2" colspan="2"/><th colspan="3">Same locus?</th></tr><tr><th>Yes</th><th>No</th><th>Total</th></tr></thead><tbody><tr><td rowspan="3">Clustered?</td><td>Yes</td><td><italic>a</italic> (true positive)</td><td><italic>b</italic> (false positive)</td><td><italic>a</italic> + <italic>b</italic> (positives)</td></tr><tr><td>No</td><td><italic>c</italic> (false negative)</td><td><italic>d</italic> (true negative)</td><td><italic>c</italic> + <italic>d</italic> (negatives)</td></tr><tr><td>Total</td><td><italic>a</italic> + <italic>c</italic> (single locus)</td><td><italic>b</italic> + <italic>d</italic> (different loci)</td><td><italic>a</italic> + <italic>b</italic> + <italic>c</italic> + <italic>d</italic></td></tr></tbody></table></table-wrap></p>
      <p id="Par62">We estimated recall, <italic>R</italic>, and precision, <italic>P</italic>, of 5 clustering algorithms for Arabidopsis and mouse assemblies that were used to evaluate execution time (see Fig. <xref rid="Fig1" ref-type="fig">1</xref> and Source data and Software evaluation). We again compared <italic>Compacta</italic> with mainly graph-based <italic>Corset</italic> and <italic>Grouper</italic> and also with <italic>CD-HIT</italic>, which relies exclusively on sequence information [<xref ref-type="bibr" rid="CR15">15</xref>] and the <italic>Trinity</italic> program for contig grouping [<xref ref-type="bibr" rid="CR39">39</xref>], which is based on De Bruijn graphs. For the comparison, all five programs were run using default parameters.</p>
      <p id="Par63">The program having the lowest recall for both assemblies was <italic>CD-HIT</italic>, and the values significantly differed from the higher values produced by the other 4 programs (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). This difference could be because <italic>CD-HIT</italic> uses only information for direct contig likeness at the sequence level, and thus produces multiple false negatives when contigs that are truly related are not grouped. On the other hand, <italic>CD-HIT</italic> had the highest precision for both assemblies, implying a low frequency of false positives that again is attributable to the direct use of sequence information: when <italic>CD-HIT</italic> clusters two or more contigs, it does so based on high sequence similarity. A disadvantage of <italic>CD-HIT</italic> is that the clusters it produces contain only a small number of contigs –those that are highly similar at the sequence level, and the user has little control over the degree of assembly compression (data not shown; see Section 2 of Additional file <xref rid="MOESM1" ref-type="media">1</xref>).</p>
      <p id="Par64">We also observed that the recall ratios for <italic>Corset</italic>, <italic>Compacta</italic>, <italic>Grouper</italic> and <italic>Trinity</italic> were relatively similar within both mouse and Arabidopsis assemblies, but the values for mouse were always lower than those for Arabidopsis (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). The higher complexity of the mouse assembly relative to that for Arabidopsis can explain the generally lower recall ratios of the four programs and that higher numbers of false negatives can be produced with complex assemblies. <italic>Compacta</italic> had the highest recall for Arabidopsis, while <italic>Grouper</italic> had the highest recall for the mouse assembly.</p>
      <p id="Par65">In contrast to the results for recall, for all five programs precision was marginally higher for the mouse assembly relative to that for Arabidopsis (Fig. <xref rid="Fig3" ref-type="fig">3</xref>), suggesting that the relative proportion of false positives does not increase with assembly complexity.</p>
      <p id="Par66">In terms of precision, and excluding the <italic>CD-HIT</italic> case discussed above, in all cases <italic>Corset</italic>, <italic>Compacta</italic>, <italic>Grouper</italic> and <italic>Trinity</italic> have a precision around 0.8 (Fig. <xref rid="Fig3" ref-type="fig">3</xref>); at <italic>P</italic> = 0<italic>.</italic>85 and <italic>P</italic> ≈ 0<italic>.</italic>84 <italic>Corset</italic> and <italic>Grouper</italic>, respectively, had the highest precision for the Arabidopsis assembly, whereas <italic>Compacta</italic> and <italic>Trinity</italic> both had <italic>P</italic> ≈ 0<italic>.</italic>78. For the mouse assembly, <italic>Corset</italic> had the highest precision (<italic>P</italic> ≈ 0<italic>.</italic>95) while <italic>Compacta</italic> and <italic>Grouper</italic> both had <italic>P</italic> ≈ 0<italic>.</italic>9, and <italic>Trinity</italic> had <italic>P</italic> ≈ 0<italic>.</italic>89. Even when <italic>Compacta</italic> did not have the highest precision in the assemblies studied, it was faster than the other programs, and, importantly, can be adjusted to yield an optimum number of clusters with the highest efficiency (see previous section). These advantages compensate for the minor loss of precision upon comparing Compacta with Corset and Grouper. Furthermore, because Compacta does not try to determine the gene origin of each contig, its results are independent of the RNA-Seq experimental design (treatments), whereas Corset and Grouper are affected by experimental factors due to the use of statistical tools to try to estimate genes from which contigs originated.</p>
      <p id="Par67">We compared the precision and recall for <italic>Compacta</italic> with a yeast assembly and generated sets of simulated assemblies for Arabidopsis, mouse and yeast with plots of precision × recall for all comparisons (Section 2 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). We also compared differential expression patterns from various assemblies (Section 4 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). Together these results showed that Compacta efficiently detected differential expression patterns after assembly clustering.</p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Conclusions</title>
    <p id="Par68">In most cases de novo assemblies produce an excess number of contigs, many of which represent minor transcription variants from expression of the same gene. We assert that without full genome information segregating contigs by gene of origin is very difficult, if not impossible. Thus, for genomes that do not have complete information, researchers must reduce the analytical complexity by selecting a set of contigs to represent the entire transcriptome. <italic>Compacta</italic> provides flexibility in the selection of sets of representative contigs for downstream analysis. Its dynamic range goes from maximum transcriptome compression –wherein all contigs that share common reads are represented by a single contig, down to minimum compression, wherein only those contigs that are subsets of the same reads are clustered together and thus represented by a single contig. Because <italic>Compacta</italic> is fast, many test runs can be made to find the optimum level of transcriptome compactness according to the specific aim of a given experiment.</p>
  </sec>
  <sec id="Sec11">
    <title>Availability and requirements</title>
    <p id="Par69"><bold>Project name:</bold> Compacta.</p>
    <p id="Par70"><bold>Project home Page:</bold><ext-link ext-link-type="uri" xlink:href="https://github.com/bioCompU/Compacta">https://github.com/bioCompU/Compacta</ext-link> or 10.5281/zenodo.3469484 Home page includes a source code tar ball, compiled executables and a software manual with demos.</p>
    <p id="Par71"><bold>Operating Systems:</bold> any Unix-based system with proper installation, or Linux × 86 with standalone executable.</p>
    <p id="Par72"><bold>Programming Language:</bold> C++.</p>
    <p id="Par73"><bold>Other Requirements:</bold> Samtools, zlib library and a C++ compiler.</p>
    <p id="Par74"><bold>Recommended Hardware:</bold> The memory needed to run the software is determined by the size of the largest input BAM file. <italic>Compacta</italic> loads the input files in memory and releases them after data pre-processing. As such, when the input data are loaded, only a small amount of memory is needed for processing. For a given dataset <italic>Compacta</italic> typically requires more memory than that of tools such as <italic>CD-HIT-EST</italic>, but less than that needed by <italic>Corset</italic> and transcriptome assemblers. The experiments shown in this study were performed on a computer with 64 Gb RAM, and an Intel CoreTM™ processor i7–6700 with 4 cores.</p>
    <p id="Par75"><bold>License:</bold> GNU GPL version 3.</p>
    <p id="Par76"><bold>Restrictions for use by non-academics:</bold> None.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec12">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12864_2020_6528_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary results. Additional text and figures are ordered according to sections in the main text.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BAM</term>
        <def>
          <p id="Par4">Binary Alignment Map</p>
        </def>
      </def-item>
      <def-item>
        <term>bp</term>
        <def>
          <p id="Par5">base pair</p>
        </def>
      </def-item>
      <def-item>
        <term>cDNA</term>
        <def>
          <p id="Par6">complementary DNA</p>
        </def>
      </def-item>
      <def-item>
        <term>
          <italic>Ef</italic>
        </term>
        <def>
          <p id="Par7">Efficiency</p>
        </def>
      </def-item>
      <def-item>
        <term>mRNA</term>
        <def>
          <p id="Par8">messenger RNA</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12864-020-6528-x.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Juan Bautista Teran Fraijo and María del Socorro Fraijo Encinas for helping us secure financial support from COFUPRO. We also thank Oscar Julio Luna, Cecilia Piri Alcaraz, Lucia Preciado Gamez and Hugo Piri for administrative support during the project. We are grateful to Dr. Miguel A. Hernández-Oñate for support during the development of this software and for providing the de novo mango assembly.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>FR-M programmed <italic>Compacta,</italic> performed the analyses and wrote the first draft of the manuscript. CH-K and OM conceived the research, supervised both software development and analyses and wrote the final version of the manuscript. All authors reviewed and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported in part by COFUPRO (A/GTO/RGAG-2014-076-Consorcio de Fundaciones PRODUCE). FR-M acknowledges the Mexican Council of Science and Technology (CONACyT) for support from a PhD scholarship (261122) during the development of the project. The funding body did not contribute to the design of the study or collection, analysis and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets used in this study are available in the Sequence Read Archive (SRA) with accession numbers SRP043494, ERP016911 and SRP149554 for Mango, Arabidopsis and Mouse datasets, respectively. The source code and standalone executable of the version of Compacta used in this study are available at 10.5281/zenodo.3469484.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par77">Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par78">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par79">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adams</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Kelley</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Gocayne</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Dubnick</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Polymeropoulos</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Merril</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Olde</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Moreno</surname>
            <given-names>RF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Complementary DNA sequencing: expressed sequence tags and human genome project</article-title>
        <source>Science</source>
        <year>1991</year>
        <volume>252</volume>
        <issue>5013</issue>
        <fpage>1651</fpage>
        <lpage>1656</lpage>
        <pub-id pub-id-type="doi">10.1126/science.2047873</pub-id>
        <pub-id pub-id-type="pmid">2047873</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ozsolak</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Milos</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>RNA sequencing: advances, challenges and opportunities</article-title>
        <source>Nat Rev Genet</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>87</fpage>
        <pub-id pub-id-type="doi">10.1038/nrg2934</pub-id>
        <pub-id pub-id-type="pmid">21191423</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grabherr</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Haas</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Yassour</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Levin</surname>
            <given-names>JZ</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Amit</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Adiconis</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Raychowdhury</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Mauceli</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hacohen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gnirke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rhind</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Di Palma</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Birren</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Nusbaum</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lindblad-Toh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Full-length transcriptome assembly from rna-seq data without a reference genome</article-title>
        <source>Nat Biotechnol</source>
        <year>2011</year>
        <volume>29</volume>
        <fpage>644</fpage>
        <lpage>652</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1883</pub-id>
        <?supplied-pmid 21572440?>
        <pub-id pub-id-type="pmid">21572440</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cheung</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>S-M</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Xiaoqian</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>T-W</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>SOAPdenovo2: an empirically improved memory-efficient short-read de novo assembler</article-title>
        <source>GigaScience</source>
        <year>2012</year>
        <volume>1</volume>
        <issue>1</issue>
        <fpage>2047</fpage>
        <pub-id pub-id-type="doi">10.1186/2047-217X-1-18</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Birol</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Jackman</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Qian</surname>
            <given-names>JQ</given-names>
          </name>
          <name>
            <surname>Varhol</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Stazyk</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Morin</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hirst</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schein</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Horsman</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Connors</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Gascoyne</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Marra</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>SJM</given-names>
          </name>
        </person-group>
        <article-title>De novo transcriptome assembly with ABySS</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>21</issue>
        <fpage>2872</fpage>
        <lpage>2877</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp367</pub-id>
        <pub-id pub-id-type="pmid">19528083</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bankevich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nurk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Antipov</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gurevich</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Dvorkin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kulikov</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Lesin</surname>
            <given-names>VM</given-names>
          </name>
          <name>
            <surname>Nikolenko</surname>
            <given-names>SI</given-names>
          </name>
          <name>
            <surname>Pham</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Prjibelski</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Pyshkin</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Sirotkin</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Vyahhi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tesler</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Alekseyev</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Spades: A new genome assembly algorithm and its applications to single-cell sequencing</article-title>
        <source>J Comput Biol</source>
        <year>2012</year>
        <volume>19</volume>
        <issue>5</issue>
        <fpage>455</fpage>
        <lpage>477</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2012.0021</pub-id>
        <?supplied-pmid 22506599?>
        <pub-id pub-id-type="pmid">22506599</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Next-generation transcriptome assembly</article-title>
        <source>Nat Rev Genet</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>10</issue>
        <fpage>671</fpage>
        <pub-id pub-id-type="doi">10.1038/nrg3068</pub-id>
        <pub-id pub-id-type="pmid">21897427</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Audano</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Sulovari</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Graves-Lindsay</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Cantsilieris</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sorensen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Welch</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Dougherty</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dutcher</surname>
            <given-names>SK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Characterizing the major structural variant alleles of the human genome</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>176</volume>
        <issue>3</issue>
        <fpage>663</fpage>
        <lpage>675</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.12.019</pub-id>
        <pub-id pub-id-type="pmid">30661756</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koonin</surname>
            <given-names>EV</given-names>
          </name>
        </person-group>
        <article-title>Orthologs, paralogs, and evolutionary genomics</article-title>
        <source>Annu Rev Genet</source>
        <year>2005</year>
        <volume>39</volume>
        <fpage>309</fpage>
        <lpage>338</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev.genet.39.073003.114725</pub-id>
        <pub-id pub-id-type="pmid">16285863</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Indrischek</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wieseke</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Prohaska</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>The paralog-to-contig assignment problem: high quality gene models from fragmented assemblies</article-title>
        <source>Algorithms Mol Biol</source>
        <year>2016</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.1186/s13015-016-0063-y</pub-id>
        <pub-id pub-id-type="pmid">26913054</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>Y-z</given-names>
          </name>
          <name>
            <surname>Passey</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <source>Is “junk” dna mostly intron dna?</source>
        <year>2015</year>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wong</surname>
            <given-names>GK-S</given-names>
          </name>
          <name>
            <surname>Passey</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Most of the human genome is transcribed</article-title>
        <source>Genome Res</source>
        <year>2001</year>
        <volume>11</volume>
        <issue>12</issue>
        <fpage>1975</fpage>
        <lpage>1977</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.202401</pub-id>
        <pub-id pub-id-type="pmid">11731486</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ameur</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zaghlool</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Halvardson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wetterbom</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gyllensten</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Cavelier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Feuk</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Total RNA sequencing reveals nascent transcription and widespread co-transcriptional splicing in the human brain</article-title>
        <source>Nat Struct Mol Biol</source>
        <year>2011</year>
        <volume>18</volume>
        <issue>12</issue>
        <fpage>1435</fpage>
        <pub-id pub-id-type="doi">10.1038/nsmb.2143</pub-id>
        <pub-id pub-id-type="pmid">22056773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chou</surname>
            <given-names>H-C</given-names>
          </name>
          <name>
            <surname>Acevedo-Luna</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kuhlman</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>SQ</given-names>
          </name>
        </person-group>
        <article-title>Pdumbase: a transcriptome database and research tool for platynereis dumerilii and early development of other metazoans</article-title>
        <source>BMC Genomics</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>618</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-018-4987-0</pub-id>
        <pub-id pub-id-type="pmid">30115014</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Godzik</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>
        <source>Bioinformatics (Oxford, England)</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1658</fpage>
        <lpage>1659</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl158</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davidson</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Corset: enabling differential gene expression analysis for de novo assembled transcriptomes</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>410</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0410-6</pub-id>
        <?supplied-pmid 25063469?>
        <pub-id pub-id-type="pmid">25063469</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Malik</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Almodaresi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Patro</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Grouper: graph-based clustering and annotation for improved de novo transcriptome analysis</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>19</issue>
        <fpage>3265</fpage>
        <lpage>3272</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty378</pub-id>
        <?supplied-pmid 29746620?>
        <pub-id pub-id-type="pmid">29746620</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vlasova</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Capella-Gutiérrez</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rendón-Anaya</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hernández-Oñate</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Minoche</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Erb</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Câmara</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Prieto-Barja</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Corvelo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sanseverino</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome and transcriptome analysis of the mesoamerican common bean and the role of gene duplications in establishing tissue and temporal specialization of genes</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>32</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0883-6</pub-id>
        <pub-id pub-id-type="pmid">26911872</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boley</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Stoiber</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Booth</surname>
            <given-names>BW</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Hoskins</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Bickel</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Celniker</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Genome-guided transcript assembly by integrative analysis of RNA sequence data</article-title>
        <source>Nat Biotechnol</source>
        <year>2014</year>
        <volume>32</volume>
        <issue>4</issue>
        <fpage>341</fpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2850</pub-id>
        <pub-id pub-id-type="pmid">24633242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bennetzen</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Devos</surname>
            <given-names>KM</given-names>
          </name>
        </person-group>
        <article-title>Mechanisms of recent genome size variation in flowering plants</article-title>
        <source>Ann Bot</source>
        <year>2005</year>
        <volume>95</volume>
        <issue>1</issue>
        <fpage>127</fpage>
        <lpage>132</lpage>
        <pub-id pub-id-type="doi">10.1093/aob/mci008</pub-id>
        <pub-id pub-id-type="pmid">15596462</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>S-I</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>N-S</given-names>
          </name>
        </person-group>
        <article-title>Transposable elements and genome size variations in plants</article-title>
        <source>Genomics Inform</source>
        <year>2014</year>
        <volume>12</volume>
        <issue>3</issue>
        <fpage>87</fpage>
        <pub-id pub-id-type="doi">10.5808/GI.2014.12.3.87</pub-id>
        <pub-id pub-id-type="pmid">25317107</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stranger</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Forrest</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Dunning</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ingle</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Beazley</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Thorne</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Redon</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bird</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>De Grassi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Relative impact of nucleotide and copy number variation on gene expression phenotypes</article-title>
        <source>Science</source>
        <year>2007</year>
        <volume>315</volume>
        <issue>5813</issue>
        <fpage>848</fpage>
        <lpage>853</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1136678</pub-id>
        <pub-id pub-id-type="pmid">17289997</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J-Q</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Patterns of exon-intron architecture variation of genes in eukaryotic genomes</article-title>
        <source>BMC Genomics</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>47</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-10-47</pub-id>
        <?supplied-pmid 19166620?>
        <pub-id pub-id-type="pmid">19166620</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Fast gapped-read alignment with bowtie 2</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>357</fpage>
        <lpage>359</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id>
        <?supplied-pmid 22388286?>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Hisat: A fast spliced aligner with low memory requirements</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>357</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3317</pub-id>
        <?supplied-pmid 25751142?>
        <pub-id pub-id-type="pmid">25751142</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Subgroup</surname>
            <given-names>GPDP</given-names>
          </name>
        </person-group>
        <article-title>The sequence alignment/map format and samtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>16</issue>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <?supplied-pmid 2723002?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Essam</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>ME</given-names>
          </name>
        </person-group>
        <article-title>Some basic definitions in graph theory</article-title>
        <source>Rev Mod Phys</source>
        <year>1970</year>
        <volume>42</volume>
        <issue>2</issue>
        <fpage>271</fpage>
        <pub-id pub-id-type="doi">10.1103/RevModPhys.42.271</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kurita</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>An efficient agglomerative clustering algorithm using a heap</article-title>
        <source>Pattern Recogn</source>
        <year>1991</year>
        <volume>24</volume>
        <fpage>205</fpage>
        <lpage>209</lpage>
        <pub-id pub-id-type="doi">10.1016/0031-3203(91)90062-A</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mercer</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Dinger</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Mattick</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Long non-coding RNAs: insights into functions</article-title>
        <source>Nat Rev Genet</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>155</fpage>
        <pub-id pub-id-type="doi">10.1038/nrg2521</pub-id>
        <pub-id pub-id-type="pmid">19188922</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frith</surname>
            <given-names>Martin C</given-names>
          </name>
          <name>
            <surname>Pheasant</surname>
            <given-names>Michael</given-names>
          </name>
          <name>
            <surname>Mattick</surname>
            <given-names>John S</given-names>
          </name>
        </person-group>
        <article-title>Genomics: The amazing complexity of the human transcriptome</article-title>
        <source>European Journal of Human Genetics</source>
        <year>2005</year>
        <volume>13</volume>
        <issue>8</issue>
        <fpage>894</fpage>
        <lpage>897</lpage>
        <pub-id pub-id-type="doi">10.1038/sj.ejhg.5201459</pub-id>
        <pub-id pub-id-type="pmid">15970949</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>HN</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>YJ</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>XS</given-names>
          </name>
        </person-group>
        <article-title>Atprmt5 regulates shoot regeneration through mediating histone h4r3 dimethylation on krps and pre-mrna splicing of rkp in Arabidopsis</article-title>
        <source>Mol Plant</source>
        <year>2016</year>
        <volume>9</volume>
        <issue>12</issue>
        <fpage>1634</fpage>
        <lpage>1164</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molp.2016.10.010</pub-id>
        <?supplied-pmid 27780782?>
        <pub-id pub-id-type="pmid">27780782</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tafolla-Arellano</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Jiao</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ruiz May</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hernandez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gonzalez Leon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sañudo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fei</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Domozych</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>KC Rose</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tiznado-Hernández</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Transcriptome analysis of mango (<italic>Mangifera indica</italic> l.) fruit epidermal peel to identify putative cuticle-associated genes</article-title>
        <source>Sci Rep</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>46163</fpage>
        <pub-id pub-id-type="doi">10.1038/srep46163</pub-id>
        <?supplied-pmid 28425468?>
        <pub-id pub-id-type="pmid">28425468</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">GeneBank: China Agricultural University, Raw Sequence Reads. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA474181/">https://www.ncbi.nlm.nih.gov/bioproject/PRJNA474181/</ext-link></mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">GeneBank: Sequence Read Archive. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/">https://www.ncbi.nlm.nih.gov/sra/</ext-link></mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>A greedy algorithm for aligning DNA sequences</article-title>
        <source>J Comput Biol</source>
        <year>2000</year>
        <volume>7</volume>
        <issue>1–2</issue>
        <fpage>203</fpage>
        <lpage>214</lpage>
        <pub-id pub-id-type="doi">10.1089/10665270050081478</pub-id>
        <pub-id pub-id-type="pmid">10890397</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>A simple min-cut algorithm</article-title>
        <source>J ACM</source>
        <year>1997</year>
        <volume>44</volume>
        <fpage>585</fpage>
        <lpage>591</lpage>
        <pub-id pub-id-type="doi">10.1007/BFb0049404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simão</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Waterhouse</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Ioannidis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kriventseva</surname>
            <given-names>EV</given-names>
          </name>
          <name>
            <surname>Zdobnov</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>Busco: assessing genome assembly and annotation completeness with single-copy orthologs</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>19</issue>
        <fpage>3210</fpage>
        <lpage>3212</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv351</pub-id>
        <pub-id pub-id-type="pmid">26059717</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>EdgeR: a bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haas</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Papanicolaou</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yassour</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Grabherr</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Blood</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Bowden</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Brian Couger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eccles</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lieber</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>MacManes</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Ott</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Orvis</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pochet</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Strozzi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Weeks</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Westerman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>William</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Dewey</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>De novo transcript sequence reconstruction from Rna-seq using the trinity platform for reference generation and analysis</article-title>
        <source>Nat Protoc</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>8</issue>
        <fpage>1494</fpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2013.084</pub-id>
        <?supplied-pmid 23845962?>
        <pub-id pub-id-type="pmid">23845962</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
