<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Res Notes</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Res Notes</journal-id>
    <journal-title-group>
      <journal-title>BMC Research Notes</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-0500</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10320995</article-id>
    <article-id pub-id-type="pmid">37403146</article-id>
    <article-id pub-id-type="publisher-id">6396</article-id>
    <article-id pub-id-type="doi">10.1186/s13104-023-06396-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Note</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PyGellermann: a Python tool to generate pseudorandom series for human and non-human animal behavioural experiments</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Jadoul</surname>
          <given-names>Yannick</given-names>
        </name>
        <address>
          <email>Yannick.Jadoul@mpi.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Duengen</surname>
          <given-names>Diandra</given-names>
        </name>
        <address>
          <email>Diandra.Duengen@mpi.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ravignani</surname>
          <given-names>Andrea</given-names>
        </name>
        <address>
          <email>andrea.ravignani@uniroma1.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.419550.c</institution-id><institution-id institution-id-type="ISNI">0000 0004 0501 3839</institution-id><institution>Comparative Bioacoustics Group, </institution><institution>Max Planck Institute for Psycholinguistics, </institution></institution-wrap>Nijmegen, The Netherlands </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.7048.b</institution-id><institution-id institution-id-type="ISNI">0000 0001 1956 2722</institution-id><institution>Center for Music in the Brain, Department of Clinical Medicine, </institution><institution>Aarhus University &amp; The Royal Academy of Music Aarhus/Aalborg, </institution></institution-wrap>Aarhus, Denmark </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.7841.a</institution-id><institution>Department of Human Neurosciences, </institution><institution>Sapienza University of Rome, </institution></institution-wrap>Rome, Italy </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>5</day>
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>135</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>6</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Objective</title>
        <p id="Par1">Researchers in animal cognition, psychophysics, and experimental psychology need to randomise the presentation order of trials in experimental sessions. In many paradigms, for each trial, one of two responses can be correct, and the trials need to be ordered such that the participant’s responses are a fair assessment of their performance. Specifically, in some cases, especially for low numbers of trials, randomised trial orders need to be excluded if they contain simple patterns which a participant could accidentally match and so succeed at the task without learning.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present and distribute a simple Python software package and tool to produce pseudorandom sequences following the Gellermann series. This series has been proposed to pre-empt simple heuristics and avoid inflated performance rates via false positive responses. Our tool allows users to choose the sequence length and outputs a .csv file with newly and randomly generated sequences. This allows behavioural researchers to produce, in a few seconds, a pseudorandom sequence for their specific experiment. <italic>PyGellermann</italic> is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/YannickJadoul/PyGellermann">https://github.com/YannickJadoul/PyGellermann</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Animal cognition</kwd>
      <kwd>Experimental psychology</kwd>
      <kwd>Randomization</kwd>
      <kwd>Simple heuristics</kwd>
      <kwd>Python</kwd>
      <kwd>Psychometrics</kwd>
      <kwd>Two-alternative forced-choice</kwd>
      <kwd>Go/no-go</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004189</institution-id>
            <institution>Max-Planck-Gesellschaft</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Max Planck Independent Group Leader funding</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Max Planck Institute for Psycholinguistics (2)</institution>
        </funding-source>
      </award-group>
      <open-access>
        <p>Open Access funding enabled and organized by Projekt DEAL.</p>
      </open-access>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par3">What is the best way to present experimental stimuli in random order? Two-alternative forced-choice tasks and go/no-go paradigms are common methodologies in human psychological and animal behaviour experiments. These tests require a participant to choose between two options; in the two-alternative forced-choice paradigm these options are two actual stimuli [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], while in the go/no-go paradigm the participant is expected to show a behaviour in response to a positive stimulus (“go”), and to inhibit that behaviour in response to a negative one (“no-go”) [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>].</p>
    <p id="Par4">The commonality among all these experiments and paradigms is that in each trial a participant can choose between two actions, of which only one is correct. From an experimenter’s perspective, the question then is how to decide in which order to present these trials? The obvious answer is randomisation: randomised sequences aim at preventing the predictability of a stimulus, and thereby false positive results in the absence of learning. The experimenter randomises, within a sequence, which of the two possible responses—hereafter referred to as A and B—is correct in each trial.</p>
    <p id="Par5">Purely random sequences, however, can accidentally contain some regularities which may be leveraged by participants. This is a potential issue during testing, when the accidental regularities in a sequence match the participant’s cognitive biases and inflate the perceived performance. It also risks hindering learning, if a participant picks up on unintended regularities in presented sequences (e.g., risking to develop a position/colour preference; [<xref ref-type="bibr" rid="CR5">5</xref>]). Let us consider a random sequence of two types of trials, A and B, in which the number of A/B trials is not balanced 50/50. In this case, an animal sticking to response A (e.g., because of a stimulus or side preference; [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]) will often be able to achieve &gt;50% correct answers within an experimental session. Likewise, a random binary sequence might also feature many alternations of adjacent As and Bs. A participant with a natural tendency to alternate between A and B, will be successful in correctly guessing significantly more than the expected 50%, when the alternating guesses happen to match those of the sequence. The particular alternation strategy adopted by the subject may even result in 70% correct choices by chance [<xref ref-type="bibr" rid="CR7">7</xref>]. This can be a problem, as the learning criterion—the benchmark to consider a task learned—is often 70% correct choices in a pre-set amount of consecutive sessions [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. Moreover, when such patterns in random sequences match a participant’s cognitive biases, these trials might incorrectly confirm and reinforce these pre-existing biases rather than advance the learning process. Another common example of these biases is the win-stay, lose-switch strategy witnessed in human psychology.</p>
    <p id="Par6">In general, building randomised but balanced trial sequences that are immune to simple cognitive biases and ensure that a participant has indeed learned, is not obvious [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. Several methods exist to circumvent scenarios where, because of an unfortunate pick of presentation order, humans and other animals can accidentally succeed at a task without learning. The most common one is the use of Gellermann series [<xref ref-type="bibr" rid="CR7">7</xref>], which puts some constraints on the randomization and is often applied when experimental sessions contain relatively few trials (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). This is a somewhat paradoxical situation: Mathematically speaking, the introduction of extra constraints increases the predictability of a sequence, which can in turn be exploited by a rational statistical learner [<xref ref-type="bibr" rid="CR11">11</xref>]. Nevertheless, Gellermann series are a popular heuristic to deal with the potentially irrational cognitive biases in human and non-human animal cognitive experiments, and are finding use in research fields such as psychophysics, neuropsychology, comparative psychology, and animal behaviour [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR16">16</xref>]. The number of trials per session in animal behaviour experiments can be as low as 10 [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>], 20 [<xref ref-type="bibr" rid="CR5">5</xref>], 30 [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>], 40 [<xref ref-type="bibr" rid="CR12">12</xref>], 40 to 60 [<xref ref-type="bibr" rid="CR15">15</xref>], or 50 to 100 [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
  </sec>
  <sec id="Sec2">
    <title>Main text</title>
    <p id="Par7">Behavioural researchers are therefore faced with an apparent paradox: they need to create sequences that are as random as possible, but exclude those that would overestimate the experimental participants’ performance by coinciding with simple, non-learning behaviour [<xref ref-type="bibr" rid="CR22">22</xref>]. The solution typically adopted is to use a Gellermann series, a random sequence which satisfies five criteria to avoid inflating the score of simple psychological or behavioural patterns. However, in existing literature, these sequences are only determined for a fixed sequence length [<xref ref-type="bibr" rid="CR7">7</xref>], analysed theoretically [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>], implemented in programming languages that are not customary used anymore [<xref ref-type="bibr" rid="CR25">25</xref>], or only partially implemented [<xref ref-type="bibr" rid="CR26">26</xref>]. To circumvent this problem, and building upon previous work [<xref ref-type="bibr" rid="CR25">25</xref>], we have developed a Python software package and graphical tool which generates ready-to-use comma-separated values (CSV) files containing Gellermann series. Our tool allows customization of 4 parameters: the length of sequences, the tolerated divergence from 50% chance rate for single and double alternation (see below), the specific string names of the A and B potential choices, and the number of sequences to produce.</p>
    <p id="Par8">Our software package, <italic>PyGellermann</italic>, consists of a Python library and accompanying graphical user interface. Whereas the library allows users to integrate Gellermann series generation into a larger experimental setup, a graphical user interface makes our tool more accessible to researchers who simply want to generate a number of series without writing a single line of code. The advantage of having our tool in Python is that this programming language is broadly used in scientific research, and can also be combined with other tools from the Python scientific ecosystem (e.g., to create sequences of audio stimuli with <italic>thebeat</italic>; [<xref ref-type="bibr" rid="CR27">27</xref>]). Providing the original Python code has the added advantage that readers can modify it, possibly adapting the original Gellermann criteria [<xref ref-type="bibr" rid="CR7">7</xref>] to their species of interest, and hence to the particular heuristics that species is prone to [<xref ref-type="bibr" rid="CR22">22</xref>].<fig id="Fig1"><label>Fig. 1</label><caption><p>A Venn diagram shows how the set of Gellermann series is a strict subset of all possible binary sequences. Some exemplary sequences (in red) violate some of the criteria put forward by [<xref ref-type="bibr" rid="CR7">7</xref>]. For instance, in red from top to bottom, the set of Gellermann series does not include the sequences (1) ABBAABABAA because it does not contain an equal number of As and Bs, (2) BAAAABBBAB as it contains 4 As in a row, (3) AAABABBBAB because it has only 1 B and in the first half of the sequence and only 1 A in the second, (4) ABABBBAABA because it contains 6 reversals, and (5) ABBBABAAAB as it provides an 80% correct response rate when responses follow a simple alternation pattern (i.e., ABABABABAB). On the contrary, the sequences AABBABAABB, AABABAABBB, AAABBABABB (in green) fulfill all criteria and are included in the nested set of Gellermann series</p></caption><graphic xlink:href="13104_2023_6396_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par9">From a mathematical perspective, Gellermann series of length <italic>n</italic> includes 5 constraints (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). While the original 5 conditions stated by [<xref ref-type="bibr" rid="CR7">7</xref>] only applied to length n=10, they can be generalised in a straightforward way to sequences of different length, following [<xref ref-type="bibr" rid="CR25">25</xref>]. Each series of length <italic>n</italic>: <list list-type="order"><list-item><p id="Par10">must contain an equal number (= <italic>n</italic>/2) of As and Bs;</p></list-item><list-item><p id="Par11">must contain at most 3 As or Bs in a row;</p></list-item><list-item><p id="Par12">must contain at least 20% (= <italic>n</italic>/5) As and Bs within both the first and last half;</p></list-item><list-item><p id="Par13">must contain at most <italic>n</italic>/2 reversals (A–B or B–A transitions);</p></list-item><list-item><p id="Par14">must provide a correct response rate close to 50% chance<xref ref-type="fn" rid="Fn1">1</xref> when responses are provided as simple alternation (ABAB...) or double alternation (AABBAA...and ABBAAB...).</p></list-item></list><fig id="Fig2"><label>Fig. 2</label><caption><p>Monte Carlo estimates of the proportion of all binary sequences that meet all five of Gellermann’s criteria, in function of the length of the sequence. Since the proportion drops off exponentially and our implementation generates and tests balanced sequences (i.e., those with an equal number of As and Bs) uniformly at random, generating Gellermann series with many more than 100 elements quickly becomes infeasible</p></caption><graphic xlink:href="13104_2023_6396_Fig2_HTML" id="MO2"/></fig></p>
    <p id="Par15">From a computational perspective, our code satisfies these mathematical constraints by repeatedly generating random permutations of a sequence with equal numbers of As and Bs (cfr. condition 1), and checking the other 4 conditions until a valid sequence is found. This procedure becomes computationally expensive for large sequences of <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n &gt; 100$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13104_2023_6396_Article_IEq1.gif"/></alternatives></inline-formula> (generating one sequence of length 100 takes about 30 to 60 s, but the time required grows exponentially with <italic>n</italic>; see Fig. <xref rid="Fig2" ref-type="fig">2</xref>). However, we are not aware of a surefire way of generating uniformly random Gellermann series more efficiently, and today’s computational power ensures that this procedure is convenient in contexts similar to studies that have used Gellermann series in the past. In addition, because of the law of large numbers, longer truly random binary sequences are more probable to have properties close to the above criteria (i.e., constraints 1, 3, 4, and 5; constraint 2 can be manually enforced after). Thus, for longer sequences, explicitly generating Gellermann series becomes arguably less important.<fig id="Fig3"><label>Fig. 3</label><caption><p>A screenshot of PyGellermann’s GUI shows the various options available to customise the generated series, as well as options to copy the generated series or save them as a table to a CSV file</p></caption><graphic xlink:href="13104_2023_6396_Fig3_HTML" id="MO3"/></fig></p>
    <p id="Par16">From a user perspective, we provide two complementary interfaces. A graphical user interface (GUI; Fig. <xref rid="Fig3" ref-type="fig">3</xref>) provides a simple, straightforward way to generate any number of freshly random Gellermann series with a single mouse click. Next, the generated sequences can be saved to disk as a CSV file, which can be read by a wide range of other programs and software libraries (most notably, Microsoft Excel, Python’s <italic>Pandas</italic> package, or R DataFrames).</p>
    <p id="Par17">Next to the GUI, <italic>PyGellermann</italic> also has an application programming interface (API), which can be accessed as a Python software library. Importing the pygellermann module provides several functions which generate and return one or more Gellermann series as Python objects. As such, <italic>PyGellermann</italic> can be flexibly integrated as part of a larger program or application. More details can be found in the online API documentation.</p>
    <p id="Par18">More details on the installation and usage of both the graphical user interface and the Python package can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/YannickJadoul/PyGellermann">https://github.com/YannickJadoul/PyGellermann</ext-link>. <italic>PyGellermann</italic> has been released as open-source software under the GNU GPLv3 licence, and we invite everyone to freely use and adapt the software, as well as contribute further improvements.</p>
    <p id="Par19">Finally, we see a role for <italic>PyGellermann</italic> in future studies on the use of Gellermann series. After the original list of sequences [<xref ref-type="bibr" rid="CR7">7</xref>], several arguments have been made for or against this type of randomization (e.g., [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]). There is a concrete opportunity for <italic>PyGellermann</italic> to fulfil a role in experimentally testing the merits of Gellermann series compared to fully random sequences. Such experiments can provide more empirical evidence whether the use of Gellermann series for a certain situation or species is either opportune, superfluous, or inappropriate. In such experiments, <italic>PyGellermann</italic> can be used to generate sets of Gellermann sequences with different “sequence length” and “alternation tolerance” parameters and test the effects on any behavioural differences with respect to fully random sequences.</p>
  </sec>
  <sec id="Sec3">
    <title>Limitations</title>
    <p id="Par20">
      <list list-type="bullet">
        <list-item>
          <p id="Par21">By definition, because the Gellermann set is a subset of all possible binary sequences, Gellermann sequences are overall ‘less random’ than a uniform distribution over all binary sequences. More precisely, if an organism could keep track of sequence regularities, it could exclude (by rote learning or even extrapolation) all those sequences which are not part of the Gellermann set.</p>
        </list-item>
        <list-item>
          <p id="Par22">Previous authors have pointed out the advantages and disadvantages of using Gellermann series (e.g., [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]); however, no clear consensus on a better solution has been found. Before using <italic>PyGellermann</italic> as an experimental tool, one should carefully consider whether Gellermann series are an appropriate randomization for the species and experiment at hand.</p>
        </list-item>
        <list-item>
          <p id="Par23">As noted by previous authors [<xref ref-type="bibr" rid="CR23">23</xref>], some original criteria detailed in [<xref ref-type="bibr" rid="CR7">7</xref>] may be too restrictive or overspecified.</p>
        </list-item>
        <list-item>
          <p id="Par24">Gellermann series are designed to ensure fair assessment of responses generated by simple strategies like perseveration or alternation (i.e., always sticking to the same answer or always switching). Our simulations and computational tests also show that Gellermann series also decently protects against more complicated response strategies such as win-stay/lose-shift or win-shift/lose-stay. However, as discussed by [<xref ref-type="bibr" rid="CR24">24</xref>], under these simple strategies, longer streaks of correct responses may occur and reinforce these response strategies to Gellermann series.</p>
        </list-item>
        <list-item>
          <p id="Par25">Reaching test criterion via binomial testing is, for a given alpha value, a function of sample size; in other words, for instance, 60% correct trials may be significant for a large sample size but not a smaller one. Studying the compound effect of this sample-size dependency and the use of Gellermann series is beyond the scope of this article, but we still warn colleagues of potential combined effects.</p>
        </list-item>
        <list-item>
          <p id="Par26">The use of Gellermann series does of course in no way remove the need for a valid, well thought-out experimental setup and accompanying statistical analysis. Moreover, insofar that the experimental setting (and e.g., a participant’s motivation) allows, increasing the number of trials is the preferred way to reduce uncertainty about participants’ performance.</p>
        </list-item>
      </list>
    </p>
  </sec>
</body>
<back>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p id="Par30">Note that in the original article [<xref ref-type="bibr" rid="CR7">7</xref>], the fifth criterion specified that the “series must offer a chance score of 50% correct from either simple or double alternation of response”. However, as noted by [<xref ref-type="bibr" rid="CR23">23</xref>] and [<xref ref-type="bibr" rid="CR25">25</xref>], no binary sequences of length 10 match this fifth criterion on top of the previous four. As such, we here adopt the approach proposed by [<xref ref-type="bibr" rid="CR23">23</xref>] and generalised by [<xref ref-type="bibr" rid="CR25">25</xref>], in which we allow a fixed margin of tolerance around 50%, determined by the user (by default, 40–60%).</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We are grateful to Robert, Elektra, Jannik, Lisa, and Robbie, as well as all the personnel from Zoo Cleves, for giving us support and inspiration.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>YJ, DD, and AR: conceptualisation, data curation, formal analysis, methodology, project administration, writing - original draft preparation, writing - review and editing. YJ: investigation, software, visualisation. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Open Access funding enabled and organized by Projekt DEAL. YJ, DD, and AR were supported by Max Planck Independent Group Leader funding awarded to AR.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All code is available in the GitHub YannickJadoul/PyGellermann repository, <ext-link ext-link-type="uri" xlink:href="https://github.com/YannickJadoul/PyGellermann">https://github.com/YannickJadoul/PyGellermann</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par27">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par28">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par29">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schluessel</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Duengen</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Irrespective of size, scales, color or body shape, all fish are just fish: object categorization in the gray bamboo shark <italic>Chiloscyllium griseum</italic></article-title>
        <source>Animal Cogn.</source>
        <year>2015</year>
        <volume>18</volume>
        <fpage>497</fpage>
        <lpage>507</lpage>
        <pub-id pub-id-type="doi">10.1007/s10071-014-0818-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Erdsack</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dehnhardt</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hanke</surname>
            <given-names>FD</given-names>
          </name>
        </person-group>
        <article-title>Serial visual reversal learning in harbor seals (<italic>Phoca vitulina</italic>)</article-title>
        <source>Animal Cogn.</source>
        <year>2022</year>
        <volume>25</volume>
        <issue>5</issue>
        <fpage>1183</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="doi">10.1007/s10071-022-01653-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Ortiz ST, Maxwell A, Hernandez A, Hansen KA. Does participation in acoustic experiments improve welfare in captive animals? A case study of three grey seals (<italic>Halichoerus grypus</italic>). bioRxiv. 2020:2020-08.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lazareva</surname>
            <given-names>OF</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Kaufman</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Call</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kaufman</surname>
            <given-names>JCE</given-names>
          </name>
        </person-group>
        <article-title>Perceptual categorization in pigeons</article-title>
        <source>Cambridge handbooks in psychology</source>
        <year>2021</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ortiz</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Maxwell</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Krasheninnikova</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wahlberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Larsen</surname>
            <given-names>ON</given-names>
          </name>
        </person-group>
        <article-title>Problem solving capabilities of peach-fronted conures (<italic>Eupsittula aurea</italic>) studied with the string-pulling test</article-title>
        <source>Behaviour.</source>
        <year>2019</year>
        <volume>156</volume>
        <issue>5–8</issue>
        <fpage>815</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="doi">10.1163/1568539X-00003539</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schluessel</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Kraniotakes</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bleckmann</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Visual discrimination of rotated 3D objects in Malawi cichlids (<italic>Pseudotropheus</italic> sp.): a first indication for form constancy in fishes</article-title>
        <source>Animal Cogn.</source>
        <year>2014</year>
        <volume>17</volume>
        <fpage>359</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.1007/s10071-013-0667-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gellermann</surname>
            <given-names>LW</given-names>
          </name>
        </person-group>
        <article-title>Chance orders of alternating stimuli in visual discrimination experiments</article-title>
        <source>J Genet Psychol.</source>
        <year>1933</year>
        <volume>42</volume>
        <fpage>206</fpage>
        <lpage>8</lpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bosshard</surname>
            <given-names>TC</given-names>
          </name>
          <name>
            <surname>Salazar</surname>
            <given-names>LTH</given-names>
          </name>
          <name>
            <surname>Laska</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Numerical cognition in black-handed spider monkeys (<italic>Ateles geoffroyi</italic>)</article-title>
        <source>Behav Process</source>
        <year>2022</year>
        <volume>201</volume>
        <fpage>104734</fpage>
        <pub-id pub-id-type="doi">10.1016/j.beproc.2022.104734</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerard</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Mackay</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>McIlvane</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>Rapid generation of balanced trial distributions for discrimination learning procedures: a technical note</article-title>
        <source>J Exp Anal Behav.</source>
        <year>2014</year>
        <volume>101</volume>
        <issue>1</issue>
        <fpage>171</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1002/jeab.58</pub-id>
        <?supplied-pmid 24249664?>
        <pub-id pub-id-type="pmid">24249664</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robbins</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Some aspects of the sequential design of experiments</article-title>
        <source>Bull Amer Math Soc.</source>
        <year>1952</year>
        <volume>58</volume>
        <issue>6</issue>
        <fpage>527</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1090/S0002-9904-1952-09620-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Herrera</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Treviño</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Undesirable choice biases with small differences in the spatial structure of chance stimulus sequences</article-title>
        <source>PLoS ONE.</source>
        <year>2015</year>
        <volume>10</volume>
        <issue>8</issue>
        <fpage>e0136084</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0136084</pub-id>
        <?supplied-pmid 26305097?>
        <pub-id pub-id-type="pmid">26305097</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Emmerton</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Numerosity differences and effects of stimulus density on pigeons’ discrimination performance</article-title>
        <source>Animal Learn Behav.</source>
        <year>1998</year>
        <volume>26</volume>
        <issue>3</issue>
        <fpage>243</fpage>
        <lpage>56</lpage>
        <pub-id pub-id-type="doi">10.3758/BF03199218</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van</surname>
            <given-names>Watanabe S</given-names>
          </name>
        </person-group>
        <article-title>Gogh, Chagall and pigeons: picture discrimination in pigeons and humans</article-title>
        <source>Animal Cogn.</source>
        <year>2001</year>
        <volume>4</volume>
        <fpage>147</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1007/s100710100112</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dawson</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Munson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Estes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Osterling</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McPartland</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Toth</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Neurocognitive function and joint attention ability in young children with autism spectrum disorder versus developmental delay</article-title>
        <source>Child Dev.</source>
        <year>2002</year>
        <volume>73</volume>
        <issue>2</issue>
        <fpage>345</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1111/1467-8624.00411</pub-id>
        <?supplied-pmid 11949896?>
        <pub-id pub-id-type="pmid">11949896</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reichmuth</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ghoul</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Southall</surname>
            <given-names>BL</given-names>
          </name>
        </person-group>
        <article-title>Temporal processing of low-frequency sounds by seals (L)</article-title>
        <source>J Acoust Soc Am.</source>
        <year>2012</year>
        <volume>132</volume>
        <issue>4</issue>
        <fpage>2147</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1121/1.4746030</pub-id>
        <?supplied-pmid 23039406?>
        <pub-id pub-id-type="pmid">23039406</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heinrich</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ravignani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hanke</surname>
            <given-names>FD</given-names>
          </name>
        </person-group>
        <article-title>Visual timing abilities of a harbour seal (<italic>Phoca vitulina</italic>) and a South African fur seal (<italic>Arctocephalus pusillus pusillus</italic>) for sub-and supra-second time intervals</article-title>
        <source>Animal Cogn.</source>
        <year>2020</year>
        <volume>23</volume>
        <fpage>851</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1007/s10071-020-01390-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poppelier</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bonsberger</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Berkhout</surname>
            <given-names>BW</given-names>
          </name>
          <name>
            <surname>Pollmanns</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schluessel</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Acoustic discrimination in the grey bamboo shark <italic>Chiloscyllium griseum</italic></article-title>
        <source>Sci Rep.</source>
        <year>2022</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>6520</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-022-10257-1</pub-id>
        <?supplied-pmid 35444192?>
        <pub-id pub-id-type="pmid">35444192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schluessel</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Kreuter</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gosemann</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Cichlids and stingrays can add and subtract ‘one’ in the number space from one to five</article-title>
        <source>Sci Rep.</source>
        <year>2022</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>3894</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-022-07552-2</pub-id>
        <?supplied-pmid 35361791?>
        <pub-id pub-id-type="pmid">35361791</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krüger</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hanke</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miersch</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Dehnhardt</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Detection and direction discrimination of single vortex rings by harbour seals (<italic>Phoca vitulina</italic>)</article-title>
        <source>J Exp Biol.</source>
        <year>2018</year>
        <volume>221</volume>
        <issue>8</issue>
        <fpage>jeb170753</fpage>
        <pub-id pub-id-type="doi">10.1242/jeb.170753</pub-id>
        <?supplied-pmid 29487151?>
        <pub-id pub-id-type="pmid">29487151</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martini</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Begall</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Findeklee</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Malkemper</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Burda</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Dogs can be trained to find a bar magnet</article-title>
        <source>PeerJ.</source>
        <year>2018</year>
        <volume>6</volume>
        <fpage>e6117</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.6117</pub-id>
        <?supplied-pmid 30588405?>
        <pub-id pub-id-type="pmid">30588405</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stansbury</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>de Freitas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Janik</surname>
            <given-names>VM</given-names>
          </name>
        </person-group>
        <article-title>Can a gray seal (<italic>Halichoerus grypus</italic>) generalize call classes?</article-title>
        <source>J Comp Psychol.</source>
        <year>2015</year>
        <volume>129</volume>
        <issue>4</issue>
        <fpage>412</fpage>
        <pub-id pub-id-type="doi">10.1037/a0039756</pub-id>
        <?supplied-pmid 26460856?>
        <pub-id pub-id-type="pmid">26460856</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ravignani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Westphal-Fitch</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Aust</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Schlumpp</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Fitch</surname>
            <given-names>WT</given-names>
          </name>
        </person-group>
        <article-title>More than one way to see it: individual heuristics in avian visual computation</article-title>
        <source>Cognition.</source>
        <year>2015</year>
        <volume>143</volume>
        <fpage>13</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cognition.2015.05.021</pub-id>
        <?supplied-pmid 26113444?>
        <pub-id pub-id-type="pmid">26113444</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lester</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>A note on Gellerman series</article-title>
        <source>Psychologi Rep.</source>
        <year>1966</year>
        <volume>18</volume>
        <issue>2</issue>
        <fpage>426</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.2466/pr0.1966.18.2.426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fellows</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Change stimulus sequences for discrimination tasks</article-title>
        <source>Psychol Bull.</source>
        <year>1967</year>
        <volume>67</volume>
        <issue>2</issue>
        <fpage>87</fpage>
        <pub-id pub-id-type="doi">10.1037/h0024098</pub-id>
        <?supplied-pmid 6045339?>
        <pub-id pub-id-type="pmid">6045339</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fragaszy</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Fragaszy</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>A program to generate Gellermann (pseudorandom) series of binary states</article-title>
        <source>Behav Res Methods Instrum.</source>
        <year>1978</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>83</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.3758/BF03205103</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Bandoni G, Cesaretti G, Kusmic C, Musumeci D. An algorithm generating long sequences of stimuli in behavioral science: a suitable test for biosensors. Molecular Electronics: Bio-sensors and Bio-computers; 2003. p. 373–8.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">van der Werff J, Ravignani A, Jadoul Y. thebeat: A Python package for working with rhythms and other temporal sequences. In review.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Res Notes</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Res Notes</journal-id>
    <journal-title-group>
      <journal-title>BMC Research Notes</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-0500</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10320995</article-id>
    <article-id pub-id-type="pmid">37403146</article-id>
    <article-id pub-id-type="publisher-id">6396</article-id>
    <article-id pub-id-type="doi">10.1186/s13104-023-06396-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Note</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PyGellermann: a Python tool to generate pseudorandom series for human and non-human animal behavioural experiments</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Jadoul</surname>
          <given-names>Yannick</given-names>
        </name>
        <address>
          <email>Yannick.Jadoul@mpi.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Duengen</surname>
          <given-names>Diandra</given-names>
        </name>
        <address>
          <email>Diandra.Duengen@mpi.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ravignani</surname>
          <given-names>Andrea</given-names>
        </name>
        <address>
          <email>andrea.ravignani@uniroma1.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.419550.c</institution-id><institution-id institution-id-type="ISNI">0000 0004 0501 3839</institution-id><institution>Comparative Bioacoustics Group, </institution><institution>Max Planck Institute for Psycholinguistics, </institution></institution-wrap>Nijmegen, The Netherlands </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.7048.b</institution-id><institution-id institution-id-type="ISNI">0000 0001 1956 2722</institution-id><institution>Center for Music in the Brain, Department of Clinical Medicine, </institution><institution>Aarhus University &amp; The Royal Academy of Music Aarhus/Aalborg, </institution></institution-wrap>Aarhus, Denmark </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.7841.a</institution-id><institution>Department of Human Neurosciences, </institution><institution>Sapienza University of Rome, </institution></institution-wrap>Rome, Italy </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>5</day>
      <month>7</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>135</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>6</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Objective</title>
        <p id="Par1">Researchers in animal cognition, psychophysics, and experimental psychology need to randomise the presentation order of trials in experimental sessions. In many paradigms, for each trial, one of two responses can be correct, and the trials need to be ordered such that the participant’s responses are a fair assessment of their performance. Specifically, in some cases, especially for low numbers of trials, randomised trial orders need to be excluded if they contain simple patterns which a participant could accidentally match and so succeed at the task without learning.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present and distribute a simple Python software package and tool to produce pseudorandom sequences following the Gellermann series. This series has been proposed to pre-empt simple heuristics and avoid inflated performance rates via false positive responses. Our tool allows users to choose the sequence length and outputs a .csv file with newly and randomly generated sequences. This allows behavioural researchers to produce, in a few seconds, a pseudorandom sequence for their specific experiment. <italic>PyGellermann</italic> is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/YannickJadoul/PyGellermann">https://github.com/YannickJadoul/PyGellermann</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Animal cognition</kwd>
      <kwd>Experimental psychology</kwd>
      <kwd>Randomization</kwd>
      <kwd>Simple heuristics</kwd>
      <kwd>Python</kwd>
      <kwd>Psychometrics</kwd>
      <kwd>Two-alternative forced-choice</kwd>
      <kwd>Go/no-go</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004189</institution-id>
            <institution>Max-Planck-Gesellschaft</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Max Planck Independent Group Leader funding</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Max Planck Institute for Psycholinguistics (2)</institution>
        </funding-source>
      </award-group>
      <open-access>
        <p>Open Access funding enabled and organized by Projekt DEAL.</p>
      </open-access>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par3">What is the best way to present experimental stimuli in random order? Two-alternative forced-choice tasks and go/no-go paradigms are common methodologies in human psychological and animal behaviour experiments. These tests require a participant to choose between two options; in the two-alternative forced-choice paradigm these options are two actual stimuli [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], while in the go/no-go paradigm the participant is expected to show a behaviour in response to a positive stimulus (“go”), and to inhibit that behaviour in response to a negative one (“no-go”) [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>].</p>
    <p id="Par4">The commonality among all these experiments and paradigms is that in each trial a participant can choose between two actions, of which only one is correct. From an experimenter’s perspective, the question then is how to decide in which order to present these trials? The obvious answer is randomisation: randomised sequences aim at preventing the predictability of a stimulus, and thereby false positive results in the absence of learning. The experimenter randomises, within a sequence, which of the two possible responses—hereafter referred to as A and B—is correct in each trial.</p>
    <p id="Par5">Purely random sequences, however, can accidentally contain some regularities which may be leveraged by participants. This is a potential issue during testing, when the accidental regularities in a sequence match the participant’s cognitive biases and inflate the perceived performance. It also risks hindering learning, if a participant picks up on unintended regularities in presented sequences (e.g., risking to develop a position/colour preference; [<xref ref-type="bibr" rid="CR5">5</xref>]). Let us consider a random sequence of two types of trials, A and B, in which the number of A/B trials is not balanced 50/50. In this case, an animal sticking to response A (e.g., because of a stimulus or side preference; [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]) will often be able to achieve &gt;50% correct answers within an experimental session. Likewise, a random binary sequence might also feature many alternations of adjacent As and Bs. A participant with a natural tendency to alternate between A and B, will be successful in correctly guessing significantly more than the expected 50%, when the alternating guesses happen to match those of the sequence. The particular alternation strategy adopted by the subject may even result in 70% correct choices by chance [<xref ref-type="bibr" rid="CR7">7</xref>]. This can be a problem, as the learning criterion—the benchmark to consider a task learned—is often 70% correct choices in a pre-set amount of consecutive sessions [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. Moreover, when such patterns in random sequences match a participant’s cognitive biases, these trials might incorrectly confirm and reinforce these pre-existing biases rather than advance the learning process. Another common example of these biases is the win-stay, lose-switch strategy witnessed in human psychology.</p>
    <p id="Par6">In general, building randomised but balanced trial sequences that are immune to simple cognitive biases and ensure that a participant has indeed learned, is not obvious [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. Several methods exist to circumvent scenarios where, because of an unfortunate pick of presentation order, humans and other animals can accidentally succeed at a task without learning. The most common one is the use of Gellermann series [<xref ref-type="bibr" rid="CR7">7</xref>], which puts some constraints on the randomization and is often applied when experimental sessions contain relatively few trials (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). This is a somewhat paradoxical situation: Mathematically speaking, the introduction of extra constraints increases the predictability of a sequence, which can in turn be exploited by a rational statistical learner [<xref ref-type="bibr" rid="CR11">11</xref>]. Nevertheless, Gellermann series are a popular heuristic to deal with the potentially irrational cognitive biases in human and non-human animal cognitive experiments, and are finding use in research fields such as psychophysics, neuropsychology, comparative psychology, and animal behaviour [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR16">16</xref>]. The number of trials per session in animal behaviour experiments can be as low as 10 [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>], 20 [<xref ref-type="bibr" rid="CR5">5</xref>], 30 [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>], 40 [<xref ref-type="bibr" rid="CR12">12</xref>], 40 to 60 [<xref ref-type="bibr" rid="CR15">15</xref>], or 50 to 100 [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
  </sec>
  <sec id="Sec2">
    <title>Main text</title>
    <p id="Par7">Behavioural researchers are therefore faced with an apparent paradox: they need to create sequences that are as random as possible, but exclude those that would overestimate the experimental participants’ performance by coinciding with simple, non-learning behaviour [<xref ref-type="bibr" rid="CR22">22</xref>]. The solution typically adopted is to use a Gellermann series, a random sequence which satisfies five criteria to avoid inflating the score of simple psychological or behavioural patterns. However, in existing literature, these sequences are only determined for a fixed sequence length [<xref ref-type="bibr" rid="CR7">7</xref>], analysed theoretically [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>], implemented in programming languages that are not customary used anymore [<xref ref-type="bibr" rid="CR25">25</xref>], or only partially implemented [<xref ref-type="bibr" rid="CR26">26</xref>]. To circumvent this problem, and building upon previous work [<xref ref-type="bibr" rid="CR25">25</xref>], we have developed a Python software package and graphical tool which generates ready-to-use comma-separated values (CSV) files containing Gellermann series. Our tool allows customization of 4 parameters: the length of sequences, the tolerated divergence from 50% chance rate for single and double alternation (see below), the specific string names of the A and B potential choices, and the number of sequences to produce.</p>
    <p id="Par8">Our software package, <italic>PyGellermann</italic>, consists of a Python library and accompanying graphical user interface. Whereas the library allows users to integrate Gellermann series generation into a larger experimental setup, a graphical user interface makes our tool more accessible to researchers who simply want to generate a number of series without writing a single line of code. The advantage of having our tool in Python is that this programming language is broadly used in scientific research, and can also be combined with other tools from the Python scientific ecosystem (e.g., to create sequences of audio stimuli with <italic>thebeat</italic>; [<xref ref-type="bibr" rid="CR27">27</xref>]). Providing the original Python code has the added advantage that readers can modify it, possibly adapting the original Gellermann criteria [<xref ref-type="bibr" rid="CR7">7</xref>] to their species of interest, and hence to the particular heuristics that species is prone to [<xref ref-type="bibr" rid="CR22">22</xref>].<fig id="Fig1"><label>Fig. 1</label><caption><p>A Venn diagram shows how the set of Gellermann series is a strict subset of all possible binary sequences. Some exemplary sequences (in red) violate some of the criteria put forward by [<xref ref-type="bibr" rid="CR7">7</xref>]. For instance, in red from top to bottom, the set of Gellermann series does not include the sequences (1) ABBAABABAA because it does not contain an equal number of As and Bs, (2) BAAAABBBAB as it contains 4 As in a row, (3) AAABABBBAB because it has only 1 B and in the first half of the sequence and only 1 A in the second, (4) ABABBBAABA because it contains 6 reversals, and (5) ABBBABAAAB as it provides an 80% correct response rate when responses follow a simple alternation pattern (i.e., ABABABABAB). On the contrary, the sequences AABBABAABB, AABABAABBB, AAABBABABB (in green) fulfill all criteria and are included in the nested set of Gellermann series</p></caption><graphic xlink:href="13104_2023_6396_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par9">From a mathematical perspective, Gellermann series of length <italic>n</italic> includes 5 constraints (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). While the original 5 conditions stated by [<xref ref-type="bibr" rid="CR7">7</xref>] only applied to length n=10, they can be generalised in a straightforward way to sequences of different length, following [<xref ref-type="bibr" rid="CR25">25</xref>]. Each series of length <italic>n</italic>: <list list-type="order"><list-item><p id="Par10">must contain an equal number (= <italic>n</italic>/2) of As and Bs;</p></list-item><list-item><p id="Par11">must contain at most 3 As or Bs in a row;</p></list-item><list-item><p id="Par12">must contain at least 20% (= <italic>n</italic>/5) As and Bs within both the first and last half;</p></list-item><list-item><p id="Par13">must contain at most <italic>n</italic>/2 reversals (A–B or B–A transitions);</p></list-item><list-item><p id="Par14">must provide a correct response rate close to 50% chance<xref ref-type="fn" rid="Fn1">1</xref> when responses are provided as simple alternation (ABAB...) or double alternation (AABBAA...and ABBAAB...).</p></list-item></list><fig id="Fig2"><label>Fig. 2</label><caption><p>Monte Carlo estimates of the proportion of all binary sequences that meet all five of Gellermann’s criteria, in function of the length of the sequence. Since the proportion drops off exponentially and our implementation generates and tests balanced sequences (i.e., those with an equal number of As and Bs) uniformly at random, generating Gellermann series with many more than 100 elements quickly becomes infeasible</p></caption><graphic xlink:href="13104_2023_6396_Fig2_HTML" id="MO2"/></fig></p>
    <p id="Par15">From a computational perspective, our code satisfies these mathematical constraints by repeatedly generating random permutations of a sequence with equal numbers of As and Bs (cfr. condition 1), and checking the other 4 conditions until a valid sequence is found. This procedure becomes computationally expensive for large sequences of <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n &gt; 100$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13104_2023_6396_Article_IEq1.gif"/></alternatives></inline-formula> (generating one sequence of length 100 takes about 30 to 60 s, but the time required grows exponentially with <italic>n</italic>; see Fig. <xref rid="Fig2" ref-type="fig">2</xref>). However, we are not aware of a surefire way of generating uniformly random Gellermann series more efficiently, and today’s computational power ensures that this procedure is convenient in contexts similar to studies that have used Gellermann series in the past. In addition, because of the law of large numbers, longer truly random binary sequences are more probable to have properties close to the above criteria (i.e., constraints 1, 3, 4, and 5; constraint 2 can be manually enforced after). Thus, for longer sequences, explicitly generating Gellermann series becomes arguably less important.<fig id="Fig3"><label>Fig. 3</label><caption><p>A screenshot of PyGellermann’s GUI shows the various options available to customise the generated series, as well as options to copy the generated series or save them as a table to a CSV file</p></caption><graphic xlink:href="13104_2023_6396_Fig3_HTML" id="MO3"/></fig></p>
    <p id="Par16">From a user perspective, we provide two complementary interfaces. A graphical user interface (GUI; Fig. <xref rid="Fig3" ref-type="fig">3</xref>) provides a simple, straightforward way to generate any number of freshly random Gellermann series with a single mouse click. Next, the generated sequences can be saved to disk as a CSV file, which can be read by a wide range of other programs and software libraries (most notably, Microsoft Excel, Python’s <italic>Pandas</italic> package, or R DataFrames).</p>
    <p id="Par17">Next to the GUI, <italic>PyGellermann</italic> also has an application programming interface (API), which can be accessed as a Python software library. Importing the pygellermann module provides several functions which generate and return one or more Gellermann series as Python objects. As such, <italic>PyGellermann</italic> can be flexibly integrated as part of a larger program or application. More details can be found in the online API documentation.</p>
    <p id="Par18">More details on the installation and usage of both the graphical user interface and the Python package can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/YannickJadoul/PyGellermann">https://github.com/YannickJadoul/PyGellermann</ext-link>. <italic>PyGellermann</italic> has been released as open-source software under the GNU GPLv3 licence, and we invite everyone to freely use and adapt the software, as well as contribute further improvements.</p>
    <p id="Par19">Finally, we see a role for <italic>PyGellermann</italic> in future studies on the use of Gellermann series. After the original list of sequences [<xref ref-type="bibr" rid="CR7">7</xref>], several arguments have been made for or against this type of randomization (e.g., [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]). There is a concrete opportunity for <italic>PyGellermann</italic> to fulfil a role in experimentally testing the merits of Gellermann series compared to fully random sequences. Such experiments can provide more empirical evidence whether the use of Gellermann series for a certain situation or species is either opportune, superfluous, or inappropriate. In such experiments, <italic>PyGellermann</italic> can be used to generate sets of Gellermann sequences with different “sequence length” and “alternation tolerance” parameters and test the effects on any behavioural differences with respect to fully random sequences.</p>
  </sec>
  <sec id="Sec3">
    <title>Limitations</title>
    <p id="Par20">
      <list list-type="bullet">
        <list-item>
          <p id="Par21">By definition, because the Gellermann set is a subset of all possible binary sequences, Gellermann sequences are overall ‘less random’ than a uniform distribution over all binary sequences. More precisely, if an organism could keep track of sequence regularities, it could exclude (by rote learning or even extrapolation) all those sequences which are not part of the Gellermann set.</p>
        </list-item>
        <list-item>
          <p id="Par22">Previous authors have pointed out the advantages and disadvantages of using Gellermann series (e.g., [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]); however, no clear consensus on a better solution has been found. Before using <italic>PyGellermann</italic> as an experimental tool, one should carefully consider whether Gellermann series are an appropriate randomization for the species and experiment at hand.</p>
        </list-item>
        <list-item>
          <p id="Par23">As noted by previous authors [<xref ref-type="bibr" rid="CR23">23</xref>], some original criteria detailed in [<xref ref-type="bibr" rid="CR7">7</xref>] may be too restrictive or overspecified.</p>
        </list-item>
        <list-item>
          <p id="Par24">Gellermann series are designed to ensure fair assessment of responses generated by simple strategies like perseveration or alternation (i.e., always sticking to the same answer or always switching). Our simulations and computational tests also show that Gellermann series also decently protects against more complicated response strategies such as win-stay/lose-shift or win-shift/lose-stay. However, as discussed by [<xref ref-type="bibr" rid="CR24">24</xref>], under these simple strategies, longer streaks of correct responses may occur and reinforce these response strategies to Gellermann series.</p>
        </list-item>
        <list-item>
          <p id="Par25">Reaching test criterion via binomial testing is, for a given alpha value, a function of sample size; in other words, for instance, 60% correct trials may be significant for a large sample size but not a smaller one. Studying the compound effect of this sample-size dependency and the use of Gellermann series is beyond the scope of this article, but we still warn colleagues of potential combined effects.</p>
        </list-item>
        <list-item>
          <p id="Par26">The use of Gellermann series does of course in no way remove the need for a valid, well thought-out experimental setup and accompanying statistical analysis. Moreover, insofar that the experimental setting (and e.g., a participant’s motivation) allows, increasing the number of trials is the preferred way to reduce uncertainty about participants’ performance.</p>
        </list-item>
      </list>
    </p>
  </sec>
</body>
<back>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p id="Par30">Note that in the original article [<xref ref-type="bibr" rid="CR7">7</xref>], the fifth criterion specified that the “series must offer a chance score of 50% correct from either simple or double alternation of response”. However, as noted by [<xref ref-type="bibr" rid="CR23">23</xref>] and [<xref ref-type="bibr" rid="CR25">25</xref>], no binary sequences of length 10 match this fifth criterion on top of the previous four. As such, we here adopt the approach proposed by [<xref ref-type="bibr" rid="CR23">23</xref>] and generalised by [<xref ref-type="bibr" rid="CR25">25</xref>], in which we allow a fixed margin of tolerance around 50%, determined by the user (by default, 40–60%).</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We are grateful to Robert, Elektra, Jannik, Lisa, and Robbie, as well as all the personnel from Zoo Cleves, for giving us support and inspiration.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>YJ, DD, and AR: conceptualisation, data curation, formal analysis, methodology, project administration, writing - original draft preparation, writing - review and editing. YJ: investigation, software, visualisation. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Open Access funding enabled and organized by Projekt DEAL. YJ, DD, and AR were supported by Max Planck Independent Group Leader funding awarded to AR.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All code is available in the GitHub YannickJadoul/PyGellermann repository, <ext-link ext-link-type="uri" xlink:href="https://github.com/YannickJadoul/PyGellermann">https://github.com/YannickJadoul/PyGellermann</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par27">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par28">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par29">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schluessel</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Duengen</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Irrespective of size, scales, color or body shape, all fish are just fish: object categorization in the gray bamboo shark <italic>Chiloscyllium griseum</italic></article-title>
        <source>Animal Cogn.</source>
        <year>2015</year>
        <volume>18</volume>
        <fpage>497</fpage>
        <lpage>507</lpage>
        <pub-id pub-id-type="doi">10.1007/s10071-014-0818-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Erdsack</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dehnhardt</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hanke</surname>
            <given-names>FD</given-names>
          </name>
        </person-group>
        <article-title>Serial visual reversal learning in harbor seals (<italic>Phoca vitulina</italic>)</article-title>
        <source>Animal Cogn.</source>
        <year>2022</year>
        <volume>25</volume>
        <issue>5</issue>
        <fpage>1183</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="doi">10.1007/s10071-022-01653-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Ortiz ST, Maxwell A, Hernandez A, Hansen KA. Does participation in acoustic experiments improve welfare in captive animals? A case study of three grey seals (<italic>Halichoerus grypus</italic>). bioRxiv. 2020:2020-08.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lazareva</surname>
            <given-names>OF</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Kaufman</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Call</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kaufman</surname>
            <given-names>JCE</given-names>
          </name>
        </person-group>
        <article-title>Perceptual categorization in pigeons</article-title>
        <source>Cambridge handbooks in psychology</source>
        <year>2021</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ortiz</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Maxwell</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Krasheninnikova</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wahlberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Larsen</surname>
            <given-names>ON</given-names>
          </name>
        </person-group>
        <article-title>Problem solving capabilities of peach-fronted conures (<italic>Eupsittula aurea</italic>) studied with the string-pulling test</article-title>
        <source>Behaviour.</source>
        <year>2019</year>
        <volume>156</volume>
        <issue>5–8</issue>
        <fpage>815</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="doi">10.1163/1568539X-00003539</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schluessel</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Kraniotakes</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bleckmann</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Visual discrimination of rotated 3D objects in Malawi cichlids (<italic>Pseudotropheus</italic> sp.): a first indication for form constancy in fishes</article-title>
        <source>Animal Cogn.</source>
        <year>2014</year>
        <volume>17</volume>
        <fpage>359</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.1007/s10071-013-0667-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gellermann</surname>
            <given-names>LW</given-names>
          </name>
        </person-group>
        <article-title>Chance orders of alternating stimuli in visual discrimination experiments</article-title>
        <source>J Genet Psychol.</source>
        <year>1933</year>
        <volume>42</volume>
        <fpage>206</fpage>
        <lpage>8</lpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bosshard</surname>
            <given-names>TC</given-names>
          </name>
          <name>
            <surname>Salazar</surname>
            <given-names>LTH</given-names>
          </name>
          <name>
            <surname>Laska</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Numerical cognition in black-handed spider monkeys (<italic>Ateles geoffroyi</italic>)</article-title>
        <source>Behav Process</source>
        <year>2022</year>
        <volume>201</volume>
        <fpage>104734</fpage>
        <pub-id pub-id-type="doi">10.1016/j.beproc.2022.104734</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerard</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Mackay</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>McIlvane</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>Rapid generation of balanced trial distributions for discrimination learning procedures: a technical note</article-title>
        <source>J Exp Anal Behav.</source>
        <year>2014</year>
        <volume>101</volume>
        <issue>1</issue>
        <fpage>171</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1002/jeab.58</pub-id>
        <?supplied-pmid 24249664?>
        <pub-id pub-id-type="pmid">24249664</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robbins</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Some aspects of the sequential design of experiments</article-title>
        <source>Bull Amer Math Soc.</source>
        <year>1952</year>
        <volume>58</volume>
        <issue>6</issue>
        <fpage>527</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1090/S0002-9904-1952-09620-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Herrera</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Treviño</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Undesirable choice biases with small differences in the spatial structure of chance stimulus sequences</article-title>
        <source>PLoS ONE.</source>
        <year>2015</year>
        <volume>10</volume>
        <issue>8</issue>
        <fpage>e0136084</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0136084</pub-id>
        <?supplied-pmid 26305097?>
        <pub-id pub-id-type="pmid">26305097</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Emmerton</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Numerosity differences and effects of stimulus density on pigeons’ discrimination performance</article-title>
        <source>Animal Learn Behav.</source>
        <year>1998</year>
        <volume>26</volume>
        <issue>3</issue>
        <fpage>243</fpage>
        <lpage>56</lpage>
        <pub-id pub-id-type="doi">10.3758/BF03199218</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van</surname>
            <given-names>Watanabe S</given-names>
          </name>
        </person-group>
        <article-title>Gogh, Chagall and pigeons: picture discrimination in pigeons and humans</article-title>
        <source>Animal Cogn.</source>
        <year>2001</year>
        <volume>4</volume>
        <fpage>147</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1007/s100710100112</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dawson</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Munson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Estes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Osterling</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McPartland</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Toth</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Neurocognitive function and joint attention ability in young children with autism spectrum disorder versus developmental delay</article-title>
        <source>Child Dev.</source>
        <year>2002</year>
        <volume>73</volume>
        <issue>2</issue>
        <fpage>345</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1111/1467-8624.00411</pub-id>
        <?supplied-pmid 11949896?>
        <pub-id pub-id-type="pmid">11949896</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reichmuth</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ghoul</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Southall</surname>
            <given-names>BL</given-names>
          </name>
        </person-group>
        <article-title>Temporal processing of low-frequency sounds by seals (L)</article-title>
        <source>J Acoust Soc Am.</source>
        <year>2012</year>
        <volume>132</volume>
        <issue>4</issue>
        <fpage>2147</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1121/1.4746030</pub-id>
        <?supplied-pmid 23039406?>
        <pub-id pub-id-type="pmid">23039406</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heinrich</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ravignani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hanke</surname>
            <given-names>FD</given-names>
          </name>
        </person-group>
        <article-title>Visual timing abilities of a harbour seal (<italic>Phoca vitulina</italic>) and a South African fur seal (<italic>Arctocephalus pusillus pusillus</italic>) for sub-and supra-second time intervals</article-title>
        <source>Animal Cogn.</source>
        <year>2020</year>
        <volume>23</volume>
        <fpage>851</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1007/s10071-020-01390-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poppelier</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bonsberger</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Berkhout</surname>
            <given-names>BW</given-names>
          </name>
          <name>
            <surname>Pollmanns</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schluessel</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Acoustic discrimination in the grey bamboo shark <italic>Chiloscyllium griseum</italic></article-title>
        <source>Sci Rep.</source>
        <year>2022</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>6520</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-022-10257-1</pub-id>
        <?supplied-pmid 35444192?>
        <pub-id pub-id-type="pmid">35444192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schluessel</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Kreuter</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gosemann</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Cichlids and stingrays can add and subtract ‘one’ in the number space from one to five</article-title>
        <source>Sci Rep.</source>
        <year>2022</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>3894</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-022-07552-2</pub-id>
        <?supplied-pmid 35361791?>
        <pub-id pub-id-type="pmid">35361791</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krüger</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hanke</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miersch</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Dehnhardt</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Detection and direction discrimination of single vortex rings by harbour seals (<italic>Phoca vitulina</italic>)</article-title>
        <source>J Exp Biol.</source>
        <year>2018</year>
        <volume>221</volume>
        <issue>8</issue>
        <fpage>jeb170753</fpage>
        <pub-id pub-id-type="doi">10.1242/jeb.170753</pub-id>
        <?supplied-pmid 29487151?>
        <pub-id pub-id-type="pmid">29487151</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martini</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Begall</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Findeklee</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Malkemper</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Burda</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Dogs can be trained to find a bar magnet</article-title>
        <source>PeerJ.</source>
        <year>2018</year>
        <volume>6</volume>
        <fpage>e6117</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.6117</pub-id>
        <?supplied-pmid 30588405?>
        <pub-id pub-id-type="pmid">30588405</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stansbury</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>de Freitas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Janik</surname>
            <given-names>VM</given-names>
          </name>
        </person-group>
        <article-title>Can a gray seal (<italic>Halichoerus grypus</italic>) generalize call classes?</article-title>
        <source>J Comp Psychol.</source>
        <year>2015</year>
        <volume>129</volume>
        <issue>4</issue>
        <fpage>412</fpage>
        <pub-id pub-id-type="doi">10.1037/a0039756</pub-id>
        <?supplied-pmid 26460856?>
        <pub-id pub-id-type="pmid">26460856</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ravignani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Westphal-Fitch</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Aust</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Schlumpp</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Fitch</surname>
            <given-names>WT</given-names>
          </name>
        </person-group>
        <article-title>More than one way to see it: individual heuristics in avian visual computation</article-title>
        <source>Cognition.</source>
        <year>2015</year>
        <volume>143</volume>
        <fpage>13</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cognition.2015.05.021</pub-id>
        <?supplied-pmid 26113444?>
        <pub-id pub-id-type="pmid">26113444</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lester</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>A note on Gellerman series</article-title>
        <source>Psychologi Rep.</source>
        <year>1966</year>
        <volume>18</volume>
        <issue>2</issue>
        <fpage>426</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.2466/pr0.1966.18.2.426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fellows</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Change stimulus sequences for discrimination tasks</article-title>
        <source>Psychol Bull.</source>
        <year>1967</year>
        <volume>67</volume>
        <issue>2</issue>
        <fpage>87</fpage>
        <pub-id pub-id-type="doi">10.1037/h0024098</pub-id>
        <?supplied-pmid 6045339?>
        <pub-id pub-id-type="pmid">6045339</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fragaszy</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Fragaszy</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>A program to generate Gellermann (pseudorandom) series of binary states</article-title>
        <source>Behav Res Methods Instrum.</source>
        <year>1978</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>83</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.3758/BF03205103</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Bandoni G, Cesaretti G, Kusmic C, Musumeci D. An algorithm generating long sequences of stimuli in behavioral science: a suitable test for biosensors. Molecular Electronics: Bio-sensors and Bio-computers; 2003. p. 373–8.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">van der Werff J, Ravignani A, Jadoul Y. thebeat: A Python package for working with rhythms and other temporal sequences. In review.</mixed-citation>
    </ref>
  </ref-list>
</back>
