<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6977721</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0228091</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-19-27893</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Neurons</subject>
                <subj-group>
                  <subject>Neuronal Dendrites</subject>
                  <subj-group>
                    <subject>Dendritic Structure</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Cellular Neuroscience</subject>
            <subj-group>
              <subject>Neurons</subject>
              <subj-group>
                <subject>Neuronal Dendrites</subject>
                <subj-group>
                  <subject>Dendritic Structure</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Neurons</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Cellular Neuroscience</subject>
            <subj-group>
              <subject>Neurons</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Neurons</subject>
                <subj-group>
                  <subject>Neuronal Dendrites</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Cellular Neuroscience</subject>
            <subj-group>
              <subject>Neurons</subject>
              <subj-group>
                <subject>Neuronal Dendrites</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Cellular Neuroscience</subject>
            <subj-group>
              <subject>Neuronal Morphology</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Social Sciences</subject>
        <subj-group>
          <subject>Linguistics</subject>
          <subj-group>
            <subject>Grammar</subject>
            <subj-group>
              <subject>Syntax</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Neurons</subject>
                <subj-group>
                  <subject>Ganglion Cells</subject>
                  <subj-group>
                    <subject>Pyramidal Cells</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Cellular Neuroscience</subject>
            <subj-group>
              <subject>Neurons</subject>
              <subj-group>
                <subject>Ganglion Cells</subject>
                <subj-group>
                  <subject>Pyramidal Cells</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Sensory Perception</subject>
            <subj-group>
              <subject>Vision</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Psychology</subject>
          <subj-group>
            <subject>Sensory Perception</subject>
            <subj-group>
              <subject>Vision</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Social Sciences</subject>
        <subj-group>
          <subject>Psychology</subject>
          <subj-group>
            <subject>Sensory Perception</subject>
            <subj-group>
              <subject>Vision</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Neurons</subject>
                <subj-group>
                  <subject>Nerve Fibers</subject>
                  <subj-group>
                    <subject>Axons</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Cellular Neuroscience</subject>
            <subj-group>
              <subject>Neurons</subject>
              <subj-group>
                <subject>Nerve Fibers</subject>
                <subj-group>
                  <subject>Axons</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Module for SWC neuron morphology file validation and correction enabled for high throughput batch processing</article-title>
      <alt-title alt-title-type="running-head">SWC morphology correction</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5752-2131</contrib-id>
        <name>
          <surname>O’Halloran</surname>
          <given-names>Damien M.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="corresp" rid="cor001">*</xref>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>Department of Biological Sciences, The George Washington University, Washington D.C., United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Tang</surname>
          <given-names>Fulei</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Augusta University, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>damienoh@gwu.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>1</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>15</volume>
    <issue>1</issue>
    <elocation-id>e0228091</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>10</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>1</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Damien M. O’Halloran</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Damien M. O’Halloran</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0228091.pdf"/>
    <abstract>
      <p>SWC files are a widely used format to store neuron morphologies, and are used to share digitally reconstructed neurons using <ext-link ext-link-type="uri" xlink:href="http://NeuroMorpho.org">NeuroMorpho.org</ext-link> as well as predict functional attributes using simulation environments such as NEURON. Here we set out to develop an easily accessible tool to validate and correct SWC formatted files with an emphasis on high throughput batch processing. <italic>SWC_BATCH_CHECK</italic> is a package that provides a suite of methods to parse and correct the syntactic structure of a directory of SWC files. This tool ensures that user specified structures such as the soma or basal dendrite are correctly connected while fixing morphological features. This tool will report on missing or invalid data values while also returning basic statistical features for each file. <italic>SWC_BATCH_CHECK</italic> was validated and tested using thousands of individual SWC files to benchmark runtime performance and efficacy in both reporting on and correcting disparate SWC file features. <italic>SWC_BATCH_CHECK</italic> is open source and freely available to all users without restriction with guidelines and requirements provided to ensure straightforward installation and execution.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100007108</institution-id>
            <institution>George Washington University</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5752-2131</contrib-id>
          <name>
            <surname>O’Halloran</surname>
            <given-names>Damien M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>Funded by The George Washington University (GWU) Columbian College of Arts and Sciences, and the GWU Department of Biological Sciences. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="2"/>
      <table-count count="0"/>
      <page-count count="6"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value><ext-link ext-link-type="uri" xlink:href="https://github.com/dohalloran/SWC_BATCH_CHECK">https://github.com/dohalloran/SWC_BATCH_CHECK</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p><ext-link ext-link-type="uri" xlink:href="https://github.com/dohalloran/SWC_BATCH_CHECK">https://github.com/dohalloran/SWC_BATCH_CHECK</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>In order to detail the intricate structure of neurons, and even map the overlying circuitry, researchers can trace the morphology using light microscopy and use microscopic images to digitally reconstruct neuronal organization and arrangement. These reconstructions are then typically stored and shared using the SWC neuron morphology format [<xref rid="pone.0228091.ref001" ref-type="bibr">1</xref>,<xref rid="pone.0228091.ref002" ref-type="bibr">2</xref>]. The SWC file is composed of header entries and data entries. The data line entries are organized by structure e.g. soma, coordinates, radius, and the parent connection. The resulting data structure is a tree-like set of nodes where each node has a set of 3-dimensional coordinates and a radius, and each tree (or neuron) having a single root node defined at the soma. SWC file formats can be uploaded and shared using NeuroMorpho.org [<xref rid="pone.0228091.ref003" ref-type="bibr">3</xref>], which houses over 100,000 digital reconstructions, and then used to predict circuit function and output using simulation environments such as NEURON [<xref rid="pone.0228091.ref004" ref-type="bibr">4</xref>–<xref rid="pone.0228091.ref006" ref-type="bibr">6</xref>]. Because of the increasing scale and complexity of available circuits, we here set out to develop a simple tool that can validate and report on SWC file format in a high-throughput manner. Quality control for SWC formatted files is imperative in order to maintain morphological integrity and to avoid downstream artefacts. Furthermore, SWC files have now become widely used in cloud-based downstream applications and pipelines (e.g. <ext-link ext-link-type="uri" xlink:href="https://www.nsgportal.org/">https://www.nsgportal.org</ext-link>), and so diverse preprocessing tools are necessary to programmatically handle SWC file validation.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Methods</title>
    <p><italic>SWC_BATCH_CHECK</italic> was developed using Perl 5 and successfully tested on Microsoft Windows 7 Enterprise ver.6.1, Linux Mint ver. 19 Tara, and MacOSX Mojave ver.10.14.5. <italic>SWC_BATCH_CHECK</italic> is freely available as a GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/dohalloran/SWC_BATCH_CHECK">https://github.com/dohalloran/SWC_BATCH_CHECK</ext-link>. The module’s main library is composed of a single package—<italic>SWC_BATCH_CHECK</italic>.<italic>pm</italic>—and all dependencies are available through CPAN (<ext-link ext-link-type="uri" xlink:href="https://metacpan.org/">https://metacpan.org/</ext-link>) which makes the module very straight forward to implement. <italic>SWC_BATCH_CHECK</italic> is written using modern Perl best practices and instantiated by collecting user arguments from a Moose class (<ext-link ext-link-type="uri" xlink:href="https://metacpan.org/pod/Moose">https://metacpan.org/pod/Moose</ext-link>). Sample data are provided at the GitHub repository and directions for installation and execution are described in the README.md file. The only required argument to run <italic>SWC_BATCH_CHECK</italic> is the path to a directory containing SWC file(s), which is supplied using the --<italic>d</italic> flag. The program will generate a new folder in the current working directory to output corrected SWC files, as well as an error log that details inconsistencies and errors within each file by describing the issue and the data line containing the problem. Warnings detected include incorrect indexing; no root node; file not starting at the soma; as well as missing data values. The user can also supply one or more structures (e.g. soma, axon, basal dendrite (<italic>basal</italic> flag), or apical dendrite (<italic>apic</italic> flag)) as arguments and the program will make corrections to the specified structure(s). In the case of dendritic structures, basal dendrites should only connect to more basal dendrites or the soma, and if an incorrectly connected dendrite is identified it will automatically correct this defect providing the subsequent node is correctly connected. The same logic is applied for apical dendrite structures. Branch compartments in which the radius is set to zero, are changed to the parent size by supplying the --<italic>rad</italic> flag argument. Other corrections and warnings are detailed on the GitHub repository. In addition, the program will also return basic statistics for each SWC file within the supplied directory as well as the command line arguments used. This feature can be piped to a file and used for later troubleshooting.</p>
  </sec>
  <sec sec-type="conclusions" id="sec003">
    <title>Results and discussion</title>
    <p>In order to validate and test <italic>SWC_BATCH_CHECK</italic> we first benchmarked runtime performance by examining execution speed as a function of file size (<xref ref-type="fig" rid="pone.0228091.g001">Fig 1A</xref>). Directories comprised of SWC formatted data files that varied from a few hundred KB up to over 28 MB in size were used to benchmark the runtime performance using default settings. In each case, <italic>SWC_BATCH_CHECK</italic> efficiently returned summary statistics and validated each file correctly. The runtime will scale with the number of methods called, and for reference a typical SWC file for a single neuron is ~60 KB and therefore the upper limits of our runtime analysis contained over 500 individual SWC files. In order to validate and test the corrections and warnings returned by <italic>SWC_BATCH_CHECK</italic> we performed validation testing on thousands of SWC files to ensure appropriate reporting. Some of these SWC files used in validation are available in the sample_input folder within the GitHub repository. In <xref ref-type="fig" rid="pone.0228091.g001">Fig 1B</xref>, we show an example correction that identifies a basal dendrite incorrectly connected to an apical dendrite (left image), and after running this SWC file through <italic>SWC_BATCH_CHECK</italic> the resulting corrected SWC file fixes this error by changing the inconsistent structure to an apical dendrite (right image). We also include examples from real neuron reconstructions in <xref ref-type="fig" rid="pone.0228091.g002">Fig 2</xref>. In <xref ref-type="fig" rid="pone.0228091.g002">Fig 2A</xref>, a CA1 hippocampal pyramidal cell was used. The <italic>NeuroMorpho</italic> ID for this cell is NMO_00227 and neuron name is c91662. The cell was reconstructed from a female Sprague-Dawley rat [<xref rid="pone.0228091.ref007" ref-type="bibr">7</xref>]. The full reconstruction is depicted in <xref ref-type="fig" rid="pone.0228091.g002">Fig 2A</xref> (leftmost image). For demonstration purposes, we introduced errors into the SWC file to insert basal dendrite compartments within the apical dendrite branch (<xref ref-type="fig" rid="pone.0228091.g002">Fig 2A</xref> middle image, errors denoted by arrowheads). This erroneous SWC file was provided as input to <italic>SWC_BATCH_CHECK</italic> using the --<italic>basal</italic> and --<italic>apic</italic> flags and the apical region from the resulting SWC file was visually rendered with the correct apical dendrite syntactic structure (<xref ref-type="fig" rid="pone.0228091.g002">Fig 2A</xref>, rightmost image). In <xref ref-type="fig" rid="pone.0228091.g002">Fig 2B</xref>, we used the SWC file digital reconstruction of a precentral gyrus layer 5 principal pyramidal cell from the frontal neocortex of a male Sprague-Dawley rate [<xref rid="pone.0228091.ref008" ref-type="bibr">8</xref>]. The <italic>NeuroMorpho</italic> ID for this file is NMO_05515 and the neuron name is 16-L5-na. A visual rendering of the full cell is shown in <xref ref-type="fig" rid="pone.0228091.g002">Fig 2B</xref> (leftmost image). In this case, we introduced two different types of errors into the underling SWC file. Firstly, we changed the radius to zero for several compartments along the primary apical branch. This region is shown in <xref ref-type="fig" rid="pone.0228091.g002">Fig 2B</xref> (leftmost image) as a small dashed rectangle; in the upper middle image of <xref ref-type="fig" rid="pone.0228091.g002">Fig 2B</xref>, this region is magnified to visually depict the effect of introducing zero radius compartments, which are marked by arrowheads. This modified SWC file was then supplied as input to <italic>SWC_BATCH_CHECK</italic> using the --<italic>rad</italic> flag and part of the resulting SWC file is shown as the rightmost upper image in <xref ref-type="fig" rid="pone.0228091.g002">Fig 2B</xref>. Next, we introduced errors into the axon region of the cell by changing several axonal compartments to apical dendrite syntax instead. These regions are denoted by arrowheads in the lower middle image of <xref ref-type="fig" rid="pone.0228091.g002">Fig 2B</xref>; the corresponding field of view is denoted in the leftmost whole image as a large dashed box. The SWC file containing these errors was used as input for <italic>SWC_BATCH_CHECK</italic> using the --<italic>axon</italic> flag and the basal region from the resulting output SWC file is visually rendered in <xref ref-type="fig" rid="pone.0228091.g002">Fig 2B</xref> (rightmost lower image). In each of the examples described above, <italic>SWC_BATCH_CHECK</italic> correctly documented all the errors that were introduced and made the appropriate corrections in the resulting output SWC file. In all cases, it is best to first examine the error log to understand as many putative errors as possible, and then use various flags to correct these errors.</p>
    <fig id="pone.0228091.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0228091.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Runtime performance testing of <italic>SWC_BATCH_CHECK</italic>.</title>
        <p><bold>(A)</bold> Directories containing different numbers of SWC formatted files were provided as input and ran using default settings. Directory sizes were: 0.000285MB, 0.000627MB, 2.320682MB, 5.773404MB, 17.037202MB, and 28.301MB. From this analysis the equation of the regression line was <italic>y</italic> = 2.631 + 0.023⋅<italic>x;</italic> correlation coefficient, <italic>r</italic> = 0.9469. <bold>(B)</bold> Validation testing of uncorrected SWC file containing an incorrectly connected basal and apical dendrite (left image) and a SWC file corrected using <italic>SWC_BATCH_CHECK</italic> (right image) that fixes the inconsistency of apical to basal connection. Images were rendered using <italic>SharkViewer</italic> [<xref rid="pone.0228091.ref012" ref-type="bibr">12</xref>].</p>
      </caption>
      <graphic xlink:href="pone.0228091.g001"/>
    </fig>
    <fig id="pone.0228091.g002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0228091.g002</object-id>
      <label>Fig 2</label>
      <caption>
        <title>Testing <italic>SWC_BATCH_CHECK</italic> on real neuron reconstructions from <italic>NeuroMorpho</italic>.</title>
        <p><bold>(A)</bold> Full reconstruction of a CA1 pyramidal cell (<italic>NeuroMorpho</italic> ID NMO_00227; neuron name c91662) is shown in the leftmost image. Errors were introduced (arrowheads) to insert basal dendrite into the apical dendrite region (middle image). The apical region from the corrected output file using <italic>SWC_BATCH_CHECK</italic> with the correct apical dendrite syntactic structure is rendered in the rightmost image. <bold>(B)</bold> Reconstruction of a precentral gyrus layer 5 pyramidal cell (<italic>NeuroMorpho</italic> ID NMO_05515; neuron name 16-L5-na) is shown in the leftmost image. The radius was changed to zero for several compartments along the primary apical branch (upper middle image, arrowheads denote errors). The region containing these errors is shown in the full reconstruction (leftmost image) as a small dashed rectangle. Part of the corrected SWC file using <italic>SWC_BATCH_CHECK</italic> is shown as the rightmost upper image. Errors were also introduced into the axonal region (marked by arrowheads) of the cell by changing several axonal compartments to apical dendrite syntax (middle lower image). The resulting SWC file from <italic>SWC_BATCH_CHECK</italic> was visually rendered in rightmost lower image. For all images green indicates soma, red indicates apical dendrite, blue for basal dendrite, and orange for axon. SWC files for all images were rendered using neuTube [<xref rid="pone.0228091.ref009" ref-type="bibr">9</xref>] except for the upper images in <bold>(B)</bold> which were generated using <italic>SharkViewer</italic> [<xref rid="pone.0228091.ref012" ref-type="bibr">12</xref>].</p>
      </caption>
      <graphic xlink:href="pone.0228091.g002"/>
    </fig>
    <p>Finally, it is important to recognize that multiple tools are available that perform some or all of the functions described within <italic>SWC_BATCH_CHECK</italic> [<xref rid="pone.0228091.ref009" ref-type="bibr">9</xref>–<xref rid="pone.0228091.ref011" ref-type="bibr">11</xref>]. One of the main distinctions between <italic>SWC_BATCH_CHECK</italic> and some other tools is that other SWC editors include visual rendering capability; for example, neuTube [<xref rid="pone.0228091.ref009" ref-type="bibr">9</xref>] allows the user to visually inspect the structural integrity of neuron reconstructions and edit branches. While this is a limitation of <italic>SWC_BATCH_CHECK</italic>, it was not the goal of developing the module described here, rather the goal was to produce an intuitive module to automate the task of identifying errors in digital neuronal reconstructions in SWC format. In developing this tool, the major goals were: accessibility, ease of use, documentation, as well as applicability of options for large-scale analyses. In summary, I here describe a lightweight Perl package for robust analysis, validation, and correction of SWC neuron morphology files batches, which is intuitive, easily installed, and freely available on GitHub at: <ext-link ext-link-type="uri" xlink:href="https://github.com/dohalloran/SWC_BATCH_CHECK">https://github.com/dohalloran/SWC_BATCH_CHECK</ext-link></p>
    <sec sec-type="data-availability" id="sec004">
      <title>Availability of data and materials</title>
      <list list-type="bullet">
        <list-item>
          <p>Project name: SWC_BATCH_CHECK</p>
        </list-item>
        <list-item>
          <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/dohalloran/SWC_BATCH_CHECK">https://github.com/dohalloran/SWC_BATCH_CHECK</ext-link></p>
        </list-item>
        <list-item>
          <p>Operating system(s): Platform independent</p>
        </list-item>
        <list-item>
          <p>Programming language: Perl</p>
        </list-item>
        <list-item>
          <p>Other requirements: none</p>
        </list-item>
        <list-item>
          <p>License: GNU</p>
        </list-item>
        <list-item>
          <p>Any restrictions to use by non-academics: no restrictions or login requirements</p>
        </list-item>
      </list>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <p>I thank members of the O’Halloran lab for critical reading of the manuscript.</p>
  </ack>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>KB</term>
        <def>
          <p>Kilobytes</p>
        </def>
      </def-item>
      <def-item>
        <term>MB</term>
        <def>
          <p>Megabytes</p>
        </def>
      </def-item>
      <def-item>
        <term>CPAN</term>
        <def>
          <p>Comprehensive Perl Archive Network</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ref-list>
    <title>References</title>
    <ref id="pone.0228091.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Cannon</surname><given-names>RC</given-names></name>, <name><surname>Turner</surname><given-names>DA</given-names></name>, <name><surname>Pyapali</surname><given-names>GK</given-names></name>, <name><surname>Wheal</surname><given-names>HV</given-names></name>. <article-title>An on-line archive of reconstructed hippocampal neurons</article-title>. <source>JNeurosciMethods</source>. <year>1998</year>;<volume>84</volume>: <fpage>49</fpage>–<lpage>54</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0228091.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Stockley</surname><given-names>EW</given-names></name>, <name><surname>Cole</surname><given-names>HM</given-names></name>, <name><surname>Brown</surname><given-names>AD</given-names></name>, <name><surname>Wheal</surname><given-names>HV</given-names></name>. <article-title>A system for quantitative morphological measurement and electronic modelling of neurons: three-dimensional reconstruction</article-title>. <source>JNeurosciMethods</source>. <year>1993</year>;<volume>47</volume>: <fpage>39</fpage>–<lpage>51</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0228091.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Ascoli</surname><given-names>GA</given-names></name>, <name><surname>Donohue</surname><given-names>DE</given-names></name>, <name><surname>Halavi</surname><given-names>M</given-names></name>. <article-title>NeuroMorpho.Org: a central resource for neuronal morphologies</article-title>. <source>JNeurosci</source>. <year>2007</year>;<volume>27</volume>: <fpage>9247</fpage>–<lpage>9251</lpage>.<pub-id pub-id-type="pmid">17728438</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0228091.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Hines</surname><given-names>ML</given-names></name>, <name><surname>Carnevale</surname><given-names>NT</given-names></name>. <article-title>NEURON: a tool for neuroscientists</article-title>. <source>Neuroscientist</source>. <year>2001</year>;<volume>7</volume>: <fpage>123</fpage>–<lpage>135</lpage>. <pub-id pub-id-type="doi">10.1177/107385840100700207</pub-id><?supplied-pmid 11496923?><pub-id pub-id-type="pmid">11496923</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0228091.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Hines</surname><given-names>ML</given-names></name>, <name><surname>Carnevale</surname><given-names>NT</given-names></name>. <article-title>Expanding NEURON’s repertoire of mechanisms with NMODL</article-title>. <source>Neural Comput</source>. <year>2000</year>;<volume>12</volume>: <fpage>995</fpage>–<lpage>1007</lpage>. <pub-id pub-id-type="doi">10.1162/089976600300015475</pub-id><?supplied-pmid 10905805?><pub-id pub-id-type="pmid">10905805</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0228091.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Hines</surname><given-names>ML</given-names></name>, <name><surname>Carnevale</surname><given-names>NT</given-names></name>. <article-title>The NEURON simulation environment</article-title>. <source>Neural Comput</source>. <year>1997</year>;<volume>9</volume>: <fpage>1179</fpage>–<lpage>1209</lpage>. <pub-id pub-id-type="doi">10.1162/neco.1997.9.6.1179</pub-id><?supplied-pmid 9248061?><pub-id pub-id-type="pmid">9248061</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0228091.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Ishizuka</surname><given-names>N</given-names></name>, <name><surname>Cowan</surname><given-names>WM</given-names></name>, <name><surname>Amaral</surname><given-names>DG</given-names></name>. <article-title>A quantitative analysis of the dendritic organization of pyramidal cells in the rat hippocampus</article-title>. <source>JCompNeurol</source>. <year>1995</year>;<volume>362</volume>: <fpage>17</fpage>–<lpage>45</lpage>. <pub-id pub-id-type="doi">10.1002/cne.903620103</pub-id><?supplied-pmid 8576427?><pub-id pub-id-type="pmid">8576427</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0228091.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Radman</surname><given-names>T</given-names></name>, <name><surname>Ramos</surname><given-names>RL</given-names></name>, <name><surname>Brumberg</surname><given-names>JC</given-names></name>, <name><surname>Bikson</surname><given-names>M</given-names></name>. <article-title>Role of cortical cell type and morphology in subthreshold and suprathreshold uniform electric field stimulation in vitro</article-title>. <source>Brain Stimul</source>. <year>2009</year>;<volume>2</volume>: <fpage>215</fpage>–<lpage>228</lpage>, 228.e1–3. <pub-id pub-id-type="doi">10.1016/j.brs.2009.03.007</pub-id><?supplied-pmid 20161507?><pub-id pub-id-type="pmid">20161507</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0228091.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Feng</surname><given-names>L</given-names></name>, <name><surname>Zhao</surname><given-names>T</given-names></name>, <name><surname>Kim</surname><given-names>J</given-names></name>. <article-title>neuTube 1.0: A New Design for Efficient Neuron Reconstruction Software Based on the SWC Format</article-title>. <source>eNeuro</source>. <year>2015</year>;<volume>2</volume>: <fpage>10</fpage>1523/ENEURO.0049-14.2014. eCollection 2015 Jan-Feb. <pub-id pub-id-type="doi">10.1523/ENEURO.0049-14.2014</pub-id><?supplied-pmid 26464967?><pub-id pub-id-type="pmid">26464967</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0228091.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Scorcioni</surname><given-names>R</given-names></name>, <name><surname>Polavaram</surname><given-names>S</given-names></name>, <name><surname>Ascoli</surname><given-names>GA</given-names></name>. <article-title>L-Measure: a web-accessible tool for the analysis, comparison and search of digital reconstructions of neuronal morphologies</article-title>. <source>NatProtoc</source>. <year>2008</year>;<volume>3</volume>: <fpage>866</fpage>–<lpage>876</lpage>. <pub-id pub-id-type="doi">10.1038/nprot.2008.51</pub-id><?supplied-pmid 18451794?><pub-id pub-id-type="pmid">18451794</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0228091.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Luisi</surname><given-names>J</given-names></name>, <name><surname>Narayanaswamy</surname><given-names>A</given-names></name>, <name><surname>Galbreath</surname><given-names>Z</given-names></name>, <name><surname>Roysam</surname><given-names>B</given-names></name>. <article-title>The FARSIGHT trace editor: an open source tool for 3-D inspection and efficient pattern analysis aided editing of automated neuronal reconstructions</article-title>. <source>Neuroinformatics</source>. <year>2011</year>;<volume>9</volume>: <fpage>305</fpage>–<lpage>315</lpage>. <pub-id pub-id-type="doi">10.1007/s12021-011-9115-0</pub-id><?supplied-pmid 21487683?><pub-id pub-id-type="pmid">21487683</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0228091.ref012">
      <label>12</label>
      <mixed-citation publication-type="other">SharkViewer. Available: <ext-link ext-link-type="uri" xlink:href="https://github.com/JaneliaSciComp/SharkViewer">https://github.com/JaneliaSciComp/SharkViewer</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
