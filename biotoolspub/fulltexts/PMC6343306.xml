<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6343306</article-id>
    <article-id pub-id-type="publisher-id">2593</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-018-2593-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>An integrated package for bisulfite DNA methylation data analysis with Indel-sensitive mapping</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhou</surname>
          <given-names>Qiangwei</given-names>
        </name>
        <address>
          <email>qiangwei.zhou2013@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lim</surname>
          <given-names>Jing-Quan</given-names>
        </name>
        <address>
          <email>jing.quan.lim@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Sung</surname>
          <given-names>Wing-Kin</given-names>
        </name>
        <address>
          <email>ksung@comp.nus.edu.sg</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1601-6640</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Guoliang</given-names>
        </name>
        <address>
          <email>guoliang.li@mail.hzau.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1790 4137</institution-id><institution-id institution-id-type="GRID">grid.35155.37</institution-id><institution>National Key Laboratory of Crop Genetic Improvement, Agricultural Bioinformatics Key Laboratory of Hubei Province, College of Informatics, </institution><institution>Huazhong Agricultural University, </institution></institution-wrap>Wuhan, 430070 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2180 6431</institution-id><institution-id institution-id-type="GRID">grid.4280.e</institution-id><institution>Department of Computer Science, </institution><institution>National University of Singapore, </institution></institution-wrap>Singapore, 117417 Singapore </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0620 715X</institution-id><institution-id institution-id-type="GRID">grid.418377.e</institution-id><institution>Department of Computational and Systems Biology, </institution><institution>Genome Institute of Singapore, </institution></institution-wrap>Singapore, 138672 Singapore </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1790 4137</institution-id><institution-id institution-id-type="GRID">grid.35155.37</institution-id><institution>Agricultural Bioinformatics Key Laboratory of Hubei Province, College of Informatics, </institution><institution>Huazhong Agricultural University, </institution></institution-wrap>Wuhan, 430070 China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0620 9745</institution-id><institution-id institution-id-type="GRID">grid.410724.4</institution-id><institution>Lymphoma Genomic Translational Research Laboratory, </institution><institution>National Cancer Centre, </institution></institution-wrap>Singapore, Singapore </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>1</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>1</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>47</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>1</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>12</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Â© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">DNA methylation plays crucial roles in most eukaryotic organisms. Bisulfite sequencing (BS-Seq) is a sequencing approach that provides quantitative cytosine methylation levels in genome-wide scope and single-base resolution. However, genomic variations such as insertions and deletions (indels) affect methylation calling, and the alignment of reads near/across indels becomes inaccurate in the presence of polymorphisms. Hence, the simultaneous detection of DNA methylation and indels is important for exploring the mechanisms of functional regulation in organisms.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">These problems motivated us to develop the algorithm BatMeth2, which can align BS reads with high accuracy while allowing for variable-length indels with respect to the reference genome. The results from simulated and real bisulfite DNA methylation data demonstrated that our proposed method increases alignment accuracy. Additionally, BatMeth2 can calculate the methylation levels of individual loci, genomic regions or functional regions such as genes/transposable elements. Additional programs were also developed to provide methylation data annotation, visualization, and differentially methylated cytosine/region (DMC/DMR) detection. The whole package provides new tools and will benefit bisulfite data analysis.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">BatMeth2 improves DNA methylation calling, particularly for regions close to indels. It is an autorun package and easy to use. In addition, a DNA methylation visualization program and a differential analysis program are provided in BatMeth2. We believe that BatMeth2 will facilitate the study of the mechanisms of DNA methylation in development and disease. BatMeth2 is an open source software program and is available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/GuoliangLi-HZAU/BatMeth2">https://github.com/GuoliangLi-HZAU/BatMeth2</ext-link>/).</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-018-2593-4) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>DNA methylation</kwd>
      <kwd>Bisulfite sequencing</kwd>
      <kwd>Alignment</kwd>
      <kwd>Indel</kwd>
      <kwd>Pipeline</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Fundamental Research Funds for the Central University</institution>
        </funding-source>
        <award-id>2662017PY116</award-id>
        <principal-award-recipient>
          <name>
            <surname>Li</surname>
            <given-names>Guoliang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>31771402</award-id>
        <principal-award-recipient>
          <name>
            <surname>Li</surname>
            <given-names>Guoliang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>Â© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par5">DNA methylation is an important epigenetic modification that plays critical roles in cellular differentiation [<xref ref-type="bibr" rid="CR1">1</xref>], genomic imprinting [<xref ref-type="bibr" rid="CR2">2</xref>], X-chromosome inactivation [<xref ref-type="bibr" rid="CR3">3</xref>], development [<xref ref-type="bibr" rid="CR4">4</xref>] and disease [<xref ref-type="bibr" rid="CR5">5</xref>]. Bisulfite sequencing applies a bisulfite treatment to genomic DNA to convert nonmethylated cytosines to uracils, which can be sequenced as thymines (T). Methylated cytosines cannot be converted to uracils and are sequenced as cytosines (C). In this way, methylated and nonmethylated Cs can be distinguished. Whole-genome bisulfite sequencing (BS-Seq) is a method to convert nonmethylated cytosines into thymines for DNA methylation detection at single-base resolution, a process that has substantially improved DNA methylation studies. However, bisulfite conversion introduces mismatches between the reads and the reference genome, which leads to slow and inaccurate mapping. In the last few years, a number of tools have been developed for BS-read alignment, such as BatMeth [<xref ref-type="bibr" rid="CR6">6</xref>], BSMAP [<xref ref-type="bibr" rid="CR7">7</xref>], Bismark [<xref ref-type="bibr" rid="CR8">8</xref>], BS-Seeker2 [<xref ref-type="bibr" rid="CR9">9</xref>], BWA-meth [<xref ref-type="bibr" rid="CR10">10</xref>], BSmooth [<xref ref-type="bibr" rid="CR11">11</xref>] and Biscuit [<xref ref-type="bibr" rid="CR12">12</xref>].</p>
    <p id="Par6">Structural variations (SVs) play a crucial role in genetic diversity [<xref ref-type="bibr" rid="CR13">13</xref>â<xref ref-type="bibr" rid="CR15">15</xref>]. Many SVs are associated with cancers and genetic diseases such as psoriasis, sporadic prostate cancer, high-grade serous ovarian cancer and small-cell lung cancer [<xref ref-type="bibr" rid="CR16">16</xref>â<xref ref-type="bibr" rid="CR18">18</xref>]. Insertions and deletions (indels) are the second most common type of human genetic variants after single nucleotide polymorphisms (SNP) [<xref ref-type="bibr" rid="CR19">19</xref>]. Many human inherited diseases have been reported to be related to indels [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. Recent results show that the indel rate in the human genome is approximately 1 in 3000âbp [<xref ref-type="bibr" rid="CR22">22</xref>]. If we cannot align indel-containing reads accurately, the resulting misalignments can lead to numerous errors in the downstream data analysis and directly affect the calling of DNA methylation, which leads to incorrect results. Because DNA methylation and indels both play important roles in development and diseases such as cancer, it is necessary to detect them simultaneously.</p>
    <p id="Par7">However, the current methylation callers fail to accurately align reads to indel regions. BSMAP can detect only indels with lengths less than 3 nucleotides. Other tools, such as BWA-meth (which uses BWA-mem [<xref ref-type="bibr" rid="CR23">23</xref>] as the fundamental mapping tool), use seeding approaches. These methods assume that the seeds have no indels. Hence, they cannot obtain the correct results when sequencing reads contain multiple mismatches and indels. As a result, we were motivated to study the alignment performance of the published methods on reads with and without indels. Based on the âReverse-alignmentâ and âDeep-scanâ ideas in BatAlign [<xref ref-type="bibr" rid="CR24">24</xref>], we developed the DNA methylation mapping tool BatMeth2, which is sensitive to indels in bisulfite DNA methylation reads. In addition, we also provided programs for DNA methylation data annotation, visualization and differentially methylated cytosine/region (DMC/DMR) detection to facilitate DNA methylation data analysis. The package BatMeth2 is designed to be an easy-to-use, autorun package for DNA methylation analyses.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Bisulfite sequencing read alignment with BatMeth2</title>
      <p id="Par8">The basic alignment tool underlying BatMeth2 is the alignment program BatAlign [<xref ref-type="bibr" rid="CR24">24</xref>], which works as follows. First, converted reference genomes and converted input sequences are prepared with all Cs in the reference genomes, and input sequences are converted to Ts. Because the plus and minus strands are not complementary after Cs are converted to Ts, two converted reference genomes are prepared, where one is for the plus strand of the original reference genome and the other is for the minus strand of the original reference genome. The indexes are built for these two converted reference genomes. Many existing approaches first find putative hits for the short seeds of the input reads by performing exact alignment or 1-mismatch alignment of the seeds. When the short seeds have two or more mutations, the putative hits of the short seeds may not represent the correct locations of the input reads. To address the limitation of missing alignment hits with low edit-distance short seeds, BatMeth2 finds hits of long seeds from the input reads allowing a high edit-distance (long seeds of 75âbp, five mismatches and one gap allowed). When the input sequence is shorter than 150âbp, the candidate hits of the 75âbp seed are searched and then extended to their original full read length. When the input read is longer than 150âbp, multiple nonoverlapping 75âbp seeds are used to search for candidate hits. These hits are extended, and then, the best alignment is selected on the basis of a set of predefined criteria, including the mismatch number and the number of mapping hits. For the calculation of the alignment score, the penalty for a gap is exactly the same as the penalty for 1.5 mismatches. If the number of âdetected mismatchesâ in a read is smaller than the mismatch threshold, the detection of indels will not be conducted unless there is no appropriate alignment result for the read. (When there is a mismatch alignment of a read with a small number of mismatches, it is better than an alignment with indels. Hence, it is unnecessary to obtain a gapped alignment.) When the allowed number of mismatches is greater than the mismatch threshold, BatMeth2 will detect indels and report the alignment hit. This algorithm will not sacrifice accuracy, yet it is more efficient. AdditionalÂ fileÂ <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1 outlines the details of the BatMeth2 algorithm.</p>
      <p id="Par9">The final alignment between a read and the reference genome is based on an affine-gap scoring scheme, where the score for a match or a mismatch is the Phred scaled value at this position. The gap opening penalty and the gap extension penalty are 40 and 6, respectively.</p>
      <p id="Par10">In reduced representation bisulfite sequencing (RRBS), the genomic DNA is first fragmented by enzymatic digestion (e.g., MspI), followed by a size selection step to enrich the fragments for CpG islands. Therefore, in BatMeth2, we partition the genome by enzymatic digestion site (e.g., C-CGG for MspI); then, we index only the reduced representation genome regions, which are fragment regions that are shorter than the predefined value, which is 600 by default. We map the RRBS reads by building special enzymatic digestion indexes with improved efficiency.</p>
    </sec>
    <sec id="Sec4">
      <title>Methods for aligning reads across the breakpoints of small insertions and deletions (indels)</title>
      <p id="Par11">BatMeth2 starts scanning for the most likely hits for a read in the reference genome by using âReverse-alignmentâ. The current alignment methods mostly use seed-and-extend approaches. They first align short seeds allowing 0 or 1 mismatch; then, the seeds are extended. When the alignment of the read contains multiple mismatches and/or indels, the current solutions may fail. To avoid this problem, our approach is to align a long seed (default 75âbp) allowing more mismatches and gaps (by default, we allowed five mismatches and one gap). In addition, for aligning paired-end reads, the best hit for an individual read is not necessarily the best alignment result for the paired-end reads. In this case, we need to consider the alignment results of both reads at the same time. Therefore, after we obtain the least-cost (highest Smith-Waterman score) hit for each read, we continue to search for more alignment hits and finally choose the appropriate alignment results according to the paired-end sequence alignment. This method is called âDeep-scanâ and is described in BatAlign [<xref ref-type="bibr" rid="CR24">24</xref>]. Among the hits of both reads, BatMeth2 finds the best hit pair and reports it.</p>
      <p id="Par12">If a read spans a genomic rearrangement breakpoint, many mismatches between the read and the genome may occur, which will cause the alignment score to be negative. In this case, we will remove some part of this read (soft-clipping). When the soft-clipped length is greater than 20, we will realign the clipped portion of the read (allowing for 0 mismatches) and obtain auxiliary alignments. The chosen auxiliary alignment and the primary alignment of the read together will represent a complete alignment of the original read.</p>
      <p id="Par13">The main differences between BatMeth2 and BatMeth are as follows: 1) BatMeth2 supports gapped alignment with an affine-gap scoring scheme, while BatMeth finds only ungapped alignments. 2) BatMeth2 supports paired-end alignment, while BatMeth can align only single-end reads. 3) BatMeth2 supports characterizing the alignment hits with a mapping quality report. 4) BatMeth2 supports local alignment, which does not require reads to align end-to-end. Therefore, BatMeth2 can remove some part of this read (soft-clipping) based on the alignment score.</p>
    </sec>
    <sec id="Sec5">
      <title>Calculation of methylation levels</title>
      <p id="Par14">To calculate the methylation density, we first count the total number of C/T nucleotides that overlap with each cytosine site on the plus strand and the number of G/A nucleotides on the minus strand. Those cytosines, which are used for further statistical analysis, should meet the criterion that their depth (C plus T) should be more than some predefined threshold (by default, 5) to reduce the influence of sequencing errors in the cytosine site. In addition, we know that there may be a SNP variation from cytosine (C) to thymine (T), which may affect the calculation of methylation levels in the cytosine loci. To determine whether a site contains a C-to-T bisulfite conversion or a C-to-T SNP, we need to consider the reverse complement strand simultaneously. If the cytosine site is a methylation, it will change from C to T after bisulfite treatment, while the reverse complement strand (rev) should be G. Conversely, if the site is a C-to-T SNP, the rev should be A. Therefore, we calculate the methylation level (ML) by the following equation, which was used in the BSMAP [<xref ref-type="bibr" rid="CR7">7</xref>] program:<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{ML}=\mathit{\min}\left(\frac{C}{\left(C+T\right)\ast \frac{\mathit{\operatorname{Re}}{v}_G}{\left(\mathit{\operatorname{Re}}{v}_G+\mathit{\operatorname{Re}}{v}_A\right)}},1.0\right)\ast 100\% $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mi>ML</mml:mi><mml:mo>=</mml:mo><mml:mo mathvariant="italic">min</mml:mo><mml:mfenced close=")" open="(" separators=","><mml:mfrac><mml:mi>C</mml:mi><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfenced><mml:mo>â</mml:mo><mml:mfrac><mml:mrow><mml:mo mathvariant="italic">Re</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mo mathvariant="italic">Re</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo mathvariant="italic">Re</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mfrac></mml:mrow></mml:mfrac><mml:mn>1.0</mml:mn></mml:mfenced><mml:mo>â</mml:mo><mml:mn>100</mml:mn><mml:mo>%</mml:mo></mml:math><graphic xlink:href="12859_2018_2593_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where C (or T) is the coverage of C (or T) from the reads on the plus strand and RevG (or RevA) is the coverage of G (or A) from the reads on the minus strand.</p>
      <p id="Par15">However, to ensure the accuracy of the DNA ML, the above formula is applied when the coverage on the complement strand of the cytosine site is high. When the coverage on the reverse complementary strand (Gâ+âA) is smaller than the preset coverage threshold (default: 10), we calculate the ML by the following equation:<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{ML}=\frac{C}{\left(C+T\right)}\ast 100\% $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mi>ML</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>C</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfenced></mml:mfrac><mml:mo>â</mml:mo><mml:mn>100</mml:mn><mml:mo>%</mml:mo></mml:math><graphic xlink:href="12859_2018_2593_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec6">
      <title>Identification of differentially methylated regions (DMRs)</title>
      <p id="Par16">BatMeth2 integrates several commonly used methods for detecting differentially methylated regions (DMRs), for example, the beta-binomial distribution model [<xref ref-type="bibr" rid="CR25">25</xref>] for data with replicates and Fisherâs exact test for data without replicates. In addition, BatMeth2 can not only scan the whole genome for DMRs but also operate on predefined windows, such as gene bodies, transposable elements (TEs), untranslated regions (UTRs), and CpG islands.</p>
      <p id="Par17">For each sliding window or predefined window, differential analysis can be performed if it meets the following criteria: (1) the region contains at least m valid CpG (or non-CpG) sites (e.g., m = 5) in both samples; (2) each valid CpG site is covered by at least n bisulfite sequencing reads (e.g., <italic>n</italic> = 5). Users can choose a suitable statistical method to perform hypothesis tests. Each predefined window or sliding window acquires one <italic>p</italic> value from the selected statistical testing method. Finally, the <italic>p</italic> values are adjusted with the false discovery rate (FDR) method for multiple hypothesis testing, proposed by Benjamini and Hochberg [<xref ref-type="bibr" rid="CR26">26</xref>]. If the adjusted <italic>p</italic> value of a window is less than the predefined threshold, and the difference of DNA ML between the two samples is greater than the preset threshold, the window is defined as a DMR.</p>
    </sec>
    <sec id="Sec7">
      <title>Visualization of DNA methylation data</title>
      <p id="Par18">To visualize the methylation profile, the ML in each genomic region is calculated. These genomic regions can be gene bodies or promoters, etc.</p>
      <p id="Par19">To calculate the methylation density level in a given genomic region, only cytosines with coverage greater than the preset threshold are used. The ML in a genomic region is defined as the total number of sequenced Cs over the total number of sequenced Cs and Ts at all cytosine positions across the region, and the equation is as follows:<disp-formula id="Equc"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{M}=\frac{\sum_1^nC}{\sum_1^n\left(C+T\right)}\ast 100\% $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mi mathvariant="normal">M</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>â</mml:mo><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:msubsup><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mo>â</mml:mo><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>â</mml:mo><mml:mn>100</mml:mn><mml:mo>%</mml:mo></mml:math><graphic xlink:href="12859_2018_2593_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>where <italic>n</italic> is the total number of cytosine sites whose coverage is more than the predefined threshold in the genomic region.</p>
    </sec>
    <sec id="Sec8">
      <title>Mapping programs and environment for evaluation</title>
      <p id="Par20">We evaluated the performance of BatMeth2 by aligning both simulated and real BS reads to the human genome (hg19) and compared it with the current popular DNA methylation mapping tools, such as Bismark (v0.14.5), BSMAP (v2.74), BS-Seeker2 (v2.0.8), BWA-meth, BSmooth (v0.8.1) and Biscuit (v0.3.8). All tests were conducted in a workstation with an Intel(R) Xeon(R) E5â2630 0 @ 2.30âGHz CPU and 128âGB RAM running Linux (Red Hat 4.4.7â11). We allowed the same number of mismatches for the read alignment and the same number of CPU threads for all the compared programs in our experiments. If not specified, the parameters were kept as default. When running Bismark (with Bowtie2 as the fundamental mapping method), we used the default parameters and set the alignment seed length as 15 for testing. The format of the BSmooth alignment results was adjusted using the code of BWA-meth.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Result</title>
    <sec id="Sec10">
      <title>An easy-to-use, autorun package for DNA methylation analyses</title>
      <p id="Par21">To complete DNA methylation data analysis more conveniently, we packaged all the functions in an easy-to-use, autorun package for DNA methylation analysis. FigureÂ <xref rid="Fig1" ref-type="fig">1</xref> shows the main features of BatMeth2: 1) BatMeth2 has efficient and accurate alignment performance. 2) BatMeth2 can calculate the DNA methylation level (ML) of individual cytosine sites or any functional regions, such as whole chromosomes, gene regions, transposable elements (TEs), etc. 3) After the integration of different statistical algorithms, BatMeth2 can perform differential DNA methylation analysis for any region, any number of input samples and user requirements. 4) By integrating BS-Seq data visualization (DNA methylation distribution on chromosomes and genes) and differential methylation annotation, BatMeth2 can visualize the DNA methylation data more clearly. During the execution of the BatMeth2 tool, an html report is generated for the statistics of the sample. Sample html report details are shown in <ext-link ext-link-type="uri" xlink:href="http://htmlpreview.github.io/?https://github.com/GuoliangLi-HZAU/BatMeth2/blob/master/BatMeth2-Report/batmeth2.html">http://htmlpreview.github.io/?https://github.com/GuoliangLi-HZAU/BatMeth2/blob/master/BatMeth2-Report/batmeth2.html</ext-link>.<fig id="Fig1"><label>Fig. 1</label><caption><p>The workflow of BatMeth2. The two big arrows mean input or output files</p></caption><graphic xlink:href="12859_2018_2593_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec11">
      <title>BatMeth2 has better mapping performance on simulated BS-Seq data</title>
      <p id="Par22">We first evaluated all the aligners using simulated datasets (without indels) consisting of reads with 75 base pairs (bp), 100âbp and 150âbp and with different bisulfite conversion rates (ranging from 0 to 100% with step 10%). These datasets were simulated from the human genome (UCSC hg19) using FASTX-mutate-tools [<xref ref-type="bibr" rid="CR27">27</xref>], wgsim (v0.3.0) and the simulator in SAMtools (v1.1) [<xref ref-type="bibr" rid="CR28">28</xref>], which allows 0.03% indels, a 1% base error rate in the whole genome and a maximum of two mismatches per read. We mapped the simulated reads to the reference genome, allowing at most two mismatches. Because the original positions of the simulated reads were known, we could evaluate the accuracy of all the programs by comparing their mapping outputs with the original positions.</p>
      <p id="Par23">To compare the performances of the different software, a sequencing read with indels was considered correctly mapped if the following conditions were true: 1) the read was uniquely mapped to the same strand as it was simulated from and the mapping quality was greater than 0; 2) the reported starting position of the aligned read was within ten base pairs of the original starting position of the simulated read; 3) the mapping results had similar indels or mismatches to the simulated read. If any of these conditions were violated, the read was considered wrongly mapped. Because BatMeth2 allows one gap in the seed region, it can find seed locations incorporating indels with high accuracy and can avoid mismatched locations, which would cause reads incorporating indels to be misaligned. The results in Fig.Â <xref rid="Fig2" ref-type="fig">2</xref> show that BatMeth2 achieved the largest number of correctly aligned reads and the lowest number of incorrectly aligned reads in all test datasets at different bisulfite conversion rates.<fig id="Fig2"><label>Fig. 2</label><caption><p>Evaluation of all BS-Seq aligners using simulated datasets with different read lengths from FASTX and wgsim. Simulated data with different bisulfite conversion rates is shown in different shapes. Results from different aligners are shown with different colors of the symbols. The results near the top-left corner in each panel show that the software achieved more number of correctly mapped reads and the lower number of incorrectly mapped reads. The results from our aligner BatMeth2 are the best in the different simulated bisulfite datasets</p></caption><graphic xlink:href="12859_2018_2593_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par24">In brief, the results from wgsim-simulated indel-aberrant datasets show that BatMeth2 has better performance (1~2% better than the second top aligner) than the other methods when aligning general simulated BS reads containing a mixture of mismatches and indels. We can see that with the increased BS conversion rate, the alignment accuracy of all the software is reduced. In these different conditions, BatMeth2 performs better.</p>
    </sec>
    <sec id="Sec12">
      <title>BatMeth2 has better mapping performance on real BS-Seq data</title>
      <p id="Par25">To test the performance of BatMeth2 on real BS-Seq datasets, we downloaded paired-end BS-Seq datasets and randomly extracted 1 million 2âÃâ90 bp paired-end reads from SRA SRR847318, 1 million 2âÃâ101 bp paired-end reads from SRA SRR1035722 and 1 million 2âÃâ125 bp paired-end reads from SRA SRR3503136 for evaluation purposes. Because these datasets are from healthy cell lines or tissues, they are expected to contain a low number of structural variations. Hence, we aligned these real data using single-end reads from the paired-end datasets and evaluated the concordant and discordant mapping rates from the paired alignments to estimate the correct and incorrect alignment rates. Because the insert size of the paired-end reads was approximately 500âbp, a pair of partner reads could be considered concordant if they were mapped within a nominal distance of 500âbp; otherwise, a pair of partner reads could be considered discordant. Similar to our results with the simulated data, BatMeth2 reported more concordant and fewer discordant alignments on the real datasets over a large range of map quality scores, as shown in Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>.<fig id="Fig3"><label>Fig. 3</label><caption><p>Concordance and discordance rates of alignments on real paired-end reads from different aligners. Cumulative counts of concordant and discordant alignments from high to low mapping quality for real bisulfite sequencing reads. There is only one point for BSmap and the aligners based bowtie separately, since these aligners have no map quality score. Bismark-bowtie2L15 means bowtie2 alignment with seed length 15</p></caption><graphic xlink:href="12859_2018_2593_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par26">In addition, TableÂ <xref rid="Tab1" ref-type="table">1</xref> shows the relative runtimes of the programs. BatMeth2 with the default settings ran faster than most of the published aligners and was comparable to BWA-meth and BatMeth. Bismark2 (with Bowtie2 as the fundamental mapping method), BS Seeker2 and BSmooth require longer running times.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Running time (in seconds) from different aligners for real bisulfite reads with length 90âbp</p></caption><table frame="hsides" rules="groups"><thead><tr><th>BatMeth</th><th>BatMeth2</th><th>Bismark-b1</th><th>Bismark-b2</th><th>Bismark-L15</th></tr></thead><tbody><tr><td>456</td><td>681</td><td>633</td><td>1869</td><td>2102</td></tr><tr><td>BWA-Meth</td><td>Biscuit</td><td>BS Seeker</td><td>BSmap</td><td>BSmooth</td></tr><tr><td>498</td><td>1256</td><td>1173</td><td>774</td><td>3740</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec13">
      <title>DNA methylation calling</title>
      <p id="Par27">To evaluate the accuracy of DNA methylation calling among different software, we downloaded 450âK bead chip data from the IMR90 cell line from ENCODE (Encyclopedia of DNA Elements). We also downloaded whole-genome bisulfite sequencing (WGBS-Seq) data of the IMR90 cell line from ENCODE (42.6 Gbases). For each software, we aligned the WGBS-Seq reads and calculated the level of DNA methylation. Then, we compared the results with the MLs at the same sites in the 450âK Bead Chip data. When the difference between the DNA ML from the WGBS-Seq data by the software and that from the 450âK Bead Chip was less than 0.2, the calling result was defined as correct; otherwise, it was considered incorrect.</p>
      <p id="Par28">The results are shown in TableÂ <xref rid="Tab2" ref-type="table">2</xref>. The overlap among the correct results of all the software is shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2. We can see that BatMeth2 and Biscuit have similar performances, which are better than those of the other software. In conclusion, BatMeth2 improves the accuracy of both BS-read alignment and DNA ML calling.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Results of methylation calling</p></caption><table frame="hsides" rules="groups"><thead><tr><th>450âK (48421)</th><th>BatMeth2</th><th>Biscuit</th><th>bwameth</th><th>BSmap</th><th>Bismark-b2</th><th>Bismark-L15</th><th>Bismark-b1</th></tr></thead><tbody><tr><td rowspan="2">Detected</td><td>379,139</td><td>379,209</td><td>378,256</td><td>374,735</td><td>364,581</td><td>364,518</td><td>352,995</td></tr><tr><td>78.59%</td><td>78.60%</td><td>78.40%</td><td>77.68%</td><td>75.57%</td><td>75.56%</td><td>73.17%</td></tr><tr><td rowspan="2">Correct</td><td>320,650</td><td>320,549</td><td>319,634</td><td>316,620</td><td>307,121</td><td>307,058</td><td>297,399</td></tr><tr><td>66.47%</td><td>66.45%</td><td>66.26%</td><td>65.63%</td><td>63.66%</td><td>63.65%</td><td>61.65%</td></tr><tr><td rowspan="2">Wrong</td><td>58,489</td><td>58,660</td><td>58,622</td><td>58,115</td><td>57,460</td><td>57,460</td><td>55,596</td></tr><tr><td>12.12%</td><td>12.16%</td><td>12.15%</td><td>12.05%</td><td>12.91%</td><td>11.91%</td><td>11.52%</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec14">
      <title>BatMeth2 aligns BS reads while allowing for variable-length indels</title>
      <p id="Par29">Cancer contains a notably higher proportion of indels than healthy cells do. Therefore, to verify whether BatMeth2 can align BS reads with indels of different lengths, we downloaded WGBS data (75 Gbases) and 450âK Bead Chip data from HepG2 (liver hepatocellular carcinoma, a cancer cell line) from ENCODE. We checked the indel length distribution in the reads after the alignment of HepG2 WGBS-Seq data. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3A shows that the lengths of the detected indels were mainly distributed in the 1âbp~â5âbp range, and the longest indel was 40âbp in length. According to our statistics, 2.3% of the alignment reads contained indels. From these results, we know that BatMeth2 can align reads with indels of different lengths.</p>
      <p id="Par30">Next, we tested the effect of indel detection on DNA methylation calling. For BatMeth2, we ran two options on the HepG2 data: with and without indel detection (i.e., set -I parameter in BatMeth2). We also ran Bismark on the WGBS-Seq data from HepG2 as a reference for DNA methylation calling with indel detection, because Bismark does not have an indel calling function. We compared the calling of DNA methylation in BatMeth2 and Bismark with the calling from the 450âK Bead Chip data. The results are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3B, where âBatMeth2-noIndelâ corresponds to BatMeth2 with no indel detection. We can see that, in the absence of indel detection, the result of BatMeth2 was only slightly better than that of Bismark (with Bowtie1 as the fundamental mapping method). The result of BatMeth2 with indel detection was significantly better. Furthermore, we can see that BatMeth2 can detect more DNA methylation sites than BatMeth2-noIndel and Bismark (Bowtie 1). To understand why the performance of BatMeth2 with indel detection is better, we defined the methylation sites called by BatMeth2 as Result A, while the methylation sites called by BatMeth2-noIndel and Bismark were defined as Result B. Then, we let mclA be the methylation sites appearing in Result A but not Result B. We observed that mclA included 23,853 DNA methylation sites and 15,048 (63%) of the 23,853 sites covered by the alignments of indel reads called by BatMeth2 with indel detection (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3C). In addition, we found that the indel rates in Result A and Result B were only 5 and 0%, respectively. Hence, we concluded that accurate indel detection can improve DNA methylation calling.</p>
    </sec>
    <sec id="Sec15">
      <title>Visualization of DNA methylation data</title>
      <p id="Par31">BatMeth2 provides tools to visualize the methylation data. To illustrate the visualization features of BatMeth2, we downloaded (1) 117 Gbases of single-end reads from the human H9 cell line, (2) 105.2 Gbases of single-end reads from the human IMR90 cell line and (3) 12.6 Gbases of paired-end reads from wild-type rice. First, BatMeth2 can visualize cytosine methylation density at the chromosome level. The dots in Fig.Â <xref rid="Fig4" ref-type="fig">4</xref>a represent a sliding window of 100âkb with a step of 50âkb. To allow viewing of the ML at individual CpG or non-CpG sites in a genome browser, we also provide files in bed and bigWig formats (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). By comparing with the density of genes and TEs, we observed that the ML was correlated with the TE density and was anticorrelated with the gene density (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). This tendency has been previously observed in rice [<xref ref-type="bibr" rid="CR29">29</xref>].<fig id="Fig4"><label>Fig. 4</label><caption><p>Visualization of the methylation levels in chromosome scale. <bold>a</bold> The methyl-cytosine density in human chromosome 10. The dots represent the methylation levels in sliding windows of 100Kb with a step of 50Kb. The red dots refer to the methylation levels in the plus strand, and the blue dots refer to the methylation levels in the minus strand. <bold>b</bold> An example about the distributions of the DNA methylation levels and differentially-methylated regions (DMRs) between H9 and IMR90 cell lines in human chromosome 10. <bold>c</bold> The density of genes, transposon elements (TEs) and the level of DNA methylation in the whole rice genome. Panel A is the results generated from Batmeth2. Panel B is the visualization results from UCSC browser, with the BED files from Batmeth2</p></caption><graphic xlink:href="12859_2018_2593_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par32">Second, BatMeth2 can visualize the MLs of genes. More precisely, BatMeth2 can visualize the MLs 2âkb upstream of the gene, at the transcription start site (TSS), in the gene body, at the transcription end site (TES) and 2âkb downstream of the gene body. Comparing the upstream, body and downstream regions, Fig.Â <xref rid="Fig5" ref-type="fig">5</xref>a shows that the DNA ML of the gene body is higher than that in the promoter region. Comparing all five regions, there is obviously a valley in the TSS region (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). BatMeth2 can also calculate the ML profiles around introns, exons, intergenic regions and TEs (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). Additionally, BatMeth2 can provide a heat map of multiple genes by gene region for convenient comparison of the overall gene MLs of different samples (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c).<fig id="Fig5"><label>Fig. 5</label><caption><p>Visualization of DNA methylation under different contexts. <bold>a</bold> The DNA methylation levels in 2Kb regions upstream of genes, gene bodies, 2Kb downstream of gene bodies. <bold>b</bold> The aggregation profile of DNA methylation levels across genes. <bold>c</bold> The heat map of all genes in 2Kb regions upstream of genes, gene bodies, 2Kb downstream of gene bodies</p></caption><graphic xlink:href="12859_2018_2593_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par33">Third, BatMeth2 can visualize the distribution of DNA methylation. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5A shows the DNA methylation distributions in the H9 and IMR90 cell lines. In the figure, the DNA ML is partitioned into five categories: methylated (M: &gt;â80%), intermediate between partially methylated and methylated (Mh: 60â80%), partially methylated (H: 40â60%), intermediate between nonmethylated and partially methylated (hU: 20â40%), and nonmethylated (U: &lt;â20%). As shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5A, the ML was higher in the H9 cell line in the M category than in the IMR90 cell line, especially in the CpG context. In the CH sequence context, CpG methylation is the predominant form, but a significant fraction of methylated cytosines are found at CpA sites, while the ML is less than 40%, particularly in the H9 cell line (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5B).</p>
      <p id="Par34">Fourth, BatMeth2 can analyze the correlation between gene expression level and gene promoter DNA ML. We illustrated this feature using the H9 and IMR90 cell lines. The expression levels of the genes in H9 or IMR90 were divided into different categories. As shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5C, the highly expressed genes exhibited lower MLs in their promoter regions. Furthermore, we divided the MLs of the gene promoters into five categories. The result in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5D shows that genes with promoters having higher ML values exhibited lower expression levels. The negative correlation between the expression of mammalian genes and promoter DNA methylation is known [<xref ref-type="bibr" rid="CR1">1</xref>]. This analysis further indicates the accuracy of BatMeth2.</p>
    </sec>
    <sec id="Sec16">
      <title>Finding differentially methylated cytosines and regions (DMCs/DMRs)</title>
      <p id="Par35">The identification of differentially methylated cytosines (DMCs) and differentially methylated regions (DMRs) is one of the major goals in methylation data analysis. Although researchers are occasionally interested in correlating single cytosine sites to a phenotype [<xref ref-type="bibr" rid="CR30">30</xref>], DMRs are very important features [<xref ref-type="bibr" rid="CR31">31</xref>].</p>
      <p id="Par36">Early BS-Seq studies profiled cells without collecting replicates. For such datasets, we used Fisherâs exact test to discern differentially methylated cytosines (DMCs). For BS-Seq datasets with replicates, the most natural statistical model to call DMCs is beta-binomial distribution [<xref ref-type="bibr" rid="CR31">31</xref>]. We know that a number of software programs can perform differential DNA methylation data analysis, such as methylKit [<xref ref-type="bibr" rid="CR32">32</xref>] (a differential analysis program that requires biological replicates) and Methy-Pipe [<xref ref-type="bibr" rid="CR33">33</xref>] (a differential analysis program without biological duplication). However, no comprehensive package including both mapping and differential methylation analysis is available. Thus, we developed a package that integrates mapping with differential analysis. To facilitate the identification of DMRs from bisulfite data without replicates, we integrated Fisherâs exact test to perform a hypothesis test. When a sample has two or more replicates, we use the beta-binomial distribution to perform differential methylation analysis. We also provide bed or bigWig files for the list of DMRs. The DMRs can be visualized in a genome browser (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b) with the generated bed or bigWig files.</p>
      <p id="Par37">As an illustration, Fig.Â <xref rid="Fig6" ref-type="fig">6</xref>a shows the numbers of DMCs and regions in the IMR90 cell line and in the H9 cell line, as detected by BatMeth2 (<italic>p</italic> value&lt;â0.05, meth.diff &gt;â=â0.6). BatMeth2 can visualize whether CpGs and DMCs are enriched in some regions, such as gene, CDS, intron, intergenic, UTR, TE, LTR, LINE and SINE regions. FigureÂ <xref rid="Fig6" ref-type="fig">6</xref>b visualizes the proportions of DMCs in different genomic regions. Apart from the intergenic regions, we did not observe DMC enrichment in any regions.<fig id="Fig6"><label>Fig. 6</label><caption><p>Differential methylation analysis. <bold>a</bold> Analysis results of differentially-methylated regions (DMRs), differentially-methylated genes (DMGs), and differentially-methylated promoters (DMPs) between H9 and IMR90 cell lines. <bold>b</bold> Annotation of differentially-methylated Cytosines (DMC) against different genomic properties and repeat elements. <bold>c</bold> DMPs contain H9 or IMR90 specific-indels (orange) occupy a substantial proportion in the all DMPs (DNA Methylation differential Promoters)</p></caption><graphic xlink:href="12859_2018_2593_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec17">
      <title>A substantial proportion of differentially methylated promoters (DMPs) contain indels</title>
      <p id="Par38">We know that indels and DNA methylation play an important role in tissue development [<xref ref-type="bibr" rid="CR4">4</xref>] and diseases [<xref ref-type="bibr" rid="CR5">5</xref>]. Here, we examine the relationship between differentially methylated promoters (DMPs) and indels. We performed this study using the BS-Seq reads in IMR90 and H9 cell lines. We first aligned the BS-Seq reads using BatMeth2; then, indels were called using BisSNP [<xref ref-type="bibr" rid="CR34">34</xref>] and GATK [<xref ref-type="bibr" rid="CR35">35</xref>] tools. Subsequently, we defined the indels that occur in only H9 or IMR90 as cell-line-specific indels.</p>
      <p id="Par39">Then, we detected 1384 DMPs between H9 and IMR90 by BatMeth2 (<italic>p</italic> value&lt;â0.05, meth.diff &gt;â=â0.6). A total of 236 (17%) among all the DMPs above contain indels, as shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>c. In short, a substantial proportion of the DMPs contain indels. Therefore, accurate alignment of BS-Seq reads near these indels is very important for research and exploration of DNA methylation.</p>
    </sec>
  </sec>
  <sec id="Sec18">
    <title>Conclusion and discussion</title>
    <p id="Par40">DNA methylation plays an important role in the development of tissues and diseases. However, the complexity of DNA methylation analysis has hindered further research into the mechanism of DNA methylation in some diseases. Here, we discussed some difficulties and issues in bisulfite sequence alignment. First, incomplete bisulfite conversion when reannealing during the bisulfite conversion will lead to incorrect alignments. Moreover, sequencing errors, C-to-T converted reads and converted reference genomes further complicate the alignment of bisulfite sequences. These are the specific problems associated with aligning BS-Seq reads, in contrast to aligning normal genomic reads.</p>
    <p id="Par41">In this study, we designed and implemented BatMeth2, an integrated, accurate, efficient, and user-friendly whole-genome bisulfite sequencing data analysis pipeline. BatMeth2 improves the accuracy of DNA methylation calling, particularly for regions close to the indels. We also present a DNA methylation visualization program and differential analysis program. We believe that the superior performance of BatMeth2 should be able to facilitate an increased understanding of the mechanisms of DNA methylation in development and disease.</p>
  </sec>
  <sec id="Sec19">
    <title>Availability and requirements</title>
    <p id="Par42"><bold>Project name:</bold> BatMeth2.</p>
    <p id="Par43">
      <bold>Project home page:</bold>
      <ext-link ext-link-type="uri" xlink:href="https://github.com/GuoliangLi-HZAU/BatMeth2">https://github.com/GuoliangLi-HZAU/BatMeth2</ext-link>
    </p>
    <p id="Par44"><bold>Operating systems:</bold> Linux.</p>
    <p id="Par45"><bold>Programming Languages:</bold> C++, Python, R.</p>
    <p id="Par46"><bold>Other requirements:</bold> GCC, SAMtools.</p>
    <p id="Par47"><bold>License:</bold> General Public License GPL 3.0.</p>
    <p id="Par48"><bold>Any restrictions to use by non-academics:</bold> License required.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional file</title>
    <sec id="Sec20">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2018_2593_MOESM1_ESM.pdf">
            <label>Additional file 1:</label>
            <caption>
              <p><bold>Figure S1</bold>. Outline of the mapping algorithm details. <bold>Figure S2.</bold> The overlap of the correct methylation callings from IMR90 cell line based on 450K BeadChip data for all compared software. <bold>Figure S3.</bold> BatMeth2 align BS reads allowing for variable-length indels. <bold>Figure S3.</bold> (A) Indel length distribution detected by BatMeth2. (B) The overlap of 450K with BatMeth2, BatMeth2 no indel detect mode and Bismark-bowtie 1(bismarkBT1). (C) More correct methylation loci in result A (mclA) covered by Indel distribution. We define the methylation sites called by BatMeth2 as Result A while the methylation sites called by BatMeth2-noIndel and Bismark as Results B. Let mclA be the methylation sites appear in Result A but not Result B. <bold>Figure S4.</bold> The DNA methylation level distribution across exon, intron, intergenic and TEs, etc. <bold>Figure S5.</bold> Methylation level under different conditions. (PDF 2044 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviation</title>
    <def-list>
      <def-item>
        <term>BS-Seq</term>
        <def>
          <p id="Par4">Sodium bisulfite conversion of DNA followed by sequencing</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p id="Par49">This work was partially supported by the National Natural Science Foundation of China (Grant No. 31771402) and the Fundamental Research Funds for the Central Universities (Grant No. 2662017PY116). QZ was partially supported by the China Scholarship Council (CSC). The funding body did not play any role in the study design and collection, analysis and interpretation of the data and the write-up of the manuscript.</p>
    </sec>
    <sec id="FPar2" sec-type="data-availability">
      <title>Availability of data and materials</title>
      <p id="Par50">We downloaded publicly-available DNA methylation data from GEO or SRA. The datasets are as follows: GEO number GSM706059, GSM706060, and GSM706061 from human H9 cell line; GSM432687 and GSM432688 from human IMR90 cell line; SRA SRR847318 (human normal liver data), SRA SRR1035722 (human normal colon data), and SRA SRR3503136 (wild type Oryza data) for evaluation purpose. The accession number of 450âK Bead Chip data from human IMR90 cell line in ENCODE is ENCSR000ACV, and the corresponding WGBS-Seq data from human IMR90 cell line is ENCBS683AVF. And the accession number of 450âK Bead Chip data from human HepG2 cell line in ENCODE is ENCSR941PPN, and the corresponding WGBS-Seq data from human HepG2 cell line is ENCSR786DCL.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authorsâ contributions</title>
    <p>QZ, WS and GL conceived the project and wrote the paper. QZ developed the bisulfite algorithm and coded the BatMeth2 software based on BatMeth and BatAlign. JL provided advices on code implementation and BS-Seq data simulation. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar4">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar5">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar6">
      <title>Publisherâs Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Laurent</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Huynh</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tsirigos</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ong</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Low</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Kin Sung</surname>
            <given-names>KW</given-names>
          </name>
          <name>
            <surname>Rigoutsos</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Loring</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dynamic changes in the human methylome during differentiation</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <issue>3</issue>
        <fpage>320</fpage>
        <lpage>331</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.101907.109</pub-id>
        <?supplied-pmid 20133333?>
        <pub-id pub-id-type="pmid">20133333</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reik</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Dean</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Epigenetic reprogramming in mammalian development</article-title>
        <source>Science</source>
        <year>2001</year>
        <volume>293</volume>
        <issue>5532</issue>
        <fpage>1089</fpage>
        <lpage>1093</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1063443</pub-id>
        <?supplied-pmid 11498579?>
        <pub-id pub-id-type="pmid">11498579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heard</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Clerc</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Avner</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>X-CHROMOSOME INACTIVATION IN MAMMALS</article-title>
        <source>Annu Rev Genet</source>
        <year>1997</year>
        <volume>31</volume>
        <issue>1</issue>
        <fpage>571</fpage>
        <lpage>610</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev.genet.31.1.571</pub-id>
        <?supplied-pmid 9442908?>
        <pub-id pub-id-type="pmid">9442908</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>I-H</given-names>
          </name>
          <name>
            <surname>Wen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Murakami</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Aryee</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Herb</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ladd-Acosta</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rho</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Loewer</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differential methylation of tissue- and cancer-specific CpG island shores distinguishes human induced pluripotent stem cells, embryonic stem cells and fibroblasts</article-title>
        <source>Nat Genet</source>
        <year>2009</year>
        <volume>41</volume>
        <issue>12</issue>
        <fpage>1350</fpage>
        <lpage>1353</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.471</pub-id>
        <?supplied-pmid 19881528?>
        <pub-id pub-id-type="pmid">19881528</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robertson</surname>
            <given-names>KD</given-names>
          </name>
        </person-group>
        <article-title>DNA methylation and human disease</article-title>
        <source>Nat Rev Genet</source>
        <year>2005</year>
        <volume>6</volume>
        <issue>8</issue>
        <fpage>597</fpage>
        <lpage>610</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg1655</pub-id>
        <?supplied-pmid 16136652?>
        <pub-id pub-id-type="pmid">16136652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lim</surname>
            <given-names>JQ</given-names>
          </name>
          <name>
            <surname>Tennakoon</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Sung</surname>
            <given-names>WK</given-names>
          </name>
        </person-group>
        <article-title>BatMeth: improved mapper for bisulfite sequencing reads on DNA methylation</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>10</issue>
        <fpage>R82</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-10-r82</pub-id>
        <?supplied-pmid 23034162?>
        <pub-id pub-id-type="pmid">23034162</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>BSMAP: whole genome bisulfite sequence MAPping program</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>232</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-232</pub-id>
        <?supplied-pmid 19635165?>
        <pub-id pub-id-type="pmid">19635165</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krueger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Bismark: a flexible aligner and methylation caller for bisulfite-Seq applications</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>11</issue>
        <fpage>1571</fpage>
        <lpage>1572</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr167</pub-id>
        <?supplied-pmid 21493656?>
        <pub-id pub-id-type="pmid">21493656</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Fiziev</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cokus</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>MQ</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>P-Y</given-names>
          </name>
          <name>
            <surname>Pellegrini</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>BS-Seeker2: a versatile aligning pipeline for bisulfite sequencing data</article-title>
        <source>BMC Genomics</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-14-1</pub-id>
        <pub-id pub-id-type="pmid">23323973</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Brent S, Pedersen KE, De S, Yang IV, David A. Schwartz: Fast and accurate alignment of long bisulfite-seq reads. Arxiv:1401.1129. 2014.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Hansen KD, Langmead B, Irizarry RA: BSmooth: from whole genome bisulfite sequencing reads to differentially methylated regions. Genome Biol 2012, 13(10):R83-R83.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Zhou W. Biscuit. <ext-link ext-link-type="uri" xlink:href="https://www.githubcom/zwdzwd/biscuit">https://www.githubcom/zwdzwd/biscuit.</ext-link></mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Redon</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Global variation in copy number in the human genome</article-title>
        <source>Nature</source>
        <year>2006</year>
        <volume>444</volume>
        <fpage>444</fpage>
        <lpage>454</lpage>
        <pub-id pub-id-type="doi">10.1038/nature05329</pub-id>
        <?supplied-pmid 17122850?>
        <pub-id pub-id-type="pmid">17122850</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jakobsson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scholz</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Scheet</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gibbs</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>VanLiere</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Fung</surname>
            <given-names>H-C</given-names>
          </name>
          <name>
            <surname>Szpiech</surname>
            <given-names>ZA</given-names>
          </name>
          <name>
            <surname>Degnan</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Guerreiro</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genotype, haplotype and copy-number variation in worldwide human populations</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>451</volume>
        <issue>7181</issue>
        <fpage>998</fpage>
        <lpage>1003</lpage>
        <pub-id pub-id-type="doi">10.1038/nature06742</pub-id>
        <?supplied-pmid 18288195?>
        <pub-id pub-id-type="pmid">18288195</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iafrate</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Feuk</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rivera</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Listewnik</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Donahoe</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Qi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Scherer</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Detection of large-scale variation in the human genome</article-title>
        <source>Nat Genet</source>
        <year>2004</year>
        <volume>36</volume>
        <issue>9</issue>
        <fpage>949</fpage>
        <lpage>951</lpage>
        <pub-id pub-id-type="doi">10.1038/ng1416</pub-id>
        <?supplied-pmid 15286789?>
        <pub-id pub-id-type="pmid">15286789</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hollox</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Huffmeier</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Zeeuwen</surname>
            <given-names>PLJM</given-names>
          </name>
          <name>
            <surname>Palla</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lascorz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rodijk-Olthuis</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>van de Kerkhof</surname>
            <given-names>PCM</given-names>
          </name>
          <name>
            <surname>Traupe</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>de Jongh</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>den Heijer</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Psoriasis is associated with increased beta-defensin genomic copy number</article-title>
        <source>Nat Genet</source>
        <year>2008</year>
        <volume>40</volume>
        <issue>1</issue>
        <fpage>23</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2007.48</pub-id>
        <?supplied-pmid 18059266?>
        <pub-id pub-id-type="pmid">18059266</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huse</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Taudien</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Groth</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rosenstiel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Szafranski</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hiller</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hampe</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Junker</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schubert</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schreiber</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genetic variants of the copy number polymorphic beta-defensin locus are associated with sporadic prostate cancer</article-title>
        <source>Tumour Biol</source>
        <year>2008</year>
        <volume>29</volume>
        <issue>2</issue>
        <fpage>83</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="doi">10.1159/000135688</pub-id>
        <?supplied-pmid 18515986?>
        <pub-id pub-id-type="pmid">18515986</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macintyre</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ylstra</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Brenton</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Sequencing structural variants in Cancer for precision therapeutics</article-title>
        <source>Trends Genet</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>9</issue>
        <fpage>530</fpage>
        <lpage>542</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2016.07.002</pub-id>
        <?supplied-pmid 27478068?>
        <pub-id pub-id-type="pmid">27478068</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsing</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cherkasov</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Indel PDB: a database of structural insertions and deletions derived from sequence alignments of closely related proteins</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-293</pub-id>
        <pub-id pub-id-type="pmid">18173834</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A functional insertion/deletion polymorphism in the promoter ofPDCD6IPIs associated with the susceptibility of hepatocellular carcinoma in a Chinese population</article-title>
        <source>DNA Cell Biol</source>
        <year>2013</year>
        <volume>32</volume>
        <issue>8</issue>
        <fpage>451</fpage>
        <lpage>457</lpage>
        <pub-id pub-id-type="doi">10.1089/dna.2013.2061</pub-id>
        <?supplied-pmid 23777424?>
        <pub-id pub-id-type="pmid">23777424</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ross</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Al-Rohil</surname>
            <given-names>RN</given-names>
          </name>
          <name>
            <surname>Nazeer</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sheehan</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Otto</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Palmer</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Yelensky</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lipson</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Advanced urothelial carcinoma: next-generation sequencing reveals diverse genomic alterations and targets of therapy</article-title>
        <source>Mod Pathol</source>
        <year>2014</year>
        <volume>27</volume>
        <issue>2</issue>
        <fpage>271</fpage>
        <lpage>280</lpage>
        <pub-id pub-id-type="doi">10.1038/modpathol.2013.135</pub-id>
        <?supplied-pmid 23887298?>
        <pub-id pub-id-type="pmid">23887298</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Montgomery</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Goode</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Kvikstad</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Albers</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>ZD</given-names>
          </name>
          <name>
            <surname>Mu</surname>
            <given-names>XJ</given-names>
          </name>
          <name>
            <surname>Ananda</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Howie</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Karczewski</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>KS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The origin, evolution, and functional impact of short insertion-deletion variants identified in 179 human genomes</article-title>
        <source>Genome Res</source>
        <year>2013</year>
        <volume>23</volume>
        <issue>5</issue>
        <fpage>749</fpage>
        <lpage>761</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.148718.112</pub-id>
        <?supplied-pmid 23478400?>
        <pub-id pub-id-type="pmid">23478400</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Li H. Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM. ArXiv:1303.3997. 2013.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lim</surname>
            <given-names>JQ</given-names>
          </name>
          <name>
            <surname>Tennakoon</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Guan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sung</surname>
            <given-names>WK</given-names>
          </name>
        </person-group>
        <article-title>BatAlign: an incremental method for accurate alignment of sequencing reads</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>16</issue>
        <fpage>e107</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv533</pub-id>
        <?supplied-pmid 26170239?>
        <pub-id pub-id-type="pmid">26170239</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Decato</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hong</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Qu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Garvin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kessler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>AD</given-names>
          </name>
        </person-group>
        <article-title>A reference Methylome database and analysis pipeline to facilitate integrative and comparative Epigenomics</article-title>
        <source>PLoS One</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>12</issue>
        <fpage>e81148</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0081148</pub-id>
        <?supplied-pmid 24324667?>
        <pub-id pub-id-type="pmid">24324667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J Royal Statistical Society Series B (Methodological)</source>
        <year>1995</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>289</fpage>
        <lpage>300</lpage>
        <pub-id pub-id-type="doi">10.1111/j.2517-6161.1995.tb02031.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Prezza N. Fastx-mutate-tools. <ext-link ext-link-type="uri" xlink:href="https://www.githubcom/nicolaprezza/fastx-mutate-tools">https://www.githubcom/nicolaprezza/fastx-mutate-tools</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <collab>Genome Project Data Processing S</collab>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>16</issue>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <?supplied-pmid 19505943?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Stolc</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Tongprasit</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-resolution mapping of epigenetic modifications of the rice genome uncovers interplay between DNA methylation, histone methylation, and gene expression</article-title>
        <source>Plant Cell</source>
        <year>2008</year>
        <volume>20</volume>
        <issue>2</issue>
        <fpage>259</fpage>
        <lpage>276</lpage>
        <pub-id pub-id-type="doi">10.1105/tpc.107.056879</pub-id>
        <?supplied-pmid 18263775?>
        <pub-id pub-id-type="pmid">18263775</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weaver</surname>
            <given-names>ICG</given-names>
          </name>
          <name>
            <surname>Cervoni</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Champagne</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>D'Alessio</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Seckl</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Dymov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Szyf</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Meaney</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Epigenetic programming by maternal behavior</article-title>
        <source>Nat Neurosci</source>
        <year>2004</year>
        <volume>7</volume>
        <issue>8</issue>
        <fpage>847</fpage>
        <lpage>854</lpage>
        <pub-id pub-id-type="doi">10.1038/nn1276</pub-id>
        <?supplied-pmid 15220929?>
        <pub-id pub-id-type="pmid">15220929</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Kahraman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Lindsay</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nowicka</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Statistical methods for detecting differentially methylated loci and regions</article-title>
        <source>Front Genet</source>
        <year>2014</year>
        <volume>5</volume>
        <fpage>324</fpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2014.00324</pub-id>
        <?supplied-pmid 25278959?>
        <pub-id pub-id-type="pmid">25278959</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Akalin A, Kormaksson M, Li S, Garrett-Bakelman FE, Figueroa ME, Melnick A, Mason CE: methylKit: a comprehensive R package for the analysis of genome-wide DNA methylation profiles. Genome Biol 2012, 13 (10): R87-R87.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lun</surname>
            <given-names>FMF</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>KCA</given-names>
          </name>
          <name>
            <surname>Chiu</surname>
            <given-names>RWK</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>YMD</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Methy-pipe: an integrated bioinformatics pipeline for whole genome bisulfite sequencing data analysis</article-title>
        <source>PLoS One</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>6</issue>
        <fpage>e100360</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0100360</pub-id>
        <?supplied-pmid 24945300?>
        <pub-id pub-id-type="pmid">24945300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Siegmund</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>PW</given-names>
          </name>
          <name>
            <surname>Berman</surname>
            <given-names>BP</given-names>
          </name>
        </person-group>
        <article-title>Bis-SNP: combined DNA methylation and SNP calling for bisulfite-seq data</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>7</issue>
        <fpage>R61</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-7-r61</pub-id>
        <?supplied-pmid 22784381?>
        <pub-id pub-id-type="pmid">22784381</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hanna</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sivachenko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cibulskis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kernytsky</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Garimella</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Altshuler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gabriel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The genome analysis toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <issue>9</issue>
        <fpage>1297</fpage>
        <lpage>1303</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id>
        <?supplied-pmid 2928508?>
        <pub-id pub-id-type="pmid">20644199</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
