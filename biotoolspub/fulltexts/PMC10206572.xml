<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Med Res Methodol</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Med Res Methodol</journal-id>
    <journal-title-group>
      <journal-title>BMC Medical Research Methodology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2288</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10206572</article-id>
    <article-id pub-id-type="publisher-id">1951</article-id>
    <article-id pub-id-type="doi">10.1186/s12874-023-01951-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MSMpred: interactive modelling and prediction of individual evolution via multistate models</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2053-9535</contrib-id>
        <name>
          <surname>Garmendia Bergés</surname>
          <given-names>Leire</given-names>
        </name>
        <address>
          <email>leire.garmendia@upc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cortés Martínez</surname>
          <given-names>Jordi</given-names>
        </name>
        <address>
          <email>jordi.cortes-martinez@upc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gómez Melis</surname>
          <given-names>Guadalupe</given-names>
        </name>
        <address>
          <email>lupe.gomez@upc.edu</email>
        </address>
        <xref ref-type="contrib" rid="IA1"/>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" id="IA1">
        <collab>DIVINE project</collab>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.6835.8</institution-id><institution-id institution-id-type="ISNI">0000 0004 1937 028X</institution-id><institution>Department of Statistics and Operations Research, </institution><institution>Universitat Politècnica de Catalunya, </institution></institution-wrap>Barcelona, Spain </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>126</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Modelling the course of a disease regarding severe events and identifying prognostic factors is of great clinical relevance. Multistate models (MSM) can be used to describe diseases or processes that change over time using different states and the transitions between them. Specifically, they are useful to analyse a disease with an increasing degree of severity, that may precede death. The complexity of these models changes depending on the number of states and transitions taken into account. Due to that, a web tool has been developed making easier to work with those models.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">MSMpred is a web tool created with the shiny R package that has two main features: 1) to allow to fit a MSM from specific data; 2) to predict the clinical evolution for a given subject. To fit the model, the data to be analysed must be upload in a prespecified format. Then, the user has to define the states and transitions as well as the covariates (e.g., age or gender) involved in each transition. From this information, the app returns histograms or barplots, as appropriate, to represent the distributions of the selected covariates and boxplots to show the patient’ length of stay (for uncensored data) in each state. To make predictions, the values of selected covariates from a new subject at baseline has to be provided. From these inputs, the app provides some indicators of the subject’s evolution such as the probability of 30-day death or the most likely state at a fixed time. Furthermore, visual representations (e.g., the stacked transition probabilities plot) are given to make predictions more understandable.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">MSMpred is an intuitive and visual app that eases the work of biostatisticians and facilitates to the medical personnel the interpretation of MSMs.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Shiny app</kwd>
      <kwd>Multistate models</kwd>
      <kwd>COVID-19</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100010552</institution-id>
            <institution>Departament de Salut, Generalitat de Catalunya</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2020PANDE00148</award-id>
        <principal-award-recipient>
          <name>
            <surname>Gómez Melis</surname>
            <given-names>Guadalupe</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004837</institution-id>
            <institution>Ministerio de Ciencia e Innovación</institution>
          </institution-wrap>
        </funding-source>
        <award-id>PID2019-104830RB-I00</award-id>
        <principal-award-recipient>
          <name>
            <surname>Gómez Melis</surname>
            <given-names>Guadalupe</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par12">A multistate model (MSM) generalizes the classic survival modelling allowing the description of complex dynamical processes over time. It is defined by a series of states — which could represent different stages of the life history of an individual — and the transitions that connect them — which describe the potential paths between those states along time [<xref ref-type="bibr" rid="CR1">1</xref>].</p>
    <p id="Par13">As examples in the context of COVID-19, Ursino et al. [<xref ref-type="bibr" rid="CR2">2</xref>] and Mody et al. [<xref ref-type="bibr" rid="CR3">3</xref>] used MSMs in order to describe the evolution of patients admitted to the Intensive Care Unit (ICU), and hospitalized patients, respectively. They consider several states, such as inpatient floor, ICU and invasive mechanical ventilation (IMV). The conclusions raised from these papers are powerful because they are able to estimate the factors associated to each transition and not only those that focus on the discharge or death.</p>
    <p id="Par14">Since these type of models are usually complex, different tools have been developed to ease the modellization process and to help with the interpretability of the findings. For instance, the app <bold>MSMshiny</bold> [<xref ref-type="bibr" rid="CR4">4</xref>] aims to fit multistate models. It allows the user to: i) add an initial state even if it is not included in the uploaded data; ii) include as many transitions as desired; iii) assign specific covariates to each transition; iv) specify different models and compare their log-likelihood and Akaike information criterion (AIC) to help in selecting the best one. Furthermore, MSMshiny provides an interactive visualization of how individuals move between states over time. Among the main limitations of this app, we highlight that once a transition has been defined, it cannot be removed anymore and that the model cannot be validated through a residual analysis. Despite MSMshiny allows to make predictions, the outputs are limited and they do not help in the interpretation of the results. The app <bold>MSMplus</bold> [<xref ref-type="bibr" rid="CR5">5</xref>] is intended to offer a wide spectrum of visualizations once an MSM is fitted outside the application. It provides a nice friendly interface, which provides various types of graphics, together with some indications, allowing a thorough interpretation of the fitted model. MSMplus allows a deep customization of the returned plots (e.g., changing the names of the states) and is complemented with theoretical explanations on MSMs. A weakness of the MSMplus app is that the users have to perform the analyses on their own and upload the outputs to obtain a complete data visualization of the results. In addition, the app lacks some numerical output, such as a table with the estimates of the fitted model. The <bold>MSDshiny</bold> app [<xref ref-type="bibr" rid="CR6">6</xref>] has been designed specifically for clinical trials allowing the user to make simulations based on MSMs. The total number of states is decided by the user in the model specification. The simulation of the time-to-event times is performed using a Weibull distribution with specific parameters for each transition. Some of its main limitations are the lack of the relevant transition probability plots, the restriction to a maximum of five states and that it does not allow having transient initial states.</p>
    <p id="Par15">This work presents the <bold>MSMpred</bold> shiny app (<ext-link ext-link-type="uri" xlink:href="https://www.grbio.eu/pubs/MSMpred/">https://www.grbio.eu/pubs/MSMpred/</ext-link>) designed to fit a MSM from specific data and to predict the clinical evolution for a given patient based on the previous model. We aim to overcome the above mentioned limitations of the existing apps. Before presenting <bold>MSMpred</bold> we provide an overview of MSM.</p>
    <sec id="Sec2">
      <title>Multistate models</title>
      <p id="Par16">A MSM is a model for a continuous time stochastic process allowing individuals to move among a finite number of states. Within the scope of survival analysis, MSMs allow to describe complex clinical processes that change over time. Those models are formed by states and transitions, which represent, for instance, the different stages of a disease evolution and the possible paths to move between those states, respectively. In these models we focus on the transitions between states and the time until they occur.</p>
      <p id="Par17">Usually those models are represented using a diagram where the nodes represent the states of the model, and the arrows represent the transitions. The diagram provides a visualization of the model allowing a complete understanding of all possible trajectories.</p>
      <p id="Par18">There are three different types of states: initial states are the ones where an individual could start the process; transient states are those in which individuals can get in and out of the state; and absorbing states are the ones where the process ends.</p>
      <p id="Par19">The main goals of MSMs are to characterize the process of an individual or a group; to analyse the relationship between the covariates of interest and the process transitions; to identify the risk factors for specific transitions; and to develop predictive models for new individuals.</p>
      <p id="Par20">There are three main steps to build a MSM: 1) represent the clinical process by means of states and transitions; 2) decide which covariates or factors are considered in each transition; 3) fit the model. The first two steps usually require a clinical insight; so, collaboration with medical experts is essential.</p>
      <sec id="Sec3">
        <title>Characterization</title>
        <p id="Par21">There are different ways to characterize a MSM, related to each other in such a way that one characterization can be obtained from any of the others.</p>
        <p id="Par22">Let <inline-formula id="IEq2"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X=\{X(t): t\ge 0\}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq2.gif"/></alternatives></inline-formula> be the stochastic process where <italic>X</italic>(<italic>t</italic>) represents the state in which the subject is at time <italic>t</italic> and takes values in the discrete set of states of the model, <inline-formula id="IEq3"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {R}=\{1,..,R\}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi mathvariant="script">R</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq3.gif"/></alternatives></inline-formula>. The class <inline-formula id="IEq4"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {H}(t) = \{X(s), {\textbf {Z}}(s), s \le t\}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi mathvariant="script">H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq4.gif"/></alternatives></inline-formula> contains the information of all the paths of all the individuals up to time t including the covariates <inline-formula id="IEq5"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf {Z}}(s)$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq5.gif"/></alternatives></inline-formula>, which might be time-dependent.</p>
        <p id="Par23">The Markov property is met when, for any <inline-formula id="IEq6"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s&lt;t$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq6.gif"/></alternatives></inline-formula> and <inline-formula id="IEq7"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l,k \in \mathcal {R}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq7.gif"/></alternatives></inline-formula>,<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \Pr \{X(t)=l|X(s)=k;\mathcal {H}(s^-)\}{} &amp; {} \nonumber \\ =\Pr \{X(t)=l|X(s)=k\}{} &amp; {} \end{aligned}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Pr</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="script">H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mo>=</mml:mo><mml:mo>Pr</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12874_2023_1951_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {H}(s^-)$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi mathvariant="script">H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq8.gif"/></alternatives></inline-formula> represents the history of the process prior to time <italic>s</italic>. This condition implies that the future path of a subject only depends on the state where he/she is at present but not on the past path that he/she had followed. Under the Markov assumption an MSM process can be characterized by means of either transition probabilities, transition intensities and cumulative transition intensities that we define next [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
        <p id="Par24"><bold>Transition probability</bold>, <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _{kl}(s,t)$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq9.gif"/></alternatives></inline-formula>: the probability that a subject in state <italic>k</italic> at time <italic>s</italic> (<inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s &lt; t$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq10.gif"/></alternatives></inline-formula>) is in state <italic>l</italic> at time <italic>t</italic>, that is,<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}{} &amp; {} \pi _{kl}(s,t)=\Pr \{X(t)=l|X(s)=k\}, \;\; \forall k \ne l \in \mathcal {R},\nonumber \\{} &amp; {} \pi _{kk}(s,t)=1-\sum _{k \ne l}\pi _{kl}(s,t), \;\; \forall k \in \mathcal {R}. \end{aligned}$$\end{document}</tex-math><mml:math id="M22" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>Pr</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">kk</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12874_2023_1951_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par25"><bold>Transition intensity</bold>, <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{kl}(t)$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq11.gif"/></alternatives></inline-formula>: the transition intensity represents the instantaneous probability of transition between two states, <italic>k</italic> and <italic>l</italic>, at a specific time point <italic>t</italic> and it is defined as<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \lambda _{kl}(t)= &amp; {} \lim _{\Delta t\rightarrow 0} \frac{\Pr \{X(t+\Delta t)=l|X(t)=k\}}{\Delta t}\nonumber \\= &amp; {} \lim _{\Delta t\rightarrow 0} \frac{\pi _{kl}(t,t+\Delta t)}{\Delta t}, \;\; \forall k \ne l \in \mathcal {R},\nonumber \\ \lambda _{kk}(t)= &amp; {} -\sum _{k \ne l} \lambda _{kl}(t), \;\; \forall k \in \mathcal {R}. \end{aligned}$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:munder><mml:mo movablelimits="true">lim</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mo>Pr</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:munder><mml:mo movablelimits="true">lim</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">kk</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12874_2023_1951_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par26"><bold>Cumulative transition intensity</bold>, <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Lambda _{kl}(t)$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq12.gif"/></alternatives></inline-formula>: the cumulative transition intensity between states <italic>k</italic> and <italic>l</italic> is defined as<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \Lambda _{kl}(t)=\int _0^t \lambda _{kl}(s) ds, \;\; \forall k,l \in \mathcal {R}. \end{aligned}$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12874_2023_1951_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec4">
        <title>Estimation</title>
        <p id="Par27">A non-parametric estimation of the cumulative transition intensities is given by the <bold>Nelson-Aalen estimator</bold> [<xref ref-type="bibr" rid="CR7">7</xref>]. This estimator is based on the number of direct transitions <inline-formula id="IEq13"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \rightarrow l$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq13.gif"/></alternatives></inline-formula> before time <italic>t</italic>, denoted by <inline-formula id="IEq14"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{kl}(t)$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq14.gif"/></alternatives></inline-formula>, and the number of individuals in state <italic>k</italic> just before time <italic>t</italic>, denoted by <inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_k(t)$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq15.gif"/></alternatives></inline-formula>. Then, the Nelson-Aalen estimator for the cumulative transition intensity is given by<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \hat{\Lambda }_{kl}(t)= &amp; {} \int _0^t \frac{dN_{kl}(s)}{Y_k(s)} ds, \;\; \forall l \ne k \in \mathcal {R}\nonumber \\ \hat{\Lambda }_{kk}(t)= &amp; {} -\sum _{k \ne l} \hat{\Lambda }_{kl}(t), \;\; \forall k \in \mathcal {R}. \end{aligned}$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mi>d</mml:mi><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mo>∀</mml:mo><mml:mi>l</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">R</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mover accent="true"><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">kk</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mover accent="true"><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12874_2023_1951_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par28">Semi-parametric regression models are very convenient to analyse MSMs as they are very flexible. This version of <bold>MSMpred</bold> only includes the Cox proportional hazards model. Since a Cox model is fitted for every transition, different subsets of covariates might be chosen to indicate their influence on different states of the model.</p>
        <p id="Par29">The <bold>Cox or proportional hazards model</bold> allows to relate the characteristics of an individual (described by some covariates) and the transition intensities:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \lambda _{kl}(t;{\textbf {Z}}) = \lambda _{kl,0}(t)\exp (\varvec{\beta }_{kl}^T {\textbf {Z}}) \end{aligned}$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold">Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mi mathvariant="bold">Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12874_2023_1951_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq16"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{kl,0}(t)$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq16.gif"/></alternatives></inline-formula> is the baseline intensity function for the transition <inline-formula id="IEq17"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \rightarrow l$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq17.gif"/></alternatives></inline-formula>, <inline-formula id="IEq18"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\beta }_{kl}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq18.gif"/></alternatives></inline-formula> is the vector of regression parameters, and <inline-formula id="IEq19"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf {Z}}=(Z_1,...,Z_p)$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq19.gif"/></alternatives></inline-formula> is the covariate vector.</p>
        <p id="Par30">The association of a covariate <inline-formula id="IEq20"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z_m$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>Z</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq20.gif"/></alternatives></inline-formula> with the transition intensity of a specific transition <inline-formula id="IEq21"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \rightarrow l$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq21.gif"/></alternatives></inline-formula> can be measured by means of the <bold>hazard ratio</bold> (<inline-formula id="IEq22"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {HR}$$\end{document}</tex-math><mml:math id="M54"><mml:mtext>HR</mml:mtext></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq22.gif"/></alternatives></inline-formula>):<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text {HR}_{kl,q} = \exp (\beta _{kl,q}). \end{aligned}$$\end{document}</tex-math><mml:math id="M56" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>HR</mml:mtext><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12874_2023_1951_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par31">The Cox model is built under three assumptions that need to be validated for each transition after every preliminary fitting. The assumptions are the following: first, the continuous covariates must act linearly on the logarithm of the hazard ratio; second, the final fitted model must lack influential observations; and third, the hazard rates between every two values of each covariate must be proportional. If any of these assumptions does not hold for a specific transition, the corresponding subset of covariates has to be changed and the model has to be readjusted [<xref ref-type="bibr" rid="CR8">8</xref>]. <bold>MSMpred</bold> allows to make all these validations graphically using several types of residuals. In this app we have implemented the following residuals:</p>
        <p id="Par32"><bold>Martingale-based residuals</bold> in order to validate the linearity in the continuous covariates. A graph representing the martingale-based residuals of the selected transition and covariate as function of covariate values is reported. If the smoothed curve along the x axis is reasonably linear, we can assume the linearity of that covariate in that specific transition, otherwise, a transformation of the covariate in that specific transition should be implemented.</p>
        <p id="Par33"><bold>Residuals based on the scores</bold> to validate the global fit and to detect influential individuals. The user can plot the dfbetas residuals versus each covariate for any specific transition. The dfbetas residuals are the standardized dfbeta residuals which give a measure of the approximate change of the coefficients if the individual <italic>i</italic> is not taken into account [<xref ref-type="bibr" rid="CR9">9</xref>]:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} r_{df_{i,kl}}(t) = \hat{\varvec{\beta }}_{kl} - \hat{\varvec{\beta }}_{kl(i)}, \end{aligned}$$\end{document}</tex-math><mml:math id="M58" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12874_2023_1951_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq23"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\varvec{\beta }}_{kl}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq23.gif"/></alternatives></inline-formula> represents the estimator obtained when adjusting the Cox model for the transition <inline-formula id="IEq24"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \rightarrow l$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq24.gif"/></alternatives></inline-formula> considering all the individuals, and <inline-formula id="IEq25"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\varvec{\beta }}_{kl(i)}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq25.gif"/></alternatives></inline-formula> the estimator from the model without taking into account the individual <italic>i</italic>. These graphs help to detect if there is any potential influential value. Since large values of dfbetas indicate observations that are influential in estimating a given parameter, the larger the value of dfbetas the more influential the observation is.</p>
        <p id="Par34"><bold>Schoenfeld residuals</bold> to validate the proportional hazards premise. These residuals show the difference between the observed value of a covariate for a given selected transition and for every failure and the expected value under proportionality of the hazards. A graph with the scaled residuals over time can be plotted for each covariate. Each of these graphs should be independently assessed, and if the confidence band of the smoothed curve covers the line <inline-formula id="IEq26"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{SC_{kl,m}}=0$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq26.gif"/></alternatives></inline-formula>, the proportionality of the hazard of covariate <inline-formula id="IEq27"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z_m$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>Z</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq27.gif"/></alternatives></inline-formula> in the transition <inline-formula id="IEq28"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \rightarrow l$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq28.gif"/></alternatives></inline-formula> is not severely violated.</p>
      </sec>
      <sec id="Sec5">
        <title>Prediction</title>
        <p id="Par35">As we will use MSMs to make predictions for new individuals, a predictive model needs to be specified to obtain <inline-formula id="IEq29"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\text {P}}\{X(t_1)=x|\mathcal {H}(t_0)\}$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mover accent="true"><mml:mtext>P</mml:mtext><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="script">H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq29.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq30"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_1&gt;t_0$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq30.gif"/></alternatives></inline-formula> and <inline-formula id="IEq31"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {H}(t_0)=\{\mathcal {X}(t_0), \mathcal {Z}(t_0)\}$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi mathvariant="script">H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="script">X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="script">Z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq31.gif"/></alternatives></inline-formula> is the observed history of states and covariates until time <inline-formula id="IEq32"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_0$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq32.gif"/></alternatives></inline-formula>. The tilde over P indicates that this is the predicted probability and not the observed probability, <inline-formula id="IEq33"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Pr \{X(t_1)=x|\mathcal {H}(t_0)\}$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mo>Pr</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="script">H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq33.gif"/></alternatives></inline-formula>. Once the predictive model is obtained, the transition probabilities and hazard functions could be obtained in order to forecast different aspects of interest (e.g., probability of being in each state after time <italic>t</italic>).</p>
        <p id="Par36">To assess how good are those predictions, we need to analyse the calibration and sharpness of the predictive model. Concerning the calibration analysis the predicted probabilities, <inline-formula id="IEq34"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\text {P}}$$\end{document}</tex-math><mml:math id="M82"><mml:mover accent="true"><mml:mtext>P</mml:mtext><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq34.gif"/></alternatives></inline-formula>, and the true probabilities, <italic>P</italic>, are compared, aiming to check how near/far are from each other. Ultimately systematically biased predictions can be detected [<xref ref-type="bibr" rid="CR7">7</xref>]. With the sharpness of the model we analyse if the baseline information given by <inline-formula id="IEq35"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {H}(t_0)$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi mathvariant="script">H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq35.gif"/></alternatives></inline-formula>, has a highly predictive value for the state where individuals will be later in time.</p>
        <p id="Par37">Some scoring rules, such as the logarithmic score, combine both aspects, calibration and sharpness, to analyse the performance of the predictive models. The logarithmic score for a group of <italic>n</italic> individuals is computed as<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text {LS}(\tilde{\text {P}}, t_1) = -\frac{1}{n}\sum _{i=1}^n \log \tilde{\text {P}}\{X_i(t_1)=x_i(t_1)| \mathcal {H}_i(t_0)\} \end{aligned}$$\end{document}</tex-math><mml:math id="M86" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>LS</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mtext>P</mml:mtext><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mo>log</mml:mo><mml:mover accent="true"><mml:mtext>P</mml:mtext><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="script">H</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12874_2023_1951_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>and takes values between 0 and <inline-formula id="IEq36"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\infty$$\end{document}</tex-math><mml:math id="M88"><mml:mi>∞</mml:mi></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq36.gif"/></alternatives></inline-formula>. This score is useful to compare different models, where models with lower values of <inline-formula id="IEq37"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {LS}(\tilde{\text {P}}, t_1)$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mtext>LS</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mtext>P</mml:mtext><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq37.gif"/></alternatives></inline-formula> are preferable. The value of the the logarithmic score by itself is not, however, interpretable.</p>
        <p id="Par38">The article is from now on structured as follows. It starts with an <xref rid="Sec6" ref-type="sec">Implementation</xref> section introducing the different tabs of the <bold>MSMpred</bold> describing their inputs and outputs, together with some indications about how to interpret them. For illustrative purposes the app is accompanied by data from a subset of four cohorts corresponding to four different Spanish waves of the COVID-19 pandemic. This dataset (uploaded on July 28th, 2022) has information about 4,000 hospitalized adult COVID-19 patients from 8 Catalan hospitals and it is part of the <italic>Dynamic evaluation of COVID-19 clinical states and their prognostic factors to improve the intra-hospital patient management</italic> project (DIVINE project, 2020PANDE00148, <ext-link ext-link-type="uri" xlink:href="https://grbio.upc.edu/en/research/projects/pandemies">https://grbio.upc.edu/en/research/projects/pandemies</ext-link>). This project was approved by the Ethics Committee of the Hospital Universitari de Bellvitge. The <xref rid="Sec8" ref-type="sec">Results</xref> section uses this dataset to illustrate the different capabilities of the app, which is open to further implementations outlined in the <xref rid="Sec14" ref-type="sec">Discussion</xref> section. This paper ends by listing the future work of <bold>MSMpred</bold> and comparing the app to other web tools related to MSMs.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Implementation</title>
    <p id="Par39"><bold>MSMpred</bold> is a shiny app with two main goals: 1) to fit a MSM from specific data; 2) to predict the clinical evolution for a given individual based on a previously fitted MSM. The user can upload a new dataset, provided that it has the required format explained in the help of the app.</p>
    <p id="Par40">As <bold>MSMpred</bold> is mainly designed for physicians or researchers with little knowledge about MSMs or statisticians that want to analyse data in a quick and visual way, the app is very friendly, implementing all the statistical part in an intuitive way and including interpretations for the different outputs.</p>
    <sec id="Sec7">
      <title>Software</title>
      <p id="Par41">This app has been created using shiny (version 1.7.3), an R package to create interactive web applications. The user can access this app either using the link (<ext-link ext-link-type="uri" xlink:href="https://www.grbio.eu/pubs/MSMpred/">https://www.grbio.eu/pubs/MSMpred/</ext-link>) or downloading the R code that is available in github (<ext-link ext-link-type="uri" xlink:href="https://github.com/LeireGarmendia/MSMpred">https://github.com/LeireGarmendia/MSMpred</ext-link>) and locally running it. Other R packages used to implement the app and to improve the user interface are shinyBS, shinyWidgets, shinydashboard, shinydashboardPlus, shinyalert, shinyMatrix, and shinyjs. For implementing the MSM the app uses the mstate package following the indications given by Wreede [<xref ref-type="bibr" rid="CR10">10</xref>]. The plots are made using the packages ggplot2, bshazard, cmprsk, DiagrammeR, LoopDetectR, survminer, pals, and the tables using DT and summarytools. Finally, another packages for data manipulation, such as dplyr, stringr, and lubridate are needed. The app was deployed using the version 4.2.1 of the R statistical software (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/bin/windows/base/old/4.2.1/">https://cran.r-project.org/bin/windows/base/old/4.2.1/</ext-link>).</p>
      <p id="Par42"><bold>MSMpred</bold> has different sections identified by tabs where the user defines different aspects of MSMs (e.g., selection of the covariates or characteristics of the new individual) using parameterizable inputs. They are shortly described below along with their features:<list list-type="bullet"><list-item><p id="Par43"><bold>Home</bold>: app explanation, example data description and required format for data.</p></list-item><list-item><p id="Par44"><bold>Data</bold>: dataset upload, state and covariate labels customization and filters to apply to the dataset. Descriptive analysis of the covariates.</p></list-item><list-item><p id="Par45"><bold>Model specification</bold>: states and transitions definition and covariate selection for each transition.</p></list-item><list-item><p id="Par46"><bold>Exploring the data</bold>: descriptive and non-parametric plots related to MSM.</p></list-item><list-item><p id="Par47"><bold>Model output</bold>: selection of the type of model to be fitted, model output by means of tables and forest-plots, model validation and model comparison.</p></list-item><list-item><p id="Par48"><bold>Predictions</bold>: predictions for new individuals based on their characteristics.</p></list-item></list></p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Results</title>
    <p id="Par49">Hereafter we explain a case study using the example dataset with the aim of showing the capability of MSMpred. Our goal is to show how the app works and its potential, not to reach conclusions from the results.</p>
    <p id="Par50">The example data consists of 3,984 hospitalized adult COVID-19 patients from 8 Catalan hospitals during 4 different waves (1st, 2nd, 3rd and 5th) of the pandemic in Spain. The default MSM consists of 7 states and 14 transitions (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Those states are: 1) <bold>No severe pneumonia</bold>
<italic>(nopneum)</italic>: patients without severe pneumonia and without mechanical ventilation; 2) <bold>Severe pneumonia</bold>
<italic>(pneum)</italic>: patients with severe pneumonia defined as fraction of inspired oxygen (Fi02) requirements <inline-formula id="IEq38"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt; 35\%$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>35</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq38.gif"/></alternatives></inline-formula> but no need for mechanical ventilation [<xref ref-type="bibr" rid="CR11">11</xref>]; 3) <bold>Recovery</bold>
<italic>(reco)</italic>: patients recovered but still hospitalized; 4) <bold>Non-invasive mechanical ventilation</bold>
<italic>(nimv)</italic>: patients with non-invasive mechanical ventilation (i.e. Optiflow and/or Bilevel positive airway pressure dispositives); 5) <bold>Invasive mechanical ventilation</bold>
<italic>(imv)</italic>: patients with invasive mechanical ventilation (i.e., endotracheal intubation); 6) <bold>Discharge</bold>
<italic>(dcharg)</italic>: patients that go home or to another hospital after recovering from COVID-19; 7) <bold>Death</bold>
<italic>(death)</italic>: patients that die in the hospital due to COVID-19. The covariates used in this example are <bold>wave</bold> (with categories 1, 2, 3 and 5); <bold>sex</bold> (<italic>Man</italic>/Woman); <bold>age</bold> (age in years at hospital admission); <bold>cardiovascular diseases (</bold><bold><italic>card_vasc</italic></bold><bold>)</bold> (<italic>No</italic>/<italic>Yes</italic>); <bold>immunosuppressed (</bold><bold><italic>immune</italic></bold><bold>)</bold> (<italic>No</italic>/<italic>Yes</italic>); <bold>vaccinated (</bold><bold><italic>vacany</italic></bold><bold>)</bold> (<italic>No</italic>/<italic>Yes</italic>); <bold>Charlson index (</bold><bold><italic>charlson</italic></bold><bold>)</bold> (comorbidity index at hospital admission: it ranges from 0 to 24) [<xref ref-type="bibr" rid="CR12">12</xref>]; <bold>PaO2/FiO2 (</bold><bold><italic>safi</italic></bold><bold>)</bold>; <bold>severity score for community-acquired pneumonia (</bold><bold><italic>curb65</italic></bold><bold>)</bold>; <bold>pneumonia severity index (</bold><bold><italic>psi</italic></bold><bold>)</bold> (index to measure the mortality for adults with community-acquired pneumonia); <bold>C-reactive protein (</bold><bold><italic>crprot</italic></bold><bold>)</bold> (it checks for inflammation in the body, usually caused by an infection. Normal values range from 0.8 to 3.0 mg/L); and <bold>lymphocytes (</bold><bold><italic>lympho</italic></bold><bold>)</bold> (number of <inline-formula id="IEq39"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^3$$\end{document}</tex-math><mml:math id="M94"><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq39.gif"/></alternatives></inline-formula> lymphocytes per <inline-formula id="IEq40"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {mm}^3$$\end{document}</tex-math><mml:math id="M96"><mml:msup><mml:mtext>mm</mml:mtext><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq40.gif"/></alternatives></inline-formula>: in normal conditions it ranges from 1 to 4.8 cells/<inline-formula id="IEq41"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {mm}^3$$\end{document}</tex-math><mml:math id="M98"><mml:msup><mml:mtext>mm</mml:mtext><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq41.gif"/></alternatives></inline-formula>).<fig id="Fig1"><label>Fig. 1</label><caption><p>Multistate model of the DIVINE project</p></caption><graphic xlink:href="12874_2023_1951_Fig1_HTML" id="MO10"/></fig></p>
    <sec id="Sec9">
      <title>Data</title>
      <p id="Par51">The user can upload a new dataset, provided that it has the required format. The app allows to filter the data by some covariates and to work with a subset of the original data. An example dataset from the DIVINE project is available and for our case study, we filter the data to only consider patients from the fifth Spanish wave of the pandemic (July-August 2021, <inline-formula id="IEq42"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=690$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>690</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq42.gif"/></alternatives></inline-formula>).</p>
      <p id="Par52">The names of the states and covariates can be customized in the numerical and graphical outputs. To check if the data has been imported correctly and as a first exploration of the data, descriptive plots and tables of the covariates are shown to observe their distribution and their main summary statistics.</p>
    </sec>
    <sec id="Sec10">
      <title>Model specification</title>
      <p id="Par53">The first step is to define the model by specifying the states and transitions of the desired MSM. From the names of the columns of the dataset, the app identifies what are the states, and by drop-downs menus the user can select the transitions between them. It is important to only include those transitions relevants for the problem and with enough individuals passing through them so that the estimation of the associated parameters is feasible. In general, at least 5 events per covariate are needed in each transition, otherwise it is not possible to estimate the corresponding parameters [<xref ref-type="bibr" rid="CR13">13</xref>]. On the other hand, if one specific state does not need to be in the model, it is enough not to include it as part of any transition.</p>
      <p id="Par54">Figure <xref rid="Fig1" ref-type="fig">1</xref> shows the diagram of the defined model where there are two orange initial states (<italic>nopneum, pneum</italic>), three non-initial blue transient states (<italic>reco, nimv, imv</italic>) and two purple absorbing states (<italic>death, dcharg</italic>). The colors help to distinguish the different roles that each state plays into the model. Figure <xref rid="Fig2" ref-type="fig">2</xref> reveals the number of events for each transition, which is helpful to decide whether or not a specific transition should be included and to know how many covariates could be included in each transition [<xref ref-type="bibr" rid="CR14">14</xref>]. The number of events and individuals per transition are the same because <bold>MSMpred</bold> does not allow the inclusion of loops into the model that would permit an individual to pass twice through the same transition.</p>
      <p id="Par55">In the proposed﻿ model there are four transitions that have less than five individuals: <italic>nopneum</italic>
<inline-formula id="IEq43"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M102"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq43.gif"/></alternatives></inline-formula>
<italic>death</italic>, <italic>pneum</italic>
<inline-formula id="IEq44"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M104"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq44.gif"/></alternatives></inline-formula>
<italic>death</italic>, <italic>reco</italic>
<inline-formula id="IEq45"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M106"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq45.gif"/></alternatives></inline-formula>
<italic>death</italic> and <italic>nimv</italic>
<inline-formula id="IEq46"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M108"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq46.gif"/></alternatives></inline-formula>
<italic>death</italic>. Due to their small sample size we will not consider those transitions and we removed them from the model.</p>
      <p id="Par56">
        <fig id="Fig2">
          <label>Fig. 2</label>
          <caption>
            <p>Number of individuals per transition for the DIVINE MSM</p>
          </caption>
          <graphic xlink:href="12874_2023_1951_Fig2_HTML" id="MO11"/>
        </fig>
      </p>
      <p id="Par57">The <italic>covariates/time specification</italic> tab contains a table to be filled with potential covariates in columns and the transitions in rows to specify covariates for each transition. In this same tab, the follow-up time to be considered in the graphical representations and in the predictions can be specified. In our example, the follow-up time is fixed to 30 days, the period for which we are interested in the patient’s evolution.</p>
      <p id="Par58">Once all the model specification is finished, it is mandatory to click on the <italic>save model specification</italic> button to be applied in subsequent sections of the app.</p>
    </sec>
    <sec id="Sec11">
      <title>Exploring the data (EDA)</title>
      <p id="Par59">Box plots representing the length of stay in the initial or transient states of the model are a convenient tool, for uncensored data, to describe the distribution of these stays and to identify possible outliers before fitting the model. In Fig. <xref rid="Fig3" ref-type="fig">3</xref>, we can observe that the state with the highest median length of stay (<inline-formula id="IEq47"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$med=14 \; days$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>14</mml:mn><mml:mspace width="0.277778em"/><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq47.gif"/></alternatives></inline-formula>) is <italic>imv</italic>, while the other four initial/transient states (<italic>nimv, nopneum, pneum, reco</italic>) have lower and similar medians between them, all of them below 5. In our setting, it seems reasonable since <italic>imv</italic> is applied to patients in a critical situation that need longer times in that state to recover. Regarding to the outlier analysis, there are some patients that deserve more attention (e.g., a patient that has been in <italic>reco</italic> almost 100 days without being discharged).<fig id="Fig3"><label>Fig. 3</label><caption><p>Length of stay in the initial/transient states</p></caption><graphic xlink:href="12874_2023_1951_Fig3_HTML" id="MO12"/></fig></p>
      <p id="Par60">In reference to the absorbing states the cumulative incidence plot is provided. It is useful to visualize the rate at which patients enter those states and the chances of reaching them in a given time. We observe that in the fifth wave approximately <inline-formula id="IEq48"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5\%$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq48.gif"/></alternatives></inline-formula> of the hospitalized COVID-19 patients died.</p>
      <p id="Par61">Finally, a plot with a non-parametric estimation of the instantaneous hazards of the transitions is presented, where data can be stratified by a single covariate (e.g.,<italic>sex</italic>, Fig. <xref rid="Fig4" ref-type="fig">4</xref>). For the transitions starting from the state no severe pneumonia, we can observe that women have an increasing risk of going from <italic>nopneum</italic> to <italic>dcharg</italic>, while they have a decreasing risk for transition <italic>nopneum</italic>
<inline-formula id="IEq49"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M114"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq49.gif"/></alternatives></inline-formula>
<italic>pneum</italic>. In the case of men, they have a decreasing risk for transition <italic>nopneum</italic>
<inline-formula id="IEq50"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M116"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq50.gif"/></alternatives></inline-formula>
<italic>pneum</italic>, but the risk for transition <italic>nopneum</italic>
<inline-formula id="IEq51"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M118"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq51.gif"/></alternatives></inline-formula>
<italic>dcharg</italic> changes over time. So, we conclude that there are not relevant differences according to the sex, and the more marked one is associated to the transition <italic>nopneum</italic>
<inline-formula id="IEq52"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M120"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq52.gif"/></alternatives></inline-formula>
<italic>dcharg</italic>, particularly after the seventh day.<fig id="Fig4"><label>Fig. 4</label><caption><p>Exploring the data: instantaneous hazards stratified by sex</p></caption><graphic xlink:href="12874_2023_1951_Fig4_HTML" id="MO13"/></fig></p>
    </sec>
    <sec id="Sec12">
      <title>Model output</title>
      <p id="Par62">Markovian Cox models [<xref ref-type="bibr" rid="CR1">1</xref>] can be selected from the drop-down menu within the <bold>fitted model</bold> tab. Other models are postponed for future releases. The model is fitted including all the previously selected transition specific covariates. The transition specific covariate selection was done based on background knowledge. After fitting the model three tables are returned giving different information of the model (Fig. <xref rid="Fig5" ref-type="fig">5</xref>).<fig id="Fig5"><label>Fig. 5</label><caption><p>Tables of the fitted model</p></caption><graphic xlink:href="12874_2023_1951_Fig5_HTML" id="MO14"/></fig></p>
      <p id="Par63"><bold>1) Table of model coefficients</bold>. Each row represents a transition for a given covariate named in the first column of the table as <italic>covar (</italic><inline-formula id="IEq53"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \rightarrow l$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq53.gif"/></alternatives></inline-formula><italic>)</italic> where <italic>covar</italic> indicates the name of the covariate and <inline-formula id="IEq54"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \rightarrow l$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq54.gif"/></alternatives></inline-formula> the transition of interest. For each covariate and transition the estimated coefficient (<italic>coef</italic>), the estimated hazard ratio, its confidence interval (<italic>HR (95%CI)</italic>), and the <italic>p</italic>-value (<italic>p-value</italic>) to test <inline-formula id="IEq55"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{kl}=0$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq55.gif"/></alternatives></inline-formula> for the corresponding covariate are provided. Those values indicate which is the association level of the covariate <italic>covar</italic> on the risk of having a specific transition.</p>
      <p id="Par64"><bold>2) Table of likelihood</bold>. It contains the values of the log-likelihood of the fitted and the null model. If a null model is fitted, the values of both log-likelihoods match. This table also provides the Akaike Information Criteria (AIC) [<xref ref-type="bibr" rid="CR15">15</xref>] that allows to compare non-nested models.</p>
      <p id="Par65"><bold>3) Table of goodness of fit</bold>. The likelihood ratio, Wald, and score tests (<italic>test</italic>) are implemented to assess the goodness of fit of the proposed model versus the null model. For each test, the value of the statistic, the degrees of freedom (<italic>df</italic>) and the <italic>p</italic>-value are reported. These tests indicate whether or not the proposed model is more likely than the null model.</p>
      <p id="Par66">The estimated hazard ratios and their 95% confidence intervals are represented by forest plots to facilitate the interpretation of the risks associated with the different covariates in each transition. As the MSMs usually have too many coefficients, only the hazard ratios of the covariates related with a specific selected transition are shown. To accommodate covariates measured in different units, the user can scale the <italic>effect</italic> of any numerical covariate, for instance, by representing the risk related to 10-units change instead of 1 unit.</p>
      <p id="Par67">Figure <xref rid="Fig6" ref-type="fig">6</xref> reveals that <italic>psi</italic> and <italic>immune</italic> are the covariates that have an <italic>effect</italic> on transition <inline-formula id="IEq56"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textit{imv} \rightarrow \textit{death}$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mi mathvariant="italic">imv</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="italic">death</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq56.gif"/></alternatives></inline-formula>: the risk of transitioning from invasive mechanical ventilation to dying increases 1.25 times when the pneumonia severity index of the patient increases 10 units, and it increases 3.32 times for immunosuppressed patients compared to non-immunosuppressed patients. There is no evidence to claim that the other covariates have an influence among those patients that transition from invasive mechanical ventilation to dying.<fig id="Fig6"><label>Fig. 6</label><caption><p>Forest plot of the covariates related with the transition imv <inline-formula id="IEq57"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M130"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq57.gif"/></alternatives></inline-formula> death</p></caption><graphic xlink:href="12874_2023_1951_Fig6_HTML" id="MO15"/></fig></p>
      <p id="Par68">Some assumptions are made when fitting the Cox model and they should be evaluated for each transition after every preliminary fitting.</p>
      <p id="Par69">Linearity of the numerical covariates is the first assumption to be assessed using martingale-based residuals. The blue smoothed curve represents a non-parametric estimate of the trajectory of the points along the covariate values indicating whether it is reasonably linear or not. In the case of the covariate <italic>psi</italic> and transition <inline-formula id="IEq58"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textit{imv} \rightarrow \textit{death}$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:mi mathvariant="italic">imv</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="italic">death</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq58.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig7" ref-type="fig">7</xref>), this premise can be assumed.<fig id="Fig7"><label>Fig. 7</label><caption><p>Validation of the assumption of linearity of the psi continuous covariate in the transition imv <inline-formula id="IEq59"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M134"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq59.gif"/></alternatives></inline-formula> death</p></caption><graphic xlink:href="12874_2023_1951_Fig7_HTML" id="MO16"/></fig></p>
      <p id="Par70">The second assumption, absence of influential observations, is analysed by the dfbetas residuals. When there are no points quite far from the others, it suggest the lack of influential observations(see transition <inline-formula id="IEq60"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textit{imv} \rightarrow \textit{death}$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:mi mathvariant="italic">imv</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="italic">death</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq60.gif"/></alternatives></inline-formula> in Fig. <xref rid="Fig8" ref-type="fig">8</xref>).<fig id="Fig8"><label>Fig. 8</label><caption><p>Validation of the assumption of absence of influential observations of covariates related with the transition imv <inline-formula id="IEq61"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M138"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq61.gif"/></alternatives></inline-formula> death</p></caption><graphic xlink:href="12874_2023_1951_Fig8_HTML" id="MO17"/></fig></p>
      <p id="Par71">The last assumption, proportionality of the hazards, is assessed through the Schoenfeld residuals: the confidence bands of the smoothed curves should completely cover the line at 0. In Fig. <xref rid="Fig9" ref-type="fig">9</xref>, we see that this premise holds for transition <inline-formula id="IEq62"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textit{imv} \rightarrow \textit{death}$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:mi mathvariant="italic">imv</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="italic">death</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq62.gif"/></alternatives></inline-formula>.<fig id="Fig9"><label>Fig. 9</label><caption><p>Validation of the assumption of proportionality of the hazards of covariates related with the transition imv <inline-formula id="IEq63"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M142"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq63.gif"/></alternatives></inline-formula> death</p></caption><graphic xlink:href="12874_2023_1951_Fig9_HTML" id="MO18"/></fig></p>
      <p id="Par72">As all the assumptions hold for transition <inline-formula id="IEq64"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textit{imv} \rightarrow \textit{death}$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:mi mathvariant="italic">imv</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="italic">death</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq64.gif"/></alternatives></inline-formula>, it is not necessary to go back and redefine the model fitting for this transition. But, before drawing conclusions or making predictions based on that model it is necessary to analyse every transition of the model.</p>
      <p id="Par73">As the fitted model will be used to predict, it is important to evaluate its global predictive performance. As the involved calculation has a high computational cost, this is only done on request by clicking the <italic>predictive performance</italic> button. Then, two tables will be showed: the first one returns the logarithmic score of the fitted model, while the second one represents the confusion matrix, containing the absolute frequencies according to the real (columns) and predicted (rows) states for a given follow-up time. Furthermore, a barplot representing the proportion of correct guesses for each state is provided.</p>
      <p id="Par74">In the <bold>model comparison</bold> tab, the information of each fitted model is stored in order to make possible their comparison. In addition, this information can be saved to be subsequently loaded in other session.</p>
    </sec>
    <sec id="Sec13">
      <title>Predictions</title>
      <p id="Par75">Predictions on new subjects as well as comparison of two subjects with different profiles are implemented in <bold>MSMpred</bold>. For instance, we want to contrast the evolution at 30 days of two hospitalized patients with non-invasive mechanical ventilation. They are both females, 80 years old, with a Charlson index and CURB-65 of 2, with a pneumonia severity index of 100, a C-reactive protein of 90 ng/ml and a safi and lymphocytes of 428.571 mmHg and <inline-formula id="IEq65"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.93 \times 10^3$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:mn>0.93</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq65.gif"/></alternatives></inline-formula> cells/<inline-formula id="IEq66"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {mm}^3$$\end{document}</tex-math><mml:math id="M148"><mml:msup><mml:mtext>mm</mml:mtext><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq66.gif"/></alternatives></inline-formula>, respectively. The first woman has cardiovascular as well as autoimmune diseases and she is not vaccinated against COVID-19. The second woman is vaccinated and does not have neither cardiovascular nor autoimmune diseases.</p>
      <p id="Par76">Once the profiles have been defined, we obtain the probability of being in each state after 30 days for each patient (Fig. <xref rid="Fig10" ref-type="fig">10</xref>), regardless of previously visited states. We can observe that the evolution of first patient is less optimistic with 65.1% probability of having left the hospital before day 30 and 32.2% probability of dying, while the second one has a better prognosis with a probability of discharge before day 30 of 77.3%.<fig id="Fig10"><label>Fig. 10</label><caption><p>Predictions of the probability of being in each state after 30 days for the two new patients</p></caption><graphic xlink:href="12874_2023_1951_Fig10_HTML" id="MO19"/></fig></p>
      <p id="Par77">Graphically, Fig. <xref rid="Fig11" ref-type="fig">11</xref> shows those percentages via transition probability plots, in a non-stacked or stacked way. Both versions give the probability of being in each state in a specific time point. In the case of the stacked plot, that probability is the height of the coloured section corresponding to the state of interest, while in the case of the non-stacked plot, it is directly the value of the curve of the state of interest.<fig id="Fig11"><label>Fig. 11</label><caption><p>Transition probability plots for the two new patients, the first in a non-stacked way and the second in a stacked way</p></caption><graphic xlink:href="12874_2023_1951_Fig11_HTML" id="MO20"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Discussion</title>
    <p id="Par78"><bold>MSMpred</bold> is a powerful tool to address a wide spectrum of problems. <bold>MSMpred</bold> can be used for modelling the course of any disease by means of MSM models (e.g., cancer, Alzheimer, fertility, chronic diabetic complications) with different degrees of severity. <bold>MSMpred</bold> is also appropriate in other fields outside the biomedical setting, for instance in multistate reliability assessment.</p>
    <p id="Par79"><bold>MSMpred</bold> allows to fit an MSM and to make predictions for new individuals in a friendly way providing several graphics that help interpreting those results.</p>
    <p id="Par80">Although other apps and packages to work with MSM exist, there are some unique characteristics of our app that make the difference. Regarding to the model definition, <bold>MSMpred</bold> does not limit the number of states or transitions: Furthermore, a diagram of the model is depicted while it is being specified. In order to build this diagram the number of states and transitions need to be taken into account. In addition, the user can delete transitions if by error a transition has been included or a transition is not needed. As seen, the covariates can be specified for each transition allowing a maximum level of detail in the model specification. Regarding visualization, several points are noteworthy. The instantaneous hazard plot, albeit common in this type of models, can be instantly obtained by specifying the ending/starting state of interest and also stratifying by some covariate. Furthermore, <bold>MSMpred</bold> shows the forest plot of the covariates related to the transition of interest. In relation to predictive performance, <bold>MSMpred</bold> provides outputs of the overall performance both for comparing models to each other (e.g., the logarithmic score) and more interpretable measures of accuracy for a single model (e.g., the confusion matrix). Finally, obtaining the validation graphics automatically allows the user to speed up model fitting with the corresponding saving of time in research work.</p>
    <p id="Par81"><bold>MSMpred</bold> is being constantly updated. In particular we are working on a new dataset including censored observations. We would also like to implement the option of including time-dependent covariates into the model, as well as allowing to fit other type of MSMs (e.g., non-Markov Cox models, semi-Markov models, parametric models). Finally, we are working in the development of a formal methodology to compare the goodness of fit of different MSMs.</p>
  </sec>
  <sec id="Sec15">
    <title>Conclusions</title>
    <p id="Par82"><bold>MSMpred</bold> is an R shiny app presenting useful tools for description, analysis, prediction and visualization of the different stages of a disease. <bold>MSMpred</bold> facilitates, in an interactive way, a better understanding of the potential paths along the states, of the risks associated to each transition and on the prognosis for a new subject. Non-experienced users might use <bold>MSMpred</bold> because is an intuitive and visual app and does not require neither programming skills nor advanced statistical knowledge. If needed, basic statistical knowledge on survival analysis can be obtained in classic references such as Klein [<xref ref-type="bibr" rid="CR16">16</xref>]. For a thorough monograph on Cox Model we suggest [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>MSM</term>
        <def>
          <p id="Par4">multistate model</p>
        </def>
      </def-item>
      <def-item>
        <term>DIVINE</term>
        <def>
          <p id="Par5">Dynamic evaluation of COVID-19 clinical states and their prognostic factors to improve the intra-hospital patient management</p>
        </def>
      </def-item>
      <def-item>
        <term>ICU</term>
        <def>
          <p id="Par6">Intensive Care Unit</p>
        </def>
      </def-item>
      <def-item>
        <term>NIMV</term>
        <def>
          <p id="Par7">Non-Invasive Mechanical Ventilation</p>
        </def>
      </def-item>
      <def-item>
        <term>IMV</term>
        <def>
          <p id="Par8">Invasive Mechanical Ventilation</p>
        </def>
      </def-item>
      <def-item>
        <term>
          <inline-formula id="IEq1">
            <alternatives>
              <tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \rightarrow l$$\end{document}</tex-math>
              <mml:math id="M150">
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                  <mml:mo stretchy="false">→</mml:mo>
                  <mml:mi>l</mml:mi>
                </mml:mrow>
              </mml:math>
              <inline-graphic xlink:href="12874_2023_1951_Article_IEq1.gif"/>
            </alternatives>
          </inline-formula>
        </term>
        <def>
          <p id="Par9">Direct transition from state <italic>k</italic> to state <italic>l</italic></p>
        </def>
      </def-item>
      <def-item>
        <term>HR</term>
        <def>
          <p id="Par10">Hazard ratio</p>
        </def>
      </def-item>
      <def-item>
        <term>LS</term>
        <def>
          <p id="Par11">Logarithmic score</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thanks the researchers that give us some feedback about the beta version of the app: Rui Alves, Mireia Besalú, Marta Bofill, Jacobo de Uña Álvarez, Daniel Fernández, Luís Filipe Meira Machado, Antoni Miñarro, Natàlia Pallarès, Pau Satorra, Albert Sorribas, Esteban Vegas, and Lore Zumeta.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>GGM had the original idea. LGB, JCM, and GGM designed the web tool. LGB wrote the first draft of the article. All authors substantively revised the submitted version. All authors have approved the submitted version. All authors have agreed both to be personally accountable for the author’s own contributions and to ensure that questions related to the accuracy or integrity of any part of the work.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This research was funded by the Ministerio de Ciencia e Innovación (Spain) [PID2019-104830RB-I00/ DOI (AEI): 10.13039/501100011033] and by Generalitat de Catalunya (2020PANDE00148).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The example dataset of the DIVINE project supporting the conclusions of this article is not available due to confidentiality reasons, but a modified example dataset is available in the Github repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/LeireGarmendia/MSMpred">https://github.com/LeireGarmendia/MSMpred</ext-link>. The detailed code of the app can be found in the same Github repository.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability and requirements</title>
    <p>Project name: MSMpred.</p>
    <p> Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.grbio.eu/pubs/MSMpred/">https://www.grbio.eu/pubs/MSMpred/</ext-link></p>
    <p> Operating system(s): Platform independent.</p>
    <p> Programming language: R.</p>
    <p> Other requirements: Any web browser.</p>
    <p> License: published under the GNU General Public License Version 2.</p>
    <p> Any restrictions to use by non-academics: Commercial organizations are welcome to contact the author prior to use.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par83">The study protocol associated with the example dataset was approved by the Ethics Committee of the Hospital Universitari de Bellvitge and all patients included into the study provide its informed consent to participate.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par84">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par85">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1. </label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meira-Machado</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>de Uña</surname>
            <given-names>Alvarez J</given-names>
          </name>
          <name>
            <surname>Cadarso-Suárez</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Andersen</surname>
            <given-names>PK</given-names>
          </name>
        </person-group>
        <article-title>Multi-state models for the analysis of time-to-event data</article-title>
        <source>Stat Methods Med Res.</source>
        <year>2009</year>
        <volume>18</volume>
        <issue>2</issue>
        <fpage>195</fpage>
        <lpage>222</lpage>
        <pub-id pub-id-type="doi">10.1177/0962280208092301</pub-id>
        <?supplied-pmid 18562394?>
        <pub-id pub-id-type="pmid">18562394</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2. </label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ursino</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dupuis</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Buetti</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multistate Modeling of COVID-19 Patients Using a Large Multicentric Prospective Cohort of Critically Ill Patients</article-title>
        <source>J Clin Med.</source>
        <year>2021</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>544</fpage>
        <pub-id pub-id-type="doi">10.3390/jcm10030544</pub-id>
        <?supplied-pmid 33540733?>
        <pub-id pub-id-type="pmid">33540733</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3. </label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mody</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lyons</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Vazquez Guillamet</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Clinical Course of Coronavirus Disease 2019 in a US Hospital System: A Multistate Analysis</article-title>
        <source>Am J Epidemiol.</source>
        <year>2021</year>
        <volume>190</volume>
        <issue>4</issue>
        <fpage>539</fpage>
        <lpage>552</lpage>
        <pub-id pub-id-type="doi">10.1093/aje/kwaa286</pub-id>
        <?supplied-pmid 33351077?>
        <pub-id pub-id-type="pmid">33351077</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4. </label>
      <mixed-citation publication-type="other">Stuart Lacy. MSM shiny. 2017. <ext-link ext-link-type="uri" xlink:href="https://stulacy.shinyapps.io/msm-shiny/">https://stulacy.shinyapps.io/msm-shiny/</ext-link>. Accessed 21 July 2022.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5. </label>
      <mixed-citation publication-type="other">Nikolaos Skourlis. MSMplus shiny. 2021. Available from: <ext-link ext-link-type="uri" xlink:href="https://nskbiostatistics.shinyapps.io/MSMplus/">https://nskbiostatistics.shinyapps.io/MSMplus/</ext-link>. Accessed 21 July 2022.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6. </label>
      <mixed-citation publication-type="other">Ryan Peterson. MSDshiny; 2019. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/petersonR/MSDshiny">https://github.com/petersonR/MSDshiny</ext-link>. Accessed 21 July 2022.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7. </label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cook</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Lawless</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <source>Multistate Models for the Analysis of Life History Data</source>
        <year>2018</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Chapman and Hall/CRC</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8. </label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Therneau</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Grambsch</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <source>Modeling Survival Data: Extending the Cox Model</source>
        <year>2000</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9. </label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Valliant</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Linear Regression Influence Diagnostics for Unclustered Survey Data</article-title>
        <source>J Off Stat.</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>1</issue>
        <fpage>99</fpage>
        <lpage>119</lpage>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10. </label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Wreede</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Fiocco</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Putter</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>mstate: An R Package for the Analysis of Competing Risks and Multi-State Models</article-title>
        <source>J Stat Softw.</source>
        <year>2011</year>
        <volume>38</volume>
        <issue>7</issue>
        <fpage>1</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v038.i07</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11. </label>
      <mixed-citation publication-type="other">Catoire P, Tellier E, de la Rivière C, Beauvieux MC, Valdenaire G, Galinski M, Revel P, Combes X, Gil-Jardiné C. Assessment of the SpO2/FiO2 ratio as a tool for hypoxemia screening in the emergency department. Am J Emerg Med. 2021;44:116-120.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12. </label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Charlson</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Pompei</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ales</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>MacKenzie</surname>
            <given-names>CR</given-names>
          </name>
        </person-group>
        <article-title>A new method of classifying prognostic comorbidity in longitudinal studies: development and validation</article-title>
        <source>J Chronic Dis.</source>
        <year>1987</year>
        <volume>40</volume>
        <issue>5</issue>
        <fpage>373</fpage>
        <lpage>383</lpage>
        <pub-id pub-id-type="doi">10.1016/0021-9681(87)90171-8</pub-id>
        <?supplied-pmid 3558716?>
        <pub-id pub-id-type="pmid">3558716</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13. </label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peduzzi</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Concato</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kemper</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Holford</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Feinstein</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>A simulation study of the number of events per variable in logistic regression analysis</article-title>
        <source>J Clin Epidemiol.</source>
        <year>1996</year>
        <volume>49</volume>
        <issue>12</issue>
        <fpage>1373</fpage>
        <lpage>1379</lpage>
        <pub-id pub-id-type="doi">10.1016/S0895-4356(96)00236-3</pub-id>
        <?supplied-pmid 8970487?>
        <pub-id pub-id-type="pmid">8970487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14. </label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vittinghoff</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>McCulloch</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>Relaxing the rule of ten events per variable in logistic and Cox regression</article-title>
        <source>Am J Epidemiol.</source>
        <year>2007</year>
        <volume>165</volume>
        <issue>6</issue>
        <fpage>710</fpage>
        <lpage>718</lpage>
        <pub-id pub-id-type="doi">10.1093/aje/kwk052</pub-id>
        <?supplied-pmid 17182981?>
        <pub-id pub-id-type="pmid">17182981</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15. </label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Akaike</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A new look at the statistical model identification</article-title>
        <source>IEEE Trans Autom Control.</source>
        <year>1974</year>
        <volume>19</volume>
        <issue>6</issue>
        <fpage>716</fpage>
        <lpage>723</lpage>
        <pub-id pub-id-type="doi">10.1109/TAC.1974.1100705</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16. </label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Moeschberger</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <source>Survival Analysis: Techniques for Censored and Truncated Data</source>
        <year>2003</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Med Res Methodol</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Med Res Methodol</journal-id>
    <journal-title-group>
      <journal-title>BMC Medical Research Methodology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2288</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10206572</article-id>
    <article-id pub-id-type="publisher-id">1951</article-id>
    <article-id pub-id-type="doi">10.1186/s12874-023-01951-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MSMpred: interactive modelling and prediction of individual evolution via multistate models</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2053-9535</contrib-id>
        <name>
          <surname>Garmendia Bergés</surname>
          <given-names>Leire</given-names>
        </name>
        <address>
          <email>leire.garmendia@upc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cortés Martínez</surname>
          <given-names>Jordi</given-names>
        </name>
        <address>
          <email>jordi.cortes-martinez@upc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gómez Melis</surname>
          <given-names>Guadalupe</given-names>
        </name>
        <address>
          <email>lupe.gomez@upc.edu</email>
        </address>
        <xref ref-type="contrib" rid="IA1"/>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" id="IA1">
        <collab>DIVINE project</collab>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.6835.8</institution-id><institution-id institution-id-type="ISNI">0000 0004 1937 028X</institution-id><institution>Department of Statistics and Operations Research, </institution><institution>Universitat Politècnica de Catalunya, </institution></institution-wrap>Barcelona, Spain </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>126</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Modelling the course of a disease regarding severe events and identifying prognostic factors is of great clinical relevance. Multistate models (MSM) can be used to describe diseases or processes that change over time using different states and the transitions between them. Specifically, they are useful to analyse a disease with an increasing degree of severity, that may precede death. The complexity of these models changes depending on the number of states and transitions taken into account. Due to that, a web tool has been developed making easier to work with those models.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">MSMpred is a web tool created with the shiny R package that has two main features: 1) to allow to fit a MSM from specific data; 2) to predict the clinical evolution for a given subject. To fit the model, the data to be analysed must be upload in a prespecified format. Then, the user has to define the states and transitions as well as the covariates (e.g., age or gender) involved in each transition. From this information, the app returns histograms or barplots, as appropriate, to represent the distributions of the selected covariates and boxplots to show the patient’ length of stay (for uncensored data) in each state. To make predictions, the values of selected covariates from a new subject at baseline has to be provided. From these inputs, the app provides some indicators of the subject’s evolution such as the probability of 30-day death or the most likely state at a fixed time. Furthermore, visual representations (e.g., the stacked transition probabilities plot) are given to make predictions more understandable.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">MSMpred is an intuitive and visual app that eases the work of biostatisticians and facilitates to the medical personnel the interpretation of MSMs.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Shiny app</kwd>
      <kwd>Multistate models</kwd>
      <kwd>COVID-19</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100010552</institution-id>
            <institution>Departament de Salut, Generalitat de Catalunya</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2020PANDE00148</award-id>
        <principal-award-recipient>
          <name>
            <surname>Gómez Melis</surname>
            <given-names>Guadalupe</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004837</institution-id>
            <institution>Ministerio de Ciencia e Innovación</institution>
          </institution-wrap>
        </funding-source>
        <award-id>PID2019-104830RB-I00</award-id>
        <principal-award-recipient>
          <name>
            <surname>Gómez Melis</surname>
            <given-names>Guadalupe</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par12">A multistate model (MSM) generalizes the classic survival modelling allowing the description of complex dynamical processes over time. It is defined by a series of states — which could represent different stages of the life history of an individual — and the transitions that connect them — which describe the potential paths between those states along time [<xref ref-type="bibr" rid="CR1">1</xref>].</p>
    <p id="Par13">As examples in the context of COVID-19, Ursino et al. [<xref ref-type="bibr" rid="CR2">2</xref>] and Mody et al. [<xref ref-type="bibr" rid="CR3">3</xref>] used MSMs in order to describe the evolution of patients admitted to the Intensive Care Unit (ICU), and hospitalized patients, respectively. They consider several states, such as inpatient floor, ICU and invasive mechanical ventilation (IMV). The conclusions raised from these papers are powerful because they are able to estimate the factors associated to each transition and not only those that focus on the discharge or death.</p>
    <p id="Par14">Since these type of models are usually complex, different tools have been developed to ease the modellization process and to help with the interpretability of the findings. For instance, the app <bold>MSMshiny</bold> [<xref ref-type="bibr" rid="CR4">4</xref>] aims to fit multistate models. It allows the user to: i) add an initial state even if it is not included in the uploaded data; ii) include as many transitions as desired; iii) assign specific covariates to each transition; iv) specify different models and compare their log-likelihood and Akaike information criterion (AIC) to help in selecting the best one. Furthermore, MSMshiny provides an interactive visualization of how individuals move between states over time. Among the main limitations of this app, we highlight that once a transition has been defined, it cannot be removed anymore and that the model cannot be validated through a residual analysis. Despite MSMshiny allows to make predictions, the outputs are limited and they do not help in the interpretation of the results. The app <bold>MSMplus</bold> [<xref ref-type="bibr" rid="CR5">5</xref>] is intended to offer a wide spectrum of visualizations once an MSM is fitted outside the application. It provides a nice friendly interface, which provides various types of graphics, together with some indications, allowing a thorough interpretation of the fitted model. MSMplus allows a deep customization of the returned plots (e.g., changing the names of the states) and is complemented with theoretical explanations on MSMs. A weakness of the MSMplus app is that the users have to perform the analyses on their own and upload the outputs to obtain a complete data visualization of the results. In addition, the app lacks some numerical output, such as a table with the estimates of the fitted model. The <bold>MSDshiny</bold> app [<xref ref-type="bibr" rid="CR6">6</xref>] has been designed specifically for clinical trials allowing the user to make simulations based on MSMs. The total number of states is decided by the user in the model specification. The simulation of the time-to-event times is performed using a Weibull distribution with specific parameters for each transition. Some of its main limitations are the lack of the relevant transition probability plots, the restriction to a maximum of five states and that it does not allow having transient initial states.</p>
    <p id="Par15">This work presents the <bold>MSMpred</bold> shiny app (<ext-link ext-link-type="uri" xlink:href="https://www.grbio.eu/pubs/MSMpred/">https://www.grbio.eu/pubs/MSMpred/</ext-link>) designed to fit a MSM from specific data and to predict the clinical evolution for a given patient based on the previous model. We aim to overcome the above mentioned limitations of the existing apps. Before presenting <bold>MSMpred</bold> we provide an overview of MSM.</p>
    <sec id="Sec2">
      <title>Multistate models</title>
      <p id="Par16">A MSM is a model for a continuous time stochastic process allowing individuals to move among a finite number of states. Within the scope of survival analysis, MSMs allow to describe complex clinical processes that change over time. Those models are formed by states and transitions, which represent, for instance, the different stages of a disease evolution and the possible paths to move between those states, respectively. In these models we focus on the transitions between states and the time until they occur.</p>
      <p id="Par17">Usually those models are represented using a diagram where the nodes represent the states of the model, and the arrows represent the transitions. The diagram provides a visualization of the model allowing a complete understanding of all possible trajectories.</p>
      <p id="Par18">There are three different types of states: initial states are the ones where an individual could start the process; transient states are those in which individuals can get in and out of the state; and absorbing states are the ones where the process ends.</p>
      <p id="Par19">The main goals of MSMs are to characterize the process of an individual or a group; to analyse the relationship between the covariates of interest and the process transitions; to identify the risk factors for specific transitions; and to develop predictive models for new individuals.</p>
      <p id="Par20">There are three main steps to build a MSM: 1) represent the clinical process by means of states and transitions; 2) decide which covariates or factors are considered in each transition; 3) fit the model. The first two steps usually require a clinical insight; so, collaboration with medical experts is essential.</p>
      <sec id="Sec3">
        <title>Characterization</title>
        <p id="Par21">There are different ways to characterize a MSM, related to each other in such a way that one characterization can be obtained from any of the others.</p>
        <p id="Par22">Let <inline-formula id="IEq2"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X=\{X(t): t\ge 0\}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq2.gif"/></alternatives></inline-formula> be the stochastic process where <italic>X</italic>(<italic>t</italic>) represents the state in which the subject is at time <italic>t</italic> and takes values in the discrete set of states of the model, <inline-formula id="IEq3"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {R}=\{1,..,R\}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi mathvariant="script">R</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq3.gif"/></alternatives></inline-formula>. The class <inline-formula id="IEq4"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {H}(t) = \{X(s), {\textbf {Z}}(s), s \le t\}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi mathvariant="script">H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq4.gif"/></alternatives></inline-formula> contains the information of all the paths of all the individuals up to time t including the covariates <inline-formula id="IEq5"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf {Z}}(s)$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq5.gif"/></alternatives></inline-formula>, which might be time-dependent.</p>
        <p id="Par23">The Markov property is met when, for any <inline-formula id="IEq6"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s&lt;t$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq6.gif"/></alternatives></inline-formula> and <inline-formula id="IEq7"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l,k \in \mathcal {R}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq7.gif"/></alternatives></inline-formula>,<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \Pr \{X(t)=l|X(s)=k;\mathcal {H}(s^-)\}{} &amp; {} \nonumber \\ =\Pr \{X(t)=l|X(s)=k\}{} &amp; {} \end{aligned}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Pr</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="script">H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mo>=</mml:mo><mml:mo>Pr</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12874_2023_1951_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {H}(s^-)$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi mathvariant="script">H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq8.gif"/></alternatives></inline-formula> represents the history of the process prior to time <italic>s</italic>. This condition implies that the future path of a subject only depends on the state where he/she is at present but not on the past path that he/she had followed. Under the Markov assumption an MSM process can be characterized by means of either transition probabilities, transition intensities and cumulative transition intensities that we define next [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
        <p id="Par24"><bold>Transition probability</bold>, <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _{kl}(s,t)$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq9.gif"/></alternatives></inline-formula>: the probability that a subject in state <italic>k</italic> at time <italic>s</italic> (<inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s &lt; t$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq10.gif"/></alternatives></inline-formula>) is in state <italic>l</italic> at time <italic>t</italic>, that is,<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}{} &amp; {} \pi _{kl}(s,t)=\Pr \{X(t)=l|X(s)=k\}, \;\; \forall k \ne l \in \mathcal {R},\nonumber \\{} &amp; {} \pi _{kk}(s,t)=1-\sum _{k \ne l}\pi _{kl}(s,t), \;\; \forall k \in \mathcal {R}. \end{aligned}$$\end{document}</tex-math><mml:math id="M22" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>Pr</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">kk</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12874_2023_1951_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par25"><bold>Transition intensity</bold>, <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{kl}(t)$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq11.gif"/></alternatives></inline-formula>: the transition intensity represents the instantaneous probability of transition between two states, <italic>k</italic> and <italic>l</italic>, at a specific time point <italic>t</italic> and it is defined as<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \lambda _{kl}(t)= &amp; {} \lim _{\Delta t\rightarrow 0} \frac{\Pr \{X(t+\Delta t)=l|X(t)=k\}}{\Delta t}\nonumber \\= &amp; {} \lim _{\Delta t\rightarrow 0} \frac{\pi _{kl}(t,t+\Delta t)}{\Delta t}, \;\; \forall k \ne l \in \mathcal {R},\nonumber \\ \lambda _{kk}(t)= &amp; {} -\sum _{k \ne l} \lambda _{kl}(t), \;\; \forall k \in \mathcal {R}. \end{aligned}$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:munder><mml:mo movablelimits="true">lim</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mo>Pr</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:munder><mml:mo movablelimits="true">lim</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">kk</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12874_2023_1951_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par26"><bold>Cumulative transition intensity</bold>, <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Lambda _{kl}(t)$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq12.gif"/></alternatives></inline-formula>: the cumulative transition intensity between states <italic>k</italic> and <italic>l</italic> is defined as<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \Lambda _{kl}(t)=\int _0^t \lambda _{kl}(s) ds, \;\; \forall k,l \in \mathcal {R}. \end{aligned}$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12874_2023_1951_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec4">
        <title>Estimation</title>
        <p id="Par27">A non-parametric estimation of the cumulative transition intensities is given by the <bold>Nelson-Aalen estimator</bold> [<xref ref-type="bibr" rid="CR7">7</xref>]. This estimator is based on the number of direct transitions <inline-formula id="IEq13"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \rightarrow l$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq13.gif"/></alternatives></inline-formula> before time <italic>t</italic>, denoted by <inline-formula id="IEq14"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{kl}(t)$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq14.gif"/></alternatives></inline-formula>, and the number of individuals in state <italic>k</italic> just before time <italic>t</italic>, denoted by <inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_k(t)$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq15.gif"/></alternatives></inline-formula>. Then, the Nelson-Aalen estimator for the cumulative transition intensity is given by<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \hat{\Lambda }_{kl}(t)= &amp; {} \int _0^t \frac{dN_{kl}(s)}{Y_k(s)} ds, \;\; \forall l \ne k \in \mathcal {R}\nonumber \\ \hat{\Lambda }_{kk}(t)= &amp; {} -\sum _{k \ne l} \hat{\Lambda }_{kl}(t), \;\; \forall k \in \mathcal {R}. \end{aligned}$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mi>d</mml:mi><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mo>∀</mml:mo><mml:mi>l</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">R</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mover accent="true"><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">kk</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mover accent="true"><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12874_2023_1951_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par28">Semi-parametric regression models are very convenient to analyse MSMs as they are very flexible. This version of <bold>MSMpred</bold> only includes the Cox proportional hazards model. Since a Cox model is fitted for every transition, different subsets of covariates might be chosen to indicate their influence on different states of the model.</p>
        <p id="Par29">The <bold>Cox or proportional hazards model</bold> allows to relate the characteristics of an individual (described by some covariates) and the transition intensities:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \lambda _{kl}(t;{\textbf {Z}}) = \lambda _{kl,0}(t)\exp (\varvec{\beta }_{kl}^T {\textbf {Z}}) \end{aligned}$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold">Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mi mathvariant="bold">Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12874_2023_1951_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq16"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{kl,0}(t)$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq16.gif"/></alternatives></inline-formula> is the baseline intensity function for the transition <inline-formula id="IEq17"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \rightarrow l$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq17.gif"/></alternatives></inline-formula>, <inline-formula id="IEq18"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\beta }_{kl}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq18.gif"/></alternatives></inline-formula> is the vector of regression parameters, and <inline-formula id="IEq19"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf {Z}}=(Z_1,...,Z_p)$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq19.gif"/></alternatives></inline-formula> is the covariate vector.</p>
        <p id="Par30">The association of a covariate <inline-formula id="IEq20"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z_m$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>Z</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq20.gif"/></alternatives></inline-formula> with the transition intensity of a specific transition <inline-formula id="IEq21"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \rightarrow l$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq21.gif"/></alternatives></inline-formula> can be measured by means of the <bold>hazard ratio</bold> (<inline-formula id="IEq22"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {HR}$$\end{document}</tex-math><mml:math id="M54"><mml:mtext>HR</mml:mtext></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq22.gif"/></alternatives></inline-formula>):<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text {HR}_{kl,q} = \exp (\beta _{kl,q}). \end{aligned}$$\end{document}</tex-math><mml:math id="M56" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>HR</mml:mtext><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12874_2023_1951_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par31">The Cox model is built under three assumptions that need to be validated for each transition after every preliminary fitting. The assumptions are the following: first, the continuous covariates must act linearly on the logarithm of the hazard ratio; second, the final fitted model must lack influential observations; and third, the hazard rates between every two values of each covariate must be proportional. If any of these assumptions does not hold for a specific transition, the corresponding subset of covariates has to be changed and the model has to be readjusted [<xref ref-type="bibr" rid="CR8">8</xref>]. <bold>MSMpred</bold> allows to make all these validations graphically using several types of residuals. In this app we have implemented the following residuals:</p>
        <p id="Par32"><bold>Martingale-based residuals</bold> in order to validate the linearity in the continuous covariates. A graph representing the martingale-based residuals of the selected transition and covariate as function of covariate values is reported. If the smoothed curve along the x axis is reasonably linear, we can assume the linearity of that covariate in that specific transition, otherwise, a transformation of the covariate in that specific transition should be implemented.</p>
        <p id="Par33"><bold>Residuals based on the scores</bold> to validate the global fit and to detect influential individuals. The user can plot the dfbetas residuals versus each covariate for any specific transition. The dfbetas residuals are the standardized dfbeta residuals which give a measure of the approximate change of the coefficients if the individual <italic>i</italic> is not taken into account [<xref ref-type="bibr" rid="CR9">9</xref>]:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} r_{df_{i,kl}}(t) = \hat{\varvec{\beta }}_{kl} - \hat{\varvec{\beta }}_{kl(i)}, \end{aligned}$$\end{document}</tex-math><mml:math id="M58" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12874_2023_1951_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq23"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\varvec{\beta }}_{kl}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq23.gif"/></alternatives></inline-formula> represents the estimator obtained when adjusting the Cox model for the transition <inline-formula id="IEq24"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \rightarrow l$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq24.gif"/></alternatives></inline-formula> considering all the individuals, and <inline-formula id="IEq25"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\varvec{\beta }}_{kl(i)}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq25.gif"/></alternatives></inline-formula> the estimator from the model without taking into account the individual <italic>i</italic>. These graphs help to detect if there is any potential influential value. Since large values of dfbetas indicate observations that are influential in estimating a given parameter, the larger the value of dfbetas the more influential the observation is.</p>
        <p id="Par34"><bold>Schoenfeld residuals</bold> to validate the proportional hazards premise. These residuals show the difference between the observed value of a covariate for a given selected transition and for every failure and the expected value under proportionality of the hazards. A graph with the scaled residuals over time can be plotted for each covariate. Each of these graphs should be independently assessed, and if the confidence band of the smoothed curve covers the line <inline-formula id="IEq26"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{SC_{kl,m}}=0$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq26.gif"/></alternatives></inline-formula>, the proportionality of the hazard of covariate <inline-formula id="IEq27"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z_m$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>Z</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq27.gif"/></alternatives></inline-formula> in the transition <inline-formula id="IEq28"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \rightarrow l$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq28.gif"/></alternatives></inline-formula> is not severely violated.</p>
      </sec>
      <sec id="Sec5">
        <title>Prediction</title>
        <p id="Par35">As we will use MSMs to make predictions for new individuals, a predictive model needs to be specified to obtain <inline-formula id="IEq29"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\text {P}}\{X(t_1)=x|\mathcal {H}(t_0)\}$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mover accent="true"><mml:mtext>P</mml:mtext><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="script">H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq29.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq30"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_1&gt;t_0$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq30.gif"/></alternatives></inline-formula> and <inline-formula id="IEq31"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {H}(t_0)=\{\mathcal {X}(t_0), \mathcal {Z}(t_0)\}$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi mathvariant="script">H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="script">X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="script">Z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq31.gif"/></alternatives></inline-formula> is the observed history of states and covariates until time <inline-formula id="IEq32"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_0$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq32.gif"/></alternatives></inline-formula>. The tilde over P indicates that this is the predicted probability and not the observed probability, <inline-formula id="IEq33"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Pr \{X(t_1)=x|\mathcal {H}(t_0)\}$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mo>Pr</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="script">H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq33.gif"/></alternatives></inline-formula>. Once the predictive model is obtained, the transition probabilities and hazard functions could be obtained in order to forecast different aspects of interest (e.g., probability of being in each state after time <italic>t</italic>).</p>
        <p id="Par36">To assess how good are those predictions, we need to analyse the calibration and sharpness of the predictive model. Concerning the calibration analysis the predicted probabilities, <inline-formula id="IEq34"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{\text {P}}$$\end{document}</tex-math><mml:math id="M82"><mml:mover accent="true"><mml:mtext>P</mml:mtext><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq34.gif"/></alternatives></inline-formula>, and the true probabilities, <italic>P</italic>, are compared, aiming to check how near/far are from each other. Ultimately systematically biased predictions can be detected [<xref ref-type="bibr" rid="CR7">7</xref>]. With the sharpness of the model we analyse if the baseline information given by <inline-formula id="IEq35"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {H}(t_0)$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi mathvariant="script">H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq35.gif"/></alternatives></inline-formula>, has a highly predictive value for the state where individuals will be later in time.</p>
        <p id="Par37">Some scoring rules, such as the logarithmic score, combine both aspects, calibration and sharpness, to analyse the performance of the predictive models. The logarithmic score for a group of <italic>n</italic> individuals is computed as<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text {LS}(\tilde{\text {P}}, t_1) = -\frac{1}{n}\sum _{i=1}^n \log \tilde{\text {P}}\{X_i(t_1)=x_i(t_1)| \mathcal {H}_i(t_0)\} \end{aligned}$$\end{document}</tex-math><mml:math id="M86" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>LS</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mtext>P</mml:mtext><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mo>log</mml:mo><mml:mover accent="true"><mml:mtext>P</mml:mtext><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="script">H</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12874_2023_1951_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>and takes values between 0 and <inline-formula id="IEq36"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\infty$$\end{document}</tex-math><mml:math id="M88"><mml:mi>∞</mml:mi></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq36.gif"/></alternatives></inline-formula>. This score is useful to compare different models, where models with lower values of <inline-formula id="IEq37"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {LS}(\tilde{\text {P}}, t_1)$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mtext>LS</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mtext>P</mml:mtext><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq37.gif"/></alternatives></inline-formula> are preferable. The value of the the logarithmic score by itself is not, however, interpretable.</p>
        <p id="Par38">The article is from now on structured as follows. It starts with an <xref rid="Sec6" ref-type="sec">Implementation</xref> section introducing the different tabs of the <bold>MSMpred</bold> describing their inputs and outputs, together with some indications about how to interpret them. For illustrative purposes the app is accompanied by data from a subset of four cohorts corresponding to four different Spanish waves of the COVID-19 pandemic. This dataset (uploaded on July 28th, 2022) has information about 4,000 hospitalized adult COVID-19 patients from 8 Catalan hospitals and it is part of the <italic>Dynamic evaluation of COVID-19 clinical states and their prognostic factors to improve the intra-hospital patient management</italic> project (DIVINE project, 2020PANDE00148, <ext-link ext-link-type="uri" xlink:href="https://grbio.upc.edu/en/research/projects/pandemies">https://grbio.upc.edu/en/research/projects/pandemies</ext-link>). This project was approved by the Ethics Committee of the Hospital Universitari de Bellvitge. The <xref rid="Sec8" ref-type="sec">Results</xref> section uses this dataset to illustrate the different capabilities of the app, which is open to further implementations outlined in the <xref rid="Sec14" ref-type="sec">Discussion</xref> section. This paper ends by listing the future work of <bold>MSMpred</bold> and comparing the app to other web tools related to MSMs.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Implementation</title>
    <p id="Par39"><bold>MSMpred</bold> is a shiny app with two main goals: 1) to fit a MSM from specific data; 2) to predict the clinical evolution for a given individual based on a previously fitted MSM. The user can upload a new dataset, provided that it has the required format explained in the help of the app.</p>
    <p id="Par40">As <bold>MSMpred</bold> is mainly designed for physicians or researchers with little knowledge about MSMs or statisticians that want to analyse data in a quick and visual way, the app is very friendly, implementing all the statistical part in an intuitive way and including interpretations for the different outputs.</p>
    <sec id="Sec7">
      <title>Software</title>
      <p id="Par41">This app has been created using shiny (version 1.7.3), an R package to create interactive web applications. The user can access this app either using the link (<ext-link ext-link-type="uri" xlink:href="https://www.grbio.eu/pubs/MSMpred/">https://www.grbio.eu/pubs/MSMpred/</ext-link>) or downloading the R code that is available in github (<ext-link ext-link-type="uri" xlink:href="https://github.com/LeireGarmendia/MSMpred">https://github.com/LeireGarmendia/MSMpred</ext-link>) and locally running it. Other R packages used to implement the app and to improve the user interface are shinyBS, shinyWidgets, shinydashboard, shinydashboardPlus, shinyalert, shinyMatrix, and shinyjs. For implementing the MSM the app uses the mstate package following the indications given by Wreede [<xref ref-type="bibr" rid="CR10">10</xref>]. The plots are made using the packages ggplot2, bshazard, cmprsk, DiagrammeR, LoopDetectR, survminer, pals, and the tables using DT and summarytools. Finally, another packages for data manipulation, such as dplyr, stringr, and lubridate are needed. The app was deployed using the version 4.2.1 of the R statistical software (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/bin/windows/base/old/4.2.1/">https://cran.r-project.org/bin/windows/base/old/4.2.1/</ext-link>).</p>
      <p id="Par42"><bold>MSMpred</bold> has different sections identified by tabs where the user defines different aspects of MSMs (e.g., selection of the covariates or characteristics of the new individual) using parameterizable inputs. They are shortly described below along with their features:<list list-type="bullet"><list-item><p id="Par43"><bold>Home</bold>: app explanation, example data description and required format for data.</p></list-item><list-item><p id="Par44"><bold>Data</bold>: dataset upload, state and covariate labels customization and filters to apply to the dataset. Descriptive analysis of the covariates.</p></list-item><list-item><p id="Par45"><bold>Model specification</bold>: states and transitions definition and covariate selection for each transition.</p></list-item><list-item><p id="Par46"><bold>Exploring the data</bold>: descriptive and non-parametric plots related to MSM.</p></list-item><list-item><p id="Par47"><bold>Model output</bold>: selection of the type of model to be fitted, model output by means of tables and forest-plots, model validation and model comparison.</p></list-item><list-item><p id="Par48"><bold>Predictions</bold>: predictions for new individuals based on their characteristics.</p></list-item></list></p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Results</title>
    <p id="Par49">Hereafter we explain a case study using the example dataset with the aim of showing the capability of MSMpred. Our goal is to show how the app works and its potential, not to reach conclusions from the results.</p>
    <p id="Par50">The example data consists of 3,984 hospitalized adult COVID-19 patients from 8 Catalan hospitals during 4 different waves (1st, 2nd, 3rd and 5th) of the pandemic in Spain. The default MSM consists of 7 states and 14 transitions (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Those states are: 1) <bold>No severe pneumonia</bold>
<italic>(nopneum)</italic>: patients without severe pneumonia and without mechanical ventilation; 2) <bold>Severe pneumonia</bold>
<italic>(pneum)</italic>: patients with severe pneumonia defined as fraction of inspired oxygen (Fi02) requirements <inline-formula id="IEq38"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt; 35\%$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>35</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq38.gif"/></alternatives></inline-formula> but no need for mechanical ventilation [<xref ref-type="bibr" rid="CR11">11</xref>]; 3) <bold>Recovery</bold>
<italic>(reco)</italic>: patients recovered but still hospitalized; 4) <bold>Non-invasive mechanical ventilation</bold>
<italic>(nimv)</italic>: patients with non-invasive mechanical ventilation (i.e. Optiflow and/or Bilevel positive airway pressure dispositives); 5) <bold>Invasive mechanical ventilation</bold>
<italic>(imv)</italic>: patients with invasive mechanical ventilation (i.e., endotracheal intubation); 6) <bold>Discharge</bold>
<italic>(dcharg)</italic>: patients that go home or to another hospital after recovering from COVID-19; 7) <bold>Death</bold>
<italic>(death)</italic>: patients that die in the hospital due to COVID-19. The covariates used in this example are <bold>wave</bold> (with categories 1, 2, 3 and 5); <bold>sex</bold> (<italic>Man</italic>/Woman); <bold>age</bold> (age in years at hospital admission); <bold>cardiovascular diseases (</bold><bold><italic>card_vasc</italic></bold><bold>)</bold> (<italic>No</italic>/<italic>Yes</italic>); <bold>immunosuppressed (</bold><bold><italic>immune</italic></bold><bold>)</bold> (<italic>No</italic>/<italic>Yes</italic>); <bold>vaccinated (</bold><bold><italic>vacany</italic></bold><bold>)</bold> (<italic>No</italic>/<italic>Yes</italic>); <bold>Charlson index (</bold><bold><italic>charlson</italic></bold><bold>)</bold> (comorbidity index at hospital admission: it ranges from 0 to 24) [<xref ref-type="bibr" rid="CR12">12</xref>]; <bold>PaO2/FiO2 (</bold><bold><italic>safi</italic></bold><bold>)</bold>; <bold>severity score for community-acquired pneumonia (</bold><bold><italic>curb65</italic></bold><bold>)</bold>; <bold>pneumonia severity index (</bold><bold><italic>psi</italic></bold><bold>)</bold> (index to measure the mortality for adults with community-acquired pneumonia); <bold>C-reactive protein (</bold><bold><italic>crprot</italic></bold><bold>)</bold> (it checks for inflammation in the body, usually caused by an infection. Normal values range from 0.8 to 3.0 mg/L); and <bold>lymphocytes (</bold><bold><italic>lympho</italic></bold><bold>)</bold> (number of <inline-formula id="IEq39"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^3$$\end{document}</tex-math><mml:math id="M94"><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq39.gif"/></alternatives></inline-formula> lymphocytes per <inline-formula id="IEq40"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {mm}^3$$\end{document}</tex-math><mml:math id="M96"><mml:msup><mml:mtext>mm</mml:mtext><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq40.gif"/></alternatives></inline-formula>: in normal conditions it ranges from 1 to 4.8 cells/<inline-formula id="IEq41"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {mm}^3$$\end{document}</tex-math><mml:math id="M98"><mml:msup><mml:mtext>mm</mml:mtext><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq41.gif"/></alternatives></inline-formula>).<fig id="Fig1"><label>Fig. 1</label><caption><p>Multistate model of the DIVINE project</p></caption><graphic xlink:href="12874_2023_1951_Fig1_HTML" id="MO10"/></fig></p>
    <sec id="Sec9">
      <title>Data</title>
      <p id="Par51">The user can upload a new dataset, provided that it has the required format. The app allows to filter the data by some covariates and to work with a subset of the original data. An example dataset from the DIVINE project is available and for our case study, we filter the data to only consider patients from the fifth Spanish wave of the pandemic (July-August 2021, <inline-formula id="IEq42"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=690$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>690</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq42.gif"/></alternatives></inline-formula>).</p>
      <p id="Par52">The names of the states and covariates can be customized in the numerical and graphical outputs. To check if the data has been imported correctly and as a first exploration of the data, descriptive plots and tables of the covariates are shown to observe their distribution and their main summary statistics.</p>
    </sec>
    <sec id="Sec10">
      <title>Model specification</title>
      <p id="Par53">The first step is to define the model by specifying the states and transitions of the desired MSM. From the names of the columns of the dataset, the app identifies what are the states, and by drop-downs menus the user can select the transitions between them. It is important to only include those transitions relevants for the problem and with enough individuals passing through them so that the estimation of the associated parameters is feasible. In general, at least 5 events per covariate are needed in each transition, otherwise it is not possible to estimate the corresponding parameters [<xref ref-type="bibr" rid="CR13">13</xref>]. On the other hand, if one specific state does not need to be in the model, it is enough not to include it as part of any transition.</p>
      <p id="Par54">Figure <xref rid="Fig1" ref-type="fig">1</xref> shows the diagram of the defined model where there are two orange initial states (<italic>nopneum, pneum</italic>), three non-initial blue transient states (<italic>reco, nimv, imv</italic>) and two purple absorbing states (<italic>death, dcharg</italic>). The colors help to distinguish the different roles that each state plays into the model. Figure <xref rid="Fig2" ref-type="fig">2</xref> reveals the number of events for each transition, which is helpful to decide whether or not a specific transition should be included and to know how many covariates could be included in each transition [<xref ref-type="bibr" rid="CR14">14</xref>]. The number of events and individuals per transition are the same because <bold>MSMpred</bold> does not allow the inclusion of loops into the model that would permit an individual to pass twice through the same transition.</p>
      <p id="Par55">In the proposed﻿ model there are four transitions that have less than five individuals: <italic>nopneum</italic>
<inline-formula id="IEq43"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M102"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq43.gif"/></alternatives></inline-formula>
<italic>death</italic>, <italic>pneum</italic>
<inline-formula id="IEq44"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M104"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq44.gif"/></alternatives></inline-formula>
<italic>death</italic>, <italic>reco</italic>
<inline-formula id="IEq45"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M106"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq45.gif"/></alternatives></inline-formula>
<italic>death</italic> and <italic>nimv</italic>
<inline-formula id="IEq46"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M108"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq46.gif"/></alternatives></inline-formula>
<italic>death</italic>. Due to their small sample size we will not consider those transitions and we removed them from the model.</p>
      <p id="Par56">
        <fig id="Fig2">
          <label>Fig. 2</label>
          <caption>
            <p>Number of individuals per transition for the DIVINE MSM</p>
          </caption>
          <graphic xlink:href="12874_2023_1951_Fig2_HTML" id="MO11"/>
        </fig>
      </p>
      <p id="Par57">The <italic>covariates/time specification</italic> tab contains a table to be filled with potential covariates in columns and the transitions in rows to specify covariates for each transition. In this same tab, the follow-up time to be considered in the graphical representations and in the predictions can be specified. In our example, the follow-up time is fixed to 30 days, the period for which we are interested in the patient’s evolution.</p>
      <p id="Par58">Once all the model specification is finished, it is mandatory to click on the <italic>save model specification</italic> button to be applied in subsequent sections of the app.</p>
    </sec>
    <sec id="Sec11">
      <title>Exploring the data (EDA)</title>
      <p id="Par59">Box plots representing the length of stay in the initial or transient states of the model are a convenient tool, for uncensored data, to describe the distribution of these stays and to identify possible outliers before fitting the model. In Fig. <xref rid="Fig3" ref-type="fig">3</xref>, we can observe that the state with the highest median length of stay (<inline-formula id="IEq47"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$med=14 \; days$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>14</mml:mn><mml:mspace width="0.277778em"/><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq47.gif"/></alternatives></inline-formula>) is <italic>imv</italic>, while the other four initial/transient states (<italic>nimv, nopneum, pneum, reco</italic>) have lower and similar medians between them, all of them below 5. In our setting, it seems reasonable since <italic>imv</italic> is applied to patients in a critical situation that need longer times in that state to recover. Regarding to the outlier analysis, there are some patients that deserve more attention (e.g., a patient that has been in <italic>reco</italic> almost 100 days without being discharged).<fig id="Fig3"><label>Fig. 3</label><caption><p>Length of stay in the initial/transient states</p></caption><graphic xlink:href="12874_2023_1951_Fig3_HTML" id="MO12"/></fig></p>
      <p id="Par60">In reference to the absorbing states the cumulative incidence plot is provided. It is useful to visualize the rate at which patients enter those states and the chances of reaching them in a given time. We observe that in the fifth wave approximately <inline-formula id="IEq48"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5\%$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq48.gif"/></alternatives></inline-formula> of the hospitalized COVID-19 patients died.</p>
      <p id="Par61">Finally, a plot with a non-parametric estimation of the instantaneous hazards of the transitions is presented, where data can be stratified by a single covariate (e.g.,<italic>sex</italic>, Fig. <xref rid="Fig4" ref-type="fig">4</xref>). For the transitions starting from the state no severe pneumonia, we can observe that women have an increasing risk of going from <italic>nopneum</italic> to <italic>dcharg</italic>, while they have a decreasing risk for transition <italic>nopneum</italic>
<inline-formula id="IEq49"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M114"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq49.gif"/></alternatives></inline-formula>
<italic>pneum</italic>. In the case of men, they have a decreasing risk for transition <italic>nopneum</italic>
<inline-formula id="IEq50"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M116"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq50.gif"/></alternatives></inline-formula>
<italic>pneum</italic>, but the risk for transition <italic>nopneum</italic>
<inline-formula id="IEq51"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M118"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq51.gif"/></alternatives></inline-formula>
<italic>dcharg</italic> changes over time. So, we conclude that there are not relevant differences according to the sex, and the more marked one is associated to the transition <italic>nopneum</italic>
<inline-formula id="IEq52"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M120"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq52.gif"/></alternatives></inline-formula>
<italic>dcharg</italic>, particularly after the seventh day.<fig id="Fig4"><label>Fig. 4</label><caption><p>Exploring the data: instantaneous hazards stratified by sex</p></caption><graphic xlink:href="12874_2023_1951_Fig4_HTML" id="MO13"/></fig></p>
    </sec>
    <sec id="Sec12">
      <title>Model output</title>
      <p id="Par62">Markovian Cox models [<xref ref-type="bibr" rid="CR1">1</xref>] can be selected from the drop-down menu within the <bold>fitted model</bold> tab. Other models are postponed for future releases. The model is fitted including all the previously selected transition specific covariates. The transition specific covariate selection was done based on background knowledge. After fitting the model three tables are returned giving different information of the model (Fig. <xref rid="Fig5" ref-type="fig">5</xref>).<fig id="Fig5"><label>Fig. 5</label><caption><p>Tables of the fitted model</p></caption><graphic xlink:href="12874_2023_1951_Fig5_HTML" id="MO14"/></fig></p>
      <p id="Par63"><bold>1) Table of model coefficients</bold>. Each row represents a transition for a given covariate named in the first column of the table as <italic>covar (</italic><inline-formula id="IEq53"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \rightarrow l$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq53.gif"/></alternatives></inline-formula><italic>)</italic> where <italic>covar</italic> indicates the name of the covariate and <inline-formula id="IEq54"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \rightarrow l$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq54.gif"/></alternatives></inline-formula> the transition of interest. For each covariate and transition the estimated coefficient (<italic>coef</italic>), the estimated hazard ratio, its confidence interval (<italic>HR (95%CI)</italic>), and the <italic>p</italic>-value (<italic>p-value</italic>) to test <inline-formula id="IEq55"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{kl}=0$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq55.gif"/></alternatives></inline-formula> for the corresponding covariate are provided. Those values indicate which is the association level of the covariate <italic>covar</italic> on the risk of having a specific transition.</p>
      <p id="Par64"><bold>2) Table of likelihood</bold>. It contains the values of the log-likelihood of the fitted and the null model. If a null model is fitted, the values of both log-likelihoods match. This table also provides the Akaike Information Criteria (AIC) [<xref ref-type="bibr" rid="CR15">15</xref>] that allows to compare non-nested models.</p>
      <p id="Par65"><bold>3) Table of goodness of fit</bold>. The likelihood ratio, Wald, and score tests (<italic>test</italic>) are implemented to assess the goodness of fit of the proposed model versus the null model. For each test, the value of the statistic, the degrees of freedom (<italic>df</italic>) and the <italic>p</italic>-value are reported. These tests indicate whether or not the proposed model is more likely than the null model.</p>
      <p id="Par66">The estimated hazard ratios and their 95% confidence intervals are represented by forest plots to facilitate the interpretation of the risks associated with the different covariates in each transition. As the MSMs usually have too many coefficients, only the hazard ratios of the covariates related with a specific selected transition are shown. To accommodate covariates measured in different units, the user can scale the <italic>effect</italic> of any numerical covariate, for instance, by representing the risk related to 10-units change instead of 1 unit.</p>
      <p id="Par67">Figure <xref rid="Fig6" ref-type="fig">6</xref> reveals that <italic>psi</italic> and <italic>immune</italic> are the covariates that have an <italic>effect</italic> on transition <inline-formula id="IEq56"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textit{imv} \rightarrow \textit{death}$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mi mathvariant="italic">imv</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="italic">death</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq56.gif"/></alternatives></inline-formula>: the risk of transitioning from invasive mechanical ventilation to dying increases 1.25 times when the pneumonia severity index of the patient increases 10 units, and it increases 3.32 times for immunosuppressed patients compared to non-immunosuppressed patients. There is no evidence to claim that the other covariates have an influence among those patients that transition from invasive mechanical ventilation to dying.<fig id="Fig6"><label>Fig. 6</label><caption><p>Forest plot of the covariates related with the transition imv <inline-formula id="IEq57"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M130"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq57.gif"/></alternatives></inline-formula> death</p></caption><graphic xlink:href="12874_2023_1951_Fig6_HTML" id="MO15"/></fig></p>
      <p id="Par68">Some assumptions are made when fitting the Cox model and they should be evaluated for each transition after every preliminary fitting.</p>
      <p id="Par69">Linearity of the numerical covariates is the first assumption to be assessed using martingale-based residuals. The blue smoothed curve represents a non-parametric estimate of the trajectory of the points along the covariate values indicating whether it is reasonably linear or not. In the case of the covariate <italic>psi</italic> and transition <inline-formula id="IEq58"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textit{imv} \rightarrow \textit{death}$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:mi mathvariant="italic">imv</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="italic">death</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq58.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig7" ref-type="fig">7</xref>), this premise can be assumed.<fig id="Fig7"><label>Fig. 7</label><caption><p>Validation of the assumption of linearity of the psi continuous covariate in the transition imv <inline-formula id="IEq59"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M134"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq59.gif"/></alternatives></inline-formula> death</p></caption><graphic xlink:href="12874_2023_1951_Fig7_HTML" id="MO16"/></fig></p>
      <p id="Par70">The second assumption, absence of influential observations, is analysed by the dfbetas residuals. When there are no points quite far from the others, it suggest the lack of influential observations(see transition <inline-formula id="IEq60"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textit{imv} \rightarrow \textit{death}$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:mi mathvariant="italic">imv</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="italic">death</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq60.gif"/></alternatives></inline-formula> in Fig. <xref rid="Fig8" ref-type="fig">8</xref>).<fig id="Fig8"><label>Fig. 8</label><caption><p>Validation of the assumption of absence of influential observations of covariates related with the transition imv <inline-formula id="IEq61"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M138"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq61.gif"/></alternatives></inline-formula> death</p></caption><graphic xlink:href="12874_2023_1951_Fig8_HTML" id="MO17"/></fig></p>
      <p id="Par71">The last assumption, proportionality of the hazards, is assessed through the Schoenfeld residuals: the confidence bands of the smoothed curves should completely cover the line at 0. In Fig. <xref rid="Fig9" ref-type="fig">9</xref>, we see that this premise holds for transition <inline-formula id="IEq62"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textit{imv} \rightarrow \textit{death}$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:mi mathvariant="italic">imv</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="italic">death</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq62.gif"/></alternatives></inline-formula>.<fig id="Fig9"><label>Fig. 9</label><caption><p>Validation of the assumption of proportionality of the hazards of covariates related with the transition imv <inline-formula id="IEq63"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rightarrow$$\end{document}</tex-math><mml:math id="M142"><mml:mo stretchy="false">→</mml:mo></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq63.gif"/></alternatives></inline-formula> death</p></caption><graphic xlink:href="12874_2023_1951_Fig9_HTML" id="MO18"/></fig></p>
      <p id="Par72">As all the assumptions hold for transition <inline-formula id="IEq64"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textit{imv} \rightarrow \textit{death}$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:mi mathvariant="italic">imv</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="italic">death</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq64.gif"/></alternatives></inline-formula>, it is not necessary to go back and redefine the model fitting for this transition. But, before drawing conclusions or making predictions based on that model it is necessary to analyse every transition of the model.</p>
      <p id="Par73">As the fitted model will be used to predict, it is important to evaluate its global predictive performance. As the involved calculation has a high computational cost, this is only done on request by clicking the <italic>predictive performance</italic> button. Then, two tables will be showed: the first one returns the logarithmic score of the fitted model, while the second one represents the confusion matrix, containing the absolute frequencies according to the real (columns) and predicted (rows) states for a given follow-up time. Furthermore, a barplot representing the proportion of correct guesses for each state is provided.</p>
      <p id="Par74">In the <bold>model comparison</bold> tab, the information of each fitted model is stored in order to make possible their comparison. In addition, this information can be saved to be subsequently loaded in other session.</p>
    </sec>
    <sec id="Sec13">
      <title>Predictions</title>
      <p id="Par75">Predictions on new subjects as well as comparison of two subjects with different profiles are implemented in <bold>MSMpred</bold>. For instance, we want to contrast the evolution at 30 days of two hospitalized patients with non-invasive mechanical ventilation. They are both females, 80 years old, with a Charlson index and CURB-65 of 2, with a pneumonia severity index of 100, a C-reactive protein of 90 ng/ml and a safi and lymphocytes of 428.571 mmHg and <inline-formula id="IEq65"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.93 \times 10^3$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:mn>0.93</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq65.gif"/></alternatives></inline-formula> cells/<inline-formula id="IEq66"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {mm}^3$$\end{document}</tex-math><mml:math id="M148"><mml:msup><mml:mtext>mm</mml:mtext><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12874_2023_1951_Article_IEq66.gif"/></alternatives></inline-formula>, respectively. The first woman has cardiovascular as well as autoimmune diseases and she is not vaccinated against COVID-19. The second woman is vaccinated and does not have neither cardiovascular nor autoimmune diseases.</p>
      <p id="Par76">Once the profiles have been defined, we obtain the probability of being in each state after 30 days for each patient (Fig. <xref rid="Fig10" ref-type="fig">10</xref>), regardless of previously visited states. We can observe that the evolution of first patient is less optimistic with 65.1% probability of having left the hospital before day 30 and 32.2% probability of dying, while the second one has a better prognosis with a probability of discharge before day 30 of 77.3%.<fig id="Fig10"><label>Fig. 10</label><caption><p>Predictions of the probability of being in each state after 30 days for the two new patients</p></caption><graphic xlink:href="12874_2023_1951_Fig10_HTML" id="MO19"/></fig></p>
      <p id="Par77">Graphically, Fig. <xref rid="Fig11" ref-type="fig">11</xref> shows those percentages via transition probability plots, in a non-stacked or stacked way. Both versions give the probability of being in each state in a specific time point. In the case of the stacked plot, that probability is the height of the coloured section corresponding to the state of interest, while in the case of the non-stacked plot, it is directly the value of the curve of the state of interest.<fig id="Fig11"><label>Fig. 11</label><caption><p>Transition probability plots for the two new patients, the first in a non-stacked way and the second in a stacked way</p></caption><graphic xlink:href="12874_2023_1951_Fig11_HTML" id="MO20"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Discussion</title>
    <p id="Par78"><bold>MSMpred</bold> is a powerful tool to address a wide spectrum of problems. <bold>MSMpred</bold> can be used for modelling the course of any disease by means of MSM models (e.g., cancer, Alzheimer, fertility, chronic diabetic complications) with different degrees of severity. <bold>MSMpred</bold> is also appropriate in other fields outside the biomedical setting, for instance in multistate reliability assessment.</p>
    <p id="Par79"><bold>MSMpred</bold> allows to fit an MSM and to make predictions for new individuals in a friendly way providing several graphics that help interpreting those results.</p>
    <p id="Par80">Although other apps and packages to work with MSM exist, there are some unique characteristics of our app that make the difference. Regarding to the model definition, <bold>MSMpred</bold> does not limit the number of states or transitions: Furthermore, a diagram of the model is depicted while it is being specified. In order to build this diagram the number of states and transitions need to be taken into account. In addition, the user can delete transitions if by error a transition has been included or a transition is not needed. As seen, the covariates can be specified for each transition allowing a maximum level of detail in the model specification. Regarding visualization, several points are noteworthy. The instantaneous hazard plot, albeit common in this type of models, can be instantly obtained by specifying the ending/starting state of interest and also stratifying by some covariate. Furthermore, <bold>MSMpred</bold> shows the forest plot of the covariates related to the transition of interest. In relation to predictive performance, <bold>MSMpred</bold> provides outputs of the overall performance both for comparing models to each other (e.g., the logarithmic score) and more interpretable measures of accuracy for a single model (e.g., the confusion matrix). Finally, obtaining the validation graphics automatically allows the user to speed up model fitting with the corresponding saving of time in research work.</p>
    <p id="Par81"><bold>MSMpred</bold> is being constantly updated. In particular we are working on a new dataset including censored observations. We would also like to implement the option of including time-dependent covariates into the model, as well as allowing to fit other type of MSMs (e.g., non-Markov Cox models, semi-Markov models, parametric models). Finally, we are working in the development of a formal methodology to compare the goodness of fit of different MSMs.</p>
  </sec>
  <sec id="Sec15">
    <title>Conclusions</title>
    <p id="Par82"><bold>MSMpred</bold> is an R shiny app presenting useful tools for description, analysis, prediction and visualization of the different stages of a disease. <bold>MSMpred</bold> facilitates, in an interactive way, a better understanding of the potential paths along the states, of the risks associated to each transition and on the prognosis for a new subject. Non-experienced users might use <bold>MSMpred</bold> because is an intuitive and visual app and does not require neither programming skills nor advanced statistical knowledge. If needed, basic statistical knowledge on survival analysis can be obtained in classic references such as Klein [<xref ref-type="bibr" rid="CR16">16</xref>]. For a thorough monograph on Cox Model we suggest [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>MSM</term>
        <def>
          <p id="Par4">multistate model</p>
        </def>
      </def-item>
      <def-item>
        <term>DIVINE</term>
        <def>
          <p id="Par5">Dynamic evaluation of COVID-19 clinical states and their prognostic factors to improve the intra-hospital patient management</p>
        </def>
      </def-item>
      <def-item>
        <term>ICU</term>
        <def>
          <p id="Par6">Intensive Care Unit</p>
        </def>
      </def-item>
      <def-item>
        <term>NIMV</term>
        <def>
          <p id="Par7">Non-Invasive Mechanical Ventilation</p>
        </def>
      </def-item>
      <def-item>
        <term>IMV</term>
        <def>
          <p id="Par8">Invasive Mechanical Ventilation</p>
        </def>
      </def-item>
      <def-item>
        <term>
          <inline-formula id="IEq1">
            <alternatives>
              <tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \rightarrow l$$\end{document}</tex-math>
              <mml:math id="M150">
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                  <mml:mo stretchy="false">→</mml:mo>
                  <mml:mi>l</mml:mi>
                </mml:mrow>
              </mml:math>
              <inline-graphic xlink:href="12874_2023_1951_Article_IEq1.gif"/>
            </alternatives>
          </inline-formula>
        </term>
        <def>
          <p id="Par9">Direct transition from state <italic>k</italic> to state <italic>l</italic></p>
        </def>
      </def-item>
      <def-item>
        <term>HR</term>
        <def>
          <p id="Par10">Hazard ratio</p>
        </def>
      </def-item>
      <def-item>
        <term>LS</term>
        <def>
          <p id="Par11">Logarithmic score</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thanks the researchers that give us some feedback about the beta version of the app: Rui Alves, Mireia Besalú, Marta Bofill, Jacobo de Uña Álvarez, Daniel Fernández, Luís Filipe Meira Machado, Antoni Miñarro, Natàlia Pallarès, Pau Satorra, Albert Sorribas, Esteban Vegas, and Lore Zumeta.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>GGM had the original idea. LGB, JCM, and GGM designed the web tool. LGB wrote the first draft of the article. All authors substantively revised the submitted version. All authors have approved the submitted version. All authors have agreed both to be personally accountable for the author’s own contributions and to ensure that questions related to the accuracy or integrity of any part of the work.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This research was funded by the Ministerio de Ciencia e Innovación (Spain) [PID2019-104830RB-I00/ DOI (AEI): 10.13039/501100011033] and by Generalitat de Catalunya (2020PANDE00148).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The example dataset of the DIVINE project supporting the conclusions of this article is not available due to confidentiality reasons, but a modified example dataset is available in the Github repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/LeireGarmendia/MSMpred">https://github.com/LeireGarmendia/MSMpred</ext-link>. The detailed code of the app can be found in the same Github repository.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability and requirements</title>
    <p>Project name: MSMpred.</p>
    <p> Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.grbio.eu/pubs/MSMpred/">https://www.grbio.eu/pubs/MSMpred/</ext-link></p>
    <p> Operating system(s): Platform independent.</p>
    <p> Programming language: R.</p>
    <p> Other requirements: Any web browser.</p>
    <p> License: published under the GNU General Public License Version 2.</p>
    <p> Any restrictions to use by non-academics: Commercial organizations are welcome to contact the author prior to use.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par83">The study protocol associated with the example dataset was approved by the Ethics Committee of the Hospital Universitari de Bellvitge and all patients included into the study provide its informed consent to participate.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par84">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par85">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1. </label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meira-Machado</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>de Uña</surname>
            <given-names>Alvarez J</given-names>
          </name>
          <name>
            <surname>Cadarso-Suárez</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Andersen</surname>
            <given-names>PK</given-names>
          </name>
        </person-group>
        <article-title>Multi-state models for the analysis of time-to-event data</article-title>
        <source>Stat Methods Med Res.</source>
        <year>2009</year>
        <volume>18</volume>
        <issue>2</issue>
        <fpage>195</fpage>
        <lpage>222</lpage>
        <pub-id pub-id-type="doi">10.1177/0962280208092301</pub-id>
        <?supplied-pmid 18562394?>
        <pub-id pub-id-type="pmid">18562394</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2. </label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ursino</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dupuis</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Buetti</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multistate Modeling of COVID-19 Patients Using a Large Multicentric Prospective Cohort of Critically Ill Patients</article-title>
        <source>J Clin Med.</source>
        <year>2021</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>544</fpage>
        <pub-id pub-id-type="doi">10.3390/jcm10030544</pub-id>
        <?supplied-pmid 33540733?>
        <pub-id pub-id-type="pmid">33540733</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3. </label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mody</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lyons</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Vazquez Guillamet</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Clinical Course of Coronavirus Disease 2019 in a US Hospital System: A Multistate Analysis</article-title>
        <source>Am J Epidemiol.</source>
        <year>2021</year>
        <volume>190</volume>
        <issue>4</issue>
        <fpage>539</fpage>
        <lpage>552</lpage>
        <pub-id pub-id-type="doi">10.1093/aje/kwaa286</pub-id>
        <?supplied-pmid 33351077?>
        <pub-id pub-id-type="pmid">33351077</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4. </label>
      <mixed-citation publication-type="other">Stuart Lacy. MSM shiny. 2017. <ext-link ext-link-type="uri" xlink:href="https://stulacy.shinyapps.io/msm-shiny/">https://stulacy.shinyapps.io/msm-shiny/</ext-link>. Accessed 21 July 2022.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5. </label>
      <mixed-citation publication-type="other">Nikolaos Skourlis. MSMplus shiny. 2021. Available from: <ext-link ext-link-type="uri" xlink:href="https://nskbiostatistics.shinyapps.io/MSMplus/">https://nskbiostatistics.shinyapps.io/MSMplus/</ext-link>. Accessed 21 July 2022.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6. </label>
      <mixed-citation publication-type="other">Ryan Peterson. MSDshiny; 2019. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/petersonR/MSDshiny">https://github.com/petersonR/MSDshiny</ext-link>. Accessed 21 July 2022.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7. </label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cook</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Lawless</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <source>Multistate Models for the Analysis of Life History Data</source>
        <year>2018</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Chapman and Hall/CRC</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8. </label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Therneau</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Grambsch</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <source>Modeling Survival Data: Extending the Cox Model</source>
        <year>2000</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9. </label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Valliant</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Linear Regression Influence Diagnostics for Unclustered Survey Data</article-title>
        <source>J Off Stat.</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>1</issue>
        <fpage>99</fpage>
        <lpage>119</lpage>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10. </label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Wreede</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Fiocco</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Putter</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>mstate: An R Package for the Analysis of Competing Risks and Multi-State Models</article-title>
        <source>J Stat Softw.</source>
        <year>2011</year>
        <volume>38</volume>
        <issue>7</issue>
        <fpage>1</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v038.i07</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11. </label>
      <mixed-citation publication-type="other">Catoire P, Tellier E, de la Rivière C, Beauvieux MC, Valdenaire G, Galinski M, Revel P, Combes X, Gil-Jardiné C. Assessment of the SpO2/FiO2 ratio as a tool for hypoxemia screening in the emergency department. Am J Emerg Med. 2021;44:116-120.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12. </label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Charlson</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Pompei</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ales</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>MacKenzie</surname>
            <given-names>CR</given-names>
          </name>
        </person-group>
        <article-title>A new method of classifying prognostic comorbidity in longitudinal studies: development and validation</article-title>
        <source>J Chronic Dis.</source>
        <year>1987</year>
        <volume>40</volume>
        <issue>5</issue>
        <fpage>373</fpage>
        <lpage>383</lpage>
        <pub-id pub-id-type="doi">10.1016/0021-9681(87)90171-8</pub-id>
        <?supplied-pmid 3558716?>
        <pub-id pub-id-type="pmid">3558716</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13. </label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peduzzi</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Concato</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kemper</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Holford</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Feinstein</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>A simulation study of the number of events per variable in logistic regression analysis</article-title>
        <source>J Clin Epidemiol.</source>
        <year>1996</year>
        <volume>49</volume>
        <issue>12</issue>
        <fpage>1373</fpage>
        <lpage>1379</lpage>
        <pub-id pub-id-type="doi">10.1016/S0895-4356(96)00236-3</pub-id>
        <?supplied-pmid 8970487?>
        <pub-id pub-id-type="pmid">8970487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14. </label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vittinghoff</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>McCulloch</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>Relaxing the rule of ten events per variable in logistic and Cox regression</article-title>
        <source>Am J Epidemiol.</source>
        <year>2007</year>
        <volume>165</volume>
        <issue>6</issue>
        <fpage>710</fpage>
        <lpage>718</lpage>
        <pub-id pub-id-type="doi">10.1093/aje/kwk052</pub-id>
        <?supplied-pmid 17182981?>
        <pub-id pub-id-type="pmid">17182981</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15. </label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Akaike</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A new look at the statistical model identification</article-title>
        <source>IEEE Trans Autom Control.</source>
        <year>1974</year>
        <volume>19</volume>
        <issue>6</issue>
        <fpage>716</fpage>
        <lpage>723</lpage>
        <pub-id pub-id-type="doi">10.1109/TAC.1974.1100705</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16. </label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Moeschberger</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <source>Survival Analysis: Techniques for Censored and Truncated Data</source>
        <year>2003</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
