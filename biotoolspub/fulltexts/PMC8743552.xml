<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Microb Genom</journal-id>
    <journal-id journal-id-type="iso-abbrev">Microb Genom</journal-id>
    <journal-id journal-id-type="hwp">mgen</journal-id>
    <journal-id journal-id-type="publisher-id">mgen</journal-id>
    <journal-title-group>
      <journal-title>Microbial Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2057-5858</issn>
    <publisher>
      <publisher-name>Microbiology Society</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8743552</article-id>
    <article-id pub-id-type="pmid">34793294</article-id>
    <article-id pub-id-type="publisher-id">000689</article-id>
    <article-id pub-id-type="doi">10.1099/mgen.0.000689</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Articles</subject>
        <subj-group subj-group-type="heading">
          <subject>Pathogens and Epidemiology</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Comprehensive and accurate genetic variant identification from contaminated and low-coverage <italic toggle="yes">Mycobacterium tuberculosis</italic> whole genome sequencing data</article-title>
      <alt-title alt-title-type="recto-page-foot">
        <ext-link xlink:href="http://mgen.microbiologyresearch.org" ext-link-type="uri">http://mgen.microbiologyresearch.org</ext-link>
      </alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6237-3898</contrib-id>
        <name>
          <surname>Heupink</surname>
          <given-names>Tim H.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="cor1" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5647-5852</contrib-id>
        <name>
          <surname>Verboven</surname>
          <given-names>Lennert</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5741-7358</contrib-id>
        <name>
          <surname>Warren</surname>
          <given-names>Robin M.</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7666-3263</contrib-id>
        <name>
          <surname>Van Rie</surname>
          <given-names>Annelies</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <aff id="aff1"><label><sup>1</sup>​</label><institution content-type="department">Family Medicine and Population Health (FAMPOP)</institution>, <institution>Faculty of Medicine and Health Sciences, University of Antwerp</institution>, <addr-line content-type="city">Antwerp</addr-line>, <country>Belgium</country></aff>
      <aff id="aff2"><label><sup>2</sup>​</label><institution content-type="department">South African Medical Research Council Centre for Tuberculosis Research and DST/NRF Centre of Excellence for Biomedical Tuberculosis Research</institution>, <institution>Division of Molecular Biology and Human Genetics, Stellenbosch University</institution>, <addr-line content-type="city">Stellenbosch</addr-line>, <country>South Africa</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><bold>*Correspondence:</bold> Tim H. Heupink, <email xlink:href="mailto:tim.heupink@uantwerpen.be">tim.heupink@uantwerpen.be</email>
</corresp>
      <fn fn-type="accession-no">
        <p>Simulated sequencing data have been deposited in SRA BioProject PRJNA706121.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <!--PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>.-->
    <volume>7</volume>
    <issue>11</issue>
    <elocation-id>000689</elocation-id>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>09</day>
        <month>9</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 The Authors</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution NonCommercial License.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="mgen-7-0689.pdf"/>
    <abstract>
      <p>Improved understanding of the genomic variants that allow <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10886" ext-link-type="uri">Mycobacterium tuberculosis</ext-link></named-content></italic> (<italic toggle="yes">Mtb</italic>) to acquire drug resistance, or tolerance, and increase its virulence are important factors in controlling the current tuberculosis epidemic. Current approaches to <italic toggle="yes">Mtb</italic> sequencing, however, cannot reveal <italic toggle="yes">Mtb</italic>’s full genomic diversity due to the strict requirements of low contamination levels, high <italic toggle="yes">Mtb</italic> sequence coverage and elimination of complex regions. We have developed the XBS (compleX Bacterial Samples) bioinformatics pipeline, which implements joint calling and machine-learning-based variant filtering tools to specifically improve variant detection in the important <italic toggle="yes">Mtb</italic> samples that do not meet these criteria, such as those from unbiased sputum samples. Using novel simulated datasets, which permit exact accuracy verification, XBS was compared to the UVP and MTBseq pipelines. Accuracy statistics showed that all three pipelines performed equally well for sequence data that resemble those obtained from culture isolates of high depth of coverage and low-level contamination. In the complex genomic regions, however, XBS accurately identified 9.0 % more SNPs and 8.1 % more single nucleotide insertions and deletions than the WHO-endorsed unified analysis variant pipeline. XBS also had superior accuracy for sequence data that resemble those obtained directly from sputum samples, where depth of coverage is typically very low and contamination levels are high. XBS was the only pipeline not affected by low depth of coverage (5–10×), type of contamination and excessive contamination levels (&gt;50 %). Simulation results were confirmed using whole genome sequencing (WGS) data from clinical samples, confirming the superior performance of XBS with a higher sensitivity (98.8%) when analysing culture isolates and identification of 13.9 % more variable sites in WGS data from sputum samples as compared to MTBseq, without evidence for false positive variants when rRNA regions were excluded. The XBS pipeline facilitates sequencing of less-than-perfect <italic toggle="yes">Mtb</italic> samples. These advances will benefit future clinical applications of <italic toggle="yes">Mtb</italic> sequencing, especially WGS directly from clinical specimens, thereby avoiding <italic toggle="yes">in vitro</italic> biases and making many more samples available for drug resistance and other genomic analyses. The additional genetic resolution and increased sample success rate will improve genome-wide association studies and sequence-based transmission studies.</p>
    </abstract>
    <kwd-group>
      <kwd>bacteria</kwd>
      <kwd>contamination</kwd>
      <kwd>low coverage</kwd>
      <kwd>
        <italic toggle="yes">Mycobacterium tuberculosis</italic>
      </kwd>
      <kwd>sputum</kwd>
      <kwd>whole-genome sequencing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>fonds wetenschappelijk onderzoek</funding-source>
        <award-id>G0F8316N</award-id>
        <principal-award-recipient>AnneliesVan Rie</principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>OpenAccessEmbargo</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="s2">
    <title>Data Summary</title>
    <p>Simulated sequencing data have been deposited in SRA BioProject PRJNA706121. All detailed findings are available in the supplementary material. Supplementary material can be found in Figshare: <ext-link xlink:href="https://doi.org/10.6084/m9.figshare.17032835.v1" ext-link-type="uri">https://doi.org/10.6084/m9.figshare.17032835.v1</ext-link>. Scripts for running the XBS variant calling core are available on <ext-link xlink:href="https://github.com/TimHHH/XBS" ext-link-type="uri">https://github.com/TimHHH/XBS.</ext-link>
</p>
    <p>The authors confirm all supporting data, code and protocols have been provided within the article or through supplementary data files.</p>
    <boxed-text position="float">
      <caption>
        <title>Impact Statement</title>
      </caption>
      <p><italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10886" ext-link-type="uri">Mycobacterium tuberculosis</ext-link></named-content></italic> (<italic toggle="yes">Mtb</italic>) DNA is usually extracted from culture isolates to obtain high quantities of non-contaminated DNA, but this process can change the make-up of the bacterial population and is time-consuming. Furthermore, current analytical approaches exclude complex genomic regions where DNA sequences are repeated to avoid inference of false positive genetic variants, which may result in the loss of important genetic information. We have designed the compleX Bacterial Sample (XBS) variant caller to overcome these limitations. XBS employs joint variant calling and machine-learning-based variant filtering to ensure that high-quality variants can be inferred from low-coverage and highly contaminated genomic sequence data obtained directly from sputum samples. Simulation and clinical data analyses showed that XBS performs better than other pipelines as it can identify more genetic variants and can handle complex (low depth, highly contaminated) <italic toggle="yes">Mtb</italic> samples. The XBS pipeline was designed to analyse <italic toggle="yes">Mtb</italic> samples but can easily be adapted to analyse other complex bacterial samples.</p>
    </boxed-text>
  </sec>
  <sec sec-type="intro" id="s3">
    <title>Introduction</title>
    <p>Genetic approaches are increasingly being used in tuberculosis research and for the diagnosis of drug-resistant tuberculosis. Whole genome sequencing (WGS) of <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10886" ext-link-type="uri">Mycobacterium tuberculosis</ext-link></named-content></italic> (<italic toggle="yes">Mtb</italic>) aims to investigate the entire genome of the <italic toggle="yes">Mtb</italic> strain to comprehensively assess all known drug resistance-conferring regions, provide maximum resolution for genetic transmission studies, and investigate the role of genomic variants using genome-wide association studies [<xref rid="R1" ref-type="bibr">1</xref>]. The three key problems facing current <italic toggle="yes">Mtb</italic> WGS approaches are the need for high quantities of <italic toggle="yes">Mtb</italic> DNA, presence of contaminant bacterial and human DNA, and presence of complex regions in the <italic toggle="yes">Mtb</italic> genome.</p>
    <p><italic toggle="yes">Mtb</italic> is notoriously difficult to sequence directly from clinical samples because the DNA from human cells, bacteria and viruses outnumbers that from <italic toggle="yes">Mtb</italic> bacilli. This results in insufficient template <italic toggle="yes">Mtb</italic> DNA and low genomic depth of coverage when sequenced [<xref rid="R2" ref-type="bibr">2</xref>]. <italic toggle="yes">Mtb</italic> WGS therefore primarily uses cultured isolates, which requires a harsh decontamination step followed by a lengthy (2–4 weeks) incubation to generate large quantities of <italic toggle="yes">Mtb</italic>. The decontamination step not only reduces the presence of bacteria other than <italic toggle="yes">Mtb</italic>, but may also reduce the <italic toggle="yes">Mtb</italic> load [<xref rid="R3" ref-type="bibr">3</xref>]. The culture step can increase the presence of certain strains over others due to stochastic processes or when certain strains are better suited to growing in culture media [<xref rid="R4" ref-type="bibr">4, 5</xref>]. These processing steps thus result in a population bias, where the inferred <italic toggle="yes">in vitro Mtb</italic> population may not truly represent the <italic toggle="yes">in vivo</italic> population. To generate a rapid and unbiased result, <italic toggle="yes">Mtb</italic> would thus ideally be sequenced directly from the clinical sample.</p>
    <p>Despite decontamination, a small proportion of contaminants may persist in the DNA extracted from the culture isolate. Current <italic toggle="yes">Mtb</italic> bioinformatic pipelines use <italic toggle="yes">in silico</italic> meta-genomic classification software to identify these contaminants and exclude samples with a high proportion of contaminant DNA. For example the unified analysis variant pipeline (UVP) uses a cut-off maximum of 10 % contamination [<xref rid="R6" ref-type="bibr">6</xref>], which may exclude valuable samples from analysis. In addition to the low contamination threshold, the <italic toggle="yes">Mtb</italic> community has adopted relatively high standards for genome coverage, with 30× to 50× and up to 100× depth being the most commonly used. A Poisson distribution, however, reveals that a mean depth of coverage of 15.8× results in 95 % of the genome being covered by 10× or more reads [<xref rid="R7" ref-type="bibr">7</xref>], which should be sufficient for accurately calling majority variants in a haploid genome.</p>
    <p>A third problem that complicates <italic toggle="yes">Mtb</italic> WGS is the abundance of complex regions including repeats, transposons, duplicates and phage genes, and the numerous PE/PPE genes. These complex regions are generally excluded from analyses by <italic toggle="yes">Mtb</italic> pipelines. The core genome multi-locus sequence typing (cgMLST) method goes even further as only the most trusted regions are analysed [<xref rid="R8" ref-type="bibr">8</xref>]. While these strategies ensure the accuracy of the genome assembly and variant calling, they can result in the loss of a significant proportion of genomic information (~9 % when using the UVP [<xref rid="R6" ref-type="bibr">6</xref>]), which may be important for defining transmission events and identification of variants that affect pathogenicity.</p>
    <p>There is thus a need for novel bioinformatics tools that overcome the current requirements of low contamination, high <italic toggle="yes">Mtb</italic> DNA sequence coverage and exclusion of complex genomic regions [<xref rid="R9" ref-type="bibr">9</xref>]. The Genome Analysis ToolKit (GATK), originally designed for human genome studies (i.e. diploid), now allows for processing of haploid genomes such as that of <italic toggle="yes">Mtb</italic>. The Base Quality Score Recalibration and Indel Realigner tools and single sample variant calling using the now superseded Unified Genotyper tool have already been applied in <italic toggle="yes">Mtb</italic> genome studies [<xref rid="R6" ref-type="bibr">6, 10</xref>]. GATK’s ‘Germline short variant discovery Best Practices workflow’, however, includes joint genotyping and machine-learning-based variant filtering and has seen little to no implementation in bacterial and <italic toggle="yes">Mtb</italic> genome assembly pipelines. The major advantage of joint variant calling, as opposed to single sample variant calling, is a greater sensitivity for variants at low frequency in the population and detection of variants in low-coverage samples for which there would be insufficient confidence if the sample had been analysed on its own [<xref rid="R11" ref-type="bibr">11</xref>]. Joint variant calling also enables the calculation of various statistical annotations (including depth of coverage, strand bias and read mapping quality) for alleles in the population rather than for those in a single strain. These population variants are more numerous and their annotations suffer from fewer stochastic deviations, thereby improving subsequent variant filtering. The machine-learning-based variant filtering (VQSR) in GATK [<xref rid="R12" ref-type="bibr">12</xref>] eliminates the need for hard-filtering of variants, which is commonly applied through the use of rather arbitrary cut-offs for strand bias and coverage depth.</p>
    <p>We hypothesize that GATK’s tools are suitable for distinguishing contaminant variants from <italic toggle="yes">Mtb</italic> and to score and identify variants in complex regions of the <italic toggle="yes">Mtb</italic> genome. We developed a novel <italic toggle="yes">Mtb</italic> pipeline integrating GATK’s tools to improve the identification of genetic variants in less-than-perfect <italic toggle="yes">Mtb</italic> samples and thereby greatly increase our power to capture the diversity of within-patient and within-bacterial genetic information. We also tested the variant calling core of this pipeline for its accuracy to identify genetic variants in comparison to existing pipelines.</p>
  </sec>
  <sec sec-type="methods" id="s4">
    <title>Methods</title>
    <sec id="s4-1">
      <title>Development of the XBS pipeline</title>
      <p>The XBS pipeline was designed to perform analyses of Illumina FASTQ sequence data. The pipeline was primarily designed to analyse <italic toggle="yes">Mtb</italic> samples but can easily be adapted to analyse other complex bacterial samples. XBS was realized through coupling published software packages with custom Bash and Python scripts.</p>
      <p>Pipelines typically start with identifying the level of contaminants and/or removing contaminants before mapping the sequence reads. In XBS, all FASTQ sequence data, whether single read or paired-end, are directly mapped to the reference genome (H37Rv: NC_000962.3), however, using BWA mem [<xref rid="R13" ref-type="bibr">13</xref>] (<xref rid="F1" ref-type="fig">Fig. 1</xref>). XBS does not employ an adapter trimming step because BWA mem locally aligns sequence reads, which masks the portions of the read that do not align well with the reference genome. Skipping the step of removing contaminants saves considerable computing time but does require sophisticated downstream variant filtering to distinguish genuine <italic toggle="yes">Mtb</italic> variants from those introduced by contaminants.</p>
      <fig position="float" fig-type="figure" id="F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Flow chart for XBS’s variant calling core.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g001" position="float"/>
      </fig>
      <p>Next, the mapped sequence library is merged with other independently mapped sequence libraries from the same sample using Samtools (<ext-link xlink:href="https://www.htslib.org/" ext-link-type="uri">https://www.htslib.org/</ext-link>). GATK's MarkDuplicates (Picard) is then used to mark duplicated reads in the merged bam file. Unlike other <italic toggle="yes">Mtb</italic> pipelines XBS does not employ Base Quality Score Recalibration (BQSR) to avoid variants in contaminant DNA being interpreted as systematic errors by BQSR, which would result in reduced base qualities, including for genuine <italic toggle="yes">Mtb</italic> variants.</p>
      <p>The mapped sequences are then locally reassembled to correctly identify possible haplotypes and their variants using GATK HaplotypeCaller. At this point, the statistics of depth of coverage, breadth of coverage, multiple infection and level of non-tuberculous mycobacteria (NTM) contamination are assessed to judge if a sample is suitable for subsequent joint variant calling. Coverage statistics are inferred using GATK's CollectWgsMetrics (Picard). Quality approved samples’ Genomic Variant Call Format (GVCF) files are then merged with GATK's CombineGVCFs and the genotypes are joint called using GATK's GenotypeGVCFs. This results in a VCF file with the unfiltered variants for all quality approved samples. GATK is run with a ploidy of 1 for the variant calling processes so that the allele with the highest confidence is identified as the allele representing the haploid genotype for each variant site.</p>
      <p>Next, the machine-learning-based variant filtering (VQSR) in GATK is employed to identify the probable true variants [<xref rid="R12" ref-type="bibr">12</xref>]. This step requires a truth set of variants known to occur in <italic toggle="yes">Mtb</italic>, which can for example consist of Drug Resistance (DR) conferring mutations. SNPs and insertions and deletions (INDELs) are processed separately for variant filtering. The annotated statistics calculated during the genotyping are used to build a positive statistical model for the variants in the dataset that also occur in the truth set. Similarly, a negative variant model is built for the variants with the worst annotated statistics. The remaining variants not consulted for either the positive or the negative model construction are then confidence scored according to the placement of their annotated statistics in relation to these models. To identify as many variants as possible, variants are then filtered by applying a target sensitivity of 99.9%, calculated as the percentage of identified variants from the present truth-set variants. The filtered SNP and INDEL VCFs are then further processed as appropriate for constructing annotated phylogenies and inferences of multiple infection, drug (hetero-)resistance, lineage and transmission clusters.</p>
    </sec>
    <sec id="s4-2">
      <title><italic toggle="yes">In silico</italic> development of a simulated dataset</title>
      <p>A dataset of 1200 simulated samples representing 50 000 SNPs, 2500 insertions and 2500 deletions was developed (<xref rid="F2" ref-type="fig">Fig. 2</xref>). Of these, 600 were designed to resemble WGS data from mono-culture isolates and 600 to resemble WGS data obtained directly from sputum samples, the latter including high levels of various contaminants.</p>
      <fig position="float" fig-type="figure" id="F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Flow chart for dataset construction.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g002" position="float"/>
      </fig>
      <p>First, a set of 50 simulated strains with the exact mutations known with respect to the reference genome was created <italic toggle="yes">in silico</italic> using SNP Mutator v.1.2.0 [<xref rid="R14" ref-type="bibr">14</xref>]. Each simulated genome was created by randomly introducing 1000 SNPs, 50 single nucleotide insertions and 50 single nucleotide deletions in H37Rv (NC_000962.3). Multi-nucleotide INDELs could not be introduced using the SNP Mutator software. SNPs and INDELs were introduced randomly throughout each simulated strain genome to ensure that random bases were affected and/or introduced and to create genetically varying strains. GATK's LeftAlignAndTrimVariants was used so that the truth set's INDELs were in the standard notation.</p>
      <p>For each dataset, 100 strains were randomly drawn from the 50 simulated strains to ensure that some strains and their variants occurred more than once, as would be the case for clinical datasets where specific strains and drug resistance variants often occur more than once. To simulate WGS data obtained from culture isolates, six datasets representing 5×, 10×, 20×, 30×, 50× or 100× depth were generated using 100 randomly drawn simulated strains each (<xref rid="F2" ref-type="fig">Fig. 2</xref>). In order to investigate the impact of low-level contamination, no or low-level contamination (0, 1, 2, 3, 4 or 5%) and contamination type was randomly assigned to each of the simulated strains. The eight contamination types used were <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.6366" ext-link-type="uri">Mycobacterium intracellulare</ext-link></named-content></italic> (NC_016946.1), <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.6313" ext-link-type="uri">Mycobacterium abscessus</ext-link></named-content></italic> (NC_010397.1, including plasmid), <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10879" ext-link-type="uri">Mycobacterium avium</ext-link></named-content></italic> (NC_002944.2), the three most common NTM, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.2553" ext-link-type="uri">Pseudomonas aeruginosa</ext-link></named-content></italic> (NC_002516.2) and <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">Staphylococcus epidermidis</ext-link></named-content></italic> (NC_004461.1), <italic toggle="yes">Homo sapiens</italic> (GRCh38), a mixture of the three NTM (<italic toggle="yes">M. intracellulare, M. abcessus</italic> and <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10879" ext-link-type="uri">M. avium</ext-link></named-content></italic>) and a mixture of all six contaminants. Because it was not possible to represent the full diverse spectrum of contaminating bacteria in the simulations, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.2553" ext-link-type="uri">P aeruginosa</ext-link></named-content></italic> and <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic> were selected as these are the most common bacterial contaminants [<xref rid="R2" ref-type="bibr">2</xref>], and NTMs were included because these pose a serious challenge for <italic toggle="yes">Mtb</italic> variant calling. The simulated samples included no or low-level contamination in order to resemble WGS data from culture isolates and to be able to investigate the effect of the various low levels of such contamination. Simulated contaminant sequence reads were added to the simulated <italic toggle="yes">Mtb</italic> reads so that the final contamination level matched the assigned contamination percentage.</p>
      <p>ART v.2.5.8 software [<xref rid="R15" ref-type="bibr">15</xref>] was then used to emulate Illumina 150 bp paired-end sequence reads with an HiSeq error profile and a Poisson distributed 300 bp average library insert size for each simulated strain and its contaminant(s). In total, 600 cultured WGS samples were generated in six datasets of 100 simulated samples with each dataset representing a different level of coverage (5, 10, 20, 30, 50 or 100× depth) to allow assessment of the relationship between coverage and accuracy of variant identification.</p>
      <p>To simulate <italic toggle="yes">Mtb</italic> WGS data obtained directly from sputum samples, another six datasets were generated, each with a set number of paired-end sequence reads per sample, ranging from 500 000 to 3 000 000 paired-end reads (<xref rid="F2" ref-type="fig">Fig. 2</xref>). <italic toggle="yes">Mtb</italic> and contamination levels were randomly sampled from a beta distribution around 0.01–78.63% <italic toggle="yes">Mtb</italic> DNA to match levels observed for direct-from-sputum WGS data [<xref rid="R9" ref-type="bibr">9</xref>]. The contamination type was either <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.2553" ext-link-type="uri">P. aeruginosa</ext-link></named-content></italic>, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic>, <italic toggle="yes">H. sapiens,</italic> a mixture of <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.2553" ext-link-type="uri">P. aeruginosa</ext-link></named-content></italic>, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic> and <italic toggle="yes">H. sapiens,</italic> or an NTM mixture (<italic toggle="yes">M. intracellulare, M. abcessus</italic> or <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10879" ext-link-type="uri">M. avium</ext-link></named-content></italic> up to 20 % of the <italic toggle="yes">Mtb</italic> fraction with the remaining contamination consisting of <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.2553" ext-link-type="uri">P. aeruginosa</ext-link></named-content></italic>, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic> or <italic toggle="yes">H. sapiens</italic>).</p>
      <p>ART v.2.5.8 software [<xref rid="R15" ref-type="bibr">15</xref>] was used as described previously to emulate sequence reads for each simulated strain and its contaminant(s). In total, 600 simulated WGS data directly from sputum samples were generated in six datasets of 100 simulated samples, each dataset representing a number of paired-end sequence reads and had various levels and types of contamination, allowing us to study the relationship between contaminant nature, read number and variant identification.</p>
    </sec>
    <sec id="s4-3">
      <title>Assessment of XBS pipeline performance</title>
      <p>The performance of XBS was compared to UVP [<xref rid="R6" ref-type="bibr">6</xref>] and MTBseq [<xref rid="R16" ref-type="bibr">16</xref>], two well-established and commonly used <italic toggle="yes">Mtb</italic> pipelines. Each pipeline was evaluated using their standard settings. For UVP, variants in the GATK filtered VCF file were used for accuracy calculations. For MTBseq, two approaches were assessed. In ‘MTBseq-basic’, the ‘GATK position variants’ file was used for calculations of accuracy. In ‘MTBseq-exrep’, the variants marked ‘repetitive’ in MTBseq’s ‘MTB_Gene_Categories.txt’ were excluded to assess the effect of this commonly applied filtering step. From here on, XBS, UVP and the two MTBseq approaches will be referred to as pipelines.</p>
      <p>For XBS, VQSR was run with a truth set consisting of 5000 SNPs, 250 insertions and 250 deletions randomly selected from the mutations known to occur in the 50 simulated strains. The truth set therefore represented 10 % (5 500/55 000) of the total variants introduced <italic toggle="yes">in silico</italic>. GATKs VariantRecalibrator was run to score each SNP according to the inferred positive and negative models, built on the depth, mapping quality, mapping quality rank-sum and quality by depth statistical annotations. These annotations were processed in an allele-specific fashion to distinguish between genuine and contaminant variants occurring at the same genomic location. Annotations that showed insufficient variance, as determined by VQSR, were excluded. A logit transform and jitter were applied to improve mapping quality-based filtering. The FS, ReadPosRanksum and SOR annotations were excluded because they are more applicable for real sequence data than for simulated data. Where possible, four Gaussians were used for the positive model. GATK's ApplyVQSR was applied with a truth sensitivity level of 99.9 %. The same process was followed for INDELs except that allele specificity was disabled and, where possible, two Gaussians were used for the positive model. The MQ annotation was not taken into consideration following the GATK Best Practices Workflow for Germline short variant discovery. To avoid over-representation of contaminant alleles in the filtered dataset, INDELs in the sputum simulations were filtered using a VQSLOD score of 0 rather than a truth sensitivity level. This ensures that only those INDELs that are most likely to fall in the positive and not the negative model are kept. The resulting SNP and INDEL variants were used for the accuracy calculations. Version 4.1.9.0 of GATK was used.</p>
      <p>The six datasets simulating WGS from culture were analysed using all four pipelines (XBS, MTBseq-basic, MTBseq-exrep, UVP). The six datasets simulating WGS from sputum samples came only from three pipelines as UVP cannot analyse samples with contamination exceeding 10 %. The inferred variants identified by each pipeline were compared with the truth in terms of genome position and allelic nature (bases involved and length). The pipeline’s accuracy was calculated in terms of precision, recall and harmonic mean (F<sub>1</sub> score).</p>
      <p>For simulation of WGS from culture isolates, accuracy scores were averaged over the 100 samples in each dataset and calculated for each combination of variant type (SNP or INDEL) and genomic region (complete, complex or non-complex). F<sub>1</sub> scores were plotted for the four pipelines at six levels of depth for the complete genome, and for complex and non-complex regions separately. UVP’s list of excluded loci was used to define regions as complex, and these were filtered using GATK's SelectVariants.</p>
      <p>For simulation of WGS from sputum, the range of F<sub>1</sub> scores was calculated, separately for SNPs and INDELs, and the proportion of samples with an F<sub>1</sub> score &gt;0.9 was estimated. The number of <italic toggle="yes">Mtb</italic> reads was converted to the theoretical depth of coverage (number of simulated <italic toggle="yes">Mtb</italic> reads multiplied by average read length) and plotted against F<sub>1</sub> scores for each pipeline, contamination level and type after excluding samples with a theoretical coverage of &lt;20× so that the lesser performance of such samples did not distort these figures.</p>
      <p>Plots were created in R using the ggplot2 and gridExtra packages.</p>
    </sec>
    <sec id="s4-4">
      <title>Analysis of WGS from clinical samples</title>
      <p>The performance of the XBS variant caller was examined using two published WGS datasets obtained from clinical samples and compared to UVP and MTBseq. Data published by Roetzer <italic toggle="yes">et al</italic>. [<xref rid="R17" ref-type="bibr">17</xref>] were used to test the pipelines’ sensitivity by identifying a set of known variants (Sanger-confirmed) in DNA extracted from cultured <italic toggle="yes">Mtb</italic> samples. Data from Goig <italic toggle="yes">et al</italic>. [<xref rid="R9" ref-type="bibr">9</xref>] were used to evaluate the ability to call variants in WGS data from DNA extracted directly from sputum. Only samples with ≥5× genomic coverage depth (S02, S26, S17, S21, S31, S20, S27, S67, S09 and S69) were analysed to ensure sufficient width of coverage and prevent problems with phylogenetic inference. A reference set of 125 diverse cultured <italic toggle="yes">Mtb</italic> strains with high coverage WGS data was included in the analyses to provide a reference in the phylogenetic tree and increase the variation in statistical annotations, thereby improving VQSR for XBS. XBS VQSR was run in SNP mode with a truth-set containing lineage and DR variants [<xref rid="R18" ref-type="bibr">18–20</xref>]. These variants reflect the diversity of the bacterium (<italic toggle="yes">Mtb</italic> lineages) and the entirety of the genome, enabling VQSR to build a model to identify variants in exactly such regions and as such avoid bias. The variants from the Goig <italic toggle="yes">et al</italic>. and reference datasets were converted to FASTA format, where positions represented by fewer than 95 % of the samples were excluded. MTBseq and UVP were run in default mode.</p>
      <p>IQ-TREE v2.1.2 was used to construct maximum-likelihood trees [<xref rid="R21" ref-type="bibr">21</xref>], which were plotted with Figtree v1.4.3 [<xref rid="R22" ref-type="bibr">22</xref>], and the resulting branch lengths were used to evaluate the potential presence of false positive variants.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="s5">
    <title>Results</title>
    <sec id="s5-1">
      <title>Pipeline performance for analysis of WGS data from simulated culture isolates</title>
      <p>At the highest coverage (100×) and with the low levels of contamination (≤5 %), all pipeline approaches detected very few false positives and missed few variants, resulting in a 100 % precision for SNPs and INDELs across the genome, except for UVP which obtained a slightly lower precision of 98 % for SNP calling (<xref rid="T1 T2" ref-type="table">Tables 1 and 2</xref>). Recall scores were highest for XBS and MTBseq-basic (97–99 % for the SNPs and INDELs) compared to MTBseq-exrep and UVP which missed some variants (92 % for SNPs and 91 % for INDELs by MTBseq-exrep; 90 % for SNPs and 89 % for INDELs by UVP). The overall variant calling accuracy was highest for XBS and MTBseq-basic (F<sub>1</sub> score 0.99 for SNPs, ≥0.98 for INDELs), somewhat lower for MTBseq-exrep (F<sub>1</sub> score 0.96 for SNPs, 0.95 for INDELs) and lowest for UVP (F<sub>1</sub> score 0.94 for SNPs and INDELs) (<xref rid="F3" ref-type="fig">Fig. 3</xref>). At 100× coverage MTBseq-basic identified an average 9.2 % more true positive SNPs and 9.8 % more INDELS per genome when compared to UVP (<xref rid="T1 T2" ref-type="table">Tables 1 and 2</xref>). XBS identified an average 9.0 % more true positive SNPs and 8.1 % more INDELs per genome when compared to UVP at 100× coverage.</p>
      <fig position="float" fig-type="figure" id="F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Performance (F<sub>1</sub> scores) of four bioinformatic pipelines for SNP calling in simulated <italic toggle="yes">Mtb</italic> culture isolates at six levels of depth of <italic toggle="yes">Mtb</italic> genomic coverage.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g003" position="float"/>
      </fig>
      <table-wrap position="float" id="T1">
        <label>Table 1.</label>
        <caption>
          <p>SNP calling accuracies across the entire genome for four <italic toggle="yes">Mtb</italic> pipelines</p>
          <p><sc>na</sc>, Not applicable.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" valign="top" rowspan="1" colspan="1"/>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>XBS</p>
              </th>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>MTBseq-basic</p>
              </th>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>MTBseq-exrep</p>
              </th>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>UVP</p>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Simulated dataset</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Rrecall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV5</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.93</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.88</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.05</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.10</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.86</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.05</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.09</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.03</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.06</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV10</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.69</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.49</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.66</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.48</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.64</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV20</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.97</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.90</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.91</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>81</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV30</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.92</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.90</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.93</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>89</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV50</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.92</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.90</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.93</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>91</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.92</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.90</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>99</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM0500K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.79</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.60</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.63</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>49</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.44</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.29</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.32</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>20</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.44</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.27</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.31</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>15</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM1000K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.83</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.72</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.73</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>65</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.37</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.40</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>25</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.34</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>21</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM1500K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.93</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.70</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.75</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>58</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.54</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.46</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.47</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.43</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.45</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>33</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM2000K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.76</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.78</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>72</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.56</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>41</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.56</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.49</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.51</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>30</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM2500K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.90</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.79</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.81</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>71</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.67</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.62</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.61</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.66</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.57</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.59</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>45</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM3000K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.81</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.84</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>77</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.62</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.59</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.58</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>43</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.62</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.55</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.56</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>37</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="float" id="T2">
        <label>Table 2.</label>
        <caption>
          <p>INDEL calling accuracies across the entire genome for four <italic toggle="yes">Mtb</italic> pipelines</p>
          <p>na, Not applicable.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" valign="top" rowspan="1" colspan="1"/>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>XBS</p>
              </th>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>MTBseq-basic</p>
              </th>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>MTBseq-exrep</p>
              </th>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>UVP</p>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Simulated dataset</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Pecision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV5</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.91</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.88</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.05</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.10</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.86</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.05</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.09</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.03</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.06</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV10</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.50</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.66</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.46</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.63</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.48</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.64</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV20</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.97</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>99</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV30</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.97</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.91</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>99</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV50</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.97</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.91</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>95</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.97</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.91</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>98</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM0500K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.73</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.57</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.61</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>47</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.46</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.28</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.32</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>21</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.46</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.27</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.31</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>16</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM1000K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.88</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.70</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.74</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>67</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.56</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.36</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.40</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>28</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.55</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.34</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>27</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM1500K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.86</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.67</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.73</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>57</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.55</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.45</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.48</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>41</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.55</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.42</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.46</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>40</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM2000K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.87</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.68</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.74</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>62</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.64</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.52</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.55</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>45</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.64</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.48</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>40</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM2500K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.91</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.75</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.79</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>70</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.70</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.61</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.63</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>58</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.70</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.57</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.60</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM3000K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.86</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.79</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.81</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>73</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.69</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.58</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.61</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>47</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.69</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.54</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.59</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>45</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Lowering the depth of <italic toggle="yes">Mtb</italic> genome coverage from 100× to 20× had minimal effect on accuracy scores. XBS’s precision and recal did not change and the F<sub>1</sub> score deviated by ≤0.01 for SNPs and INDELs. The performance of MTBseq-basic and MTBseq-exrep also did not differ for these lower coverages, with similar precision for SNPs and INDELs, a drop in recall by 2 % for SNPs and 3 % for INDELs, and the F<sub>1</sub> score lowered by 0.01 for both SNPs and INDELs. UVP’s accuracy statistics did not change for INDELs, but precision, recall and F<sub>1</sub> score for SNPs dropped slightly by 4%, 1 % and 0.01, respectively.</p>
      <p>At depths ranging from 20× to 100×, the performance for SNP and INDEL calling in the non-complex regions of the <italic toggle="yes">Mtb</italic> genome was high for all four pipelines (<xref rid="F4" ref-type="fig">Fig. 4</xref> and Table S1, available in the online version of the article). Performance for variant calling in the complex regions was similar for MTBseq-basic and XBS, with an average SNP and INDEL precision of 100%, recall around 91 % and F<sub>1</sub> around 0.95. Accuracy statistics for variant calling in the complex regions could not be calculate for UVP as complex regions are excluded from from its standard output. MTBseq-exrep’s exclusion of repetitive regions was less strict than UVP’s excluded loci and hence the former was able to identify a small number of variants in the complex regions.</p>
      <fig position="float" fig-type="figure" id="F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Performance (F<sub>1</sub> scores) of four bioinformatic pipelines for SNP calling in simulated <italic toggle="yes">Mtb</italic> culture isolates at six levels of depth of <italic toggle="yes">Mtb</italic> genomic coverage, stratified by complex and non-complex regions of the genome.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g004" position="float"/>
      </fig>
      <p>At 10× depth of coverage, all four pipelines retained their precision but recall was affected. UVP and both MTBseq approaches missed many variants, resulting in a recall of around 50 % for SNPs and INDELs. Consequently, F<sub>1</sub> scores dropped drastically for MTBseq-basic (0.69 for SNPs and 0.66 for INDELs), MTBseq-exrep (0.66 for SNPs and 0.63 for INDELs) and UVP (0.64 for both SNPs and INDELs). In contrast, XBS’s accuracy remained high, with recall at 99 % for SNPs and 98 % for INDELs and F<sub>1</sub> scores of 0.99 for SNPs and INDELs (<xref rid="F3" ref-type="fig">Fig. 3</xref>). Only at an <italic toggle="yes">Mtb</italic> genome coverage of 5× was the performance of XBS noticeably affected, although performance remained largely accurate, with F<sub>1</sub> scores of 0.96 for SNPs and 0.95 for INDELs, a precision of 100 % for both, and recall of 93 % for SNPs and 91 % for INDEL calling. XBS’s ability to call variants in both low-coverage and complex regions was retained (<xref rid="F4" ref-type="fig">Fig. 4</xref>).</p>
      <p>The type of low-level contaminant (<italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.6366" ext-link-type="uri">M. intracellulare</ext-link></named-content></italic>, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.6313" ext-link-type="uri">M. abscessus</ext-link></named-content></italic>, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10879" ext-link-type="uri">M. avium</ext-link></named-content></italic>, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.2553" ext-link-type="uri">P. aeruginosa</ext-link></named-content></italic>, <italic toggle="yes">S. epidermidis, H. sapiens</italic>, NTM mixture or mixture of all six contaminants) only affected the F<sub>1</sub> estimates of UVP due to false positive SNP calls when NTMs or <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic> were present (Fig. S1 and Table S1). The level of contamination (varying from 0 to 5 %) also only affected UVP’s performance, with a decrease in precision and SNP F<sub>1</sub> scores at higher levels of contamination (Fig. S2 and Table S1).</p>
    </sec>
    <sec id="s5-2">
      <title>Pipeline performance for analysis of WGS data from simulated sputum samples</title>
      <p>XBS outperformed both MTBseq approaches when analysing the data simulated to represent WGS directly from sputum. For SNPs, F<sub>1</sub> scores ranged from 0.63 to 0.84 for XBS compared to 0.33–0.58 for MTBseq-basic and 0.31–0.59 for MTBseq-exrep. Using XBS, 49–77 % of samples achieved F<sub>1</sub> scores above 0.90, compared to 20–53% and 15–45 % for MTBseq-basic and MTBseq-exrep, respectively (<xref rid="T1 T2" ref-type="table">Tables 1 and 2</xref>). For INDELs F<sub>1</sub> scores ranged from 0.61 to 0.81 for XBS, 0.32 to 0.63 for MTBseq-basic and 0.31 to 0.60 for MTBseq-exrep. Using XBS, 47–73 % of samples achieved F<sub>1</sub> scores above 0.9, compared to 21–58 % and 16–53 % for MTBseq-basic and MTBseq-exrep, respectively. Plotting the theoretical depth of coverage against F<sub>1</sub> score showed that XBS calls SNPs and INDELs with higher accuracy at low genomic depth of coverage compared to both MTBseq approaches (<xref rid="F5" ref-type="fig">Fig. 5</xref>).</p>
      <fig position="float" fig-type="figure" id="F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Performance (F<sub>1</sub> scores) of different bioinformatic pipelines for SNP and INDEL calling from contaminated sputum samples at various levels of theoretical depth of <italic toggle="yes">Mtb</italic> genomic coverage.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g005" position="float"/>
      </fig>
      <p>SNP accuracy of XBS was unaffected by contamination level or type (<xref rid="F6" ref-type="fig">Fig. 6</xref>). In contrast, accuracy for MTBseq-basic and MTBseq-exrep depended on the type and level of contamination. <italic toggle="yes">H. sapiens</italic> contamination did not affect the F<sub>1</sub> score, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic> lowered the F<sub>1</sub> score to 0.90 when the contamination level was ≥50 %, and NTM and bacterial/human contamination mixtures reduced the F<sub>1</sub> score when the contamination level was ≥75 %. For INDELs, the MTBseq-basic pipeline performed slightly better than XBS when <italic toggle="yes">Mtb</italic> depth of coverage was ≥20×, with average F<sub>1</sub> scores of 0.99 for MTBseq-basic, 0.95 for MTBseq-exrep and 0.96 for XBS respectively. (Figs S3 and S5B).</p>
      <fig position="float" fig-type="figure" id="F6">
        <label>Fig. 6.</label>
        <caption>
          <p>Performance (F<sub>1</sub> scores) of three bioinformatic pipelines for SNP calling in sputum samples with minimum 20× <italic toggle="yes">Mtb</italic> coverage and various types and levels of contamination.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g006" position="float"/>
      </fig>
    </sec>
    <sec id="s5-3">
      <title>Pipeline performance for analysis of WGS data from clinical culture isolates</title>
      <p>MTBseq and XBS could analyse all samples from the Roetzer <italic toggle="yes">et al</italic>. dataset, whereas UVP excluded 33 of the 86 (38 %) samples. Of the 85 Sanger-confirmed mutations, MTBseq-basic recovered 81, MTBseq-exrep 79, UVP 61 and XBS 84, corresponding to sensitivities of 95.3, 92.9, 71.8 and 98.8%, respectively (Table S3). The single variant missed by XBS was located right on the border of a repetitive region, resulting in reads with sub-optimal mapping qualities.</p>
    </sec>
    <sec id="s5-4">
      <title>Pipeline performance for analysis of WGS data from clinical sputum samples</title>
      <p>UVP failed to analyse any sample included in the Goig <italic toggle="yes">et al</italic>. dataset, as contamination levels were above the 10 % threshold for all samples. For the 10 Goig <italic toggle="yes">et al</italic>. samples and the 125 reference samples, XBS reported 11 977 variant positions (after exclusion of the rRNA regions), 13.9 % more than the 10 514 variants reported by MTBseq. The number of variants called by MTBseq further reduced to 10 114 when variants within 12 bp of each other were excluded.</p>
      <p>There was no evidence of false positive variants when using XBS (no obvious branch extension for any sputum samples) with the highly conserved rRNA regions removed (<xref rid="F7" ref-type="fig">Fig. 7</xref>). When including the genes coding for rRNA, obvious extended branch lengths were present for three samples (S02, S26 and S20, Fig. S4) due to VQSLOD scores for such variants that had fallen just within the within the positive VQSR model. When using MTBseq, there were also no obvious branch extensions but one sample (S26) showed a shorter branch length compared to its nearest neighbours in the phylogenetic tree. This was the case for FASTA files including and excluding SNPs within 12 bp distance from each other (Figs S5 and S6).</p>
      <fig position="float" fig-type="figure" id="F7">
        <label>Fig. 7.</label>
        <caption>
          <p>XBS maximum-likelihood tree showing the location of Goig <italic toggle="yes">et al</italic>.’s sputum samples (marked in red) in relation to the reference dataset. The scale bar is in substitutions per site and refers to the branch lengths.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g007" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s6">
    <title>Discussion</title>
    <p>We developed XBS and applied the joint variant calling and machine-learning-based variant filtering approaches, initially designed for human genome analyses, to a pipeline for <italic toggle="yes">Mtb</italic> WGS analyses. Using 1200 simulated samples representing characteristics of WGS data from <italic toggle="yes">Mtb</italic> culture or directly from sputum samples, we demonstrated that XBS increases the performance in variant calling compared to existing pipelines (UVP and MTBseq), especially for WGS data from less-than-perfect, contaminated low<italic toggle="yes">-Mtb</italic>-burden samples. The strain simulation, variant calling and filtering approach presented here may also benefit the study of other bacteria where sequence coverage, complex genomes or contamination hinder accurate identification of genetic variants.</p>
    <p>We showed that current pipeline approaches perform well for SNP and INDEL calling when sequencing DNA extracts from decontaminated cultures with high (≥20×) depth, but accuracy decreases when depth of coverage is low (5–10×) or contamination levels are high (&gt;50 %). The novel XBS pipeline substantially outperformed other MTB pipelines for SNP and INDEL calling in <italic toggle="yes">Mtb</italic> at low-coverage-depth culture samples and highly contaminated, low-coverage-depth sputum samples.</p>
    <p>When analysing WGS data from culture isolates at the current standard 30–100× depth coverage, all pipelines accurately called SNPs and INDELs (F<sub>1</sub> scores &gt;0.90). Of the three pipelines assessed, UVP’s performance was slightly inferior given its lower precision (false positive variants) at higher (5%) contamination, particularly when the contaminant was an NTM. XBS and MTBseq-basic were not affected by low-level (0–5 %) contamination and identified on average 9 % more SNPs and INDELs compared to UVP by investigating <italic toggle="yes">Mtb</italic>’s complex genomic regions. Identifying 9 % more variants could greatly benefit transmission and genome-wide association studies.</p>
    <p>At lower coverage (&lt;20×), XBS was the only pipeline that could accurately call SNPs and INDELs, probably due to the joint calling and filtering processes that permit lower allele coverages. XBS’s accuracy remained high at 5× depth, where the modest drop in F<sub>1</sub> score was due to a slightly lower recall rate and difficulty in accurately calling genuine INDELs due to coverage gaps. This is expected as, according to the Poisson distribution, only 99.3 % of the genome is covered by at least one read at 5× coverage. The low-level contamination simulated for the culture samples did not affect the accuracy of the XBS or MTBseq pipelines. The UVP pipeline, however, was affected by both the level and the type of low-level contamination, and such effects have been observed previously [<xref rid="R23" ref-type="bibr">23</xref>]. Considering these findings it is understandable that UVP uses a strict contamination cut-off, but the other pipelines show that variants can be identified more accurately despite the absence of such cut-offs. Sequencing at 5× depth using XBS resulted in an average SNP F<sub>1</sub> score of 0.96 (minimum 0.95) and average INDEL F<sub>1</sub> score of 0.95 (minimum 0.91), whereas the F<sub>1</sub> scores of the other pipelines were ≤0.10 for both SNPs and INDELs. Such low-coverage sequencing could lower the costs by a factor of 10 compared to standard 50× coverage sequencing. In combination with low-cost library preparations, which is the main driver of sequencing cost, this could open the door to large-scale population sequencing projects in high tuberculosis-burden settings.</p>
    <p>WGS data obtained directly from sputum are characterized by a low number of <italic toggle="yes">Mtb</italic> reads (theoretical coverage), a high level of contamination and the presence of a mix of contaminants. The novel XBS pipeline showed superior performance for analysing such impure sequencing data. Due to the joint calling approach, XBS could analyse samples with much lower genomic coverage than the two MTBseq approaches. XBS successfully identified SNPs and INDELs in an average of 73 % of samples with 2,5–5 million paired-end reads, where MTBseq-basic only successfully analysed 50 % and MTBseq-exrep 45 % of such samples. By employing VQSR filtering, which identifies contaminant reads based on a multitude of statistical annotations, XBS’s performance was not affected by level or type of contaminants. Hard filtering, as is implemented in MTBseq-basic and MTBseq-exrep, was not sufficient at high levels (&gt;50 %) of contamination because contaminant alleles may be interpreted as the most likely and therefore genuine allele, leading to false positives, once they reach coverage levels greater than the <italic toggle="yes">Mtb</italic> allele. For MTBseq, the type of contaminant affected the accuracy. High levels of human DNA did not affect accuracy as these are unlikely to map to the reference genome, but <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic> contamination started to have an effect from 50 % upwards as contaminant alleles then outnumber that of <italic toggle="yes">Mtb</italic>. The NTM-mix only affected accuracy at high contamination despite the great genome similarity among NTMs. This counterintuitive finding is probably because high levels of contamination are required before one of the NTM contaminants present in the mix approaches 50 % allele frequency.</p>
    <p>Since it cannot be said exactly which samples underperform in terms of variant identification accuracy in a clinical dataset, it is best to ensure an acceptable minimum accuracy instead. When employing XBS on WGS data from real-life sputum, our data suggest that it may be prudent to restrict the analyses to those samples that present a coverage of ≥10×. A 10× cut off would result in average SNP F<sub>1</sub> scores of 0.99 (minimum 0.98) and average INDEL F<sub>1</sub> scores of 0.97 (minimum 0.91) for 60 % (60/100) of the samples in the 300 0000 PE read dataset. MTBseq-basic would result in average SNP F<sub>1</sub> scores of 0.91 (minimum 0.53) and average INDEL F<sub>1</sub> scores of 0.95 (minimum 0.69) for the same samples.</p>
    <p>Comparisons of the performance of <italic toggle="yes">Mtb</italic> pipelines is important but hampered by the absence of large datasets for which the true variants are known. To date, studies assessing the performance of <italic toggle="yes">Mtb</italic> pipelines have compared their ability to identify transmission clusters as established through contact tracing or older molecular methods, or by comparing the detection of genomic drug resistance in relation to phenotypic tests or Sanger-confirmed variants [<xref rid="R6" ref-type="bibr">6, 16, 24, 25</xref>]. These approaches suffer from important limitations. Contact tracing is complex and may not necessarily identify all clusters correctly [<xref rid="R26" ref-type="bibr">26</xref>]. Older molecular methods have significantly lower resolution than WGS so that all pipelines call clusters identified by these older methods with relative ease [<xref rid="R27" ref-type="bibr">27</xref>]. Using genomic drug resistance to compare pipelines is affected by the reference drug resistance mutation list used by each pipeline, whereas focusing on a limited number of Sanger-confirmed variants is not representative for the entire genome. The only other study that used simulated read datasets to compare combinations of mapper, caller and filtering methods found that the GATK variant caller in combination with VQSR consistently had the highest precision scores [<xref rid="R28" ref-type="bibr">28</xref>], supporting the findings of our study. This study, however, had multiple limitations. First, GATK calling was performed for one sample at a time, which is not optimal for VQSR or for low-coverage samples. Second, for the VQSR truth sets, half of the samples’ variants with the best quality score were taken, an approach that is problematic when high-frequency contaminant alleles are present. Third, the use of the clinical CDC1551 strain prohibited an assessment of accuracy for the complex regions as the exact location of CDC1551 variants in relation to H37Rv cannot be established with certainty for complex regions.</p>
    <p>We successfully overcame the limitations of prior <italic toggle="yes">Mtb</italic> pipeline accuracy studies by using an <italic toggle="yes">in silico</italic> approach to construct a fully representative variant truth set. The simulated dataset resembled clinical datasets by ensuring that some strains occurred once while others occurred several times. VQSR benefited from the presence of clonal strains as it improves the identification of variants in low-coverage samples observed in other samples. Our datasets simulating culture isolates represented the range of depth (5–100×) and low levels of contamination (0–5 %). Our simulated sputum datasets contained more than 21.4 % contamination (mean 82.12%, maximum 99.99%) and thus very low levels of <italic toggle="yes">Mtb</italic> DNA, which correspond to the findings of a recent study of the clinical samples where most (51%) WGS data showed less than 5 % <italic toggle="yes">Mtb</italic> DNA sequence reads [<xref rid="R9" ref-type="bibr">9</xref>]. The use of the simulated datasets allowed us not only to accurately quantify the performance of different pipelines for variant calling throughout the entire genome, including the complex regions, but also to assess the effect of important characteristics that determine accuracy such as mycobacterial burden, and level and type of contamination.</p>
    <p>The excellent performance of XBS for the analysis of complex samples was confirmed when analysing WGS data obtained from clinical samples. Analyses of the WGS data from clinical culture isolates showed that XBS outperformed other pipelines (including pipelines not investigated in this study) in terms of sensitivity (Table S3). The high specificity of XBS matches the findings of the culture simulations where the four pipeline approaches show similar recall scores. Analysis of WGS data obtained from DNA extracted directly from sputum samples confirmed that only XBS and MTBseq, but not UVP, could successfully analyse such data. While both pipelines showed high specificity (no evidence of false positive variants resulting in branch extension on the phylogeny), the performance of XBS was superior to MTBseq as it allowed the identification of 13.9 % more variants.</p>
    <p>Several limitations remain to the novel XBS variant caller. First, XBS (and other pipelines) cannot analyse samples when NTM contaminant sequences exceed 20 %. Such samples would require analyses by programs such as QuantTB that can potentially filter out NTM contaminants before <italic toggle="yes">Mtb</italic> variant identification as they resemble multiple infections [<xref rid="R29" ref-type="bibr">29</xref>]. Second, XBS requires multiple samples for each run. Previously inferred Genomic VCFs can, however, be included from the Combine VCF step just before the VQSR, eliminating the need to batch new samples. Third, the highly conserved rRNA regions had to be excluded for optimal specificity as sequences in these regions from contaminating bacteria can map to the <italic toggle="yes">Mtb</italic> reference genome with very high confidence, making the variants in such regions indistinguishable in terms of the statistical annotations used by VQSR. Eliminating these regions may result in some loss of the genomic information, albeit a small loss as this region represents only 0.1 % of the genome Fourth, we used H37Rv as the reference genome for all analysis. If the <italic toggle="yes">Mtb</italic> ancestral genome were used as the reference genome instead, a VQSR truth-set could be constructed by aligning the ancestral genome to H37Rv and translating the latter's lineage and DR truth variants. When applying the XBS approach to other bacteria, one should employ well-established variants that occur throughout the entire genome for constructing the VQSR truth set. Finally, we were not able to compare the run time of XBS to the other pipelines as there were important differences in the analyses run other than the variant calling core, and the number of samples analysed differed due to pipeline restrictions. However, elimination of the adapter removal and base recalibration steps reduces the overall processing time and exclusion of meta-genomic classification further reduces computing time. It also prevents the need for computing infrastructure with large memory requirements. To get an idea of the run time for genuine sputum samples we ran the 10 Goig <italic toggle="yes">et al</italic>. samples through the XBS core; the mapping and haplotype calling took under 15 min for each sample and was performed in parallel, and subsequent joint-calling and VQSR took under 5 min (eight threads and 64 GB memory provided).</p>
    <p>Direct-from-sputum WGS data contain a wealth of diverse bacterial contaminants besides that of human origin and all these contaminants occur at widely varying levels. It was not possible to represent this endless variety of bacterial contaminants in our simulation experiments, and hence the most commonly observed bacterial contaminants were used instead [<xref rid="R2" ref-type="bibr">2</xref>], NTMs were included because these pose a serious challenge for <italic toggle="yes">Mtb</italic> variant calling. Contaminant levels were simulated to match those observed for genuine sputum samples [<xref rid="R9" ref-type="bibr">9</xref>]. As such it was possible to study the effect of the various contaminants and their levels on variant calling; this would not have been possible had all the endless contaminants observed for direct-from-sputum samples been used. To show that XBS was able to handle such genuinely diverse contamination, two clinical WGS datasets were studied, one from cultured samples and one direct-from-sputum samples. Further studies are required to study the effect of the full diversity of contaminants that are observed for direct-from-sputum samples.</p>
    <p>In conclusion, all pipelines studied (MTBseq, UVP, XBS) accurately analysed WGS data from <italic toggle="yes">Mtb</italic> culture isolates. Only XBS and MTBseq could accurately identify variants in low<italic toggle="yes">-Mtb</italic>-coverage and highly contaminated samples and XBS achieved higher performance parameters of all the pipelines studied. High performance at low depth could decrease sequencing cost and improve WGS analysis directly from sputum samples. The accurate identification of variants in the complex genomic <italic toggle="yes">Mtb</italic> regions allow for improved resolution in transmission studies through increased genetic resolution and creates the ability to explore the functional role of variants in these complex regions. Taken together, the novel XBS pipeline sets the stage for the next generation of <italic toggle="yes">Mtb</italic> WGS studies.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Data</title>
    <supplementary-material position="float" id="supp1" content-type="local-data">
      <caption>
        <title>Supplementary material 1</title>
      </caption>
      <media xlink:href="mgen-7-0689-s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Funding information</title>
    <p>This work was supported by the Research Foundation Flanders (FWO) (grant number FWO Odysseus G0F8316N).</p>
  </ack>
  <ack id="ack2">
    <title>Acknowledgements</title>
    <p>We would like to thank the members of the Tuberculosis Omics ResearCH (TORCH) consortium for helpful discussions and particularly Elise De Vos for discussions surrounding sputum simulation. We thank the reviewers for helpful comments and Galo A. Goig <italic toggle="yes">et al</italic>. for providing additional direct-from-sputum sequencing data.</p>
  </ack>
  <ack id="ack3">
    <title>Author contributions</title>
    <p>T.H.H., R.M.W. and A.V.R.: conceptualized the project and methodology. T.H.H. and L.V.: curated the data and designed and scripted the software. R.M.W. and A.V.R.: acquired the funding. T.H.H., L.V., R.M.W. and A.V.R.: wrote, reviewed and edited the manuscript.</p>
  </ack>
  <ack id="ack4">
    <title>Conflicts of interest</title>
    <p content-type="COI-statement">The authors declare that there are no conflicts of interest.</p>
  </ack>
  <fn-group>
    <fn id="FN1">
      <p>Abbreviations: DR, drug resistance; GATK, Genome Analysis ToolKit; GVCF, Genomic Variant Call Format; INDEL, Insertion/Deletion; <italic toggle="yes">Mtb</italic>, <italic toggle="yes">Mycobacterium tuberculosis</italic>; NTM, non-tuberculous mycobacteria; SNP, Single Nucleotide Polymorphism; UVP, Unified Variant Pipeline; VCF, Variant Call Format; VQSR, Variant Quality Score Recalibration; WGS, whole genome sequencing; XBS, compleX Bacterial Sample.</p>
    </fn>
    <fn id="FN2">
      <p>All supporting data, code and protocols have been provided within the article or through supplementary data files. Three supplementary tables and six supplementary figures are available with the online version of this article.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="R1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meehan</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Goig</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Kohl</surname>
            <given-names>TA</given-names>
          </name>
        </person-group>
        <article-title>Whole genome sequencing of <italic toggle="yes">Mycobacterium tuberculosis</italic>: current standards and open issues</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2019</year>
        <volume>17</volume>
        <fpage>533</fpage>
        <lpage>545</lpage>
        <pub-id pub-id-type="doi">10.1038/s41579-019-0214-5</pub-id>
        <?supplied-pmid 31209399?>
        <pub-id pub-id-type="pmid">31209399</pub-id>
      </element-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McClean</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stanley</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Stanley</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Identification and characterization of breakthrough contaminants associated with the conventional isolation of <italic toggle="yes">Mycobacterium tuberculosis</italic>
</article-title>
        <source>J Med Microbiol</source>
        <year>2011</year>
        <volume>60</volume>
        <fpage>1292</fpage>
        <lpage>1298</lpage>
        <pub-id pub-id-type="doi">10.1099/jmm.0.030619-0</pub-id>
        <?supplied-pmid 21527550?>
        <pub-id pub-id-type="pmid">21527550</pub-id>
      </element-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rachow</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Saathoff</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mtafya</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mapamba</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mangu</surname>
            <given-names>C</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>The impact of repeated NALC/NaOH- decontamination on the performance of Xpert MTB/RIF assay</article-title>
        <source>Tuberculosis</source>
        <year>2018</year>
        <volume>110</volume>
        <fpage>56</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tube.2018.04.001</pub-id>
        <?supplied-pmid 29779774?>
        <pub-id pub-id-type="pmid">29779774</pub-id>
      </element-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Farmanfarmaei</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kamakoli</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Sadegh</surname>
            <given-names>HR</given-names>
          </name>
        </person-group>
        <article-title>Bias in detection of <italic toggle="yes">Mycobacterium tuberculosis</italic> polyclonal infection: Use clinical samples or cultures?</article-title>
        <source>Mol Cell Probes</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>1</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mcp.2017.01.002</pub-id>
        <?supplied-pmid 28130122?>
        <pub-id pub-id-type="pmid">28130122</pub-id>
      </element-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nimmo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Doyle</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Whole genome sequencing <italic toggle="yes">Mycobacterium tuberculosis</italic> directly from sputum identifies more genetic diversity than sequencing from culture</article-title>
        <source>BMC Genomics</source>
        <year>2019</year>
        <volume>20</volume>
        <elocation-id>389</elocation-id>
        <pub-id pub-id-type="doi">10.1186/s12864-019-5841-8</pub-id>
        <?supplied-pmid 31142261?>
        <pub-id pub-id-type="pmid">31109296</pub-id>
      </element-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ezewudo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Borens</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chiner-Oms</surname>
            <given-names>Á</given-names>
          </name>
        </person-group>
        <article-title>tegrating standardized whole genome sequence analysis with a global <italic toggle="yes">Mycobacterium tuberculosis</italic> antibiotic resistance knowledgebase</article-title>
        <source>Sci Rep</source>
        <year>2018</year>
        <volume>8</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <comment>DOI: 10.1038/s41598-018-33731-1</comment>
        <pub-id pub-id-type="pmid">29311619</pub-id>
      </element-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Genomic mapping by fingerprinting random clones: a mathematical analysis</article-title>
        <source>Genomics</source>
        <year>1988</year>
        <volume>2</volume>
        <fpage>231</fpage>
        <lpage>239</lpage>
        <pub-id pub-id-type="doi">10.1016/0888-7543(88)90007-9</pub-id>
        <?supplied-pmid 3294162?>
        <pub-id pub-id-type="pmid">3294162</pub-id>
      </element-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kohl</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Diel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Harmsen</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Whole-genome-based <italic toggle="yes">Mycobacterium tuberculosis</italic> surveillance: a standardized, portable, and expandable approach</article-title>
        <source>J Clin Microbiol</source>
        <year>2014</year>
        <volume>52</volume>
        <fpage>2479</fpage>
        <lpage>2486</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.00567-14</pub-id>
        <?supplied-pmid 24789177?>
        <pub-id pub-id-type="pmid">24789177</pub-id>
      </element-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goig</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Cancino-Muñoz</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Torres-Puente</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Whole-genome sequencing of <italic toggle="yes">Mycobacterium tuberculosis</italic> directly from clinical samples for high-resolution genomic epidemiology and drug resistance surveillance: an observational study</article-title>
        <source>The Lancet Microbe</source>
        <year>2020</year>
        <volume>1</volume>
        <fpage>e175</fpage>
        <lpage>e183</lpage>
        <pub-id pub-id-type="doi">10.1016/S2666-5247(20)30060-4</pub-id>
      </element-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kato-Maeda</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Passarelli</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Use of whole genome sequencing to determine the microevolution of <italic toggle="yes">Mycobacterium tuberculosis</italic> during an outbreak</article-title>
        <source>PLoS One</source>
        <year>2013</year>
        <volume>8</volume>
        <elocation-id>e58235</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0058235</pub-id>
        <?supplied-pmid 23472164?>
        <pub-id pub-id-type="pmid">23472164</pub-id>
      </element-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ruano-Rubio</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Scaling accurate genetic variant discovery to tens of thousands of samples</article-title>
        <source>BioRxiv</source>
        <year>2017</year>
        <fpage>201178</fpage>
      </element-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>491</fpage>
        <pub-id pub-id-type="doi">10.1038/ng.806</pub-id>
        <?supplied-pmid 21478889?>
        <pub-id pub-id-type="pmid">21478889</pub-id>
      </element-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM</article-title>
        <source>arXiv Prepr</source>
        <year>2013</year>
        <volume>3997</volume>
      </element-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pettengill</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>Y</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>CFSAN SNP pipeline: An automated method for constructing SNP matrices from next-generation sequence data</article-title>
        <source>PeerJ Comput Sci</source>
        <year>2015</year>
        <volume>1</volume>
        <elocation-id>e20</elocation-id>
        <pub-id pub-id-type="doi">10.7717/peerj-cs.20</pub-id>
      </element-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>ART: a next-generation sequencing read simulator</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>593</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id>
        <?supplied-pmid 22199392?>
        <pub-id pub-id-type="pmid">22199392</pub-id>
      </element-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kohl</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Utpatel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schleusener</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>MTBseq: a comprehensive pipeline for whole genome sequence analysis of <italic toggle="yes">Mycobacterium tuberculosis</italic> complex isolates</article-title>
        <source>PeerJ</source>
        <year>2018</year>
        <volume>6</volume>
        <elocation-id>e5895</elocation-id>
        <pub-id pub-id-type="doi">10.7717/peerj.5895</pub-id>
        <?supplied-pmid 30479891?>
        <pub-id pub-id-type="pmid">30479891</pub-id>
      </element-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roetzer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Diel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kohl</surname>
            <given-names>TA</given-names>
          </name>
        </person-group>
        <article-title>Whole genome sequencing versus traditional genotyping for investigation of a <italic toggle="yes">Mycobacterium tuberculosis</italic> outbreak: a longitudinal molecular epidemiological study</article-title>
        <source>PLoS Med</source>
        <year>2013</year>
        <volume>10</volume>
        <elocation-id>e1001387</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pmed.1001387</pub-id>
        <?supplied-pmid 23424287?>
        <pub-id pub-id-type="pmid">23424287</pub-id>
      </element-citation>
    </ref>
    <ref id="R18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coll</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>McNerney</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Guerra-Assunção</surname>
            <given-names>JA</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>A robust SNP barcode for typing <italic toggle="yes">Mycobacterium tuberculosis</italic> complex strains</article-title>
        <source>Nat Commun</source>
        <year>2014</year>
        <volume>5</volume>
        <fpage>1</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1038/ncomms5812</pub-id>
      </element-citation>
    </ref>
    <ref id="R19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coll</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Phelan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hill-Cawthorne</surname>
            <given-names>GA</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide analysis of multi-and extensively drug-resistant <italic toggle="yes">Mycobacterium tuberculosis</italic>
</article-title>
        <source>Nat Genet</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>307</fpage>
        <lpage>316</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-017-0029-0</pub-id>
        <?supplied-pmid 29358649?>
        <pub-id pub-id-type="pmid">29358649</pub-id>
      </element-citation>
    </ref>
    <ref id="R20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Napier</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Campino</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Merid</surname>
            <given-names>Y</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Robust barcoding and identification of <italic toggle="yes">Mycobacterium tuberculosis</italic> lineages for epidemiological and clinical studies</article-title>
        <source>Genome Med</source>
        <year>2020</year>
        <volume>12</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1186/s13073-020-00817-3</pub-id>
      </element-citation>
    </ref>
    <ref id="R21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Chernomor</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>IQ-TREE 2: new models and efficient methods for phylogenetic inference in the genomic era</article-title>
        <source>Mol Biol Evol</source>
        <year>2020</year>
        <volume>37</volume>
        <fpage>1530</fpage>
        <lpage>1534</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msaa015</pub-id>
        <?supplied-pmid 32011700?>
        <pub-id pub-id-type="pmid">32011700</pub-id>
      </element-citation>
    </ref>
    <ref id="R22">
      <label>22</label>
      <element-citation publication-type="journal">
        <comment>N.d</comment>
        <article-title>Rambaut A</article-title>
        <source>FigTree</source>
        <ext-link xlink:href="https://github.com/rambaut/figtree/" ext-link-type="uri">https://github.com/rambaut/figtree/</ext-link>
      </element-citation>
    </ref>
    <ref id="R23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goig</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Blanco</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Garcia-Basteiro</surname>
            <given-names>AL</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Contaminant DNA in bacterial sequencing experiments is a major source of false genetic variability</article-title>
        <source>BMC Biol</source>
        <year>2020</year>
        <volume>18</volume>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="pmid">31898513</pub-id>
      </element-citation>
    </ref>
    <ref id="R24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schleusener</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Köser</surname>
            <given-names>CU</given-names>
          </name>
          <name>
            <surname>Beckert</surname>
            <given-names>P</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title><italic toggle="yes">Mycobacterium tuberculosis</italic> resistance prediction and lineage classification from genome sequencing: Comparison of automated analysis tools</article-title>
        <source>Sci Rep</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/srep46327</pub-id>
        <pub-id pub-id-type="pmid">28127051</pub-id>
      </element-citation>
    </ref>
    <ref id="R25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jajou</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kohl</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Towards standardisation: Comparison of five whole genome sequencing (WGS) analysis pipelines for detection of epidemiologically linked tuberculosis cases</article-title>
        <source>Euro Surveill</source>
        <year>2019</year>
        <volume>24</volume>
        <pub-id pub-id-type="doi">10.2807/1560-7917.ES.2019.24.50.1900130</pub-id>
        <?supplied-pmid 31847944?>
        <pub-id pub-id-type="pmid">31847944</pub-id>
      </element-citation>
    </ref>
    <ref id="R26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nikolayevskyy</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Kranzer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Niemann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Whole genome sequencing of <italic toggle="yes">Mycobacterium tuberculosis</italic> for detection of recent transmission and tracing outbreaks: a systematic review</article-title>
        <source>Tuberculosis</source>
        <year>2016</year>
        <volume>98</volume>
        <fpage>77</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tube.2016.02.009</pub-id>
        <?supplied-pmid 27156621?>
        <pub-id pub-id-type="pmid">27156621</pub-id>
      </element-citation>
    </ref>
    <ref id="R27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meehan</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Moris</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kohl</surname>
            <given-names>TA</given-names>
          </name>
        </person-group>
        <article-title>The relationship between transmission time and clustering methods in <italic toggle="yes">Mycobacterium tuberculosis</italic> epidemiology</article-title>
        <source>EBioMedicine</source>
        <year>2018</year>
        <volume>37</volume>
        <fpage>410</fpage>
        <lpage>416</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ebiom.2018.10.013</pub-id>
        <?supplied-pmid 30341041?>
        <pub-id pub-id-type="pmid">30341041</pub-id>
      </element-citation>
    </ref>
    <ref id="R28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Walter</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Colijn</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>T</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Genomic variant-identification methods may alter <italic toggle="yes">Mycobacterium tuberculosis</italic> transmission inferences</article-title>
        <source>Microb Genomics</source>
        <year>2020</year>
        <volume>6</volume>
        <pub-id pub-id-type="doi">10.1099/mgen.0.000418</pub-id>
      </element-citation>
    </ref>
    <ref id="R29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anyansi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Keo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>QuantTB--A method to classify mixed <italic toggle="yes">Mycobacterium tuberculosis</italic> infections within whole genome sequencing data</article-title>
        <source>BMC Genomics</source>
        <year>2020</year>
        <volume>21</volume>
        <elocation-id>80</elocation-id>
        <pub-id pub-id-type="doi">10.1186/s12864-020-6486-3</pub-id>
        <?supplied-pmid 31992201?>
        <pub-id pub-id-type="pmid">31992201</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Microb Genom</journal-id>
    <journal-id journal-id-type="iso-abbrev">Microb Genom</journal-id>
    <journal-id journal-id-type="hwp">mgen</journal-id>
    <journal-id journal-id-type="publisher-id">mgen</journal-id>
    <journal-title-group>
      <journal-title>Microbial Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2057-5858</issn>
    <publisher>
      <publisher-name>Microbiology Society</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8743552</article-id>
    <article-id pub-id-type="pmid">34793294</article-id>
    <article-id pub-id-type="publisher-id">000689</article-id>
    <article-id pub-id-type="doi">10.1099/mgen.0.000689</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Articles</subject>
        <subj-group subj-group-type="heading">
          <subject>Pathogens and Epidemiology</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Comprehensive and accurate genetic variant identification from contaminated and low-coverage <italic toggle="yes">Mycobacterium tuberculosis</italic> whole genome sequencing data</article-title>
      <alt-title alt-title-type="recto-page-foot">
        <ext-link xlink:href="http://mgen.microbiologyresearch.org" ext-link-type="uri">http://mgen.microbiologyresearch.org</ext-link>
      </alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6237-3898</contrib-id>
        <name>
          <surname>Heupink</surname>
          <given-names>Tim H.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="cor1" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5647-5852</contrib-id>
        <name>
          <surname>Verboven</surname>
          <given-names>Lennert</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5741-7358</contrib-id>
        <name>
          <surname>Warren</surname>
          <given-names>Robin M.</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7666-3263</contrib-id>
        <name>
          <surname>Van Rie</surname>
          <given-names>Annelies</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <aff id="aff1"><label><sup>1</sup>​</label><institution content-type="department">Family Medicine and Population Health (FAMPOP)</institution>, <institution>Faculty of Medicine and Health Sciences, University of Antwerp</institution>, <addr-line content-type="city">Antwerp</addr-line>, <country>Belgium</country></aff>
      <aff id="aff2"><label><sup>2</sup>​</label><institution content-type="department">South African Medical Research Council Centre for Tuberculosis Research and DST/NRF Centre of Excellence for Biomedical Tuberculosis Research</institution>, <institution>Division of Molecular Biology and Human Genetics, Stellenbosch University</institution>, <addr-line content-type="city">Stellenbosch</addr-line>, <country>South Africa</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><bold>*Correspondence:</bold> Tim H. Heupink, <email xlink:href="mailto:tim.heupink@uantwerpen.be">tim.heupink@uantwerpen.be</email>
</corresp>
      <fn fn-type="accession-no">
        <p>Simulated sequencing data have been deposited in SRA BioProject PRJNA706121.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <!--PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>.-->
    <volume>7</volume>
    <issue>11</issue>
    <elocation-id>000689</elocation-id>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>09</day>
        <month>9</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 The Authors</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution NonCommercial License.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="mgen-7-0689.pdf"/>
    <abstract>
      <p>Improved understanding of the genomic variants that allow <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10886" ext-link-type="uri">Mycobacterium tuberculosis</ext-link></named-content></italic> (<italic toggle="yes">Mtb</italic>) to acquire drug resistance, or tolerance, and increase its virulence are important factors in controlling the current tuberculosis epidemic. Current approaches to <italic toggle="yes">Mtb</italic> sequencing, however, cannot reveal <italic toggle="yes">Mtb</italic>’s full genomic diversity due to the strict requirements of low contamination levels, high <italic toggle="yes">Mtb</italic> sequence coverage and elimination of complex regions. We have developed the XBS (compleX Bacterial Samples) bioinformatics pipeline, which implements joint calling and machine-learning-based variant filtering tools to specifically improve variant detection in the important <italic toggle="yes">Mtb</italic> samples that do not meet these criteria, such as those from unbiased sputum samples. Using novel simulated datasets, which permit exact accuracy verification, XBS was compared to the UVP and MTBseq pipelines. Accuracy statistics showed that all three pipelines performed equally well for sequence data that resemble those obtained from culture isolates of high depth of coverage and low-level contamination. In the complex genomic regions, however, XBS accurately identified 9.0 % more SNPs and 8.1 % more single nucleotide insertions and deletions than the WHO-endorsed unified analysis variant pipeline. XBS also had superior accuracy for sequence data that resemble those obtained directly from sputum samples, where depth of coverage is typically very low and contamination levels are high. XBS was the only pipeline not affected by low depth of coverage (5–10×), type of contamination and excessive contamination levels (&gt;50 %). Simulation results were confirmed using whole genome sequencing (WGS) data from clinical samples, confirming the superior performance of XBS with a higher sensitivity (98.8%) when analysing culture isolates and identification of 13.9 % more variable sites in WGS data from sputum samples as compared to MTBseq, without evidence for false positive variants when rRNA regions were excluded. The XBS pipeline facilitates sequencing of less-than-perfect <italic toggle="yes">Mtb</italic> samples. These advances will benefit future clinical applications of <italic toggle="yes">Mtb</italic> sequencing, especially WGS directly from clinical specimens, thereby avoiding <italic toggle="yes">in vitro</italic> biases and making many more samples available for drug resistance and other genomic analyses. The additional genetic resolution and increased sample success rate will improve genome-wide association studies and sequence-based transmission studies.</p>
    </abstract>
    <kwd-group>
      <kwd>bacteria</kwd>
      <kwd>contamination</kwd>
      <kwd>low coverage</kwd>
      <kwd>
        <italic toggle="yes">Mycobacterium tuberculosis</italic>
      </kwd>
      <kwd>sputum</kwd>
      <kwd>whole-genome sequencing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>fonds wetenschappelijk onderzoek</funding-source>
        <award-id>G0F8316N</award-id>
        <principal-award-recipient>AnneliesVan Rie</principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>OpenAccessEmbargo</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="s2">
    <title>Data Summary</title>
    <p>Simulated sequencing data have been deposited in SRA BioProject PRJNA706121. All detailed findings are available in the supplementary material. Supplementary material can be found in Figshare: <ext-link xlink:href="https://doi.org/10.6084/m9.figshare.17032835.v1" ext-link-type="uri">https://doi.org/10.6084/m9.figshare.17032835.v1</ext-link>. Scripts for running the XBS variant calling core are available on <ext-link xlink:href="https://github.com/TimHHH/XBS" ext-link-type="uri">https://github.com/TimHHH/XBS.</ext-link>
</p>
    <p>The authors confirm all supporting data, code and protocols have been provided within the article or through supplementary data files.</p>
    <boxed-text position="float">
      <caption>
        <title>Impact Statement</title>
      </caption>
      <p><italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10886" ext-link-type="uri">Mycobacterium tuberculosis</ext-link></named-content></italic> (<italic toggle="yes">Mtb</italic>) DNA is usually extracted from culture isolates to obtain high quantities of non-contaminated DNA, but this process can change the make-up of the bacterial population and is time-consuming. Furthermore, current analytical approaches exclude complex genomic regions where DNA sequences are repeated to avoid inference of false positive genetic variants, which may result in the loss of important genetic information. We have designed the compleX Bacterial Sample (XBS) variant caller to overcome these limitations. XBS employs joint variant calling and machine-learning-based variant filtering to ensure that high-quality variants can be inferred from low-coverage and highly contaminated genomic sequence data obtained directly from sputum samples. Simulation and clinical data analyses showed that XBS performs better than other pipelines as it can identify more genetic variants and can handle complex (low depth, highly contaminated) <italic toggle="yes">Mtb</italic> samples. The XBS pipeline was designed to analyse <italic toggle="yes">Mtb</italic> samples but can easily be adapted to analyse other complex bacterial samples.</p>
    </boxed-text>
  </sec>
  <sec sec-type="intro" id="s3">
    <title>Introduction</title>
    <p>Genetic approaches are increasingly being used in tuberculosis research and for the diagnosis of drug-resistant tuberculosis. Whole genome sequencing (WGS) of <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10886" ext-link-type="uri">Mycobacterium tuberculosis</ext-link></named-content></italic> (<italic toggle="yes">Mtb</italic>) aims to investigate the entire genome of the <italic toggle="yes">Mtb</italic> strain to comprehensively assess all known drug resistance-conferring regions, provide maximum resolution for genetic transmission studies, and investigate the role of genomic variants using genome-wide association studies [<xref rid="R1" ref-type="bibr">1</xref>]. The three key problems facing current <italic toggle="yes">Mtb</italic> WGS approaches are the need for high quantities of <italic toggle="yes">Mtb</italic> DNA, presence of contaminant bacterial and human DNA, and presence of complex regions in the <italic toggle="yes">Mtb</italic> genome.</p>
    <p><italic toggle="yes">Mtb</italic> is notoriously difficult to sequence directly from clinical samples because the DNA from human cells, bacteria and viruses outnumbers that from <italic toggle="yes">Mtb</italic> bacilli. This results in insufficient template <italic toggle="yes">Mtb</italic> DNA and low genomic depth of coverage when sequenced [<xref rid="R2" ref-type="bibr">2</xref>]. <italic toggle="yes">Mtb</italic> WGS therefore primarily uses cultured isolates, which requires a harsh decontamination step followed by a lengthy (2–4 weeks) incubation to generate large quantities of <italic toggle="yes">Mtb</italic>. The decontamination step not only reduces the presence of bacteria other than <italic toggle="yes">Mtb</italic>, but may also reduce the <italic toggle="yes">Mtb</italic> load [<xref rid="R3" ref-type="bibr">3</xref>]. The culture step can increase the presence of certain strains over others due to stochastic processes or when certain strains are better suited to growing in culture media [<xref rid="R4" ref-type="bibr">4, 5</xref>]. These processing steps thus result in a population bias, where the inferred <italic toggle="yes">in vitro Mtb</italic> population may not truly represent the <italic toggle="yes">in vivo</italic> population. To generate a rapid and unbiased result, <italic toggle="yes">Mtb</italic> would thus ideally be sequenced directly from the clinical sample.</p>
    <p>Despite decontamination, a small proportion of contaminants may persist in the DNA extracted from the culture isolate. Current <italic toggle="yes">Mtb</italic> bioinformatic pipelines use <italic toggle="yes">in silico</italic> meta-genomic classification software to identify these contaminants and exclude samples with a high proportion of contaminant DNA. For example the unified analysis variant pipeline (UVP) uses a cut-off maximum of 10 % contamination [<xref rid="R6" ref-type="bibr">6</xref>], which may exclude valuable samples from analysis. In addition to the low contamination threshold, the <italic toggle="yes">Mtb</italic> community has adopted relatively high standards for genome coverage, with 30× to 50× and up to 100× depth being the most commonly used. A Poisson distribution, however, reveals that a mean depth of coverage of 15.8× results in 95 % of the genome being covered by 10× or more reads [<xref rid="R7" ref-type="bibr">7</xref>], which should be sufficient for accurately calling majority variants in a haploid genome.</p>
    <p>A third problem that complicates <italic toggle="yes">Mtb</italic> WGS is the abundance of complex regions including repeats, transposons, duplicates and phage genes, and the numerous PE/PPE genes. These complex regions are generally excluded from analyses by <italic toggle="yes">Mtb</italic> pipelines. The core genome multi-locus sequence typing (cgMLST) method goes even further as only the most trusted regions are analysed [<xref rid="R8" ref-type="bibr">8</xref>]. While these strategies ensure the accuracy of the genome assembly and variant calling, they can result in the loss of a significant proportion of genomic information (~9 % when using the UVP [<xref rid="R6" ref-type="bibr">6</xref>]), which may be important for defining transmission events and identification of variants that affect pathogenicity.</p>
    <p>There is thus a need for novel bioinformatics tools that overcome the current requirements of low contamination, high <italic toggle="yes">Mtb</italic> DNA sequence coverage and exclusion of complex genomic regions [<xref rid="R9" ref-type="bibr">9</xref>]. The Genome Analysis ToolKit (GATK), originally designed for human genome studies (i.e. diploid), now allows for processing of haploid genomes such as that of <italic toggle="yes">Mtb</italic>. The Base Quality Score Recalibration and Indel Realigner tools and single sample variant calling using the now superseded Unified Genotyper tool have already been applied in <italic toggle="yes">Mtb</italic> genome studies [<xref rid="R6" ref-type="bibr">6, 10</xref>]. GATK’s ‘Germline short variant discovery Best Practices workflow’, however, includes joint genotyping and machine-learning-based variant filtering and has seen little to no implementation in bacterial and <italic toggle="yes">Mtb</italic> genome assembly pipelines. The major advantage of joint variant calling, as opposed to single sample variant calling, is a greater sensitivity for variants at low frequency in the population and detection of variants in low-coverage samples for which there would be insufficient confidence if the sample had been analysed on its own [<xref rid="R11" ref-type="bibr">11</xref>]. Joint variant calling also enables the calculation of various statistical annotations (including depth of coverage, strand bias and read mapping quality) for alleles in the population rather than for those in a single strain. These population variants are more numerous and their annotations suffer from fewer stochastic deviations, thereby improving subsequent variant filtering. The machine-learning-based variant filtering (VQSR) in GATK [<xref rid="R12" ref-type="bibr">12</xref>] eliminates the need for hard-filtering of variants, which is commonly applied through the use of rather arbitrary cut-offs for strand bias and coverage depth.</p>
    <p>We hypothesize that GATK’s tools are suitable for distinguishing contaminant variants from <italic toggle="yes">Mtb</italic> and to score and identify variants in complex regions of the <italic toggle="yes">Mtb</italic> genome. We developed a novel <italic toggle="yes">Mtb</italic> pipeline integrating GATK’s tools to improve the identification of genetic variants in less-than-perfect <italic toggle="yes">Mtb</italic> samples and thereby greatly increase our power to capture the diversity of within-patient and within-bacterial genetic information. We also tested the variant calling core of this pipeline for its accuracy to identify genetic variants in comparison to existing pipelines.</p>
  </sec>
  <sec sec-type="methods" id="s4">
    <title>Methods</title>
    <sec id="s4-1">
      <title>Development of the XBS pipeline</title>
      <p>The XBS pipeline was designed to perform analyses of Illumina FASTQ sequence data. The pipeline was primarily designed to analyse <italic toggle="yes">Mtb</italic> samples but can easily be adapted to analyse other complex bacterial samples. XBS was realized through coupling published software packages with custom Bash and Python scripts.</p>
      <p>Pipelines typically start with identifying the level of contaminants and/or removing contaminants before mapping the sequence reads. In XBS, all FASTQ sequence data, whether single read or paired-end, are directly mapped to the reference genome (H37Rv: NC_000962.3), however, using BWA mem [<xref rid="R13" ref-type="bibr">13</xref>] (<xref rid="F1" ref-type="fig">Fig. 1</xref>). XBS does not employ an adapter trimming step because BWA mem locally aligns sequence reads, which masks the portions of the read that do not align well with the reference genome. Skipping the step of removing contaminants saves considerable computing time but does require sophisticated downstream variant filtering to distinguish genuine <italic toggle="yes">Mtb</italic> variants from those introduced by contaminants.</p>
      <fig position="float" fig-type="figure" id="F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Flow chart for XBS’s variant calling core.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g001" position="float"/>
      </fig>
      <p>Next, the mapped sequence library is merged with other independently mapped sequence libraries from the same sample using Samtools (<ext-link xlink:href="https://www.htslib.org/" ext-link-type="uri">https://www.htslib.org/</ext-link>). GATK's MarkDuplicates (Picard) is then used to mark duplicated reads in the merged bam file. Unlike other <italic toggle="yes">Mtb</italic> pipelines XBS does not employ Base Quality Score Recalibration (BQSR) to avoid variants in contaminant DNA being interpreted as systematic errors by BQSR, which would result in reduced base qualities, including for genuine <italic toggle="yes">Mtb</italic> variants.</p>
      <p>The mapped sequences are then locally reassembled to correctly identify possible haplotypes and their variants using GATK HaplotypeCaller. At this point, the statistics of depth of coverage, breadth of coverage, multiple infection and level of non-tuberculous mycobacteria (NTM) contamination are assessed to judge if a sample is suitable for subsequent joint variant calling. Coverage statistics are inferred using GATK's CollectWgsMetrics (Picard). Quality approved samples’ Genomic Variant Call Format (GVCF) files are then merged with GATK's CombineGVCFs and the genotypes are joint called using GATK's GenotypeGVCFs. This results in a VCF file with the unfiltered variants for all quality approved samples. GATK is run with a ploidy of 1 for the variant calling processes so that the allele with the highest confidence is identified as the allele representing the haploid genotype for each variant site.</p>
      <p>Next, the machine-learning-based variant filtering (VQSR) in GATK is employed to identify the probable true variants [<xref rid="R12" ref-type="bibr">12</xref>]. This step requires a truth set of variants known to occur in <italic toggle="yes">Mtb</italic>, which can for example consist of Drug Resistance (DR) conferring mutations. SNPs and insertions and deletions (INDELs) are processed separately for variant filtering. The annotated statistics calculated during the genotyping are used to build a positive statistical model for the variants in the dataset that also occur in the truth set. Similarly, a negative variant model is built for the variants with the worst annotated statistics. The remaining variants not consulted for either the positive or the negative model construction are then confidence scored according to the placement of their annotated statistics in relation to these models. To identify as many variants as possible, variants are then filtered by applying a target sensitivity of 99.9%, calculated as the percentage of identified variants from the present truth-set variants. The filtered SNP and INDEL VCFs are then further processed as appropriate for constructing annotated phylogenies and inferences of multiple infection, drug (hetero-)resistance, lineage and transmission clusters.</p>
    </sec>
    <sec id="s4-2">
      <title><italic toggle="yes">In silico</italic> development of a simulated dataset</title>
      <p>A dataset of 1200 simulated samples representing 50 000 SNPs, 2500 insertions and 2500 deletions was developed (<xref rid="F2" ref-type="fig">Fig. 2</xref>). Of these, 600 were designed to resemble WGS data from mono-culture isolates and 600 to resemble WGS data obtained directly from sputum samples, the latter including high levels of various contaminants.</p>
      <fig position="float" fig-type="figure" id="F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Flow chart for dataset construction.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g002" position="float"/>
      </fig>
      <p>First, a set of 50 simulated strains with the exact mutations known with respect to the reference genome was created <italic toggle="yes">in silico</italic> using SNP Mutator v.1.2.0 [<xref rid="R14" ref-type="bibr">14</xref>]. Each simulated genome was created by randomly introducing 1000 SNPs, 50 single nucleotide insertions and 50 single nucleotide deletions in H37Rv (NC_000962.3). Multi-nucleotide INDELs could not be introduced using the SNP Mutator software. SNPs and INDELs were introduced randomly throughout each simulated strain genome to ensure that random bases were affected and/or introduced and to create genetically varying strains. GATK's LeftAlignAndTrimVariants was used so that the truth set's INDELs were in the standard notation.</p>
      <p>For each dataset, 100 strains were randomly drawn from the 50 simulated strains to ensure that some strains and their variants occurred more than once, as would be the case for clinical datasets where specific strains and drug resistance variants often occur more than once. To simulate WGS data obtained from culture isolates, six datasets representing 5×, 10×, 20×, 30×, 50× or 100× depth were generated using 100 randomly drawn simulated strains each (<xref rid="F2" ref-type="fig">Fig. 2</xref>). In order to investigate the impact of low-level contamination, no or low-level contamination (0, 1, 2, 3, 4 or 5%) and contamination type was randomly assigned to each of the simulated strains. The eight contamination types used were <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.6366" ext-link-type="uri">Mycobacterium intracellulare</ext-link></named-content></italic> (NC_016946.1), <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.6313" ext-link-type="uri">Mycobacterium abscessus</ext-link></named-content></italic> (NC_010397.1, including plasmid), <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10879" ext-link-type="uri">Mycobacterium avium</ext-link></named-content></italic> (NC_002944.2), the three most common NTM, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.2553" ext-link-type="uri">Pseudomonas aeruginosa</ext-link></named-content></italic> (NC_002516.2) and <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">Staphylococcus epidermidis</ext-link></named-content></italic> (NC_004461.1), <italic toggle="yes">Homo sapiens</italic> (GRCh38), a mixture of the three NTM (<italic toggle="yes">M. intracellulare, M. abcessus</italic> and <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10879" ext-link-type="uri">M. avium</ext-link></named-content></italic>) and a mixture of all six contaminants. Because it was not possible to represent the full diverse spectrum of contaminating bacteria in the simulations, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.2553" ext-link-type="uri">P aeruginosa</ext-link></named-content></italic> and <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic> were selected as these are the most common bacterial contaminants [<xref rid="R2" ref-type="bibr">2</xref>], and NTMs were included because these pose a serious challenge for <italic toggle="yes">Mtb</italic> variant calling. The simulated samples included no or low-level contamination in order to resemble WGS data from culture isolates and to be able to investigate the effect of the various low levels of such contamination. Simulated contaminant sequence reads were added to the simulated <italic toggle="yes">Mtb</italic> reads so that the final contamination level matched the assigned contamination percentage.</p>
      <p>ART v.2.5.8 software [<xref rid="R15" ref-type="bibr">15</xref>] was then used to emulate Illumina 150 bp paired-end sequence reads with an HiSeq error profile and a Poisson distributed 300 bp average library insert size for each simulated strain and its contaminant(s). In total, 600 cultured WGS samples were generated in six datasets of 100 simulated samples with each dataset representing a different level of coverage (5, 10, 20, 30, 50 or 100× depth) to allow assessment of the relationship between coverage and accuracy of variant identification.</p>
      <p>To simulate <italic toggle="yes">Mtb</italic> WGS data obtained directly from sputum samples, another six datasets were generated, each with a set number of paired-end sequence reads per sample, ranging from 500 000 to 3 000 000 paired-end reads (<xref rid="F2" ref-type="fig">Fig. 2</xref>). <italic toggle="yes">Mtb</italic> and contamination levels were randomly sampled from a beta distribution around 0.01–78.63% <italic toggle="yes">Mtb</italic> DNA to match levels observed for direct-from-sputum WGS data [<xref rid="R9" ref-type="bibr">9</xref>]. The contamination type was either <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.2553" ext-link-type="uri">P. aeruginosa</ext-link></named-content></italic>, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic>, <italic toggle="yes">H. sapiens,</italic> a mixture of <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.2553" ext-link-type="uri">P. aeruginosa</ext-link></named-content></italic>, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic> and <italic toggle="yes">H. sapiens,</italic> or an NTM mixture (<italic toggle="yes">M. intracellulare, M. abcessus</italic> or <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10879" ext-link-type="uri">M. avium</ext-link></named-content></italic> up to 20 % of the <italic toggle="yes">Mtb</italic> fraction with the remaining contamination consisting of <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.2553" ext-link-type="uri">P. aeruginosa</ext-link></named-content></italic>, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic> or <italic toggle="yes">H. sapiens</italic>).</p>
      <p>ART v.2.5.8 software [<xref rid="R15" ref-type="bibr">15</xref>] was used as described previously to emulate sequence reads for each simulated strain and its contaminant(s). In total, 600 simulated WGS data directly from sputum samples were generated in six datasets of 100 simulated samples, each dataset representing a number of paired-end sequence reads and had various levels and types of contamination, allowing us to study the relationship between contaminant nature, read number and variant identification.</p>
    </sec>
    <sec id="s4-3">
      <title>Assessment of XBS pipeline performance</title>
      <p>The performance of XBS was compared to UVP [<xref rid="R6" ref-type="bibr">6</xref>] and MTBseq [<xref rid="R16" ref-type="bibr">16</xref>], two well-established and commonly used <italic toggle="yes">Mtb</italic> pipelines. Each pipeline was evaluated using their standard settings. For UVP, variants in the GATK filtered VCF file were used for accuracy calculations. For MTBseq, two approaches were assessed. In ‘MTBseq-basic’, the ‘GATK position variants’ file was used for calculations of accuracy. In ‘MTBseq-exrep’, the variants marked ‘repetitive’ in MTBseq’s ‘MTB_Gene_Categories.txt’ were excluded to assess the effect of this commonly applied filtering step. From here on, XBS, UVP and the two MTBseq approaches will be referred to as pipelines.</p>
      <p>For XBS, VQSR was run with a truth set consisting of 5000 SNPs, 250 insertions and 250 deletions randomly selected from the mutations known to occur in the 50 simulated strains. The truth set therefore represented 10 % (5 500/55 000) of the total variants introduced <italic toggle="yes">in silico</italic>. GATKs VariantRecalibrator was run to score each SNP according to the inferred positive and negative models, built on the depth, mapping quality, mapping quality rank-sum and quality by depth statistical annotations. These annotations were processed in an allele-specific fashion to distinguish between genuine and contaminant variants occurring at the same genomic location. Annotations that showed insufficient variance, as determined by VQSR, were excluded. A logit transform and jitter were applied to improve mapping quality-based filtering. The FS, ReadPosRanksum and SOR annotations were excluded because they are more applicable for real sequence data than for simulated data. Where possible, four Gaussians were used for the positive model. GATK's ApplyVQSR was applied with a truth sensitivity level of 99.9 %. The same process was followed for INDELs except that allele specificity was disabled and, where possible, two Gaussians were used for the positive model. The MQ annotation was not taken into consideration following the GATK Best Practices Workflow for Germline short variant discovery. To avoid over-representation of contaminant alleles in the filtered dataset, INDELs in the sputum simulations were filtered using a VQSLOD score of 0 rather than a truth sensitivity level. This ensures that only those INDELs that are most likely to fall in the positive and not the negative model are kept. The resulting SNP and INDEL variants were used for the accuracy calculations. Version 4.1.9.0 of GATK was used.</p>
      <p>The six datasets simulating WGS from culture were analysed using all four pipelines (XBS, MTBseq-basic, MTBseq-exrep, UVP). The six datasets simulating WGS from sputum samples came only from three pipelines as UVP cannot analyse samples with contamination exceeding 10 %. The inferred variants identified by each pipeline were compared with the truth in terms of genome position and allelic nature (bases involved and length). The pipeline’s accuracy was calculated in terms of precision, recall and harmonic mean (F<sub>1</sub> score).</p>
      <p>For simulation of WGS from culture isolates, accuracy scores were averaged over the 100 samples in each dataset and calculated for each combination of variant type (SNP or INDEL) and genomic region (complete, complex or non-complex). F<sub>1</sub> scores were plotted for the four pipelines at six levels of depth for the complete genome, and for complex and non-complex regions separately. UVP’s list of excluded loci was used to define regions as complex, and these were filtered using GATK's SelectVariants.</p>
      <p>For simulation of WGS from sputum, the range of F<sub>1</sub> scores was calculated, separately for SNPs and INDELs, and the proportion of samples with an F<sub>1</sub> score &gt;0.9 was estimated. The number of <italic toggle="yes">Mtb</italic> reads was converted to the theoretical depth of coverage (number of simulated <italic toggle="yes">Mtb</italic> reads multiplied by average read length) and plotted against F<sub>1</sub> scores for each pipeline, contamination level and type after excluding samples with a theoretical coverage of &lt;20× so that the lesser performance of such samples did not distort these figures.</p>
      <p>Plots were created in R using the ggplot2 and gridExtra packages.</p>
    </sec>
    <sec id="s4-4">
      <title>Analysis of WGS from clinical samples</title>
      <p>The performance of the XBS variant caller was examined using two published WGS datasets obtained from clinical samples and compared to UVP and MTBseq. Data published by Roetzer <italic toggle="yes">et al</italic>. [<xref rid="R17" ref-type="bibr">17</xref>] were used to test the pipelines’ sensitivity by identifying a set of known variants (Sanger-confirmed) in DNA extracted from cultured <italic toggle="yes">Mtb</italic> samples. Data from Goig <italic toggle="yes">et al</italic>. [<xref rid="R9" ref-type="bibr">9</xref>] were used to evaluate the ability to call variants in WGS data from DNA extracted directly from sputum. Only samples with ≥5× genomic coverage depth (S02, S26, S17, S21, S31, S20, S27, S67, S09 and S69) were analysed to ensure sufficient width of coverage and prevent problems with phylogenetic inference. A reference set of 125 diverse cultured <italic toggle="yes">Mtb</italic> strains with high coverage WGS data was included in the analyses to provide a reference in the phylogenetic tree and increase the variation in statistical annotations, thereby improving VQSR for XBS. XBS VQSR was run in SNP mode with a truth-set containing lineage and DR variants [<xref rid="R18" ref-type="bibr">18–20</xref>]. These variants reflect the diversity of the bacterium (<italic toggle="yes">Mtb</italic> lineages) and the entirety of the genome, enabling VQSR to build a model to identify variants in exactly such regions and as such avoid bias. The variants from the Goig <italic toggle="yes">et al</italic>. and reference datasets were converted to FASTA format, where positions represented by fewer than 95 % of the samples were excluded. MTBseq and UVP were run in default mode.</p>
      <p>IQ-TREE v2.1.2 was used to construct maximum-likelihood trees [<xref rid="R21" ref-type="bibr">21</xref>], which were plotted with Figtree v1.4.3 [<xref rid="R22" ref-type="bibr">22</xref>], and the resulting branch lengths were used to evaluate the potential presence of false positive variants.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="s5">
    <title>Results</title>
    <sec id="s5-1">
      <title>Pipeline performance for analysis of WGS data from simulated culture isolates</title>
      <p>At the highest coverage (100×) and with the low levels of contamination (≤5 %), all pipeline approaches detected very few false positives and missed few variants, resulting in a 100 % precision for SNPs and INDELs across the genome, except for UVP which obtained a slightly lower precision of 98 % for SNP calling (<xref rid="T1 T2" ref-type="table">Tables 1 and 2</xref>). Recall scores were highest for XBS and MTBseq-basic (97–99 % for the SNPs and INDELs) compared to MTBseq-exrep and UVP which missed some variants (92 % for SNPs and 91 % for INDELs by MTBseq-exrep; 90 % for SNPs and 89 % for INDELs by UVP). The overall variant calling accuracy was highest for XBS and MTBseq-basic (F<sub>1</sub> score 0.99 for SNPs, ≥0.98 for INDELs), somewhat lower for MTBseq-exrep (F<sub>1</sub> score 0.96 for SNPs, 0.95 for INDELs) and lowest for UVP (F<sub>1</sub> score 0.94 for SNPs and INDELs) (<xref rid="F3" ref-type="fig">Fig. 3</xref>). At 100× coverage MTBseq-basic identified an average 9.2 % more true positive SNPs and 9.8 % more INDELS per genome when compared to UVP (<xref rid="T1 T2" ref-type="table">Tables 1 and 2</xref>). XBS identified an average 9.0 % more true positive SNPs and 8.1 % more INDELs per genome when compared to UVP at 100× coverage.</p>
      <fig position="float" fig-type="figure" id="F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Performance (F<sub>1</sub> scores) of four bioinformatic pipelines for SNP calling in simulated <italic toggle="yes">Mtb</italic> culture isolates at six levels of depth of <italic toggle="yes">Mtb</italic> genomic coverage.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g003" position="float"/>
      </fig>
      <table-wrap position="float" id="T1">
        <label>Table 1.</label>
        <caption>
          <p>SNP calling accuracies across the entire genome for four <italic toggle="yes">Mtb</italic> pipelines</p>
          <p><sc>na</sc>, Not applicable.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" valign="top" rowspan="1" colspan="1"/>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>XBS</p>
              </th>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>MTBseq-basic</p>
              </th>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>MTBseq-exrep</p>
              </th>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>UVP</p>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Simulated dataset</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Rrecall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV5</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.93</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.88</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.05</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.10</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.86</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.05</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.09</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.03</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.06</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV10</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.69</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.49</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.66</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.48</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.64</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV20</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.97</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.90</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.91</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>81</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV30</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.92</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.90</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.93</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>89</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV50</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.92</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.90</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.93</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>91</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.92</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.90</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>99</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM0500K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.79</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.60</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.63</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>49</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.44</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.29</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.32</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>20</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.44</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.27</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.31</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>15</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM1000K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.83</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.72</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.73</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>65</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.37</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.40</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>25</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.34</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>21</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM1500K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.93</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.70</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.75</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>58</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.54</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.46</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.47</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.43</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.45</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>33</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM2000K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.76</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.78</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>72</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.56</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>41</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.56</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.49</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.51</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>30</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM2500K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.90</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.79</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.81</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>71</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.67</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.62</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.61</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.66</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.57</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.59</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>45</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM3000K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.81</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.84</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>77</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.62</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.59</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.58</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>43</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.62</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.55</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.56</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>37</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="float" id="T2">
        <label>Table 2.</label>
        <caption>
          <p>INDEL calling accuracies across the entire genome for four <italic toggle="yes">Mtb</italic> pipelines</p>
          <p>na, Not applicable.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" valign="top" rowspan="1" colspan="1"/>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>XBS</p>
              </th>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>MTBseq-basic</p>
              </th>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>MTBseq-exrep</p>
              </th>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>UVP</p>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Simulated dataset</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Pecision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV5</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.91</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.88</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.05</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.10</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.86</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.05</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.09</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.03</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.06</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV10</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.50</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.66</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.46</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.63</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.48</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.64</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV20</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.97</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>99</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV30</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.97</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.91</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>99</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV50</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.97</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.91</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>95</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.97</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.91</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>98</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM0500K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.73</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.57</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.61</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>47</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.46</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.28</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.32</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>21</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.46</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.27</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.31</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>16</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM1000K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.88</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.70</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.74</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>67</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.56</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.36</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.40</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>28</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.55</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.34</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>27</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM1500K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.86</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.67</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.73</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>57</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.55</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.45</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.48</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>41</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.55</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.42</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.46</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>40</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM2000K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.87</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.68</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.74</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>62</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.64</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.52</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.55</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>45</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.64</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.48</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>40</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM2500K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.91</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.75</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.79</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>70</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.70</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.61</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.63</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>58</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.70</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.57</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.60</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM3000K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.86</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.79</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.81</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>73</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.69</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.58</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.61</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>47</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.69</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.54</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.59</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>45</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Lowering the depth of <italic toggle="yes">Mtb</italic> genome coverage from 100× to 20× had minimal effect on accuracy scores. XBS’s precision and recal did not change and the F<sub>1</sub> score deviated by ≤0.01 for SNPs and INDELs. The performance of MTBseq-basic and MTBseq-exrep also did not differ for these lower coverages, with similar precision for SNPs and INDELs, a drop in recall by 2 % for SNPs and 3 % for INDELs, and the F<sub>1</sub> score lowered by 0.01 for both SNPs and INDELs. UVP’s accuracy statistics did not change for INDELs, but precision, recall and F<sub>1</sub> score for SNPs dropped slightly by 4%, 1 % and 0.01, respectively.</p>
      <p>At depths ranging from 20× to 100×, the performance for SNP and INDEL calling in the non-complex regions of the <italic toggle="yes">Mtb</italic> genome was high for all four pipelines (<xref rid="F4" ref-type="fig">Fig. 4</xref> and Table S1, available in the online version of the article). Performance for variant calling in the complex regions was similar for MTBseq-basic and XBS, with an average SNP and INDEL precision of 100%, recall around 91 % and F<sub>1</sub> around 0.95. Accuracy statistics for variant calling in the complex regions could not be calculate for UVP as complex regions are excluded from from its standard output. MTBseq-exrep’s exclusion of repetitive regions was less strict than UVP’s excluded loci and hence the former was able to identify a small number of variants in the complex regions.</p>
      <fig position="float" fig-type="figure" id="F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Performance (F<sub>1</sub> scores) of four bioinformatic pipelines for SNP calling in simulated <italic toggle="yes">Mtb</italic> culture isolates at six levels of depth of <italic toggle="yes">Mtb</italic> genomic coverage, stratified by complex and non-complex regions of the genome.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g004" position="float"/>
      </fig>
      <p>At 10× depth of coverage, all four pipelines retained their precision but recall was affected. UVP and both MTBseq approaches missed many variants, resulting in a recall of around 50 % for SNPs and INDELs. Consequently, F<sub>1</sub> scores dropped drastically for MTBseq-basic (0.69 for SNPs and 0.66 for INDELs), MTBseq-exrep (0.66 for SNPs and 0.63 for INDELs) and UVP (0.64 for both SNPs and INDELs). In contrast, XBS’s accuracy remained high, with recall at 99 % for SNPs and 98 % for INDELs and F<sub>1</sub> scores of 0.99 for SNPs and INDELs (<xref rid="F3" ref-type="fig">Fig. 3</xref>). Only at an <italic toggle="yes">Mtb</italic> genome coverage of 5× was the performance of XBS noticeably affected, although performance remained largely accurate, with F<sub>1</sub> scores of 0.96 for SNPs and 0.95 for INDELs, a precision of 100 % for both, and recall of 93 % for SNPs and 91 % for INDEL calling. XBS’s ability to call variants in both low-coverage and complex regions was retained (<xref rid="F4" ref-type="fig">Fig. 4</xref>).</p>
      <p>The type of low-level contaminant (<italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.6366" ext-link-type="uri">M. intracellulare</ext-link></named-content></italic>, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.6313" ext-link-type="uri">M. abscessus</ext-link></named-content></italic>, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10879" ext-link-type="uri">M. avium</ext-link></named-content></italic>, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.2553" ext-link-type="uri">P. aeruginosa</ext-link></named-content></italic>, <italic toggle="yes">S. epidermidis, H. sapiens</italic>, NTM mixture or mixture of all six contaminants) only affected the F<sub>1</sub> estimates of UVP due to false positive SNP calls when NTMs or <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic> were present (Fig. S1 and Table S1). The level of contamination (varying from 0 to 5 %) also only affected UVP’s performance, with a decrease in precision and SNP F<sub>1</sub> scores at higher levels of contamination (Fig. S2 and Table S1).</p>
    </sec>
    <sec id="s5-2">
      <title>Pipeline performance for analysis of WGS data from simulated sputum samples</title>
      <p>XBS outperformed both MTBseq approaches when analysing the data simulated to represent WGS directly from sputum. For SNPs, F<sub>1</sub> scores ranged from 0.63 to 0.84 for XBS compared to 0.33–0.58 for MTBseq-basic and 0.31–0.59 for MTBseq-exrep. Using XBS, 49–77 % of samples achieved F<sub>1</sub> scores above 0.90, compared to 20–53% and 15–45 % for MTBseq-basic and MTBseq-exrep, respectively (<xref rid="T1 T2" ref-type="table">Tables 1 and 2</xref>). For INDELs F<sub>1</sub> scores ranged from 0.61 to 0.81 for XBS, 0.32 to 0.63 for MTBseq-basic and 0.31 to 0.60 for MTBseq-exrep. Using XBS, 47–73 % of samples achieved F<sub>1</sub> scores above 0.9, compared to 21–58 % and 16–53 % for MTBseq-basic and MTBseq-exrep, respectively. Plotting the theoretical depth of coverage against F<sub>1</sub> score showed that XBS calls SNPs and INDELs with higher accuracy at low genomic depth of coverage compared to both MTBseq approaches (<xref rid="F5" ref-type="fig">Fig. 5</xref>).</p>
      <fig position="float" fig-type="figure" id="F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Performance (F<sub>1</sub> scores) of different bioinformatic pipelines for SNP and INDEL calling from contaminated sputum samples at various levels of theoretical depth of <italic toggle="yes">Mtb</italic> genomic coverage.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g005" position="float"/>
      </fig>
      <p>SNP accuracy of XBS was unaffected by contamination level or type (<xref rid="F6" ref-type="fig">Fig. 6</xref>). In contrast, accuracy for MTBseq-basic and MTBseq-exrep depended on the type and level of contamination. <italic toggle="yes">H. sapiens</italic> contamination did not affect the F<sub>1</sub> score, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic> lowered the F<sub>1</sub> score to 0.90 when the contamination level was ≥50 %, and NTM and bacterial/human contamination mixtures reduced the F<sub>1</sub> score when the contamination level was ≥75 %. For INDELs, the MTBseq-basic pipeline performed slightly better than XBS when <italic toggle="yes">Mtb</italic> depth of coverage was ≥20×, with average F<sub>1</sub> scores of 0.99 for MTBseq-basic, 0.95 for MTBseq-exrep and 0.96 for XBS respectively. (Figs S3 and S5B).</p>
      <fig position="float" fig-type="figure" id="F6">
        <label>Fig. 6.</label>
        <caption>
          <p>Performance (F<sub>1</sub> scores) of three bioinformatic pipelines for SNP calling in sputum samples with minimum 20× <italic toggle="yes">Mtb</italic> coverage and various types and levels of contamination.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g006" position="float"/>
      </fig>
    </sec>
    <sec id="s5-3">
      <title>Pipeline performance for analysis of WGS data from clinical culture isolates</title>
      <p>MTBseq and XBS could analyse all samples from the Roetzer <italic toggle="yes">et al</italic>. dataset, whereas UVP excluded 33 of the 86 (38 %) samples. Of the 85 Sanger-confirmed mutations, MTBseq-basic recovered 81, MTBseq-exrep 79, UVP 61 and XBS 84, corresponding to sensitivities of 95.3, 92.9, 71.8 and 98.8%, respectively (Table S3). The single variant missed by XBS was located right on the border of a repetitive region, resulting in reads with sub-optimal mapping qualities.</p>
    </sec>
    <sec id="s5-4">
      <title>Pipeline performance for analysis of WGS data from clinical sputum samples</title>
      <p>UVP failed to analyse any sample included in the Goig <italic toggle="yes">et al</italic>. dataset, as contamination levels were above the 10 % threshold for all samples. For the 10 Goig <italic toggle="yes">et al</italic>. samples and the 125 reference samples, XBS reported 11 977 variant positions (after exclusion of the rRNA regions), 13.9 % more than the 10 514 variants reported by MTBseq. The number of variants called by MTBseq further reduced to 10 114 when variants within 12 bp of each other were excluded.</p>
      <p>There was no evidence of false positive variants when using XBS (no obvious branch extension for any sputum samples) with the highly conserved rRNA regions removed (<xref rid="F7" ref-type="fig">Fig. 7</xref>). When including the genes coding for rRNA, obvious extended branch lengths were present for three samples (S02, S26 and S20, Fig. S4) due to VQSLOD scores for such variants that had fallen just within the within the positive VQSR model. When using MTBseq, there were also no obvious branch extensions but one sample (S26) showed a shorter branch length compared to its nearest neighbours in the phylogenetic tree. This was the case for FASTA files including and excluding SNPs within 12 bp distance from each other (Figs S5 and S6).</p>
      <fig position="float" fig-type="figure" id="F7">
        <label>Fig. 7.</label>
        <caption>
          <p>XBS maximum-likelihood tree showing the location of Goig <italic toggle="yes">et al</italic>.’s sputum samples (marked in red) in relation to the reference dataset. The scale bar is in substitutions per site and refers to the branch lengths.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g007" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s6">
    <title>Discussion</title>
    <p>We developed XBS and applied the joint variant calling and machine-learning-based variant filtering approaches, initially designed for human genome analyses, to a pipeline for <italic toggle="yes">Mtb</italic> WGS analyses. Using 1200 simulated samples representing characteristics of WGS data from <italic toggle="yes">Mtb</italic> culture or directly from sputum samples, we demonstrated that XBS increases the performance in variant calling compared to existing pipelines (UVP and MTBseq), especially for WGS data from less-than-perfect, contaminated low<italic toggle="yes">-Mtb</italic>-burden samples. The strain simulation, variant calling and filtering approach presented here may also benefit the study of other bacteria where sequence coverage, complex genomes or contamination hinder accurate identification of genetic variants.</p>
    <p>We showed that current pipeline approaches perform well for SNP and INDEL calling when sequencing DNA extracts from decontaminated cultures with high (≥20×) depth, but accuracy decreases when depth of coverage is low (5–10×) or contamination levels are high (&gt;50 %). The novel XBS pipeline substantially outperformed other MTB pipelines for SNP and INDEL calling in <italic toggle="yes">Mtb</italic> at low-coverage-depth culture samples and highly contaminated, low-coverage-depth sputum samples.</p>
    <p>When analysing WGS data from culture isolates at the current standard 30–100× depth coverage, all pipelines accurately called SNPs and INDELs (F<sub>1</sub> scores &gt;0.90). Of the three pipelines assessed, UVP’s performance was slightly inferior given its lower precision (false positive variants) at higher (5%) contamination, particularly when the contaminant was an NTM. XBS and MTBseq-basic were not affected by low-level (0–5 %) contamination and identified on average 9 % more SNPs and INDELs compared to UVP by investigating <italic toggle="yes">Mtb</italic>’s complex genomic regions. Identifying 9 % more variants could greatly benefit transmission and genome-wide association studies.</p>
    <p>At lower coverage (&lt;20×), XBS was the only pipeline that could accurately call SNPs and INDELs, probably due to the joint calling and filtering processes that permit lower allele coverages. XBS’s accuracy remained high at 5× depth, where the modest drop in F<sub>1</sub> score was due to a slightly lower recall rate and difficulty in accurately calling genuine INDELs due to coverage gaps. This is expected as, according to the Poisson distribution, only 99.3 % of the genome is covered by at least one read at 5× coverage. The low-level contamination simulated for the culture samples did not affect the accuracy of the XBS or MTBseq pipelines. The UVP pipeline, however, was affected by both the level and the type of low-level contamination, and such effects have been observed previously [<xref rid="R23" ref-type="bibr">23</xref>]. Considering these findings it is understandable that UVP uses a strict contamination cut-off, but the other pipelines show that variants can be identified more accurately despite the absence of such cut-offs. Sequencing at 5× depth using XBS resulted in an average SNP F<sub>1</sub> score of 0.96 (minimum 0.95) and average INDEL F<sub>1</sub> score of 0.95 (minimum 0.91), whereas the F<sub>1</sub> scores of the other pipelines were ≤0.10 for both SNPs and INDELs. Such low-coverage sequencing could lower the costs by a factor of 10 compared to standard 50× coverage sequencing. In combination with low-cost library preparations, which is the main driver of sequencing cost, this could open the door to large-scale population sequencing projects in high tuberculosis-burden settings.</p>
    <p>WGS data obtained directly from sputum are characterized by a low number of <italic toggle="yes">Mtb</italic> reads (theoretical coverage), a high level of contamination and the presence of a mix of contaminants. The novel XBS pipeline showed superior performance for analysing such impure sequencing data. Due to the joint calling approach, XBS could analyse samples with much lower genomic coverage than the two MTBseq approaches. XBS successfully identified SNPs and INDELs in an average of 73 % of samples with 2,5–5 million paired-end reads, where MTBseq-basic only successfully analysed 50 % and MTBseq-exrep 45 % of such samples. By employing VQSR filtering, which identifies contaminant reads based on a multitude of statistical annotations, XBS’s performance was not affected by level or type of contaminants. Hard filtering, as is implemented in MTBseq-basic and MTBseq-exrep, was not sufficient at high levels (&gt;50 %) of contamination because contaminant alleles may be interpreted as the most likely and therefore genuine allele, leading to false positives, once they reach coverage levels greater than the <italic toggle="yes">Mtb</italic> allele. For MTBseq, the type of contaminant affected the accuracy. High levels of human DNA did not affect accuracy as these are unlikely to map to the reference genome, but <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic> contamination started to have an effect from 50 % upwards as contaminant alleles then outnumber that of <italic toggle="yes">Mtb</italic>. The NTM-mix only affected accuracy at high contamination despite the great genome similarity among NTMs. This counterintuitive finding is probably because high levels of contamination are required before one of the NTM contaminants present in the mix approaches 50 % allele frequency.</p>
    <p>Since it cannot be said exactly which samples underperform in terms of variant identification accuracy in a clinical dataset, it is best to ensure an acceptable minimum accuracy instead. When employing XBS on WGS data from real-life sputum, our data suggest that it may be prudent to restrict the analyses to those samples that present a coverage of ≥10×. A 10× cut off would result in average SNP F<sub>1</sub> scores of 0.99 (minimum 0.98) and average INDEL F<sub>1</sub> scores of 0.97 (minimum 0.91) for 60 % (60/100) of the samples in the 300 0000 PE read dataset. MTBseq-basic would result in average SNP F<sub>1</sub> scores of 0.91 (minimum 0.53) and average INDEL F<sub>1</sub> scores of 0.95 (minimum 0.69) for the same samples.</p>
    <p>Comparisons of the performance of <italic toggle="yes">Mtb</italic> pipelines is important but hampered by the absence of large datasets for which the true variants are known. To date, studies assessing the performance of <italic toggle="yes">Mtb</italic> pipelines have compared their ability to identify transmission clusters as established through contact tracing or older molecular methods, or by comparing the detection of genomic drug resistance in relation to phenotypic tests or Sanger-confirmed variants [<xref rid="R6" ref-type="bibr">6, 16, 24, 25</xref>]. These approaches suffer from important limitations. Contact tracing is complex and may not necessarily identify all clusters correctly [<xref rid="R26" ref-type="bibr">26</xref>]. Older molecular methods have significantly lower resolution than WGS so that all pipelines call clusters identified by these older methods with relative ease [<xref rid="R27" ref-type="bibr">27</xref>]. Using genomic drug resistance to compare pipelines is affected by the reference drug resistance mutation list used by each pipeline, whereas focusing on a limited number of Sanger-confirmed variants is not representative for the entire genome. The only other study that used simulated read datasets to compare combinations of mapper, caller and filtering methods found that the GATK variant caller in combination with VQSR consistently had the highest precision scores [<xref rid="R28" ref-type="bibr">28</xref>], supporting the findings of our study. This study, however, had multiple limitations. First, GATK calling was performed for one sample at a time, which is not optimal for VQSR or for low-coverage samples. Second, for the VQSR truth sets, half of the samples’ variants with the best quality score were taken, an approach that is problematic when high-frequency contaminant alleles are present. Third, the use of the clinical CDC1551 strain prohibited an assessment of accuracy for the complex regions as the exact location of CDC1551 variants in relation to H37Rv cannot be established with certainty for complex regions.</p>
    <p>We successfully overcame the limitations of prior <italic toggle="yes">Mtb</italic> pipeline accuracy studies by using an <italic toggle="yes">in silico</italic> approach to construct a fully representative variant truth set. The simulated dataset resembled clinical datasets by ensuring that some strains occurred once while others occurred several times. VQSR benefited from the presence of clonal strains as it improves the identification of variants in low-coverage samples observed in other samples. Our datasets simulating culture isolates represented the range of depth (5–100×) and low levels of contamination (0–5 %). Our simulated sputum datasets contained more than 21.4 % contamination (mean 82.12%, maximum 99.99%) and thus very low levels of <italic toggle="yes">Mtb</italic> DNA, which correspond to the findings of a recent study of the clinical samples where most (51%) WGS data showed less than 5 % <italic toggle="yes">Mtb</italic> DNA sequence reads [<xref rid="R9" ref-type="bibr">9</xref>]. The use of the simulated datasets allowed us not only to accurately quantify the performance of different pipelines for variant calling throughout the entire genome, including the complex regions, but also to assess the effect of important characteristics that determine accuracy such as mycobacterial burden, and level and type of contamination.</p>
    <p>The excellent performance of XBS for the analysis of complex samples was confirmed when analysing WGS data obtained from clinical samples. Analyses of the WGS data from clinical culture isolates showed that XBS outperformed other pipelines (including pipelines not investigated in this study) in terms of sensitivity (Table S3). The high specificity of XBS matches the findings of the culture simulations where the four pipeline approaches show similar recall scores. Analysis of WGS data obtained from DNA extracted directly from sputum samples confirmed that only XBS and MTBseq, but not UVP, could successfully analyse such data. While both pipelines showed high specificity (no evidence of false positive variants resulting in branch extension on the phylogeny), the performance of XBS was superior to MTBseq as it allowed the identification of 13.9 % more variants.</p>
    <p>Several limitations remain to the novel XBS variant caller. First, XBS (and other pipelines) cannot analyse samples when NTM contaminant sequences exceed 20 %. Such samples would require analyses by programs such as QuantTB that can potentially filter out NTM contaminants before <italic toggle="yes">Mtb</italic> variant identification as they resemble multiple infections [<xref rid="R29" ref-type="bibr">29</xref>]. Second, XBS requires multiple samples for each run. Previously inferred Genomic VCFs can, however, be included from the Combine VCF step just before the VQSR, eliminating the need to batch new samples. Third, the highly conserved rRNA regions had to be excluded for optimal specificity as sequences in these regions from contaminating bacteria can map to the <italic toggle="yes">Mtb</italic> reference genome with very high confidence, making the variants in such regions indistinguishable in terms of the statistical annotations used by VQSR. Eliminating these regions may result in some loss of the genomic information, albeit a small loss as this region represents only 0.1 % of the genome Fourth, we used H37Rv as the reference genome for all analysis. If the <italic toggle="yes">Mtb</italic> ancestral genome were used as the reference genome instead, a VQSR truth-set could be constructed by aligning the ancestral genome to H37Rv and translating the latter's lineage and DR truth variants. When applying the XBS approach to other bacteria, one should employ well-established variants that occur throughout the entire genome for constructing the VQSR truth set. Finally, we were not able to compare the run time of XBS to the other pipelines as there were important differences in the analyses run other than the variant calling core, and the number of samples analysed differed due to pipeline restrictions. However, elimination of the adapter removal and base recalibration steps reduces the overall processing time and exclusion of meta-genomic classification further reduces computing time. It also prevents the need for computing infrastructure with large memory requirements. To get an idea of the run time for genuine sputum samples we ran the 10 Goig <italic toggle="yes">et al</italic>. samples through the XBS core; the mapping and haplotype calling took under 15 min for each sample and was performed in parallel, and subsequent joint-calling and VQSR took under 5 min (eight threads and 64 GB memory provided).</p>
    <p>Direct-from-sputum WGS data contain a wealth of diverse bacterial contaminants besides that of human origin and all these contaminants occur at widely varying levels. It was not possible to represent this endless variety of bacterial contaminants in our simulation experiments, and hence the most commonly observed bacterial contaminants were used instead [<xref rid="R2" ref-type="bibr">2</xref>], NTMs were included because these pose a serious challenge for <italic toggle="yes">Mtb</italic> variant calling. Contaminant levels were simulated to match those observed for genuine sputum samples [<xref rid="R9" ref-type="bibr">9</xref>]. As such it was possible to study the effect of the various contaminants and their levels on variant calling; this would not have been possible had all the endless contaminants observed for direct-from-sputum samples been used. To show that XBS was able to handle such genuinely diverse contamination, two clinical WGS datasets were studied, one from cultured samples and one direct-from-sputum samples. Further studies are required to study the effect of the full diversity of contaminants that are observed for direct-from-sputum samples.</p>
    <p>In conclusion, all pipelines studied (MTBseq, UVP, XBS) accurately analysed WGS data from <italic toggle="yes">Mtb</italic> culture isolates. Only XBS and MTBseq could accurately identify variants in low<italic toggle="yes">-Mtb</italic>-coverage and highly contaminated samples and XBS achieved higher performance parameters of all the pipelines studied. High performance at low depth could decrease sequencing cost and improve WGS analysis directly from sputum samples. The accurate identification of variants in the complex genomic <italic toggle="yes">Mtb</italic> regions allow for improved resolution in transmission studies through increased genetic resolution and creates the ability to explore the functional role of variants in these complex regions. Taken together, the novel XBS pipeline sets the stage for the next generation of <italic toggle="yes">Mtb</italic> WGS studies.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Data</title>
    <supplementary-material position="float" id="supp1" content-type="local-data">
      <caption>
        <title>Supplementary material 1</title>
      </caption>
      <media xlink:href="mgen-7-0689-s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Funding information</title>
    <p>This work was supported by the Research Foundation Flanders (FWO) (grant number FWO Odysseus G0F8316N).</p>
  </ack>
  <ack id="ack2">
    <title>Acknowledgements</title>
    <p>We would like to thank the members of the Tuberculosis Omics ResearCH (TORCH) consortium for helpful discussions and particularly Elise De Vos for discussions surrounding sputum simulation. We thank the reviewers for helpful comments and Galo A. Goig <italic toggle="yes">et al</italic>. for providing additional direct-from-sputum sequencing data.</p>
  </ack>
  <ack id="ack3">
    <title>Author contributions</title>
    <p>T.H.H., R.M.W. and A.V.R.: conceptualized the project and methodology. T.H.H. and L.V.: curated the data and designed and scripted the software. R.M.W. and A.V.R.: acquired the funding. T.H.H., L.V., R.M.W. and A.V.R.: wrote, reviewed and edited the manuscript.</p>
  </ack>
  <ack id="ack4">
    <title>Conflicts of interest</title>
    <p content-type="COI-statement">The authors declare that there are no conflicts of interest.</p>
  </ack>
  <fn-group>
    <fn id="FN1">
      <p>Abbreviations: DR, drug resistance; GATK, Genome Analysis ToolKit; GVCF, Genomic Variant Call Format; INDEL, Insertion/Deletion; <italic toggle="yes">Mtb</italic>, <italic toggle="yes">Mycobacterium tuberculosis</italic>; NTM, non-tuberculous mycobacteria; SNP, Single Nucleotide Polymorphism; UVP, Unified Variant Pipeline; VCF, Variant Call Format; VQSR, Variant Quality Score Recalibration; WGS, whole genome sequencing; XBS, compleX Bacterial Sample.</p>
    </fn>
    <fn id="FN2">
      <p>All supporting data, code and protocols have been provided within the article or through supplementary data files. Three supplementary tables and six supplementary figures are available with the online version of this article.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="R1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meehan</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Goig</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Kohl</surname>
            <given-names>TA</given-names>
          </name>
        </person-group>
        <article-title>Whole genome sequencing of <italic toggle="yes">Mycobacterium tuberculosis</italic>: current standards and open issues</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2019</year>
        <volume>17</volume>
        <fpage>533</fpage>
        <lpage>545</lpage>
        <pub-id pub-id-type="doi">10.1038/s41579-019-0214-5</pub-id>
        <?supplied-pmid 31209399?>
        <pub-id pub-id-type="pmid">31209399</pub-id>
      </element-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McClean</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stanley</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Stanley</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Identification and characterization of breakthrough contaminants associated with the conventional isolation of <italic toggle="yes">Mycobacterium tuberculosis</italic>
</article-title>
        <source>J Med Microbiol</source>
        <year>2011</year>
        <volume>60</volume>
        <fpage>1292</fpage>
        <lpage>1298</lpage>
        <pub-id pub-id-type="doi">10.1099/jmm.0.030619-0</pub-id>
        <?supplied-pmid 21527550?>
        <pub-id pub-id-type="pmid">21527550</pub-id>
      </element-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rachow</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Saathoff</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mtafya</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mapamba</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mangu</surname>
            <given-names>C</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>The impact of repeated NALC/NaOH- decontamination on the performance of Xpert MTB/RIF assay</article-title>
        <source>Tuberculosis</source>
        <year>2018</year>
        <volume>110</volume>
        <fpage>56</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tube.2018.04.001</pub-id>
        <?supplied-pmid 29779774?>
        <pub-id pub-id-type="pmid">29779774</pub-id>
      </element-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Farmanfarmaei</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kamakoli</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Sadegh</surname>
            <given-names>HR</given-names>
          </name>
        </person-group>
        <article-title>Bias in detection of <italic toggle="yes">Mycobacterium tuberculosis</italic> polyclonal infection: Use clinical samples or cultures?</article-title>
        <source>Mol Cell Probes</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>1</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mcp.2017.01.002</pub-id>
        <?supplied-pmid 28130122?>
        <pub-id pub-id-type="pmid">28130122</pub-id>
      </element-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nimmo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Doyle</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Whole genome sequencing <italic toggle="yes">Mycobacterium tuberculosis</italic> directly from sputum identifies more genetic diversity than sequencing from culture</article-title>
        <source>BMC Genomics</source>
        <year>2019</year>
        <volume>20</volume>
        <elocation-id>389</elocation-id>
        <pub-id pub-id-type="doi">10.1186/s12864-019-5841-8</pub-id>
        <?supplied-pmid 31142261?>
        <pub-id pub-id-type="pmid">31109296</pub-id>
      </element-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ezewudo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Borens</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chiner-Oms</surname>
            <given-names>Á</given-names>
          </name>
        </person-group>
        <article-title>tegrating standardized whole genome sequence analysis with a global <italic toggle="yes">Mycobacterium tuberculosis</italic> antibiotic resistance knowledgebase</article-title>
        <source>Sci Rep</source>
        <year>2018</year>
        <volume>8</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <comment>DOI: 10.1038/s41598-018-33731-1</comment>
        <pub-id pub-id-type="pmid">29311619</pub-id>
      </element-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Genomic mapping by fingerprinting random clones: a mathematical analysis</article-title>
        <source>Genomics</source>
        <year>1988</year>
        <volume>2</volume>
        <fpage>231</fpage>
        <lpage>239</lpage>
        <pub-id pub-id-type="doi">10.1016/0888-7543(88)90007-9</pub-id>
        <?supplied-pmid 3294162?>
        <pub-id pub-id-type="pmid">3294162</pub-id>
      </element-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kohl</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Diel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Harmsen</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Whole-genome-based <italic toggle="yes">Mycobacterium tuberculosis</italic> surveillance: a standardized, portable, and expandable approach</article-title>
        <source>J Clin Microbiol</source>
        <year>2014</year>
        <volume>52</volume>
        <fpage>2479</fpage>
        <lpage>2486</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.00567-14</pub-id>
        <?supplied-pmid 24789177?>
        <pub-id pub-id-type="pmid">24789177</pub-id>
      </element-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goig</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Cancino-Muñoz</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Torres-Puente</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Whole-genome sequencing of <italic toggle="yes">Mycobacterium tuberculosis</italic> directly from clinical samples for high-resolution genomic epidemiology and drug resistance surveillance: an observational study</article-title>
        <source>The Lancet Microbe</source>
        <year>2020</year>
        <volume>1</volume>
        <fpage>e175</fpage>
        <lpage>e183</lpage>
        <pub-id pub-id-type="doi">10.1016/S2666-5247(20)30060-4</pub-id>
      </element-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kato-Maeda</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Passarelli</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Use of whole genome sequencing to determine the microevolution of <italic toggle="yes">Mycobacterium tuberculosis</italic> during an outbreak</article-title>
        <source>PLoS One</source>
        <year>2013</year>
        <volume>8</volume>
        <elocation-id>e58235</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0058235</pub-id>
        <?supplied-pmid 23472164?>
        <pub-id pub-id-type="pmid">23472164</pub-id>
      </element-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ruano-Rubio</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Scaling accurate genetic variant discovery to tens of thousands of samples</article-title>
        <source>BioRxiv</source>
        <year>2017</year>
        <fpage>201178</fpage>
      </element-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>491</fpage>
        <pub-id pub-id-type="doi">10.1038/ng.806</pub-id>
        <?supplied-pmid 21478889?>
        <pub-id pub-id-type="pmid">21478889</pub-id>
      </element-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM</article-title>
        <source>arXiv Prepr</source>
        <year>2013</year>
        <volume>3997</volume>
      </element-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pettengill</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>Y</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>CFSAN SNP pipeline: An automated method for constructing SNP matrices from next-generation sequence data</article-title>
        <source>PeerJ Comput Sci</source>
        <year>2015</year>
        <volume>1</volume>
        <elocation-id>e20</elocation-id>
        <pub-id pub-id-type="doi">10.7717/peerj-cs.20</pub-id>
      </element-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>ART: a next-generation sequencing read simulator</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>593</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id>
        <?supplied-pmid 22199392?>
        <pub-id pub-id-type="pmid">22199392</pub-id>
      </element-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kohl</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Utpatel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schleusener</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>MTBseq: a comprehensive pipeline for whole genome sequence analysis of <italic toggle="yes">Mycobacterium tuberculosis</italic> complex isolates</article-title>
        <source>PeerJ</source>
        <year>2018</year>
        <volume>6</volume>
        <elocation-id>e5895</elocation-id>
        <pub-id pub-id-type="doi">10.7717/peerj.5895</pub-id>
        <?supplied-pmid 30479891?>
        <pub-id pub-id-type="pmid">30479891</pub-id>
      </element-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roetzer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Diel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kohl</surname>
            <given-names>TA</given-names>
          </name>
        </person-group>
        <article-title>Whole genome sequencing versus traditional genotyping for investigation of a <italic toggle="yes">Mycobacterium tuberculosis</italic> outbreak: a longitudinal molecular epidemiological study</article-title>
        <source>PLoS Med</source>
        <year>2013</year>
        <volume>10</volume>
        <elocation-id>e1001387</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pmed.1001387</pub-id>
        <?supplied-pmid 23424287?>
        <pub-id pub-id-type="pmid">23424287</pub-id>
      </element-citation>
    </ref>
    <ref id="R18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coll</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>McNerney</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Guerra-Assunção</surname>
            <given-names>JA</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>A robust SNP barcode for typing <italic toggle="yes">Mycobacterium tuberculosis</italic> complex strains</article-title>
        <source>Nat Commun</source>
        <year>2014</year>
        <volume>5</volume>
        <fpage>1</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1038/ncomms5812</pub-id>
      </element-citation>
    </ref>
    <ref id="R19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coll</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Phelan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hill-Cawthorne</surname>
            <given-names>GA</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide analysis of multi-and extensively drug-resistant <italic toggle="yes">Mycobacterium tuberculosis</italic>
</article-title>
        <source>Nat Genet</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>307</fpage>
        <lpage>316</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-017-0029-0</pub-id>
        <?supplied-pmid 29358649?>
        <pub-id pub-id-type="pmid">29358649</pub-id>
      </element-citation>
    </ref>
    <ref id="R20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Napier</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Campino</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Merid</surname>
            <given-names>Y</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Robust barcoding and identification of <italic toggle="yes">Mycobacterium tuberculosis</italic> lineages for epidemiological and clinical studies</article-title>
        <source>Genome Med</source>
        <year>2020</year>
        <volume>12</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1186/s13073-020-00817-3</pub-id>
      </element-citation>
    </ref>
    <ref id="R21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Chernomor</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>IQ-TREE 2: new models and efficient methods for phylogenetic inference in the genomic era</article-title>
        <source>Mol Biol Evol</source>
        <year>2020</year>
        <volume>37</volume>
        <fpage>1530</fpage>
        <lpage>1534</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msaa015</pub-id>
        <?supplied-pmid 32011700?>
        <pub-id pub-id-type="pmid">32011700</pub-id>
      </element-citation>
    </ref>
    <ref id="R22">
      <label>22</label>
      <element-citation publication-type="journal">
        <comment>N.d</comment>
        <article-title>Rambaut A</article-title>
        <source>FigTree</source>
        <ext-link xlink:href="https://github.com/rambaut/figtree/" ext-link-type="uri">https://github.com/rambaut/figtree/</ext-link>
      </element-citation>
    </ref>
    <ref id="R23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goig</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Blanco</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Garcia-Basteiro</surname>
            <given-names>AL</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Contaminant DNA in bacterial sequencing experiments is a major source of false genetic variability</article-title>
        <source>BMC Biol</source>
        <year>2020</year>
        <volume>18</volume>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="pmid">31898513</pub-id>
      </element-citation>
    </ref>
    <ref id="R24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schleusener</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Köser</surname>
            <given-names>CU</given-names>
          </name>
          <name>
            <surname>Beckert</surname>
            <given-names>P</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title><italic toggle="yes">Mycobacterium tuberculosis</italic> resistance prediction and lineage classification from genome sequencing: Comparison of automated analysis tools</article-title>
        <source>Sci Rep</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/srep46327</pub-id>
        <pub-id pub-id-type="pmid">28127051</pub-id>
      </element-citation>
    </ref>
    <ref id="R25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jajou</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kohl</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Towards standardisation: Comparison of five whole genome sequencing (WGS) analysis pipelines for detection of epidemiologically linked tuberculosis cases</article-title>
        <source>Euro Surveill</source>
        <year>2019</year>
        <volume>24</volume>
        <pub-id pub-id-type="doi">10.2807/1560-7917.ES.2019.24.50.1900130</pub-id>
        <?supplied-pmid 31847944?>
        <pub-id pub-id-type="pmid">31847944</pub-id>
      </element-citation>
    </ref>
    <ref id="R26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nikolayevskyy</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Kranzer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Niemann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Whole genome sequencing of <italic toggle="yes">Mycobacterium tuberculosis</italic> for detection of recent transmission and tracing outbreaks: a systematic review</article-title>
        <source>Tuberculosis</source>
        <year>2016</year>
        <volume>98</volume>
        <fpage>77</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tube.2016.02.009</pub-id>
        <?supplied-pmid 27156621?>
        <pub-id pub-id-type="pmid">27156621</pub-id>
      </element-citation>
    </ref>
    <ref id="R27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meehan</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Moris</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kohl</surname>
            <given-names>TA</given-names>
          </name>
        </person-group>
        <article-title>The relationship between transmission time and clustering methods in <italic toggle="yes">Mycobacterium tuberculosis</italic> epidemiology</article-title>
        <source>EBioMedicine</source>
        <year>2018</year>
        <volume>37</volume>
        <fpage>410</fpage>
        <lpage>416</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ebiom.2018.10.013</pub-id>
        <?supplied-pmid 30341041?>
        <pub-id pub-id-type="pmid">30341041</pub-id>
      </element-citation>
    </ref>
    <ref id="R28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Walter</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Colijn</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>T</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Genomic variant-identification methods may alter <italic toggle="yes">Mycobacterium tuberculosis</italic> transmission inferences</article-title>
        <source>Microb Genomics</source>
        <year>2020</year>
        <volume>6</volume>
        <pub-id pub-id-type="doi">10.1099/mgen.0.000418</pub-id>
      </element-citation>
    </ref>
    <ref id="R29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anyansi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Keo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>QuantTB--A method to classify mixed <italic toggle="yes">Mycobacterium tuberculosis</italic> infections within whole genome sequencing data</article-title>
        <source>BMC Genomics</source>
        <year>2020</year>
        <volume>21</volume>
        <elocation-id>80</elocation-id>
        <pub-id pub-id-type="doi">10.1186/s12864-020-6486-3</pub-id>
        <?supplied-pmid 31992201?>
        <pub-id pub-id-type="pmid">31992201</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Microb Genom</journal-id>
    <journal-id journal-id-type="iso-abbrev">Microb Genom</journal-id>
    <journal-id journal-id-type="hwp">mgen</journal-id>
    <journal-id journal-id-type="publisher-id">mgen</journal-id>
    <journal-title-group>
      <journal-title>Microbial Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2057-5858</issn>
    <publisher>
      <publisher-name>Microbiology Society</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8743552</article-id>
    <article-id pub-id-type="pmid">34793294</article-id>
    <article-id pub-id-type="publisher-id">000689</article-id>
    <article-id pub-id-type="doi">10.1099/mgen.0.000689</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Articles</subject>
        <subj-group subj-group-type="heading">
          <subject>Pathogens and Epidemiology</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Comprehensive and accurate genetic variant identification from contaminated and low-coverage <italic toggle="yes">Mycobacterium tuberculosis</italic> whole genome sequencing data</article-title>
      <alt-title alt-title-type="recto-page-foot">
        <ext-link xlink:href="http://mgen.microbiologyresearch.org" ext-link-type="uri">http://mgen.microbiologyresearch.org</ext-link>
      </alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6237-3898</contrib-id>
        <name>
          <surname>Heupink</surname>
          <given-names>Tim H.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="cor1" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5647-5852</contrib-id>
        <name>
          <surname>Verboven</surname>
          <given-names>Lennert</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5741-7358</contrib-id>
        <name>
          <surname>Warren</surname>
          <given-names>Robin M.</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7666-3263</contrib-id>
        <name>
          <surname>Van Rie</surname>
          <given-names>Annelies</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <aff id="aff1"><label><sup>1</sup>​</label><institution content-type="department">Family Medicine and Population Health (FAMPOP)</institution>, <institution>Faculty of Medicine and Health Sciences, University of Antwerp</institution>, <addr-line content-type="city">Antwerp</addr-line>, <country>Belgium</country></aff>
      <aff id="aff2"><label><sup>2</sup>​</label><institution content-type="department">South African Medical Research Council Centre for Tuberculosis Research and DST/NRF Centre of Excellence for Biomedical Tuberculosis Research</institution>, <institution>Division of Molecular Biology and Human Genetics, Stellenbosch University</institution>, <addr-line content-type="city">Stellenbosch</addr-line>, <country>South Africa</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><bold>*Correspondence:</bold> Tim H. Heupink, <email xlink:href="mailto:tim.heupink@uantwerpen.be">tim.heupink@uantwerpen.be</email>
</corresp>
      <fn fn-type="accession-no">
        <p>Simulated sequencing data have been deposited in SRA BioProject PRJNA706121.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <!--PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>.-->
    <volume>7</volume>
    <issue>11</issue>
    <elocation-id>000689</elocation-id>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>09</day>
        <month>9</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 The Authors</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution NonCommercial License.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="mgen-7-0689.pdf"/>
    <abstract>
      <p>Improved understanding of the genomic variants that allow <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10886" ext-link-type="uri">Mycobacterium tuberculosis</ext-link></named-content></italic> (<italic toggle="yes">Mtb</italic>) to acquire drug resistance, or tolerance, and increase its virulence are important factors in controlling the current tuberculosis epidemic. Current approaches to <italic toggle="yes">Mtb</italic> sequencing, however, cannot reveal <italic toggle="yes">Mtb</italic>’s full genomic diversity due to the strict requirements of low contamination levels, high <italic toggle="yes">Mtb</italic> sequence coverage and elimination of complex regions. We have developed the XBS (compleX Bacterial Samples) bioinformatics pipeline, which implements joint calling and machine-learning-based variant filtering tools to specifically improve variant detection in the important <italic toggle="yes">Mtb</italic> samples that do not meet these criteria, such as those from unbiased sputum samples. Using novel simulated datasets, which permit exact accuracy verification, XBS was compared to the UVP and MTBseq pipelines. Accuracy statistics showed that all three pipelines performed equally well for sequence data that resemble those obtained from culture isolates of high depth of coverage and low-level contamination. In the complex genomic regions, however, XBS accurately identified 9.0 % more SNPs and 8.1 % more single nucleotide insertions and deletions than the WHO-endorsed unified analysis variant pipeline. XBS also had superior accuracy for sequence data that resemble those obtained directly from sputum samples, where depth of coverage is typically very low and contamination levels are high. XBS was the only pipeline not affected by low depth of coverage (5–10×), type of contamination and excessive contamination levels (&gt;50 %). Simulation results were confirmed using whole genome sequencing (WGS) data from clinical samples, confirming the superior performance of XBS with a higher sensitivity (98.8%) when analysing culture isolates and identification of 13.9 % more variable sites in WGS data from sputum samples as compared to MTBseq, without evidence for false positive variants when rRNA regions were excluded. The XBS pipeline facilitates sequencing of less-than-perfect <italic toggle="yes">Mtb</italic> samples. These advances will benefit future clinical applications of <italic toggle="yes">Mtb</italic> sequencing, especially WGS directly from clinical specimens, thereby avoiding <italic toggle="yes">in vitro</italic> biases and making many more samples available for drug resistance and other genomic analyses. The additional genetic resolution and increased sample success rate will improve genome-wide association studies and sequence-based transmission studies.</p>
    </abstract>
    <kwd-group>
      <kwd>bacteria</kwd>
      <kwd>contamination</kwd>
      <kwd>low coverage</kwd>
      <kwd>
        <italic toggle="yes">Mycobacterium tuberculosis</italic>
      </kwd>
      <kwd>sputum</kwd>
      <kwd>whole-genome sequencing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>fonds wetenschappelijk onderzoek</funding-source>
        <award-id>G0F8316N</award-id>
        <principal-award-recipient>AnneliesVan Rie</principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>OpenAccessEmbargo</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="s2">
    <title>Data Summary</title>
    <p>Simulated sequencing data have been deposited in SRA BioProject PRJNA706121. All detailed findings are available in the supplementary material. Supplementary material can be found in Figshare: <ext-link xlink:href="https://doi.org/10.6084/m9.figshare.17032835.v1" ext-link-type="uri">https://doi.org/10.6084/m9.figshare.17032835.v1</ext-link>. Scripts for running the XBS variant calling core are available on <ext-link xlink:href="https://github.com/TimHHH/XBS" ext-link-type="uri">https://github.com/TimHHH/XBS.</ext-link>
</p>
    <p>The authors confirm all supporting data, code and protocols have been provided within the article or through supplementary data files.</p>
    <boxed-text position="float">
      <caption>
        <title>Impact Statement</title>
      </caption>
      <p><italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10886" ext-link-type="uri">Mycobacterium tuberculosis</ext-link></named-content></italic> (<italic toggle="yes">Mtb</italic>) DNA is usually extracted from culture isolates to obtain high quantities of non-contaminated DNA, but this process can change the make-up of the bacterial population and is time-consuming. Furthermore, current analytical approaches exclude complex genomic regions where DNA sequences are repeated to avoid inference of false positive genetic variants, which may result in the loss of important genetic information. We have designed the compleX Bacterial Sample (XBS) variant caller to overcome these limitations. XBS employs joint variant calling and machine-learning-based variant filtering to ensure that high-quality variants can be inferred from low-coverage and highly contaminated genomic sequence data obtained directly from sputum samples. Simulation and clinical data analyses showed that XBS performs better than other pipelines as it can identify more genetic variants and can handle complex (low depth, highly contaminated) <italic toggle="yes">Mtb</italic> samples. The XBS pipeline was designed to analyse <italic toggle="yes">Mtb</italic> samples but can easily be adapted to analyse other complex bacterial samples.</p>
    </boxed-text>
  </sec>
  <sec sec-type="intro" id="s3">
    <title>Introduction</title>
    <p>Genetic approaches are increasingly being used in tuberculosis research and for the diagnosis of drug-resistant tuberculosis. Whole genome sequencing (WGS) of <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10886" ext-link-type="uri">Mycobacterium tuberculosis</ext-link></named-content></italic> (<italic toggle="yes">Mtb</italic>) aims to investigate the entire genome of the <italic toggle="yes">Mtb</italic> strain to comprehensively assess all known drug resistance-conferring regions, provide maximum resolution for genetic transmission studies, and investigate the role of genomic variants using genome-wide association studies [<xref rid="R1" ref-type="bibr">1</xref>]. The three key problems facing current <italic toggle="yes">Mtb</italic> WGS approaches are the need for high quantities of <italic toggle="yes">Mtb</italic> DNA, presence of contaminant bacterial and human DNA, and presence of complex regions in the <italic toggle="yes">Mtb</italic> genome.</p>
    <p><italic toggle="yes">Mtb</italic> is notoriously difficult to sequence directly from clinical samples because the DNA from human cells, bacteria and viruses outnumbers that from <italic toggle="yes">Mtb</italic> bacilli. This results in insufficient template <italic toggle="yes">Mtb</italic> DNA and low genomic depth of coverage when sequenced [<xref rid="R2" ref-type="bibr">2</xref>]. <italic toggle="yes">Mtb</italic> WGS therefore primarily uses cultured isolates, which requires a harsh decontamination step followed by a lengthy (2–4 weeks) incubation to generate large quantities of <italic toggle="yes">Mtb</italic>. The decontamination step not only reduces the presence of bacteria other than <italic toggle="yes">Mtb</italic>, but may also reduce the <italic toggle="yes">Mtb</italic> load [<xref rid="R3" ref-type="bibr">3</xref>]. The culture step can increase the presence of certain strains over others due to stochastic processes or when certain strains are better suited to growing in culture media [<xref rid="R4" ref-type="bibr">4, 5</xref>]. These processing steps thus result in a population bias, where the inferred <italic toggle="yes">in vitro Mtb</italic> population may not truly represent the <italic toggle="yes">in vivo</italic> population. To generate a rapid and unbiased result, <italic toggle="yes">Mtb</italic> would thus ideally be sequenced directly from the clinical sample.</p>
    <p>Despite decontamination, a small proportion of contaminants may persist in the DNA extracted from the culture isolate. Current <italic toggle="yes">Mtb</italic> bioinformatic pipelines use <italic toggle="yes">in silico</italic> meta-genomic classification software to identify these contaminants and exclude samples with a high proportion of contaminant DNA. For example the unified analysis variant pipeline (UVP) uses a cut-off maximum of 10 % contamination [<xref rid="R6" ref-type="bibr">6</xref>], which may exclude valuable samples from analysis. In addition to the low contamination threshold, the <italic toggle="yes">Mtb</italic> community has adopted relatively high standards for genome coverage, with 30× to 50× and up to 100× depth being the most commonly used. A Poisson distribution, however, reveals that a mean depth of coverage of 15.8× results in 95 % of the genome being covered by 10× or more reads [<xref rid="R7" ref-type="bibr">7</xref>], which should be sufficient for accurately calling majority variants in a haploid genome.</p>
    <p>A third problem that complicates <italic toggle="yes">Mtb</italic> WGS is the abundance of complex regions including repeats, transposons, duplicates and phage genes, and the numerous PE/PPE genes. These complex regions are generally excluded from analyses by <italic toggle="yes">Mtb</italic> pipelines. The core genome multi-locus sequence typing (cgMLST) method goes even further as only the most trusted regions are analysed [<xref rid="R8" ref-type="bibr">8</xref>]. While these strategies ensure the accuracy of the genome assembly and variant calling, they can result in the loss of a significant proportion of genomic information (~9 % when using the UVP [<xref rid="R6" ref-type="bibr">6</xref>]), which may be important for defining transmission events and identification of variants that affect pathogenicity.</p>
    <p>There is thus a need for novel bioinformatics tools that overcome the current requirements of low contamination, high <italic toggle="yes">Mtb</italic> DNA sequence coverage and exclusion of complex genomic regions [<xref rid="R9" ref-type="bibr">9</xref>]. The Genome Analysis ToolKit (GATK), originally designed for human genome studies (i.e. diploid), now allows for processing of haploid genomes such as that of <italic toggle="yes">Mtb</italic>. The Base Quality Score Recalibration and Indel Realigner tools and single sample variant calling using the now superseded Unified Genotyper tool have already been applied in <italic toggle="yes">Mtb</italic> genome studies [<xref rid="R6" ref-type="bibr">6, 10</xref>]. GATK’s ‘Germline short variant discovery Best Practices workflow’, however, includes joint genotyping and machine-learning-based variant filtering and has seen little to no implementation in bacterial and <italic toggle="yes">Mtb</italic> genome assembly pipelines. The major advantage of joint variant calling, as opposed to single sample variant calling, is a greater sensitivity for variants at low frequency in the population and detection of variants in low-coverage samples for which there would be insufficient confidence if the sample had been analysed on its own [<xref rid="R11" ref-type="bibr">11</xref>]. Joint variant calling also enables the calculation of various statistical annotations (including depth of coverage, strand bias and read mapping quality) for alleles in the population rather than for those in a single strain. These population variants are more numerous and their annotations suffer from fewer stochastic deviations, thereby improving subsequent variant filtering. The machine-learning-based variant filtering (VQSR) in GATK [<xref rid="R12" ref-type="bibr">12</xref>] eliminates the need for hard-filtering of variants, which is commonly applied through the use of rather arbitrary cut-offs for strand bias and coverage depth.</p>
    <p>We hypothesize that GATK’s tools are suitable for distinguishing contaminant variants from <italic toggle="yes">Mtb</italic> and to score and identify variants in complex regions of the <italic toggle="yes">Mtb</italic> genome. We developed a novel <italic toggle="yes">Mtb</italic> pipeline integrating GATK’s tools to improve the identification of genetic variants in less-than-perfect <italic toggle="yes">Mtb</italic> samples and thereby greatly increase our power to capture the diversity of within-patient and within-bacterial genetic information. We also tested the variant calling core of this pipeline for its accuracy to identify genetic variants in comparison to existing pipelines.</p>
  </sec>
  <sec sec-type="methods" id="s4">
    <title>Methods</title>
    <sec id="s4-1">
      <title>Development of the XBS pipeline</title>
      <p>The XBS pipeline was designed to perform analyses of Illumina FASTQ sequence data. The pipeline was primarily designed to analyse <italic toggle="yes">Mtb</italic> samples but can easily be adapted to analyse other complex bacterial samples. XBS was realized through coupling published software packages with custom Bash and Python scripts.</p>
      <p>Pipelines typically start with identifying the level of contaminants and/or removing contaminants before mapping the sequence reads. In XBS, all FASTQ sequence data, whether single read or paired-end, are directly mapped to the reference genome (H37Rv: NC_000962.3), however, using BWA mem [<xref rid="R13" ref-type="bibr">13</xref>] (<xref rid="F1" ref-type="fig">Fig. 1</xref>). XBS does not employ an adapter trimming step because BWA mem locally aligns sequence reads, which masks the portions of the read that do not align well with the reference genome. Skipping the step of removing contaminants saves considerable computing time but does require sophisticated downstream variant filtering to distinguish genuine <italic toggle="yes">Mtb</italic> variants from those introduced by contaminants.</p>
      <fig position="float" fig-type="figure" id="F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Flow chart for XBS’s variant calling core.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g001" position="float"/>
      </fig>
      <p>Next, the mapped sequence library is merged with other independently mapped sequence libraries from the same sample using Samtools (<ext-link xlink:href="https://www.htslib.org/" ext-link-type="uri">https://www.htslib.org/</ext-link>). GATK's MarkDuplicates (Picard) is then used to mark duplicated reads in the merged bam file. Unlike other <italic toggle="yes">Mtb</italic> pipelines XBS does not employ Base Quality Score Recalibration (BQSR) to avoid variants in contaminant DNA being interpreted as systematic errors by BQSR, which would result in reduced base qualities, including for genuine <italic toggle="yes">Mtb</italic> variants.</p>
      <p>The mapped sequences are then locally reassembled to correctly identify possible haplotypes and their variants using GATK HaplotypeCaller. At this point, the statistics of depth of coverage, breadth of coverage, multiple infection and level of non-tuberculous mycobacteria (NTM) contamination are assessed to judge if a sample is suitable for subsequent joint variant calling. Coverage statistics are inferred using GATK's CollectWgsMetrics (Picard). Quality approved samples’ Genomic Variant Call Format (GVCF) files are then merged with GATK's CombineGVCFs and the genotypes are joint called using GATK's GenotypeGVCFs. This results in a VCF file with the unfiltered variants for all quality approved samples. GATK is run with a ploidy of 1 for the variant calling processes so that the allele with the highest confidence is identified as the allele representing the haploid genotype for each variant site.</p>
      <p>Next, the machine-learning-based variant filtering (VQSR) in GATK is employed to identify the probable true variants [<xref rid="R12" ref-type="bibr">12</xref>]. This step requires a truth set of variants known to occur in <italic toggle="yes">Mtb</italic>, which can for example consist of Drug Resistance (DR) conferring mutations. SNPs and insertions and deletions (INDELs) are processed separately for variant filtering. The annotated statistics calculated during the genotyping are used to build a positive statistical model for the variants in the dataset that also occur in the truth set. Similarly, a negative variant model is built for the variants with the worst annotated statistics. The remaining variants not consulted for either the positive or the negative model construction are then confidence scored according to the placement of their annotated statistics in relation to these models. To identify as many variants as possible, variants are then filtered by applying a target sensitivity of 99.9%, calculated as the percentage of identified variants from the present truth-set variants. The filtered SNP and INDEL VCFs are then further processed as appropriate for constructing annotated phylogenies and inferences of multiple infection, drug (hetero-)resistance, lineage and transmission clusters.</p>
    </sec>
    <sec id="s4-2">
      <title><italic toggle="yes">In silico</italic> development of a simulated dataset</title>
      <p>A dataset of 1200 simulated samples representing 50 000 SNPs, 2500 insertions and 2500 deletions was developed (<xref rid="F2" ref-type="fig">Fig. 2</xref>). Of these, 600 were designed to resemble WGS data from mono-culture isolates and 600 to resemble WGS data obtained directly from sputum samples, the latter including high levels of various contaminants.</p>
      <fig position="float" fig-type="figure" id="F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Flow chart for dataset construction.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g002" position="float"/>
      </fig>
      <p>First, a set of 50 simulated strains with the exact mutations known with respect to the reference genome was created <italic toggle="yes">in silico</italic> using SNP Mutator v.1.2.0 [<xref rid="R14" ref-type="bibr">14</xref>]. Each simulated genome was created by randomly introducing 1000 SNPs, 50 single nucleotide insertions and 50 single nucleotide deletions in H37Rv (NC_000962.3). Multi-nucleotide INDELs could not be introduced using the SNP Mutator software. SNPs and INDELs were introduced randomly throughout each simulated strain genome to ensure that random bases were affected and/or introduced and to create genetically varying strains. GATK's LeftAlignAndTrimVariants was used so that the truth set's INDELs were in the standard notation.</p>
      <p>For each dataset, 100 strains were randomly drawn from the 50 simulated strains to ensure that some strains and their variants occurred more than once, as would be the case for clinical datasets where specific strains and drug resistance variants often occur more than once. To simulate WGS data obtained from culture isolates, six datasets representing 5×, 10×, 20×, 30×, 50× or 100× depth were generated using 100 randomly drawn simulated strains each (<xref rid="F2" ref-type="fig">Fig. 2</xref>). In order to investigate the impact of low-level contamination, no or low-level contamination (0, 1, 2, 3, 4 or 5%) and contamination type was randomly assigned to each of the simulated strains. The eight contamination types used were <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.6366" ext-link-type="uri">Mycobacterium intracellulare</ext-link></named-content></italic> (NC_016946.1), <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.6313" ext-link-type="uri">Mycobacterium abscessus</ext-link></named-content></italic> (NC_010397.1, including plasmid), <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10879" ext-link-type="uri">Mycobacterium avium</ext-link></named-content></italic> (NC_002944.2), the three most common NTM, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.2553" ext-link-type="uri">Pseudomonas aeruginosa</ext-link></named-content></italic> (NC_002516.2) and <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">Staphylococcus epidermidis</ext-link></named-content></italic> (NC_004461.1), <italic toggle="yes">Homo sapiens</italic> (GRCh38), a mixture of the three NTM (<italic toggle="yes">M. intracellulare, M. abcessus</italic> and <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10879" ext-link-type="uri">M. avium</ext-link></named-content></italic>) and a mixture of all six contaminants. Because it was not possible to represent the full diverse spectrum of contaminating bacteria in the simulations, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.2553" ext-link-type="uri">P aeruginosa</ext-link></named-content></italic> and <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic> were selected as these are the most common bacterial contaminants [<xref rid="R2" ref-type="bibr">2</xref>], and NTMs were included because these pose a serious challenge for <italic toggle="yes">Mtb</italic> variant calling. The simulated samples included no or low-level contamination in order to resemble WGS data from culture isolates and to be able to investigate the effect of the various low levels of such contamination. Simulated contaminant sequence reads were added to the simulated <italic toggle="yes">Mtb</italic> reads so that the final contamination level matched the assigned contamination percentage.</p>
      <p>ART v.2.5.8 software [<xref rid="R15" ref-type="bibr">15</xref>] was then used to emulate Illumina 150 bp paired-end sequence reads with an HiSeq error profile and a Poisson distributed 300 bp average library insert size for each simulated strain and its contaminant(s). In total, 600 cultured WGS samples were generated in six datasets of 100 simulated samples with each dataset representing a different level of coverage (5, 10, 20, 30, 50 or 100× depth) to allow assessment of the relationship between coverage and accuracy of variant identification.</p>
      <p>To simulate <italic toggle="yes">Mtb</italic> WGS data obtained directly from sputum samples, another six datasets were generated, each with a set number of paired-end sequence reads per sample, ranging from 500 000 to 3 000 000 paired-end reads (<xref rid="F2" ref-type="fig">Fig. 2</xref>). <italic toggle="yes">Mtb</italic> and contamination levels were randomly sampled from a beta distribution around 0.01–78.63% <italic toggle="yes">Mtb</italic> DNA to match levels observed for direct-from-sputum WGS data [<xref rid="R9" ref-type="bibr">9</xref>]. The contamination type was either <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.2553" ext-link-type="uri">P. aeruginosa</ext-link></named-content></italic>, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic>, <italic toggle="yes">H. sapiens,</italic> a mixture of <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.2553" ext-link-type="uri">P. aeruginosa</ext-link></named-content></italic>, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic> and <italic toggle="yes">H. sapiens,</italic> or an NTM mixture (<italic toggle="yes">M. intracellulare, M. abcessus</italic> or <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10879" ext-link-type="uri">M. avium</ext-link></named-content></italic> up to 20 % of the <italic toggle="yes">Mtb</italic> fraction with the remaining contamination consisting of <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.2553" ext-link-type="uri">P. aeruginosa</ext-link></named-content></italic>, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic> or <italic toggle="yes">H. sapiens</italic>).</p>
      <p>ART v.2.5.8 software [<xref rid="R15" ref-type="bibr">15</xref>] was used as described previously to emulate sequence reads for each simulated strain and its contaminant(s). In total, 600 simulated WGS data directly from sputum samples were generated in six datasets of 100 simulated samples, each dataset representing a number of paired-end sequence reads and had various levels and types of contamination, allowing us to study the relationship between contaminant nature, read number and variant identification.</p>
    </sec>
    <sec id="s4-3">
      <title>Assessment of XBS pipeline performance</title>
      <p>The performance of XBS was compared to UVP [<xref rid="R6" ref-type="bibr">6</xref>] and MTBseq [<xref rid="R16" ref-type="bibr">16</xref>], two well-established and commonly used <italic toggle="yes">Mtb</italic> pipelines. Each pipeline was evaluated using their standard settings. For UVP, variants in the GATK filtered VCF file were used for accuracy calculations. For MTBseq, two approaches were assessed. In ‘MTBseq-basic’, the ‘GATK position variants’ file was used for calculations of accuracy. In ‘MTBseq-exrep’, the variants marked ‘repetitive’ in MTBseq’s ‘MTB_Gene_Categories.txt’ were excluded to assess the effect of this commonly applied filtering step. From here on, XBS, UVP and the two MTBseq approaches will be referred to as pipelines.</p>
      <p>For XBS, VQSR was run with a truth set consisting of 5000 SNPs, 250 insertions and 250 deletions randomly selected from the mutations known to occur in the 50 simulated strains. The truth set therefore represented 10 % (5 500/55 000) of the total variants introduced <italic toggle="yes">in silico</italic>. GATKs VariantRecalibrator was run to score each SNP according to the inferred positive and negative models, built on the depth, mapping quality, mapping quality rank-sum and quality by depth statistical annotations. These annotations were processed in an allele-specific fashion to distinguish between genuine and contaminant variants occurring at the same genomic location. Annotations that showed insufficient variance, as determined by VQSR, were excluded. A logit transform and jitter were applied to improve mapping quality-based filtering. The FS, ReadPosRanksum and SOR annotations were excluded because they are more applicable for real sequence data than for simulated data. Where possible, four Gaussians were used for the positive model. GATK's ApplyVQSR was applied with a truth sensitivity level of 99.9 %. The same process was followed for INDELs except that allele specificity was disabled and, where possible, two Gaussians were used for the positive model. The MQ annotation was not taken into consideration following the GATK Best Practices Workflow for Germline short variant discovery. To avoid over-representation of contaminant alleles in the filtered dataset, INDELs in the sputum simulations were filtered using a VQSLOD score of 0 rather than a truth sensitivity level. This ensures that only those INDELs that are most likely to fall in the positive and not the negative model are kept. The resulting SNP and INDEL variants were used for the accuracy calculations. Version 4.1.9.0 of GATK was used.</p>
      <p>The six datasets simulating WGS from culture were analysed using all four pipelines (XBS, MTBseq-basic, MTBseq-exrep, UVP). The six datasets simulating WGS from sputum samples came only from three pipelines as UVP cannot analyse samples with contamination exceeding 10 %. The inferred variants identified by each pipeline were compared with the truth in terms of genome position and allelic nature (bases involved and length). The pipeline’s accuracy was calculated in terms of precision, recall and harmonic mean (F<sub>1</sub> score).</p>
      <p>For simulation of WGS from culture isolates, accuracy scores were averaged over the 100 samples in each dataset and calculated for each combination of variant type (SNP or INDEL) and genomic region (complete, complex or non-complex). F<sub>1</sub> scores were plotted for the four pipelines at six levels of depth for the complete genome, and for complex and non-complex regions separately. UVP’s list of excluded loci was used to define regions as complex, and these were filtered using GATK's SelectVariants.</p>
      <p>For simulation of WGS from sputum, the range of F<sub>1</sub> scores was calculated, separately for SNPs and INDELs, and the proportion of samples with an F<sub>1</sub> score &gt;0.9 was estimated. The number of <italic toggle="yes">Mtb</italic> reads was converted to the theoretical depth of coverage (number of simulated <italic toggle="yes">Mtb</italic> reads multiplied by average read length) and plotted against F<sub>1</sub> scores for each pipeline, contamination level and type after excluding samples with a theoretical coverage of &lt;20× so that the lesser performance of such samples did not distort these figures.</p>
      <p>Plots were created in R using the ggplot2 and gridExtra packages.</p>
    </sec>
    <sec id="s4-4">
      <title>Analysis of WGS from clinical samples</title>
      <p>The performance of the XBS variant caller was examined using two published WGS datasets obtained from clinical samples and compared to UVP and MTBseq. Data published by Roetzer <italic toggle="yes">et al</italic>. [<xref rid="R17" ref-type="bibr">17</xref>] were used to test the pipelines’ sensitivity by identifying a set of known variants (Sanger-confirmed) in DNA extracted from cultured <italic toggle="yes">Mtb</italic> samples. Data from Goig <italic toggle="yes">et al</italic>. [<xref rid="R9" ref-type="bibr">9</xref>] were used to evaluate the ability to call variants in WGS data from DNA extracted directly from sputum. Only samples with ≥5× genomic coverage depth (S02, S26, S17, S21, S31, S20, S27, S67, S09 and S69) were analysed to ensure sufficient width of coverage and prevent problems with phylogenetic inference. A reference set of 125 diverse cultured <italic toggle="yes">Mtb</italic> strains with high coverage WGS data was included in the analyses to provide a reference in the phylogenetic tree and increase the variation in statistical annotations, thereby improving VQSR for XBS. XBS VQSR was run in SNP mode with a truth-set containing lineage and DR variants [<xref rid="R18" ref-type="bibr">18–20</xref>]. These variants reflect the diversity of the bacterium (<italic toggle="yes">Mtb</italic> lineages) and the entirety of the genome, enabling VQSR to build a model to identify variants in exactly such regions and as such avoid bias. The variants from the Goig <italic toggle="yes">et al</italic>. and reference datasets were converted to FASTA format, where positions represented by fewer than 95 % of the samples were excluded. MTBseq and UVP were run in default mode.</p>
      <p>IQ-TREE v2.1.2 was used to construct maximum-likelihood trees [<xref rid="R21" ref-type="bibr">21</xref>], which were plotted with Figtree v1.4.3 [<xref rid="R22" ref-type="bibr">22</xref>], and the resulting branch lengths were used to evaluate the potential presence of false positive variants.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="s5">
    <title>Results</title>
    <sec id="s5-1">
      <title>Pipeline performance for analysis of WGS data from simulated culture isolates</title>
      <p>At the highest coverage (100×) and with the low levels of contamination (≤5 %), all pipeline approaches detected very few false positives and missed few variants, resulting in a 100 % precision for SNPs and INDELs across the genome, except for UVP which obtained a slightly lower precision of 98 % for SNP calling (<xref rid="T1 T2" ref-type="table">Tables 1 and 2</xref>). Recall scores were highest for XBS and MTBseq-basic (97–99 % for the SNPs and INDELs) compared to MTBseq-exrep and UVP which missed some variants (92 % for SNPs and 91 % for INDELs by MTBseq-exrep; 90 % for SNPs and 89 % for INDELs by UVP). The overall variant calling accuracy was highest for XBS and MTBseq-basic (F<sub>1</sub> score 0.99 for SNPs, ≥0.98 for INDELs), somewhat lower for MTBseq-exrep (F<sub>1</sub> score 0.96 for SNPs, 0.95 for INDELs) and lowest for UVP (F<sub>1</sub> score 0.94 for SNPs and INDELs) (<xref rid="F3" ref-type="fig">Fig. 3</xref>). At 100× coverage MTBseq-basic identified an average 9.2 % more true positive SNPs and 9.8 % more INDELS per genome when compared to UVP (<xref rid="T1 T2" ref-type="table">Tables 1 and 2</xref>). XBS identified an average 9.0 % more true positive SNPs and 8.1 % more INDELs per genome when compared to UVP at 100× coverage.</p>
      <fig position="float" fig-type="figure" id="F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Performance (F<sub>1</sub> scores) of four bioinformatic pipelines for SNP calling in simulated <italic toggle="yes">Mtb</italic> culture isolates at six levels of depth of <italic toggle="yes">Mtb</italic> genomic coverage.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g003" position="float"/>
      </fig>
      <table-wrap position="float" id="T1">
        <label>Table 1.</label>
        <caption>
          <p>SNP calling accuracies across the entire genome for four <italic toggle="yes">Mtb</italic> pipelines</p>
          <p><sc>na</sc>, Not applicable.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" valign="top" rowspan="1" colspan="1"/>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>XBS</p>
              </th>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>MTBseq-basic</p>
              </th>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>MTBseq-exrep</p>
              </th>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>UVP</p>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Simulated dataset</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Rrecall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV5</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.93</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.88</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.05</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.10</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.86</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.05</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.09</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.03</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.06</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV10</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.69</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.49</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.66</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.48</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.64</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV20</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.97</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.90</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.91</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>81</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV30</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.92</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.90</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.93</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>89</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV50</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.92</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.90</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.93</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>91</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.92</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.90</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>99</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM0500K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.79</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.60</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.63</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>49</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.44</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.29</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.32</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>20</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.44</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.27</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.31</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>15</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM1000K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.83</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.72</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.73</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>65</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.37</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.40</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>25</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.34</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>21</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM1500K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.93</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.70</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.75</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>58</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.54</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.46</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.47</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.43</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.45</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>33</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM2000K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.76</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.78</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>72</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.56</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>41</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.56</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.49</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.51</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>30</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM2500K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.90</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.79</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.81</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>71</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.67</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.62</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.61</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.66</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.57</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.59</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>45</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM3000K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.81</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.84</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>77</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.62</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.59</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.58</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>43</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.62</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.55</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.56</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>37</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="float" id="T2">
        <label>Table 2.</label>
        <caption>
          <p>INDEL calling accuracies across the entire genome for four <italic toggle="yes">Mtb</italic> pipelines</p>
          <p>na, Not applicable.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" valign="top" rowspan="1" colspan="1"/>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>XBS</p>
              </th>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>MTBseq-basic</p>
              </th>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>MTBseq-exrep</p>
              </th>
              <th align="center" valign="top" colspan="4" rowspan="1">
                <p>UVP</p>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Simulated dataset</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Pecision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Precision</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>Recall</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub>
</bold>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <bold>F<sub>1</sub> &gt;0.90</bold>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV5</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.91</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.88</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.05</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.10</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.86</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.05</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.09</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.03</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.06</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV10</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.50</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.66</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.46</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.63</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.48</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.64</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV20</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.97</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.96</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>99</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV30</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.97</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.91</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>99</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV50</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.97</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.91</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>95</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>COV100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.97</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.99</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>100</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.91</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.95</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>98</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>1.00</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.89</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.94</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>98</p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM0500K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.73</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.57</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.61</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>47</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.46</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.28</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.32</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>21</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.46</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.27</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.31</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>16</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM1000K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.88</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.70</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.74</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>67</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.56</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.36</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.40</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>28</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.55</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.34</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.38</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>27</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM1500K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.86</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.67</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.73</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>57</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.55</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.45</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.48</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>41</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.55</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.42</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.46</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>40</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM2000K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.87</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.68</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.74</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>62</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.64</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.52</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.55</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>45</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.64</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.48</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>40</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM2500K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.91</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.75</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.79</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>70</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.70</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.61</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.63</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>58</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.70</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.57</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.60</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>53</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>SPUTUM3000K</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.86</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.79</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.81</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>73</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.69</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.58</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.61</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>47</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.69</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.54</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>0.59</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>45</p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
              <td align="center" valign="top" rowspan="1" colspan="1">
                <p>
                  <sc>na</sc>
                </p>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Lowering the depth of <italic toggle="yes">Mtb</italic> genome coverage from 100× to 20× had minimal effect on accuracy scores. XBS’s precision and recal did not change and the F<sub>1</sub> score deviated by ≤0.01 for SNPs and INDELs. The performance of MTBseq-basic and MTBseq-exrep also did not differ for these lower coverages, with similar precision for SNPs and INDELs, a drop in recall by 2 % for SNPs and 3 % for INDELs, and the F<sub>1</sub> score lowered by 0.01 for both SNPs and INDELs. UVP’s accuracy statistics did not change for INDELs, but precision, recall and F<sub>1</sub> score for SNPs dropped slightly by 4%, 1 % and 0.01, respectively.</p>
      <p>At depths ranging from 20× to 100×, the performance for SNP and INDEL calling in the non-complex regions of the <italic toggle="yes">Mtb</italic> genome was high for all four pipelines (<xref rid="F4" ref-type="fig">Fig. 4</xref> and Table S1, available in the online version of the article). Performance for variant calling in the complex regions was similar for MTBseq-basic and XBS, with an average SNP and INDEL precision of 100%, recall around 91 % and F<sub>1</sub> around 0.95. Accuracy statistics for variant calling in the complex regions could not be calculate for UVP as complex regions are excluded from from its standard output. MTBseq-exrep’s exclusion of repetitive regions was less strict than UVP’s excluded loci and hence the former was able to identify a small number of variants in the complex regions.</p>
      <fig position="float" fig-type="figure" id="F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Performance (F<sub>1</sub> scores) of four bioinformatic pipelines for SNP calling in simulated <italic toggle="yes">Mtb</italic> culture isolates at six levels of depth of <italic toggle="yes">Mtb</italic> genomic coverage, stratified by complex and non-complex regions of the genome.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g004" position="float"/>
      </fig>
      <p>At 10× depth of coverage, all four pipelines retained their precision but recall was affected. UVP and both MTBseq approaches missed many variants, resulting in a recall of around 50 % for SNPs and INDELs. Consequently, F<sub>1</sub> scores dropped drastically for MTBseq-basic (0.69 for SNPs and 0.66 for INDELs), MTBseq-exrep (0.66 for SNPs and 0.63 for INDELs) and UVP (0.64 for both SNPs and INDELs). In contrast, XBS’s accuracy remained high, with recall at 99 % for SNPs and 98 % for INDELs and F<sub>1</sub> scores of 0.99 for SNPs and INDELs (<xref rid="F3" ref-type="fig">Fig. 3</xref>). Only at an <italic toggle="yes">Mtb</italic> genome coverage of 5× was the performance of XBS noticeably affected, although performance remained largely accurate, with F<sub>1</sub> scores of 0.96 for SNPs and 0.95 for INDELs, a precision of 100 % for both, and recall of 93 % for SNPs and 91 % for INDEL calling. XBS’s ability to call variants in both low-coverage and complex regions was retained (<xref rid="F4" ref-type="fig">Fig. 4</xref>).</p>
      <p>The type of low-level contaminant (<italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.6366" ext-link-type="uri">M. intracellulare</ext-link></named-content></italic>, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.6313" ext-link-type="uri">M. abscessus</ext-link></named-content></italic>, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.10879" ext-link-type="uri">M. avium</ext-link></named-content></italic>, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.2553" ext-link-type="uri">P. aeruginosa</ext-link></named-content></italic>, <italic toggle="yes">S. epidermidis, H. sapiens</italic>, NTM mixture or mixture of all six contaminants) only affected the F<sub>1</sub> estimates of UVP due to false positive SNP calls when NTMs or <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic> were present (Fig. S1 and Table S1). The level of contamination (varying from 0 to 5 %) also only affected UVP’s performance, with a decrease in precision and SNP F<sub>1</sub> scores at higher levels of contamination (Fig. S2 and Table S1).</p>
    </sec>
    <sec id="s5-2">
      <title>Pipeline performance for analysis of WGS data from simulated sputum samples</title>
      <p>XBS outperformed both MTBseq approaches when analysing the data simulated to represent WGS directly from sputum. For SNPs, F<sub>1</sub> scores ranged from 0.63 to 0.84 for XBS compared to 0.33–0.58 for MTBseq-basic and 0.31–0.59 for MTBseq-exrep. Using XBS, 49–77 % of samples achieved F<sub>1</sub> scores above 0.90, compared to 20–53% and 15–45 % for MTBseq-basic and MTBseq-exrep, respectively (<xref rid="T1 T2" ref-type="table">Tables 1 and 2</xref>). For INDELs F<sub>1</sub> scores ranged from 0.61 to 0.81 for XBS, 0.32 to 0.63 for MTBseq-basic and 0.31 to 0.60 for MTBseq-exrep. Using XBS, 47–73 % of samples achieved F<sub>1</sub> scores above 0.9, compared to 21–58 % and 16–53 % for MTBseq-basic and MTBseq-exrep, respectively. Plotting the theoretical depth of coverage against F<sub>1</sub> score showed that XBS calls SNPs and INDELs with higher accuracy at low genomic depth of coverage compared to both MTBseq approaches (<xref rid="F5" ref-type="fig">Fig. 5</xref>).</p>
      <fig position="float" fig-type="figure" id="F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Performance (F<sub>1</sub> scores) of different bioinformatic pipelines for SNP and INDEL calling from contaminated sputum samples at various levels of theoretical depth of <italic toggle="yes">Mtb</italic> genomic coverage.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g005" position="float"/>
      </fig>
      <p>SNP accuracy of XBS was unaffected by contamination level or type (<xref rid="F6" ref-type="fig">Fig. 6</xref>). In contrast, accuracy for MTBseq-basic and MTBseq-exrep depended on the type and level of contamination. <italic toggle="yes">H. sapiens</italic> contamination did not affect the F<sub>1</sub> score, <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic> lowered the F<sub>1</sub> score to 0.90 when the contamination level was ≥50 %, and NTM and bacterial/human contamination mixtures reduced the F<sub>1</sub> score when the contamination level was ≥75 %. For INDELs, the MTBseq-basic pipeline performed slightly better than XBS when <italic toggle="yes">Mtb</italic> depth of coverage was ≥20×, with average F<sub>1</sub> scores of 0.99 for MTBseq-basic, 0.95 for MTBseq-exrep and 0.96 for XBS respectively. (Figs S3 and S5B).</p>
      <fig position="float" fig-type="figure" id="F6">
        <label>Fig. 6.</label>
        <caption>
          <p>Performance (F<sub>1</sub> scores) of three bioinformatic pipelines for SNP calling in sputum samples with minimum 20× <italic toggle="yes">Mtb</italic> coverage and various types and levels of contamination.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g006" position="float"/>
      </fig>
    </sec>
    <sec id="s5-3">
      <title>Pipeline performance for analysis of WGS data from clinical culture isolates</title>
      <p>MTBseq and XBS could analyse all samples from the Roetzer <italic toggle="yes">et al</italic>. dataset, whereas UVP excluded 33 of the 86 (38 %) samples. Of the 85 Sanger-confirmed mutations, MTBseq-basic recovered 81, MTBseq-exrep 79, UVP 61 and XBS 84, corresponding to sensitivities of 95.3, 92.9, 71.8 and 98.8%, respectively (Table S3). The single variant missed by XBS was located right on the border of a repetitive region, resulting in reads with sub-optimal mapping qualities.</p>
    </sec>
    <sec id="s5-4">
      <title>Pipeline performance for analysis of WGS data from clinical sputum samples</title>
      <p>UVP failed to analyse any sample included in the Goig <italic toggle="yes">et al</italic>. dataset, as contamination levels were above the 10 % threshold for all samples. For the 10 Goig <italic toggle="yes">et al</italic>. samples and the 125 reference samples, XBS reported 11 977 variant positions (after exclusion of the rRNA regions), 13.9 % more than the 10 514 variants reported by MTBseq. The number of variants called by MTBseq further reduced to 10 114 when variants within 12 bp of each other were excluded.</p>
      <p>There was no evidence of false positive variants when using XBS (no obvious branch extension for any sputum samples) with the highly conserved rRNA regions removed (<xref rid="F7" ref-type="fig">Fig. 7</xref>). When including the genes coding for rRNA, obvious extended branch lengths were present for three samples (S02, S26 and S20, Fig. S4) due to VQSLOD scores for such variants that had fallen just within the within the positive VQSR model. When using MTBseq, there were also no obvious branch extensions but one sample (S26) showed a shorter branch length compared to its nearest neighbours in the phylogenetic tree. This was the case for FASTA files including and excluding SNPs within 12 bp distance from each other (Figs S5 and S6).</p>
      <fig position="float" fig-type="figure" id="F7">
        <label>Fig. 7.</label>
        <caption>
          <p>XBS maximum-likelihood tree showing the location of Goig <italic toggle="yes">et al</italic>.’s sputum samples (marked in red) in relation to the reference dataset. The scale bar is in substitutions per site and refers to the branch lengths.</p>
        </caption>
        <graphic xlink:href="mgen-7-0689-g007" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s6">
    <title>Discussion</title>
    <p>We developed XBS and applied the joint variant calling and machine-learning-based variant filtering approaches, initially designed for human genome analyses, to a pipeline for <italic toggle="yes">Mtb</italic> WGS analyses. Using 1200 simulated samples representing characteristics of WGS data from <italic toggle="yes">Mtb</italic> culture or directly from sputum samples, we demonstrated that XBS increases the performance in variant calling compared to existing pipelines (UVP and MTBseq), especially for WGS data from less-than-perfect, contaminated low<italic toggle="yes">-Mtb</italic>-burden samples. The strain simulation, variant calling and filtering approach presented here may also benefit the study of other bacteria where sequence coverage, complex genomes or contamination hinder accurate identification of genetic variants.</p>
    <p>We showed that current pipeline approaches perform well for SNP and INDEL calling when sequencing DNA extracts from decontaminated cultures with high (≥20×) depth, but accuracy decreases when depth of coverage is low (5–10×) or contamination levels are high (&gt;50 %). The novel XBS pipeline substantially outperformed other MTB pipelines for SNP and INDEL calling in <italic toggle="yes">Mtb</italic> at low-coverage-depth culture samples and highly contaminated, low-coverage-depth sputum samples.</p>
    <p>When analysing WGS data from culture isolates at the current standard 30–100× depth coverage, all pipelines accurately called SNPs and INDELs (F<sub>1</sub> scores &gt;0.90). Of the three pipelines assessed, UVP’s performance was slightly inferior given its lower precision (false positive variants) at higher (5%) contamination, particularly when the contaminant was an NTM. XBS and MTBseq-basic were not affected by low-level (0–5 %) contamination and identified on average 9 % more SNPs and INDELs compared to UVP by investigating <italic toggle="yes">Mtb</italic>’s complex genomic regions. Identifying 9 % more variants could greatly benefit transmission and genome-wide association studies.</p>
    <p>At lower coverage (&lt;20×), XBS was the only pipeline that could accurately call SNPs and INDELs, probably due to the joint calling and filtering processes that permit lower allele coverages. XBS’s accuracy remained high at 5× depth, where the modest drop in F<sub>1</sub> score was due to a slightly lower recall rate and difficulty in accurately calling genuine INDELs due to coverage gaps. This is expected as, according to the Poisson distribution, only 99.3 % of the genome is covered by at least one read at 5× coverage. The low-level contamination simulated for the culture samples did not affect the accuracy of the XBS or MTBseq pipelines. The UVP pipeline, however, was affected by both the level and the type of low-level contamination, and such effects have been observed previously [<xref rid="R23" ref-type="bibr">23</xref>]. Considering these findings it is understandable that UVP uses a strict contamination cut-off, but the other pipelines show that variants can be identified more accurately despite the absence of such cut-offs. Sequencing at 5× depth using XBS resulted in an average SNP F<sub>1</sub> score of 0.96 (minimum 0.95) and average INDEL F<sub>1</sub> score of 0.95 (minimum 0.91), whereas the F<sub>1</sub> scores of the other pipelines were ≤0.10 for both SNPs and INDELs. Such low-coverage sequencing could lower the costs by a factor of 10 compared to standard 50× coverage sequencing. In combination with low-cost library preparations, which is the main driver of sequencing cost, this could open the door to large-scale population sequencing projects in high tuberculosis-burden settings.</p>
    <p>WGS data obtained directly from sputum are characterized by a low number of <italic toggle="yes">Mtb</italic> reads (theoretical coverage), a high level of contamination and the presence of a mix of contaminants. The novel XBS pipeline showed superior performance for analysing such impure sequencing data. Due to the joint calling approach, XBS could analyse samples with much lower genomic coverage than the two MTBseq approaches. XBS successfully identified SNPs and INDELs in an average of 73 % of samples with 2,5–5 million paired-end reads, where MTBseq-basic only successfully analysed 50 % and MTBseq-exrep 45 % of such samples. By employing VQSR filtering, which identifies contaminant reads based on a multitude of statistical annotations, XBS’s performance was not affected by level or type of contaminants. Hard filtering, as is implemented in MTBseq-basic and MTBseq-exrep, was not sufficient at high levels (&gt;50 %) of contamination because contaminant alleles may be interpreted as the most likely and therefore genuine allele, leading to false positives, once they reach coverage levels greater than the <italic toggle="yes">Mtb</italic> allele. For MTBseq, the type of contaminant affected the accuracy. High levels of human DNA did not affect accuracy as these are unlikely to map to the reference genome, but <italic toggle="yes"><named-content content-type="species"><ext-link xlink:href="http://doi.org/10.1601/nm.5246" ext-link-type="uri">S. epidermidis</ext-link></named-content></italic> contamination started to have an effect from 50 % upwards as contaminant alleles then outnumber that of <italic toggle="yes">Mtb</italic>. The NTM-mix only affected accuracy at high contamination despite the great genome similarity among NTMs. This counterintuitive finding is probably because high levels of contamination are required before one of the NTM contaminants present in the mix approaches 50 % allele frequency.</p>
    <p>Since it cannot be said exactly which samples underperform in terms of variant identification accuracy in a clinical dataset, it is best to ensure an acceptable minimum accuracy instead. When employing XBS on WGS data from real-life sputum, our data suggest that it may be prudent to restrict the analyses to those samples that present a coverage of ≥10×. A 10× cut off would result in average SNP F<sub>1</sub> scores of 0.99 (minimum 0.98) and average INDEL F<sub>1</sub> scores of 0.97 (minimum 0.91) for 60 % (60/100) of the samples in the 300 0000 PE read dataset. MTBseq-basic would result in average SNP F<sub>1</sub> scores of 0.91 (minimum 0.53) and average INDEL F<sub>1</sub> scores of 0.95 (minimum 0.69) for the same samples.</p>
    <p>Comparisons of the performance of <italic toggle="yes">Mtb</italic> pipelines is important but hampered by the absence of large datasets for which the true variants are known. To date, studies assessing the performance of <italic toggle="yes">Mtb</italic> pipelines have compared their ability to identify transmission clusters as established through contact tracing or older molecular methods, or by comparing the detection of genomic drug resistance in relation to phenotypic tests or Sanger-confirmed variants [<xref rid="R6" ref-type="bibr">6, 16, 24, 25</xref>]. These approaches suffer from important limitations. Contact tracing is complex and may not necessarily identify all clusters correctly [<xref rid="R26" ref-type="bibr">26</xref>]. Older molecular methods have significantly lower resolution than WGS so that all pipelines call clusters identified by these older methods with relative ease [<xref rid="R27" ref-type="bibr">27</xref>]. Using genomic drug resistance to compare pipelines is affected by the reference drug resistance mutation list used by each pipeline, whereas focusing on a limited number of Sanger-confirmed variants is not representative for the entire genome. The only other study that used simulated read datasets to compare combinations of mapper, caller and filtering methods found that the GATK variant caller in combination with VQSR consistently had the highest precision scores [<xref rid="R28" ref-type="bibr">28</xref>], supporting the findings of our study. This study, however, had multiple limitations. First, GATK calling was performed for one sample at a time, which is not optimal for VQSR or for low-coverage samples. Second, for the VQSR truth sets, half of the samples’ variants with the best quality score were taken, an approach that is problematic when high-frequency contaminant alleles are present. Third, the use of the clinical CDC1551 strain prohibited an assessment of accuracy for the complex regions as the exact location of CDC1551 variants in relation to H37Rv cannot be established with certainty for complex regions.</p>
    <p>We successfully overcame the limitations of prior <italic toggle="yes">Mtb</italic> pipeline accuracy studies by using an <italic toggle="yes">in silico</italic> approach to construct a fully representative variant truth set. The simulated dataset resembled clinical datasets by ensuring that some strains occurred once while others occurred several times. VQSR benefited from the presence of clonal strains as it improves the identification of variants in low-coverage samples observed in other samples. Our datasets simulating culture isolates represented the range of depth (5–100×) and low levels of contamination (0–5 %). Our simulated sputum datasets contained more than 21.4 % contamination (mean 82.12%, maximum 99.99%) and thus very low levels of <italic toggle="yes">Mtb</italic> DNA, which correspond to the findings of a recent study of the clinical samples where most (51%) WGS data showed less than 5 % <italic toggle="yes">Mtb</italic> DNA sequence reads [<xref rid="R9" ref-type="bibr">9</xref>]. The use of the simulated datasets allowed us not only to accurately quantify the performance of different pipelines for variant calling throughout the entire genome, including the complex regions, but also to assess the effect of important characteristics that determine accuracy such as mycobacterial burden, and level and type of contamination.</p>
    <p>The excellent performance of XBS for the analysis of complex samples was confirmed when analysing WGS data obtained from clinical samples. Analyses of the WGS data from clinical culture isolates showed that XBS outperformed other pipelines (including pipelines not investigated in this study) in terms of sensitivity (Table S3). The high specificity of XBS matches the findings of the culture simulations where the four pipeline approaches show similar recall scores. Analysis of WGS data obtained from DNA extracted directly from sputum samples confirmed that only XBS and MTBseq, but not UVP, could successfully analyse such data. While both pipelines showed high specificity (no evidence of false positive variants resulting in branch extension on the phylogeny), the performance of XBS was superior to MTBseq as it allowed the identification of 13.9 % more variants.</p>
    <p>Several limitations remain to the novel XBS variant caller. First, XBS (and other pipelines) cannot analyse samples when NTM contaminant sequences exceed 20 %. Such samples would require analyses by programs such as QuantTB that can potentially filter out NTM contaminants before <italic toggle="yes">Mtb</italic> variant identification as they resemble multiple infections [<xref rid="R29" ref-type="bibr">29</xref>]. Second, XBS requires multiple samples for each run. Previously inferred Genomic VCFs can, however, be included from the Combine VCF step just before the VQSR, eliminating the need to batch new samples. Third, the highly conserved rRNA regions had to be excluded for optimal specificity as sequences in these regions from contaminating bacteria can map to the <italic toggle="yes">Mtb</italic> reference genome with very high confidence, making the variants in such regions indistinguishable in terms of the statistical annotations used by VQSR. Eliminating these regions may result in some loss of the genomic information, albeit a small loss as this region represents only 0.1 % of the genome Fourth, we used H37Rv as the reference genome for all analysis. If the <italic toggle="yes">Mtb</italic> ancestral genome were used as the reference genome instead, a VQSR truth-set could be constructed by aligning the ancestral genome to H37Rv and translating the latter's lineage and DR truth variants. When applying the XBS approach to other bacteria, one should employ well-established variants that occur throughout the entire genome for constructing the VQSR truth set. Finally, we were not able to compare the run time of XBS to the other pipelines as there were important differences in the analyses run other than the variant calling core, and the number of samples analysed differed due to pipeline restrictions. However, elimination of the adapter removal and base recalibration steps reduces the overall processing time and exclusion of meta-genomic classification further reduces computing time. It also prevents the need for computing infrastructure with large memory requirements. To get an idea of the run time for genuine sputum samples we ran the 10 Goig <italic toggle="yes">et al</italic>. samples through the XBS core; the mapping and haplotype calling took under 15 min for each sample and was performed in parallel, and subsequent joint-calling and VQSR took under 5 min (eight threads and 64 GB memory provided).</p>
    <p>Direct-from-sputum WGS data contain a wealth of diverse bacterial contaminants besides that of human origin and all these contaminants occur at widely varying levels. It was not possible to represent this endless variety of bacterial contaminants in our simulation experiments, and hence the most commonly observed bacterial contaminants were used instead [<xref rid="R2" ref-type="bibr">2</xref>], NTMs were included because these pose a serious challenge for <italic toggle="yes">Mtb</italic> variant calling. Contaminant levels were simulated to match those observed for genuine sputum samples [<xref rid="R9" ref-type="bibr">9</xref>]. As such it was possible to study the effect of the various contaminants and their levels on variant calling; this would not have been possible had all the endless contaminants observed for direct-from-sputum samples been used. To show that XBS was able to handle such genuinely diverse contamination, two clinical WGS datasets were studied, one from cultured samples and one direct-from-sputum samples. Further studies are required to study the effect of the full diversity of contaminants that are observed for direct-from-sputum samples.</p>
    <p>In conclusion, all pipelines studied (MTBseq, UVP, XBS) accurately analysed WGS data from <italic toggle="yes">Mtb</italic> culture isolates. Only XBS and MTBseq could accurately identify variants in low<italic toggle="yes">-Mtb</italic>-coverage and highly contaminated samples and XBS achieved higher performance parameters of all the pipelines studied. High performance at low depth could decrease sequencing cost and improve WGS analysis directly from sputum samples. The accurate identification of variants in the complex genomic <italic toggle="yes">Mtb</italic> regions allow for improved resolution in transmission studies through increased genetic resolution and creates the ability to explore the functional role of variants in these complex regions. Taken together, the novel XBS pipeline sets the stage for the next generation of <italic toggle="yes">Mtb</italic> WGS studies.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Data</title>
    <supplementary-material position="float" id="supp1" content-type="local-data">
      <caption>
        <title>Supplementary material 1</title>
      </caption>
      <media xlink:href="mgen-7-0689-s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Funding information</title>
    <p>This work was supported by the Research Foundation Flanders (FWO) (grant number FWO Odysseus G0F8316N).</p>
  </ack>
  <ack id="ack2">
    <title>Acknowledgements</title>
    <p>We would like to thank the members of the Tuberculosis Omics ResearCH (TORCH) consortium for helpful discussions and particularly Elise De Vos for discussions surrounding sputum simulation. We thank the reviewers for helpful comments and Galo A. Goig <italic toggle="yes">et al</italic>. for providing additional direct-from-sputum sequencing data.</p>
  </ack>
  <ack id="ack3">
    <title>Author contributions</title>
    <p>T.H.H., R.M.W. and A.V.R.: conceptualized the project and methodology. T.H.H. and L.V.: curated the data and designed and scripted the software. R.M.W. and A.V.R.: acquired the funding. T.H.H., L.V., R.M.W. and A.V.R.: wrote, reviewed and edited the manuscript.</p>
  </ack>
  <ack id="ack4">
    <title>Conflicts of interest</title>
    <p content-type="COI-statement">The authors declare that there are no conflicts of interest.</p>
  </ack>
  <fn-group>
    <fn id="FN1">
      <p>Abbreviations: DR, drug resistance; GATK, Genome Analysis ToolKit; GVCF, Genomic Variant Call Format; INDEL, Insertion/Deletion; <italic toggle="yes">Mtb</italic>, <italic toggle="yes">Mycobacterium tuberculosis</italic>; NTM, non-tuberculous mycobacteria; SNP, Single Nucleotide Polymorphism; UVP, Unified Variant Pipeline; VCF, Variant Call Format; VQSR, Variant Quality Score Recalibration; WGS, whole genome sequencing; XBS, compleX Bacterial Sample.</p>
    </fn>
    <fn id="FN2">
      <p>All supporting data, code and protocols have been provided within the article or through supplementary data files. Three supplementary tables and six supplementary figures are available with the online version of this article.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="R1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meehan</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Goig</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Kohl</surname>
            <given-names>TA</given-names>
          </name>
        </person-group>
        <article-title>Whole genome sequencing of <italic toggle="yes">Mycobacterium tuberculosis</italic>: current standards and open issues</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2019</year>
        <volume>17</volume>
        <fpage>533</fpage>
        <lpage>545</lpage>
        <pub-id pub-id-type="doi">10.1038/s41579-019-0214-5</pub-id>
        <?supplied-pmid 31209399?>
        <pub-id pub-id-type="pmid">31209399</pub-id>
      </element-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McClean</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stanley</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Stanley</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Identification and characterization of breakthrough contaminants associated with the conventional isolation of <italic toggle="yes">Mycobacterium tuberculosis</italic>
</article-title>
        <source>J Med Microbiol</source>
        <year>2011</year>
        <volume>60</volume>
        <fpage>1292</fpage>
        <lpage>1298</lpage>
        <pub-id pub-id-type="doi">10.1099/jmm.0.030619-0</pub-id>
        <?supplied-pmid 21527550?>
        <pub-id pub-id-type="pmid">21527550</pub-id>
      </element-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rachow</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Saathoff</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mtafya</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mapamba</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mangu</surname>
            <given-names>C</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>The impact of repeated NALC/NaOH- decontamination on the performance of Xpert MTB/RIF assay</article-title>
        <source>Tuberculosis</source>
        <year>2018</year>
        <volume>110</volume>
        <fpage>56</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tube.2018.04.001</pub-id>
        <?supplied-pmid 29779774?>
        <pub-id pub-id-type="pmid">29779774</pub-id>
      </element-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Farmanfarmaei</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kamakoli</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Sadegh</surname>
            <given-names>HR</given-names>
          </name>
        </person-group>
        <article-title>Bias in detection of <italic toggle="yes">Mycobacterium tuberculosis</italic> polyclonal infection: Use clinical samples or cultures?</article-title>
        <source>Mol Cell Probes</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>1</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mcp.2017.01.002</pub-id>
        <?supplied-pmid 28130122?>
        <pub-id pub-id-type="pmid">28130122</pub-id>
      </element-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nimmo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Doyle</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Whole genome sequencing <italic toggle="yes">Mycobacterium tuberculosis</italic> directly from sputum identifies more genetic diversity than sequencing from culture</article-title>
        <source>BMC Genomics</source>
        <year>2019</year>
        <volume>20</volume>
        <elocation-id>389</elocation-id>
        <pub-id pub-id-type="doi">10.1186/s12864-019-5841-8</pub-id>
        <?supplied-pmid 31142261?>
        <pub-id pub-id-type="pmid">31109296</pub-id>
      </element-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ezewudo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Borens</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chiner-Oms</surname>
            <given-names>Á</given-names>
          </name>
        </person-group>
        <article-title>tegrating standardized whole genome sequence analysis with a global <italic toggle="yes">Mycobacterium tuberculosis</italic> antibiotic resistance knowledgebase</article-title>
        <source>Sci Rep</source>
        <year>2018</year>
        <volume>8</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <comment>DOI: 10.1038/s41598-018-33731-1</comment>
        <pub-id pub-id-type="pmid">29311619</pub-id>
      </element-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Genomic mapping by fingerprinting random clones: a mathematical analysis</article-title>
        <source>Genomics</source>
        <year>1988</year>
        <volume>2</volume>
        <fpage>231</fpage>
        <lpage>239</lpage>
        <pub-id pub-id-type="doi">10.1016/0888-7543(88)90007-9</pub-id>
        <?supplied-pmid 3294162?>
        <pub-id pub-id-type="pmid">3294162</pub-id>
      </element-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kohl</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Diel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Harmsen</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Whole-genome-based <italic toggle="yes">Mycobacterium tuberculosis</italic> surveillance: a standardized, portable, and expandable approach</article-title>
        <source>J Clin Microbiol</source>
        <year>2014</year>
        <volume>52</volume>
        <fpage>2479</fpage>
        <lpage>2486</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.00567-14</pub-id>
        <?supplied-pmid 24789177?>
        <pub-id pub-id-type="pmid">24789177</pub-id>
      </element-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goig</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Cancino-Muñoz</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Torres-Puente</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Whole-genome sequencing of <italic toggle="yes">Mycobacterium tuberculosis</italic> directly from clinical samples for high-resolution genomic epidemiology and drug resistance surveillance: an observational study</article-title>
        <source>The Lancet Microbe</source>
        <year>2020</year>
        <volume>1</volume>
        <fpage>e175</fpage>
        <lpage>e183</lpage>
        <pub-id pub-id-type="doi">10.1016/S2666-5247(20)30060-4</pub-id>
      </element-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kato-Maeda</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Passarelli</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Use of whole genome sequencing to determine the microevolution of <italic toggle="yes">Mycobacterium tuberculosis</italic> during an outbreak</article-title>
        <source>PLoS One</source>
        <year>2013</year>
        <volume>8</volume>
        <elocation-id>e58235</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0058235</pub-id>
        <?supplied-pmid 23472164?>
        <pub-id pub-id-type="pmid">23472164</pub-id>
      </element-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ruano-Rubio</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Scaling accurate genetic variant discovery to tens of thousands of samples</article-title>
        <source>BioRxiv</source>
        <year>2017</year>
        <fpage>201178</fpage>
      </element-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>491</fpage>
        <pub-id pub-id-type="doi">10.1038/ng.806</pub-id>
        <?supplied-pmid 21478889?>
        <pub-id pub-id-type="pmid">21478889</pub-id>
      </element-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM</article-title>
        <source>arXiv Prepr</source>
        <year>2013</year>
        <volume>3997</volume>
      </element-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pettengill</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>Y</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>CFSAN SNP pipeline: An automated method for constructing SNP matrices from next-generation sequence data</article-title>
        <source>PeerJ Comput Sci</source>
        <year>2015</year>
        <volume>1</volume>
        <elocation-id>e20</elocation-id>
        <pub-id pub-id-type="doi">10.7717/peerj-cs.20</pub-id>
      </element-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>ART: a next-generation sequencing read simulator</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>593</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id>
        <?supplied-pmid 22199392?>
        <pub-id pub-id-type="pmid">22199392</pub-id>
      </element-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kohl</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Utpatel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schleusener</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>MTBseq: a comprehensive pipeline for whole genome sequence analysis of <italic toggle="yes">Mycobacterium tuberculosis</italic> complex isolates</article-title>
        <source>PeerJ</source>
        <year>2018</year>
        <volume>6</volume>
        <elocation-id>e5895</elocation-id>
        <pub-id pub-id-type="doi">10.7717/peerj.5895</pub-id>
        <?supplied-pmid 30479891?>
        <pub-id pub-id-type="pmid">30479891</pub-id>
      </element-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roetzer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Diel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kohl</surname>
            <given-names>TA</given-names>
          </name>
        </person-group>
        <article-title>Whole genome sequencing versus traditional genotyping for investigation of a <italic toggle="yes">Mycobacterium tuberculosis</italic> outbreak: a longitudinal molecular epidemiological study</article-title>
        <source>PLoS Med</source>
        <year>2013</year>
        <volume>10</volume>
        <elocation-id>e1001387</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pmed.1001387</pub-id>
        <?supplied-pmid 23424287?>
        <pub-id pub-id-type="pmid">23424287</pub-id>
      </element-citation>
    </ref>
    <ref id="R18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coll</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>McNerney</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Guerra-Assunção</surname>
            <given-names>JA</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>A robust SNP barcode for typing <italic toggle="yes">Mycobacterium tuberculosis</italic> complex strains</article-title>
        <source>Nat Commun</source>
        <year>2014</year>
        <volume>5</volume>
        <fpage>1</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1038/ncomms5812</pub-id>
      </element-citation>
    </ref>
    <ref id="R19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coll</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Phelan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hill-Cawthorne</surname>
            <given-names>GA</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide analysis of multi-and extensively drug-resistant <italic toggle="yes">Mycobacterium tuberculosis</italic>
</article-title>
        <source>Nat Genet</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>307</fpage>
        <lpage>316</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-017-0029-0</pub-id>
        <?supplied-pmid 29358649?>
        <pub-id pub-id-type="pmid">29358649</pub-id>
      </element-citation>
    </ref>
    <ref id="R20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Napier</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Campino</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Merid</surname>
            <given-names>Y</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Robust barcoding and identification of <italic toggle="yes">Mycobacterium tuberculosis</italic> lineages for epidemiological and clinical studies</article-title>
        <source>Genome Med</source>
        <year>2020</year>
        <volume>12</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1186/s13073-020-00817-3</pub-id>
      </element-citation>
    </ref>
    <ref id="R21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Chernomor</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>IQ-TREE 2: new models and efficient methods for phylogenetic inference in the genomic era</article-title>
        <source>Mol Biol Evol</source>
        <year>2020</year>
        <volume>37</volume>
        <fpage>1530</fpage>
        <lpage>1534</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msaa015</pub-id>
        <?supplied-pmid 32011700?>
        <pub-id pub-id-type="pmid">32011700</pub-id>
      </element-citation>
    </ref>
    <ref id="R22">
      <label>22</label>
      <element-citation publication-type="journal">
        <comment>N.d</comment>
        <article-title>Rambaut A</article-title>
        <source>FigTree</source>
        <ext-link xlink:href="https://github.com/rambaut/figtree/" ext-link-type="uri">https://github.com/rambaut/figtree/</ext-link>
      </element-citation>
    </ref>
    <ref id="R23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goig</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Blanco</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Garcia-Basteiro</surname>
            <given-names>AL</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Contaminant DNA in bacterial sequencing experiments is a major source of false genetic variability</article-title>
        <source>BMC Biol</source>
        <year>2020</year>
        <volume>18</volume>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="pmid">31898513</pub-id>
      </element-citation>
    </ref>
    <ref id="R24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schleusener</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Köser</surname>
            <given-names>CU</given-names>
          </name>
          <name>
            <surname>Beckert</surname>
            <given-names>P</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title><italic toggle="yes">Mycobacterium tuberculosis</italic> resistance prediction and lineage classification from genome sequencing: Comparison of automated analysis tools</article-title>
        <source>Sci Rep</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/srep46327</pub-id>
        <pub-id pub-id-type="pmid">28127051</pub-id>
      </element-citation>
    </ref>
    <ref id="R25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jajou</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kohl</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Towards standardisation: Comparison of five whole genome sequencing (WGS) analysis pipelines for detection of epidemiologically linked tuberculosis cases</article-title>
        <source>Euro Surveill</source>
        <year>2019</year>
        <volume>24</volume>
        <pub-id pub-id-type="doi">10.2807/1560-7917.ES.2019.24.50.1900130</pub-id>
        <?supplied-pmid 31847944?>
        <pub-id pub-id-type="pmid">31847944</pub-id>
      </element-citation>
    </ref>
    <ref id="R26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nikolayevskyy</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Kranzer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Niemann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Whole genome sequencing of <italic toggle="yes">Mycobacterium tuberculosis</italic> for detection of recent transmission and tracing outbreaks: a systematic review</article-title>
        <source>Tuberculosis</source>
        <year>2016</year>
        <volume>98</volume>
        <fpage>77</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tube.2016.02.009</pub-id>
        <?supplied-pmid 27156621?>
        <pub-id pub-id-type="pmid">27156621</pub-id>
      </element-citation>
    </ref>
    <ref id="R27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meehan</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Moris</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kohl</surname>
            <given-names>TA</given-names>
          </name>
        </person-group>
        <article-title>The relationship between transmission time and clustering methods in <italic toggle="yes">Mycobacterium tuberculosis</italic> epidemiology</article-title>
        <source>EBioMedicine</source>
        <year>2018</year>
        <volume>37</volume>
        <fpage>410</fpage>
        <lpage>416</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ebiom.2018.10.013</pub-id>
        <?supplied-pmid 30341041?>
        <pub-id pub-id-type="pmid">30341041</pub-id>
      </element-citation>
    </ref>
    <ref id="R28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Walter</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Colijn</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>T</given-names>
          </name>
          <etal>et al</etal>
        </person-group>
        <article-title>Genomic variant-identification methods may alter <italic toggle="yes">Mycobacterium tuberculosis</italic> transmission inferences</article-title>
        <source>Microb Genomics</source>
        <year>2020</year>
        <volume>6</volume>
        <pub-id pub-id-type="doi">10.1099/mgen.0.000418</pub-id>
      </element-citation>
    </ref>
    <ref id="R29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anyansi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Keo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>QuantTB--A method to classify mixed <italic toggle="yes">Mycobacterium tuberculosis</italic> infections within whole genome sequencing data</article-title>
        <source>BMC Genomics</source>
        <year>2020</year>
        <volume>21</volume>
        <elocation-id>80</elocation-id>
        <pub-id pub-id-type="doi">10.1186/s12864-020-6486-3</pub-id>
        <?supplied-pmid 31992201?>
        <pub-id pub-id-type="pmid">31992201</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
