<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Adv</journal-id>
    <journal-id journal-id-type="publisher-id">SciAdv</journal-id>
    <journal-id journal-id-type="hwp">advances</journal-id>
    <journal-title-group>
      <journal-title>Science Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2375-2548</issn>
    <publisher>
      <publisher-name>American Association for the Advancement of Science</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7439569</article-id>
    <article-id pub-id-type="publisher-id">aba2619</article-id>
    <article-id pub-id-type="doi">10.1126/sciadv.aba2619</article-id>
    <article-categories>
      <subj-group subj-group-type="article-type">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Research Articles</subject>
      </subj-group>
      <subj-group subj-group-type="legacy-article-type">
        <subject>SciAdv r-articles</subject>
      </subj-group>
      <subj-group subj-group-type="field">
        <subject>Systems Biology</subject>
        <subject>Life Sciences</subject>
      </subj-group>
      <subj-group subj-group-type="overline">
        <subject>Systems Biology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Deep learning–based cell composition analysis from tissue expression profiles</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">http://orcid.org/0000-0002-5228-985X</contrib-id>
        <name>
          <surname>Menden</surname>
          <given-names>Kevin</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref rid="cor1" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">http://orcid.org/0000-0002-3877-7793</contrib-id>
        <name>
          <surname>Marouf</surname>
          <given-names>Mohamed</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">http://orcid.org/0000-0002-8994-1549</contrib-id>
        <name>
          <surname>Oller</surname>
          <given-names>Sergio</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dalmia</surname>
          <given-names>Anupriya</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">http://orcid.org/0000-0001-5708-8400</contrib-id>
        <name>
          <surname>Magruder</surname>
          <given-names>Daniel Sumner</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kloiber</surname>
          <given-names>Karin</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">http://orcid.org/0000-0001-5218-1737</contrib-id>
        <name>
          <surname>Heutink</surname>
          <given-names>Peter</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">http://orcid.org/0000-0003-4366-5662</contrib-id>
        <name>
          <surname>Bonn</surname>
          <given-names>Stefan</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref rid="cor1" ref-type="corresp">*</xref>
      </contrib>
      <aff id="aff1"><label>1</label>German Center for Neurodegenerative Diseases, Tuebingen, Germany.</aff>
      <aff id="aff2"><label>2</label>Institute of Medical Systems Biology, University Medical Center Hamburg-Eppendorf, Hamburg, Germany.</aff>
      <aff id="aff3"><label>3</label>Genevention GmbH, Goettingen, Germany.</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>*</label>Corresponding author. Email: <email xlink:href="sbonn@uke.de">sbonn@uke.de</email> (S.B.); <email xlink:href="kevin.menden@dzne.de">kevin.menden@dzne.de</email> (K.M.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <volume>6</volume>
    <issue>30</issue>
    <elocation-id>eaba2619</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>11</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>05</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2020 The Authors, some rights reserved; exclusive licensee American Association for the Advancement of Science. No claim to original U.S. Government Works. Distributed under a Creative Commons Attribution NonCommercial License 4.0 (CC BY-NC).</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>The Authors</copyright-holder>
      <license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/" id="p-2">
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="vor" start_date="2020-07-22">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial license</ext-link>, which permits use, distribution, and reproduction in any medium, so long as the resultant use is <bold>not</bold> for commercial advantage and provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract abstract-type="teaser">
      <p>Scaden enables robust cell type deconvolution of complex samples across data types, using a deep learning–based model.</p>
    </abstract>
    <abstract>
      <p>We present Scaden, a deep neural network for cell deconvolution that uses gene expression information to infer the cellular composition of tissues. Scaden is trained on single-cell RNA sequencing (RNA-seq) data to engineer discriminative features that confer robustness to bias and noise, making complex data preprocessing and feature selection unnecessary. We demonstrate that Scaden outperforms existing deconvolution algorithms in both precision and robustness. A single trained network reliably deconvolves bulk RNA-seq and microarray, human and mouse tissue expression data and leverages the combined information of multiple datasets. Because of this stability and flexibility, we surmise that deep learning will become an algorithmic mainstay for cell deconvolution of various data types. Scaden’s software package and web application are easy to use on new as well as diverse existing expression datasets available in public resources, deepening the molecular and cellular understanding of developmental and disease processes.</p>
    </abstract>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Copyeditor</meta-name>
        <meta-value>Kyle Solis</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec sec-type="introduction" disp-level="1">
    <title>INTRODUCTION</title>
    <p>The analysis of tissue-specific gene expression using next-generation sequencing [RNA sequencing (RNA-seq)] is a centerpiece of the molecular characterization of biological and medical processes (<xref rid="R1" ref-type="bibr"><italic>1</italic></xref>). A well-known limitation of tissue-based RNA-seq is that it typically measures average gene expression across many molecularly diverse cell types that can have distinct cellular states (<xref rid="R2" ref-type="bibr"><italic>2</italic></xref>). A change in gene expression between two conditions can therefore be attributed to a change in the cellular composition of the tissue or a change in gene expression in a specific cell population, or a mixture of the two. To deconvolve the cell type composition from a change in gene expression is especially important in systems with cellular proliferation (e.g., cancer) or cellular death (e.g., neuronal loss in neurodegenerative diseases) due to systematic cell population differences between experimental groups (<xref rid="R3" ref-type="bibr"><italic>3</italic></xref>).</p>
    <p>To account for this problem, several computational cell deconvolution methods have been proposed during the last years (<xref rid="R4" ref-type="bibr"><italic>4</italic></xref>, <xref rid="R5" ref-type="bibr"><italic>5</italic></xref>). These algorithms use gene expression profiles (GEPs) of cell type–specifically expressed genes to estimate cellular fractions using linear regression to detect, interpret, and possibly correct for systematic differences in cellular abundance between samples (<xref rid="R4" ref-type="bibr"><italic>4</italic></xref>). While the best-performing linear regression algorithms for deconvolution seem to be variations of support vector regression (<xref rid="R6" ref-type="bibr"><italic>6</italic></xref>–<xref rid="R10" ref-type="bibr"><italic>10</italic></xref>), the selection of an optimal GEP is a field of active research (<xref rid="R10" ref-type="bibr"><italic>10</italic></xref>, <xref rid="R11" ref-type="bibr"><italic>11</italic></xref>). It has been recently shown that the design of the GEP is the most important factor in most deconvolution methods, as results from different algorithms strongly correlate given the same GEP (<xref rid="R11" ref-type="bibr"><italic>11</italic></xref>).</p>
    <p>In theory, an optimal GEP should contain a set of genes that are predominantly expressed within each cell population of a complex sample (<xref rid="R12" ref-type="bibr"><italic>12</italic></xref>). They should be stably expressed across experimental conditions, for example, across health and disease, and resilient to experimental noise and bias. However, bias is typically inherent to biomedical data and is imparted, for instance, by intersubject variability, variations across species, different data acquisition methods, different experimenters, or different data types. The negative impact of bias on deconvolution performance can be partly improved by using large, heterogeneous GEP matrices (<xref rid="R11" ref-type="bibr"><italic>11</italic></xref>). It is therefore expected that recent advancement in cell deconvolution relied almost exclusively on sophisticated algorithms to normalize the data and engineer optimal GEPs (<xref rid="R10" ref-type="bibr"><italic>10</italic></xref>).</p>
    <p>While GEP-based approaches lay the foundational basis of modern cell deconvolution algorithms, we hypothesize that deep neural networks (DNNs) could create optimal features for cell deconvolution, without relying on the complex generation of GEPs. DNNs such as multilayer perceptrons are universal function approximators that achieve state-of-the-art performance on classification and regression tasks. Whereas this feature is of little importance for strictly linear input data, it makes DNNs superior to linear regression algorithms as soon as data deviate from ideal linearity. This means, for instance, that as soon as data are noisy or biased and classical linear regression algorithms may falter, the hidden layer nodes of the DNN learn to represent higher-order latent representations of cell types that do not depend on input noise and bias. We theorize, therefore, that by using gene expression information as network input, hidden layer nodes of the DNN would represent higher-order latent representations of cell types that are robust to input noise and technical bias.</p>
    <p>An obvious limitation of DNNs is the requirement for large training data to avoid overfitting of the machine learning model. While ground-truth information on tissue RNA-seq cell composition is scarce, one can use single-cell RNA-seq (scRNA-seq) data to obtain large numbers of in silico tissue datasets of predefined cell composition (<xref rid="R7" ref-type="bibr"><italic>7</italic></xref>–<xref rid="R9" ref-type="bibr"><italic>9</italic></xref>, <xref rid="R13" ref-type="bibr"><italic>13</italic></xref>–<xref rid="R15" ref-type="bibr"><italic>15</italic></xref>). We do this by subsampling and subsequently merging cells from scRNA-seq datasets, this approach being limited only by the availability of tissue-specific scRNA-seq data. It is to be noted that scRNA-seq data suffer from biases, such as dropout, to which RNA-seq data are not subject (<xref rid="R16" ref-type="bibr"><italic>16</italic></xref>). While this complicates the use of scRNA-seq data for GEP design (<xref rid="R8" ref-type="bibr"><italic>8</italic></xref>), we surmise that latent network nodes could represent features that are robust to these biases.</p>
    <p>On the basis of these assumptions, we developed a single cell–assisted deconvolutional DNN (Scaden) that uses simulated bulk RNA-seq samples for training and predicts cell type proportions for input expression samples of cell mixtures. Scaden is available as downloadable software package and web application (<ext-link ext-link-type="uri" xlink:href="https://scaden.ims.bio">https://scaden.ims.bio</ext-link>). Scaden is trained on publicly available scRNA-seq and RNA-seq data, does not rely on specific GEP matrices, and automatically infers informative features. Last, we show that Scaden deconvolves expression data into cell types with higher precision and robustness than existing methods that rely on GEP matrices.</p>
  </sec>
  <sec sec-type="results" disp-level="1">
    <title>RESULTS</title>
    <sec disp-level="2">
      <title>Scaden overview, model selection, and training</title>
      <p>In this part, we focus on the design and optimization of Scaden by training, validation, and testing on in silico data. Note that the generation of in silico data is a strictly linear mathematical operation. Our aim in this context, to corroborate Scaden’s basic functionality, is to show that Scaden’s performance compares with (but not necessarily exceeds) that of state-of-the-art algorithms.</p>
      <p>The basic architecture of Scaden is a DNN that takes gene counts of RNA-seq data as input and outputs predicted cell fractions (<xref rid="F1" ref-type="fig">Fig. 1</xref>). To optimize the performance of the DNN, it is trained on data that contain both the gene expression and the real cell type fraction information (<xref rid="F1" ref-type="fig">Fig. 1B</xref>). The network then adjusts its weights to minimize the error between the predicted cell fractions and the real cell fractions (<xref rid="F1" ref-type="fig">Fig. 1C</xref>). We restricted feature selection to the removal of “uninformative” genes that have either zero expression or an expression variance below 0.1, leaving ~10,000 genes for training. In our hands, this feature selection step decreases training time and memory usage.</p>
      <fig id="F1" fig-type="figure" orientation="portrait" position="float">
        <label>Fig. 1</label>
        <caption>
          <title>Overview of training data generation and cell type deconvolution with Scaden.</title>
          <p>(<bold>A</bold>) Artificial bulk samples are generated by subsampling random cells from an scRNA-seq dataset and merging their expression profiles. (<bold>B</bold>) Model training and parameter optimization on simulated tissue RNA-seq data by comparing cell fraction predictions to ground-truth cell composition. (<bold>C</bold>) Cell deconvolution of real tissue RNA-seq data using Scaden.</p>
        </caption>
        <graphic xlink:href="aba2619-F1"/>
      </fig>
      <p>For the model selection and training, we made use of the large numbers of artificial bulk RNA-seq datasets with defined composition that can be generated in silico from published scRNA-seq and RNA-seq datasets (simulated tissues; <xref rid="F1" ref-type="fig">Fig. 1A</xref> and tables S1 and S2). The only constraint is that the scRNA-seq and RNA-seq data must come from the same tissue as the bulk data subject to deconvolution.</p>
      <p>To find the optimal DNN architecture for cell deconvolution, we generated bulk peripheral blood mononuclear cell (PBMC) RNA-seq data from four publicly available scRNA-seq datasets (tables S1 and S3). We performed leave-one-dataset-out cross-validation, training Scaden on mixtures of synthetic datasets from three scRNA-seq datasets and evaluating the performance on simulated tissue from a fourth scRNA-seq dataset.</p>
      <p>We used the root mean square error (RMSE), Pearson’s correlation coefficient (<italic>r</italic>), the slope and intercept of the regression fitted for ground-truth and predicted cell fractions, and Lin’s concordance correlation coefficient (CCC) (<xref rid="R17" ref-type="bibr"><italic>17</italic></xref>) to assess algorithmic performance. The CCC is a measure sensitive not only to scatter but also to deviations from linearity (slope and intercept). Within the main text, we report on CCC and RMSE values only; other metrics can be found in the Supplementary Materials.</p>
      <p>The final Scaden model is an ensemble of the three best-performing models (table S4), and the final cell type composition estimates are the averaged predictions of all three ensemble models (<xref rid="F1" ref-type="fig">Fig. 1</xref> and fig. S1). Using an ensemble of models increased the deconvolution performance as compared to single best models (table S6). Details of the model and hyperparameters are given in table S5. We also evaluated the effect of the size of the training dataset on Scaden deconvolution performance, repeating leave-one-dataset-out cross-validation on PBMC data with training dataset sizes from 150 up to 15,000 samples (fig. S2). The increase in CCC value starts to level off from about 1500 simulated samples for this dataset but continues to increase slowly with sample size. We specifically addressed the question to what degree the DNN, trained on simulated samples, tends to overfit, failing to generalize to real bulk RNA-seq data. To understand after how many steps a model trained on in silico data overfits on real RNA-seq data, we trained Scaden on simulated data from an ascites scRNA-seq dataset (table S1; 6000 samples) and evaluated the loss function on a corresponding annotated RNA-seq dataset (<xref rid="R18" ref-type="bibr"><italic>18</italic></xref>) (table S2; three samples) as a function of the number of steps (fig. S3). All models converged after approximately 5000 steps and slightly overfit when trained for longer. On the basis of this result, we opted for an early-stop approach after 5000 steps for evaluation on real bulk RNA-seq data.</p>
      <p>We then compared Scaden to four state-of-the-art GEP-based cell deconvolution algorithms, CIBERSORT (CS) (<xref rid="R6" ref-type="bibr"><italic>6</italic></xref>), CIBERSORTx (CSx) (<xref rid="R7" ref-type="bibr"><italic>7</italic></xref>), Multi-subject Single Cell deconvolution (MuSiC) (<xref rid="R8" ref-type="bibr"><italic>8</italic></xref>), and Cell Population Mapping (CPM) (<xref rid="R9" ref-type="bibr"><italic>9</italic></xref>). While CS relies on hand-curated GEP matrices, CSx, MuSiC, and CPM can generate GEPs using scRNA-seq data as input.</p>
      <p>To get an initial estimate of Scaden’s deconvolution fidelity, we trained the model on 24,000 simulated PBMC RNA-seq samples from three datasets and tested its performance in comparison to CS, CSx, MuSiC, and CPM on a fourth dataset of 500 samples each (e.g., training on data6k, data8k, and donorA and evaluation on donorC). We used corresponding scRNA-seq datasets for the construction of GEPs as input for CSx and MuSiC, and CPM. For CS, we used the PBMC-optimized LM22 GEP matrix (<xref rid="R6" ref-type="bibr"><italic>6</italic></xref>), which was developed by the CS authors for the deconvolution of human PBMC data.</p>
      <p>For two of four test datasets (donorA and donorC), Scaden obtained the highest CCC and lowest RMSE, followed by CSx, MuSiC, CS, and CPM (fig. S4 and table S7). CSx and MuSiC obtained the highest CCC values for the data8k and data6k datasets, respectively. Scaden obtained the highest average CCC and lowest RMSE (0.88 and 0.08, respectively), followed by MuSiC (0.85 and 0.10), CSx (0.83 and 0.11), CS (0.63 and 0.15), and CPM (0 and 0.20; fig. S4). As expected, all algorithms that use scRNA-seq data as reference performed well, with the notable exception of CPM. We want to mention that CPM focuses on the reconstruction of continuous spectra of cellular states, while it incorporates cell deconvolution as an additional feature. We therefore report CPM’s deconvolution performance in the Supplementary Materials from here on. On average, Scaden also obtained the highest correlation and the best intercept and slope values on simulated PBMC data (table S7). A closer inspection on a per–cell type basis (<xref rid="F2" ref-type="fig">Fig. 2A</xref>) revealed that Scaden yields consistently higher CCC values and lower RMSEs when compared to the other algorithms.</p>
      <fig id="F2" fig-type="figure" orientation="portrait" position="float">
        <label>Fig. 2</label>
        <caption>
          <title>Performance comparison of deconvolution algorithms on simulated tissue data.</title>
          <p>(<bold>A</bold>) Boxplots of the cell type prediction CCC and RMSE for four simulated PBMC datasets. Tables S14 and S16 contain information on the five (six for CS) cell types used. (<bold>B</bold>) Scatterplots for four pancreas cell types of ground-truth (<italic>x</italic> axis) and predicted values (<italic>y</italic> axis) for Scaden, CSx, and MuSiC on artificial pancreas data (<xref rid="R20" ref-type="bibr"><italic>20</italic></xref>). Numbers inside the plotting area and in parenthesis signify CCC values.</p>
        </caption>
        <graphic xlink:href="aba2619-F2"/>
      </fig>
      <p>A specific feature of the MuSiC algorithm is that it preferentially weighs genes according to low intersubject and intracell cluster variability for its GEP, which increases deconvolution robustness when high-expression heterogeneity is observed between human participants, for example (<xref rid="R8" ref-type="bibr"><italic>8</italic></xref>). To understand whether Scaden can use multisubject information to increase its deconvolution performance, we trained Scaden, CSx, and MuSiC on scRNA-seq pancreas data from several participants (<xref rid="R19" ref-type="bibr"><italic>19</italic></xref>) and assessed the performance on a separate simulated pancreas RNA-seq dataset (<xref rid="R20" ref-type="bibr"><italic>20</italic></xref>). To allow for direct comparison, we chose the same pancreas training and test datasets that were used in the original MuSiC publication (table S1). To enable Scaden to leverage the heterogeneity of multisubject data, training data were generated separately for every participant in the dataset (see Methods). CSx cannot profit from multisubject data but performed well on the artificial PBMC datasets and was therefore included in the comparison. The best average performance (across cell types) is achieved by Scaden (CCC = 0.98), closely followed by MuSiC (CCC = 0.93), while CSx does not perform as well (CCC = 0.75; <xref rid="F2" ref-type="fig">Fig. 2B</xref> and table S8). On a per–cell type basis, Scaden’s predictions are clearly superior to the other two algorithms for all cell types. This provides strong evidence that Scaden, by separating training data generation for each participant, can learn intersubject heterogeneity and outperform specialized multisubject algorithms such as MuSiC on the cell type deconvolution task.</p>
      <p>In addition, we wanted to test how the best-performing deconvolution algorithms Scaden, MuSiC, and CSx behave when unknown cell content is part of the mixture. To test this, all cells falling into the “Unknown” category were removed from the training or reference PBMC datasets but added to the simulated mixture samples at fixed percentages (5, 10, 20, and 30%; see Methods). Scaden obtains the highest CCC for all tested percentages of unknown cell content (fig. S5 and table S9). The general deconvolution performance declines linearly with increasing percentage of unknown content for all tested algorithms, indicating that Scaden, MuSiC, and CSx have a similar robustness against unknown mixture content.</p>
      <p>We next compared the runtime and memory footprint of Scaden and MuSiC on an Intel Xeon six-core central processing unit (CPU) to the runtime of the CSx web application. Scaden is the only algorithm that requires the generation of in silico training data, which takes 13 min for 2000 samples with a peak memory usage of 8 GB. Similar values were obtained for the human brain data. Next, we used the PBMC data to benchmark the runtime and memory consumption of the deconvolution task. For Scaden, model training took ~11 min and cell fraction prediction ~8 s for 500 samples, using less than 1-GB memory. We used the web application of CSx with batch correction to deconvolve the 500 PBMC samples in 35 min. MuSiC took only 2 min and 15 s to deconvolve all 500 samples, with the memory usage peaking at 4.5 GB. As Scaden can take advantage of a graphics processing unit (GPU), we additionally compared training duration on an AMD Ryzen 5 2600 CPU and GeForce RTX 2600 GPU on the same machine. Training on the CPU took 9 min and 39 s, while it took only 3 min and 2 s on the GPU, corresponding to a roughly three times shorter runtime for Scaden if a GPU is available.</p>
    </sec>
    <sec disp-level="2">
      <title>Robust deconvolution of bulk expression data</title>
      <p>The true use case of cell deconvolution algorithms is the cell fraction estimation of tissue RNA-seq data. In particular for noisy and biased bulk RNA-seq data, we hypothesize that Scaden’s latent feature representations might help it to more robustly predict cell fractions as compared to GEP-based algorithms.</p>
      <p>We therefore assessed the performance of Scaden, CS, CSx, and MuSiC to deconvolve two publicly available human PBMC bulk RNA-seq datasets, for which curated GEP matrices and RNA-seq data with associated ground-truth cell type compositions from flow cytometry are available (see the “Data availability” section). We will refer to these datasets that consists of 12 samples each as PBMC1 (<xref rid="R21" ref-type="bibr"><italic>21</italic></xref>) and PBMC2 (<xref rid="R10" ref-type="bibr"><italic>10</italic></xref>) (table S2). Both datasets have similar cell type compositions across samples, with CD4 and CD8 T cells making up the biggest fractions. Deconvolution for all methods was performed as described in the previous section, with the difference that data from all four PBMC scRNA-seq datasets were now deployed for Scaden training. Results are given in <xref rid="F3" ref-type="fig">Fig. 3 (A to C)</xref> and tables S10 and S11.</p>
      <fig id="F3" fig-type="figure" orientation="portrait" position="float">
        <label>Fig. 3</label>
        <caption>
          <title>Comparison of deconvolution algorithms on PBMC tissue RNA-seq data.</title>
          <p>(<bold>A</bold>) Per–cell type scatterplots of ground-truth (<italic>x</italic> axis) and predicted values (<italic>y</italic> axis) for Scaden, CS, CSx, and MuSiC on real PBMC1 and PBMC2 cell fractions. Numbers inside the plotting area signify CCC values. For Scaden, the CCC using only scRNA-seq training data is shown in parenthesis, and the CCC using mixed scRNA-seq and RNA-seq training data is shown without parentheses. (<bold>B</bold>) Boxplots of RMSE values for real PBMC1 and PBMC2 data. (<bold>C</bold>) CCC values for real PBMC1 and PBMC2 data.</p>
        </caption>
        <graphic xlink:href="aba2619-F3"/>
      </fig>
      <p>On the PBMC1 dataset and using all cell types, Scaden obtained the highest CCC and lowest RMSE (0.56 and 0.13), while CSx (0.55 and 0.16) and CS (0.43 and 0.15) performed well yet notably worse than Scaden (<xref rid="F3" ref-type="fig">Fig. 3A</xref> and tables S10 and S11). CPM (0 and 0.18) and MuSiC (−0.19 and 0.32) both failed to deconvolve the cell fractions of the PBMC1 data. Scaden also obtained the best CCC and RMSE (0.68 and 0.08) on the PBMC2 dataset, while CS (0.58 and 0.10) and CSx (0.42 and 0.13) obtained good deconvolution results. Similar to the PBMC1 data deconvolution results, CPM (−0.16 and 0.11) and MuSiC (−0.13 and 0.30) did not perform well on the PBMC2 deconvolution task. In addition to CCC and RMSE metrics, Scaden achieves the best correlation, intercept, and slope on both PBMC datasets (tables S10 and S11).</p>
      <p>In particular, Scaden outperforms classical algorithms on a per–cell type basis (<xref rid="F3" ref-type="fig">Fig. 3, B and C</xref>). These results show weaker correlations and a strong dependence on the cell type. A closer examination of the metrics in table S11 and fig. S6 shows that the largest variations are found in the slope and intercept.</p>
      <p>We further evaluated how good the Scaden ensemble performs compared to the best single DNN model (M512, 512 nodes input layer). While the M512 model shows good deconvolution performance on the PBMC1 (CCC, 0.57) and PBMC2 (CCC, 0.68) datasets, the ensemble model achieves the best average cross-validation performance (table S6). We therefore opted to use the ensemble method to reduce interdataset performance variation observed with M512 and other single models.</p>
      <p>An additional algorithmic feature of Scaden is that it seamlessly integrates increasing amounts of training data, which can be of different types, such as a combination of simulated tissue and real tissue data with cell fraction information. In theory, even limited real tissue training data could make Scaden robust to data type bias and consequently improve Scaden’s deconvolution performance on real tissue data. We therefore trained Scaden on a mix of simulated PBMC and real PBMC2 (12 samples) data and evaluated its performance on real PBMC1 data (<xref rid="F3" ref-type="fig">Fig. 3, A and B</xref>, fig. S6, and tables S10 and S11). While the training contained very little (~2%) real data, Scaden’s CCC increased from 0.56 to 0.72, and the RMSE decreased from 0.13 to 0.10. We observed similar performance increases when Scaden was trained on simulated PBMC and real PBMC1 data and evaluated on real PBMC2 data (<xref rid="F3" ref-type="fig">Fig. 3, A and B</xref>, fig. S6, and tables S10 and S11). Next, we wanted to investigate how a Scaden model trained on only few real samples compares to the models trained on simulated or simulated and real data. While a Scaden model trained on only bulk PBMC1 samples (<italic>n</italic> = 12) deconvolves PBMC2 data with a CCC of 0.62, it does not reach the CCC of models trained on simulated data (CCC of 0.68) or on simulated and bulk data (CCC of 0.86). We would also not advise training models on so few training samples, as these models are usually overfit.</p>
      <p>This further validates that Scaden reliably deconvolves tissue RNA-seq data into the constituent cell fractions and that very accurate deconvolution results can be obtained if reference and target datasets are from the same experiment.</p>
      <p>We next wanted to test how the algorithm performs on postmortem human brain tissue of a subsample from the Religious Orders Study and Memory and Aging Project (ROSMAP) study (<xref rid="R22" ref-type="bibr"><italic>22</italic></xref>), for which ground-truth cell composition information was recently measured by immunohistochemistry (41 samples with all cell types given) (<xref rid="R23" ref-type="bibr"><italic>23</italic></xref>). The data provided by this study consist of bulk RNA-seq data from the dorsolateral prefrontal cortex and pose a special challenge due to the complexity of its cell type composition, which is further complicated by the fact that the data originate from brains of healthy individuals as well as patients with Alzheimer’s disease (AD) at various stages of neuronal loss. As reference datasets, we used the scRNA-seq dataset provided by Darmanis <italic>et al.</italic> (<xref rid="R24" ref-type="bibr"><italic>24</italic></xref>) from the anterior temporal lobe of living patients and the Lake dataset that isolates nuclei of neurons from two (visual and frontal) cortical regions from a postmortem brain and subjects them to RNA-seq (<xref rid="R25" ref-type="bibr"><italic>25</italic></xref>). From these, we generated 2000 training samples (Darmanis) and 4000 samples (two regions from the Lake dataset).</p>
      <p><xref rid="F4" ref-type="fig">Figure 4A</xref> shows the deconvolution results for all three algorithms with the Darmanis (scRNA-seq) reference dataset. Scaden achieves the highest CCC value (0.92) followed by MuSiC (0.87) and CSx (0.81; table S12). Compared to Scaden, MuSiC and CSx overestimate neural percentages, leading to higher RMSE values of 0.09 and 0.12, respectively (Scaden, 0.06). Notably, all methods showed a lower CCC on the per–cell type level (<xref rid="F3" ref-type="fig">Fig. 3B</xref>), demonstrating that some per–cell type correlations are poor, either in slope, intercept, variance, or a combination of them. This emphasizes the need for a cell type–specific inspection of results and highlights that, depending on the dataset, cell type–specific deconvolution results can be far from perfect.</p>
      <fig id="F4" fig-type="figure" orientation="portrait" position="float">
        <label>Fig. 4</label>
        <caption>
          <title>Deconvolution performance comparison on brain tissue RNA-seq data.</title>
          <p>(<bold>A</bold>) Prediction of human brain cell fractions of the ROSMAP dataset using the Darmanis dataset as a reference: scatterplots of ground-truth (<italic>x</italic> axis) and predicted values (<italic>y</italic> axis) for Scaden, CSx, and MuSiC of data. CCC values are shown as inserts. (<bold>B</bold>) Per–cell type CCC values for ROSMAP using the Darmanis data as a reference. (<bold>C</bold>) Neuronal content determined by Scaden trained on mouse brain data and evaluated on the Braak stage of the ROSMAP study.</p>
        </caption>
        <graphic xlink:href="aba2619-F4"/>
      </fig>
      <p>In addition to comparing the predictive power of Scaden, CSx, and MuSiC on human brain tissue with different reference datasets, we also tested how the choice of reference datasets affected Scaden’s deconvolution results. Notably, all methods substantially drop in performance when the Lake single-nucleus RNA-seq dataset is used as a reference as we had presumed (fig. S7A). We want to emphasize that Scaden, in contrast to CSx and MuSiC, has the possibility to simultaneously use both datasets as reference, whereas for CSx and MuSiC, the user has to choose one of the two, unaware of which will give the correct results.</p>
      <p>We found that the performance of Scaden was almost unaffected when the Lake dataset was added to the Darmanis training samples (CCC = 0.90, RMSE = 0.06; fig. S7A and table S12). These results show that cell deconvolution with Scaden is robust to training data bias (Darmanis single-cell versus Lake single-nucleus data). An added benefit of Scaden is that it allows for the inclusion and mixing of different scRNA-seq experiments in the training dataset, further increasing its robustness (fig. S7A). Last, when calculating the CCC values on a per-sample basis, Scaden achieves the best scores for most samples (fig. S7B).</p>
      <p>In a next step, we wanted to assess whether Scaden’s deconvolution performance was robust across species by trying to predict the cell fractions of the ROSMAP study (<xref rid="R22" ref-type="bibr"><italic>22</italic></xref>) with a Scaden model trained on in silico data from five mouse brain scRNA-seq datasets (table S1). Intriguingly, Scaden was able to achieve a CCC value of 0.83 and an RMSE of 0.079, showing that Scaden can reliably deconvolve RNA-seq data across related species.</p>
      <p>The ROSMAP study also contains information on the Braak stages (<xref rid="R26" ref-type="bibr"><italic>26</italic></xref>) corresponding to 390 human postmortem prefrontal cortex samples, which correlate with the severity and progression stage of AD and the degree of neuronal loss. We used the Scaden model trained on artificial data generated from five mouse brain scRNA-seq datasets to predict neuronal cell fractions of this larger human dataset. Overall, Scaden’s cell fraction predictions capture the increased neuronal loss with increasing Braak stage (<xref rid="F4" ref-type="fig">Fig. 4C</xref>). The largest drop in neural percentage is observed at stage 5, when the neurodegeneration typically reaches the prefrontal cortex of the brain.</p>
      <p>Given the robustness with which Scaden predicts tissue RNA-seq cell fractions using scRNA-seq training data, even across species, we next wanted to investigate whether an scRNA-seq–trained Scaden model can also deconvolve other data types. To this end, we measured the deconvolution performance on a bulk PBMC microarray dataset (20 samples) (<xref rid="R6" ref-type="bibr"><italic>6</italic></xref>) of a Scaden model trained on scRNA-seq and RNA-seq PBMC data (see above). We compared Scaden to CS using the microarray-derived LM22 matrix. CS achieved a slightly higher CCC and slightly lower total RMSE (0.72 and 0.11) than Scaden (0.71 and 0.13), while Scaden obtained the highest average CCC (0.50) compared to CS (0.39; fig. S8 and table S13). Notably, in this scenario, Scaden was trained entirely on simulated scRNA-seq and RNA-seq data, while CS’s LM22 GEP was optimized on PBMC microarray data.</p>
      <p>Overall, we provide strong evidence that Scaden robustly deconvolves tissue data across tissues, species, and even data types.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" disp-level="1">
    <title>DISCUSSION</title>
    <p>Scaden is a novel deep learning–based cell deconvolution algorithm that, in many instances, compares favorably in both prediction robustness and accuracy to existing deconvolution algorithms that rely on GEP design and linear regression. We believe that Scaden’s performance relies to a large degree on the inherent feature engineering of the DNN. The network does not only select features (genes) for regression but also creates new features that are optimal for the regression task in the nodes of the hidden layers. These hidden features are nonlinear combinations of the input features (gene expression), which makes it notoriously difficult to explain how a DNN works (<xref rid="R27" ref-type="bibr"><italic>27</italic></xref>). It is important to highlight that this feature creation is fundamentally different from all other existing cell deconvolution algorithms, which rely on heuristics that select a defined subset of genes as features for linear regression.</p>
    <p>Another advantage of this inherent feature engineering is that Scaden can be trained to be robust to input noise and bias (e.g., batch effects). Noise and bias are all prevalent in experimental data, because of different sample quality, sample processing, experimenters, and instrumentation, for example. If the network is trained on different datasets of the same tissue, however, then it learns to create hidden features that are robust to noise and bias, such as batch effects. This robustness is pivotal in real-world cell deconvolution use cases, where the bulk RNA data for deconvolution and the training data (and therefore the network and GEP) contain different noise and biases. In this study, we tested Scaden with training data from scRNA-seq datasets generated with a variety of different protocols and could not identify a specific protocol that is not suitable. While especially recent cell deconvolution algorithms include batch correction heuristics before GEP construction, Scaden optimizes its hidden features automatically when trained on data from various batches. Potential protocol-specific biases can therefore be alleviated when employing training data from multiple protocols.</p>
    <p>The robustness to noise and bias, which might be due to hidden feature generation, is especially evident in Scaden’s ability to deconvolve across data types. A network trained on in silico bulk RNA-seq data can seamlessly deconvolve microarray data of the same tissue. This is quite noteworthy, as microarray data are known to have a reduced dynamic range and several hybridization-based biases compared to RNA-seq data. In other words, Scaden can deconvolve bulk data of types that it has never been trained on, even in the face of strong data type bias. This raises the possibility that Scaden trained on scRNA-seq data might reliably deconvolve other bulk omics data as well, such as proteomic and metabolomic data. This assumption is strengthened by the fact that Scaden, trained on scRNA-seq data, attains state-of-the-art performance on the deconvolution of bulk RNA-seq data, two data types with very distinct biases (<xref rid="R16" ref-type="bibr"><italic>16</italic></xref>).</p>
    <p>As highlighted in the introduction, a drawback for many DNNs is the large amount of training data required to obtain robust performance. Here, we used scRNA-seq data to create in silico bulk RNA-seq data of predefined type (target tissue) with known composition, across datasets. This immediately highlights Scaden’s biggest limitation, the dependency on scRNA-seq data of the target tissue. In this study, we have shown that Scaden, trained solely on simulated data from scRNA-seq datasets, can outperform GEP-based deconvolution algorithms. We did observe, however, that the addition of labeled RNA-seq samples to the training data did substantially improve deconvolution performance in the case of PBMC data. We therefore believe that efforts to increase the similarity between simulated training data and the target bulk RNA-seq data could increase Scaden’s performance further. Mixtures of in silico bulk RNA-seq data and publically available RNA-seq data, of purified cell types, for example, could further increase the deconvolution performance of Scaden. Furthermore, domain adaptation methods can be used to improve performance of models that are trained on data (here, scRNA-seq data) that are similar to the target data (here, RNA-seq data) (<xref rid="R28" ref-type="bibr"><italic>28</italic></xref>). In future versions, Scaden’s simple multilayer perceptron architecture could leverage domain adaptation to further stabilize and improve its cell deconvolution performance.</p>
    <p>Scaden uses an ensemble approach by averaging the predictions of three different models to increase performance and improve generalization. Increasing the number of models per ensemble would allow for the estimation of the prediction uncertainty. While not implemented in this study, this could be an interesting extension to Scaden’s ensemble architecture.</p>
    <p>Recent cell deconvolution algorithms have used cell fraction estimates to infer cell type–specific gene expression from bulk RNA-seq data. It is straightforward to use Scaden’s cell fraction estimates to infer per-group (<xref rid="R3" ref-type="bibr"><italic>3</italic></xref>) and per-sample (<xref rid="R7" ref-type="bibr"><italic>7</italic></xref>) cell type–specific gene expression using simple regression or non-negative matrix factorization, respectively. We would like to add a note of caution, however, as the error of cell fraction estimates, which can be quite large, is propagated into the gene expression calculations and will affect any downstream statistical analysis.</p>
    <p>While Scaden achieves good performance on the samples and tissues used in this study, it is important to keep in mind that cell type similarity, sample heterogeneity, and complexity, as well as experimental noise and bias, can severely limit deconvolution accuracy. Furthermore, Scaden is currently not attempting to model cell size differences in its algorithm, which might be useful to consider for the interpretation of prediction results.</p>
    <p>In summary, the deconvolution performance, robustness to noise and bias, and the flexibility to learn from large numbers of in silico datasets, across data types (scRNA-seq and RNA-seq mixtures) and potentially even tissues, make us believe that DNN-based architectures will become an algorithmic mainstay of cell type deconvolution.</p>
  </sec>
  <sec sec-type="methods" disp-level="1">
    <title>METHODS</title>
    <sec disp-level="2">
      <title>Datasets and preprocessing</title>
      <sec disp-level="3">
        <title>scRNA-seq datasets</title>
        <p>The following human PBMC scRNA-seq datasets were downloaded from the 10X Genomics data download page: 6k PBMCs from a Healthy Donor, 8k PBMCs from a Healthy Donor, Frozen PBMCs (Donor A), and Frozen PBMCs (Donor C) (<xref rid="R29" ref-type="bibr"><italic>29</italic></xref>). Throughout this paper, these datasets are referred to with the handles data6k, data8k, donorA, and donorC, respectively. It was not intended to incorporate as many datasets as possible. Instead, these four datasets were chosen with the goal to dispose of a set of samples with consistent cell types and gene expression. This limited our choice to datasets that displayed clearly identifiable cell types for the majority of cells. The Ascites scRNA-seq dataset was downloaded from <ext-link ext-link-type="uri" xlink:href="https://figshare.com">https://figshare.com</ext-link> as provided by Schelker <italic>et al.</italic> (<xref rid="R18" ref-type="bibr"><italic>18</italic></xref>). Pancreas and mouse brain datasets were downloaded from the scRNA-seq dataset collection of the Hemberg laboratory (<ext-link ext-link-type="uri" xlink:href="https://hemberg-lab.github.io/scRNA.seq.datasets/">https://hemberg-lab.github.io/scRNA.seq.datasets/</ext-link>). The human brain datasets from Darmanis <italic>et al.</italic> (<xref rid="R24" ref-type="bibr"><italic>24</italic></xref>) and Lake <italic>et al.</italic> (<xref rid="R25" ref-type="bibr"><italic>25</italic></xref>) where downloaded from Gene Expression Omnibus (GEO) with accession numbers GSE67835 and GSE97930, respectively. A table listing all datasets including references to the original publications can be found in table S1.</p>
      </sec>
      <sec disp-level="3">
        <title>scRNA-seq preprocessing and analysis</title>
        <p>All datasets were processed using the Python package Scanpy (v. 1.2.2) (<xref rid="R30" ref-type="bibr"><italic>30</italic></xref>) following the Scanpy’s reimplementation of the popular Seurat’s clustering workflow. First, the corresponding cell-gene matrices were filtered for cells with less than 500 detected genes and genes expressed in less than five cells. The resulting count matrix for each dataset was filtered for outliers with high or low numbers of counts. Gene expression was normalized to library size using the Scanpy function “normalize_per_cell.” The normalized matrix of all filtered cells and genes was saved for the subsequent data generation step.</p>
        <p>The following processing and analysis steps had the sole purpose of assigning cell type labels to every cell. All cells were clustered using the louvain clustering implementation of the Scanpy package. The louvain clustering resolution was chosen for each dataset, using the lowest possible resolution value (low-resolution values lead to less clusters) for which the calculated clusters appropriately separated the cell types. The top 1000 highly variable genes were used for clustering, which were calculated using Scanpy’s “filter_genes_dispersion” function with parameters min_mean = 0.0125, max_mean = 3, and min_disp = 0.5. Principal components analysis was used for dimensionality reduction.</p>
        <p>To identify cell types, marker genes were investigated for all cell types in question. For PBMC datasets, useful marker genes were adopted from public resources such as the Seurat tutorial for 2700 PBMCs (<xref rid="R31" ref-type="bibr"><italic>31</italic></xref>). Briefly, interleukin-7 receptor (IL7R) was taken as marker for CD4 T cells, LYZ for monocytes, MS4A1 for B cells, GNLY for natural killer cells, FCER1A for dendritic cells, and CD8A and CCL5 as markers for CD8 T cells. For all other scRNA-seq datasets, marker genes and expected cell types were inferred from the original publication of the dataset. For instance, to annotate cell types of the mouse brain dataset from Zeisel <italic>et al.</italic> (<xref rid="R32" ref-type="bibr"><italic>32</italic></xref>), we used the same marker genes as Zeisel and colleagues. We did not use the same cell type labels from the original publications because a main objective was to assure that cell type labeling is consistent between all datasets of a certain tissue.</p>
        <p>Cell type annotation was performed manually across all the clusters for each dataset, such that all cells belonging to the same cluster were labeled with the same cell type. The cell type identity of each cluster was chosen by crossing the cluster’s highly differentially expressed genes with the curated cell type’s marker genes. Clusters that could not be clearly identified with a cell type were grouped into the “Unknown” category.</p>
      </sec>
      <sec disp-level="3">
        <title>Tissue datasets for benchmarking</title>
        <p>To assess the deconvolution performance on real tissue expression data, we used datasets for which the corresponding cell fractions were measured and published. The first dataset is the PBMC1 dataset, which was obtained from Zimmermann <italic>et al.</italic> (<xref rid="R21" ref-type="bibr"><italic>21</italic></xref>). The second dataset, PBMC2, was downloaded from GEO with accession code GSE107011 (<xref rid="R10" ref-type="bibr"><italic>10</italic></xref>). This dataset contains both RNA-seq profiles of immune cells (S4 cohort) and from bulk individuals (S13 cohort). As we were interested in the bulk profiles, we only used 12 samples from the S13 cohort from these data. Flow cytometry fractions were collected from the Monaco <italic>et al.</italic> publication (<xref rid="R10" ref-type="bibr"><italic>10</italic></xref>).</p>
        <p>In addition to the above mentioned two PBMC datasets, we used Ascites RNA-seq data. This dataset was provided by the authors, and cell type fractions for this dataset were taken from the supplementary materials of the publication (<xref rid="R18" ref-type="bibr"><italic>18</italic></xref>).</p>
        <p>For the evaluation on pancreas data, artificial bulk RNA-seq samples created from the scRNA-seq dataset of Xin <italic>et al.</italic> (<xref rid="R20" ref-type="bibr"><italic>20</italic></xref>) were used. This dataset was downloaded from the resources of the MuSiC publication (<xref rid="R8" ref-type="bibr"><italic>8</italic></xref>). The artificial bulk RNA-seq samples used for evaluation were then created using the “bulk_construct” function of the MuSiC tool.</p>
        <p>To assess how Scaden and the GEP algorithms deal with the presence of unknown cell types, we generated PBMC bulk RNA samples from the four scRNA-seq datasets (6000 each). The undefined amount of unknown cells that was generated by this approach was removed to be replaced by defined amounts of 5, 10, 20, and 30% of unknown cells, respectively. Cell fractions of all four samples were predicted with Scaden trained on the other three.</p>
        <p>Performance on these samples was then assessed to test robustness against unseen cell types in the bulk mixture. Scaden was trained on samples from all datasets but the test dataset, while CSx and MuSiC used data8k as a reference.</p>
        <p>The microarray dataset GSE65133 was downloaded from GEO, and cell type fractions were taken from the original CS publication (<xref rid="R6" ref-type="bibr"><italic>6</italic></xref>).</p>
        <p>Last, we wanted to get insights into neurodegenerative cell fraction changes in the brain. While it is known that neurodegenerative diseases like AD are accompanied by a gradual loss of brain neurons, stage-specific cell type shifts are still hard to come by. Here, we use the ROSMAP study cortical RNA-seq dataset along with the corresponding clinical metadata, to infer cell type composition over six clinically relevant stages of neurodegeneration (<xref rid="R22" ref-type="bibr"><italic>22</italic></xref>). Furthermore, to assess deconvolution accuracy on postmortem human brain tissue, we used 41 samples from the ROSMAP, for which cell composition information from immunohistochemistry (<xref rid="R23" ref-type="bibr"><italic>23</italic></xref>) was recently released and for which fractions for all cell types were reported. The ROSMAP RNA-seq data were downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.synapse.org/">www.synapse.org/</ext-link>. The cell composition values were provided by the authors of the study (<xref rid="R23" ref-type="bibr"><italic>23</italic></xref>).</p>
      </sec>
      <sec disp-level="3">
        <title>RNA-seq preprocessing and analysis</title>
        <p>For the RNA-seq datasets analyzed in this study, we did not apply any additional processing steps but used the obtained count or expression tables directly as downloaded for all datasets except the ROSMAP dataset. For the latter, we generated count tables from raw FastQ files using Salmon (<xref rid="R33" ref-type="bibr"><italic>33</italic></xref>) and the GRCh38 reference genome. FastQ files from the ROSMAP study were downloaded from Synapse (<ext-link ext-link-type="uri" xlink:href="http://www.synapse.org">www.synapse.org</ext-link>).</p>
      </sec>
    </sec>
    <sec disp-level="2">
      <title>Simulation of bulk RNA-seq samples from scRNA-seq data</title>
      <p>Scaden’s DNN requires large amounts of training RNA-seq samples with known cell fractions. This explains why the generation of artificial bulk RNA-seq data is one of the key elements of the Scaden workflow.</p>
      <p>To generate the training data, preprocessed scRNA-seq datasets were used (see the “Datasets and preprocessing” section), comprising the gene expression matrix and the cell type labels. Artificial RNA-seq samples were simulated by subsampling cells from individual scRNA-seq datasets; cells from different datasets were not merged into samples to preserve within-subject relationships. Datasets generated from multiple participants were split according to participant, and each subsampling was constrained to cells from one participant to capture the cross-subject heterogeneity and keep subject-specific gene dependencies.</p>
      <p>The exact subsampling procedure is described in the following. First, for every simulated sample, random fractions were created for all different cell types within each scRNA-seq dataset using the random module of the Python package NumPy. Briefly, a random number was chosen from a uniform distribution between 0 and 1 using the NumPy function “random.rand()” for each cell type, and then this number was divided by the sum of all random numbers created to ensure the constraint of all fractions adding up to 1<disp-formula><mml:math id="m1"><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mo stretchy="true">∑</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>all</mml:mtext></mml:msub></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></disp-formula>where <italic>r<sub>c</sub></italic> is the random number created for cell type <italic>c</italic> and <italic>C</italic><sub>all</sub> is the set of all cell types. Here, <italic>f<sub>c</sub></italic> is the calculated random fraction for cell type <italic>c</italic>. Then, each fraction was multiplied with the total number of cells selected for each sample, yielding the number of cells to choose for a specific cell type<disp-formula><mml:math id="m2"><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mtext>total</mml:mtext></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula>where <italic>N<sub>c</sub></italic> is the number of cells to select for the cell type <italic>c</italic>, and <italic>N</italic><sub>total</sub> is the total number of cells contributing to one simulated RNA-seq sample (500, in this study). Next, <italic>N<sub>c</sub></italic> cells were randomly sampled from the scRNA-seq gene expression matrix for each cell type <italic>c</italic>. Afterward, the randomly selected single-cell expression profiles for every cell type are then aggregated by summing their expression values, to yield the artificial bulk expression profile for this sample.</p>
      <p>Using the above-described approach, cell compositions that are strongly biased toward a certain cell type or are missing specific cell types are rare among the generated training samples. To account for this and to simulate cell compositions with a heavy bias to and the absence of certain cell types, a variation of the subsampling procedure was used to generate samples with sparse compositions, which we refer to as sparse samples. Before generating the random fractions for all cell types, a random number of cell types was selected to be absent from the sample, with the requirement of at least one cell type constituting the sample. After these leave-out cell types were chosen, random fractions were created and samples generated as described above. The average cell type proportions of the training dataset generated as described above are equal for all cell types. This allows for unbiased deconvolution as the true cell composition of a given tissue is not known beforehand. Using different sampling distributions (e.g., Gaussian and Uniform) or excluding sparse samples did not change Scaden’s deconvolution performance notably on the simulated PBMC datasets. This shows that Scaden is relatively robust to training data generated by different sampling procedures.</p>
      <p>Using this procedure, we generated 32,000 samples for the human PBMC training dataset, 14,000 samples for the human pancreas training dataset, 6000 samples for human brain, and 30,000 samples for the mouse brain training dataset (table S3).</p>
      <p>Artificial bulk RNA-seq datasets were stored in “h5ad” format using the Anndata package (<xref rid="R30" ref-type="bibr"><italic>30</italic></xref>), which allows to store the samples together with their corresponding cell type ratios while also keeping information about the scRNA-seq dataset of origin for each sample. This allowed to access samples from specific datasets, which is useful for cross-validation.</p>
    </sec>
    <sec disp-level="2">
      <title>Scaden overview</title>
      <p>The following section contains an overview of the input data preprocessing, the Scaden model, model selection, and how Scaden predictions are generated.</p>
      <sec disp-level="3">
        <title>Input data preprocessing</title>
        <p>The data preprocessing step is aimed to make the input data more suitable for machine learning algorithms. To achieve this, an optimal preprocessing procedure should transform any input data from the simulated samples or from the bulk RNA-seq to the same feature scale. Before any scaling procedure can be applied, it must be ensured that both the training data and the bulk RNA-seq data subject to prediction share the same features. Therefore, before scaling, both datasets are limited to contain features (genes) that are available in both datasets. In addition, uninformative genes that have either zero expression or an expression variance below 0.1 were removed, leaving ~10,000 genes for model training and inference. The two-step processing procedure used for Scaden is described in the following:</p>
        <p>First, to account for heteroscedasticity, a feature inherent to RNA-seq data, the data were transformed into logarithmic space by adding a pseudocount of 1 and then taking the Logarithm (base 2).</p>
        <p>Second, every sample was scaled to the range [0,1] using the MinMaxScaler() class from the Sklearn preprocessing module. Per-sample scaling, unlike per-feature scaling that is more common in machine learning, assures that intergene relative expression patterns in every sample are preserved. This is important, as our hypothesis was that a neural network could learn the deconvolution from these intergene expression patterns<disp-formula><mml:math id="m3"><mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mtext>scaled</mml:mtext><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mtext>min</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext>max</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mtext>min</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where <italic>x</italic><sub>scaled, <italic>i</italic></sub> is the log<sub>2</sub> expression value of gene <italic>x</italic> in sample <italic>i</italic>, <italic>X<sub>i</sub></italic> is the vector of log<sub>2</sub> expression values for all genes of sample <italic>i</italic>, min(<bold><italic>X</italic></bold><italic><sub>i</sub></italic>) is the minimum gene expression of vector <italic>X<sub>i</sub></italic>, and max(<italic>X<sub>i</sub></italic>) is the maximum gene expression of vector <italic>X<sub>i</sub></italic>.</p>
        <p>Note that all training datasets are stored as expression values and are only processed as described above. In the deployment use case, the simulated training data should contain the same features as in the bulk RNA-seq sample that shall be deconvolved.</p>
      </sec>
      <sec disp-level="3">
        <title>Model selection</title>
        <p>The goal of model selection was to find an architecture and hyperparameters that robustly deconvolve simulated tissue RNA-seq data and, more importantly, real bulk RNA-seq data. Because of the very limited availability of bulk RNA-seq datasets with known cell fractions, model selection was mainly optimized on the simulated PBMC datasets. To capture interexperimental variation, we used leave-one-dataset-out cross-validation for model optimization: A model was trained on simulated data from all but one dataset, and performance was tested on simulated samples from the left-out dataset. This allows to simulate batch effects between datasets and helps to test the generalizability of the model. In the process of model selection and (hyper-) parameter optimization, performed on PBMC and Ascites datasets, we found three models with different architectures and dropout rates but comparable performance. To address overfitting in individual models, we decided to use a combination of models, expecting this to serve as another means of regularization. We did not test multiple combinations but rather used an informed choice with varying layer sizes and dropout regularization, with the goal to increase model diversity. We observed that the average of an ensemble of models generalized better to the test sets than individual models. Model training and prediction is done separately for each model, with the prediction averaging step combining all model predictions (fig. S1 and tables S4 and S6). We provide a list of all tested parameters in the Supplementary Materials (table S5).</p>
      </sec>
      <sec disp-level="3">
        <title>Final Scaden model</title>
        <p>The Scaden model learns cell type deconvolution through supervised training on datasets of simulated bulk RNA-seq samples simulated with scRNA-seq data. To account for model biases and to improve performance, Scaden consists of an ensemble of three DNNs with varying architectures and degrees of dropout regularization. All models of the ensemble use four layers of varying sizes between 32 and 1024 nodes, with dropout regularization implemented in two of the three ensemble models. The exact layer sizes and dropout rates are listed in table S4. The rectified linear unit is used as activation function in every internal layer. We used a Softmax function to predict cell fractions, as we did not see any improvements in using a linear output function with consecutive non-negativity correction and sum-to-one scaling. Python (v. 3.6.6) and the TensorFlow library (v. 1.10.0) were used for implementation of Scaden. A complete list of all software used for the implementation of Scaden is provided in table S15.</p>
      </sec>
      <sec disp-level="3">
        <title>Training and prediction</title>
        <p>After the preprocessing of the data, a Scaden ensemble can be trained on simulated tissue RNA-seq data or mixtures of simulated and real tissue RNA-seq data. Parameters are optimized using Adam with a learning rate of 0.0001 and a batch size of 128. We used an L1 loss as optimization objective<disp-formula><mml:math id="m4"><mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>∣</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>∣</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where <italic>y<sub>i</sub></italic> is the vector of ground-truth fractions of sample <italic>i</italic> and <inline-formula><mml:math id="m5"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> is the vector of predicted fractions of sample <italic>i</italic>. Each of the three ensemble models is trained independently for 5000 steps. This “early stopping” serves to avoid domain overfitting on the simulated tissue data, which would decrease the model performance on the real tissue RNA-seq data. We observed that training for more steps lead to an average performance decrease on real tissue RNA-seq data. To perform deconvolution with Scaden, a bulk RNA-seq sample is fed into a trained Scaden ensemble, and three independent predictions for the cell type fractions of this sample are generated by the trained DNNs. These three predictions are then averaged per cell type to yield the final cell type composition for the input bulk RNA-seq sample<disp-formula><mml:math id="m6"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:msubsup><mml:mi>y</mml:mi><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mover accent="true"><mml:msubsup><mml:mi>y</mml:mi><mml:mi>c</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="m7"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> is the final predicted fraction for cell type <italic>c</italic> and <inline-formula><mml:math id="m8"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:msubsup><mml:mi>y</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> is the predicted fraction for cell type <italic>c</italic> of model <italic>i</italic>.</p>
      </sec>
      <sec disp-level="3">
        <title>Scaden requirements</title>
        <p>Currently, a disadvantage of the Scaden algorithm is the necessity to train a new model for deconvolution if no perfect overlap in the feature space exists. This constraint limits the usefulness of pretrained models. Once trained, however, the prediction runtime scales linearly with sample numbers and is usually in the order of seconds, making Scaden a useful tool if deconvolution is to be performed on very large datasets. While the requirements are dataset dependent, the Scaden demo was profiled to require a peak of 3.2 GB of random-access memory (RAM) during the DNN training process, so a computer with 8 GB of RAM should be able to run it smoothly. In our tests with an Intel(R) Xeon(R) CPU E5-1630 workstation, the demo could run in 22 min, spending most of the CPU time in the DNN training process. The most prominent and obvious issue of Scaden is the difference between simulated scRNA-seq data used for training and the bulk RNA-seq data subject to inference. While Scaden is able to transfer the learned deconvolution between the two data types and achieves state-of-the-art performance, we hypothesize that efforts to improve this translatability could improve Scaden’s prediction accuracy even further. Algorithmic improvements are therefore likely to address this issue and are planned for future releases.</p>
      </sec>
    </sec>
    <sec disp-level="2">
      <title>Algorithm comparison</title>
      <p>We used several performance measures to compare Scaden to four existing cell deconvolution algorithms, CS with LM22 GEP, CSx, MuSiC, and CPM. To compare the performance of the five deconvolution algorithms, we measured the RMSE, Lin’s CCC, Pearson product moment correlation coefficient <italic>r</italic>, and <italic>R</italic><sup>2</sup> values, comparing real and predicted cell fractions estimates. In addition, to identify systematic prediction errors and biases, slope and intercept for the regression lines were calculated. These metrics are defined as follows<disp-formula><mml:math id="m9"><mml:mrow><mml:mrow><mml:mtext>RMSE</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mtext>avg</mml:mtext><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="m10"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>cov</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="normal">σ</mml:mi><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="m11"><mml:mrow><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="m12"><mml:mrow><mml:mrow><mml:mtext>slope</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi mathvariant="italic">Δy</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="m13"><mml:mrow><mml:mrow><mml:mtext>CCC</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>r</mml:mi><mml:msub><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="normal">σ</mml:mi><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:msub><mml:mi mathvariant="normal">σ</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:msub><mml:mi mathvariant="normal">σ</mml:mi><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:msub><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="normal">μ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="normal">μ</mml:mi><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></disp-formula>where <italic>y</italic> are the ground-truth fractions, <inline-formula><mml:math id="m14"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> are the prediction fractions, σ<italic><sub>x</sub></italic> is the SD of <italic>x</italic>, <inline-formula><mml:math id="m15"><mml:mrow><mml:mrow><mml:mtext>cov</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the covariance of <italic>y</italic> and <inline-formula><mml:math id="m16"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="m17"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">μ</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">μ</mml:mi><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are the mean of the predicted and ground-truth fractions, respectively.</p>
      <p>All metrics were calculated for all data points of a dataset and separately for all data points of a specific cell type. For the latter approach, we then averaged the resulting values to recover single values. While the metrics calculated on all data points might be sufficient, we deem that the cell type–specific deconvolution might, in many instances, be of even greater interest. It is noteworthy in this context that cell type–specific deconvolution performance can be quite weak, depending on the dataset. This is true for all tested deconvolution algorithms, while Scaden achieves best performance.</p>
      <sec disp-level="3">
        <title>CIBERSORT</title>
        <p>CS is a cell convolution algorithm based on specialized GEPs and support vector regression. Cell composition estimations were obtained using the CS web application (<ext-link ext-link-type="uri" xlink:href="https://cibersort.stanford.edu/">https://cibersort.stanford.edu/</ext-link>). For all deconvolutions with CS, we used the LM22 GEP, which was generated by the CS authors from 22 leukocyte subsets profiled on the HGU133A microarray platform.</p>
        <p>Because the LM22 GEP matrix contains cell types at a finer granularity than what was used for this study, predicted fractions of subcell types were added together. For cell grouping, we used the mapping of subcell types to broader types given by figure 6 from Monaco <italic>et al.</italic> (<xref rid="R10" ref-type="bibr"><italic>10</italic></xref>). We provide a table with the exact mappings used here in the Supplementary Materials (table S13). The deconvolution was performed using 500 permutations with quantile normalization disabled for all datasets but GSE65133 (Microarray), as is recommended for RNA-seq data. We used default settings for all other CS parameters.</p>
      </sec>
      <sec disp-level="3">
        <title>CIBERSORTx</title>
        <p>CSx is a recent variant of CS that can generate GEP matrices from scRNA-seq data and use these for deconvolution. For additional deconvolution robustness, it applies batch normalization to the data. All signature matrices were created by uploading the labeled scRNA-seq expression matrices and using the default options. Quantile normalization was disabled. For deconvolution on simulated data, no batch normalization was used. For all bulk RNA-seq datasets, the S-Mode batch normalization was chosen. All PBMC datasets were deconvolved using a GEP matrix generated from the data6k dataset (for simulated samples from data6k, a donorA GEP matrix was chosen).</p>
      </sec>
      <sec disp-level="3">
        <title>MuSiC</title>
        <p>MuSiC is a deconvolution algorithm that uses multisubject scRNA-seq datasets as GEP matrices in an attempt to include heterogeneity in the matrices to improve generalization. While MuSiC tries to address similar issues of previous deconvolution algorithms by using scRNA-seq data, the approach is very different. For deconvolution, MuSiC applies a sophisticated GEP-based deconvolution algorithm that uses weighted non-negative least-squares regression with an iterative estimation procedure that imposes more weight on informative genes and less weight on noninformative genes.</p>
        <p>The MuSiC R package contains functionality to generate the necessary GEP matrix given an scRNA-seq dataset and cell type labels. To generate MuSiC deconvolution predictions on PBMC datasets, we used the data8k scRNA-seq dataset as reference data for MuSiC and follow the tutorial provided by the authors to perform the deconvolution. For deconvolution of artificial samples generated from the data8k dataset, we provided MuSiC with the data6k dataset as a reference instead.</p>
        <p>MuSiC was developed with a focus on multisubject scRNA-seq datasets, in which the algorithm tries to take advantage from the added heterogeneity that these datasets contain, by calculating a measure of cross-subject consistency for marker genes. To assess how Scaden performs on multisubject datasets compared to MuSiC, we evaluated both methods on artificial bulk RNA-seq samples from human pancreas. We used the bulk_construct function from MuSiC to combine the cells from all 18 participants contained in the scRNA-seq dataset from Xin <italic>et al.</italic> (<xref rid="R20" ref-type="bibr"><italic>20</italic></xref>) to generate artificial bulk samples for evaluation. Next, as a multisubject reference dataset, we used the pancreas scRNA-seq dataset from Segerstolpe <italic>et al.</italic> (<xref rid="R19" ref-type="bibr"><italic>19</italic></xref>), which contains single-cell expression data from 10 different participants, 4 of which with type 2 diabetes. For Scaden, the Segerstolpe scRNA-seq dataset was split by participants, and training datasets were generated for each participant, yielding in total 10,000 samples. For MuSiC, a processed version of this dataset was downloaded from the resources provided by the MuSiC authors (<xref rid="R8" ref-type="bibr"><italic>8</italic></xref>) and used as an input reference dataset for the MuSiC deconvolution. Deconvolution was then performed according to the MuSiC tutorial, and performance was compared according to the above-defined metrics.</p>
      </sec>
      <sec disp-level="3">
        <title>Cell Population Mapping</title>
        <p>CPM is a deconvolution algorithm that uses single-cell expression profiles to identify a so-called “cell population map” from bulk RNA-seq data (<xref rid="R9" ref-type="bibr"><italic>9</italic></xref>). In CPM, the cell population map is defined as composition of cells over a cell-state space, where a cell state is defined as a current phenotype of a single cell. Contrary to other deconvolution methods, CPM tries to estimate the abundance of all cell states and types for a given bulk mixture, instead of only deconvolving the cell types. As input, CPM requires an scRNA-seq dataset and a low-dimensional embedding of all cells in this dataset, which represents the cell-state map. As CPM estimates abundances of both cell states and types, it can be used for cell type deconvolution by summing up all estimated fractions for all cell states of a given cell type, a method that is implemented in the scBio R package, which contains the CPM method. To perform deconvolution with CPM, we used the data6k PBMC scRNA-seq dataset as an input reference for all PBMC samples. For samples simulated from the data6k dataset, we used the data8k dataset as a reference. According to the CPM paper, a dimension reduction method can be used to obtain the cell-state space. We therefore used Uniform Manifold Approximation and Projection (UMAP), a dimension reduction method widely used for scRNA-seq data, to generate the cell-state space mapping for the input scRNA-seq data. Deconvolution was then performed using the CPM function of the scBio package with an scRNA-seq dataset and accompanying UMAP embedding as input.</p>
      </sec>
    </sec>
    <sec disp-level="2">
      <title>Code and software availability</title>
      <p>The source code for Scaden is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/KevinMenden/scaden">https://github.com/KevinMenden/scaden</ext-link>. Documentation is published at <ext-link ext-link-type="uri" xlink:href="https://scaden.readthedocs.io">https://scaden.readthedocs.io</ext-link>. Code to generate the figures along with the training datasets used in this study is published at figshare: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/projects/Scaden/62834">https://figshare.com/projects/Scaden/62834</ext-link>. The Scaden web application can be accessed at <ext-link ext-link-type="uri" xlink:href="https://scaden.ims.bio">https://scaden.ims.bio</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>aba2619_SM.pdf</title>
      </caption>
      <media mimetype="application" mime-subtype="pdf" xlink:href="aba2619_SM.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>We would like to thank the people of the Genome Biology of Neurodegenerative Diseases group and Institute of Medical Systems Biology for helpful discussions and suggestions. <bold>Funding:</bold> This study was supported, in part, by RiMod-FTD, an EU Joint Programme–Neurodegenerative Disease Research (JPND), and the NOMIS Foundation to K.M., A.D., and P.H. and BMBF Integrative Data Semantics for Neurodegenerative research (IDSN), ERA-Net E-Rare MAXOMOD, CRC 1286/Z2, CRU 296 P8, and CRU 306 P-C to M.M., S.O., D.S.M., K.K., and S.B. <bold>Author contributions:</bold> K.M. and S.B. initiated the project. K.M., P.H., and S.B. designed the study, deep learning models, and analysis. K.M., M.M., and S.O. built the deep learning models. K.M., M.M., K.K., and A.D. analyzed the data. D.S.M. and S.O. built the Scaden web application. K.M., K.K., and S.B. wrote the manuscript. M.M., A.D., and P.H. contributed to the manuscript writing. <bold>Competing interests:</bold> The authors declare that they have no competing interests. <bold>Data and materials availability:</bold> All data needed to evaluate the conclusions in the paper are present in the paper and/or the Supplementary Materials. Additional data related to this paper may be requested from the authors. Only publicly available datasets were used during this study. The scRNA-seq PBMC datasets donorA, donorC, data6k, and data8k were all downloaded from 10X Genomics (<ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets">https://support.10xgenomics.com/single-cell-gene-expression/datasets</ext-link>), where they are listed as “Frozen PBMCs (Donor A),” “Frozen PBMCs (Donor C),” “6k PBMCs from a Healthy Donor,” and “8k PBMCs from a Healthy Donor,” respectively. The pancreas scRNA-seq dataset from Segerstolpe <italic>et al.</italic> (<xref rid="R19" ref-type="bibr"><italic>19</italic></xref>) was downloaded from ArrayExpress with accession code E-MTAB-5061. The scRNA-seq datasets from Baron <italic>et al.</italic> (<xref rid="R34" ref-type="bibr"><italic>34</italic></xref>) (pancreas), Tasic <italic>et al.</italic> (<xref rid="R35" ref-type="bibr"><italic>35</italic></xref>), Zeisel <italic>et al.</italic> (<xref rid="R32" ref-type="bibr"><italic>32</italic></xref>), Romanov <italic>et al.</italic> (<xref rid="R36" ref-type="bibr"><italic>36</italic></xref>), Campbell <italic>et al.</italic> (<xref rid="R37" ref-type="bibr"><italic>37</italic></xref>), and Chen <italic>et al.</italic> (<xref rid="R38" ref-type="bibr"><italic>38</italic></xref>) (all mouse brain) were all downloaded from <ext-link ext-link-type="uri" xlink:href="https://hemberg-lab.github.io/scRNA.seq.datasets/">https://hemberg-lab.github.io/scRNA.seq.datasets/</ext-link>. The ascites scRNA-seq dataset was downloaded from <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/711d3fb2bd3288c8483a">https://figshare.com/s/711d3fb2bd3288c8483a</ext-link>. The bulk RNA-seq dataset PBMC1 is accessible from ImmPort with accession code SDY67. The PBMC2 dataset was downloaded from GEO with accession code GSE107011. The ROSMAP human brain RNA-seq dataset was downloaded from Synapse (ID: syn3219045). The bulk RNA-seq data from ascites was provided by Schelker <italic>et al.</italic> (<xref rid="R18" ref-type="bibr"><italic>18</italic></xref>). The pancreas scRNA-seq dataset from Xin <italic>et al.</italic> (<xref rid="R20" ref-type="bibr"><italic>20</italic></xref>) was accessed from the MuSiC tutorial site (<ext-link ext-link-type="uri" xlink:href="https://xuranw.github.io/MuSiC/articles/pages/data.html">https://xuranw.github.io/MuSiC/articles/pages/data.html</ext-link>).</p>
  </ack>
  <app-group>
    <app>
      <title>SUPPLEMENTARY MATERIALS</title>
      <supplementary-material content-type="local-data">
        <p>Supplementary material for this article is available at <ext-link ext-link-type="uri" xlink:href="http://advances.sciencemag.org/cgi/content/full/6/30/eaba2619/DC1">http://advances.sciencemag.org/cgi/content/full/6/30/eaba2619/DC1</ext-link></p>
      </supplementary-material>
    </app>
    <app>
      <p><ext-link ext-link-type="uri" xlink:href="https://en.bio-protocol.org/cjrap.aspx?eid=10.1126/sciadv.aba2619">View/request a protocol for this paper from <italic>Bio-protocol</italic></ext-link>.</p>
    </app>
  </app-group>
  <ref-list>
    <title>REFERENCES AND NOTES</title>
    <ref id="R1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hrdlickova</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Toloue</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Tian</surname><given-names>B.</given-names></name></person-group>, 
<article-title>RNA-Seq methods for transcriptome analysis</article-title>. <source>Wiley Interdiscip. Rev. RNA</source><volume>8</volume>, 
<fpage>e1364</fpage> (<year>2017</year>).</mixed-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Egeblad</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Nakasone</surname><given-names>E. S.</given-names></name>, <name name-style="western"><surname>Werb</surname><given-names>Z.</given-names></name></person-group>, 
<article-title>Tumors as organs: Complex tissues that interface with the entire organism</article-title>. <source>Dev. Cell</source><volume>18</volume>, 
<fpage>884</fpage>–<lpage>901</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20627072</pub-id></mixed-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kuhn</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Thu</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Waldvogel</surname><given-names>H. J.</given-names></name>, <name name-style="western"><surname>Faull</surname><given-names>R. L. M.</given-names></name>, <name name-style="western"><surname>Luthi-Carter</surname><given-names>R.</given-names></name></person-group>, 
<article-title>Population-specific expression analysis (PSEA) reveals molecular changes in diseased brain</article-title>. <source>Nat. Methods</source><volume>8</volume>, 
<fpage>945</fpage>–<lpage>947</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21983921</pub-id></mixed-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Avila Cobos</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Vandesompele</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Mestdagh</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>De Preter</surname><given-names>K.</given-names></name></person-group>, 
<article-title>Computational deconvolution of transcriptomics data from mixed cell populations</article-title>. <source>Bioinformatics</source><volume>34</volume>, 
<fpage>1969</fpage>–<lpage>1979</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">29351586</pub-id></mixed-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mohammadi</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Zuckerman</surname><given-names>N.</given-names></name>, <name name-style="western"><surname>Goldsmith</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Grama</surname><given-names>A.</given-names></name></person-group>, 
<article-title>A critical survey of deconvolution methods for separating cell types in complex tissues</article-title>. <source>Proc. IEEE</source><volume>105</volume>, 
<fpage>340</fpage>–<lpage>366</lpage> (<year>2017</year>).</mixed-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Newman</surname><given-names>A. M.</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>C. L.</given-names></name>, <name name-style="western"><surname>Green</surname><given-names>M. R.</given-names></name>, <name name-style="western"><surname>Gentles</surname><given-names>A. J.</given-names></name>, <name name-style="western"><surname>Feng</surname><given-names>W.</given-names></name>, <name name-style="western"><surname>Xu</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Hoang</surname><given-names>C. D.</given-names></name>, <name name-style="western"><surname>Diehn</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Alizadeh</surname><given-names>A. A.</given-names></name></person-group>, 
<article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>. <source>Nat. Methods</source><volume>12</volume>, 
<fpage>453</fpage>–<lpage>457</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25822800</pub-id></mixed-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Newman</surname><given-names>A. M.</given-names></name>, <name name-style="western"><surname>Steen</surname><given-names>C. B.</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>C. L.</given-names></name>, <name name-style="western"><surname>Gentles</surname><given-names>A. J.</given-names></name>, <name name-style="western"><surname>Chaudhuri</surname><given-names>A. A.</given-names></name>, <name name-style="western"><surname>Scherer</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Khodadoust</surname><given-names>M. S.</given-names></name>, <name name-style="western"><surname>Esfahani</surname><given-names>M. S.</given-names></name>, <name name-style="western"><surname>Luca</surname><given-names>B. A.</given-names></name>, <name name-style="western"><surname>Steiner</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Diehn</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Alizadeh</surname><given-names>A. A.</given-names></name></person-group>, 
<article-title>Determining cell type abundance and expression from bulk tissues with digital cytometry</article-title>. <source>Nat. Biotechnol.</source><volume>37</volume>, 
<fpage>773</fpage>–<lpage>782</lpage> (<year>2019</year>).<pub-id pub-id-type="pmid">31061481</pub-id></mixed-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>X.</given-names></name>, <name name-style="western"><surname>Park</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Susztak</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>N. R.</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>M.</given-names></name></person-group>, 
<article-title>Bulk tissue cell type deconvolution with multi-subject single-cell expression reference</article-title>. <source>Nat. Commun.</source><volume>10</volume>, 
<fpage>380</fpage> (<year>2019</year>).<pub-id pub-id-type="pmid">30670690</pub-id></mixed-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Frishberg</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Peshes-Yaloz</surname><given-names>N.</given-names></name>, <name name-style="western"><surname>Cohn</surname><given-names>O.</given-names></name>, <name name-style="western"><surname>Rosentul</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Steuerman</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Valadarsky</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Yankovitz</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Mandelboim</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Iraqi</surname><given-names>F. A.</given-names></name>, <name name-style="western"><surname>Amit</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Mayo</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Bacharach</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Gat-Viks</surname><given-names>I.</given-names></name></person-group>, 
<article-title>Cell composition analysis of bulk genomics using single-cell data</article-title>. <source>Nat. Methods</source><volume>16</volume>, 
<fpage>327</fpage>–<lpage>332</lpage> (<year>2019</year>).<pub-id pub-id-type="pmid">30886410</pub-id></mixed-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Monaco</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Xu</surname><given-names>W.</given-names></name>, <name name-style="western"><surname>Mustafah</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Hwang</surname><given-names>Y. Y.</given-names></name>, <name name-style="western"><surname>Carré</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Burdin</surname><given-names>N.</given-names></name>, <name name-style="western"><surname>Visan</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Ceccarelli</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Poidinger</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Zippelius</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Pedro de Magalhães</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Larbi</surname><given-names>A.</given-names></name></person-group>, 
<article-title>RNA-Seq signatures normalized by mRNA abundance allow absolute deconvolution of human immune cell types</article-title>. <source>Cell Rep.</source><volume>26</volume>, 
<fpage>1627</fpage>–<lpage>1640.e7</lpage> (<year>2019</year>).<pub-id pub-id-type="pmid">30726743</pub-id></mixed-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vallania</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Tam</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Lofgren</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Schaffert</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Azad</surname><given-names>T. D.</given-names></name>, <name name-style="western"><surname>Bongen</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Haynes</surname><given-names>W.</given-names></name>, <name name-style="western"><surname>Alsup</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Alonso</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Davis</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Engleman</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Khatri</surname><given-names>P.</given-names></name></person-group>, 
<article-title>Leveraging heterogeneity across multiple datasets increases cell-mixture deconvolution accuracy and reduces biological and technical biases</article-title>. <source>Nat. Commun.</source><volume>9</volume>, 
<fpage>4735</fpage> (<year>2018</year>).<pub-id pub-id-type="pmid">30413720</pub-id></mixed-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Venet</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Pecasse</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Maenhaut</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Bersini</surname><given-names>H.</given-names></name></person-group>, 
<article-title>Separation of samples into their constituents using gene expression data</article-title>. <source>Bioinformatics</source><volume>17</volume>, 
<fpage>S279</fpage>–<lpage>S287</lpage> (<year>2001</year>).<pub-id pub-id-type="pmid">11473019</pub-id></mixed-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shapiro</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Biezuner</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Linnarsson</surname><given-names>S.</given-names></name></person-group>, 
<article-title>Single-cell sequencing-based technologies will revolutionize whole-organism science</article-title>. <source>Nat. Rev. Genet.</source><volume>14</volume>, 
<fpage>618</fpage>–<lpage>630</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23897237</pub-id></mixed-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>Tabula Muris Consortium</collab></person-group>, 
<article-title>Single-cell transcriptomics of 20 mouse organs creates a <italic>Tabula Muris</italic></article-title>. <source>Nature</source><volume>562</volume>, 
<fpage>367</fpage>–<lpage>372</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">30283141</pub-id></mixed-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kelley</surname><given-names>K. W.</given-names></name>, <name name-style="western"><surname>Nakao-Inoue</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Molofsky</surname><given-names>A. V.</given-names></name>, <name name-style="western"><surname>Oldham</surname><given-names>M. C.</given-names></name></person-group>, 
<article-title>Variation among intact tissue samples reveals the core transcriptional features of human CNS cell classes</article-title>. <source>Nat. Neurosci.</source><volume>21</volume>, 
<fpage>1171</fpage>–<lpage>1184</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">30154505</pub-id></mixed-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hicks</surname><given-names>S. C.</given-names></name>, <name name-style="western"><surname>Townes</surname><given-names>F. W.</given-names></name>, <name name-style="western"><surname>Teng</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Irizarry</surname><given-names>R. A.</given-names></name></person-group>, 
<article-title>Missing data and technical variability in single-cell RNA-sequencing experiments</article-title>. <source>Biostatistics</source><volume>19</volume>, 
<fpage>562</fpage>–<lpage>578</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">29121214</pub-id></mixed-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lin</surname><given-names>L. I.</given-names></name></person-group>, 
<article-title>A concordance correlation coefficient to evaluate reproducibility</article-title>. <source>Biometrics</source><volume>45</volume>, 
<fpage>255</fpage>–<lpage>268</lpage> (<year>1989</year>).<pub-id pub-id-type="pmid">2720055</pub-id></mixed-citation>
    </ref>
    <ref id="R18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schelker</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Feau</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Du</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Ranu</surname><given-names>N.</given-names></name>, <name name-style="western"><surname>Klipp</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>MacBeath</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Schoeberl</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Raue</surname><given-names>A.</given-names></name></person-group>, 
<article-title>Estimation of immune cell content in tumour tissue using single-cell RNA-seq data</article-title>. <source>Nat. Commun.</source><volume>8</volume>, 
<fpage>2032</fpage> (<year>2017</year>).<pub-id pub-id-type="pmid">29230012</pub-id></mixed-citation>
    </ref>
    <ref id="R19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Segerstolpe</surname><given-names>Å.</given-names></name>, <name name-style="western"><surname>Palasantza</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Eliasson</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Andersson</surname><given-names>E. M.</given-names></name>, <name name-style="western"><surname>Andréasson</surname><given-names>A. C.</given-names></name>, <name name-style="western"><surname>Sun</surname><given-names>X.</given-names></name>, <name name-style="western"><surname>Picelli</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Sabirsh</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Clausen</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Bjursell</surname><given-names>M. K.</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>D. M.</given-names></name>, <name name-style="western"><surname>Kasper</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Ämmälä</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Sandberg</surname><given-names>R.</given-names></name></person-group>, 
<article-title>Single-cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title>. <source>Cell Metab.</source><volume>24</volume>, 
<fpage>593</fpage>–<lpage>607</lpage> (<year>2016</year>).<pub-id pub-id-type="pmid">27667667</pub-id></mixed-citation>
    </ref>
    <ref id="R20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Xin</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Kim</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Okamoto</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Ni</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Wei</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Adler</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Murphy</surname><given-names>A. J.</given-names></name>, <name name-style="western"><surname>Yancopoulos</surname><given-names>G. D.</given-names></name>, <name name-style="western"><surname>Lin</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Gromada</surname><given-names>J.</given-names></name></person-group>, 
<article-title>RNA sequencing of single human islet cells reveals type 2 diabetes genes</article-title>. <source>Cell Metab.</source><volume>24</volume>, 
<fpage>608</fpage>–<lpage>615</lpage> (<year>2016</year>).<pub-id pub-id-type="pmid">27667665</pub-id></mixed-citation>
    </ref>
    <ref id="R21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zimmermann</surname><given-names>M. T.</given-names></name>, <name name-style="western"><surname>Oberg</surname><given-names>A. L.</given-names></name>, <name name-style="western"><surname>Grill</surname><given-names>D. E.</given-names></name>, <name name-style="western"><surname>Ovsyannikova</surname><given-names>I. G.</given-names></name>, <name name-style="western"><surname>Haralambieva</surname><given-names>I. H.</given-names></name>, <name name-style="western"><surname>Kennedy</surname><given-names>R. B.</given-names></name>, <name name-style="western"><surname>Poland</surname><given-names>G. A.</given-names></name></person-group>, 
<article-title>System-wide associations between DNA-methylation, gene expression, and humoral immune response to influenza vaccination</article-title>. <source>PLOS ONE</source><volume>11</volume>, 
<fpage>e0152034</fpage> (<year>2016</year>).<pub-id pub-id-type="pmid">27031986</pub-id></mixed-citation>
    </ref>
    <ref id="R22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bennett</surname><given-names>D. A.</given-names></name>, <name name-style="western"><surname>Buchman</surname><given-names>A. S.</given-names></name>, <name name-style="western"><surname>Boyle</surname><given-names>P. A.</given-names></name>, <name name-style="western"><surname>Barnes</surname><given-names>L. L.</given-names></name>, <name name-style="western"><surname>Wilson</surname><given-names>R. S.</given-names></name>, <name name-style="western"><surname>Schneider</surname><given-names>J. A.</given-names></name></person-group>, 
<article-title>Religious orders study and rush memory and aging project</article-title>. <source>J. Alzheimers Dis.</source><volume>64</volume>, 
<fpage>S161</fpage>–<lpage>S189</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">29865057</pub-id></mixed-citation>
    </ref>
    <ref id="R23">
      <label>23</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Patrick</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Taga</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Ergun</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Ng</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Casazza</surname><given-names>W.</given-names></name>, <name name-style="western"><surname>Cimpean</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Yung</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Schneider</surname><given-names>J. A.</given-names></name>, <name name-style="western"><surname>Bennett</surname><given-names>D. A.</given-names></name>, <name name-style="western"><surname>Gaiteri</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>De Jager</surname><given-names>P. L.</given-names></name>, <name name-style="western"><surname>Bradshaw</surname><given-names>E. M.</given-names></name>, <name name-style="western"><surname>Mostafavi</surname><given-names>S.</given-names></name></person-group>, 
<article-title>Deconvolving the contributions of cell-type heterogeneity on cortical gene expression</article-title>. <source>bioRxiv</source><volume>2019</volume>, 
<fpage>566307</fpage> (<year>2019</year>).</mixed-citation>
    </ref>
    <ref id="R24">
      <label>24</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Darmanis</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Sloan</surname><given-names>S. A.</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Enge</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Caneda</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Shuer</surname><given-names>L. M.</given-names></name>, <name name-style="western"><surname>Gephart</surname><given-names>M. G. H.</given-names></name>, <name name-style="western"><surname>Barres</surname><given-names>B. A.</given-names></name>, <name name-style="western"><surname>Quake</surname><given-names>S. R.</given-names></name></person-group>, 
<article-title>A survey of human brain transcriptome diversity at the single cell level</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source><volume>112</volume>, 
<fpage>7285</fpage>–<lpage>7290</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">26060301</pub-id></mixed-citation>
    </ref>
    <ref id="R25">
      <label>25</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lake</surname><given-names>B. B.</given-names></name>, <name name-style="western"><surname>Ai</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Kaeser</surname><given-names>G. E.</given-names></name>, <name name-style="western"><surname>Salathia</surname><given-names>N. S.</given-names></name>, <name name-style="western"><surname>Yung</surname><given-names>Y. C.</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Wildberg</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Gao</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Fung</surname><given-names>H. L.</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Vijayaraghavan</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Wong</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Sheng</surname><given-names>X.</given-names></name>, <name name-style="western"><surname>Kaper</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Shen</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Ronaghi</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Fan</surname><given-names>J. B.</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>W.</given-names></name>, <name name-style="western"><surname>Chun</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>K.</given-names></name></person-group>, 
<article-title>Neuronal subtypes and diversity revealed by single-nucleus RNA sequencing of the human brain</article-title>. <source>Science</source><volume>352</volume>, 
<fpage>1586</fpage>–<lpage>1590</lpage> (<year>2016</year>).<pub-id pub-id-type="pmid">27339989</pub-id></mixed-citation>
    </ref>
    <ref id="R26">
      <label>26</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Braak</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Braak</surname><given-names>E.</given-names></name></person-group>, 
<article-title>Neuropathological stageing of Alzheimer-related changes</article-title>. <source>Acta Neuropathol.</source><volume>82</volume>, 
<fpage>239</fpage>–<lpage>259</lpage> (<year>1991</year>).<pub-id pub-id-type="pmid">1759558</pub-id></mixed-citation>
    </ref>
    <ref id="R27">
      <label>27</label>
      <mixed-citation publication-type="web">J. Yosinski, J. Clune, A. Nguyen, T. Fuchs, H. Lipson, Understanding Neural Networks Through Deep Visualization (2015); <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1506.06579">http://arxiv.org/abs/1506.06579</ext-link>.</mixed-citation>
    </ref>
    <ref id="R28">
      <label>28</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Athiwaratkun</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Finzi</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Izmailov</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Wilson</surname><given-names>A. G.</given-names></name></person-group>, 
<article-title>Improving consistency-based semi-supervised learning with weight averaging</article-title>. <source>Jmlr</source><volume>17</volume>, 
<fpage>1</fpage>–<lpage>35</lpage> (<year>2018</year>).</mixed-citation>
    </ref>
    <ref id="R29">
      <label>29</label>
      <mixed-citation publication-type="confproc">M. Zhang, K. T. Ma, J. H. Lim, Q. Zhao, J. Feng, Deep future gaze: Gaze anticipation on egocentric videos using adversarial networks, in <italic>2017 IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</italic>, Honolulu, HI, USA, 21 to 26 July 2017.</mixed-citation>
    </ref>
    <ref id="R30">
      <label>30</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wolf</surname><given-names>F. A.</given-names></name>, <name name-style="western"><surname>Angerer</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Theis</surname><given-names>F. J.</given-names></name></person-group>, 
<article-title>SCANPY: Large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol.</source><volume>19</volume>, 
<fpage>15</fpage> (<year>2018</year>).<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="R31">
      <label>31</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Satija</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Farrell</surname><given-names>J. A.</given-names></name>, <name name-style="western"><surname>Gennert</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Schier</surname><given-names>A. F.</given-names></name>, <name name-style="western"><surname>Regev</surname><given-names>A.</given-names></name></person-group>, 
<article-title>Spatial reconstruction of single-cell gene expression data</article-title>. <source>Nat. Biotechnol.</source><volume>33</volume>, 
<fpage>495</fpage>–<lpage>502</lpage> (<year>2015</year>).<pub-id pub-id-type="pmid">25867923</pub-id></mixed-citation>
    </ref>
    <ref id="R32">
      <label>32</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zeisel</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Hochgerner</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Lönnerberg</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Johnsson</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Memic</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>van der Zwan</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Häring</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Braun</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Borm</surname><given-names>L. E.</given-names></name>, <name name-style="western"><surname>La Manno</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Codeluppi</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Furlan</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Skene</surname><given-names>N.</given-names></name>, <name name-style="western"><surname>Harris</surname><given-names>K. D.</given-names></name>, <name name-style="western"><surname>Hjerling-Leffler</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Arenas</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Ernfors</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Marklund</surname><given-names>U.</given-names></name>, <name name-style="western"><surname>Linnarsson</surname><given-names>S.</given-names></name></person-group>, 
<article-title>Molecular architecture of the mouse nervous system</article-title>. <source>Cell</source><volume>174</volume>, 
<fpage>999</fpage>–<lpage>1014.e22</lpage> (<year>2018</year>).<pub-id pub-id-type="pmid">30096314</pub-id></mixed-citation>
    </ref>
    <ref id="R33">
      <label>33</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Love</surname><given-names>M. I.</given-names></name>, <name name-style="western"><surname>Soneson</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Patro</surname><given-names>R.</given-names></name></person-group>, 
<article-title>Swimming downstream: Statistical analysis of differential transcript usage following Salmon quantification</article-title>. <source>F1000Res.</source><volume>7</volume>, 
<fpage>952</fpage> (<year>2018</year>).<pub-id pub-id-type="pmid">30356428</pub-id></mixed-citation>
    </ref>
    <ref id="R34">
      <label>34</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Baron</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Veres</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Wolock</surname><given-names>S. L.</given-names></name>, <name name-style="western"><surname>Faust</surname><given-names>A. L.</given-names></name>, <name name-style="western"><surname>Gaujoux</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Vetere</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Ryu</surname><given-names>J. H.</given-names></name>, <name name-style="western"><surname>Wagner</surname><given-names>B. K.</given-names></name>, <name name-style="western"><surname>Shen-Orr</surname><given-names>S. S.</given-names></name>, <name name-style="western"><surname>Klein</surname><given-names>A. M.</given-names></name>, <name name-style="western"><surname>Melton</surname><given-names>D. A.</given-names></name>, <name name-style="western"><surname>Yanai</surname><given-names>I.</given-names></name></person-group>, 
<article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure</article-title>. <source>Cell Syst.</source><volume>3</volume>, 
<fpage>346</fpage>–<lpage>360.e4</lpage> (<year>2016</year>).<pub-id pub-id-type="pmid">27667365</pub-id></mixed-citation>
    </ref>
    <ref id="R35">
      <label>35</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tasic</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Menon</surname><given-names>V.</given-names></name>, <name name-style="western"><surname>Nguyen</surname><given-names>T. N.</given-names></name>, <name name-style="western"><surname>Kim</surname><given-names>T. K.</given-names></name>, <name name-style="western"><surname>Jarsky</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Yao</surname><given-names>Z.</given-names></name>, <name name-style="western"><surname>Levi</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Gray</surname><given-names>L. T.</given-names></name>, <name name-style="western"><surname>Sorensen</surname><given-names>S. A.</given-names></name>, <name name-style="western"><surname>Dolbeare</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Bertagnolli</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Goldy</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Shapovalova</surname><given-names>N.</given-names></name>, <name name-style="western"><surname>Parry</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Bernard</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Madisen</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Sunkin</surname><given-names>S. M.</given-names></name>, <name name-style="western"><surname>Hawrylycz</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Koch</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Zeng</surname><given-names>H.</given-names></name></person-group>, 
<article-title>Adult mouse cortical cell taxonomy revealed by single cell transcriptomics</article-title>. <source>Nat. Neurosci.</source><volume>19</volume>, 
<fpage>335</fpage>–<lpage>346</lpage> (<year>2016</year>).<pub-id pub-id-type="pmid">26727548</pub-id></mixed-citation>
    </ref>
    <ref id="R36">
      <label>36</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Romanov</surname><given-names>R. A.</given-names></name>, <name name-style="western"><surname>Zeisel</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Bakker</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Girach</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Hellysaz</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Tomer</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Alpár</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Mulder</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Clotman</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Keimpema</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Hsueh</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Crow</surname><given-names>A. K.</given-names></name>, <name name-style="western"><surname>Martens</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Schwindling</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Calvigioni</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Bains</surname><given-names>J. S.</given-names></name>, <name name-style="western"><surname>Máté</surname><given-names>Z.</given-names></name>, <name name-style="western"><surname>Szabó</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Yanagawa</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>M.-D.</given-names></name>, <name name-style="western"><surname>Rendeiro</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Farlik</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Uhlén</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Wulff</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Bock</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Broberger</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Deisseroth</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Hökfelt</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Linnarsson</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Horvath</surname><given-names>T. L.</given-names></name>, <name name-style="western"><surname>Harkany</surname><given-names>T.</given-names></name></person-group>, 
<article-title>Molecular interrogation of hypothalamic organization reveals distinct dopamine neuronal subtypes</article-title>. <source>Nat. Neurosci.</source><volume>20</volume>, 
<fpage>176</fpage>–<lpage>188</lpage> (<year>2017</year>).<pub-id pub-id-type="pmid">27991900</pub-id></mixed-citation>
    </ref>
    <ref id="R37">
      <label>37</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Campbell</surname><given-names>J. N.</given-names></name>, <name name-style="western"><surname>Macosko</surname><given-names>E. Z.</given-names></name>, <name name-style="western"><surname>Fenselau</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Pers</surname><given-names>T. H.</given-names></name>, <name name-style="western"><surname>Lyubetskaya</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Tenen</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Goldman</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Verstegen</surname><given-names>A. M. J.</given-names></name>, <name name-style="western"><surname>Resch</surname><given-names>J. M.</given-names></name>, <name name-style="western"><surname>McCarroll</surname><given-names>S. A.</given-names></name>, <name name-style="western"><surname>Rosen</surname><given-names>E. D.</given-names></name>, <name name-style="western"><surname>Lowell</surname><given-names>B. B.</given-names></name>, <name name-style="western"><surname>Tsai</surname><given-names>L. T.</given-names></name></person-group>, 
<article-title>A molecular census of arcuate hypothalamus and median eminence cell types</article-title>. <source>Nat. Neurosci.</source><volume>20</volume>, 
<fpage>484</fpage>–<lpage>496</lpage> (<year>2017</year>).<pub-id pub-id-type="pmid">28166221</pub-id></mixed-citation>
    </ref>
    <ref id="R38">
      <label>38</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Wu</surname><given-names>X.</given-names></name>, <name name-style="western"><surname>Jiang</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>Y.</given-names></name></person-group>, 
<article-title>Single-cell RNA-seq reveals hypothalamic cell diversity</article-title>. <source>Cell Rep.</source><volume>18</volume>, 
<fpage>3227</fpage>–<lpage>3241</lpage> (<year>2017</year>).<pub-id pub-id-type="pmid">28355573</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
