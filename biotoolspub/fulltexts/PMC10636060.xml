<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10636060</article-id>
    <article-id pub-id-type="pmid">37945552</article-id>
    <article-id pub-id-type="publisher-id">42528</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-023-42528-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>trRosettaRNA: automated prediction of RNA 3D structure with transformer network</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8603-8250</contrib-id>
        <name>
          <surname>Wang</surname>
          <given-names>Wenkai</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Feng</surname>
          <given-names>Chenjie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Han</surname>
          <given-names>Renmin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Ziyi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ye</surname>
          <given-names>Lisha</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Du</surname>
          <given-names>Zongyang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wei</surname>
          <given-names>Hong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2081-9369</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Fa</given-names>
        </name>
        <address>
          <email>zhangfa@ict.ac.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0303-6693</contrib-id>
        <name>
          <surname>Peng</surname>
          <given-names>Zhenling</given-names>
        </name>
        <address>
          <email>zhenling@email.sdu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2912-7737</contrib-id>
        <name>
          <surname>Yang</surname>
          <given-names>Jianyi</given-names>
        </name>
        <address>
          <email>yangjy@sdu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01y1kjr75</institution-id><institution-id institution-id-type="GRID">grid.216938.7</institution-id><institution-id institution-id-type="ISNI">0000 0000 9878 7032</institution-id><institution>School of Mathematical Sciences, </institution><institution>Nankai University, </institution></institution-wrap>Tianjin, 300071 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0207yh398</institution-id><institution-id institution-id-type="GRID">grid.27255.37</institution-id><institution-id institution-id-type="ISNI">0000 0004 1761 1174</institution-id><institution>MOE Frontiers Science Center for Nonlinear Expectations, Research Center for Mathematics and Interdisciplinary Sciences, </institution><institution>Shandong University, </institution></institution-wrap>Qingdao, 266237 China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02h8a1848</institution-id><institution-id institution-id-type="GRID">grid.412194.b</institution-id><institution-id institution-id-type="ISNI">0000 0004 1761 9803</institution-id><institution>School of Science, </institution><institution>Ningxia Medical University, </institution></institution-wrap>Yinchuan, 750004 China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01skt4w74</institution-id><institution-id institution-id-type="GRID">grid.43555.32</institution-id><institution-id institution-id-type="ISNI">0000 0000 8841 6246</institution-id><institution>School of Medical Technology, </institution><institution>Beijing Institute of Technology, </institution></institution-wrap>Beijing, 100081 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>9</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>7266</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">RNA 3D structure prediction is a long-standing challenge. Inspired by the recent breakthrough in protein structure prediction, we developed trRosettaRNA, an automated deep learning-based approach to RNA 3D structure prediction. The trRosettaRNA pipeline comprises two major steps: 1D and 2D geometries prediction by a transformer network; and 3D structure folding by energy minimization. Benchmark tests suggest that trRosettaRNA outperforms traditional automated methods. In the blind tests of the 15<sup>th</sup> Critical Assessment of Structure Prediction (CASP15) and the RNA-Puzzles experiments, the automated trRosettaRNA predictions for the natural RNAs are competitive with the top human predictions. trRosettaRNA also outperforms other deep learning-based methods in CASP15 when measured by the Z-score of the Root-Mean-Square Deviation. Nevertheless, it remains challenging to predict accurate structures for synthetic RNAs with an automated approach. We hope this work could be a good start toward solving the hard problem of RNA structure prediction with deep learning.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Here, authors develop trRosettaRNA, a deep learning-based approach for predicting RNA 3D structures. Blind tests demonstrate that the automated predictions compete effectively with top human predictions on natural RNAs.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Computational models</kwd>
      <kwd>Software</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Molecular modelling</kwd>
      <kwd>Molecular modelling</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Limited 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Ribonucleic acid (RNA) is one of the most important types of functional molecules in living cells. It is involved in many fundamental biological and cellular processes, for example, as the transcript of genetic information, serving catalytic, scaffolding, and structural functions. Interest in the structure and functions of non-coding RNA (ncRNA), such as transfer RNAs (tRNAs) and ribosomal RNAs (rRNAs), has been increasing over the past few decades with the discovery of new types of ncRNAs every year. Similar to proteins, ncRNA molecules’ biological function is typically determined by their 3D structures. However, due to the intrinsic structural heterogeneity caused by the flexible backbones and weak long-range tertiary interactions, it is more challenging to experimentally solve the structure of an RNA than a protein<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. For example, only ~6000 RNA structures are deposited in the Protein Data Bank (PDB)<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>, which is much less than the number of deposited protein structures (~190,000). Thus, there is a great demand for developing efficient algorithms to predict RNA 3D structures.</p>
    <p id="Par4">The current RNA 3D structure prediction methods can be divided into two groups: template-based methods and de novo methods. Template-based methods predict the target structure using homologous templates in PDB. For example, representative methods, such as ModeRNA<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> and MMB<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, work by reducing the sampling space with homologous structures. In general, the predicted structure models by template-based methods are accurate when homologous templates exist in PDB. However, the progress for template-based methods is slow, due to the limited number of known RNA structures and the difficulty of aligning RNA sequences.</p>
    <p id="Par5">On the contrary, de novo methods build 3D conformations by simulating the folding process from scratch. With molecular dynamic simulations and/or fragment assembly, methods such as FARNA<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>, FARFAR<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, FARFAR2<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, SimRNA<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, iFoldRNA<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, RNAComposer<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, and 3dRNA<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR12">12</xref></sup>, work well for certain small RNAs (&lt;100 nucleotides). Nevertheless, it is hard to generate accurate 3D structures for large RNAs with complicated topologies, due to the inaccurate force field parameters and the huge sampling space. To partly address this issue, inter-nucleotide contacts predicted by direct coupling analysis (DCA) have been used to guide the structure simulations<sup><xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR15">15</xref></sup>. In addition, given the hierarchical nature of RNA structure folding, a few methods derive 3D structures from secondary structures, such as Vfold<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup> and MC-Fold<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. They are very fast but the modeling accuracy largely depends on the quality of the input secondary structures. The RNA-Puzzles experiments indicate that it remains a grand challenge to accurately predict the structures for large RNAs with complex architectures<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>.</p>
    <p id="Par6">Deep learning has recently been used to improve de novo RNA 3D structure prediction. The predicted inter-nucleotide contacts by the residual convolutional network (ResNet) are about two times more accurate than DCA, improving 3D structure prediction to some extent<sup><xref ref-type="bibr" rid="CR21">21</xref>,<xref ref-type="bibr" rid="CR22">22</xref></sup>. It was shown that with the model selection from a geometric deep learning-based scoring system (ARES), the FARFAR2 protocol predicted the most accurate models for four targets in the blind test of the RNA-Puzzles experiments<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. Recently, inspired by the success of AlphaFold2<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>, a few new deep learning-based methods are developed, such as DeepFoldRNA<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, RoseTTAFoldNA<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, and RhoFold<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>.</p>
    <p id="Par7">In this work, we introduce trRosettaRNA, an automated deep learning-based approach to RNA 3D structure prediction. It is partly inspired by the successful application of deep learning in protein structure prediction, especially in AlphaFold2<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> and our previous method trRosetta<sup><xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref></sup>. Benchmark tests and blind tests show that trRosettaRNA is promising to enhance RNA structure prediction. The server and source codes are available at: <ext-link ext-link-type="uri" xlink:href="https://yanglab.qd.sdu.edu.cn/trRosettaRNA">https://yanglab.qd.sdu.edu.cn/trRosettaRNA</ext-link>.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview of trRosettaRNA</title>
      <p id="Par8">The architecture of trRosettaRNA is depicted in Fig. <xref rid="Fig1" ref-type="fig">1a</xref>. Starting from the nucleotide sequence of an RNA of interest, a multiple sequence alignment (MSA) and a secondary structure are first generated by the programs rMSA<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> and SPOT-RNA<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>, respectively. They are then converted into an MSA representation and a pair representation, which are fed into a transformer network (named RNAformer, see Fig. <xref rid="Fig1" ref-type="fig">1b</xref> and Methods for more details) to predict 1D and 2D geometries (see Fig. <xref rid="MOESM1" ref-type="media">S1</xref>). Similar to trRosetta, these geometries are converted into restraints to guide the final step of 3D structure folding based on energy minimization (see Methods). Unless otherwise specified, the RMSDs mentioned below are calculated by considering all atoms using the evaluation toolkit provided by the RNA-Puzzles community<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>.<fig id="Fig1"><label>Fig. 1</label><caption><title>Overall architecture of trRosettaRNA.</title><p><bold>a</bold> flowchart of trRosettaRNA. <bold>b</bold> structure of each RNAformer block. <italic>n</italic>, <italic>L</italic>, and <italic>c</italic> are the number of sequences in the MSA, the length of the query sequence, and the number of channels, respectively.</p></caption><graphic xlink:href="41467_2023_42528_Fig1_HTML" id="d32e511"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Performance of trRosettaRNA on 30 independent RNAs</title>
      <p id="Par9">To evaluate trRosettaRNA, we collected 30 non-redundant RNA structures based on both release date and similarity with the training RNAs. These RNAs are released after the training RNAs date (i.e., 2017-01) and do not share sequence similarity with trRosettaRNA and SPOT-RNA’s training RNAs (see Methods).</p>
      <p id="Par10">We compare trRosettaRNA with two representative methods, RNAComposer<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> and SimRNA<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. The same secondary structures (from SPOT-RNA) were fed into both methods for fair comparison. For RNAComposer, we submitted the RNA sequences and the predicted secondary structures to its web server to generate 3D models. SimRNA was installed and run locally in our computer cluster. We evaluate the first predicted model to ensure fairness. As shown in Table <xref rid="Tab1" ref-type="table">1</xref>, on these 30 RNAs, the average RMSD by trRosettaRNA (8.5 Å) is significantly lower than those by RNAComposer (17.4 Å; <italic>P</italic>-value = 1.3E-6) and SimRNA (17.1 Å; <italic>P</italic>-value = 1.1E-7; the <italic>P</italic>-values presented in this manuscript were calculated by two-tailed Student’s <italic>t</italic>-tests). trRosettaRNA outperforms RNAComposer and SimRNA for 86.7% and 96.7% of the 30 cases, respectively (Fig. <xref rid="MOESM1" ref-type="media">S2a</xref>). 20% of the models predicted by trRosettaRNA are with RMSD &lt; 4 Å, whereas no models from RNAComposer and SimRNA can achieve this accuracy. These data demonstrate the superiority of the proposed pipeline over traditional RNA structure prediction methods.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison between trRosettaRNA, SimRNA, and RNAComposer on 30 independent RNAs</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Methods</th><th>Average RMSD (±std.) (Å)</th><th>Ratio of accurate models (RMSD &lt; 4 Å)</th><th><italic>P</italic>-value</th></tr></thead><tbody><tr><td>SimRNA</td><td>17.1 ( ± 5.2)</td><td>0%</td><td>1.1E-7</td></tr><tr><td>RNAComposer</td><td>17.4 ( ± 6.8)</td><td>0%</td><td>1.3E-6</td></tr><tr><td>trRosettaRNA</td><td>8.5 ( ± 5.7)</td><td>20%</td><td>-</td></tr></tbody></table><table-wrap-foot><p>Please note that the evaluation here is on the first model predicted by each method. The <italic>P</italic>-values presented here were calculated by two-tailed Student’s <italic>t</italic>-tests. No adjustments were made for multiple comparisons. Source data are provided as a Source Data file.</p></table-wrap-foot></table-wrap></p>
      <p id="Par11">We further analyze the impact of the input features (i.e., MSA and secondary structure). The MSA quality is measured by the alignment depth, i.e., the logarithm of the effective number (denoted by log(<italic>N</italic><sub><italic>eff</italic></sub>)) of homologous sequences with &lt;80% sequence identity. As shown in Fig. <xref rid="MOESM1" ref-type="media">S2b</xref>, the RMSD of the trRosettaRNA model is correlated with log(<italic>N</italic><sub><italic>eff</italic></sub>) (Pearson correlation coefficient, PCC = −0.32). trRosettaRNA outperforms RNAComposer and SimRNA at all log(<italic>N</italic><sub><italic>eff</italic></sub>) levels, especially on targets with high log(<italic>N</italic><sub><italic>eff</italic></sub>) values. For the models by RNAComposer and SimRNA, the correlations between the RMSDs and the alignment depth are weak (PCCs are −0.05 and 0.21, respectively), probably because they do not use MSA during modeling. In contrast, there is a stronger correlation between the RMSDs of the predicted models and the accuracy of the predicted secondary structures (measured by F1-score) for all methods (PCCs are −0.35, −0.31, and −0.29 for trRosettaRNA, SimRNA, and RNAComposer, respectively, Fig. <xref rid="MOESM1" ref-type="media">S2c</xref>). This is consistent with the observations that precise RNA secondary structure prediction plays a key role in successful 3D structure modeling<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>.</p>
      <p id="Par12">To provide a more direct demonstration of the contribution of MSA to the RNA structure prediction, we also evaluate the performance of trRosettaRNA when MSAs are excluded. As shown in Fig. <xref rid="MOESM1" ref-type="media">S3</xref>, for 21 out of the 30 RNAs, the introduction of MSAs helps improve the accuracy of the predicted models. Fig. <xref rid="MOESM1" ref-type="media">S4</xref> presents the MSAs for two example RNAs (PDB IDs: <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb5KH8/pdb">5KH8</ext-link>/<ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb7D7V/pdb">7D7V</ext-link>). The coevolutionary information extracted from these MSAs not only covers the majority of 2D base-pairing interactions but also encompasses some 3D interactions (highlighted by green circles in the 2D maps of Fig. <xref rid="MOESM1" ref-type="media">S4</xref>). With the assistance of MSAs, trRosettaRNA can generate more accurate models for these two RNAs (refer to the bottom right of each subfigure in Fig. <xref rid="MOESM1" ref-type="media">S4</xref>).</p>
      <p id="Par13">As the secondary structure used in trRosettaRNA is predicted by SPOT-RNA, it is important to consider the possibility of inaccurate predictions by SPOT-RNA. Among the 30 RNAs in the dataset, there are 8 RNAs for which SPOT-RNA failed to predict accurate secondary structures (i.e., F1-score &lt;0.5). Table <xref rid="MOESM1" ref-type="media">S1</xref> reveals that for 6 of these 8 RNAs, the secondary structures of trRosettaRNA models are more accurate than those predicted by SPOT-RNA. In Fig. <xref rid="MOESM1" ref-type="media">S5a</xref>, it is evident that trRosettaRNA corrects certain false positive base pairs, which are highlighted by red circles. Furthermore, trRosettaRNA identifies some interactions that were missed by SPOT-RNA, as indicated by the green circles in Fig. <xref rid="MOESM1" ref-type="media">S5a</xref>. These observations suggest that trRosettaRNA can correct incomplete or inaccurate secondary structures, although its accuracy is correlated with the quality of the input secondary structures.</p>
      <p id="Par14">Nevertheless, when considering the entire set of 30 RNAs, trRosettaRNA exhibits a slight drop in the average F1-score of secondary structures, decreasing it from 0.65 to 0.6 (as shown in Fig. <xref rid="MOESM1" ref-type="media">S5b</xref>). This decrease is mainly from the cases where the secondary structures predicted by SPOT-RNA are accurate (F1-score &gt; 0.6). This may be caused by the potential conflicts between the predicted distance restraints and the base pair restraints, which are not trival to resolve, especially for targets modeled with low confidence.</p>
      <p id="Par15">However, as a data-driven method, the performance of trRosettaRNA is influenced by the structural homology existing between the target RNA and previously solved RNA structures, which is measured by the maximum TM-score<sub>RNA</sub>. As shown in Fig. <xref rid="MOESM1" ref-type="media">S2d</xref>, the correlation between the structural homology and the RMSD of trRosettaRNA models is stronger compared to SimRNA and RNAComposer (PCCs are −0.6, −0.0003, and −0.05, respectively). For five RNAs lacking homolog match (i.e., maximum TM-score<sub>RNA</sub> with solved RNAs below 0.45), the average RMSD of trRosettaRNA models is 15.8 Å. This value significantly drops to 7.0 Å for the remaining 25 RNAs possessing structural homologs. This discrepancy may be due to the current limitation in the number of solved RNA structures within the PDB database, which in turn impacts the performance of data-driven methods on RNAs with novel structures. Nevertheless, for the 5 RNAs without structural homologs, the average RMSD of the models by trRosettaRNA (15.8 Å) remains lower than SimRNA (20.6 Å) and RNAComposer (24.3 Å), illustrating the superiority of the deep-learning method over traditional methods for automated prediction.</p>
    </sec>
    <sec id="Sec5">
      <title>Performance of trRosettaRNA on RNA-Puzzles targets</title>
      <p id="Par16">We further test trRosettaRNA on 20 targets from the RNA-Puzzles experiments<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>. The target information and the prediction results are summarized in Tables <xref rid="MOESM1" ref-type="media">S2</xref> and <xref rid="MOESM1" ref-type="media">S3</xref>, respectively. It turns out that these targets are harder to predict than the 30 independent RNAs, as revealed by the increased value of RMSD (from 8.5 Å to 10.5 Å).</p>
      <p id="Par17">We compare the trRosettaRNA predictions with the original submissions from the RNA-Puzzles experiments. According to the official assessments<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>, the most accurate approach is the Das group, which submitted models for 17 targets. Table <xref rid="MOESM1" ref-type="media">S3</xref> summarizes the results on these targets for the models from the Das group (denoted by Das) and the best of the models from all groups (denoted by PZ_best). On these 17 targets, the average RMSD of the first predicted models by our method is 10.3 Å, compared with 9.3 Å and 7.2 Å from Das and PZ_best, respectively. For 9 of the 17 targets, the trRosettaRNA models are more accurate than the Das models. Similar observations can be obtained when all the five submitted models are assessed (Table <xref rid="MOESM1" ref-type="media">S3</xref>). Note that certain participating groups may utilize human experts and/or literature data to guide the modeling during the prediction seasons of the RNA-Puzzles experiments. In contrast, the trRosettaRNA predictions, which are fully automated, achieve similar accuracy to the top human groups.</p>
      <p id="Par18">To obtain a more comprehensive understanding of the quality of trRosettaRNA models, we employ other evaluation measures used in the RNA-Puzzles assessment, in addition to RMSD (Table <xref rid="MOESM1" ref-type="media">S4</xref>). These measures include the deformation index (DI; evaluating the predicted structures with both RMSDs and base interactions; lower is better)<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>, the Interaction Network Fidelity (INF; evaluating the interactions in the predicted structure; higher is better)<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>, and MolProbity clash scores (number of serious steric overlaps per 1000 atoms in a structure; lower is better)<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. The average clash score of the trRosettaRNA models (3.2) is significantly lower than that of the Das models (10.8), indicating that trRosettaRNA not only achieves higher accuracy but also produces higher-quality models. Nevertheless, trRosettaRNA models exhibit worse INF and DI scores than the Das models. This can be explained by the inherent features of our methodology. First, the secondary structures used by trRosettaRNA are predicted rather than from experiments, literature, or human annotation. These predicted secondary structures may provide inaccurate interaction information to the transformer network. Second, trRosettaRNA uses predicted geometry restraints rather than fragment assembly to derive the secondary structures. Both factors may lead to less accurate local base-base interactions in the trRosettaRNA models.</p>
    </sec>
    <sec id="Sec6">
      <title>Blind test in CASP15</title>
      <p id="Par19">Based on trRosettaRNA, we participated in the blind test of the CASP15 experiment on RNA structure prediction as an automated server (group name Yang-Server). The Yang-Server models for the 12 CASP15 RNAs are shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. According to the official ranking, Yang-Server is ranked the 9<sup>th</sup> out of 42 RNA structure prediction groups (including 33 human groups and 9 server groups). Yang-Server is ranked second (after the UltraFold_Server) when considering automated server groups only. Note that the official ranking considers both global and local accuracy, including TM-score<sub>RNA</sub>, GDT-TS score, INF, lDDT, and steric clash; while the main objective optimized in trRosettaRNA is RMSD. Based on the cumulative Z-score of RMSD ( &gt; 0.0), Yang-Server’s ranking is improved: 5<sup>th</sup>/42 for all groups and 1<sup>st</sup>/9 for server groups (Fig. <xref rid="MOESM1" ref-type="media">S6</xref>). Yang-Server also achieves a higher ranking than other deep learning-based groups such as AIchemy_RNA (based on RhoFold<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>), BAKER (based on RoseTTAFoldNA<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>), and DF_RNA (based on DeepFoldRNA<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>) in terms of the Z-score of RMSD. According to the RNA-Puzzles assessment<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>, the Yang-Server predictions (though not perfect) for two protein-binding targets (R1189 and R1190) are the most accurate among all submitted models (with RMSDs of 16.3 Å and 16.0 Å, respectively). This result demonstrates the potential of our method in predicting protein-binding RNAs even in the absence of binding partner information, though the accuracy is far from satisfactory.<fig id="Fig2"><label>Fig. 2</label><caption><title>Yang-Server models (red) versus experimental structures (gray) for 12 CASP15 targets.</title><p>Consistent with Table <xref rid="Tab2" ref-type="table">2</xref>, the best-submitted models are shown here. The 3D structures are presented using PyMOL.</p></caption><graphic xlink:href="41467_2023_42528_Fig2_HTML" id="d32e818"/></fig></p>
      <p id="Par20">The 12 RNAs in CASP15 can be classified into two categories based on their sources: eight of them are natural, while the remaining four are synthetic. On the eight natural RNAs, Yang-Server yields comparable results to the top human group, AIchemy_RNA2 (mean RMSDs of the first/best in five models: 14.8/12.9 Å versus 15.7/11.3 Å; Table <xref rid="Tab2" ref-type="table">2</xref> and S<xref rid="MOESM1" ref-type="media">5</xref>). It is worth noting that trRosettaRNA does not consider structural templates, which may be crucial in improving the modeling accuracy. For example, for the targets, R1107, R1108, and R1149, secondary structure templates can be easily found in the RFAM database (version 14.4, released in December 2020) using an automated process<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. With these secondary structure templates, trRosettaRNA predicts much more accurate 3D structures than the models submitted during the CASP15 season (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). The RMSD values are reduced from 17.9 Å, 9.1 Å, and 13.9 Å to 4.3 Å, 4.8 Å, and 10.6 Å, for R1107, R1108, and R1149, respectively, competitive to the models by AIchemy_RNA2 (i.e., 4.5 Å, 4.5 Å, and 10.5 Å). Thus we believe that the fusion of high-quality secondary structure templates and deep-learning techniques can improve the performance further.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Results for 12 RNA targets in CASP15</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">Target type</th><th rowspan="2">Target ID</th><th colspan="6">RMSD (Å)</th></tr><tr><th>Yang-Server</th><th>AIchemy_RNA2</th><th>Chen</th><th>RNApolis</th><th>Deep learning best<sup>a</sup></th><th>Overall best</th></tr></thead><tbody><tr><td rowspan="9">Natural</td><td>R1107</td><td>17.9 (4.3<sup>b</sup>)</td><td>4.5</td><td>6.5</td><td>8.8</td><td>5.9</td><td>4.5</td></tr><tr><td>R1108</td><td>9.1 (4.8<sup>b</sup>)</td><td>4.5</td><td>6.0</td><td>8.5</td><td>4.8</td><td>4.5</td></tr><tr><td>R1116</td><td>10.9</td><td>17.3</td><td>18.0</td><td>12.7</td><td>7.9</td><td>4.8</td></tr><tr><td>R1117</td><td>2.7</td><td>2.3</td><td>2.0</td><td>2.7</td><td>2.7</td><td>2.0</td></tr><tr><td>R1149</td><td>13.9 (10.6<sup>b</sup>)</td><td>10.5</td><td>14.0</td><td>18.2</td><td>6.9</td><td>6.9</td></tr><tr><td>R1156</td><td>16.6</td><td>7.6</td><td>11.0</td><td>17.1</td><td>12.9</td><td>5.4</td></tr><tr><td>R1189</td><td>16.3</td><td>22.0</td><td>21.2</td><td>18.7</td><td>22.8</td><td>16.3</td></tr><tr><td>R1190</td><td>16.0</td><td>22.0</td><td>18.8</td><td>22.4</td><td>22.2</td><td>16.0</td></tr><tr><td>Average</td><td>12.9 (10.3<sup>b</sup>)</td><td>11.3</td><td>12.2</td><td>13.6</td><td>10.8</td><td>7.5</td></tr><tr><td rowspan="5">Synthetic</td><td>R1126</td><td>32.7</td><td>8.8</td><td>12.6</td><td>20.0</td><td>30.2</td><td>8.9</td></tr><tr><td>R1128</td><td>22.3</td><td>4.3</td><td>6.7</td><td>14.6</td><td>14.3</td><td>4.3</td></tr><tr><td>R1136</td><td>41.6</td><td>7.3</td><td>10.9</td><td>11.0</td><td>27.3</td><td>7.2</td></tr><tr><td>R1138</td><td>40.8</td><td>7.8</td><td>12.3</td><td>9.6</td><td>35.5</td><td>7.8</td></tr><tr><td>Average</td><td>34.4</td><td>7.0</td><td>10.6</td><td>13.8</td><td>26.8</td><td>7.0</td></tr><tr><td colspan="2">Overall average</td><td>20.1 (18.3<sup>b</sup>)</td><td>9.9</td><td>11.2</td><td>13.7</td><td>16.1</td><td>7.4</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>According to the CASP15 abstracts, there are 14 RNA prediction groups utilizing deep learning-based methods to predict RNA structures.</p><p><sup>b</sup>trRosettaRNA results with secondary structure templates as inputs.</p><p>For all compared groups, we evaluate their best-submitted models for each target. The evaluation based on the first predicted model is shown in Table <xref rid="MOESM1" ref-type="media">S5</xref>.</p></table-wrap-foot></table-wrap><fig id="Fig3"><label>Fig. 3</label><caption><title>Results for three targets from CASP15 for which the template secondary structures can be found in the Rfam database.</title><p>The RNA secondary structure visualization was employed with forna<sup><xref ref-type="bibr" rid="CR52">52</xref></sup>. The template search and 2D structure modelling were employed with R2DT program<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. For the 3D modelling results, we present the best model submitted by Yang-Server (in red), the trRosettaRNA model based on 2D templates (in blue) and the AIchemy_RNA2 best model (in green). Both predicted 3D structures are superimposed onto the experimental structures (gray). For Yang-Server models, the RMSD and eRMSD values are shown in SPOT-RNA-based/R2DT-based format.</p></caption><graphic xlink:href="41467_2023_42528_Fig3_HTML" id="d32e1267"/></fig></p>
      <p id="Par21">Nevertheless, when it comes to the modeling of synthetic RNAs, there is a notable margin between all the deep learning-based groups (including ours) and the top human groups such as AIchemy_RNA2 (the bottom half of Tables <xref rid="Tab2" ref-type="table">2</xref> and S<xref rid="MOESM1" ref-type="media">5</xref>). Note that the top groups for these targets are all based on human-intervented simulations rather than automated modeling. For example, the leading group AIchemy_RNA2 model predicted RNA structure based on the assembly of manually-detected RNA structural motifs followed by full atom optimization with the BRiQ statistical potential<sup><xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup>.</p>
      <p id="Par22">The challenge in the automated structure prediction of synthetic RNAs may be explained by a few factors. First, the deep learning-based approach may be biased towards the limited training data, which are mainly from natural RNAs. The synthetic RNAs lack globally homologous RNA sequences and similar structures to the existing RNAs (the maximum TM-score<sub>RNA</sub> is around 0.3), which may hinder the neural networks from inferring meaning predictions. Second, the human groups were given a three-week deadline for each target, allowing the elaborate human-expert interventions in the modeling procedure. In contrast, the Yang-Server predictions for each target were generated automatically in three days. As a fair comparison, we run the SimRNA package and RNAComposer server with the same secondary structures used by Yang-Server as inputs. The results show no superiority to the Yang-Server models (Fig. <xref rid="MOESM1" ref-type="media">S7</xref>). This highlights the inherent challenge in automated modeling for these synthetic RNAs, which applies to both conventional and deep learning-based methods.</p>
      <p id="Par23">For example, R1138 contains a few helix hinges and kissing loops, which play important roles in the folding of the overall structure. While the automated methods successfully establish satisfactory local interaction networks (with INF value of ~0.7), the predicted models still deviate significantly from the experimental structure when considering the global 3D topologies (Fig. <xref rid="MOESM1" ref-type="media">S8b</xref>). Accurately predicting the kissing loops (such as the one highlighted by the black circle) and the helix hinges in R1138 poses a significant challenge for automated methods, despite the recurrence of these motifs across numerous RNA structures. To illustrate, trRosettaRNA correctly predicted the highlighted kissing loop (highlighted by the black circle on the predicted distance map in Fig. <xref rid="MOESM1" ref-type="media">S9b</xref>). Utilizing this limited set of distance restraints, trRosettaRNA can successfully generate an accurate structure of the kissing loop (Fig. <xref rid="MOESM1" ref-type="media">S9a</xref>). However, this particular kissing loop was not predicted correctly when modeling the structure globally, probably due to the complicated interactions between other motifs (Fig. <xref rid="MOESM1" ref-type="media">S9c</xref>). This reflects the modeling difficulty of such synthetic RNA by automated approaches. As mentioned by AIchemy_RNA2, the accurate modeling of these synthetic RNAs requires extensive human-expert interventions, involving template detection, secondary structure determination, motif assignment, and more<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>.</p>
      <p id="Par24">As the primary focus of our method is to optimize the global RMSD, it is also worthwhile to investigate other metrics (Table <xref rid="MOESM1" ref-type="media">S6</xref>). In addition to the INF and MolProbity clash score mentioned above, we also evaluate the Local Distance Difference Test (lDDT<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>) score, which measures the local inter-residue distance error and has been widely used to evaluate protein structure models. In terms of the two local metrics (INF and lDDT), the Yang-Server models show a notable margin with AIchemy_RNA2 for both natural and synthetic RNAs. This discrepancy can be attributed to the reasons mentioned earlier, namely, the inaccurate input secondary structures and the methodological differences between the two approaches (deep learning-based versus fragment assembly-based). The integration of local fragment segments and deep-learning techniques is promising for bridging this gap in the future.</p>
      <p id="Par25">During CASP15, our method did not consider steric clashes in modeling, resulting in high clash scores (&gt;20) for our submitted models. This might impact our official ranking which considers both modeling accuracy and steric clashes. According to the CASP15 assessments<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>, Yang-Server is ranked 26<sup>th</sup> out of the 42 groups in terms of clash score, worse than AIchemy_RNA and BAKER. We addressed this issue after CASP15 by implementing an additional refining step at the end of the energy minimization procedure. Consequently, the average clash score of the 12 CASP15 targets dropped significantly from 33.84 to 3.05, which is much lower than that of AIchemy_RNA2 (16.68).</p>
    </sec>
    <sec id="Sec7">
      <title>Blind test on the latest RNA-Puzzles targets</title>
      <p id="Par26">In addition to our participation in CASP15, we also took part in the blind tests of three RNA-Puzzles targets as an automated server group named Yang. These targets include PZ37 (PDB ID: <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb8GXC/pdb">8GXC</ext-link>; a ligand-binding dimer), PZ38 (PDB ID: <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb8HB8/pdb">8HB8</ext-link>; a ligand-binding riboswitch), and PZ39 (PDB ID: <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb8DP3/pdb">8DP3</ext-link>; a protein-binding cloverleaf RNA). The results are summarized in Fig. <xref rid="Fig4" ref-type="fig">4a, b</xref>.<fig id="Fig4"><label>Fig. 4</label><caption><title>Blind test results and comparison with other deep learning-based methods.</title><p><bold>a</bold>, <bold>b</bold> blind test results on the latest three targets from RNA-Puzzles. <bold>a</bold> RMSD comparison of the models submitted by Yang group and models from other groups. <bold>b</bold> the best models submitted by Yang group (red) superposed to the experimental structures (gray). <bold>c</bold> head-to-head RMSD comparison between trRosettaRNA and other deep learning-based methods (<italic>n</italic> = 15 RNAs from the blind tests of CASP15 and RNA-Puzzles). The dashed horizontal and vertical lines correspond to an RMSD of 4 Å. The bar plots show the RMSD distributions. The red circles highlight the two cases (R1107 and R1108) in which trRosettaRNA can achieve better results with improved secondary structures. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_42528_Fig4_HTML" id="d32e1377"/></fig></p>
      <p id="Par27">In the case of PZ37/PZ38, our results (RMSD 10.3 Å/8.7 Å) are highly competitive, ranking at 3/3 out of 16/15 participating groups, and only surpassed by the human groups Chen and Szachniuk. It is worth noting that our predictions were fully automated and did not consider the ligand or dimer information, making our results impressive. However, we notice that the first model chosen for PZ38 is the worst among the five submitted models, with an RMSD of 14.4 Å, compared to 8.7 Å of the best model. This reflects that while trRosettaRNA exhibits the capability to produce models with commendable accuracy, there remains potential for model ranking.</p>
      <p id="Par28">For the target PZ39, the RMSD of our models are higher than 15 Å. PZ39 has no similar sequence (according to BLASTN search at an e-value cutoff of 10) nor similar structure (according to TM-score<sub>RNA</sub> &gt; 0.45) from the known RNAs. This may account for the poor performance of our method on this target. Nonetheless, local motif templates can be found for this RNA. For example, for the fragment consisting of residues 20 to 26 which forms the Fab binding site, it is easy to identify the same fragments in known Fab-binding RNAs (e.g., in PDB IDs: <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb6DB9/pdb">6DB9</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb3IVK/pdb">3IVK</ext-link>). Given the limited data of available RNA 3D structure, a promising approach to improving may be based on the combination of deep learning with conventional physics-based and/or fragment assembly-based methods.</p>
    </sec>
    <sec id="Sec8">
      <title>Comparison with other deep learning-based methods</title>
      <p id="Par29">During the preparation of this manuscript, another three deep learning-based approaches (DeepFoldRNA, RoseTTAFoldNA, and RhoFold) were posted. As mentioned above, trRosettaRNA achieves a higher summed Z-score of RMSD than these methods in the blind test of the CASP15 competition. We further conducted head-to-head comparisons between these methods on RNAs from the blind tests (CASP15 and RNA-Puzzles). For each target from blind tests, we used the result of the first submitted models if available; otherwise, we ran the program locally to predict the structure model.</p>
      <p id="Par30">The results show that trRosettaRNA achieves a 3.3/2.1 Å lower RMSD than DeepFoldRNA/RoseTTAFoldNA (orange/purple points in Fig. <xref rid="Fig4" ref-type="fig">4c</xref>) on the 15 RNAs from the blind tests. For 11/9 out of these 15 RNAs, the trRosettaRNA predictions are more accurate than those by DeepFoldRNA/RoseTTAFoldNA. The average RMSD of trRosettaRNA models (21.3 Å) is marginally higher than RhoFold models (20.6 Å; P-value = 0.9; blue points in Fig. <xref rid="Fig4" ref-type="fig">4c</xref>), which is inconsistent with the comparison based on the Z-score of RMSD (i.e., Fig. <xref rid="MOESM1" ref-type="media">S6</xref>). This slight difference is mainly due to the poor performance of trRosettaRNA on two CASP15 RNAs (17.9 Å for R1107 and 9.1 Å for R1108; compared to 5.9 Å and 5.4 Å for RhoFold, respectively; highlighted by red circle in Fig. <xref rid="Fig4" ref-type="fig">4c</xref>). As mentioned above (see also Fig. <xref rid="Fig3" ref-type="fig">3</xref>), this performance gap can be effectively bridged by employing more confident secondary structures as inputs. For the remaining 13 RNAs, the average RMSD of trRosettaRNA (22.5 Å) is slightly lower than RhoFold (22.9 Å). Moreover, trRosettaRNA outperforms RhoFold for 8 out of the remaining 13 RNAs.</p>
      <p id="Par31">To summarize, trRosettaRNA outperforms DeepFoldRNA and RoseTTAFoldNA, and is competitive with RhoFold in blind tests, highlighting its robustness.</p>
    </sec>
    <sec id="Sec9">
      <title>Impact of the predicted 1D and 2D geometries</title>
      <p id="Par32">The geometries predicted by the RNAformer network consist of 1D orientations and 2D contacts, distances, and orientations (Fig. <xref rid="MOESM1" ref-type="media">S1</xref>). To analyze their contributions, we compare the modeling results using different geometries on the 30 RNA-Puzzles targets (Fig. <xref rid="Fig5" ref-type="fig">5a</xref> and Table <xref rid="MOESM1" ref-type="media">S7</xref>). Using the 2D distance restraints only, trRosettaRNA achieves a reasonable RMSD of 11.34 Å. This value is reduced to 10.79 Å when the 1D and 2D orientations are included. Furthermore, with the help of 2D contacts, the RMSD drops to 10.51 Å. We use the target PZ11 (PDB ID: <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb5LYS/pdb">5LYS</ext-link>) to show the impacts of different restraints. As shown in Fig. <xref rid="Fig5" ref-type="fig">5b</xref>, using 2D distance restraints only, trRosettaRNA can generate a structure model with an RMSD of 10.5 Å. However, the helix at the 5’-end and 3’-end (highlighted by the green square in Fig. <xref rid="Fig5" ref-type="fig">5b</xref>) is wrongly twisted. The introduction of 1D and 2D orientations fixes the wrong twist of this region. The 2D contact restraints further refine the structure, resulting in a more accurate model with 6.7 Å RMSD.<fig id="Fig5"><label>Fig. 5</label><caption><title>Summary of the folding results by different restraints.</title><p><bold>a</bold> contribution of the various restraints to the trRosettaRNA modeling accuracy in terms of the RMSD for the 20 RNA-Puzzles targets (<italic>n</italic> = 20 RNAs). <bold>b</bold> an example (PZ11) to illustrate the impact of different restraints. The predicted models (red cartoon) are superposed to the experimental structures (gray cartoon). The green square highlights the helix region which is influenced by the introduction of more restraints. <bold>c</bold> head-to-head comparison between the estimated and real RMSD for all RNAs in the benchmark datasets (<italic>n</italic> = 50 RNAs). <bold>d</bold> the relationship between the running time and the sequence length on 1752 Rfam families. The 2D geometry predictions (orange dots) were run on one GPU card. The 3D structure folding was performed on one CPU core. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_42528_Fig5_HTML" id="d32e1472"/></fig></p>
    </sec>
    <sec id="Sec10">
      <title>Confidence score of the predicted structure models</title>
      <p id="Par33">To guide real-world application, the confidence scores of the predicted protein structure models have been estimated reliably in trRosetta<sup><xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref></sup>. A similar estimation can be extended to trRosettaRNA. Specifically, we first calculate a few variables reflecting the confidence of the predicted distance maps and the convergence of the first structure models (see Methods for more details). Then a linear regression on these variables is employed to fit the RMSD values. For the RNAs from the benchmark datasets, the estimated RMSDs (eRMSDs) correlate well with the real RMSDs of the predicted models (PCC = 0.56, Fig. <xref rid="Fig5" ref-type="fig">5c</xref>). Moreover, the eRMSD metric also roughly reflects the modeling difficulty for the 12 CASP15 targets, with an average value of 17.2 Å.</p>
      <p id="Par34">As a practical application, for the three CASP15 RNAs (R1107, R1108, and R1149) with reliable secondary structure templates, the defined eRMSD effectively captures the improvements from the introduction of these templates (Fig. <xref rid="Fig3" ref-type="fig">3</xref> and Table <xref rid="MOESM1" ref-type="media">S5</xref>). Additionally, in 6 out of the 8 cases where SPOT-RNA provided inaccurate secondary structures, the eRMSD successfully helps identify models with more accurate input of secondary structures (Table <xref rid="MOESM1" ref-type="media">S1</xref>). These observations highlight the promising potential of eRMSD in facilitating the optimal selection between predictions from various inputs.</p>
    </sec>
    <sec id="Sec11">
      <title>Analysis of the running time</title>
      <p id="Par35">We decompose the running time of trRosettaRNA into two parts: 2D geometry prediction and 3D structure generation. The time for MSA generation is not discussed here as it can be flexible depending on the searching algorithms and sequence databases. Fig. <xref rid="Fig5" ref-type="fig">5d</xref> shows that trRosettaRNA spends most time in the generation of 3D structure (&gt; 95%). With the increase in sequence length, the running time increases linearly. In general, it takes &lt;30 min to complete the prediction for a typical RNA with &lt;200 nucleotides.</p>
    </sec>
    <sec id="Sec12">
      <title>Application to Rfam families with unknown structures</title>
      <p id="Par36">It remains challenging to solve RNA structures by experiment. For example, only 123 out of the 3938 families in the Rfam database (version 14.4) have experimentally resolved 3D structures<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. We sought to predict the structures for the Rfam families that have no experimental structures. We collected 1752 unsolved families that are 50–200 nucleotides long and have more than 30 members. For each family, we use its consensus secondary structure along with the MSA derived from the consensus sequence as the input features to trRosettaRNA. Most of these families are not predicted well, with eRMSD &gt; 10 Å for 891 out of 1752 families (Fig. <xref rid="Fig6" ref-type="fig">6a</xref>). This may reflect the difficulty of determining the structures for these families.<fig id="Fig6"><label>Fig. 6</label><caption><title>Application of trRosettaRNA to Rfam families with unknown structures.</title><p><bold>a</bold> eRMSD (i.e., estimated RMSD) distributions of the predicted structure models (<italic>n</italic> = 1752 Rfam families). <bold>b</bold> six selected example families with eRMSD &lt;4 Å. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_42528_Fig6_HTML" id="d32e1537"/></fig></p>
      <p id="Par37">Nevertheless, trRosettaRNA does predict accurate structures for 263 families with eRMSD &lt;4 Å. For 27 of these families, the predicted structure models do not have any similar structures in PDB according to the program RNAalign (TM-score<sub>RNA</sub><sup><xref ref-type="bibr" rid="CR42">42</xref></sup> ≥ 0.45). In Fig. <xref rid="Fig6" ref-type="fig">6b</xref>, we show the predicted structures for 6 families with distinct topologies. These high-confidence models are anticipated to provide a structural basis for understanding their biological functions and guide their experimental determinations. For example, for the family sul1 RNA (<ext-link ext-link-type="uri" xlink:href="https://rfam.org/search?q=RF01070">RF01070</ext-link>) which encodes a subunit of an enzyme participating in the citric acid cycle, trRosettaRNA can generate a confident model with an estimated RMSD of 1.6 Å. The trRosettaRNA models for the 263 families with eRMSD &lt;4 Å are available on our website (<ext-link ext-link-type="uri" xlink:href="https://yanglab.qd.sdu.edu.cn/trRosettaRNA/rfam/">https://yanglab.qd.sdu.edu.cn/trRosettaRNA/rfam/</ext-link>).</p>
    </sec>
  </sec>
  <sec id="Sec13" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par38">We have developed trRosettaRNA, an automated approach to RNA 3D structure prediction with the transformer network. We have rigorously assessed trRosettaRNA with two independent datasets and two blind tests. The benchmark tests show that trRosettaRNA predicts more accurate models than the other automated methods. trRosettaRNA was assessed blindly in two experiments: RNA-Puzzles (3 targets) and CASP15 (12 targets). The RNA-Puzzles experiments show that the automated predictions by trRosettaRNA are competitive with the top human predictions for 2 out of 3 targets. The CASP15 experiments show that trRosettaRNA outperforms other deep learning-based methods in terms of the cumulative Z-score based on RMSD. Our method achieves comparable accuracy to the top human groups on 8 natural RNAs, though without any human interventions.</p>
    <p id="Par39">However, we notice that the average RMSD on the natural RNAs from the CASP15 blind test (14.8 Å for the first models) is higher than that on the RNAs from the two benchmark datasets (8.5 Å for 30 independent RNAs and 10.5 Å for 20 previous RNA-Puzzles targets). The disparity in the modeling accuracy may be explained by the target difficulty and novelty. (1) target difficulty. Most of the CASP15 RNAs exhibit high flexibility and can adopt multiple conformations (except for R1116 and R1117)<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. In addition, there are two dimers (R1107, R1108) and two protein-binding RNAs with many single-strand regions (R1189, R1190). These features pose challenges for SPOT-RNA in predicting confident secondary structures. To illustrate, the average F1-score of the predicted secondary structure by SPOT-RNA is much lower for the 8 natural RNAs from CASP15 in contrast to the 20 RNA-Puzzles targets (0.62 and 0.72, respectively). (2) target novelty. A significant proportion of RNAs (two-thirds, 20 out of 30) from the non-redundant benchmark dataset exhibit high similarities (TM-score<sub>RNA</sub> &gt; 0.6) to previously known RNAs, making them easy to predict for data-driven methods like trRosettaRNA. On the contrary, none of the RNAs from CASP15 show such a level of similarity (Fig. <xref rid="MOESM1" ref-type="media">S10</xref>).</p>
    <p id="Par40">This reflects the limitations associated with trRosettaRNA and the benchmark tests employed in this work. First, the performance of trRosettaRNA is susceptible to the quality of predicted secondary structures. Secondly, though trRosettaRNA achieves promising accuracy in the internal benchmark tests, its performance on novel RNAs remains limited. Moreover, the automated structure prediction of synthetic RNAs remains challenging.</p>
    <p id="Par41">The blind tests in CASP15 experiments suggest that the deep learning approach to RNA structure prediction is still in its infancy. Nevertheless, with consistent development, deep learning should be promising to advance RNA structure prediction. Incorporation of physics-based modeling into deep learning is one of the directions to improve in the future. One of the most instant alternatives is to combine it with other conventional approaches and optimize the algorithms toward those under-represented RNA structures in the future. For example, to overcome the bias toward known RNA folds, neural networks (such as with physics-informed neural networks<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>) can be utilized to learn force fields or to recognize/assemble local motifs instead of directly predicting the global 3D structures.</p>
  </sec>
  <sec id="Sec14">
    <title>Methods</title>
    <sec id="Sec15">
      <title>trRosettaRNA algorithm</title>
      <p id="Par42">As shown in Fig. <xref rid="Fig1" ref-type="fig">1a</xref>, the full pipeline of trRosettaRNA consists of three major steps: preparation of input data, prediction of 1D and 2D geometries, and generation of 3D structure.</p>
    </sec>
    <sec id="Sec16">
      <title>Step 1. Preparation of input data</title>
      <p id="Par43">For a given query RNA, the first step of trRosettaRNA is to prepare an MSA and a secondary structure. Two different MSAs are generated for each query sequence. The first is generated by using the program rMSA against multiple sequence databases (NCBI’s nt, Rfam, and RNAcentral<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>). The second is obtained by running the program Infernal<sup><xref ref-type="bibr" rid="CR45">45</xref></sup> against the smaller database RNAcentral with two iterations, which is very fast. Then we select the final MSA based on the qualities of the predicted distance maps (measured by the average of standard deviations of the probability values of each nucleotide pair, Fig. <xref rid="MOESM1" ref-type="media">S11</xref>). The secondary structure is predicted by SPOT-RNA<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> from the query sequence. Here we use the predicted probability matrix as the input, which contains more information than the dot-bracket representation.</p>
    </sec>
    <sec id="Sec17">
      <title>Step 2. Prediction of 1D and 2D geometries</title>
      <p id="Par44">The second step of trRosettaRNA is to predict the 1D and 2D geometries by deep learning. We design a transformer network (named RNAformer) similar to the network Evoformer in AlphaFold2. At the very start, the input MSA and secondary structure are converted into two representations, i.e., the MSA representation (i.e., MSA embedded by nucleotide types) and the pair representation (including the direct couplings derived from MSA and the probability matrix of the predicted secondary structure). We adopt a transformer-based module (i.e., RNAformer) to update both representations. More specifically, each block of RNAformer can be divided into four steps according to the update direction (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>).<list list-type="order"><list-item><p id="Par45"><bold>MSA to MSA</bold>. To update the MSA representation by itself, we perform row- and column-wise gated self-attention operations and combine the corresponding results. A feed-forward layer is employed to introduce nonlinearity. Note that the pair information participates in the row-wise attention by adding bias to the attention maps.</p></list-item><list-item><p id="Par46"><bold>MSA to pair</bold>. We perform an outer product operation on the self-updated MSA representation to transform it into the pair format. In detail, the MSA representation is linearly projected to a smaller dimension. Then for the nucleotide pair (<italic>i</italic>, <italic>j</italic>), the outer products of the vectors from the <italic>i</italic><sup>th</sup> and the <italic>j</italic><sup>th</sup> columns of the MSA representation are averaged over the homologous sequences to update the representation for this pair.</p></list-item><list-item><p id="Par47"><bold>Pair to pair</bold>. After the above step, we perform the triangle updates, followed by a feed-forward layer. For each triangle update layer, we use a multi-scale network Res2Net<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> to enhance the ability to model the local details.</p></list-item><list-item><p id="Par48"><bold>Pair to MSA</bold>. The updated pair representation is then linearly projected to the pair-wise attention maps, which are then multiplied on the MSA representation, followed by a feed-forward layer.</p></list-item></list></p>
      <p id="Par49">A single-pass RNAformer consists of 48 blocks, which are cycled 4 times in the complete inference (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). The final predicted probability distributions of the 2D geometries are derived from the updated pair representation via linear layers and softmax operations. To predict the 1D geometry, we transform the MSA representation into 1D representation by row-wise weighted summation, followed by linear layers and softmax operations to obtain the predicted probabilities.</p>
    </sec>
    <sec id="Sec18">
      <title>Step 3. Generation of full-atom structure models</title>
      <p id="Par50">Similar to trRosetta, trRosettaRNA generates full-atom structure models by energy minimization with deep learning potentials and physics-based energy terms in Rosetta.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E={w}_{1}{E}_{dist}+{w}_{2}{E}_{ori}+{w}_{3}{E}_{cont}+{w}_{4}{E}_{ros}$$\end{document}</tex-math><mml:math id="M2"><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${E}_{ori}={E}_{ori,2D}+\frac{L}{2}{E}_{ori,1D}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <italic>E</italic><sub><italic>dist</italic></sub>, <italic>E</italic><sub><italic>ori</italic></sub>, and <italic>E</italic><sub><italic>cont</italic></sub> represent the distance-, orientation-, contact-based restraints and Rosetta’s internal energy terms, respectively; <italic>E</italic><sub><italic>ori,2D</italic></sub> and <italic>E</italic><sub><italic>ori,1D</italic></sub> represent the restraints from 2D and 1D orientations, respectively; <italic>L</italic> is the length of the sequence. A detailed description of these energy terms is available in the Supporting Information. The weights (<italic>w</italic><sub>1</sub> = 1.03, <italic>w</italic><sub>2</sub> = 1.0, <italic>w</italic><sub>3</sub> = 1.05, <italic>w</italic><sub>4</sub> = 0.05) are decided on hundreds of RNAs randomly selected from the training set to minimize the average RMSD. Note that we only select a subset of restraints with probabilities higher than a specified threshold (0.45, 0.65, and 0.6 for distances, orientations, and contacts, respectively).</p>
      <p id="Par51">The folding procedure is implemented with pyRosetta<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>. From each RNA, 20 full-atom starting structures are first generated using the RNA_HelixAssembler protocol in pyRosetta<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>. The Quasi-Newton-based optimization L-BFGS is then applied to refine these structures by minimizing the total energy, resulting in 20 refined full-atom structure models. Finally, the model with the lowest total energy (Eq. <xref rid="Equ1" ref-type="disp-formula">1</xref>) is selected as the final prediction.</p>
    </sec>
    <sec id="Sec19">
      <title>Construction of datasets</title>
      <sec id="Sec20">
        <title>Test sets</title>
        <p id="Par52">Two benchmark datasets are constructed in this work. The first one is from the RNA-Puzzles experiments. This set consists of all RNA-Puzzles targets from PZ1 through PZ33 except PZ2. PZ2 is a complex that has complicated interactions among eight chains, which is out of the prediction scope of the current work. The second dataset comes from PDB. In detail, we first collected 339 RNA structures from PDB that were released after 2017-01. RNAs with more than 200 or less than 30 nucleotides were removed. Then the program cd-hit-est<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> was used to remove redundant sequences at 80% sequence identity. To avoid over-estimation, RNAs with an e-value lower than 10 by BLASTN searching against the training sets of trRosettaRNA and SPOT-RNA were excluded from both test sets. The duplicated RNAs between these two test sets were also removed. The resulting sets comprised 20 RNA-Puzzles targets and 30 non-redundant RNAs, respectively.</p>
      </sec>
      <sec id="Sec21">
        <title>Training sets from PDB</title>
        <p id="Par53">To train our models, we first collected all the RNA chains released before 2022-01 in PDB. Multi-chain structures were separated into single-chain structures. Modified nucleotides are replaced by the standard ones. In addition, if two chains form more than three base-pairing interactions, they are linked by three Adenines, resulting in a new sample. In total, we obtained 8849 samples. Then we tried to generate MSA for each query sequence and removed the sequences without sequence homologs. Finally, 3633 RNA chains were retained for training the network models of trRosettaRNA.</p>
        <p id="Par54">To avoid data leakage in the benchmark tests while keeping as many training samples as possible, five training subsets were obtained by filtering the above 3633 RNA chains. Specifically, for the RNA-Puzzles set, we split the 20 RNAs into four subsets according to their release dates in PDB (i.e., 2010-12 ~ 2013-07, 2013-07 ~ 2016-07, 2016-07 ~ 2019-04, and after 2019-04, see Table <xref rid="MOESM1" ref-type="media">S2</xref>). Correspondingly, four smaller training sets (1133, 1528, 2337, and 3001 samples, respectively) were obtained by removing structures that were released after the above dates. We trained four network models with these training sets, respectively. For each group of the RNA-Puzzles targets, the predictions were made by the model trained on the corresponding training set. For the 30 independent RNAs, the training set consists of 2454 RNAs that were released before 2017-01.</p>
      </sec>
      <sec id="Sec22">
        <title>Self-distillation training set from bpRNA</title>
        <p id="Par55">As the number of available RNA structures is limited, inspired by the success of the self-distillation method used in AlphaFold2, we constructed a self-distillation dataset from the bpRNA database with experimental secondary structures<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>. In detail, we collected the bpRNA sequences that are available in the Rfam database<sup><xref ref-type="bibr" rid="CR41">41</xref></sup> so that the Rfam MSAs can be used immediately. Then we removed the orphan families (i.e., with one RNA sequence only) and ran cd-hit-est to exclude the redundant sequences at a sequence identity cutoff of 80%. The final self-distillation dataset consists of 13202 RNA chains. The RNAs possessing an e-value lower than 10 (by BLASTN) or with a sequence identity higher than 80% (by cd-hit-est) with the two benchmark datasets were excluded from the self-distillation dataset when training the models for benchmark tests. Consequently, the self-distillation dataset for benchmark tests consists of 13175 RNA chains.</p>
        <p id="Par56">We use a single un-distilled RNAformer model, i.e., trained on the PDB dataset (or the corresponding subsets for benchmark tests), to generate the predicted labels for the self-distillation set. Using this un-distilled model, we predicted the 1D and 2D geometries (in the form of probability distributions) for every sequence in the self-distillation set. These predicted geometries are then assigned as the labels of these distillation samples. As the predictions may be inaccurate for some nucleotides, we estimate the prediction confidence and filtered out the potentially inaccurate nucleotides and nucleotide pairs. In detail, for each pair of nucleotides (<italic>i</italic>, <italic>j</italic>) with sequence separation less than 128 (i.e., |<italic>i</italic>-<italic>j</italic> | ≤ 128), we computed the mean P-P distance distribution (i.e., the reference distribution, denoted by<inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{|i-j|}^{ref}$$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_42528_Article_IEq1.gif"/></alternatives></inline-formula>), using the predicted distance maps for 1000 samples randomly selected from the self-distillation set. Then for each pair of nucleotides in a self-distillation sequence, we calculated its confidence score (denoted by <italic>c</italic><sub><italic>i,j</italic></sub>), defined as the Kullback-Leibler divergence between its predicted distribution (denoted by <italic>P</italic><sub><italic>i,j</italic></sub>) and the reference distribution:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{i,j}={D}_{KL}\left({P}_{i,j}|{P}_{|i-j|}^{ref}\right)$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par57">The per-nucleotide confidence score <italic>c</italic><sub><italic>i</italic></sub> was calculated as the average of <italic>c</italic><sub><italic>i,j</italic></sub> over all <italic>j</italic>s within the sequence separation of 128:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{i}=\frac{1}{128}\mathop{\sum }\limits_{j=i+1}^{i+128}{c}_{i,j}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>128</mml:mn></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>128</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par58">During training (see below), the nucleotides/nucleotide pairs with confidence scores &lt;0.5 are masked out when calculating the 1D/2D losses, respectively.</p>
      </sec>
    </sec>
    <sec id="Sec23">
      <title>Training procedure and loss function</title>
      <p id="Par59">The training of an RNAformer model can be divided into three steps. In the first step, we trained an un-distilled model using the PDB set by 15 epochs. This model was then used to generate the labels for RNAs in the self-distillation set. In the second step, the un-distilled model was further trained on the combination of the PDB set and the self-distillation set with another 15 epochs. At each epoch, the training samples consist of all the <italic>N</italic> samples from the PDB set and randomly selected 3 <italic>N</italic> samples from the self-distillation set, where <italic>N</italic> is the size of the PDB set. In the third step, we finetuned the models on the long sequences (&gt;100 nucleotides) selected from the PDB set. We used the Adam optimizer to minimize the loss function (see below) with different learning rates (0.0001 for the first two steps, 0.00005 for the third step).</p>
      <p id="Par60">For all training steps, the loss function is defined as the cross entropy between the predicted distributions and the real or generated labels. In total, the loss function can be written as:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Loss={L}_{2D}+{L}_{1D}+5{L}_{cont}$$\end{document}</tex-math><mml:math id="M12"><mml:mi>L</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <italic>L</italic><sub>2D</sub>, <italic>L</italic><sub>1D</sub>, and <italic>L</italic><sub>cont</sub> are the loss items for the 2D distances and orientations, 1D orientations, and 2D contacts, respectively. More specifically, the three loss items can be written as:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{2D}=\frac{1}{10{N}_{nt}^{2}}\mathop{\sum }\limits_{i=1}^{L}\mathop{\sum }\limits_{j=1}^{L}\mathop{\sum}\limits_{g\in \{2D\,geometries\}}CE\left({P}_{i,j}^{g},{Y}_{i,j}^{g}\right)$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>10</mml:mn><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>D</mml:mi><mml:mspace width="0.25em"/><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mi>C</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1D}=\frac{1}{4{N}_{L}}\mathop{\sum }\limits_{i=1}^{L}\mathop{\sum}\limits_{g\in \{1D\,geometries\}}CE\left({P}_{i}^{g},{Y}_{i}^{g}\right)$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mi>D</mml:mi><mml:mspace width="0.25em"/><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mi>C</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{cont}=\frac{1}{{L}^{2}}\mathop{\sum }\limits_{i=1}^{L}\mathop{\sum }\limits_{j=1}^{L}CE\left({P}_{i,j}^{cont},{Y}_{i,j}^{cont}\right)$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mi>C</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <italic>CE</italic>() is the cross entropy function; <inline-formula id="IEq2"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{i,j}^{g}$$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_42528_Article_IEq2.gif"/></alternatives></inline-formula> is the predicted probability distribution of the 2D geometry <italic>g</italic> between nucleotides <italic>i</italic> and <italic>j</italic>; <inline-formula id="IEq3"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{i}^{g}$$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_42528_Article_IEq3.gif"/></alternatives></inline-formula> is the predicted probability distribution of the 1D geometry <italic>g</italic> of nucleotide <italic>i</italic>; <inline-formula id="IEq4"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{i,j}^{cont}$$\end{document}</tex-math><mml:math id="M24"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_42528_Article_IEq4.gif"/></alternatives></inline-formula> is the predicted probability of nucleotides <italic>i</italic> and <italic>j</italic> to be in contact; the <italic>Y</italic> heads are the one-hot encodings of the true labels (for PDB samples) or the predicted distributions (for self-distillation samples); <italic>L</italic> is the number of nucleotides in sequence; 10 and 4 are the number of types of 2D geometries (5 distances + 5 orientations) and 1D geometries (4 orientations), respectively.</p>
    </sec>
    <sec id="Sec24">
      <title>Estimation of model confidence</title>
      <p id="Par61">To estimate the quality of the predicted model, a few variables are first derived from predicted distance maps and generated decoys.<list list-type="order"><list-item><p id="Par62"><italic>pRMSD</italic>: the average pair-wise RMSD of the top ten decoys with the lowest total energies.</p></list-item><list-item><p id="Par63"><italic>mp</italic>: the mean probability of the predicted inter-nucleotide distances for the set (denoted by <italic>S</italic>) of the top 15 <italic>L</italic> (<italic>L</italic> is the sequence length) nucleotide pairs (as ranked by the probability <italic>P</italic>(<italic>d</italic><sub>P-P</sub> &lt; 40 Å)). A similar variable has been defined to estimate the accuracy of predicted inter-residue distances<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>.<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$mp=\frac{1}{{N}_{bins}}\mathop{\sum }\limits_{k=1}^{{N}_{bins}}\frac{1}{|{M}_{k}|}\mathop{\sum}\limits_{(i,j)\in {M}_{k}}{P}_{\max }(i,\, j)$$\end{document}</tex-math><mml:math id="M26"><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where <italic>d</italic><sub>P-P</sub> denotes the distance between the atoms P; <italic>N</italic><sub><italic>bins</italic></sub> is the total number of distance bins (38 here), <italic>M</italic><sub><italic>k</italic></sub> is a collection of nucleotide pairs (<italic>i</italic>, <italic>j</italic>) (from <italic>S</italic>), for which the maximum probability of <italic>d</italic><sub>P-P</sub>, (i.e., <italic>P</italic><sub>max</sub>(<italic>i</italic>, <italic>j</italic>)), belongs to the <italic>k</italic><sup>th</sup> distance bin.</p></list-item><list-item><p id="Par64"><italic>std</italic>, the average standard deviations of the probability values for all nucleotide pairs.</p></list-item><list-item><p id="Par65"><italic>prop</italic>, the proportion of nucleotide pairs with <italic>P</italic>(<italic>d</italic><sub>P-P</sub> &lt; 40 Å) &gt; 0.45.</p></list-item></list></p>
      <p id="Par66">The RMSD is estimated based on linear regression over the above variables using hundreds of randomly selected RNAs from the training set.<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$eRMSD=0.64 \times pRMSD-189.43 \times std -4.01 \times mp-1.06 \times prop+15.2$$\end{document}</tex-math><mml:math id="M28"><mml:mi>e</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>0.64</mml:mn><mml:mo>×</mml:mo><mml:mi>p</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mo>−</mml:mo><mml:mn>189.43</mml:mn><mml:mo>×</mml:mo><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>4.01</mml:mn><mml:mo>×</mml:mo><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mn>1.06</mml:mn><mml:mo>×</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>15.2</mml:mn></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec25">
      <title>Statistics &amp; reproducibility</title>
      <p id="Par67">No statistical method was used to predetermine sample size. No data were excluded from the analyses. The experiments were not randomized. The Investigators were not blinded to allocation during experiments and outcome assessment.</p>
    </sec>
    <sec id="Sec26">
      <title>Reporting summary</title>
      <p id="Par68">Further information on research design is available in the <xref rid="MOESM3" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec27">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2023_42528_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2023_42528_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2023_42528_MOESM3_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
    <sec id="Sec28">
      <title>Source data</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2023_42528_MOESM4_ESM.xlsx">
            <caption>
              <p>Source Data</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Wenkai Wang, Chenjie Feng, Renmin Han.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-023-42528-4.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work is supported in part by the National Natural Science Foundation of China (NSFC T2225007 to J.Y., T2222012 to Z.P., and 61932018 to F.Z.), and the Foundation for Innovative Research Groups of State Key Laboratory of Microbial Technology (WZCX2021-03 to J.Y.).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>J.Y. conceptualized and administered the study. W.W. designed and implemented the network. C.F. and L.Y. implemented the energy minimization. Z.P. and F.Z. co-supervised the study. R.H., Z.W., Z.D., and H.W. prepared the training data. All authors revised and approved the final draft of the manuscript.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par69"><italic>Nature Communications</italic> thanks Rhiju Das and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. A peer review file is available.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The training sets, the set of 20 RNA-Puzzles RNAs, and the set of 30 independent RNAs can be downloaded from Zenodo<sup><xref ref-type="bibr" rid="CR51">51</xref></sup> and our website (<ext-link ext-link-type="uri" xlink:href="https://yanglab.qd.sdu.edu.cn/trRosettaRNA/">https://yanglab.qd.sdu.edu.cn/trRosettaRNA/</ext-link>). The RNAs from blind tests of CASP15 and RNA-Puzzles can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://predictioncenter.org/casp15/results.cgi?tr_type=rna">https://predictioncenter.org/casp15/results.cgi?tr_type=rna</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://www.rnapuzzles.org/results/">https://www.rnapuzzles.org/results/</ext-link>, respectively. The PDB entries mentioned in this study (<ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb3IVK/pdb">3IVK</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb5KH8/pdb">5KH8</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb5LYS/pdb">5LYS</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb6D89/pdb">6D89</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb7D7V/pdb">7D7V</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb8DP3/pdb">8DP3</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb8GXC/pdb">8GXC</ext-link>, and <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb8HB8/pdb">8HB8</ext-link>) were obtained by four-digit accession codes in the Protein Data Bank repository (<ext-link ext-link-type="uri" xlink:href="https://www.rcsb.org/">https://www.rcsb.org/</ext-link>). The sequence databases of NCBI’s nt, Rfam, and RNAcentral used to generate MSA in this study can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/nucleotide">https://www.ncbi.nlm.nih.gov/nucleotide</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://rfam.org/">https://rfam.org/</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://rnacentral.org/">https://rnacentral.org/</ext-link>, respectively. The source data underlying Tables <xref rid="MOESM4" ref-type="media">1</xref>, S<xref rid="MOESM4" ref-type="media">7</xref> and Figs. <xref rid="MOESM4" ref-type="media">4</xref>–<xref rid="MOESM4" ref-type="media">6</xref>, S<xref rid="MOESM4" ref-type="media">2</xref>, S<xref rid="MOESM4" ref-type="media">3</xref>, S<xref rid="MOESM4" ref-type="media">5</xref>, S<xref rid="MOESM4" ref-type="media">6</xref>, S<xref rid="MOESM4" ref-type="media">10</xref>, S<xref rid="MOESM4" ref-type="media">11</xref> are provided in the Source Data file. <xref ref-type="sec" rid="Sec28">Source data</xref> are provided with this paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The trRosettaRNA server and the standalone package are available at Zenodo<sup><xref ref-type="bibr" rid="CR51">51</xref></sup> and our website (<ext-link ext-link-type="uri" xlink:href="https://yanglab.qd.sdu.edu.cn/trRosettaRNA/">https://yanglab.qd.sdu.edu.cn/trRosettaRNA/</ext-link>).</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par70">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>QC</given-names>
          </name>
        </person-group>
        <article-title>Advances and opportunities in RNA structure experimental determination and computational modeling</article-title>
        <source>Nat. Methods</source>
        <year>2022</year>
        <volume>19</volume>
        <fpage>1193</fpage>
        <lpage>1207</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-022-01623-y</pub-id>
        <?supplied-pmid 36203019?>
        <pub-id pub-id-type="pmid">36203019</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berman</surname>
            <given-names>HM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Protein Data Bank</article-title>
        <source>Nucleic acids Res.</source>
        <year>2000</year>
        <volume>28</volume>
        <fpage>235</fpage>
        <lpage>242</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/28.1.235</pub-id>
        <?supplied-pmid 10592235?>
        <pub-id pub-id-type="pmid">10592235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rother</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rother</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Puton</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bujnicki</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>ModeRNA: a tool for comparative modeling of RNA 3D structure</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>4007</fpage>
        <lpage>4022</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq1320</pub-id>
        <?supplied-pmid 21300639?>
        <pub-id pub-id-type="pmid">21300639</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Flores, S. C., Wan, Y., Russell, R. &amp; Altman, R. B. Predicting RNA structure by multiple template homology modeling. <italic>Pac Symp Biocomput</italic>. <bold>2010</bold>, 216-227 (2009).</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Das</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Automated de novo prediction of native-like RNA tertiary structures</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2007</year>
        <volume>104</volume>
        <fpage>14664</fpage>
        <lpage>14669</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0703836104</pub-id>
        <?supplied-pmid 17726102?>
        <pub-id pub-id-type="pmid">17726102</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Das</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Karanicolas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Atomic accuracy in predicting and designing noncanonical RNA structure</article-title>
        <source>Nat. Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>291</fpage>
        <lpage>294</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1433</pub-id>
        <?supplied-pmid 20190761?>
        <pub-id pub-id-type="pmid">20190761</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Watkins</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Rangan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Das</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>FARFAR2: improved de novo rosetta prediction of complex global RNA folds</article-title>
        <source>Struct. (Lond., Engl.: 1993)</source>
        <year>2020</year>
        <volume>28</volume>
        <fpage>963</fpage>
        <lpage>976.e966</lpage>
        <pub-id pub-id-type="doi">10.1016/j.str.2020.05.011</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boniecki</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SimRNA: a coarse-grained method for RNA folding simulations and 3D structure prediction</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>e63</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1479</pub-id>
        <?supplied-pmid 26687716?>
        <pub-id pub-id-type="pmid">26687716</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sharma</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Dokholyan</surname>
            <given-names>NV</given-names>
          </name>
        </person-group>
        <article-title>iFoldRNA: three-dimensional RNA structure prediction and folding</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>1951</fpage>
        <lpage>1952</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn328</pub-id>
        <?supplied-pmid 18579566?>
        <pub-id pub-id-type="pmid">18579566</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Popenda</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated 3D structure composition for large RNAs</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>e112</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks339</pub-id>
        <?supplied-pmid 22539264?>
        <pub-id pub-id-type="pmid">22539264</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated and fast building of three-dimensional RNA structures</article-title>
        <source>Sci. Rep.</source>
        <year>2012</year>
        <volume>2</volume>
        <fpage>734</fpage>
        <pub-id pub-id-type="doi">10.1038/srep00734</pub-id>
        <pub-id pub-id-type="pmid">23071898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>3dRNA: 3D structure prediction from linear to circular RNAs</article-title>
        <source>J. Mol. Biol.</source>
        <year>2022</year>
        <volume>434</volume>
        <fpage>167452</fpage>
        <pub-id pub-id-type="doi">10.1016/j.jmb.2022.167452</pub-id>
        <?supplied-pmid 35662453?>
        <pub-id pub-id-type="pmid">35662453</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Leonardis</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Direct-coupling analysis of nucleotide coevolution facilitates RNA secondary and tertiary structure prediction</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>10444</fpage>
        <lpage>10455</lpage>
        <?supplied-pmid 26420827?>
        <pub-id pub-id-type="pmid">26420827</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cuturello</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Tiana</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bussi</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Assessing the accuracy of direct-coupling analysis for RNA contact prediction</article-title>
        <source>RNA</source>
        <year>2020</year>
        <volume>26</volume>
        <fpage>637</fpage>
        <lpage>647</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.074179.119</pub-id>
        <?supplied-pmid 32115426?>
        <pub-id pub-id-type="pmid">32115426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Optimization of RNA 3D structure prediction using evolutionary restraints of nucleotide-nucleotide interactions from direct coupling analysis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <fpage>6299</fpage>
        <lpage>6309</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx386</pub-id>
        <?supplied-pmid 28482022?>
        <pub-id pub-id-type="pmid">28482022</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Predicting RNA folding thermodynamics with a reduced chain representation model</article-title>
        <source>RNA</source>
        <year>2005</year>
        <volume>11</volume>
        <fpage>1884</fpage>
        <lpage>1897</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.2109105</pub-id>
        <?supplied-pmid 16251382?>
        <pub-id pub-id-type="pmid">16251382</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Vfold-Pipeline: a web server for RNA 3D structure prediction from sequences</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <fpage>4042</fpage>
        <lpage>4043</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac426</pub-id>
        <?supplied-pmid 35758624?>
        <pub-id pub-id-type="pmid">35758624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parisien</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Major</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>The MC-Fold and MC-Sym pipeline infers RNA structure from sequence data</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>452</volume>
        <fpage>51</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="doi">10.1038/nature06684</pub-id>
        <?supplied-pmid 18322526?>
        <pub-id pub-id-type="pmid">18322526</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cruz</surname>
            <given-names>JA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Puzzles: a CASP-like evaluation of RNA three-dimensional structure prediction</article-title>
        <source>RNA</source>
        <year>2012</year>
        <volume>18</volume>
        <fpage>610</fpage>
        <lpage>625</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.031054.111</pub-id>
        <?supplied-pmid 22361291?>
        <pub-id pub-id-type="pmid">22361291</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miao</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Puzzles Round IV: 3D structure predictions of four ribozymes and two aptamers</article-title>
        <source>RNA</source>
        <year>2020</year>
        <volume>26</volume>
        <fpage>982</fpage>
        <lpage>995</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.075341.120</pub-id>
        <?supplied-pmid 32371455?>
        <pub-id pub-id-type="pmid">32371455</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>RNA inter-nucleotide 3D closeness prediction by deep residual neural networks</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>1093</fpage>
        <lpage>1098</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa932</pub-id>
        <?supplied-pmid 33135062?>
        <pub-id pub-id-type="pmid">33135062</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Singh, J., Paliwal, K., Litfin, T., Singh, J. &amp; Zhou, Y. Predicting RNA distance-based contact maps by integrated deep learning on physics-inferred secondary structure and evolutionary-derived mutational coupling. <italic>Bioinformatics</italic><bold>38</bold>, 3900–3910 (2022).</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Townshend</surname>
            <given-names>RJL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Geometric deep learning of RNA structure</article-title>
        <source>Science</source>
        <year>2021</year>
        <volume>373</volume>
        <fpage>1047</fpage>
        <lpage>1051</lpage>
        <pub-id pub-id-type="doi">10.1126/science.abe5650</pub-id>
        <?supplied-pmid 34446608?>
        <pub-id pub-id-type="pmid">34446608</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jumper</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>596</volume>
        <fpage>583</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id>
        <?supplied-pmid 34265844?>
        <pub-id pub-id-type="pmid">34265844</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Pearce, R., Omenn, G. S. &amp; Zhang, Y. De Novo RNA Tertiary Structure Prediction at Atomic Resolution Using Geometric Potentials from Deep Learning. Preprint at <italic>bioRxiv</italic>, 2022.05.15.491755 (2022).</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Baek, M., McHugh, R., Anishchenko, I., Baker, D. &amp; DiMaio, F. Accurate prediction of nucleic acid and protein-nucleic acid complexes using RoseTTAFoldNA. Preprint at <italic>bioRxiv</italic>, 2022.09.09.507333 (2022).</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Shen, T. et al. E2Efold-3D: End-to-End Deep Learning Method for accurate de novo RNA 3D Structure Prediction. Preprint at <italic>arXiv e-prints</italic>, arXiv:2207.01586 (2022).</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved protein structure prediction using predicted interresidue orientations</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2020</year>
        <volume>117</volume>
        <fpage>1496</fpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1914677117</pub-id>
        <pub-id pub-id-type="pmid">31896580</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Du</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The trRosetta server for fast and accurate protein structure prediction</article-title>
        <source>Nat. Protoc.</source>
        <year>2021</year>
        <volume>16</volume>
        <fpage>5634</fpage>
        <lpage>5651</lpage>
        <pub-id pub-id-type="doi">10.1038/s41596-021-00628-9</pub-id>
        <?supplied-pmid 34759384?>
        <pub-id pub-id-type="pmid">34759384</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Su</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved Protein Structure Prediction Using a New Multi-Scale Network and Homologous Templates</article-title>
        <source>Adv. Sci. (Weinh.)</source>
        <year>2021</year>
        <volume>8</volume>
        <fpage>e2102592</fpage>
        <?supplied-pmid 34719864?>
        <pub-id pub-id-type="pmid">34719864</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pyle</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>rMSA: A sequence search and alignment algorithm to improve rna structure modeling</article-title>
        <source>J. Mol. Biol.</source>
        <year>2023</year>
        <volume>435</volume>
        <fpage>167904</fpage>
        <pub-id pub-id-type="doi">10.1016/j.jmb.2022.167904</pub-id>
        <?supplied-pmid 37356900?>
        <pub-id pub-id-type="pmid">37356900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Singh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hanson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Paliwal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>RNA secondary structure prediction using an ensemble of two-dimensional deep neural networks and transfer learning</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>5407</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-13395-9</pub-id>
        <?supplied-pmid 31776342?>
        <pub-id pub-id-type="pmid">31776342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Magnus</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Puzzles toolkit: a computational resource of RNA 3D structure benchmark datasets, structure manipulation, and evaluation tools</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2020</year>
        <volume>48</volume>
        <fpage>576</fpage>
        <lpage>588</lpage>
        <?supplied-pmid 31799609?>
        <pub-id pub-id-type="pmid">31799609</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parisien</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cruz</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Westhof</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Major</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>New metrics for comparing and assessing discrepancies between RNA 3D structures and models</article-title>
        <source>Rna</source>
        <year>2009</year>
        <volume>15</volume>
        <fpage>1875</fpage>
        <lpage>1885</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.1700409</pub-id>
        <pub-id pub-id-type="pmid">19710185</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Williams</surname>
            <given-names>CJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MolProbity: More and better reference data for improved all-atom structure validation</article-title>
        <source>Protein Sci.</source>
        <year>2018</year>
        <volume>27</volume>
        <fpage>293</fpage>
        <lpage>315</lpage>
        <pub-id pub-id-type="doi">10.1002/pro.3330</pub-id>
        <?supplied-pmid 29067766?>
        <pub-id pub-id-type="pmid">29067766</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Rhiju, D. et al. Assessment of three-dimensional RNA structure prediction in CASP15. Preprint at <italic>bioRxiv</italic>, 2023.2004.2025.538330 (2023).</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sweeney</surname>
            <given-names>BA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>R2DT is a framework for predicting and visualising RNA secondary structure using templates</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>3494</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-23555-5</pub-id>
        <?supplied-pmid 34108470?>
        <pub-id pub-id-type="pmid">34108470</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiong</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zhan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Pairing a high-resolution statistical potential with a nucleobase-centric sampling algorithm for improving RNA model refinement</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>2777</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-23100-4</pub-id>
        <?supplied-pmid 33986288?>
        <pub-id pub-id-type="pmid">33986288</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Chen, K., Zhou, Y., Wang, S. &amp; Xiong, P. RNA tertiary structure modeling with BRiQ potential in CASP15. <italic>Proteins: Structure, Function, and Bioinformatics</italic><bold>n/a</bold> (2023).</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mariani</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Biasini</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Barbato</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schwede</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>lDDT: a local superposition-free score for comparing protein structures and models using distance difference tests</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2722</fpage>
        <lpage>2728</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt473</pub-id>
        <pub-id pub-id-type="pmid">23986568</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kalvari</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rfam 14: expanded coverage of metagenomic, viral and microRNA families</article-title>
        <source>Nucleic Acids Res</source>
        <year>2021</year>
        <volume>49</volume>
        <fpage>D192</fpage>
        <lpage>D200</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa1047</pub-id>
        <pub-id pub-id-type="pmid">33211869</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gong</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>RNA-align: quick and accurate alignment of RNA 3D structures based on size-independent TM-scoreRNA</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>4459</fpage>
        <lpage>4461</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz282</pub-id>
        <?supplied-pmid 31161212?>
        <pub-id pub-id-type="pmid">31161212</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karniadakis</surname>
            <given-names>GE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Physics-informed machine learning</article-title>
        <source>Nat. Rev. Phys.</source>
        <year>2021</year>
        <volume>3</volume>
        <fpage>422</fpage>
        <lpage>440</lpage>
        <pub-id pub-id-type="doi">10.1038/s42254-021-00314-5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Consortium</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>RNAcentral 2021: secondary structure integration, improved sequence search and new member databases</article-title>
        <source>Nucleic Acids Res</source>
        <year>2021</year>
        <volume>49</volume>
        <fpage>D212</fpage>
        <lpage>D220</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa921</pub-id>
        <pub-id pub-id-type="pmid">33106848</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nawrocki</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Infernal 1.1: 100-fold faster RNA homology searches</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2933</fpage>
        <lpage>2935</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt509</pub-id>
        <pub-id pub-id-type="pmid">24008419</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>S-H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Res2net: A new multi-scale backbone architecture</article-title>
        <source>IEEE Trans. Pattern Anal. Mach. Intell.</source>
        <year>2019</year>
        <volume>43</volume>
        <fpage>652</fpage>
        <lpage>662</lpage>
        <pub-id pub-id-type="doi">10.1109/TPAMI.2019.2938758</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaudhury</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lyskov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gray</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>PyRosetta: a script-based interface for implementing molecular modeling algorithms using Rosetta</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>689</fpage>
        <lpage>691</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq007</pub-id>
        <?supplied-pmid 20061306?>
        <pub-id pub-id-type="pmid">20061306</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Godzik</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1658</fpage>
        <lpage>1659</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl158</pub-id>
        <?supplied-pmid 16731699?>
        <pub-id pub-id-type="pmid">16731699</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Danaee</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>bpRNA: large-scale automated annotation and analysis of RNA secondary structure</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>5381</fpage>
        <lpage>5394</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky285</pub-id>
        <?supplied-pmid 29746666?>
        <pub-id pub-id-type="pmid">29746666</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Du, Z., Peng, Z. &amp; Yang, J. Toward the assessment of predicted inter-residue distance. <italic>Bioinformatics</italic><bold>38</bold>, 962–969 (2022).</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Wenkai, W. et al. Source code and data for “trRosettaRNA: automated prediction of RNA 3D structure with transformer network”. <italic>Zenodo</italic><ext-link ext-link-type="uri" xlink:href="https://zenodo.org/doi/10.5281/zenodo.8362613">https://zenodo.org/doi/10.5281/zenodo.8362613</ext-link> (2023).</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kerpedjiev</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hammer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
        </person-group>
        <article-title>Forna (force-directed RNA): Simple and effective online RNA secondary structure diagrams</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>3377</fpage>
        <lpage>3379</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv372</pub-id>
        <?supplied-pmid 26099263?>
        <pub-id pub-id-type="pmid">26099263</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10636060</article-id>
    <article-id pub-id-type="pmid">37945552</article-id>
    <article-id pub-id-type="publisher-id">42528</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-023-42528-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>trRosettaRNA: automated prediction of RNA 3D structure with transformer network</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8603-8250</contrib-id>
        <name>
          <surname>Wang</surname>
          <given-names>Wenkai</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Feng</surname>
          <given-names>Chenjie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Han</surname>
          <given-names>Renmin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Ziyi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ye</surname>
          <given-names>Lisha</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Du</surname>
          <given-names>Zongyang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wei</surname>
          <given-names>Hong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2081-9369</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Fa</given-names>
        </name>
        <address>
          <email>zhangfa@ict.ac.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0303-6693</contrib-id>
        <name>
          <surname>Peng</surname>
          <given-names>Zhenling</given-names>
        </name>
        <address>
          <email>zhenling@email.sdu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2912-7737</contrib-id>
        <name>
          <surname>Yang</surname>
          <given-names>Jianyi</given-names>
        </name>
        <address>
          <email>yangjy@sdu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01y1kjr75</institution-id><institution-id institution-id-type="GRID">grid.216938.7</institution-id><institution-id institution-id-type="ISNI">0000 0000 9878 7032</institution-id><institution>School of Mathematical Sciences, </institution><institution>Nankai University, </institution></institution-wrap>Tianjin, 300071 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0207yh398</institution-id><institution-id institution-id-type="GRID">grid.27255.37</institution-id><institution-id institution-id-type="ISNI">0000 0004 1761 1174</institution-id><institution>MOE Frontiers Science Center for Nonlinear Expectations, Research Center for Mathematics and Interdisciplinary Sciences, </institution><institution>Shandong University, </institution></institution-wrap>Qingdao, 266237 China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02h8a1848</institution-id><institution-id institution-id-type="GRID">grid.412194.b</institution-id><institution-id institution-id-type="ISNI">0000 0004 1761 9803</institution-id><institution>School of Science, </institution><institution>Ningxia Medical University, </institution></institution-wrap>Yinchuan, 750004 China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01skt4w74</institution-id><institution-id institution-id-type="GRID">grid.43555.32</institution-id><institution-id institution-id-type="ISNI">0000 0000 8841 6246</institution-id><institution>School of Medical Technology, </institution><institution>Beijing Institute of Technology, </institution></institution-wrap>Beijing, 100081 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>9</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>7266</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">RNA 3D structure prediction is a long-standing challenge. Inspired by the recent breakthrough in protein structure prediction, we developed trRosettaRNA, an automated deep learning-based approach to RNA 3D structure prediction. The trRosettaRNA pipeline comprises two major steps: 1D and 2D geometries prediction by a transformer network; and 3D structure folding by energy minimization. Benchmark tests suggest that trRosettaRNA outperforms traditional automated methods. In the blind tests of the 15<sup>th</sup> Critical Assessment of Structure Prediction (CASP15) and the RNA-Puzzles experiments, the automated trRosettaRNA predictions for the natural RNAs are competitive with the top human predictions. trRosettaRNA also outperforms other deep learning-based methods in CASP15 when measured by the Z-score of the Root-Mean-Square Deviation. Nevertheless, it remains challenging to predict accurate structures for synthetic RNAs with an automated approach. We hope this work could be a good start toward solving the hard problem of RNA structure prediction with deep learning.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Here, authors develop trRosettaRNA, a deep learning-based approach for predicting RNA 3D structures. Blind tests demonstrate that the automated predictions compete effectively with top human predictions on natural RNAs.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Computational models</kwd>
      <kwd>Software</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Molecular modelling</kwd>
      <kwd>Molecular modelling</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Limited 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Ribonucleic acid (RNA) is one of the most important types of functional molecules in living cells. It is involved in many fundamental biological and cellular processes, for example, as the transcript of genetic information, serving catalytic, scaffolding, and structural functions. Interest in the structure and functions of non-coding RNA (ncRNA), such as transfer RNAs (tRNAs) and ribosomal RNAs (rRNAs), has been increasing over the past few decades with the discovery of new types of ncRNAs every year. Similar to proteins, ncRNA molecules’ biological function is typically determined by their 3D structures. However, due to the intrinsic structural heterogeneity caused by the flexible backbones and weak long-range tertiary interactions, it is more challenging to experimentally solve the structure of an RNA than a protein<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. For example, only ~6000 RNA structures are deposited in the Protein Data Bank (PDB)<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>, which is much less than the number of deposited protein structures (~190,000). Thus, there is a great demand for developing efficient algorithms to predict RNA 3D structures.</p>
    <p id="Par4">The current RNA 3D structure prediction methods can be divided into two groups: template-based methods and de novo methods. Template-based methods predict the target structure using homologous templates in PDB. For example, representative methods, such as ModeRNA<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> and MMB<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, work by reducing the sampling space with homologous structures. In general, the predicted structure models by template-based methods are accurate when homologous templates exist in PDB. However, the progress for template-based methods is slow, due to the limited number of known RNA structures and the difficulty of aligning RNA sequences.</p>
    <p id="Par5">On the contrary, de novo methods build 3D conformations by simulating the folding process from scratch. With molecular dynamic simulations and/or fragment assembly, methods such as FARNA<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>, FARFAR<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, FARFAR2<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, SimRNA<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, iFoldRNA<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, RNAComposer<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, and 3dRNA<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR12">12</xref></sup>, work well for certain small RNAs (&lt;100 nucleotides). Nevertheless, it is hard to generate accurate 3D structures for large RNAs with complicated topologies, due to the inaccurate force field parameters and the huge sampling space. To partly address this issue, inter-nucleotide contacts predicted by direct coupling analysis (DCA) have been used to guide the structure simulations<sup><xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR15">15</xref></sup>. In addition, given the hierarchical nature of RNA structure folding, a few methods derive 3D structures from secondary structures, such as Vfold<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup> and MC-Fold<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. They are very fast but the modeling accuracy largely depends on the quality of the input secondary structures. The RNA-Puzzles experiments indicate that it remains a grand challenge to accurately predict the structures for large RNAs with complex architectures<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>.</p>
    <p id="Par6">Deep learning has recently been used to improve de novo RNA 3D structure prediction. The predicted inter-nucleotide contacts by the residual convolutional network (ResNet) are about two times more accurate than DCA, improving 3D structure prediction to some extent<sup><xref ref-type="bibr" rid="CR21">21</xref>,<xref ref-type="bibr" rid="CR22">22</xref></sup>. It was shown that with the model selection from a geometric deep learning-based scoring system (ARES), the FARFAR2 protocol predicted the most accurate models for four targets in the blind test of the RNA-Puzzles experiments<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. Recently, inspired by the success of AlphaFold2<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>, a few new deep learning-based methods are developed, such as DeepFoldRNA<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, RoseTTAFoldNA<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, and RhoFold<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>.</p>
    <p id="Par7">In this work, we introduce trRosettaRNA, an automated deep learning-based approach to RNA 3D structure prediction. It is partly inspired by the successful application of deep learning in protein structure prediction, especially in AlphaFold2<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> and our previous method trRosetta<sup><xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref></sup>. Benchmark tests and blind tests show that trRosettaRNA is promising to enhance RNA structure prediction. The server and source codes are available at: <ext-link ext-link-type="uri" xlink:href="https://yanglab.qd.sdu.edu.cn/trRosettaRNA">https://yanglab.qd.sdu.edu.cn/trRosettaRNA</ext-link>.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview of trRosettaRNA</title>
      <p id="Par8">The architecture of trRosettaRNA is depicted in Fig. <xref rid="Fig1" ref-type="fig">1a</xref>. Starting from the nucleotide sequence of an RNA of interest, a multiple sequence alignment (MSA) and a secondary structure are first generated by the programs rMSA<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> and SPOT-RNA<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>, respectively. They are then converted into an MSA representation and a pair representation, which are fed into a transformer network (named RNAformer, see Fig. <xref rid="Fig1" ref-type="fig">1b</xref> and Methods for more details) to predict 1D and 2D geometries (see Fig. <xref rid="MOESM1" ref-type="media">S1</xref>). Similar to trRosetta, these geometries are converted into restraints to guide the final step of 3D structure folding based on energy minimization (see Methods). Unless otherwise specified, the RMSDs mentioned below are calculated by considering all atoms using the evaluation toolkit provided by the RNA-Puzzles community<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>.<fig id="Fig1"><label>Fig. 1</label><caption><title>Overall architecture of trRosettaRNA.</title><p><bold>a</bold> flowchart of trRosettaRNA. <bold>b</bold> structure of each RNAformer block. <italic>n</italic>, <italic>L</italic>, and <italic>c</italic> are the number of sequences in the MSA, the length of the query sequence, and the number of channels, respectively.</p></caption><graphic xlink:href="41467_2023_42528_Fig1_HTML" id="d32e511"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Performance of trRosettaRNA on 30 independent RNAs</title>
      <p id="Par9">To evaluate trRosettaRNA, we collected 30 non-redundant RNA structures based on both release date and similarity with the training RNAs. These RNAs are released after the training RNAs date (i.e., 2017-01) and do not share sequence similarity with trRosettaRNA and SPOT-RNA’s training RNAs (see Methods).</p>
      <p id="Par10">We compare trRosettaRNA with two representative methods, RNAComposer<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> and SimRNA<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. The same secondary structures (from SPOT-RNA) were fed into both methods for fair comparison. For RNAComposer, we submitted the RNA sequences and the predicted secondary structures to its web server to generate 3D models. SimRNA was installed and run locally in our computer cluster. We evaluate the first predicted model to ensure fairness. As shown in Table <xref rid="Tab1" ref-type="table">1</xref>, on these 30 RNAs, the average RMSD by trRosettaRNA (8.5 Å) is significantly lower than those by RNAComposer (17.4 Å; <italic>P</italic>-value = 1.3E-6) and SimRNA (17.1 Å; <italic>P</italic>-value = 1.1E-7; the <italic>P</italic>-values presented in this manuscript were calculated by two-tailed Student’s <italic>t</italic>-tests). trRosettaRNA outperforms RNAComposer and SimRNA for 86.7% and 96.7% of the 30 cases, respectively (Fig. <xref rid="MOESM1" ref-type="media">S2a</xref>). 20% of the models predicted by trRosettaRNA are with RMSD &lt; 4 Å, whereas no models from RNAComposer and SimRNA can achieve this accuracy. These data demonstrate the superiority of the proposed pipeline over traditional RNA structure prediction methods.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison between trRosettaRNA, SimRNA, and RNAComposer on 30 independent RNAs</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Methods</th><th>Average RMSD (±std.) (Å)</th><th>Ratio of accurate models (RMSD &lt; 4 Å)</th><th><italic>P</italic>-value</th></tr></thead><tbody><tr><td>SimRNA</td><td>17.1 ( ± 5.2)</td><td>0%</td><td>1.1E-7</td></tr><tr><td>RNAComposer</td><td>17.4 ( ± 6.8)</td><td>0%</td><td>1.3E-6</td></tr><tr><td>trRosettaRNA</td><td>8.5 ( ± 5.7)</td><td>20%</td><td>-</td></tr></tbody></table><table-wrap-foot><p>Please note that the evaluation here is on the first model predicted by each method. The <italic>P</italic>-values presented here were calculated by two-tailed Student’s <italic>t</italic>-tests. No adjustments were made for multiple comparisons. Source data are provided as a Source Data file.</p></table-wrap-foot></table-wrap></p>
      <p id="Par11">We further analyze the impact of the input features (i.e., MSA and secondary structure). The MSA quality is measured by the alignment depth, i.e., the logarithm of the effective number (denoted by log(<italic>N</italic><sub><italic>eff</italic></sub>)) of homologous sequences with &lt;80% sequence identity. As shown in Fig. <xref rid="MOESM1" ref-type="media">S2b</xref>, the RMSD of the trRosettaRNA model is correlated with log(<italic>N</italic><sub><italic>eff</italic></sub>) (Pearson correlation coefficient, PCC = −0.32). trRosettaRNA outperforms RNAComposer and SimRNA at all log(<italic>N</italic><sub><italic>eff</italic></sub>) levels, especially on targets with high log(<italic>N</italic><sub><italic>eff</italic></sub>) values. For the models by RNAComposer and SimRNA, the correlations between the RMSDs and the alignment depth are weak (PCCs are −0.05 and 0.21, respectively), probably because they do not use MSA during modeling. In contrast, there is a stronger correlation between the RMSDs of the predicted models and the accuracy of the predicted secondary structures (measured by F1-score) for all methods (PCCs are −0.35, −0.31, and −0.29 for trRosettaRNA, SimRNA, and RNAComposer, respectively, Fig. <xref rid="MOESM1" ref-type="media">S2c</xref>). This is consistent with the observations that precise RNA secondary structure prediction plays a key role in successful 3D structure modeling<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>.</p>
      <p id="Par12">To provide a more direct demonstration of the contribution of MSA to the RNA structure prediction, we also evaluate the performance of trRosettaRNA when MSAs are excluded. As shown in Fig. <xref rid="MOESM1" ref-type="media">S3</xref>, for 21 out of the 30 RNAs, the introduction of MSAs helps improve the accuracy of the predicted models. Fig. <xref rid="MOESM1" ref-type="media">S4</xref> presents the MSAs for two example RNAs (PDB IDs: <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb5KH8/pdb">5KH8</ext-link>/<ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb7D7V/pdb">7D7V</ext-link>). The coevolutionary information extracted from these MSAs not only covers the majority of 2D base-pairing interactions but also encompasses some 3D interactions (highlighted by green circles in the 2D maps of Fig. <xref rid="MOESM1" ref-type="media">S4</xref>). With the assistance of MSAs, trRosettaRNA can generate more accurate models for these two RNAs (refer to the bottom right of each subfigure in Fig. <xref rid="MOESM1" ref-type="media">S4</xref>).</p>
      <p id="Par13">As the secondary structure used in trRosettaRNA is predicted by SPOT-RNA, it is important to consider the possibility of inaccurate predictions by SPOT-RNA. Among the 30 RNAs in the dataset, there are 8 RNAs for which SPOT-RNA failed to predict accurate secondary structures (i.e., F1-score &lt;0.5). Table <xref rid="MOESM1" ref-type="media">S1</xref> reveals that for 6 of these 8 RNAs, the secondary structures of trRosettaRNA models are more accurate than those predicted by SPOT-RNA. In Fig. <xref rid="MOESM1" ref-type="media">S5a</xref>, it is evident that trRosettaRNA corrects certain false positive base pairs, which are highlighted by red circles. Furthermore, trRosettaRNA identifies some interactions that were missed by SPOT-RNA, as indicated by the green circles in Fig. <xref rid="MOESM1" ref-type="media">S5a</xref>. These observations suggest that trRosettaRNA can correct incomplete or inaccurate secondary structures, although its accuracy is correlated with the quality of the input secondary structures.</p>
      <p id="Par14">Nevertheless, when considering the entire set of 30 RNAs, trRosettaRNA exhibits a slight drop in the average F1-score of secondary structures, decreasing it from 0.65 to 0.6 (as shown in Fig. <xref rid="MOESM1" ref-type="media">S5b</xref>). This decrease is mainly from the cases where the secondary structures predicted by SPOT-RNA are accurate (F1-score &gt; 0.6). This may be caused by the potential conflicts between the predicted distance restraints and the base pair restraints, which are not trival to resolve, especially for targets modeled with low confidence.</p>
      <p id="Par15">However, as a data-driven method, the performance of trRosettaRNA is influenced by the structural homology existing between the target RNA and previously solved RNA structures, which is measured by the maximum TM-score<sub>RNA</sub>. As shown in Fig. <xref rid="MOESM1" ref-type="media">S2d</xref>, the correlation between the structural homology and the RMSD of trRosettaRNA models is stronger compared to SimRNA and RNAComposer (PCCs are −0.6, −0.0003, and −0.05, respectively). For five RNAs lacking homolog match (i.e., maximum TM-score<sub>RNA</sub> with solved RNAs below 0.45), the average RMSD of trRosettaRNA models is 15.8 Å. This value significantly drops to 7.0 Å for the remaining 25 RNAs possessing structural homologs. This discrepancy may be due to the current limitation in the number of solved RNA structures within the PDB database, which in turn impacts the performance of data-driven methods on RNAs with novel structures. Nevertheless, for the 5 RNAs without structural homologs, the average RMSD of the models by trRosettaRNA (15.8 Å) remains lower than SimRNA (20.6 Å) and RNAComposer (24.3 Å), illustrating the superiority of the deep-learning method over traditional methods for automated prediction.</p>
    </sec>
    <sec id="Sec5">
      <title>Performance of trRosettaRNA on RNA-Puzzles targets</title>
      <p id="Par16">We further test trRosettaRNA on 20 targets from the RNA-Puzzles experiments<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>. The target information and the prediction results are summarized in Tables <xref rid="MOESM1" ref-type="media">S2</xref> and <xref rid="MOESM1" ref-type="media">S3</xref>, respectively. It turns out that these targets are harder to predict than the 30 independent RNAs, as revealed by the increased value of RMSD (from 8.5 Å to 10.5 Å).</p>
      <p id="Par17">We compare the trRosettaRNA predictions with the original submissions from the RNA-Puzzles experiments. According to the official assessments<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>, the most accurate approach is the Das group, which submitted models for 17 targets. Table <xref rid="MOESM1" ref-type="media">S3</xref> summarizes the results on these targets for the models from the Das group (denoted by Das) and the best of the models from all groups (denoted by PZ_best). On these 17 targets, the average RMSD of the first predicted models by our method is 10.3 Å, compared with 9.3 Å and 7.2 Å from Das and PZ_best, respectively. For 9 of the 17 targets, the trRosettaRNA models are more accurate than the Das models. Similar observations can be obtained when all the five submitted models are assessed (Table <xref rid="MOESM1" ref-type="media">S3</xref>). Note that certain participating groups may utilize human experts and/or literature data to guide the modeling during the prediction seasons of the RNA-Puzzles experiments. In contrast, the trRosettaRNA predictions, which are fully automated, achieve similar accuracy to the top human groups.</p>
      <p id="Par18">To obtain a more comprehensive understanding of the quality of trRosettaRNA models, we employ other evaluation measures used in the RNA-Puzzles assessment, in addition to RMSD (Table <xref rid="MOESM1" ref-type="media">S4</xref>). These measures include the deformation index (DI; evaluating the predicted structures with both RMSDs and base interactions; lower is better)<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>, the Interaction Network Fidelity (INF; evaluating the interactions in the predicted structure; higher is better)<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>, and MolProbity clash scores (number of serious steric overlaps per 1000 atoms in a structure; lower is better)<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. The average clash score of the trRosettaRNA models (3.2) is significantly lower than that of the Das models (10.8), indicating that trRosettaRNA not only achieves higher accuracy but also produces higher-quality models. Nevertheless, trRosettaRNA models exhibit worse INF and DI scores than the Das models. This can be explained by the inherent features of our methodology. First, the secondary structures used by trRosettaRNA are predicted rather than from experiments, literature, or human annotation. These predicted secondary structures may provide inaccurate interaction information to the transformer network. Second, trRosettaRNA uses predicted geometry restraints rather than fragment assembly to derive the secondary structures. Both factors may lead to less accurate local base-base interactions in the trRosettaRNA models.</p>
    </sec>
    <sec id="Sec6">
      <title>Blind test in CASP15</title>
      <p id="Par19">Based on trRosettaRNA, we participated in the blind test of the CASP15 experiment on RNA structure prediction as an automated server (group name Yang-Server). The Yang-Server models for the 12 CASP15 RNAs are shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. According to the official ranking, Yang-Server is ranked the 9<sup>th</sup> out of 42 RNA structure prediction groups (including 33 human groups and 9 server groups). Yang-Server is ranked second (after the UltraFold_Server) when considering automated server groups only. Note that the official ranking considers both global and local accuracy, including TM-score<sub>RNA</sub>, GDT-TS score, INF, lDDT, and steric clash; while the main objective optimized in trRosettaRNA is RMSD. Based on the cumulative Z-score of RMSD ( &gt; 0.0), Yang-Server’s ranking is improved: 5<sup>th</sup>/42 for all groups and 1<sup>st</sup>/9 for server groups (Fig. <xref rid="MOESM1" ref-type="media">S6</xref>). Yang-Server also achieves a higher ranking than other deep learning-based groups such as AIchemy_RNA (based on RhoFold<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>), BAKER (based on RoseTTAFoldNA<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>), and DF_RNA (based on DeepFoldRNA<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>) in terms of the Z-score of RMSD. According to the RNA-Puzzles assessment<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>, the Yang-Server predictions (though not perfect) for two protein-binding targets (R1189 and R1190) are the most accurate among all submitted models (with RMSDs of 16.3 Å and 16.0 Å, respectively). This result demonstrates the potential of our method in predicting protein-binding RNAs even in the absence of binding partner information, though the accuracy is far from satisfactory.<fig id="Fig2"><label>Fig. 2</label><caption><title>Yang-Server models (red) versus experimental structures (gray) for 12 CASP15 targets.</title><p>Consistent with Table <xref rid="Tab2" ref-type="table">2</xref>, the best-submitted models are shown here. The 3D structures are presented using PyMOL.</p></caption><graphic xlink:href="41467_2023_42528_Fig2_HTML" id="d32e818"/></fig></p>
      <p id="Par20">The 12 RNAs in CASP15 can be classified into two categories based on their sources: eight of them are natural, while the remaining four are synthetic. On the eight natural RNAs, Yang-Server yields comparable results to the top human group, AIchemy_RNA2 (mean RMSDs of the first/best in five models: 14.8/12.9 Å versus 15.7/11.3 Å; Table <xref rid="Tab2" ref-type="table">2</xref> and S<xref rid="MOESM1" ref-type="media">5</xref>). It is worth noting that trRosettaRNA does not consider structural templates, which may be crucial in improving the modeling accuracy. For example, for the targets, R1107, R1108, and R1149, secondary structure templates can be easily found in the RFAM database (version 14.4, released in December 2020) using an automated process<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. With these secondary structure templates, trRosettaRNA predicts much more accurate 3D structures than the models submitted during the CASP15 season (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). The RMSD values are reduced from 17.9 Å, 9.1 Å, and 13.9 Å to 4.3 Å, 4.8 Å, and 10.6 Å, for R1107, R1108, and R1149, respectively, competitive to the models by AIchemy_RNA2 (i.e., 4.5 Å, 4.5 Å, and 10.5 Å). Thus we believe that the fusion of high-quality secondary structure templates and deep-learning techniques can improve the performance further.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Results for 12 RNA targets in CASP15</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">Target type</th><th rowspan="2">Target ID</th><th colspan="6">RMSD (Å)</th></tr><tr><th>Yang-Server</th><th>AIchemy_RNA2</th><th>Chen</th><th>RNApolis</th><th>Deep learning best<sup>a</sup></th><th>Overall best</th></tr></thead><tbody><tr><td rowspan="9">Natural</td><td>R1107</td><td>17.9 (4.3<sup>b</sup>)</td><td>4.5</td><td>6.5</td><td>8.8</td><td>5.9</td><td>4.5</td></tr><tr><td>R1108</td><td>9.1 (4.8<sup>b</sup>)</td><td>4.5</td><td>6.0</td><td>8.5</td><td>4.8</td><td>4.5</td></tr><tr><td>R1116</td><td>10.9</td><td>17.3</td><td>18.0</td><td>12.7</td><td>7.9</td><td>4.8</td></tr><tr><td>R1117</td><td>2.7</td><td>2.3</td><td>2.0</td><td>2.7</td><td>2.7</td><td>2.0</td></tr><tr><td>R1149</td><td>13.9 (10.6<sup>b</sup>)</td><td>10.5</td><td>14.0</td><td>18.2</td><td>6.9</td><td>6.9</td></tr><tr><td>R1156</td><td>16.6</td><td>7.6</td><td>11.0</td><td>17.1</td><td>12.9</td><td>5.4</td></tr><tr><td>R1189</td><td>16.3</td><td>22.0</td><td>21.2</td><td>18.7</td><td>22.8</td><td>16.3</td></tr><tr><td>R1190</td><td>16.0</td><td>22.0</td><td>18.8</td><td>22.4</td><td>22.2</td><td>16.0</td></tr><tr><td>Average</td><td>12.9 (10.3<sup>b</sup>)</td><td>11.3</td><td>12.2</td><td>13.6</td><td>10.8</td><td>7.5</td></tr><tr><td rowspan="5">Synthetic</td><td>R1126</td><td>32.7</td><td>8.8</td><td>12.6</td><td>20.0</td><td>30.2</td><td>8.9</td></tr><tr><td>R1128</td><td>22.3</td><td>4.3</td><td>6.7</td><td>14.6</td><td>14.3</td><td>4.3</td></tr><tr><td>R1136</td><td>41.6</td><td>7.3</td><td>10.9</td><td>11.0</td><td>27.3</td><td>7.2</td></tr><tr><td>R1138</td><td>40.8</td><td>7.8</td><td>12.3</td><td>9.6</td><td>35.5</td><td>7.8</td></tr><tr><td>Average</td><td>34.4</td><td>7.0</td><td>10.6</td><td>13.8</td><td>26.8</td><td>7.0</td></tr><tr><td colspan="2">Overall average</td><td>20.1 (18.3<sup>b</sup>)</td><td>9.9</td><td>11.2</td><td>13.7</td><td>16.1</td><td>7.4</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>According to the CASP15 abstracts, there are 14 RNA prediction groups utilizing deep learning-based methods to predict RNA structures.</p><p><sup>b</sup>trRosettaRNA results with secondary structure templates as inputs.</p><p>For all compared groups, we evaluate their best-submitted models for each target. The evaluation based on the first predicted model is shown in Table <xref rid="MOESM1" ref-type="media">S5</xref>.</p></table-wrap-foot></table-wrap><fig id="Fig3"><label>Fig. 3</label><caption><title>Results for three targets from CASP15 for which the template secondary structures can be found in the Rfam database.</title><p>The RNA secondary structure visualization was employed with forna<sup><xref ref-type="bibr" rid="CR52">52</xref></sup>. The template search and 2D structure modelling were employed with R2DT program<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. For the 3D modelling results, we present the best model submitted by Yang-Server (in red), the trRosettaRNA model based on 2D templates (in blue) and the AIchemy_RNA2 best model (in green). Both predicted 3D structures are superimposed onto the experimental structures (gray). For Yang-Server models, the RMSD and eRMSD values are shown in SPOT-RNA-based/R2DT-based format.</p></caption><graphic xlink:href="41467_2023_42528_Fig3_HTML" id="d32e1267"/></fig></p>
      <p id="Par21">Nevertheless, when it comes to the modeling of synthetic RNAs, there is a notable margin between all the deep learning-based groups (including ours) and the top human groups such as AIchemy_RNA2 (the bottom half of Tables <xref rid="Tab2" ref-type="table">2</xref> and S<xref rid="MOESM1" ref-type="media">5</xref>). Note that the top groups for these targets are all based on human-intervented simulations rather than automated modeling. For example, the leading group AIchemy_RNA2 model predicted RNA structure based on the assembly of manually-detected RNA structural motifs followed by full atom optimization with the BRiQ statistical potential<sup><xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup>.</p>
      <p id="Par22">The challenge in the automated structure prediction of synthetic RNAs may be explained by a few factors. First, the deep learning-based approach may be biased towards the limited training data, which are mainly from natural RNAs. The synthetic RNAs lack globally homologous RNA sequences and similar structures to the existing RNAs (the maximum TM-score<sub>RNA</sub> is around 0.3), which may hinder the neural networks from inferring meaning predictions. Second, the human groups were given a three-week deadline for each target, allowing the elaborate human-expert interventions in the modeling procedure. In contrast, the Yang-Server predictions for each target were generated automatically in three days. As a fair comparison, we run the SimRNA package and RNAComposer server with the same secondary structures used by Yang-Server as inputs. The results show no superiority to the Yang-Server models (Fig. <xref rid="MOESM1" ref-type="media">S7</xref>). This highlights the inherent challenge in automated modeling for these synthetic RNAs, which applies to both conventional and deep learning-based methods.</p>
      <p id="Par23">For example, R1138 contains a few helix hinges and kissing loops, which play important roles in the folding of the overall structure. While the automated methods successfully establish satisfactory local interaction networks (with INF value of ~0.7), the predicted models still deviate significantly from the experimental structure when considering the global 3D topologies (Fig. <xref rid="MOESM1" ref-type="media">S8b</xref>). Accurately predicting the kissing loops (such as the one highlighted by the black circle) and the helix hinges in R1138 poses a significant challenge for automated methods, despite the recurrence of these motifs across numerous RNA structures. To illustrate, trRosettaRNA correctly predicted the highlighted kissing loop (highlighted by the black circle on the predicted distance map in Fig. <xref rid="MOESM1" ref-type="media">S9b</xref>). Utilizing this limited set of distance restraints, trRosettaRNA can successfully generate an accurate structure of the kissing loop (Fig. <xref rid="MOESM1" ref-type="media">S9a</xref>). However, this particular kissing loop was not predicted correctly when modeling the structure globally, probably due to the complicated interactions between other motifs (Fig. <xref rid="MOESM1" ref-type="media">S9c</xref>). This reflects the modeling difficulty of such synthetic RNA by automated approaches. As mentioned by AIchemy_RNA2, the accurate modeling of these synthetic RNAs requires extensive human-expert interventions, involving template detection, secondary structure determination, motif assignment, and more<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>.</p>
      <p id="Par24">As the primary focus of our method is to optimize the global RMSD, it is also worthwhile to investigate other metrics (Table <xref rid="MOESM1" ref-type="media">S6</xref>). In addition to the INF and MolProbity clash score mentioned above, we also evaluate the Local Distance Difference Test (lDDT<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>) score, which measures the local inter-residue distance error and has been widely used to evaluate protein structure models. In terms of the two local metrics (INF and lDDT), the Yang-Server models show a notable margin with AIchemy_RNA2 for both natural and synthetic RNAs. This discrepancy can be attributed to the reasons mentioned earlier, namely, the inaccurate input secondary structures and the methodological differences between the two approaches (deep learning-based versus fragment assembly-based). The integration of local fragment segments and deep-learning techniques is promising for bridging this gap in the future.</p>
      <p id="Par25">During CASP15, our method did not consider steric clashes in modeling, resulting in high clash scores (&gt;20) for our submitted models. This might impact our official ranking which considers both modeling accuracy and steric clashes. According to the CASP15 assessments<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>, Yang-Server is ranked 26<sup>th</sup> out of the 42 groups in terms of clash score, worse than AIchemy_RNA and BAKER. We addressed this issue after CASP15 by implementing an additional refining step at the end of the energy minimization procedure. Consequently, the average clash score of the 12 CASP15 targets dropped significantly from 33.84 to 3.05, which is much lower than that of AIchemy_RNA2 (16.68).</p>
    </sec>
    <sec id="Sec7">
      <title>Blind test on the latest RNA-Puzzles targets</title>
      <p id="Par26">In addition to our participation in CASP15, we also took part in the blind tests of three RNA-Puzzles targets as an automated server group named Yang. These targets include PZ37 (PDB ID: <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb8GXC/pdb">8GXC</ext-link>; a ligand-binding dimer), PZ38 (PDB ID: <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb8HB8/pdb">8HB8</ext-link>; a ligand-binding riboswitch), and PZ39 (PDB ID: <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb8DP3/pdb">8DP3</ext-link>; a protein-binding cloverleaf RNA). The results are summarized in Fig. <xref rid="Fig4" ref-type="fig">4a, b</xref>.<fig id="Fig4"><label>Fig. 4</label><caption><title>Blind test results and comparison with other deep learning-based methods.</title><p><bold>a</bold>, <bold>b</bold> blind test results on the latest three targets from RNA-Puzzles. <bold>a</bold> RMSD comparison of the models submitted by Yang group and models from other groups. <bold>b</bold> the best models submitted by Yang group (red) superposed to the experimental structures (gray). <bold>c</bold> head-to-head RMSD comparison between trRosettaRNA and other deep learning-based methods (<italic>n</italic> = 15 RNAs from the blind tests of CASP15 and RNA-Puzzles). The dashed horizontal and vertical lines correspond to an RMSD of 4 Å. The bar plots show the RMSD distributions. The red circles highlight the two cases (R1107 and R1108) in which trRosettaRNA can achieve better results with improved secondary structures. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_42528_Fig4_HTML" id="d32e1377"/></fig></p>
      <p id="Par27">In the case of PZ37/PZ38, our results (RMSD 10.3 Å/8.7 Å) are highly competitive, ranking at 3/3 out of 16/15 participating groups, and only surpassed by the human groups Chen and Szachniuk. It is worth noting that our predictions were fully automated and did not consider the ligand or dimer information, making our results impressive. However, we notice that the first model chosen for PZ38 is the worst among the five submitted models, with an RMSD of 14.4 Å, compared to 8.7 Å of the best model. This reflects that while trRosettaRNA exhibits the capability to produce models with commendable accuracy, there remains potential for model ranking.</p>
      <p id="Par28">For the target PZ39, the RMSD of our models are higher than 15 Å. PZ39 has no similar sequence (according to BLASTN search at an e-value cutoff of 10) nor similar structure (according to TM-score<sub>RNA</sub> &gt; 0.45) from the known RNAs. This may account for the poor performance of our method on this target. Nonetheless, local motif templates can be found for this RNA. For example, for the fragment consisting of residues 20 to 26 which forms the Fab binding site, it is easy to identify the same fragments in known Fab-binding RNAs (e.g., in PDB IDs: <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb6DB9/pdb">6DB9</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb3IVK/pdb">3IVK</ext-link>). Given the limited data of available RNA 3D structure, a promising approach to improving may be based on the combination of deep learning with conventional physics-based and/or fragment assembly-based methods.</p>
    </sec>
    <sec id="Sec8">
      <title>Comparison with other deep learning-based methods</title>
      <p id="Par29">During the preparation of this manuscript, another three deep learning-based approaches (DeepFoldRNA, RoseTTAFoldNA, and RhoFold) were posted. As mentioned above, trRosettaRNA achieves a higher summed Z-score of RMSD than these methods in the blind test of the CASP15 competition. We further conducted head-to-head comparisons between these methods on RNAs from the blind tests (CASP15 and RNA-Puzzles). For each target from blind tests, we used the result of the first submitted models if available; otherwise, we ran the program locally to predict the structure model.</p>
      <p id="Par30">The results show that trRosettaRNA achieves a 3.3/2.1 Å lower RMSD than DeepFoldRNA/RoseTTAFoldNA (orange/purple points in Fig. <xref rid="Fig4" ref-type="fig">4c</xref>) on the 15 RNAs from the blind tests. For 11/9 out of these 15 RNAs, the trRosettaRNA predictions are more accurate than those by DeepFoldRNA/RoseTTAFoldNA. The average RMSD of trRosettaRNA models (21.3 Å) is marginally higher than RhoFold models (20.6 Å; P-value = 0.9; blue points in Fig. <xref rid="Fig4" ref-type="fig">4c</xref>), which is inconsistent with the comparison based on the Z-score of RMSD (i.e., Fig. <xref rid="MOESM1" ref-type="media">S6</xref>). This slight difference is mainly due to the poor performance of trRosettaRNA on two CASP15 RNAs (17.9 Å for R1107 and 9.1 Å for R1108; compared to 5.9 Å and 5.4 Å for RhoFold, respectively; highlighted by red circle in Fig. <xref rid="Fig4" ref-type="fig">4c</xref>). As mentioned above (see also Fig. <xref rid="Fig3" ref-type="fig">3</xref>), this performance gap can be effectively bridged by employing more confident secondary structures as inputs. For the remaining 13 RNAs, the average RMSD of trRosettaRNA (22.5 Å) is slightly lower than RhoFold (22.9 Å). Moreover, trRosettaRNA outperforms RhoFold for 8 out of the remaining 13 RNAs.</p>
      <p id="Par31">To summarize, trRosettaRNA outperforms DeepFoldRNA and RoseTTAFoldNA, and is competitive with RhoFold in blind tests, highlighting its robustness.</p>
    </sec>
    <sec id="Sec9">
      <title>Impact of the predicted 1D and 2D geometries</title>
      <p id="Par32">The geometries predicted by the RNAformer network consist of 1D orientations and 2D contacts, distances, and orientations (Fig. <xref rid="MOESM1" ref-type="media">S1</xref>). To analyze their contributions, we compare the modeling results using different geometries on the 30 RNA-Puzzles targets (Fig. <xref rid="Fig5" ref-type="fig">5a</xref> and Table <xref rid="MOESM1" ref-type="media">S7</xref>). Using the 2D distance restraints only, trRosettaRNA achieves a reasonable RMSD of 11.34 Å. This value is reduced to 10.79 Å when the 1D and 2D orientations are included. Furthermore, with the help of 2D contacts, the RMSD drops to 10.51 Å. We use the target PZ11 (PDB ID: <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb5LYS/pdb">5LYS</ext-link>) to show the impacts of different restraints. As shown in Fig. <xref rid="Fig5" ref-type="fig">5b</xref>, using 2D distance restraints only, trRosettaRNA can generate a structure model with an RMSD of 10.5 Å. However, the helix at the 5’-end and 3’-end (highlighted by the green square in Fig. <xref rid="Fig5" ref-type="fig">5b</xref>) is wrongly twisted. The introduction of 1D and 2D orientations fixes the wrong twist of this region. The 2D contact restraints further refine the structure, resulting in a more accurate model with 6.7 Å RMSD.<fig id="Fig5"><label>Fig. 5</label><caption><title>Summary of the folding results by different restraints.</title><p><bold>a</bold> contribution of the various restraints to the trRosettaRNA modeling accuracy in terms of the RMSD for the 20 RNA-Puzzles targets (<italic>n</italic> = 20 RNAs). <bold>b</bold> an example (PZ11) to illustrate the impact of different restraints. The predicted models (red cartoon) are superposed to the experimental structures (gray cartoon). The green square highlights the helix region which is influenced by the introduction of more restraints. <bold>c</bold> head-to-head comparison between the estimated and real RMSD for all RNAs in the benchmark datasets (<italic>n</italic> = 50 RNAs). <bold>d</bold> the relationship between the running time and the sequence length on 1752 Rfam families. The 2D geometry predictions (orange dots) were run on one GPU card. The 3D structure folding was performed on one CPU core. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_42528_Fig5_HTML" id="d32e1472"/></fig></p>
    </sec>
    <sec id="Sec10">
      <title>Confidence score of the predicted structure models</title>
      <p id="Par33">To guide real-world application, the confidence scores of the predicted protein structure models have been estimated reliably in trRosetta<sup><xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref></sup>. A similar estimation can be extended to trRosettaRNA. Specifically, we first calculate a few variables reflecting the confidence of the predicted distance maps and the convergence of the first structure models (see Methods for more details). Then a linear regression on these variables is employed to fit the RMSD values. For the RNAs from the benchmark datasets, the estimated RMSDs (eRMSDs) correlate well with the real RMSDs of the predicted models (PCC = 0.56, Fig. <xref rid="Fig5" ref-type="fig">5c</xref>). Moreover, the eRMSD metric also roughly reflects the modeling difficulty for the 12 CASP15 targets, with an average value of 17.2 Å.</p>
      <p id="Par34">As a practical application, for the three CASP15 RNAs (R1107, R1108, and R1149) with reliable secondary structure templates, the defined eRMSD effectively captures the improvements from the introduction of these templates (Fig. <xref rid="Fig3" ref-type="fig">3</xref> and Table <xref rid="MOESM1" ref-type="media">S5</xref>). Additionally, in 6 out of the 8 cases where SPOT-RNA provided inaccurate secondary structures, the eRMSD successfully helps identify models with more accurate input of secondary structures (Table <xref rid="MOESM1" ref-type="media">S1</xref>). These observations highlight the promising potential of eRMSD in facilitating the optimal selection between predictions from various inputs.</p>
    </sec>
    <sec id="Sec11">
      <title>Analysis of the running time</title>
      <p id="Par35">We decompose the running time of trRosettaRNA into two parts: 2D geometry prediction and 3D structure generation. The time for MSA generation is not discussed here as it can be flexible depending on the searching algorithms and sequence databases. Fig. <xref rid="Fig5" ref-type="fig">5d</xref> shows that trRosettaRNA spends most time in the generation of 3D structure (&gt; 95%). With the increase in sequence length, the running time increases linearly. In general, it takes &lt;30 min to complete the prediction for a typical RNA with &lt;200 nucleotides.</p>
    </sec>
    <sec id="Sec12">
      <title>Application to Rfam families with unknown structures</title>
      <p id="Par36">It remains challenging to solve RNA structures by experiment. For example, only 123 out of the 3938 families in the Rfam database (version 14.4) have experimentally resolved 3D structures<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. We sought to predict the structures for the Rfam families that have no experimental structures. We collected 1752 unsolved families that are 50–200 nucleotides long and have more than 30 members. For each family, we use its consensus secondary structure along with the MSA derived from the consensus sequence as the input features to trRosettaRNA. Most of these families are not predicted well, with eRMSD &gt; 10 Å for 891 out of 1752 families (Fig. <xref rid="Fig6" ref-type="fig">6a</xref>). This may reflect the difficulty of determining the structures for these families.<fig id="Fig6"><label>Fig. 6</label><caption><title>Application of trRosettaRNA to Rfam families with unknown structures.</title><p><bold>a</bold> eRMSD (i.e., estimated RMSD) distributions of the predicted structure models (<italic>n</italic> = 1752 Rfam families). <bold>b</bold> six selected example families with eRMSD &lt;4 Å. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_42528_Fig6_HTML" id="d32e1537"/></fig></p>
      <p id="Par37">Nevertheless, trRosettaRNA does predict accurate structures for 263 families with eRMSD &lt;4 Å. For 27 of these families, the predicted structure models do not have any similar structures in PDB according to the program RNAalign (TM-score<sub>RNA</sub><sup><xref ref-type="bibr" rid="CR42">42</xref></sup> ≥ 0.45). In Fig. <xref rid="Fig6" ref-type="fig">6b</xref>, we show the predicted structures for 6 families with distinct topologies. These high-confidence models are anticipated to provide a structural basis for understanding their biological functions and guide their experimental determinations. For example, for the family sul1 RNA (<ext-link ext-link-type="uri" xlink:href="https://rfam.org/search?q=RF01070">RF01070</ext-link>) which encodes a subunit of an enzyme participating in the citric acid cycle, trRosettaRNA can generate a confident model with an estimated RMSD of 1.6 Å. The trRosettaRNA models for the 263 families with eRMSD &lt;4 Å are available on our website (<ext-link ext-link-type="uri" xlink:href="https://yanglab.qd.sdu.edu.cn/trRosettaRNA/rfam/">https://yanglab.qd.sdu.edu.cn/trRosettaRNA/rfam/</ext-link>).</p>
    </sec>
  </sec>
  <sec id="Sec13" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par38">We have developed trRosettaRNA, an automated approach to RNA 3D structure prediction with the transformer network. We have rigorously assessed trRosettaRNA with two independent datasets and two blind tests. The benchmark tests show that trRosettaRNA predicts more accurate models than the other automated methods. trRosettaRNA was assessed blindly in two experiments: RNA-Puzzles (3 targets) and CASP15 (12 targets). The RNA-Puzzles experiments show that the automated predictions by trRosettaRNA are competitive with the top human predictions for 2 out of 3 targets. The CASP15 experiments show that trRosettaRNA outperforms other deep learning-based methods in terms of the cumulative Z-score based on RMSD. Our method achieves comparable accuracy to the top human groups on 8 natural RNAs, though without any human interventions.</p>
    <p id="Par39">However, we notice that the average RMSD on the natural RNAs from the CASP15 blind test (14.8 Å for the first models) is higher than that on the RNAs from the two benchmark datasets (8.5 Å for 30 independent RNAs and 10.5 Å for 20 previous RNA-Puzzles targets). The disparity in the modeling accuracy may be explained by the target difficulty and novelty. (1) target difficulty. Most of the CASP15 RNAs exhibit high flexibility and can adopt multiple conformations (except for R1116 and R1117)<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. In addition, there are two dimers (R1107, R1108) and two protein-binding RNAs with many single-strand regions (R1189, R1190). These features pose challenges for SPOT-RNA in predicting confident secondary structures. To illustrate, the average F1-score of the predicted secondary structure by SPOT-RNA is much lower for the 8 natural RNAs from CASP15 in contrast to the 20 RNA-Puzzles targets (0.62 and 0.72, respectively). (2) target novelty. A significant proportion of RNAs (two-thirds, 20 out of 30) from the non-redundant benchmark dataset exhibit high similarities (TM-score<sub>RNA</sub> &gt; 0.6) to previously known RNAs, making them easy to predict for data-driven methods like trRosettaRNA. On the contrary, none of the RNAs from CASP15 show such a level of similarity (Fig. <xref rid="MOESM1" ref-type="media">S10</xref>).</p>
    <p id="Par40">This reflects the limitations associated with trRosettaRNA and the benchmark tests employed in this work. First, the performance of trRosettaRNA is susceptible to the quality of predicted secondary structures. Secondly, though trRosettaRNA achieves promising accuracy in the internal benchmark tests, its performance on novel RNAs remains limited. Moreover, the automated structure prediction of synthetic RNAs remains challenging.</p>
    <p id="Par41">The blind tests in CASP15 experiments suggest that the deep learning approach to RNA structure prediction is still in its infancy. Nevertheless, with consistent development, deep learning should be promising to advance RNA structure prediction. Incorporation of physics-based modeling into deep learning is one of the directions to improve in the future. One of the most instant alternatives is to combine it with other conventional approaches and optimize the algorithms toward those under-represented RNA structures in the future. For example, to overcome the bias toward known RNA folds, neural networks (such as with physics-informed neural networks<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>) can be utilized to learn force fields or to recognize/assemble local motifs instead of directly predicting the global 3D structures.</p>
  </sec>
  <sec id="Sec14">
    <title>Methods</title>
    <sec id="Sec15">
      <title>trRosettaRNA algorithm</title>
      <p id="Par42">As shown in Fig. <xref rid="Fig1" ref-type="fig">1a</xref>, the full pipeline of trRosettaRNA consists of three major steps: preparation of input data, prediction of 1D and 2D geometries, and generation of 3D structure.</p>
    </sec>
    <sec id="Sec16">
      <title>Step 1. Preparation of input data</title>
      <p id="Par43">For a given query RNA, the first step of trRosettaRNA is to prepare an MSA and a secondary structure. Two different MSAs are generated for each query sequence. The first is generated by using the program rMSA against multiple sequence databases (NCBI’s nt, Rfam, and RNAcentral<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>). The second is obtained by running the program Infernal<sup><xref ref-type="bibr" rid="CR45">45</xref></sup> against the smaller database RNAcentral with two iterations, which is very fast. Then we select the final MSA based on the qualities of the predicted distance maps (measured by the average of standard deviations of the probability values of each nucleotide pair, Fig. <xref rid="MOESM1" ref-type="media">S11</xref>). The secondary structure is predicted by SPOT-RNA<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> from the query sequence. Here we use the predicted probability matrix as the input, which contains more information than the dot-bracket representation.</p>
    </sec>
    <sec id="Sec17">
      <title>Step 2. Prediction of 1D and 2D geometries</title>
      <p id="Par44">The second step of trRosettaRNA is to predict the 1D and 2D geometries by deep learning. We design a transformer network (named RNAformer) similar to the network Evoformer in AlphaFold2. At the very start, the input MSA and secondary structure are converted into two representations, i.e., the MSA representation (i.e., MSA embedded by nucleotide types) and the pair representation (including the direct couplings derived from MSA and the probability matrix of the predicted secondary structure). We adopt a transformer-based module (i.e., RNAformer) to update both representations. More specifically, each block of RNAformer can be divided into four steps according to the update direction (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>).<list list-type="order"><list-item><p id="Par45"><bold>MSA to MSA</bold>. To update the MSA representation by itself, we perform row- and column-wise gated self-attention operations and combine the corresponding results. A feed-forward layer is employed to introduce nonlinearity. Note that the pair information participates in the row-wise attention by adding bias to the attention maps.</p></list-item><list-item><p id="Par46"><bold>MSA to pair</bold>. We perform an outer product operation on the self-updated MSA representation to transform it into the pair format. In detail, the MSA representation is linearly projected to a smaller dimension. Then for the nucleotide pair (<italic>i</italic>, <italic>j</italic>), the outer products of the vectors from the <italic>i</italic><sup>th</sup> and the <italic>j</italic><sup>th</sup> columns of the MSA representation are averaged over the homologous sequences to update the representation for this pair.</p></list-item><list-item><p id="Par47"><bold>Pair to pair</bold>. After the above step, we perform the triangle updates, followed by a feed-forward layer. For each triangle update layer, we use a multi-scale network Res2Net<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> to enhance the ability to model the local details.</p></list-item><list-item><p id="Par48"><bold>Pair to MSA</bold>. The updated pair representation is then linearly projected to the pair-wise attention maps, which are then multiplied on the MSA representation, followed by a feed-forward layer.</p></list-item></list></p>
      <p id="Par49">A single-pass RNAformer consists of 48 blocks, which are cycled 4 times in the complete inference (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). The final predicted probability distributions of the 2D geometries are derived from the updated pair representation via linear layers and softmax operations. To predict the 1D geometry, we transform the MSA representation into 1D representation by row-wise weighted summation, followed by linear layers and softmax operations to obtain the predicted probabilities.</p>
    </sec>
    <sec id="Sec18">
      <title>Step 3. Generation of full-atom structure models</title>
      <p id="Par50">Similar to trRosetta, trRosettaRNA generates full-atom structure models by energy minimization with deep learning potentials and physics-based energy terms in Rosetta.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E={w}_{1}{E}_{dist}+{w}_{2}{E}_{ori}+{w}_{3}{E}_{cont}+{w}_{4}{E}_{ros}$$\end{document}</tex-math><mml:math id="M2"><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${E}_{ori}={E}_{ori,2D}+\frac{L}{2}{E}_{ori,1D}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <italic>E</italic><sub><italic>dist</italic></sub>, <italic>E</italic><sub><italic>ori</italic></sub>, and <italic>E</italic><sub><italic>cont</italic></sub> represent the distance-, orientation-, contact-based restraints and Rosetta’s internal energy terms, respectively; <italic>E</italic><sub><italic>ori,2D</italic></sub> and <italic>E</italic><sub><italic>ori,1D</italic></sub> represent the restraints from 2D and 1D orientations, respectively; <italic>L</italic> is the length of the sequence. A detailed description of these energy terms is available in the Supporting Information. The weights (<italic>w</italic><sub>1</sub> = 1.03, <italic>w</italic><sub>2</sub> = 1.0, <italic>w</italic><sub>3</sub> = 1.05, <italic>w</italic><sub>4</sub> = 0.05) are decided on hundreds of RNAs randomly selected from the training set to minimize the average RMSD. Note that we only select a subset of restraints with probabilities higher than a specified threshold (0.45, 0.65, and 0.6 for distances, orientations, and contacts, respectively).</p>
      <p id="Par51">The folding procedure is implemented with pyRosetta<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>. From each RNA, 20 full-atom starting structures are first generated using the RNA_HelixAssembler protocol in pyRosetta<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>. The Quasi-Newton-based optimization L-BFGS is then applied to refine these structures by minimizing the total energy, resulting in 20 refined full-atom structure models. Finally, the model with the lowest total energy (Eq. <xref rid="Equ1" ref-type="disp-formula">1</xref>) is selected as the final prediction.</p>
    </sec>
    <sec id="Sec19">
      <title>Construction of datasets</title>
      <sec id="Sec20">
        <title>Test sets</title>
        <p id="Par52">Two benchmark datasets are constructed in this work. The first one is from the RNA-Puzzles experiments. This set consists of all RNA-Puzzles targets from PZ1 through PZ33 except PZ2. PZ2 is a complex that has complicated interactions among eight chains, which is out of the prediction scope of the current work. The second dataset comes from PDB. In detail, we first collected 339 RNA structures from PDB that were released after 2017-01. RNAs with more than 200 or less than 30 nucleotides were removed. Then the program cd-hit-est<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> was used to remove redundant sequences at 80% sequence identity. To avoid over-estimation, RNAs with an e-value lower than 10 by BLASTN searching against the training sets of trRosettaRNA and SPOT-RNA were excluded from both test sets. The duplicated RNAs between these two test sets were also removed. The resulting sets comprised 20 RNA-Puzzles targets and 30 non-redundant RNAs, respectively.</p>
      </sec>
      <sec id="Sec21">
        <title>Training sets from PDB</title>
        <p id="Par53">To train our models, we first collected all the RNA chains released before 2022-01 in PDB. Multi-chain structures were separated into single-chain structures. Modified nucleotides are replaced by the standard ones. In addition, if two chains form more than three base-pairing interactions, they are linked by three Adenines, resulting in a new sample. In total, we obtained 8849 samples. Then we tried to generate MSA for each query sequence and removed the sequences without sequence homologs. Finally, 3633 RNA chains were retained for training the network models of trRosettaRNA.</p>
        <p id="Par54">To avoid data leakage in the benchmark tests while keeping as many training samples as possible, five training subsets were obtained by filtering the above 3633 RNA chains. Specifically, for the RNA-Puzzles set, we split the 20 RNAs into four subsets according to their release dates in PDB (i.e., 2010-12 ~ 2013-07, 2013-07 ~ 2016-07, 2016-07 ~ 2019-04, and after 2019-04, see Table <xref rid="MOESM1" ref-type="media">S2</xref>). Correspondingly, four smaller training sets (1133, 1528, 2337, and 3001 samples, respectively) were obtained by removing structures that were released after the above dates. We trained four network models with these training sets, respectively. For each group of the RNA-Puzzles targets, the predictions were made by the model trained on the corresponding training set. For the 30 independent RNAs, the training set consists of 2454 RNAs that were released before 2017-01.</p>
      </sec>
      <sec id="Sec22">
        <title>Self-distillation training set from bpRNA</title>
        <p id="Par55">As the number of available RNA structures is limited, inspired by the success of the self-distillation method used in AlphaFold2, we constructed a self-distillation dataset from the bpRNA database with experimental secondary structures<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>. In detail, we collected the bpRNA sequences that are available in the Rfam database<sup><xref ref-type="bibr" rid="CR41">41</xref></sup> so that the Rfam MSAs can be used immediately. Then we removed the orphan families (i.e., with one RNA sequence only) and ran cd-hit-est to exclude the redundant sequences at a sequence identity cutoff of 80%. The final self-distillation dataset consists of 13202 RNA chains. The RNAs possessing an e-value lower than 10 (by BLASTN) or with a sequence identity higher than 80% (by cd-hit-est) with the two benchmark datasets were excluded from the self-distillation dataset when training the models for benchmark tests. Consequently, the self-distillation dataset for benchmark tests consists of 13175 RNA chains.</p>
        <p id="Par56">We use a single un-distilled RNAformer model, i.e., trained on the PDB dataset (or the corresponding subsets for benchmark tests), to generate the predicted labels for the self-distillation set. Using this un-distilled model, we predicted the 1D and 2D geometries (in the form of probability distributions) for every sequence in the self-distillation set. These predicted geometries are then assigned as the labels of these distillation samples. As the predictions may be inaccurate for some nucleotides, we estimate the prediction confidence and filtered out the potentially inaccurate nucleotides and nucleotide pairs. In detail, for each pair of nucleotides (<italic>i</italic>, <italic>j</italic>) with sequence separation less than 128 (i.e., |<italic>i</italic>-<italic>j</italic> | ≤ 128), we computed the mean P-P distance distribution (i.e., the reference distribution, denoted by<inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{|i-j|}^{ref}$$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_42528_Article_IEq1.gif"/></alternatives></inline-formula>), using the predicted distance maps for 1000 samples randomly selected from the self-distillation set. Then for each pair of nucleotides in a self-distillation sequence, we calculated its confidence score (denoted by <italic>c</italic><sub><italic>i,j</italic></sub>), defined as the Kullback-Leibler divergence between its predicted distribution (denoted by <italic>P</italic><sub><italic>i,j</italic></sub>) and the reference distribution:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{i,j}={D}_{KL}\left({P}_{i,j}|{P}_{|i-j|}^{ref}\right)$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par57">The per-nucleotide confidence score <italic>c</italic><sub><italic>i</italic></sub> was calculated as the average of <italic>c</italic><sub><italic>i,j</italic></sub> over all <italic>j</italic>s within the sequence separation of 128:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{i}=\frac{1}{128}\mathop{\sum }\limits_{j=i+1}^{i+128}{c}_{i,j}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>128</mml:mn></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>128</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par58">During training (see below), the nucleotides/nucleotide pairs with confidence scores &lt;0.5 are masked out when calculating the 1D/2D losses, respectively.</p>
      </sec>
    </sec>
    <sec id="Sec23">
      <title>Training procedure and loss function</title>
      <p id="Par59">The training of an RNAformer model can be divided into three steps. In the first step, we trained an un-distilled model using the PDB set by 15 epochs. This model was then used to generate the labels for RNAs in the self-distillation set. In the second step, the un-distilled model was further trained on the combination of the PDB set and the self-distillation set with another 15 epochs. At each epoch, the training samples consist of all the <italic>N</italic> samples from the PDB set and randomly selected 3 <italic>N</italic> samples from the self-distillation set, where <italic>N</italic> is the size of the PDB set. In the third step, we finetuned the models on the long sequences (&gt;100 nucleotides) selected from the PDB set. We used the Adam optimizer to minimize the loss function (see below) with different learning rates (0.0001 for the first two steps, 0.00005 for the third step).</p>
      <p id="Par60">For all training steps, the loss function is defined as the cross entropy between the predicted distributions and the real or generated labels. In total, the loss function can be written as:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Loss={L}_{2D}+{L}_{1D}+5{L}_{cont}$$\end{document}</tex-math><mml:math id="M12"><mml:mi>L</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <italic>L</italic><sub>2D</sub>, <italic>L</italic><sub>1D</sub>, and <italic>L</italic><sub>cont</sub> are the loss items for the 2D distances and orientations, 1D orientations, and 2D contacts, respectively. More specifically, the three loss items can be written as:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{2D}=\frac{1}{10{N}_{nt}^{2}}\mathop{\sum }\limits_{i=1}^{L}\mathop{\sum }\limits_{j=1}^{L}\mathop{\sum}\limits_{g\in \{2D\,geometries\}}CE\left({P}_{i,j}^{g},{Y}_{i,j}^{g}\right)$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>10</mml:mn><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>D</mml:mi><mml:mspace width="0.25em"/><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mi>C</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1D}=\frac{1}{4{N}_{L}}\mathop{\sum }\limits_{i=1}^{L}\mathop{\sum}\limits_{g\in \{1D\,geometries\}}CE\left({P}_{i}^{g},{Y}_{i}^{g}\right)$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mi>D</mml:mi><mml:mspace width="0.25em"/><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mi>C</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{cont}=\frac{1}{{L}^{2}}\mathop{\sum }\limits_{i=1}^{L}\mathop{\sum }\limits_{j=1}^{L}CE\left({P}_{i,j}^{cont},{Y}_{i,j}^{cont}\right)$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mi>C</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <italic>CE</italic>() is the cross entropy function; <inline-formula id="IEq2"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{i,j}^{g}$$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_42528_Article_IEq2.gif"/></alternatives></inline-formula> is the predicted probability distribution of the 2D geometry <italic>g</italic> between nucleotides <italic>i</italic> and <italic>j</italic>; <inline-formula id="IEq3"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{i}^{g}$$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_42528_Article_IEq3.gif"/></alternatives></inline-formula> is the predicted probability distribution of the 1D geometry <italic>g</italic> of nucleotide <italic>i</italic>; <inline-formula id="IEq4"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{i,j}^{cont}$$\end{document}</tex-math><mml:math id="M24"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_42528_Article_IEq4.gif"/></alternatives></inline-formula> is the predicted probability of nucleotides <italic>i</italic> and <italic>j</italic> to be in contact; the <italic>Y</italic> heads are the one-hot encodings of the true labels (for PDB samples) or the predicted distributions (for self-distillation samples); <italic>L</italic> is the number of nucleotides in sequence; 10 and 4 are the number of types of 2D geometries (5 distances + 5 orientations) and 1D geometries (4 orientations), respectively.</p>
    </sec>
    <sec id="Sec24">
      <title>Estimation of model confidence</title>
      <p id="Par61">To estimate the quality of the predicted model, a few variables are first derived from predicted distance maps and generated decoys.<list list-type="order"><list-item><p id="Par62"><italic>pRMSD</italic>: the average pair-wise RMSD of the top ten decoys with the lowest total energies.</p></list-item><list-item><p id="Par63"><italic>mp</italic>: the mean probability of the predicted inter-nucleotide distances for the set (denoted by <italic>S</italic>) of the top 15 <italic>L</italic> (<italic>L</italic> is the sequence length) nucleotide pairs (as ranked by the probability <italic>P</italic>(<italic>d</italic><sub>P-P</sub> &lt; 40 Å)). A similar variable has been defined to estimate the accuracy of predicted inter-residue distances<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>.<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$mp=\frac{1}{{N}_{bins}}\mathop{\sum }\limits_{k=1}^{{N}_{bins}}\frac{1}{|{M}_{k}|}\mathop{\sum}\limits_{(i,j)\in {M}_{k}}{P}_{\max }(i,\, j)$$\end{document}</tex-math><mml:math id="M26"><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where <italic>d</italic><sub>P-P</sub> denotes the distance between the atoms P; <italic>N</italic><sub><italic>bins</italic></sub> is the total number of distance bins (38 here), <italic>M</italic><sub><italic>k</italic></sub> is a collection of nucleotide pairs (<italic>i</italic>, <italic>j</italic>) (from <italic>S</italic>), for which the maximum probability of <italic>d</italic><sub>P-P</sub>, (i.e., <italic>P</italic><sub>max</sub>(<italic>i</italic>, <italic>j</italic>)), belongs to the <italic>k</italic><sup>th</sup> distance bin.</p></list-item><list-item><p id="Par64"><italic>std</italic>, the average standard deviations of the probability values for all nucleotide pairs.</p></list-item><list-item><p id="Par65"><italic>prop</italic>, the proportion of nucleotide pairs with <italic>P</italic>(<italic>d</italic><sub>P-P</sub> &lt; 40 Å) &gt; 0.45.</p></list-item></list></p>
      <p id="Par66">The RMSD is estimated based on linear regression over the above variables using hundreds of randomly selected RNAs from the training set.<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$eRMSD=0.64 \times pRMSD-189.43 \times std -4.01 \times mp-1.06 \times prop+15.2$$\end{document}</tex-math><mml:math id="M28"><mml:mi>e</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>0.64</mml:mn><mml:mo>×</mml:mo><mml:mi>p</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mo>−</mml:mo><mml:mn>189.43</mml:mn><mml:mo>×</mml:mo><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>4.01</mml:mn><mml:mo>×</mml:mo><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mn>1.06</mml:mn><mml:mo>×</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>15.2</mml:mn></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec25">
      <title>Statistics &amp; reproducibility</title>
      <p id="Par67">No statistical method was used to predetermine sample size. No data were excluded from the analyses. The experiments were not randomized. The Investigators were not blinded to allocation during experiments and outcome assessment.</p>
    </sec>
    <sec id="Sec26">
      <title>Reporting summary</title>
      <p id="Par68">Further information on research design is available in the <xref rid="MOESM3" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec27">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2023_42528_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2023_42528_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2023_42528_MOESM3_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
    <sec id="Sec28">
      <title>Source data</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2023_42528_MOESM4_ESM.xlsx">
            <caption>
              <p>Source Data</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Wenkai Wang, Chenjie Feng, Renmin Han.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-023-42528-4.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work is supported in part by the National Natural Science Foundation of China (NSFC T2225007 to J.Y., T2222012 to Z.P., and 61932018 to F.Z.), and the Foundation for Innovative Research Groups of State Key Laboratory of Microbial Technology (WZCX2021-03 to J.Y.).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>J.Y. conceptualized and administered the study. W.W. designed and implemented the network. C.F. and L.Y. implemented the energy minimization. Z.P. and F.Z. co-supervised the study. R.H., Z.W., Z.D., and H.W. prepared the training data. All authors revised and approved the final draft of the manuscript.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par69"><italic>Nature Communications</italic> thanks Rhiju Das and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. A peer review file is available.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The training sets, the set of 20 RNA-Puzzles RNAs, and the set of 30 independent RNAs can be downloaded from Zenodo<sup><xref ref-type="bibr" rid="CR51">51</xref></sup> and our website (<ext-link ext-link-type="uri" xlink:href="https://yanglab.qd.sdu.edu.cn/trRosettaRNA/">https://yanglab.qd.sdu.edu.cn/trRosettaRNA/</ext-link>). The RNAs from blind tests of CASP15 and RNA-Puzzles can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://predictioncenter.org/casp15/results.cgi?tr_type=rna">https://predictioncenter.org/casp15/results.cgi?tr_type=rna</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://www.rnapuzzles.org/results/">https://www.rnapuzzles.org/results/</ext-link>, respectively. The PDB entries mentioned in this study (<ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb3IVK/pdb">3IVK</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb5KH8/pdb">5KH8</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb5LYS/pdb">5LYS</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb6D89/pdb">6D89</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb7D7V/pdb">7D7V</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb8DP3/pdb">8DP3</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb8GXC/pdb">8GXC</ext-link>, and <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb8HB8/pdb">8HB8</ext-link>) were obtained by four-digit accession codes in the Protein Data Bank repository (<ext-link ext-link-type="uri" xlink:href="https://www.rcsb.org/">https://www.rcsb.org/</ext-link>). The sequence databases of NCBI’s nt, Rfam, and RNAcentral used to generate MSA in this study can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/nucleotide">https://www.ncbi.nlm.nih.gov/nucleotide</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://rfam.org/">https://rfam.org/</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://rnacentral.org/">https://rnacentral.org/</ext-link>, respectively. The source data underlying Tables <xref rid="MOESM4" ref-type="media">1</xref>, S<xref rid="MOESM4" ref-type="media">7</xref> and Figs. <xref rid="MOESM4" ref-type="media">4</xref>–<xref rid="MOESM4" ref-type="media">6</xref>, S<xref rid="MOESM4" ref-type="media">2</xref>, S<xref rid="MOESM4" ref-type="media">3</xref>, S<xref rid="MOESM4" ref-type="media">5</xref>, S<xref rid="MOESM4" ref-type="media">6</xref>, S<xref rid="MOESM4" ref-type="media">10</xref>, S<xref rid="MOESM4" ref-type="media">11</xref> are provided in the Source Data file. <xref ref-type="sec" rid="Sec28">Source data</xref> are provided with this paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The trRosettaRNA server and the standalone package are available at Zenodo<sup><xref ref-type="bibr" rid="CR51">51</xref></sup> and our website (<ext-link ext-link-type="uri" xlink:href="https://yanglab.qd.sdu.edu.cn/trRosettaRNA/">https://yanglab.qd.sdu.edu.cn/trRosettaRNA/</ext-link>).</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par70">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>QC</given-names>
          </name>
        </person-group>
        <article-title>Advances and opportunities in RNA structure experimental determination and computational modeling</article-title>
        <source>Nat. Methods</source>
        <year>2022</year>
        <volume>19</volume>
        <fpage>1193</fpage>
        <lpage>1207</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-022-01623-y</pub-id>
        <?supplied-pmid 36203019?>
        <pub-id pub-id-type="pmid">36203019</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berman</surname>
            <given-names>HM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Protein Data Bank</article-title>
        <source>Nucleic acids Res.</source>
        <year>2000</year>
        <volume>28</volume>
        <fpage>235</fpage>
        <lpage>242</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/28.1.235</pub-id>
        <?supplied-pmid 10592235?>
        <pub-id pub-id-type="pmid">10592235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rother</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rother</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Puton</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bujnicki</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>ModeRNA: a tool for comparative modeling of RNA 3D structure</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>4007</fpage>
        <lpage>4022</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq1320</pub-id>
        <?supplied-pmid 21300639?>
        <pub-id pub-id-type="pmid">21300639</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Flores, S. C., Wan, Y., Russell, R. &amp; Altman, R. B. Predicting RNA structure by multiple template homology modeling. <italic>Pac Symp Biocomput</italic>. <bold>2010</bold>, 216-227 (2009).</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Das</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Automated de novo prediction of native-like RNA tertiary structures</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2007</year>
        <volume>104</volume>
        <fpage>14664</fpage>
        <lpage>14669</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0703836104</pub-id>
        <?supplied-pmid 17726102?>
        <pub-id pub-id-type="pmid">17726102</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Das</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Karanicolas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Atomic accuracy in predicting and designing noncanonical RNA structure</article-title>
        <source>Nat. Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>291</fpage>
        <lpage>294</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1433</pub-id>
        <?supplied-pmid 20190761?>
        <pub-id pub-id-type="pmid">20190761</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Watkins</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Rangan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Das</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>FARFAR2: improved de novo rosetta prediction of complex global RNA folds</article-title>
        <source>Struct. (Lond., Engl.: 1993)</source>
        <year>2020</year>
        <volume>28</volume>
        <fpage>963</fpage>
        <lpage>976.e966</lpage>
        <pub-id pub-id-type="doi">10.1016/j.str.2020.05.011</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boniecki</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SimRNA: a coarse-grained method for RNA folding simulations and 3D structure prediction</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>e63</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1479</pub-id>
        <?supplied-pmid 26687716?>
        <pub-id pub-id-type="pmid">26687716</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sharma</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Dokholyan</surname>
            <given-names>NV</given-names>
          </name>
        </person-group>
        <article-title>iFoldRNA: three-dimensional RNA structure prediction and folding</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>1951</fpage>
        <lpage>1952</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn328</pub-id>
        <?supplied-pmid 18579566?>
        <pub-id pub-id-type="pmid">18579566</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Popenda</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated 3D structure composition for large RNAs</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>e112</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks339</pub-id>
        <?supplied-pmid 22539264?>
        <pub-id pub-id-type="pmid">22539264</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated and fast building of three-dimensional RNA structures</article-title>
        <source>Sci. Rep.</source>
        <year>2012</year>
        <volume>2</volume>
        <fpage>734</fpage>
        <pub-id pub-id-type="doi">10.1038/srep00734</pub-id>
        <pub-id pub-id-type="pmid">23071898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>3dRNA: 3D structure prediction from linear to circular RNAs</article-title>
        <source>J. Mol. Biol.</source>
        <year>2022</year>
        <volume>434</volume>
        <fpage>167452</fpage>
        <pub-id pub-id-type="doi">10.1016/j.jmb.2022.167452</pub-id>
        <?supplied-pmid 35662453?>
        <pub-id pub-id-type="pmid">35662453</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Leonardis</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Direct-coupling analysis of nucleotide coevolution facilitates RNA secondary and tertiary structure prediction</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>10444</fpage>
        <lpage>10455</lpage>
        <?supplied-pmid 26420827?>
        <pub-id pub-id-type="pmid">26420827</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cuturello</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Tiana</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bussi</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Assessing the accuracy of direct-coupling analysis for RNA contact prediction</article-title>
        <source>RNA</source>
        <year>2020</year>
        <volume>26</volume>
        <fpage>637</fpage>
        <lpage>647</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.074179.119</pub-id>
        <?supplied-pmid 32115426?>
        <pub-id pub-id-type="pmid">32115426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Optimization of RNA 3D structure prediction using evolutionary restraints of nucleotide-nucleotide interactions from direct coupling analysis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <fpage>6299</fpage>
        <lpage>6309</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx386</pub-id>
        <?supplied-pmid 28482022?>
        <pub-id pub-id-type="pmid">28482022</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Predicting RNA folding thermodynamics with a reduced chain representation model</article-title>
        <source>RNA</source>
        <year>2005</year>
        <volume>11</volume>
        <fpage>1884</fpage>
        <lpage>1897</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.2109105</pub-id>
        <?supplied-pmid 16251382?>
        <pub-id pub-id-type="pmid">16251382</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Vfold-Pipeline: a web server for RNA 3D structure prediction from sequences</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <fpage>4042</fpage>
        <lpage>4043</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac426</pub-id>
        <?supplied-pmid 35758624?>
        <pub-id pub-id-type="pmid">35758624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parisien</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Major</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>The MC-Fold and MC-Sym pipeline infers RNA structure from sequence data</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>452</volume>
        <fpage>51</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="doi">10.1038/nature06684</pub-id>
        <?supplied-pmid 18322526?>
        <pub-id pub-id-type="pmid">18322526</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cruz</surname>
            <given-names>JA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Puzzles: a CASP-like evaluation of RNA three-dimensional structure prediction</article-title>
        <source>RNA</source>
        <year>2012</year>
        <volume>18</volume>
        <fpage>610</fpage>
        <lpage>625</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.031054.111</pub-id>
        <?supplied-pmid 22361291?>
        <pub-id pub-id-type="pmid">22361291</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miao</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Puzzles Round IV: 3D structure predictions of four ribozymes and two aptamers</article-title>
        <source>RNA</source>
        <year>2020</year>
        <volume>26</volume>
        <fpage>982</fpage>
        <lpage>995</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.075341.120</pub-id>
        <?supplied-pmid 32371455?>
        <pub-id pub-id-type="pmid">32371455</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>RNA inter-nucleotide 3D closeness prediction by deep residual neural networks</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>1093</fpage>
        <lpage>1098</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa932</pub-id>
        <?supplied-pmid 33135062?>
        <pub-id pub-id-type="pmid">33135062</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Singh, J., Paliwal, K., Litfin, T., Singh, J. &amp; Zhou, Y. Predicting RNA distance-based contact maps by integrated deep learning on physics-inferred secondary structure and evolutionary-derived mutational coupling. <italic>Bioinformatics</italic><bold>38</bold>, 3900–3910 (2022).</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Townshend</surname>
            <given-names>RJL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Geometric deep learning of RNA structure</article-title>
        <source>Science</source>
        <year>2021</year>
        <volume>373</volume>
        <fpage>1047</fpage>
        <lpage>1051</lpage>
        <pub-id pub-id-type="doi">10.1126/science.abe5650</pub-id>
        <?supplied-pmid 34446608?>
        <pub-id pub-id-type="pmid">34446608</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jumper</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>596</volume>
        <fpage>583</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id>
        <?supplied-pmid 34265844?>
        <pub-id pub-id-type="pmid">34265844</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Pearce, R., Omenn, G. S. &amp; Zhang, Y. De Novo RNA Tertiary Structure Prediction at Atomic Resolution Using Geometric Potentials from Deep Learning. Preprint at <italic>bioRxiv</italic>, 2022.05.15.491755 (2022).</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Baek, M., McHugh, R., Anishchenko, I., Baker, D. &amp; DiMaio, F. Accurate prediction of nucleic acid and protein-nucleic acid complexes using RoseTTAFoldNA. Preprint at <italic>bioRxiv</italic>, 2022.09.09.507333 (2022).</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Shen, T. et al. E2Efold-3D: End-to-End Deep Learning Method for accurate de novo RNA 3D Structure Prediction. Preprint at <italic>arXiv e-prints</italic>, arXiv:2207.01586 (2022).</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved protein structure prediction using predicted interresidue orientations</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2020</year>
        <volume>117</volume>
        <fpage>1496</fpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1914677117</pub-id>
        <pub-id pub-id-type="pmid">31896580</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Du</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The trRosetta server for fast and accurate protein structure prediction</article-title>
        <source>Nat. Protoc.</source>
        <year>2021</year>
        <volume>16</volume>
        <fpage>5634</fpage>
        <lpage>5651</lpage>
        <pub-id pub-id-type="doi">10.1038/s41596-021-00628-9</pub-id>
        <?supplied-pmid 34759384?>
        <pub-id pub-id-type="pmid">34759384</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Su</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved Protein Structure Prediction Using a New Multi-Scale Network and Homologous Templates</article-title>
        <source>Adv. Sci. (Weinh.)</source>
        <year>2021</year>
        <volume>8</volume>
        <fpage>e2102592</fpage>
        <?supplied-pmid 34719864?>
        <pub-id pub-id-type="pmid">34719864</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pyle</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>rMSA: A sequence search and alignment algorithm to improve rna structure modeling</article-title>
        <source>J. Mol. Biol.</source>
        <year>2023</year>
        <volume>435</volume>
        <fpage>167904</fpage>
        <pub-id pub-id-type="doi">10.1016/j.jmb.2022.167904</pub-id>
        <?supplied-pmid 37356900?>
        <pub-id pub-id-type="pmid">37356900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Singh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hanson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Paliwal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>RNA secondary structure prediction using an ensemble of two-dimensional deep neural networks and transfer learning</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>5407</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-13395-9</pub-id>
        <?supplied-pmid 31776342?>
        <pub-id pub-id-type="pmid">31776342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Magnus</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Puzzles toolkit: a computational resource of RNA 3D structure benchmark datasets, structure manipulation, and evaluation tools</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2020</year>
        <volume>48</volume>
        <fpage>576</fpage>
        <lpage>588</lpage>
        <?supplied-pmid 31799609?>
        <pub-id pub-id-type="pmid">31799609</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parisien</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cruz</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Westhof</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Major</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>New metrics for comparing and assessing discrepancies between RNA 3D structures and models</article-title>
        <source>Rna</source>
        <year>2009</year>
        <volume>15</volume>
        <fpage>1875</fpage>
        <lpage>1885</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.1700409</pub-id>
        <pub-id pub-id-type="pmid">19710185</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Williams</surname>
            <given-names>CJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MolProbity: More and better reference data for improved all-atom structure validation</article-title>
        <source>Protein Sci.</source>
        <year>2018</year>
        <volume>27</volume>
        <fpage>293</fpage>
        <lpage>315</lpage>
        <pub-id pub-id-type="doi">10.1002/pro.3330</pub-id>
        <?supplied-pmid 29067766?>
        <pub-id pub-id-type="pmid">29067766</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Rhiju, D. et al. Assessment of three-dimensional RNA structure prediction in CASP15. Preprint at <italic>bioRxiv</italic>, 2023.2004.2025.538330 (2023).</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sweeney</surname>
            <given-names>BA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>R2DT is a framework for predicting and visualising RNA secondary structure using templates</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>3494</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-23555-5</pub-id>
        <?supplied-pmid 34108470?>
        <pub-id pub-id-type="pmid">34108470</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiong</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zhan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Pairing a high-resolution statistical potential with a nucleobase-centric sampling algorithm for improving RNA model refinement</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>2777</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-23100-4</pub-id>
        <?supplied-pmid 33986288?>
        <pub-id pub-id-type="pmid">33986288</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Chen, K., Zhou, Y., Wang, S. &amp; Xiong, P. RNA tertiary structure modeling with BRiQ potential in CASP15. <italic>Proteins: Structure, Function, and Bioinformatics</italic><bold>n/a</bold> (2023).</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mariani</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Biasini</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Barbato</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schwede</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>lDDT: a local superposition-free score for comparing protein structures and models using distance difference tests</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2722</fpage>
        <lpage>2728</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt473</pub-id>
        <pub-id pub-id-type="pmid">23986568</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kalvari</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rfam 14: expanded coverage of metagenomic, viral and microRNA families</article-title>
        <source>Nucleic Acids Res</source>
        <year>2021</year>
        <volume>49</volume>
        <fpage>D192</fpage>
        <lpage>D200</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa1047</pub-id>
        <pub-id pub-id-type="pmid">33211869</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gong</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>RNA-align: quick and accurate alignment of RNA 3D structures based on size-independent TM-scoreRNA</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>4459</fpage>
        <lpage>4461</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz282</pub-id>
        <?supplied-pmid 31161212?>
        <pub-id pub-id-type="pmid">31161212</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karniadakis</surname>
            <given-names>GE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Physics-informed machine learning</article-title>
        <source>Nat. Rev. Phys.</source>
        <year>2021</year>
        <volume>3</volume>
        <fpage>422</fpage>
        <lpage>440</lpage>
        <pub-id pub-id-type="doi">10.1038/s42254-021-00314-5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Consortium</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>RNAcentral 2021: secondary structure integration, improved sequence search and new member databases</article-title>
        <source>Nucleic Acids Res</source>
        <year>2021</year>
        <volume>49</volume>
        <fpage>D212</fpage>
        <lpage>D220</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa921</pub-id>
        <pub-id pub-id-type="pmid">33106848</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nawrocki</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Infernal 1.1: 100-fold faster RNA homology searches</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2933</fpage>
        <lpage>2935</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt509</pub-id>
        <pub-id pub-id-type="pmid">24008419</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>S-H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Res2net: A new multi-scale backbone architecture</article-title>
        <source>IEEE Trans. Pattern Anal. Mach. Intell.</source>
        <year>2019</year>
        <volume>43</volume>
        <fpage>652</fpage>
        <lpage>662</lpage>
        <pub-id pub-id-type="doi">10.1109/TPAMI.2019.2938758</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaudhury</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lyskov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gray</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>PyRosetta: a script-based interface for implementing molecular modeling algorithms using Rosetta</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>689</fpage>
        <lpage>691</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq007</pub-id>
        <?supplied-pmid 20061306?>
        <pub-id pub-id-type="pmid">20061306</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Godzik</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1658</fpage>
        <lpage>1659</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl158</pub-id>
        <?supplied-pmid 16731699?>
        <pub-id pub-id-type="pmid">16731699</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Danaee</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>bpRNA: large-scale automated annotation and analysis of RNA secondary structure</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>5381</fpage>
        <lpage>5394</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky285</pub-id>
        <?supplied-pmid 29746666?>
        <pub-id pub-id-type="pmid">29746666</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Du, Z., Peng, Z. &amp; Yang, J. Toward the assessment of predicted inter-residue distance. <italic>Bioinformatics</italic><bold>38</bold>, 962–969 (2022).</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Wenkai, W. et al. Source code and data for “trRosettaRNA: automated prediction of RNA 3D structure with transformer network”. <italic>Zenodo</italic><ext-link ext-link-type="uri" xlink:href="https://zenodo.org/doi/10.5281/zenodo.8362613">https://zenodo.org/doi/10.5281/zenodo.8362613</ext-link> (2023).</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kerpedjiev</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hammer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
        </person-group>
        <article-title>Forna (force-directed RNA): Simple and effective online RNA secondary structure diagrams</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>3377</fpage>
        <lpage>3379</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv372</pub-id>
        <?supplied-pmid 26099263?>
        <pub-id pub-id-type="pmid">26099263</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10636060</article-id>
    <article-id pub-id-type="pmid">37945552</article-id>
    <article-id pub-id-type="publisher-id">42528</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-023-42528-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>trRosettaRNA: automated prediction of RNA 3D structure with transformer network</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8603-8250</contrib-id>
        <name>
          <surname>Wang</surname>
          <given-names>Wenkai</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Feng</surname>
          <given-names>Chenjie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Han</surname>
          <given-names>Renmin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Ziyi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ye</surname>
          <given-names>Lisha</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Du</surname>
          <given-names>Zongyang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wei</surname>
          <given-names>Hong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2081-9369</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Fa</given-names>
        </name>
        <address>
          <email>zhangfa@ict.ac.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0303-6693</contrib-id>
        <name>
          <surname>Peng</surname>
          <given-names>Zhenling</given-names>
        </name>
        <address>
          <email>zhenling@email.sdu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2912-7737</contrib-id>
        <name>
          <surname>Yang</surname>
          <given-names>Jianyi</given-names>
        </name>
        <address>
          <email>yangjy@sdu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01y1kjr75</institution-id><institution-id institution-id-type="GRID">grid.216938.7</institution-id><institution-id institution-id-type="ISNI">0000 0000 9878 7032</institution-id><institution>School of Mathematical Sciences, </institution><institution>Nankai University, </institution></institution-wrap>Tianjin, 300071 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0207yh398</institution-id><institution-id institution-id-type="GRID">grid.27255.37</institution-id><institution-id institution-id-type="ISNI">0000 0004 1761 1174</institution-id><institution>MOE Frontiers Science Center for Nonlinear Expectations, Research Center for Mathematics and Interdisciplinary Sciences, </institution><institution>Shandong University, </institution></institution-wrap>Qingdao, 266237 China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02h8a1848</institution-id><institution-id institution-id-type="GRID">grid.412194.b</institution-id><institution-id institution-id-type="ISNI">0000 0004 1761 9803</institution-id><institution>School of Science, </institution><institution>Ningxia Medical University, </institution></institution-wrap>Yinchuan, 750004 China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01skt4w74</institution-id><institution-id institution-id-type="GRID">grid.43555.32</institution-id><institution-id institution-id-type="ISNI">0000 0000 8841 6246</institution-id><institution>School of Medical Technology, </institution><institution>Beijing Institute of Technology, </institution></institution-wrap>Beijing, 100081 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>9</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>7266</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">RNA 3D structure prediction is a long-standing challenge. Inspired by the recent breakthrough in protein structure prediction, we developed trRosettaRNA, an automated deep learning-based approach to RNA 3D structure prediction. The trRosettaRNA pipeline comprises two major steps: 1D and 2D geometries prediction by a transformer network; and 3D structure folding by energy minimization. Benchmark tests suggest that trRosettaRNA outperforms traditional automated methods. In the blind tests of the 15<sup>th</sup> Critical Assessment of Structure Prediction (CASP15) and the RNA-Puzzles experiments, the automated trRosettaRNA predictions for the natural RNAs are competitive with the top human predictions. trRosettaRNA also outperforms other deep learning-based methods in CASP15 when measured by the Z-score of the Root-Mean-Square Deviation. Nevertheless, it remains challenging to predict accurate structures for synthetic RNAs with an automated approach. We hope this work could be a good start toward solving the hard problem of RNA structure prediction with deep learning.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Here, authors develop trRosettaRNA, a deep learning-based approach for predicting RNA 3D structures. Blind tests demonstrate that the automated predictions compete effectively with top human predictions on natural RNAs.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Computational models</kwd>
      <kwd>Software</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Molecular modelling</kwd>
      <kwd>Molecular modelling</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Limited 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Ribonucleic acid (RNA) is one of the most important types of functional molecules in living cells. It is involved in many fundamental biological and cellular processes, for example, as the transcript of genetic information, serving catalytic, scaffolding, and structural functions. Interest in the structure and functions of non-coding RNA (ncRNA), such as transfer RNAs (tRNAs) and ribosomal RNAs (rRNAs), has been increasing over the past few decades with the discovery of new types of ncRNAs every year. Similar to proteins, ncRNA molecules’ biological function is typically determined by their 3D structures. However, due to the intrinsic structural heterogeneity caused by the flexible backbones and weak long-range tertiary interactions, it is more challenging to experimentally solve the structure of an RNA than a protein<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. For example, only ~6000 RNA structures are deposited in the Protein Data Bank (PDB)<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>, which is much less than the number of deposited protein structures (~190,000). Thus, there is a great demand for developing efficient algorithms to predict RNA 3D structures.</p>
    <p id="Par4">The current RNA 3D structure prediction methods can be divided into two groups: template-based methods and de novo methods. Template-based methods predict the target structure using homologous templates in PDB. For example, representative methods, such as ModeRNA<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> and MMB<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, work by reducing the sampling space with homologous structures. In general, the predicted structure models by template-based methods are accurate when homologous templates exist in PDB. However, the progress for template-based methods is slow, due to the limited number of known RNA structures and the difficulty of aligning RNA sequences.</p>
    <p id="Par5">On the contrary, de novo methods build 3D conformations by simulating the folding process from scratch. With molecular dynamic simulations and/or fragment assembly, methods such as FARNA<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>, FARFAR<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, FARFAR2<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, SimRNA<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, iFoldRNA<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, RNAComposer<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, and 3dRNA<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR12">12</xref></sup>, work well for certain small RNAs (&lt;100 nucleotides). Nevertheless, it is hard to generate accurate 3D structures for large RNAs with complicated topologies, due to the inaccurate force field parameters and the huge sampling space. To partly address this issue, inter-nucleotide contacts predicted by direct coupling analysis (DCA) have been used to guide the structure simulations<sup><xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR15">15</xref></sup>. In addition, given the hierarchical nature of RNA structure folding, a few methods derive 3D structures from secondary structures, such as Vfold<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup> and MC-Fold<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. They are very fast but the modeling accuracy largely depends on the quality of the input secondary structures. The RNA-Puzzles experiments indicate that it remains a grand challenge to accurately predict the structures for large RNAs with complex architectures<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>.</p>
    <p id="Par6">Deep learning has recently been used to improve de novo RNA 3D structure prediction. The predicted inter-nucleotide contacts by the residual convolutional network (ResNet) are about two times more accurate than DCA, improving 3D structure prediction to some extent<sup><xref ref-type="bibr" rid="CR21">21</xref>,<xref ref-type="bibr" rid="CR22">22</xref></sup>. It was shown that with the model selection from a geometric deep learning-based scoring system (ARES), the FARFAR2 protocol predicted the most accurate models for four targets in the blind test of the RNA-Puzzles experiments<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. Recently, inspired by the success of AlphaFold2<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>, a few new deep learning-based methods are developed, such as DeepFoldRNA<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, RoseTTAFoldNA<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, and RhoFold<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>.</p>
    <p id="Par7">In this work, we introduce trRosettaRNA, an automated deep learning-based approach to RNA 3D structure prediction. It is partly inspired by the successful application of deep learning in protein structure prediction, especially in AlphaFold2<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> and our previous method trRosetta<sup><xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref></sup>. Benchmark tests and blind tests show that trRosettaRNA is promising to enhance RNA structure prediction. The server and source codes are available at: <ext-link ext-link-type="uri" xlink:href="https://yanglab.qd.sdu.edu.cn/trRosettaRNA">https://yanglab.qd.sdu.edu.cn/trRosettaRNA</ext-link>.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview of trRosettaRNA</title>
      <p id="Par8">The architecture of trRosettaRNA is depicted in Fig. <xref rid="Fig1" ref-type="fig">1a</xref>. Starting from the nucleotide sequence of an RNA of interest, a multiple sequence alignment (MSA) and a secondary structure are first generated by the programs rMSA<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> and SPOT-RNA<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>, respectively. They are then converted into an MSA representation and a pair representation, which are fed into a transformer network (named RNAformer, see Fig. <xref rid="Fig1" ref-type="fig">1b</xref> and Methods for more details) to predict 1D and 2D geometries (see Fig. <xref rid="MOESM1" ref-type="media">S1</xref>). Similar to trRosetta, these geometries are converted into restraints to guide the final step of 3D structure folding based on energy minimization (see Methods). Unless otherwise specified, the RMSDs mentioned below are calculated by considering all atoms using the evaluation toolkit provided by the RNA-Puzzles community<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>.<fig id="Fig1"><label>Fig. 1</label><caption><title>Overall architecture of trRosettaRNA.</title><p><bold>a</bold> flowchart of trRosettaRNA. <bold>b</bold> structure of each RNAformer block. <italic>n</italic>, <italic>L</italic>, and <italic>c</italic> are the number of sequences in the MSA, the length of the query sequence, and the number of channels, respectively.</p></caption><graphic xlink:href="41467_2023_42528_Fig1_HTML" id="d32e511"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Performance of trRosettaRNA on 30 independent RNAs</title>
      <p id="Par9">To evaluate trRosettaRNA, we collected 30 non-redundant RNA structures based on both release date and similarity with the training RNAs. These RNAs are released after the training RNAs date (i.e., 2017-01) and do not share sequence similarity with trRosettaRNA and SPOT-RNA’s training RNAs (see Methods).</p>
      <p id="Par10">We compare trRosettaRNA with two representative methods, RNAComposer<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> and SimRNA<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. The same secondary structures (from SPOT-RNA) were fed into both methods for fair comparison. For RNAComposer, we submitted the RNA sequences and the predicted secondary structures to its web server to generate 3D models. SimRNA was installed and run locally in our computer cluster. We evaluate the first predicted model to ensure fairness. As shown in Table <xref rid="Tab1" ref-type="table">1</xref>, on these 30 RNAs, the average RMSD by trRosettaRNA (8.5 Å) is significantly lower than those by RNAComposer (17.4 Å; <italic>P</italic>-value = 1.3E-6) and SimRNA (17.1 Å; <italic>P</italic>-value = 1.1E-7; the <italic>P</italic>-values presented in this manuscript were calculated by two-tailed Student’s <italic>t</italic>-tests). trRosettaRNA outperforms RNAComposer and SimRNA for 86.7% and 96.7% of the 30 cases, respectively (Fig. <xref rid="MOESM1" ref-type="media">S2a</xref>). 20% of the models predicted by trRosettaRNA are with RMSD &lt; 4 Å, whereas no models from RNAComposer and SimRNA can achieve this accuracy. These data demonstrate the superiority of the proposed pipeline over traditional RNA structure prediction methods.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison between trRosettaRNA, SimRNA, and RNAComposer on 30 independent RNAs</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Methods</th><th>Average RMSD (±std.) (Å)</th><th>Ratio of accurate models (RMSD &lt; 4 Å)</th><th><italic>P</italic>-value</th></tr></thead><tbody><tr><td>SimRNA</td><td>17.1 ( ± 5.2)</td><td>0%</td><td>1.1E-7</td></tr><tr><td>RNAComposer</td><td>17.4 ( ± 6.8)</td><td>0%</td><td>1.3E-6</td></tr><tr><td>trRosettaRNA</td><td>8.5 ( ± 5.7)</td><td>20%</td><td>-</td></tr></tbody></table><table-wrap-foot><p>Please note that the evaluation here is on the first model predicted by each method. The <italic>P</italic>-values presented here were calculated by two-tailed Student’s <italic>t</italic>-tests. No adjustments were made for multiple comparisons. Source data are provided as a Source Data file.</p></table-wrap-foot></table-wrap></p>
      <p id="Par11">We further analyze the impact of the input features (i.e., MSA and secondary structure). The MSA quality is measured by the alignment depth, i.e., the logarithm of the effective number (denoted by log(<italic>N</italic><sub><italic>eff</italic></sub>)) of homologous sequences with &lt;80% sequence identity. As shown in Fig. <xref rid="MOESM1" ref-type="media">S2b</xref>, the RMSD of the trRosettaRNA model is correlated with log(<italic>N</italic><sub><italic>eff</italic></sub>) (Pearson correlation coefficient, PCC = −0.32). trRosettaRNA outperforms RNAComposer and SimRNA at all log(<italic>N</italic><sub><italic>eff</italic></sub>) levels, especially on targets with high log(<italic>N</italic><sub><italic>eff</italic></sub>) values. For the models by RNAComposer and SimRNA, the correlations between the RMSDs and the alignment depth are weak (PCCs are −0.05 and 0.21, respectively), probably because they do not use MSA during modeling. In contrast, there is a stronger correlation between the RMSDs of the predicted models and the accuracy of the predicted secondary structures (measured by F1-score) for all methods (PCCs are −0.35, −0.31, and −0.29 for trRosettaRNA, SimRNA, and RNAComposer, respectively, Fig. <xref rid="MOESM1" ref-type="media">S2c</xref>). This is consistent with the observations that precise RNA secondary structure prediction plays a key role in successful 3D structure modeling<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>.</p>
      <p id="Par12">To provide a more direct demonstration of the contribution of MSA to the RNA structure prediction, we also evaluate the performance of trRosettaRNA when MSAs are excluded. As shown in Fig. <xref rid="MOESM1" ref-type="media">S3</xref>, for 21 out of the 30 RNAs, the introduction of MSAs helps improve the accuracy of the predicted models. Fig. <xref rid="MOESM1" ref-type="media">S4</xref> presents the MSAs for two example RNAs (PDB IDs: <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb5KH8/pdb">5KH8</ext-link>/<ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb7D7V/pdb">7D7V</ext-link>). The coevolutionary information extracted from these MSAs not only covers the majority of 2D base-pairing interactions but also encompasses some 3D interactions (highlighted by green circles in the 2D maps of Fig. <xref rid="MOESM1" ref-type="media">S4</xref>). With the assistance of MSAs, trRosettaRNA can generate more accurate models for these two RNAs (refer to the bottom right of each subfigure in Fig. <xref rid="MOESM1" ref-type="media">S4</xref>).</p>
      <p id="Par13">As the secondary structure used in trRosettaRNA is predicted by SPOT-RNA, it is important to consider the possibility of inaccurate predictions by SPOT-RNA. Among the 30 RNAs in the dataset, there are 8 RNAs for which SPOT-RNA failed to predict accurate secondary structures (i.e., F1-score &lt;0.5). Table <xref rid="MOESM1" ref-type="media">S1</xref> reveals that for 6 of these 8 RNAs, the secondary structures of trRosettaRNA models are more accurate than those predicted by SPOT-RNA. In Fig. <xref rid="MOESM1" ref-type="media">S5a</xref>, it is evident that trRosettaRNA corrects certain false positive base pairs, which are highlighted by red circles. Furthermore, trRosettaRNA identifies some interactions that were missed by SPOT-RNA, as indicated by the green circles in Fig. <xref rid="MOESM1" ref-type="media">S5a</xref>. These observations suggest that trRosettaRNA can correct incomplete or inaccurate secondary structures, although its accuracy is correlated with the quality of the input secondary structures.</p>
      <p id="Par14">Nevertheless, when considering the entire set of 30 RNAs, trRosettaRNA exhibits a slight drop in the average F1-score of secondary structures, decreasing it from 0.65 to 0.6 (as shown in Fig. <xref rid="MOESM1" ref-type="media">S5b</xref>). This decrease is mainly from the cases where the secondary structures predicted by SPOT-RNA are accurate (F1-score &gt; 0.6). This may be caused by the potential conflicts between the predicted distance restraints and the base pair restraints, which are not trival to resolve, especially for targets modeled with low confidence.</p>
      <p id="Par15">However, as a data-driven method, the performance of trRosettaRNA is influenced by the structural homology existing between the target RNA and previously solved RNA structures, which is measured by the maximum TM-score<sub>RNA</sub>. As shown in Fig. <xref rid="MOESM1" ref-type="media">S2d</xref>, the correlation between the structural homology and the RMSD of trRosettaRNA models is stronger compared to SimRNA and RNAComposer (PCCs are −0.6, −0.0003, and −0.05, respectively). For five RNAs lacking homolog match (i.e., maximum TM-score<sub>RNA</sub> with solved RNAs below 0.45), the average RMSD of trRosettaRNA models is 15.8 Å. This value significantly drops to 7.0 Å for the remaining 25 RNAs possessing structural homologs. This discrepancy may be due to the current limitation in the number of solved RNA structures within the PDB database, which in turn impacts the performance of data-driven methods on RNAs with novel structures. Nevertheless, for the 5 RNAs without structural homologs, the average RMSD of the models by trRosettaRNA (15.8 Å) remains lower than SimRNA (20.6 Å) and RNAComposer (24.3 Å), illustrating the superiority of the deep-learning method over traditional methods for automated prediction.</p>
    </sec>
    <sec id="Sec5">
      <title>Performance of trRosettaRNA on RNA-Puzzles targets</title>
      <p id="Par16">We further test trRosettaRNA on 20 targets from the RNA-Puzzles experiments<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>. The target information and the prediction results are summarized in Tables <xref rid="MOESM1" ref-type="media">S2</xref> and <xref rid="MOESM1" ref-type="media">S3</xref>, respectively. It turns out that these targets are harder to predict than the 30 independent RNAs, as revealed by the increased value of RMSD (from 8.5 Å to 10.5 Å).</p>
      <p id="Par17">We compare the trRosettaRNA predictions with the original submissions from the RNA-Puzzles experiments. According to the official assessments<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>, the most accurate approach is the Das group, which submitted models for 17 targets. Table <xref rid="MOESM1" ref-type="media">S3</xref> summarizes the results on these targets for the models from the Das group (denoted by Das) and the best of the models from all groups (denoted by PZ_best). On these 17 targets, the average RMSD of the first predicted models by our method is 10.3 Å, compared with 9.3 Å and 7.2 Å from Das and PZ_best, respectively. For 9 of the 17 targets, the trRosettaRNA models are more accurate than the Das models. Similar observations can be obtained when all the five submitted models are assessed (Table <xref rid="MOESM1" ref-type="media">S3</xref>). Note that certain participating groups may utilize human experts and/or literature data to guide the modeling during the prediction seasons of the RNA-Puzzles experiments. In contrast, the trRosettaRNA predictions, which are fully automated, achieve similar accuracy to the top human groups.</p>
      <p id="Par18">To obtain a more comprehensive understanding of the quality of trRosettaRNA models, we employ other evaluation measures used in the RNA-Puzzles assessment, in addition to RMSD (Table <xref rid="MOESM1" ref-type="media">S4</xref>). These measures include the deformation index (DI; evaluating the predicted structures with both RMSDs and base interactions; lower is better)<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>, the Interaction Network Fidelity (INF; evaluating the interactions in the predicted structure; higher is better)<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>, and MolProbity clash scores (number of serious steric overlaps per 1000 atoms in a structure; lower is better)<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. The average clash score of the trRosettaRNA models (3.2) is significantly lower than that of the Das models (10.8), indicating that trRosettaRNA not only achieves higher accuracy but also produces higher-quality models. Nevertheless, trRosettaRNA models exhibit worse INF and DI scores than the Das models. This can be explained by the inherent features of our methodology. First, the secondary structures used by trRosettaRNA are predicted rather than from experiments, literature, or human annotation. These predicted secondary structures may provide inaccurate interaction information to the transformer network. Second, trRosettaRNA uses predicted geometry restraints rather than fragment assembly to derive the secondary structures. Both factors may lead to less accurate local base-base interactions in the trRosettaRNA models.</p>
    </sec>
    <sec id="Sec6">
      <title>Blind test in CASP15</title>
      <p id="Par19">Based on trRosettaRNA, we participated in the blind test of the CASP15 experiment on RNA structure prediction as an automated server (group name Yang-Server). The Yang-Server models for the 12 CASP15 RNAs are shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. According to the official ranking, Yang-Server is ranked the 9<sup>th</sup> out of 42 RNA structure prediction groups (including 33 human groups and 9 server groups). Yang-Server is ranked second (after the UltraFold_Server) when considering automated server groups only. Note that the official ranking considers both global and local accuracy, including TM-score<sub>RNA</sub>, GDT-TS score, INF, lDDT, and steric clash; while the main objective optimized in trRosettaRNA is RMSD. Based on the cumulative Z-score of RMSD ( &gt; 0.0), Yang-Server’s ranking is improved: 5<sup>th</sup>/42 for all groups and 1<sup>st</sup>/9 for server groups (Fig. <xref rid="MOESM1" ref-type="media">S6</xref>). Yang-Server also achieves a higher ranking than other deep learning-based groups such as AIchemy_RNA (based on RhoFold<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>), BAKER (based on RoseTTAFoldNA<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>), and DF_RNA (based on DeepFoldRNA<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>) in terms of the Z-score of RMSD. According to the RNA-Puzzles assessment<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>, the Yang-Server predictions (though not perfect) for two protein-binding targets (R1189 and R1190) are the most accurate among all submitted models (with RMSDs of 16.3 Å and 16.0 Å, respectively). This result demonstrates the potential of our method in predicting protein-binding RNAs even in the absence of binding partner information, though the accuracy is far from satisfactory.<fig id="Fig2"><label>Fig. 2</label><caption><title>Yang-Server models (red) versus experimental structures (gray) for 12 CASP15 targets.</title><p>Consistent with Table <xref rid="Tab2" ref-type="table">2</xref>, the best-submitted models are shown here. The 3D structures are presented using PyMOL.</p></caption><graphic xlink:href="41467_2023_42528_Fig2_HTML" id="d32e818"/></fig></p>
      <p id="Par20">The 12 RNAs in CASP15 can be classified into two categories based on their sources: eight of them are natural, while the remaining four are synthetic. On the eight natural RNAs, Yang-Server yields comparable results to the top human group, AIchemy_RNA2 (mean RMSDs of the first/best in five models: 14.8/12.9 Å versus 15.7/11.3 Å; Table <xref rid="Tab2" ref-type="table">2</xref> and S<xref rid="MOESM1" ref-type="media">5</xref>). It is worth noting that trRosettaRNA does not consider structural templates, which may be crucial in improving the modeling accuracy. For example, for the targets, R1107, R1108, and R1149, secondary structure templates can be easily found in the RFAM database (version 14.4, released in December 2020) using an automated process<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. With these secondary structure templates, trRosettaRNA predicts much more accurate 3D structures than the models submitted during the CASP15 season (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). The RMSD values are reduced from 17.9 Å, 9.1 Å, and 13.9 Å to 4.3 Å, 4.8 Å, and 10.6 Å, for R1107, R1108, and R1149, respectively, competitive to the models by AIchemy_RNA2 (i.e., 4.5 Å, 4.5 Å, and 10.5 Å). Thus we believe that the fusion of high-quality secondary structure templates and deep-learning techniques can improve the performance further.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Results for 12 RNA targets in CASP15</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">Target type</th><th rowspan="2">Target ID</th><th colspan="6">RMSD (Å)</th></tr><tr><th>Yang-Server</th><th>AIchemy_RNA2</th><th>Chen</th><th>RNApolis</th><th>Deep learning best<sup>a</sup></th><th>Overall best</th></tr></thead><tbody><tr><td rowspan="9">Natural</td><td>R1107</td><td>17.9 (4.3<sup>b</sup>)</td><td>4.5</td><td>6.5</td><td>8.8</td><td>5.9</td><td>4.5</td></tr><tr><td>R1108</td><td>9.1 (4.8<sup>b</sup>)</td><td>4.5</td><td>6.0</td><td>8.5</td><td>4.8</td><td>4.5</td></tr><tr><td>R1116</td><td>10.9</td><td>17.3</td><td>18.0</td><td>12.7</td><td>7.9</td><td>4.8</td></tr><tr><td>R1117</td><td>2.7</td><td>2.3</td><td>2.0</td><td>2.7</td><td>2.7</td><td>2.0</td></tr><tr><td>R1149</td><td>13.9 (10.6<sup>b</sup>)</td><td>10.5</td><td>14.0</td><td>18.2</td><td>6.9</td><td>6.9</td></tr><tr><td>R1156</td><td>16.6</td><td>7.6</td><td>11.0</td><td>17.1</td><td>12.9</td><td>5.4</td></tr><tr><td>R1189</td><td>16.3</td><td>22.0</td><td>21.2</td><td>18.7</td><td>22.8</td><td>16.3</td></tr><tr><td>R1190</td><td>16.0</td><td>22.0</td><td>18.8</td><td>22.4</td><td>22.2</td><td>16.0</td></tr><tr><td>Average</td><td>12.9 (10.3<sup>b</sup>)</td><td>11.3</td><td>12.2</td><td>13.6</td><td>10.8</td><td>7.5</td></tr><tr><td rowspan="5">Synthetic</td><td>R1126</td><td>32.7</td><td>8.8</td><td>12.6</td><td>20.0</td><td>30.2</td><td>8.9</td></tr><tr><td>R1128</td><td>22.3</td><td>4.3</td><td>6.7</td><td>14.6</td><td>14.3</td><td>4.3</td></tr><tr><td>R1136</td><td>41.6</td><td>7.3</td><td>10.9</td><td>11.0</td><td>27.3</td><td>7.2</td></tr><tr><td>R1138</td><td>40.8</td><td>7.8</td><td>12.3</td><td>9.6</td><td>35.5</td><td>7.8</td></tr><tr><td>Average</td><td>34.4</td><td>7.0</td><td>10.6</td><td>13.8</td><td>26.8</td><td>7.0</td></tr><tr><td colspan="2">Overall average</td><td>20.1 (18.3<sup>b</sup>)</td><td>9.9</td><td>11.2</td><td>13.7</td><td>16.1</td><td>7.4</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>According to the CASP15 abstracts, there are 14 RNA prediction groups utilizing deep learning-based methods to predict RNA structures.</p><p><sup>b</sup>trRosettaRNA results with secondary structure templates as inputs.</p><p>For all compared groups, we evaluate their best-submitted models for each target. The evaluation based on the first predicted model is shown in Table <xref rid="MOESM1" ref-type="media">S5</xref>.</p></table-wrap-foot></table-wrap><fig id="Fig3"><label>Fig. 3</label><caption><title>Results for three targets from CASP15 for which the template secondary structures can be found in the Rfam database.</title><p>The RNA secondary structure visualization was employed with forna<sup><xref ref-type="bibr" rid="CR52">52</xref></sup>. The template search and 2D structure modelling were employed with R2DT program<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. For the 3D modelling results, we present the best model submitted by Yang-Server (in red), the trRosettaRNA model based on 2D templates (in blue) and the AIchemy_RNA2 best model (in green). Both predicted 3D structures are superimposed onto the experimental structures (gray). For Yang-Server models, the RMSD and eRMSD values are shown in SPOT-RNA-based/R2DT-based format.</p></caption><graphic xlink:href="41467_2023_42528_Fig3_HTML" id="d32e1267"/></fig></p>
      <p id="Par21">Nevertheless, when it comes to the modeling of synthetic RNAs, there is a notable margin between all the deep learning-based groups (including ours) and the top human groups such as AIchemy_RNA2 (the bottom half of Tables <xref rid="Tab2" ref-type="table">2</xref> and S<xref rid="MOESM1" ref-type="media">5</xref>). Note that the top groups for these targets are all based on human-intervented simulations rather than automated modeling. For example, the leading group AIchemy_RNA2 model predicted RNA structure based on the assembly of manually-detected RNA structural motifs followed by full atom optimization with the BRiQ statistical potential<sup><xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup>.</p>
      <p id="Par22">The challenge in the automated structure prediction of synthetic RNAs may be explained by a few factors. First, the deep learning-based approach may be biased towards the limited training data, which are mainly from natural RNAs. The synthetic RNAs lack globally homologous RNA sequences and similar structures to the existing RNAs (the maximum TM-score<sub>RNA</sub> is around 0.3), which may hinder the neural networks from inferring meaning predictions. Second, the human groups were given a three-week deadline for each target, allowing the elaborate human-expert interventions in the modeling procedure. In contrast, the Yang-Server predictions for each target were generated automatically in three days. As a fair comparison, we run the SimRNA package and RNAComposer server with the same secondary structures used by Yang-Server as inputs. The results show no superiority to the Yang-Server models (Fig. <xref rid="MOESM1" ref-type="media">S7</xref>). This highlights the inherent challenge in automated modeling for these synthetic RNAs, which applies to both conventional and deep learning-based methods.</p>
      <p id="Par23">For example, R1138 contains a few helix hinges and kissing loops, which play important roles in the folding of the overall structure. While the automated methods successfully establish satisfactory local interaction networks (with INF value of ~0.7), the predicted models still deviate significantly from the experimental structure when considering the global 3D topologies (Fig. <xref rid="MOESM1" ref-type="media">S8b</xref>). Accurately predicting the kissing loops (such as the one highlighted by the black circle) and the helix hinges in R1138 poses a significant challenge for automated methods, despite the recurrence of these motifs across numerous RNA structures. To illustrate, trRosettaRNA correctly predicted the highlighted kissing loop (highlighted by the black circle on the predicted distance map in Fig. <xref rid="MOESM1" ref-type="media">S9b</xref>). Utilizing this limited set of distance restraints, trRosettaRNA can successfully generate an accurate structure of the kissing loop (Fig. <xref rid="MOESM1" ref-type="media">S9a</xref>). However, this particular kissing loop was not predicted correctly when modeling the structure globally, probably due to the complicated interactions between other motifs (Fig. <xref rid="MOESM1" ref-type="media">S9c</xref>). This reflects the modeling difficulty of such synthetic RNA by automated approaches. As mentioned by AIchemy_RNA2, the accurate modeling of these synthetic RNAs requires extensive human-expert interventions, involving template detection, secondary structure determination, motif assignment, and more<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>.</p>
      <p id="Par24">As the primary focus of our method is to optimize the global RMSD, it is also worthwhile to investigate other metrics (Table <xref rid="MOESM1" ref-type="media">S6</xref>). In addition to the INF and MolProbity clash score mentioned above, we also evaluate the Local Distance Difference Test (lDDT<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>) score, which measures the local inter-residue distance error and has been widely used to evaluate protein structure models. In terms of the two local metrics (INF and lDDT), the Yang-Server models show a notable margin with AIchemy_RNA2 for both natural and synthetic RNAs. This discrepancy can be attributed to the reasons mentioned earlier, namely, the inaccurate input secondary structures and the methodological differences between the two approaches (deep learning-based versus fragment assembly-based). The integration of local fragment segments and deep-learning techniques is promising for bridging this gap in the future.</p>
      <p id="Par25">During CASP15, our method did not consider steric clashes in modeling, resulting in high clash scores (&gt;20) for our submitted models. This might impact our official ranking which considers both modeling accuracy and steric clashes. According to the CASP15 assessments<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>, Yang-Server is ranked 26<sup>th</sup> out of the 42 groups in terms of clash score, worse than AIchemy_RNA and BAKER. We addressed this issue after CASP15 by implementing an additional refining step at the end of the energy minimization procedure. Consequently, the average clash score of the 12 CASP15 targets dropped significantly from 33.84 to 3.05, which is much lower than that of AIchemy_RNA2 (16.68).</p>
    </sec>
    <sec id="Sec7">
      <title>Blind test on the latest RNA-Puzzles targets</title>
      <p id="Par26">In addition to our participation in CASP15, we also took part in the blind tests of three RNA-Puzzles targets as an automated server group named Yang. These targets include PZ37 (PDB ID: <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb8GXC/pdb">8GXC</ext-link>; a ligand-binding dimer), PZ38 (PDB ID: <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb8HB8/pdb">8HB8</ext-link>; a ligand-binding riboswitch), and PZ39 (PDB ID: <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb8DP3/pdb">8DP3</ext-link>; a protein-binding cloverleaf RNA). The results are summarized in Fig. <xref rid="Fig4" ref-type="fig">4a, b</xref>.<fig id="Fig4"><label>Fig. 4</label><caption><title>Blind test results and comparison with other deep learning-based methods.</title><p><bold>a</bold>, <bold>b</bold> blind test results on the latest three targets from RNA-Puzzles. <bold>a</bold> RMSD comparison of the models submitted by Yang group and models from other groups. <bold>b</bold> the best models submitted by Yang group (red) superposed to the experimental structures (gray). <bold>c</bold> head-to-head RMSD comparison between trRosettaRNA and other deep learning-based methods (<italic>n</italic> = 15 RNAs from the blind tests of CASP15 and RNA-Puzzles). The dashed horizontal and vertical lines correspond to an RMSD of 4 Å. The bar plots show the RMSD distributions. The red circles highlight the two cases (R1107 and R1108) in which trRosettaRNA can achieve better results with improved secondary structures. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_42528_Fig4_HTML" id="d32e1377"/></fig></p>
      <p id="Par27">In the case of PZ37/PZ38, our results (RMSD 10.3 Å/8.7 Å) are highly competitive, ranking at 3/3 out of 16/15 participating groups, and only surpassed by the human groups Chen and Szachniuk. It is worth noting that our predictions were fully automated and did not consider the ligand or dimer information, making our results impressive. However, we notice that the first model chosen for PZ38 is the worst among the five submitted models, with an RMSD of 14.4 Å, compared to 8.7 Å of the best model. This reflects that while trRosettaRNA exhibits the capability to produce models with commendable accuracy, there remains potential for model ranking.</p>
      <p id="Par28">For the target PZ39, the RMSD of our models are higher than 15 Å. PZ39 has no similar sequence (according to BLASTN search at an e-value cutoff of 10) nor similar structure (according to TM-score<sub>RNA</sub> &gt; 0.45) from the known RNAs. This may account for the poor performance of our method on this target. Nonetheless, local motif templates can be found for this RNA. For example, for the fragment consisting of residues 20 to 26 which forms the Fab binding site, it is easy to identify the same fragments in known Fab-binding RNAs (e.g., in PDB IDs: <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb6DB9/pdb">6DB9</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb3IVK/pdb">3IVK</ext-link>). Given the limited data of available RNA 3D structure, a promising approach to improving may be based on the combination of deep learning with conventional physics-based and/or fragment assembly-based methods.</p>
    </sec>
    <sec id="Sec8">
      <title>Comparison with other deep learning-based methods</title>
      <p id="Par29">During the preparation of this manuscript, another three deep learning-based approaches (DeepFoldRNA, RoseTTAFoldNA, and RhoFold) were posted. As mentioned above, trRosettaRNA achieves a higher summed Z-score of RMSD than these methods in the blind test of the CASP15 competition. We further conducted head-to-head comparisons between these methods on RNAs from the blind tests (CASP15 and RNA-Puzzles). For each target from blind tests, we used the result of the first submitted models if available; otherwise, we ran the program locally to predict the structure model.</p>
      <p id="Par30">The results show that trRosettaRNA achieves a 3.3/2.1 Å lower RMSD than DeepFoldRNA/RoseTTAFoldNA (orange/purple points in Fig. <xref rid="Fig4" ref-type="fig">4c</xref>) on the 15 RNAs from the blind tests. For 11/9 out of these 15 RNAs, the trRosettaRNA predictions are more accurate than those by DeepFoldRNA/RoseTTAFoldNA. The average RMSD of trRosettaRNA models (21.3 Å) is marginally higher than RhoFold models (20.6 Å; P-value = 0.9; blue points in Fig. <xref rid="Fig4" ref-type="fig">4c</xref>), which is inconsistent with the comparison based on the Z-score of RMSD (i.e., Fig. <xref rid="MOESM1" ref-type="media">S6</xref>). This slight difference is mainly due to the poor performance of trRosettaRNA on two CASP15 RNAs (17.9 Å for R1107 and 9.1 Å for R1108; compared to 5.9 Å and 5.4 Å for RhoFold, respectively; highlighted by red circle in Fig. <xref rid="Fig4" ref-type="fig">4c</xref>). As mentioned above (see also Fig. <xref rid="Fig3" ref-type="fig">3</xref>), this performance gap can be effectively bridged by employing more confident secondary structures as inputs. For the remaining 13 RNAs, the average RMSD of trRosettaRNA (22.5 Å) is slightly lower than RhoFold (22.9 Å). Moreover, trRosettaRNA outperforms RhoFold for 8 out of the remaining 13 RNAs.</p>
      <p id="Par31">To summarize, trRosettaRNA outperforms DeepFoldRNA and RoseTTAFoldNA, and is competitive with RhoFold in blind tests, highlighting its robustness.</p>
    </sec>
    <sec id="Sec9">
      <title>Impact of the predicted 1D and 2D geometries</title>
      <p id="Par32">The geometries predicted by the RNAformer network consist of 1D orientations and 2D contacts, distances, and orientations (Fig. <xref rid="MOESM1" ref-type="media">S1</xref>). To analyze their contributions, we compare the modeling results using different geometries on the 30 RNA-Puzzles targets (Fig. <xref rid="Fig5" ref-type="fig">5a</xref> and Table <xref rid="MOESM1" ref-type="media">S7</xref>). Using the 2D distance restraints only, trRosettaRNA achieves a reasonable RMSD of 11.34 Å. This value is reduced to 10.79 Å when the 1D and 2D orientations are included. Furthermore, with the help of 2D contacts, the RMSD drops to 10.51 Å. We use the target PZ11 (PDB ID: <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb5LYS/pdb">5LYS</ext-link>) to show the impacts of different restraints. As shown in Fig. <xref rid="Fig5" ref-type="fig">5b</xref>, using 2D distance restraints only, trRosettaRNA can generate a structure model with an RMSD of 10.5 Å. However, the helix at the 5’-end and 3’-end (highlighted by the green square in Fig. <xref rid="Fig5" ref-type="fig">5b</xref>) is wrongly twisted. The introduction of 1D and 2D orientations fixes the wrong twist of this region. The 2D contact restraints further refine the structure, resulting in a more accurate model with 6.7 Å RMSD.<fig id="Fig5"><label>Fig. 5</label><caption><title>Summary of the folding results by different restraints.</title><p><bold>a</bold> contribution of the various restraints to the trRosettaRNA modeling accuracy in terms of the RMSD for the 20 RNA-Puzzles targets (<italic>n</italic> = 20 RNAs). <bold>b</bold> an example (PZ11) to illustrate the impact of different restraints. The predicted models (red cartoon) are superposed to the experimental structures (gray cartoon). The green square highlights the helix region which is influenced by the introduction of more restraints. <bold>c</bold> head-to-head comparison between the estimated and real RMSD for all RNAs in the benchmark datasets (<italic>n</italic> = 50 RNAs). <bold>d</bold> the relationship between the running time and the sequence length on 1752 Rfam families. The 2D geometry predictions (orange dots) were run on one GPU card. The 3D structure folding was performed on one CPU core. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_42528_Fig5_HTML" id="d32e1472"/></fig></p>
    </sec>
    <sec id="Sec10">
      <title>Confidence score of the predicted structure models</title>
      <p id="Par33">To guide real-world application, the confidence scores of the predicted protein structure models have been estimated reliably in trRosetta<sup><xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref></sup>. A similar estimation can be extended to trRosettaRNA. Specifically, we first calculate a few variables reflecting the confidence of the predicted distance maps and the convergence of the first structure models (see Methods for more details). Then a linear regression on these variables is employed to fit the RMSD values. For the RNAs from the benchmark datasets, the estimated RMSDs (eRMSDs) correlate well with the real RMSDs of the predicted models (PCC = 0.56, Fig. <xref rid="Fig5" ref-type="fig">5c</xref>). Moreover, the eRMSD metric also roughly reflects the modeling difficulty for the 12 CASP15 targets, with an average value of 17.2 Å.</p>
      <p id="Par34">As a practical application, for the three CASP15 RNAs (R1107, R1108, and R1149) with reliable secondary structure templates, the defined eRMSD effectively captures the improvements from the introduction of these templates (Fig. <xref rid="Fig3" ref-type="fig">3</xref> and Table <xref rid="MOESM1" ref-type="media">S5</xref>). Additionally, in 6 out of the 8 cases where SPOT-RNA provided inaccurate secondary structures, the eRMSD successfully helps identify models with more accurate input of secondary structures (Table <xref rid="MOESM1" ref-type="media">S1</xref>). These observations highlight the promising potential of eRMSD in facilitating the optimal selection between predictions from various inputs.</p>
    </sec>
    <sec id="Sec11">
      <title>Analysis of the running time</title>
      <p id="Par35">We decompose the running time of trRosettaRNA into two parts: 2D geometry prediction and 3D structure generation. The time for MSA generation is not discussed here as it can be flexible depending on the searching algorithms and sequence databases. Fig. <xref rid="Fig5" ref-type="fig">5d</xref> shows that trRosettaRNA spends most time in the generation of 3D structure (&gt; 95%). With the increase in sequence length, the running time increases linearly. In general, it takes &lt;30 min to complete the prediction for a typical RNA with &lt;200 nucleotides.</p>
    </sec>
    <sec id="Sec12">
      <title>Application to Rfam families with unknown structures</title>
      <p id="Par36">It remains challenging to solve RNA structures by experiment. For example, only 123 out of the 3938 families in the Rfam database (version 14.4) have experimentally resolved 3D structures<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. We sought to predict the structures for the Rfam families that have no experimental structures. We collected 1752 unsolved families that are 50–200 nucleotides long and have more than 30 members. For each family, we use its consensus secondary structure along with the MSA derived from the consensus sequence as the input features to trRosettaRNA. Most of these families are not predicted well, with eRMSD &gt; 10 Å for 891 out of 1752 families (Fig. <xref rid="Fig6" ref-type="fig">6a</xref>). This may reflect the difficulty of determining the structures for these families.<fig id="Fig6"><label>Fig. 6</label><caption><title>Application of trRosettaRNA to Rfam families with unknown structures.</title><p><bold>a</bold> eRMSD (i.e., estimated RMSD) distributions of the predicted structure models (<italic>n</italic> = 1752 Rfam families). <bold>b</bold> six selected example families with eRMSD &lt;4 Å. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_42528_Fig6_HTML" id="d32e1537"/></fig></p>
      <p id="Par37">Nevertheless, trRosettaRNA does predict accurate structures for 263 families with eRMSD &lt;4 Å. For 27 of these families, the predicted structure models do not have any similar structures in PDB according to the program RNAalign (TM-score<sub>RNA</sub><sup><xref ref-type="bibr" rid="CR42">42</xref></sup> ≥ 0.45). In Fig. <xref rid="Fig6" ref-type="fig">6b</xref>, we show the predicted structures for 6 families with distinct topologies. These high-confidence models are anticipated to provide a structural basis for understanding their biological functions and guide their experimental determinations. For example, for the family sul1 RNA (<ext-link ext-link-type="uri" xlink:href="https://rfam.org/search?q=RF01070">RF01070</ext-link>) which encodes a subunit of an enzyme participating in the citric acid cycle, trRosettaRNA can generate a confident model with an estimated RMSD of 1.6 Å. The trRosettaRNA models for the 263 families with eRMSD &lt;4 Å are available on our website (<ext-link ext-link-type="uri" xlink:href="https://yanglab.qd.sdu.edu.cn/trRosettaRNA/rfam/">https://yanglab.qd.sdu.edu.cn/trRosettaRNA/rfam/</ext-link>).</p>
    </sec>
  </sec>
  <sec id="Sec13" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par38">We have developed trRosettaRNA, an automated approach to RNA 3D structure prediction with the transformer network. We have rigorously assessed trRosettaRNA with two independent datasets and two blind tests. The benchmark tests show that trRosettaRNA predicts more accurate models than the other automated methods. trRosettaRNA was assessed blindly in two experiments: RNA-Puzzles (3 targets) and CASP15 (12 targets). The RNA-Puzzles experiments show that the automated predictions by trRosettaRNA are competitive with the top human predictions for 2 out of 3 targets. The CASP15 experiments show that trRosettaRNA outperforms other deep learning-based methods in terms of the cumulative Z-score based on RMSD. Our method achieves comparable accuracy to the top human groups on 8 natural RNAs, though without any human interventions.</p>
    <p id="Par39">However, we notice that the average RMSD on the natural RNAs from the CASP15 blind test (14.8 Å for the first models) is higher than that on the RNAs from the two benchmark datasets (8.5 Å for 30 independent RNAs and 10.5 Å for 20 previous RNA-Puzzles targets). The disparity in the modeling accuracy may be explained by the target difficulty and novelty. (1) target difficulty. Most of the CASP15 RNAs exhibit high flexibility and can adopt multiple conformations (except for R1116 and R1117)<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. In addition, there are two dimers (R1107, R1108) and two protein-binding RNAs with many single-strand regions (R1189, R1190). These features pose challenges for SPOT-RNA in predicting confident secondary structures. To illustrate, the average F1-score of the predicted secondary structure by SPOT-RNA is much lower for the 8 natural RNAs from CASP15 in contrast to the 20 RNA-Puzzles targets (0.62 and 0.72, respectively). (2) target novelty. A significant proportion of RNAs (two-thirds, 20 out of 30) from the non-redundant benchmark dataset exhibit high similarities (TM-score<sub>RNA</sub> &gt; 0.6) to previously known RNAs, making them easy to predict for data-driven methods like trRosettaRNA. On the contrary, none of the RNAs from CASP15 show such a level of similarity (Fig. <xref rid="MOESM1" ref-type="media">S10</xref>).</p>
    <p id="Par40">This reflects the limitations associated with trRosettaRNA and the benchmark tests employed in this work. First, the performance of trRosettaRNA is susceptible to the quality of predicted secondary structures. Secondly, though trRosettaRNA achieves promising accuracy in the internal benchmark tests, its performance on novel RNAs remains limited. Moreover, the automated structure prediction of synthetic RNAs remains challenging.</p>
    <p id="Par41">The blind tests in CASP15 experiments suggest that the deep learning approach to RNA structure prediction is still in its infancy. Nevertheless, with consistent development, deep learning should be promising to advance RNA structure prediction. Incorporation of physics-based modeling into deep learning is one of the directions to improve in the future. One of the most instant alternatives is to combine it with other conventional approaches and optimize the algorithms toward those under-represented RNA structures in the future. For example, to overcome the bias toward known RNA folds, neural networks (such as with physics-informed neural networks<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>) can be utilized to learn force fields or to recognize/assemble local motifs instead of directly predicting the global 3D structures.</p>
  </sec>
  <sec id="Sec14">
    <title>Methods</title>
    <sec id="Sec15">
      <title>trRosettaRNA algorithm</title>
      <p id="Par42">As shown in Fig. <xref rid="Fig1" ref-type="fig">1a</xref>, the full pipeline of trRosettaRNA consists of three major steps: preparation of input data, prediction of 1D and 2D geometries, and generation of 3D structure.</p>
    </sec>
    <sec id="Sec16">
      <title>Step 1. Preparation of input data</title>
      <p id="Par43">For a given query RNA, the first step of trRosettaRNA is to prepare an MSA and a secondary structure. Two different MSAs are generated for each query sequence. The first is generated by using the program rMSA against multiple sequence databases (NCBI’s nt, Rfam, and RNAcentral<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>). The second is obtained by running the program Infernal<sup><xref ref-type="bibr" rid="CR45">45</xref></sup> against the smaller database RNAcentral with two iterations, which is very fast. Then we select the final MSA based on the qualities of the predicted distance maps (measured by the average of standard deviations of the probability values of each nucleotide pair, Fig. <xref rid="MOESM1" ref-type="media">S11</xref>). The secondary structure is predicted by SPOT-RNA<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> from the query sequence. Here we use the predicted probability matrix as the input, which contains more information than the dot-bracket representation.</p>
    </sec>
    <sec id="Sec17">
      <title>Step 2. Prediction of 1D and 2D geometries</title>
      <p id="Par44">The second step of trRosettaRNA is to predict the 1D and 2D geometries by deep learning. We design a transformer network (named RNAformer) similar to the network Evoformer in AlphaFold2. At the very start, the input MSA and secondary structure are converted into two representations, i.e., the MSA representation (i.e., MSA embedded by nucleotide types) and the pair representation (including the direct couplings derived from MSA and the probability matrix of the predicted secondary structure). We adopt a transformer-based module (i.e., RNAformer) to update both representations. More specifically, each block of RNAformer can be divided into four steps according to the update direction (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>).<list list-type="order"><list-item><p id="Par45"><bold>MSA to MSA</bold>. To update the MSA representation by itself, we perform row- and column-wise gated self-attention operations and combine the corresponding results. A feed-forward layer is employed to introduce nonlinearity. Note that the pair information participates in the row-wise attention by adding bias to the attention maps.</p></list-item><list-item><p id="Par46"><bold>MSA to pair</bold>. We perform an outer product operation on the self-updated MSA representation to transform it into the pair format. In detail, the MSA representation is linearly projected to a smaller dimension. Then for the nucleotide pair (<italic>i</italic>, <italic>j</italic>), the outer products of the vectors from the <italic>i</italic><sup>th</sup> and the <italic>j</italic><sup>th</sup> columns of the MSA representation are averaged over the homologous sequences to update the representation for this pair.</p></list-item><list-item><p id="Par47"><bold>Pair to pair</bold>. After the above step, we perform the triangle updates, followed by a feed-forward layer. For each triangle update layer, we use a multi-scale network Res2Net<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> to enhance the ability to model the local details.</p></list-item><list-item><p id="Par48"><bold>Pair to MSA</bold>. The updated pair representation is then linearly projected to the pair-wise attention maps, which are then multiplied on the MSA representation, followed by a feed-forward layer.</p></list-item></list></p>
      <p id="Par49">A single-pass RNAformer consists of 48 blocks, which are cycled 4 times in the complete inference (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). The final predicted probability distributions of the 2D geometries are derived from the updated pair representation via linear layers and softmax operations. To predict the 1D geometry, we transform the MSA representation into 1D representation by row-wise weighted summation, followed by linear layers and softmax operations to obtain the predicted probabilities.</p>
    </sec>
    <sec id="Sec18">
      <title>Step 3. Generation of full-atom structure models</title>
      <p id="Par50">Similar to trRosetta, trRosettaRNA generates full-atom structure models by energy minimization with deep learning potentials and physics-based energy terms in Rosetta.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E={w}_{1}{E}_{dist}+{w}_{2}{E}_{ori}+{w}_{3}{E}_{cont}+{w}_{4}{E}_{ros}$$\end{document}</tex-math><mml:math id="M2"><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${E}_{ori}={E}_{ori,2D}+\frac{L}{2}{E}_{ori,1D}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <italic>E</italic><sub><italic>dist</italic></sub>, <italic>E</italic><sub><italic>ori</italic></sub>, and <italic>E</italic><sub><italic>cont</italic></sub> represent the distance-, orientation-, contact-based restraints and Rosetta’s internal energy terms, respectively; <italic>E</italic><sub><italic>ori,2D</italic></sub> and <italic>E</italic><sub><italic>ori,1D</italic></sub> represent the restraints from 2D and 1D orientations, respectively; <italic>L</italic> is the length of the sequence. A detailed description of these energy terms is available in the Supporting Information. The weights (<italic>w</italic><sub>1</sub> = 1.03, <italic>w</italic><sub>2</sub> = 1.0, <italic>w</italic><sub>3</sub> = 1.05, <italic>w</italic><sub>4</sub> = 0.05) are decided on hundreds of RNAs randomly selected from the training set to minimize the average RMSD. Note that we only select a subset of restraints with probabilities higher than a specified threshold (0.45, 0.65, and 0.6 for distances, orientations, and contacts, respectively).</p>
      <p id="Par51">The folding procedure is implemented with pyRosetta<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>. From each RNA, 20 full-atom starting structures are first generated using the RNA_HelixAssembler protocol in pyRosetta<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>. The Quasi-Newton-based optimization L-BFGS is then applied to refine these structures by minimizing the total energy, resulting in 20 refined full-atom structure models. Finally, the model with the lowest total energy (Eq. <xref rid="Equ1" ref-type="disp-formula">1</xref>) is selected as the final prediction.</p>
    </sec>
    <sec id="Sec19">
      <title>Construction of datasets</title>
      <sec id="Sec20">
        <title>Test sets</title>
        <p id="Par52">Two benchmark datasets are constructed in this work. The first one is from the RNA-Puzzles experiments. This set consists of all RNA-Puzzles targets from PZ1 through PZ33 except PZ2. PZ2 is a complex that has complicated interactions among eight chains, which is out of the prediction scope of the current work. The second dataset comes from PDB. In detail, we first collected 339 RNA structures from PDB that were released after 2017-01. RNAs with more than 200 or less than 30 nucleotides were removed. Then the program cd-hit-est<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> was used to remove redundant sequences at 80% sequence identity. To avoid over-estimation, RNAs with an e-value lower than 10 by BLASTN searching against the training sets of trRosettaRNA and SPOT-RNA were excluded from both test sets. The duplicated RNAs between these two test sets were also removed. The resulting sets comprised 20 RNA-Puzzles targets and 30 non-redundant RNAs, respectively.</p>
      </sec>
      <sec id="Sec21">
        <title>Training sets from PDB</title>
        <p id="Par53">To train our models, we first collected all the RNA chains released before 2022-01 in PDB. Multi-chain structures were separated into single-chain structures. Modified nucleotides are replaced by the standard ones. In addition, if two chains form more than three base-pairing interactions, they are linked by three Adenines, resulting in a new sample. In total, we obtained 8849 samples. Then we tried to generate MSA for each query sequence and removed the sequences without sequence homologs. Finally, 3633 RNA chains were retained for training the network models of trRosettaRNA.</p>
        <p id="Par54">To avoid data leakage in the benchmark tests while keeping as many training samples as possible, five training subsets were obtained by filtering the above 3633 RNA chains. Specifically, for the RNA-Puzzles set, we split the 20 RNAs into four subsets according to their release dates in PDB (i.e., 2010-12 ~ 2013-07, 2013-07 ~ 2016-07, 2016-07 ~ 2019-04, and after 2019-04, see Table <xref rid="MOESM1" ref-type="media">S2</xref>). Correspondingly, four smaller training sets (1133, 1528, 2337, and 3001 samples, respectively) were obtained by removing structures that were released after the above dates. We trained four network models with these training sets, respectively. For each group of the RNA-Puzzles targets, the predictions were made by the model trained on the corresponding training set. For the 30 independent RNAs, the training set consists of 2454 RNAs that were released before 2017-01.</p>
      </sec>
      <sec id="Sec22">
        <title>Self-distillation training set from bpRNA</title>
        <p id="Par55">As the number of available RNA structures is limited, inspired by the success of the self-distillation method used in AlphaFold2, we constructed a self-distillation dataset from the bpRNA database with experimental secondary structures<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>. In detail, we collected the bpRNA sequences that are available in the Rfam database<sup><xref ref-type="bibr" rid="CR41">41</xref></sup> so that the Rfam MSAs can be used immediately. Then we removed the orphan families (i.e., with one RNA sequence only) and ran cd-hit-est to exclude the redundant sequences at a sequence identity cutoff of 80%. The final self-distillation dataset consists of 13202 RNA chains. The RNAs possessing an e-value lower than 10 (by BLASTN) or with a sequence identity higher than 80% (by cd-hit-est) with the two benchmark datasets were excluded from the self-distillation dataset when training the models for benchmark tests. Consequently, the self-distillation dataset for benchmark tests consists of 13175 RNA chains.</p>
        <p id="Par56">We use a single un-distilled RNAformer model, i.e., trained on the PDB dataset (or the corresponding subsets for benchmark tests), to generate the predicted labels for the self-distillation set. Using this un-distilled model, we predicted the 1D and 2D geometries (in the form of probability distributions) for every sequence in the self-distillation set. These predicted geometries are then assigned as the labels of these distillation samples. As the predictions may be inaccurate for some nucleotides, we estimate the prediction confidence and filtered out the potentially inaccurate nucleotides and nucleotide pairs. In detail, for each pair of nucleotides (<italic>i</italic>, <italic>j</italic>) with sequence separation less than 128 (i.e., |<italic>i</italic>-<italic>j</italic> | ≤ 128), we computed the mean P-P distance distribution (i.e., the reference distribution, denoted by<inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{|i-j|}^{ref}$$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_42528_Article_IEq1.gif"/></alternatives></inline-formula>), using the predicted distance maps for 1000 samples randomly selected from the self-distillation set. Then for each pair of nucleotides in a self-distillation sequence, we calculated its confidence score (denoted by <italic>c</italic><sub><italic>i,j</italic></sub>), defined as the Kullback-Leibler divergence between its predicted distribution (denoted by <italic>P</italic><sub><italic>i,j</italic></sub>) and the reference distribution:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{i,j}={D}_{KL}\left({P}_{i,j}|{P}_{|i-j|}^{ref}\right)$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>∣</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par57">The per-nucleotide confidence score <italic>c</italic><sub><italic>i</italic></sub> was calculated as the average of <italic>c</italic><sub><italic>i,j</italic></sub> over all <italic>j</italic>s within the sequence separation of 128:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{i}=\frac{1}{128}\mathop{\sum }\limits_{j=i+1}^{i+128}{c}_{i,j}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>128</mml:mn></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>128</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par58">During training (see below), the nucleotides/nucleotide pairs with confidence scores &lt;0.5 are masked out when calculating the 1D/2D losses, respectively.</p>
      </sec>
    </sec>
    <sec id="Sec23">
      <title>Training procedure and loss function</title>
      <p id="Par59">The training of an RNAformer model can be divided into three steps. In the first step, we trained an un-distilled model using the PDB set by 15 epochs. This model was then used to generate the labels for RNAs in the self-distillation set. In the second step, the un-distilled model was further trained on the combination of the PDB set and the self-distillation set with another 15 epochs. At each epoch, the training samples consist of all the <italic>N</italic> samples from the PDB set and randomly selected 3 <italic>N</italic> samples from the self-distillation set, where <italic>N</italic> is the size of the PDB set. In the third step, we finetuned the models on the long sequences (&gt;100 nucleotides) selected from the PDB set. We used the Adam optimizer to minimize the loss function (see below) with different learning rates (0.0001 for the first two steps, 0.00005 for the third step).</p>
      <p id="Par60">For all training steps, the loss function is defined as the cross entropy between the predicted distributions and the real or generated labels. In total, the loss function can be written as:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Loss={L}_{2D}+{L}_{1D}+5{L}_{cont}$$\end{document}</tex-math><mml:math id="M12"><mml:mi>L</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <italic>L</italic><sub>2D</sub>, <italic>L</italic><sub>1D</sub>, and <italic>L</italic><sub>cont</sub> are the loss items for the 2D distances and orientations, 1D orientations, and 2D contacts, respectively. More specifically, the three loss items can be written as:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{2D}=\frac{1}{10{N}_{nt}^{2}}\mathop{\sum }\limits_{i=1}^{L}\mathop{\sum }\limits_{j=1}^{L}\mathop{\sum}\limits_{g\in \{2D\,geometries\}}CE\left({P}_{i,j}^{g},{Y}_{i,j}^{g}\right)$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>10</mml:mn><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>D</mml:mi><mml:mspace width="0.25em"/><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mi>C</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{1D}=\frac{1}{4{N}_{L}}\mathop{\sum }\limits_{i=1}^{L}\mathop{\sum}\limits_{g\in \{1D\,geometries\}}CE\left({P}_{i}^{g},{Y}_{i}^{g}\right)$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mi>D</mml:mi><mml:mspace width="0.25em"/><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mi>C</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_{cont}=\frac{1}{{L}^{2}}\mathop{\sum }\limits_{i=1}^{L}\mathop{\sum }\limits_{j=1}^{L}CE\left({P}_{i,j}^{cont},{Y}_{i,j}^{cont}\right)$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mi>C</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <italic>CE</italic>() is the cross entropy function; <inline-formula id="IEq2"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{i,j}^{g}$$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_42528_Article_IEq2.gif"/></alternatives></inline-formula> is the predicted probability distribution of the 2D geometry <italic>g</italic> between nucleotides <italic>i</italic> and <italic>j</italic>; <inline-formula id="IEq3"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{i}^{g}$$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_42528_Article_IEq3.gif"/></alternatives></inline-formula> is the predicted probability distribution of the 1D geometry <italic>g</italic> of nucleotide <italic>i</italic>; <inline-formula id="IEq4"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{i,j}^{cont}$$\end{document}</tex-math><mml:math id="M24"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2023_42528_Article_IEq4.gif"/></alternatives></inline-formula> is the predicted probability of nucleotides <italic>i</italic> and <italic>j</italic> to be in contact; the <italic>Y</italic> heads are the one-hot encodings of the true labels (for PDB samples) or the predicted distributions (for self-distillation samples); <italic>L</italic> is the number of nucleotides in sequence; 10 and 4 are the number of types of 2D geometries (5 distances + 5 orientations) and 1D geometries (4 orientations), respectively.</p>
    </sec>
    <sec id="Sec24">
      <title>Estimation of model confidence</title>
      <p id="Par61">To estimate the quality of the predicted model, a few variables are first derived from predicted distance maps and generated decoys.<list list-type="order"><list-item><p id="Par62"><italic>pRMSD</italic>: the average pair-wise RMSD of the top ten decoys with the lowest total energies.</p></list-item><list-item><p id="Par63"><italic>mp</italic>: the mean probability of the predicted inter-nucleotide distances for the set (denoted by <italic>S</italic>) of the top 15 <italic>L</italic> (<italic>L</italic> is the sequence length) nucleotide pairs (as ranked by the probability <italic>P</italic>(<italic>d</italic><sub>P-P</sub> &lt; 40 Å)). A similar variable has been defined to estimate the accuracy of predicted inter-residue distances<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>.<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$mp=\frac{1}{{N}_{bins}}\mathop{\sum }\limits_{k=1}^{{N}_{bins}}\frac{1}{|{M}_{k}|}\mathop{\sum}\limits_{(i,j)\in {M}_{k}}{P}_{\max }(i,\, j)$$\end{document}</tex-math><mml:math id="M26"><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where <italic>d</italic><sub>P-P</sub> denotes the distance between the atoms P; <italic>N</italic><sub><italic>bins</italic></sub> is the total number of distance bins (38 here), <italic>M</italic><sub><italic>k</italic></sub> is a collection of nucleotide pairs (<italic>i</italic>, <italic>j</italic>) (from <italic>S</italic>), for which the maximum probability of <italic>d</italic><sub>P-P</sub>, (i.e., <italic>P</italic><sub>max</sub>(<italic>i</italic>, <italic>j</italic>)), belongs to the <italic>k</italic><sup>th</sup> distance bin.</p></list-item><list-item><p id="Par64"><italic>std</italic>, the average standard deviations of the probability values for all nucleotide pairs.</p></list-item><list-item><p id="Par65"><italic>prop</italic>, the proportion of nucleotide pairs with <italic>P</italic>(<italic>d</italic><sub>P-P</sub> &lt; 40 Å) &gt; 0.45.</p></list-item></list></p>
      <p id="Par66">The RMSD is estimated based on linear regression over the above variables using hundreds of randomly selected RNAs from the training set.<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$eRMSD=0.64 \times pRMSD-189.43 \times std -4.01 \times mp-1.06 \times prop+15.2$$\end{document}</tex-math><mml:math id="M28"><mml:mi>e</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>0.64</mml:mn><mml:mo>×</mml:mo><mml:mi>p</mml:mi><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mo>−</mml:mo><mml:mn>189.43</mml:mn><mml:mo>×</mml:mo><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>4.01</mml:mn><mml:mo>×</mml:mo><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mn>1.06</mml:mn><mml:mo>×</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>15.2</mml:mn></mml:math><graphic xlink:href="41467_2023_42528_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec25">
      <title>Statistics &amp; reproducibility</title>
      <p id="Par67">No statistical method was used to predetermine sample size. No data were excluded from the analyses. The experiments were not randomized. The Investigators were not blinded to allocation during experiments and outcome assessment.</p>
    </sec>
    <sec id="Sec26">
      <title>Reporting summary</title>
      <p id="Par68">Further information on research design is available in the <xref rid="MOESM3" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec27">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2023_42528_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2023_42528_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2023_42528_MOESM3_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
    <sec id="Sec28">
      <title>Source data</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2023_42528_MOESM4_ESM.xlsx">
            <caption>
              <p>Source Data</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Wenkai Wang, Chenjie Feng, Renmin Han.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-023-42528-4.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work is supported in part by the National Natural Science Foundation of China (NSFC T2225007 to J.Y., T2222012 to Z.P., and 61932018 to F.Z.), and the Foundation for Innovative Research Groups of State Key Laboratory of Microbial Technology (WZCX2021-03 to J.Y.).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>J.Y. conceptualized and administered the study. W.W. designed and implemented the network. C.F. and L.Y. implemented the energy minimization. Z.P. and F.Z. co-supervised the study. R.H., Z.W., Z.D., and H.W. prepared the training data. All authors revised and approved the final draft of the manuscript.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par69"><italic>Nature Communications</italic> thanks Rhiju Das and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. A peer review file is available.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The training sets, the set of 20 RNA-Puzzles RNAs, and the set of 30 independent RNAs can be downloaded from Zenodo<sup><xref ref-type="bibr" rid="CR51">51</xref></sup> and our website (<ext-link ext-link-type="uri" xlink:href="https://yanglab.qd.sdu.edu.cn/trRosettaRNA/">https://yanglab.qd.sdu.edu.cn/trRosettaRNA/</ext-link>). The RNAs from blind tests of CASP15 and RNA-Puzzles can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://predictioncenter.org/casp15/results.cgi?tr_type=rna">https://predictioncenter.org/casp15/results.cgi?tr_type=rna</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://www.rnapuzzles.org/results/">https://www.rnapuzzles.org/results/</ext-link>, respectively. The PDB entries mentioned in this study (<ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb3IVK/pdb">3IVK</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb5KH8/pdb">5KH8</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb5LYS/pdb">5LYS</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb6D89/pdb">6D89</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb7D7V/pdb">7D7V</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb8DP3/pdb">8DP3</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb8GXC/pdb">8GXC</ext-link>, and <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.2210/pdb8HB8/pdb">8HB8</ext-link>) were obtained by four-digit accession codes in the Protein Data Bank repository (<ext-link ext-link-type="uri" xlink:href="https://www.rcsb.org/">https://www.rcsb.org/</ext-link>). The sequence databases of NCBI’s nt, Rfam, and RNAcentral used to generate MSA in this study can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/nucleotide">https://www.ncbi.nlm.nih.gov/nucleotide</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://rfam.org/">https://rfam.org/</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://rnacentral.org/">https://rnacentral.org/</ext-link>, respectively. The source data underlying Tables <xref rid="MOESM4" ref-type="media">1</xref>, S<xref rid="MOESM4" ref-type="media">7</xref> and Figs. <xref rid="MOESM4" ref-type="media">4</xref>–<xref rid="MOESM4" ref-type="media">6</xref>, S<xref rid="MOESM4" ref-type="media">2</xref>, S<xref rid="MOESM4" ref-type="media">3</xref>, S<xref rid="MOESM4" ref-type="media">5</xref>, S<xref rid="MOESM4" ref-type="media">6</xref>, S<xref rid="MOESM4" ref-type="media">10</xref>, S<xref rid="MOESM4" ref-type="media">11</xref> are provided in the Source Data file. <xref ref-type="sec" rid="Sec28">Source data</xref> are provided with this paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The trRosettaRNA server and the standalone package are available at Zenodo<sup><xref ref-type="bibr" rid="CR51">51</xref></sup> and our website (<ext-link ext-link-type="uri" xlink:href="https://yanglab.qd.sdu.edu.cn/trRosettaRNA/">https://yanglab.qd.sdu.edu.cn/trRosettaRNA/</ext-link>).</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par70">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>QC</given-names>
          </name>
        </person-group>
        <article-title>Advances and opportunities in RNA structure experimental determination and computational modeling</article-title>
        <source>Nat. Methods</source>
        <year>2022</year>
        <volume>19</volume>
        <fpage>1193</fpage>
        <lpage>1207</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-022-01623-y</pub-id>
        <?supplied-pmid 36203019?>
        <pub-id pub-id-type="pmid">36203019</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berman</surname>
            <given-names>HM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Protein Data Bank</article-title>
        <source>Nucleic acids Res.</source>
        <year>2000</year>
        <volume>28</volume>
        <fpage>235</fpage>
        <lpage>242</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/28.1.235</pub-id>
        <?supplied-pmid 10592235?>
        <pub-id pub-id-type="pmid">10592235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rother</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rother</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Puton</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bujnicki</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>ModeRNA: a tool for comparative modeling of RNA 3D structure</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>4007</fpage>
        <lpage>4022</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq1320</pub-id>
        <?supplied-pmid 21300639?>
        <pub-id pub-id-type="pmid">21300639</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Flores, S. C., Wan, Y., Russell, R. &amp; Altman, R. B. Predicting RNA structure by multiple template homology modeling. <italic>Pac Symp Biocomput</italic>. <bold>2010</bold>, 216-227 (2009).</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Das</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Automated de novo prediction of native-like RNA tertiary structures</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2007</year>
        <volume>104</volume>
        <fpage>14664</fpage>
        <lpage>14669</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0703836104</pub-id>
        <?supplied-pmid 17726102?>
        <pub-id pub-id-type="pmid">17726102</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Das</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Karanicolas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Atomic accuracy in predicting and designing noncanonical RNA structure</article-title>
        <source>Nat. Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>291</fpage>
        <lpage>294</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1433</pub-id>
        <?supplied-pmid 20190761?>
        <pub-id pub-id-type="pmid">20190761</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Watkins</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Rangan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Das</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>FARFAR2: improved de novo rosetta prediction of complex global RNA folds</article-title>
        <source>Struct. (Lond., Engl.: 1993)</source>
        <year>2020</year>
        <volume>28</volume>
        <fpage>963</fpage>
        <lpage>976.e966</lpage>
        <pub-id pub-id-type="doi">10.1016/j.str.2020.05.011</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boniecki</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SimRNA: a coarse-grained method for RNA folding simulations and 3D structure prediction</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>e63</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1479</pub-id>
        <?supplied-pmid 26687716?>
        <pub-id pub-id-type="pmid">26687716</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sharma</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Dokholyan</surname>
            <given-names>NV</given-names>
          </name>
        </person-group>
        <article-title>iFoldRNA: three-dimensional RNA structure prediction and folding</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>1951</fpage>
        <lpage>1952</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn328</pub-id>
        <?supplied-pmid 18579566?>
        <pub-id pub-id-type="pmid">18579566</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Popenda</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated 3D structure composition for large RNAs</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>e112</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks339</pub-id>
        <?supplied-pmid 22539264?>
        <pub-id pub-id-type="pmid">22539264</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated and fast building of three-dimensional RNA structures</article-title>
        <source>Sci. Rep.</source>
        <year>2012</year>
        <volume>2</volume>
        <fpage>734</fpage>
        <pub-id pub-id-type="doi">10.1038/srep00734</pub-id>
        <pub-id pub-id-type="pmid">23071898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>3dRNA: 3D structure prediction from linear to circular RNAs</article-title>
        <source>J. Mol. Biol.</source>
        <year>2022</year>
        <volume>434</volume>
        <fpage>167452</fpage>
        <pub-id pub-id-type="doi">10.1016/j.jmb.2022.167452</pub-id>
        <?supplied-pmid 35662453?>
        <pub-id pub-id-type="pmid">35662453</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Leonardis</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Direct-coupling analysis of nucleotide coevolution facilitates RNA secondary and tertiary structure prediction</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>10444</fpage>
        <lpage>10455</lpage>
        <?supplied-pmid 26420827?>
        <pub-id pub-id-type="pmid">26420827</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cuturello</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Tiana</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bussi</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Assessing the accuracy of direct-coupling analysis for RNA contact prediction</article-title>
        <source>RNA</source>
        <year>2020</year>
        <volume>26</volume>
        <fpage>637</fpage>
        <lpage>647</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.074179.119</pub-id>
        <?supplied-pmid 32115426?>
        <pub-id pub-id-type="pmid">32115426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Optimization of RNA 3D structure prediction using evolutionary restraints of nucleotide-nucleotide interactions from direct coupling analysis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <fpage>6299</fpage>
        <lpage>6309</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx386</pub-id>
        <?supplied-pmid 28482022?>
        <pub-id pub-id-type="pmid">28482022</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Predicting RNA folding thermodynamics with a reduced chain representation model</article-title>
        <source>RNA</source>
        <year>2005</year>
        <volume>11</volume>
        <fpage>1884</fpage>
        <lpage>1897</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.2109105</pub-id>
        <?supplied-pmid 16251382?>
        <pub-id pub-id-type="pmid">16251382</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Vfold-Pipeline: a web server for RNA 3D structure prediction from sequences</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <fpage>4042</fpage>
        <lpage>4043</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac426</pub-id>
        <?supplied-pmid 35758624?>
        <pub-id pub-id-type="pmid">35758624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parisien</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Major</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>The MC-Fold and MC-Sym pipeline infers RNA structure from sequence data</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>452</volume>
        <fpage>51</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="doi">10.1038/nature06684</pub-id>
        <?supplied-pmid 18322526?>
        <pub-id pub-id-type="pmid">18322526</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cruz</surname>
            <given-names>JA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Puzzles: a CASP-like evaluation of RNA three-dimensional structure prediction</article-title>
        <source>RNA</source>
        <year>2012</year>
        <volume>18</volume>
        <fpage>610</fpage>
        <lpage>625</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.031054.111</pub-id>
        <?supplied-pmid 22361291?>
        <pub-id pub-id-type="pmid">22361291</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miao</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Puzzles Round IV: 3D structure predictions of four ribozymes and two aptamers</article-title>
        <source>RNA</source>
        <year>2020</year>
        <volume>26</volume>
        <fpage>982</fpage>
        <lpage>995</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.075341.120</pub-id>
        <?supplied-pmid 32371455?>
        <pub-id pub-id-type="pmid">32371455</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>RNA inter-nucleotide 3D closeness prediction by deep residual neural networks</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>1093</fpage>
        <lpage>1098</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa932</pub-id>
        <?supplied-pmid 33135062?>
        <pub-id pub-id-type="pmid">33135062</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Singh, J., Paliwal, K., Litfin, T., Singh, J. &amp; Zhou, Y. Predicting RNA distance-based contact maps by integrated deep learning on physics-inferred secondary structure and evolutionary-derived mutational coupling. <italic>Bioinformatics</italic><bold>38</bold>, 3900–3910 (2022).</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Townshend</surname>
            <given-names>RJL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Geometric deep learning of RNA structure</article-title>
        <source>Science</source>
        <year>2021</year>
        <volume>373</volume>
        <fpage>1047</fpage>
        <lpage>1051</lpage>
        <pub-id pub-id-type="doi">10.1126/science.abe5650</pub-id>
        <?supplied-pmid 34446608?>
        <pub-id pub-id-type="pmid">34446608</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jumper</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>596</volume>
        <fpage>583</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id>
        <?supplied-pmid 34265844?>
        <pub-id pub-id-type="pmid">34265844</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Pearce, R., Omenn, G. S. &amp; Zhang, Y. De Novo RNA Tertiary Structure Prediction at Atomic Resolution Using Geometric Potentials from Deep Learning. Preprint at <italic>bioRxiv</italic>, 2022.05.15.491755 (2022).</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Baek, M., McHugh, R., Anishchenko, I., Baker, D. &amp; DiMaio, F. Accurate prediction of nucleic acid and protein-nucleic acid complexes using RoseTTAFoldNA. Preprint at <italic>bioRxiv</italic>, 2022.09.09.507333 (2022).</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Shen, T. et al. E2Efold-3D: End-to-End Deep Learning Method for accurate de novo RNA 3D Structure Prediction. Preprint at <italic>arXiv e-prints</italic>, arXiv:2207.01586 (2022).</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved protein structure prediction using predicted interresidue orientations</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2020</year>
        <volume>117</volume>
        <fpage>1496</fpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1914677117</pub-id>
        <pub-id pub-id-type="pmid">31896580</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Du</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The trRosetta server for fast and accurate protein structure prediction</article-title>
        <source>Nat. Protoc.</source>
        <year>2021</year>
        <volume>16</volume>
        <fpage>5634</fpage>
        <lpage>5651</lpage>
        <pub-id pub-id-type="doi">10.1038/s41596-021-00628-9</pub-id>
        <?supplied-pmid 34759384?>
        <pub-id pub-id-type="pmid">34759384</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Su</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved Protein Structure Prediction Using a New Multi-Scale Network and Homologous Templates</article-title>
        <source>Adv. Sci. (Weinh.)</source>
        <year>2021</year>
        <volume>8</volume>
        <fpage>e2102592</fpage>
        <?supplied-pmid 34719864?>
        <pub-id pub-id-type="pmid">34719864</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pyle</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>rMSA: A sequence search and alignment algorithm to improve rna structure modeling</article-title>
        <source>J. Mol. Biol.</source>
        <year>2023</year>
        <volume>435</volume>
        <fpage>167904</fpage>
        <pub-id pub-id-type="doi">10.1016/j.jmb.2022.167904</pub-id>
        <?supplied-pmid 37356900?>
        <pub-id pub-id-type="pmid">37356900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Singh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hanson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Paliwal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>RNA secondary structure prediction using an ensemble of two-dimensional deep neural networks and transfer learning</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>5407</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-13395-9</pub-id>
        <?supplied-pmid 31776342?>
        <pub-id pub-id-type="pmid">31776342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Magnus</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-Puzzles toolkit: a computational resource of RNA 3D structure benchmark datasets, structure manipulation, and evaluation tools</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2020</year>
        <volume>48</volume>
        <fpage>576</fpage>
        <lpage>588</lpage>
        <?supplied-pmid 31799609?>
        <pub-id pub-id-type="pmid">31799609</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parisien</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cruz</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Westhof</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Major</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>New metrics for comparing and assessing discrepancies between RNA 3D structures and models</article-title>
        <source>Rna</source>
        <year>2009</year>
        <volume>15</volume>
        <fpage>1875</fpage>
        <lpage>1885</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.1700409</pub-id>
        <pub-id pub-id-type="pmid">19710185</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Williams</surname>
            <given-names>CJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MolProbity: More and better reference data for improved all-atom structure validation</article-title>
        <source>Protein Sci.</source>
        <year>2018</year>
        <volume>27</volume>
        <fpage>293</fpage>
        <lpage>315</lpage>
        <pub-id pub-id-type="doi">10.1002/pro.3330</pub-id>
        <?supplied-pmid 29067766?>
        <pub-id pub-id-type="pmid">29067766</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Rhiju, D. et al. Assessment of three-dimensional RNA structure prediction in CASP15. Preprint at <italic>bioRxiv</italic>, 2023.2004.2025.538330 (2023).</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sweeney</surname>
            <given-names>BA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>R2DT is a framework for predicting and visualising RNA secondary structure using templates</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>3494</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-23555-5</pub-id>
        <?supplied-pmid 34108470?>
        <pub-id pub-id-type="pmid">34108470</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiong</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zhan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Pairing a high-resolution statistical potential with a nucleobase-centric sampling algorithm for improving RNA model refinement</article-title>
        <source>Nat. Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>2777</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-23100-4</pub-id>
        <?supplied-pmid 33986288?>
        <pub-id pub-id-type="pmid">33986288</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Chen, K., Zhou, Y., Wang, S. &amp; Xiong, P. RNA tertiary structure modeling with BRiQ potential in CASP15. <italic>Proteins: Structure, Function, and Bioinformatics</italic><bold>n/a</bold> (2023).</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mariani</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Biasini</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Barbato</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schwede</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>lDDT: a local superposition-free score for comparing protein structures and models using distance difference tests</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2722</fpage>
        <lpage>2728</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt473</pub-id>
        <pub-id pub-id-type="pmid">23986568</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kalvari</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rfam 14: expanded coverage of metagenomic, viral and microRNA families</article-title>
        <source>Nucleic Acids Res</source>
        <year>2021</year>
        <volume>49</volume>
        <fpage>D192</fpage>
        <lpage>D200</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa1047</pub-id>
        <pub-id pub-id-type="pmid">33211869</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gong</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>RNA-align: quick and accurate alignment of RNA 3D structures based on size-independent TM-scoreRNA</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>4459</fpage>
        <lpage>4461</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz282</pub-id>
        <?supplied-pmid 31161212?>
        <pub-id pub-id-type="pmid">31161212</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karniadakis</surname>
            <given-names>GE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Physics-informed machine learning</article-title>
        <source>Nat. Rev. Phys.</source>
        <year>2021</year>
        <volume>3</volume>
        <fpage>422</fpage>
        <lpage>440</lpage>
        <pub-id pub-id-type="doi">10.1038/s42254-021-00314-5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Consortium</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>RNAcentral 2021: secondary structure integration, improved sequence search and new member databases</article-title>
        <source>Nucleic Acids Res</source>
        <year>2021</year>
        <volume>49</volume>
        <fpage>D212</fpage>
        <lpage>D220</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa921</pub-id>
        <pub-id pub-id-type="pmid">33106848</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nawrocki</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Infernal 1.1: 100-fold faster RNA homology searches</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2933</fpage>
        <lpage>2935</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt509</pub-id>
        <pub-id pub-id-type="pmid">24008419</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>S-H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Res2net: A new multi-scale backbone architecture</article-title>
        <source>IEEE Trans. Pattern Anal. Mach. Intell.</source>
        <year>2019</year>
        <volume>43</volume>
        <fpage>652</fpage>
        <lpage>662</lpage>
        <pub-id pub-id-type="doi">10.1109/TPAMI.2019.2938758</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaudhury</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lyskov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gray</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>PyRosetta: a script-based interface for implementing molecular modeling algorithms using Rosetta</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>689</fpage>
        <lpage>691</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq007</pub-id>
        <?supplied-pmid 20061306?>
        <pub-id pub-id-type="pmid">20061306</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Godzik</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1658</fpage>
        <lpage>1659</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl158</pub-id>
        <?supplied-pmid 16731699?>
        <pub-id pub-id-type="pmid">16731699</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Danaee</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>bpRNA: large-scale automated annotation and analysis of RNA secondary structure</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>5381</fpage>
        <lpage>5394</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky285</pub-id>
        <?supplied-pmid 29746666?>
        <pub-id pub-id-type="pmid">29746666</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Du, Z., Peng, Z. &amp; Yang, J. Toward the assessment of predicted inter-residue distance. <italic>Bioinformatics</italic><bold>38</bold>, 962–969 (2022).</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Wenkai, W. et al. Source code and data for “trRosettaRNA: automated prediction of RNA 3D structure with transformer network”. <italic>Zenodo</italic><ext-link ext-link-type="uri" xlink:href="https://zenodo.org/doi/10.5281/zenodo.8362613">https://zenodo.org/doi/10.5281/zenodo.8362613</ext-link> (2023).</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kerpedjiev</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hammer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
        </person-group>
        <article-title>Forna (force-directed RNA): Simple and effective online RNA secondary structure diagrams</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>3377</fpage>
        <lpage>3379</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv372</pub-id>
        <?supplied-pmid 26099263?>
        <pub-id pub-id-type="pmid">26099263</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
