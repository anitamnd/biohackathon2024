<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Theor Biol Med Model</journal-id>
    <journal-id journal-id-type="iso-abbrev">Theor Biol Med Model</journal-id>
    <journal-title-group>
      <journal-title>Theoretical Biology &amp; Medical Modelling</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1742-4682</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6498635</article-id>
    <article-id pub-id-type="publisher-id">105</article-id>
    <article-id pub-id-type="doi">10.1186/s12976-019-0105-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MiStImm: an agent-based simulation tool to study the self-nonself discrimination of the adaptive immune response</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9541-246X</contrib-id>
        <name>
          <surname>Kerepesi</surname>
          <given-names>Csaba</given-names>
        </name>
        <address>
          <email>kerepesi@sztaki.hu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bakács</surname>
          <given-names>Tibor</given-names>
        </name>
        <address>
          <email>tiborbakacs@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Szabados</surname>
          <given-names>Tamás</given-names>
        </name>
        <address>
          <email>szabados@math.bme.hu</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0633 9072</institution-id><institution-id institution-id-type="GRID">grid.4836.9</institution-id><institution>Institute for Computer Science and Control, Hungarian Academy of Sciences, </institution></institution-wrap>Kende u 13-17, Budapest, 1111 Hungary </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0669 0135</institution-id><institution-id institution-id-type="GRID">grid.423969.3</institution-id><institution>Alfréd Rényi Institute of Mathematics, Hungarian Academy of Sciences, </institution></institution-wrap>Reáltanoda u 13-15, Budapest, 1053 Hungary </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2180 0451</institution-id><institution-id institution-id-type="GRID">grid.6759.d</institution-id><institution>Department of Stochastics, Budapest University of Technology and Economics, </institution></institution-wrap>Müegyetem rkp 3, Budapest, 1521 Hungary </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>2</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>9</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>1</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>4</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>There is an increasing need for complex computational models to perform in silico experiments as an adjunct to in vitro and in vivo experiments in immunology. We introduce Microscopic Stochastic Immune System Simulator (MiStImm), an agent-based simulation tool, that is designed to study the self-nonself discrimination of the adaptive immune system. MiStImm can simulate some components of the humoral adaptive immune response, including T cells, B cells, antibodies, danger signals, interleukins, self cells, foreign antigens, and the interactions among them. The simulation starts after conception and progresses step by step (in time) driven by random simulation events. We also have provided tools to visualize and analyze the output of the simulation program.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>As the first application of MiStImm, we simulated two different immune models, and then we compared performances of them in the mean of self-nonself discrimination. The first model is a so-called conventional immune model, and the second model is based on our earlier T-cell model, called “one-signal model”, which is developed to resolve three important paradoxes of immunology. Our new T-cell model postulates that a dynamic steady state coupled system is formed through low-affinity complementary TCR–MHC interactions between T cells and host cells. The new model implies that a significant fraction of the naive polyclonal T cells is recruited into the first line of defense against an infection. Simulation experiments using MiStImm have shown that the computational realization of the new model shows real patterns. For example, the new model develops immune memory and it does not develop autoimmune reaction despite the hypothesized, enhanced TCR–MHC interaction between T cells and self cells. Simulations also demonstrated that our new model gives better results to overcome a critical primary infection answering the paradox “how can a tiny fraction of human genome effectively compete with a vastly larger pool of mutating pathogen DNA?”</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The outcomes of our in silico experiments, presented here, are supported by numerous clinical trial observations from the field of immunotherapy. We hope that our results will encourage investigations to make in vitro and in vivo experiments clarifying questions about self-nonself discrimination of the adaptive immune system. We also hope that MiStImm or some concept in it will be useful to other researchers who want to implement or compare other immune models.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12976-019-0105-5) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Immune system simulation</kwd>
      <kwd>Self-nonself discrimination</kwd>
      <kwd>Self-centered model</kwd>
      <kwd>Agent-based model</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100005881</institution-id>
            <institution>Emberi Eroforrások Minisztériuma</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2018-1.2.1-NKP-00008</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>We are witnessing a major change in immunology’s conceptual character from an emphasis on immunity as a defense to immunity as an interface-of-exchange. Immunity should be regarded as a communicative system of the internal homeostasis which perceives and then mediates environmental information (organic and inorganic; internal and external) [<xref ref-type="bibr" rid="CR1">1</xref>]. To handle this complexity there is an increasing need for complex computational models to perform in silico experiments as an adjunct to in vitro and in vivo experiments. One of the key points of immunity is the concept of self-nonself discrimination. We proposed first that in order to recognize self and non-self, T lymphocytes should recognize the much smaller set of self antigens, rather than the practically unlimited non-self antigen universe [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. The immune system is continuously in a state of delicate balance between tolerating self and attacking non-self. If this balance is perturbed, autoimmune reactions occur. Immunological tolerance is rooted in regulatory immune cell subsets, suppressive cytokines, and immune checkpoint pathways [<xref ref-type="bibr" rid="CR4">4</xref>].</p>
    <p>A good example for the delicate balance between immune tolerance and intolerance – and for the importance of this research area – is the ambiguous results of The Cancer Immunotherapy Revolution [<xref ref-type="bibr" rid="CR5">5</xref>], in which the newly approved immunotherapies manipulate components of the immune system to attack tumors. Hundreds of clinical trials are underway to improve responses and success stories of terminal cancer patients defying the odds and achieving complete remissions are accumulating. Unfortunately, the manipulation of the immune system has also resulted in a major safety issue: the iatrogenic immune-related adverse events (IrAEs). As a result of the impaired self-tolerance, irAEs may present with a broad clinical spectrum that mainly involves the gut, skin, endocrine glands, liver, and lung but can potentially affect any tissue, and their incidence may reach up to 90% of patients [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p>In order to aid in the qualitative characterization and examination of the delicate immune balance, we have developed MiStImm computer program, which is capable to simulate the complex processes of self-nonself discrimination of the adaptive immune system. We know that a computer model can not reliably simulate the whole immune system, however, simulating areas of interest can be useful for testing ideas to help in the design of in vivo and in vitro experiments [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p>MiStImm uses agent-based modeling technique [<xref ref-type="bibr" rid="CR9">9</xref>] and it can simulate some aspects of humoral immune response along with its major components, including T cells, B cells, antibodies, danger signals, interleukins, self cells and foreign antigens. These simulation components (called “agents”) determine the nodes of a dynamic immune network where links are the potential interactions between two elements. The immune network changes step by step (in time) driven by random events. Using the terminology of [<xref ref-type="bibr" rid="CR10">10</xref>], a model simulated by MiStimm is an agent-based model that is in part “individual particle based-stochastic”, and in part “particle number stochastic”. An “individual particle based stochastic element” is an agent that models individual cells and their individual random attachments with other cells or molecules. In our program, this approach is used for Th cells and B cells. A “particle number stochastic element” is a population of cells or molecules that are represented in the model by the properties of the population and by the number of elements in it. In our program, this approach is used e.g. for self cells and foreign antigens. Because our model is stochastic, their attachments with other elements is also controlled randomly. A great advantage of such a model is that it can easily incorporate the most important types of cells and molecules together with their essential features and simulation events that play important roles in immune reactions. In such a simulation events – for example interactions of components – occur at random. A stochastic model fits well with the affinity maturation of B lymphocytes in which random events are perhaps the most characteristic. It is also suitable to model the development of the regulatory T cell population and the random selection of specific T cell clones.</p>
    <p>To simplify things, we chose the humoral adaptive immune system since the humoral phase (blood or lymph) may be considered spatially homogeneous; thus a microscopic spatial volume may represent the whole phase well. A major advantage of this approach is that it is not necessary to describe the actual spatial positions and spatial motions in the model. Instead, model components (agents) randomly choose one of the other components as interaction partners, because any components are close enough to become engaged in an interaction.</p>
    <p>As the first application of MiStImm, we have simulated two different immune models and then we have compared performances of them in the mean efficacy of self-nonself discrimination (see the Results). The first model is called <italic>nonself centered</italic> or <italic>Conventional Role of Self</italic> (CRS) where even a primary immune reaction depends on the recognition of non-self antigens by T and B cell receptors [<xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR13">13</xref>]. The role of self in this model is that the great majority of autoreactive T and B cell clones are selected and purged from the immune system [<xref ref-type="bibr" rid="CR14">14</xref>]. The second model called <italic>self-centered</italic> or <italic>Enchanced Role of Self</italic> (ERS) which is based on our previously published “one-signal model” [<xref ref-type="bibr" rid="CR3">3</xref>]. We proposed that model (hypothesis) when we have been seeking the answer to three unresolved paradoxes of immunology: 
<list list-type="bullet"><list-item><p>(Q1) How can a tiny fraction of human genome effectively compete with a vastly larger pool of mutating pathogen DNA [<xref ref-type="bibr" rid="CR15">15</xref>]?</p></list-item><list-item><p>(Q2) Considering the fact, that average 3 mutations are formed each of the 10<sup>16</sup> times the cell’s 3·10<sup>9</sup> DNA base pairs are duplicated during a human lifetime [<xref ref-type="bibr" rid="CR16">16</xref>], “why does cancer occur so infrequently”?</p></list-item><list-item><p>(Q3) Considering the facts that T cells require three to five days to attain fighting strength (because they are rare, short-lived, and their doubling time is at least 6 h), yet how can a T cell response be measurable in the lymph nodes draining the infection site within 12 to 18 h [<xref ref-type="bibr" rid="CR17">17</xref>]?</p></list-item></list></p>
    <p>In order to explain these paradoxes, we have suggested a new T cell model [<xref ref-type="bibr" rid="CR3">3</xref>] that we can summarize in the following. We have postulated that a dynamic steady state, a so-called coupled system is formed through low affinity complementary TCR–MHC interactions between T cells and host cells. Under such condition, it is sufficient to recognize what is self in order to attack nonself (answer to Q1). We have postulated that the evolutionary pressure driving the creation of the T cell receptor (TCR) repertoire was primarily the homeostatic surveillance of the genome (answer to Q2). The new model implies that a significant fraction of the naive polyclonal T cells is recruited into the first line of defense from the very outset of an infection (answer to Q3). The computational variant of our hypothesized T-cell model is the ERS model, presented in this paper. The ERS and CRS model are summarized by Fig. <xref rid="Fig1" ref-type="fig">1</xref>.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Humoral adaptive immune response by the ERS and CRS model. The ERS model is described by (<bold>a</bold>), (<bold>b</bold>) and (<bold>c</bold>), while CRS models are described by (<bold>c</bold>) alone. <bold>a</bold> In the ERS model, a hypothesized <italic>weak affinity interaction</italic> begins in intrauterine life and keeps the immune image of self during the whole life. It is sufficient for homeostasis; low affinity BCR binds self-antigens and presents self-peptides in their MHCII to regulatory T helper (Threg) cells; this ensures B and Threg cell survival. <bold>b</bold> In the ERS model another hypothesized interaction, <italic>intermediate affinity interaction</italic> initiate the first line of defense against an infection; some B cells that have higher BCR affinity for the antigens of the pathogen capture pathogens with intermediate affinity and present foreign peptides in their MHCII. The foreign peptides indirectly inhibit binding of Threg cells to these B cells for a critical time period, then the B cells will secrete hypothesized danger signals. Danger signals activate local Th cells, which in turn, release interleukins that fuel local T cell activation. This way a non-specific, local polyclonal B and T cell activation is induced, which is the primary defense mechanism against infections in the ERS model. Clonal expansion requires affinity maturation, which results in a several magnitude increase of BCR affinity, typically over a time of one week. Random mutations cause the production of B cells with a broad range of affinities for their presented foreign antigen. B cells with unfavorable mutations will not get sufficiently activated by the foreign antigen and will die, while those with improved affinity will be stimulated to clone themselves. <bold>c</bold> Specific immune reaction, here called as <italic>strong affinity interaction</italic>, appears in both the ERS and CRS models and is supervised and supported by pathogen peptide-specific Th cells, which require direct contact via TCR to the MHCII of the expanding B cell clone. Such higher affinity interactions would then drive clonal T cell proliferation, activation, lysis of infected cells. Having cleared the infection, specific T cells could eventually become an expanded memory type T cell clone, while B cells could differentiate into infection specific antibody-producing plasma cells or memory B cells. This interaction usually needs several days to efficiently start</p></caption><graphic xlink:href="12976_2019_105_Fig1_HTML" id="MO1"/></fig>
</p>
    <p>Though, there are some immune system simulation models that are capable to simulate a conventional (or standard) immune model like our CRS model (e.g. Basic Immune Simulator [<xref ref-type="bibr" rid="CR18">18</xref>], C-ImmSim [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>], SIMISYS [<xref ref-type="bibr" rid="CR21">21</xref>]), they are not directly usable for modelling the self-nonself discrimination theory of our group (presented by the ERS model) and compare it with a conventional model. However, when we built MiStImm, we have adapted some principles of the earlier simulation models (see the <xref rid="Sec23" ref-type="sec">Discussion</xref> for a comparison).</p>
    <p>The main goal of the simulation experiments of the current paper is showing that the ERS model matches real patterns and additionally to analyze how the two models (CRS and ERS) cope against a critical primary infection. That was the main reason why we have developed MiStImm.</p>
    <p>In the Results we show that the ERS model does not develop autoimmune reactions despite the existence of the hypothesized TCR–MHC interaction between T cells and self antigens in the model. Autoimmune reaction is a strong immune response of an organism against its own healthy cells and tissues. Despite the weak reaction of B and Th cells against the healthy self cells in the model, the sizes of these self cell populations are not decreasing, so does not occur a pathological consequence of these weak reactions.</p>
    <p>We also show that the ERS model gives better results to overcome a critical primary infection, answering the paradox “how can a tiny fraction of human genome effectively compete with a vastly larger pool of mutating pathogen DNA?” We hope that our results will encourage investigations to make in vitro and in vivo experiments clarifying questions about self-nonself discrimination of the adaptive immune system. We also hope that MiStImm or some concept in it will be useful for implementation and/or comparing other immune models by other researchers.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>The Microscopic Stochastic Immune Simulator (MiStImm) is a single program written in the C programming language in the spirit of agent-based models [<xref ref-type="bibr" rid="CR9">9</xref>]. We have provided its executed binary file for instant use in Windows operation system. It gets its input parameters from a raw text file. By changing the input parameters new initial conditions or even new immune models can be set up for the simulation program (see the list of parameters in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). The output of the simulation consists of two text files containing the state of the system at all time steps with additional statistics. We have also provided additional tools to visualize and analyze the output of the simulation program.</p>
    <sec id="Sec3">
      <title>Components (agents) of the simulation</title>
      <p>MiStImm can simulate some components of the humoral adaptive immune system, like helper T cells, B cells, antibodies, interleukins, self cells, and foreign antigens (Table <xref rid="Tab1" ref-type="table">1</xref>). Components (agents) are handled as population or individuals and each of them is implemented as a custom data type in C (called “struct” that is similar to a “class” in other computer languages like C++). Each component has a number of numerical parameters and certain attached events or processes of events that may occur at random (see details in Table <xref rid="Tab1" ref-type="table">1</xref>). The output of the simulator contains the number of each components at each time point so we can trace the changes of the population sizes over a simulation (see simulation outcomes in the Results). In nature, it is typical that when the size of a certain cell population gets larger the per capita birth rate in the population decreases. Thus the size of a population first increases fast, later it slows down, and at the end it gets relatively stable. So to control birth rates (ensuring that the number of components always remain in the biologically feasible domain) we have used logistic functions previously applied by many other authors (see e.g. [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>] and Additional file <xref rid="MOESM1" ref-type="media">1</xref>).
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Associated events and behaviors of the simulated components (“agent types”) in MiStImm program</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Agent type</th><th align="left">Simulation event or behavior</th><th align="left">Model</th></tr></thead><tbody><tr><td align="left">Self cell pop.</td><td align="left">Born</td><td align="left">ERS/CRS</td></tr><tr><td align="left">Foreign antigen pop.</td><td align="left">Born</td><td align="left">ERS/CRS</td></tr><tr><td align="left">Bone marrow cell pop.</td><td align="left">Born</td><td align="left">ERS/CRS</td></tr><tr><td align="left"/><td align="left">Creates a native B cell</td><td align="left">ERS/CRS</td></tr><tr><td align="left"/><td align="left">Creates a T helper cell</td><td align="left">ERS/CRS</td></tr><tr><td align="left">B cell (individual)</td><td align="left">Born at the periphery by division</td><td align="left">ERS/CRS</td></tr><tr><td align="left"/><td align="left">Negative selection in the bone marrow</td><td align="left">ERS/CRS</td></tr><tr><td align="left"/><td align="left">Dies because its lifespan terminates</td><td align="left">ERS/CRS</td></tr><tr><td align="left"/><td align="left">Emits some danger signals</td><td align="left">ERS</td></tr><tr><td align="left"/><td align="left">Activation control process</td><td align="left">ERS</td></tr><tr><td align="left"/><td align="left">Action*:</td><td align="left">ERS/CRS</td></tr><tr><td align="left"/><td align="left">- detection/killing/antigen presentation</td><td align="left">ERS/CRS</td></tr><tr><td align="left"/><td align="left">- division of weak kind</td><td align="left">ERS</td></tr><tr><td align="left"/><td align="left">- division of intermediate kind</td><td align="left">ERS</td></tr><tr><td align="left"/><td align="left">- division of strong kind</td><td align="left">ERS/CRS</td></tr><tr><td align="left"/><td align="left">A plasma cell creates some antibodies</td><td align="left">ERS/CRS</td></tr><tr><td align="left">Th cell (individual)</td><td align="left">Born at the periphery</td><td align="left">ERS/CRS</td></tr><tr><td align="left"/><td align="left">Dies because its lifespan terminates</td><td align="left">ERS/CRS</td></tr><tr><td align="left"/><td align="left">Positive and negative selection in the thymus</td><td align="left">ERS/CRS</td></tr><tr><td align="left"/><td align="left">Emits some interleukin</td><td align="left">ERS</td></tr><tr><td align="left"/><td align="left">Activation control process</td><td align="left">ERS</td></tr><tr><td align="left"/><td align="left">Action*:</td><td align="left">ERS/CRS</td></tr><tr><td align="left"/><td align="left">- detection</td><td align="left">ERS/CRS</td></tr><tr><td align="left"/><td align="left">- division of weak kind</td><td align="left">ERS</td></tr><tr><td align="left"/><td align="left">- division of intermediate kind</td><td align="left">ERS</td></tr><tr><td align="left"/><td align="left">- division of strong kind</td><td align="left">ERS/CRS</td></tr><tr><td align="left">Danger signal pop.</td><td align="left">Some danger signals die</td><td align="left">ERS</td></tr><tr><td align="left"/><td align="left">Action*</td><td align="left">ERS</td></tr><tr><td align="left">Interleukin pop.</td><td align="left">Some interleukins die</td><td align="left">ERS</td></tr><tr><td align="left"/><td align="left">Action*</td><td align="left">ERS</td></tr><tr><td align="left">Antibody pop.</td><td align="left">An amount of antibodies dies</td><td align="left">ERS/CRS</td></tr><tr><td align="left"/><td align="left">An amount of antibodies acts (kill)*</td><td align="left">ERS/CRS</td></tr></tbody></table><table-wrap-foot><p>B and Th cells are handled individually while the remaining types of agents are handled as population (“pop”.). Each row in the table describes a scheduled event of the simulation except the subprocesses of the <italic>Action events</italic>. These subprocesses can occur along an <italic>Action</italic> event. Interactions among agents can also occur as an implication of the five action events (signed with an asterisk*). Some simulation events and subprocess are elements of both the ERS and the CRS model, others are elements only the ERS model. A plasma cell is a special kind of B cells, a result of a B cell maturity process. A plasma cell has neither a B cell action event nor a B cell activation control event. On the other hand, it has an antibody birth and an antibody death event. An antibody has the same shape in the antigen lattice as the BCR of its mother plasma cell</p></table-wrap-foot></table-wrap>
</p>
    </sec>
    <sec id="Sec4">
      <title>Progression of simulation events</title>
      <p>A simulation progresses with discrete time points by consecutive steps (turns). At each time point a simulation <italic>event</italic> is selected randomly from the actual list of the scheduled events (see possible events in Table <xref rid="Tab1" ref-type="table">1</xref>). Then the selected event occurs and it changes the state of the system: it can change the state of the simulation components (agents) and also can include/remove/modify other scheduled events in the list. The random selection (and the time point of the occurrence) depends on the expected waiting times of the events in the actual scheduled event list. (See details in the “Mathematical model” section of the Additional file <xref rid="MOESM1" ref-type="media">1</xref>). In the program, each event is implemented as a C function containing the rules that will be executed when the event occurs (see the details of the rules below and in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). The scheduled simulation event list is programmed as a dynamic list of individual objects, consisting of the event ID along with its own parameters like the expected waiting time of the event.</p>
    </sec>
    <sec id="Sec5">
      <title>Simulation spaces</title>
      <p>The simulation environment of MiStImm is the spatially homogeneous humoral phase (blood or lymph) of the adaptive immune system. A major advantage of this approach is that it is not necessary to describe the actual spatial positions (locations) and spatial motions in the model. Instead, model components (agents) randomly choose an interaction partner among the other components (agents), because any components are close enough to become engaged in an interaction. Instead of locations, MiStImm simulates the spatial shape of the peptides and receptors that are key points of the adaptive immune response.</p>
      <sec id="Sec6">
        <title>Simulation space 1: peptide universe</title>
        <p>MiStImm takes a microscopic volume of the humoral phase and also a microscopically small part of the shape space universe. Shape space models were used by Perelson, Segel and their colleagues since the 1970’s [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>] and also in the Celada–Seiden model [<xref ref-type="bibr" rid="CR26">26</xref>]. To explain what we mean by shape space here, assume that the shape of a T cell receptor (TCR) can be represented by a point in a discrete lattice of real numbers. Theoretical considerations compared with experimental data led to the conclusion that the dimension of this shape space, i.e. the number of parameters essential in describing a binding, is not too large, probably around five [<xref ref-type="bibr" rid="CR24">24</xref>]. The microscopically small part of the shape space that we consider in the simulation program is a small discrete <italic>N</italic>×<italic>N</italic> planar grid in the shape space (default: <italic>N</italic>=1000). The <italic>x</italic>∈{0,1,…,<italic>N</italic>} coordinate of a shape point may represent a “horizontal” coordinate of the main part of the binding profile of a TCR or an MHC+peptide complex, while the <italic>y</italic>∈{−<italic>N</italic>/2,…,<italic>N</italic>/2} coordinate may represent the “vertical” coordinate of the main part of the binding profile. A positive coordinate represents “convexity”, while a negative coordinate represents “concavity”. Figure <xref rid="Fig2" ref-type="fig">2</xref>a shows our underlying idea for the shape of a peptide characterized by a single point (<italic>x</italic><sub><italic>P</italic></sub>,<italic>y</italic><sub><italic>P</italic></sub>). We call the above finite square grid the peptide lattice.
<fig id="Fig2"><label>Fig. 2</label><caption><p><bold>a</bold> Two simplified complementary shapes characterized by the points (<italic>x</italic><sub><italic>P</italic></sub>,<italic>y</italic><sub><italic>P</italic></sub>) and (<italic>x</italic><sub><italic>P</italic></sub>,−<italic>y</italic><sub><italic>P</italic></sub>), respectively, in the peptide lattice. <bold>b</bold> Simplified graphical representation of the difference between the ERS and the CRS models. Dark blue: area allocated to regulatory T cells; Green: area for potential infection specific T cells; Intensity of the colors represent the density of T cells in the area (a darker color means larger density)</p></caption><graphic xlink:href="12976_2019_105_Fig2_HTML" id="MO2"/></fig>
</p>
      </sec>
      <sec id="Sec7">
        <title>Simulation space 2: antigen universe</title>
        <p>The shape of a B cell receptor (BCR) or shape of an antigen is similarly represented by a point of an antigen lattice in the model. Here again the <italic>x</italic>∈{0,1,…,<italic>N</italic>} coordinate of a shape point may represent a “horizontal” coordinate of the main part of the binding profile of the BCR or antigen, while the <italic>y</italic>∈{−<italic>N</italic>/2,…,<italic>N</italic>/2} coordinate may represent the “vertical” coordinate of the main part of the binding profile; a positive coordinate representing “convexity”, while a negative coordinate representing “concavity”, see Fig. <xref rid="Fig2" ref-type="fig">2</xref>a.</p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Interactions of agents in simulation</title>
      <sec id="Sec9">
        <title>Complementarity of binding</title>
        <p>Complementarity plays a basic role in binding. The perfect fit between a TCR and an MHC+peptide complex means in the model that the shape (<italic>x</italic><sub><italic>T</italic></sub>,<italic>y</italic><sub><italic>T</italic></sub>) of the TCR and the shape (<italic>x</italic><sub><italic>P</italic></sub>,<italic>y</italic><sub><italic>P</italic></sub>) of the MHC+peptide satisfy the equalities <italic>x</italic><sub><italic>T</italic></sub>=<italic>x</italic><sub><italic>P</italic></sub> and <italic>y</italic><sub><italic>T</italic></sub>=−<italic>y</italic><sub><italic>P</italic></sub>, see Fig. <xref rid="Fig2" ref-type="fig">2</xref>a. In the model we introduce <italic>a metric</italic> or <italic>distance</italic><italic>d</italic> to measure the degree of similarity of two shapes <italic>z</italic><sub>1</sub>:=(<italic>x</italic><sub>1</sub>,<italic>y</italic><sub>1</sub>) and <italic>z</italic><sub>2</sub>:=(<italic>x</italic><sub>2</sub>,<italic>y</italic><sub>2</sub>): 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ d(z_{1}, z_{2}) := \max \{|x_{2} - x_{1}|, |y_{2} - y_{1}| \}.  $$ \end{document}</tex-math><mml:math id="M2"><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo>max</mml:mo><mml:mo>{</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>}</mml:mo><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12976_2019_105_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>(This is called the maximum or <italic>ℓ</italic><sub><italic>∞</italic></sub> distance in mathematics.) A TCR <italic>z</italic><sub><italic>T</italic></sub>:=(<italic>x</italic><sub><italic>T</italic></sub>,<italic>y</italic><sub><italic>T</italic></sub>) and an MHC+peptide <italic>z</italic><sub><italic>P</italic></sub>:=(<italic>x</italic><sub><italic>P</italic></sub>,<italic>y</italic><sub><italic>P</italic></sub>) are perfectly complementary in our model if the distance between <italic>z</italic><sub><italic>T</italic></sub> and <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {z_{P}} := (x_{P}, -y_{P})$\end{document}</tex-math><mml:math id="M4"><mml:mover accent="false"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12976_2019_105_Article_IEq1.gif"/></alternatives></inline-formula> is zero. The larger the distance, the more imperfect the complementarity is. The representation of the complementarity between BCRs and antigens is similar. Only complementary or nearly complementary shaped ligands and receptors can bind. The dots in Fig. <xref rid="Fig2" ref-type="fig">2</xref>b represent TCRs that are exactly complementary to some self MHC+self-peptide complex. In the case of ERS model, the areas shaded in dark blue are called the <italic>characteristic rings of self-peptides</italic>. They represent the set of shapes that are allocated to possible <italic>regulatory T cells</italic> after negative and positive selection in the ERS model. The areas denoted by green correspond to possible shapes of classical, <italic>potentially infection (or mutation) specific T cells</italic>, while white areas are representing self-reactive T cells that are prohibited for T cells in the two respective models. In the ERS model, moderately self-reactive T cells are present after negative and positive selection. In fact, they constitute the most important class of T cells that decide self-nonself discrimination. On the other hand, such moderately self-reactive T cells are negatively selected out in CRS models.</p>
        <p>Interactions among agents are implications of the following simulation events: T cell action, B cell action, danger signal action, interleukin action, antibody action (see events signed by asterisks in Table <xref rid="Tab1" ref-type="table">1</xref>). These interactions are realized as BCR – antigen binding, TCR – MHC+peptide binding, or danger signals/interleukins emission (for details see the “<xref rid="Sec9" ref-type="sec">Complementarity of binding</xref>” section above and Additional file <xref rid="MOESM1" ref-type="media">1</xref>). In MiStImm, T cell – B cell interactions are basic, here we describe three different types of it. Each of the three types fulfills an important role in the ERS model (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). CRS model can be described by the third type of interactions (called <italic>strong interaction and division</italic>) alone.</p>
      </sec>
      <sec id="Sec10">
        <title>Weak affinity interaction and division (specific to ERS model)</title>
        <p>According to the hypotheses of ERS model, in a healthy individual during intrauterine life, randomly produced moderately self-reactive B cell clones are confronted with an overwhelming quantity of soluble self antigens. Those B cells that can attach with intermediate affinity to any of these self antigens via their B cell receptors (BCRs) will present self peptides in their surface major histocompatibility complex II (MHCII) molecules to regulatory T helper cells (Thregs). This ensures B cell and Threg cell survival, respectively, but it is insufficient to trigger extensive clonally based B cell expansion required for specific immunity or autoimmunity. This hypothesized interaction is called <italic>weak affinity interaction and division</italic> here. Thus the positively selected Threg cells are critical parts of the homeostatic control in our model so that Threg clones exist for practically all kinds of self-MHCII – self-peptide complexes presented by any of the B cells. After birth, this process maintains an immune image of soluble self which can control self-nonself discrimination. This self-surveillance makes ERS model self-centered (rather than infection centered) and gives the answer to the Q2 paradox mentioned in the “Introduction”.</p>
      </sec>
      <sec id="Sec11">
        <title>Intermediate affinity interaction and division (specific to ERS model)</title>
        <p>During a <italic>primary infection</italic> a new antigen appears in the blood. B cells with an appropriate affinity for the new antigen, engulf new antigens and present its foreign peptides on their surface MHCII proteins. Since in the ERS model foreign peptides temporarily inhibit the complementary TCR-MHC interactions, such perturbation creates steric hindrance that obstructs the docking of positively selected Thregs. Disruption of such contact between an MHCII and Thregs <italic>for a critical period of time</italic> results in an emergency and activates the corresponding B cell. In order to reestablish contact, in the ERS model, foreign peptide presenting B cells will secrete a hypothetic <italic>chemotactic danger signals</italic><italic>(“smoking gun”)</italic> attracting Th cells to this region. We imagine this process as the B7-1 and B7-2 ligands of B cells will activate most CD28 receptors of the bystander helper T cells, This initiates a non-specific, polyclonal activation in local Th lymphocytes via the CD28 receptor alone [<xref ref-type="bibr" rid="CR27">27</xref>] such that a local cytokine storm is generated in Th cells triggering B cells to clonal expansion, hypermutation, and eventually they may develop into specific antibody-producing plasma cells. This hypothesized interaction will be called <italic>intermediate affinity interaction and division</italic> here. The resulting inner state of the affected Th and B cells will be called <italic>“activated”</italic> state. Since affinity maturation is driven by the fast increasing local concentration of pathogen antigens (e.g. hepatitis virus), the probability of clonal autoimmunity is very low but possible.</p>
      </sec>
      <sec id="Sec12">
        <title>Strong affinity interaction and division (specific to both ERS and CRS model)</title>
        <p>Both in ERS and CRS model, following the initial polyclonal activation phase, there is always a possibility that rare T cell and B cell clones with higher affinity may well recognize foreign antigens, particularly when a significant fraction of host cells are infected and the viral load is high (for example in hepatitis, see in [<xref ref-type="bibr" rid="CR28">28</xref>]). Such higher affinity interactions would then drive clonal (e.g. HCV specific) T cell proliferation, activation, lysis of infected cells. Having cleared the infection, specific T cells could eventually become an expanded memory type T cell clone, while B cells could differentiate into infection specific antibody-producing plasma cells or memory B cells. Specific T and B cell activation, proliferation and lysis of infected cells, therefore, obey the rules of the conventional two-signal model. Clearly, this process may require several days in general. This interaction will be called <italic>strong interaction and division</italic> in the sequel. The resulting inner state of the affected Th and B cells is called <italic>“strongly activated”</italic> state here.</p>
      </sec>
      <sec id="Sec13">
        <title>Hypothesized danger signals and interleukins (specific to ERS model)</title>
        <p>We use the symbolic names “danger signals and interleukins” in this paper, without specifying the exact type of these molecules, similarly to Fig. 3 of Ref. [<xref ref-type="bibr" rid="CR29">29</xref>]. These types of soluble molecules have roles only in intermediate interactions and divisions in the ERS model. Since conventional immune reactions correspond to the ones that we call strong interactions and divisions, these types of molecules do not appear when simulating CRS models. <italic>Danger signals (soluble molecules)</italic> are emitted by B lymphocytes following disruption of the homeostatic complementary interaction of B cells and Threg cells. This event initiates an action event and also a death event of these molecules. Each danger molecule randomly chooses a Th cell agent. This is a signal for the Th cell to start intermediate type division and to secrete interleukins. Note that this danger signal is not the same as in [<xref ref-type="bibr" rid="CR30">30</xref>] because our danger signals are emitted when the system detects any kind of nonself and not only a dangerous one. <italic>Interleukins</italic> are emitted by Th lymphocytes. This event initiates an action event and also a death event of these interleukins. Each interleukin molecule randomly chooses a B cell. This is a signal for a B cell that has lost complementary Threg cell control to start cell division of intermediate kind. For more details of interactions see in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      </sec>
    </sec>
    <sec id="Sec14">
      <title>Parameter setting, model validation</title>
      <p>MiStImm can be initialized by 178 of parameters (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>). The simulation program, along with its parameter values, was developed by trial and error comparing the simulation outcome patterns to the normal behavior observed in living systems. For example, we set the parameters so that the number of T cells and the number of B cells be approximately equal during a simulation, or we have used logistic functions to prevent population explosion of the components (see details in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>). We also used some principles that were tested by other researchers in their work (see <xref rid="Sec23" ref-type="sec">Discussion</xref>). Simulation outcomes demonstrating our endeavors are shown in the <xref rid="Sec16" ref-type="sec">Results</xref>.</p>
    </sec>
    <sec id="Sec15">
      <title>Limitations and future perspectives</title>
      <p>MiStImm can be easily customized by varying parameters. However, model that is remarkable different from the default settings of MiStImm could be difficult to implement because it requires understanding of the source code written in C. For example, it is easy to vary the type and initial number of foreign and self cells (and many another input parameters), but it is relatively hard to implement a new type of cells (like macrophages) or change the binding model. To solve this limitation an implementation of a Python library would be beneficial providing an easy-to-use interface to customize an immune model from built-in building blocks (similarly as Keras library makes deep learning as easy as manipulating LEGO bricks [<xref ref-type="bibr" rid="CR31">31</xref>]). We think such a big enterprise could revolutionize immune system modelling. MiStImm is one of the first steps in that road.</p>
    </sec>
  </sec>
  <sec id="Sec16" sec-type="results">
    <title>Results</title>
    <sec id="Sec17">
      <title>Simulations of the ERS model show real patterns</title>
      <p>Beside providing screenshots of MiStImm simulation tool, the following simulation results demonstrate that the ERS model – introduced above – show real patterns. For example, the ERS model does not develop autoimmune reactions despite the hypothesized enhanced TCR–MHC interaction between T cells and self antigens. We also perform in silico experiments to show the existence of immune memory in the ERS model, and we also show an example of autoimmune reaction at given pathological conditions.</p>
    </sec>
    <sec id="Sec18">
      <title>Simulation of the development and homeostasis of the adaptive immune system by the ERS model</title>
      <p>We have run simulation experiments for the analysis of the development and homeostasis of the simulated immune system by the ERS model. A simulation starts a few days after conception and goes until the 5000th time step; the unit of time is being a tenth of a day (2 h and 24 min). Initially, only three types of non-immune self antigen populations appear in the model, each with a number of 150 cells, and no other components. Each of these populations is accompanied by a cell division process that implies continuous growing of the number of self cells, with decreasing rate in time (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). B and T cells, which generated by the bone marrow cells, first appear at the 10th day (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). The number of these cells also grow continuously at a decreasing rate. According to the ERS model, the immune system does not attack self cells strongly, just to a very limited extent. Some B cells must continuously present self peptides to ensure that Threg cell characteristic rings around self peptides are constantly maintained. Because of negative selection, this type of immune response is weak and typically settles down quickly before it becomes pathological.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Simulation of the development and homeostasis of the adaptive immune system by the ERS model. The same single simulation in a bird’s eye view (<bold>a</bold>) and a closer view (<bold>b</bold>), respectively. Horizontal axis: time (day) from conception. Vertical axis: number of cells/molecules. In the case of self cells the sum of sizes of the self cell populations is displayed</p></caption><graphic xlink:href="12976_2019_105_Fig3_HTML" id="MO3"/></fig>
</p>
      <p>The peptide and the antigen lattices both have has a size {0,1000}×{−500,500}. Coordinates of antigens of three different self cells (denoted by letters “s”) were (550,300), (700,−200) and (850,150), both in the case of the peptide and the antigen lattice (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a and b). TCR rings around the mirror images of self peptides – that are characteristic features of the ERS model – begin to develop about the 150th day and become more or less stabilized by the 280th day (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). These rings fluctuate for two reasons: <italic>(i)</italic> occasionally global Th cell populations overgrow the set upper limits and this reduces the probability of Th cell division; <italic>(ii)</italic> sometimes the number of presented self peptides in the MHCII-peptide complexes of B cells reaches an extremely low level.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Simulation spaces (peptide and antigen lattices) in the ERS model. <bold>a</bold> A snapshot of the peptide lattice, where the actual TCRs are displayed. With random ‘rings’ around the reflected images of non-immune self antigens (“s”) about one month after birth. A movie capturing a typical simulation of the peptide space is available at the address <ext-link ext-link-type="uri" xlink:href="https://goo.gl/QcdG48">https://goo.gl/QcdG48</ext-link>. <bold>b</bold> A snapshot of the antigen lattice, where the actually existing BCRs are displayed. B cell response to a pathogen: large density of pathogen specific B cells at the reflected image of nonself (“n”) about one week after the infection. As a result of negative selection, there are empty domains around the reflected images of non-immune self antigens (‘s’). A movie capturing a typical simulation of the antigen lattice (shape space) is also available at the address <ext-link ext-link-type="uri" xlink:href="https://goo.gl/3oK1bM">https://goo.gl/3oK1bM</ext-link></p></caption><graphic xlink:href="12976_2019_105_Fig4_HTML" id="MO4"/></fig>
</p>
    </sec>
    <sec id="Sec19">
      <title>Simulations of the normal immune response and immune memory by ERS model</title>
      <p>We have run simulations with the same parameters as above in the development and homeostasis section with the exception that we have injected pathogens into the system at two distinct time points. An infection brings significant changes. A rising population of B and Th cells appear at the mirror image of the infecting agent denoted by a letter “n” (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). An immune response should have the ability to destroy the majority of pathogens – some of them suddenly, others perhaps slowly, while in some cases it may fail. In the ERS model, the death of an individual occurs when the pathogen population grows up irreversibly, technically, as its size reaches 4000 cells. Diversity of pathogens are represented by different locations of their receptors, different speeds of growth, and different initial numbers.</p>
      <p>A normal immune response develops immune memory. Thanks to memory cells, a second immune response against the same nonself antigen have been more effective than at a primary infection (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a and b). For a deeper analysis of the immune memory, we have performed 500 simulations (by the ERS model), adding the same type of pathogen (number of cells =350, mean waiting time between two divisions =60) at the 300th and at the 315th day. ERS model cleared both infections in 451 cases and the mean time lengths needed for elimination were 62.02 (std 13.26) at the first infection and 20.51 (std 14.94) at the second infection. We have said that an elimination happened when the number of pathogens has decreased under 50. With a two-tailed t-test, the <italic>p</italic>-value for equality of mean elimination times for the first and the second infection was 5.2<italic>e</italic>−227.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Immune response in the ERS model. <bold>a</bold> Normal immune response against a repeated infection. First infection was injected at the 300th day and the second infection was injected at the 310th day. Both infections are the same type (number of cells =350, mean waiting time between two divisions =60). The second infection was eliminated faster due to the existence of B cell memory. Horizontal axis: time (day) from conception. Vertical axis: number of cells/molecules. <bold>b</bold> Division of weak/intermediate/strong kind of T and B cells in the same simulation showed in (<bold>a</bold>). Horizontal axis: time (day) from conception. Vertical axis: number of divisions. <bold>c</bold> Autoimmunity caused by the lack of negative selection of B cells: number of self cells decreases rapidly. Horizontal axis: time (day) from conception. Vertical axis: number of cells/molecules</p></caption><graphic xlink:href="12976_2019_105_Fig5_HTML" id="MO5"/></fig>
</p>
    </sec>
    <sec id="Sec20">
      <title>Simulation experiment with lack of negative selection of B cells in the ERS model</title>
      <p>We want to demonstrate that our simulation tool is capable to simulate autoimmune events at given pathological conditions, for example, the lack of negative selection of B cells is shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>c. Without negative selection some of the B cells can constantly destroy self cells.</p>
    </sec>
    <sec id="Sec21">
      <title>Simulation experiments for comparison of ERS and CRS model against a critical infection</title>
      <p>One can switch the ERS (<italic>Enhanced Role of Self</italic>) model to a CRS (<italic>Conventional Role of Self</italic>) model by modifying four parameters. Turning off the <italic>division of weak type</italic> and the <italic>division of intermediate type</italic> are required in the CRS model (medrepr =1→0 and weakrepr =1→0). Turning off the positive selection of T cells is also required in the CRS model (comptype =0→1). The latter adjustment causes large growth of the T cell population, so simultaneously we need to decrease the expectation of the waiting time between two births of T helper cells in the bone marrow (tauthm =5→30). We compared the efficiencies of the immune reactions in the two models. Our results showed that in the ERS model the adaptive immune reaction was able to destroy infections with critically large initial numbers or with critically fast division times more often than in a CRS model (Tables <xref rid="Tab2" ref-type="table">2</xref> and <xref rid="Tab3" ref-type="table">3</xref>). Fisher’s exact test was used for the statistical evaluation (Table <xref rid="Tab4" ref-type="table">4</xref>). These results show that our ERS model is a proper answer to the paradox Q1, mentioned the Introduction, saying “How can a tiny fraction of human genome effectively compete with a vastly larger pool of mutating pathogen DNA”.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>ERS vs. CRS model, simulated by MiStImm 500–500 times as the initial number of pathogens is increasing (from 200 to 400) and the mean waiting time between two divisions of a pathogen is fixed (50)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">f cells</th><th align="left">div time</th><th align="left">ERS wins</th><th align="left">CRS wins</th><th align="left">ratio</th><th align="left"><italic>p</italic>-value</th></tr></thead><tbody><tr><td align="left">200</td><td align="left">50</td><td align="left">499</td><td align="left">432</td><td align="left">1.155</td><td align="left">1.1E-20</td></tr><tr><td align="left">250</td><td align="left">50</td><td align="left">497</td><td align="left">361</td><td align="left">1.377</td><td align="left">1.85E-42</td></tr><tr><td align="left">300</td><td align="left">50</td><td align="left">481</td><td align="left">310</td><td align="left">1.552</td><td align="left">5.19E-45</td></tr><tr><td align="left">350</td><td align="left">50</td><td align="left">417</td><td align="left">225</td><td align="left">1.853</td><td align="left">4.48E-38</td></tr><tr><td align="left">400</td><td align="left">50</td><td align="left">272</td><td align="left">135</td><td align="left">2.015</td><td align="left">5.74E-19</td></tr></tbody></table><table-wrap-foot><p>The table shows how the performance of ERS and CRS model is changing when we increase the initial number of pathogens. The unit of time is one-tenth of a day; <italic>f cells</italic>: the initial number of foreign cells at the 300th day; <italic>div time</italic>: the mean waiting time between two divisions of a foreign cell; <italic>ERS wins</italic>: number of wins of the immune system against pathogens using the ERS model setting; <italic>CRS wins</italic>: number of wins of the immune system against pathogens using the CRS model setting; <italic>ratio</italic>: ERS wins divided per CRS wins; <italic>p</italic>-value: one-sided <italic>p</italic>-value of the Fisher’s exact test. In every case ERS performed significantly better than CRS</p></table-wrap-foot></table-wrap><table-wrap id="Tab3"><label>Table 3</label><caption><p>ERS vs. CRS model, simulated by MiStImm 500–500 times as the mean waiting time between two divisions of a pathogen is increasing (from 40 to 80) and the initial number of pathogens is fixed (350)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">div time</th><th align="left">f cells</th><th align="left">ERS wins</th><th align="left">CRS wins</th><th align="left">ratio</th><th align="left"><italic>p</italic>-value</th></tr></thead><tbody><tr><td align="left">40</td><td align="left">350</td><td align="left">208</td><td align="left">66</td><td align="left">3.152</td><td align="left">1.19E-24</td></tr><tr><td align="left">50</td><td align="left">350</td><td align="left">417</td><td align="left">225</td><td align="left">1.853</td><td align="left">4.48E-38</td></tr><tr><td align="left">60</td><td align="left">350</td><td align="left">473</td><td align="left">320</td><td align="left">1.478</td><td align="left">1.16E-35</td></tr><tr><td align="left">70</td><td align="left">350</td><td align="left">493</td><td align="left">400</td><td align="left">1.233</td><td align="left">1.42E-24</td></tr><tr><td align="left">80</td><td align="left">350</td><td align="left">500</td><td align="left">441</td><td align="left">1.134</td><td align="left">2.81E-19</td></tr></tbody></table><table-wrap-foot><p>The table shows how the performance of ERS and CRS model is changing when we increase the mean waiting time between two divisions of a pathogen. Column labels are the same as in Table <xref rid="Tab2" ref-type="table">2</xref> but the positions of the columns “f cells” and “div time” are switched. In every cases ERS performed significantly better than CRS</p></table-wrap-foot></table-wrap><table-wrap id="Tab4"><label>Table 4</label><caption><p>Contingency table of the one sided Fisher’s exact test [<xref ref-type="bibr" rid="CR54">54</xref>] for the fourth row of Table <xref rid="Tab2" ref-type="table">2</xref>, as an example</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">ERS</th><th align="left">CRS</th><th align="left">Row total</th></tr></thead><tbody><tr><td align="left">Win</td><td align="left">417</td><td align="left">225</td><td align="left">642</td></tr><tr><td align="left">Loss</td><td align="left">83</td><td align="left">275</td><td align="left">358</td></tr><tr><td align="left">Col total</td><td align="left">500</td><td align="left">500</td><td align="left">1000</td></tr></tbody></table><table-wrap-foot><p>The <italic>p</italic>-value appearing there was calculated by the formula <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{i=417}^{500} {642 \choose i} {358 \choose 500-i} / {1000 \choose 500} \approx 4.48E-38 $\end{document}</tex-math><mml:math id="M6"><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>417</mml:mn></mml:mrow><mml:mrow><mml:mn>500</mml:mn></mml:mrow></mml:munderover><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0"><mml:mrow><mml:mn>642</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0"><mml:mrow><mml:mn>358</mml:mn></mml:mrow><mml:mrow><mml:mn>500</mml:mn><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>/</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0"><mml:mrow><mml:mn>1000</mml:mn></mml:mrow><mml:mrow><mml:mn>500</mml:mn></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>≈</mml:mo><mml:mn>4.48</mml:mn><mml:mi>E</mml:mi><mml:mo>−</mml:mo><mml:mn>38</mml:mn></mml:math><inline-graphic xlink:href="12976_2019_105_Article_IEq2.gif"/></alternatives></inline-formula>. Note that the values of the hypergeometric distribution inside the sum are the probabilities of choosing 500 experiments out of 1000, containing exactly <italic>i</italic> ERS wins of the given 642 total number of wins and also choosing exactly 500−<italic>i</italic> ERS losses of the given 358 total number of losses</p></table-wrap-foot></table-wrap>
</p>
    </sec>
    <sec id="Sec22">
      <title>Sensitivity analysis of the model parameters</title>
      <p>The objective of a sensitivity analysis (SA) is to identify critical input parameters of a model and quantifying how input uncertainty impacts model outputs [<xref ref-type="bibr" rid="CR32">32</xref>]. In the previous section, we investigated how a given output (win or lose against a critical infection) changes when we vary one particular input parameter. In this section, we investigate how output variables change when we vary more than one input parameters randomly at the same time. This method gives a more global insight into the correlations between the input and output.</p>
      <p>For this purpose, we have chosen 13 critical parameters that we have sampled randomly (by uniform distribution) around its default value (Table <xref rid="Tab5" ref-type="table">5</xref>). The remaining parameters have been fixed (to the same values as in Fig. <xref rid="Fig5" ref-type="fig">5</xref>a and b). We have also varied the random seed of the simulations, as usual. Each simulation was stopped at the 305th day (5 days after an initial infection) and the output variables were only evaluated at the end of the simulation (see Additional file <xref rid="MOESM2" ref-type="media">2</xref> for the raw data of the 500 simulations). Our main observations are summarized in Fig. <xref rid="Fig6" ref-type="fig">6</xref>, which shows the distributions of the output values Fig. <xref rid="Fig6" ref-type="fig">6</xref>a, and the correlations between input values and output values Fig. <xref rid="Fig6" ref-type="fig">6</xref>b, c and d. Interestingly, most of the input parameters do not correlate with any of the other output variables. We can suppose that this trend would remain if we would analyze all of the input parameters. So, actually, there may be much more unimportant (or even unnecessary) input parameters.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Sensitivity analysis to investigate how 13 critical input parameters impact certain output values 5 days after a random type of infection. <bold>a</bold> Value distribution of the input parameters <bold>b</bold> Pearson correlation coefficient between input parameters (horizontal axis) and output variables (vertical axis). Values are rounded to one decimal. <bold>c</bold> Scatter plot of the input parameter r0 (action radius of naive B cells) and the output variable nW (number of self cells). <bold>d</bold> Scatter plot of the input parameter taub0 (mean waiting time between two actions of a B cell) and the output variable nR (number of foreign cells). Descriptions of the output variables: nW, no. selfs; nR, no. foreign cells; nB, no. B cells; nAb, no. antibodies; nTh, no. T cells; nIL, no. danger signals; nM, no. bone marrow cells. Description of input parameters: see Table <xref rid="Tab1" ref-type="table">1</xref> in Additional file <xref rid="MOESM1" ref-type="media">1</xref> or the file “indat1” in the Github repository of MiStImm</p></caption><graphic xlink:href="12976_2019_105_Fig6_HTML" id="MO6"/></fig><table-wrap id="Tab5"><label>Table 5</label><caption><p>Input parameters for sensitivity analysis</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Parameter</th><th align="left">Type</th><th align="left">Default</th><th align="left">Min</th><th align="left">Max</th></tr></thead><tbody><tr><td align="left">r0</td><td align="left">int</td><td align="left">150</td><td align="left">50</td><td align="left">250</td></tr><tr><td align="left">pmem</td><td align="left">float</td><td align="left">0.3</td><td align="left">0.1</td><td align="left">0.5</td></tr><tr><td align="left">crnew</td><td align="left">float</td><td align="left">0.9</td><td align="left">0.1</td><td align="left">1.7</td></tr><tr><td align="left">rminnew</td><td align="left">int</td><td align="left">5</td><td align="left">1</td><td align="left">9</td></tr><tr><td align="left">crspread</td><td align="left">float</td><td align="left">0.9</td><td align="left">0.1</td><td align="left">1.7</td></tr><tr><td align="left">rminsprd</td><td align="left">int</td><td align="left">5</td><td align="left">1</td><td align="left">10</td></tr><tr><td align="left">thrad</td><td align="left">int</td><td align="left">80</td><td align="left">50</td><td align="left">250</td></tr><tr><td align="left">pmut</td><td align="left">float</td><td align="left">0.4</td><td align="left">0.1</td><td align="left">0.7</td></tr><tr><td align="left">taub0</td><td align="left">float</td><td align="left">5</td><td align="left">1</td><td align="left">9</td></tr><tr><td align="left">tauth0</td><td align="left">float</td><td align="left">2</td><td align="left">1</td><td align="left">9</td></tr><tr><td align="left">tcrit_stress</td><td align="left">float</td><td align="left">2</td><td align="left">1</td><td align="left">3</td></tr><tr><td align="left">nr</td><td align="left">int</td><td align="left">350</td><td align="left">200</td><td align="left">500</td></tr><tr><td align="left">tr</td><td align="left">float</td><td align="left">60</td><td align="left">40</td><td align="left">80</td></tr></tbody></table><table-wrap-foot><p>Values were sampled randomly with uniform distribution around its default value (between Min and Max). Borders of the ranges were chosen rather intuitively, appropriate to the meaning of the parameters, with the rule that the default value should be in the middle of the range</p></table-wrap-foot></table-wrap>
</p>
      <p>Another interesting observation is that the largest correlation is between the input parameter r0 (action radius of naive B cells) and nW (number of self cells). This may be due to the main characteristic of our proposed model (ERS model) that enables a constant weak connection between B cells and self cells. As we increase the radius of naive B cells there will be more reachable self peptides for naive B cells and it turns into a catastrophe, actually, an autoimmune reaction. The conclusion is that if we want to simulate a healthy (normal) immune reaction we must not set r0 to a value larger than 150 (see Fig. <xref rid="Fig6" ref-type="fig">6</xref>c). The second largest correlation was observed between the input parameter taub0 (mean waiting time between two actions of a B cell) and the output value nR (number of foreign cells). This means, not surprisingly, that the more the B cells action, the more efficient the immune reaction is.</p>
    </sec>
  </sec>
  <sec id="Sec23" sec-type="discussion">
    <title>Discussion</title>
    <p>When we built our simulator tool MiStImm, we have used some principles that were tested by other researchers in their work. The earliest related computer simulation model is the cellular automaton model Celada and Seiden [<xref ref-type="bibr" rid="CR8">8</xref>], which is focused, similarly as MiStImm, on the processes that are important for the initiation and regulation of the humoral immune response. All entities (A cells, B cells, T cells, antigens, antibodies) of the Celada-Seiden model along their structural elements appear in MiStImm (except the A-cells), however, we used a more complex model of affinity maturation. Another closely related model is an agent-based model, the <sc>C-IMMSIM</sc> [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. The main differences between C-ImmSim and MiStimm are that C-Immsim represents pathogens and lymphocytes receptors by their amino acid sequences and use bioinformatics methods for T and B cell epitope prediction. The Basic Immune Simulator (BIS) [<xref ref-type="bibr" rid="CR18">18</xref>] is also a closely related agent-based computing model that is intended to study the interactions between innate and adaptive immunity and demonstrated that the initial innate response is crucial for an appropriate adaptive response. [<xref ref-type="bibr" rid="CR21">21</xref>] developed SIMISYS, which is also a cellular automata model of the human immune system. It uses tens of thousands of cells and innate and adaptive components of the immune system. In particular, the model contains macrophages, dendritic cells, neutrophils, natural killer cells, B cells, T helper cells, complement proteins, and pathogenic bacteria. Reference [<xref ref-type="bibr" rid="CR33">33</xref>] investigates a hypothesis about B cell hypermutation and affinity maturation using both individual particle-based stochastic and concentration-based non-spatial non-stochastic, ordinary differential equation models. A B cell model developed in [<xref ref-type="bibr" rid="CR34">34</xref>] has partly similar ideas as our B cell model, but differs from MiStImm in the representation of ligands that are encoded by bit strings and their distances are measured by the number of mismatches (Hamming distance) (like in the above-mentioned IMMSIM and C-ImmSim models). Similar (but not identical) to our ERS model is the mathematical model of T cell mediated suppression of [<xref ref-type="bibr" rid="CR35">35</xref>], where tolerance is also based on ubiquitous and constitutive self-antigens, which select and sustain clones of specific regulatory (R) cells, and which are similar to our Treg cells. In their model, R cell populations represent typically between 30% and 95% of the total T cells in the periphery. It is an important difference to the widely accepted view in which conventional regulatory CD4+CD25+ T cells (Treg) usually make up only about 5–10% of CD4+ T cells [<xref ref-type="bibr" rid="CR36">36</xref>]. R cells perform their function through linked recognition of the APCs (antigen presenting cells). Also in their model, immune responses to foreign antigens are achieved by displacing the self-antigens from the APCs, leading to a loss of R cells if the foreign antigen introduction entails a sharp increase in the number of foreign antigen carrying APCs.</p>
    <p>Predictions of our theoretical model and the outcomes of the in silico experiment of the Results are supported by numerous clinical trial observations. As a result of the cancer immunotherapy revolution hundreds of clinical trials of the newly approved immunotherapies are now under way to improve responses. Not unexpectedly, the 2018 Nobel Prize in Physiology or Medicine was awarded to James P. Allison and Tasuku Honjo for their development of cancer therapy by blockade of co-inhibitory signals. While success stories of terminal cancer patients achieving complete remissions are accumulating, not enough research has been done into the risks of the new therapies. The developers of the inhibitory anti-CTLA-4 antibody started with the premise that a CTLA-4 (cytotoxic T lymphocyte-associated antigen 4) blockade would selectively target anti-tumor T cells [<xref ref-type="bibr" rid="CR37">37</xref>]. Although the anti-CTLA-4 antibody improved survival in a minority of metastatic melanoma patients, the vast majority suffered autoimmune-related adverse events (irAEs) [<xref ref-type="bibr" rid="CR38">38</xref>]. While the conventional nonself centered T cell activation models (implemented as the CRS model in MiStImm) are unable to explain the widespread and dose-dependent irAEs, our self-centered T cell activation model (implemented as the ERS model in MiStImm) can [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. The reason for this that the nonself-centered models eliminate self-reactive immune cells to ensure that an activation signal can exclusively originate from a foreign/mutated antigen. However, there is evidence for that immune cells require cognate receptor engagement with ubiquitous self antigens in their ’flight for survival’ [<xref ref-type="bibr" rid="CR39">39</xref>]. During such engagements T cells receive ’tonic’ signal one (TCR signal) generated by positively selecting self-peptide/MHC, which promotes activation and homeostatic survival of T cells in the periphery (see regulatory T cells of the ERS model in MiStImm). Furthermore, there is evidence for control of such tonic TCR signals by co-inhibitors [<xref ref-type="bibr" rid="CR40">40</xref>]. This is consistent with a critical role for co-inhibitors early in life to establish tolerance in the first T cells that seed the periphery ([<xref ref-type="bibr" rid="CR40">40</xref>–<xref ref-type="bibr" rid="CR42">42</xref>]. In addition, the ability of TCRs to interact with tonic self-peptide/MHC ligands opens the possibility that co-inhibitor blockade causes T cell effector activity to spill over onto nearby healthy cells. Increased collateral damage is indeed seen during immune responses where a co-inhibitor is lacking [<xref ref-type="bibr" rid="CR43">43</xref>]. Altogether, the above concepts suggest that all T cells are temporarily activated, expressing co-inhibitors such as CTLA-4 that can then be targeted by anti-CTLA-4 antibodies. This is consistent with the immunological homunculus concept of Irun Cohen, who suggested that the immune system continuously responds to self [<xref ref-type="bibr" rid="CR44">44</xref>]. Prolonged therapeutic overstimulation of T cells by antibodies that target their negative regulators (immune checkpoint, IC) such as CTLA-4 and the programmed cell death protein 1 pathway (PD-1/PD-L1) led to a breakthrough in the treatment of a variety of malignancies. While three generations of IC immunotherapy have been developed since Ref. [<xref ref-type="bibr" rid="CR45">45</xref>, <xref ref-type="bibr" rid="CR46">46</xref>], the safety of IC blockade is still an unresolved, timely and sensitive issue in the context of advanced cancer patients. By now Science has acknowledged that these patients are “human experiments” of the autoimmune process [<xref ref-type="bibr" rid="CR47">47</xref>]. Notwithstanding, we could not find a paper (other than our own) that deduced the widespread irAEs based on the similar outcomes of the TGN1412 and ipilimumab trials despite the fact that the number of ipilimumab papers has increased from 144 (in 2011) to 2585 (PubMed search as of October, 2018). As a result of the impaired self-tolerance, irAEs may present with a broad clinical spectrum that mainly involves the gut, skin, endocrine glands, liver, and lung but can potentially affect any tissue, and their incidence may reach up to 90% of patients [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. Actually, the Nobel committee emphasized that a crucial aspect in the future development of checkpoint inhibitor therapies is to improve understanding of events leading to adverse events.1 Since the use of immunotherapy is becoming more common, and is expected to develop into first- and second-line treatments, immunotoxicity and autoimmunity are emerging as the nemesis of immunotherapy. Based on our self-centered theory, we have addressed the controversy regarding the safety–efficacy issue in immunotherapy trials and argued that the price we pay for reversing immunosuppression in cancer by a prolonged immune checkpoint blockade is the generation of uncontrolled T-cell activation [<xref ref-type="bibr" rid="CR48">48</xref>–<xref ref-type="bibr" rid="CR51">51</xref>]. We predicted that harnessing the unleashed autoimmune power of T cells by low dose IC blockade could be rewarding to defeat cancer. Using our prediction, Ref. [<xref ref-type="bibr" rid="CR52">52</xref>, <xref ref-type="bibr" rid="CR53">53</xref>] have developed just such a promising combination therapy, which was safely and successfully administered to heavily pretreated stage IV cancer patients who had exhausted all conventional treatments.</p>
  </sec>
  <sec id="Sec24" sec-type="conclusion">
    <title>Conclusions</title>
    <p>We described the MiStImm simulation tool that was made to investigate some important characteristics of immune development, starting from conception and ending some time after birth. Results of some computer experiments were discussed. An important part of the latter was the comparison of the CRS and ERS theoretical models. We think that it is likely that evolution preferred adaptive immune systems whose basic mechanism is closer to the ERS model than to a CRS model because ERS gives better results to overcome a critical primary infection. We hope that our ideas and our computational model may encourage investigations about the problems raised in this paper, using both in vitro and in vivo experiments. We would especially like to see experiments clarifying questions about self-nonself discrimination in a primary infection.</p>
  </sec>
  <sec id="Sec25" sec-type="data-availability">
    <title>Availability of data and materials</title>
    <p><bold>Project name:</bold> MiStImm</p>
    <p>
      <bold>Project home page:</bold>
      <ext-link ext-link-type="uri" xlink:href="https://github.com/kerepesi/mistimm">https://github.com/kerepesi/mistimm</ext-link>
    </p>
    <p><bold>Operating system(s):</bold> Windows</p>
    <p><bold>Programming language:</bold> C</p>
    <p><bold>Other requirements:</bold> -</p>
    <p><bold>License:</bold> -</p>
    <p><bold>Any restrictions to use by non-academics:</bold> -</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec26">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12976_2019_105_MOESM1_ESM.pdf">
            <label>Additional file 1</label>
            <caption>
              <p>Appendix. Description of the mathematical model of the event sequence (section 1), the logistic function (section 1) Behavioral rules of the components (agents) of the model (section 3-8). Input parameters for the simulation program (section 8). (PDF 241 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12976_2019_105_MOESM2_ESM.xlsx">
            <label>Additional file 2</label>
            <caption>
              <p>Data of sensitivity analysis. Results of sensitivity analysis of input parameters. (XLSX 57 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BCR</term>
        <def>
          <p>B cell receptor</p>
        </def>
      </def-item>
      <def-item>
        <term>CRS</term>
        <def>
          <p>Conventional role of self model</p>
        </def>
      </def-item>
      <def-item>
        <term>ERS</term>
        <def>
          <p>Enhanced role of self model</p>
        </def>
      </def-item>
      <def-item>
        <term>IrAE</term>
        <def>
          <p>Immune-related adverse event</p>
        </def>
      </def-item>
      <def-item>
        <term>MHC</term>
        <def>
          <p>Major histocompatibility complex</p>
        </def>
      </def-item>
      <def-item>
        <term>MiStImm</term>
        <def>
          <p>Microscopic stochastic immune simulator</p>
        </def>
      </def-item>
      <def-item>
        <term>SA</term>
        <def>
          <p>Sensitivity analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>TCR</term>
        <def>
          <p>T cell receptor</p>
        </def>
      </def-item>
      <def-item>
        <term>Treg</term>
        <def>
          <p>regulatory T cell</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>We are grateful to Dr. Andrea Ladányi for her useful criticism and to Prof. Péter Csermely for his useful advice. We thank former students Gábor Szabados, Tamás Kiss, Kristóf Hörömpöly, and Endre Szecsei for their contributions to developing the software.</p>
    <sec id="d29e2446">
      <title>Funding</title>
      <p>CK is supported by the “2018-1.2.1-NKP-00008: Exploring the Mathematical Foundations of Artificial Intelligence” project supported by the Ministry of Human Capacities in Hungary.</p>
    </sec>
    <sec id="d29e2451" sec-type="data-availability">
      <title>Availability of data and materials</title>
      <p>Source codes and executables of MiStImm are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/kerepesi/MiStImm">https://github.com/kerepesi/MiStImm</ext-link>. Simulation output files are available at <ext-link ext-link-type="uri" xlink:href="https://info.ilab.sztaki.hu/~kerepesi/MiStImm/">https://info.ilab.sztaki.hu/~kerepesi/MiStImm/</ext-link>. Every simulation output file contain the actual parameter setting.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>TB and TS conceived the study. TS developed the first version of the MiStImm program. CK and TS developed the final version of the MiStImm program. CK performed the simulations presented in the <xref rid="Sec16" ref-type="sec">Results</xref>. All authors interpreted the results, drafted the manuscript, read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec>
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec>
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec>
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec>
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Tauber</surname>
            <given-names>AI</given-names>
          </name>
        </person-group>
        <source>Immunity: the Evolution of an Idea</source>
        <year>2017</year>
        <publisher-loc>Oxford</publisher-loc>
        <publisher-name>Oxford University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bakács</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mehrishi</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Szabados</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Varga</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Szabó</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tusnády</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>T cells survey the stability of the self: a testable hypothesis on the homeostatic role of TCR-MHC interactions</article-title>
        <source>Int Arch Allergy and Immunol</source>
        <year>2007</year>
        <volume>144</volume>
        <fpage>171</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1159/000103282</pub-id>
        <pub-id pub-id-type="pmid">17541288</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Szabados</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bakács</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Sufficient to recognize self to attack non-self: blueprint for a one-signal T cell model</article-title>
        <source>J Biol Syst</source>
        <year>2011</year>
        <volume>19</volume>
        <fpage>299</fpage>
        <lpage>317</lpage>
        <pub-id pub-id-type="doi">10.1142/S0218339011003919</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Topalian</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Targeting immune checkpoints in cancer therapy</article-title>
        <source>Jama</source>
        <year>2017</year>
        <volume>318</volume>
        <issue>17</issue>
        <fpage>1647</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1001/jama.2017.14155</pub-id>
        <?supplied-pmid 28885639?>
        <pub-id pub-id-type="pmid">28885639</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kelly</surname>
            <given-names>PN</given-names>
          </name>
        </person-group>
        <article-title>The Cancer Immunotherapy Revolution</article-title>
        <source>Science</source>
        <year>2018</year>
        <volume>359</volume>
        <issue>6382</issue>
        <fpage>1344</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1126/science.359.6382.1344</pub-id>
        <?supplied-pmid 29567702?>
        <pub-id pub-id-type="pmid">29567702</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Puzanov</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Diab</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Abdallah</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bingham</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Brogdon</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dadu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hamad</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lacouture</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>LeBoeuf</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Managing toxicities associated with immune checkpoint inhibitors: consensus recommendations from the Society for Immunotherapy of Cancer (SITC) Toxicity Management Working Group</article-title>
        <source>J Immunother Cancer</source>
        <year>2017</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>95</fpage>
        <pub-id pub-id-type="doi">10.1186/s40425-017-0300-z</pub-id>
        <?supplied-pmid 29162153?>
        <pub-id pub-id-type="pmid">29162153</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brahmer</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Lacchetti</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Management of immune-related adverse events in patients treated with immune checkpoint inhibitor therapy: American Society of Clinical Oncology Clinical Practice Guideline Summary</article-title>
        <source>J Oncol Pract</source>
        <year>2018</year>
        <volume>14</volume>
        <issue>4</issue>
        <fpage>247</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1200/JOP.18.00005</pub-id>
        <?supplied-pmid 29517954?>
        <pub-id pub-id-type="pmid">29517954</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Celada</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Seiden</surname>
            <given-names>PE</given-names>
          </name>
        </person-group>
        <article-title>A computer model of cellular interactions in the immune system</article-title>
        <source>Immunol Today</source>
        <year>1992</year>
        <volume>13</volume>
        <fpage>56</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="doi">10.1016/0167-5699(92)90135-T</pub-id>
        <?supplied-pmid 1575893?>
        <pub-id pub-id-type="pmid">1575893</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bonabeau</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Agent-based modeling: Methods and techniques for simulating human systems</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2002</year>
        <volume>99</volume>
        <issue>suppl 3</issue>
        <fpage>7280</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.082080899</pub-id>
        <?supplied-pmid 12011407?>
        <pub-id pub-id-type="pmid">12011407</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Germain</surname>
            <given-names>RN</given-names>
          </name>
          <name>
            <surname>Meier-Schellersheim</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nita-Lazar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fraser</surname>
            <given-names>IDC</given-names>
          </name>
        </person-group>
        <article-title>Systems biology in immunology – A computational modeling perspective</article-title>
        <source>Annu Rev Immunol</source>
        <year>2011</year>
        <volume>29</volume>
        <fpage>527</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-immunol-030409-101317</pub-id>
        <?supplied-pmid 21219182?>
        <pub-id pub-id-type="pmid">21219182</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bretscher</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cohn</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A theory of self-nonself discrimination: Paralysis and induction involve the recognition of one and two determinants on an antigen, respectively</article-title>
        <source>Science</source>
        <year>1970</year>
        <volume>169</volume>
        <issue>3950</issue>
        <fpage>1042</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1126/science.169.3950.1042</pub-id>
        <?supplied-pmid 4194660?>
        <pub-id pub-id-type="pmid">4194660</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Janeway</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>KP</given-names>
          </name>
          <name>
            <surname>Travers</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Walport</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>Immunobiology</source>
        <year>2008</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Garland Science</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Paul</surname>
            <given-names>WE</given-names>
          </name>
        </person-group>
        <source>Fundamental immunology</source>
        <year>2008</year>
        <publisher-loc>Philadelphia</publisher-loc>
        <publisher-name>Lippincott Williams &amp; Wilkins</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Faro</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Velasco</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>González-Fernández</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bandeira</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>The impact of thymic antigen diversity on the size of the selected t cell repertoire</article-title>
        <source>J Immunol</source>
        <year>2004</year>
        <volume>172</volume>
        <issue>4</issue>
        <fpage>2247</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="doi">10.4049/jimmunol.172.4.2247</pub-id>
        <?supplied-pmid 14764693?>
        <pub-id pub-id-type="pmid">14764693</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langman</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <article-title>Molecular economy and antibody function: the evolution of a Protecton</article-title>
        <source>Int J Clin Lab Res.</source>
        <year>1992</year>
        <volume>22</volume>
        <issue>1–4</issue>
        <fpage>63</fpage>
        <lpage>68</lpage>
        <pub-id pub-id-type="doi">10.1007/BF02591398</pub-id>
        <?supplied-pmid 1504307?>
        <pub-id pub-id-type="pmid">1504307</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bredberg</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Cancer resistance and peto’s paradox</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2009</year>
        <volume>106</volume>
        <fpage>51</fpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0901953106</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>AK</surname>
            <given-names>AKA</given-names>
          </name>
          <name>
            <surname>Lichtman</surname>
            <given-names>AH</given-names>
          </name>
        </person-group>
        <source>Basic Immunology: Functions and Disorders of the Immune System, 2nd edn.</source>
        <year>2004</year>
        <publisher-loc>Philadelphia</publisher-loc>
        <publisher-name>Saunders</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Folcik</surname>
            <given-names>VA</given-names>
          </name>
          <name>
            <surname>An</surname>
            <given-names>GC</given-names>
          </name>
          <name>
            <surname>Orosz</surname>
            <given-names>CG</given-names>
          </name>
        </person-group>
        <article-title>The Basic Immune Simulator: An agent-based model to study the interactions between innate and adaptive immunity</article-title>
        <source>Theor Biol Med Model</source>
        <year>2007</year>
        <volume>4</volume>
        <fpage>39</fpage>
        <pub-id pub-id-type="doi">10.1186/1742-4682-4-39</pub-id>
        <?supplied-pmid 17900357?>
        <pub-id pub-id-type="pmid">17900357</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Castiglione</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bernaschi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Succi</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Simulating the immune response on a distributed parallel computer</article-title>
        <source>Int J Mod Phys C</source>
        <year>1997</year>
        <volume>8</volume>
        <issue>03</issue>
        <fpage>527</fpage>
        <lpage>45</lpage>
        <pub-id pub-id-type="doi">10.1142/S0129183197000424</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rapin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Lund</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Bernaschi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Castiglione</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Computational immunology meets bioinformatics: The use of prediction tools for molecular binding in the simulation of the immune system</article-title>
        <source>PLoS ONE</source>
        <year>2010</year>
        <volume>5</volume>
        <issue>4</issue>
        <fpage>9862</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0009862</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kalita</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Chandrashekar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hans</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Selvam</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Newell</surname>
            <given-names>MK</given-names>
          </name>
        </person-group>
        <article-title>Computational modelling and simulation of the immune system</article-title>
        <source>Int J Bioinform Res Appl</source>
        <year>2006</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>63</fpage>
        <lpage>88</lpage>
        <pub-id pub-id-type="doi">10.1504/IJBRA.2006.009194</pub-id>
        <?supplied-pmid 18048154?>
        <pub-id pub-id-type="pmid">18048154</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kaufman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Urbain</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Towards a logical analysis of immune response</article-title>
        <source>J Theor Biol</source>
        <year>1985</year>
        <volume>114</volume>
        <fpage>527</fpage>
        <lpage>61</lpage>
        <pub-id pub-id-type="doi">10.1016/S0022-5193(85)80042-4</pub-id>
        <?supplied-pmid 3875000?>
        <pub-id pub-id-type="pmid">3875000</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Boer</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Perelson</surname>
            <given-names>AS</given-names>
          </name>
        </person-group>
        <article-title>Size and connectivity as emergent properties of a developing immune network</article-title>
        <source>J Theor Biol</source>
        <year>1991</year>
        <volume>149</volume>
        <fpage>381</fpage>
        <lpage>424</lpage>
        <pub-id pub-id-type="doi">10.1016/S0022-5193(05)80313-3</pub-id>
        <?supplied-pmid 2062103?>
        <pub-id pub-id-type="pmid">2062103</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perelson</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Oster</surname>
            <given-names>GF</given-names>
          </name>
        </person-group>
        <article-title>Theoretical studies of clonal selection: minimal antibody repertoire size and reliability of self-nonself discrimination</article-title>
        <source>J Theor Biol</source>
        <year>1979</year>
        <volume>81</volume>
        <fpage>645</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1016/0022-5193(79)90275-3</pub-id>
        <?supplied-pmid 94141?>
        <pub-id pub-id-type="pmid">94141</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segel</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Perelson</surname>
            <given-names>AS</given-names>
          </name>
        </person-group>
        <article-title>Computations in shape space: a new approach to immune network theory</article-title>
        <source>Theor Immunol</source>
        <year>1988</year>
        <volume>2</volume>
        <fpage>321</fpage>
        <lpage>43</lpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Celada</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Seiden</surname>
            <given-names>PE</given-names>
          </name>
        </person-group>
        <article-title>Affinity maturation and hypermutation in a simulation of the humoral immune response</article-title>
        <source>Eur J Immunol</source>
        <year>1996</year>
        <volume>26</volume>
        <fpage>1350</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1002/eji.1830260626</pub-id>
        <?supplied-pmid 8647216?>
        <pub-id pub-id-type="pmid">8647216</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mehrishi</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Szabó</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bakács</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Some aspects of the recombinantly expressed humanised superagonist anti-CD28 mAb, TGN1412 trial catastrophe lessons to safeguard mAbs and vaccine trials</article-title>
        <source>Vaccine</source>
        <year>2007</year>
        <volume>25</volume>
        <fpage>3517</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1016/j.vaccine.2007.02.078</pub-id>
        <?supplied-pmid 17397974?>
        <pub-id pub-id-type="pmid">17397974</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thimme</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Oldach</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Steiger</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ray</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Chisari</surname>
            <given-names>FV</given-names>
          </name>
        </person-group>
        <article-title>Determinants of viral clearance and persistence during acute hepatitis C virus infection</article-title>
        <source>J Exp Med</source>
        <year>2001</year>
        <volume>194</volume>
        <fpage>1395</fpage>
        <lpage>406</lpage>
        <pub-id pub-id-type="doi">10.1084/jem.194.10.1395</pub-id>
        <?supplied-pmid 11714747?>
        <pub-id pub-id-type="pmid">11714747</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eberl</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Colonna</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Di Santo</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>McKenzie</surname>
            <given-names>AN</given-names>
          </name>
        </person-group>
        <article-title>Innate lymphoid cells: A new paradigm in immunology</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>348</volume>
        <issue>6237</issue>
        <fpage>6566</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aaa6566</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matzinger</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>The danger model: a renewed sense of self</article-title>
        <source>Science</source>
        <year>2002</year>
        <volume>296</volume>
        <issue>5566</issue>
        <fpage>301</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1071059</pub-id>
        <pub-id pub-id-type="pmid">11951032</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Chollet</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <source>Deep learning with python</source>
        <year>2017</year>
        <publisher-loc>Shelter Island</publisher-loc>
        <publisher-name>Manning</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marino</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hogue</surname>
            <given-names>IB</given-names>
          </name>
          <name>
            <surname>Ray</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Kirschner</surname>
            <given-names>DE</given-names>
          </name>
        </person-group>
        <article-title>A methodology for performing global uncertainty and sensitivity analysis in systems biology</article-title>
        <source>J Theor Biol</source>
        <year>2008</year>
        <volume>254</volume>
        <issue>1</issue>
        <fpage>178</fpage>
        <lpage>96</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jtbi.2008.04.011</pub-id>
        <?supplied-pmid 18572196?>
        <pub-id pub-id-type="pmid">18572196</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Billard</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ramirez</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Schmidl</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Monson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kepler</surname>
            <given-names>TB</given-names>
          </name>
        </person-group>
        <article-title>A model for migratory B cell oscillations from receptor down-regulation induced by external chemokine fields</article-title>
        <source>Bull Math Biol</source>
        <year>2013</year>
        <volume>75</volume>
        <issue>1</issue>
        <fpage>185</fpage>
        <lpage>205</lpage>
        <pub-id pub-id-type="doi">10.1007/s11538-012-9799-9</pub-id>
        <?supplied-pmid 23296998?>
        <pub-id pub-id-type="pmid">23296998</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schulz</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Werner</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Behn</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Self-tolerance in a minimal model of the idiotypic network</article-title>
        <source>Immune Syst Model Anal.</source>
        <year>2014</year>
        <volume>5</volume>
        <issue>86</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>León</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lage</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Carneiro</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Tolerance and immunity in a mathematical model of T-cell mediated suppression</article-title>
        <source>J Theor Biol</source>
        <year>2003</year>
        <volume>225</volume>
        <issue>1</issue>
        <fpage>107</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1016/S0022-5193(03)00226-1</pub-id>
        <?supplied-pmid 14559064?>
        <pub-id pub-id-type="pmid">14559064</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chinen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kannan</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gasteiger</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Fontenot</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Rudensky</surname>
            <given-names>AY</given-names>
          </name>
        </person-group>
        <article-title>An essential role for the IL-2 receptor in Treg cell function</article-title>
        <source>Nat Immunol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>11</issue>
        <fpage>1322</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1038/ni.3540</pub-id>
        <?supplied-pmid 27595233?>
        <pub-id pub-id-type="pmid">27595233</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Curran</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Callahan</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Subudhi</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Allison</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Response to Ipilimumab (Yervoy) and the TGN1412 catastrophe</article-title>
        <source>Immunobiology</source>
        <year>2012</year>
        <volume>217</volume>
        <issue>6</issue>
        <fpage>590</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="doi">10.1016/j.imbio.2011.11.001</pub-id>
        <?supplied-pmid 22459268?>
        <pub-id pub-id-type="pmid">22459268</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bertrand</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kostine</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Barnetche</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Truchetet</surname>
            <given-names>M-E</given-names>
          </name>
          <name>
            <surname>Schaeverbeke</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Immune related adverse events associated with anti-CTLA-4 antibodies: systematic review and meta-analysis</article-title>
        <source>BMC Med</source>
        <year>2015</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>211</fpage>
        <pub-id pub-id-type="doi">10.1186/s12916-015-0455-8</pub-id>
        <?supplied-pmid 26337719?>
        <pub-id pub-id-type="pmid">26337719</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Freitas</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Rocha</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Population biology of lymphocytes: the flight for survival</article-title>
        <source>Annu Rev Immunol</source>
        <year>2000</year>
        <volume>18</volume>
        <fpage>83</fpage>
        <lpage>111</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev.immunol.18.1.83</pub-id>
        <?supplied-pmid 10837053?>
        <pub-id pub-id-type="pmid">10837053</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ellestad</surname>
            <given-names>KK</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Boon</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>CC</given-names>
          </name>
        </person-group>
        <article-title>PD-1 controls tonic signaling and lymphopenia-induced proliferation of T lymphocytes</article-title>
        <source>Front Immunol</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>1289</fpage>
        <pub-id pub-id-type="doi">10.3389/fimmu.2017.01289</pub-id>
        <?supplied-pmid 29075267?>
        <pub-id pub-id-type="pmid">29075267</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ellestad</surname>
            <given-names>KK</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>CC</given-names>
          </name>
        </person-group>
        <article-title>Two strikes and you’re out? The pathogenic interplay of coinhibitor deficiency and lymphopenia-induced proliferation</article-title>
        <source>J Immunol</source>
        <year>2017</year>
        <volume>198</volume>
        <issue>7</issue>
        <fpage>2534</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="doi">10.4049/jimmunol.1601884</pub-id>
        <?supplied-pmid 28320914?>
        <pub-id pub-id-type="pmid">28320914</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ellestad</surname>
            <given-names>KK</given-names>
          </name>
          <name>
            <surname>Thangavelu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Haile</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Boon</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>CC</given-names>
          </name>
        </person-group>
        <article-title>Prior to Peripheral Tolerance, newly generated cD4 T cells Maintain Dangerous autoimmune Potential: Fas-and Perforin-independent autoimmunity controlled by Programmed Death-1</article-title>
        <source>Front Immunol</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>12</fpage>
        <pub-id pub-id-type="doi">10.3389/fimmu.2018.00012</pub-id>
        <?supplied-pmid 29416537?>
        <pub-id pub-id-type="pmid">29416537</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thangavelu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gill</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Boon</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ellestad</surname>
            <given-names>KK</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>CC</given-names>
          </name>
        </person-group>
        <article-title>Control of in vivo collateral damage generated by T cell immunity</article-title>
        <source>J Immunol</source>
        <year>2013</year>
        <volume>191</volume>
        <issue>4</issue>
        <fpage>1686</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.4049/jimmunol.1203240</pub-id>
        <?supplied-pmid 23851694?>
        <pub-id pub-id-type="pmid">23851694</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cohen</surname>
            <given-names>IR</given-names>
          </name>
        </person-group>
        <article-title>The cognitive paradigm and the immunological homunculus</article-title>
        <source>Immunol Today</source>
        <year>1992</year>
        <volume>13</volume>
        <issue>12</issue>
        <fpage>490</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1016/0167-5699(92)90024-2</pub-id>
        <?supplied-pmid 1463581?>
        <pub-id pub-id-type="pmid">1463581</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allison</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Immune checkpoint blockade in cancer therapy: the 2015 lasker-debakey clinical medical research award</article-title>
        <source>Jama</source>
        <year>2015</year>
        <volume>314</volume>
        <issue>11</issue>
        <fpage>1113</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1001/jama.2015.11929</pub-id>
        <?supplied-pmid 26348357?>
        <pub-id pub-id-type="pmid">26348357</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoos</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Development of immuno-oncology drugs from CTLA4 to PD1 to the next generations</article-title>
        <source>Nat Rev Drug Discov</source>
        <year>2016</year>
        <volume>15</volume>
        <issue>4</issue>
        <fpage>235</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.1038/nrd.2015.35</pub-id>
        <?supplied-pmid 26965203?>
        <pub-id pub-id-type="pmid">26965203</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Couzin-Frankel</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Autoimmune diseases surface after cancer treatment</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>358</volume>
        <issue>6365</issue>
        <fpage>852</fpage>
        <pub-id pub-id-type="doi">10.1126/science.358.6365.852</pub-id>
        <?supplied-pmid 29146788?>
        <pub-id pub-id-type="pmid">29146788</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bakacs</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mehrishi</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Moss</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Ipilimumab (Yervoy) and the TGN1412 catastrophe</article-title>
        <source>Immunobiology</source>
        <year>2012</year>
        <volume>217</volume>
        <issue>6</issue>
        <fpage>583</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1016/j.imbio.2011.07.005</pub-id>
        <?supplied-pmid 21821307?>
        <pub-id pub-id-type="pmid">21821307</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bakacs</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mehrishi</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Szabo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moss</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Interesting possibilities to improve the safety and efficacy of ipilimumab (Yervoy)</article-title>
        <source>Pharmacol Res</source>
        <year>2012</year>
        <volume>66</volume>
        <issue>2</issue>
        <fpage>192</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1016/j.phrs.2012.03.015</pub-id>
        <?supplied-pmid 22503629?>
        <pub-id pub-id-type="pmid">22503629</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Slavin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Moss</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bakacs</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Control of minimal residual cancer by low dose ipilimumab activating autologous anti-tumor immunity</article-title>
        <source>Pharmacol Res</source>
        <year>2014</year>
        <volume>79</volume>
        <fpage>9</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1016/j.phrs.2013.10.004</pub-id>
        <?supplied-pmid 24200897?>
        <pub-id pub-id-type="pmid">24200897</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bakacs</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mehrishi</surname>
            <given-names>JN</given-names>
          </name>
        </person-group>
        <article-title>Anti-CTLA-4 therapy may have mechanisms similar to those occurring in inherited human CTLA4 haploinsufficiency</article-title>
        <source>Immunobiology</source>
        <year>2015</year>
        <volume>220</volume>
        <issue>5</issue>
        <fpage>624</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1016/j.imbio.2014.11.019</pub-id>
        <?supplied-pmid 25638260?>
        <pub-id pub-id-type="pmid">25638260</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kleef</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Moss</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Szasz</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Bohdjalian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bakacs</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Near complete remission of pulmonary metastases in triple negative breast cancer (TNBC) using low-dose immune checkpoint (IC) inhibitors with high dose (HD) interleukin-2 (IL-2) and fever range hyperthermia</article-title>
        <source>J Clin Oncol</source>
        <year>2016</year>
        <volume>34</volume>
        <issue>15_suppl</issue>
        <fpage>e23111</fpage>
        <lpage>e23111</lpage>
        <pub-id pub-id-type="doi">10.1200/JCO.2016.34.15_suppl.e23111</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kleef</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Moss</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Szasz</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Bohdjalian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bojar</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bakacs</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Complete clinical remission of stage iv triple-negative breast cancer lung metastasis administering low-dose immune checkpoint blockade in combination with hyperthermia and interleukin-2</article-title>
        <source>Integr Cancer Ther.</source>
        <year>2018</year>
        <volume>4</volume>
        <fpage>1297</fpage>
        <lpage>303</lpage>
        <pub-id pub-id-type="doi">10.1177/1534735418794867</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Fisher</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <source>The design of experiments</source>
        <year>1949</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Hafner</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
