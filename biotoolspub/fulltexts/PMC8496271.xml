<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">G3 (Bethesda)</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genetics</journal-id>
    <journal-id journal-id-type="publisher-id">g3journal</journal-id>
    <journal-title-group>
      <journal-title>G3: Genes|Genomes|Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2160-1836</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8496271</article-id>
    <article-id pub-id-type="pmid">34544142</article-id>
    <article-id pub-id-type="doi">10.1093/g3journal/jkab204</article-id>
    <article-id pub-id-type="publisher-id">jkab204</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software and Data Resources</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01180</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI00010</subject>
        <subject>AcademicSubjects/SCI00960</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Eagle for better genome-wide association mapping</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>George</surname>
          <given-names>Andrew W</given-names>
        </name>
        <xref rid="jkab204-aff1" ref-type="aff">1</xref>
        <xref rid="jkab204-cor1" ref-type="corresp"/>
        <!--geo047@gmail.com-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Verbyla</surname>
          <given-names>Arunas</given-names>
        </name>
        <xref rid="jkab204-aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bowden</surname>
          <given-names>Joshua</given-names>
        </name>
        <xref rid="jkab204-aff3" ref-type="aff">3</xref>
      </contrib>
    </contrib-group>
    <aff id="jkab204-aff1"><label>1</label><institution>Data61, Commonwealth Scientific and Industrial Research Organisation</institution>, Brisbane 4102, <country country="AU">Australia</country></aff>
    <aff id="jkab204-aff2"><label>2</label><institution>Data61, Commonwealth Scientific and Industrial Research Organisation</institution>, Atherton 4883, <country country="AU">Australia</country></aff>
    <aff id="jkab204-aff3"><label>3</label><institution>Inria Rennes—Bretagne Atlantique, Campus Universitaire de Beaulieu</institution>, Rennes 35042, <country country="FR">France</country></aff>
    <author-notes>
      <corresp id="jkab204-cor1">Corresponding author: Email: <email>geo047@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-07-16">
      <day>16</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <volume>11</volume>
    <issue>9</issue>
    <elocation-id>jkab204</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>03</day>
        <month>6</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press on behalf of Genetics Society of America.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial-NoDerivs licence (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">http://creativecommons.org/licenses/by-nc-nd/4.0/</ext-link>), which permits non-commercial reproduction and distribution of the work, in any medium, provided the original work is not altered or transformed in any way, and that the work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="jkab204.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Eagle is an R package for multi-locus association mapping on a genome-wide scale. It is unlike other multi-locus packages in that it is easy to use for R users and non-users alike. It has two modes of use, command line and graphical user interface. Eagle is fully documented and has its own supporting website, <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://eagle.r-forge.r-project.org/index.html" ext-link-type="uri">http://eagle.r-forge.r-project.org/index.html</ext-link>. Eagle is a significant improvement over the method-of-choice, single-locus association mapping. It has greater power to detect SNP-trait associations. It is based on model selection, linear mixed models, and a clever idea on how random effects can be used to identify SNP-trait associations. Through an example with real mouse data, we demonstrate Eagle’s ability to bring clarity and increased insight to single-locus findings. Initially, we see Eagle complementing single-locus analyses. However, over time, we hope the community will make, increasingly, multi-locus association mapping their method-of-choice for the analysis of genome-wide association study data.</p>
    </abstract>
    <kwd-group>
      <kwd>multi-locus</kwd>
      <kwd>quantitative trait</kwd>
      <kwd>genetic discovery</kwd>
      <kwd>model selection</kwd>
      <kwd>GWAS</kwd>
    </kwd-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <p>The Eagle package was developed to meet a shared need in animal, plant, and human genetics. It was built to make multi-locus association mapping easy. Multi-locus association mapping is more powerful, statistically, than single-locus association mapping (<xref rid="jkab204-B16" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="jkab204-B19" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2019</xref>). By being able to model the association between multiple single-nucleotide polymorphisms (SNPs) and a trait simultaneously, multi-locus association mapping better captures the hidden reality of heritable traits with complex genetic architectures. Yet, multi-locus association mapping is rarely used in practice. Many of the current multi-locus software implementations are driven by high-level statistical theory making their inner statistical workings difficult to follow for non-statisticians. Eagle does not suffer from this limitation.</p>
  <p>We created the Eagle package to be as fast as single-locus association mapping, to be easy to use even for non-R users, and to give easily interpretable results. It implements the Eagle method for association mapping (<xref rid="jkab204-B5" ref-type="bibr">George <italic toggle="yes">et al.</italic> 2020</xref>). It is based on linear mixed models (LMMs) and model selection. Methodologically, it is only a little more complicated than single-locus methods. The “best” LMM is built iteratively. At each iteration, the SNP in strongest association with a trait is identified from the random effects part of the model and moved to the fixed effects part of the model. This process is simple yet ingenious. It simultaneously identifies those regions of the genome that house genes influencing a trait while also accounting for all other SNP-trait associations.</p>
  <p>R, by default, comes with single-threaded math libraries. By replacing these libraries with their multi-threaded counterparts, certain linear algebra operations become parallelized, implicitly. The Eagle package has been structured, purposely, to make extensive use of these implicitly parallelized operations. In the parts of Eagle where this has not been possible, we have instead written C++ routines and parallelized the code explicitly through openMP (<xref rid="jkab204-B4" ref-type="bibr">Dagum and Menon 1998</xref>). Eagle differs most from competing packages in its ease-of-use for non-R users. Considerable effort has been invested into making Eagle equally usable to R and non-R users. Eagle is available on CRAN (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://cran.r-project.org/" ext-link-type="uri">https://cran.r-project.org/</ext-link>). The package comes with a browser-based graphical user interface (GUI). A user need only issue a single R command, OpenGUI(), to harness the full functionality of Eagle. Eagle has its own website (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://eagle.r-forge.r-project.org/index.html" ext-link-type="uri">http://eagle.r-forge.r-project.org/index.html</ext-link>) with instructions on how to install a multi-threaded version of R, quick start guide, tutorials, videos, and answers to frequently asked questions. Users can experiment with Eagle, prior to installing the package, by analyzing a test data set on our public server (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://eagle.r-forge.r-project.org/demo.html" ext-link-type="uri">http://eagle.r-forge.r-project.org/demo.html</ext-link>).</p>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Notation</title>
      <p>Suppose genotypes are collected on <italic toggle="yes">L</italic> loci from <italic toggle="yes">n<sub>g</sub></italic> individuals/lines/strains. The genotypes are coded as −1, 0, and 1 corresponding to SNP genotypes AA, AB, and BB, respectively. Ideally, missing genotypes are imputed prior to analysis. If not, missing genotypes are set to 0 by Eagle. Let <inline-formula id="IE1"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> be the matrix of SNP genotype data where the vector <inline-formula id="IE2"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> contains the genotypes −1, 0, and 1 for the <italic toggle="yes">j</italic>th SNP. Furthermore, let <inline-formula id="IE3"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> contain the quantitative trait data. Examples of the quantitative trait data include flowering time and grain yield in plants, weight gain and feed efficiency in animals, and blood pressure and cholesterol levels in humans. Here, <italic toggle="yes">n</italic> can be larger than <italic toggle="yes">n<sub>g</sub></italic> if multiple measurements, as is common in plant studies, are recorded on the same line/strain.</p>
      <p>The model is built iteratively. At each iteration, an SNP is selected and moved from the random effects to the fixed effects part of the LMM. Suppose <italic toggle="yes">s</italic> iterations of the model building process have been performed. Let <inline-formula id="IE4"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> be a set of ordinal numbers. The number <italic toggle="yes">S<sub>k</sub></italic> corresponds to the <italic toggle="yes">S<sub>k</sub></italic>th SNP in the marker map that was selected in the <italic toggle="yes">k</italic>th iteration of the model building process. For example, if <inline-formula id="IE5"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mn>101</mml:mn><mml:mo>,</mml:mo><mml:mn>12</mml:mn><mml:mo>,</mml:mo><mml:mn>1143</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, then the 101th, 12th, and 1143th SNPs in the marker map were selected in the first, second, and third model selection iterations, respectively.</p>
    </sec>
    <sec>
      <title>Multi-locus model</title>
      <p>The standard LMM for association mapping is
<disp-formula id="E1"><label>(1)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">τ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE6"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE7"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> are known design matrices, <italic toggle="yes">n</italic> is the number of observations, <italic toggle="yes">n<sub>g</sub></italic> is the number of individuals/lines/strains/with <inline-formula id="IE8"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE9"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">τ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is a vector with <italic toggle="yes">p</italic> fixed effects parameters including the intercept, and <inline-formula id="IE10"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is a vector containing the genetic effects. The residuals, <inline-formula id="IE11"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, are assumed to follow a normal distribution with mean 0 and covariance matrix <inline-formula id="IE12"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> where <inline-formula id="IE13"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> is an unknown residual variance.</p>
      <p>In the standard LMM, the genetic effects, <inline-formula id="IE14"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, are a random polygenic term that accounts for the genetic background (<xref rid="jkab204-B18" ref-type="bibr">Yu <italic toggle="yes">et al.</italic> 2006</xref>; <xref rid="jkab204-B20" ref-type="bibr">Zhao <italic toggle="yes">et al.</italic> 2007</xref>). It is assumed to follow a <inline-formula id="IE15"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> where <bold><italic toggle="yes">G</italic></bold> is a relationship matrix and <inline-formula id="IE16"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> is the unknown genetic variance. The relationship matrix is calculated from pedigree records or from SNP data. However, Eagle models <inline-formula id="IE17"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> differently and this is where the innovation lies. Instead of relying on the relatedness between individuals to model the genetic background, Eagle accounts for genetic background by modeling the association between all the SNPs and trait simultaneously. A similar idea exists in genomic selection (<xref rid="jkab204-B6" ref-type="bibr">Goddard 2009</xref>).</p>
      <p>For a detailed explanation of how <inline-formula id="IE18"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is formed and its statistical justification, the interested reader is referred to <xref rid="jkab204-B12" ref-type="bibr">Verbyla <italic toggle="yes">et al.</italic> (2007</xref>, <xref rid="jkab204-B13" ref-type="bibr">2012</xref>). Briefly, the genetic effects are modeled as
<disp-formula id="E2"><label>(2)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE19"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the vector of genotypes for the <italic toggle="yes">k</italic>th selected SNP, <inline-formula id="IE20"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the additive effect of the <italic toggle="yes">k</italic>th selected SNP, <inline-formula id="IE21"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the matrix of SNP genotypes with the data for the SNPs in <italic toggle="yes">S</italic> removed, and <inline-formula id="IE22"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is a random effect whose distribution is <inline-formula id="IE23"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The first term on the left-hand side is the fixed effects. The second term is the random effects. The fixed effects measure the additive effect of the <italic toggle="yes">S</italic> already-selected SNPs on the trait. The random effects measure the association between all other <italic toggle="yes">L</italic>–<italic toggle="yes">s</italic> SNPs and trait, simultaneously. Here, SNPs are assumed to be uncorrelated to reduce model complexity, making the analysis more manageable. Also, for a working model, it is not uncommon to assume SNP effects are pairwise uncorrelated. Such an assumption has long been made for marker-assisted selection with ridge regression (<xref rid="jkab204-B17" ref-type="bibr">Whittaker <italic toggle="yes">et al.</italic> 2000</xref>).</p>
      <p>There will be situations where the standard LMM is not appropriate such as when additional random effects are needed or, as occurs in multi-environment trials in plants, the assumption of uncorrelated errors is violated. A partial solution is a stage analysis (<xref rid="jkab204-B5" ref-type="bibr">George <italic toggle="yes">et al.</italic> 2020</xref>) but Eagle’s reliance on uncorrelated errors is a limitation. Any analysis by Eagle where the residuals are in fact correlated would be approximate. Further testing is needed to measure the impact of such a violation.</p>
    </sec>
    <sec>
      <title>Dimension reduction</title>
      <p>In modern genome-wide association studies, the number of loci, <italic toggle="yes">L</italic>, can be very large, sometimes in the tens of millions. This creates a problem, computationally, when fitting (2) as the vector <inline-formula id="IE24"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> contains a large number of elements. Fortunately, the dimensionality of (2) can be reduced by orders of magnitude.</p>
      <p>The goal is to form an equivalent model for (2) of lower dimension but where the equivalent model has the same variance. The variance structure of <inline-formula id="IE25"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the <inline-formula id="IE26"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> matrix <inline-formula id="IE27"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>. Here, the only unknown is the variance <inline-formula id="IE28"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>. By taking the matrix square root,
<disp-formula id="E3"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula>
an equivalent, dimension-reduced, model for <inline-formula id="IE29"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is
<disp-formula id="E4"><label>(3)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE30"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> is a random effect with only <italic toggle="yes">n<sub>g</sub></italic> elements and distributed as <inline-formula id="IE31"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>The Eagle algorithm requires estimates of <inline-formula id="IE32"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and its variance to identify the SNP in strongest association with the trait. These can be recovered from the fitting of the dimension-reduced model (<xref rid="jkab204-B13" ref-type="bibr">Verbyla <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="jkab204-B11" ref-type="bibr">2014</xref>) since
<disp-formula id="E5"><label>(4)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" display="block" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></disp-formula>
and its variance matrix is
<disp-formula id="E6"><label>(5)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" display="block" overflow="scroll"><mml:mrow><mml:mtext>var</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mtext>var</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p>
      <p>Only the diagonal elements of the variance matrix are needed which simplifies its calculation.</p>
    </sec>
    <sec>
      <title>The Eagle algorithm</title>
      <p>Eagle treats association mapping as a model selection problem. The model is built iteratively, via forward selection. At each iteration, from the current model, a new model is formed. This is done by selecting an SNP from the random effects and moving it to the fixed effects. The SNP is selected based on a score statistic. The reasoning behind moving effects from random to fixed is if there are major SNP-trait associations, then at first, they are contained in the genetic background of the model. This gives opportunity for the genetic background, which is being modeled by the random term in (2), to act as an SNP selection mechanism. Major SNP–trait associations are identifiable as outliers (or unusually large random effects in (2)) when compared to background effects (or the other random effects in (2)).</p>
      <p>Suppose <italic toggle="yes">s</italic> iterations of the model building process have been performed. The current model is of the forms (1) and (3). The vector of genetic effects <inline-formula id="IE33"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> has <italic toggle="yes">s</italic> fixed effects for the <italic toggle="yes">s</italic> discovered SNP–trait associations. The model has been fitted and parameter estimates obtained via maximum likelihood (ML). The vector of random effects <inline-formula id="IE34"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and its variance <inline-formula id="IE35"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">var</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are then computed.</p>
      <p>The following steps are performed for the <inline-formula id="IE36"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>th iteration of the model building process.</p>
      <p><bold>Step 1: SNP selection.</bold> An SNP is selected from the random effects based on the maximum score statistic
<disp-formula id="E7"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mtext>var</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
where <italic toggle="yes">j</italic> refers to the <italic toggle="yes">j</italic>th SNP in the marker map, the <italic toggle="yes">j</italic> index is over all SNPs except the <italic toggle="yes">s</italic> SNPs already selected, <inline-formula id="IE37"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> is a scalar value formed from the square of the best linear unbiased predictor of the <italic toggle="yes">j</italic>th SNP’s random effect, and <inline-formula id="IE38"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mtext>var</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is its variance. These values are recovered from <inline-formula id="IE39"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE40"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:mtext>var</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, which were obtained from the fitting of the current model and (4) and (5). By choosing the SNP with the maximum score statistic, we are selecting the SNP, which is in strongest association with the trait, from amongst those SNPs whose association is being modeled by the random effects.</p>
      <p><bold>Step 2: model building and fitting.</bold> A new dimension-reduced model is built, according to (1) and (3), from the trait data <bold><italic toggle="yes">y</italic></bold>, and known matrices <bold><italic toggle="yes">X</italic></bold>, <bold><italic toggle="yes">Z</italic></bold>, and <inline-formula id="IE41"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Here, <italic toggle="yes">S</italic> is the set of indexes of the <italic toggle="yes">s</italic> previously selected SNP and the additional SNP found in the previous step. The model is fitted to the data and parameters estimated via maximum likelihood.</p>
      <p><bold>Step 3: model selection.</bold> The importance of the <inline-formula id="IE42"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>th selected SNP is determined via the extended Bayes information criteria (extBIC, <xref rid="jkab204-B3" ref-type="bibr">Chen and Chen 2008</xref>). The extBIC is a model selection measure that takes into account the number of parameters and the complexity of the model space. If the extBIC increases, then the new model is accepted and the iterative model building process continues.</p>
      <p>Upon completion, <italic toggle="yes">S</italic> is the set of indexes of the SNP in strongest and measurable association with the trait. Each SNP identifies a different part of the genome housing genes that are influencing the trait.</p>
      <p>Basing the above algorithm on ML is a departure from what was first proposed in <xref rid="jkab204-B5" ref-type="bibr">George <italic toggle="yes">et al.</italic> (2020)</xref>, which was residual maximum likelihood (REML). REML’s advantage over ML is that it yields unbiased estimates of the variance components. However, it is not appropriate, statistically, to then use its maximized log-likelihood value in a model selection statistic such as the extBIC. This necessitated an extra ML calculation for every iteration of the model building process. By replacing REML with ML, we reduced the amount of computation needed per iteration, improving the speed of the algorithm considerably. Also, in the context of genome-wide association studies, the sample size is much larger than the number of fixed effects. This results in minimal bias when using ML. For the data sets we have analyzed, we have found no discernible difference between the variance component estimates under ML and REML.</p>
    </sec>
    <sec>
      <title>The Eagle package</title>
      <sec>
        <title>Overview</title>
        <p>Eagle is an R package for the genome-wide analysis of association data. It can handle data collected from inbred or outbred study populations. The populations can be of arbitrary and unknown complexity. The data can be larger than the memory capacity of the computer. Since Eagle is framed within a LMM paradigm, it is best suited to the analysis of data on continuous normally distributed traits. However, LMMs can also tolerate non-normal data (<xref rid="jkab204-B10" ref-type="bibr">Schielzeth <italic toggle="yes">et al.</italic> 2020</xref>). A flow chart of the analysis pipeline for Eagle is shown in <xref rid="jkab204-F1" ref-type="fig">Figure 1</xref>. The package contains functions for opening the GUI, inputting the data, performing genome-wide analyses, and for summarizing and visualizing the results. Non-R users need only be familiar with a single function OpenGUI that opens the GUI.</p>
        <fig position="float" id="jkab204-F1">
          <label>Figure 1</label>
          <caption>
            <p>A flow chart of the analysis pipeline for Eagle. Each green box corresponds to a separate page of the GUI.</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="jkab204f1" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>Installation</title>
        <p>Eagle is available on CRAN. As such, it can be installed in the usual way. However, Eagle has been designed to make extensive use of implicit parallelization. Many of the vector, matrix, and linear algebra operations in R link directly to the API’s of BLAS (Basic Linear Algebra Subroutines, see <xref rid="jkab204-B2" ref-type="bibr">Blackford <italic toggle="yes">et al.</italic> 2002</xref>) and LAPACK (Linear Algebra Package, see <xref rid="jkab204-B1" ref-type="bibr">Anderson <italic toggle="yes">et al.</italic> 1999</xref>). R, by default, comes with single-threaded versions of these libraries. If these libraries are replaced by their multi-threaded counterparts, such as MKL and openBLAS, parts of R become multi-threaded, implicitly. Detailed instructions for converting R to multi-threaded computation are available on the Eagle website (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://eagle.r-forge.r-project.org/instruction.html" ext-link-type="uri">http://eagle.r-forge.r-project.org/instruction.html</ext-link>).</p>
        <p>We have also developed an alternate approach for running Eagle. Docker is an open platform that packages an application and its dependencies inside virtual containers. Here, we have created two Eagle containers, a container for running the GUI (geo047/eagle: 2.4.5_app) and a different container for running RStudio with Eagle pre-installed (geo047/eagle: 2.4.5_rstudio). Both containers come with multi-threaded R. For a user, once Docker is installed on their system, a container can be run with the “docker run” command. This then allows the user to access either the GUI or RStudio via their web-browser. Instructions for running the Eagle containers are available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://hub.docker.com/r/geo047/eagle" ext-link-type="uri">https://hub.docker.com/r/geo047/eagle</ext-link>.</p>
      </sec>
      <sec>
        <title>Data input</title>
        <p>There are, potentially, four different types of data required by Eagle for input. These are the phenotypic data, the genotypic data, the marker map, and the Z matrix. Whether all four are needed is dependent upon the study design and format of the genotypic data. Each input data type is discussed below.</p>
        <p>The phenotypic data consist of observations on one or more traits and any explanatory variables. A trait may have a single observation per individual/line/strain or, as is common in plant studies, may have repeat observations. The data are arranged into columns. The first row contains the column headings. The observations can be space or comma separated. Missing trait and/or explanatory variable values are allowed. The data are read into Eagle with the function ReadPheno.</p>
        <p>The genotypic data are the genotypes observed on the individuals/lines/strains from the SNPs. Since association studies can collect genotypes on thousands of individuals across millions of SNPS, these data can be extremely large. Fortunately, Eagle can handle data beyond a computer’s memory capacity. Eagle will accept genotypic data that are in variant call format, space delimited ASCII format (the default), or PLINK ped format. The data are read with the function ReadMarker. The argument type, which has the value “vcf”, “text”, or “PLINK”, specifies the type of data being read. The argument availmemGb tells Eagle how much memory, in gigabytes, is available. The order of the SNPs in the input file must correspond to their map order. Ideally, missing genotypes are imputed prior to input but some missing genotypic data can be tolerated.</p>
        <p>The marker map consists of the names and locations of the SNPs. The map is specified via three columns of data. The first column contains the SNP labels. The second has the names of the chromosomes upon which the SNPs residue. The third column has their chromosomal positions. The data are space separated with the first row being the column names. The SNPs are in map order. Missing values are not allowed. The data are read with the function ReadMap. If the genotypic data are in variant call format, a separate marker map file is not needed. A variant call format file contains not only the SNP genotypes but also marker map information.</p>
        <p>The Z matrix is needed only if a trait has repeat observations. It is an incidence matrix. As such, it contains zeroes and ones only. The number of rows in the matrix equals the number of rows of phenotypic data. The number of columns equals the number of rows of genotypic data. The data are space separated. The function ReadZmat reads the data.</p>
      </sec>
      <sec>
        <title>Controlling the type 1 error rate</title>
        <p>All association mapping methods commit type 1 errors. For some, the type 1 error rate is controlled explicitly. For others, it is implicit to the internal workings of the methodology. In Eagle, the conservativeness of the model building process is managed explicitly via the parameter <italic toggle="yes">λ</italic>. The parameter <italic toggle="yes">λ</italic> is part of the extBIC. It ranges from zero to one. The conservativeness of the extBIC increases with increasing <italic toggle="yes">λ</italic>. Although it is possible to set <italic toggle="yes">λ</italic> analytically, the desired type 1 error rate is not part of the calculation. Instead, an empirical approach is adopted in Eagle.</p>
        <p>A permutation approach is implemented in the function FPR4AM. It finds the type 1 error rate for discrete values of <italic toggle="yes">λ</italic>. Suppose the number of permutations performed is <italic toggle="yes">n<sub>perm</sub></italic> and their are <inline-formula id="IE43"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>λ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> discrete values of <italic toggle="yes">λ</italic> being considered, potentially this means <inline-formula id="IE44"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">perm</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>λ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> genome-wide analyses are required. For large data sets, this quickly becomes computationally intractable. Fortunately, even though the trait data <bold><italic toggle="yes">y</italic></bold> change across replicates, the SNP and explanatory variable data remain the same. This means, for a permutation, only those parts of the Eagle algorithm impacted by a change in <bold><italic toggle="yes">y</italic></bold> need recalculation. Also, through vectorization, the type 1 error rates corresponding to all <inline-formula id="IE45"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mo>λ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> discrete values of <italic toggle="yes">λ</italic> can be calculated simultaneously, for each permutation.</p>
        <p>In the example below, the run time for FPR4AM was 1.36 min and for the analysis it was 53 s but the run times are situation specific. Having to run FPR4AM can more than double the computational cost of an analysis but being able to control the type 1 error more than compensates for this cost.</p>
      </sec>
      <sec>
        <title>Association mapping analysis</title>
        <p>One of the most important functions in the package, from a user’s perspective, is AM. This function implements the methodology presented above. It is the function that performs association mapping. The function has 12 arguments. The important arguments are as follows. The trait and fixed effects are specified via the arguments trait and fformula, respectively. The data are passed to AM through the arguments pheno, geno, map, and if required, Zmat. The number of threads, for parallel computation, is set with ncpu. The type 1 error rate is controlled with lambda. Its value is found by running FPR4AM.</p>
        <p>As an example, suppose the phenotypic data, SNP data, and marker map have been read with the functions described above and stored in data objects phenoObj, genoObj, and mapObj, respectively. The trait name is “y”. The explanatory variables of interest are “cov1” and “cov2”. These explanatory variables can be continuous such as weight and height, ordinal such as day and education level, or categorical such as race and sex. The fixed effects part of (1) has the form cov1 + cov2 + cov1*cov2 where cov1*cov2 is an interaction term. Let the <italic toggle="yes">λ</italic> value that gives a type 1 error rate of 0.05 be 0.78 and it was found with FPR4AM. Then, the function call that performs the analysis is</p>
        <p>
          <disp-quote content-type="extract">
            <p>R&gt; AM(trait=“y”,fformula=“cov1+cov2+cov1*cov2”,</p>
            <p>+ geno=genoObj, pheno=phenoObj, map=mapObj,</p>
            <p>+ ncpu = 8, lambda = 0.78)</p>
          </disp-quote>
        </p>
        <p>The number of threads for parallel computation has been set to 8. After running the function, the SNPs closest to the genes underlying “y” are reported. Each SNP identifies a different region of interest on the genome.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Additional analysis information is obtained with the function SummaryAM. Three tables are generated. They are a table of summary information, a findings table, and an effects table. The summary table contains information on items such as the number of cpu that were available, number of samples, the fixed effects formula, number of significant SNP–trait associations, and the <italic toggle="yes">λ</italic> value at which the analysis was performed. The findings table lists the names, chromosomes, and positions of those SNPs that were found to be in association with the trait. The effects table has the effect sizes, degrees of freedom, Wald statistic values, and <italic toggle="yes">P</italic>-values of the fixed effects in the model, including the SNPs that were identified as being in association with the trait.</p>
      </sec>
      <sec>
        <title>Visualization</title>
        <p>PlotAM is an interactive function for viewing the strength of association along a chromosome or genome. This is done on an iteration-by-iteration basis. It is useful for better understanding how a model is built, how SNP–trait association varies within a region, and how the strength of association for SNPs changes over the model building process.</p>
        <p>The function has the form</p>
        <p>
          <disp-quote content-type="extract">
            <p>PlotAM(AMobj=NULL, itnum = 1, chr=“All”,type=“Manhattan”).</p>
          </disp-quote>
        </p>
        <p>An example of its use is given in the Example section.</p>
      </sec>
      <sec>
        <title>Browser-based GUI</title>
        <p>To release users from the requirement of having to know R, a GUI was built. Here, a user only needs to know how to load the package with library(Eagle) and start the GUI with OpenGUI(). After running OpenGUI(), a browser automatically opens to the GUI’s home page. By clicking on the tabs in the navigation bar at the top of a page, a user can access pages for reading the input data, for performing analyses, and for summarizing/visualizing results.</p>
      </sec>
      <sec>
        <title>Help</title>
        <p>Detailed help files are available for each of the functions in the package. These help files include many worked examples. Help on a function is accessed in the usual way, with the library function. With the GUI, every page contains a help banner that gives a summary of the functionality contained within the page. Single sentence help descriptions also appear as the mouse cursor hovers over different parts of a page. External to the package, an email address <email>eaglehelp@csiro.au</email> has been set up to answer any queries. Also, help is available via the website <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://eagle.r-forge.r-project.org/index.html" ext-link-type="uri">http://eagle.r-forge.r-project.org/index.html</ext-link>.</p>
      </sec>
      <sec>
        <title>Improvements to Eagle</title>
        <p>The Eagle package has undergone continued development since it was first introduced in <xref rid="jkab204-B5" ref-type="bibr">George <italic toggle="yes">et al.</italic> (2020)</xref>. There have been significant improvements to its performance and utility. Eagle can analyze marker data larger than a computer’s memory capacity. Previously, it was doing this by converting the raw SNP data into a packed binary file and storing it on disk. The packed file would then be unpacked and read into memory when needed. However, this unpacking process, when repeated many times, incurs a significant computational cost. Unpacking can be avoided by instead converting the raw marker data into a simple ASCII file containing the snp genotypes 0, 1, and 2. We have been able to reduce the run time of AM by 50% and FPR4AM by an order of magnitude. The latest version of Eagle can handle vcf data and comes with an interactive plotting facility (see <italic toggle="yes">Results</italic>). Also, the internal handling of missing data has been improved, the reporting of final results has been refined, and the type of errors that can be caught by Eagle has been broadened. Users of the old version of Eagle are encouraged to update to the latest version (Version 2.4.4 at the time of submission).</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <p>Here, the steps for performing association mapping with Eagle are presented. Both modes of use are given. That is, via function statements issued at the R command line and via the GUI. For each function statement, a screenshot of its matching GUI page is shown where applicable. The example is for the analysis of a mouse data set. As stated previously, the goal of association mapping is to find the SNPs in strongest association with the genes underlying a heritable trait. The data are real. They were collected from a large GWAS in outbred mice (<xref rid="jkab204-B9" ref-type="bibr">Nicod <italic toggle="yes">et al.</italic> 2016</xref>). Many different traits were measured but our focus is on high-density lipoprotein (Bioch.HDL). We chose this trait because from previous analyses, a number of genomic regions of interest across multiple chromosomes have been reported. In the original study (<xref rid="jkab204-B9" ref-type="bibr">Nicod <italic toggle="yes">et al.</italic> 2016</xref>), this trait was found to be influenced by the explanatory variables for sex (Sex), batch number (Batch), and average weight (Weight.Average). These same variables are treated as explanatory variables in our analysis. Even though large data sets are not a problem for Eagle, we wanted the example data to be easily accessible to R. A way of doing this is to host the data on GitHub (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/geo047/Example_Data" ext-link-type="uri">https://github.com/geo047/Example_Data</ext-link>). GitHub has a file size limit of 10 megabytes, which made it necessary to base the example on a subset of the original data.</p>
    <sec>
      <title>Creating the input files</title>
      <p>Three input files were created. These are the files phenoex.dat with the phenotypic data, genoex.dat with the genotypic data, and mapex.dat with the maker map. In the original study, data were collected from 1887 outbred mice on a large number of traits and SNPs. As such, this data set was too large to house on GitHub. So the study size was reduced to 800 randomly selected mice. Our focus was restricted to the analysis of a single trait, Bioch.HDL. The genotypic data were reduced to the genotypes from 70,484 SNPs. The SNPs were selected from every 5th locus of the original set where loci with a minor allele frequency of less than 1% have been removed along with loci on the sex chromosome.</p>
      <p>The phenotypic data in phenoex.dat are space separated and arranged into 801 rows and four columns. The rows correspond to data on different mice. The columns contain data on Bioch.HDL and the explanatory variables Sex, Batch, and Weight.Average. The first row has the column names.</p>
      <p>The genotypic data in genoex.dat has 800 rows and 70,484 columns. The data are space separated. The columns are not named, nor are there missing values. Each row contains the genome-wide data for a mouse. Each column contains the genotypes for an SNP. Rows in the two files are assumed to be ordered such that the same row in each file corresponds to data collected on the same mouse. The columns are in marker map order. A numeric coding of 0, 1, and 2 was used for the SNP genotypes, AA, AB, and BB, respectively.</p>
      <p>The marker map in mapex.dat is space separated and has 70,485 rows and three columns. The first row is the column names. The rows contain map information on the SNPs. The rows are ordered according to the SNPs map order. The first column has the names of the SNPs. The second column contains the chromosome names upon which the SNPs reside. The third column has the chromosome positions of the SNPs. It is assumed that the row order of the SNPs in this file matches the column order in genoex.dat.</p>
      <p>The input files are downloaded and uncompressed from GitHub with the R commands</p>
      <p>
        <disp-quote content-type="extract">
          <p>R&gt; DIR &lt;- “<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://raw.githubusercontent.com/" ext-link-type="uri">https://raw.githubusercontent.com/</ext-link></p>
          <p>+ geo047/Example_Data/master/”</p>
          <p>R&gt; download.file(paste0(DIR, “mapex.dat”))</p>
          <p>R&gt; download.file(paste0(DIR, “phenoex.dat”))</p>
          <p>R&gt; download.file(paste0(DIR, “genoex.dat.zip”))</p>
          <p>R&gt; unzip(“genoex.dat.zip”)</p>
        </disp-quote>
      </p>
    </sec>
    <sec>
      <title>Single-locus association mapping</title>
      <p>We begin by analyzing these data in the “usual” way, with single-locus association mapping. As stated previously, for a single-locus analysis, a separate LMM is fitted to the data for each SNP. The statistical significance of an SNP, when treated as a fixed effect, is a measure of the strength of association between the SNP and trait. The data were analyzed with the R package gaston (<xref rid="jkab204-B14" ref-type="bibr">Wang and Zhang 2018</xref>). The process was to read in the phenotypic and genotypic information with fread from the R package data.table. Scale the marker data. Convert the explanatory variables into a usable form with covObj¡-model.matrix(Sex+Batch+Weight.Average, phenoObj). Calculate the genetic relationship matrix with the gaston function GRM and its eigenvalues/eigenvectors with the base function eigen. Perform the analysis with the gaston function association.test with the arguments method=“lmm” and test=“wald” along with arguments for the trait data, the eigenvalues/eigenvectors of the scaled marker data, and covariate matrix. The R script for performing the analysis is available upon request.</p>
      <p>The single-locus analysis results are shown in the Manhattan plot in <xref rid="jkab204-F2" ref-type="fig">Figure 2</xref>. The positions of the SNPs on the genome are on the <italic toggle="yes">x</italic>-axis and the significance scores <inline-formula id="IE46"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>value</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of the SNPs are on the <italic toggle="yes">y</italic>-axis. We would conclude from this analysis that there is a single region of interest on chromosome 5. In fact, from our Eagle analysis (see below), we know that there are five regions of interest for this trait. These are on chromosomes 1, 5, 6, and 10. The region on chromosome 5 is obvious. The regions on 1 and 6 we might have suspected but lacked the power under a single-locus analysis to confirm. However, the region on chromosome 10 is only revealed after the effects of the other regions have been accounted for. Also, it is not at all obvious from a single-locus analysis that we are dealing with two closely linked regions on chromosome 5.</p>
      <fig position="float" id="jkab204-F2">
        <label>Figure 2</label>
        <caption>
          <p>Manhattan plot for the single-locus analysis of the example data. Each point is the strength of association between an SNP and trait. Results are shown for the entire genome. The red horizontal line is the 5% genome-wide significance threshold, calculated via a Bonferroni correction. The blue dashed horizontal lines are the locations of the findings from Eagle. The order in which Eagle found these findings is given below the blue line. Where single-locus association mapping found only a single region of interest, because of Eagle’s increased statistical power, Eagle found five regions of interest.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="jkab204f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>Reading the data into Eagle</title>
      <p>The function statements for reading the phenotype and map input files are simple. Only the file names need specifying. This is also true if using the GUI. By default, the two input files are assumed space separated. If comma or tab separated, an additional argument is needed in the function statement. For comma separated files, sep=“,”. For tab separated files, sep=“\t”. The GUI has a checkbox for choosing if the file is space or comma separated. A tab separated option is not yet available.</p>
      <p>The function statements for reading the two input files are</p>
      <p>
        <disp-quote content-type="extract">
          <p>R&gt; phenoObj &lt;- ReadPheno(“phenoex.dat”)</p>
          <p>R&gt; mapObj &lt;- ReadMap(“mapex.dat”)</p>
          <p>Both the phenoObj and mapObj are data frame objects.</p>
        </disp-quote>
      </p>
      <p>Screenshots of the corresponding GUI pages are shown in <xref rid="jkab204-F3" ref-type="fig">Figure 3</xref>. They were taken after the relevant information had been entered via the selections made in the left-half of the GUI page and the files uploaded. The output from uploading a file is printed in the right-half of the page. These are the same outputs that appear when running the function statements from the command line.</p>
      <fig position="float" id="jkab204-F3">
        <label>Figure 3</label>
        <caption>
          <p>Screenshots of the GUI pages after the phenotypic data (left) and marker map (right) have been uploaded. Any output from the underlying functions is shown in the right-half of a page.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="jkab204f3" position="float"/>
      </fig>
      <p>The function statement for reading the SNP data differs from the two previous input statements. Besides the file name, additional arguments are required. The file type needs specifying. Here, since the marker data are in a space delimited text file, the type=“text” argument is included in the function statement. Other allowable formats are variant call format (type=“vcf”) and PLINK ped (type=“PLINK”). Text files give the user the freedom to select their own coding scheme but how these codes map to the SNP genotypes need specifying. In this example, the file contains codes 0, 1, and 2 for SNP genotypes AA, AB, and BB, respectively. This means that the function statement includes the arguments AA = 0, AB = 1, and BB = 2. Also, it is good practice to set the amount of available memory, in gigabytes, with the availmemGb argument. The default is to assume 16 GB of memory.</p>
      <p>The ReadMarker function statement for this example is</p>
      <p>
        <disp-quote content-type="extract">
          <p>R&gt; genoObj&lt;- ReadMarker(“genoex.dat”,type=“text”,</p>
          <p>+ AA = 0, AB = 1, BB = 2, availmemGb = 8)</p>
        </disp-quote>
      </p>
      <p>A screenshot of the corresponding GUI page after uploading the file is shown in <xref rid="jkab204-F4" ref-type="fig">Figure 4</xref>. The output from running the statement is the same as the output shown in the right-half of the GUI page. Unlike the other input functions, ReadMarker does not read the data into memory. Instead, the marker data, and its transpose, are stored on disk in a binary form. By not holding the genotype data in memory, it gives Eagle the ability to analyze marker data larger than the memory capacity of a computer. The object returned by ReadMarker is a list object that holds elements containing information on the dimensions of the marker data, the name and location of the reformatted marker data, and the number of phenotypic samples.</p>
      <fig position="float" id="jkab204-F4">
        <label>Figure 4</label>
        <caption>
          <p>Screenshots of the GUI pages after the genotypic data (left) have been uploaded and the multi-locus association mapping analysis (right) performed. Output is shown in the right-half of the page.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="jkab204f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>Controlling the type 1 error and performing the Eagle analysis</title>
      <p>To find the value of lambda that will give a 5% type 1 error rate for the analysis, we ran the function FPR4AM. For its arguments, we specified the desired type 1 error rate (falseposrate = 0.05), the number of permutations (numreps = 100), the trait name (trait=“Bioch.HDL”), the fixed effects part of the model (fformula=“Sex+Batch+Weight.Average”), the phenotypic data (pheno=phenoObj), the genotypic data (geno=genoObj), the marker map (map=mapObj), and the number of processes (ncpu = 8).</p>
      <p>The function statement is</p>
      <p>
        <disp-quote content-type="extract">
          <p>R&gt; fdr &lt;- FPR4AM(falseposrate = 0.05,</p>
          <p>+  numreps = 100, trait=“Bioch.HDL”,</p>
          <p>+  fformula=“Sex+Batch+Weight.Average”,</p>
          <p>+ pheno=phenoObj, geno=genoObj, map=mapObj, ncpu = 8)</p>
        </disp-quote>
      </p>
      <p>Once run, a lambda value of 0.53 (rounded to two significant digits) is reported. This value is used in AM to set the type 1 error rate to 5%.</p>
      <p>To perform multi-locus association mapping of the example data, the function statement is</p>
      <p>
        <disp-quote content-type="extract">
          <p>R&gt; res &lt;- AM(trait= “Bioch.HDL”,</p>
          <p>+     fformula=“Sex+Batch+Weight.Average”,</p>
          <p>+     pheno=phenoObj, geno=genoObj, map=mapObj,</p>
          <p>+     ncpu = 8, lambda = 0.53)</p>
        </disp-quote>
      </p>
      <p>As the function is run, a user can see how the model is being built. For each iteration, the selected SNPs, their chromosome, their map position, the column number of the SNP locus in the marker data file, and the extBIC value are printed. The final results are shown below (<xref rid="jkab204-T1" ref-type="table">Table 1</xref>).</p>
      <table-wrap position="float" id="jkab204-T1">
        <label>Table 1</label>
        <caption>
          <p>Final results</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">SNP</th>
              <th rowspan="1" colspan="1">Chrm</th>
              <th rowspan="1" colspan="1">Map Pos</th>
              <th rowspan="1" colspan="1">Col Num</th>
              <th rowspan="1" colspan="1">extBIC</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Null model</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">1700.22</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">M12008C5</td>
              <td rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1">124,991,768</td>
              <td rowspan="1" colspan="1">22,264</td>
              <td rowspan="1" colspan="1">1659.56</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">M1530C6</td>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1">17,541,026</td>
              <td rowspan="1" colspan="1">23,521</td>
              <td rowspan="1" colspan="1">1652.16</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">M26336C1</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">171,730,395</td>
              <td rowspan="1" colspan="1">5254</td>
              <td rowspan="1" colspan="1">1644.45</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">M12020C5</td>
              <td rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1">125,044,979</td>
              <td rowspan="1" colspan="1">22,267</td>
              <td rowspan="1" colspan="1">1643.63</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">M11706C10</td>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">125,357,987</td>
              <td rowspan="1" colspan="1">41,402</td>
              <td rowspan="1" colspan="1">1643.24</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>Gamma value for model selection was set to 0.53.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="jkab204-T2">
        <label>Table 2</label>
        <caption>
          <p>Summary information</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Number cpu</td>
              <td rowspan="1" colspan="1">8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Max memory (Gb)</td>
              <td rowspan="1" colspan="1">8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Number of samples</td>
              <td rowspan="1" colspan="1">800</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Number of snp</td>
              <td rowspan="1" colspan="1">70,484</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Trait name</td>
              <td rowspan="1" colspan="1">Bioch.HDL</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Fixed model</td>
              <td rowspan="1" colspan="1">Sex + Batch + Weight.Average</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Number samples missing obs</td>
              <td rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Number significant snp-trait assocs</td>
              <td rowspan="1" colspan="1">5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Lambda value for extBIC</td>
              <td rowspan="1" colspan="1">0.53</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="float" id="jkab204-T3">
        <label>Table 3</label>
        <caption>
          <p>Findings</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">SNP</th>
              <th rowspan="1" colspan="1">Chrm</th>
              <th rowspan="1" colspan="1">Position</th>
              <th rowspan="1" colspan="1">Col Num</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">M12008C5</td>
              <td rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1">124,991,768</td>
              <td rowspan="1" colspan="1">22,264</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">M1530C6</td>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1">17,541,026</td>
              <td rowspan="1" colspan="1">23,521</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">M26336C1</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">171,730,395</td>
              <td rowspan="1" colspan="1">5254</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">M12020C5</td>
              <td rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1">125,044,979</td>
              <td rowspan="1" colspan="1">22,267</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">M11706C10</td>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">125,357,987</td>
              <td rowspan="1" colspan="1">41,402</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="float" id="jkab204-T4">
        <label>Table 4</label>
        <caption>
          <p>Size and significance of effects in final model</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">Effect size</th>
              <th rowspan="1" colspan="1">Df</th>
              <th rowspan="1" colspan="1">Wald statistic</th>
              <th rowspan="1" colspan="1">Pr(Chisq)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">(Intercept)</td>
              <td rowspan="1" colspan="1">−2.31</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">35.98</td>
              <td rowspan="1" colspan="1">1.995E−09</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SexM</td>
              <td rowspan="1" colspan="1">1.13</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">507.16</td>
              <td rowspan="1" colspan="1">0.000E+00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">BatchOBT02</td>
              <td rowspan="1" colspan="1">0.00</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">0.00</td>
              <td rowspan="1" colspan="1">9.869E−01</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">BatchOBT03</td>
              <td rowspan="1" colspan="1">−0.28</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">1.29</td>
              <td rowspan="1" colspan="1">2.561E−01</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">BatchOBT63</td>
              <td rowspan="1" colspan="1">−0.16</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">0.43</td>
              <td rowspan="1" colspan="1">5.117E−01</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">BatchOBT64</td>
              <td rowspan="1" colspan="1">−0.11</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">0.21</td>
              <td rowspan="1" colspan="1">6.448E−01</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">BatchOBT65</td>
              <td rowspan="1" colspan="1">−0.12</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">0.21</td>
              <td rowspan="1" colspan="1">6.491E−01</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">BatchOBT66</td>
              <td rowspan="1" colspan="1">−0.20</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">0.85</td>
              <td rowspan="1" colspan="1">3.570E−01</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Weight.Average</td>
              <td rowspan="1" colspan="1">0.05</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">148.30</td>
              <td rowspan="1" colspan="1">0.000E+00</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">M12008C5</td>
              <td rowspan="1" colspan="1">0.35</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">23.30</td>
              <td rowspan="1" colspan="1">1.387E−06</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">M1530C6</td>
              <td rowspan="1" colspan="1">0.15</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">29.76</td>
              <td rowspan="1" colspan="1">4.878E−08</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">M26336C1</td>
              <td rowspan="1" colspan="1">0.15</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">26.03</td>
              <td rowspan="1" colspan="1">3.363E−07</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">M12020C5</td>
              <td rowspan="1" colspan="1">−0.20</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">18.98</td>
              <td rowspan="1" colspan="1">1.324E−05</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">M11706C10</td>
              <td rowspan="1" colspan="1">−0.23</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">17.89</td>
              <td rowspan="1" colspan="1">2.346E−05</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>In <xref rid="jkab204-F4" ref-type="fig">Figure 4</xref>, a screenshot of the Analysis page is shown of how the same analysis can be performed via the GUI. Here, a user chooses a trait for analysis, selects any fixed effects, lets Eagle find lambda by selecting the Set automatically option or specifies their own lambda value by selecting Set manually, and performs the analysis. The same output from the above two functions is printed in the right-half of the Analysis page.</p>
    </sec>
    <sec>
      <title>Summarizing the results</title>
      <p>A summary of the results is produced with</p>
      <p>R&gt; SummaryAM(AMobj=res)</p>
      <p>where res is the list object obtained from AM. Three tables are printed (<xref rid="jkab204-T2" ref-type="table">Table 2</xref>–<xref rid="jkab204-T4" ref-type="table">4</xref>). These same three tables are available within the GUI by going to the Summary page (page not shown). The first table (<xref rid="jkab204-T2" ref-type="table">Table 2</xref>) contains summary information such as the number of cpu, trait name, and number of significant snp-trait associations found. The second table (<xref rid="jkab204-T3" ref-type="table">Table 3</xref>) gives the names and locations of the SNPs. The third table (<xref rid="jkab204-T4" ref-type="table">Table 4</xref>) contains the effect sizes and statistical significances of the explanatory variables and the selected SNPs.</p>
    </sec>
    <sec>
      <title>Visualizing the findings</title>
      <p>Suppose we are interested in viewing how the pattern of significance varies throughout the model building process. Here, we focus on chromosome 5. This chromosome is interesting because it has two closely linked regions housing genes underlying the trait.</p>
      <p>Using the function statement</p>
      <p>
        <disp-quote content-type="extract">
          <p>R&gt; PlotAM(AMobj=res, itnum = 1, chr = “5”,</p>
          <p>+    type = “Manhattan”)</p>
        </disp-quote>
      </p>
      <p>the resulting plot, for chromosome 5 and iteration 1, is shown in <xref rid="jkab204-F5" ref-type="fig">Figure 5A</xref>. Each point is a measure of the strength of association between a SNP and trait. The measure is calculated as the <inline-formula id="IE47"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> of the <italic toggle="yes">p</italic>-value of the score statistic (see <italic toggle="yes">The Eagle</italic> <italic toggle="yes">Algorithm</italic>) for the SNP, since type=“Manhattan”. There is a clear spike toward the middle of the chromosome. In fact, the SNP in strongest association across the entire genome, at iteration 1, was on chromosome 5. Its position is given by the red vertical line.</p>
      <p>By the end of the second iteration of the model building process, the SNP, which was identified in the first iteration, has been found to be significant. Its effect has been moved from the random to the fixed effects part of the model. This change impacts the significance of the other SNPs. By using the above command but with itnum set to 2, the plot in <xref rid="jkab204-F5" ref-type="fig">Figure 5B</xref> is generated. Here, the SNPs that have increased (decreased) in significance are denoted by green (purple) points. The size of the point is proportional to the size of the change in significance from the previous iteration. Unsurprisingly, the largest changes have occurred around the SNP whose effect is now being treated as a fixed effect. We can see this more clearly by using the zoom feature in PlotAM to focus on the region around the SNP of interest (<xref rid="jkab204-F5" ref-type="fig">Figure 5C</xref>).</p>
      <fig position="float" id="jkab204-F5">
        <label>Figure 5</label>
        <caption>
          <p>Screenshots of the plots from running the Eagle function PlotAM. All plots are Manhattan plots and are of chromosome 5. These plots show how the significance of the SNPs changes throughout the model building process. The red vertical line is the position of the SNP that has the largest score statistic and strongest association with the trait at that iteration. The orange vertical lines are the positions of SNPs found in previous iterations to be in strongest association with the trait. Green (purple) points denote SNPs that have increased (decreased) in significance from the previous iteration. The size of the point is proportional to the size of the change in significance. Images (A), (B), and (D) are plots of the first, second, and fifth iterations, respectively, of the model building process. Images (C) and (E) were created from (B) and (D), respectively, by using PlotAM’s interactive zoom feature.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="jkab204f5" position="float"/>
      </fig>
      <p>What is interesting about <xref rid="jkab204-F5" ref-type="fig">Figure 5C</xref> is that there are still several SNPs in strong association with the trait. This suggests that there may be other statistically significant SNP–trait associations here. This is in fact the case, because by the fifth iteration, a second SNP has been found and fitted as a fixed effect. The pattern of association is shown in <xref rid="jkab204-F5" ref-type="fig">Figure 5D</xref> with the same zoomed region as before shown in <xref rid="jkab204-F5" ref-type="fig">Figure 5E</xref>. The drop in significance between fitting a single SNP in this region as a fixed effect to fitting two closely linked SNPs as fixed effects is apparent when you compare <xref rid="jkab204-F5" ref-type="fig">Figure 5C and E</xref>, noting the change in scales of the <italic toggle="yes">y</italic>-axes.</p>
    </sec>
    <sec>
      <title>Multi-locus analysis via Blink</title>
      <p>We thought that it would be informative to compare the performance of Eagle to another state-of-the-art multi-locus association mapping package. We chose Blink (<xref rid="jkab204-B7" ref-type="bibr">Huang <italic toggle="yes">et al.</italic> 2019</xref>) as implemented in the R package GAPIT3 (<xref rid="jkab204-B15" ref-type="bibr">Wang and Zhang 2020</xref>). Blink improves on the multi-locus method FarmCPU (<xref rid="jkab204-B8" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2016</xref>). It is faster and more powerful (<xref rid="jkab204-B7" ref-type="bibr">Huang <italic toggle="yes">et al.</italic> 2019</xref>). An analysis was performed by reading in the phenotypic, genotypic, and map data into R. A covariate matrix was formed with covObj¡-model.matrix(Sex+Batch+Weight.Average, phenoObj). An analysis was then performed with the GAPIT3 function GAPIT with the argument model set to “Blink”. Blink found four of the five SNPs found by Eagle. It found one of the two SNPs on chromosome 5 and the same SNPs as Eagle on chromosomes 1, 6, and 10. Further testing would be needed to discover if, in general, Eagle has greater power than Blink for uncovering association between tightly linked SNP.</p>
    </sec>
    <sec>
      <title>Computing speed</title>
      <p>In terms of run times for the single-locus and multiple-locus analyses, gaston took 1.67 min, Eagle took 2.25 min, and Blink took 2.16 min. There is a C-based version of Blink that is an order of magnitude faster than the version tested here. However, due to R’s ever expanding ecosystem, our preference is for the R version of Blink.</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>The Eagle package has been created to make genome-wide multi-locus association mapping easy. The package accepts marker data in different formats, has easy-to-use functions, comes with a user-friendly GUI, and has an interactive plotting function for visualizing the model building process. We welcome feedback via <email>eaglehelp@csiro.au</email> from users on how the functionality and usability of the package could be even further improved. As we saw in the example, Eagle brings clarity to situations where there are tightly linked SNPs in association with a trait. It can also uncover significant SNP–trait associations that are otherwise hidden to single-locus association mapping. At the very least, Eagle complements single-locus association mapping. However, ultimately, with the aid of Eagle, our hope is that the genetics community will shift to multi-locus association mapping as the method-of-choice for the genome-wide analysis of association data.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The Eagle package is implemented in R and is freely available from <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://CRAN.R-project.org/package=Eagle" ext-link-type="uri">https://CRAN.R-project.org/package=Eagle</ext-link>. An R script for performing the analyses presented in <italic toggle="yes">Results</italic> is available upon request. The input files used in the analysis are available from <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/geo047/Example_Data" ext-link-type="uri">https://github.com/geo047/Example_Data</ext-link>.</p>
  </sec>
</body>
<back>
  <sec>
    <title>Conflicts of interest</title>
    <p>None declared.</p>
  </sec>
  <ref-list id="ref1">
    <title>Literature cited</title>
    <ref id="jkab204-B1">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Anderson</surname><given-names>E</given-names></string-name>, <string-name><surname>Bai</surname><given-names>Z</given-names></string-name>, <string-name><surname>Bischof</surname><given-names>C</given-names></string-name>, <string-name><surname>Blackford</surname><given-names>SL</given-names></string-name>, <string-name><surname>Demmel</surname><given-names>J</given-names></string-name></person-group>, <etal>et al</etal><year>1999</year>. <source>LAPACK Users’ Guide</source>. Philadelphia, PA,: 
<publisher-name>SIAM</publisher-name>.</mixed-citation>
    </ref>
    <ref id="jkab204-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blackford</surname><given-names>SL</given-names></string-name>, <string-name><surname>Petitet</surname><given-names>A</given-names></string-name>, <string-name><surname>Pozo</surname><given-names>R</given-names></string-name>, <string-name><surname>Remington</surname><given-names>K</given-names></string-name>, <string-name><surname>Whaley</surname><given-names>CR</given-names></string-name></person-group>, <etal>et al</etal><year>2002</year>. 
<article-title>An updated set of basic linear algebra subprograms (blas)</article-title>. <source>ACM Trans Math Softw</source>. <volume>28</volume>:<fpage>135</fpage>–<lpage>151</lpage>.</mixed-citation>
    </ref>
    <ref id="jkab204-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>J</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Z.</given-names></string-name></person-group><year>2008</year>. 
<article-title>Extended Bayesian information criteria for model selection with large model spaces</article-title>. <source>Biometrika</source>. <volume>95</volume>:<fpage>759</fpage>–<lpage>771</lpage>.</mixed-citation>
    </ref>
    <ref id="jkab204-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dagum</surname><given-names>L</given-names></string-name>, <string-name><surname>Menon</surname><given-names>R.</given-names></string-name></person-group><year>1998</year>. 
<article-title>Openmp: An industry standard api for shared-memory programming</article-title>. <source>IEEE Comput Sci Eng</source>. <volume>5</volume>:<fpage>46</fpage>–<lpage>55</lpage>.</mixed-citation>
    </ref>
    <ref id="jkab204-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>George</surname><given-names>AW</given-names></string-name>, <string-name><surname>Verbyla</surname><given-names>A</given-names></string-name>, <string-name><surname>Bowden</surname><given-names>J.</given-names></string-name></person-group><year>2020</year>. 
<article-title>Eagle: multi-locus association mapping on a genome-wide scale made routine</article-title>. <source>Bioinformatics</source>. <volume>36</volume>:<fpage>1509</fpage>–<lpage>1516</lpage>.<pub-id pub-id-type="pmid">31596455</pub-id></mixed-citation>
    </ref>
    <ref id="jkab204-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goddard</surname><given-names>M.</given-names></string-name></person-group><year>2009</year>. 
<article-title>Genomic selection: prediction of accuracy and maximisation of long term response</article-title>. <source>Genetica</source>. <volume>136</volume>:<fpage>245</fpage>–<lpage>257</lpage>.<pub-id pub-id-type="pmid">18704696</pub-id></mixed-citation>
    </ref>
    <ref id="jkab204-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>M</given-names></string-name>, <string-name><surname>Liu</surname><given-names>X</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>Y</given-names></string-name>, <string-name><surname>Summers</surname><given-names>RM</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Z.</given-names></string-name></person-group><year>2019</year>. 
<article-title>Blink: a package for the next level of genome-wide association studies with both individuals and markers in the millions</article-title>. <source>GigaScience</source>. <volume>8</volume>:giy154.</mixed-citation>
    </ref>
    <ref id="jkab204-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>X</given-names></string-name>, <string-name><surname>Huang</surname><given-names>M</given-names></string-name>, <string-name><surname>Fan</surname><given-names>B</given-names></string-name>, <string-name><surname>Buckler</surname><given-names>ES</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Z.</given-names></string-name></person-group><year>2016</year>. 
<article-title>Iterative usage of fixed and random effect models for powerful and efficient genome-wide association studies</article-title>. <source>PLoS Genet</source>. <volume>12</volume>:<fpage>e1005767</fpage>.<pub-id pub-id-type="pmid">26828793</pub-id></mixed-citation>
    </ref>
    <ref id="jkab204-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nicod</surname><given-names>J</given-names></string-name>, <string-name><surname>Davies</surname><given-names>RW</given-names></string-name>, <string-name><surname>Cai</surname><given-names>N</given-names></string-name>, <string-name><surname>Hassett</surname><given-names>C</given-names></string-name>, <string-name><surname>Goodstadt</surname><given-names>L</given-names></string-name></person-group>, <etal>et al</etal><year>2016</year>. 
<article-title>Genome-wide association of multiple complex traits in outbred mice by ultra-low-coverage sequencing</article-title>. <source>Nat Genet</source>. <volume>48</volume>:<fpage>912</fpage>–<lpage>918</lpage>.<pub-id pub-id-type="pmid">27376238</pub-id></mixed-citation>
    </ref>
    <ref id="jkab204-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schielzeth</surname><given-names>H</given-names></string-name>, <string-name><surname>Dingemanse</surname><given-names>NJ</given-names></string-name>, <string-name><surname>Nakagawa</surname><given-names>S</given-names></string-name>, <string-name><surname>Westneat</surname><given-names>DF</given-names></string-name>, <string-name><surname>Allegue</surname><given-names>H</given-names></string-name></person-group>, <etal>et al</etal><year>2020</year>. 
<article-title>Robustness of linear mixed-effects models to violations of distributional assumptions</article-title>. <source>Methods Ecol Evol</source>. <volume>11</volume>:<fpage>1141</fpage>–<lpage>1152</lpage>.,</mixed-citation>
    </ref>
    <ref id="jkab204-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Verbyla</surname><given-names>AP</given-names></string-name>, <string-name><surname>Cavanagh</surname><given-names>CR</given-names></string-name>, <string-name><surname>Verbyla</surname><given-names>KL.</given-names></string-name></person-group><year>2014</year>. 
<article-title>Whole-genome analysis of multienvironment or multitrait QTL in MAGIC</article-title>. <source>G3 (Bethesda)</source>. <volume>4</volume>:<fpage>1569</fpage>–<lpage>1584</lpage>.<pub-id pub-id-type="pmid">25237109</pub-id></mixed-citation>
    </ref>
    <ref id="jkab204-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Verbyla</surname><given-names>AP</given-names></string-name>, <string-name><surname>Cullis</surname><given-names>BR</given-names></string-name>, <string-name><surname>Thompson</surname><given-names>R.</given-names></string-name></person-group><year>2007</year>. 
<article-title>The analysis of QTL by simultaneous use of the full linkage map</article-title>. <source>Theor Appl Genet</source>. <volume>116</volume>:<fpage>95</fpage>–<lpage>111</lpage>.<pub-id pub-id-type="pmid">17952402</pub-id></mixed-citation>
    </ref>
    <ref id="jkab204-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Verbyla</surname><given-names>AP</given-names></string-name>, <string-name><surname>Taylor</surname><given-names>JD</given-names></string-name>, <string-name><surname>Verbyla</surname><given-names>KL.</given-names></string-name></person-group><year>2012</year>. 
<article-title>RWGAIM: an efficient high-dimensional random whole genome average (QTL) interval mapping approach</article-title>. <source>Genet Res (Camb)</source>. <volume>94</volume>:<fpage>291</fpage>–<lpage>306</lpage>.<pub-id pub-id-type="pmid">23374240</pub-id></mixed-citation>
    </ref>
    <ref id="jkab204-B14">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>J</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Z.</given-names></string-name></person-group><year>2018</year>. Gapit version 3: an interactive analytical tool for genomic association and prediction preprint on webpage at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.researchgate.net/publication/329829469_GAPIT_Version_3_An_Interactive_Analytical_Tool_for_Genomic_Association_and_Prediction" ext-link-type="uri">https://www.researchgate.net/publication/329829469_GAPIT_Version_3_An_Interactive_Analytical_Tool_for_Genomic_Association_and_Prediction</ext-link>.</mixed-citation>
    </ref>
    <ref id="jkab204-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>J</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Z.</given-names></string-name></person-group><year>2020</year>. 
<article-title>Gapit version 3: boosting power and accuracy for genomic association and prediction</article-title>. <source>bioRxiv</source>.</mixed-citation>
    </ref>
    <ref id="jkab204-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>S-B</given-names></string-name>, <string-name><surname>Feng</surname><given-names>J-Y</given-names></string-name>, <string-name><surname>Ren</surname><given-names>W-L</given-names></string-name>, <string-name><surname>Huang</surname><given-names>B</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>L</given-names></string-name></person-group>, <etal>et al</etal><year>2016</year>. 
<article-title>Improving power and accuracy of genome-wide association studies via a multi-locus mixed linear model methodology</article-title>. <source>Sci Rep</source>. <volume>6</volume>:<fpage>19444</fpage>.<pub-id pub-id-type="pmid">26787347</pub-id></mixed-citation>
    </ref>
    <ref id="jkab204-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whittaker</surname><given-names>JC</given-names></string-name>, <string-name><surname>Thompson</surname><given-names>R</given-names></string-name>, <string-name><surname>Denham</surname><given-names>MC.</given-names></string-name></person-group><year>2000</year>. 
<article-title>Marker-assisted selection using ridge regression</article-title>. <source>Genet Res</source>. <volume>75</volume>:<fpage>249</fpage>–<lpage>252</lpage>.<pub-id pub-id-type="pmid">10816982</pub-id></mixed-citation>
    </ref>
    <ref id="jkab204-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname><given-names>J</given-names></string-name>, <string-name><surname>Pressoir</surname><given-names>G</given-names></string-name>, <string-name><surname>Briggs</surname><given-names>WH</given-names></string-name>, <string-name><surname>Bi</surname><given-names>IV</given-names></string-name>, <string-name><surname>Yamasaki</surname><given-names>M</given-names></string-name></person-group>, <etal>et al</etal><year>2006</year>. 
<article-title>A unified mixed-model method for association mapping that accounts for multiple levels of relatedness</article-title>. <source>Nat Genet</source>. <volume>38</volume>:<fpage>203</fpage>–<lpage>208</lpage>.,<pub-id pub-id-type="pmid">16380716</pub-id></mixed-citation>
    </ref>
    <ref id="jkab204-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Y-M</given-names></string-name>, <string-name><surname>Jia</surname><given-names>Z</given-names></string-name>, <string-name><surname>Dunwell</surname><given-names>JM.</given-names></string-name></person-group><year>2019</year>. 
<article-title>The applications of new multi-locus gwas methodologies in the genetic dissection of complex traits</article-title>. <source>Front Plant Sci</source>. <volume>10</volume>:<fpage>100</fpage>.<pub-id pub-id-type="pmid">30804969</pub-id></mixed-citation>
    </ref>
    <ref id="jkab204-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname><given-names>K</given-names></string-name>, <string-name><surname>Aranzana</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Kim</surname><given-names>S</given-names></string-name>, <string-name><surname>Lister</surname><given-names>C</given-names></string-name>, <string-name><surname>Shindo</surname><given-names>C</given-names></string-name></person-group>, <etal>et al</etal><year>2007</year>. 
<article-title>An Arabidopsis example of association mapping in structured samples</article-title>. <source>PLoS Genet</source>. <volume>3</volume>:<fpage>e4</fpage>.<pub-id pub-id-type="pmid">17238287</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
