<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.0 20040830//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Mol Syst Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Mol. Syst. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">msb</journal-id>
    <journal-title-group>
      <journal-title>Molecular Systems Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1744-4292</issn>
    <issn pub-type="epub">1744-4292</issn>
    <publisher>
      <publisher-name>BlackWell Publishing Ltd</publisher-name>
      <publisher-loc>Oxford, UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4300491</article-id>
    <article-id pub-id-type="pmid">25527639</article-id>
    <article-id pub-id-type="doi">10.15252/msb.20145654</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Annotation of genomics data using bidirectional hidden Markov models unveils variations in Pol II transcription cycle</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zacher</surname>
          <given-names>Benedikt</given-names>
        </name>
        <xref ref-type="aff" rid="au1">1</xref>
        <xref ref-type="aff" rid="au2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lidschreiber</surname>
          <given-names>Michael</given-names>
        </name>
        <xref ref-type="aff" rid="au1">1</xref>
        <xref ref-type="aff" rid="au3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cramer</surname>
          <given-names>Patrick</given-names>
        </name>
        <xref ref-type="aff" rid="au1">1</xref>
        <xref ref-type="aff" rid="au3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gagneur</surname>
          <given-names>Julien</given-names>
        </name>
        <xref ref-type="aff" rid="au1">1</xref>
        <xref ref-type="corresp" rid="cor2">**</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tresch</surname>
          <given-names>Achim</given-names>
        </name>
        <xref ref-type="aff" rid="au1">1</xref>
        <xref ref-type="aff" rid="au2">2</xref>
        <xref ref-type="aff" rid="au4">4</xref>
        <xref ref-type="corresp" rid="cor1">*</xref>
      </contrib>
      <aff id="au1">
        <label>1</label>
        <institution>Gene Center and Department of Biochemistry, Center for Integrated Protein Science CIPSM, Ludwig-Maximilians-Universität München</institution>
        <addr-line>Munich, Germany</addr-line>
      </aff>
      <aff id="au2">
        <label>2</label>
        <institution>Institute for Genetics, University of Cologne</institution>
        <addr-line>Cologne, Germany</addr-line>
      </aff>
      <aff id="au3">
        <label>3</label>
        <institution>Department of Molecular Biology, Max Planck Institute for Biophysical Chemistry</institution>
        <addr-line>Göttingen, Germany</addr-line>
      </aff>
      <aff id="au4">
        <label>4</label>
        <institution>Max Planck Institute for Plant Breeding Research</institution>
        <addr-line>Cologne, Germany</addr-line>
      </aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">*Corresponding author. Tel: +49 221 5062 161; Fax: +49 221 5062 163; E-mail: <email>tresch@mpipz.mpg.de</email></corresp>
      <corresp id="cor2">**Corresponding author. Tel: +49 89 2180 76742; Fax: +49 89 2180 76797; E-mail: <email>gagneur@genzentrum.lmu.de</email></corresp>
      <fn>
        <p><bold>Subject Categories</bold> Genome-Scale &amp; Integrative Biology; Post-translational Modifications, Proteolysis &amp; Proteomics; Signal Transduction</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>12</month>
      <year>2014</year>
    </pub-date>
    <volume>10</volume>
    <issue>12</issue>
    <elocation-id>768</elocation-id>
    <history>
      <date date-type="received">
        <day>04</day>
        <month>8</month>
        <year>2014</year>
      </date>
      <date date-type="rev-recd">
        <day>19</day>
        <month>11</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>11</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2014 The Authors. Published under the terms of the CC BY 4.0 license</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article under the terms of the Creative Commons Attribution 4.0 License, which permits use, distribution and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>DNA replication, transcription and repair involve the recruitment of protein complexes that change their composition as they progress along the genome in a directed or strand-specific manner. Chromatin immunoprecipitation in conjunction with hidden Markov models (HMMs) has been instrumental in understanding these processes, as they segment the genome into discrete states that can be related to DNA-associated protein complexes. However, current HMM-based approaches are not able to assign forward or reverse direction to states or properly integrate strand-specific (e.g., RNA expression) with non-strand-specific (e.g., ChIP) data, which is indispensable to accurately characterize directed processes. To overcome these limitations, we introduce bidirectional HMMs which infer directed genomic states from occupancy profiles <italic>de novo</italic>. Application to RNA polymerase II-associated factors in yeast and chromatin modifications in human T cells recovers the majority of transcribed loci, reveals gene-specific variations in the yeast transcription cycle and indicates the existence of directed chromatin state patterns at transcribed, but not at repressed, regions in the human genome. In yeast, we identify 32 new transcribed loci, a regulated initiation–elongation transition, the absence of elongation factors Ctk1 and Paf1 from a class of genes, a distinct transcription mechanism for highly expressed genes and novel DNA sequence motifs associated with transcription termination. We anticipate bidirectional HMMs to significantly improve the analyses of genome-associated directed processes.</p>
    </abstract>
    <kwd-group>
      <kwd>bidirectional hidden Markov model</kwd>
      <kwd>chromatin marks</kwd>
      <kwd>genome annotation</kwd>
      <kwd>RNA transcription cycle</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>Introduction</title>
    <p>An important question in molecular biology is how the occupancy of a genomic position with protein factors relates to the composition of genome-associated protein complexes at this position. This question is of high relevance to fundamental genome-associated processes such as DNA replication, transcription and repair because these generally involve the formation of functional multi-protein complexes that undergo transitions in their protein composition along the genome. For example, during transcription, RNA polymerase (Pol) II progresses through the initiation, elongation and termination phases, which are characterized by the presence of distinct Pol II-associated proteins and various post-translational modifications of Pol II and histones. Analysis of genomewide occupancy maps of Pol II-associated factors obtained by chromatin immunoprecipitation (ChIP) in yeast indicates the presence of distinct protein complexes for the initiation, elongation and termination of transcription, which are formed during a universally conserved mRNA transcription cycle (Venters &amp; Pugh, <xref rid="b34" ref-type="bibr">2009</xref>; Mayer <italic>et al</italic>, <xref rid="b28" ref-type="bibr">2010</xref>; Bataille <italic>et al</italic>, <xref rid="b1" ref-type="bibr">2012</xref>). These conclusions were deduced from metagene analysis, that is, the averaging of occupancy profiles over a pre-selected set of representative genes. In the present work, we check this hypothesis on the single-gene level.</p>
    <p>To systematically investigate occupancy profiles in an unbiased, position-specific manner, hidden Markov models (HMMs) (Rabiner, <xref rid="b30" ref-type="bibr">1989</xref>) were used to describe longitudinal observations as a sequence of discrete states (here: genomic states, which model the genome-associated complexes). HMMs have been used to infer chromatin states and annotate enhancers, promoters and transcribed and quiescent regions in the genome of human (Day <italic>et al</italic>, <xref rid="b6" ref-type="bibr">2007</xref>; Thurman <italic>et al</italic>, <xref rid="b33" ref-type="bibr">2007</xref>; Ernst and Kellis <xref rid="b9" ref-type="bibr">2010</xref>; Ernst <italic>et al</italic>, <xref rid="b10" ref-type="bibr">2011</xref>; Ernst &amp; Kellis, <xref rid="b11" ref-type="bibr">2012</xref>; Hoffman <italic>et al</italic>, <xref rid="b20" ref-type="bibr">2012</xref>
<xref rid="b21" ref-type="bibr">2013</xref>) and fly (Filion <italic>et al</italic>, <xref rid="b14" ref-type="bibr">2010</xref>; modENCODE Consortium, <xref rid="b8" ref-type="bibr">2010</xref>). For instance, Ernst and Kellis (<xref rid="b9" ref-type="bibr">2010</xref>) infer promoter and transcribed chromatin states in human T cells, which occur in a typical order upstream and downstream of annotated transcription start sites (TSSs). However, these state-of-the-art HMM approaches infer genomic states in a non-strand-specific (or undirected) manner. For example, they cannot decide whether a bona fide ‘TSS upstream’ state generally precedes or follows a bona fide ‘TSS downstream’ state. Directionality information needs to be included in a post-processing step. Moreover, these models lack a sound way to integrate strand-specific (e.g., expression) with non-strand-specific (e.g., ChIP) data, which is indispensable to appropriately characterize strand-specific genomic processes.</p>
    <p>To address these issues, we develop the theory of bidirectional hidden Markov models (bdHMMs), a novel probabilistic model that annotates directed states from non-strand-specific data (such as ChIP), and optionally strand-specific data (such as RNA expression). We introduce the concept of ‘directed genomic states’, which encode directionality information and thus provide a more realistic model of the underlying genome-associated complexes and their transitions. We present a very efficient algorithm for the learning of the bdHMM, available as an R/Bioconductor package STAN (<ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/devel/bioc/html/STAN.html">http://www.bioconductor.org/packages/devel/bioc/html/STAN.html</ext-link>). The broad applicability of our method is demonstrated on two entirely different datasets, namely on a tiling array transcription factor dataset in yeast and a deep-sequencing histone dataset in human. We show that bdHMM produces more accurate genome annotations than standard HMM. Our bdHMM analysis of previously defined chromatin states in human T cells (Ernst &amp; Kellis, <xref rid="b9" ref-type="bibr">2010</xref>) <italic>de novo</italic> identifies directed chromatin state patterns and provides an improved annotation of the human ‘histone code’. Application of the bdHHM method to a set of 22 genomic profiles in the <italic>S. cerevisiae</italic> finds new transcription units and DNA sequence motifs and unveils so far unknown variations in the Pol II transcription cycle. The yeast and human datasets, their state annotation and bdHMMs, which generated them, are available from the website <ext-link ext-link-type="uri" xlink:href="http://www.treschgroup.de/STAN.html">http://www.treschgroup.de/STAN.html</ext-link>. Using essentially the same set of parameters, the bdHMM is as easy to learn as standard HMM while extracting more information. We therefore anticipate bdHMM to replace standard HMM in a wide range of genomic analyses.</p>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>Annotation of directed genomic states using bdHMMs</title>
      <p>Standard and bidirectional HMMs are best understood with the help of a simulated dataset. A precise definition of the HMM and a bdHMM is given in the Materials and Methods. The example in Fig<xref ref-type="fig" rid="fig01">1</xref> considers a part of the genome where transcription occurs as a sequence of three different genomic segments. The transcribed regions split into segments of early (E) and late (L) transcription activity, and they are flanked by untranscribed (U) segments. The order of the three segments U, E and L along the genome depends on the orientation of the respective gene (Fig<xref ref-type="fig" rid="fig01">1</xref>A, gray arrows). ChIP measurements <italic>o</italic><sub>0</sub>,<italic>o</italic><sub>1</sub>,…,<italic>o</italic><sub><italic>T</italic></sub> for a single protein at genomic positions <italic>t</italic> = 0,1,…,<italic>T</italic> were simulated with low (U), medium (E) and high (L) average occupancy in the different segments. Note that these ChIP signals do not contain strand-specific information. An HMM defines a probability distribution on a sequence of observations <italic>o</italic><sub>0</sub>,…,<italic>o</italic><sub><italic>T</italic></sub>. It assumes that each observation <italic>o</italic><sub><italic>t</italic></sub> is <italic>emitted</italic> by a corresponding (unobserved) state variable <inline-formula><inline-graphic xlink:href="msb0010-0768-mu1.jpg" mimetype="image"/></inline-formula>, which can assume values from a finite set of hidden states. The value of <inline-formula><inline-graphic xlink:href="msb0010-0768-mu2.jpg" mimetype="image"/></inline-formula> determines the probability of observing <italic>o</italic><sub><italic>t</italic></sub>, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu3.jpg" mimetype="image"/></inline-formula>. The hidden variables form a first-order Markov chain, which means that the probability for observing <inline-formula><inline-graphic xlink:href="msb0010-0768-mu4.jpg" mimetype="image"/></inline-formula> depends only on <italic>s</italic><sub><italic>t</italic>−1</sub>, the transition probability <inline-formula><inline-graphic xlink:href="msb0010-0768-mu5.jpg" mimetype="image"/></inline-formula>. After the learning of these probabilities, the HMM outputs the so-called Viterbi path, which is the most likely state sequence <inline-formula><inline-graphic xlink:href="msb0010-0768-mu6.jpg" mimetype="image"/></inline-formula> that generated the observations. In our example, the Viterbi path provides a genome annotation.</p>
      <fig id="fig01" position="float">
        <label>Figure 1</label>
        <caption>
          <p>Principle of bidirectional HMM (bdHMM).</p>
          <p>
            <list list-type="alpha-upper">
              <list-item>
                <p>Simulated occupancy signal (1<sup>st</sup> track from the top) for a putative factor with a low level (centered at 0) in untranscribed regions (state U), an intermediate level in 5' part of genes (state E), and a high level in 3' part of genes (state L). Arrows (2<sup>nd</sup> track) depict boundaries and orientation of transcription. Unlike standard HMM (3<sup>rd</sup> track), bdHMM (4<sup>th</sup> track) infers strands (+ or −) to expressed states (E, L).</p>
              </list-item>
              <list-item>
                <p>HMM transition graph. Because orientation of transcription is not modeled by standard HMM, the spurious reverse transitions (<italic>E</italic> ⇒ <italic>U</italic>,<italic>L</italic> ⇒ <italic>E</italic> and <italic>U</italic> ⇒ <italic>L</italic>) are as likely as the correctly oriented transitions (<italic>U</italic> ⇒ <italic>E</italic>,<italic>E</italic> ⇒ <italic>L</italic> and <italic>L</italic> ⇒ <italic>U</italic>).</p>
              </list-item>
              <list-item>
                <p>bdHMM transition graph. In contrast to HMM, bdHMM, which has explicit strand-specific expressed states (<italic>E</italic><sup>+</sup>/<italic>E</italic><sup>−</sup> and <italic>L</italic><sup>+</sup>/<italic>L</italic><sup>−</sup>), allows inferring only the correctly oriented transitions.</p>
              </list-item>
            </list>
          </p>
        </caption>
        <graphic xlink:href="msb0010-0768-f1"/>
      </fig>
      <p>A standard HMM with 3 hidden states can distinguish the three protein occupancy levels; the three states correspond to the three genomic segments (Fig<xref ref-type="fig" rid="fig01">1</xref>B) and are therefore also called U, E and L. However, the transition probabilities in the standard HMM are symmetric because the number of observed transitions between successive segments, say E to L, in the forward direction equals the number of transitions in the reverse direction, L to E. Hence, standard HMMs are neither able to capture the strand specificity of transcription (i.e., the two different directions of transcription along the genome) nor do they infer biologically meaningful transitions along the genome as they occur during transcription.</p>
      <p>In order to infer directed transitions and directed genomic states, bdHMMs have ‘twin states’, one for each strand and genomic state. For instance, the early state E is split up into the twin states <italic>E</italic><sup>+</sup> and <italic>E</italic><sup>−</sup>. Twin states are coupled by two symmetry conditions. First, twin states are required to have identical emission probabilities, that is, in our example, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu7.jpg" mimetype="image"/></inline-formula>, where <italic>o</italic><sub><italic>t</italic></sub> is the observed data and <inline-formula><inline-graphic xlink:href="msb0010-0768-mu8.jpg" mimetype="image"/></inline-formula> is the hidden (transcription) state at position <italic>t</italic>. Second, twin states satisfy transition symmetry, a novel generalization of reversible Markov chains (see Materials and Methods for details), which requires that state transitions are invariant under reversal of time and direction, that is, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu9.jpg" mimetype="image"/></inline-formula>. In our example, this results in the bdHMM transition probabilities <inline-formula><inline-graphic xlink:href="msb0010-0768-mu10.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="msb0010-0768-mu11.jpg" mimetype="image"/></inline-formula>, as opposed to <inline-formula><inline-graphic xlink:href="msb0010-0768-mu12.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="msb0010-0768-mu13.jpg" mimetype="image"/></inline-formula> in the HMM (Fig<xref ref-type="fig" rid="fig01">1</xref>B and C). These two conditions enable the recovery of the direction of genomic states (Fig<xref ref-type="fig" rid="fig01">1</xref>A). Although the formal number of states doubles, the effective number of parameters does not increase due to the bdHMM constraints.</p>
      <p>Parameters are inferred using a constrained Baum–Welch algorithm, the validity of which was assessed by simulations showing that model parameters and states were recovered with high accuracy, even when only few training data were used (Materials and Methods, Supplementary Figs S8 and S9). The bdHMM is implemented in the R package STAN (STrand-specific ANnotation of genomic data), which is freely available on Bioconductor (<ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/devel/bioc/html/STAN.html">http://www.bioconductor.org/packages/devel/bioc/html/STAN.html</ext-link>).</p>
    </sec>
    <sec>
      <title>Genomic state annotation results in a global, strand-specific transcription map</title>
      <p>We applied the bdHMM to ChIP data in <italic>S. cerevesiae</italic>, where high-resolution datasets for dozens of proteins of the transcription machinery are available. We compiled genomewide ChIP-chip experiments for transcription initiation factors (TFIIB, Kin28), elongation factors (Spt5, Spn1, Bur1, Spt16, Ctk1, Paf1), termination factors (Pcf11, Rna15, Nrd1), Pol II and various modifications of its C-terminal domain (CTD) (Tyr1P, Ser2P, Ser5P, Ser7P) and nucleosomes (Lee <italic>et al</italic>, <xref rid="b25" ref-type="bibr">2007</xref>; Mayer <italic>et al</italic>
<xref rid="b28" ref-type="bibr">2010</xref>, <xref rid="b29" ref-type="bibr">2012</xref>; Lidschreiber <italic>et al</italic>, <xref rid="b26" ref-type="bibr">2013</xref>). The dataset was complemented by strand-specific mRNA expression data (Xu <italic>et al</italic>, <xref rid="b36" ref-type="bibr">2009</xref>) (Fig<xref ref-type="fig" rid="fig02">2</xref>).</p>
      <fig id="fig02" position="float">
        <label>Figure 2</label>
        <caption>
          <title><italic>De novo</italic> annotation of directed genomic states from genomewide transcription data in yeast using bdHMM</title>
          <p>Inputs for the bdHMM are the following, from top to bottom: strand-specific wild-type RNA levels, occupancy maps of nucleosomes, 3 termination factors, 6 elongation factors, 3 capping factors, 2 initiation factors, 4 CTD modifcations and 1 core Pol II member (Rpb3). Inferred directed genomic states are shown as colored boxes in the lowest track (see color legend beneath) where expressed states on the + (respectively −) strand are positioned above (respectively under) the axis, and not expressed states are centered on the axis. Previous transcriptome annotation is shown in the 2<sup>nd</sup> track from the bottom.</p>
        </caption>
        <graphic xlink:href="msb0010-0768-f2"/>
      </fig>
      <p>The number of bdHMM states needed to be specified in advance. Bearing in mind that our states should distinguish biologically different genomic states, classical model selection criteria (BIC, AIC, MDL) are not useful. Those criteria balance the number of parameters/states against the precision of the data fit. Since our data are very rich, they suggest a very high number of states, which cannot be interpreted. This issue has been reported repeatedly in association with HMMs (Ernst and Kellis, <xref rid="b9" ref-type="bibr">2010</xref>; Hoffman <italic>et al</italic>, <xref rid="b21" ref-type="bibr">2013</xref>, <xref rid="b20" ref-type="bibr">2012</xref>) for integrative analysis of ChIP data. We tried several state numbers (data not shown) and found that 20 states yield an appropriate trade-off between model complexity and biological interpretability (see Materials and Methods). Simulations from the inferred bdHMM recovered model parameters with high accuracy and further confirmed the validity and stability of our model (Supplementary Fig S9).</p>
      <p>The genomewide state annotation was derived as the most likely state path (Viterbi decoding, Fig<xref ref-type="fig" rid="fig02">2</xref>), which partitioned the 12-Mb yeast genome into 48,507 directed and 10,760 undirected state segments with distinct bdHMM states. This yields a strand-specific partitioning of the yeast genome into segments of directed genomic states. Alternative to Viterbi decoding, posterior decoding or mixed approaches (Posterior-Viterbi decoding, Fariselli <italic>et al</italic>, <xref rid="b13" ref-type="bibr">2005</xref>) could be used. Generally, Viterbi decoding is less subject to state flipping compared to posterior decoding. However, we did not see relevant differences between both approaches in this application (97% of genomic positions are annotated with the same state when comparing Viterbi and posterior decoded state paths).</p>
    </sec>
    <sec>
      <title>bdHMM state annotation recovers annotated genomic features with high accuracy</title>
      <p>In principle, the strand-specific expression of this dataset could also be used with standard HMMs to learn directed states. However, fitting a standard HMM did not recognize directed genomic states. In particular—since the HMM is learned without symmetry constraints for twin states—there is no obvious pairing between the forward (+) and the reverse (−) states, demonstrating the need for bdHMM (Materials and Methods, Supplementary Fig S1).</p>
      <p>In order to re-annotate transcription throughout the yeast genome and compare the performance of bdHMM and HMM, we applied a regular expression (RegEx) approach (Fig<xref ref-type="fig" rid="fig03">3</xref>A), to predict transcribed units as continuous stretches of directed transcribed states with a minimal length of 80 bp on both strands from the bdHMM and HMM annotation. Matching predicted transcript boundaries to previously published ones (Xu <italic>et al</italic>, <xref rid="b36" ref-type="bibr">2009</xref>), 4,186 (82%) of all annotated protein-coding transcripts were recovered from the bdHMM predictions, 11% more than the HMM predicts using the same criteria (3,639 transcripts) (best reciprocal hits, Materials and Methods). Moreover, the predicted transcription start sites (TSS) were consistently closer to the annotated ones (Fig<xref ref-type="fig" rid="fig03">3</xref>D). In particular, 60% of the predicted TSSs by the bdHMM were within 50 bp, whereas the best 60% of the HMM TSS predictions were within 100 bp of the published ones. Accuracy of pA site prediction was lower, but comparable between bdHMM and HMM, where approximately 60% of the predicted pA sites were within 100 bp of the annotated ones for both methods. Moreover, 32 novel transcripts were predicted from the bdHMM annotation (four overlapping a coding region, 28 non-coding, Fig<xref ref-type="fig" rid="fig03">3</xref>C, Materials and Methods), which is of particular significance because the <italic>S. cerevisiae</italic> transcriptome has been thoroughly studied and annotated.</p>
      <fig id="fig03" position="float">
        <label>Figure 3</label>
        <caption>
          <p>Genomic state annotation predicts bidirectional promoters and (novel) transcripts.</p>
          <p>
            <list list-type="alpha-upper">
              <list-item>
                <p>The genomic state annotation (viterbi path) was searched with regular expressions (RegEx) defining bidirectional promoters (right) and transcripts (bottom).</p>
              </list-item>
              <list-item>
                <p>Nucleosome binding patterns centered at 1,076 identified bidirectional promoters found with the RegEx. Each line in the heatmap corresponds to one pair of transcripts. Binding signal is color-coded (right).</p>
              </list-item>
              <list-item>
                <p>A novel SUT (stable unannotated transcript, a stable non-coding RNA, gray area) is identified on the − strand by the bdHMM. The locus shows detectable expression but was too low for the criteria used by Xu <italic>et al</italic> (<xref rid="b36" ref-type="bibr">2009</xref>).</p>
              </list-item>
              <list-item>
                <p>Estimated cumulative probability of TSS and pA site predictions shows higher accuracy of bdHMM in recovering TSSs. pA site prediction has similar accuracy for both models.</p>
              </list-item>
            </list>
          </p>
        </caption>
        <graphic xlink:href="msb0010-0768-f3"/>
      </fig>
      <p>As another illustration of genomic features that can be extracted from a bdHMM annotation, we searched for bidirectional promoters using a RegEx consisting of a promoter state flanked by an upstream transcript on the Crick strand and a downstream transcript on the Watson strand (Fig<xref ref-type="fig" rid="fig03">3</xref>A and B). We detected 1,076 bidirectional promoters in yeast, which agrees well with a previous estimate of 1,049 bidirectional promoters (Xu <italic>et al</italic>, <xref rid="b36" ref-type="bibr">2009</xref>). Altogether, these results demonstrate the high accuracy of the bdHMM for genome annotation and its advance over the standard HMM.</p>
    </sec>
    <sec>
      <title>Transcription cycle phases have a substructure</title>
      <p>To understand how the 20 bdHMM states relate to phases of the transcription cycle, we analyzed their average frequencies along annotated, transcribed genes (Fig<xref ref-type="fig" rid="fig04">4</xref>B, Materials and Methods). The states showing a single frequency peak (18 out of 20 states) were grouped into six transcription phases, according to the location of their peak on the average gene: promoter (P, 2 states), promoter escape (PE, 2 states), early elongation (eE, 3 states), mid-elongation (mE, 5 states), late elongation (lE, 3 states) and termination (T, 2 states). Two states showed two peaks in frequency, in each case with one peak upstream of the transcription start site and one peak around the polyadenylation (pA) site. We interpreted these two states as mixed promoter and termination states and labeled them accordingly P/T1 and P/T2 (Fig<xref ref-type="fig" rid="fig04">4</xref>A and B). Hence, although overlapping transcription is not explicitly modeled by bdHMMs, this phenomenon could be captured by specific states.</p>
      <fig id="fig04" position="float">
        <label>Figure 4</label>
        <caption>
          <p>Roles of directed genomic states in the transcription cycle.</p>
          <p>
            <list list-type="alpha-upper">
              <list-item>
                <p>Mean ChIP enrichment of factors (horizontal axis) indicates the composition of the transcription machinery in each state (vertical axis). Factors were ordered by hierarchical clustering, and states were ordered by position of their most frequent occurrence along the average gene.</p>
              </list-item>
              <list-item>
                <p>Each state was assigned to a phase in the transcription cycle by investigating the frequency (<italic>y</italic>-axis) of each state at an average transcript. This spatial state distribution was calculated from the genomic sate sequences (viterbi paths) of 4,362 genes.</p>
              </list-item>
              <list-item>
                <p>The flux diagram shows probabilities of state transitions calculated from the viterbi paths. Branches mark alternative successions of states at individual genes and thus reveal extensive variation in the transcription cycle as it is modeled by the genomic states. Each node (state) is positioned according to the most frequent position on a metagene. The diagram contains at least one incoming and one outgoing transition for each state as well as transitions observed with a frequency &gt; 0.01 on the metagene.</p>
              </list-item>
            </list>
          </p>
        </caption>
        <graphic xlink:href="msb0010-0768-f4"/>
      </fig>
      <p>The mean factor occupancy defining a particular state is indicative of the composition of the transcription complex and its activity (Fig<xref ref-type="fig" rid="fig04">4</xref>A). Indeed, we found that the enrichment or depletion of protein factors in each state was in accordance with their known roles in transcription (Fig<xref ref-type="fig" rid="fig04">4</xref>A). For instance, the initiation factors TFIIB and Kin28 were enriched in promoter and promoter escape states (P2, PE1, PE2) and were depleted in states of other transcription phases (Fig<xref ref-type="fig" rid="fig04">4</xref>A and B). States related to the same transcription phase often peaked at successive genomic positions. For instance, the mid-elongation phase comprises successive states mE1–mE5 (Fig<xref ref-type="fig" rid="fig04">4</xref>B and C) that were characterized by a gradual decrease in the occupancy of initiation factors, capping-related factors and Nrd1 (Fig<xref ref-type="fig" rid="fig04">4</xref>A).</p>
      <p>The association of states to phases of transcription is in accordance with state-specific enrichment of DNA sequence motifs (Materials and Methods, Supplementary Information). While promoter state P2 shows enrichment of known promoter-associated motifs, termination state T1 is enriched with known termination signals and mixed state P/T2 contains both promoter- and termination-associated motifs. We also found potentially unknown sequence motifs, which we could not associate to known functions or binders (Supplementary Information). Overall, these results show that unsupervised bdHMM analysis can define meaningful genomic states that reflect phases of transcription at every single gene.</p>
    </sec>
    <sec>
      <title>The transcription cycle shows gene-specific variation</title>
      <p>Our bdHMM annotation did not only recapitulate known events during transcription, it also provided unexpected, new insights. For example, the flux diagram (Fig<xref ref-type="fig" rid="fig04">4</xref>C, showing the most likely transitions between successive states) indicated variability within the transcription cycle. We found different states at the same position within genes that may reflect alternative functional transcription complexes (promoter: P1, P2, P/T1, or P/T2; promoter escape: PE1 or PE2; Fig<xref ref-type="fig" rid="fig04">4</xref>A and B). These alternative states are located within different branches of the flux diagram (Fig<xref ref-type="fig" rid="fig04">4</xref>C). A pronounced bifurcation occurs at the transition from P2 to promoter escape, entering either highly productive (PE2) or weak transcription (PE1). These two branches of the transcription cycle converge again during late elongation (lE2, lE3) or termination (T1). Hence, the analysis of state frequency distributions and transition diagrams suggests gene-specific variation of the transcription cycle.</p>
      <p>For a systematic investigation of gene-specific variation during the transcription cycle, we clustered genes based on their annotated state path. To that end, the state paths of 4,263 genes were rescaled to a common length and clustered into 55 groups according to their Hamming distance (Fig<xref ref-type="fig" rid="fig05">5A</xref> and <xref ref-type="fig" rid="fig05">5B</xref>, Materials and Methods). The obtained gene clusters show distinct patterns of protein occupancies, suggesting mechanistic differences in transcription (Fig<xref ref-type="fig" rid="fig05">5</xref>, Supplementary Fig S2 and below). Moreover, the gene clusters differed by gene length, expression level and genomic context (e.g., termination overlaps with neighboring downstream promoters or bidirectionality of promoters). Gene set enrichment analysis showed that clusters also corresponded to distinct functional gene groups (Supplementary Table S1). The functional categories range from housekeeping (e.g., cluster 14, 38), cell cycle (e.g., cluster 17) to stress response (e.g., cluster 39). For instance, the high expression of cluster 38 and 14 is in accordance with their associated functions including ribosome biogenesis, positive regulation of transcription, translation or nucleosome assembly. More strikingly, we found the DNA binding motif of SFP1—a regulator of ribosomal protein and ribosome biogenesis genes—to be enriched in promoter state P/T1 (which is a frequent promoter state of cluster 14 and 38 genes, Supplementary Fig S4). In contrast, stress- and autophagy-related genes in cluster 39 show very low expression and protein binding (Supplementary Fig S2B). Altogether, this suggests that different transcription cycles as they are modeled by the bdHMM correspond to different co-regulated gene sets.</p>
      <fig id="fig05" position="float">
        <label>Figure 5</label>
        <caption>
          <p>Clustering of state paths reveals gene-specific variations in the transcription cycle.</p>
          <p>
            <list list-type="alpha-upper">
              <list-item>
                <p>Genomic state sequences of 4,632 genes were clustered into 55 groups (left, only clusters containing at least 20 genes are labeled). Each line corresponds to the state sequence of a single gene. States are colored as shown in the legend.</p>
              </list-item>
              <list-item>
                <p>Clusters exhibit distinct state frequency distributions and transition patterns (shown as schematic flux diagrams on top of panels). Cluster 14 shows a transcription cycle closest to the canonical one proposed by Mayer <italic>et al</italic> (<xref rid="b28" ref-type="bibr">2010</xref>). Genomic state sequences of clusters 32 and 38 differ from the canonical one, indicating variations in the transcription cycle.</p>
              </list-item>
              <list-item>
                <p>Clusters 14 and 32 exhibit distinct recruitment of factors to genes. PolII subunit Rpb3, Nrd1, Spt5 and Spt16 binding is very similar in the beginning of genes, but decreases much more strongly in cluster 32 throughout the transcripts. Ctk1 and Paf1 are depleted at cluster 32, but not at cluster 14 genes.</p>
              </list-item>
              <list-item>
                <p>Cluster 14 shows the canonical Pol II (Rpb3) peak in the 5' region of genes, but Pol II reaches a stable, high level downstream of the TSS in cluster 38. This may suggest a lack of the mechanism for Pol II peaking observed in cluster 14. The steep increase of serine 2 phophorylation in cluster 38 might indicate that productive elongation is reached earlier at those genes.</p>
              </list-item>
            </list>
          </p>
        </caption>
        <graphic xlink:href="msb0010-0768-f5"/>
      </fig>
      <p>Cluster 14, which contains 694 genes (Fig<xref ref-type="fig" rid="fig05">5B</xref> and <xref ref-type="fig" rid="fig05">5C</xref>, Supplementary Fig S2B), shows a transcription cycle most similar to the canonical one proposed previously (Mayer <italic>et al</italic>, <xref rid="b28" ref-type="bibr">2010</xref>). In this cluster, the promoter escape state PE2 was characterized by peak occupancy of the Pol II core subunit Rpb3 between 100 and 200 bp downstream of the TSS, and phosphorylation of the CTD serine 2 residue reaches maximum levels between 600 and 1,000 bp (Fig<xref ref-type="fig" rid="fig05">5</xref>D), as observed in previous metagene analysis. The cycle ends with the canonical termination state T1, which is characterized by the presence of elongation factors Spn1, Paf1, Ctk1, Bur1, Spt16 and Spt5 and termination factors Pcf11 and Rna15 (Fig<xref ref-type="fig" rid="fig04">4</xref>A).</p>
    </sec>
    <sec>
      <title>Evidence for regulated promoter escape</title>
      <p>We next analyzed clusters with variations compared to the canonical transcription cycle. Cluster 32 (43 genes) differs from the canonical cluster 14 in the transition from promoter escape to elongation. State frequency and gene-averaged ChIP signals suggest that transcription is attenuated after promoter escape in cluster 32 (Fig<xref ref-type="fig" rid="fig05">5B</xref> and <xref ref-type="fig" rid="fig05">5C</xref>). In this cluster, a strong promoter escape (PE2) is followed by the weak elongation state eE3, which is characterized by low levels of Pol II and elongation factors (Fig<xref ref-type="fig" rid="fig05">5C</xref>). Moreover, elongation factors Ctk1 and Paf1 appear to be absent from those genes (Fig<xref ref-type="fig" rid="fig05">5C</xref>, Supplementary Fig S2C). In contrast, cluster 14 exhibits similarly strong promoter escape yet transitions into the highly productive elongation states eE2 and mE1, which are characterized by high occupancies of all measured elongation factors (Fig<xref ref-type="fig" rid="fig04">4B</xref> and <xref ref-type="fig" rid="fig04">4C</xref>). This comparison supports the existence of a regulatory checkpoint for transcription elongation after promoter escape. This is likely related to transcription attenuation with the help of the early termination factor Nrd1 (Schulz <italic>et al</italic>, <xref rid="b31" ref-type="bibr">2013</xref>) (Fig<xref ref-type="fig" rid="fig05">5C</xref>, Supplementary Fig S3). The individual occupancy profiles (Fig<xref ref-type="fig" rid="fig05">5C</xref>, Supplementary Fig S2C) indicate that this checkpoint separates the binding events of Spt5, Spn1, Bur1 and Spt16 from the binding of Ctk1 and Paf1. Thus, it appears that attenuated genes recruit early elongation factors including Spt5 and Spt16, but not the later factors Paf1 and Ctk1.</p>
    </sec>
    <sec>
      <title>Evidence for distinct transcription mechanisms for highly expressed genes</title>
      <p>Cluster 38 differs strikingly from the canonical transcription cycle during early elongation and termination (Fig<xref ref-type="fig" rid="fig05">5B</xref>, Supplementary Fig S2D, 147 genes enriched for genes involved in translation, Supplementary Table S1, Materials and Methods). Cluster 38 is characterized by the high occupancy promoter state P/T1 (<xref ref-type="fig" rid="fig04">Fig 4A</xref>) and by the early elongation state eE1 (for 58% of all cluster 38 genes, and in turn, 48% of genes with eE1 state are in cluster 38). During early elongation, serine 2 phosphorylation levels increase more steeply than in cluster 14, indicating that productive elongation is reached earlier at those genes (<xref ref-type="fig" rid="fig05">Fig 5D</xref>). Moreover, Pol II does not exhibit the typical occupancy peak 150 bp downstream of the TSS but immediately reaches a stable high level (<xref ref-type="fig" rid="fig05">Fig 5D</xref>). This profile could be the consequence of a lower drop-off rate at this position (Mayer <italic>et al</italic>, <xref rid="b28" ref-type="bibr">2010</xref>), a more constant elongation rate along the gene, or a high and uniform coverage by elongating polymerases. Specifically to cluster 38, a sharp decrease of the occupancy of essentially all factors is observed well positioned at the stop codon. The data indicate that most factors (Cbp20, Nrd1, Ctk1, Paf1, S5P, S7P, Spt16 and Bur1) are then released, as their occupancy remains low after the stop codon. Moreover, the Pol II subunit Rpb3, the serine 2 phosphorylation and the elongation factors Spt5 and Spn1 recover their occupancy levels at the pA site, suggesting a higher elongation rate for Pol II and that these factors stay bound to the transcription machinery within the 3' UTR. This indicates that the previously reported early release of elongation factors for ribosomal genes (Mayer <italic>et al</italic>, <xref rid="b28" ref-type="bibr">2010</xref>) is sharply positioned at the stop codon and also involves release of the cap-binding protein Cbp20, the early termination factor Nrd1 and dephosphorylation of the CTD residues Ser5 and Ser7. Taken together, cluster 38 suggests that highly expressed genes exhibit distinct transcription mechanisms, characterized by efficient factor recruitments during early elongation and specific processes of factor release around the stop codon.</p>
    </sec>
    <sec>
      <title>Not all termination regions are depleted of nucleosomes</title>
      <p>Nucleosome depletion has been reported at the 3' end of genes (Mavrich <italic>et al</italic>, <xref rid="b27" ref-type="bibr">2008</xref>). However, cluster 19, whose 634 genes terminate in state T1, does not show nucleosome depletion in this region. In contrast, nucleosome depletion is a hallmark of all our promoter states. We therefore hypothesized that the termination of genes in clusters other than cluster 19 overlaps with promoters of downstream genes. Genes in clusters 1, 5, 6, 12, 32, 33 and 38 showed nucleosome-depleted termination states P/T1 and P/T2. Their termination regions indeed overlap with a downstream promoter, as indicated by TFIIB enrichment downstream of their pA site (Supplementary Fig S2). This supports previous reports that nucleosome depletion is not an intrinsic mark of transcription termination (Fan <italic>et al</italic>, <xref rid="b12" ref-type="bibr">2010</xref>). Thus, bdHMM analysis of the genomic context of transcription allows distinguishing canonical binding patterns from spurious ones caused by spillover effects from neighboring genes.</p>
    </sec>
    <sec>
      <title>Comparison to standard HMM on chromatin states of human T cells</title>
      <p>We evaluated the performance of bdHMM on sequencing data and large genomes, by applying bdHMM to a dataset of 41 chromatin marks in human T cells (Ernst &amp; Kellis, <xref rid="b9" ref-type="bibr">2010</xref>). The chromatin mark data had been binarized into presence/absence of each mark at a resolution of 200 bp bins and analyzed with a standard HMM approach (ChromHMM) (Ernst &amp; Kellis, <xref rid="b11" ref-type="bibr">2012</xref>). To handle the binarized chromatin marks data defined by Ernst and Kellis (<xref rid="b9" ref-type="bibr">2010</xref>), we extended bdHMM and included binary (Bernoulli) emission distributions. We fixed the emission distributions during bdHMM learning, allowing a direct comparison of bdHMM states to HMM states. Moreover, this ensured that differences in the result are only due to differences in the modeling of state transitions. We developed a directionality score (Materials and Methods) to decide that in the bdHMM, 35 out of a total of 51 ChromHMM states are modeled as directed state pairs and 16 ChromHMM states are modeled as undirected states. Consistently, we identified directed chromatin states around transcribed, but not at repressed or repetitive regions (Supplementary Fig S5). Up to state directionality, 83% of state annotations agreed between the two methods (Materials and Methods). Comparison of the ChromHMM with the bdHMM transitions revealed that in ChromHMM, transition probabilities between two states are similar in both directions (Fig<xref ref-type="fig" rid="fig06">6C</xref>), whereas the bdHMM can resolve the true order of chromatin states (Fig<xref ref-type="fig" rid="fig06">6A</xref> and <xref ref-type="fig" rid="fig06">6B</xref>, Supplementary Fig S6). For example, transitions from state 6 into states 2 and 3 are high for the forward direction, but low for the reverse drection. In contrast, transitions from states 2 and 3 into state 6 are high in reverse, but low in forward, direction (Fig<xref ref-type="fig" rid="fig06">6B</xref>). However, all of these transitions are high in the symmetric ChromHMM model (Fig<xref ref-type="fig" rid="fig06">6C</xref>), demonstrating that bdHMM adds previously unexploited and valuable information to HMM-based analyses by uncoupling the underlying state directionality of genomic processes. Analysis of promoter and transcribed state frequencies at the TSS showed that state annotations matched the reading (sense) direction of the transcribed loci with up to 85% (Supplementary Fig S7). Promoter states showed pronounced peaks in sense direction at the TSS, which are further downstream followed by high frequencies of (sense) 5' proximal transcribed states. We conclude that bdHMM significantly improves the annotation of the human epigenome, because it correctly recovers the flow of chromatin states as they occur during transcription.</p>
      <fig id="fig06" position="float">
        <label>Figure 6</label>
        <caption>
          <p>Application of bdHMM to chromatin modifications in human T cells identifies direction of chromatin states.</p>
          <p>
            <list list-type="alpha-upper">
              <list-item>
                <p>Example of chromatin state annotation of ChromHMM and bdHMM (bottom tracks) with RefSeq gene annotation and input signal. State direction matches gene orientation of annotated convergent genes and divergent genes. The log-transformed signal (Ernst and Kellis, <xref rid="b9" ref-type="bibr">2010</xref>) of all 41 data tracks is shown in black on top. Binarized input signal is shown for 18 acetylation marks in blue, 20 methylation marks in red and CTCF/PolII/H2A.Z in brown.</p>
              </list-item>
              <list-item>
                <p>bdHMM transitions between promoter-associated states 1–11 are shown for forward and reverse states. The asymmetric, transposed structure of these two submatrices (i.e., transition probabilities favor one direction for pairs <italic>a</italic><sub><italic>ij</italic></sub> and <italic>a</italic><sub><italic>ji</italic></sub>) uncouple the two reading directions.</p>
              </list-item>
              <list-item>
                <p>The symmetric ChromHMM transition matrix hides the underlying directed flow of chromatin states.</p>
              </list-item>
            </list>
          </p>
        </caption>
        <graphic xlink:href="msb0010-0768-f6"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>We introduced bidirectional hidden Markov models (bdHMMs), a method for <italic>de novo</italic> and unbiased inference of directed genomic states from genomewide profiling data. In contrast to previously described HMM-based approaches, bdHMM explicitly models directed genomic processes. It allows for the integration of strand-specific experimental data such as RNA expression profiles together with non-strand-specific data, such as ChIP occupancy data, and outperforms standard HMM in genomic feature annotation. The open-source package STAN provides a fast, multiprocessing implementation that can process the human chromatin dataset in &lt; 1 day.</p>
    <p>Application of bdHMM analysis significantly improved insights into previously defined combinatorial chromatin marks (Ernst &amp; Kellis, <xref rid="b9" ref-type="bibr">2010</xref>), indicating the presence of directed chromatin state patterns around the transcribed, but not the repressed, portion of the human genome. Our analysis of gene transcription in the budding yeast enabled us to automatically recover the majority of known and even new Pol II transcription units at a higher accuracy than standard HMM. We could assign different directed genomic states that are characterized by the presence of different transcription factors and Pol II CTD modification marks.</p>
    <p>The most significant advance of bdHMM analysis over previous methods is its potential to <italic>de novo</italic> identify characteristic sequences (patterns) of directed states on the genome. These patterns identify gene-specific variation in transcription—or other directed processes—that were previously hidden by metagene analysis of experimental data. Metagene analysis derives only average profiles for groups of genes defined beforehand and is thus biased toward annotated genes. In contrast, bdHMM allows investigating variations in the sequence of genomic states associated with transcription. This is done by first identifying distinct genomic states <italic>de novo</italic> and then clustering genes based on the succession of these genomic states. This analysis was consistent with a general transcription cycle and uniform transitions of a core Pol II transcription complex that occurs at all genes (Venters &amp; Pugh, <xref rid="b34" ref-type="bibr">2009</xref>; Mayer <italic>et al</italic>, <xref rid="b28" ref-type="bibr">2010</xref>; Bataille <italic>et al</italic>, <xref rid="b1" ref-type="bibr">2012</xref>). On the other hand, it also indicated gene-specific variations to the general transcription cycle, because the resulting clusters differed markedly in the sequence of their genomic states. First, a few dozen genes that apparently show Nrd1-mediated transcription attenuation are shown here to lack elongation factors Ctk1 and Paf1, suggesting that transcription attenuation occurs before Ctk1 and Paf1 are recruited. Second, we provide evidence for a distinct mechanism for highly expressed genes leading to the immediate recruitment of a full complement of Pol II-associated factors downstream of the transcription start site. Third, we found that nucleosome depletion is not a necessary feature of transcription termination.</p>
    <p>Thus, we foresee bdHMMs to be instrumental for studying gene transcription and other directed genomic processes, such as DNA replication, recombination or DNA repair.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials and Methods</title>
    <sec>
      <title>Experimental data and preprocessing</title>
      <p>The experimental yeast dataset was compiled from public data (Lee <italic>et al</italic>, <xref rid="b25" ref-type="bibr">2007</xref>; Xu <italic>et al</italic>, <xref rid="b36" ref-type="bibr">2009</xref>; Mayer <italic>et al</italic>, <xref rid="b28" ref-type="bibr">2010</xref>, <xref rid="b29" ref-type="bibr">2012</xref>; Lidschreiber <italic>et al</italic>, <xref rid="b26" ref-type="bibr">2013</xref>). All measurements were done using the high-density custom-made Affymetrix tiling array (PN 520055) which tiles each strand of genomic DNA in yeast at a resolution of 8 bp. ChIP experiments were normalized using the R/Bioconductor (Ihaka &amp; Gentleman, <xref rid="b24" ref-type="bibr">1996</xref>; Gentleman <italic>et al</italic>, <xref rid="b15" ref-type="bibr">2004</xref>) package Starr (Zacher <italic>et al</italic>, <xref rid="b37" ref-type="bibr">2010</xref>) as previously described (Zacher <italic>et al</italic>, <xref rid="b38" ref-type="bibr">2011</xref>). Expression data were normalized using the tilingArray package (Huber <italic>et al</italic>, <xref rid="b23" ref-type="bibr">2006</xref>).</p>
      <p>The human chromatin modification dataset was downloaded from the supplemental website of Ernst and Kellis (<xref rid="b9" ref-type="bibr">2010</xref>), where they provided the preprocessed sequencing and binary data.</p>
    </sec>
    <sec>
      <title>The bidirectional hidden Markov model</title>
      <p>Bidirectional hidden Markov models belong to the class of hidden Markov models (HMMs). It is therefore beneficial to introduce HMMs first, along with some notation.</p>
      <p><italic>Definition</italic>. A hidden Markov model (HMM) is a tuple <inline-formula><inline-graphic xlink:href="msb0010-0768-mu14.jpg" mimetype="image"/></inline-formula> such that</p>
      <list list-type="order">
        <list-item>
          <p><inline-formula><inline-graphic xlink:href="msb0010-0768-mu15.jpg" mimetype="image"/></inline-formula> is a finite set, the elements of which are called <italic>states</italic>.</p>
        </list-item>
        <list-item>
          <p>The <italic>initial state distribution</italic>
<inline-formula><inline-graphic xlink:href="msb0010-0768-mu16.jpg" mimetype="image"/></inline-formula> is a probability (row) vector, that is, 0 ≤ <italic>π</italic><sub><italic>i</italic></sub> ≤ 1, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu17.jpg" mimetype="image"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="msb0010-0768-mu18.jpg" mimetype="image"/></inline-formula>.</p>
        </list-item>
        <list-item>
          <p>The <italic>transition matrix</italic>
<inline-formula><inline-graphic xlink:href="msb0010-0768-mu19.jpg" mimetype="image"/></inline-formula> is a <inline-formula><inline-graphic xlink:href="msb0010-0768-mu20.jpg" mimetype="image"/></inline-formula> (row) stochastic matrix, that is, each row of <italic>A</italic> is a probability vector.</p>
        </list-item>
        <list-item>
          <p>The <italic>emission distributions</italic>
<inline-formula><inline-graphic xlink:href="msb0010-0768-mu21.jpg" mimetype="image"/></inline-formula> form a set of probability distributions on a space <inline-formula><inline-graphic xlink:href="msb0010-0768-mu22.jpg" mimetype="image"/></inline-formula>, the <italic>space of observations</italic>.</p>
        </list-item>
      </list>
      <p>An HMM defines a probability distribution on a sequence of observations <inline-formula><inline-graphic xlink:href="msb0010-0768-mu23.jpg" mimetype="image"/></inline-formula> of length <italic>T</italic> + 1. It assumes that each observation <italic>o</italic><sub><italic>t</italic></sub> is <italic>emitted</italic> by a corresponding hidden (unobserved) state variable <inline-formula><inline-graphic xlink:href="msb0010-0768-mu24.jpg" mimetype="image"/></inline-formula> which can assume values in <inline-formula><inline-graphic xlink:href="msb0010-0768-mu25.jpg" mimetype="image"/></inline-formula>. The value of <inline-formula><inline-graphic xlink:href="msb0010-0768-mu26.jpg" mimetype="image"/></inline-formula> determines the probability of observing <italic>o</italic><sub><italic>t</italic></sub> by <inline-formula><inline-graphic xlink:href="msb0010-0768-mu27.jpg" mimetype="image"/></inline-formula>. The hidden variables are assumed to form a homogenous Markov chain <inline-formula><inline-graphic xlink:href="msb0010-0768-mu28.jpg" mimetype="image"/></inline-formula>, with (time independent) transition probabilities <inline-formula><inline-graphic xlink:href="msb0010-0768-mu29.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu30.jpg" mimetype="image"/></inline-formula>, <italic>t</italic>=1,...,<italic>T</italic>, and with initial state distribution <inline-formula><inline-graphic xlink:href="msb0010-0768-mu31.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu32.jpg" mimetype="image"/></inline-formula>. The (full) likelihood of an HMM is
<disp-formula id="m1"><graphic xlink:href="msb0010-0768-m33.jpg" mimetype="image" position="float"/><label>1</label></disp-formula></p>
      <p>A bdHMM is an HMM which satisfies three additional conditions. The first two conditions deal with the structure of the underlying hidden Markov chain, and the last condition considers the nature of observations. As will be shown in the subsequent paragraph on the semantic of bdHMMs, these conditions are by no means <italic>ad hoc</italic>.</p>
      <p><italic>Definition</italic>. A bidirectional hidden Markov model (bdHMM) is a tuple <inline-formula><inline-graphic xlink:href="msb0010-0768-mu34.jpg" mimetype="image"/></inline-formula> such that <inline-formula><inline-graphic xlink:href="msb0010-0768-mu35.jpg" mimetype="image"/></inline-formula> is an HMM, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu36.jpg" mimetype="image"/></inline-formula>
<inline-formula><inline-graphic xlink:href="msb0010-0768-mu37.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="msb0010-0768-mu38.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu39.jpg" mimetype="image"/></inline-formula> are involutions (<inline-formula><inline-graphic xlink:href="msb0010-0768-mu40.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu41.jpg" mimetype="image"/></inline-formula>), and the following symmetry conditions hold:<list list-type="order"><list-item><p><italic>Generalized detailed balance</italic>: The transition matrix <italic>A</italic> and the initial state distribution <italic>π</italic> satisfy <disp-formula id="m2"><graphic xlink:href="msb0010-0768-m42.jpg" mimetype="image" position="float"/><label>2</label></disp-formula>
</p><p><italic>Initiation symmetry</italic>: The initial state distribution <italic>π</italic> satisfies <disp-formula id="m3"><graphic xlink:href="msb0010-0768-m43.jpg" mimetype="image" position="float"/><label>3</label></disp-formula>
</p><p><italic>Observation symmetry</italic>: Ψ satisfies
<disp-formula id="m4"><graphic xlink:href="msb0010-0768-m44.jpg" mimetype="image" position="float"/><label>4</label></disp-formula></p></list-item></list></p>
      <sec>
        <title>The semantic of bdHMMs</title>
        <p>Why did we choose (2), (3) and (4) as the defining properties of a bdHMM? In order to motivate our choice, let <inline-formula><inline-graphic xlink:href="msb0010-0768-mu45.jpg" mimetype="image"/></inline-formula> be a bdHMM. By initiation symmetry and generalized detailed balance,
<disp-formula id="m5"><graphic xlink:href="msb0010-0768-m46.jpg" mimetype="image" position="float"/></disp-formula>which proves <italic>πA</italic> = <italic>π</italic>. In other words, the initial state distribution <italic>π</italic> of a bdHMM is always a stationary state distribution of <italic>A</italic>. It might be surprising that the initital state distribution has to match the steady state probabilities. This is, however, an uncritical constraint in practical applications, for two reasons. First, low-complexity regions (unassembled regions, repeat regions, telomeres, centromeres, etc.) lead to frequent large stretches of missing values. Hence, the model is not run on complete chromosomes, but on the remaining regions with complete data. Therefore, taking the steady state probability as initial probability is a reasonable modeling assumption. Second, these regions are typically long enough so that the initial state distribution has minimal influence on genomic state annotation.</p>
        <p>Moreover, generalized detailed balance and initiaion symmetry together imply that the relation
<disp-formula id="m6"><graphic xlink:href="msb0010-0768-m47.jpg" mimetype="image" position="float"/><label>6</label></disp-formula>holds for all states <inline-formula><inline-graphic xlink:href="msb0010-0768-mu48.jpg" mimetype="image"/></inline-formula> and all positions <italic>t</italic> = 1,…,<italic>T</italic>. This is a most natural condition as it says that at any position of the state sequence, the probability of consecutively observing states <italic>i</italic> and <italic>j</italic> equals that of observing the respective conjugate states in reversed order. Vice versa, (5) obviously implies generalized detailed balance. Under the mild assumption that <inline-formula><inline-graphic xlink:href="msb0010-0768-mu49.jpg" mimetype="image"/></inline-formula>) always exists (this is the case, e.g., if the matrix <italic>A</italic> is ergodic, see Seneta <xref rid="b32" ref-type="bibr">2006</xref>), it can be shown that (5) also implies initiation symmetry: By induction, using
<disp-formula id="m7"><graphic xlink:href="msb0010-0768-m50.jpg" mimetype="image" position="float"/><label>7</label></disp-formula>it follows that <inline-formula><inline-graphic xlink:href="msb0010-0768-mu51.jpg" mimetype="image"/></inline-formula>Therefore,
<disp-formula id="m8"><graphic xlink:href="msb0010-0768-m52.jpg" mimetype="image" position="float"/><label>8</label></disp-formula>which is exactly condition (3). Hence the natural condition (5) is essentially equivalent to (2) and (3). The reason for using the latter two conditions for the definition of a bdHMM is that they are simple relations in terms of the model parameters <italic>π</italic> and <italic>A</italic>.</p>
        <p>Bidirectional HMMs model directional processes in a sequence of observations. It is reasonable to expect that an observation contains information about the directionality of the underlying process that generated it. The involution <inline-formula><inline-graphic xlink:href="msb0010-0768-mu53.jpg" mimetype="image"/></inline-formula> is meant to map an observation <inline-formula><inline-graphic xlink:href="msb0010-0768-mu54.jpg" mimetype="image"/></inline-formula> to its so-called conjugate observation <inline-formula><inline-graphic xlink:href="msb0010-0768-mu55.jpg" mimetype="image"/></inline-formula>, which denotes the corresponding observation that one would make if the observation sequence were viewed from the opposite direction. For example, in the case of genomic measurements, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu56.jpg" mimetype="image"/></inline-formula> is modeled as <inline-formula><inline-graphic xlink:href="msb0010-0768-mu57.jpg" mimetype="image"/></inline-formula>, the Cartesian product of a space <inline-formula><inline-graphic xlink:href="msb0010-0768-mu58.jpg" mimetype="image"/></inline-formula> of non-strand-specific observations (e.g., ChIP measurements of protein binding), a space <inline-formula><inline-graphic xlink:href="msb0010-0768-mu59.jpg" mimetype="image"/></inline-formula> of forward strand-specific observations (like RNA transcription originating from the forward strand), and a corresponding set <inline-formula><inline-graphic xlink:href="msb0010-0768-mu60.jpg" mimetype="image"/></inline-formula> of reverse strand-specific observations. The forward and reverse strand-specific observations are paired in the sense that <inline-formula><inline-graphic xlink:href="msb0010-0768-mu61.jpg" mimetype="image"/></inline-formula>. The involution <inline-formula><inline-graphic xlink:href="msb0010-0768-mu62.jpg" mimetype="image"/></inline-formula> acts as the identity on <inline-formula><inline-graphic xlink:href="msb0010-0768-mu63.jpg" mimetype="image"/></inline-formula>, and it swaps the strand-specific observations, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu64.jpg" mimetype="image"/></inline-formula>. In hidden Markov models, observations will be emitted from hidden states that may indicate typical processes occurring in forward or in reverse direction, or undirectional processes. The involution <inline-formula><inline-graphic xlink:href="msb0010-0768-mu65.jpg" mimetype="image"/></inline-formula> splits the states <inline-formula><inline-graphic xlink:href="msb0010-0768-mu66.jpg" mimetype="image"/></inline-formula> of the HMM into undirected states (denoted by <inline-formula><inline-graphic xlink:href="msb0010-0768-mu67.jpg" mimetype="image"/></inline-formula>—the fixed points <inline-formula><inline-graphic xlink:href="msb0010-0768-mu68.jpg" mimetype="image"/></inline-formula> of <italic>i</italic><sub><italic>k</italic></sub>—and directed states which occur in pairs <inline-formula><inline-graphic xlink:href="msb0010-0768-mu69.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu70.jpg" mimetype="image"/></inline-formula> of ‘conjugate’ or ‘twin’ states. One member of such a pair is deemed to be involved in forward and the other in reverse directional processes (note that at this point we do not specify which of the two does what). The forward states are denoted by <inline-formula><inline-graphic xlink:href="msb0010-0768-mu71.jpg" mimetype="image"/></inline-formula> and the reverse states by <inline-formula><inline-graphic xlink:href="msb0010-0768-mu72.jpg" mimetype="image"/></inline-formula>. The observation symmetry condition (4) merely ensures that conjugate directed states encode essentially the same probability distribution, up to reversal of the observations.</p>
        <p>Note that if <inline-formula><inline-graphic xlink:href="msb0010-0768-mu73.jpg" mimetype="image"/></inline-formula> is the identity map, condition (3) is void, and condition (2) reduces to the common detailed balance relation for reversible HMMs. If additionally the involution <inline-formula><inline-graphic xlink:href="msb0010-0768-mu74.jpg" mimetype="image"/></inline-formula> is the identity map, condition (5) is also void. Thus, a bdHMM <inline-formula><inline-graphic xlink:href="msb0010-0768-mu75.jpg" mimetype="image"/></inline-formula> is nothing but a reversible HMM, that is, an HMM which additionally satisfies the (standard) detailed balance relation <italic>π</italic><sub><italic>i</italic></sub><italic>a</italic><sub><italic>ij</italic></sub> = <italic>π</italic><sub><italic>j</italic></sub><italic>a</italic><sub><italic>ji</italic></sub>, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu76.jpg" mimetype="image"/></inline-formula>. It follows that our algorithms for bdHMM learning will immediately apply to reversible HMMs.</p>
        <p>Given an observation sequence <inline-formula><inline-graphic xlink:href="msb0010-0768-mu77.jpg" mimetype="image"/></inline-formula>, let <inline-formula><inline-graphic xlink:href="msb0010-0768-mu78.jpg" mimetype="image"/></inline-formula> denote the ‘reversed’ observation sequence obtained by taking conjugates of all observations and reversing their order. Similarly, given a hidden state sequence <inline-formula><inline-graphic xlink:href="msb0010-0768-mu79.jpg" mimetype="image"/></inline-formula>, let <inline-formula><inline-graphic xlink:href="msb0010-0768-mu80.jpg" mimetype="image"/></inline-formula> denote the ‘reversed’ hidden state sequence. Verify that
<disp-formula id="m9"><graphic xlink:href="msb0010-0768-m81.jpg" mimetype="image" position="float"/><label>9</label></disp-formula></p>
        <p>Moreover,
<disp-formula id="m10"><graphic xlink:href="msb0010-0768-m82.jpg" mimetype="image" position="float"/><label>10</label></disp-formula></p>
        <p>Equations and imply <disp-formula id="m11"><graphic xlink:href="msb0010-0768-m83.jpg" mimetype="image" position="float"/><label>11</label></disp-formula>and <disp-formula id="m12"><graphic xlink:href="msb0010-0768-m84.jpg" mimetype="image" position="float"/><label>12</label></disp-formula></p>
        <p>Finally, a bdHMM is reversible in the generalized sense, <disp-formula id="m13"><graphic xlink:href="msb0010-0768-m85.jpg" mimetype="image" position="float"/><label>13</label></disp-formula></p>
        <p>The second-last equality in (12) holds because if <inline-formula><inline-graphic xlink:href="msb0010-0768-mu86.jpg" mimetype="image"/></inline-formula> runs over all possible state sequences, then so does <inline-formula><inline-graphic xlink:href="msb0010-0768-mu87.jpg" mimetype="image"/></inline-formula>. The need for a model satisfying the natural condition (10) motivated the development of bdHMMs, and indeed, condition (10) is almost their defining property: We mention without proof that under very mild assumptions on the probability distributions Ψ, any HMM satisfying (10) is a bdHMM.</p>
      </sec>
      <sec>
        <title>Learning of the transition matrix and the initial state distribution</title>
        <p>The learning problem for bdHMMs consists in maximizing the marginal likelihood of the model,
<disp-formula id="m14"><graphic xlink:href="msb0010-0768-m88.jpg" mimetype="image" position="float"/></disp-formula></p>
        <p>Parameter estimation in an HMM is commonly done using the Baum–Welch algorithm (Baum <italic>et al</italic>, <xref rid="b4" ref-type="bibr">1970</xref>), an expectation-maximization (EM) algorithm (Dempster <italic>et al</italic>, <xref rid="b7" ref-type="bibr">1977</xref>). The EM algorithm is an iterative procedure in which a target function <italic>Q</italic>(<italic>θ</italic>;<italic>θ</italic><sup>old</sup>) is maximized with respect to the parameters <italic>θ</italic>, given a previous parameter guess <italic>θ</italic><sup>old</sup>. This algorithm will converge to a local maximum of the marginal likelihood <inline-formula><inline-graphic xlink:href="msb0010-0768-mu89.jpg" mimetype="image"/></inline-formula>. In this paragraph, we will derive an EM algorithm for the learning of the bdHMM parameters <italic>A</italic>,<italic>π</italic>.</p>
        <p>Let <inline-formula><inline-graphic xlink:href="msb0010-0768-mu90.jpg" mimetype="image"/></inline-formula> be a bdHMM. Let <inline-formula><inline-graphic xlink:href="msb0010-0768-mu91.jpg" mimetype="image"/></inline-formula> be a sequence of observations. For <inline-formula><inline-graphic xlink:href="msb0010-0768-mu92.jpg" mimetype="image"/></inline-formula>, <italic>t</italic>=1,...,<italic>T</italic>, we define the posterior probabilities
<disp-formula id="m15"><graphic xlink:href="msb0010-0768-m93.jpg" mimetype="image" position="float"/><label>15</label></disp-formula>
<disp-formula id="m16"><graphic xlink:href="msb0010-0768-m94.jpg" mimetype="image" position="float"/><label>16</label></disp-formula></p>
        <p>These posterior probabilities can be calculated efficiently using the forward probabilities <inline-formula><inline-graphic xlink:href="msb0010-0768-mu95.jpg" mimetype="image"/></inline-formula> and the backward probabilities <inline-formula><inline-graphic xlink:href="msb0010-0768-mu96.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu97.jpg" mimetype="image"/></inline-formula>. Forward and backward probabilities are calculated recursively.
<disp-formula id="m17"><graphic xlink:href="msb0010-0768-m98.jpg" mimetype="image" position="float"/><label>17</label></disp-formula>for <italic>t</italic> = 1,...,<italic>T</italic>, and <inline-formula><inline-graphic xlink:href="msb0010-0768-mu99.jpg" mimetype="image"/></inline-formula>. Similarly for the backward probabilities,
<disp-formula id="m18"><graphic xlink:href="msb0010-0768-m100.jpg" mimetype="image" position="float"/><label>18</label></disp-formula>for <italic>t</italic> = <italic>T</italic>−1,...,0, and <inline-formula><inline-graphic xlink:href="msb0010-0768-mu101.jpg" mimetype="image"/></inline-formula>. It follows that
<disp-formula id="m19"><graphic xlink:href="msb0010-0768-m102.jpg" mimetype="image" position="float"/><label>19</label></disp-formula>and
<disp-formula id="m20"><graphic xlink:href="msb0010-0768-m103.jpg" mimetype="image" position="float"/><label>20</label></disp-formula></p>
        <p>Note that the quantities <italic>ζ</italic><sub><italic>t</italic></sub>(<italic>i</italic>,<italic>j</italic>) and <italic>γ</italic><sub><italic>t</italic></sub>(<italic>i</italic>) are always non-negative. The target function <italic>Q</italic>(<italic>θ</italic>;<italic>θ</italic><sup>old</sup>) is defined as the expectation of the log likelihood <inline-formula><inline-graphic xlink:href="msb0010-0768-mu104.jpg" mimetype="image"/></inline-formula>, where expectation is taken with respect to the unknown hidden state sequence <inline-formula><inline-graphic xlink:href="msb0010-0768-mu105.jpg" mimetype="image"/></inline-formula> and its posterior distribution <inline-formula><inline-graphic xlink:href="msb0010-0768-mu106.jpg" mimetype="image"/></inline-formula>,
<disp-formula id="m21"><graphic xlink:href="msb0010-0768-m107.jpg" mimetype="image" position="float"/><label>21</label></disp-formula></p>
        <p>It can be shown that <italic>Q</italic>(<italic>θ</italic>;<italic>θ</italic><sup>old</sup>) is a lower bound of the marginal likelihood function <inline-formula><inline-graphic xlink:href="msb0010-0768-mu108.jpg" mimetype="image"/></inline-formula> which touches the likelihood function at <italic>θ</italic> = <italic>θ</italic><sup>old</sup>, that is, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu109.jpg" mimetype="image"/></inline-formula> (Dempster <italic>et al</italic>, <xref rid="b7" ref-type="bibr">1977</xref>). These properties guarantee that the iterative maximization of <italic>Q</italic> leads to a local maximum of <inline-formula><inline-graphic xlink:href="msb0010-0768-mu110.jpg" mimetype="image"/></inline-formula>. We want to maximize <italic>Q</italic> with respect to <italic>A</italic> and <italic>π</italic> under the constraints of a bdHMM. Using the posterior probabilities (13) and (14), and summarizing the <italic>ψ</italic><sub><italic>k</italic></sub> terms into one constant <italic>c</italic> which does not depend on <italic>A</italic> or <italic>π</italic>, the modified target function <italic>Q</italic> assumes a convenient form.The quantity <italic>Q</italic> is calculated in the E-step,
<disp-formula id="m22"><graphic xlink:href="msb0010-0768-m111.jpg" mimetype="image" position="float"/><label>22</label></disp-formula></p>
        <p>We calculate the Jacobian matrix and the Hessian matrix of <italic>Q</italic> and show that <italic>Q</italic> is a convex function.
<disp-formula id="m23"><graphic xlink:href="msb0010-0768-m112.jpg" mimetype="image" position="float"/><label>23</label></disp-formula>
<disp-formula id="m24"><graphic xlink:href="msb0010-0768-m113.jpg" mimetype="image" position="float"/><label>24</label></disp-formula></p>
        <p>The Hessian matrix is a diagonal matrix with non-positive diagonal entries; hence, it is negative semidefinite. This means that <italic>Q</italic> is concave. The maximization of <italic>Q</italic> is performed under the constraints that <italic>π</italic> is a probability vector, <italic>A</italic> is a stochastic matrix and that initiation symmetry and generalized detailed balance holds. Unfortunately, these constraints define a non-convex optimization domain. Still, powerful numerical solvers for concave functions exist. In our case, we used the <italic>ipopt</italic> solver (Wächter &amp; Biegler, <xref rid="b35" ref-type="bibr">2006</xref>) and Rsolnp (version 1.14, <ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org/src/contrib/Archive/Rsolnp/Rsolnp_1.14.tar.gz">http://cran.r-project.org/src/contrib/Archive/Rsolnp/Rsolnp_1.14.tar.gz</ext-link>). Transition probabilities might become very small or even 0, which may cause problems for the optimization since the lower boundary for the parameters is 0. Numerical optimizers tend to become very slow or even fail to converge at the boundary of the solution space. To ensure numerical stability and proper convergence, we set state transitions <italic>a</italic><sub><italic>ij</italic></sub>=0 that drop below a certain cutoff <inline-formula><inline-graphic xlink:href="msb0010-0768-mu114.jpg" mimetype="image"/></inline-formula>. When the algorithm approximates a point of convergence, it becomes less and less likely for a transition to be removed. The EM algorithm will find an optimal point with the additional constraints that some transitions are 0. The numerical optimization approach becomes slow for very large datasets and for a high number of hidden states. In our second approach, we therefore introduce a modified lower bound function <inline-formula><inline-graphic xlink:href="msb0010-0768-mu115.jpg" mimetype="image"/></inline-formula> which can be maximized analytically and hence very efficiently. We iterate this maximization process in the same fashion as in the EM algorithm. Although we were not able to prove convergence of the parameter sequence, this was always the case in practice. Moreover, the results obtained by our heuristic were always identical to those obtained by the numerical solver. Our heuristic is substantially faster; for our yeast data with <inline-formula><inline-graphic xlink:href="msb0010-0768-mu116.jpg" mimetype="image"/></inline-formula> states, we achieved an acceleration by a factor of about 25.</p>
        <p>Given a bdHMM parameter set <inline-formula><inline-graphic xlink:href="msb0010-0768-mu117.jpg" mimetype="image"/></inline-formula>, denoted by <inline-formula><inline-graphic xlink:href="msb0010-0768-mu118.jpg" mimetype="image"/></inline-formula>, the bdHMM parameter set is defined by <inline-formula><inline-graphic xlink:href="msb0010-0768-mu119.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu120.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu121.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu122.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu123.jpg" mimetype="image"/></inline-formula>. The modified target function is defined as
<disp-formula id="m25"><graphic xlink:href="msb0010-0768-m124.jpg" mimetype="image" position="float"/><label>25</label></disp-formula>where <italic>Q</italic> is defined as in (19). Since both <italic>Q</italic> terms in the sum in (23) are, up to some additive constant, lower bounds of the marginal likelihood function <inline-formula><inline-graphic xlink:href="msb0010-0768-mu125.jpg" mimetype="image"/></inline-formula>, so is <inline-formula><inline-graphic xlink:href="msb0010-0768-mu126.jpg" mimetype="image"/></inline-formula>.</p>
        <p>For <inline-formula><inline-graphic xlink:href="msb0010-0768-mu127.jpg" mimetype="image"/></inline-formula>, let <inline-formula><inline-graphic xlink:href="msb0010-0768-mu128.jpg" mimetype="image"/></inline-formula>. It is elementary to verify that
<disp-formula id="m26"><graphic xlink:href="msb0010-0768-m129.jpg" mimetype="image" position="float"/><label>26</label></disp-formula></p>
        <p>From (24), we deduce that
<disp-formula id="m27"><graphic xlink:href="msb0010-0768-m130.jpg" mimetype="image" position="float"/><label>27</label></disp-formula>and
<disp-formula id="m28"><graphic xlink:href="msb0010-0768-m131.jpg" mimetype="image" position="float"/><label>28</label></disp-formula></p>
        <p>Equations 22 and 28 imply
<disp-formula id="m29"><graphic xlink:href="msb0010-0768-m132.jpg" mimetype="image" position="float"/></disp-formula></p>
        <p>To maximize <inline-formula><inline-graphic xlink:href="msb0010-0768-mu133.jpg" mimetype="image"/></inline-formula> under the constraint(s) that <italic>A</italic> is a stochastic matrix, we introduce Lagrange multipliers <inline-formula><inline-graphic xlink:href="msb0010-0768-mu134.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu135.jpg" mimetype="image"/></inline-formula> and rewrite <inline-formula><inline-graphic xlink:href="msb0010-0768-mu136.jpg" mimetype="image"/></inline-formula> as
<disp-formula id="m30"><graphic xlink:href="msb0010-0768-m137.jpg" mimetype="image" position="float"/><label>30</label></disp-formula></p>
        <p>For <inline-formula><inline-graphic xlink:href="msb0010-0768-mu138.jpg" mimetype="image"/></inline-formula>, we set the partial derivatives of <inline-formula><inline-graphic xlink:href="msb0010-0768-mu139.jpg" mimetype="image"/></inline-formula> with respect to <italic>a</italic><sub><italic>ij</italic></sub> to zero,
<disp-formula id="m31"><graphic xlink:href="msb0010-0768-m140.jpg" mimetype="image" position="float"/><label>31</label></disp-formula></p>
        <p>Multiplication by <italic>a</italic><sub><italic>ij</italic></sub> and summation over all equations <inline-formula><inline-graphic xlink:href="msb0010-0768-mu141.jpg" mimetype="image"/></inline-formula> leads to
<disp-formula id="m32"><graphic xlink:href="msb0010-0768-m142.jpg" mimetype="image" position="float"/><label>32</label></disp-formula></p>
        <p>After substitution of (29) into (28), we solve for <italic>a</italic><sub><italic>ij</italic></sub>.
<disp-formula id="m33"><graphic xlink:href="msb0010-0768-m143.jpg" mimetype="image" position="float"/><label>33</label></disp-formula></p>
        <p>Let
<disp-formula id="m34"><graphic xlink:href="msb0010-0768-m144.jpg" mimetype="image" position="float"/></disp-formula>Then <italic>π</italic> is a probability vector which together with <italic>A</italic> satisfies detailed balance,
<disp-formula id="m35"><graphic xlink:href="msb0010-0768-m145.jpg" mimetype="image" position="float"/></disp-formula></p>
        <p>Further, <italic>π</italic> almost satisfies initiation symmetry:
<disp-formula id="m36"><graphic xlink:href="msb0010-0768-m146.jpg" mimetype="image" position="float"/></disp-formula></p>
        <p>Although the vector <italic>π</italic> does not exactly satisfy initiation symmetry, the amount by which this symmetry is violated is generally substantially smaller than <inline-formula><inline-graphic xlink:href="msb0010-0768-mu147.jpg" mimetype="image"/></inline-formula>. This difference is negligible for large <italic>T</italic>, that is, for long observation sequences.</p>
        <p>We have developed two strategies: The first, computer-intensive strategy is to do numerical optimization using standard solvers; the second strategy is a fast heuristic. Both methods in practice lead to the same results, and they are implemented in our R/Bioconductor software package STAN.</p>
      </sec>
      <sec>
        <title>Estimation of the emission probabilities</title>
        <p>The emission distributions Ψ are also updated by maximizing the original target function <italic>Q</italic> in equation 21. Summarizing irrelevant terms in a constant <italic>c</italic>, we have
<disp-formula id="m37"><graphic xlink:href="msb0010-0768-m148.jpg" mimetype="image" position="float"/></disp-formula></p>
        <p>We assume multivariate Gaussian emission probabilities, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu149.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu150.jpg" mimetype="image"/></inline-formula>, with mean <inline-formula><inline-graphic xlink:href="msb0010-0768-mu151.jpg" mimetype="image"/></inline-formula> and covariance matrix <inline-formula><inline-graphic xlink:href="msb0010-0768-mu152.jpg" mimetype="image"/></inline-formula>. We have implemented bdHMM with multivariate Gaussian emission probabilities, since they are appropriate distributions for microarray data on a log or quasi-log scale (Huber <italic>et al</italic>, <xref rid="b22" ref-type="bibr">2002</xref>). Moreover, the covariance matrix of multivariate Gaussians allows modeling correlations between factors in each state. This is important because factor occupancies tend to scale with the gene expression level. Such dependencies are captured by the covariance matrix. Application to sequencing-based datasets can be done by transforming the data such that it approximately follows a normal distribution (Day <italic>et al</italic>, <xref rid="b6" ref-type="bibr">2007</xref>; Hoffman <italic>et al</italic>, <xref rid="b20" ref-type="bibr">2012</xref>).</p>
        <p>Setting the partial derivatives <inline-formula><inline-graphic xlink:href="msb0010-0768-mu153.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu154.jpg" mimetype="image"/></inline-formula>, <italic>d</italic> ∈ <italic>D</italic>, to zero and solving this equation system for <italic>μ</italic><sup><italic>i</italic></sup> leads to (see Supplementary Information):
<disp-formula id="m38"><graphic xlink:href="msb0010-0768-m155.jpg" mimetype="image" position="float"/></disp-formula></p>
        <p>Analogously, setting the partial derivatives <inline-formula><inline-graphic xlink:href="msb0010-0768-mu156.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu157.jpg" mimetype="image"/></inline-formula>, <italic>c</italic>,<italic>d</italic> ∈ <italic>D</italic>, to zero and solving this equation system for Σ<sup><italic>i</italic></sup> leads to (see Supplementary Information):
<disp-formula id="m39"><graphic xlink:href="msb0010-0768-m158.jpg" mimetype="image" position="float"/></disp-formula></p>
      </sec>
      <sec>
        <title>bdHMM learning without strand-specific observations</title>
        <p>A bdHMM can even be learned from entirely strand-unspecific data (<inline-formula><inline-graphic xlink:href="msb0010-0768-mu159.jpg" mimetype="image"/></inline-formula>). However, forward and reverse states are unidentifiable under these conditions, because <inline-formula><inline-graphic xlink:href="msb0010-0768-mu160.jpg" mimetype="image"/></inline-formula>. It is necessary to <italic>a priori</italic> annotate some positions with proper directions. We introduce the flag sequence <inline-formula><inline-graphic xlink:href="msb0010-0768-mu161.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="msb0010-0768-mu162.jpg" mimetype="image"/></inline-formula>, which lists the states <italic>f</italic><sub><italic>t</italic></sub> that are allowed at a position <italic>t</italic>. We then set
<disp-formula id="m40"><graphic xlink:href="msb0010-0768-m163.jpg" mimetype="image" position="float"/></disp-formula>ignoring that this does not define a probability function for <italic>i</italic> ∉ <italic>f</italic><sub><italic>t</italic></sub>.</p>
        <p>In the context of transcription data, non-overlapping genes can be used to set flags allowing only forward (respectively, reverse) and undirected states.</p>
      </sec>
      <sec>
        <title><italic>De novo</italic> inference of state direction</title>
        <p>Let <italic>k</italic> be a directed state in a bdHMM. We introduce <italic>dir</italic><sub><italic>k</italic></sub>, a measure for the directionality of state <italic>k</italic> which is based on the posterior probabilities for observing <italic>k</italic> and respectively its conjugate <inline-formula><inline-graphic xlink:href="msb0010-0768-mu164.jpg" mimetype="image"/></inline-formula> at positions <italic>t</italic> = 0,...,<italic>T</italic>. <disp-formula id="m41"><graphic xlink:href="msb0010-0768-m165.jpg" mimetype="image" position="float"/><label>41</label></disp-formula></p>
        <p>The score will be low if the differences in the probability for observing the forward twin state and the probability for observing the respective reverse twin state are low. It will be high if these differences are large, and thus, the direction of twin states is well distinguishable. In order to account for the overall probability of state <italic>k</italic>, the sum of absolute differences in the nominator in (31) is normalized by the sum over all positions <italic>t</italic> of the posterior probabilities for observing <italic>k</italic> or <inline-formula><inline-graphic xlink:href="msb0010-0768-mu166.jpg" mimetype="image"/></inline-formula>. The directionality score is used to infer whether a directed state pair <inline-formula><inline-graphic xlink:href="msb0010-0768-mu167.jpg" mimetype="image"/></inline-formula> of a bdHMM truely contains directional information or whether it should be collapsed into one undirected state of a new bdHMM. Our rule of thumb is to collapse a directed state pair if <italic>dir</italic><sub><italic>k</italic></sub> &lt; 0.5 (see also Results and Supplementary Fig S5).</p>
      </sec>
      <sec>
        <title>Initialization of bdHMMs</title>
        <p>If strand-specific data are available, the number of directed and undirected states can be set in an intuitive manner in advance. For the yeast data, the strand-specific expression data were first split into regions expressed on either the + or − strand and unexpressed regions. Directed state means were initialized as a k-means clustering from the expressed regions, while undirected states were initialized using k-means on the unexpressed regions. We found that initialization by k-means works very well and generally converges to a higher likelihood than multiple random starts, in agreement with Rabiner (<xref rid="b30" ref-type="bibr">1989</xref>). To not introduce further biases toward the k-means initialization and allow the EM to explore solutions which are further from it, covariance matrices were initially set to the covariance of the whole data and transition and initial state probabilities were initialized uniform.</p>
        <p>In the absence of strand-specific data and without directionality annotation, we suggest to apply the directionality score that can be used as a posterior criterion to merge twin states into one undirected state, as we demonstrate for the CD4 T-cell chromatin modification data.</p>
      </sec>
      <sec>
        <title>Simulations</title>
        <p>The performance of bdHMM regarding parameter inference and state annotation on data not used for training was assessed using simulated datasets. For this purpose, we construct a transition matrix <inline-formula><inline-graphic xlink:href="msb0010-0768-mu168.jpg" mimetype="image"/></inline-formula> and an initial state distribution <inline-formula><inline-graphic xlink:href="msb0010-0768-mu169.jpg" mimetype="image"/></inline-formula> which satisfy generalized detailed balance and initiation symmetry. Choose an arbitrary transition matrix <inline-formula><inline-graphic xlink:href="msb0010-0768-mu170.jpg" mimetype="image"/></inline-formula> and a stationary distribution <inline-formula><inline-graphic xlink:href="msb0010-0768-mu171.jpg" mimetype="image"/></inline-formula>, <italic>π</italic><sup>*</sup><italic>A</italic><sup>*</sup>=<italic>π</italic><sup>*</sup>
<disp-formula id="m42"><graphic xlink:href="msb0010-0768-m172.jpg" mimetype="image" position="float"/></disp-formula>
<disp-formula id="m43"><graphic xlink:href="msb0010-0768-m173.jpg" mimetype="image" position="float"/></disp-formula></p>
        <p>Verify that <italic>π</italic> is a probability vector that satisfies initiation symmetry:
<disp-formula id="m44"><graphic xlink:href="msb0010-0768-m174.jpg" mimetype="image" position="float"/></disp-formula>
<disp-formula id="m45"><graphic xlink:href="msb0010-0768-m175.jpg" mimetype="image" position="float"/></disp-formula></p>
        <p>Furter, <italic>A</italic> is a stochastic matrix,
<disp-formula id="m46"><graphic xlink:href="msb0010-0768-m176.jpg" mimetype="image" position="float"/></disp-formula>and <italic>A</italic> together with <italic>π</italic> satisfies generalized detailed balance,
<disp-formula id="m47"><graphic xlink:href="msb0010-0768-m177.jpg" mimetype="image" position="float"/></disp-formula>We mention that <italic>A</italic> is ergodic if <italic>A</italic><sup>*</sup> is ergodic.</p>
        <p>To make our simulations realistic, we sample <italic>A</italic><sup>*</sup> as follows: Introduce an arbitrary linear order ‘≤’ on <inline-formula><inline-graphic xlink:href="msb0010-0768-mu178.jpg" mimetype="image"/></inline-formula> (this order is meant to describe the preferential order of events for the directed states). Then,
<disp-formula id="m48"><graphic xlink:href="msb0010-0768-m179.jpg" mimetype="image" position="float"/></disp-formula>where <inline-formula><inline-graphic xlink:href="msb0010-0768-mu180.jpg" mimetype="image"/></inline-formula> is the uniform distribution with lower bound <italic>a</italic> and upper bound <italic>b</italic>. Rows of <italic>A</italic><sup>*</sup> are then normalized to sum up to 1. An example of a simulated transition matrix is shown in Supplementary Fig S8. To get realistic simulations, emission distributions were simulated from fitted emissions of the yeast dataset, using five non-strand-specific (ChIP) and two strand-specific (expression) observation tracks.</p>
        <p>We did 100 simulation runs. The state numbers were randomly chosen from <inline-formula><inline-graphic xlink:href="msb0010-0768-mu181.jpg" mimetype="image"/></inline-formula> in each single run, and sequences with 15,000 observations were generated. Model parameters were initialized as follows
<disp-formula id="m49"><graphic xlink:href="msb0010-0768-m182.jpg" mimetype="image" position="float"/></disp-formula>where <italic>E</italic> is the identity matrix. In each simulation run, models were learned on simulated observation sequences of length 1,000 (respectively, 10,000). The fitted values <inline-formula><inline-graphic xlink:href="msb0010-0768-mu183.jpg" mimetype="image"/></inline-formula> showed a good agreement with the true parameter values <italic>a</italic><sub><italic>ij</italic></sub>, even when the model was only trained on 1,000 observations (Supplementary Fig S8). Median recovery of true hidden states not used for training was 97% when trained on 1,000 observations and 99.5% when trained on 10,000 observations (Supplementary Fig S8).</p>
      </sec>
      <sec>
        <title>Clustering of state sequences</title>
        <p>A set of valid coding genes was selected from initially 6,603 ORFs from SGD. 5,088 of them had an annotation of transcript boundaries provided by Xu <italic>et al</italic> (<xref rid="b36" ref-type="bibr">2009</xref>). Next, we selected transcripts where the TSS was located upstream and the pA site downstream of the coding region, yielding 4,687 genes. Then, state paths were extracted from the bdHMM annotation with a ±250 bp flanking region. We further selected transcripts where more than 80% of positions were annotated to the proper strand. This resulted in 4,263 genes, which were rescaled to a common length. Pairwise Hamming distances were computed, and the sequences were hierarchically clustered. The dendrogram was cut off to yield 55 clusters. Gene set enrichment analysis was carried out using mgsa (Bauer <italic>et al</italic>, <xref rid="b2" ref-type="bibr">2010</xref>, <xref rid="b3" ref-type="bibr">2011</xref>). A GO group was considered active if the posterior probability was &gt;0.5.</p>
      </sec>
      <sec>
        <title>Targeted identification of genomic features</title>
        <p>We defined regular expressions ((<italic>S</italic><sub>+</sub>|<italic>T</italic>2) + |(<italic>S</italic><sub>−</sub>|<italic>T</italic>2)+) and ((<italic>S</italic><sub>−</sub>)+(<italic>P</italic>/<italic>T</italic>1|<italic>P</italic>2|<italic>P</italic>1) + (<italic>S</italic><sub>+</sub>)+) to search for transcripts and bidirectional promoters throughout the yeast genome, where <italic>S</italic><sub>+</sub> = {<italic>PE</italic>1<sub>+</sub>,<italic>PE</italic>2<sub>+</sub>,<italic>eE</italic>1<sub>+</sub>, <italic>eE</italic>2<sub>+</sub>, <italic>eE</italic>3<sub>+</sub>, <italic>mE</italic>1<sub>+</sub>, <italic>mE</italic>2<sub>+</sub>, <italic>mE</italic>3<sub>+</sub>, <italic>mE</italic>4<sub>+</sub>, <italic>mE</italic>5<sub>+</sub>, <italic>lE</italic>1<sub>+</sub>, <italic>lE</italic>2<sub>+</sub>, <italic>lE</italic>3<sub>+</sub>,<italic>T</italic>1<sub>+</sub>} defines a set containing all forward states, excluding state <italic>P</italic>/<italic>T</italic>2<sub>+</sub>. <italic>S</italic><sub>−</sub> is defined likewise. Transcripts were constrained to have a minimal length of 80 bp. We uniquely assigned the 6,068 predictions to previously annotated transcripts (Xu <italic>et al</italic>, <xref rid="b36" ref-type="bibr">2009</xref>), using the best reciprocal hit with respect to transcript boundary distance. This yielded 4,186 uniquely assigned transcript predictions. Estimated cumulative distribution functions were computed to assess the accuracy of the predictions. The predictions of bidirectional promoters were not subsequently filtered. The newly identified transcription units were assigned a class (coding, SUT or CUT) using the SGD ORF annotation and expression data from Xu <italic>et al</italic> (<xref rid="b36" ref-type="bibr">2009</xref>).</p>
      </sec>
      <sec>
        <title><italic>De novo</italic> motif discovery</title>
        <p>DNA sequences were extracted for each genomic state. To increase sensitivity of the motif search, we excluded very long and very short sequences (min. length: 150 bp, max. length: 90% quantile of sequence lengths for a state). Motif search was carried out using XXmotif (Hartmann <italic>et al</italic>, <xref rid="b19" ref-type="bibr">2013</xref>), which uses a negative sequence set to calculate <italic>P</italic>-values for motif enrichment. The choice of this negative set can be crucial, since it corrects for general sequence features. We chose as negative sets upstream sequences starting at −50 bp relative to the current genomic state. A sequence motif was considered to be enriched if it had an <italic>e</italic>-value &lt;10<sup>−6</sup> and occurred in at least 5% of all sequences. The TOMTOM software (Gupta <italic>et al</italic>, <xref rid="b17" ref-type="bibr">2007</xref>) was used to search databases for similar known motifs. Functional descriptions of transcription factors were obtained from SGD (Cherry <italic>et al</italic>, <xref rid="b5" ref-type="bibr">1998</xref>).</p>
      </sec>
      <sec>
        <title>Fitting a standard HMM and a bdHMM to human chromatin modifications</title>
        <p>We fitted a bdHMM to binary chromatin modification data from Ernst and Kellis (<xref rid="b9" ref-type="bibr">2010</xref>), which previously had been analyzed by the ChromHMM algorithm. The Bernoulli emission probabilities learned by ChromHMM were fixed, and only transitions were updated during the learning of the bdHMM. This was done to ensure that the improvements over ChromHMM are only due to the altered modeling of the transitions. First, an HMM transition matrix was fitted using ChromHMM transitions (51 states) as initialization, whereby 10<sup>−3</sup> was added to each transition probability. The bdHMM transition matrix was generated by inflating the transition matrix learned by the standard HMM to a 102 × 102 matrix. Thus, our model initially did not contain any undirected states. A flag sequence was generated from annotated GENCODE (Harrow <italic>et al</italic>, <xref rid="b18" ref-type="bibr">2012</xref>) transcribed units (version 3c) to set directionality constraints at actively transcribed regions. The 39,447 GENCODE annotations were filtered for non-overlapping transcripts with a minimal length of 1,000 bp and minimal distance of 5,000 bp to neighboring transcripts on both strands (6,385). This set was filtered for expressed transcripts showing a median Pol II signal greater than the 25% quantile. This yielded 1,637 actively transcribed regions, which were used to generate a flag sequence, covering approximately 6% of genomic positions. After EM learning of the bdHMM transitions, the most likely state path was calculated using Viterbi decoding. Running time for bdHMM learning was 22 h using the multiprocessing version of STAN with 30 cores.</p>
      </sec>
      <sec>
        <title>Comparison of bdHMM and ChromHMM</title>
        <p>The bdHMM annotation (i.e., the Viterbi path) was compared to the ChromHMM annotation. The comparison was carried out by identifying bdHMM states with their ChromHMM counterpart having identical emission distribution. This means that conjugate forward and reverse bdHMM states are mapped to the same ChromHMM state. 83% of state annotations matched between bdHMM and ChromHMM. To account for differences in the implementation and model fitting (ChromHMM for instance uses a non-deterministic version of the online EM, while our implementation uses the standard EM algorithm) of ChromHMM and bdHMM, we also re-fitted the transitions of a standard HMM using the STAN package, which was initialized with the parameters reported by Ernst &amp; Kellis, (<xref rid="b9" ref-type="bibr">2010</xref>), keeping the emission distributions fixed. The agreement between the bdHMM and re-fitted HMM annotation was 97%, showing that bdHMMs essentially add directionality to chromatin states.</p>
      </sec>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Julia Ertl, Benedikt Rauscher and Rafael Campos for useful comments and fruitful discussions. AT was supported by BMBF (e:Bio Syscore) and DFG (SFB 680), BZ by BMBF (e:Bio Syscore) and JG by the Bavarian Research Center for Molecular Biosystems.</p>
  </ack>
  <sec>
    <title>Author contributions</title>
    <p>BZ, AT and JG developed the statistical methods and computational workflow of the study. BZ developed and implemented all software and scripts and carried out all computational analyses. AT initiated the study. AT and JG supervised research. ML and PC helped with preprocessing of the data and interpretation of the biological results. BZ, AT, JG and PC wrote the manuscript. All authors read and approved the final version of the manuscript.</p>
  </sec>
  <sec>
    <title>Conflict of interest</title>
    <p>The authors declare that they have no conflict of interest.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="b1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bataille</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Jeronimo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jacques</surname>
            <given-names>PE</given-names>
          </name>
          <name>
            <surname>Laramee</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fortin</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Forest</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bergeron</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hanes</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Robert</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>A universal RNA polymerase II CTD cycle is orchestrated by complex interplays between kinase, phosphatase, and isomerase enzymes along genes</article-title>
        <source>Mol Cell</source>
        <year>2012</year>
        <volume>45</volume>
        <fpage>158</fpage>
        <lpage>170</lpage>
        <pub-id pub-id-type="pmid">22284676</pub-id>
      </element-citation>
    </ref>
    <ref id="b2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bauer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gagneur</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>PN</given-names>
          </name>
        </person-group>
        <article-title>GOing Bayesian: model-based gene set analysis of genome-scale data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>3523</fpage>
        <lpage>3532</lpage>
        <pub-id pub-id-type="pmid">20172960</pub-id>
      </element-citation>
    </ref>
    <ref id="b3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bauer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>PN</given-names>
          </name>
          <name>
            <surname>Gagneur</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Model-based gene set analysis for Bioconductor</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>1882</fpage>
        <lpage>1883</lpage>
        <pub-id pub-id-type="pmid">21561920</pub-id>
      </element-citation>
    </ref>
    <ref id="b4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baum</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Petrie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Soules</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>A maximization technique occurring in the statistical analysis of probabilistic functions of Markov chains</article-title>
        <source>Ann Math Stat</source>
        <year>1970</year>
        <volume>41</volume>
        <fpage>164</fpage>
        <lpage>171</lpage>
      </element-citation>
    </ref>
    <ref id="b5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cherry</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Adler</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ball</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chervitz</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Dwight</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Hester</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Juvik</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Roe</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Schroeder</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title><italic>Saccharomyces</italic> genome database</article-title>
        <source>Nucleic Acids Res</source>
        <year>1998</year>
        <volume>26</volume>
        <fpage>73</fpage>
        <lpage>79</lpage>
        <pub-id pub-id-type="pmid">9399804</pub-id>
      </element-citation>
    </ref>
    <ref id="b6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Day</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hemmaplardh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Thurman</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Stamatoyannopoulos</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Unsupervised segmentation of continuous genomic data</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>1424</fpage>
        <lpage>1426</lpage>
        <pub-id pub-id-type="pmid">17384021</pub-id>
      </element-citation>
    </ref>
    <ref id="b7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dempster</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>
        <source>J R Stat Soc B</source>
        <year>1977</year>
        <volume>39</volume>
        <fpage>1</fpage>
        <lpage>38</lpage>
      </element-citation>
    </ref>
    <ref id="b8">
      <element-citation publication-type="journal">
        <collab>modENCODE Consortium T</collab>
        <article-title>Identification of functional elements and regulatory circuits by Drosophila modENCODE</article-title>
        <source>Science</source>
        <year>2010</year>
        <volume>330</volume>
        <fpage>1787</fpage>
        <lpage>1797</lpage>
        <pub-id pub-id-type="pmid">21177974</pub-id>
      </element-citation>
    </ref>
    <ref id="b9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ernst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Discovery and characterization of chromatin states for systematic annotation of the human genome</article-title>
        <source>Nat Biotechnol</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>817</fpage>
        <lpage>825</lpage>
        <pub-id pub-id-type="pmid">20657582</pub-id>
      </element-citation>
    </ref>
    <ref id="b10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ernst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kheradpour</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mikkelsen</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Shoresh</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>Epstein</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Issner</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Coyne</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ku</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Durham</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>BE</given-names>
          </name>
        </person-group>
        <article-title>Mapping and analysis of chromatin state dynamics in nine human cell types</article-title>
        <source>Nature</source>
        <year>2011</year>
        <volume>473</volume>
        <fpage>43</fpage>
        <lpage>49</lpage>
        <pub-id pub-id-type="pmid">21441907</pub-id>
      </element-citation>
    </ref>
    <ref id="b11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ernst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>ChromHMM: automating chromatin-state discovery and characterization</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>215</fpage>
        <lpage>216</lpage>
        <pub-id pub-id-type="pmid">22373907</pub-id>
      </element-citation>
    </ref>
    <ref id="b12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Moqtaderi</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>XS</given-names>
          </name>
          <name>
            <surname>Struhl</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Nucleosome depletion at yeast terminators is not intrinsic and can occur by a transcriptional mechanism linked to 3'-end formation</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2010</year>
        <volume>107</volume>
        <fpage>17945</fpage>
        <lpage>17950</lpage>
        <pub-id pub-id-type="pmid">20921369</pub-id>
      </element-citation>
    </ref>
    <ref id="b13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fariselli</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Martelli</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Casadio</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A new decoding algorithm for hidden Markov models improves the prediction of the topology of all-beta membrane proteins</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <issue>Suppl 4</issue>
        <fpage>S12</fpage>
        <pub-id pub-id-type="pmid">16351738</pub-id>
      </element-citation>
    </ref>
    <ref id="b14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Filion</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>van Bemmel</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Braunschweig</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Talhout</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Kind</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>Brugman</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>de Castro</surname>
            <given-names>IJ</given-names>
          </name>
          <name>
            <surname>Kerkhoven</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Bussemaker</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>van Steensel</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Systematic protein location mapping reveals five principal chromatin types in <italic>Drosophila</italic> cells</article-title>
        <source>Cell</source>
        <year>2010</year>
        <volume>143</volume>
        <fpage>212</fpage>
        <lpage>224</lpage>
        <pub-id pub-id-type="pmid">20888037</pub-id>
      </element-citation>
    </ref>
    <ref id="b15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gentleman</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Bolstad</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dettling</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gautier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ge</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gentry</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hornik</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hothorn</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Iacus</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Leisch</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Maechler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rossini</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Sawitzki</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title>
        <source>Genome Biol</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>R80</fpage>
        <pub-id pub-id-type="pmid">15461798</pub-id>
      </element-citation>
    </ref>
    <ref id="b17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gupta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Stamatoyannopoulos</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Quantifying similarity between motifs</article-title>
        <source>Genome Biol</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>R24</fpage>
        <pub-id pub-id-type="pmid">17324271</pub-id>
      </element-citation>
    </ref>
    <ref id="b18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harrow</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Frankish</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Tapanari</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Diekhans</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kokocinski</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Aken</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Barrell</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zadissa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Searle</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Barnes</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bignell</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Boychenko</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kay</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rajan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Despacio-Reyes</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Saunders</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Steward</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>GENCODE: the reference human genome annotation for The ENCODE Project</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>1760</fpage>
        <lpage>1774</lpage>
        <pub-id pub-id-type="pmid">22955987</pub-id>
      </element-citation>
    </ref>
    <ref id="b19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hartmann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Guthohrlein</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Siebert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Luehr</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Soding</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>P-value-based regulatory motif discovery using positional weight matrices</article-title>
        <source>Genome Res</source>
        <year>2013</year>
        <volume>23</volume>
        <fpage>181</fpage>
        <lpage>194</lpage>
        <pub-id pub-id-type="pmid">22990209</pub-id>
      </element-citation>
    </ref>
    <ref id="b20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoffman</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Buske</surname>
            <given-names>OJ</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Bilmes</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Unsupervised pattern discovery in human chromatin structure through genomic segmentation</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>473</fpage>
        <lpage>476</lpage>
        <pub-id pub-id-type="pmid">22426492</pub-id>
      </element-citation>
    </ref>
    <ref id="b21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoffman</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Ernst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wilder</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Kundaje</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Libbrecht</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Giardine</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ellenbogen</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Bilmes</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hardison</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Dunham</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Integrative annotation of chromatin elements from ENCODE data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <fpage>827</fpage>
        <lpage>841</lpage>
        <pub-id pub-id-type="pmid">23221638</pub-id>
      </element-citation>
    </ref>
    <ref id="b22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>von Heydebreck</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sueltmann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Poustka</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Variance stabilization applied to microarray data calibration and to the quantification of differential expression</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <issue>Suppl 1</issue>
        <fpage>S96</fpage>
        <lpage>S104</lpage>
        <pub-id pub-id-type="pmid">12169536</pub-id>
      </element-citation>
    </ref>
    <ref id="b23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Toedling</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Steinmetz</surname>
            <given-names>LM</given-names>
          </name>
        </person-group>
        <article-title>Transcript mapping with high-density oligonucleotide tiling arrays</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1963</fpage>
        <lpage>1970</lpage>
        <pub-id pub-id-type="pmid">16787969</pub-id>
      </element-citation>
    </ref>
    <ref id="b24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ihaka</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>R: a language for data analysis and graphics</article-title>
        <source>J Comp Graph Stat</source>
        <year>1996</year>
        <volume>5</volume>
        <fpage>299</fpage>
        <lpage>314</lpage>
      </element-citation>
    </ref>
    <ref id="b25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Tillo</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bray</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Morse</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Nislow</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A high-resolution atlas of nucleosome occupancy in yeast</article-title>
        <source>Nat Genet</source>
        <year>2007</year>
        <volume>39</volume>
        <fpage>1235</fpage>
        <lpage>1244</lpage>
        <pub-id pub-id-type="pmid">17873876</pub-id>
      </element-citation>
    </ref>
    <ref id="b26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lidschreiber</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Leike</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Cramer</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Cap completion and C-terminal repeat domain kinase recruitment underlie the initiation-elongation transition of RNA polymerase II</article-title>
        <source>Mol Cell Biol</source>
        <year>2013</year>
        <volume>33</volume>
        <fpage>3805</fpage>
        <lpage>3816</lpage>
        <pub-id pub-id-type="pmid">23878398</pub-id>
      </element-citation>
    </ref>
    <ref id="b27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mavrich</surname>
            <given-names>TN</given-names>
          </name>
          <name>
            <surname>Ioshikhes</surname>
            <given-names>IP</given-names>
          </name>
          <name>
            <surname>Venters</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tomsho</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Qi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schuster</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Albert</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Pugh</surname>
            <given-names>BF</given-names>
          </name>
        </person-group>
        <article-title>A barrier nucleosome model for statistical positioning of nucleosomes throughout the yeast genome</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1073</fpage>
        <lpage>1083</lpage>
        <pub-id pub-id-type="pmid">18550805</pub-id>
      </element-citation>
    </ref>
    <ref id="b28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mayer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lidschreiber</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Siebert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Leike</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Soding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cramer</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Uniform transitions of the general RNA polymerase II transcription complex</article-title>
        <source>Nat Struct Mol Biol</source>
        <year>2010</year>
        <volume>17</volume>
        <fpage>1272</fpage>
        <lpage>1278</lpage>
        <pub-id pub-id-type="pmid">20818391</pub-id>
      </element-citation>
    </ref>
    <ref id="b29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mayer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Heidemann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lidschreiber</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schreieck</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hintermair</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kremmer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Eick</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cramer</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>CTD tyrosine phosphorylation impairs termination factor recruitment to RNA polymerase II</article-title>
        <source>Science</source>
        <year>2012</year>
        <volume>336</volume>
        <fpage>1723</fpage>
        <lpage>1725</lpage>
        <pub-id pub-id-type="pmid">22745433</pub-id>
      </element-citation>
    </ref>
    <ref id="b30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rabiner</surname>
            <given-names>LR</given-names>
          </name>
        </person-group>
        <article-title>A tutorial on hidden Markov models and selected applications in speech recognition</article-title>
        <source>Proc IEEE</source>
        <year>1989</year>
        <volume>77</volume>
        <fpage>257</fpage>
        <lpage>286</lpage>
      </element-citation>
    </ref>
    <ref id="b31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schulz</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schwalb</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kiesel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Baejen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Torkler</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gagneur</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Soeding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cramer</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Transcriptome surveillance by selective termination of noncoding RNA synthesis</article-title>
        <source>Cell</source>
        <year>2013</year>
        <volume>155</volume>
        <fpage>1055</fpage>
        <lpage>1087</lpage>
      </element-citation>
    </ref>
    <ref id="b32">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Seneta</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <source>Non-negative Matrices and Markov Chains, Springer Series in Statistics</source>
        <year>2006</year>
        <publisher-loc>New York, NY</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="b33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thurman</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Day</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Stamatoyannopoulos</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Identification of higher-order functional domains in the human ENCODE regions</article-title>
        <source>Genome Res</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>917</fpage>
        <lpage>927</lpage>
        <pub-id pub-id-type="pmid">17568007</pub-id>
      </element-citation>
    </ref>
    <ref id="b34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Venters</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Pugh</surname>
            <given-names>BF</given-names>
          </name>
        </person-group>
        <article-title>A canonical promoter organization of the transcription machinery and its regulators in the <italic>Saccharomyces</italic> genome</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>360</fpage>
        <lpage>371</lpage>
        <pub-id pub-id-type="pmid">19124666</pub-id>
      </element-citation>
    </ref>
    <ref id="b35">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wächter</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Biegler</surname>
            <given-names>LT</given-names>
          </name>
        </person-group>
        <article-title>On the implementation of a primal-dual interior point filter line search algorithm for large-scale nonlinear programming</article-title>
        <source>Math Program</source>
        <year>2006</year>
        <volume>106</volume>
        <fpage>25</fpage>
        <lpage>57</lpage>
      </element-citation>
    </ref>
    <ref id="b36">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Gagneur</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Perocchi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Clauder-Munster</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Camblong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Guffanti</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Stutz</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Steinmetz</surname>
            <given-names>LM</given-names>
          </name>
        </person-group>
        <article-title>Bidirectional promoters generate pervasive transcription in yeast</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>457</volume>
        <fpage>1033</fpage>
        <lpage>1037</lpage>
        <pub-id pub-id-type="pmid">19169243</pub-id>
      </element-citation>
    </ref>
    <ref id="b37">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zacher</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kuan</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Tresch</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Starr: simple tiling ARRay analysis of affymetrix ChIP-chip data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>194</fpage>
        <pub-id pub-id-type="pmid">20398407</pub-id>
      </element-citation>
    </ref>
    <ref id="b38">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zacher</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Torkler</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tresch</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Analysis of Affymetrix ChIP-chip data using starr and R/Bioconductor</article-title>
        <source>Cold Spring Harb Protoc</source>
        <year>2011</year>
        <volume>2011</volume>
        <fpage>pdb.top110</fpage>
        <pub-id pub-id-type="pmid">21536772</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec sec-type="supplementary-material">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="sd1">
      <p>Supplementary Information</p>
      <media mimetype="pdf" mime-subtype="pdf" xlink:href="msb0010-0768-sd1.pdf" xlink:type="simple" id="d35e4238" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sd2">
      <p>Supplementary Software package</p>
      <media mimetype="zip" mime-subtype="zip" xlink:href="msb0010-0768-sd2.zip" xlink:type="simple" id="d35e4242" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sd3">
      <p>Review Process File</p>
      <media mimetype="pdf" mime-subtype="pdf" xlink:href="msb0010-0768-sd3.pdf" xlink:type="simple" id="d35e4246" position="anchor"/>
    </supplementary-material>
  </sec>
</back>
