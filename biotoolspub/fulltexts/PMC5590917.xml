<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5590917</article-id>
    <article-id pub-id-type="pmid">28886110</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-17-10878</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0184206</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Finite Element Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Geometry</subject>
            <subj-group>
              <subject>Non-Euclidean geometry</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Biochemical Simulations</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Biochemical Simulations</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Ribosomes</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Structures and Organelles</subject>
            <subj-group>
              <subject>Ribosomes</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Topology</subject>
            <subj-group>
              <subject>Manifolds</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biophysics</subject>
          <subj-group>
            <subject>Biophysical Simulations</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Biophysics</subject>
            <subj-group>
              <subject>Biophysical Simulations</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Biophysical Simulations</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Quality improvement of surface triangular mesh using a modified Laplacian smoothing approach avoiding intersection</article-title>
      <alt-title alt-title-type="running-head">Quality improvement of surface triangular mesh avoiding intersection</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9664-8391</contrib-id>
        <name>
          <surname>Liu</surname>
          <given-names>Tiantian</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Minxin</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Song</surname>
          <given-names>Yu</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Hongliang</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lu</surname>
          <given-names>Benzhuo</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Mathematics, Soochow University, Suzhou 215006, China</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>State Key Laboratory of Scientific and Engineering Computing, National Center for Mathematics and Interdisciplinary Sciences, Academy of Mathematics and Systems Science, Chinese Academy of Sciences, Beijing 100190, China</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Microsystem &amp; Terahertz Research Center, China Academy of Engineering Physics, Chengdu, China</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Shi</surname>
          <given-names>Yongtang</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Nankai University, CHINA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>chenminxin@suda.edu.cn</email> (MC); <email>bzlu@lsec.cc.ac.cn</email> (BL)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <volume>12</volume>
    <issue>9</issue>
    <elocation-id>e0184206</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>3</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>8</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2017 Liu et al</copyright-statement>
      <copyright-year>2017</copyright-year>
      <copyright-holder>Liu et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0184206.pdf"/>
    <abstract>
      <p>We present a systematic procedure to improve the qualities of triangular molecular surface meshes and at the same time preserve the manifoldness. The procedure utilizes an algorithm to remove redundant points having three or four valences and another algorithm to smooth the mesh using a modified version of Laplacian method without causing intersecting triangles. This approach can be effectively applied to any manifold surface meshes with arbitrary complex geometry. In this paper, the tested meshes are biomolecular surface meshes exhibiting typically highly irregular geometry. The results show that the qualities of the surface meshes are greatly improved and the manifoldness of the surface meshes are preserved. Compared with the original meshes, these improved molecular surface meshes can be directly applied to boundary element simulations and generation of body-fitted volume meshes using Tetgen. The procedure has been incorporated into our triangular molecular surface mesh generator, TMSmesh 2.0. It can be also used as a standalone program and works together with any other surface triangular mesh generator to obtain qualified manifold mesh. The package is downloadable at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5346169.v1">https://doi.org/10.6084/m9.figshare.5346169.v1</ext-link> and can be run online at <ext-link ext-link-type="uri" xlink:href="http://www.xyzgate.com">http://www.xyzgate.com</ext-link>.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>Science Challenge Program</institution>
        </funding-source>
        <award-id>TZ2016003</award-id>
        <principal-award-recipient>
          <name>
            <surname>Chen</surname>
            <given-names>Minxin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>21573274</award-id>
        <principal-award-recipient>
          <name>
            <surname>Lu</surname>
            <given-names>Benzhuo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>11301368</award-id>
        <principal-award-recipient>
          <name>
            <surname>Chen</surname>
            <given-names>Minxin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004608</institution-id>
            <institution>Natural Science Foundation of Jiangsu Province</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BK20130278</award-id>
        <principal-award-recipient>
          <name>
            <surname>Chen</surname>
            <given-names>Minxin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award005">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>11404300</award-id>
        <principal-award-recipient>
          <name>
            <surname>Song</surname>
            <given-names>Yu</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award006">
        <funding-source>
          <institution>Science Challenge Program</institution>
        </funding-source>
        <award-id>TZ2016003</award-id>
        <principal-award-recipient>
          <name>
            <surname>Lu</surname>
            <given-names>Benzhuo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award007">
        <funding-source>
          <institution>Science Challenge Program</institution>
        </funding-source>
        <award-id>TZ2016003</award-id>
        <principal-award-recipient>
          <name>
            <surname>Song</surname>
            <given-names>Yu</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award008">
        <funding-source>
          <institution>Science Challenge Program</institution>
        </funding-source>
        <award-id>TZ2016003</award-id>
        <principal-award-recipient>
          <name>
            <surname>Li</surname>
            <given-names>Hongliang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was funded by the Science Challenge Project (No. TZ2016003), China NSF (NSFC 91530102, NSFC 21573274, NSFC 11301368, NSFC 11404300) and NSF of Jiangsu Province (BK20130278).</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="7"/>
      <table-count count="3"/>
      <page-count count="16"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>Data are available from <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5346169.v1">https://doi.org/10.6084/m9.figshare.5346169.v1</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>Data are available from <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5346169.v1">https://doi.org/10.6084/m9.figshare.5346169.v1</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Surface mesh generation arises in many applications, such as numerical simulation, computer visualization and geometry processing. Most computational applications involve triangulation of a complex surface geometry, especially in computational biology. Molecular surface plays an important role in computational biology, such as protein folding, structure prediction, docking and implicit solvent modeling. Recent developments in realistic mathematical modeling and numerical simulation of biomolecular systems raise new demands for qualified, stable, and efficient surface meshing, especially in implicit-solvent modeling [<xref rid="pone.0184206.ref001" ref-type="bibr">1</xref>]. Many triangulated meshes are generated by scanning devices or by isosurfacing implicit representations. However, it is not easy to generate high-quality mesh for complex surface geometry in such processes, especially if automated. Low-quality triangular meshes can undermine the order of accuracy or even cause non-convergence in numerical computations. In this case, it is desirable to build high-quality meshes from those low-quality meshes before performing any numerical simulation. [<xref rid="pone.0184206.ref002" ref-type="bibr">2</xref>]</p>
    <p>Mesh quality refers to the faithfulness, manifoldness and uniformness. Faithfulness is measured by how accurately the surface mesh preserves the original geometry and topology, such as surface area, volume and curvature of the referenced surface. Faithfulness related to the accuracy of the numerical simulation and geometry processing. Manifoldness of a surface mesh means that each point on the surface has a neighborhood which is homeomorphic to a disk in a real plane. Non-manifold surface mesh brings difficulties in generating corresponding surface conforming volume mesh that is an essential prerequisite for successful finite element method computations. One of the typical non-manifold errors in surface meshes is intersecting triangles. It is an important issue that preserving the manifoldness of the original surface meshes in the process of improvements of mesh qualities. Uniformness includes the triangle shape, regularity, complexity and so on. The quality of triangles in surface mesh is crucial for robustness of boundary element method (BEM) and finite element method (FEM) computations. In some numerical analysis, such as finite element analysis, regular or qualified mesh is always required. The mesh size is related to the complexity of the mesh. Generally, more sampling points capture more surface details. But more sampling points increase the complexity of the mesh, which increases the difficulty of numerical simulation. Therefore, meshes can be improved with respect to any number of quality metrics including shape, size, manifoldness, solution error or combinations of these. The improvement process is called remeshing. [<xref rid="pone.0184206.ref003" ref-type="bibr">3</xref>] There are two fundamental remeshing approaches, parameterization techniques [<xref rid="pone.0184206.ref004" ref-type="bibr">4</xref>–<xref rid="pone.0184206.ref010" ref-type="bibr">10</xref>] and mesh adaptation strategies [<xref rid="pone.0184206.ref011" ref-type="bibr">11</xref>–<xref rid="pone.0184206.ref015" ref-type="bibr">15</xref>]. In the context of the parameterization-based remeshing, the initial surface is parameterized onto a surface in 2D, the 2D surface is meshed by the standard mesh generation method and the new mesh is projected back to the original surface. The existing parameterization method is classified to linear method [<xref rid="pone.0184206.ref016" ref-type="bibr">16</xref>–<xref rid="pone.0184206.ref021" ref-type="bibr">21</xref>], non-linear method [<xref rid="pone.0184206.ref022" ref-type="bibr">22</xref>–<xref rid="pone.0184206.ref024" ref-type="bibr">24</xref>] and hybrid method [<xref rid="pone.0184206.ref025" ref-type="bibr">25</xref>, <xref rid="pone.0184206.ref026" ref-type="bibr">26</xref>]. The parameterization-based methods can work even for coarse resolution remeshing, but the computation is expensive and the result is sensitive to the specific parameterization. The mesh adaptation method treats the surface as a set of points in space and operate directly on the surface. The strategies use local mesh modifications to improve the quality of the input surface mesh or adapt the mesh to a given mesh size criterion. Typical techniques for local mesh modifications combine vertex smoothing, vertex insertion/deletion, vertex shift, edge split, edge flip, edge collapse and so on. [<xref rid="pone.0184206.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0184206.ref027" ref-type="bibr">27</xref>–<xref rid="pone.0184206.ref030" ref-type="bibr">30</xref>]</p>
    <p>Recently, we have developed a method, TMSmesh [<xref rid="pone.0184206.ref031" ref-type="bibr">31</xref>, <xref rid="pone.0184206.ref032" ref-type="bibr">32</xref>] and its improved version, TMSmesh 2.0 [<xref rid="pone.0184206.ref033" ref-type="bibr">33</xref>], to generate molecular surface mesh for large biomolecules. TMSmesh 2.0 succeeds to generate manifold surface meshes for biomolecules comprised of more than one million atoms efficiently. The generated surface mesh preserves the original molecular surface features and properties (topology, surface area, enclosed volume, local curvature and so on) [<xref rid="pone.0184206.ref034" ref-type="bibr">34</xref>]. However, the mesh quality in the aspects of uniformness and smoothness are not guaranteed. There are some redundant points and some singular triangles in the meshes generated by TMSmesh 2.0. In boundary element and finite element simulation for some large biomolecules, the uniformness of the surface mesh is required to be improved to make the numerical simulation more robust and accurate. The faithfulness of the surface mesh to the original geometric features are critical in getting reliable simulation results from BEM and FEM computation in continuum molecular simulations. The parameterization-based methods contain the process of resampling, so these automated operation can not guarantee the fidelity of improved meshes to the original surface. And the complex geometry and topology of the large biomolecules will increase the difficulty of parameterization dramatically. There are some packages using mesh adaption strategies to improve mesh qualities, but few of them can preserve manifold meshes for complex surfaces. Therefore, in this work, we develop a package named SMOPT to improve the mesh quality directly on the surface and perform a series of local modifications on the mesh. The qualities of the new resulted meshes are improved greatly over the original surface meshes and avoid causing non-manifold errors, such as intersecting triangles. The program SMOPT has been incorporated into TMSmesh 2.0. It can be also used as a standalone program and works together with any other surface triangular mesh generator to obtain qualified manifold mesh.</p>
    <p>In the next Section, the method used to improve the surface mesh quality is introduced. Some examples, analysis and applications are presented in the results section. The final section, Conclusion, gives some concluding remarks.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <p>In this section, we describe the mesh generator TMSmesh 2.0 and the improvement procedure SMOPT to improve the quality of the triangular mesh generated by TMSmesh 2.0.</p>
    <sec id="sec003">
      <title>0.1 TMSmesh 2.0</title>
      <p>TMSmesh 2.0 is an algorithm for manifold triangular meshing of Gaussian molecular surfaces. [<xref rid="pone.0184206.ref031" ref-type="bibr">31</xref>–<xref rid="pone.0184206.ref033" ref-type="bibr">33</xref>] The Gaussian surface is defined as a level set of the summation of Gaussian kernel functions:
<disp-formula id="pone.0184206.e001"><alternatives><graphic xlink:href="pone.0184206.e001.jpg" id="pone.0184206.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>{</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
where
<disp-formula id="pone.0184206.e002"><alternatives><graphic xlink:href="pone.0184206.e002.jpg" id="pone.0184206.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mo>∥</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mo>∥</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
<inline-formula id="pone.0184206.e003"><alternatives><graphic xlink:href="pone.0184206.e003.jpg" id="pone.0184206.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and <italic>r</italic><sub><italic>i</italic></sub> are the location and radius of the <italic>i</italic>th atom, <italic>N</italic> is the number of atoms in the molecule. <italic>d</italic> is the decay rate of the Gaussian kernel. When <italic>d</italic> decreases, the molecules will show more geometrical details. <italic>c</italic> is the isovalue and it controls the volume enclosed by the Gaussian surface [<xref rid="pone.0184206.ref034" ref-type="bibr">34</xref>].</p>
      <p>The algorithm of TMSmesh 2.0 contains two stages, the first stage is an adaptive estimation and division process. The Gaussian surface is approximated by piecewise trilinear surface within controllable error. The second stage is to partition each piece of trilinear surface into single-valued patches along x, y, z directions by tracing along the fold curves. Then each single-valued patch is triangulated by the ear clipping algorithm. TMSmesh 2.0 succeeds to generate surface meshes for biomolecules comprised of more than one million atoms, and all the generated meshes are manifold mesh preserving the original detailed geometry of molecular surface. The sampled points in TMSmesh 2.0 are distributed according to the curvature and geometric features of molecular surface adaptively. In the regions with dramatic changing shapes, the density of the sampled points is high. It may result in some very close points in the mesh, which will bring difficulties to generate body-fitted volume mesh. And the very close points may cause singularity in numerical simulations for continuum modeling of biomolecules. Therefore, some methods are required to delete the redundant points and improve the mesh quality without changing the geometric features of molecules.</p>
    </sec>
    <sec id="sec004">
      <title>0.2 Algorithm to delete redundant points</title>
      <p>The redundant points are chosen from the vertices whose valence is three or four. Here, valence is the number of the adjacent vertices connected by edges.</p>
      <p><xref ref-type="fig" rid="pone.0184206.g001">Fig 1</xref> shows the redundant condition that the valence of the point is three. When the black point is or almost on the plane formed by its three red connected neighboured points, the black point is considered as a redundant one. In this situation, the black point should be deleted. Meanwhile, the elements and the edges whose vertices contain the black point should also be deleted. <xref ref-type="fig" rid="pone.0184206.g002">Fig 2</xref> shows the case of redundant vertex with a valence of four. When the black point is almost on one of two diagonals of the polygon formed by the four red connected neighboured points, the black point is considered as a redundant one. In this case, the black vertex, the elements and the edges whose vertices contain the black vertex should be deleted, and the diagonal on which the black vertex located should be added as a new edge. Then we can get two new triangles to replace the original four triangles containing the redundant vertex. Algorithm 1 shows the whole process to delete the redundant vertices.</p>
      <fig id="pone.0184206.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0184206.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>The black point is considered as the redundant point when it has a valence of three and is almost on the plane formed by its 1-ring neighborhoods in red color.</title>
        </caption>
        <graphic xlink:href="pone.0184206.g001"/>
      </fig>
      <fig id="pone.0184206.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0184206.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>The redundant point whose valence is four.</title>
          <p>The black point is redundant point. The red points are 1-ring neighborhoods of the black point. The figure shows two cases that the black point is near two different diagonals.</p>
        </caption>
        <graphic xlink:href="pone.0184206.g002"/>
      </fig>
      <p>The valence three and four cases are easy to handle. When the valence is three, we can delete the point directly. When the valance is four, we delete the point and re-triangulate the resulted polygon with four vertices. For this two simple cases, the deletion and re-triangulate processes will not lead to intersections, because these operations do not add any new planes. But for the cases with higher number of valence, after deleting the redundant vertex, we should re-triangulate the resulted polygon composed of the neighborhood triangles of the deleted vertex. It is hard to guarantee no intersection, especially when this polygon is not flat. Therefore, in these cases, we prefer to change the position of the vertices with more than four valence rather than delete.</p>
      <p><bold>Algorithm 1</bold> Delete the redundant points.</p>
      <p specific-use="line"><bold>Input:</bold> vertices in the mesh and the connection relation of each vertex.</p>
      <p specific-use="line"> <italic>i</italic> = 1</p>
      <p specific-use="line"> <italic>err</italic> = 1<italic>e</italic> − 4</p>
      <p specific-use="line"> <bold>while</bold>
<italic>i</italic> ≤ num of vertices <bold>do</bold></p>
      <p specific-use="line">  <bold>if</bold> valence of vertex <italic>i</italic> is 3 <bold>then</bold></p>
      <p specific-use="line">   <italic>n</italic><sub>1</sub>, <italic>n</italic><sub>2</sub>, <italic>n</italic><sub>3</sub> are the points on the neighbour loop of vertex <italic>i</italic></p>
      <p specific-use="line">   <italic>P</italic> is the plane formed by <italic>n</italic><sub>1</sub>, <italic>n</italic><sub>2</sub>, <italic>n</italic><sub>3</sub></p>
      <p specific-use="line">   <bold>if</bold> distance(<italic>i</italic>, <italic>P</italic>) &lt; <italic>err</italic>
<bold>then</bold></p>
      <p specific-use="line">    delete vertex <italic>i</italic></p>
      <p specific-use="line">    delete the triangles whose vertices contain <italic>i</italic></p>
      <p specific-use="line">    insert the new triangle formed by <italic>n</italic><sub>1</sub>, <italic>n</italic><sub>2</sub>, <italic>n</italic><sub>3</sub></p>
      <p specific-use="line">   <bold>end if</bold></p>
      <p specific-use="line">  <bold>end if</bold> valence of vertex <italic>i</italic> is 4 <bold>then</bold></p>
      <p specific-use="line">   <italic>n</italic><sub>1</sub>, <italic>n</italic><sub>2</sub>, <italic>n</italic><sub>3</sub>, <italic>n</italic><sub>4</sub> are the points on the neighbour loop of vertex <italic>i</italic></p>
      <p specific-use="line">   <italic>n</italic><sub>1</sub><italic>n</italic><sub>3</sub> and <italic>n</italic><sub>2</sub><italic>n</italic><sub>4</sub> are the diagonals of the neighbour loop</p>
      <p specific-use="line">   <bold>if</bold> distance(<italic>i</italic>, <italic>n</italic><sub>1</sub><italic>n</italic><sub>3</sub>) &lt; <italic>err</italic>
<bold>then</bold></p>
      <p specific-use="line">    delete vertex <italic>i</italic></p>
      <p specific-use="line">    delete the triangles whose vertices contain <italic>i</italic></p>
      <p specific-use="line">    insert two new triangles formed by <italic>n</italic><sub>1</sub>, <italic>n</italic><sub>3</sub>, <italic>n</italic><sub>4</sub> and <italic>n</italic><sub>1</sub>, <italic>n</italic><sub>2</sub>, <italic>n</italic><sub>3</sub></p>
      <p specific-use="line">   <bold>else if</bold> distance(<italic>i</italic>, <italic>n</italic><sub>2</sub><italic>n</italic><sub>4</sub>) &lt; <italic>err</italic>
<bold>then</bold></p>
      <p specific-use="line">    delete vertex <italic>i</italic></p>
      <p specific-use="line">    delete the triangles whose vertices contain <italic>i</italic></p>
      <p specific-use="line">    insert two new triangles formed by <italic>n</italic><sub>1</sub>, <italic>n</italic><sub>2</sub>, <italic>n</italic><sub>4</sub> and <italic>n</italic><sub>2</sub>, <italic>n</italic><sub>3</sub>, <italic>n</italic><sub>4</sub></p>
      <p specific-use="line">   <bold>end if</bold></p>
      <p specific-use="line">  <bold>end if</bold></p>
      <p specific-use="line"> <bold>end while</bold></p>
    </sec>
    <sec id="sec005">
      <title>0.3 Mesh smoothing</title>
      <p>An inherent problem of the automated triangulated surface mesh generation is that the resulted polygonal surface appears faceted and may contains singular triangles with very small angles. The original Gaussian surface of the biomolecule is smooth. But the generated mesh can make the approximated surface rough. And the singular triangles may cause difficulties in BEM computation and corresponding body-fitted volume mesh generation. Therefore, smoothing method is necessary for improving the qualities of surface meshes.</p>
      <p>Laplacian smoothing is an algorithm to smooth a triangular surface mesh. [<xref rid="pone.0184206.ref035" ref-type="bibr">35</xref>, <xref rid="pone.0184206.ref036" ref-type="bibr">36</xref>] The Laplacian smoothing technique changes the position of nodes without modifying the topology of the mesh. In the process of Laplacian smoothing, each vertex is move to a new position defined by taking the average position of its neighbors:
<disp-formula id="pone.0184206.e004"><alternatives><graphic xlink:href="pone.0184206.e004.jpg" id="pone.0184206.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munderover><mml:msub><mml:mi>q</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
where <italic>N</italic><sub><italic>i</italic></sub> is the number of the adjacent vertices of the <italic>i</italic>th node, <italic>q</italic><sub><italic>j</italic></sub> is the position of the <italic>j</italic>th adjacent vertex. To control the rate of smoothing, the current position <italic>q</italic><sub><italic>i</italic></sub> is also included in the calculation of the new position <italic>p</italic><sub><italic>i</italic></sub>:
<disp-formula id="pone.0184206.e005"><alternatives><graphic xlink:href="pone.0184206.e005.jpg" id="pone.0184206.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munderover><mml:msub><mml:mi>q</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
where <italic>β</italic> is the parameter to control the rate of smoothing. Usually, <italic>β</italic> takes a value between [0, 1]. However, if the geometrical characters are very complex in a region, the Laplacian smoothing may cause self-intersection. To ensure manifoldness, we proposed the modified version of Laplacian smoothing as follows. For each vertex, initially, <italic>β</italic> is chosen to be 1 and the vertex is moved to a new position through <xref ref-type="disp-formula" rid="pone.0184206.e005">Eq (4)</xref>. Then we check whether this movement causes intersection near this vertex. And if it does result in intersecting triangles, redo this movement by <xref ref-type="disp-formula" rid="pone.0184206.e005">Eq (4)</xref> using half <italic>β</italic>. This process is repeated until the new position of current vertex does not bring intersecting triangles. And in each time of checking intersecting triangles, we only need to check whether there is an edge intersecting a triangle in the vicinity of the current moved vertex.</p>
      <p>The key to detect self-intersection is to decide whether an edge is intersecting with a triangle. <xref ref-type="fig" rid="pone.0184206.g003">Fig 3</xref> shows the case that an edge intersects with a triangle. In <xref ref-type="fig" rid="pone.0184206.g003">Fig 3</xref>, <italic>P</italic><sub>1</sub><italic>P</italic><sub>2</sub><italic>P</italic><sub>3</sub> is a triangle and <italic>Q</italic><sub>1</sub><italic>Q</italic><sub>2</sub> is an edge. If <italic>Q</italic><sub>2</sub> is in the shadow of <italic>P</italic><sub>1</sub><italic>P</italic><sub>2</sub><italic>P</italic><sub>3</sub> blocking light from the source <italic>Q</italic><sub>1</sub>, the edge <italic>Q</italic><sub>1</sub><italic>Q</italic><sub>2</sub> intersect with the triangle <italic>P</italic><sub>1</sub><italic>P</italic><sub>2</sub><italic>P</italic><sub>3</sub>. In other words, if <italic>Q</italic><sub>1</sub><italic>Q</italic><sub>2</sub> intersect with <italic>P</italic><sub>1</sub><italic>P</italic><sub>2</sub><italic>P</italic><sub>3</sub>, following four conditions should be satisfied:</p>
      <list list-type="bullet">
        <list-item>
          <p>the point <italic>Q</italic><sub>2</sub> and <italic>P</italic><sub>3</sub> are on the same side of the plane <italic>Q</italic><sub>1</sub><italic>P</italic><sub>1</sub><italic>P</italic><sub>2</sub></p>
        </list-item>
        <list-item>
          <p>the point <italic>Q</italic><sub>2</sub> and <italic>P</italic><sub>1</sub> are on the same side of the plane <italic>Q</italic><sub>1</sub><italic>P</italic><sub>2</sub><italic>P</italic><sub>3</sub></p>
        </list-item>
        <list-item>
          <p>the point <italic>Q</italic><sub>2</sub> and <italic>P</italic><sub>2</sub> are on the same side of the plane <italic>Q</italic><sub>1</sub><italic>P</italic><sub>3</sub><italic>P</italic><sub>1</sub></p>
        </list-item>
        <list-item>
          <p>the point <italic>Q</italic><sub>1</sub> and <italic>Q</italic><sub>2</sub> are on different sides of the plane <italic>P</italic><sub>1</sub><italic>P</italic><sub>2</sub><italic>P</italic><sub>3</sub>.</p>
        </list-item>
      </list>
      <fig id="pone.0184206.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0184206.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Diagram of an edge intersects with a triangle.</title>
        </caption>
        <graphic xlink:href="pone.0184206.g003"/>
      </fig>
      <p>Algorithm 2 shows the whole process to detect whether an edge intersects with a triangle.</p>
      <p specific-use="line"><bold>Algorithm 2</bold> The algorithm to decide whether an edge intersects with a triangle.</p>
      <p specific-use="line"><bold>Input:</bold> three vertices of a triangle <italic>P</italic><sub>1</sub>, <italic>P</italic><sub>2</sub>, <italic>P</italic><sub>3</sub> and two endpoints of an edge <italic>Q</italic><sub>1</sub>, <italic>Q</italic><sub>2</sub></p>
      <p specific-use="line"> <inline-formula id="pone.0184206.e006"><alternatives><graphic xlink:href="pone.0184206.e006.jpg" id="pone.0184206.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>×</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>
</p>
      <p specific-use="line"> <bold>if</bold> dot_product(<inline-formula id="pone.0184206.e007"><alternatives><graphic xlink:href="pone.0184206.e007.jpg" id="pone.0184206.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>)*dot_product(<inline-formula id="pone.0184206.e008"><alternatives><graphic xlink:href="pone.0184206.e008.jpg" id="pone.0184206.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>)&lt; 0 <bold>then</bold></p>
      <p specific-use="line">  return False (False means no intersection and True means that the edge intersects with the triangle)</p>
      <p specific-use="line"> <bold>else</bold></p>
      <p specific-use="line">  <inline-formula id="pone.0184206.e009"><alternatives><graphic xlink:href="pone.0184206.e009.jpg" id="pone.0184206.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>×</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>
</p>
      <p specific-use="line">  <bold>if</bold> dot_product(<inline-formula id="pone.0184206.e010"><alternatives><graphic xlink:href="pone.0184206.e010.jpg" id="pone.0184206.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>)*dot_product(<inline-formula id="pone.0184206.e011"><alternatives><graphic xlink:href="pone.0184206.e011.jpg" id="pone.0184206.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>)&lt; 0 <bold>then</bold></p>
      <p specific-use="line">   return False</p>
      <p specific-use="line">  <bold>else</bold></p>
      <p specific-use="line">   <inline-formula id="pone.0184206.e012"><alternatives><graphic xlink:href="pone.0184206.e012.jpg" id="pone.0184206.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>×</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>
</p>
      <p specific-use="line">   <bold>if</bold> dot_product(<inline-formula id="pone.0184206.e013"><alternatives><graphic xlink:href="pone.0184206.e013.jpg" id="pone.0184206.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>)*dot_product(<inline-formula id="pone.0184206.e014"><alternatives><graphic xlink:href="pone.0184206.e014.jpg" id="pone.0184206.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>)&lt; 0 <bold>then</bold></p>
      <p specific-use="line">    return False</p>
      <p specific-use="line">   <bold>else</bold></p>
      <p specific-use="line">    <inline-formula id="pone.0184206.e015"><alternatives><graphic xlink:href="pone.0184206.e015.jpg" id="pone.0184206.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>×</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>
</p>
      <p specific-use="line">    <bold>if</bold> dot_product <inline-formula id="pone.0184206.e016"><alternatives><graphic xlink:href="pone.0184206.e016.jpg" id="pone.0184206.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>)*dot_product(<inline-formula id="pone.0184206.e017"><alternatives><graphic xlink:href="pone.0184206.e017.jpg" id="pone.0184206.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>)&gt; 0 <bold>then</bold></p>
      <p specific-use="line">     return False</p>
      <p specific-use="line">    <bold>else</bold></p>
      <p specific-use="line">     return True</p>
      <p specific-use="line">    <bold>end if</bold></p>
      <p specific-use="line">   <bold>end if</bold></p>
      <p specific-use="line">  <bold>end if</bold></p>
      <p specific-use="line"> <bold>end if</bold></p>
      <p>For large molecules, the amount of points and triangles are huge. If we do smoothing for all points every round, the computation is expensive. To reduce the computation complexity, we use a screening method. Every round doing the modified Laplacian smoothing, we just choose the vertices and the neighbored vertices of the low-quality triangles (the triangles with low edge ratio or containing tiny angles). The detailed algorithm is shown in algorithm 3. Firstly, we do modified Laplacian smoothing for all the points once. Then we find out all the triangles with low-quality. The vertices and the neighbored vertices of these low-quality triangles are considered as the target points which need to be smoothed next round. And we do smoothing to these points several rounds, usually three or four rounds. After this, we will find out the new irregular triangles from the targets we got last round. From the irregular triangles, we can get the new target points which should be smoothed next round. Repeating in this manner, the points which need to be smoothed are getting fewer and fewer. In this way, we don’t need to do modified Laplacian smoothing for all the points in the mesh every round, which reduces the computational cost greatly. When the quality of the mesh satisfies preset goal, the smoothing process is ended. Usually, we control the number of rounds of doing modified Laplacian smoothing for irregular triangles. In our program, the default rounds is set to 100. However, in most cases, the smoothing is convergent before reaching 100 rounds.</p>
      <p><bold>Algorithm 3</bold> The algorithm of mesh smoothing using modified Laplacian method.</p>
      <p specific-use="line"><bold>for</bold> each point <italic>P</italic> in the initial mesh <bold>do</bold></p>
      <p specific-use="line"> do modified Laplacian smoothing to <italic>P</italic></p>
      <p specific-use="line">
        <bold>end for</bold>
      </p>
      <p specific-use="line">let empty set <italic>L</italic> be a temporary point set</p>
      <p specific-use="line"><bold>for</bold> each triangle <italic>T</italic> in the latest mesh <bold>do</bold></p>
      <p specific-use="line"> <bold>if</bold> the quality of <italic>T</italic> is required to be improved <bold>then</bold></p>
      <p specific-use="line">  add the vertices of <italic>T</italic> and all the neighbour vertices of <italic>T</italic> to the point set <italic>L</italic></p>
      <p specific-use="line"> <bold>end if</bold></p>
      <p specific-use="line">
        <bold>end for</bold>
      </p>
      <p specific-use="line"><bold>while</bold> TRUE <bold>do</bold></p>
      <p specific-use="line"> do modified Laplacian smoothing to the point in point set <italic>L</italic> several rounds repeatedly construct a new temporary point set <italic>L</italic>′</p>
      <p specific-use="line"> find all the singular triangles in <italic>L</italic> and add the vertices of the triangles and the neighbored vertices to <italic>L</italic>′</p>
      <p specific-use="line"> set <italic>L</italic> = <italic>L</italic>′</p>
      <p specific-use="line"> <bold>if</bold> rounds of doing modified Laplacian smoothing exceeds presupposed number</p>
      <p specific-use="line"> <bold>then</bold></p>
      <p specific-use="line">  exit</p>
      <p specific-use="line"> <bold>end if</bold></p>
      <p specific-use="line">
        <bold>end while</bold>
      </p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec006">
    <title>Results</title>
    <p>For large molecules, some surface meshes generated by TMSmesh 2.0 can not be directly used to boundary element method (BEM) simulation or generation of body-fitted volume mesh due to singular triangles with tiny angles or very short edges. The algorithms introduced in the Method section are used to improve the quality of these meshes. We test the initial and improved meshes in BEM computations of Poisson-Boltzmann (PB) electrostatics and generating corresponding surface conforming volume meshes that are required in FEM simulations. The BEM software used is a publicly available PB solver, AFMPB [<xref rid="pone.0184206.ref037" ref-type="bibr">37</xref>]. In FEM simulations, the corresponding volume meshes are generated by TetGen [<xref rid="pone.0184206.ref038" ref-type="bibr">38</xref>]. <xref rid="pone.0184206.t001" ref-type="table">Table 1</xref> shows some examples which demonstrate that our improvement algorithms are effective. The number of atoms of the test molecular ranges from several thousand to several hundred thousand. The PQR Benchmark can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5349229.v1">https://doi.org/10.6084/m9.figshare.5349229.v1</ext-link>. The initial molecular surface meshes are provided by TMSmesh 2.0. They are manifold meshes but contains highly irregular and singular triangles. The algorithms introduced in the Method section can remove the redundant points and improve the qualities of triangles effectively. The meshes are smoothed 100 rounds. The improved meshes can be applicable in AFMPB [<xref rid="pone.0184206.ref037" ref-type="bibr">37</xref>] and TetGen [<xref rid="pone.0184206.ref038" ref-type="bibr">38</xref>] directly. The volume mesh generated by TetGen can used in finite element method simulations, such as Ichannel [<xref rid="pone.0184206.ref039" ref-type="bibr">39</xref>], SMPBS [<xref rid="pone.0184206.ref040" ref-type="bibr">40</xref>], mFES [<xref rid="pone.0184206.ref041" ref-type="bibr">41</xref>] and so on.</p>
    <table-wrap id="pone.0184206.t001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0184206.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Results of applying the initial meshes and the improved meshes to AFMPB and TetGen.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0184206.t001g" xlink:href="pone.0184206.t001"/>
        <table frame="box" rules="all" border="0">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="center" rowspan="2" colspan="1">Molecule</th>
              <th align="center" rowspan="2" colspan="1">Natoms</th>
              <th align="center" colspan="2" rowspan="1">Number of vertices</th>
              <th align="center" colspan="2" rowspan="1">Number of triangles</th>
              <th align="center" colspan="2" rowspan="1">AFMPB (solvation energy)</th>
              <th align="center" colspan="2" rowspan="1">TetGen</th>
            </tr>
            <tr>
              <th align="center" rowspan="1" colspan="1">Initial</th>
              <th align="center" rowspan="1" colspan="1">Improved</th>
              <th align="center" rowspan="1" colspan="1">Initial</th>
              <th align="center" rowspan="1" colspan="1">Improved</th>
              <th align="center" rowspan="1" colspan="1">Initial</th>
              <th align="center" rowspan="1" colspan="1">Improved</th>
              <th align="center" rowspan="1" colspan="1">Initial</th>
              <th align="center" rowspan="1" colspan="1">Improved</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center" rowspan="1" colspan="1">AChE monomer</td>
              <td align="center" rowspan="1" colspan="1">8280</td>
              <td align="center" rowspan="1" colspan="1">67955</td>
              <td align="center" rowspan="1" colspan="1">63361</td>
              <td align="center" rowspan="1" colspan="1">135702</td>
              <td align="center" rowspan="1" colspan="1">126782</td>
              <td align="center" rowspan="1" colspan="1">-NAN</td>
              <td align="center" rowspan="1" colspan="1">-2.50917e+03</td>
              <td align="center" rowspan="1" colspan="1">Failed</td>
              <td align="center" rowspan="1" colspan="1">Success</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">connexin</td>
              <td align="center" rowspan="1" colspan="1">19884</td>
              <td align="center" rowspan="1" colspan="1">213362</td>
              <td align="center" rowspan="1" colspan="1">210219</td>
              <td align="center" rowspan="1" colspan="1">426716</td>
              <td align="center" rowspan="1" colspan="1">420778</td>
              <td align="center" rowspan="1" colspan="1">-NAN</td>
              <td align="center" rowspan="1" colspan="1">1.80728e+03</td>
              <td align="center" rowspan="1" colspan="1">Failed</td>
              <td align="center" rowspan="1" colspan="1">Success</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">AChe tetramer</td>
              <td align="center" rowspan="1" colspan="1">36638</td>
              <td align="center" rowspan="1" colspan="1">381665</td>
              <td align="center" rowspan="1" colspan="1">366227</td>
              <td align="center" rowspan="1" colspan="1">762514</td>
              <td align="center" rowspan="1" colspan="1">732634</td>
              <td align="center" rowspan="1" colspan="1">-NAN</td>
              <td align="center" rowspan="1" colspan="1">-7.30957e+03</td>
              <td align="center" rowspan="1" colspan="1">Failed</td>
              <td align="center" rowspan="1" colspan="1">Success</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">30S ribosome</td>
              <td align="center" rowspan="1" colspan="1">88431</td>
              <td align="center" rowspan="1" colspan="1">489315</td>
              <td align="center" rowspan="1" colspan="1">480332</td>
              <td align="center" rowspan="1" colspan="1">979094</td>
              <td align="center" rowspan="1" colspan="1">961920</td>
              <td align="center" rowspan="1" colspan="1">-NAN</td>
              <td align="center" rowspan="1" colspan="1">-2.14092e+06</td>
              <td align="center" rowspan="1" colspan="1">Failed</td>
              <td align="center" rowspan="1" colspan="1">Success</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">70S ribosome</td>
              <td align="center" rowspan="1" colspan="1">165337</td>
              <td align="center" rowspan="1" colspan="1">1160599</td>
              <td align="center" rowspan="1" colspan="1">1147035</td>
              <td align="center" rowspan="1" colspan="1">2324466</td>
              <td align="center" rowspan="1" colspan="1">2298102</td>
              <td align="center" rowspan="1" colspan="1">-NAN</td>
              <td align="center" rowspan="1" colspan="1">-3.42853e+06</td>
              <td align="center" rowspan="1" colspan="1">Failed</td>
              <td align="center" rowspan="1" colspan="1">Success</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">3K1Q</td>
              <td align="center" rowspan="1" colspan="1">203135</td>
              <td align="center" rowspan="1" colspan="1">975340</td>
              <td align="center" rowspan="1" colspan="1">925914</td>
              <td align="center" rowspan="1" colspan="1">1948856</td>
              <td align="center" rowspan="1" colspan="1">1853892</td>
              <td align="center" rowspan="1" colspan="1">-NAN</td>
              <td align="center" rowspan="1" colspan="1">-7.0773e+04</td>
              <td align="center" rowspan="1" colspan="1">Failed</td>
              <td align="center" rowspan="1" colspan="1">Success</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <p><xref rid="pone.0184206.t002" ref-type="table">Table 2</xref> shows the CPU time for mesh quality improvement. All computations run on a computer with Intel<sup>®</sup> Xeon<sup>®</sup> CPU E5-4650 v2 2.4GHz and 126GB memory under 64bit Linux system. Before deleting the redundant points and doing Laplacian smoothing, we first check whether the mesh is manifold and delete the small cavities inside the molecules. If we reserve the small cavities, they tend to collapse after several times of Laplacian smoothing. The fourth column in <xref rid="pone.0184206.t002" ref-type="table">Table 2</xref> shows the time cost by checking manifoldness and deleting cavities. The fifth column shows the CPU time cost by deleting the redundant points and doing Laplacian smoothing.</p>
    <table-wrap id="pone.0184206.t002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0184206.t002</object-id>
      <label>Table 2</label>
      <caption>
        <title>CPU time for mesh quality improvement by SMOPT.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0184206.t002g" xlink:href="pone.0184206.t002"/>
        <table frame="box" rules="all" border="0">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="center" rowspan="2" colspan="1">Molecule</th>
              <th align="center" colspan="2" rowspan="1">Number of vertices</th>
              <th align="center" colspan="2" rowspan="1">CPU Time (s)</th>
            </tr>
            <tr>
              <th align="center" rowspan="1" colspan="1">Initial</th>
              <th align="center" rowspan="1" colspan="1">Improved</th>
              <th align="center" rowspan="1" colspan="1">check manifold and delete small cavities inside</th>
              <th align="center" rowspan="1" colspan="1">delete redundant points and do Laplacian smoothing</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center" rowspan="1" colspan="1">AChE monomer</td>
              <td align="center" rowspan="1" colspan="1">67955</td>
              <td align="center" rowspan="1" colspan="1">63361</td>
              <td align="char" char="." rowspan="1" colspan="1">3.39</td>
              <td align="char" char="." rowspan="1" colspan="1">43.06</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">connexin</td>
              <td align="center" rowspan="1" colspan="1">213362</td>
              <td align="center" rowspan="1" colspan="1">210219</td>
              <td align="char" char="." rowspan="1" colspan="1">21.04</td>
              <td align="char" char="." rowspan="1" colspan="1">201.52</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">AChe tetramer</td>
              <td align="center" rowspan="1" colspan="1">381665</td>
              <td align="center" rowspan="1" colspan="1">366227</td>
              <td align="char" char="." rowspan="1" colspan="1">59.22</td>
              <td align="char" char="." rowspan="1" colspan="1">364.55</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">30S ribosome</td>
              <td align="center" rowspan="1" colspan="1">489315</td>
              <td align="center" rowspan="1" colspan="1">480332</td>
              <td align="char" char="." rowspan="1" colspan="1">97.26</td>
              <td align="char" char="." rowspan="1" colspan="1">221.12</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">70S ribosome</td>
              <td align="center" rowspan="1" colspan="1">1160599</td>
              <td align="center" rowspan="1" colspan="1">1147035</td>
              <td align="char" char="." rowspan="1" colspan="1">447.80</td>
              <td align="char" char="." rowspan="1" colspan="1">580.70</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">3K1Q</td>
              <td align="center" rowspan="1" colspan="1">975340</td>
              <td align="center" rowspan="1" colspan="1">925914</td>
              <td align="char" char="." rowspan="1" colspan="1">359.49</td>
              <td align="char" char="." rowspan="1" colspan="1">465.84</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <p>We compared the mesh quality of the improved meshes by our SMOPT with those by ISO2mesh [<xref rid="pone.0184206.ref042" ref-type="bibr">42</xref>]. ISO2mesh is a free matlab/octave-based mesh generation and processing toolbox. We use the meshresample and smoothsurf modules in ISO2mesh to improve the initial meshes. To make the improved meshes from ISO2mesh comparable to those from SMOPT, in the meshresample module, we set the vertex number in output meshes from ISO2mesh close to those from SMOPT. In the smoothsurf module of ISO2mesh, the Laplacian smoothing method is chosen and the meshes are smoothed 100 rounds. In addition, we also do the same test in MeshLab [<xref rid="pone.0184206.ref043" ref-type="bibr">43</xref>]. MeshLab is an open source system for processing and editing 3D triangular meshes. It provides a set of tools for editing, cleaning, healing, inspecting, rendering, texturing and converting meshes. We use MeshLab to do Laplacian smoothing for the meshes generated by TMSmesh 2.0. However, after several rounds of smoothing, some points with the coordinates (NaN, NaN, NaN) appear, which prevents us to do further test. So, here we only show the results from SMOPT and ISO2mesh. <xref ref-type="fig" rid="pone.0184206.g004">Fig 4</xref> shows the initial and improved surface meshes by these two methods for an enzyme molecule AChE monomer. Compared to the initial mesh, both improved meshes are smoother and become closer to the molecular surface, and the two improved meshes are similar in the aspect of visualization. But there are self-intersections in the mesh improved by ISO2mesh. An example is shown in <xref ref-type="fig" rid="pone.0184206.g004">Fig 4</xref>. <xref rid="pone.0184206.t003" ref-type="table">Table 3</xref> compares mesh quality in aspect of manifoldness. There is no self-intersection in the meshes produced by SMOPT while the improved meshes by ISO2mesh can not preserve the manifoldness of the original meshes.</p>
    <fig id="pone.0184206.g004" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0184206.g004</object-id>
      <label>Fig 4</label>
      <caption>
        <title>Initial mesh and improved meshes for an AChE monomer.</title>
        <p>(a) is the initial mesh, (b) is the improved mesh by SMOPT and (c) is the improved mesh by ISO2mesh. The left sub-figure in (c) shows an example of self-intersection in the mesh improved by ISO2mesh. The red triangle intersect with the yellow triangle. The left sub-figure in (b) shows the same region as the sub-figure in (c) and there is no intersection.</p>
      </caption>
      <graphic xlink:href="pone.0184206.g004"/>
    </fig>
    <table-wrap id="pone.0184206.t003" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0184206.t003</object-id>
      <label>Table 3</label>
      <caption>
        <title>Number of non-manifold errors in meshes produced by SMOPT and ISO2mesh.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0184206.t003g" xlink:href="pone.0184206.t003"/>
        <table frame="box" rules="all" border="0">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="center" rowspan="3" colspan="1">Molecule</th>
              <th align="center" colspan="3" rowspan="1">Number of vertices</th>
              <th align="center" colspan="3" rowspan="1">Number of intersecting triangle pairs</th>
            </tr>
            <tr>
              <th align="center" rowspan="2" colspan="1">Initial</th>
              <th align="center" colspan="2" rowspan="1">Improved</th>
              <th align="center" rowspan="2" colspan="1">Initial</th>
              <th align="center" colspan="2" rowspan="1">Improved</th>
            </tr>
            <tr>
              <th align="center" rowspan="1" colspan="1">SMOPT</th>
              <th align="center" rowspan="1" colspan="1">ISO2mesh</th>
              <th align="center" rowspan="1" colspan="1">SMOPT</th>
              <th align="center" rowspan="1" colspan="1">ISO2mesh</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center" rowspan="1" colspan="1">AChE monomer</td>
              <td align="center" rowspan="1" colspan="1">67955</td>
              <td align="center" rowspan="1" colspan="1">63361</td>
              <td align="center" rowspan="1" colspan="1">63341</td>
              <td align="center" rowspan="1" colspan="1">0</td>
              <td align="center" rowspan="1" colspan="1">0</td>
              <td align="center" rowspan="1" colspan="1">57</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">connexin</td>
              <td align="center" rowspan="1" colspan="1">213362</td>
              <td align="center" rowspan="1" colspan="1">210219</td>
              <td align="center" rowspan="1" colspan="1">207126</td>
              <td align="center" rowspan="1" colspan="1">0</td>
              <td align="center" rowspan="1" colspan="1">0</td>
              <td align="center" rowspan="1" colspan="1">10</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">AChE tetramer</td>
              <td align="center" rowspan="1" colspan="1">381665</td>
              <td align="center" rowspan="1" colspan="1">366227</td>
              <td align="center" rowspan="1" colspan="1">366262</td>
              <td align="center" rowspan="1" colspan="1">0</td>
              <td align="center" rowspan="1" colspan="1">0</td>
              <td align="center" rowspan="1" colspan="1">256</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">30S ribosome</td>
              <td align="center" rowspan="1" colspan="1">489315</td>
              <td align="center" rowspan="1" colspan="1">480332</td>
              <td align="center" rowspan="1" colspan="1">480503</td>
              <td align="center" rowspan="1" colspan="1">0</td>
              <td align="center" rowspan="1" colspan="1">0</td>
              <td align="center" rowspan="1" colspan="1">317</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">70S ribosome</td>
              <td align="center" rowspan="1" colspan="1">1160599</td>
              <td align="center" rowspan="1" colspan="1">1147035</td>
              <td align="center" rowspan="1" colspan="1">1146652</td>
              <td align="center" rowspan="1" colspan="1">0</td>
              <td align="center" rowspan="1" colspan="1">0</td>
              <td align="center" rowspan="1" colspan="1">1316</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">3K1Q</td>
              <td align="center" rowspan="1" colspan="1">975340</td>
              <td align="center" rowspan="1" colspan="1">925914</td>
              <td align="center" rowspan="1" colspan="1">925640</td>
              <td align="center" rowspan="1" colspan="1">0</td>
              <td align="center" rowspan="1" colspan="1">0</td>
              <td align="center" rowspan="1" colspan="1">351</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <p><xref ref-type="fig" rid="pone.0184206.g005">Fig 5</xref> shows the areas and volumes of the initial meshes and the improved meshes generated by SMOPT and ISO2mesh. The areas of the improved meshes by SMOPT has small deviations from those of the initial meshes. Many roughed regions are smoothed after improvement, which will reduce the surface area. The volume of the smoothed mesh is almost preserved and keeps a deviation within 3%. ISO2mesh preserves both the mesh area and volume. An important reason is that ISO2mesh re-samples the vertices while SMOPT doesn’t. We will consider to add a re-sample module into SMOPT in the future.</p>
    <fig id="pone.0184206.g005" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0184206.g005</object-id>
      <label>Fig 5</label>
      <caption>
        <title>Comparison of area and volume between the initial meshes and the improved meshes generated by SMOPT and ISO2mesh for molecules in <xref rid="pone.0184206.t003" ref-type="table">Table 3</xref>.</title>
        <p>(a) Area (b) Volume.</p>
      </caption>
      <graphic xlink:href="pone.0184206.g005"/>
    </fig>
    <p>We also compared the uniformness of the meshes. The distribution of the ratios of the shortest edge length to the longest edge length of each triangle and the distribution of the angles of each triangle are used to describe the uniformness of a triangulated surface mesh. A ratio of 1.0 corresponds to an equilateral triangle, and a ratio close to 0 is indicative of a very poor uniformness. That is, the higher the ratio, the better the quality of the triangle. <xref ref-type="fig" rid="pone.0184206.g006">Fig 6</xref> shows that the edge ratios of the initial meshes are uniform distributed between (0, 0.8). The edge ratios of the improved meshes by our method SMOPT and ISO2mesh are all clustered around 0.7, but the results by SMOPT are more concentrated than ISO2mesh. Additionally, there is no triangle whose edge ratio is between 0 and 0.1 in the improved meshes by our method, which means that there are few triangles with very poor quality after improvement. The angle distributions of surface triangles in the initial and improved meshes are shown in <xref ref-type="fig" rid="pone.0184206.g007">Fig 7</xref>. The angle distribution of the improved meshes are clustered around 40° to 80° and a small portion are close to 0° or 180°, which also indicates that the improved meshes have few sharp angles.</p>
    <fig id="pone.0184206.g006" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0184206.g006</object-id>
      <label>Fig 6</label>
      <caption>
        <title>Distributions of ratio of the shortest edge length to the longest edge.</title>
        <p>The left column is the ratios of the initial mesh, the middle column is the ratios of the improved mesh by our method and the right column is the ratios of the improved mesh by ISO2mesh.</p>
      </caption>
      <graphic xlink:href="pone.0184206.g006"/>
    </fig>
    <fig id="pone.0184206.g007" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0184206.g007</object-id>
      <label>Fig 7</label>
      <caption>
        <title>Distributions of angles of each triangle.</title>
        <p>The left column is the distributions of the initial mesh, the middle column is the distributions of the improved mesh by our method and the right column is the distributions of the improved mesh by ISO2mesh.</p>
      </caption>
      <graphic xlink:href="pone.0184206.g007"/>
    </fig>
  </sec>
  <sec sec-type="conclusions" id="sec007">
    <title>Conclusion</title>
    <p>In this paper, we have described a systematic procedure, SMOPT, to remove redundant points in a 3D triangular surface mesh and to smooth the mesh using a modified Laplacian smoothing method. The improved meshes are shown to be of good quality and can be applied to numerical simulation successfully. The program SMOPT can be used together with or integrated into a surface mesh generator, such as TMSmesh 2.0. SMOPT can be also used as a standalone software and is downloadable at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5346169.v1">https://doi.org/10.6084/m9.figshare.5346169.v1</ext-link> and can be run online at <ext-link ext-link-type="uri" xlink:href="http://www.xyzgate.com">http://www.xyzgate.com</ext-link>.</p>
  </sec>
</body>
<back>
  <ack>
    <p>We thank the referees for their helpful comments.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0184206.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Lu</surname><given-names>BZ</given-names></name>, <name><surname>Zhou</surname><given-names>YC</given-names></name>, <name><surname>Holst</surname><given-names>MJ</given-names></name>, <name><surname>MaCammon</surname><given-names>JA</given-names></name>. <article-title>Recent progress in numerical methods for the Poisson-Boltzmann equation in biophysical applications</article-title>. <source>Commun in Comput Phys</source>. <year>2008</year>;<volume>3</volume>(<issue>5</issue>):<fpage>973</fpage>–<lpage>1009</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0184206.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Marchandise</surname><given-names>E</given-names></name>, <name><surname>Remacle</surname><given-names>JF</given-names></name>, <name><surname>Geuzaine</surname><given-names>C</given-names></name>. <article-title>Optimal parametrizations for surface remeshing</article-title>. <source>Engineering with Computers</source>. <year>2014</year>;<volume>30</volume>(<issue>3</issue>):<fpage>383</fpage>–<lpage>402</lpage>. <pub-id pub-id-type="doi">10.1007/s00366-012-0309-3</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref003">
      <label>3</label>
      <mixed-citation publication-type="book"><name><surname>Alliez</surname><given-names>P</given-names></name>, <name><surname>Ucelli</surname><given-names>G</given-names></name>, <name><surname>Gotsman</surname><given-names>C</given-names></name>, <name><surname>Attene</surname><given-names>M</given-names></name>. <chapter-title>Recent Advances in Remeshing of Surfaces</chapter-title> In: <source>Shape Analysis and Structuring</source>. <publisher-name>Springer</publisher-name>; <year>2008</year> p. <fpage>53</fpage>–<lpage>82</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0184206.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Borouchaki</surname><given-names>H</given-names></name>, <name><surname>Laug</surname><given-names>P</given-names></name>, <name><surname>George</surname><given-names>PL</given-names></name>. <article-title>Parametric surface meshing using a combined advancing-front generalized Delaunay approach</article-title>. <source>International Journal for Numerical Methods in Engineering</source>. <year>2000</year>;<volume>49</volume>:<fpage>233</fpage>–<lpage>259</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0184206.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Laug</surname><given-names>P</given-names></name>, <name><surname>Borouchaki</surname><given-names>H</given-names></name>. <article-title>Interpolating and meshing 3D surface grids</article-title>. <source>International Journal for Numerical Methods in Engineering</source>. <year>2003</year>;<volume>58</volume>(<issue>2</issue>):<fpage>209</fpage>–<lpage>225</lpage>. <pub-id pub-id-type="doi">10.1002/nme.770</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Attene</surname><given-names>M</given-names></name>, <name><surname>Falcidieno</surname><given-names>B</given-names></name>, <name><surname>Spagnuolo</surname><given-names>M</given-names></name>, <name><surname>Wyvill</surname><given-names>G</given-names></name>. <article-title>A mapping-independent primitive for the triangulation of parametric surfaces</article-title>. <source>Graphical Models</source>. <year>2003</year>;<volume>65</volume>(<issue>5</issue>):<fpage>260</fpage>–<lpage>273</lpage>. <pub-id pub-id-type="doi">10.1016/S1524-0703(03)00048-1</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Marcum</surname><given-names>DL</given-names></name>. <article-title>Efficient Generation of High-Quality Unstructured Surface and Volume Grids</article-title>. <source>Engineering With Computers</source>. <year>2001</year>;<volume>17</volume>(<issue>3</issue>):<fpage>211</fpage>–<lpage>233</lpage>. <pub-id pub-id-type="doi">10.1007/PL00013386</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref008">
      <label>8</label>
      <mixed-citation publication-type="other">Tristano JR, Owen SJ, Canann SA. Advancing front surface mesh generation in parametric space using Riemannian surface definition. In: Proceedings of 7th international meshing roundtable; 1998. p. 429–455.</mixed-citation>
    </ref>
    <ref id="pone.0184206.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>Y</given-names></name>, <name><surname>Weatherill</surname><given-names>NP</given-names></name>, <name><surname>Hassan</surname><given-names>O</given-names></name>. <article-title>Topology abstraction of surface models for three-dimensional grid generation</article-title>. <source>Engineering With Computers</source>. <year>2001</year>;<volume>17</volume>(<issue>1</issue>):<fpage>28</fpage>–<lpage>38</lpage>. <pub-id pub-id-type="doi">10.1007/s003660170021</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref010">
      <label>10</label>
      <mixed-citation publication-type="other">Surazhsky V, Alliez P, Gotsman C. Isotropic Remeshing of Surfaces: A Local Parameterization Approach. In: Proceedings of 12th international meshing roundtable; 2003. p. 215–224.</mixed-citation>
    </ref>
    <ref id="pone.0184206.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Béchet</surname><given-names>E</given-names></name>, <name><surname>Cuillière</surname><given-names>Jean Christophe</given-names></name><name><surname>T</surname><given-names>F</given-names></name>. <article-title>Generation of a finite element mesh from stereolithography (STL) files</article-title>. <source>Computer-Aided Design</source>. <year>2002</year>;<volume>34</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>17</lpage>. <pub-id pub-id-type="doi">10.1016/S0010-4485(00)00146-9</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Ito</surname><given-names>Y</given-names></name>, <name><surname>Nakahashi</surname><given-names>K</given-names></name>. <article-title>Direct Surface Triangulation Using Stereolithography Data</article-title>. <source>AIAA Journal</source>. <year>2002</year>;<volume>40</volume>(<issue>3</issue>):<fpage>490</fpage>–<lpage>496</lpage>. <pub-id pub-id-type="doi">10.2514/3.15087</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>D</given-names></name>, <name><surname>Hassan</surname><given-names>O</given-names></name>, <name><surname>Morgan</surname><given-names>K</given-names></name>, <name><surname>Weatherill</surname><given-names>N</given-names></name>. <article-title>Enhanced remeshing from stl files with applications to surface grid generation</article-title>. <source>Commun Numer Meth Eng</source>. <year>2007</year>;<volume>23</volume>:<fpage>227</fpage>–<lpage>239</lpage>. <pub-id pub-id-type="doi">10.1002/cnm.894</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Lévy</surname><given-names>B</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>. <article-title>Lp Centroidal Voronoi Tesselation and its Applications</article-title>. <source>ACM Transactions on Graphics</source>. <year>2010</year>;<volume>29</volume>(<issue>4</issue>):<fpage>119:1</fpage>–<lpage>119:11</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0184206.ref015">
      <label>15</label>
      <mixed-citation publication-type="book"><name><surname>Dassi</surname><given-names>F</given-names></name>, <name><surname>Si</surname><given-names>H</given-names></name>. In: <source>A Curvature-Adapted Anisotropic Surface Re-meshing Method</source>. <publisher-name>Springer International Publishing</publisher-name>;. p. <fpage>19</fpage>–<lpage>41</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0184206.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Alliez</surname><given-names>P</given-names></name>, <name><surname>Meyer</surname><given-names>M</given-names></name>, <name><surname>Desbrun</surname><given-names>M</given-names></name>. <article-title>Interactive Geometry Remeshing</article-title>. <source>ACM Trans Graph</source>. <year>2002</year>;<volume>21</volume>(<issue>3</issue>):<fpage>347</fpage>–<lpage>354</lpage>. <pub-id pub-id-type="doi">10.1145/566654.566588</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref017">
      <label>17</label>
      <mixed-citation publication-type="other">Eck M, DeRose T, Duchamp T, Hoppey H, Lounsberyz M, Stuetzle W. Multiresolution Analysis of Arbitrary Meshes. In: Proceedings of the 22nd annual conference on Computer graphics and interactive techniques; 1995. p. 173–182.</mixed-citation>
    </ref>
    <ref id="pone.0184206.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Floater</surname><given-names>MS</given-names></name>. <article-title>Parametrization and smooth approximation of surface triangulations</article-title>. <source>Computer Aided Geometric Design</source>. <year>1997</year>;<volume>14</volume>(<issue>3</issue>):<fpage>231</fpage>–<lpage>250</lpage>. <pub-id pub-id-type="doi">10.1016/S0167-8396(96)00031-3</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Floater</surname><given-names>MS</given-names></name>. <article-title>Mean value coordinates</article-title>. <source>Computer Aided Geometric Design</source>. <year>2003</year>;<volume>20</volume>(<issue>1</issue>):<fpage>19</fpage>–<lpage>37</lpage>. <pub-id pub-id-type="doi">10.1016/S0167-8396(03)00002-5</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref020">
      <label>20</label>
      <mixed-citation publication-type="other">Lévy B, Petitjean S, Ray N, Maillot J. Least Squares Conformal Maps for Automatic Texture Atlas Generation. In: ACM SIGGRAPH conference proceedings; 2002. p. 362–371.</mixed-citation>
    </ref>
    <ref id="pone.0184206.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Tutte</surname><given-names>W</given-names></name>. <chapter-title>How to draw a graph</chapter-title> In: <source>Proceedings of the London Mathematical Society</source>. <volume>vol. 13</volume>; <year>1963</year> p. <fpage>743</fpage>–<lpage>768</lpage>. <pub-id pub-id-type="doi">10.1112/plms/s3-13.1.743</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref022">
      <label>22</label>
      <mixed-citation publication-type="other">Hormann K, Greiner G. Mips: an efficient global Parametrization method. In: Curve and surface design; 2000.</mixed-citation>
    </ref>
    <ref id="pone.0184206.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Sheffer</surname><given-names>A</given-names></name>, <name><surname>Lévy</surname><given-names>B</given-names></name>, <name><surname>Lorraine</surname><given-names>I</given-names></name>. <article-title>Abf++: fast and robust angle based flattening</article-title>. <source>ACM Transactions on Graphics</source>. <year>2005</year>;<volume>24</volume>(<issue>2</issue>):<fpage>311</fpage>–<lpage>330</lpage>. <pub-id pub-id-type="doi">10.1145/1061347.1061354</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Zigelman</surname><given-names>G</given-names></name>, <name><surname>Kimmel</surname><given-names>R</given-names></name>. <article-title>Texture mapping using surface flattening via multi-dimensional scaling</article-title>. <source>IEEE Trans Vis Comput Graph</source>. <year>2002</year>;<volume>8</volume>:<fpage>198</fpage>–<lpage>207</lpage>. <pub-id pub-id-type="doi">10.1109/2945.998671</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Ben-Chen</surname><given-names>M</given-names></name>, <name><surname>Gotsman</surname><given-names>C</given-names></name>, <name><surname>Bunin</surname><given-names>G</given-names></name>. <article-title>Conformal flattening by curvature prescription and metric scaling</article-title>. <source>Comput Graphics Forum</source>. <year>2008</year>;<volume>27</volume>(<issue>2</issue>):<fpage>449</fpage>–<lpage>458</lpage>. <pub-id pub-id-type="doi">10.1111/j.1467-8659.2008.01142.x</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref026">
      <label>26</label>
      <mixed-citation publication-type="other">Zayer R, Lévy B, Seidel HP. Linear angle based parameterization. In: Proceedings of ACM/EG symposium on geometry processing conference; 2007.</mixed-citation>
    </ref>
    <ref id="pone.0184206.ref027">
      <label>27</label>
      <mixed-citation publication-type="other">Frey PJ. About surface remeshing. In: Proceedings of 9th International Meshing Roundtable; 2000. p. 123–136.</mixed-citation>
    </ref>
    <ref id="pone.0184206.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Frey</surname><given-names>PJ</given-names></name>, <name><surname>Borouchaki</surname><given-names>H</given-names></name>. <article-title>Geometric surface mesh optimization</article-title>. <source>Computing and Visualization in Science</source>. <year>1998</year>;<volume>1</volume>:<fpage>13</fpage>–<lpage>121</lpage>. <pub-id pub-id-type="doi">10.1007/s007910050011</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Hoppe</surname><given-names>H</given-names></name>. <article-title>Progressive meshes</article-title>. <source>Computer Graphics</source>. <year>1996</year>;<volume>30</volume>:<fpage>99</fpage>–<lpage>108</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0184206.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Rassineux</surname><given-names>A</given-names></name>, <name><surname>Villon</surname><given-names>P</given-names></name>, <name><surname>Stab</surname><given-names>O</given-names></name>. <article-title>Surface remeshing by local hermite diffuse interpolation</article-title>. <source>International Journal for Numerical Methods in Engineering</source>. <year>2000</year>;<volume>49</volume>(<issue>1-2</issue>):<fpage>31</fpage>–<lpage>49</lpage>. <pub-id pub-id-type="doi">10.1002/1097-0207(20000910/20)49:1/2&lt;31::AID-NME921&gt;3.0.CO;2-6</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>MX</given-names></name>, <name><surname>Lu</surname><given-names>BZ</given-names></name>. <article-title>TMSmesh: A Robust Method for Molecular Surface Mesh Generation Using a Trace Technique</article-title>. <source>J Chem Theory Comput</source>. <year>2011</year>;<volume>7</volume>(<issue>1</issue>):<fpage>203</fpage>–<lpage>212</lpage>. <pub-id pub-id-type="doi">10.1021/ct100376g</pub-id><?supplied-pmid 26606233?><pub-id pub-id-type="pmid">26606233</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>MX</given-names></name>, <name><surname>Tu</surname><given-names>B</given-names></name>, <name><surname>Lu</surname><given-names>BZ</given-names></name>. <article-title>Triangulated Manifold Meshing Method Preserving Molecular Surface Topology</article-title>. <source>Journal of Molecular Graphics and Modelling</source>. <year>2012</year>;<volume>38</volume>(<issue>1</issue>):<fpage>411</fpage>–<lpage>418</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmgm.2012.09.006</pub-id><?supplied-pmid 23117290?><pub-id pub-id-type="pmid">23117290</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref033">
      <label>33</label>
      <mixed-citation publication-type="other">Liu T, Chen M, Lu B. Efficient and Qualified Mesh Generation for Gaussian Molecular Surface Using Adaptive Partition and Piecewise Polynomial Approximation. <ext-link ext-link-type="uri" xlink:href="https://arxivorg/pdf/161103474pdf">https://arxivorg/pdf/161103474pdf</ext-link>. 2017;.</mixed-citation>
    </ref>
    <ref id="pone.0184206.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>T</given-names></name>, <name><surname>Chen</surname><given-names>M</given-names></name>, <name><surname>Lu</surname><given-names>B</given-names></name>. <article-title>Parameterization for molecular Gaussian surface and a comparison study of surface mesh generation</article-title>. <source>Journal of Molecular Modeling</source>. <year>2015</year>;<volume>21</volume>(<issue>5</issue>). <pub-id pub-id-type="doi">10.1007/s00894-015-2654-9</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Herrmann</surname><given-names>LR</given-names></name>. <article-title>Laplacian-isoparametric grid generation scheme</article-title>. <source>Journal of the Engineering Mechanics Division</source>. <year>1976</year>;<volume>102</volume>(<issue>5</issue>):<fpage>749</fpage>–<lpage>756</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0184206.ref036">
      <label>36</label>
      <mixed-citation publication-type="other">Sorkine O, Lipman Y, Cohen-Or D, Spencer S. Laplacian Surface Editing. In: Proceedings of the 2004 Eurographics; 2004.</mixed-citation>
    </ref>
    <ref id="pone.0184206.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>B</given-names></name>, <name><surname>Peng</surname><given-names>B</given-names></name>, <name><surname>Huang</surname><given-names>J</given-names></name>, <name><surname>Pitsianis</surname><given-names>NP</given-names></name>, <name><surname>Sun</surname><given-names>X</given-names></name>, <name><surname>Lu-</surname><given-names>B</given-names></name>. <article-title>Parallel AFMPB solver with automatic surface meshing for calculations of molecular solvation free energy</article-title>. <source>Computer Physics Communications</source>. <year>2015</year>;<volume>190</volume>:<fpage>173</fpage>–<lpage>181</lpage>. <pub-id pub-id-type="doi">10.1016/j.cpc.2014.12.022</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Si</surname><given-names>H</given-names></name>. <article-title>TetGen, a Delaunay-based quality tetrahedral mesh generator</article-title>. <source>ACM Transactions on Mathematical Software</source>. <year>2015</year>;<volume>41</volume>(<issue>2</issue>):Article 11. <pub-id pub-id-type="doi">10.1145/2629697</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Tu</surname><given-names>B</given-names></name>, <name><surname>Bai</surname><given-names>S</given-names></name>, <name><surname>Chen</surname><given-names>M</given-names></name>, <name><surname>Xie</surname><given-names>Y</given-names></name>, <name><surname>Zhang</surname><given-names>L</given-names></name>, <name><surname>Lu</surname><given-names>B</given-names></name>. <article-title>A software platform for continuum modeling of ion channels based on unstructured mesh</article-title>. <source>Computational Science &amp; Discovery</source>. <year>2014</year>;<volume>7</volume>(<issue>1</issue>):<fpage>014002</fpage><pub-id pub-id-type="doi">10.1088/1749-4680/7/1/014002</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Xie</surname><given-names>Y</given-names></name>, <name><surname>Ying</surname><given-names>J</given-names></name>, <name><surname>Xie</surname><given-names>D</given-names></name>. <article-title>SMPBS: Web server for computing biomolecular electrostatics using finite element solvers of size modified Poisson-Boltzmann equation</article-title>. <source>Journal of Computational Chemistry</source>. <year>2017</year>;<volume>38</volume>(<issue>8</issue>):<fpage>541</fpage>–<lpage>552</lpage>. <pub-id pub-id-type="doi">10.1002/jcc.24703</pub-id><?supplied-pmid 28052351?><pub-id pub-id-type="pmid">28052351</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Sakalli</surname><given-names>I</given-names></name>, <name><surname>Schöberl</surname><given-names>J</given-names></name>, <name><surname>Knapp</surname><given-names>EW</given-names></name>. <article-title>mFES: A Robust Molecular Finite Element Solver for Electrostatic Energy Computations</article-title>. <source>J Chem Theory Comput</source>. <year>2014</year>;<volume>10</volume>(<issue>11</issue>):<fpage>5095</fpage>–<lpage>5112</lpage>. <pub-id pub-id-type="doi">10.1021/ct5005092</pub-id><?supplied-pmid 26584389?><pub-id pub-id-type="pmid">26584389</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0184206.ref042">
      <label>42</label>
      <mixed-citation publication-type="other">Fang Q, Boas D. Tetrahedral mesh generation from volumetric binary and gray-scale images. In: Proceedings of IEEE International Symposium on Biomedical Imaging 2009; 2009. p. 1142–1145.</mixed-citation>
    </ref>
    <ref id="pone.0184206.ref043">
      <label>43</label>
      <mixed-citation publication-type="other">Cignoni P, Callieri M, Corsini M, Dellepiane M, Ganovelli F, Ranzuglia G. MeshLab: an Open-Source Mesh Processing Tool. In: Sixth Eurographics Italian Chapter Conference; 2008. p. 129–136.</mixed-citation>
    </ref>
  </ref-list>
</back>
