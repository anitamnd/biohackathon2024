<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with OASIS Tables v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archive-oasis-article1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats-oasis2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">mSystems</journal-id>
    <journal-id journal-id-type="iso-abbrev">mSystems</journal-id>
    <journal-id journal-id-type="publisher-id">msystems</journal-id>
    <journal-title-group>
      <journal-title>mSystems</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2379-5077</issn>
    <publisher>
      <publisher-name>American Society for Microbiology</publisher-name>
      <publisher-loc>1752 N St., N.W., Washington, DC</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8577285</article-id>
    <article-id pub-id-type="pmid">34751586</article-id>
    <article-id pub-id-type="publisher-id">mSystems00697-21</article-id>
    <article-id pub-id-type="doi">10.1128/mSystems.00697-21</article-id>
    <article-id pub-id-type="publisher-id">msystems.00697-21</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="biological-terms">
        <compound-subject>
          <compound-subject-part content-type="code">human-microbiome</compound-subject-part>
          <compound-subject-part content-type="label">Human Microbiome</compound-subject-part>
        </compound-subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HashSeq: a Simple, Scalable, and Conservative <italic toggle="yes">De Novo</italic> Variant Caller for 16S rRNA Gene Data Sets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Fouladi</surname>
          <given-names>Farnaz</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
        <email>farnaz.fouladi@gmail.com</email>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Young</surname>
          <given-names>Jacqueline B.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Fodor</surname>
          <given-names>Anthony A.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
        <email>anthony.fodor@gmail.com</email>
      </contrib>
      <aff id="aff1">
        <label>a</label>
        <addr-line>Department of Bioinformatics and Genomics, <institution-wrap><institution>University of North Carolina at Charlotte</institution><institution-id institution-id-type="grid">grid.266859.6</institution-id></institution-wrap>, Charlotte, North Carolina, USA</addr-line>
      </aff>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <role>Editor</role>
        <name>
          <surname>Arumugam</surname>
          <given-names>Mani</given-names>
        </name>
        <aff>University of Copenhagen</aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn fn-type="other">
        <p><bold>Citation</bold> Fouladi F, Young JB, Fodor AA. 2021. HashSeq: a simple, scalable, and conservative <italic toggle="yes">de novo</italic> variant caller for 16S rRNA gene data sets. mSystems 6:e00697-21. <ext-link xlink:href="https://doi.org/10.1128/mSystems.00697-21" ext-link-type="uri">https://doi.org/10.1128/mSystems.00697-21</ext-link>.</p>
      </fn>
    </author-notes>
    <pub-date publication-format="electronic" date-type="pub">
      <day>9</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date publication-format="electronic" date-type="collection">
      <season>Nov-Dec</season>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>9</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <!--PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>.-->
    <volume>6</volume>
    <issue>6</issue>
    <elocation-id>e00697-21</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>10</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2021 Fouladi et al.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Fouladi et al.</copyright-holder>
      <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2021-11-09"/>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="msystems.00697-21.pdf"/>
    <abstract>
      <title>ABSTRACT</title>
      <p>16S rRNA gene sequencing is a common and cost-effective technique for characterization of microbial communities. Recent bioinformatics methods enable high-resolution detection of sequence variants of only one nucleotide difference. In this study, we utilized a very fast HashMap-based approach to detect sequence variants in six publicly available 16S rRNA gene data sets. We then use the normal distribution combined with locally estimated scatterplot smoothing (LOESS) regression to estimate background error rates as a function of sequencing depth for individual clusters of sequences. This method is computationally efficient and produces inference that yields sets of variants that are conservative and well supported by reference databases. We argue that this approach to inference is fast, simple, and scalable to large data sets and provides a high-resolution set of sequence variants which are less likely to be the result of sequencing error.</p>
      <p><bold>IMPORTANCE</bold> Recent bioinformatics development has enabled the detection of sequence variants with a high resolution of only one single-nucleotide difference in 16S rRNA gene sequence data. Despite this progress, there are several limitations that can be associated with variant calling pipelines, such as producing a large number of low-abundance sequence variants which need to be filtered out with arbitrary thresholds in downstream analyses or having a slow runtime. In this report, we introduce a fast and scalable algorithm which infers sequence variants based on the estimation of a normally distributed background error as a function of sequencing depth. Our pipeline has attractive performance characteristics, can be used independently or in parallel with other variant callers, and provides explicit <italic toggle="yes">P</italic> values for each variant evaluating the hypothesis that a variant is caused by sequencing error.</p>
    </abstract>
    <kwd-group>
      <title>KEYWORDS</title>
      <kwd>16S rRNA gene sequence variant</kwd>
      <kwd>microbiome</kwd>
      <kwd>sequence variant</kwd>
      <kwd>sequencing error</kwd>
    </kwd-group>
    <counts>
      <count count="3" count-type="supplementary-material"/>
      <fig-count count="8"/>
      <table-count count="1"/>
      <equation-count count="6"/>
      <ref-count count="19"/>
      <page-count count="14"/>
      <word-count count="7751"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>cover-date</meta-name>
        <meta-value>November/December 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>INTRODUCTION</title>
    <p>Amplicon sequencing is a popular and cost-effective method for investigating microbial communities. A challenging step in using amplicon sequencing to identify members of microbial communities is to infer true sequences from artifacts. Sequence errors commonly occur during both PCR amplification and DNA sequencing. These errors include single nucleotide substitutions and gap errors due to mismatching bases and polymerase slippage, respectively (<xref rid="B1" ref-type="bibr">1</xref>). For many years, standard practice was to lump sequences with 97% identity together into operational taxonomic units (OTUs) in order to reduce noise and cluster closely related taxa (<xref rid="B2" ref-type="bibr">2</xref><xref rid="B3" ref-type="bibr">–</xref><xref rid="B4" ref-type="bibr">4</xref>). However, recently developed bioinformatic tools attempt to infer true biological sequences at 100% identity by estimating the error profile and correcting point errors in sequences through denoising processes (<xref rid="B1" ref-type="bibr">1</xref>, <xref rid="B5" ref-type="bibr">5</xref>, <xref rid="B6" ref-type="bibr">6</xref>). These pipelines rely on different assumptions and implement various statistical models. For example, DADA2 models error rate as a function of quality scores for each possible nucleotide transition and then these error rates are used in a Poisson-based model to infer true sequences from sequence errors (<xref rid="B5" ref-type="bibr">5</xref>). Deblur compares sequence-to-sequence hamming distances to an upper-bound error model combined with a greedy algorithm (<xref rid="B6" ref-type="bibr">6</xref>). Unoise2 uses two parameters that are preset values and are used for filtering low-abundance sequencing and clustering of sequences based on their abundances (<xref rid="B1" ref-type="bibr">1</xref>). All of these algorithms provide a higher resolution of taxonomic composition of a microbial community than the traditional OTU picking approach.</p>
    <p>Despite the important progress that they represent, these algorithms all have some limitations. Deblur depends on construction of a multiple-sequence alignment, which means that it does not scale to an entire data set but works instead on each sample individually. This leads to the possibility of dependencies on the sequencing depth of each sample where variants might be called as real or artifactual differently in different samples depending on the properties of individual samples. Since Deblur sorts the abundance of sequences in each sample individually, it is also possible that the relative abundance of each variant within each sample can impact overall variant calling in complex ways. Deblur also has a number of free parameters and it is not immediately obvious how to optimize these parameters for new sequence data sets that might have different properties from the Illumina MiSeq and HiSeq training sets that were used for setting Deblur’s default values. Unoise2 is not freely available and also requires user setting of parameters for which optimal values may not be entirely clear. As we will show, DADA2 can sometimes in practice yield larger numbers of sequence variants than can be considered biologically reasonable and often requires additional filtration of low-abundance variants. Since DADA2 uses the Poisson distribution, it assumes that processes that control errors have similar rates for high- and low-abundance variants. These sorts of assumptions can be problematic in genomics. For example, in RNA sequencing (RNA-seq) analysis, it has long been understood that the relationship between mean and variance is dependent on sequencing depth (<xref rid="B7" ref-type="bibr">7</xref>).</p>
    <p>Here, we present HashSeq, a very simple and fast algorithm for inferring sequence variants. We demonstrate that with enough sequence depth, every possible unique one-mismatch variant for a sequence will be observed. We propose that the inference of true variants can therefore be determined relative to this background probability of observing one-mismatch variants, which can be approximated with a two-parameter normal distribution. We applied this method to six publicly available data sets and show that this simple approach is fast and scales well even to large data sets. Our approach provides a conservative set of variant calls that is well supported by a reference database and behaves almost identically to DADA2 calls in supervised classification.</p>
  </sec>
  <sec sec-type="results" id="s2">
    <title>RESULTS</title>
    <sec id="s2-1">
      <title>With sufficient sequencing depth, all one-mismatch “child” variants for a “parent” sequence are likely to be observed, and this is well modeled by a simple Poisson process.</title>
      <p>We used a HashMap data structure, which identifies every unique sequence in linear time proportion to the total number of sequences, to identify all sequence variants in six publicly available Illumina data sets. Sequences from these projects were obtained from three fecal microbiota data sets (the China, autism, and Roux-en-Y gastric bypass [RYGB] data sets), one vaginal microbiota data set, and one soil microbiota data set as well as one microbial mock community (MMC; see Materials and Methods). This method of sequence variant detection is very fast (less than 1 h even for the largest data set, with 416,450,026 sequences), but it results in a large number of sequence variants ranging from 6,166 for the smallest data set (mock community) to 814,494 for the largest data set (vaginal data set). The majority of these variants are presumably sequencing errors or other artifacts. In order to detect sequence errors, we clustered sequences that had only one nucleotide difference (<xref rid="fig1" ref-type="fig">Fig. 1</xref>). Under this approach, sequence variants were sorted according to their abundances. Starting with the most abundant sequence variant, considered the first “parent sequence,” clusters were formed by adding all the one-mismatch variants to each cluster (one-mismatch “children”). This resulted in 2,002 clusters of parents plus children (when present) for the smallest data set (MMC data set) and 387,903 clusters for the largest data set (vaginal data set). We assessed the relationship between the abundance of parents and the number of one-mismatch children present in each cluster. <xref rid="fig2" ref-type="fig">Figure 2</xref> shows the fraction of all possible one-mismatch children as a function of the abundance of each parent sequence for six data sets. When the abundance of a parent sequence is high enough, almost all possible unique one-mismatch children for that parent sequence can be observed (<xref rid="fig2" ref-type="fig">Fig. 2</xref>). For example, the read lengths for both the China and vaginal data sets are 250 bp; therefore, there are 750 possible one-nucleotide differences for a parent sequence in these data sets. For these data sets, the most abundant parent sequences have more than 10,000 reads and almost all of the possible child variants were observed (the rightmost points in <xref rid="fig2" ref-type="fig">Fig. 2</xref>). For the least abundant parent sequences (the leftmost points in <xref rid="fig2" ref-type="fig">Fig. 2</xref>), almost no one-mismatch variants were observed.</p>
      <fig position="float" id="fig1">
        <label>FIG 1</label>
        <caption>
          <p>Cluster formation of parents and their one-mismatch children in the HashSeq algorithm. In this clustering strategy, sequence variants are sorted according to their abundances. Starting with the most abundant sequence variant, considered the first parent sequence, clusters are formed by adding all the one-mismatch variants (one-mismatch children) to each cluster.</p>
        </caption>
        <graphic xlink:href="msystems.00697-21-f001" position="anchor"/>
      </fig>
      <fig position="float" id="fig2">
        <label>FIG 2</label>
        <caption>
          <p>The presence or absence of unique one-mismatch variants can be well modeled with a simple one-parameter Poisson distribution with an almost constant error rate across six independent 16S rRNA gene Illumina data sets. Plots show the relationship between the abundance of parent sequences on the log<sub>10</sub> scale and the fraction of all possible unique one-mismatch variants for the parent sequences. These data are well modeled by a simple one-parameter Poisson distribution. The red line corresponds to an error rate <italic toggle="yes">P</italic> of 10<sup>−4</sup>. The China, vaginal, and soil data sets were best modeled using slightly different error rates for each data set (green lines, China and soil <italic toggle="yes">P = </italic>1.5 × 10<sup>−4</sup> and soil <italic toggle="yes">P = </italic>5 × 10<sup>−5</sup>, respectively).</p>
        </caption>
        <graphic xlink:href="msystems.00697-21-f002" position="anchor"/>
      </fig>
      <p>Interestingly, these data were surprisingly well fit with a simple Poisson distribution with a single parameter across all data sets. The single parameter is the probability (<italic toggle="yes">P</italic>) that a single nucleotide will be different between two sequence variants (see Materials and Methods). Even though this model does not contain any information about different error rates for different nucleotides, or any information about the biology of any of these diverse ecosystems, all the data sets were reasonably well fit, with a <italic toggle="yes">P </italic>value of 10<sup>−4</sup> (<xref rid="fig2" ref-type="fig">Fig. 2</xref>, red curves), although for some data sets a slightly better fit could be obtained with a slightly different value for <italic toggle="yes">P</italic> (<xref rid="fig2" ref-type="fig">Fig. 2</xref>, green curves). The consistency of this fit across data sets is perhaps surprising given that not all the data sets used the same primers for PCR amplification as well as the wide biological variability of these samples extending from the vaginal to the gut and soil microbiomes. This analysis suggests that a common baseline error rate exists across multiple Illumina data sets and that the probability of seeing a one-mismatch variant is well modeled as a simple function of the abundance of the parent sequence. Our results demonstrate that with enough sequencing depth, every possible one-mismatch child is likely to be observed for all variants and in the absence of any other information, it is possible to predict the likelihood of seeing a unique child variant given only the abundance of the parent.</p>
    </sec>
    <sec id="s2-2">
      <title>The background Poisson distribution underestimates the true abundance of one-mismatch child variants, while a normal distribution-based model provides a better fit.</title>
      <p>Since we have demonstrated that one-mismatch variants accumulate as a simple function of sequencing depth, the challenge for all algorithms in finding sequence variants is to discriminate true variants from the many stochastically produced artifactual variants. One possible approach to this problem might be to use the estimated error rate derived from the presence or absence of one-mismatch variants (as described in the previous section) to predict the background abundance of sequence errors and consider variants “true” only if the abundance of sequence variants is significantly enhanced over the expected background noise. However, when we tried to use this background error rate as a threshold for determining true variants from artifacts using the Poisson test (see Materials and Methods), we rejected the null hypothesis that the sequence variant was due to random sequencing error for more than 83% of one-mismatch children even after correcting for multiple-hypothesis testing (see <xref rid="figS1" ref-type="supplementary-material">Fig. S1</xref> in the supplemental material). This suggests that the distribution of child abundance does not follow the Poisson distribution. Indeed, the Poisson distribution assumes that the mean equals the variance, and clearly this assumption does not hold, as the variance of child abundance shows clear overdispersion, that it is larger than the mean of child abundance for most parent sequence variants across data sets (<xref rid="fig3" ref-type="fig">Fig. 3</xref>). As a result, the Poisson distribution underestimates the true variance and is therefore anticonservative and calls nearly all one-mismatch variants as true variants.</p>
      <fig position="float" id="fig3">
        <label>FIG 3</label>
        <caption>
          <p>The variance of the one-mismatch child abundance in each cluster is not equal to their mean abundance. Plots show the relationship between the variance and mean abundance of one-mismatch children from each parent cluster across six different 16S rRNA gene data sets. The red line represents the Poisson assumption of equal mean and variance.</p>
        </caption>
        <graphic xlink:href="msystems.00697-21-f003" position="anchor"/>
      </fig>
      <supplementary-material position="float" id="figS1" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00697-21.1</object-id>
        <label>FIG S1</label>
        <p>The simple one-parameter Poisson model underestimates the abundance of sequence errors. Plots show the relationship between the abundance of parent sequences and the abundance of one-mismatch child sequences on the log<sub>10</sub> scale. The Poisson test with error rates estimated from the Poisson model (the best fit for each data set; green lines in <xref rid="fig1" ref-type="fig">Fig. 1</xref> in the main text) was used to test the null hypothesis that a one-mismatch child can be explained by sequencing error. Red and black dots indicate significant and insignificant <italic toggle="yes">P</italic> values, respectively, at a false-discovery rate (FDR) of 5%. Download <inline-supplementary-material id="fS1" xlink:href="msystems.00697-21-sf001.pdf" content-type="local-data">FIG S1, PDF file, 0.04 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2021 Fouladi et al.</copyright-statement>
          <copyright-year>2021</copyright-year>
          <copyright-holder>Fouladi et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2021-11-09"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
      <p>As we observed that the Poisson distribution appears to be extremely anticonservative, we next examined whether the distribution of one-mismatch children could be better explained by a normal distribution since it is more flexible in terms of the relationship between the mean and variance than the Poisson distribution. For this, the abundances of children were log<sub>10</sub> transformed and the distributions of log<sub>10</sub>-transformed abundances of children were plotted for each parent sequence. The histograms of child abundances (shown for the most abundant parent for each data set in <xref rid="fig4" ref-type="fig">Fig. 4</xref>) suggest that the distribution of one-mismatch children approximates a normal distribution. Interestingly, we observed that the mean abundance of children for each cluster can be well fit by a locally estimated scatterplot smoothing (LOESS) function of the parent abundance, especially for high-abundance parents (&gt;1,000 reads) across all the six data sets (<xref rid="fig5" ref-type="fig">Fig. 5</xref>). The smooth relationship between mean and standard deviation (SD) and sequencing depth across the six data sets suggests that there is a general error rate across all variants that is dependent on sequencing depth but not dependent on the biology of each particular parent sequence. This further suggests that the LOESS fit may represent a good model for general inference. However, when parents have a lower abundance, generally below 1,000 reads across all samples, a smaller number of one-mismatch variants are present (<xref rid="fig1" ref-type="fig">Fig. 1</xref>), and therefore, variance in the mean abundance of children significantly increases (<xref rid="fig5" ref-type="fig">Fig. 5</xref>), presumably due to sparsity effects.</p>
      <fig position="float" id="fig4">
        <label>FIG 4</label>
        <caption>
          <p>The abundance of one-mismatch children within a cluster is approximately normal on a log<sub>10</sub> scale. Histograms show the distribution of abundance of one-mismatch children for the most abundant parent on a log<sub>10</sub> scale across the six different 16S rRNA gene data sets.</p>
        </caption>
        <graphic xlink:href="msystems.00697-21-f004" position="anchor"/>
      </fig>
      <fig position="float" id="fig5">
        <label>FIG 5</label>
        <caption>
          <p>Mean and standard deviation of one-mismatch children in each cluster is a smooth function of their parent abundance on a log<sub>10</sub> scale for the most abundant parent sequences. Plots show the relationship between the mean and standard deviation of one-mismatch child abundance in each cluster and their parent abundance on a log<sub>10</sub> scale. The mean and standard deviation of abundance of one-mismatch children for each cluster can be well fit by a smooth LOESS function of the parent abundance especially for high-abundance parents (&gt;1,000 reads) across six different 16S rRNA gene data sets (red line).</p>
        </caption>
        <graphic xlink:href="msystems.00697-21-f005" position="anchor"/>
      </fig>
    </sec>
    <sec id="s2-3">
      <title>Normal-based inference of one-mismatch children is fast and conservative and produces results comparable to those of DADA2 in supervised classification analyses.</title>
      <p>The above results suggest that we can assume that the background distribution of child variants is reasonably normally distributed and is well fit for sequences with abundance &gt;∼1,000 reads by a simple localized regression (LOESS). In this section, we explore an inference scheme in which the background mean and standard deviation are the higher of the mean and the standard deviation found for each parent (black dots in <xref rid="fig5" ref-type="fig">Fig. 5</xref>) or the LOESS regression of the mean and standard deviation (red lines in <xref rid="fig5" ref-type="fig">Fig. 5</xref>). In this scheme, we use these estimates of mean and standard deviation as our background null hypothesis that the abundance of the one-mismatch child variant is a sequence error and can therefore be explained by the background level of sequencing error of the parent. From these background mean and standard deviation, we generate a one-sided <italic toggle="yes">P</italic> value (using “pnorm” in R) for rejecting the null hypothesis. A small <italic toggle="yes">P</italic> value for this null hypothesis indicates that a child variant has an abundance level above this expected background for its parent (see Materials and Methods).</p>
      <p>When using a 5% false-discovery rate (FDR), this method results in a considerably lower number of sequence variants than for DADA2 with default parameters for the nonmock biological data sets (<xref rid="tab1" ref-type="table">Table 1</xref>) and for the inference test based on the Poisson distribution described above (<xref rid="figS1" ref-type="supplementary-material">Fig. S1</xref>). When we mapped the inferred sequence variants with BLAST to the SILVA132 (<xref rid="B8" ref-type="bibr">8</xref>, <xref rid="B9" ref-type="bibr">9</xref>) database, the great majority of sequence variants had a high degree of identity (&gt;99%) to the SILVA database (<xref rid="tab1" ref-type="table">Table 1</xref> and <xref rid="fig6" ref-type="fig">Fig. 6</xref>), suggesting that many of the variants that we detected had been previously observed. This supports an assertion that these variants are not sequencing errors. Interestingly, although HashSeq calls more variants in the MMC data set than DADA2, the parent sequences include the eight bacterial taxa that are present in the mock (<named-content content-type="genus-species">Listeria monocytogenes</named-content>, <named-content content-type="genus-species">Pseudomonas aeruginosa</named-content>, <named-content content-type="genus-species">Bacillus subtilis</named-content>, <named-content content-type="genus-species">Escherichia coli</named-content>, <named-content content-type="genus-species">Salmonella enterica</named-content>, <named-content content-type="genus-species">Lactobacillus fermentum</named-content>, <named-content content-type="genus-species">Enterococcus faecalis</named-content>, and <named-content content-type="genus-species">Staphylococcus aureus</named-content>), which further confirms that our clustering strategy is able to find major taxa in a data set. Overall, these results suggest that our normal distribution-based inference approach is often more conservative than DADA2 and less prone to infer spurious variants as true sequences. However, because we do not look for variants in low-abundance regions where the LOESS regression does not show a consistent relationship to sequencing depth, our algorithm is less sensitive to low-abundance true sequences.</p>
      <fig position="float" id="fig6">
        <label>FIG 6</label>
        <caption>
          <p>Sequence variants generated by the HashSeq pipeline have a high degree of identity to the SILVA132 database. For each data set, the cumulative fraction of inferred sequence variants for a range of 90 to 100% identity to the SILVA132 database is plotted for both the HashSeq and DADA2 pipelines.</p>
        </caption>
        <graphic xlink:href="msystems.00697-21-f006" position="anchor"/>
      </fig>
      <table-wrap position="float" id="tab1">
        <label>TABLE 1</label>
        <caption>
          <p>Results of mapping of sequence variants inferred by HashSeq and DADA2 to the SILVA132 database using BLAST<xref rid="ngtab1-1" ref-type="table-fn"><sup><italic toggle="yes">a</italic></sup></xref></p>
        </caption>
        <alternatives>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="2" colspan="1">Data set</th>
                <th rowspan="2" colspan="1">Pipeline</th>
                <th rowspan="2" colspan="1">No. of SVs</th>
                <th rowspan="2" colspan="1">Parents-children</th>
                <th colspan="4" rowspan="1">Parents<hr/></th>
                <th colspan="4" rowspan="1">Children<hr/></th>
              </tr>
              <tr>
                <th rowspan="1" colspan="1">Identity = 100%</th>
                <th rowspan="1" colspan="1">100% &gt; <break/>identity <break/>≥ 99%</th>
                <th rowspan="1" colspan="1">99% &gt; <break/>identity <break/>≥ 97%</th>
                <th rowspan="1" colspan="1">97% &gt;<break/>identity</th>
                <th rowspan="1" colspan="1">Identity = 100%</th>
                <th rowspan="1" colspan="1">100% &gt; <break/>identity <break/>≥ 99%</th>
                <th rowspan="1" colspan="1">99% &gt; <break/>identity <break/>≥ 97%</th>
                <th rowspan="1" colspan="1">97% &gt;<break/>identity</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="2" colspan="1">China</td>
                <td rowspan="1" colspan="1">HashSeq</td>
                <td rowspan="1" colspan="1">451</td>
                <td rowspan="1" colspan="1">255-196</td>
                <td rowspan="1" colspan="1">194</td>
                <td rowspan="1" colspan="1">34</td>
                <td rowspan="1" colspan="1">21</td>
                <td rowspan="1" colspan="1">6</td>
                <td rowspan="1" colspan="1">67</td>
                <td rowspan="1" colspan="1">102</td>
                <td rowspan="1" colspan="1">23</td>
                <td rowspan="1" colspan="1">4</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">DADA2</td>
                <td rowspan="1" colspan="1">4,97</td>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1">1,050</td>
                <td rowspan="1" colspan="1">540</td>
                <td rowspan="1" colspan="1">400</td>
                <td rowspan="1" colspan="1">2,984</td>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td rowspan="2" colspan="1">RYGB</td>
                <td rowspan="1" colspan="1">HashSeq</td>
                <td rowspan="1" colspan="1">718</td>
                <td rowspan="1" colspan="1">402-316</td>
                <td rowspan="1" colspan="1">373</td>
                <td rowspan="1" colspan="1">21</td>
                <td rowspan="1" colspan="1">5</td>
                <td rowspan="1" colspan="1">3</td>
                <td rowspan="1" colspan="1">147</td>
                <td rowspan="1" colspan="1">169</td>
                <td rowspan="1" colspan="1">0</td>
                <td rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">DADA2</td>
                <td rowspan="1" colspan="1">3,385</td>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1">1,648</td>
                <td rowspan="1" colspan="1">966</td>
                <td rowspan="1" colspan="1">191</td>
                <td rowspan="1" colspan="1">580</td>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td rowspan="2" colspan="1">Autism</td>
                <td rowspan="1" colspan="1">HashSeq</td>
                <td rowspan="1" colspan="1">422</td>
                <td rowspan="1" colspan="1">229-193</td>
                <td rowspan="1" colspan="1">214</td>
                <td rowspan="1" colspan="1">8</td>
                <td rowspan="1" colspan="1">6</td>
                <td rowspan="1" colspan="1">1</td>
                <td rowspan="1" colspan="1">82</td>
                <td rowspan="1" colspan="1">101</td>
                <td rowspan="1" colspan="1">9</td>
                <td rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">DADA2</td>
                <td rowspan="1" colspan="1">2,398</td>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1">1,295</td>
                <td rowspan="1" colspan="1">493</td>
                <td rowspan="1" colspan="1">230</td>
                <td rowspan="1" colspan="1">385</td>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td rowspan="2" colspan="1">Vaginal</td>
                <td rowspan="1" colspan="1">HashSeq</td>
                <td rowspan="1" colspan="1">1,305</td>
                <td rowspan="1" colspan="1">530-775</td>
                <td rowspan="1" colspan="1">222</td>
                <td rowspan="1" colspan="1">191</td>
                <td rowspan="1" colspan="1">72</td>
                <td rowspan="1" colspan="1">45</td>
                <td rowspan="1" colspan="1">68</td>
                <td rowspan="1" colspan="1">400</td>
                <td rowspan="1" colspan="1">195</td>
                <td rowspan="1" colspan="1">112</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">DADA2</td>
                <td rowspan="1" colspan="1">12,106</td>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1">3,284</td>
                <td rowspan="1" colspan="1">4,335</td>
                <td rowspan="1" colspan="1">1,562</td>
                <td rowspan="1" colspan="1">2,925</td>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td rowspan="2" colspan="1">Soil</td>
                <td rowspan="1" colspan="1">HashSeq</td>
                <td rowspan="1" colspan="1">49</td>
                <td rowspan="1" colspan="1">39-10</td>
                <td rowspan="1" colspan="1">37</td>
                <td rowspan="1" colspan="1">1</td>
                <td rowspan="1" colspan="1">1</td>
                <td rowspan="1" colspan="1">0</td>
                <td rowspan="1" colspan="1">9</td>
                <td rowspan="1" colspan="1">1</td>
                <td rowspan="1" colspan="1">0</td>
                <td rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">DADA2</td>
                <td rowspan="1" colspan="1">5,761</td>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1">1,256</td>
                <td rowspan="1" colspan="1">1,387</td>
                <td rowspan="1" colspan="1">1,466</td>
                <td rowspan="1" colspan="1">1,652</td>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td rowspan="2" colspan="1">MMC</td>
                <td rowspan="1" colspan="1">HashSeq</td>
                <td rowspan="1" colspan="1">35</td>
                <td rowspan="1" colspan="1">9-26</td>
                <td rowspan="1" colspan="1">9</td>
                <td rowspan="1" colspan="1">0</td>
                <td rowspan="1" colspan="1">0</td>
                <td rowspan="1" colspan="1">0</td>
                <td rowspan="1" colspan="1">5</td>
                <td rowspan="1" colspan="1">21</td>
                <td rowspan="1" colspan="1">0</td>
                <td rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">DADA2</td>
                <td rowspan="1" colspan="1">26</td>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1">14</td>
                <td rowspan="1" colspan="1">8</td>
                <td rowspan="1" colspan="1">1</td>
                <td rowspan="1" colspan="1">3</td>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
              </tr>
            </tbody>
          </table>
          <graphic xlink:href="msystems.00697-21-t001" position="anchor"/>
        </alternatives>
        <table-wrap-foot>
          <fn fn-type="other" id="ngtab1-1">
            <label>a</label>
            <p>Shown are the numbers of sequence variants (SVs) inferred by DADA2 and HashSeq as well as the percent identity of the sequence variants to the SILVA132 database.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Next, for each data set we performed a random forest classification to study the association between the sequence variants with metadata variables of interest in the five publicly available nonmock data sets. Compared to DADA2, our approach performs nearly identically in terms of association studies between the gut microbiota and biological variables (<xref rid="fig7" ref-type="fig">Fig. 7</xref>).</p>
      <fig position="float" id="fig7">
        <label>FIG 7</label>
        <caption>
          <p>HashSeq performs almost identically to DADA2 in terms of association studies between the gut microbiota and biological variables. Random forest classification was used to study the association between the sequence variants with metadata variable of interest for five different 16S rRNA data sets. The areas under the curves (AUC) of the receiver operating characteristic (ROC) curves were essentially superimposable between our inference-based approach and DADA2. For the China data set, we examined if the gut microbiota can predict rural versus urban samples. For the RYGB data set, we tested if the gut microbiota can predict presurgical versus postsurgical samples. For the vaginal data set, we studied the association between the microbiota and ethnicity (black women versus white women). For the autism data set, we examined if the gut microbiota can predict children with autism versus the control group. For the soil data set, the association between the microbiota and two types of soil, Amazon Dark Earth (ADE) and agricultural soil (AGR), was examined.</p>
        </caption>
        <graphic xlink:href="msystems.00697-21-f007" position="anchor"/>
      </fig>
      <p>Finally, we compared runtime and memory usage between our pipeline and DADA2. On average across data sets, our pipeline is 43 times faster than for DADA2 and the memory usage is 3 times less than for DADA2 (<xref rid="fig8" ref-type="fig">Fig. 8</xref>). For the vaginal data set, the largest data set, HashSeq was 6.5 times faster than DADA2; however, it was comparable to DADA2 in terms of memory usage.</p>
      <fig position="float" id="fig8">
        <label>FIG 8</label>
        <caption>
          <p>HashSeq is faster and more efficient in memory usage than DADA2. Runtime and memory usage by DADA2 and HashSeq are plotted for each 16S rRNA gene data set.</p>
        </caption>
        <graphic xlink:href="msystems.00697-21-f008" position="anchor"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s3">
    <title>DISCUSSION</title>
    <p>In this study, we utilized a very simple HashMap-based algorithm to detect all sequence variants in a data set. This resulted unsurprisingly in a large number of one-mismatch sequence variants. We assume that nearly all these spurious sequences were caused by sequencing error. We provide two lines of evidence to support this assertion. First, the number of distinct one-mismatch children for each parent sequence can be well modeled by a simple Poisson process, suggesting that when sequence depth is high enough, every possible one-mismatch variant of a parent sequence can be observed. This seems unlikely to be explained by biological variance. A second line of support for the assertion that most variants are related to sequencing error is the excellent fit to a smooth LOESS curve with sequencing depth over 1,000 sequences (<xref rid="fig5" ref-type="fig">Fig. 5</xref>), suggesting that sequencing depth and not the biology of a particular cluster controls the abundances of observed variants.</p>
    <p>Given a postulate that nearly all sequence variants are the result of error, a natural approach is to use the background error rate for inference to detect the relatively rare occurrence of a variant that cannot be explained by background sequencing error. This approach of using a background rate to generate <italic toggle="yes">P</italic> values for an event that is reasonably uncommon has long been an approach to inference in genomics (<xref rid="B10" ref-type="bibr">10</xref>). A natural question is how to parametrize the expected background rate. Since we know that there is a dependency on sequencing depth, the simplest approach would be a Poisson-based model in which the mean equals the variance. However, the Poisson model failed to control the distribution of one-mismatch children in each cluster, presumably because the Poisson assumption of equal mean and variance was not met. In a similar way, previous studies have shown that when the Poisson distribution is used to test for differential gene expression in RNA-seq data sets, the Poisson-estimated variance is smaller than the observed variance in real data, resulting in increased false discoveries (<xref rid="B7" ref-type="bibr">7</xref>, <xref rid="B11" ref-type="bibr">11</xref>). Therefore, overdispersion (where variance is higher than mean) is a general feature of sequence count genomic data sets, including sequence variants, and this problem causes inference based on the Poisson distribution to fail.</p>
    <p>We therefore argued that inference of a true variant should utilize a model in which the variance was not constrained to equal the mean. Previous algorithms designed for RNA-seq data sets, such as DESeq and EdgeR, model count data with a negative binomial distribution which assumes that the variance is greater than the mean (<xref rid="B7" ref-type="bibr">7</xref>, <xref rid="B12" ref-type="bibr">12</xref>). We preferred the normal distribution over the negative binomial distribution to model the background error for two reasons. First, the negative binomial distribution is not defined when the variance is less than the mean, and although for the majority of sequence variants the variance is greater than the mean, there are still a large number of child sequences that have a mean greater than the variance (<xref rid="fig3" ref-type="fig">Fig. 3</xref>). Second, the negative binomial as a count model does not work on log-transformed data, which contain noninteger values. The normal distribution instead gives us more flexibility in terms of the relationship between the mean and variance as well as more naturally allowing for the transformation of count data. Regardless of the limitations of the negative binomial distribution, at high sequencing depth the negative binomial distribution is well approximated by the normal distribution, further justifying the use of the normal distribution.</p>
    <p>In order to use a normal distribution-based model to infer true sequences from the background noise, we used the mean and standard deviation predicted by a localized regression fit between mean and standard deviation and parent sequences (<xref rid="fig5" ref-type="fig">Fig. 5</xref>). In order to be as conservative as possible, we chose the mean and standard deviation for our inference test to be the higher of the mean and the standard deviation found for each parent directly or predicted by the LOESS regression. This conservative approach detected sequence variants that had a good match to existing variants in the SILVA database, suggesting that many of the variants that we detected had been previously observed and therefore are unlikely to be sequencing errors. This provides further confirmation of the conservative nature of our method.</p>
    <p>Our normal-distribution-based algorithm for detection of sequence variants, which we here call HashSeq, has a number of advantages. First, it is very fast and can detect sequence variants in less than 3 h on a single central processing unit (CPU) even for a very large data set. It can run all sequences in a data set together and does not require running sequences from each sample independently. This eliminates any potential problems in which the characteristics of individual samples impact overall variant calling in potentially complex ways. Second, our algorithm, compared to the popular algorithm DADA2, is fairly conservative and calls a lower number of sequence variants as true. The conservative nature of our method potentially increases the power of a study to detect a signal since fewer spurious variants are reported and therefore there will be a lower number of hypothesis to be corrected for in downstream analyses using FDR multiple-hypothesis correction. By determining where the smooth relationship between parent abundance and mean of child abundance breaks down, our algorithm offers a natural way to set a threshold for removing low-abundance variants. This was set at a parent abundance of 1,000 reads for all of our data sets except the largest one, where it was set to 10,000. Setting a low abundance threshold in this way is an appealing alternative to removing taxa based on arbitrary thresholds of rarity or prevalence. In addition, because our algorithm provides explicit <italic toggle="yes">P</italic> values for a null hypothesis that a child sequence was derived from sequencing error of a parent sequence, our results may be easier to interpret than algorithms that do not assign a score to variants or that assign scores based on arbitrary scales.</p>
    <p>Finally, our algorithm is simple and is based on a two-parameter model. In contrast, DADA2 assumes that each nucleotide transition has its own parameter which is calculated from the transition probabilities and quality scores. DADA2 assumes that the parameters obtained from quality scores are independent of sequencing depth, while our model explicitly considers background mean and variance as a function of sequencing depth. Despite these differences in parametrization, using our variants or DADA2 variants produces essential identical power for machine learning-based supervised classification.</p>
    <p>Our algorithm has some limitations to be noted. First, our algorithm is not sensitive to detect true low-abundance sequences. Therefore, we recommend using more sensitive algorithms, such as DADA2, to detect low-abundance sequence variants. Another limitation is that our algorithm does not consider two or more mismatches. However, we believe that one-mismatch errors are more likely to happen than two or more mismatches, and therefore, the abundances of two or more mismatches will reliably fall below the detection limit of the algorithm (usually &lt;1,000 reads). This assertion is supported by simulation results (<xref rid="figS2" ref-type="supplementary-material">Fig. S2</xref>) which suggest that variants with more than one mismatch error occur very infrequently in short reads. This assumption of the rarity of multiple-mismatch sequences, however, may not be appropriate for long-read technologies such as PacBio, and this is another potential limitation of our method. Finally, our algorithm does not explicitly model insertions or deletions (indels) and will treat indel events as a separate parent sequence. Users who need to capture indel variation in relationship to a parent might consider use of Deblur or other methods that incorporate multiple-sequence alignments. Our algorithm does not address issues of compositionality and the ways in which compositional artifacts might impact sequence variant calling. Compositionality is an important and appropriate topic for future research.</p>
    <supplementary-material position="float" id="figS2" content-type="local-data">
      <object-id pub-id-type="doi">10.1128/mSystems.00697-21.2</object-id>
      <label>FIG S2</label>
      <p>The fraction of all possible unique single mismatches for a sequence can be well fit to a Poisson model as well as simulated data. Black circles in the plot show the relationship between the abundance of parents on a log<sub>10</sub> scale and the fraction of all possible unique single mismatches that are observed for each parent sequence in the China data set. The red line shows the fraction of all possible single mismatches predicted by a one-parameter Poisson model that includes an error rate of 0.00015. The blue line shows the fraction of all possible single mismatches that are simulated from Java code (see Materials and Methods in the main text) with an error rate of 0.00015 for sequences with different sequence depths. Download <inline-supplementary-material id="fS2" xlink:href="msystems.00697-21-sf002.pdf" content-type="local-data">FIG S2, PDF file, 0.2 MB</inline-supplementary-material>.</p>
      <permissions>
        <copyright-statement>Copyright © 2021 Fouladi et al.</copyright-statement>
        <copyright-year>2021</copyright-year>
        <copyright-holder>Fouladi et al.</copyright-holder>
        <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2021-11-09"/>
        <license license-type="open-access">
          <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
          <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
        </license>
      </permissions>
    </supplementary-material>
    <p>Depending on the goals of the analysis, our algorithm can be run independently or in combination with other sequence variant callers such as DADA2 or Deblur. If the goal of an analysis is to find sequence variants that are associated with a particular experimental condition, our algorithm could be run independently and will produce a series of high-confidence variants which can be fed into statistical models to produce FDR-corrected <italic toggle="yes">P</italic> values. Different thresholds from our algorithm can be used to produce more or fewer variants, which allows users to trade off sensitivity for power in FDR-corrected hypothesis tests of each variant over the threshold. If the desired analysis is machine learning or supervised classification, our results suggest that our algorithm can give results very similar to those of DADA2 with reduced requirements for processing time and memory. A limitation of our algorithm is that it produces only one-off (single-nucleotide polymorphism [SNP]) variants. Combination with other OTU-picking algorithms will be required if users desire a broader clustering approach, with our algorithm used as a preprocessing step to perform initial one-off variant clustering for input into a final OTU-generating algorithm. Likewise, since our algorithm does not provide meaningful inference on low-abundance variants, if low-abundance taxa are of interest to a user, algorithms such as DADA2 are likely more appropriate.</p>
    <p>In summary, we have described HashSeq, a very simple and fast algorithm to infer true variants from background sequencing errors. This algorithm can be easily used for small or large 16S rRNA gene data sets generated from a diverse range of ecosystems. Source code is freely available at <ext-link xlink:href="https://github.com/FarnazFouladi/HashSeq" ext-link-type="uri">https://github.com/FarnazFouladi/HashSeq</ext-link> as an R package.</p>
  </sec>
  <sec sec-type="materials|methods" id="s4">
    <title>MATERIALS AND METHODS</title>
    <sec id="s4-1">
      <title>Publicly available data sets.</title>
      <p>Six data sets were included in this study: one publicly available microbial mock community (MMC) consisting of three samples (BioProject accession number <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJEB24409" ext-link-type="uri" assigning-authority="bioproject">PRJEB24409</ext-link>) and five publicly available 16S rRNA gene data sets, including three human gut microbiota data sets to which we refer as the China (<ext-link xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA349463" ext-link-type="uri" assigning-authority="bioproject">PRJNA349463</ext-link>; <italic toggle="yes">n</italic> = 80), autism (<ext-link xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA533120" ext-link-type="uri" assigning-authority="bioproject">PRJNA533120</ext-link>; <italic toggle="yes">n</italic> = 81), and Roux-en-Y gastric bypass (RYGB) (Sequence Read Archive [SRA] accession number <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/sra/SRP113514" ext-link-type="uri" assigning-authority="insdc.sra">SRP113514</ext-link>; <italic toggle="yes">n</italic> = 71) data sets, one vaginal microbiota data set (<ext-link xlink:href="https://www.ncbi.nlm.nih.gov/sra/SRP115697" ext-link-type="uri" assigning-authority="insdc.sra">SRP115697</ext-link>; <italic toggle="yes">n</italic> = 2,367), and one soil microbiota data set (<ext-link xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJEB14409" ext-link-type="uri" assigning-authority="bioproject">PRJEB14409</ext-link>; <italic toggle="yes">n</italic> = 40) (<xref rid="B13" ref-type="bibr">13</xref><xref rid="B14" ref-type="bibr">–</xref><xref rid="B18" ref-type="bibr">18</xref>). For all data sets except for the soil data set, forward and reverse reads were merged using the PEAR software (<xref rid="B19" ref-type="bibr">19</xref>), and the paired reads were then trimmed to a constant length and shorter reads were discarded (250 nucleotides for the China, vaginal, and MMC data sets, 200 nucleotides for the RYGB data set, and 151 nucleotides for the autism data set). For the soil data set, only forward reads were used, due to concerns about sequence quality for the reverse reads, and the reads were trimmed to 250 nucleotides. For the soil, RYGB, and MMC data sets, primers were present in the public sequences and were removed by our pipeline. Information regarding primers and the variable region of 16S rRNA gene that were sequenced can be found in <xref rid="tabS1" ref-type="supplementary-material">Table S1</xref>. For all data sets, singletons in each sample as well as sequences with N’s were removed.</p>
      <supplementary-material position="float" id="tabS1" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00697-21.3</object-id>
        <label>TABLE S1</label>
        <p>Data sets used in this study. The table includes the project numbers associated with each data set and the information regarding sequencing, including the sequencing instrument, the variable region in the 16S rRNA gene, and primers where available. Download <inline-supplementary-material id="tS1" xlink:href="msystems.00697-21-st001.docx" content-type="local-data">Table S1, DOCX file, 0.01 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2021 Fouladi et al.</copyright-statement>
          <copyright-year>2021</copyright-year>
          <copyright-holder>Fouladi et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2021-11-09"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
    </sec>
    <sec id="s4-2">
      <title>Cluster of sequences composed of a parent and one-mismatch children.</title>
      <p>We used a HashMap, a simple data structure, to detect all 16S rRNA gene sequence variants, excluding sequence variants with only one read in a sample (singletons). In our method, sequence variants are sorted according to their abundance. Starting with the most abundant sequence variant (considered a parent sequence), all possible one-mismatch sequence variants in the data set are identified and considered as the one-mismatch children for the parent sequence. Similar searches for parent and child sequences are performed for the remaining sequences until all sequences are assigned as a parent sequence or as a one-mismatch child sequence, resulting in the formation of numerous clusters of sequences that are composed of one parent and one-mismatch children (<xref rid="fig1" ref-type="fig">Fig. 1</xref>).</p>
    </sec>
    <sec id="s4-3">
      <title>Poisson model of frequency of one-match child variants.</title>
      <p>In order to estimate the rate of observing a one-mismatch sequence variant, we fit our data to a very simple model based on the Poisson distribution. This model has one free parameter which is the probability of a single-nucleotide sequencing error. In this approach, we treat each nucleotide within a set of parent and child sequence variants independently. Given the background error rate of <italic toggle="yes">P</italic> and a parent sequencing depth of P<sub>i</sub> (a parent belonging to the cluster i), the probability of seeing at least one error for a given nucleotide is given by
<disp-formula id="FD1"><label>(1)</label><alternatives><graphic xlink:href="msystems.00697-21-m001.jpg" position="float"/><mml:math id="m1" display="block" overflow="scroll"><mml:mrow><mml:mtext>1</mml:mtext><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mtext> dpois </mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mtext> P</mml:mtext></mml:mrow><mml:mtext>i</mml:mtext></mml:msub><mml:mo>×</mml:mo><mml:mi>P</mml:mi><mml:mo>/</mml:mo><mml:mtext>3</mml:mtext></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>“dpois” is an R programming function that calculates density for Poisson distribution. We divide <italic toggle="yes">P</italic> by 3 in the above equation because there are 3 possible distinct nucleotides that can be tabulated as an error (for example, an A base can be erroneously observed as either C, G, or T). If <italic toggle="yes">P</italic> is close to 1, we would expect to always see all three possible variants of the nucleotide, and if <italic toggle="yes">P</italic> is close to zero, we would expect to never see a mutation at that position in the sequence. We argue that we can fit <xref rid="FD1" ref-type="disp-formula">equation 1</xref> to our data sets by considering the fraction of all unique one-mismatch children observed for a parent sequence divided by the number of all possible one-mismatch children as shown in <xref rid="fig1" ref-type="fig">Fig. 1</xref> and described in Results. If <italic toggle="yes">P</italic> is high, then we would expect to see most of all the possible one-mismatch variants of a parent sequence, and if <italic toggle="yes">P</italic> is low, we would expect to see few.</p>
      <p>This model makes a number of simplifying assumptions. A key assumption is that the error rate <italic toggle="yes">P</italic> can be estimated independently for each nucleotide and that not considering sequences with more than one nucleotide difference between parent and children does not bias our error rate estimate. We think this is a reasonable assumption, as simulating a polymerase with the same error rate as the Poisson equation above and examining the resulting distribution of one-mismatch children observed from among all resulting sequences yields an essentially identical distribution as the Poisson equation above (the simulation code is available here at <ext-link xlink:href="https://github.com/afodor/metagenomicsTools/blob/master/src/binomFit/HowManyVariants.java" ext-link-type="uri">https://github.com/afodor/metagenomicsTools/blob/master/src/binomFit/HowManyVariants.java</ext-link>; see also <xref rid="figS2" ref-type="supplementary-material">Fig. S2</xref>). This concordance occurs because the overall error rate is low enough that sequences with more than one mismatch occur infrequently and can therefore be ignored without altering our baseline error rate estimate. For example, for a 250-bp sequence length with a <italic toggle="yes">P </italic>value of 0.00015 for error rate, sequences with more than one mismatch are seen only in about 1 of 1,600 sequences in our simulation code. Obviously, this assumption of independence of sequence variants that allows us to ignore sequences with multiple mismatches becomes more problematic for read lengths greater than the 250 bp that we examined in this study and for overall higher error rates.</p>
      <p>In addition, in order to see whether the estimated error rate derived from the presence or absence of one-mismatch variants using the above model can be used to predict the background abundance of sequence errors and therefore to infer true variants whose abundances are above the background noise, we used a Poisson test using “poisson.test” in R with the following parameters:
<disp-formula id="FD2"><label>(2)</label><alternatives><graphic xlink:href="msystems.00697-21-m002.jpg" position="float"/><mml:math id="m2" display="block" overflow="scroll"><mml:mrow><mml:mtext>Poisson</mml:mtext><mml:mo>.</mml:mo><mml:mtext>test </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mtext>ji</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mtext>P</mml:mtext><mml:mrow><mml:mtext>i</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>P</mml:mi><mml:mo>/</mml:mo><mml:mtext>3</mml:mtext><mml:mo>,</mml:mo><mml:mtext> alternative</mml:mtext><mml:mo>=</mml:mo><mml:mo>“</mml:mo><mml:mtext>greater</mml:mtext><mml:mo>”</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>where <italic toggle="yes">C</italic><sub>ji</sub> is the abundance of a jth child sequence of the cluster i, P<sub>i</sub> is the abundance of a parent sequence of the cluster i, and <italic toggle="yes">P</italic> is the estimated error rate from the Poisson model above (<xref rid="FD1" ref-type="disp-formula">equation 1</xref>). <italic toggle="yes">P</italic> values generated by the Poisson test (<xref rid="figS1" ref-type="supplementary-material">Fig. S1</xref>) were adjusted for multiple-hypothesis testing using the Benjamini-Hochberg procedure.</p>
    </sec>
    <sec id="s4-4">
      <title>Normal distribution of the background noise.</title>
      <p>As <xref rid="FD2" ref-type="disp-formula">equation 2</xref> based on the Poisson distribution underestimates the abundances of one-mismatch children (see Results), we further examined if the abundances of one-mismatch children can be better fit by the normal distribution. For this purpose, abundances of sequence variants were log<sub>10</sub> transformed and their histograms were plotted for each parent sequence. Next, the mean and standard deviation for each parent were calculated. The relationship between the mean abundance of children and the parent sequences as well as the standard deviation abundance of children and the parent sequences were fitted to a local regression, or locally estimated scatterplot smoothing (LOESS). We show that for parent sequences with depths above 1,000 reads, the LOESS regression is a reasonable fit for most data sets; however, for parents with depths below 1,000 reads, variance of the means and standard deviations is increased due to the sparsity of one-mismatch children, and therefore, the LOESS regression does not fit as well (<xref rid="fig5" ref-type="fig">Fig. 5</xref>). Therefore, as a default, sequence variants with total abundance of less than 1,000 across all samples are filtered (i.e., removed) in our pipeline. This threshold of 1,000 can be changed by users based on their data. For example, for the vaginal data set, we increased the threshold to 10,000, as the sequencing depth is significantly higher for this data set than for other data sets and the LOESS regression is a good fit when sequences have depths higher than 10,000 reads (<xref rid="fig5" ref-type="fig">Fig. 5</xref>).</p>
      <p>The means and standard deviations estimated from the LOESS regression were assumed to be the background noise, and therefore, any variant above this background noise would be called a true sequence variant. Based on this assumption, for each child variant, a one-sided <italic toggle="yes">P</italic> value was generated using the “pnom” function in R and the following formula:
<disp-formula id="FD3"><label>(3)</label><alternatives><graphic xlink:href="msystems.00697-21-m003.jpg" position="float"/><mml:math id="m3" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mtext>pnorm[log</mml:mtext></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mtext>ji</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mtext> lower</mml:mtext><mml:mo>.</mml:mo><mml:mtext>tail </mml:mtext><mml:mo>=</mml:mo><mml:mtext> FALSE</mml:mtext><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>M</mml:mi><mml:mtext>i</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>S</mml:mi><mml:mtext>i</mml:mtext></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="FD4"><label>(4)</label><alternatives><graphic xlink:href="msystems.00697-21-m004.jpg" position="float"/><mml:math id="m4" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mtext>i</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mtext>max </mml:mtext><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mtext>mean </mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mtext>i</mml:mtext></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> mean for LOESS fit</mml:mtext></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="FD5"><label>(5)</label><alternatives><graphic xlink:href="msystems.00697-21-m005.jpg" position="float"/><mml:math id="m5" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mtext>i</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mtext>maximum </mml:mtext><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mtext>SD </mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mtext>i</mml:mtext></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> SD for LOESS fit</mml:mtext></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>where <italic toggle="yes">C</italic><sub>ji</sub> is the abundance of jth child of cluster i and <italic toggle="yes">M</italic><sub>i</sub> and <italic toggle="yes">S</italic><sub>i</sub> are, respectively, the estimated mean and standard deviation (SD) of cluster i, which are the maximum of the mean and standard deviation predicted by the LOESS regression from the abundance of the parent sequence in cluster i and the mean and standard deviation estimated directly from the child abundance of cluster i (<xref rid="FD4" ref-type="disp-formula">equations 4</xref> and <xref rid="FD5" ref-type="disp-formula">5</xref>). Taking the maximum of the mean and standard deviation enables us to be more conservative, especially for low-abundance sequences where data become sparse and the LOESS fit is less reliable. <italic toggle="yes">P</italic> values generated by the “pnorm” test were adjusted for multiple-hypothesis testing using the Benjamini-Hochberg procedure. Corrected <italic toggle="yes">P</italic> values of less than 0.05 were considered significant, rejecting the null hypothesis that the variant child is a sequence error.</p>
    </sec>
    <sec id="s4-5">
      <title>Comparison to DADA2.</title>
      <p>We compared the performance of HashSeq to the performance of the DADA2 pipeline (<xref rid="B5" ref-type="bibr">5</xref>). For this purpose, reads for each data set were trimmed to the same length as discussed above. Trimming was performed with the function “filterAndTrim” in DADA2 with default parameters. Inference of sequence variants was performed as described in <ext-link xlink:href="https://benjjneb.github.io/dada2/bigdata.html" ext-link-type="uri">https://benjjneb.github.io/dada2/bigdata.html</ext-link> with default parameters. Filtering and inference were performed using separate scripts in order to better compare the run time and memory usage between the DADA2 algorithm and HashSeq.</p>
      <p>In order to compare DADA2 and our algorithm, we used “blastn” to map sequence variants inferred from both algorithms to the SILVA132 database. Percent identity was calculated as
<disp-formula id="FD6"><label>(6)</label><alternatives><graphic xlink:href="msystems.00697-21-m006.jpg" position="float"/><mml:math id="m6" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mtext>alignment length </mml:mtext><mml:mo>–</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtext>number of mismatches </mml:mtext><mml:mo>+</mml:mo><mml:mtext> gaps</mml:mtext></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mtext>maximum </mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtext>alignment length</mml:mtext><mml:mo>,</mml:mo><mml:mtext> sequence length</mml:mtext></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mtext>1</mml:mtext><mml:mn>00</mml:mn></mml:mrow></mml:math></alternatives></disp-formula>where “sequence length” is the known length of the query sequence and all other parameters were reported by BLAST. This formula penalizes both mismatches and gaps in either the sequence or the alignment. For each sequence variant, the first hit with the highest bit score with the database was selected.</p>
      <p>Finally, we compared DADA2 and our algorithm in terms of associations between the inferred sequence variants and the variable of interest in the metadata. For this purpose, we performed random forest classification for each algorithm and data set with four cross-validations and 10 repeats using RandomForestClassifier with 100 decision trees and RepeatedKFold methods from the Scikit-learn library in python 3.8.1.</p>
    </sec>
    <sec id="s4-6">
      <title>Data availability.</title>
      <p>Our pipeline is written in Java (JDK 1.8) and R (4.0.2) but can be installed as an R package and run from an R environment. Source code with instructions for installing HashSeq package can be found at <ext-link xlink:href="https://github.com/FarnazFouladi/HashSeq" ext-link-type="uri">https://github.com/FarnazFouladi/HashSeq</ext-link>. All codes and figures for the analyses of this manuscript can be found at <ext-link xlink:href="https://github.com/FarnazFouladi/HashSeq_Manuscript" ext-link-type="uri">https://github.com/FarnazFouladi/HashSeq_Manuscript</ext-link>.</p>
    </sec>
  </sec>
</body>
<back>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1</label>
      <mixed-citation publication-type="working-paper"><person-group person-group-type="author"><string-name><surname>Edgar</surname><given-names>RC</given-names></string-name></person-group>. <year>2016</year>. <article-title>UNOISE2: improved error-correction for Illumina 16S and ITS amplicon sequencing</article-title>. <source>bioRxiv</source> doi:<pub-id pub-id-type="doi">10.1101/081257</pub-id>.</mixed-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Edgar</surname><given-names>RC</given-names></string-name></person-group>. <year>2013</year>. <article-title>UPARSE: highly accurate OTU sequences from microbial amplicon reads</article-title>. <source>Nat Methods</source><volume>10</volume>:<fpage>996</fpage>–<lpage>998</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth.2604</pub-id>.<pub-id pub-id-type="pmid">23955772</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Caporaso</surname><given-names>JG</given-names></string-name>, <string-name><surname>Kuczynski</surname><given-names>J</given-names></string-name>, <string-name><surname>Stombaugh</surname><given-names>J</given-names></string-name>, <string-name><surname>Bittinger</surname><given-names>K</given-names></string-name>, <string-name><surname>Bushman</surname><given-names>FD</given-names></string-name>, <string-name><surname>Costello</surname><given-names>EK</given-names></string-name>, <string-name><surname>Fierer</surname><given-names>N</given-names></string-name>, <string-name><surname>Peña</surname><given-names>AG</given-names></string-name>, <string-name><surname>Goodrich</surname><given-names>JK</given-names></string-name>, <string-name><surname>Gordon</surname><given-names>JI</given-names></string-name>, <string-name><surname>Huttley</surname><given-names>GA</given-names></string-name>, <string-name><surname>Kelley</surname><given-names>ST</given-names></string-name>, <string-name><surname>Knights</surname><given-names>D</given-names></string-name>, <string-name><surname>Koenig</surname><given-names>JE</given-names></string-name>, <string-name><surname>Ley</surname><given-names>RE</given-names></string-name>, <string-name><surname>Lozupone</surname><given-names>CA</given-names></string-name>, <string-name><surname>McDonald</surname><given-names>D</given-names></string-name>, <string-name><surname>Muegge</surname><given-names>BD</given-names></string-name>, <string-name><surname>Pirrung</surname><given-names>M</given-names></string-name>, <string-name><surname>Reeder</surname><given-names>J</given-names></string-name>, <string-name><surname>Sevinsky</surname><given-names>JR</given-names></string-name>, <string-name><surname>Turnbaugh</surname><given-names>PJ</given-names></string-name>, <string-name><surname>Walters</surname><given-names>WA</given-names></string-name>, <string-name><surname>Widmann</surname><given-names>J</given-names></string-name>, <string-name><surname>Yatsunenko</surname><given-names>T</given-names></string-name>, <string-name><surname>Zaneveld</surname><given-names>J</given-names></string-name>, <string-name><surname>Knight</surname><given-names>R</given-names></string-name></person-group>. <year>2010</year>. <article-title>QIIME allows analysis of high-throughput community sequencing data</article-title>. <source>Nat Methods</source><volume>7</volume>:<fpage>335</fpage>–<lpage>336</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth.f.303</pub-id>.<pub-id pub-id-type="pmid">20383131</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schloss</surname><given-names>PD</given-names></string-name>, <string-name><surname>Westcott</surname><given-names>SL</given-names></string-name>, <string-name><surname>Ryabin</surname><given-names>T</given-names></string-name>, <string-name><surname>Hall</surname><given-names>JR</given-names></string-name>, <string-name><surname>Hartmann</surname><given-names>M</given-names></string-name>, <string-name><surname>Hollister</surname><given-names>EB</given-names></string-name>, <string-name><surname>Lesniewski</surname><given-names>RA</given-names></string-name>, <string-name><surname>Oakley</surname><given-names>BB</given-names></string-name>, <string-name><surname>Parks</surname><given-names>DH</given-names></string-name>, <string-name><surname>Robinson</surname><given-names>CJ</given-names></string-name>, <string-name><surname>Sahl</surname><given-names>JW</given-names></string-name>, <string-name><surname>Stres</surname><given-names>B</given-names></string-name>, <string-name><surname>Thallinger</surname><given-names>GG</given-names></string-name>, <string-name><surname>Van Horn</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Weber</surname><given-names>CF</given-names></string-name></person-group>. <year>2009</year>. <article-title>Introducing mothur: open-source, platform-independent, community-supported software for describing and comparing microbial communities</article-title>. <source>Appl Environ Microbiol</source><volume>75</volume>:<fpage>7537</fpage>–<lpage>7541</lpage>. doi:<pub-id pub-id-type="doi">10.1128/AEM.01541-09</pub-id>.<pub-id pub-id-type="pmid">19801464</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Callahan</surname><given-names>BJ</given-names></string-name>, <string-name><surname>McMurdie</surname><given-names>PJ</given-names></string-name>, <string-name><surname>Rosen</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Han</surname><given-names>AW</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Holmes</surname><given-names>SP</given-names></string-name></person-group>. <year>2016</year>. <article-title>DADA2: high-resolution sample inference from Illumina amplicon data</article-title>. <source>Nat Methods</source><volume>13</volume>:<fpage>581</fpage>–<lpage>583</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth.3869</pub-id>.<pub-id pub-id-type="pmid">27214047</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amir</surname><given-names>A</given-names></string-name>, <string-name><surname>McDonald</surname><given-names>D</given-names></string-name>, <string-name><surname>Navas-Molina</surname><given-names>JA</given-names></string-name>, <string-name><surname>Kopylova</surname><given-names>E</given-names></string-name>, <string-name><surname>Morton</surname><given-names>JT</given-names></string-name>, <string-name><surname>Zech Xu</surname><given-names>Z</given-names></string-name>, <string-name><surname>Kightley</surname><given-names>EP</given-names></string-name>, <string-name><surname>Thompson</surname><given-names>LR</given-names></string-name>, <string-name><surname>Hyde</surname><given-names>ER</given-names></string-name>, <string-name><surname>Gonzalez</surname><given-names>A</given-names></string-name>, <string-name><surname>Knight</surname><given-names>R</given-names></string-name></person-group>. <year>2017</year>. <article-title>Deblur rapidly resolves single-nucleotide community sequence patterns</article-title>. <source>mSystems</source><volume>2</volume>:<elocation-id>e00191-16</elocation-id>. doi:<pub-id pub-id-type="doi">10.1128/mSystems.00191-16</pub-id>.<pub-id pub-id-type="pmid">28289731</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Anders</surname><given-names>S</given-names></string-name>, <string-name><surname>Huber</surname><given-names>W</given-names></string-name></person-group>. <year>2010</year>. <article-title>Differential expression analysis for sequence count data</article-title>. <source>Genome Biol</source><volume>11</volume>:<fpage>R106</fpage>. doi:<pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id>.<pub-id pub-id-type="pmid">20979621</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Quast</surname><given-names>C</given-names></string-name>, <string-name><surname>Pruesse</surname><given-names>E</given-names></string-name>, <string-name><surname>Yilmaz</surname><given-names>P</given-names></string-name>, <string-name><surname>Gerken</surname><given-names>J</given-names></string-name>, <string-name><surname>Schweer</surname><given-names>T</given-names></string-name>, <string-name><surname>Yarza</surname><given-names>P</given-names></string-name>, <string-name><surname>Peplies</surname><given-names>J</given-names></string-name>, <string-name><surname>Glöckner</surname><given-names>FO</given-names></string-name></person-group>. <year>2013</year>. <article-title>The SILVA ribosomal RNA gene database project: improved data processing and web-based tools</article-title>. <source>Nucleic Acids Res</source><volume>41</volume>:<fpage>D590</fpage>–<lpage>D596</lpage>. doi:<pub-id pub-id-type="doi">10.1093/nar/gks1219</pub-id>.<pub-id pub-id-type="pmid">23193283</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yilmaz</surname><given-names>P</given-names></string-name>, <string-name><surname>Parfrey</surname><given-names>LW</given-names></string-name>, <string-name><surname>Yarza</surname><given-names>P</given-names></string-name>, <string-name><surname>Gerken</surname><given-names>J</given-names></string-name>, <string-name><surname>Pruesse</surname><given-names>E</given-names></string-name>, <string-name><surname>Quast</surname><given-names>C</given-names></string-name>, <string-name><surname>Schweer</surname><given-names>T</given-names></string-name>, <string-name><surname>Peplies</surname><given-names>J</given-names></string-name>, <string-name><surname>Ludwig</surname><given-names>W</given-names></string-name>, <string-name><surname>Glöckner</surname><given-names>FO</given-names></string-name></person-group>. <year>2014</year>. <article-title>The SILVA and “All-species Living Tree Project (LTP)” taxonomic frameworks</article-title>. <source>Nucleic Acids Res</source><volume>42</volume>:<fpage>D643</fpage>–<lpage>D648</lpage>. doi:<pub-id pub-id-type="doi">10.1093/nar/gkt1209</pub-id>.<pub-id pub-id-type="pmid">24293649</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fodor</surname><given-names>AA</given-names></string-name>, <string-name><surname>Tickle</surname><given-names>TL</given-names></string-name>, <string-name><surname>Richardson</surname><given-names>C</given-names></string-name></person-group>. <year>2007</year>. <article-title>Towards the uniform distribution of null P values on Affymetrix microarrays</article-title>. <source>Genome Biol</source><volume>8</volume>:<fpage>R69</fpage>. doi:<pub-id pub-id-type="doi">10.1186/gb-2007-8-5-r69</pub-id>.<pub-id pub-id-type="pmid">17472745</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>MD</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>GK</given-names></string-name></person-group>. <year>2007</year>. <article-title>Moderated statistical tests for assessing differences in tag abundance</article-title>. <source>Bioinformatics</source><volume>23</volume>:<fpage>2881</fpage>–<lpage>2887</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btm453</pub-id>.<pub-id pub-id-type="pmid">17881408</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>MD</given-names></string-name>, <string-name><surname>McCarthy</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>GK</given-names></string-name></person-group>. <year>2010</year>. <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source><volume>26</volume>:<fpage>139</fpage>–<lpage>140</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>.<pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Winglee</surname><given-names>K</given-names></string-name>, <string-name><surname>Howard</surname><given-names>AG</given-names></string-name>, <string-name><surname>Sha</surname><given-names>W</given-names></string-name>, <string-name><surname>Gharaibeh</surname><given-names>RZ</given-names></string-name>, <string-name><surname>Liu</surname><given-names>J</given-names></string-name>, <string-name><surname>Jin</surname><given-names>D</given-names></string-name>, <string-name><surname>Fodor</surname><given-names>AA</given-names></string-name>, <string-name><surname>Gordon-Larsen</surname><given-names>P</given-names></string-name></person-group>. <year>2017</year>. <article-title>Recent urbanization in China is correlated with a Westernized microbiome encoding increased virulence and antibiotic resistance genes</article-title>. <source>Microbiome</source><volume>5</volume>:<fpage>121</fpage>. doi:<pub-id pub-id-type="doi">10.1186/s40168-017-0338-7</pub-id>.<pub-id pub-id-type="pmid">28915922</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kang</surname><given-names>DW</given-names></string-name>, <string-name><surname>Park</surname><given-names>JG</given-names></string-name>, <string-name><surname>Ilhan</surname><given-names>ZE</given-names></string-name>, <string-name><surname>Wallstrom</surname><given-names>G</given-names></string-name>, <string-name><surname>Labaer</surname><given-names>J</given-names></string-name>, <string-name><surname>Adams</surname><given-names>JB</given-names></string-name>, <string-name><surname>Krajmalnik-Brown</surname><given-names>R</given-names></string-name></person-group>. <year>2013</year>. <article-title>Reduced incidence of Prevotella and other fermenters in intestinal microflora of autistic children</article-title>. <source>PLoS One</source><volume>8</volume>:<elocation-id>e68322</elocation-id>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0068322</pub-id>.<pub-id pub-id-type="pmid">23844187</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kang</surname><given-names>DW</given-names></string-name>, <string-name><surname>Ilhan</surname><given-names>ZE</given-names></string-name>, <string-name><surname>Isern</surname><given-names>NG</given-names></string-name>, <string-name><surname>Hoyt</surname><given-names>DW</given-names></string-name>, <string-name><surname>Howsmon</surname><given-names>DP</given-names></string-name>, <string-name><surname>Shaffer</surname><given-names>M</given-names></string-name>, <string-name><surname>Lozupone</surname><given-names>CA</given-names></string-name>, <string-name><surname>Hahn</surname><given-names>J</given-names></string-name>, <string-name><surname>Adams</surname><given-names>JB</given-names></string-name>, <string-name><surname>Krajmalnik-Brown</surname><given-names>R</given-names></string-name></person-group>. <year>2018</year>. <article-title>Differences in fecal microbial metabolites and microbiota of children with autism spectrum disorders</article-title>. <source>Anaerobe</source><volume>49</volume>:<fpage>121</fpage>–<lpage>131</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.anaerobe.2017.12.007</pub-id>.<pub-id pub-id-type="pmid">29274915</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Al Assal</surname><given-names>K</given-names></string-name>, <string-name><surname>Prifti</surname><given-names>E</given-names></string-name>, <string-name><surname>Belda</surname><given-names>E</given-names></string-name>, <string-name><surname>Sala</surname><given-names>P</given-names></string-name>, <string-name><surname>Clément</surname><given-names>K</given-names></string-name>, <string-name><surname>Dao</surname><given-names>MC</given-names></string-name>, <string-name><surname>Doré</surname><given-names>J</given-names></string-name>, <string-name><surname>Levenez</surname><given-names>F</given-names></string-name>, <string-name><surname>Taddei</surname><given-names>CR</given-names></string-name>, <string-name><surname>Fonseca</surname><given-names>DC</given-names></string-name>, <string-name><surname>Rocha</surname><given-names>IM</given-names></string-name>, <string-name><surname>Balmant</surname><given-names>BD</given-names></string-name>, <string-name><surname>Thomas</surname><given-names>AM</given-names></string-name>, <string-name><surname>Santo</surname><given-names>MA</given-names></string-name>, <string-name><surname>Dias-Neto</surname><given-names>E</given-names></string-name>, <string-name><surname>Setubal</surname><given-names>JC</given-names></string-name>, <string-name><surname>Zucker</surname><given-names>JD</given-names></string-name>, <string-name><surname>Belarmino</surname><given-names>G</given-names></string-name>, <string-name><surname>Torrinhas</surname><given-names>RS</given-names></string-name>, <string-name><surname>Waitzberg</surname><given-names>DL</given-names></string-name></person-group>. <year>2020</year>. <article-title>Gut microbiota profile of obese diabetic women submitted to Roux-en-Y gastric bypass and its association with food intake and postoperative diabetes remission</article-title>. <source>Nutrients</source><volume>12</volume>:<fpage>278</fpage>. doi:<pub-id pub-id-type="doi">10.3390/nu12020278</pub-id>.</mixed-citation>
    </ref>
    <ref id="B17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mendes</surname><given-names>LW</given-names></string-name>, <string-name><surname>Raaijmakers</surname><given-names>JM</given-names></string-name>, <string-name><surname>de Hollander</surname><given-names>M</given-names></string-name>, <string-name><surname>Mendes</surname><given-names>R</given-names></string-name>, <string-name><surname>Tsai</surname><given-names>SM</given-names></string-name></person-group>. <year>2018</year>. <article-title>Influence of resistance breeding in common bean on rhizosphere microbiome composition and function</article-title>. <source>ISME J</source><volume>12</volume>:<fpage>212</fpage>–<lpage>224</lpage>. doi:<pub-id pub-id-type="doi">10.1038/ismej.2017.158</pub-id>.<pub-id pub-id-type="pmid">29028000</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Callahan</surname><given-names>BJ</given-names></string-name>, <string-name><surname>DiGiulio</surname><given-names>DB</given-names></string-name>, <string-name><surname>Goltsman</surname><given-names>DSA</given-names></string-name>, <string-name><surname>Sun</surname><given-names>CL</given-names></string-name>, <string-name><surname>Costello</surname><given-names>EK</given-names></string-name>, <string-name><surname>Jeganathan</surname><given-names>P</given-names></string-name>, <string-name><surname>Biggio</surname><given-names>JR</given-names></string-name>, <string-name><surname>Wong</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Druzin</surname><given-names>ML</given-names></string-name>, <string-name><surname>Shaw</surname><given-names>GM</given-names></string-name>, <string-name><surname>Stevenson</surname><given-names>DK</given-names></string-name>, <string-name><surname>Holmes</surname><given-names>SP</given-names></string-name>, <string-name><surname>Relman</surname><given-names>DA</given-names></string-name></person-group>. <year>2017</year>. <article-title>Replication and refinement of a vaginal microbial signature of preterm birth in two racially distinct cohorts of US women</article-title>. <source>Proc Natl Acad Sci USA</source><volume>114</volume>:<fpage>9966</fpage>–<lpage>9971</lpage>. doi:<pub-id pub-id-type="doi">10.1073/pnas.1705899114</pub-id>.<pub-id pub-id-type="pmid">28847941</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>J</given-names></string-name>, <string-name><surname>Kobert</surname><given-names>K</given-names></string-name>, <string-name><surname>Flouri</surname><given-names>T</given-names></string-name>, <string-name><surname>Stamatakis</surname><given-names>A</given-names></string-name></person-group>. <year>2014</year>. <article-title>PEAR: a fast and accurate Illumina Paired-End reAd mergeR</article-title>. <source>Bioinformatics</source><volume>30</volume>:<fpage>614</fpage>–<lpage>620</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btt593</pub-id>.<pub-id pub-id-type="pmid">24142950</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
