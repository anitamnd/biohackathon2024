<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7430822</article-id>
    <article-id pub-id-type="pmid">32753029</article-id>
    <article-id pub-id-type="publisher-id">3700</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03700-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scTyper: a comprehensive pipeline for the cell typing analysis of single-cell RNA-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Choi</surname>
          <given-names>Ji-Hye</given-names>
        </name>
        <address>
          <email>jiheachoehihi@hanmail.net</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>In Kim</surname>
          <given-names>Hye</given-names>
        </name>
        <address>
          <email>hyeiny119@naver.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0916-893X</contrib-id>
        <name>
          <surname>Woo</surname>
          <given-names>Hyun Goo</given-names>
        </name>
        <address>
          <email>hg@ajou.ac.kr</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.251916.8</institution-id><institution-id institution-id-type="ISNI">0000 0004 0532 3933</institution-id><institution>Department of Physiology, </institution><institution>Ajou University School of Medicine, </institution></institution-wrap>164 Worldcup-ro, Yeongtong-gu, Suwon, 16499 Republic of Korea </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.251916.8</institution-id><institution-id institution-id-type="ISNI">0000 0004 0532 3933</institution-id><institution>Department of Biomedical Science, Graduate School, </institution><institution>Ajou University, </institution></institution-wrap>Suwon, Republic of Korea </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>4</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>342</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>1</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>7</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Recent advances in single-cell RNA sequencing (scRNA-seq) technology have enabled the identification of individual cell types, such as epithelial cells, immune cells, and fibroblasts, in tissue samples containing complex cell populations. Cell typing is one of the key challenges in scRNA-seq data analysis that is usually achieved by estimating the expression of cell marker genes. However, there is no standard practice for cell typing, often resulting in variable and inaccurate outcomes.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We have developed a comprehensive and user-friendly R-based scRNA-seq analysis and cell typing package, scTyper. scTyper also provides a database of cell type markers, scTyper.db, which contains 213 cell marker sets collected from literature. These marker sets include but are not limited to markers for malignant cells, cancer-associated fibroblasts, and tumor-infiltrating T cells. Additionally, scTyper provides three customized methods for estimating cell-type marker expression, including nearest template prediction (NTP), gene set enrichment analysis (GSEA), and average expression values. DNA copy number inference method (inferCNV) has been implemented with an improved modification that can be used for malignant cell typing. The package also supports the data preprocessing pipelines by Cell Ranger from 10X Genomics and the Seurat package. A summary reporting system is also implemented, which may facilitate users to perform reproducible analyses.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">scTyper provides a comprehensive and user-friendly analysis pipeline for cell typing of scRNA-seq data with a curated cell marker database, scTyper.db.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell RNA sequencing</kwd>
      <kwd>Cell typing</kwd>
      <kwd>Cell type marker database</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003725</institution-id>
            <institution>National Research Foundation of Korea</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2017M3A9B6061509</award-id>
        <award-id>2017M3C9A6047620</award-id>
        <award-id>2017R1E1A1A01074733</award-id>
        <award-id>2019R1A5A2026045</award-id>
        <principal-award-recipient>
          <name>
            <surname>Woo</surname>
            <given-names>Hyun Goo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par11">Single-cell RNA sequencing (scRNA-seq) technology has enabled researchers to profile transcriptomes at single-cell level [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. However, there are a number of challenges in the analysis of scRNA-seq data and its outcomes; one of the key challenges is the identification of cell types from the transcriptome data. Currently, various cell typing methods have been introduced using different workflows and data types [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. Cell typing by estimation of the expression level of cell marker genes is generally used by researchers for convenience. With time, enriched resources for cell type markers that have been generated from different sources, including single cell sequencing and experimental studies, are becoming available [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. Thus, cell typing using these inconsistent markers has become more time-consuming and an error-prone process. Thus far, there is no standard practice for cell typing and use of different cell markers and cell typing algorithms often results in inconsistent cell type assignment.</p>
    <p id="Par12">To overcome this issue, a collection of versatile cell markers from previous studies is needed for cell typing. In fact, there is a comprehensive cell marker database, CellMarker, which provides manually curated cell markers and their information [<xref ref-type="bibr" rid="CR9">9</xref>]. However, this database does not include the recent studies, especially on tumor tissues, even though many tumor-associated cells have been characterized recently [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR12">12</xref>].</p>
    <p id="Par13">In this study, we developed scTyper, an R package that provides a cell marker database, scTyper.db, as well as a flexible pipeline for cell typing analysis of scRNA-seq data with three different methods. Users can customize the cell typing pipeline and easily use the pre-collected cell marker databases.</p>
    <sec id="Sec2">
      <title>Implementation</title>
      <p id="Par14">scTyper is an R package that can be executed by a single command. Experienced users can customize the pipeline stepwise by manipulating the parameters. Besides the cell typing process, scTyper also supports pipelines for quality control and sequence alignment, which are performed by FASTQC (<ext-link ext-link-type="uri" xlink:href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc">https://www.bioinformatics.babraham.ac.uk/projects/fastqc</ext-link>) and Cell Ranger [<xref ref-type="bibr" rid="CR13">13</xref>], respectively. Data normalization, clustering, and visualization processes are also supported by the wrapper functions for ‘Seurat’ R package [<xref ref-type="bibr" rid="CR14">14</xref>].</p>
    </sec>
  </sec>
  <sec id="Sec3">
    <title>Results</title>
    <sec id="Sec4">
      <title>Overall workflow of scTyper</title>
      <p id="Par15">scTyper provides an automated and customizable pipeline for the cell typing of scRNA-seq data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). For user convenience, the package has been supported with raw data preprocessing pipelines by wrapper functions for FASTQC and Cell Ranger from 10X Genomics; the preprocessing includes quality control, sequence alignment and quantification of raw sequencing data. These processes can be executed by a single command. Data processing steps for log transformation, normalization, and clustering are performed by the wrapper functions for Seurat, generating a Seurat object that is used as an input file in the subsequent processes.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overall workflow of scTyper. A schematic diagram of the workflow of scTyper for scRNA seq-based cell typing</p></caption><graphic xlink:href="12859_2020_3700_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par16">After data processing, cell typing can be performed using the pre-pooled cell marker database, scTyper.db, and a previously reported cell marker database, CellMarker [<xref ref-type="bibr" rid="CR9">9</xref>]. Users can choose the cell markers of interest from these databases and apply them to subsequent cell typing. The expression of the cell marker sets can be estimated by three different methods, nearest template prediction (NTP) [<xref ref-type="bibr" rid="CR15">15</xref>], pre-ranked gene set enrichment analysis (GSEA) [<xref ref-type="bibr" rid="CR16">16</xref>], and average gene expression values. For malignant cell typing, users can utilize the inferred DNA copy numbers using the inferCNV R package with modifications [<xref ref-type="bibr" rid="CR17">17</xref>].</p>
      <p id="Par17">Overall, scTyper is comprised of the modularized processes of “QC”, “Cell Ranger”, “Seurat processing”, “cell typing”, and “malignant cell typing”. These processes can be customized by manipulating the parameters for each process. If users want to perform only the cell typing process and a preprocessed input file with Seurat object is already prepared, the processing steps of “QC”, “Cell Ranger” and “Seurat processing” can be skipped by setting the parameters “qc”, “run.cellranger” and “norm.seurat” to “FALSE”. The processes and their parameters implemented in scTyper are summarized in <bold>Supplementary Table</bold> <xref rid="MOESM1" ref-type="media"><bold>1</bold></xref> (more details can be found in the package manual).</p>
      <p id="Par18">Finally, the results and the executed processes are automatically documented as a report. The report summarizes the processing steps, cell typing and clustering results, and visualizes the results with plots.</p>
    </sec>
    <sec id="Sec5">
      <title>scTyper.db, a manually curated cell marker database</title>
      <p id="Par19">scTyper.db is pre-installed in the package that is comprised of manually curated 213 cell marker gene sets and the 121 cell types collected from 22 studies (<bold>Supplementary Table</bold> <xref rid="MOESM2" ref-type="media"><bold>2</bold></xref>). We collected the cell markers for cancer-associated fibroblasts (<italic>n</italic> = 21), tumor-infiltrated lymphocyte (<italic>n</italic> = 33), tumor-associated macrophage (<italic>n</italic> = 4), and malignant cells from different tissue types (<italic>n</italic> = 13) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a-b and <bold>Supplementary Table</bold> <xref rid="MOESM2" ref-type="media"><bold>2</bold></xref><bold>)</bold>. Immune repertoires of 149 immune cell markers were also included in the database. For example, there were 62 T cell marker sets with different cell transition states such as CD4+, CD8+, regulatory T, and exhausted T cells.
<fig id="Fig2"><label>Fig. 2</label><caption><p>The manually curated cell marker databases in scTyper. <bold>a.</bold> A pie plot shows the proportion of the tissue types in scTyper.db (<italic>left</italic>). A bar plot indicates the number of gene sets across tissue types in scTyper.db (<italic>right</italic>). Malignant (<italic>red</italic>) and non-malignant (<italic>blue</italic>) cell types are indicated with different colors. <bold>b.</bold> Pie plots show the proportion of the immune (<italic>left</italic>) and non-immune cell (<italic>right</italic>) markers implemented in scTyper.db. <bold>c.</bold> A pie plot shows the proportion of the tissue types in CellMarker (<italic>left</italic>). A bar plot indicates the number of gene sets across tissue types in CellMarker (<italic>right</italic>). Malignant (<italic>red</italic>) and non-malignant (<italic>blue</italic>) cell types are indicated with different colors</p></caption><graphic xlink:href="12859_2020_3700_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par20">We have used a unified nomenclature to label the marker gene sets in the database. For example, a cell marker label “Puram.2017.HNSCC.TME” was designated by concatenating the first author name of the publication (Puram), publication year (2017), tissue type/cancer type (HNSCC), and category of cell composition (TME, tumor microenvironment). Using this nomenclature, users can easily search the cell markers of interest. Detailed information about the cell markers such as data source, PubMed ID, species name, tissue type, study detail, etc. was also provided in the “extdata” directory. In addition to scTyper.db, we also implemented the previous, CellMarker database, which comprised 2867 cell type marker sets and 467 cell types from 1764 studies (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c and <bold>Supplementary Table</bold> <xref rid="MOESM2" ref-type="media"><bold>3</bold></xref>).</p>
    </sec>
    <sec id="Sec6">
      <title>Cell marker expression estimation and cell typing</title>
      <p id="Par21">In the current version of scTyper, three different methods are implemented to estimate the expression of cell marker sets, including NTP, pre-ranked GSEA, and average expression values (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). NTP is a class prediction method to estimate the proximity to the cell type templates by using a list of gene sets and calculating its distance to the test data [<xref ref-type="bibr" rid="CR18">18</xref>]. Enrichment score (ES) is calculated by the pre-ranked GSEA method (<ext-link ext-link-type="uri" xlink:href="https://www.gsea-msigdb.org/gsea/index.jsp">https://www.gsea-msigdb.org/gsea/index.jsp</ext-link>). Users can choose the level for cell typing from the options, “cell-level” or “cluster-level” by setting the value of the parameter “level” to “cell” or “cluster”, respectively.</p>
      <p id="Par22">For malignant cell typing, inferred DNA copy numbers are estimated by the inferCNV R package [<xref ref-type="bibr" rid="CR17">17</xref>] with an improved modification. The group of genes with same function can be located within their proximity on a chromosome, resulting in the construction of a gene cluster. These gene clusters can have similar expression levels and thus can be falsely inferred to have regional DNA copy number alteration. Therefore, we have added a gene filtering step in the inferCNV process to remove gene clusters from the inferCNV analysis.</p>
      <p id="Par23">Next, we benchmarked the performance of different cell typing methods implemented in scTyper using a test data set (GSE103322, 5902 cells from head and neck squamous cancer) [<xref ref-type="bibr" rid="CR18">18</xref>]. Cell typing was performed with 6 different parameters using all the 3 cell typing methods for comparison with or without the application of inferCNV. The cell markers of Puram.2017.HNSCC.TME were used. As expected, we observed that the cell types were assigned differently based on the methods applied (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). For instance, applying the inferCNV method could identify 529 additional malignant cells that were assigned to be non-malignant cells in the original Puram study (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, c). During inferCNV analysis, 5 gene clusters (including 180 genes) were filtered out; these were identified by performing gene set enrichment analysis of genes residing in the neighboring chromosomal regions (1 Mb) (<italic>P</italic> &lt; 0.05). These results show that the combined analysis of the cell marker expression and CNV inference is greatly helpful in appropriately interpreting the cell typing results.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Cell typing with different cell typing options in scTyper. <bold>a.</bold> A bar plot shows the proportion of cell type assignments by using the six methods according to the use of different cell typing methods (i.e., NTP, ES, and average values) and the inferCNV-based malignant cell typing. The results are also compared with that of the original study (Puram et al.). <bold>b.</bold> A heatmap shows the cell typing result with the gene expression levels of the 9 cell types of ‘Puram.2017.HNSCC.TME’. For each method, the assigned cell types are indicated by color bars (<italic>top</italic>). The inferred CNV values for each cell are shown (<italic>bottom</italic>). The cells with the CNV values greater than 90 percentile of the CNV values of immune cells were considered to have DNA copy number aberration and designated as malignant cells (red color bars). The malignant cells were assigned by cell typing methods (predicted as ‘Epithelial cell’) or CNV values (CNV values for reference cells &gt; Q90, i.e., 86.44). <bold>c.</bold> Venn diagrams show the overlapped counts of the malignant cells assigned by the three cell typing methods without (<italic>top</italic>) or with (<italic>bottom</italic>) inferCNV analysis. The cell type assignment from the original study (Puram et al.) is also compared</p></caption><graphic xlink:href="12859_2020_3700_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par24">In the performance test, cell typing of the test data (5902 cells) with NTP and inferCNV utilized 2.25 h of runtime under the computing environment of a single CPU core (Intel Xeon, 2.40 GHz) and 500 M RAM (<bold>Supplementary Fig.</bold> <xref rid="MOESM3" ref-type="media"><bold>1</bold></xref>). Most of the runtime was used by the inferCNV (1.43 h) and NTP (0.32 h) processes. We also tested a larger test set with 54,239 cells (in-house data), that utilized 20.63 h of runtime. Preprocessing steps for raw data (“QC” and “Cell Ranger”) were not included in the performance test. Parallel computation using multiple CPU cores (up to 20) could enhance the performance, improving the runtime to 0.47 h for 5902 cells and 5.47 h for 54,239 cells.</p>
      <p id="Par25">The scTyper generates an automatic report summary document (<xref rid="MOESM4" ref-type="media"><bold>Supplementary Data</bold></xref>); this document summarizes each step of the processes including the parameters used and the results of cell typing and clustering, and visualization plots (heatmaps and UMAP/t-SNE plots). This may help users reproduce their analysis workflows.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Discussion</title>
    <p id="Par26">In this study, we employed a comprehensive and flexible pipeline for cell typing of scRNA-seq data, by providing manually curated, pre-installed cell marker databases and three different cell typing methods. Customization or update of the cell marker database can be easily accomplished by replacing the ‘sigTyper.db.txt’ file in the “extdata” directory to a newer one. The package allows the users to use and compare different cell typing methods. The modularized design of the pipeline enables users to modify the pipeline at each step, will facilitating the appropriate interpretation of data.</p>
    <p id="Par27">scTyper has some limitations for implementation in the current version. The package does not include the cell typing methods that utilize reference scRNA-seq data instead of the cell markers [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. Divergent clustering and dimension reduction methods can be applied to the analysis pipeline, but the current version of scTyper only supports the functions provided by the “Seurat” package such as “PCA” or “UMAP/t-SNE”.</p>
  </sec>
  <sec id="Sec8">
    <title>Conclusions</title>
    <p id="Par28">We developed scTyper, a flexible and user-friendly pipeline for cell typing of scRNA-seq data. This package can help users to perform reproducible and comprehensive cell typing.</p>
    <sec id="Sec9">
      <title>Availability and requirements</title>
      <p id="Par29"><bold>Project name</bold>: scTyper.</p>
      <p id="Par30"><bold>Project home page</bold>: <ext-link ext-link-type="uri" xlink:href="https://github.com/omicsCore/scTyper">https://github.com/omicsCore/scTyper</ext-link></p>
      <p id="Par31"><bold>Operating system</bold>: Linux dependent.</p>
      <p id="Par32"><bold>Programming language</bold>: R.</p>
      <p id="Par33"><bold>Other requirements:</bold> R 3.5 or higher.</p>
      <p id="Par34"><bold>License</bold>: GPL2.</p>
      <p id="Par35"><bold>Any restrictions to use by non-academics:</bold> None.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec10">
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="12859_2020_3700_MOESM1_ESM.docx">
          <caption>
            <p><bold>Additional file 1: Supplementary Table 1.</bold> Parameters for scTyper.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2">
        <media xlink:href="12859_2020_3700_MOESM2_ESM.xlsx">
          <caption>
            <p><bold>Additional file 2: Supplementary Table 2–3.</bold> This file contains the list of cell markers in each of scTyper.db (Table S2) and CellMarker DB (Table S3) and detailed information such as identifier, study name, species, cell type, gene symbol, and PMID.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM3">
        <media xlink:href="12859_2020_3700_MOESM3_ESM.docx">
          <caption>
            <p><bold>Additional file 3: Supplementary Figure. 1.</bold> Runtime of scTyper according to CPU cores up to 20. A plot shows runtimes for cell typing pipeline of scTyper according to the CPU cores (up to 20). The “NTP” cell typing method and inferCNV were applied for the test.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM4">
        <media xlink:href="12859_2020_3700_MOESM4_ESM.html">
          <caption>
            <p><bold>Additional file 4: Supplementary Data.</bold> An example report summary document of scTyper.</p>
          </caption>
        </media>
      </supplementary-material>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>scRNA-seq</term>
        <def>
          <p id="Par4">Single-cell RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>NTP</term>
        <def>
          <p id="Par5">Nearest template prediction</p>
        </def>
      </def-item>
      <def-item>
        <term>GSEA</term>
        <def>
          <p id="Par6">Gene set enrichment analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>CNV</term>
        <def>
          <p id="Par7">Copy number variation</p>
        </def>
      </def-item>
      <def-item>
        <term>ES</term>
        <def>
          <p id="Par8">Enrichment scores</p>
        </def>
      </def-item>
      <def-item>
        <term>CAF</term>
        <def>
          <p id="Par9">Cancer associated fibroblast</p>
        </def>
      </def-item>
      <def-item>
        <term>TIL</term>
        <def>
          <p id="Par10">Tumor infiltrated lymphocyte</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Ji-Hye Choi and Hye In Kim contributed equally to this work.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-020-03700-5.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported by KREONET (Korea Research Environment Open NETwork) which was managed and operated by KISTI (Korea Institute of Science and Technology Information).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>JHC, HIK, and HGW developed the package and wrote the manuscript. HIK implemented reporting functions and wrote the package manual and the vignette for the package. HGW conducted overall study design and directed the study. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by grants from the National Research Foundation of Korea (NRF) funded by the Korea government (MSIP) (NRF-2017M3A9B6061509, NRF-2017M3C9A6047620, NRF-2017R1E1A1A01074733, NRF-2019R1A5A2026045). The funding body did not play any roles in the design of the study, collection, analysis, and interpretation of data, and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Source codes and a detailed manual are freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/omicsCore/scTyper">https://github.com/omicsCore/scTyper</ext-link></p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par36">Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par37">Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par38">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hwang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Bang</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA sequencing technologies and bioinformatics pipelines</article-title>
        <source>Exp Mol Med</source>
        <year>2018</year>
        <volume>50</volume>
        <issue>8</issue>
        <fpage>96</fpage>
        <?supplied-pmid 30089861?>
        <pub-id pub-id-type="pmid">30089861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdelaal</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Michielsen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cats</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hoogduin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mei</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Reinders</surname>
            <given-names>MJT</given-names>
          </name>
          <name>
            <surname>Mahfouz</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>194</fpage>
        <?supplied-pmid 31500660?>
        <pub-id pub-id-type="pmid">31500660</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Pliner HA, Shendure J. Supervised classification enables rapid annotation of cell atlases. Nat Methods. 2019;16(10):983–6.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Pellegrini</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>ACTINN: automated identification of cell types in single cell RNA sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>2</issue>
        <fpage>533</fpage>
        <lpage>538</lpage>
        <?supplied-pmid 31359028?>
        <pub-id pub-id-type="pmid">31359028</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alquicira-Hernandez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sathe</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Powell</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <article-title>scPred: accurate supervised method for cell-type classification from single-cell RNA-seq data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>264</fpage>
        <?supplied-pmid 31829268?>
        <pub-id pub-id-type="pmid">31829268</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Kim T, Lo K, Geddes TA, Kim HJ, JYH Y, Yang P. scReClassify: post hoc cell type classification of single-cell rNA-seq data.BMC Genomics. 2019;20(Suppl 9):913.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ceder</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Jansson</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Helczynski</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Abrahamsson</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Delta-like 1 (Dlk-1), a novel marker of prostate basal and candidate epithelial stem cells, is downregulated by notch signalling in intermediate/transit amplifying cells of the human prostate</article-title>
        <source>Eur Urol</source>
        <year>2008</year>
        <volume>54</volume>
        <issue>6</issue>
        <fpage>1344</fpage>
        <lpage>1353</lpage>
        <?supplied-pmid 18375047?>
        <pub-id pub-id-type="pmid">18375047</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>KW</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Wo</surname>
            <given-names>JY</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>IO</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Guan</surname>
            <given-names>XY</given-names>
          </name>
        </person-group>
        <article-title>Identification and characterization of tumorigenic liver cancer stem/progenitor cells</article-title>
        <source>Gastroenterology</source>
        <year>2007</year>
        <volume>132</volume>
        <issue>7</issue>
        <fpage>2542</fpage>
        <lpage>2556</lpage>
        <?supplied-pmid 17570225?>
        <pub-id pub-id-type="pmid">17570225</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Quan</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CellMarker: a manually curated resource of cell markers in human and mouse</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>D721</fpage>
        <lpage>d728</lpage>
        <?supplied-pmid 30289549?>
        <pub-id pub-id-type="pmid">30289549</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Costea</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Hills</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Osman</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Thurlow</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kalna</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Pena Murillo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Parajuli</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Suliman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kulasekara</surname>
            <given-names>KK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of two distinct carcinoma-associated fibroblast subtypes with differential tumor-promoting abilities in oral squamous cell carcinoma</article-title>
        <source>Cancer Res</source>
        <year>2013</year>
        <volume>73</volume>
        <issue>13</issue>
        <fpage>3888</fpage>
        <lpage>3901</lpage>
        <?supplied-pmid 23598279?>
        <pub-id pub-id-type="pmid">23598279</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Navab</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Strumpf</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bandarchi</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>CQ</given-names>
          </name>
          <name>
            <surname>Pintilie</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ramnarine</surname>
            <given-names>VR</given-names>
          </name>
          <name>
            <surname>Ibrahimov</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Radulovich</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Barczyk</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Prognostic gene-expression signature of carcinoma-associated fibroblasts in non-small cell lung cancer</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2011</year>
        <volume>108</volume>
        <issue>17</issue>
        <fpage>7160</fpage>
        <lpage>7165</lpage>
        <?supplied-pmid 21474781?>
        <pub-id pub-id-type="pmid">21474781</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Modak</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carotta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Haslinger</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kind</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Landscape and dynamics of single immune cells in hepatocellular carcinoma</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>179</volume>
        <issue>4</issue>
        <fpage>829</fpage>
        <lpage>845.e820</lpage>
        <?supplied-pmid 31675496?>
        <pub-id pub-id-type="pmid">31675496</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>GXY</given-names>
          </name>
          <name>
            <surname>Terry</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Belgrader</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ryvkin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bent</surname>
            <given-names>ZW</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ziraldo</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>McDermott</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>14049</fpage>
        <?supplied-pmid 28091601?>
        <pub-id pub-id-type="pmid">28091601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Farrell</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Gennert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Spatial reconstruction of single-cell gene expression data</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>5</issue>
        <fpage>495</fpage>
        <lpage>502</lpage>
        <?supplied-pmid 4430369?>
        <pub-id pub-id-type="pmid">25867923</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoshida</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Nearest template prediction: a single-sample-based flexible class prediction with confidence assessment</article-title>
        <source>PLoS One</source>
        <year>2010</year>
        <volume>5</volume>
        <issue>11</issue>
        <fpage>e15543</fpage>
        <?supplied-pmid 21124904?>
        <pub-id pub-id-type="pmid">21124904</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mootha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Gillette</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Paulovich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pomeroy</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2005</year>
        <volume>102</volume>
        <issue>43</issue>
        <fpage>15545</fpage>
        <lpage>15550</lpage>
        <?supplied-pmid 16199517?>
        <pub-id pub-id-type="pmid">16199517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patel</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Gillespie</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Wakimoto</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cahill</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Nahed</surname>
            <given-names>BV</given-names>
          </name>
          <name>
            <surname>Curry</surname>
            <given-names>WT</given-names>
          </name>
          <name>
            <surname>Martuza</surname>
            <given-names>RL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>344</volume>
        <issue>6190</issue>
        <fpage>1396</fpage>
        <lpage>1401</lpage>
        <?supplied-pmid 24925914?>
        <pub-id pub-id-type="pmid">24925914</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Puram S, Tirosh I, Parikh A, Patel A, Yizhak K, Gillespie S, Rodman C, Luo C, Mroz E, Emerick K, et al. Single-cell Transcriptomic analysis of primary and metastatic tumor ecosystems in head and neck Cancer. Cell. 2017;171.</mixed-citation>
    </ref>
  </ref-list>
</back>
