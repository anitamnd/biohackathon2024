<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9264648</article-id>
    <article-id pub-id-type="publisher-id">2716</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-022-02716-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scSTEM: clustering pseudotime ordered single-cell data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Song</surname>
          <given-names>Qi</given-names>
        </name>
        <address>
          <email>qisong@andrew.cmu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Jingtao</given-names>
        </name>
        <address>
          <email>jingtao.wang@mail.mcgill.ca</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3430-6051</contrib-id>
        <name>
          <surname>Bar-Joseph</surname>
          <given-names>Ziv</given-names>
        </name>
        <address>
          <email>zivbj@cs.cmu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.147455.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 2097 0344</institution-id><institution>Computational Biology Department, School of Computer Science, </institution><institution>Carnegie Mellon University, </institution></institution-wrap>Pittsburgh, PA 15213 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.14709.3b</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8649</institution-id><institution>Department of Medicine, Division of Experimental Medicine, </institution><institution>McGill University, </institution></institution-wrap>Montreal, QC Canada </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.147455.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 2097 0344</institution-id><institution>Machine Learning Department, School of Computer Science, </institution><institution>Carnegie Mellon University, </institution></institution-wrap>Pittsburgh, PA 15213 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>7</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>7</day>
      <month>7</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>150</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>11</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>6</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">We develop scSTEM, single-cell STEM, a method for clustering dynamic profiles of genes in trajectories inferred from pseudotime ordering of single-cell RNA-seq (scRNA-seq) data. scSTEM uses one of several metrics to summarize the expression of genes and assigns a <italic>p</italic>-value to clusters enabling the identification of significant profiles and comparison of profiles across different paths. Application of scSTEM to several scRNA-seq datasets demonstrates its usefulness and ability to improve downstream analysis of biological processes. scSTEM is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/alexQiSong/scSTEM">https://github.com/alexQiSong/scSTEM</ext-link>.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-022-02716-9.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single cell</kwd>
      <kwd>Genomics</kwd>
      <kwd>Gene clustering</kwd>
      <kwd>Visualization</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM122096</award-id>
        <award-id>OT2OD026682</award-id>
        <principal-award-recipient>
          <name>
            <surname>Bar-Joseph</surname>
            <given-names>Ziv</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Much attention in the analysis of single-cell data has focused on grouping cells to cell types or on modeling trajectories of cell development and differentiation [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Much less work in this area has focused on the analysis of genes within identified clusters or for a given path within reconstructed trajectories. Methods that have been developed for these tasks, including scLM [<xref ref-type="bibr" rid="CR3">3</xref>], and GPseudoClust [<xref ref-type="bibr" rid="CR4">4</xref>], have mainly focused on clustering genes within cell types and did not utilize dynamic information obtained from time series scRNA-Seq studies or from other trajectory inference methods.</p>
    <p id="Par3">A unique aspect of scRNA-Seq data is the ability to extract detailed dynamics even when using a small number, or a single, time point. Such analysis, which is often termed pseudotime ordering of cells results in a reconstructed trajectory of cells along a (usually small) number of branches and paths. An important question for the resulting trajectory is, What are the sets of expressed and repressed genes that are activated or repressed along a specific branch in the model and how different branches vary in such sets? This information can be very useful in determining the function or type of cells along a certain path [<xref ref-type="bibr" rid="CR5">5</xref>]. Moreover, comparing such clusters between two paths that split at a certain point in the pseudotime can help explain the differences that led to the separation and in some cases can be used to predict specific interventions that may affect cell fate decisions [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p id="Par4">While clustering of genes along paths is of interest, it is also challenging. As mentioned above, the number of branching points in an inferred trajectory is usually quite small [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. This means that genes in different paths often share parts of the paths and, assuming a constant rate change along a specific edge in the path, that the actual number of different values we can obtain for a gene along each of the paths is fairly small (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Thus, any clustering methods that would attempt to cluster pseudotime ordered data would have to account for the large overlap and the relatively small number of effective time points.<fig id="Fig1"><label>Fig. 1</label><caption><p>Flowchart of scSTEM pipeline. <bold>A</bold> The flowchart of scSTEM gene clustering. Colored solid circles represent cells mapped to different key segments of a trajectory tree. Aggregation of expressions are performed for each key segment. The resulted matrix (rows as genes and column as key segments) will be used as input for STEM to perform gene clustering. <bold>B</bold> Comparison function enables comparison of clustering results from different trajectory paths. This will identify clusters having similar genes but showing different/similar temporal expression patterns</p></caption><graphic xlink:href="13059_2022_2716_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par5">To provide such method that can be used to cluster pseudotime ordered data, we extended the Short Time-series Expression Miner (STEM) [<xref ref-type="bibr" rid="CR9">9</xref>] so that it can be applied to scRNA-Seq data. STEM was originally developed for short time series bulk data and employs a unique approach to identify significant clusters. Unlike most methods that are data driven, STEM pre-computes the set of all possible expression profiles. It then assigns genes to the pre-computed expression profiles and groups similar profiles to create clusters. By using a pre-defined set of profiles, STEM can assign significance to each cluster by comparing the enrichment of a profile to an enrichment of the same profile for randomized temporal data. Since STEM needs to account for all possible profiles, such method can only work for short time series datasets [<xref ref-type="bibr" rid="CR10">10</xref>]. STEM is the most widely used method for clustering time series bulk data, though until now was not able to cluster single-cell data.</p>
    <p id="Par6">Here, we extended STEM and developed scSTEM, which can use trajectory information from single-cell data to cluster genes. To perform such clustering, scSTEM first uses one of several pseudotime inference methods to construct a trajectory for a given scRNA-Seq data. Next, for every gene in every connected component in the analysis scSTEM generates summary time series data using several different approaches for each of the paths. This data is then used as input for STEM and clusters are determined for each path in the trajectory. Users can also compare STEM clusters between two trajectories in the same component to determine what are the differences in genes and biological processes that led to the divergence of these trajectories. We compared scSTEM to several other methods and show that scSTEM produced the best functional relevant clusters and scales well to large single-cell datasets. We have tested scSTEM on a number of datasets with different trajectory inference methods and gene summarization methods. As we show, scSTEM can correctly identify the key functional processes expected to be active along different paths. In addition, comparisons using scSTEM provide biological insights about the activity of different cell types, including clusters distinguishing between very similar cell types such as T cells and NK cells.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>scSTEM—clustering time series scRNA-Seq data</title>
      <p id="Par7">The overall idea for scSTEM is to cluster genes based on their temporal expression patterns along a given trajectory path. The clustering process starts with building a trajectory tree using expression count matrix, gene metadata, and cell metadata as input files. scSTEM can work with several trajectory inference methods including several popular methods (Monocle 3 [<xref ref-type="bibr" rid="CR11">11</xref>], Slingshot [<xref ref-type="bibr" rid="CR7">7</xref>], PAGA [<xref ref-type="bibr" rid="CR12">12</xref>], etc., see “<xref rid="Sec13" ref-type="sec">Methods</xref>”). For an input dataset, following trajectory inference a user can select one of the paths using the scSTEM GUI. scSTEM then uses one of the several metrics (“<xref rid="Sec13" ref-type="sec">Methods</xref>”) to summarize the expression profiles of genes along the selected path. These values, for each gene, are then used as inputs for STEM clustering. By using aggregated gene expressions along each path, scSTEM reduces the impact of noise and dropouts while still taking full advantage of scRNA-Seq data to identify many different trajectories within a time series dataset. The final output from scSTEM for each path includes (1) a table of enriched GO terms for each cluster, (2) a table of gene list and corresponding cluster assignments, and (3) a plot showing temporal gene expression profiles. Each profile represents a small set of genes with similar temporal pattern, and significant profiles are further grouped together to construct larger clusters. Figure <xref rid="Fig1" ref-type="fig">1</xref>A illustrates each key step of the scSTEM pipeline. Apart from clustering genes on each individual path, scSTEM also allows for comparison of clustering results between different paths (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B). This would match clusters having similar genes that may be expressed differently in different branches. In the following subsections, we will demonstrate application of scSTEM to a number of time series scRNA-seq data sets.</p>
    </sec>
    <sec id="Sec4">
      <title>Identification of functional gene clusters using scSTEM</title>
      <p id="Par8">We applied scSTEM to three scRNA-seq data sets: (1) human fetal immune cells [<xref ref-type="bibr" rid="CR13">13</xref>], (2) mouse embryonic blood cells [<xref ref-type="bibr" rid="CR11">11</xref>], (3) mouse embryonic neural crest cells [<xref ref-type="bibr" rid="CR11">11</xref>]. For each data set, we selected a subset of genes for our analysis. These genes can either be top-ranked cell-type-specific marker genes or highly variable genes. We have found that such filtering is important for trajectory inference and for scSTEM to produce meaningful and compact gene clusters (Additional File <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S1). We preprocessed the expression count matrix, cell metadata, and gene metadata as described in “<xref rid="Sec13" ref-type="sec">Methods</xref>”.</p>
      <sec id="Sec5">
        <title>Human fetal immune cells [<xref ref-type="bibr" rid="CR13">13</xref>]</title>
        <p id="Par9">In this study, researchers looked at fetus development and profiled cells from several different tissues over time. To focus on a specific biological process, we have analyzed the set of blood cells from this dataset (103,766 cells sampled at 18 time points). Cell type annotations provided in the original publication [<xref ref-type="bibr" rid="CR13">13</xref>] have identified several immune cell clusters within these blood cells including ILC3 cell, T cell, and NK cell cluster. We next used Monocle 3 and mean expression to perform scSTEM clustering analysis for the immune cell partition for this data set. Monocle 3 identified 7 paths, and scSTEM analysis of these resulted in several significant clusters (between 1 and 5 significant clusters per path, each with 35 ~ 301 gene) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>). These clusters successfully captured key properties of these cells and the genes activated during their development. As can be seen in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, cluster 0 in path 1 is associated with regulation of NK cell-mediated cytotoxicity (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B), while cluster 1 in path 5 and cluster 1 in path 4 are both associated with T cell activation and differentiation (Fig. <xref rid="Fig2" ref-type="fig">2</xref>C, <xref rid="Fig2" ref-type="fig">D</xref>). We have also tested other methods for pseudotime inference with this data and observed similar results. For example, the T cell activation and differentiation cluster and path were also captured by using Slingshot and mean expressions (Fig. <xref rid="Fig2" ref-type="fig">2</xref>C). Expressions of genes in significant clusters mostly show an increase in levels as cells transition along the trajectory enabling the identification of those genes that are likely associated with immune cell fates (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B–D). Using additional trajectory inference methods and other expression summarization methods leads to similar results as shown in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2 and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S3.<fig id="Fig2"><label>Fig. 2</label><caption><p>scSTEM results for human fetal immune cells. <bold>A</bold> UMAP visualization of human fetal immune data set. <bold>B</bold> scSTEM results for path 1 (NK cell-related path), with top 10 enriched GO terms (ranked by enrichment fold). <bold>C</bold> Comparison of scSTEM results between using Monocle3 and using Slingshot as trajectory inference method. The top 10 enriched GO terms have shown T cell-related activities. <bold>D</bold> scSTEM results and enriched GO terms for path 5, a T cell-related path. The top 10 enriched GO terms have shown T cell-related activities. Black curves indicate the trajectory tree, and the highlighted red curves are edges along one selected path. Yellow cells are cells mapped to the selected path and grey cells are other remaining cells</p></caption><graphic xlink:href="13059_2022_2716_Fig2_HTML" id="MO2"/></fig></p>
      </sec>
      <sec id="Sec6">
        <title>Mouse embryonic blood cells</title>
        <p id="Par10">This data set investigated gene expressions during early organogenesis of mouse embryo [<xref ref-type="bibr" rid="CR11">11</xref>]. In this analysis, we applied scSTEM to erythroid and white blood cells (42,262 cells sampled from 5 time points). We used the cell type annotations as given in the original publication [<xref ref-type="bibr" rid="CR11">11</xref>]. Although there is no clear separation of cell types in the 2D UMAP space, scSTEM was able to identify significant clusters consisting of immune development and immune response-related genes (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B, <xref rid="Fig3" ref-type="fig">C</xref>, interleukin-related terms and phagocytosis-related terms). Using Monocle3 and mean expressions, scSTEM has identified 6 paths each with between 1 and 5 significant clusters, and each path contains 52 ~ 401 genes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>). Interestingly, in contrast to the increased expressions of immune response-related clusters, cell development/immune system development-related clusters are characterized by decreased expression levels of genes assigned to these profiles (cluster 1 in Fig. <xref rid="Fig3" ref-type="fig">3</xref>B and cluster 1 of path 5 identified by Monocle 3 + mean expressions in Fig. <xref rid="Fig3" ref-type="fig">3</xref>C). This is likely the result of fixation of the terminal cell fate as time progresses which leads to repression of developmental programs in these cells. In contrast, as time progresses more and more, fate (immune)-related genes are expressed at higher levels as indicated by the profiles. Therefore, scSTEM can reveal functional gene clusters modulating different biological processes, as well as their temporal expression patterns. For this data set, we also applied PAGA and entropy reduction as additional trajectory inference method and additional gene summarization method and compared them to the Monocle 3 + mean expression results. As illustrated in Fig. <xref rid="Fig3" ref-type="fig">3</xref>C, PAGA and Monocle 3 have identified similar paths and clusters, showing increased immune response activity by mean expression and entropy reduction. Results for other trajectory inference methods can be found in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S4 and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S5.<fig id="Fig3"><label>Fig. 3</label><caption><p>scSTEM results for mouse embryonic blood cells and comparison for different trajectory inference methods and different gene summarization methods. <bold>A</bold> UMAP visualization of mouse embryonic blood cell data set. <bold>B</bold> scSTEM results for path 1, with top 10 enriched GO term (ranked by enrichment fold). <bold>C</bold> scSTEM results and the top 10 enriched GO terms for different trajectory inference methods and different gene summarization methods. Black curves indicate the trajectory tree, and the highlighted red curves are edges along one selected path. Yellow cells are cells mapped to the selected path and grey cells are other remaining cells</p></caption><graphic xlink:href="13059_2022_2716_Fig3_HTML" id="MO3"/></fig></p>
      </sec>
      <sec id="Sec7">
        <title>Mouse embryonic neural crest cells</title>
        <p id="Par11">Finally, we applied scSTEM with Monocle 3 and mean expression to neural crest cells in mouse embryo organogenesis data set (22,283 cells sampled from 5 time points). scSTEM has identified 12 paths with 1 ~ 6 significant clusters (Additional file <xref rid="MOESM1" ref-type="media">1</xref>). Several of the significant clusters identified by scSTEM are related to neuron development (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B, <xref rid="Fig4" ref-type="fig">C</xref>, <xref rid="Fig4" ref-type="fig">E</xref>), and these clusters can be used to identify new genes associated with these functions. Note that these clusters showed diverse expression patterns. For example, cluster 1 in path 2 (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B) and cluster 1 in path 7 (Fig. <xref rid="Fig4" ref-type="fig">4</xref>E) show decreased expressions for neuron/axon development-related genes, while cluster 1 in path 5 (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C) represents increased expressions for neuron/axon development. This suggests the same functional module may drive cells towards different terminal fates through modulation of gene expressions. Results for additional trajectory inference and gene summarization methods can be found in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S6 and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S7.<fig id="Fig4"><label>Fig. 4</label><caption><p>scSTEM results for mouse embryonic neural crest cells. <bold>A</bold> UMAP visualization of mouse embryonic neural crest cell data set. <bold>B–D</bold> scSTEM results and the top 10 enriched GO terms (ranked by enrichment fold) for clusters in different trajectory paths. Black curves indicate the trajectory tree, and the highlighted red curves are edges along one selected path. Yellow cells are cells mapped to the selected path and grey cells are other remaining cells</p></caption><graphic xlink:href="13059_2022_2716_Fig4_HTML" id="MO4"/></fig></p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>scSTEM can characterize functional role of unannotated cell clusters</title>
      <p id="Par12">One challenge users may face is to determine the functional role of cell cluster when cell type annotation is not available. Here, we demonstrate that scSTEM is able to characterize the functional role of unannotated cells in the human fetal immune cell data set [<xref ref-type="bibr" rid="CR13">13</xref>]. We applied scSTEM to the largest unannotated cell cluster and its adjacent cluster in spleen tissue using Monocle 3 + mean expression. In the original publication, the authors did not identify a specific cell type for these cells but marked this cluster based on its highly expressed genes STC2 and TLX1. We therefore used “STC2_TLX1” to label this cell cluster. This cell cluster may represent progression from an unknown cell type towards stromal cell (Additional File <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S8 A B). The results showed that scSTEM has identified cluster0 in path3 as significant. This cluster is characterized by a strong decline in expressions, which may signify its role during the cell transition. GO analysis further revealed that cluster 0 is likely to associate with “antigen processing and presentation of endogenous antigen” (corrected <italic>p</italic>-value = 0.004, Additional File <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S8 C). The discussions in the supplementary materials of human fetal immune cell data set paper [<xref ref-type="bibr" rid="CR13">13</xref>] suggested this STC2_TLX1 cell cluster may relate to mesenchymal precursors or stem cells. These cells have been reported to activate antigen presentation [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>]. Although the true cell type of STC2_TLX1 cell cluster remains undetermined, scSTEM analysis may help to annotate this unknown set of cells based on the profiles and function of the clusters.</p>
    </sec>
    <sec id="Sec9">
      <title>Comparison of functional gene clusters using scSTEM</title>
      <p id="Par13">In addition to clusters of expressed or repressed genes within specific paths, an important biological question is the identification of differentially activated pathways and program between different conditions, cell types, and developmental stages. For example, an important question in single-cell analysis is determining the reasons for a branching point in which some cells continue to one fate whereas others continue to another. A possible way to address this is to compare the expression of significant clusters between two paths in a trajectory to determine if the same set of genes display significantly different expression patterns following the branching point. scSTEM can be used to identify such differences between two cluster sets by identifying significant intersections in genes assigned to profiles in two different paths (“<xref rid="Sec13" ref-type="sec">Methods</xref>”).</p>
      <p id="Par14">We performed the comparative analysis using human fetal immune cell data set to compare the clustering results related to the two very similar cell populations, T cells and NK cells. By using Monocle 3 + mean expressions, we have identified clusters with similar genes that showed discrepant expression patterns in different paths. As can be seen Fig. <xref rid="Fig5" ref-type="fig">5</xref>A, path 2 is related to progression towards NK cells while path 6 and path 7 are related to progression towards T cells. These two cell types are fairly similar, and identification of the specific program that differs between them is of interest. scSTEM identified that genes assigned to Cluster 0 in path 2 (C0P2, 301 genes) significantly overlap genes assigned to cluster 2 in path 7 (C2P7, 124 genes) and cluster 2 in path 6 (C2P6, 56 genes). See Additional file <xref rid="MOESM3" ref-type="media">3</xref> for genes assigned to the clusters in each path. Genes in C0P2 display elevated expressions (See Additional File <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S9 for detailed visualizations of gene profiles and clusters) along NK cell developmental path, and GO enrichment analysis indicates that these genes are significantly associated with NK cell cytotoxicity (Fig. <xref rid="Fig5" ref-type="fig">5</xref>C and Additional file <xref rid="MOESM4" ref-type="media">4</xref>). In contrast, for the T cell path, the same genes are assigned to C2P7 and C2P6 which display increased expressions at the beginning (shared part of the path) but decreased expressions later when the T cell fate is achieved. Interestingly, many of the genes in C0P2 are known NK markers (14 genes, hypergeometric test, <italic>p</italic>-value &lt; 0.001). These markers include SAMD3, a signal transducer protein that has been reported to have reduced expressions in T cells [<xref ref-type="bibr" rid="CR16">16</xref>]. GZMM and GZMA were also included in the C0P2 cluster. These are granzymes that mediate targeted cell death through NK cells [<xref ref-type="bibr" rid="CR17">17</xref>]. GZMM is reported to be primarily expressed in NK cells and has shown reduced expressions in other innate T cells [<xref ref-type="bibr" rid="CR17">17</xref>]. Although GZMA has been reported to be expressed both in T cells and NK cells, the observed expression patterns may indicate that GZMA has a stronger role in NK cells, which is less characterized in previous studies. Thus, by identifying differential expression patterns for significant clusters, scSTEM was able to zero in on some of the key NK-specific genes and show that their expression indeed differs in T cells.<fig id="Fig5"><label>Fig. 5</label><caption><p>Comparison of functional gene clusters in human fetal immune cell data set. <bold>A</bold> The Comparison for clustering results between NK cell path and T cell paths. Each row on the left side represents one scSTEM cluster from path 2 (NK cell path), which significantly overlapped with each cluster shown on the right side (clusters from T cell path). Highlighted clusters are the ones significantly enriched for NK cell markers in each path. Black curves indicate the trajectory tree, and the highlighted red curves are edges along one selected path. Yellow cells are cells mapped to the selected path and grey cells are other remaining cells. <bold>B</bold> Differentiation of T cells and NK cells. <bold>C</bold> The top 10 enriched GO terms for path 2 (NK cell path, ranked by enrichment fold), cluster 0 (highlighted in <bold>A</bold>)</p></caption><graphic xlink:href="13059_2022_2716_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par15">To further validate the role of the genes, we compared all three clusters to 80 available human NK cell expression markers [<xref ref-type="bibr" rid="CR18">18</xref>] (<ext-link ext-link-type="uri" xlink:href="https://www.panglaodb.se/markers.html?cell_type=%27NK%20cells%27">https://www.panglaodb.se/markers.html?cell_type=%27NK%20cells%27</ext-link>). We performed hypergeometric test and used all protein coding genes (19,965 genes) in GRCh38 genome [<xref ref-type="bibr" rid="CR19">19</xref>] as background. The results showed that C0P2 has 14 NK cell markers (<italic>p</italic>-value &lt; 0.001) and C2P7 has 4 NK cell markers (<italic>p</italic>-value &lt; 0.001) and no NK cell markers were found in C2P6. The comparison between C0P2 and C2P7 is consistent with the expectation that NK cell marker genes showed increased expression early in the common developmental path between NK cells and T cells (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A, <xref rid="Fig5" ref-type="fig">B</xref>) but later in the more differentiated NK cell-specific path and T cell-specific path, these genes showed drastically different expression patterns, possibly leading to different cell fates. The above analysis used all protein coding genes as background for hypergeometric test. We have also performed a stricter analysis in which we compared scSTEM significant clusters to the subset of 3000 genes which passed the initial filtering. For this analysis, we still observed a significant enrichment of NK cell markers for C0P2 (<italic>p</italic>-value = 0.012) though the enrichment for C2P7 was not significant (<italic>p</italic>-value = 0.240) when using this reduced background.</p>
    </sec>
    <sec id="Sec10">
      <title>Comparison with previous clustering methods</title>
      <p id="Par16">To further evaluate the clusters identified by scSTEM, we compared scSTEM clustering results to a number of other single-cell gene clustering methods (scHOT [<xref ref-type="bibr" rid="CR20">20</xref>] and tradeSeq [<xref ref-type="bibr" rid="CR5">5</xref>]). Since a common workflow for single-cell analysis is to first identify differentially expressed (DE) genes and then perform GO enrichment analysis based on rankings by <italic>p</italic>-values from DE analysis, we have also compared our pipeline to two single-cell DE methods (Monocle 3 and tradeSeq [<xref ref-type="bibr" rid="CR5">5</xref>]). In this analysis, we focused on the NK cell-related path in human fetal immune cell data set [<xref ref-type="bibr" rid="CR13">13</xref>] (3000 genes and 4058 cells). Since there is no standard metric for comparing gene clustering results, we used NK gene ratio to evaluate the results (number of genes annotated with natural-killer-cell-related functions divided by cluster size or DE gene number). Results show that scSTEM achieved the best functional relevance, with highest NK gene ratio among all methods (5.98% for scSTEM, 0% for scHOT, 3.39% for Monocle 3, 3.72% for tradeSeq in DE analysis, and 0% for tradeSeq in clustering analysis). See Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S10 A B for complete results. As for computation efficiency, scSTEM is the second-fastest method among all methods (16 s for Monocle3, 60 s for scSTEM, &gt; 10,000 s for tradeSeq and &gt; 40,000 s for scHOT). Additionally, scSTEM only produced two significant clusters, as compared to 66 clusters from tradeSeq and 6 clusters from scHOT, which may make the clustering results easier to interpret. To evaluate whether scSTEM can capture underlying biological signals from DE genes, we generated synthetic scRNA-seq datasets with simulated DE genes. (See Additional File <xref rid="MOESM2" ref-type="media">2</xref>: Supplementary Note for results).</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Discussion</title>
    <p id="Par17">Several methods have been developed to reconstruct trajectories using single-cell data. To enable downstream analysis of the resulting trajectories and the clustering of genes along paths in each trajectory, we extended the STEM method and developed scSTEM. scSTEM retains much of the features that made STEM a big success in bulk time series analysis. Specifically, scSTEM is able to assign significance to profiles and to group similar profiles to form clusters. Since the clusters are not data driven, scSTEM also allows the ability to compare clusters between trajectories to infer key differences that may indicate which biological processes or functions leading to the observed branching in the inferred trajectory.</p>
    <p id="Par18">To enable the use of single-cell data in STEM, we combined it with several popular pseudotime inference methods. Users can choose one of these methods to infer trajectories and then perform scSTEM analysis on the resulting paths. scSTEM provides a number of options for users for summarizing genes along an edge in the path. The first is mean expression which works well for cases where the expression of genes along a specific path is expected to be homogeneous (for example, in cases where the data is sampled at a high rate and so there are only small differences between cells on the same path). Rate change may be a useful metric for cases where cells are expected to change along a path in a predictable way (for example during development, some pathways are expected to be steadily increasing whereas others decreasing). Finally, entropy can be used for cases where little is known about the underlying molecular activity in each path.</p>
    <p id="Par19">Once the user selects a trajectory inference and gene summarization method, scSTEM clusters cells along each path. These clusters are easy to interpret and are represented by cluster plots in which the trend of expressions corresponds to the progression of cell fates along each specific trajectory path. Gene clustering of each path is fast (less than 30 s for each trajectory path analyzed in this study), making it possible to cluster thousands of genes from many cells without the need to limit clustering to only a few hundred of genes as in [<xref ref-type="bibr" rid="CR4">4</xref>]. Although scSTEM still needs some “prefiltering” process to reduce the list of input genes to a few thousand (3000 ~ 5000 in this study), the clustering engine can easily handle larger number of genes. However, to generate interpretable results, we recommend the users to limit to a few thousand of input genes. Following clustering, the user can also compare significant profiles across clusters to identify pathways and processes that differ between different paths. scSTEM performs comparison by testing the number of overlapping genes in clusters from different paths. Users can then compare the expression patterns of clusters with significant overlap and combine with other evidence (GO enrichment, cell type information, etc.) to determine whether there are functional relevancies between clusters. An important assumption used by scSTEM is that the expression change of a gene along the edges between milestones is linear. There is some prior work that supports this idea for time series expression data [<xref ref-type="bibr" rid="CR21">21</xref>]. We have also further examined whether such linearity is observed for genes in the human fetal immune cell data set. Genes expressed in at least 5% of the cells that mapped to the edges were selected for this analysis. For each gene, we used corrected <italic>p</italic>-values (BH corrections) from F test to evaluate the fit of a linear model. As shown in Additional File <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S11, we observe a significant fit for a linear model for over 50% of the genes for internal (non-terminal) edges. We observe less agreement for terminal edges, but this is in part a function of the way the trajectory is constructed. Terminal edges have much fewer cells and significant than internal edges (since each branching further splits the number of genes) which leads to noisy expression profile that is harder to model using a simple curve. As a method for sanity check, we have added the relevant functionality in scSTEM interface, where users can conveniently generate plot that shows linear fit for a trajectory path.</p>
    <p id="Par20">While useful, there are several limitations that should be noted. First, scSTEM relies on trajectory inference methods, which may not accurately reconstruct cell trajectories. While the package provides access to several such methods, and so it is likely that at least a few will work well, there is no guarantee that the resulting trajectories indeed capture the underlying process. Second, most trajectory inference methods do not reflect directionality of progression along the path. scSTEM uses real time point information to pinpoint the origin of the trajectory tree, but if such time information does not agree with the real direction, the analysis would be inaccurate. Third, in some cases, trajectory methods provide too many branches, which artificially increases the path length and may be detrimental to scSTEM analysis.</p>
    <p id="Par21">To further improve scSTEM in the future, time point information may be explicitly used during the construction of trajectory and clustering of genes. Methods that provide directionality of single-cell progression such as RNA velocity [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>] may be considered.</p>
    <p id="Par22">We have provided scSTEM as an R shiny GUI-based tool which does not require any coding experience (available at <ext-link ext-link-type="uri" xlink:href="https://github.com/alexQiSong/scSTEM">https://github.com/alexQiSong/scSTEM</ext-link>). While not being limited to bioinformatians and computational biologists, we aim to provide scSTEM to the broader audiences of all researchers interested in analyzing scRNA-seq data.</p>
  </sec>
  <sec id="Sec12">
    <title>Conclusions</title>
    <p id="Par23">We have developed a computational tool, scSTEM, to cluster genes for scRNA-seq data. We applied scSTEM to published scRNA-seq data sets, and the results showed that scSTEM has successfully captured the T cell, NK cell, immune process, and neuron development-related gene clusters. The comparison between gene clusters from T cell and NK cell trajectory path has revealed NK cell-specific expression patterns of several genes. scSTEM is able to work with different trajectory inference methods for single-cell data. Users may choose the method of interest and identify the best method for the relevant biological question. We believe scSTEM can be used as a powerful tool to dissect complex scRNA-seq datasets and reveal meaningful gene expression patterns.</p>
  </sec>
  <sec id="Sec13">
    <title>Methods</title>
    <sec id="Sec14">
      <title>Retrieval and preprocessing of data sets</title>
      <p id="Par24">We have tested scSTEM on three time series single-cell data sets: (1) human fetal immune cells [<xref ref-type="bibr" rid="CR13">13</xref>], (2) mouse embryonic blood cells [<xref ref-type="bibr" rid="CR11">11</xref>], (3) mouse embryonic neural crest cells [<xref ref-type="bibr" rid="CR11">11</xref>]. For the human fetal immune cell data set, we downloaded processed UMI counts from <ext-link ext-link-type="uri" xlink:href="https://descartes.brotmanbaty.org/bbi/human-gene-expression-during-development/">https://descartes.brotmanbaty.org/bbi/human-gene-expression-during-development/</ext-link>. The data set contained 103,766 cells sampled at 18 time points. For this data set, we used the top 3000 cell-type-specific marker genes as was done in the original publication [<xref ref-type="bibr" rid="CR13">13</xref>]. For mouse embryonic blood cells and mouse embryonic neural crest cells, we downloaded processed UMI counts from <ext-link ext-link-type="uri" xlink:href="https://oncoscape.v3.sttrcancer.org/atlas.gs.washington.edu.mouse.rna/downloads">https://oncoscape.v3.sttrcancer.org/atlas.gs.washington.edu.mouse.rna/downloads</ext-link>. The mouse embryonic blood cell dataset contained 42,262 cells sampled at 5 time points while the neural crest dataset contained 22,283 cells and 5 time points. For both datasets, we filtered genes expressed in less than 10 cells and cells expressing less than 200 genes. We next identified the top 5000 most variable genes by Seurat (Version 4.0.3) and used these genes for downstream analysis.</p>
    </sec>
    <sec id="Sec15">
      <title>scSTEM pipeline</title>
      <sec id="Sec16">
        <title>Normalization and dimensionality reduction</title>
        <p id="Par25">For initial visualization of the data, scSTEM performs normalization of UMI count data using log normalization provided by Monocle3 package [<xref ref-type="bibr" rid="CR11">11</xref>]. Normalized data is reduced to 100 dimensions prior to dimensionality reduction by UMAP.</p>
      </sec>
      <sec id="Sec17">
        <title>Selection of cells by partition</title>
        <p id="Par26">Instead of using all cells to perform trajectory inference, it is important to infer trajectory tree for a subset of cells relevant to the biological question of interest. Therefore, scSTEM allows users to select a subset of cells after the dimensionality reduction step and before trajectory inference step. scSTEM uses Leiden algorithm to cluster cells. For each connected component in the Leiden graph, the software assigns a cluster ID allowing the users to analyze each of these separately. User can then select the cell partition by selecting the corresponding cluster IDs in the scSTEM GUI and perform trajectory inference for the selected cells.</p>
      </sec>
      <sec id="Sec18">
        <title>Trajectory inference</title>
        <p id="Par27">To perform pseudotime inference, scSTEM allows users to select one of several popular methods. To enable this, we use a general trajectory inference framework provided by the dynverse package [<xref ref-type="bibr" rid="CR2">2</xref>]. Dynverse supports several popular methods including slingshot [<xref ref-type="bibr" rid="CR7">7</xref>], PAGA [<xref ref-type="bibr" rid="CR12">12</xref>], and more. The trajectory is represented by a graph in which each node is a milestone node and edges connecting them represent transitions between two milestone nodes. Although scSTEM is primarily designed to work with general trajectory structures, it imposes some constraints which impacts the set of methods that can be used for the initial pseudotime inference. These include (1) the inferred trajectories provided by the method should follow a tree structure without loops; (2) the inference method only takes a set of starting cells as prior information if prior information is required. These requirements still leave a very large set of 19 trajectory inference methods which can be used with scSTEM (See Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1).</p>
        <p id="Par28">Trajectory inference will produce a trajectory tree, with nodes representing possible cell states and edges representing the transitions among these cell states. Following the terminologies used by Dynverse, we term these nodes as “milestone nodes.” A path is the shortest path connecting the root node and a leaf node. The goal for scSTEM is to perform gene clustering on each path. scSTEM assigns an ID number to each path. The user can then select a single or multiple path(s) by checking the corresponding path ID numbers in the GUI.</p>
      </sec>
      <sec id="Sec19">
        <title>Summarizing gene expression levels along a path</title>
        <p id="Par29">While each path may contain hundreds or even thousands of cells, the changes between milestone nodes is usually linear for genes. Thus, the trajectory of a specific gene along a specific path can be represented with a small set of values, one for each of the milestone nodes along the paths. These values are used as inputs to scSTEM to cluster the genes along the path and to assign significance value to the clusters. However, there are several different ways in which one can summarize the expression of genes along the path and different summarization may be more appropriate for different studies.</p>
        <p id="Par30">scSTEM provides three methods for aggregating expression levels from cells assigned to a specific segment. A segment is defined as the set of milestone nodes and edges connecting two consecutive milestone nodes in the trajectory. We define three types of milestone nodes: (1) the root node, (2) branching node, and (3) leaf node. For directed trees, a branching node is a node having greater than or equal to two outgoing edges. For undirected tree, branching node is a node having greater than or equal to three edges connected to it. Once trajectory tree has been constructed, scSTEM will iterate over all possible paths going from root node to leaf node and aggregate gene expressions in each key segment and in each path. We term these segments as “sampled time point,” and each path may include several such sampled time points. scSTEM then clusters genes for each path based on these time point values. When the number of sampled time points is less than three, the STEM algorithm will not be able to produce meaningful clusters. To address this issue, in such cases scSTEM further breaks paths into more segments using ordering of pseudotime values. For paths containing only one key segment, scSTEM will partition the segment into three segments by looking for 1/3 and 2/3 quantile points. For paths containing only two key segments, scSTEM will partition each segment into two segments by looking for median point. We have observed that this strategy is useful for trajectory inference methods that do not create complex branch structure. The metrics used to aggregate gene expressions for each sampled time point are described below.</p>
        <sec id="FPar1">
          <title>Mean expression</title>
          <p id="Par31">This metric simply computes the mean of normalized expression values for each gene in all cells belonging to a sampled time point.</p>
        </sec>
        <sec id="FPar2">
          <title>Entropy reduction score</title>
          <p id="Par32">ROGUE (Ratio of Global Unshifted Entropy) is a statistic initially proposed to measure the impurity of cell population [<xref ref-type="bibr" rid="CR24">24</xref>]. We used ROGUE score to measure the purity of a gene in a cell population. The ROGUE score for gene <italic>i</italic> in a population of <italic>n</italic> cells is calculated as<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d{s}_{i}=\mathit{ln}E\left({X}_{i}\right)-\frac{{\sum }_{j=1}^{n}\left(\mathit{ln}{X}_{ij}\right)}{n}$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="italic">ln</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi mathvariant="italic">ln</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2022_2716_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
          <p id="Par33">where <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E\left({X}_{i}\right)$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2022_2716_Article_IEq1.gif"/></alternatives></inline-formula> is the expected gene count from Poisson-Gamma model and <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathit{ln}E\left({X}_{i}\right)$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi mathvariant="italic">ln</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2022_2716_Article_IEq2.gif"/></alternatives></inline-formula> represents differential entropy under <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{0}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2716_Article_IEq3.gif"/></alternatives></inline-formula> that cell population is homogeneous and thus only one Poisson-Gamma component is present for all cells. The right part of the equation <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{\sum }_{j=1}^{n}\left(\mathit{ln}{X}_{ij}\right)}{n}$$\end{document}</tex-math><mml:math id="M10"><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi mathvariant="italic">ln</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2022_2716_Article_IEq4.gif"/></alternatives></inline-formula> measures the differential entropy for the other extreme case: when cell population is extremely heterogeneous, each cell represents its own cluster. This metric can capture the consistency of expression levels for this gene in this segment.</p>
        </sec>
        <sec id="FPar3">
          <title>Change rate of gene expression</title>
          <p id="Par34">This metric measures the rate of expression change for each gene along the segment. To compute the change rate, we first apply a filtering strategy to remove zero and low expression values which may represent dropouts. We use a <italic>Z</italic>-score based simple strategy here. For each gene, scSTEM computes <italic>Z</italic>-scores for all expressions in the segment and then removes cells with <italic>Z</italic>-score &lt; 1.96 and <italic>Z</italic>-score &gt; 1.96 for that time point. After this filtering step, scSTEM fits a linear model using the remaining cells:<disp-formula id="Equb"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{i}={\upbeta }_{\mathrm{i}}t+\varepsilon$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="normal">β</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>ε</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2022_2716_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
          <p id="Par35">where <inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{e}}}_{{\varvec{i}}}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2716_Article_IEq5.gif"/></alternatives></inline-formula> denotes expression of gene <italic>i</italic>, <italic>t</italic> is the pseudotime values of cells within each sampled time point, and <italic>ε</italic> represents the noise in the expression values. scSTEM then uses <inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2716_Article_IEq6.gif"/></alternatives></inline-formula>, the linear rate parameter, as the value for this gene in this segment.'</p>
        </sec>
      </sec>
    </sec>
    <sec id="Sec20">
      <title>STEM clustering</title>
      <p id="Par36">STEM is an algorithm for clustering genes in short time series data [<xref ref-type="bibr" rid="CR10">10</xref>]. STEM clusters genes by assigning genes to pre-generated model profiles that represent distinct expression profiles. The main advantage of STEM over other unsupervised methods is the use of a pre-defined set of profiles which enables it to assign significance to each of the clusters. Each gene is assigned to one of these pre-defined profiles based on its expression level, and clusters are constructed from genes assigned to the same profile (or a number of different profiles with a similar trajectory). Since the set of possible profiles is pre-determined, STEM can assign significance to the number of genes assigned to each profile by using permutation tests. We used metrics described in “<xref rid="Sec13" ref-type="sec">Methods</xref>” to summarize the expression of each gene in each of the paths. Values are ordered for each gene based on the pseudotime order of the edges on a path leading to a short time series dataset that summarizes the expression of the genes in each selected path. STEM further processes the input to compute log ratio for each sampled time point with respect to the first sampled time point and then uses these ratios to cluster genes. See also [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>] for more details about STEM algorithm.</p>
    </sec>
    <sec id="Sec21">
      <title>Comparison of clustering results in different paths</title>
      <p id="Par37">STEM can compare the clustering results from two different bulk RNA-seq time series data sets. Similarly, we have enabled scSTEM to perform comparison of clustering results from different trajectory paths to reveal how functional gene clusters change along different cell lineages. scSTEM performs hypergeometric test to identify clusters that have significant number of overlapping genes in different paths then visualizes the expression patterns of these similar clusters (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B). Users can easily perform the comparison in the scSTEM GUI by selecting any two paths of interest.</p>
    </sec>
    <sec id="Sec22">
      <title>GO enrichment analysis</title>
      <p id="Par38">We used built-in GO enrichment analysis in STEM software to perform GO analysis. If input gene IDs are ensemble IDs, scSTEM will first map them to gene symbols by biomaRt R package then passed down the converted IDs to STEM for GO analysis.</p>
    </sec>
    <sec id="Sec23">
      <title>Comparison of different clustering and DE methods</title>
      <p id="Par39">For DE gene analysis, we first performed trajectory inference with Monocle 3 and extracted cells mapped to path 1 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B) from the human fetal immune cell data set. Then, we ran differential expression analysis using graph_test() function in Monocle 3 and the workflow of DE gene analysis in tradeSeq (see tradeSeq documentation: <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/release/bioc/vignettes/tradeSeq/inst/doc/Monocle.html">http://www.bioconductor.org/packages/release/bioc/vignettes/tradeSeq/inst/doc/Monocle.html</ext-link>). GO enrichment was then performed using ranking of <italic>p</italic>-values.</p>
      <p id="Par40">For clustering analysis, we have run two comparison methods as well, scHot and tradeSeq, on the same path. scHOT clusters genes by computing the pairwise Spearman correlation followed by hierarchical clustering. Such operations are very computationally expensive for large datasets. We thus only applied scHOT to the top 300 marker genes in the NK cell path (the path shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>B).</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec24">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2022_2716_MOESM1_ESM.xlsx">
            <caption>
              <p>Additional file 1. Gene cluster sizes, profile sizes, and p-values for each combination of trajectory inference method and gene summarization metric; Number of NK cell markers for the clusters presented in Fig. <xref rid="Fig5" ref-type="fig">5</xref>.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2022_2716_MOESM2_ESM.pdf">
            <caption>
              <p>Additional file 2. All supplementary notes, supplementary figures, and supplementary tables.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2022_2716_MOESM3_ESM.xlsx">
            <caption>
              <p>Additional file 3. Gene IDs for clusters presented in Fig. <xref rid="Fig5" ref-type="fig">5</xref>.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13059_2022_2716_MOESM4_ESM.xlsx">
            <caption>
              <p>Additional file 4. GO enrichment analysis results for clusters presented in Fig. <xref rid="Fig5" ref-type="fig">5</xref>.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13059_2022_2716_MOESM5_ESM.docx">
            <caption>
              <p>Additional file 5. Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We wish to acknowledge Alex Singh, Marouen Ben Guebila, Tian Wang, Wei Liu, Rujia Bi, Chujia Chen, and Yirui Chen for testing the R shiny package and providing valuable feedbacks and comments.</p>
    <sec id="FPar4">
      <title>Review history</title>
      <p id="Par41">The review history is available as Additional file <xref rid="MOESM5" ref-type="media">5.</xref></p>
    </sec>
    <sec id="FPar5">
      <title>Peer review information</title>
      <p id="Par42">Wenjing She was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>Z.B.J. and Q.S. designed the research; Q.S. performed all analyses and implemented the R Shiny package; J.T.W. implemented modified STEM Java program. Q.S. and Z.B.J. wrote the manuscript. All authors read and approved the final manuscript.</p>
    <sec id="FPar6">
      <title>Authors’ information</title>
      <p id="Par43">Twitter handles: @sqsq3178(Qi Song); @jingtaowang12(Jingtao Wang)</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was partially supported by NIH grants 1R01GM122096 and OT2OD026682 to Z.B.J.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets generated and/or analyzed during the current study are available in the GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/alexQiSong/scSTEM_sample_data/">https://github.com/alexQiSong/scSTEM_sample_data/</ext-link> [<xref ref-type="bibr" rid="CR25">25</xref>]. The original scRNA-seq data (processed as gene count matrices) for human fetal immune cells can be accessed at descartes.brotmanbaty.org [<xref ref-type="bibr" rid="CR13">13</xref>], and the corresponding raw data can be accessed through dbGaP under the accession number phs002003.v1.p1. The original scRNA-seq data (processed as gene count matrices) for mouse embryonic blood cells and mouse embryonic neural crest cells can be accessed at <ext-link ext-link-type="uri" xlink:href="https://oncoscape.v3.sttrcancer.org/atlas.gs.washington.edu.mouse.rna/landing">https://oncoscape.v3.sttrcancer.org/atlas.gs.washington.edu.mouse.rna/landing</ext-link> [<xref ref-type="bibr" rid="CR11">11</xref>], and the corresponding raw data can be accessed through NCBI Gene Expression Omnibus under the accession number GSE119945.</p>
    <p>scSTEM package, the analysis code, and other processed data used in this study are available at GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/alexQiSong/scSTEM">https://github.com/alexQiSong/scSTEM</ext-link> under MIT license [<xref ref-type="bibr" rid="CR25">25</xref>], and at Zenodo. (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.6331254">https://doi.org/10.5281/zenodo.6331254</ext-link>) [<xref ref-type="bibr" rid="CR26">26</xref>] under Creative Commons Attribution 4.0 International license.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar7">
      <title>Ethics approval and consent to participate</title>
      <p id="Par44">Not applicable.</p>
    </notes>
    <notes id="FPar8">
      <title>Consent for publication</title>
      <p id="Par45">Not applicable.</p>
    </notes>
    <notes id="FPar9" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par46">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Challenges in unsupervised clustering of single-cell RNA-seq data</article-title>
        <source>Nat Rev Genet.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>273</fpage>
        <lpage>282</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-018-0088-9</pub-id>
        <pub-id pub-id-type="pmid">30617341</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saelens</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cannoodt</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Todorov</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>A comparison of single-cell trajectory inference methods</article-title>
        <source>Nat Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>547</fpage>
        <lpage>554</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0071-9</pub-id>
        <pub-id pub-id-type="pmid">30936559</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>scLM: Automatic detection of consensus gene clusters across multiple single-cell datasets</article-title>
        <source>Genomics Proteomics Bioinformatics.</source>
        <year>2020</year>
        <volume>19</volume>
        <issue>2</issue>
        <fpage>330</fpage>
        <lpage>341</lpage>
        <pub-id pub-id-type="doi">10.1016/j.gpb.2020.09.002</pub-id>
        <pub-id pub-id-type="pmid">33359676</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Strauss</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Kirk</surname>
            <given-names>PDW</given-names>
          </name>
          <name>
            <surname>Reid</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Wernisch</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>GPseudoClust: Deconvolution of shared pseudo-profiles at single-cell resolution</article-title>
        <source>Bioinformatics.</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>5</issue>
        <fpage>1484</fpage>
        <lpage>1491</lpage>
        <?supplied-pmid 31608923?>
        <pub-id pub-id-type="pmid">31608923</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Van den Berge K, Roux de Bézieux H, Street K, Saelens W, Cannoodt R, Saeys Y, et al. Trajectory-based differential expression analysis for single-cell sequencing data. Nat Commun. 2020;11:1201.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hurley</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Villacorta-Martin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Herriges</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Jacob</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vedaie</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reconstructed single-cell fate trajectories define lineage plasticity windows during differentiation of human PSC-derived distal lung progenitors</article-title>
        <source>Cell Stem Cell.</source>
        <year>2020</year>
        <volume>26</volume>
        <issue>4</issue>
        <fpage>593</fpage>
        <lpage>608</lpage>
        <pub-id pub-id-type="doi">10.1016/j.stem.2019.12.009</pub-id>
        <pub-id pub-id-type="pmid">32004478</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Street</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Risso</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fletcher</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Das</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ngai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Slingshot: cell lineage and pseudotime inference for single-cell transcriptomics</article-title>
        <source>BMC Genomics.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>477</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-018-4772-0</pub-id>
        <pub-id pub-id-type="pmid">29914354</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Albergante</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hsu</surname>
            <given-names>JY</given-names>
          </name>
          <name>
            <surname>Lareau</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Lo Bosco</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Guan</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell trajectories reconstruction, exploration and mapping of omics data with STREAM</article-title>
        <source>Nat Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>1903</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-09670-4</pub-id>
        <pub-id pub-id-type="pmid">31015418</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ernst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bar-Joseph</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>STEM: A tool for the analysis of short time series gene expression data</article-title>
        <source>BMC Bioinformatics.</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>191</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-191</pub-id>
        <pub-id pub-id-type="pmid">16597342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Ernst J, Nau GJ, Bar-Joseph Z. Clustering short time series gene expression data. Bioinformatics. 2005;21(suppl_1):i159–68.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Spielmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ibrahim</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The single-cell transcriptional landscape of mammalian organogenesis</article-title>
        <source>Nature.</source>
        <year>2019</year>
        <volume>566</volume>
        <issue>7745</issue>
        <fpage>496</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-0969-x</pub-id>
        <pub-id pub-id-type="pmid">30787437</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Hamey</surname>
            <given-names>FK</given-names>
          </name>
          <name>
            <surname>Plass</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Solana</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dahlin</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Göttgens</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PAGA: graph abstraction reconciles clustering with trajectory inference through a topology preserving map of single cells</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>59</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1663-x</pub-id>
        <pub-id pub-id-type="pmid">30890159</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Cao J, O’Day DR, Pliner HA, Kingsley PD, Deng M, Daza RM, et al. A human cell atlas of fetal gene expression. Science (80). 2020;370(6518).</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chan</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Harrison</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Ponzio</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Rameshwar</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Mesenchymal stem cells (MSC) exhibit antigen presenting (APC) and phagocytic properties: implications to bone marrow failure during inflammation</article-title>
        <source>Blood.</source>
        <year>2004</year>
        <volume>104</volume>
        <issue>11</issue>
        <fpage>4249</fpage>
        <pub-id pub-id-type="doi">10.1182/blood.V104.11.4249.4249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chan</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>KC</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Bonilla</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Pierobon</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ponzio</surname>
            <given-names>NM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Antigen-presenting property of mesenchymal stem cells occurs during a narrow window at low levels of interferon-γ</article-title>
        <source>Blood.</source>
        <year>2006</year>
        <volume>107</volume>
        <issue>12</issue>
        <fpage>4817</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1182/blood-2006-01-0057</pub-id>
        <pub-id pub-id-type="pmid">16493000</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolfraim</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Fernandez</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Mamura</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fuller</surname>
            <given-names>WL</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>DE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Loss of Smad3 in acute T-cell lymphoblastic leukemia</article-title>
        <source>N Engl J Med.</source>
        <year>2004</year>
        <volume>352</volume>
        <fpage>552</fpage>
        <lpage>559</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMoa031197</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Souza-Fonseca-Guimaraes F, Krasnova Y, Putoczki T, Miles K, Macdonald KP, Town L, et al. Granzyme M has a critical role in providing innate immune protection in ulcerative colitis. Cell Death Dis. 2016;7:e2302.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Franzén O, Gan LM, Björkegren JLM. PanglaoDB: a web server for exploration of mouse and human single-cell RNA sequencing data. Database. 2019;2019:baz046.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frankish</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Diekhans</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jungreis</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Loveland</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GENCODE reference annotation for the human and mouse genomes</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>D766</fpage>
        <lpage>773</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky955</pub-id>
        <pub-id pub-id-type="pmid">30357393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ghazanfar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Patrick</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>ZG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Investigating higher-order interactions in single-cell data with scHOT</article-title>
        <source>Nat Methods.</source>
        <year>2020</year>
        <volume>17</volume>
        <issue>8</issue>
        <fpage>799</fpage>
        <lpage>806</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-0885-x</pub-id>
        <pub-id pub-id-type="pmid">32661426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sefer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kleyman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bar-Joseph</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Tradeoffs between dense and replicate sampling strategies for high-throughput time series experiments</article-title>
        <source>Cell Syst.</source>
        <year>2016</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>P35</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.06.007</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>La Manno</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Soldatov</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Braun</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hochgerner</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Petukhov</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA velocity of single cells</article-title>
        <source>Nature.</source>
        <year>2018</year>
        <volume>560</volume>
        <issue>7719</issue>
        <fpage>494</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0414-6</pub-id>
        <pub-id pub-id-type="pmid">30089906</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bergen</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Lange</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Peidli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Generalizing RNA velocity to transient cell states through dynamical modeling</article-title>
        <source>Nat Biotechnol.</source>
        <year>2020</year>
        <volume>38</volume>
        <issue>12</issue>
        <fpage>1408</fpage>
        <lpage>1414</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0591-3</pub-id>
        <pub-id pub-id-type="pmid">32747759</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>An entropy-based metric for assessing the purity of single cell populations</article-title>
        <source>Nat Commun.</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>3155</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-16904-3</pub-id>
        <pub-id pub-id-type="pmid">32572028</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Song Q, Wang J, Bar-Joseph Z. alexQiSong/scSTEM: scSTEM v1.1.0 (v1.1.0). GitHub. 2022. <ext-link ext-link-type="uri" xlink:href="https://github.com/alexQiSong/scSTEM">https://github.com/alexQiSong/scSTEM</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Song Q, Wang J, Bar-Joseph Z. alexQiSong/scSTEM: scSTEM v1.1.0 (v1.1.0). Zenodo. 2022. 10.5281/zenodo.6331254.</mixed-citation>
    </ref>
  </ref-list>
</back>
