<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7267824</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa185</article-id>
    <article-id pub-id-type="publisher-id">btaa185</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>COMER2: GPU-accelerated sensitive and specific homology searches</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-4981-6708</contrib-id>
        <name>
          <surname>Margelevičius</surname>
          <given-names>Mindaugas</given-names>
        </name>
        <xref ref-type="aff" rid="btaa185-aff1"/>
        <xref ref-type="corresp" rid="btaa185-cor1"/>
        <!--<email>mindaugas.margelevicius@bti.vu.lt</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Elofsson</surname>
          <given-names>Arne</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btaa185-aff1"><institution>Institute of Biotechnology</institution>, Life Sciences Center, Vilnius University, Vilnius 10257, Lithuania</aff>
    <author-notes>
      <corresp id="btaa185-cor1">
        <email>mindaugas.margelevicius@bti.vu.lt</email>
      </corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-03-13">
      <day>13</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>11</issue>
    <fpage>3570</fpage>
    <lpage>3572</lpage>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>11</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>02</day>
        <month>3</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>3</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa185.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Searching for homology in the vast amount of sequence data has a particular emphasis on its speed. We present a completely rewritten version of the sensitive homology search method COMER based on alignment of protein sequence profiles, which is capable of searching big databases even on a lightweight laptop. By harnessing the power of CUDA-enabled graphics processing units, it is up to 20 times faster than HHsearch, a state-of-the-art method using vectorized instructions on modern CPUs.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>COMER2 is cross-platform open-source software available at <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/comer2">https://sourceforge.net/projects/comer2</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/minmarg/comer2">https://github.com/minmarg/comer2</ext-link>. It can be easily installed from source code or using stand-alone installers.</p>
      </sec>
      <sec id="s3">
        <title>Contact</title>
        <p>
          <email>mindaugas.margelevicius@bti.vu.lt</email>
        </p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Regional Development Fund</institution>
            <institution-id institution-id-type="DOI">10.13039/501100008530</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>01.2.2-LMT-K-718-01-0028</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Research Council of Lithuania</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004504</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>LMTLT</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The detection of homology between protein sequences underlies a wide variety of protein studies ranging from active site and function prediction to contact and structure prediction. Sensitivity, therefore, is one of the most desirable properties of homology search methods. Efforts to increase sensitivity, however, are often accompanied by an increase in computation time. For homology search methods to be applicable to the vast amount of sequence data that is available today, various algorithms have been proposed to reduce computation time (<xref rid="btaa185-B1" ref-type="bibr">Altschul <italic>et al.</italic>, 1997</xref>; <xref rid="btaa185-B3" ref-type="bibr">Eddy, 2011</xref>; <xref rid="btaa185-B8" ref-type="bibr">Raimondi <italic>et al.</italic>, 2018</xref>; <xref rid="btaa185-B9" ref-type="bibr">Remmert <italic>et al.</italic>, 2012</xref>).</p>
    <p>This article contributes to increasing computing performance and presents a new implementation (version 2.2) of the COMER method (<xref rid="btaa185-B5" ref-type="bibr">Margelevičius, 2016</xref>, <xref rid="btaa185-B6" ref-type="bibr">2018</xref>) for homology search based on alignment of protein sequence profiles. The new version is more than three orders of magnitude faster, more sensitive, produces alignments of higher quality and, as it is shown, highly specific.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>COMER computing performance is increased by harnessing the power of the graphics processing unit (GPU). To the best of our knowledge, COMER2 represents the first GPU implementation of homology searches based on profile–profile alignment. As a target processor, a GPU was selected because of its high level of parallelism and cost efficiency.</p>
    <p>The approach and algorithms behind the COMER method have not changed, but the software has been completely rewritten (see Supplementary Section S1). Changed architecture, data types, fast approximations to exponential/logarithmic functions and other code optimizations have an impact on sensitivity and alignment quality, which we evaluate in addition to computation time.</p>
    <p>We evaluated and benchmarked the new software on (i) a laptop equipped with a six-core hyper-threaded Intel Core i9-8950HK CPU clocked at 2.9 GHz, 16GB DDR4 RAM and an 8GB GDDR5 NVIDIA GeForce GTX 1080MQ GPU and (ii) a high-end server with two 10-core hyper-threaded Intel Xeon Gold 5115 CPUs at 2.4 GHz, 128GB DDR4 RAM and two 16GB HBM2 NVIDIA Tesla V100 GPU accelerators. The CPUs of these computers support the AVX2/AVX512 instruction set that provides maximum instruction throughput for HHsearch/HHblits v3.2.</p>
    <p>Two datasets were used. The first, referred to as the SCOPe dataset, was half of the entries in the SCOPe 2.03 database (Fox <italic>et al.</italic>, 2013) filtered at 20% sequence identity. Profiles were constructed from multiple sequence alignments (MSAs) obtained using (i) PSI-BLAST (<xref rid="btaa185-B1" ref-type="bibr">Altschul <italic>et al.</italic>, 1997</xref>) and (ii) HHblits (<xref rid="btaa185-B9" ref-type="bibr">Remmert <italic>et al.</italic>, 2012</xref>). 1722 profiles were used as queries to search a total of 4900 profiles.</p>
    <p>The second, referred to as the simulated dataset, was composed of 1 million randomly generated profiles (<xref rid="btaa185-B7" ref-type="bibr">Margelevičius, 2019</xref>) and 1284 profiles constructed for the sequences of randomly selected PDB (<xref rid="btaa185-B2" ref-type="bibr">Berman <italic>et al.</italic>, 2000</xref>) structures sharing &lt;20% sequence identity at the domain level (1 001 284 profiles in total). Another set of 128 profiles corresponding to PDB entries was used as queries. MSAs for the PDB sequences were obtained from HHpred PDB70 database 190918 (<xref rid="btaa185-B11" ref-type="bibr">Zimmermann <italic>et al.</italic>, 2018</xref>).</p>
    <p>Sensitivity was measured by the number of identified true positives (TPs). A TP was a domain that was structurally similar to the query domain or belonged to the same SCOPe superfamily as the query. For both datasets, the analysis was conducted at the domain level. A hit to a dissimilar domain from a different fold or to a random profile was a false positive (FP).</p>
    <p>For the SCOPe dataset, alignment quality was evaluated by generating structural models based on profile–profile alignments. A high-quality alignment (HQA) corresponded to a model structurally similar to the native structure. Alignment quality was evaluated locally, along the alignment extent and globally, regarding the whole domain.</p>
    <p>More details can be found in Supplementary Section S2.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>The results accumulated over all queries are shown in <xref ref-type="fig" rid="btaa185-F1">Figure 1</xref>. More results can be found in Supplementary Section S3.</p>
    <fig id="btaa185-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Results for (<bold>A–G</bold>) the SCOPe and (<bold>H–K</bold>) the simulated dataset. (A, D and H) sensitivity; (B and E) alignment quality in the local mode; (C and F) alignment quality in the global mode. COMER, HHsearch and HHblits maximally extend alignments. (G, J and K) running time; (I) specificity. Bold type denotes the new COMER version. *Measured on a cluster with Intel Xeon CPUs E5-2670 v3 </p>
      </caption>
      <graphic xlink:href="btaa185f1"/>
    </fig>
    <p>The new version for the SCOPe dataset is more sensitive (<xref ref-type="fig" rid="btaa185-F1">Fig. 1A and D</xref>), produces higher-quality alignments evaluated locally (<xref ref-type="fig" rid="btaa185-F1">Fig. 1B and E</xref>) and globally (<xref ref-type="fig" rid="btaa185-F1">Fig. 1C and F</xref>) and is more than three orders of magnitude faster (<xref ref-type="fig" rid="btaa185-F1">Fig. 1G</xref>) when measured on the laptop.</p>
    <p>The simulated dataset (53GB) was used to estimate running time on big data and evaluate specificity. COMER v2.2 and HHsearch/HHblits v3.2 (<xref rid="btaa185-B10" ref-type="bibr">Steinegger <italic>et al.</italic>, 2019</xref>) were the only feasible implementations for this test.</p>
    <p>The results show that COMER v2.2 is highly sensitive (<xref ref-type="fig" rid="btaa185-F1">Fig. 1H</xref>) and specific (<xref ref-type="fig" rid="btaa185-F1">Fig. 1I</xref>). All FPs but one were associated with the same query (1AL3_A) and locally shared the same secondary structure with it, indicating a possible evolutionary signal. And there were no hits to random profiles. In contrast, the results of HHsearch and HHblits included many statistically significant alignments between the queries and random profiles.</p>
    <p>The property of simultaneously performing searches with multiple queries and the capability of utilizing multiple GPUs help COMER v2.2 achieve high performance and scalability. COMER v2.2 is nearly 10× and 20× faster than HHsearch v3.2, measured on the server (<xref ref-type="fig" rid="btaa185-F1">Fig. 1J</xref>) and the laptop (<xref ref-type="fig" rid="btaa185-F1">Fig. 1K</xref>), respectively. A beneficial characteristic is a weak dependence of its running time (varies within 15%) on the GPU memory used.</p>
    <p>The gains in running time achieved by HHblits are due to its filtering strategy that identified only 7870 (0.8%) profile pairs per query on average as candidates for alignment, whereas this number for COMER corresponds to the total number of entries in the database. This difference in computational complexity indicates a high potential to significantly increase COMER’s computing performance further (see Section 4).</p>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>COMER v2.2 is cross-platform software written in CUDA and C++11 and designed to run on major operating systems (Windows, Linux and macOS). It was tested on Windows 10 using the native compiler and on the Ubuntu 18.04 LTS and CentOS 7.6 Linux distributions using GCC (4.8.5, 7.4 and 8.3) and LLVM/Clang 6.0 compilers.</p>
    <p>The new implementation of the COMER method exhibits good performance characteristics and advantageous features. The GPU memory limit that can be used by COMER2 is configurable, and the performance weakly depends on the amount of memory used for computation. In other words, the efficient use of computational resources allows for fast searching big databases even on a lightweight laptop.</p>
    <p>COMER2 is capable of utilizing multiple GPUs and demonstrates excellent scalability, which enables large-scale sensitive homology search to be performed within minutes. The performance gain is achieved without compromising sensitivity and alignment quality. On the contrary, COMER2 is now more sensitive and produces more accurate alignments.</p>
    <p>The software architecture provides a foundation for further significant improvements. The current version calculates complete dynamic programming (DP) matrices and does not use any heuristics to screen for candidates to the profile–profile alignment phase. Implementing algorithms for reducing DP complexity, such as extending from seeds found in the score matrix and applying banded DP, and for filtering out possibly unrelated pairs can lead to orders of magnitude improvement in performance. We will investigate these and other directions in future work.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btaa185_Supplementary_Data</label>
      <media xlink:href="btaa185_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The author thanks Justas Dapkūnas and Albertas Timinskas for useful discussions.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the European Regional Development Fund [01.2.2-LMT-K-718-01-0028] under a grant agreement with the Research Council of Lithuania (LMTLT). </p>
      <p><italic>Conflict of Interest</italic>: none declared. </p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa185-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>S.F.</given-names></name></person-group><etal>et al</etal> (<year>1997</year>) 
<article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic Acids Res</source>., <volume>25</volume>, <fpage>3389</fpage>–<lpage>3402</lpage>.<pub-id pub-id-type="pmid">9254694</pub-id></mixed-citation>
    </ref>
    <ref id="btaa185-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Berman</surname><given-names>H.</given-names></name></person-group> (<year>2000</year>) 
<article-title>The Protein Data Bank</article-title>. <source>Nucleic Acids Res</source>., <volume>28</volume>, <fpage>235</fpage>–<lpage>242</lpage>.<pub-id pub-id-type="pmid">10592235</pub-id></mixed-citation>
    </ref>
    <ref id="btaa185-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Eddy</surname><given-names>S.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Accelerated profile HMM searches</article-title>. <source>PLoS Comput. Biol</source>., <volume>7</volume>, <fpage>e1002195</fpage>.<pub-id pub-id-type="pmid">22039361</pub-id></mixed-citation>
    </ref>
    <ref id="btaa185-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fox</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>SCOPe: Structural classification of proteins–extended, integrating SCOP and ASTRAL data and classification of new structures</article-title>. <source>Nucleic Acids Res</source>., <volume>42</volume>, <fpage>D304</fpage>–<lpage>D309</lpage>.<pub-id pub-id-type="pmid">24304899</pub-id></mixed-citation>
    </ref>
    <ref id="btaa185-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Margelevičius</surname><given-names>M.</given-names></name></person-group> (<year>2016</year>) 
<article-title>Bayesian nonparametrics in protein remote homology search</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>2744</fpage>–<lpage>2752</lpage>.<pub-id pub-id-type="pmid">27153649</pub-id></mixed-citation>
    </ref>
    <ref id="btaa185-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Margelevičius</surname><given-names>M.</given-names></name></person-group> (<year>2018</year>) 
<article-title>A low-complexity add-on score for protein remote homology search with COMER</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>2037</fpage>–<lpage>2045</lpage>.<pub-id pub-id-type="pmid">29390109</pub-id></mixed-citation>
    </ref>
    <ref id="btaa185-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Margelevičius</surname><given-names>M.</given-names></name></person-group> (<year>2019</year>) 
<article-title>Estimating statistical significance of local protein profile-profile alignments</article-title>. <source>BMC Bioinformatics</source>, <volume>20</volume>, <fpage>419</fpage>.<pub-id pub-id-type="pmid">31409275</pub-id></mixed-citation>
    </ref>
    <ref id="btaa185-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Raimondi</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Ultra-fast global homology detection with Discrete Cosine Transform and Dynamic Time Warping</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>3118</fpage>–<lpage>3125</lpage>.<pub-id pub-id-type="pmid">29684140</pub-id></mixed-citation>
    </ref>
    <ref id="btaa185-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Remmert</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>HHblits: lightning-fast iterative protein sequence searching by HMM-HMM alignment</article-title>. <source>Nat. Methods</source>, <volume>9</volume>, <fpage>173</fpage>–<lpage>175</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa185-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Steinegger</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>HH-suite3 for fast remote homology detection and deep protein annotation</article-title>. <source>BMC Bioinformatics</source>, <volume>20</volume>, <fpage>473</fpage>.<pub-id pub-id-type="pmid">31521110</pub-id></mixed-citation>
    </ref>
    <ref id="btaa185-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zimmermann</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>A completely reimplemented MPI bioinformatics toolkit with a new HHpred server at its core</article-title>. <source>J. Mol. Biol</source>., <volume>430</volume>, <fpage>2237</fpage>–<lpage>2243</lpage>.<pub-id pub-id-type="pmid">29258817</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
