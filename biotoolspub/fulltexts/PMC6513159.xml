<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6513159</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty894</article-id>
    <article-id pub-id-type="publisher-id">bty894</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>VCPA: genomic variant calling pipeline and data management tool for Alzheimer’s Disease Sequencing Project</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Leung</surname>
          <given-names>Yuk Yee</given-names>
        </name>
        <xref ref-type="aff" rid="bty894-aff1">1</xref>
        <xref ref-type="corresp" rid="bty894-cor1"/>
        <!--<email>yyee@pennmedicine.upenn.edu</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Valladares</surname>
          <given-names>Otto</given-names>
        </name>
        <xref ref-type="aff" rid="bty894-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chou</surname>
          <given-names>Yi-Fan</given-names>
        </name>
        <xref ref-type="aff" rid="bty894-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Han-Jen</given-names>
        </name>
        <xref ref-type="aff" rid="bty894-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kuzma</surname>
          <given-names>Amanda B</given-names>
        </name>
        <xref ref-type="aff" rid="bty894-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cantwell</surname>
          <given-names>Laura</given-names>
        </name>
        <xref ref-type="aff" rid="bty894-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Qu</surname>
          <given-names>Liming</given-names>
        </name>
        <xref ref-type="aff" rid="bty894-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gangadharan</surname>
          <given-names>Prabhakaran</given-names>
        </name>
        <xref ref-type="aff" rid="bty894-aff1">1</xref>
        <on-behalf-of>Alzheimer’s Disease Sequencing Project (ADSP)</on-behalf-of>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Salerno</surname>
          <given-names>William J</given-names>
        </name>
        <xref ref-type="aff" rid="bty894-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schellenberg</surname>
          <given-names>Gerard D</given-names>
        </name>
        <xref ref-type="aff" rid="bty894-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Li-San</given-names>
        </name>
        <xref ref-type="aff" rid="bty894-aff1">1</xref>
        <xref ref-type="corresp" rid="bty894-cor1"/>
        <!--<email>lswang@pennmedicine.upenn.edu</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Hancock</surname>
          <given-names>John</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="bty894-aff1"><label>1</label>Department of Pathology and Laboratory Medicine, Perelman School of Medicine at the University of Pennsylvania, Penn Neurodegeneration Genomics Center, Philadelphia, PA, USA</aff>
    <aff id="bty894-aff2"><label>2</label>Human Genome Sequencing Center, Baylor College of Medicine, Houston, TX, USA</aff>
    <author-notes>
      <corresp id="bty894-cor1">To whom correspondence should be addressed. Email: <email>yyee@pennmedicine.upenn.edu</email> or <email>lswang@pennmedicine.upenn.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-10-23">
      <day>23</day>
      <month>10</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>10</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>10</issue>
    <fpage>1768</fpage>
    <lpage>1770</lpage>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>6</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>9</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>10</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty894.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>We report VCPA, our SNP/Indel Variant Calling Pipeline and data management tool used for the analysis of whole genome and exome sequencing (WGS/WES) for the Alzheimer’s Disease Sequencing Project. VCPA consists of two independent but linkable components: pipeline and tracking database. The pipeline, implemented using the Workflow Description Language and fully optimized for the Amazon elastic compute cloud environment, includes steps from aligning raw sequence reads to variant calling using GATK. The tracking database allows users to view job running status in real time and visualize &gt;100 quality metrics per genome. VCPA is functionally equivalent to the CCDG/TOPMed pipeline. Users can use the pipeline and the dockerized database to process large WGS/WES datasets on Amazon cloud with minimal configuration.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>VCPA is released under the MIT license and is available for academic and nonprofit use for free. The pipeline source code and step-by-step instructions are available from the National Institute on Aging Genetics of Alzheimer’s Disease Data Storage Site (<ext-link ext-link-type="uri" xlink:href="http://www.niagads.org/VCPA">http://www.niagads.org/VCPA</ext-link>).</p>
      </sec>
      <sec id="s3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Institute on Aging</named-content>
          <named-content content-type="funder-identifier">10.13039/100000049</named-content>
        </funding-source>
        <award-id>U54-AG052427</award-id>
        <award-id>U01-AG032984</award-id>
        <award-id>U24-AG041689</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>1 Introduction</title>
    <p>The Alzheimer’s Disease Sequencing Project (ADSP) is an integral component of the National Alzheimer’s Project Act (NAPA) towards a cure of Alzheimer’s Disease (AD). ADSP will eventually analyze whole-genome sequencing (WGS) and whole-exome sequencing (WES) data from more than 20 000 late-onset AD patients and cognitively normal elderly to find new genetic variants associated with disease risk. To ensure all sequencing data are processed consistently and efficiently according to best practices, a common workflow called ‘Variant Calling Pipeline and data management tool’ (VCPA) was developed by the Genome Center for Alzheimer’s Disease (GCAD) in collaboration with ADSP. VCPA is capable to process any kind of germline DNA sequencing data and available for general use. VCPA (i) is optimized for large-scale production of WGS and WES data, (ii) includes a tracking database with web frontend for users to track production process and review quality metrics, (iii) is implemented using the Workflow Description Language (WDL) for better deployment and maintenance and (iv) is designed for the latest human reference genome build (GRCh38/hg38, version GRCh38DH) and follows best practices for WGS analysis with input from TOPMed (Trans-Omics for Precision Medicine) and CCDG (Centers for Common Disease Genomics).</p>
    <p>VCPA consists of two independent but interoperable components: a tracking database (<xref ref-type="fig" rid="bty894-F1">Fig. 1</xref>A) with a web frontend (<xref ref-type="fig" rid="bty894-F1">Fig. 1</xref>B) and a SNP/indel calling pipeline (<xref ref-type="fig" rid="bty894-F1">Fig. 1</xref>C). The pipeline was optimized for automatic processing WGS/WES data in various file formats, from mapping sequence reads to the latest human reference genome (GRCh38/hg38) and variant calling. The tracking database (available as another AMI) was designed for monitoring the job status and recording quality metrics for each processed sample (<xref ref-type="fig" rid="bty894-F1">Fig. 1</xref>B). With a dynamic web interface of the database, researchers can easily compare, share and visualize all these individual level quality metrics.</p>
    <fig id="bty894-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>(<bold>A</bold>) VCPA tracking database; (<bold>B</bold>) dynamic view of job status; (<bold>C</bold>) VCPA Pipeline overview</p>
      </caption>
      <graphic xlink:href="bty894f1"/>
    </fig>
  </sec>
  <sec>
    <title>2 SNP/indel calling pipeline</title>
    <p>The variant calling pipeline for the WGS (stages 1 and 2a) was developed with input from CCDG/TOPMed for functional equivalence (<xref rid="bty894-B10" ref-type="bibr">Regier <italic>et al.</italic>, 2018</xref>) and follows best practices of Germline Single Nucleotide Polymorphisms (SNPs) &amp; Insertion/deletion (indel) Discovery for Genomic Analysis Toolkit (GATK) v3.7 (<xref rid="bty894-B2" ref-type="bibr">DePristo <italic><italic>et al</italic>.</italic>, 2011</xref>). A uniqueness of VCPA is that it accepts either WGS or WES pair-end reads in FASTQ, BAM (binary sequence alignment map format), or CRAM (compressed BAM) formats with flow cell information and genomic regions for exome sequencing enrichment/capture kits. The workflow is modularized and consists of four stages (<xref ref-type="fig" rid="bty894-F1">Fig. 1</xref>C). Users can configure the workflow to skip individual stages to reduce the time and cost.</p>
    <p>Stage 0 includes preparation steps for read mapping. For samples already mapped previously, PICARD (<ext-link ext-link-type="uri" xlink:href="http://broadinstitute.github.io/picard">http://broadinstitute.github.io/picard</ext-link>) is used to roll back BAM files to uBAM (unaligned BAM) files (<ext-link ext-link-type="uri" xlink:href="https://gatkforums.broadinstitute.org/gatk/discussions/tagged/ubam">https://gatkforums.broadinstitute.org/gatk/discussions/tagged/ubam</ext-link>).</p>
    <p>Stage 1 generates BAM files. First, reads are mapped to GRCh38/hg38 using BWA-MEM (<xref rid="bty894-B5" ref-type="bibr">Li H., 2013</xref>) and duplicate reads are marked by BamUtil (<ext-link ext-link-type="uri" xlink:href="https://genome.sph.umich.edu/wiki/BamUtil">https://genome.sph.umich.edu/wiki/BamUtil</ext-link>). Next, BAM files are processed by Samblaster (adding MC and MQ tags to pair-end reads) (<xref rid="bty894-B4" ref-type="bibr">Faust and Hall, 2014</xref>) and sorted by genomic coordinates using SAMtools (<xref rid="bty894-B6" ref-type="bibr">Li <italic>et al</italic>., 2009</xref>). Finally, coverage statistics are computed using Sambamba (<xref rid="bty894-B8" ref-type="bibr">Tarasov <italic>et al.</italic>, 2015</xref>).</p>
    <p>Stage 2A performs local realignment near known indel sites (1000 Genome indels) and recalibration of base call quality scores using GATK v3.7 (<xref rid="bty894-B7" ref-type="bibr">McKenna <italic>et al</italic>., 2010</xref>).</p>
    <p>Stage 2B implements the GATK best practice steps for variant calling and annotation on SNPs and indels, and generates genotype call files in genomic Variant Call Format (gVCF) for each sample individually. Quality metrics of called variants are computed using GATK (<xref rid="bty894-B2" ref-type="bibr">DePristo <italic>et al.</italic>, 2011</xref>).</p>
    <p>Stage 3 combines gVCF files from multiple samples and performs joint genotype calling using GATK best practices. A project-level VCF file containing genotype information for all polymorphic sites across all samples is generated.</p>
    <p>Details for job submission are described in <xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>. The resulting directory architecture and important VCPA outputs are described in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref>.</p>
  </sec>
  <sec>
    <title>3 Tracking database</title>
    <p>The tracking database enables the user to monitor production status (<xref ref-type="fig" rid="bty894-F1">Fig. 1</xref>B) and review sequencing quality such as mapping percentage, depth coverage and quality of called variants. All 113 quality metrics are collected during the pipeline execution and imported into the database, and are organized by workflow stages and projects and viewable through an interactive web user interface.</p>
    <p>The tracking database is built on a LAMP (Linux, Apache Httpd, MySQL and PHP) application stack using the SLIM-PHP framework. The application has a small memory and storage footprint, provides a RESTful API interface to the MySQL back-end, and supports password protection to restrict access. The tracking database is dockerized and can be installed on-site (off the cloud) if preferred.</p>
  </sec>
  <sec>
    <title>4 Using VCPA on Amazon EC2 or local Linux environment</title>
    <p>We evaluated our pipeline using the NA12878 sample from the Genome in a Bottle project using the hg38 high confidence set (<xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>). Sensitivity/precision of VCPA calls were 0.999/0.994 for SNPs and 0.985/0.987 for indels respectively and comparable to TOPMed/CCDG workflows (<xref rid="bty894-B10" ref-type="bibr">Regier <italic>et al.</italic>, 2018</xref>). We also ran VCPA on two replicates of NA19238 (Yoruban) in CRAM and FASTQ format and the pairwise variant discordance rate is 1.000 for both SNVs and indels (<xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>), comparable to TOPMed/CCDG workflows (<xref rid="bty894-B10" ref-type="bibr">Regier <italic>et al.</italic>, 2018</xref>). Benchmark of cost and time on Amazon Elastic Compute Cloud (EC2) for running VCPA on these samples can be found in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>. VCPA is available as Amazon Machine Images (AMI), ami-acc840d3. A dockerized version is also available for deployment on other linux-based environments.</p>
    <p>To conclude, VCPA is an efficient, high quality and scalable pipeline for processing WGS/WES data on the Amazon EC2 environment. VCPA is used for the ADSP production and can track information from &gt;1000 genome analysis runs simultaneously. Future plans include incorporating other variant calling pipelines such as xAtlas (<xref rid="bty894-B3" ref-type="bibr">Farek <italic>et al</italic>., 2018</xref>) and GATK4.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>bty894_Supplementary_Data</label>
      <media xlink:href="bty894_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>Acknowledgement</title>
    <p>We thank members from the Genome Center for Alzheimer's Disease (GCAD) and ADSP for their input. For full acknowledgement session, refer to <ext-link ext-link-type="uri" xlink:href="https://www.niagads.org/adsp/content/acknowledgement-statement/">https://www.niagads.org/adsp/content/acknowledgement-statement/</ext-link>.</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>This work is supported by the National Institute on Aging (U54-AG052427, U01-AG032984, U24-AG041689).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>References</title>
    <ref id="bty894-B1">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Chandran</surname><given-names>S.</given-names></name><etal>et al</etal></person-group> (<year>2018</year>) <comment>uBAM-unmapped BAM format</comment>, <ext-link ext-link-type="uri" xlink:href="https://software.broadinstitute.org/gatk/documentation/article?id=11008">https://software.broadinstitute.org/gatk/documentation/article?id=11008</ext-link>.</mixed-citation>
    </ref>
    <ref id="bty894-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>DePristo</surname><given-names>M.A.</given-names></name><etal>et al</etal></person-group> (<year>2011</year>) 
<article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>. <source>Nat. Genet.</source>, <volume>43</volume>, <fpage>491</fpage>–<lpage>498</lpage>.<pub-id pub-id-type="pmid">21478889</pub-id></mixed-citation>
    </ref>
    <ref id="bty894-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Farek</surname><given-names>J.</given-names></name><etal>et al</etal></person-group> (<year>2018</year>) 
<article-title>xAtlas: scalable small variant calling across heterogeneous next-generation sequencing experiments.</article-title><source>bioRxiv</source>, <comment>doi: 10.1101/295071</comment>.</mixed-citation>
    </ref>
    <ref id="bty894-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Faust</surname><given-names>G.G.</given-names></name>, <name name-style="western"><surname>Hall</surname><given-names>I.M.</given-names></name></person-group> (<year>2014</year>) 
<article-title>SAMBLASTER: fast duplicate marking and structural variant read extraction</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>2503</fpage>–<lpage>2505</lpage>.<pub-id pub-id-type="pmid">24812344</pub-id></mixed-citation>
    </ref>
    <ref id="bty894-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H.</given-names></name></person-group> (<year>2013</year>) 
<article-title>Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM</article-title>. <source>arXiv preprint</source>, <volume>1303</volume>, <fpage>3997</fpage>.</mixed-citation>
    </ref>
    <ref id="bty894-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H.</given-names></name><etal>et al</etal></person-group> (<year>2009</year>) 
<article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>2078</fpage>–<lpage>2079</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="bty894-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McKenna</surname><given-names>A.</given-names></name><etal>et al</etal></person-group> (<year>2010</year>) 
<article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome Res.</source>, <volume>20</volume>, <fpage>1297</fpage>–<lpage>1303</lpage>.<pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="bty894-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tarasov</surname><given-names>A.</given-names></name><etal>et al</etal></person-group> (<year>2015</year>) 
<article-title>Sambamba: fast processing of NGS alignment formats</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>2032</fpage>–<lpage>2034</lpage>.<pub-id pub-id-type="pmid">25697820</pub-id></mixed-citation>
    </ref>
    <ref id="bty894-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Voss</surname><given-names>K.</given-names></name><etal>et al</etal></person-group> (<year>2017</year>) 
<article-title>Full-stack genomics pipelining with GATK4 + WDL + Cromwell</article-title>. <source>F1000Res.</source>, <volume>6</volume>, <fpage>1379</fpage>.</mixed-citation>
    </ref>
    <ref id="bty894-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Regier</surname><given-names>A.A.</given-names></name><etal>et al</etal></person-group> (<year>2018</year>) 
<article-title>Functional equivalence of genome sequencing analysis pipelines enables harmonized variant calling across human genetics projects.</article-title><source>bioRxiv</source>, <comment>doi: 10.1101/269316</comment>.</mixed-citation>
    </ref>
  </ref-list>
</back>
