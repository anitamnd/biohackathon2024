<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4699372</article-id>
    <article-id pub-id-type="pmid">26673418</article-id>
    <article-id pub-id-type="publisher-id">843</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-015-0843-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Quality control, modeling, and visualization of CRISPR screens with MAGeCK-VISPR</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Li</surname>
          <given-names>Wei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Köster</surname>
          <given-names>Johannes</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xu</surname>
          <given-names>Han</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Chen-Hao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xiao</surname>
          <given-names>Tengfei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Jun S.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Brown</surname>
          <given-names>Myles</given-names>
        </name>
        <address>
          <email>myles_brown@dfci.harvard.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff3"/>
        <xref ref-type="aff" rid="Aff6"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Liu</surname>
          <given-names>X. Shirley</given-names>
        </name>
        <address>
          <email>xsliu@jimmy.harvard.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff7"/>
      </contrib>
      <aff id="Aff1"><label/>Department of Biostatistics and Computational Biology, Dana-Farber Cancer Institute, Harvard T.H. Chan School of Public Health, Boston, MA 02215 USA </aff>
      <aff id="Aff2"><label/>Center for Functional Cancer Epigenetics, Dana-Farber Cancer Institute, Boston, MA 02215 USA </aff>
      <aff id="Aff3"><label/>Division of Molecular and Cellular Oncology, Department of Medical Oncology, Dana-Farber Cancer Institute, Boston, MA 02215 USA </aff>
      <aff id="Aff4"><label/>Broad Institute of MIT and Harvard, 7 Cambridge Center, Cambridge, MA 02142 USA </aff>
      <aff id="Aff5"><label/>Department of Statistics, Harvard University, Science Center 715, 1 Oxford Street, Cambridge, MA 02138 USA </aff>
      <aff id="Aff6"><label/>Department of Medicine, Brigham and Women’s Hospital and Harvard Medical School, Boston, MA 02215 USA </aff>
      <aff id="Aff7"><label/>School of Life Science and Technology, Tongji University, Shanghai, 200092 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>12</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>12</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2015</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>281</elocation-id>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>7</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>11</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Li et al. 2015</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p>High-throughput CRISPR screens have shown great promise in functional genomics. We present MAGeCK-VISPR, a comprehensive quality control (QC), analysis, and visualization workflow for CRISPR screens. MAGeCK-VISPR defines a set of QC measures to assess the quality of an experiment, and includes a maximum-likelihood algorithm to call essential genes simultaneously under multiple conditions. The algorithm uses a generalized linear model to deconvolute different effects, and employs expectation-maximization to iteratively estimate sgRNA knockout efficiency and gene essentiality. MAGeCK-VISPR also includes VISPR, a framework for the interactive visualization and exploration of QC and analysis results. MAGeCK-VISPR is freely available at <ext-link ext-link-type="uri" xlink:href="http://bitbucket.org/liulab/mageck-vispr">http://bitbucket.org/liulab/mageck-vispr</ext-link>.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s13059-015-0843-6) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>CRISPR/Cas9</kwd>
      <kwd>Screening</kwd>
      <kwd>Maximum likelihood</kwd>
      <kwd>Expectation-Maximization</kwd>
      <kwd>Negative binomial</kwd>
      <kwd>Data-driven documents</kwd>
      <kwd>D3</kwd>
      <kwd>Visualization</kwd>
      <kwd>Quality control</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health (US)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U01 CA180980</award-id>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health (US)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01 GM113242-01</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Jun S.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation (US)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DMS-1120368</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Jun S.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100007886</institution-id>
            <institution>Dana-Farber Cancer Institute (US)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Claudia Adams Barr Award in Innovative Basic Cancer Research</award-id>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>National Human Genome Research Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01 HG008728</award-id>
        <award-id>R01 HG008728</award-id>
        <principal-award-recipient>
          <name>
            <surname>Brown</surname>
            <given-names>Myles</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2015</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Background</title>
    <p>The clustered regularly interspaced short palindromic repeats (CRISPR)/Cas9 system is a powerful genetic engineering technique, allowing direct modifications of genomic loci in most model organisms in a cost-effective way. Based on this system, the recent development of high-throughput CRISPR screening technology has shown great promise in functional genomics, allowing researchers to systematically identify genes associated with various phenotypes [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref>]. CRISPR screens can be performed by either direct knockout of genes using CRISPR/Cas9 [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], or perturbing gene expressions using CRISPR and a dead-Cas9 (dCas9) fused with activation or repression effectors [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p>While CRISPR screening is a powerful technique, it creates computational challenges that include: (1) how to evaluate the data quality; (2) how to identify gene or pathway hits from the screens and assess their statistical significance; and (3) how to visualize and explore the screening results efficiently. Until now, a comprehensive quality control (QC), data analysis, and visualization method for CRISPR screen was not available. Several algorithms are developed for screening analysis on microarray or high-throughput sequencing data, such as RIGER [<xref ref-type="bibr" rid="CR7">7</xref>], RSA [<xref ref-type="bibr" rid="CR8">8</xref>], HitSelect [<xref ref-type="bibr" rid="CR9">9</xref>], as well as the MAGeCK algorithm we previously developed [<xref ref-type="bibr" rid="CR10">10</xref>]. These algorithms are designed based on a comparison of two conditions, although many screens are conducted simultaneously across several time points, under many treatment conditions or over many cell lines. In addition, these algorithms do not consider the knockout efficiency of single guide RNAs (sgRNA) on target genes. The knockout efficiency is the ability of a sgRNA to induce cutting events that lead to the knockout of the targeted gene. It is influenced by sgRNA sequence content [<xref ref-type="bibr" rid="CR11">11</xref>], chromatin accessibility and exon position of the targeting gene [<xref ref-type="bibr" rid="CR12">12</xref>], and so on.</p>
    <p>In this study, we present MAGeCK-VISPR to overcome the computational challenges of CRISPR screens. MAGeCK-VISPR (1) defines a set of QC measurements and (2) extends the MAGeCK algorithm by a maximum likelihood estimation method (MAGeCK-MLE) to call essential genes under multiple conditions while considering sgRNA knockout efficiency. Further, MAGeCK-VISPR (3) provides a web-based visualization framework (VISPR) for interactive exploration of CRISPR screen quality control and analysis results. MAGeCK-VISPR employs a Snakemake [<xref ref-type="bibr" rid="CR13">13</xref>] workflow to combine MAGeCK and VISPR in a scalable and reproducible way (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><p>An overview of the MAGeCK-VISPR workflow. Given FASTQ files and an sgRNA design, the workflow employs several preprocessing steps, including using FastQC and MAGeCK to collect quality control metrics and calculate per-sgRNA read counts. Then, either MAGeCK-RRA or MAGeCK-MLE is used to determine essential genes under user-defined conditions. Finally, results are composed for visualization and interactive exploration in VISPR</p></caption><graphic xlink:href="13059_2015_843_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results and discussion</title>
    <sec id="Sec3">
      <title>Quality control measurements for CRISPR screening experiments</title>
      <p>Apart from the determination of essential genes with MAGeCK, a central purpose of MAGeCK-VISPR is to collect quality control (QC) measurements at various levels (<ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc">http://www.bioinformatics.babraham.ac.uk/projects/fastqc</ext-link>). The proposed measurements (Table <xref rid="Tab1" ref-type="table">1</xref>) can be divided into four categories: sequence level, read count level, sample level, and gene level (Fig. <xref rid="Fig2" ref-type="fig">2</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Quality control (QC) measures from MAGeCK-VISPR</p></caption><table frame="hsides" rules="groups"><thead><tr><th>QC term</th><th>Description</th><th>Expected</th></tr></thead><tbody><tr><td>GC content</td><td>GC content distribution of the sequencing reads</td><td>Similar distribution for all samples from same library</td></tr><tr><td>Base quality</td><td>Base quality distribution of the sequencing reads</td><td>Single-peak distribution with median base quality at least 25</td></tr><tr><td>Sequencing reads</td><td>Total number of sequencing reads</td><td>Varies depending on sequencing platform</td></tr><tr><td>Mapped reads</td><td>Total number of reads mapped to the sgRNA library</td><td>300 * (number of sgRNAs)</td></tr><tr><td>% Mapped reads</td><td>Percentage of mapped reads to the total number of sequencing reads</td><td>At least 65 %</td></tr><tr><td>Zero sgRNAs</td><td>Number of sgRNAs with zero read counts</td><td>At most 1 % of total sgRNAs</td></tr><tr><td>Gini index</td><td>Gini index of log-scaled read count distributions</td><td>At most 0.1 for plasmid or initial state samples, and at most 0.2 for negative selection samples</td></tr><tr><td>Sample correlation</td><td>Pearson correlation coefficient between samples</td><td>At least 0.8 for replicates</td></tr><tr><td>Correlation clustering or PCA clustering</td><td>Hierarchical clustering of samples or first three PCA components</td><td>Samples with similar conditions should cluster together</td></tr><tr><td>Ribosomal gene selection</td><td>Negative selection enrichment statistics of ribosomal genes</td><td>Significant <italic>P</italic> values (&lt;0.001) for ribosomal subunit (GO:0044391) in negative selection experiments</td></tr></tbody></table></table-wrap><fig id="Fig2"><label>Fig. 2</label><caption><p>The quality control (QC) view of VISPR, the visualization framework of MAGeCK-VISPR. The measurements include the distribution of GC content (<bold>a</bold>), median base quality (<bold>b</bold>), the distribution of mean sequence quality (<bold>c</bold>), the number of zero-count sgRNAs (<bold>d</bold>), Gini-index (<bold>e</bold>), total number of reads and the percentage of mapped reads (<bold>f</bold>), Principle Component Analysis (PCA) plot (<bold>g</bold>), normalized read count distribution (<bold>h</bold>, <bold>i</bold>), and pairwise sample correlations (<bold>j</bold>). Shown results are from ESC (<bold>a</bold>-<bold>f</bold>) and melanoma dataset (<bold>g</bold>-<bold>j</bold>)</p></caption><graphic xlink:href="13059_2015_843_Fig2_HTML" id="MO2"/></fig></p>
      <p>Sequence level QC measurements aim to detect problems with the sequencing, similar as in other next-generation sequencing (NGS) experiments. Two measurements are reported: sample GC content distribution (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>) and the base quality distribution of sequencing reads (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>, <xref rid="Fig2" ref-type="fig">c</xref>). Ideally, sequencing reads should have reasonable base qualities (median value &gt;25), and samples from the same experiment should have similar GC content distributions.</p>
      <p>The second level of QC measurements is based on the sgRNA read counts collected from MAGeCK. Raw sequencing reads are first mapped to sgRNA sequences in the library with no mismatches tolerated. After that, the number of sequencing reads, mapped reads (and thereof the percentage of mapped reads), sgRNAs with zero read count, and the Gini index of read count distribution are reported for each sample (Fig. <xref rid="Fig2" ref-type="fig">2d</xref>-<xref rid="Fig2" ref-type="fig">f</xref>). The percentage of mapped reads is a good indicator of sample quality, and low mappability could be due to sequencing error, oligonucleotide synthesis error, or sample contamination. Good statistical power of downstream analysis relies on sufficient reads (preferably over 300 reads) for each sgRNA, with low number of zero-count sgRNAs in the plasmid library or early time points. Gini index, a common measure of income inequality in economics, can measure the evenness of sgRNA read counts [<xref ref-type="bibr" rid="CR14">14</xref>]. It is perfectly normal for later time points in positive selection experiments to have higher Gini index since a few surviving clones (a few sgRNA with extreme high counts) could dominate the final pool while most of the other cells die (more sgRNAs with zero-count). In contrast, high Gini index in plasmid library, in early time points, or in negative selection experiments may indicate CRISPR oligonucleotide synthesis unevenness, low viral transfection efficiency, and over selection, respectively.</p>
      <p>Sample level QC (Fig. <xref rid="Fig2" ref-type="fig">2g</xref>-<xref rid="Fig2" ref-type="fig">j</xref>) checks the consistency between samples. MAGeCK-VISPR reports the distributions of normalized read counts by box plots and cumulative distribution functions. It also calculates pairwise Pearson correlations of sample log read counts, and draws the samples on the first three components of a Principle Component Analysis (PCA). Biological replicates or samples with similar conditions should have similar read count distributions and higher correlations, and appear closer to each other in the PCA plot. PCA plots can also identify potential batch effects if the screens are conducted under different batches.</p>
      <p>Finally, gene level QC determines the extent of negative selection in the screens. Since knocking out ribosomal genes lead to a strong negative selection phenotype [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], the significance of negative selection on ribosomal genes can be evaluated in MAGeCK-VISPR by Gene Ontology (GO) enrichment analysis using GOrilla [<xref ref-type="bibr" rid="CR15">15</xref>]. A working negative selection experiment should have a significant <italic>P</italic> value (&lt;0.001), although many good experiments could have much smaller <italic>P</italic> values (&lt;1e-10, see Section A of Additional file <xref rid="MOESM1" ref-type="media">1</xref>).</p>
    </sec>
    <sec id="Sec4">
      <title>Calling essential genes under multiple conditions with MAGeCK-MLE</title>
      <p>MAGeCK-VISPR includes a new algorithm, ‘MAGeCK-MLE’, to estimate the essentiality of genes in various screening conditions using a maximum likelihood estimation (MLE) approach. Compared with the original MAGeCK algorithm using Robust Rank Aggregation (‘MAGeCK-RRA’) that can only compare samples between two conditions, MAGeCK-MLE is able to model complex experimental designs. Furthermore, MAGeCK-MLE explicitly models the sgRNA knockout efficiency, which may vary depending on different sequence contents and chromatin structures [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. In MAGeCK-MLE, the read count of a sgRNA <italic>i</italic> targeting gene <italic>g</italic> in sample <italic>j</italic> is modeled as a Negative Binomial (NB) random variable. The mean of the NB distribution (<italic>μ</italic><sub><italic>ij</italic></sub>) is dependent on three factors: the sequencing depth of sample <italic>j</italic> (<italic>s</italic><sub><italic>j</italic></sub>), the knockout efficiency of sgRNA <italic>i</italic>, and a linear combination of the effects in different conditions (that is, different drug treatments) on gene <italic>g</italic>. If sgRNA <italic>i</italic> knocks out target gene <italic>g</italic> efficiently, then <italic>μ</italic><sub><italic>ij</italic></sub> is modeled as:<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mu}_{ij}={s}_j\  exp\left({\beta}_{i0}+{\displaystyle \sum_r}{d}_{jr}{\beta}_{gr}\right) $$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mspace width="0.25em"/><mml:mi mathvariant="italic">exp</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo stretchy="true">∑</mml:mo><mml:mi>r</mml:mi></mml:munder></mml:mstyle><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2015_843_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The effects of <italic>r</italic> different conditions are represented as the score ‘<italic>β</italic><sub><italic>gr</italic></sub>’, a measurement of gene selections similar to the term of ‘log fold change’ in differential expression analysis. The presence or absence of each condition on each sample is encoded into binary elements of the <italic>design matrix d</italic><sub><italic>jr</italic></sub>, and can be obtained from experiment designs. ‘<italic>β</italic>’ scores reflect the extent of selection in each condition: <italic>β</italic><sub><italic>gr</italic></sub> &gt;0 (or &lt;0) means <italic>g</italic> is positively (or negatively) selected in condition <italic>r. μ</italic><sub><italic>ij</italic></sub> is also dependent on <italic>β</italic><sub><italic>i</italic>0</sub>, the initial sgRNA abundance which is usually measured in plasmid or the day 0 of the experiment.</p>
      <p>The values of <italic>β</italic>, together with the information whether an sgRNA is efficient, can be estimated by maximizing the joint log-likelihood of observing all sgRNA read counts of <italic>g</italic> on all different samples, and are optimized using an Expectation-Maximization (EM) algorithm. In the EM algorithm, MAGeCK-MLE iteratively determines the knockout efficiency of each sgRNA based on the current estimation of ‘<italic>β</italic>’ scores (the E step), and uses the updated knockout efficiency information to re-calculate ‘<italic>β</italic>’ scores (the M step). By examining the patterns of read counts of each sgRNA across all samples, the EM algorithm minimizes the effect of inefficient sgRNAs. A detailed description of the method is presented in the Methods section.</p>
      <p>We tested MAGeCK algorithms on four public datasets. The first two datasets (the ‘ESC’ and ‘leukemia’ dataset) correspond to negative selection experiments on mouse embryonic stem cells (ESCs) and two human leukemia cell lines (KBM7 and HL-60), respectively (Fig. <xref rid="Fig3" ref-type="fig">3a</xref> and <xref rid="Fig3" ref-type="fig">b</xref>) [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR4">4</xref>]. In both datasets, cells were grown with their natural growing condition and negative selections occurred in cells after CRISPR/Cas9 is activated. The other two datasets (‘melanoma’ knockout and activation dataset) are different CRISPR screens on the human melanoma cell line A375 that harbors a BRAF V600E mutation (Figs. <xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref>). The cells were treated with BRAF inhibitor vemurafenib (PLX) or dimethyl sulfoxide (DMSO) control, and screened either with GeCKO [<xref ref-type="bibr" rid="CR2">2</xref>] or with CRISPR/dCas9 Synergistic Activation Mediator (SAM) libraries [<xref ref-type="bibr" rid="CR5">5</xref>]. These two datasets include multiple experimental conditions that are difficult to compare directly using the original MAGeCK-RRA algorithm. In the melanoma knockout dataset, cells were under 7-day or 14-day selection [<xref ref-type="bibr" rid="CR2">2</xref>]. In the melanoma activation dataset, two different drugs (puromycin and zeocin) were used to select cells with lentiviral infection, and both DMSO and PLX treatments were profiled under 3-day or 21-day selection [<xref ref-type="bibr" rid="CR5">5</xref>].<fig id="Fig3"><label>Fig. 3</label><caption><p>The gene essentiality scores (<italic>β</italic> scores) reported from MAGeCK-MLE on two conditions. <bold>a</bold>, <bold>b</bold> the <italic>β</italic> scores of two leukemia cell lines in the leukemia dataset (<bold>a</bold>), and two biological replicates of mouse ESC cells in the ESC dataset (<bold>b</bold>). In (<bold>a</bold>), some well-known driver genes and cell type-specific genes are also labeled. These genes may play distinct roles in two different leukemia subtypes (HL60: acute myeloid leukemia; KBM7: chronic myeloid leukemia), including CDK6 and TRIB1 for HL60, and RUNX1 in KBM7. CDK6 is required in AML growth [<xref ref-type="bibr" rid="CR17">17</xref>] and TRIB1 over-expression is observed in AML patients compared with CML patients [<xref ref-type="bibr" rid="CR18">18</xref>]. On the other hand, the frequent RUNX1 loss-of-function mutations are observed in CML to AML transformations [<xref ref-type="bibr" rid="CR19">19</xref>]. <bold>c</bold> An illustration of differentially selected genes identified by two-condition comparison algorithms (like RRA, blue rectangles). MAGeCK-MLE can further distinguish cell type-specific genes (red dots) from other genes. Cell type-specific genes are genes having no essentiality in one condition but strong essentiality in the other, and are usually more biologically interesting</p></caption><graphic xlink:href="13059_2015_843_Fig3_HTML" id="MO3"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>The <italic>β</italic> scores of MAGeCK-MLE on the melanoma knockout dataset. <bold>a</bold> A k-means clustering view of <italic>β</italic> scores of all conditions from top selected genes (k = 4). Only genes with the highest or lowest 1 % <italic>β</italic> scores in DMSO or PLX 14-day treatment conditions are shown. <bold>b</bold> The distribution of scores across four conditions using different algorithms. The red rectangle in MAGeCK-MLE indicates genes in cluster 4 in Fig. 4a, or genes that are strongly positively selected in PLX 14-day condition. Some validated genes in the original study are marked as red dots, including NF1, NF2, MED12, and CUL3</p></caption><graphic xlink:href="13059_2015_843_Fig4_HTML" id="MO4"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>The <italic>β</italic> scores of MAGeCK-MLE on the melanoma activation dataset. <bold>a</bold> A k-means clustering view of <italic>β</italic> scores of all conditions from top selected genes (k = 5). Only genes with the highest or lowest 1 % <italic>β</italic> scores in DMSO or PLX 21-day treatment conditions are shown. <bold>b</bold> the average <italic>β</italic> scores of genes in cluster 5 of A (consistently positive selected genes in both zeocin and puromycin conditions), as well as the <italic>β</italic> scores of these genes in melanoma knockout dataset. Similar to (<bold>a</bold>), the k-means clustering algorithm is applied to the selected genes (k = 4)</p></caption><graphic xlink:href="13059_2015_843_Fig5_HTML" id="MO5"/></fig></p>
      <p>In two-condition comparisons, MAGeCK-MLE gives similar results with existing methods such as MAGeCK-RRA, RSA, and RIGER. All the algorithms identified genes that are commonly essential to different cell types [<xref ref-type="bibr" rid="CR16">16</xref>], as well as known positively selected genes in PLX treated conditions in two melanoma datasets (Fig. <xref rid="Fig3" ref-type="fig">3</xref>; also see Section A and B of Additional file <xref rid="MOESM1" ref-type="media">1</xref>). In the leukemia dataset, two-condition comparison algorithms (like MAGeCK-RRA) identified genes that are differentially selected in two cell lines by a direct comparison of HL60 and KBM7 (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>) [<xref ref-type="bibr" rid="CR10">10</xref>]. However, not all of these genes are equally biologically interesting, as MAGeCK-MLE further distinguished them into two groups: genes having little effect in one (β scores close to zero) but strong selection effect in the other cell line (large absolute β scores), and genes having weak and opposite effects in two cell lines (Fig. <xref rid="Fig3" ref-type="fig">3c</xref>). The first group of genes are often more biologically interesting as they are cell type-specific genes. This includes some well-known driver genes (like BCR in KBM7) as well as genes that may be functional in only one cell type: CDK6 and TRIB1 in HL60 [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>], and RUNX1 in KBM7 [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
      <p>One of the advantages of MAGeCK-MLE over other methods is that it enables accurate comparisons of gene essentialities across multiple conditions and experiments in one run (Fig. <xref rid="Fig4" ref-type="fig">4</xref> and Section C of Additional file <xref rid="MOESM1" ref-type="media">1</xref>). In the melanoma knockout dataset, a k-means clustering of the β scores of top selected genes demonstrated that these genes have various essentialities across conditions (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>). Some of the genes are universally positively or negatively selected in all conditions (cluster 3), while others have different essentiality across different conditions (clusters 1, 2, and 4). Genes in cluster 4 are particularly interesting as they show strong positive selection in 14-day PLX treated condition. Indeed, genes whose knockout leads to strong positive selection in PLX-treated cells are in cluster 4, including NF1, NF2, MED12, CUL3 [<xref ref-type="bibr" rid="CR2">2</xref>]. In contrast, the k-means clusters of measurements from other algorithms did not reveal the strong effect of genes in cluster 4 (Section C of Additional file <xref rid="MOESM1" ref-type="media">1</xref>). This is because their score distributions are similar across different conditions (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>), and do not reflect the fact that the one condition (PLX 14-day treatment) induces much stronger positive selection than other conditions [<xref ref-type="bibr" rid="CR2">2</xref>]. This is partly because MAGeCK-RRA, RIGER, and RSA all use a rank-based method to compare sgRNA between two conditions, which may lose quantitative information.</p>
      <p>Another example of using MAGeCK-MLE on multiple conditions is demonstrated in the melanoma activation dataset, where cells underwent different selection methods (using puromycin or zeocin), drug treatments (DMSO or PLX), and durations (3-day or 21-day treatment) (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). Similar to the melanoma knockout dataset, we performed k-means clustering of the top-selected gene β scores. Many positively selected genes are dependent on the selection method, which might not be biologically interesting. For example, genes in clusters 2 and 4 correspond to positively selected genes that are specific to puromycin or zeocin selection, respectively. A small set of genes (cluster 5) are consistently selected in both zeocin and puromycin, including genes that are validated in the original study, for example, EGFR, GPR35, LPAR1/5 [<xref ref-type="bibr" rid="CR5">5</xref>]. We further examined the genes in cluster 5 (Fig. <xref rid="Fig5" ref-type="fig">5b</xref>), and focused on genes positively selected in the CRISPR activation experiment but strongly negatively selected in the knockout experiment. These genes include EGFR and BRAF, two known kinases that drive melanoma progression and PLX resistance [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>], and CRKL, a protein kinase that activates RAS and JUN pathway. CRKL amplification is reported to lead to drug resistance against EGFR inhibitors by activating EGFR downstream pathways [<xref ref-type="bibr" rid="CR22">22</xref>], implying its potential role in PLX drug resistance.</p>
    </sec>
    <sec id="Sec5">
      <title>Visualization of QC measurements and gene essentiality with VISPR</title>
      <p>VISPR (VISualization of crisPR screens) is a web-based frontend for interactive visualization of CRISPR screen QC and comparison results. Interactive access is provided by an HTML5 based browser interface, while visualizations are realized with Vega [<xref ref-type="bibr" rid="CR23">23</xref>], a declarative visualization grammar on top of Data-Driven Documents (D3) [<xref ref-type="bibr" rid="CR24">24</xref>]. VISPR provides three types of views for interactive exploration of CRISPR screening: a quality control view, a result view, and an experiment comparison view. The quality control view shows the QC measurements described before (Fig. <xref rid="Fig2" ref-type="fig">2</xref>).</p>
      <p>In the result view, screening results can be interactively explored. It contains a table showing the comparison results of each gene (Fig. <xref rid="Fig6" ref-type="fig">6a</xref>). The table can be sorted by different columns and filtered (from ‘Search’) via gene names or regular expressions. Further, the distribution of <italic>P</italic> values is displayed as cumulative distribution function (CDF) (Fig. <xref rid="Fig6" ref-type="fig">6b</xref>) and as a histogram (Fig. <xref rid="Fig6" ref-type="fig">6c</xref>). For each gene, the normalized sgRNA counts in all samples can be displayed in a parallel coordinate visualization (Fig. <xref rid="Fig6" ref-type="fig">6d</xref>). If available, knockout efficiency predictions [<xref ref-type="bibr" rid="CR11">11</xref>] and gene coordinates of each sgRNA are displayed as separate axes. Axes can be reordered or toggled on or off, and sgRNAs can be highlighted by selecting ranges on each axis. Genes selected in the table are highlighted in the CDF, allowing to assess their occurrence within the <italic>P</italic> value distribution of all genes.<fig id="Fig6"><label>Fig. 6</label><caption><p>The result and comparison views of VISPR. The result view includes a gene comparison table (<bold>a</bold>), the distribution of <italic>P</italic> values as CDF (<bold>b</bold>) and histogram (<bold>c</bold>), and the normalized sgRNA counts in all samples of selected genes along with chromosome positions and predicted efficiency (<bold>d</bold>). The comparison view of VISPR (<bold>e</bold>) displays the overlap between significant genes under different selectable conditions and experiments as an Euler diagram. Shown results are from ESC (<bold>a</bold>, <bold>d</bold>) and melanoma dataset (<bold>b</bold>, <bold>c</bold>, <bold>e</bold>) </p></caption><graphic xlink:href="13059_2015_843_Fig6_HTML" id="MO6"/></fig></p>
      <p>VISPR provides various ways to further explore the analysis results. Individual genes can be viewed in Ensembl [<xref ref-type="bibr" rid="CR25">25</xref>] and IGV [<xref ref-type="bibr" rid="CR26">26</xref>]. Selected genes can be visualized in terms of their interaction network and function via GeneMANIA [<xref ref-type="bibr" rid="CR27">27</xref>]. Functional analysis can be performed with GOrilla [<xref ref-type="bibr" rid="CR15">15</xref>], an online Gene Ontology (GO) enrichment analysis tool. GOrilla takes a ranked list of genes (here based on the <italic>P</italic> values reported by MAGeCK) to perform a threshold-free enrichment analysis. The resulting GO term enrichments can be further used for gene-level quality control.</p>
      <p>The comparison view of VISPR can compare different experiments by visualizing the common and exclusive significant genes via Euler diagrams (Fig. <xref rid="Fig6" ref-type="fig">6e</xref>). Clicking on segments of the Euler diagram opens the result views of the corresponding experiments. For example, clicking on the intersection between two experiments will open ‘restricted’ result views for each experiment, where only the common significant genes are displayed. These views provide the same features as the unconstrained result views described above. However, in this case, GO enrichment analysis with GOrilla is performed with the shown genes (that is, the genes from the intersection) as foreground and the other genes of the experiment as background.</p>
      <p>The visualizations displayed in VISPR can be downloaded as publication-ready SVG files. In addition, a command line interface is provided to store visualizations as Vega specifications. This format allows users to modify and style the output of VISPR programmatically.</p>
    </sec>
    <sec id="Sec6">
      <title>Implementation of the MAGeCK-VISPR workflow with Snakemake</title>
      <p>We implemented the MAGeCK-VISPR workflow with the workflow management system Snakemake [<xref ref-type="bibr" rid="CR13">13</xref>], allowing an automatic execution of some or all of the MAGeCK-VISPR functions: quality control, essential gene analysis, and visualization. Choosing a workflow management system like Snakemake has several advantages. First, the workflow steps can be automatically parallelized and executed on workstations, servers, and compute clusters without the modification of the workflow. Second, Snakemake tracks metadata (like creation date, input, and log files) for all generated result and intermediate files. This way, used data, methods, and parameters are documented comprehensively for each analysis (also called data provenance), an important requirement of reproducible science. MAGeCK-VISPR provides a command line interface to initialize the workflow in a given work directory. This installs the workflow definition as a so-called <italic>Snakefile</italic>, along with a configuration file and documentation. The configuration file is used to define locations of raw data and additional parameters for MAGeCK-VISPR. Once configured, the Snakefile can be executed with Snakemake. Since the Snakefile is installed into the given work directory, it can be easily modified or extended by the user.</p>
      <p>We provide all components of the workflow as Conda packages [<xref ref-type="bibr" rid="CR28">28</xref>], such that MAGeCK-VISPR can be installed with a single command. Optionally, the Conda package manager can create isolated environments for the workflow to, for example, freeze or compare different software versions or publish snapshots of a MAGeCK-VISPR workflow instance along with all data and used software. This further increases the reproducibility of the generated results.</p>
    </sec>
  </sec>
  <sec id="Sec7" sec-type="conclusion">
    <title>Conclusion</title>
    <p>The recently developed CRISPR screening is a powerful technology in functional studies with different foci, including tumor progression and metastasis [<xref ref-type="bibr" rid="CR29">29</xref>], drug resistance [<xref ref-type="bibr" rid="CR3">3</xref>], immune response [<xref ref-type="bibr" rid="CR30">30</xref>], and stem cell differentiation [<xref ref-type="bibr" rid="CR4">4</xref>]. To our knowledge, MAGeCK-VISPR is the first comprehensive pipeline developed for quality control, analysis, and visualization of CRISPR screens, and highlights new features compared with existing screening analysis algorithms. For example, a typical CRISPR screening experiment usually includes complex designs that are difficult to analyze using existing algorithms, as they are all designed for two-condition comparisons. To address this challenge, MAGeCK-VISPR uses a maximum likelihood approach to estimate the effect of different conditions using a generalized linear model (GLM). It also incorporates sgRNA knockout efficiency information by using a probabilistic mixture model. We demonstrated that MAGeCK-MLE provides additional insights into cell type-specific essential genes and is able to compare gene essentiality scores across conditions or even experiments. Also, MAGeCK-VISPR is able to handle screens of different types including CRISPR knockout and CRISPR activation screens, and can be potentially applied to high-throughput sequencing datasets of traditional RNA interference (RNAi) screens.</p>
    <p>The MAGeCK-MLE approach is able to estimate sgRNA knockout efficiencies from CRISPR screens besides gene essentiality. We previously reported that sequence-specific features learned from CRISPR screening data helped the design of efficient sgRNAs [<xref ref-type="bibr" rid="CR11">11</xref>]. With more CRISPR screen data becoming available, the algorithm will help us identify sgRNAs with the best behavior and learn patterns of ‘good’ sgRNAs. The information will further guide the design of optimized sgRNAs for CRISPR screens and individual gene knockouts.</p>
    <p>One potential limitation of MAGeCK-MLE is that its EM algorithm uses an iterative process involving matrix operations, making it slower than our previous MAGeCK RRA method and other competing algorithms. Future approaches to speed up MAGeCK-MLE include improving parametric tests for <italic>P</italic> value estimation (instead of using permutation) and implementing the algorithm in Cython instead of Python. Another potential limitation of MAGeCK-VISPR on the quality control assessment is that the current QC thresholds for ‘successful’ experiments are determined heuristically due to limited number of publicly available CRISPR screening datasets. We and other researchers have previously reported that bigger collections of ChIP-seq datasets provide better criteria on ChIP-seq quality control [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. As more public CRISPR screening datasets become available, the QC metrics (and other parts of MAGeCK-VISPR) can be further refined.</p>
    <p>As CRISPR screens become more popular, complications in the data such as batch effects will be unavoidable which need proper correction for meaningful downstream analysis. Existing batch removal algorithms, including ComBat [<xref ref-type="bibr" rid="CR33">33</xref>] and RUVseq [<xref ref-type="bibr" rid="CR34">34</xref>], have been widely used to remove batch effects in gene expression analysis. In the future, these algorithms can be integrated into MAGeCK-VISPR pipeline. After that, MAGeCK-VISPR will be able to identify cancer- and disease-specific essential genes by a direct comparison between different datasets or experiments, providing potentially new therapeutic insights into the mechanisms of diseases and cancers.</p>
  </sec>
  <sec id="Sec8" sec-type="materials|methods">
    <title>Methods</title>
    <sec id="Sec9">
      <title>MAGeCK-MLE: a maximum likelihood approach for essential gene detection</title>
      <sec id="Sec10">
        <title>The Negative Binomial model for high-throughput CRISPR screening read counts</title>
        <p>After read mapping, the sequencing results of CRISPR screening are presented as a read count table, where rows correspond to sgRNAs and columns correspond to samples. Read counts generated from high-throughput sequencing data have higher variances when a high number of read counts are observed (also called ‘over-dispersion’). This is usually modeled using Negative Binomial (NB) distribution, such as in the statistical models used in many RNA-seq differential expression analysis algorithms: edgeR, DESeq/DESeq2, and so on [<xref ref-type="bibr" rid="CR35">35</xref>–<xref ref-type="bibr" rid="CR37">37</xref>]. MAGeCK-MLE uses a similar model; briefly, the read count of sgRNA <italic>i</italic> in sample <italic>j</italic>, or <italic>x</italic><sub><italic>ij</italic></sub>, is modeled as:<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {x}_{ij}\sim NB\left({\mu}_{ij},{\alpha}_i\right) $$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:math><graphic xlink:href="13059_2015_843_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Where <italic>μ</italic><sub><italic>ij</italic></sub> and <italic>α</italic><sub><italic>i</italic></sub> are the mean and over-dispersion factor of the NB distribution, respectively. The mean value <italic>μ</italic><sub><italic>ij</italic></sub> is further modeled as:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mu}_{ij}={s}_j{q}_{ij} $$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="13059_2015_843_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Where <italic>s</italic><sub><italic>j</italic></sub> is the size factor of sample <italic>j</italic> for adjusting sequencing depths of the samples, and q<sub>ij</sub> is a variable modeling the behavior of sgRNA <italic>i</italic> in sample <italic>j</italic> that will be discussed in later sections. <italic>s</italic><sub><italic>j</italic></sub> is calculated by the ‘median ratio method’ in MAGeCK and DESeq2 [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]:<disp-formula id="Equc"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {s}_j= media{n}_i\left\{\frac{x_{ij}}{{\hat{x}}_{i\cdot }}\right\} $$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="italic">media</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close="}" open="{"><mml:mfrac><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>⋅</mml:mo></mml:mrow></mml:msub></mml:mfrac></mml:mfenced></mml:math><graphic xlink:href="13059_2015_843_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Here, <inline-formula id="IEq1"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{x}}_i $$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq1.gif"/></alternatives></inline-formula> is the geometric mean of the read counts of sgRNA <italic>i</italic> across all <italic>J</italic> samples: <inline-formula id="IEq2"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{x}}_i={\left({\displaystyle \prod_{k=1}^J}{x}_{ik}\right)}^{1/J}. $$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:munderover></mml:mstyle><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="true">/</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:msup><mml:mtext>.</mml:mtext></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq2.gif"/></alternatives></inline-formula><italic>s</italic><sub><italic>j</italic></sub> can also be calculated based on a set of predefined ‘control’ sgRNAs instead of all sgRNAs. This is particularly useful when a majority of the genes in the library are supposed to be essential; in such cases it is not suitable to calculate <italic>s</italic><sub><italic>j</italic></sub> based on all sgRNAs. Both methods are implemented in MAGeCK-VISPR and users can specify which method to use.</p>
        <p>The over-dispersion factor <italic>α</italic><sub><italic>i</italic></sub> is calculated based on the regression residual and will be discussed in more details in the last Methods section.</p>
      </sec>
      <sec id="Sec11">
        <title>Modeling sgRNA knockout efficiency and complex experimental settings</title>
        <p>Different studies demonstrated that sgRNAs have various DNA cutting efficiencies [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR38">38</xref>], but such information is not considered in most essential gene calling algorithms (including MAGeCK). In MAGeCK-MLE, we use a binary variable <italic>π</italic><sub><italic>i</italic></sub> to model whether sgRNA <italic>i</italic> is efficient or not: <italic>π</italic><sub><italic>i</italic></sub> = 1 corresponds to an efficient sgRNA <italic>i</italic> and vice versa. Since <italic>π</italic><sub><italic>i</italic></sub> is unknown, the probability of observing a read count <italic>x</italic> from <italic>x</italic><sub><italic>ij</italic></sub> is a mixture of two distributions:<disp-formula id="Equd"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ P\left({x}_{ij}=x\right)=p\left({x}_{ij}=x\Big|{\pi}_i=1\right)p\left({\pi}_i=1\right)+p\left({x}_{ij}=x\Big|{\pi}_i=0\right)p\left({\pi}_i=0\right) $$\end{document}</tex-math><mml:math id="M14"><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2015_843_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>In CRISPR screening experiments, it is common to have cells treated with different conditions. For example in melanoma activation dataset [<xref ref-type="bibr" rid="CR5">5</xref>], cell lines underwent different sgRNA expression selection methods (cells are first selected using puromycin or zeocin), duration of treatment (3-day or 21-day treatment) and drug treatments (DMSO or PLX). For an efficient sgRNA <italic>i</italic> (<italic>π</italic><sub><italic>i</italic></sub> = 1), MAGeCK-MLE uses a generalized linear model (GLM) to model the effect of <italic>q</italic><sub><italic>ij</italic></sub> as a linear combination of effects from different sources:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{c}\hfill P\left({x}_{ij}=x\Big|{\pi}_i=1\right)\sim NB\left(x;{s}_j{q}_{ij},{\alpha}_i\right)\hfill \\ {}\hfill log\left({q}_{ij}\right)={\beta}_{i0}+{\displaystyle \sum_r}{d}_{jr}{\beta}_{gr}\hfill \end{array} $$\end{document}</tex-math><mml:math id="M16"><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>x</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi mathvariant="italic">log</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo stretchy="true">∑</mml:mo><mml:mi>r</mml:mi></mml:munder></mml:mstyle><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2015_843_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Here, <italic>β</italic><sub><italic>i</italic>0</sub> is the baseline abundance of sgRNA <italic>i</italic>, corresponding to its abundance in an initial state (in plasmid or day 0). <italic>d</italic><sub><italic>jr</italic></sub> is an element of a <italic>design matrix</italic> given by the user (explained later), and <italic>β</italic><sub><italic>gr</italic></sub> is the (unknown) coefficient that we would like to estimate.</p>
        <p>If sgRNA <italic>i</italic> is inefficient (<italic>π</italic><sub><italic>i</italic></sub> = 0), then its read counts in all samples are not determined by any experimental conditions except the baseline abundance:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{c}\hfill P\left({x}_{ij}=x\Big|{\pi}_i=0\right)\sim NB\left(x;{s}_j{q}_{ij},{\alpha}_i\right)\hfill \\ {}\hfill log{q}_{ij}={\beta}_{i0}\hfill \end{array} $$\end{document}</tex-math><mml:math id="M18"><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>x</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi mathvariant="italic">log</mml:mi><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2015_843_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec12">
        <title>The design matrix</title>
        <p>Design matrices have been used in many gene expression analysis algorithms for modeling complex experimental designs, including LIMMA [<xref ref-type="bibr" rid="CR39">39</xref>], VOOM [<xref ref-type="bibr" rid="CR40">40</xref>], DESeq2 [<xref ref-type="bibr" rid="CR37">37</xref>], and so on. The design matrix <italic>D</italic> models the combination of effects of different conditions. For <italic>J</italic> samples that are affected by <italic>R</italic> conditions, <italic>D</italic> is a <italic>J</italic> * <italic>R</italic> binary matrix with element <italic>d</italic><sub><italic>jr</italic></sub> = 1 if sample <italic>j</italic> is affected by condition <italic>R</italic>, and 0 otherwise. An example of the design matrix is presented in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
        <p>Based on the design matrix, the equations in (<xref rid="Equ2" ref-type="">2</xref>) and (<xref rid="Equ3" ref-type="">3</xref>) can be written in a matrix form. For a gene <italic>g</italic> with <italic>N</italic> sgRNAs in <italic>J</italic> samples, let <inline-formula id="IEq3"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{q}}_g $$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mover><mml:mi>q</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq3.gif"/></alternatives></inline-formula> be the vector of <italic>q</italic> values of all sgRNAs in all samples in gene <italic>g</italic>:<disp-formula id="Eque"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{q}}_g={\left({q}_{11},{q}_{21}, \dots, {q}_{N1},\dots, {q}_{1J},{q}_{2J},\dots, {q}_{NJ}\right)}^T $$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mover><mml:mi>q</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>21</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>J</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>J</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi>T</mml:mi></mml:msup></mml:math><graphic xlink:href="13059_2015_843_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>It can be written as:<disp-formula id="Equf"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \log \left({\overrightarrow{q}}_g\right)=D\hbox{'}*{\overrightarrow{\beta}}_g $$\end{document}</tex-math><mml:math id="M24"><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mover><mml:mi>q</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mi>'</mml:mi><mml:mo>*</mml:mo><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:math><graphic xlink:href="13059_2015_843_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Where <inline-formula id="IEq4"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{\beta}}_g $$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq4.gif"/></alternatives></inline-formula> is a <italic>N</italic> + <italic>r</italic> vector of <italic>β</italic> values in Equations (<xref rid="Equ2" ref-type="">2</xref>) and (<xref rid="Equ3" ref-type="">3</xref>). The first <italic>N</italic> elements of <inline-formula id="IEq5"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{\beta}}_g $$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq5.gif"/></alternatives></inline-formula> are the baseline abundances of <italic>N</italic> sgRNAs, and the following <italic>R</italic> elements of <inline-formula id="IEq6"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{\beta}}_g $$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq6.gif"/></alternatives></inline-formula> are the coefficients corresponding to <italic>R</italic> columns in the design matrix:<disp-formula id="Equg"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{\beta}}_g={\left({\beta}_{00},{\beta}_{10},\dots,\ {\beta}_{N0},{\beta}_1,\dots, {\beta}_r\right)}^T. $$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mi>T</mml:mi></mml:msup><mml:mtext>.</mml:mtext></mml:math><graphic xlink:href="13059_2015_843_Article_Equg.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>The binary <italic>extended design matrix D</italic>’ is used to set up the linear relationship between <inline-formula id="IEq7"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{\beta}}_g $$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq7.gif"/></alternatives></inline-formula> and <inline-formula id="IEq8"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{q}}_g $$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mover><mml:mi>q</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq8.gif"/></alternatives></inline-formula>, and can be derived directly from the design matrix. See Additional file <xref rid="MOESM1" ref-type="media">1</xref> for the definition and an example of <italic>D</italic>’.</p>
      </sec>
      <sec id="Sec13">
        <title>The EM approach</title>
        <p>MAGeCK-MLE uses a maximum likelihood estimation (MLE) approach to find the values of <inline-formula id="IEq9"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{\beta^{\ast}}}_g $$\end{document}</tex-math><mml:math id="M38" display="block"><mml:msub><mml:mrow><mml:mover><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo accent="false">→</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq9.gif"/></alternatives></inline-formula> The objective function of MAGeCK-MLE is:<disp-formula id="Equh"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left({\overrightarrow{\beta}}_g^{*},{\pi_i}^{*}\right)= arg\underset{\upbeta_{\mathrm{g}},\ {\pi}_i}{max}\left({\displaystyle \sum_{\begin{array}{c}\hfill i\in g,\ \hfill \\ {}\hfill j=1,\dots J\hfill \end{array}}} \log\ p\left({x}_{ij}\right)\ \right) $$\end{document}</tex-math><mml:math id="M40"><mml:mfenced close=")" open="(" separators=","><mml:msubsup><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:msup><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>*</mml:mo></mml:msup></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="italic">arg</mml:mi><mml:munder><mml:mi mathvariant="italic">max</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="normal">β</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mfenced close=")" open="("><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo stretchy="true">∑</mml:mo><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mi>J</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:munder></mml:mstyle><mml:mo>log</mml:mo><mml:mspace width="0.25em"/><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mspace width="0.25em"/></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2015_843_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Similar to DESeq2 [<xref ref-type="bibr" rid="CR37">37</xref>], MAGeCK-MLE also adds a prior <inline-formula id="IEq10"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ p\left({\overrightarrow{\beta}}_g\right) $$\end{document}</tex-math><mml:math id="M42"><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq10.gif"/></alternatives></inline-formula> that follows a normal distribution centered on zero in the objective function. Adding this prior makes sure <inline-formula id="IEq11"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{\beta^{\ast}}}_g $$\end{document}</tex-math><mml:math id="M44" display="block"><mml:msub><mml:mrow><mml:mover><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo accent="false">→</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq11.gif"/></alternatives></inline-formula> does not become arbitrarily large, when the sgRNA knockout efficiency is low and the differences of read counts between samples are high.</p>
        <p>The objective function can be maximized using expectation maximization (EM). At the beginning, we have an initial guess of <italic>p</italic>(<italic>π</italic><sub><italic>i</italic></sub> = 1). Subsequently, we iteratively update the values of <italic>p</italic>(<italic>π</italic><sub><italic>i</italic></sub> = 1) and <inline-formula id="IEq12"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overrightarrow{\beta} $$\end{document}</tex-math><mml:math id="M46"><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq12.gif"/></alternatives></inline-formula> in the E step and the M step, respectively.</p>
      </sec>
      <sec id="Sec14">
        <title>The initial guess of sgRNA knockout efficiency</title>
        <p>We demonstrated that the SSC (Spacer Scoring of CRISPR) algorithm accurately predicts sgRNA knockout efficiency from genomic sequence content [<xref ref-type="bibr" rid="CR11">11</xref>]. For each sgRNA, SSC generates an efficiency score in the range (−2,2). We scale the score linearly to the range (0,1) as an initial guess of <italic>p</italic>(<italic>π</italic><sub><italic>i</italic></sub> = 1). If no initial estimates are given, MAGeCK-MLE starts with <italic>p</italic>(<italic>π</italic><sub><italic>i</italic></sub> = 1) = 1 for all sgRNAs.</p>
      </sec>
      <sec id="Sec15">
        <title>The expectation step</title>
        <p>In the E step, we re-estimate the posterior probability <italic>p</italic>(<italic>π</italic><sub><italic>i</italic></sub> = 1) and the current estimation of <inline-formula id="IEq13"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{\beta}}_g $$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq13.gif"/></alternatives></inline-formula>:<disp-formula id="Equi"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ p\left({\pi}_i=1\Big|{x}_{ij},{\overrightarrow{\beta}}_g\ \right)=\frac{{\displaystyle {\prod}_j}p\left({x}_{ij}\left|{\pi}_i=1,\ {\overrightarrow{\beta}}_g\ \right)p\left({\pi}_i=1\right|{\overrightarrow{\beta}}_g\right)}{{\displaystyle {\prod}_j}p\left({x}_{ij}\Big|{\pi}_i=1,{\overrightarrow{\beta}}_g\right)p\left({\pi}_i=1\Big|{\overrightarrow{\beta}}_g\right) + {\displaystyle {\prod}_j}p\left({x}_{ij}\left|{\pi}_i=0,\ {\overrightarrow{\beta}}_g\ \right)p\left({\pi}_i=0\right|{\overrightarrow{\beta}}_g\right)\ } $$\end{document}</tex-math><mml:math id="M50"><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mspace width="0.25em"/></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mo stretchy="true">∏</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:mstyle><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mspace width="0.25em"/><mml:mo stretchy="true">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mo stretchy="true">∏</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:mstyle><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo stretchy="true">∏</mml:mo><mml:mi>j</mml:mi></mml:msub></mml:mstyle><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mspace width="0.25em"/><mml:mo stretchy="true">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2015_843_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec16">
        <title>The maximization step</title>
        <p>In the M step, we maximize the values of <inline-formula id="IEq14"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{\beta}}_g $$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq14.gif"/></alternatives></inline-formula> based on the values of <italic>p</italic>(<italic>π</italic><sub><italic>i</italic></sub> = 1). To derive the formula for updating <inline-formula id="IEq15"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{\beta}}_g $$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq15.gif"/></alternatives></inline-formula>, we write the probability of observing a read count <italic>x</italic> of <italic>x</italic><sub><italic>ij</italic></sub> as:<disp-formula id="Equj"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ P\left({x}_{ij}=x\right)=P{\left({x}_{ij}=x\Big|{\pi}_i=1\right)}^{I\left({\pi}_i=1\right)}*P{\left({x}_{ij}=x\Big|{\pi}_i=0\right)}^{I\left({\pi}_i=0\right)} $$\end{document}</tex-math><mml:math id="M56"><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mrow><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mo>*</mml:mo><mml:mi>P</mml:mi><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mrow><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:math><graphic xlink:href="13059_2015_843_Article_Equj.gif" position="anchor"/></alternatives></disp-formula>where <italic>I</italic>(.) is an indicator function. Taking the logarithm on both sides of the equation, we get<disp-formula id="Equk"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \log P\left({x}_{ij}=x\right)=I\left({\pi}_i=1\right) \log P\left({x}_{ij}=x\Big|{\pi}_i=1\right)+I\left({\pi}_i=0\right) \log P\left({x}_{ij}=x\Big|{\pi}_i=0\right) $$\end{document}</tex-math><mml:math id="M58"><mml:mo>log</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>log</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>log</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2015_843_Article_Equk.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>In the EM algorithm, it can be approximated by replacing the indicator function <italic>I</italic>(<italic>π</italic><sub><italic>i</italic></sub> = 1) and <italic>I</italic>(<italic>π</italic><sub><italic>i</italic></sub> = 0) with the posterior probability of <italic>P</italic>(<italic>π</italic><sub><italic>i</italic></sub> = 1) and <italic>P</italic>(<italic>π</italic><sub><italic>i</italic></sub> = 0), respectively [<xref ref-type="bibr" rid="CR41">41</xref>], using the results from the E step. Therefore, the log likelihood function from the mixture model can be written as:<disp-formula id="Equl"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{l}{\displaystyle \sum_{i,j}} \log P\left({x}_{ij}=x\right)\hfill \\ {}={\displaystyle {\sum}_{i,j}P\left({\pi}_i=1\Big|{x}_{ij},{\overrightarrow{\beta}}_g\right) logP\left({x}_{ij}=x\Big|\ {\pi}_i=1\right)+P\left({\pi}_i=0\Big|{x}_{ij},{\overrightarrow{\beta}}_g\right) logP\left({x}_{ij}=x\Big|{\pi}_i=0\right)}\hfill \end{array} $$\end{document}</tex-math><mml:math id="M60"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mstyle displaystyle="true"><mml:munder><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder></mml:mstyle><mml:mo>log</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo stretchy="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="italic">logP</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="italic">logP</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2015_843_Article_Equl.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Since NB distribution belongs to exponential family distributions, a fast algorithm exists for the maximum likelihood estimation of generalized linear models [<xref ref-type="bibr" rid="CR42">42</xref>]. Taking the prior of <inline-formula id="IEq16"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{\beta}}_g $$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq16.gif"/></alternatives></inline-formula> into consideration, the objective function can be maximized using iteratively reweighted ridge regression, or weighted updates, the same the algorithm used in DESeq2 [<xref ref-type="bibr" rid="CR37">37</xref>]. The update rule for calculating <inline-formula id="IEq17"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{\beta^t}}_g $$\end{document}</tex-math><mml:math id="M64" display="block"><mml:msub><mml:mrow><mml:mover><mml:msup><mml:mi>β</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo accent="false">→</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq17.gif"/></alternatives></inline-formula> at step <italic>t</italic> of the iteration can be written as:<disp-formula id="Equm"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overrightarrow{\beta_g^t}={\left({\mathrm{D}}^{\hbox{'}\mathrm{T}}W\mathrm{D}\hbox{'}+\lambda I\right)}^{-1}{\mathrm{D}}^{\hbox{'}\mathrm{T}}W\overrightarrow{z^t} $$\end{document}</tex-math><mml:math id="M66" display="block"><mml:mrow><mml:mover><mml:msubsup><mml:mi>β</mml:mi><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo accent="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mtext>'</mml:mtext><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mtext>'</mml:mtext><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">D</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mtext>'</mml:mtext><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mi>W</mml:mi><mml:mtext/><mml:mrow><mml:mover><mml:msup><mml:mi>z</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo accent="false">→</mml:mo></mml:mover></mml:mrow></mml:math><graphic xlink:href="13059_2015_843_Article_Equm.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Here, <italic>W</italic> is the diagonal matrix with its values given by <italic>w</italic><sub><italic>ii</italic></sub> = <italic>e</italic><sub><italic>i</italic></sub><sup><italic>t</italic></sup>/(1/<italic>μ</italic><sub><italic>i</italic></sub> + <italic>α</italic><sub><italic>i</italic></sub>), where <italic>e</italic><sub><italic>i</italic></sub><sup><italic>t</italic></sup> is the current estimate of the efficiency of sgRNA <inline-formula id="IEq18"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ i:{e}_i^t=P\left({\pi}_i=1\Big|{x}_{ij},\overrightarrow{\beta_g^{t-1}}\right) $$\end{document}</tex-math><mml:math id="M68" display="block"><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:msubsup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mover><mml:msubsup><mml:mi>β</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo accent="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq18.gif"/></alternatives></inline-formula>, <italic>λ</italic> is the regularization parameter in the ridge regression, and <italic>μ</italic><sub><italic>i</italic></sub> is the current estimate of the mean of the NB variable:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{c}\kern1em \overrightarrow{\mu^t}={s}_j exp\left(\overrightarrow{h^t}\right)\kern1em \\ {}\kern1em \overrightarrow{{\mathrm{h}}^{\mathrm{t}-1}}=\mathrm{D}\hbox{'}\overrightarrow{\beta_g^{t-1}}\kern1em \end{array} $$\end{document}</tex-math><mml:math id="M70" display="block"><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mspace width=".5em"/><mml:mspace width=".5em"/></mml:mrow><mml:mrow><mml:mover><mml:msup><mml:mi>μ</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo accent="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mtext/><mml:mrow><mml:mover><mml:msup><mml:mi>h</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo accent="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mspace width=".5em"/><mml:mspace width=".5em"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/><mml:mrow><mml:mspace width=".5em"/><mml:mspace width=".5em"/></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:msup><mml:mi mathvariant="normal">h</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo accent="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">D</mml:mi></mml:mrow><mml:mtext>'</mml:mtext><mml:mtext/><mml:mrow><mml:mover><mml:msubsup><mml:mi>β</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo accent="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mspace width=".5em"/><mml:mspace width=".5em"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2015_843_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p><inline-formula id="IEq19"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{\mathrm{z}}}^t $$\end{document}</tex-math><mml:math id="M72"><mml:msup><mml:mover><mml:mi mathvariant="normal">z</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>t</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq19.gif"/></alternatives></inline-formula> is the residue vector of the current estimate, with its <italic>i</italic>th element:<disp-formula id="Equn"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {z}_i^t={\mathrm{h}}_{\mathrm{i}}^{t-1}+{e}_i^t\left({\mathrm{x}}_{\mathrm{i}}-{\mu}_i^t\right)/{\mu}_i^t $$\end{document}</tex-math><mml:math id="M74"><mml:msubsup><mml:mi>z</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mfenced><mml:mo stretchy="true">/</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math><graphic xlink:href="13059_2015_843_Article_Equn.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Here, <italic>x</italic><sub><italic>i</italic></sub> is the read count of sgRNA <italic>i</italic>.</p>
      </sec>
      <sec id="Sec17">
        <title>Convergence</title>
        <p>The EM approach iterates the E step and the M step until it converges or reaches a predefined maximum number of iteration.</p>
      </sec>
    </sec>
    <sec id="Sec18">
      <title>Statistical significance</title>
      <p>The statistical significance of <inline-formula id="IEq20"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{\beta}}_g $$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq20.gif"/></alternatives></inline-formula> is calculated in both permutation and Wald test. In permutation test, MAGeCK-MLE shuffles all sgRNAs in a gene to generate empirical null distribution of <inline-formula id="IEq21"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{\beta}}_g $$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq21.gif"/></alternatives></inline-formula> . The number of shufflings is a parameter specified by the user, and the default value is set to be 2*(total number of genes). In the Wald test, MAGeCK-MLE compares the value of <inline-formula id="IEq22"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{\beta}}_g/SE\left({\overrightarrow{\beta}}_g\right) $$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="true">/</mml:mo><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq22.gif"/></alternatives></inline-formula> to the standard Normal distribution, where <inline-formula id="IEq23"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ SE\left({\overrightarrow{\beta}}_g\right) $$\end{document}</tex-math><mml:math id="M82"><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq23.gif"/></alternatives></inline-formula> is the standard error of <inline-formula id="IEq24"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{\beta}}_g $$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq24.gif"/></alternatives></inline-formula>:<disp-formula id="Equo"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{c}\hfill SE\left({\overrightarrow{\beta}}_g\right)=\sqrt{diag\Big(Cov\left(\left({\overrightarrow{\beta}}_g\right)\right)\ }\hfill \\ {}\hfill Cov\left(\left({\overrightarrow{\beta}}_g\right)\right)={\left({D}^{\hbox{'}T}W{D}^{\hbox{'}}+\lambda I\right)}^{-1}\left({D}^{\hbox{'}T}W{D}^{\hbox{'}}\right){\left({D}^{\hbox{'}T}W{D}^{\hbox{'}}+\lambda I\right)}^{-1}\hfill \end{array} $$\end{document}</tex-math><mml:math id="M86"><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mi mathvariant="italic">diag</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mfenced close=")" open="("><mml:mfenced close=")" open="("><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mfenced></mml:mfenced><mml:mspace width="0.25em"/></mml:mrow></mml:msqrt></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mfenced close=")" open="("><mml:mfenced close=")" open="("><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mfenced></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>W</mml:mi><mml:msup><mml:mi>D</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>W</mml:mi><mml:msup><mml:mi>D</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:mfenced><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>W</mml:mi><mml:msup><mml:mi>D</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2015_843_Article_Equo.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Here, <inline-formula id="IEq25"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ diag\left(Cov\left({\overrightarrow{\beta}}_g\right)\right) $$\end{document}</tex-math><mml:math id="M88"><mml:mi mathvariant="italic">diag</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq25.gif"/></alternatives></inline-formula> are the diagonal elements of the covariance matrix of <inline-formula id="IEq26"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{\beta}}_g $$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq26.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec19">
      <title>Calculating the over-dispersion factor</title>
      <p>The over-dispersion factor, <italic>α</italic><sub><italic>i</italic></sub>, is calculated based on the mean and variance estimation algorithm used in MAGeCK [<xref ref-type="bibr" rid="CR10">10</xref>] and VOOM [<xref ref-type="bibr" rid="CR40">40</xref>]. We first calculate the fitted values of <inline-formula id="IEq27"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overrightarrow{\beta}}_g $$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mover><mml:mi>β</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq27.gif"/></alternatives></inline-formula>, or <inline-formula id="IEq28"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\beta}}_g $$\end{document}</tex-math><mml:math id="M94"><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq28.gif"/></alternatives></inline-formula>, using the EM algorithm proposed before, with the over-dispersion factor set to a fixed value (for example, 0.01). Then the fitted means <inline-formula id="IEq29"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\mu}}_i $$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq29.gif"/></alternatives></inline-formula> are calculated using Equation (<xref rid="Equ4" ref-type="">4</xref>), and the residual variances are calculated using the following equation:<disp-formula id="Equp"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {{\widehat{\sigma}}_i}^2={\left({x}_i-{\widehat{\mu}}_i\right)}^2 $$\end{document}</tex-math><mml:math id="M98"><mml:msup><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:math><graphic xlink:href="13059_2015_843_Article_Equp.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>MAGeCK-MLE then models the sample residual variance <inline-formula id="IEq30"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\sigma}}^2 $$\end{document}</tex-math><mml:math id="M100"><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq30.gif"/></alternatives></inline-formula> and fitted mean <inline-formula id="IEq31"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \widehat{\mu} $$\end{document}</tex-math><mml:math id="M102"><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq31.gif"/></alternatives></inline-formula> using the same model as in MAGeCK [<xref ref-type="bibr" rid="CR10">10</xref>]:<disp-formula id="Equq"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\sigma}}^2=\widehat{\mu}+k{\widehat{\mu}}^b $$\end{document}</tex-math><mml:math id="M104"><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:msup><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>b</mml:mi></mml:msup></mml:math><graphic xlink:href="13059_2015_843_Article_Equq.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Where <italic>k</italic> and <italic>b</italic> are learned from the fitted means and residual variances of all sgRNA read counts. The values of <italic>α</italic><sub><italic>i</italic></sub> are then calculated based on the fitted values of sample residual variance <inline-formula id="IEq32"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {{\widehat{\sigma}}_f}^2 $$\end{document}</tex-math><mml:math id="M106"><mml:msup><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>f</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13059_2015_843_Article_IEq32.gif"/></alternatives></inline-formula> from this model:<disp-formula id="Equr"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\alpha}_i=\frac{{\widehat{\sigma}}_f^2-{\widehat{\mu}}_i}{{{\widehat{\mu}}_i}^2} $$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msup><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:msup></mml:mfrac></mml:math><graphic xlink:href="13059_2015_843_Article_Equr.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec20">
      <title>Availability</title>
      <p>The MAGeCK-VISPR workflow is available open source at <ext-link ext-link-type="uri" xlink:href="http://bitbucket.org/liulab/mageck-vispr">http://bitbucket.org/liulab/mageck-vispr</ext-link> under the MIT license.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional file</title>
    <sec id="Sec21">
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="13059_2015_843_MOESM1_ESM.pdf">
          <label>Additional file 1:</label>
          <caption>
            <p><bold>Supplementary materials.</bold> (PDF 2045 kb)</p>
          </caption>
        </media>
      </supplementary-material>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>AML</term>
        <def>
          <p>acute myeloid leukemia</p>
        </def>
      </def-item>
      <def-item>
        <term>CDF</term>
        <def>
          <p>cumulative distribution function</p>
        </def>
      </def-item>
      <def-item>
        <term>CML</term>
        <def>
          <p>chronic myeloid leukemia</p>
        </def>
      </def-item>
      <def-item>
        <term>CRISPR</term>
        <def>
          <p>clustered regularly interspaced short palindromic repeats</p>
        </def>
      </def-item>
      <def-item>
        <term>D3</term>
        <def>
          <p>Data-Driven Documents</p>
        </def>
      </def-item>
      <def-item>
        <term>dCas9</term>
        <def>
          <p>dead Cas9</p>
        </def>
      </def-item>
      <def-item>
        <term>DMSO</term>
        <def>
          <p>dimethyl sulfoxide</p>
        </def>
      </def-item>
      <def-item>
        <term>EM</term>
        <def>
          <p>expectation-maximization</p>
        </def>
      </def-item>
      <def-item>
        <term>GeCKO</term>
        <def>
          <p>genome-scale CRISPR/Cas9 knockout</p>
        </def>
      </def-item>
      <def-item>
        <term>GLM</term>
        <def>
          <p>generalized linear model</p>
        </def>
      </def-item>
      <def-item>
        <term>GO</term>
        <def>
          <p>gene ontology</p>
        </def>
      </def-item>
      <def-item>
        <term>MAGeCK</term>
        <def>
          <p>Model-based Analysis of Genome-wide CRISPR/Cas9 Knockout</p>
        </def>
      </def-item>
      <def-item>
        <term>MLE</term>
        <def>
          <p>maximum-likelihood estimation</p>
        </def>
      </def-item>
      <def-item>
        <term>NB</term>
        <def>
          <p>negative binomial</p>
        </def>
      </def-item>
      <def-item>
        <term>NGS</term>
        <def>
          <p>next-generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>PCA</term>
        <def>
          <p>principle component analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>QC</term>
        <def>
          <p>quality control</p>
        </def>
      </def-item>
      <def-item>
        <term>RNAi</term>
        <def>
          <p>RNA interference</p>
        </def>
      </def-item>
      <def-item>
        <term>RRA</term>
        <def>
          <p>robust rank aggregation</p>
        </def>
      </def-item>
      <def-item>
        <term>SAM</term>
        <def>
          <p>Synergistic Activation Mediator</p>
        </def>
      </def-item>
      <def-item>
        <term>sgRNA</term>
        <def>
          <p>single-guide RNA</p>
        </def>
      </def-item>
      <def-item>
        <term>VISPR</term>
        <def>
          <p>VISualization of crisPR screens</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>Wei Li and Johannes Köster contributed equally to this work.</p>
    </fn>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare no competing financial interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>WL, JSL, and XSL designed the statistical model. WL and JK developed the algorithm, designed and performed the analysis. XH and CHC performed sgRNA efficiency prediction analysis. WL, JK, and XSL wrote the manuscript with help from all other authors. XSL and MB supervised the whole project. All authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like to thank Michael I. Love, Clifford Meyer, Peng Jiang, Bo Li, and Graham McVicker for helpful discussions.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p>The project was supported by the NIH grant U01 CA180980 (to XSL), R01 HG008728 (to MB and XSL), Department of Defense Synergistic Idea Development Award PC140817 (to MB and XSL), R01 GM113242-01 (to JSL), NSF grant DMS-1120368 (to JSL), and the Claudia Adams Barr Award in Innovative Basic Cancer Research from the Dana-Farber Cancer Institute.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Sabatini</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <article-title>Genetic screens in human cells using the CRISPR-Cas9 system</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>343</volume>
        <fpage>80</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1246981</pub-id>
        <?supplied-pmid 24336569?>
        <pub-id pub-id-type="pmid">24336569</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shalem</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Sanjana</surname>
            <given-names>NE</given-names>
          </name>
          <name>
            <surname>Hartenian</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Mikkelsen</surname>
            <given-names>TS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-scale CRISPR-Cas9 knockout screening in human cells</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>343</volume>
        <fpage>84</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1247005</pub-id>
        <?supplied-pmid 24336571?>
        <pub-id pub-id-type="pmid">24336571</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-throughput screening of a CRISPR/Cas9 library for functional genomics in human cells</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>509</volume>
        <fpage>487</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13166</pub-id>
        <?supplied-pmid 24717434?>
        <pub-id pub-id-type="pmid">24717434</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koike-Yusa</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>E-P</given-names>
          </name>
          <name>
            <surname>Velasco-Herrera</surname>
            <given-names>MDC</given-names>
          </name>
          <name>
            <surname>Yusa</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide recessive genetic screening in mammalian cells with a lentiviral CRISPR-guide RNA library</article-title>
        <source>Nat Biotechnol</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>267</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2800</pub-id>
        <?supplied-pmid 24535568?>
        <pub-id pub-id-type="pmid">24535568</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Konermann</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brigham</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Trevino</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Joung</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Abudayyeh</surname>
            <given-names>OO</given-names>
          </name>
          <name>
            <surname>Barcena</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-scale transcriptional activation by an engineered CRISPR-Cas9 complex</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>517</volume>
        <fpage>583</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14136</pub-id>
        <?supplied-pmid 25494202?>
        <pub-id pub-id-type="pmid">25494202</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gilbert</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Horlbeck</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Adamson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Villalta</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Whitehead</surname>
            <given-names>EH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-scale CRISPR-mediated control of gene repression and activation</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>159</volume>
        <fpage>647</fpage>
        <lpage>61</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2014.09.029</pub-id>
        <?supplied-pmid 25307932?>
        <pub-id pub-id-type="pmid">25307932</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Cheung</surname>
            <given-names>HW</given-names>
          </name>
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sharifnia</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Okamoto</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly parallel identification of essential genes in cancer cells</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2008</year>
        <volume>105</volume>
        <fpage>20380</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0810485105</pub-id>
        <?supplied-pmid 19091943?>
        <pub-id pub-id-type="pmid">19091943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>König</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chiang</surname>
            <given-names>C-Y</given-names>
          </name>
          <name>
            <surname>Tu</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>DeJesus</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Romero</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A probability-based approach for the analysis of large-scale RNAi screens</article-title>
        <source>Nat Methods</source>
        <year>2007</year>
        <volume>4</volume>
        <fpage>847</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth1089</pub-id>
        <?supplied-pmid 17828270?>
        <pub-id pub-id-type="pmid">17828270</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Diaz</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ramalho-Santos</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>HiTSelect: a comprehensive tool for high-complexity-pooled screen analysis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>e16</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku1197</pub-id>
        <?supplied-pmid 25428347?>
        <pub-id pub-id-type="pmid">25428347</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cong</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MAGeCK enables robust identification of essential genes from genome-scale CRISPR/Cas9 knockout screens</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>554</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0554-4</pub-id>
        <?supplied-pmid 25476604?>
        <pub-id pub-id-type="pmid">25476604</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>C-H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sequence determinants of improved CRISPR sgRNA design</article-title>
        <source>Genome Res</source>
        <year>2015</year>
        <volume>25</volume>
        <fpage>1147</fpage>
        <lpage>57</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.191452.115</pub-id>
        <?supplied-pmid 26063738?>
        <pub-id pub-id-type="pmid">26063738</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Kriz</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Chiu</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Hsu</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Dadon</surname>
            <given-names>DB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide binding of the CRISPR endonuclease Cas9 in mammalian cells</article-title>
        <source>Nat Biotechnol</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>670</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2889</pub-id>
        <?supplied-pmid 24752079?>
        <pub-id pub-id-type="pmid">24752079</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Köster</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rahmann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Snakemake - a scalable bioinformatics workflow engine</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>2520</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts480</pub-id>
        <?supplied-pmid 22908215?>
        <pub-id pub-id-type="pmid">22908215</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wittebolle</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Marzorati</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clement</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Balloi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Daffonchio</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Heylen</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Initial community evenness favours functionality under selective stress</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>458</volume>
        <fpage>623</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nature07840</pub-id>
        <?supplied-pmid 19270679?>
        <pub-id pub-id-type="pmid">19270679</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eden</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Navon</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Steinfeld</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lipson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Yakhini</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>GOrilla: a tool for discovery and visualization of enriched GO terms in ranked gene lists</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>48</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-48</pub-id>
        <?supplied-pmid 19192299?>
        <pub-id pub-id-type="pmid">19192299</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hart</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Sircoulomb</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Rottapel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Moffat</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Measuring error rates in genomic perturbation screens: gold standards for human functional genomics</article-title>
        <source>Mol Syst Biol</source>
        <year>2014</year>
        <volume>10</volume>
        <fpage>733</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.15252/msb.20145216</pub-id>
        <?supplied-pmid 24987113?>
        <pub-id pub-id-type="pmid">24987113</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Placke</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Faber</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Nonami</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Putwain</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Salih</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Heidel</surname>
            <given-names>FH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Requirement for CDK6 in MLL-rearranged acute myeloid leukemia</article-title>
        <source>Blood</source>
        <year>2014</year>
        <volume>124</volume>
        <fpage>13</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1182/blood-2014-02-558114</pub-id>
        <?supplied-pmid 24764564?>
        <pub-id pub-id-type="pmid">24764564</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Röthlisberger</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Heizmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bargetzi</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>TRIB1 overexpression in acute myeloid leukemia</article-title>
        <source>Cancer Genet Cytogenet</source>
        <year>2007</year>
        <volume>176</volume>
        <fpage>58</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cancergencyto.2007.03.003</pub-id>
        <?supplied-pmid 17574965?>
        <pub-id pub-id-type="pmid">17574965</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>L-J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y-Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>L-Y</given-names>
          </name>
          <name>
            <surname>Xiong</surname>
            <given-names>S-M</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>X-Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Functional features of RUNX1 mutants in acute transformation of chronic myeloid leukemia and their contribution to inducing murine full-blown leukemia</article-title>
        <source>Blood</source>
        <year>2012</year>
        <volume>119</volume>
        <fpage>2873</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1182/blood-2011-08-370981</pub-id>
        <?supplied-pmid 22318203?>
        <pub-id pub-id-type="pmid">22318203</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davies</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bignell</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Edkins</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Clegg</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mutations of the BRAF gene in human cancer</article-title>
        <source>Nature</source>
        <year>2002</year>
        <volume>417</volume>
        <fpage>949</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.1038/nature00766</pub-id>
        <?supplied-pmid 12068308?>
        <pub-id pub-id-type="pmid">12068308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prahallad</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Di Nicolantonio</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Salazar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zecchin</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unresponsiveness of colon cancer to BRAF(V600E) inhibition through feedback activation of EGFR</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>483</volume>
        <fpage>100</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10868</pub-id>
        <?supplied-pmid 22281684?>
        <pub-id pub-id-type="pmid">22281684</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheung</surname>
            <given-names>HW</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Boehm</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Weir</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Amplification of CRKL induces transformation and epidermal growth factor receptor inhibitor resistance in human non-small cell lung cancers</article-title>
        <source>Cancer Discov</source>
        <year>2011</year>
        <volume>1</volume>
        <fpage>608</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1158/2159-8290.CD-11-0046</pub-id>
        <?supplied-pmid 22586683?>
        <pub-id pub-id-type="pmid">22586683</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">VEGA. A Visualization Grammar. [<ext-link ext-link-type="uri" xlink:href="https://vega.github.io">https://vega.github.io</ext-link>].</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bostock</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ogievetsky</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Heer</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>D<sup>3</sup>: Data-Driven Documents</article-title>
        <source>IEEE Trans Vis Comput Graph</source>
        <year>2011</year>
        <volume>17</volume>
        <fpage>2301</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1109/TVCG.2011.185</pub-id>
        <?supplied-pmid 22034350?>
        <pub-id pub-id-type="pmid">22034350</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cunningham</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Amode</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Barrell</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Beal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Billis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Brent</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ensembl 2015</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>Database issue</issue>
        <fpage>D662</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku1010</pub-id>
        <?supplied-pmid 25352552?>
        <pub-id pub-id-type="pmid">25352552</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thorvaldsdóttir</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Integrative Genomics Viewer (IGV): high-performance genomics data visualization and exploration</article-title>
        <source>Brief Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>178</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbs017</pub-id>
        <?supplied-pmid 22517427?>
        <pub-id pub-id-type="pmid">22517427</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Warde-Farley</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Donaldson</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Comes</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Zuberi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Badrawi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chao</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The GeneMANIA prediction server: biological network integration for gene prioritization and predicting gene function</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <issue>Web Server issue</issue>
        <fpage>W214</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq537</pub-id>
        <?supplied-pmid 20576703?>
        <pub-id pub-id-type="pmid">20576703</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">The Conda project [<ext-link ext-link-type="uri" xlink:href="https://anaconda.org">https://anaconda.org</ext-link>].</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sanjana</surname>
            <given-names>NE</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shalem</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide CRISPR screen in a mouse model of tumor growth and metastasis</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>160</volume>
        <fpage>1246</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.02.038</pub-id>
        <?supplied-pmid 25748654?>
        <pub-id pub-id-type="pmid">25748654</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parnas</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Jovanovic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eisenhaure</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Herbst</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Dixit</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>CJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A Genome-wide CRISPR Screen in Primary Immune Cells to Dissect Regulatory Networks</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>162</volume>
        <fpage>675</fpage>
        <lpage>86</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.06.059</pub-id>
        <?supplied-pmid 26189680?>
        <pub-id pub-id-type="pmid">26189680</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CR Cistrome: a ChIP-Seq database for chromatin regulators and histone modification linkages in human and mouse</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <issue>Database issue</issue>
        <fpage>D450</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt1151</pub-id>
        <?supplied-pmid 24253304?>
        <pub-id pub-id-type="pmid">24253304</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Diaz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nellore</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>CHANCE: comprehensive software for quality control and validation of ChIP-seq data</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>R98</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-10-r98</pub-id>
        <?supplied-pmid 23068444?>
        <pub-id pub-id-type="pmid">23068444</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rabinovic</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Adjusting batch effects in microarray expression data using empirical Bayes methods</article-title>
        <source>Biostatistics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>118</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxj037</pub-id>
        <?supplied-pmid 16632515?>
        <pub-id pub-id-type="pmid">16632515</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Risso</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ngai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Normalization of RNA-seq data using factor analysis of control genes or samples</article-title>
        <source>Nat Biotechnol</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>896</fpage>
        <lpage>902</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2931</pub-id>
        <?supplied-pmid 25150836?>
        <pub-id pub-id-type="pmid">25150836</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>139</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <?supplied-pmid 19910308?>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis for sequence count data</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R106</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id>
        <?supplied-pmid 20979621?>
        <pub-id pub-id-type="pmid">20979621</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>550</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
        <?supplied-pmid 25516281?>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doench</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Hartenian</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Graham</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Tothova</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Hegde</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rational design of highly active sgRNAs for CRISPR-Cas9-mediated gene inactivation</article-title>
        <source>Nat Biotechnol</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>1262</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3026</pub-id>
        <?supplied-pmid 25184501?>
        <pub-id pub-id-type="pmid">25184501</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Linear models and empirical bayes methods for assessing differential expression in microarray experiments</article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <year>2004</year>
        <volume>3</volume>
        <fpage>Article3–25</fpage>
        <pub-id pub-id-type="pmid">16646809</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>voom: precision weights unlock linear model analysis tools for RNA-seq read counts</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>R29</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-2-r29</pub-id>
        <?supplied-pmid 24485249?>
        <pub-id pub-id-type="pmid">24485249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dempster</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>
        <source>J R Stat Soc Ser B</source>
        <year>1977</year>
        <volume>39</volume>
        <fpage>1</fpage>
        <lpage>38</lpage>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Fox</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Applied Regression Analysis and Generalized Linear Models</source>
        <year>2015</year>
        <publisher-loc>London</publisher-loc>
        <publisher-name>SAGE Publications</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
