<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Med</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Med</journal-id>
    <journal-title-group>
      <journal-title>Genome Medicine</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-994X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10726641</article-id>
    <article-id pub-id-type="pmid">38111063</article-id>
    <article-id pub-id-type="publisher-id">1269</article-id>
    <article-id pub-id-type="doi">10.1186/s13073-023-01269-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>De novo identification of expressed cancer somatic mutations from single-cell RNA sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Tianyun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jia</surname>
          <given-names>Hanying</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Song</surname>
          <given-names>Tairan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lv</surname>
          <given-names>Lin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gulhan</surname>
          <given-names>Doga C.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Haishuai</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Guo</surname>
          <given-names>Wei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xi</surname>
          <given-names>Ruibin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Guo</surname>
          <given-names>Hongshan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4709-3374</contrib-id>
        <name>
          <surname>Shen</surname>
          <given-names>Ning</given-names>
        </name>
        <address>
          <email>shenningzju@zju.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.13402.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 700X</institution-id><institution>Department of Hepatobiliary and Pancreatic Surgery of the First Affiliated Hospital &amp; Liangzhu Laboratory, </institution><institution>Zhejiang University School of Medicine, </institution></institution-wrap>Hangzhou, 311121 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05m1p5x56</institution-id><institution-id institution-id-type="GRID">grid.452661.2</institution-id><institution-id institution-id-type="ISNI">0000 0004 1803 6319</institution-id><institution>Kidney Disease Center, </institution><institution>the First Affiliated Hospital, Zhejiang University School of Medicine, </institution></institution-wrap>Zhejiang, 311121 China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution>Department of Biomedical Informatics, </institution><institution>Harvard Medical School, </institution></institution-wrap>Boston, MA 02115 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00a2xv884</institution-id><institution-id institution-id-type="GRID">grid.13402.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 700X</institution-id><institution>College of Computer Science, </institution><institution>Zhejiang University, </institution></institution-wrap>Hangzhou, 311121 Zhejiang China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.512487.d</institution-id><institution>Zhejiang University-University of Edinburgh Institute, School of Medicine, Zhejiang University, </institution></institution-wrap>Jiaxing, 314400 China </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02v51f717</institution-id><institution-id institution-id-type="GRID">grid.11135.37</institution-id><institution-id institution-id-type="ISNI">0000 0001 2256 9319</institution-id><institution>School of Mathematical Sciences and Center for Statistical Science, </institution><institution>Peking University, </institution></institution-wrap>5 Yiheyuan Road, Beijing, 100871 China </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05m1p5x56</institution-id><institution-id institution-id-type="GRID">grid.452661.2</institution-id><institution-id institution-id-type="ISNI">0000 0004 1803 6319</institution-id><institution>Bone Marrow Transplantation Center, The First Affiliated Hospital, Zhejiang University School of Medicine, </institution></institution-wrap>Hangzhou, 310003 Zhejiang China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>15</volume>
    <elocation-id>115</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>12</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023, corrected publication 2024</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Identifying expressed somatic mutations from single-cell RNA sequencing data de novo is challenging but highly valuable. We propose RESA – Recurrently Expressed SNV Analysis, a computational framework to identify expressed somatic mutations from scRNA-seq data. RESA achieves an average precision of 0.77 on three in silico spike-in datasets. In extensive benchmarking against existing methods using 19 datasets, RESA consistently outperforms them. Furthermore, we applied RESA to analyze intratumor mutational heterogeneity in a melanoma drug resistance dataset. By enabling high precision detection of expressed somatic mutations, RESA substantially enhances the reliability of mutational analysis in scRNA-seq. RESA is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ShenLab-Genomics/RESA">https://github.com/ShenLab-Genomics/RESA</ext-link>.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13073-023-01269-1.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Somatic mutations</kwd>
      <kwd>Single-cell RNA sequencing data</kwd>
      <kwd>Recurrently Expressed SNV Analysis</kwd>
      <kwd>High precision</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Leading Innovative and Entrepreneur Team Introduction Program of Zhejiang (CN)</institution>
        </funding-source>
        <award-id>2021R01012</award-id>
        <principal-award-recipient>
          <name>
            <surname>Shen</surname>
            <given-names>Ning</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Zhejiang University Starting Fund</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par15">Somatic mutations are accumulated during cell generations and can transform normal cells into cancer, promote tumor progression, and develop drug resistance. Genetic heterogeneity together with transcriptional heterogeneity are two key aspects that contribute to cancer evolution and drug resistance. Recent studies have attempted to identify somatic mutations, single nucleotide variants (SNVs) in particular, by associating them with transcriptional variations in cancer bulk RNA-seq data [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. However, it remains challenging to connect transcriptional heterogeneity to genetic heterogeneity at the single-cell level. Therefore, identifying somatic mutations carried by RNA at the single-cell level is highly valuable.</p>
    <p id="Par16">Experimental technologies, such as targeted genotyping coupled with scRNA-seq, have been developed to enable the study of expressional and somatic variations together at single-cell level [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref>]. However, the single cells have limited amounts of biological materials, a small number of detectable mutations, and a low signal-to-noise ratio have restricted their application. As a result, computational methods are sought-after to identify expressed somatic mutations from scRNA-seq data. Profiling of scRNA-seq coupled with bulk genotyping, e.g. whole exome sequencing (WES), whole genome sequencing (WGS), and single cell genotyping of selected mutations, of the same sample have been applied to study intratumor heterogeneity and lineage tracing [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]. Although such data can effectively minimize false positives, their design requires thoughtful consideration and can only characterize a limited number of mutations, thus they were not widely adopted.</p>
    <p id="Par17">Computational methods that identify expressed somatic mutations directly from scRNA-seq data de novo are highly desirable, as such methods not only provide orthogonal insights into the intratumor heterogeneity but also face fewer experimental challenges. Most mutational analysis of scRNA-seq use data generated from scRNA-seq technologies with full length library prep, e.g. SMART-seq2 [<xref ref-type="bibr" rid="CR11">11</xref>], for its higher coverage in the gene body compared to the 10X genomics and Drop-seq approach. De novo somatic mutation calling and follow-up analysis have been applied to various biological questions including aging in the human pancreas, Alzheimer’s disease, glioblastoma, lung cancer, etc. [<xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR15">15</xref>]. Methods reported in these studies employ standard variant calling steps that involve quality-based filtering such as sequencing quality or stratification from a curated whitelist of known cancer mutations, following the standard variant calling steps. However, these methods were originally designed for bulk RNA-seq data and their reliability for single-cell RNA-seq data still requires further evaluation [<xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR19">19</xref>].</p>
    <p id="Par18">In this study, we developed a computational framework named Recurrently Expressed SNV Analysis (RESA) that can detect expressed somatic SNVs with high precision directly from scRNA-seq data. RESA is composed of a specific filtering workflow tailored for scRNA-seq data, especially the recurrence of expressed SNVs across cells. Additionally, we introduced a joint logistic regression (RESA-jLR) model that expands the pool of somatic variants by leveraging information from earlier steps. To evaluate the performance of RESA and RESA-jLR, we conducted in silico spike-in experiments using over 800 cells from the human pancreas. Furthermore, we benchmarked RESA and RESA-jLR using real scRNA-seq datasets with matched WES data from 15 cancer cell lines and 4 tumor PDX tissues. RESA is specifically designed for high precision detection of somatic mutations while minimizing noise and artefacts from experimental procedures, so that users can be confident with the reliability of the results (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). Thus, the applications of RESA and RESA-jLR may provide a reliable and integrative view to study intratumor heterogeneity and drug resistance.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>WES and scRNA-seq datasets of cancer cell lines</title>
      <p id="Par19">The exonic somatic mutations for all cancer cell lines tested in this study were processed by the CCLE project and downloaded from CCLE_20Q1_mutations [<xref ref-type="bibr" rid="CR20">20</xref>]. The scRNA-seq for cancer cell lines were downloaded from GSE105451, GSE76312, GSE99795, GSE150993, GSE108383, GSE140440, and GSE69405 respectively.</p>
      <p id="Par20">Specifically, scRNA-seq for JURKAT, SET2 (GSE105451), and K562 (GSE76312) was done using the SMART-seq + and TARGET-seq technologies [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. All other cell lines were done with the Smart-seq2 protocol. LNCaP (GSE99795) was treated with double thymidine for 12 h (hr) to synchronize the population cell cycle, then single cells were collected at 0 h without drug treatment, and 12 h with and without drug treatment [<xref ref-type="bibr" rid="CR21">21</xref>]. HCT116 (GSE150993) live cells and methanol-fixed cells were processed and sequenced respectively [<xref ref-type="bibr" rid="CR22">22</xref>]. Yu-jui Ho et al. sequenced A375 (GSE108383) with and without BRAF inhibitor [<xref ref-type="bibr" rid="CR23">23</xref>]. Similarly, Patricia M Schnepp et al. divided their cells into docetaxel-sensitive and -resistant groups of DU145 (GSE140440) [<xref ref-type="bibr" rid="CR24">24</xref>]. Finally, we analyzed both the cancer cell line NCI-H358 data (GSE69405) and lung adenocarcinoma (LUAD) PDX tumor data from Kyu-Tae Kim et al. [<xref ref-type="bibr" rid="CR25">25</xref>].</p>
      <p id="Par21">Besides, we evaluated the consistency between two experimental replicates of these cell lines after applying RESA-jLR in all applicable cases. We counted the number of detected mutations in each replicate and computed the fold change between the number of detected mutations in replicate 1 and the number of detected mutations in replicate 2. If the result is close to 1, it means the number of detected mutations between two replicates is similar. The consistency shows that our method has stable performance in datasets under similar conditions.</p>
    </sec>
    <sec id="Sec4">
      <title>RESA workflow</title>
      <p id="Par22">RESA comprises three main steps: initial variant calling, filtering and labeling, and modeling and refinement [<xref ref-type="bibr" rid="CR26">26</xref>]. The first step of RESA is to align the sequencing reads to the genome and run through basic mutation calling algorithms with RNA-seq specific parameter settings (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). To minimize aligner and variant caller biases, two independent alignments and two basic variant callers were employed. Next, we run through a series of processing, filtering, and most importantly, cross-cell recurrence counting. In this step, the variants are grouped into 3 categories: 1) a high-confidence set of SNVs that are either putative somatic SNVs or artefacts; 2) a set of filtered-out variants; and 3) a set of undefined SNVs for further refinement (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). The high-confidence set of putative positive somatic variants were labeled as RESA-identified somatic mutations.<fig id="Fig1"><label>Fig. 1</label><caption><p>RESA workflow. <bold>a</bold> Step1 is an initial variant call using two aligners and two mutation calling algorithms. <bold>b</bold> RESA: Variants calling then goes through a series of filtering and labeling, categorizing into a confident set of positive somatic variants and artefacts, and a set of unsure SNVs to refine. <bold>c</bold> RESA-jLR: The confident set of variants is used to build a joint logistic regression model, where the model is applied to make predictions in the unsure set of SNVs to refine and expand the final positive set of somatic SNVs. <bold>d</bold> the detailed workflow of RESA</p></caption><graphic xlink:href="13073_2023_1269_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par23">Denoting RESA identified mutations as “positive” and the putative biases and artefacts variants as “negative”, RESA randomly splits the data into training and test sets. We developed a joint logistic regression classifier that models both quality and sequence-related features independently (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). The joint logistic regression classifier was then applied to make predictions on the set of undefined SNVs. The final set of somatic SNVs identified by RESA-jLR is a combination of positive SNVs from the high-confidence set and predicted positive SNVs from the undefined set using the joint logistic regression model.</p>
    </sec>
    <sec id="Sec5">
      <title>Initial read mapping and variant calling</title>
      <p id="Par24">To reduce the bias in aligners and variant callers, we employed two independent alignment and variant calling methods for each cell's fastq file in the scRNA-seq analysis. The first method consisted of aligning the reads using the widely adopted STAR aligner [<xref ref-type="bibr" rid="CR27">27</xref>], a highly effective read aligner, in a two-pass mode to improve alignment accuracy. Then processing the aligned reads based on recommendations from GATK (gatk/4.0.0.0) [<xref ref-type="bibr" rid="CR28">28</xref>] involving steps such as removing duplicates and recalibrating base quality scores and calling variants using GATK (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). The second method involved aligning the reads using the Minimap2 aligner [<xref ref-type="bibr" rid="CR29">29</xref>], followed by RNA variant calling settings from Strelka [<xref ref-type="bibr" rid="CR30">30</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). Only variants marked as passing the default filtering set by the Strelka algorithm were retained for this method. Therefore, we obtained two sets of candidate variants per cell that were detected by these two pipelines. Our primary reference for downstream analysis was the STAR-GATK procedure which is a widely used combination of read alignment and variant calling pipelines, as we found that the GATK process can aid in identifying and correcting noise and artefacts in the data. The outputs from the STAR-GATK procedure included information that was utilized in subsequent steps.</p>
    </sec>
    <sec id="Sec6">
      <title>RESA</title>
      <p id="Par25">We then annotated and filtered variants from the STAR-GATK pipeline similar to the CTAT-Mutations Pipeline which is designed to detect variants from bulk RNA sequencing data [<xref ref-type="bibr" rid="CR31">31</xref>]. We first annotated the variant location using ANNOVAR and kept only SNVs located in the exonic region for downstream filtering and labeling. Then SNVs that overlapped with RNA editing databases were removed for potential RNA editing events (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). After that, we filtered germline variants generated from matched normal if available, or from population SNP databases such as the genome Aggregation Database(gnomAD) 3.0. Hence, the primary filtered candidate variants from the original STAR-GATK pipeline were kept for further procession.</p>
      <p id="Par26">Next, we checked the concordance between the filtered STAR-GATK pipeline and the second pipeline using RESA. Variants identified by both pipelines were considered for candidate variant set A which represented the intersection of results from these two pipelines, while the variants of the filtered STAR-GATK pipeline which were the elements of the second pipeline were considered for candidate set B. RESA further processed the variant calling outputs by setting additional requirements on read quality, variant quality, strand bias, and variant positional bias. The common variants from the above-mentioned procedures were required to have a minimum read depth of 3 or user-specified site-specific depth.</p>
      <p id="Par27">Importantly, the resulting filtered SNVs for variant set A were stricter or at least comparable to quality-based filtering approaches used in other studies, such as the Quality-filter approach [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR16">16</xref>] referred to as Enge, 2017, for performance comparison.</p>
      <p id="Par28">RESA assumes that cancer cells evolve in a clonal manner and thus expressed somatic mutations have cross-cell recurrence, whereas the noise and artefacts are likely distributed randomly with a small probability of recurrence across the cell population (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). Based on this assumption, RESA set a cross-cell recurrence filter on a pseudo-bulk basis by keeping only SNVs that were detected in at least X number of cells to filter out artefacts, where X (X &gt;  = 3) by default is no less than 10% of the total cell number and can be adjusted by users (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d), which removed background sequencing errors and artefacts from candidate somatic SNVs. This criterion was intended to filter the false positive somatic mutations because we assume that the true positive somatic mutations should at least express a certain number of cells, but it may also remove true positive somatic mutations that are only expressed in very few cells (less than 10%). Furthermore, mutations detected in more than 80% of the total cell number were considered to be germline polymorphisms or artefacts as well. The key assumption is that compared with somatic mutations, germline variants should be detected in most cells at the RNA level.</p>
      <p id="Par29">The upper and lower limit number of cross-cell recurrence were used as parameters in the software and could be adjusted in a user-specified manner. The filtered SNVs from set A were considered putative true somatic variants. Thus, RESA built a putative “true positive” set of somatic variants directly from scRNA-seq data based on cross-cell recurrence and quality-based filtering.</p>
      <p id="Par30">RESA applied several criteria to enable filtering of putative germline mutations: 1) germline variants that were generated from the matched normal data, if available and specified in user input; 2) putative germline variants identified from population SNP databases such as gnomAD 3.0.; 3) putative germline variants with high detection recurrence in the tested cell population.</p>
      <p id="Par31">To build a high-confidence set of noise and artefact SNVs, RESA selected SNVs from set B that failed the above-mentioned criteria, such that putative noise and artefacts had the following properties:1) SNVs did not pass the quality-based filtering as described above, and 2) SNVs did not show any cross-cell recurrence. The remaining SNVs in set B pass the above-mentioned criteria and SNVs in set A failed the criteria were defined as the unsure set, which was subjected to RESA-jLR described below. We applied this selection criteria for each single cell and found very few SNVs overlapping between the positive and negative sets after merging SNVs across the cell population, suggesting a decent separation between our putative positive and negative sets.</p>
    </sec>
    <sec id="Sec7">
      <title>RESA-jLR</title>
      <p id="Par32">RESA employs a process of combining all putative positive and negative sets of somatic SNVs. The input variants to feed RESA-jLR combined all variants in positive and negative sets. Then the input dataset was split into training and test sets with the 3:1 ratio, with 3 quarters of the data used for training the model, and a quarter of the data used as an independent test set to evaluate the model performance. Because the sample size for each class on the training set was often imbalanced, thus, random oversampling was applied to replicate observations in minority classes, thereby rebalancing the dataset. RESA with the joint logistic regression model was the joint composition of two logistic regression models. One model depended on quality-based features such as variant quality, read depth, variant allele fraction, normalized probabilities of genotype, and allele depth. The other model derived its features from sequence-based attributes like mutation types, sequence contexts, and mutation signature components. Quality-based features were generally weighted similarly across datasets, while mutation sequence composition can be more sample-specific; hence, they were modeled differently. We trained the joint logistic regression model using the liblinear library, with L1 regularization applied to the quality-based model and L2 regularization applied to the sequence-based model using one-hot encoding. Each logistic regression model returned probability values for positive and negative classifications, with users being able to specify their thresholds based on these probabilities. Then we combined these two models into an integrated classifier with the following equation:<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left({pos}_{classifier}\right)=\frac{1}{2}{\sum }_{P\in ({P}_{seq}, { P}_{pos})}wP,$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="italic">pos</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">classifier</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">seq</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">pos</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mi>w</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13073_2023_1269_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>Where <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w=\left\{\begin{array}{c}1, if \,P \ge 0.5\\ 0, otherwise\end{array}\right.$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mo>≥</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1269_Article_IEq1.gif"/></alternatives></inline-formula>, <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{seq}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">seq</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1269_Article_IEq2.gif"/></alternatives></inline-formula> and <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{pos}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">pos</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1269_Article_IEq3.gif"/></alternatives></inline-formula> were probabilities to be the positive class of the two regression models. RESA-jLR sets 0.5 as the default threshold, which meant RESA-jLR defined the SNVs as positive if <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left({pos}_{classifier}\right) \ge 0.5$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="italic">pos</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">classifier</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>≥</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1269_Article_IEq4.gif"/></alternatives></inline-formula>. We also included probability as a parameter so that users could modify the thresholds.</p>
      <p id="Par33">After training, we assess the model's performance on the test set using the AUC score. As opposed to accuracy, the AUC score is appropriate for imbalanced datasets. Additionally, we applied the model to the candidate SNVs in the unsure set to refine and extrapolate the putative somatic variant set. This step recovered some true somatic variants filtered out in stringent criteria described earlier and enhanced sensitivity while maintaining high precision.</p>
    </sec>
    <sec id="Sec8">
      <title>Somatic mutation detection by other methods</title>
      <p id="Par34">We conducted a performance evaluation of RESA and RESA-jLR by comparing them to five previously published methods, including Enge 2017, Maynard 2020, BCFtools, VarScan, and Hovestadt 2019. We applied similar filtering criteria and parameters for somatic mutation filtering across all methods.</p>
      <p id="Par35">Somatic mutations were filtered by similar quality criteria which have been adopted in Enge 2017 [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. Specifically, we aligned sequencing data to the hg38 human reference using STAR and called alignment BAM files for different cell lines using GATK HaplotypeCaller. We then filtered out potential artefacts using VariantFilter (-cluster 3; -window 35; -filter QD &lt; 2.0; -filter FS &gt; 30.0). Finally, we employed the GATK variant quality score recalibration pipeline to filter the variation calls and exclude known germline variants.</p>
      <p id="Par36">Moreover, we utilized concord whitelist-based mutation selection which has been adopted in the Maynard 2020 with similar filtering criteria [<xref ref-type="bibr" rid="CR15">15</xref>]. Reads were aligned using STAR aligner, processed as suggested by GATK pipeline (gatk 4.0.0.0). Variants were called by GATK HaplotypeCaller (this process is adopted as part of the STAR-GATK Pipeline) [<xref ref-type="bibr" rid="CR30">30</xref>]. Next, we filtered out variants using the following criteria: 1) variants are located in exonic region; 2) variants have pathogenic effect as predicted by FATHMM; 3) variants have minimum total read depth of 3; 4) variants have been curated in COSMIC database [<xref ref-type="bibr" rid="CR32">32</xref>] in the same tissue type as sample tested. Besides, we also applied the STAR-GATK Pipeline [<xref ref-type="bibr" rid="CR28">28</xref>] from raw sequencing data detecting variants.</p>
      <p id="Par37">BCFtools [<xref ref-type="bibr" rid="CR33">33</xref>] (BCFtools 1.9) and VarScan (Varscan v2.4.4) [<xref ref-type="bibr" rid="CR34">34</xref>] were evaluated for their performances of detecting mutations across scRNA-seq data [<xref ref-type="bibr" rid="CR16">16</xref>]. We aligned reads to hg38 human reference using the BWA-MEM (BWA 0.7.17) and then used the GATK-PICARD pipeline to preprocess the BAM file. For better comparison, we chose the default parameters of these toolkits.</p>
      <p id="Par38">Besides, we created another recurrence-based method based on recurrence rates by following filtering criteria in the Hovestadt 2019 [<xref ref-type="bibr" rid="CR10">10</xref>]. We quantified variants at the genomic position using SAMtools mpileup for preprocessed BAM files in scRNA-seq data and then filtered out variants detected in fewer than three cells or not detected in the genome sequencing data.</p>
    </sec>
    <sec id="Sec9">
      <title>Somatic mutation detection using RESA in in silico spiked-in dataset</title>
      <p id="Par39">In order to further assess the effectiveness of RESA on human tissue datasets, we conducted a test using in silico spiked-in datasets. We hypothesized that scRNA-seq data from healthy juveniles would not contain somatic mutations, with the variants detected more likely to be germline mutations or artefacts resulting from sequencing. To assess the ability to detect somatic mutations in human tissue RNA datasets, we added somatic mutations from 10 distinct cell lines. The inclusion of various types of somatic mutations from different cell lines allowed for the evaluation of the generalization of RESA, as it was exposed to diverse mutation spectrums. And in this experiment, our focus was on the ability to detect add-on somatic mutations to avoid the potential impact on model performance that could arise from using ground truth data filtered by different criteria.</p>
      <p id="Par40">To avoid the subjective factors and controllable preferences, we used an independent tool – BAMSurgeon, a tool that can introduce somatic mutations to BAM files, to generate simulation data [<xref ref-type="bibr" rid="CR35">35</xref>]. To add mutations, we collected three independent real scRNA-seq data of pancreatic epithelial cells from healthy juveniles with SMART-seq2 technology, aged 1 month, 5 years, and 6 years [<xref ref-type="bibr" rid="CR12">12</xref>]. We aligned the raw reads from real scRNA-seq data to GRCh38 (GRCh38.p12) using BWA-MEM 0.7.17 with default parameters to create the original BAM files.</p>
      <p id="Par41">To spike SNV mutations into each scRNA-seq dataset, we used ten cancer cell lines with varying numbers of mutations from CCLE [<xref ref-type="bibr" rid="CR20">20</xref>] as the 'truth' VCF files that contained variant position information and variant allele fraction (VAF). The VAF of SNVs was determined by WES. If the VAF was missing, we replaced the VAF with 0.5. We used addsnv.py with the following relevant settings to spike SNVs in the original BAM files of cells: –mindepth 2 –minmutreads 1 –aligner mem. We then converted the 'burned-in' BAMs to in silico 'spiked-in' FASTQ files using GATK 4.2.3.0 SamToFastq. We identified 'spike-in' SNVs from each cell and reintroduced simulated SNVs to 50% of VCF files generated by the STAR-GATK procedure. Once algorithmic biases were introduced into the cells, we proceeded to analyze the 'spike-in' data using RESA and five other algorithms—Enge 2017 [<xref ref-type="bibr" rid="CR12">12</xref>], Maynard 2020 [<xref ref-type="bibr" rid="CR15">15</xref>], Hovestadt 2019 [<xref ref-type="bibr" rid="CR10">10</xref>], BCFtools [<xref ref-type="bibr" rid="CR16">16</xref>], and VarScan [<xref ref-type="bibr" rid="CR16">16</xref>].</p>
    </sec>
    <sec id="Sec10">
      <title>Method evaluation</title>
      <p id="Par42">To evaluate the performance of different methods, we gathered somatic mutations identified by various methods as mentioned above. We defined WES-identified somatic mutations that were carried in the tested scRNA-seq dataset as the ground truth. In this context, false positives are "false" somatic mutations including germline variants, RNA editing sites, noise, and artefact mutations in scRNA-seq data that are labeled as somatic mutations by RESA. Meanwhile, false negatives refer to true somatic mutations in scRNA-seq that are mislabeled by RESA as "false".</p>
      <p id="Par43">Precision, sensitivity, and F0.5 score were utilized to assess the performance of RESA across datasets. Precision evaluates the proportion of true positives among all the predicted positives, while sensitivity measures the proportion of true positives among all the ground truth positives. The F0.5 score is a commonly used adjusted F-score that assigns greater weight to precision than to sensitivity, given that precision is of greater importance in our algorithm. The F0.5 score satisfies the following equation:<disp-formula id="Equb"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_{0\cdot5}=1.25\cdot\frac{\left(precision\,sensitivity\right)}{0.25\,precision+sensitivity}$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>·</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1.25</mml:mn><mml:mo>·</mml:mo><mml:mfrac><mml:mfenced close=")" open="("><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.166667em"/><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi></mml:mfenced><mml:mrow><mml:mn>0.25</mml:mn><mml:mspace width="0.166667em"/><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1269_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par44">As we developed RESA, our strategy prioritized precision over sensitivity to instill greater confidence. This means our focus was on detecting true somatic mutations while minimizing the impact of artefacts. Even in situations where there is no matched normal WES/WGS data available for comparison, our strategy could still accurately predict somatic mutations.</p>
      <p id="Par45">To show the consistency between replicate experiments, we have presented it by using the overlap coefficient. It is defined as the size of the intersection divided by the smaller of the size in these two datasets.<disp-formula id="Equc"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$overlap \left(X,Y\right)=\frac{\left|X\cap Y\right|}{{\text{min}}\left(\left|X\right|,\left|Y\right|\right)}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:mi>X</mml:mi><mml:mo>∩</mml:mo><mml:mi>Y</mml:mi></mml:mfenced><mml:mrow><mml:mtext>min</mml:mtext><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:mi>X</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced close="|" open="|"><mml:mi>Y</mml:mi></mml:mfenced></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1269_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec11">
      <title>Analyzing primary tumor data</title>
      <p id="Par46">Kyu-Tae Kim used scRNA-seq by SMART-seq and whole-exome sequencing (WES) to examine intratumor heterogeneity in lung adenocarcinoma tumors (GSE69405). A 60-year-old male patient had a treatment-naïve lung cancer tumor, which was surgically excised and inoculated into immunocompromised mice to generate patient-derived xenograft (PDX) tumors. A sample of PDX tumor containing 34 single cells and an additional sample with 43 cells as a biological replicate were sequenced. WES analysis was also done on the patient's blood to obtain the matched normal data and filter out germline mutations.</p>
      <p id="Par47">The raw reads for melanoma scRNA-seq used for mutation identification were obtained from GSE116237 [<xref ref-type="bibr" rid="CR36">36</xref>]. The matched WES data for the PDX sample with two replicates were downloaded from EGAD0000179 [<xref ref-type="bibr" rid="CR37">37</xref>]. Four time points (T0, phase 1, phase 2, and phase 3) were included in the scRNA-seq dataset, but only T0 and phase 3 had matched WES data. To assess the performance of our method using matched WES data, we utilized RESA and RESA-jLR separately on these two time points.</p>
      <p id="Par48">Somatic mutation calling from WES data was carried out similarly to the CCLE project, including aligning WES reads to the GRACh38 reference genome using BWA-MEM 0.7.17, marking duplication with Picard, and avoiding systematic errors by Base Quality Score Recalibration with variant sites identified from the 1000 Genomes Project, dbSNP138, and Mills and 1000G gold standard indels. HaplotyCaller was used to call SNVs for the PDX tumor sample that contained matched normal data such as patient blood WES. The model of scoring variant quality for filtering was developed by VariantRecalibrator and ApplyVQSR under default parameters.</p>
    </sec>
    <sec id="Sec12">
      <title>Re-analyzing melanoma scRNA-seq expression matrix</title>
      <p id="Par49">The gene expression read count table after processing melanoma PDX data for all cells was obtained from GSE116237. The Seurat package was employed for expression analysis, and read counts were log normalized. The top 2000 variably-expressed genes were selected for dimension reduction using PCA. The K-nearest neighbor (KNN) graph was clustered and refined using the Louvain algorithm based on the top 30 transformed PCs from PCA. UMAP was used with a dimension of 20 and applied to the top 30 PCs for data exploration and visualization.</p>
    </sec>
    <sec id="Sec13">
      <title>Analyzing stage-specific somatic mutations</title>
      <p id="Par50">To enhance the sensitivity of our methods, we utilized RESA and RESA-jLR on the melanoma scRNA dataset across four time points. We then assessed stage-specific enrichment by calculating the <italic>p</italic>-value based on the cumulative distribution function of the hypergeometric distribution. We aimed to determine whether the number of cells with a mutant gene was overrepresented in one stage compared to the other stages. For each candidate gene containing a somatic mutation, we counted the number of mutation-carrying cells in each tumor stage and computed the p-value to identify the enrichment at each stage. If a gene passed the defined threshold p-value of 0.05 at a specific stage, we labeled it as enriched at that stage. This indicates that the distribution of the number of mutation-carrying cells is non-uniform and significantly enriched at the specific stage compared to the other stages [<xref ref-type="bibr" rid="CR38">38</xref>].</p>
    </sec>
    <sec id="Sec14">
      <title>Custom analysis and plots</title>
      <p id="Par51">Mutation Signature plots were done using SigProfilerPloting. UMAP plots were done using the Seurat package in R. Other custom plots were done using the Seaborn package in Python and the ggplot2 package in R.</p>
    </sec>
  </sec>
  <sec id="Sec15">
    <title>Results</title>
    <sec id="Sec16">
      <title>Challenges of detecting expressed SNVs in scRNA-seq data</title>
      <p id="Par52">De novo identification of somatic SNVs from scRNA-seq data is challenging due to the sparsity and noisiness of the data. Several factors, including allelic expression, expression abundance of mutant-containing genes, sequencing coverage per cell, variant allele frequency (VAF), and clonality, may contribute to the sparsity of the detectable mutations. To understand various factors that may influence the detectability of somatic mutations in scRNA-seq data, we gathered WES, bulk RNA-seq (bRNA-seq), and scRNA-seq datasets for the melanoma cell line A375. For example, the site for the <italic>BRAF</italic> V600E driver mutation has high coverage (referred to as site-specific depth hereafter) in both WES and bRNA-seq data, whereas only three out of five selected single cells have detectable site-specific depth (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). As indicated by this example, allelic expression as well as sequencing coverage might contribute to the sparsity of somatic mutations detectable from scRNA-seq data, which is also known as the effect of “allelic dropout”. Next, we analyzed scRNA-seq of all A375 cells and observed a significant correlation between sequencing coverage and expressed somatic mutations per cell (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). Concordantly, both site-specific depth and the gene expression levels correlate positively with the number of detectable somatic mutations (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). In addition, scRNA-seq VAF correlates positively with VAF from both bRNA-seq (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d) and WES (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3). Collectively, these results suggest that the detection of somatic mutations in scRNA-seq is jointly shaped by the mutation burden, sequencing coverage of the cell, as well as the sequencing depth and expression level of the mutant allele.<fig id="Fig2"><label>Fig. 2</label><caption><p>Detecting expressed somatic mutations in the A375 cell line and pancreas tissue datasets. <bold>a</bold> Integrative Genomics Viewer (IGV) window shows the hotspot mutation <italic>BRAF</italic> V600E in the A375 cell line. <bold>b</bold> The scatter plot of the percentage of exonic SNVs validated in scRNA-seq against the million reads per cell. <bold>c</bold> The scatter plot shows the expression level against the number of expressed somatic mutations in each gene. <bold>d</bold>, <bold>e</bold>, The bar plot illustrates the distribution of VAF of expressed somatic mutations in scRNA-seq compared with corresponding VAF in bRNA-seq (<bold>d</bold>) and in WES (<bold>e</bold>). <bold>f</bold> The percentage of accumulated expressed SNVs validated in scRNA-seq. <bold>g</bold> The density plot shows the distribution of detected SNVs of each cell after passing the standard variant calling pipeline in the A375 cell line datasets with two conditions</p></caption><graphic xlink:href="13073_2023_1269_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par53">The sparsity of detectable somatic mutations in scRNA-seq data can be alleviated by sequencing a large number of cells (Fig. <xref rid="Fig2" ref-type="fig">2</xref>f). However, de novo identification of expressed somatic mutations following standard variant calling pipelines results in tremendous amounts of noise in the data (Fig. <xref rid="Fig2" ref-type="fig">2</xref>g). One possible explanation for the noise is that currently used mutation calling algorithms failed to take into account the noise and artefact SNVs generated during the experimental procedure. Consistently, a recent study evaluated the performance of several mutations calling algorithms on scRNA-seq data using simulated scRNA-seq reads, and demonstrated that most of the algorithms tested showed satisfying performance with FDR &lt; 0.05 [<xref ref-type="bibr" rid="CR16">16</xref>], suggesting that noise and artefacts carried by the sequencing read can be picked up equally well with actual mutations of the cell. This aligns with our knowledge that the experimental procedures of scRNA-seq, including cell lysis, cDNA conversion, library preparation, etc., may result in arteficial variants that far exceed the number of true variants (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4). Subsequently, the direct application of such mutation calling algorithms on real scRNA-seq data may mislead biological interpretations of the data. Therefore, computational methods that can effectively filter out such experimental noise and artefacts are essential for de novo identification of somatic mutations in scRNA-seq data.</p>
    </sec>
    <sec id="Sec17">
      <title>The computational principle of RESA to identify somatic SNVs from scRNA-seq</title>
      <p id="Par54">We present a computational framework RESA – Recurrently Expressed SNV Analysis, which detects expressed somatic mutations with high precision directly from scRNA-seq data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a-d). We focused on scRNA-seq technologies that capture full length transcripts and single nucleotide variants (SNVs) for somatic mutation analysis. RESA effectively eliminates noise and artefact variants in the scRNA-seq data by applying a series of filtering steps, including cross-cell recurrence. For instance, with the standard variant calling process, about 0.5–0.8 million SNVs were identified in cancer cell lines A375 and HCT116, where numerous noises and artefacts dominate the pool (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5). We found that different variant callers followed with basic filtering barely helped. On the contrary, applying RESA effectively removed the majority of noises and artefacts, and achieved about 75% of true somatic SNVs out of the total SNVs identified by the algorithm (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5c, d). In addition, we developed a joint logistic regression approach following RESA, i.e., RESA-jLR, to filter out noise and artefacts while increasing sensitivity by identifying positive cases from an unsure set of variants. Notably, applying RESA-jLR identified additional somatic SNVs while keeping the proportion of noise and artefacts small (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5).</p>
      <p id="Par55">We validated that RESA-identified somatic mutations maintained a positive VAF correlation between scRNA-seq and WES, as well as scRNA-seq and bRNA-seq across multiple cell lines (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6a, b). In particular, although germline variants are thought to share similar quality properties as somatic mutations, we adopted several approaches to help eliminate germline variants in different circumstances.</p>
      <p id="Par56">We applied RESA-jLR to full-length scRNA-seq data from 15 datasets encompassing 8 cancer cell lines, which were generated by different research groups, employed different experimental protocols, and operated under different experimental conditions (<xref rid="Sec2" ref-type="sec">Methods</xref>, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1). To assess the accuracy of the joint logistic regression model, we evaluated its performance in the independently held-out test sets. The model achieved an AUC ranging from 0.79 to 0.98, with an average AUC of 0.89 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7), suggesting the joint logistic regression model was highly effective. Furthermore, we observed high agreement among most datasets when comparing the feature weights of quality-related features in the quality-based logistic regression. This indicates that the effect of quality-related features on mutation detection could be generalizable (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8a). In contrast, we found that feature weights of sequence-related features were cell type-specific, with high correlation observed only among different experimental conditions of the same cell line (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8b). This demonstrated the adaptable nature of RESA-jLR to specific cell types and the robustness of RESA-jLR across experimental conditions.</p>
    </sec>
    <sec id="Sec18">
      <title>RESA maintains high precision in in silico spike-in scRNA-seq datasets of human tissue</title>
      <p id="Par57">To comprehensively benchmark RESA against other methods in human tissue scRNA-seq data under diverse scenarios, we designed an in silico spike-in experiment (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). Briefly, we collected SMART-seq2 data generated from pancreas tissues of three donors as three baseline datasets, namely 4-month-old (221 cells), 5-year-old (331 cells), and 6-year-old (178 cells), respectively [<xref ref-type="bibr" rid="CR12">12</xref>]. We considered the datasets from these donors to carry predominantly noise and artefacts and expected minimal true somatic mutations as they were generated in body cells after birth. We then collected a total of 77,088 somatic mutations from CCLE WES data of 10 cancer cell lines with varying cancer types and mutation burdens. For each cancer cell line and each baseline dataset, we “spiked-in” somatic SNVs in silico using BAMSurgeon [<xref ref-type="bibr" rid="CR35">35</xref>], followed by performing RESA or other methods to detect somatic mutations. To analyze the effect of coverage per cell and cell number on algorithm performance, we sorted the single cells in decreasing coverage and tested algorithms’ performance on different subsets of the cell population (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, <xref rid="Sec2" ref-type="sec">Methods</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><p>Benchmark RESA to other methods in the in silico spike-in scRNA-seq datasets. <bold>a</bold> Workflow for in silico spike-in. scRNA-seq raw reads of pancreas tissues from 3 healthy juveniles using SMART-seq2 technology in Enge et al. 2017 [<xref ref-type="bibr" rid="CR12">12</xref>] were collected as original BAM files. Somatic SNVs of 10 cancer cell lines covering 5 tissues of origin were identified from WES data. Bamsurgeon spiked cancer cell line somatic SNVs into the original BAM files to produce ‘Burn-in’ BAM files. In silico spike-in scRNA-seq datasets were ordered by the coverage of each cell, split into several subsets, and followed by further evaluations. b, The violin plot illustrates the distribution of coverage in each subset. The error bars display the average and standard deviation of the precision of RESA, RESA-jLR, and the other 5 previously published algorithms. If the minimum value of the error bar is less than 0, 0 is shown. Top: a 4-month-old infant (Blue). Middle: a 5-year-old child (Purple). Bottom: a 6-year-old child (Green). <bold>c</bold> The scatter plot shows precisions and sensitivities in different subsets of 10 cell lines. Points in red are the results of RESA, and points in blue are the results of RESA-jLR. Top: a 4-month-old infant. Middle: 5-year-old child. Bottom: a 6-year-old child. <bold>d</bold> F0.5 score in in silico spike-in scRNA-seq datasets (Wilcoxon rank-sum test, NS: not significant, * <italic>p</italic> &lt; 0.05, ** p &lt; 0.01, *** <italic>p</italic> &lt; 0.001, **** <italic>p</italic> &lt; 0.0001). Top: a 4-month-old infant (Blue). Middle: 5-year-old child (Purple). Bottom: a 6-year-old child (Green). <bold>e</bold> The bar plot illustrates the number of “spiked-in” mutations across 10 cell lines. Top: a 4-month-old infant (Blue). Middle: 5-year-old child (Purple). Bottom: a 6-year-old child (Green)</p></caption><graphic xlink:href="13073_2023_1269_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par58">RESA demonstrated the most consistent and highest precision in all spiked-in scRNA-seq datasets tested, with average precision of 0.84, 0.87, and 0.87 for the three baseline datasets, respectively, followed by RESA-jLR model with average precision of 0.61, 0.66, and 0.76, respectively (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). Among the five previously published methods, Maynard et al. showed the highest average precision. However, the precision varied significantly across different test cases, with an average precision of only 0.2 for all three baseline datasets (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). Furthermore, spike-in results showed that additional cells with lower sequencing coverage led to decreased precision overall, but RESA demonstrated more stable precision compared to the RESA-jLR model (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). This suggests that sequencing coverage at a single cell level might be more crucial for mutation detection than the total number of cells tested. Additionally, we observed that RESA consistently maintained high precision with low variation even with a significant variation in the number of “spiked-in” somatic mutations from different cancer cell lines (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, d). Here we demonstrated that RESA can reach average an precision of 0.86 in primary tissue samples, with an average of 1.8 million reads/cell (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9). Notably, in the in silico spike-in data of a 1-month-old infant, more than 50 cells had less than 1 million reads, yet the average precision for this dataset was approximately 0.87.</p>
      <p id="Par59">The RESA-jLR model complemented the conservative approach used in RESA by demonstrating increased sensitivity at the cost of decreased precision. For instance, the RESA-jLR identified, on average, 20% more new somatic mutations in the test cases from the 5-year-old baseline dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10). We further evaluated the performance using an F0.5 score, a weighted harmonic mean emphasizing more on precision over sensitivity. In test cases with large numbers of “spiked-in” somatic mutations, RESA-jLR outperformed RESA with an increase in sensitivity and a stable precision that resulted in higher F0.5 scores (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c, d, e, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S11), suggesting that RESA-jLR has advantages in datasets with high mutation burden. In addition, through in silico “spike-in” analysis, we demonstrated the superior performance of RESA across different sequencing coverage and cancer cell lines. Our results highlighted the difficulty in balancing precision and sensitivity in scRNA-seq somatic mutation detection tasks.</p>
    </sec>
    <sec id="Sec19">
      <title>RESA achieves higher precision across cancer cell line data</title>
      <p id="Par60">The WES/WGS data available from various cancer cell lines presented us with the opportunity to assess the performance of different methods using orthogonal information. We gathered 15 scRNA-seq datasets covering eight cancer cell lines with somatic mutations from WES available, and compared five previously published methods [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>] with varying strategies to benchmark against the RESA pipeline. Across all 15 datasets, both RESA and RESA-jLR consistently demonstrated substantially higher precision compared to other methods, achieving an average precision of 0.75 (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S12), while RESA-jLR increased sensitivity with slightly decreased precision compared to RESA alone (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S13). The high precision of RESA and RESA-jLR made the identified somatic mutations much more reliable for downstream analysis and interpretations, despite suboptimal sensitivity. The other methods showed variable sensitivity but dramatically lower precision, which diminished the value of these methods (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). Additionally, RESA and RESA-jLR outperformed other methods overall, with RESA-jLR showing marginally higher and more stable F0.5 performance (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). The best-performing method, other than RESA, is the method used by Maynard et al. [<xref ref-type="bibr" rid="CR15">15</xref>] (Methods), which mainly focused on filtering against a curated somatic mutation whitelist combined with tissue source information. Although this filtering of mutations is intuitively reasonable, however, the performances of the Maynard et al. method varied dramatically depending on the dataset used, which confirmed the sporadic nature of cancer somatic mutations in a sample specific manner. In contrast, the somatic mutations identified by RESA between datasets of the same cell line showed remarkable consistency (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14b).<fig id="Fig4"><label>Fig. 4</label><caption><p>Evaluating the performance of RESA with comparison to other methods using WES data across multiple cancer cell lines. <bold>a</bold> Boxplots showing precisions (top) and sensitivities (bottom) of different methods in identifying positive somatic SNVs using WES data as ground truth across 15 scRNA-seq datasets. <bold>b</bold> The scatter plot showing F0.5 scores of different methods in identifying positive somatic SNVs using the number of somatic SNVs in WES data as ground truth across 15 scRNA-seq datasets. <bold>c</bold> Mutation spectra of somatic SNVs identified using all exonic SNVs, all expressed SNVs, RESA-jLR, and the Maynard 2020 approach across 3 scRNA-seq datasets. Pairwise cosine similarity scores were shown next to brackets</p></caption><graphic xlink:href="13073_2023_1269_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par61">Notably, RESA effectively identified somatic SNVs across cancer cells with varying mutation burdens despite sensitivity differences (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14d). In particular, in the case of the JURKAT cell line, RESA detected a median of 449 and 387 somatic SNVs per cell in the SMART-seq and TARGET-seq datasets, respectively. These numbers were over 100 times higher than the somatic mutations detected in experimental multi-omic profiling (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14c, Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S1, Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Table S1) [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>].</p>
      <p id="Par62">Next, we assessed the population-wise mutational spectrum captured by different methods against the WES mutational spectrum, and all expressed SNVs that can potentially be detected in the corresponding scRNA-seq data. We observed that expressed SNVs generally captured the exonic mutational spectra well, with lower numbers of SNVs detected and sparser presentation for low mutation burden samples (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14d). Expressed SNVs detected by RESA-jLR reproduced the mutational spectrum of all expressed SNVs faithfully, particularly in samples with a high mutation burden (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14d). In contrast, Maynard 2020 [<xref ref-type="bibr" rid="CR15">15</xref>], the best-performing method in precision among all other methods, failed to capture the mutational spectra of either expressed or all exonic SNVs (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14d). Therefore, expressed SNVs detected by RESA-jLR from the scRNA-seq data can be used to assess the genomic mutational spectra, particularly in samples with a high mutation burden.</p>
    </sec>
    <sec id="Sec20">
      <title>RESA achieved higher precision across tumor tissue datasets</title>
      <p id="Par63">To further evaluate RESA's performance in real tumor data, we collected four scRNA-seq datasets with matching WES data from two independent studies involving different cancer types. These datasets include two replicates of lung adenocarcinoma tumor xenograft [<xref ref-type="bibr" rid="CR25">25</xref>], and melanoma patient-derived xenograft (PDX) before and after RAF/MEK inhibitor treatment [<xref ref-type="bibr" rid="CR36">36</xref>]. Again, RESA and RESA-jLR achieved the highest precision and F0.5 scores over other methods (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, b, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S15, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S16). In particular, in the lung cancer datasets with matched normal WES available, RESA was able to obtain higher performance using germline variants from matched normal than using publicly available SNP databases to filter out germline variants (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S17), highlighting that germline variants from matched normal should be applied in RESA whenever such data is available. Despite the likelihood of primary tumor samples being more heterogeneous than cancer cell lines, RESA maintained a positive correlation between scRNA-seq VAF and WES VAF, even with large variations in the WES VAF (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c).<fig id="Fig5"><label>Fig. 5</label><caption><p>Benchmark RESA to other methods in PDX tumor datasets. <bold>a</bold> The bar plots illustrate precisions of RESA, RESA-jLR and other methods in a lung cancer PDX tumor from the same patient with 2 replicates. <bold>b</bold> The bar plots illustrate precisions of RESA, RESA-jLR and other methods in melanoma PDX datasets without treatment (T0) and after treatment (Phase3), <bold>c</bold>, <bold>d</bold>, <bold>e</bold>, <bold>f</bold>, Scatter plots showing VAF correlation of SNVs detected by RESA between scRNA-seq and WES in the lung cancer tumor sample with the replicate 1 (<bold>c</bold>) and replicate 2 (<bold>d</bold>), and melanoma datasets without treatment (<bold>e</bold>) and with treatment (<bold>f</bold>)</p></caption><graphic xlink:href="13073_2023_1269_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par64">Melanoma tumors are characterized by UV signatures in their mutational spectra, which can serve as an additional indicator to assess the reliability of RESA. In the above-mentioned time-course study of RAF/MEK inhibition resistance using scRNA-seq datasets from the melanoma PDX model, over 600 single cells were profiled across four time points: T0 (tumor before treatment), phase 1 (tumor shrinking stage after treatment), phase 2 (minimal residual disease stage), and phase 3 (relapsed stage after drug treatment) [<xref ref-type="bibr" rid="CR36">36</xref>]. RESA accurately reproduced the typical mutational spectrum of UV signature in all melanoma datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S18a). Interestingly, the UV signature remains strong with little variation across different clusters or time points of the cell population, despite expression heterogeneity of somatic SNVs and involved genes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S18c). This is consistent with previous knowledge that treatment with mechanism of action (MOA) not involving DNA replication and repair, e.g. BRAF inhibitor dabrafenib, is not expected to induce large mutational changes [<xref ref-type="bibr" rid="CR36">36</xref>]. In addition, we identified the known BRAF V600E driver mutation present in the sample using RESA (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S1), further validating the reliability of RESA.</p>
    </sec>
    <sec id="Sec21">
      <title>RESA identifies drug resistance-associated genes with expressed somatic mutations in a melanoma PDX scRNA-seq dataset</title>
      <p id="Par65">We applied RESA-jLR to the scRNA-seq datasets of the melanoma PDX model, where we identified 575 unique somatic SNVs and their corresponding 524 genes (Methods, Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S1). To investigate the interplay between mutational heterogeneity and transcriptional heterogeneity, we further analyzed the dataset using graph-based clustering to summarize the gene expression heterogeneity (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S18b). By overlaying the four-time points onto the clusters, we identified both shared and unique clusters across timepoints (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a), which confirmed the transcriptional heterogeneity in the scRNA-seq of the melanoma samples throughout different drug treatment stages. For example, cluster 3 represented unique cell groups at the MRD stage (phase 2), whereas cluster 2 showed expression patterns shared by both the tumor shrinking stage (phase 1) and MRD stage (phase 2). We observed that during the MRD stage of phase 2, cell clusters of 0,1,2,3,5 were all present, indicating a coexistence of heterogeneous subclones rather than the dominance of a single subclone despite minimal tumor size. Thus, our gene expression reanalysis validates the existence of multiple subclones with distinct gene expression signatures across different tumor stages.<fig id="Fig6"><label>Fig. 6</label><caption><p>Somatic SNVs enriched in specific stages using RESA. <bold>a</bold> UMAP embedding of scRNA-seq profiles of each stage. <bold>b</bold> Distributions of percentages of cells harboring stage-specific mutations of each stage. (n.s.: <italic>p</italic> &gt; 0.05, *: <italic>p</italic> &lt;  = 0.05, **: <italic>p</italic> &lt;  = 0.01, ***: <italic>p</italic> &lt;  = 0.001, ****: <italic>p</italic> &lt;  = 0.0001) <bold>c</bold> Aggregate expression of log<sub>2</sub> of transcripts per 10,000 reads (color bar) for stage-specific genes detected in more than 10 cells and the number of cells harboring the mutation in each stage (cycle). <bold>d</bold> List of gene set enrichment results for each stage (MSigDB hallmark)</p></caption><graphic xlink:href="13073_2023_1269_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par66">In order to study the mutational heterogeneity during drug response, we defined "stage-specific" somatic mutations as follows (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b,c). While most mutations were found present across all stages, we reasoned that subclonal mutations that contribute to different stages of the tumor should be non-uniformly present. Based on this assumption, we counted the number of cells carrying mutations in each tumor stage and calculated the enrichment accordingly. We then identified mutated genes that were enriched in specific tumor stages of the cell population compared to their wild-type counterparts. Specifically, we detected 72, 75, 88, and 63 mutated genes for the respective stages and focused our following analysis on mutated genes (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b,c, Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Table S1, Methods).</p>
      <p id="Par67">To investigate the mutated gene expression signatures, we tested GSEA curated cancer hallmarks enriched for the stage-specific mutated genes (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d). As expected, mutated genes were enriched in pathways associated with melanoma development and progression, including the p53 pathway, epithelial to mesenchymal transition (EMT) pathway, mTORC1 signaling, androgen response pathway, and UV response [<xref ref-type="bibr" rid="CR39">39</xref>–<xref ref-type="bibr" rid="CR44">44</xref>]. Notably, when comparing hallmarks of mutated genes across different stages, the androgen response pathway, which is associated with melanoma tumor growth and invasion, was enriched exclusively in the MRD stage (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d). Recent clinical research has reported that drug resistance is associated with sex, and males have shorter survival after BRAF-inhibitor monotherapy [<xref ref-type="bibr" rid="CR45">45</xref>, <xref ref-type="bibr" rid="CR46">46</xref>]. Additionally, androgen receptor signaling is associated with the resistance of targeting BRAF [<xref ref-type="bibr" rid="CR45">45</xref>]. Thus, the androgen response pathway may serve as a crucial mechanism for tumor survival in such cases. Therefore, cancer hallmarks that may be disturbed by expressed somatic SNVs may provide valuable orthogonal information beyond expression variation.</p>
    </sec>
  </sec>
  <sec id="Sec22">
    <title>Discussion</title>
    <p id="Par68">Identifying somatic mutations directly from scRNA-seq data has been a long-standing challenge. While attempts have been made, no computational method has been proven widely applicable. We report a computational framework named RESA, which identifies expressed somatic SNVs with high precision directly from the scRNA-seq data. RESA can effectively filter out noise and artefacts generated during the experimental procedure, thereby achieving high precision. In addition, RESA applies a joint logistic regression to expand the putative somatic mutations, which helps increase detection sensitivity while maintaining high precision. We comprehensively benchmarked RESA across datasets both in vitro and in vivo, and demonstrated the reliability of RESA in different scenarios.</p>
    <p id="Par69">In addition to evaluating individual SNVs, RESA also attempts to assess the mutational spectrum of expressed SNVs. High precision detection of somatic SNVs enables reliable mutational signature analysis of the expressed SNVs in scRNA-seq data, thus providing insights into the mechanistic biological processes involved in cancer progression, or revealing potential therapeutic opportunities in the sample of interest.</p>
    <p id="Par70">Balancing precision and sensitivity is tricky. Precision measures the proportion of true somatic mutations identified by RESA out of all somatic mutations suggested by RESA (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). On the other hand, sensitivity measures the proportion of true somatic mutations out of all somatic mutations carried in scRNA-seq data. Previous methods mostly achieve high sensitivity, but their low precisions lead to an excessive amount of noise and artefacts (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). The main purpose of our model is to identify higly reliable somatic mutation, which emphasizes more on precision over sensitivity. So that we can be very confident in the RESA-suggested somatic mutations in cases without matched WES/WGS for evaluation and improved the reliability of downstream analysis. To compensate for the loss of sensitivity, and increase sensitivity, we developed the RESA-jLR modeling step. In addition, we used the F0.5 score to reconcile the performance evaluation balance between precision and sensitivity. As demonstrated in our results, RESA-jLR achieves better performances than RESA in cases of high mutation burden or high sequencing coverage per cell.</p>
    <p id="Par71">VAF represents the fraction of alleles containing mutations. In WES, the VAF value is affected by tumor purity and clonality. In bRNA-seq, the VAF interpretation is further complicated due to allelic and stochastic expression and the abundance of genes containing mutations. However, the VAF estimate from scRNA-seq might be perceived as the deconvolution of bRNA for VAF without the complication of tumor purity as long as only cancer cells are assessed. Interestingly, we observed a positive correlation between scRNA-seq VAF and VAF from both bRNA-seq (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d) and WES (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e) in the A375 cell line data. These results suggest that scRNA-seq VAF might be indicative of the mutant VAF at the bulk level. Notably, we detected somatic mutations from scRNA-seq with a WES VAF as low as 0.13 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3).</p>
    <p id="Par72">Detection of expressed SNVs using RESA may suffer from several limitations. RESA works best in scRNA-seq data that are sequenced relatively deep (1–3 million reads per cell in general), or in samples with relatively high mutation burden. Application to other widely used scRNA-seq technologies like 10X genomics and drop-seq might thus be limited by the nature of shallow sequencing and biased gene region coverage. However, recent studies have made efforts to address the coverage issue by combining bam files of the same cell type in 10X Genomics datasets to detect somatic mutations [<xref ref-type="bibr" rid="CR47">47</xref>]. Taking this into consideration, we acknowledge that RESA could be improved by incorporating this strategy in the future, thereby expanding its potential application areas. Another potential limitation is that this approach is designed to detect clonal somatic mutations instead of rare mutations in the population. Empirically we found that WES VAF above 0.1 can be detectable in scRNA-seq data and RESA. In addition, due to the nature of the scRNA-seq experiment, only mutations with relatively high expression are potentially detectable. Lastly, some somatic mutations expressed in a single cell might not be detectable through WES/WGS, leading to a decreased precision value that underestimates the real precision. Moreover, the clonal divergence between cell cultures that generated WES/WGS data vs. scRNA-seq data might also decrease the precision. Thus, the limited sensitivity of scRNA-seq data as well as RESA might potentially limit its application.</p>
    <p id="Par73">The success of RESA in high precision somatic mutation detection from scRNA-seq data highlights the critical importance of cellular recurrence, whereas prioritizing based on functional prediction or stratification from curated whitelist mutations does not always work well. This is the first study, to the best of our knowledge, that made a direct comparison among the methods emphasizing the above aspects and delivering distinctive results. As more datasets, especially datasets with both scRNA-seq and WES/WEG profiling on the same sample, become available, new methods may be developed with better performance. We believe RESA will provide valuable information to facilitate single cell level genotype to phenotype study in the future.</p>
  </sec>
  <sec id="Sec23">
    <title>Conclusions</title>
    <p id="Par74">In summary, we introduce a computational framework package named RESA that identifies expressed somatic mutations from scRNA-seq de novo. RESA effectively filters out noise and artefacts identified through common variant calling pipelines. We demonstrated the remarkable improvement in precision and F0.5 score of RESA against other methods across multiple test case scenarios. We showcased the application of RESA-jLR to provide novel insights into the potential mutational mechanisms underlying melanoma MRD, and we believe RESA is highly valuable to providing orthogonal insights into the intratumor heterogeneity studies in scRNA-seq datasets.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec24">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13073_2023_1269_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: </bold>Includes 18 figures of additional results. The names of the figure are: <bold>Figure S1. </bold>Workflow illustrates the different strategies between RESA and other methods; <bold>Figure S2.</bold> The correlation between site-specific depth and number of detectable SNVs in scRNA-seq; <bold>Figure S3. </bold>Scatter plots showing VAF correlation of SNVs detected by RESA between scRNA-seq and WES in the A375 cell line; <bold>Figure S4.</bold> Full length scRNA-seq sequencing procedure, steps where noise and artefacts may be introduced are highlighted; <bold>Figure S5. </bold>Comparison between identified somatic SNVs and identified noise and artefacts; <bold>Figure S6.</bold> Scatter plots showing VAF correlation of SNVs detected by RESA between scRNA-seq and WES, as well as scRNA-seq and bRNA-seq in the A375 cell line and LNCaP cell line; <bold>Figure S7.</bold> AUC values of the joint logistic regression model prediction on the test set in 15 tested datasets;<bold> Figure S8.</bold> Correlation of feature weights in quality-based and sequence-based logistic regression; <bold>Figure S9. </bold>The distribution of million reads per cell in in silico spike-in datasets of 1-month-old, 5-year-old, 6-year-old donors; <bold>Figure S10. </bold>The bar plot illustrates the percentage change of the number of expressed SNVs detected by RESA-jLR against RESA-identified SNVs in the in silico spike-in scRNA-seq dataset of a 5-year-old child; <bold>Figure S11.</bold> The bar plot illustrates sensitivity in the in silico spike-in scRNA-seq dataset of 1-month-old, 5-year-old, 6-year-old donors; <bold>Figure S12.</bold> Boxplots showing precisions (top) and sensitivities (bottom) of different methods in identifying positive somatic SNVs using WES data as ground truth across 15 scRNA-seq datasets; <bold>Figure S13. </bold>The bar plot illustrates the sensitivity of 15 cell line datasets;<bold> Figure S14. </bold>Evaluating RESA performance with comparison to other methods; <bold>Figure S15.</bold> The bar plot illustrates sensitivity in PDX tumor datasets; <bold>Figure S16.</bold> Bar plots illustrate the F0.5 scores of RESA, RESA-jLR, and other methods in PDX tumor datasets; <bold>Figure S17.</bold> Lung cancer PDX tumor datasets with the matched normal in two groups of independent cells; <bold>Figure S18. </bold>Reanalysis of a melanoma scRNA-seq dataset using RESA.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13073_2023_1269_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2:</bold> Includes 1 table for cell line data sets used in the study. The name of the table is:<bold> Table S1. </bold>Somatic SNVs detecting by RESA to full-length scRNA-seq data from 15 datasets.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13073_2023_1269_MOESM3_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3:</bold> Includes 1 table of the annotation for cell line data sets used in the study. The name of the table is:<bold> Table S1. </bold>Annotation of each mutation in 15 cell line datasets detected by RESA.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13073_2023_1269_MOESM4_ESM.xlsx">
            <caption>
              <p><bold>Additional file 4:</bold> Includes 1 table of the statistical summary for cell line data sets. The name of the table is:<bold> Table S1.</bold> Summary statistic table of mutations detected by RESA.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13073_2023_1269_MOESM5_ESM.xlsx">
            <caption>
              <p><bold>Additional file 5:</bold> Includes 1 table for melanoma data sets. The name of the table is:<bold> Table S1.</bold> 575 unique somatic SNVs of scRNA-seq of the melanoma detected by RESA, which mapped to 524 genes.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="13073_2023_1269_MOESM6_ESM.xlsx">
            <caption>
              <p><bold>Additional file 6:</bold> Includes 1 table of the stage enrichment for melanoma data sets. The name of the table is:<bold> Table S1.</bold> P values of the Hypergeometric test for stage-specific somatic SNVs enrichment in each stage.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>scRNA-seq</term>
        <def>
          <p id="Par2">Single-cell RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>RESA</term>
        <def>
          <p id="Par3">Recurrently Expressed SNV Analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>MRD</term>
        <def>
          <p id="Par4">Minimal residual disease</p>
        </def>
      </def-item>
      <def-item>
        <term>WGS</term>
        <def>
          <p id="Par5">Whole genome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>WES</term>
        <def>
          <p id="Par6">Whole exome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>RESA-jLR</term>
        <def>
          <p id="Par7">RESA followed by a joint logistic regression</p>
        </def>
      </def-item>
      <def-item>
        <term>VAF</term>
        <def>
          <p id="Par8">Variant allele frequency</p>
        </def>
      </def-item>
      <def-item>
        <term>bRNA-seq</term>
        <def>
          <p id="Par9">Bulk RNA-seq</p>
        </def>
      </def-item>
      <def-item>
        <term>PDX</term>
        <def>
          <p id="Par10">Patient-derived xenograft</p>
        </def>
      </def-item>
      <def-item>
        <term>MOA</term>
        <def>
          <p id="Par11">Mechanism of action</p>
        </def>
      </def-item>
      <def-item>
        <term>EMT</term>
        <def>
          <p id="Par12">Epithelial to mesenchymal transition</p>
        </def>
      </def-item>
      <def-item>
        <term>scWGS</term>
        <def>
          <p id="Par13">Single cell whole genome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>LUAD</term>
        <def>
          <p id="Par14">Lung adenocarcinoma</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>This article has been updated to amend affiliations 1 &amp; 2.</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>
        <bold>Change history</bold>
      </p>
      <p>5/14/2024</p>
      <p>A Correction to this paper has been published: 10.1186/s13073-024-01343-2</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Prof. Peter Park, Prof. Haoxing Xu, and Vinay V. Viswanadham for their helpful discussion and suggestions. We thank Prof. Haoxing Xu, Dr. Jiaming Li, Dr. Xudong Fu, Dr. Zhaoyuan Fang, and Dr. Asif Ashan for critical reading and suggestions on the manuscript. We are also thankful for the technical support by the Core Facilities of Liangzhu Laboratory.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>N.S. designed the project and overall method. N.S. and T.Z. developed, implemented the method and analyzed the data. N.S., T.Z., H.J., and T.S. drafted the manuscript. L.L., D.C.G, H.W., R.X., W.G. and H.G. contributed suggestions. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the Leading Innovative and Entrepreneur Team Introduction Program of Zhejiang (No. 2021R01012) and the Starting Fund from Zhejiang University.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The WES data and bulk RNA-seq data for cancer cell line LNCaP were downloaded through Genomic Data Commons (<ext-link ext-link-type="uri" xlink:href="https://gdc.cancer.gov/">https://gdc.cancer.gov/</ext-link>). The exonic somatic mutations for all cancer cell lines were downloaded from CCLE_20Q1_mutations [<xref ref-type="bibr" rid="CR20">20</xref>]. The scRNA-seq for cancer cell lines were downloaded from GSE105451 [<xref ref-type="bibr" rid="CR4">4</xref>], GSE99795 [<xref ref-type="bibr" rid="CR21">21</xref>], GSE76312 [<xref ref-type="bibr" rid="CR5">5</xref>], GSE150993 [<xref ref-type="bibr" rid="CR22">22</xref>], GSE108383 [<xref ref-type="bibr" rid="CR23">23</xref>], GSE140440 [<xref ref-type="bibr" rid="CR24">24</xref>], and GSE69405 [<xref ref-type="bibr" rid="CR25">25</xref>] respectively. The lung cancer scRNA-seq data and WES were downloaded from GSE69405 [<xref ref-type="bibr" rid="CR25">25</xref>]. The human tissue scRNA-seq data of melanoma were downloaded from GSE81547 [<xref ref-type="bibr" rid="CR35">35</xref>]. The matched WES of melanoma PDX was downloaded from EGAD00001007749 [<xref ref-type="bibr" rid="CR36">36</xref>].</p>
    <p>The source code for the RESA pipeline is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ShenLab-Genomics/RESA">https://github.com/ShenLab-Genomics/RESA</ext-link> [<xref ref-type="bibr" rid="CR26">26</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par75">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par76">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par77">The authors have submitted a patent application for the method. Other than this, the authors declare that they do not have any competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Yizhak K, Aguet F, Kim J, Hess JM, Kübler K, Grimsby J, et al. RNA sequence analysis reveals macroscopic somatic clonal expansion across normal tissues. Science. 2019;364. Available from: 10.1126/science.aaw0726</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">PCAWG Transcriptome Core Group, Calabrese C, Davidson NR, Demircioğlu D, Fonseca NA, He Y, et al. Genomic basis for RNA alterations in cancer. Nature. 2020;578:129–36.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nam</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>K-T</given-names>
          </name>
          <name>
            <surname>Chaligne</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Izzo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Somatic mutations and cell identity linked by Genotyping of Transcriptomes</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>571</volume>
        <fpage>355</fpage>
        <lpage>360</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1367-0</pub-id>
        <?supplied-pmid 31270458?>
        <pub-id pub-id-type="pmid">31270458</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rodriguez-Meira</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Buck</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>S-A</given-names>
          </name>
          <name>
            <surname>Povinelli</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Alcolea</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Louka</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unravelling intratumoral heterogeneity through high-sensitivity single-cell mutational analysis and parallel RNA Sequencing</article-title>
        <source>Mol Cell</source>
        <year>2019</year>
        <volume>73</volume>
        <fpage>1292</fpage>
        <lpage>305.e8</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2019.01.009</pub-id>
        <?supplied-pmid 30765193?>
        <pub-id pub-id-type="pmid">30765193</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giustacchini</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Thongjuea</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Barkas</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Woll</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Povinelli</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Booth</surname>
            <given-names>CAG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomics uncovers distinct molecular signatures of stem cells in chronic myeloid leukemia</article-title>
        <source>Nat Med</source>
        <year>2017</year>
        <volume>23</volume>
        <fpage>692</fpage>
        <lpage>702</lpage>
        <pub-id pub-id-type="doi">10.1038/nm.4336</pub-id>
        <?supplied-pmid 28504724?>
        <pub-id pub-id-type="pmid">28504724</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Petti</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Fiddes</surname>
            <given-names>IT</given-names>
          </name>
          <name>
            <surname>Srivatsan</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>DY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A general approach for detecting expressed mutations in AML cells using single cell RNA-sequencing</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>3660</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-11591-1</pub-id>
        <?supplied-pmid 31413257?>
        <pub-id pub-id-type="pmid">31413257</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">van Galen P, Hovestadt V, Wadsworth MH Ii, Hughes TK, Griffin GK, Battaglia S, et al. Single-Cell RNA-Seq Reveals AML Hierarchies Relevant to Disease Progression and Immunity. Cell. 2019;176:1265–81.e24.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Francis</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Georghiou</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hergert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated single-cell genetic and transcriptional analysis suggests novel drivers of chronic lymphocytic leukemia</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>1300</fpage>
        <lpage>1311</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.217331.116</pub-id>
        <?supplied-pmid 28679620?>
        <pub-id pub-id-type="pmid">28679620</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campbell</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Steif</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zahn</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>clonealign: statistical integration of independent single-cell RNA and DNA sequencing data from human cancers</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>54</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1645-z</pub-id>
        <?supplied-pmid 30866997?>
        <pub-id pub-id-type="pmid">30866997</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hovestadt</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Bihannic</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Filbin</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Baumgartner</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Resolving medulloblastoma cellular architecture by single-cell genomics</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>572</volume>
        <fpage>74</fpage>
        <lpage>79</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1434-6</pub-id>
        <?supplied-pmid 31341285?>
        <pub-id pub-id-type="pmid">31341285</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Picelli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Björklund</surname>
            <given-names>ÅK</given-names>
          </name>
          <name>
            <surname>Faridani</surname>
            <given-names>OR</given-names>
          </name>
          <name>
            <surname>Sagasser</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Winberg</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Smart-seq2 for sensitive full-length transcriptome profiling in single cells</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1096</fpage>
        <lpage>1098</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2639</pub-id>
        <?supplied-pmid 24056875?>
        <pub-id pub-id-type="pmid">24056875</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Enge</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Arda</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Mignardi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Beausang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bottino</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>SK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell analysis of human pancreas reveals transcriptional signatures of aging and somatic mutation patterns</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <fpage>321</fpage>
        <lpage>30.e14</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.09.004</pub-id>
        <?supplied-pmid 28965763?>
        <pub-id pub-id-type="pmid">28965763</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mathys</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Davila-Velderrain</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mohammadi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>JZ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomic analysis of Alzheimer’s disease</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>570</volume>
        <fpage>332</fpage>
        <lpage>337</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1195-2</pub-id>
        <?supplied-pmid 31042697?>
        <pub-id pub-id-type="pmid">31042697</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darmanis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sloan</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Croote</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mignardi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chernikova</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Samghababi</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-Seq analysis of infiltrating neoplastic cells at the migrating front of human glioblastoma</article-title>
        <source>Cell Rep</source>
        <year>2017</year>
        <volume>21</volume>
        <fpage>1399</fpage>
        <lpage>1410</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2017.10.030</pub-id>
        <?supplied-pmid 29091775?>
        <pub-id pub-id-type="pmid">29091775</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maynard</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McCoach</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Rotow</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Haderk</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kerr</surname>
            <given-names>DL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Therapy-induced evolution of human lung cancer revealed by single-cell RNA sequencing</article-title>
        <source>Cell</source>
        <year>2020</year>
        <volume>182</volume>
        <fpage>1232</fpage>
        <lpage>51.e22</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.07.017</pub-id>
        <?supplied-pmid 32822576?>
        <pub-id pub-id-type="pmid">32822576</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systematic comparative analysis of single-nucleotide variant detection methods from single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>242</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1863-4</pub-id>
        <?supplied-pmid 31744515?>
        <pub-id pub-id-type="pmid">31744515</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vu</surname>
            <given-names>TN</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>H-N</given-names>
          </name>
          <name>
            <surname>Calza</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kalari</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pawitan</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Cell-level somatic mutation detection from single-cell RNA sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>4679</fpage>
        <lpage>4687</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz288</pub-id>
        <?supplied-pmid 31028395?>
        <pub-id pub-id-type="pmid">31028395</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Edwards N, Dillard C, Prashant NM, Hongyu L, Yang M, Ulianova E, et al. SCExecute: custom cell barcode-stratified analyses of scRNA-seq data. Bioinformatics. 2023;39. Available from: 10.1093/bioinformatics/btac768</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frohlich</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Anti-HTLV III testing of blood donors and recipients Hawaii experience</article-title>
        <source>Hawaii Med J</source>
        <year>1986</year>
        <volume>45</volume>
        <fpage>391</fpage>
        <lpage>392</lpage>
        <?supplied-pmid 3468095?>
        <pub-id pub-id-type="pmid">3468095</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ghandi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>FW</given-names>
          </name>
          <name>
            <surname>Jané-Valbuena</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kryukov</surname>
            <given-names>GV</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>McDonald</surname>
            <given-names>ER</given-names>
            <suffix>3rd</suffix>
          </name>
          <etal/>
        </person-group>
        <article-title>Next-generation characterization of the cancer cell line encyclopedia</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>569</volume>
        <fpage>503</fpage>
        <lpage>508</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1186-3</pub-id>
        <?supplied-pmid 31068700?>
        <pub-id pub-id-type="pmid">31068700</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Horning</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>C-K</given-names>
          </name>
          <name>
            <surname>Louie</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Jadhav</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Hung</surname>
            <given-names>C-N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq reveals a subpopulation of prostate cancer cells with enhanced cell-cycle-related transcription and attenuated androgen response</article-title>
        <source>Cancer Res</source>
        <year>2018</year>
        <volume>78</volume>
        <fpage>853</fpage>
        <lpage>864</lpage>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-17-1924</pub-id>
        <?supplied-pmid 29233929?>
        <pub-id pub-id-type="pmid">29233929</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>The effect of methanol fixation on single-cell RNA sequencing data</article-title>
        <source>BMC Genomics</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>420</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-021-07744-6</pub-id>
        <?supplied-pmid 34090348?>
        <pub-id pub-id-type="pmid">34090348</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ho</surname>
            <given-names>Y-J</given-names>
          </name>
          <name>
            <surname>Anaparthy</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Molik</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mathew</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Aicher</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq analysis identifies markers of resistance to targeted BRAF inhibitors in melanoma cell populations</article-title>
        <source>Genome Res</source>
        <year>2018</year>
        <volume>28</volume>
        <fpage>1353</fpage>
        <lpage>1363</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.234062.117</pub-id>
        <?supplied-pmid 30061114?>
        <pub-id pub-id-type="pmid">30061114</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schnepp</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Shelley</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wakim</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Mizokami</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomics analysis identifies nuclear protein 1 as a regulator of docetaxel resistance in prostate cancer cells</article-title>
        <source>Mol Cancer Res</source>
        <year>2020</year>
        <volume>18</volume>
        <fpage>1290</fpage>
        <lpage>1301</lpage>
        <pub-id pub-id-type="doi">10.1158/1541-7786.MCR-20-0051</pub-id>
        <?supplied-pmid 32513898?>
        <pub-id pub-id-type="pmid">32513898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>K-T</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>HW</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>H-O</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Seo</surname>
            <given-names>YJ</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell mRNA sequencing identifies subclonal heterogeneity in anti-cancer drug responses of lung adenocarcinoma cells</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>127</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0692-3</pub-id>
        <?supplied-pmid 26084335?>
        <pub-id pub-id-type="pmid">26084335</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Shen N, Zhang T. RESA Github. 2020 <ext-link ext-link-type="uri" xlink:href="https://github.com/ShenLab-Genomics/RESA">https://github.com/ShenLab-Genomics/RESA</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Schlesinger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Drenkow</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zaleski</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jha</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id>
        <?supplied-pmid 23104886?>
        <pub-id pub-id-type="pmid">23104886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Garimella</surname>
            <given-names>KV</given-names>
          </name>
          <name>
            <surname>Maguire</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hartl</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>491</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.806</pub-id>
        <?supplied-pmid 21478889?>
        <pub-id pub-id-type="pmid">21478889</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <?supplied-pmid 29750242?>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Scheffler</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Halpern</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Bekritsky</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Noh</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Källberg</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Strelka2: fast and accurate calling of germline and somatic variants</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>591</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0051-x</pub-id>
        <?supplied-pmid 30013048?>
        <pub-id pub-id-type="pmid">30013048</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Fangal VD. CTAT Mutations: a machine learning based RNA-Seq variant calling pipeline incorporating variant annotation, prioritization, and visualization. 2020; Available from: <ext-link ext-link-type="uri" xlink:href="https://dash.harvard.edu/handle/1/37365605">https://dash.harvard.edu/handle/1/37365605</ext-link></mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tate</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Bamford</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jubb</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Sondka</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Beare</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Bindal</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>COSMIC: the catalogue of somatic mutations in cancer</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D941</fpage>
        <lpage>D947</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1015</pub-id>
        <?supplied-pmid 30371878?>
        <pub-id pub-id-type="pmid">30371878</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <?supplied-pmid 19505943?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koboldt</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wylie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>McLellan</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Mardis</surname>
            <given-names>ER</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>VarScan: variant detection in massively parallel sequencing of individual and pooled samples</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2283</fpage>
        <lpage>2285</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp373</pub-id>
        <?supplied-pmid 19542151?>
        <pub-id pub-id-type="pmid">19542151</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ewing</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Houlahan</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ellrott</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Caloian</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yamaguchi</surname>
            <given-names>TN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Combining tumor genome simulation with crowdsourcing to benchmark somatic single-nucleotide-variant detection</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>623</fpage>
        <lpage>630</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3407</pub-id>
        <?supplied-pmid 25984700?>
        <pub-id pub-id-type="pmid">25984700</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rambow</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Rogiers</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marin-Bejar</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Aibar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Femel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dewaele</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Toward minimal residual disease-directed therapy in melanoma</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>174</volume>
        <fpage>843</fpage>
        <lpage>55.e19</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.06.025</pub-id>
        <?supplied-pmid 30017245?>
        <pub-id pub-id-type="pmid">30017245</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marin-Bejar</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Rogiers</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dewaele</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Femel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Karras</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pozniak</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evolutionary predictability of genetic versus nongenetic resistance to anticancer drugs in melanoma</article-title>
        <source>Cancer Cell</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>1135</fpage>
        <lpage>49.e8</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ccell.2021.05.015</pub-id>
        <?supplied-pmid 34143978?>
        <pub-id pub-id-type="pmid">34143978</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mootha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Gillette</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>15545</fpage>
        <lpage>15550</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id>
        <?supplied-pmid 16199517?>
        <pub-id pub-id-type="pmid">16199517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmidt</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Joyce</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Buquicchio</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ritz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Distel</surname>
            <given-names>RJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The lncRNA SLNCR1 mediates melanoma invasion through a conserved SRA1-like Region</article-title>
        <source>Cell Rep</source>
        <year>2016</year>
        <volume>15</volume>
        <fpage>2025</fpage>
        <lpage>2037</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2016.04.018</pub-id>
        <?supplied-pmid 27210747?>
        <pub-id pub-id-type="pmid">27210747</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Box NF, Vukmer TO, Terzian T. Targeting p53 in melanoma. Pigment Cell Melanoma Res. 2014. p. 8–10.</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stretch</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Gatter</surname>
            <given-names>KC</given-names>
          </name>
          <name>
            <surname>Ralfkiaer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lane</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>AL</given-names>
          </name>
        </person-group>
        <article-title>Expression of mutant p53 in melanoma</article-title>
        <source>Cancer Res</source>
        <year>1991</year>
        <volume>51</volume>
        <fpage>5976</fpage>
        <lpage>5979</lpage>
        <?supplied-pmid 1933861?>
        <pub-id pub-id-type="pmid">1933861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Elsas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zerp</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>van der Flier</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Krüse</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Aarnoudse</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hayward</surname>
            <given-names>NK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Relevance of ultraviolet-induced N-ras oncogene point mutations in development of primary human cutaneous melanoma</article-title>
        <source>Am J Pathol</source>
        <year>1996</year>
        <volume>149</volume>
        <fpage>883</fpage>
        <lpage>893</lpage>
        <?supplied-pmid 8780392?>
        <pub-id pub-id-type="pmid">8780392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Tang Y, Durand S, Dalle S, Caramel J. EMT-Inducing transcription factors, drivers of melanoma phenotype switching, and resistance to treatment. Cancers. 2020;12. Available from: 10.3390/cancers12082154</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yeh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Androgen receptor promotes melanoma metastasis via altering the miRNA-539-3p/USP13/MITF/AXL signals</article-title>
        <source>Oncogene</source>
        <year>2017</year>
        <volume>36</volume>
        <fpage>1644</fpage>
        <lpage>1654</lpage>
        <pub-id pub-id-type="doi">10.1038/onc.2016.330</pub-id>
        <?supplied-pmid 27869170?>
        <pub-id pub-id-type="pmid">27869170</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vellano</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Chelvanambi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Witt</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Daniele</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Androgen receptor blockade promotes response to BRAF/MEK-targeted therapy</article-title>
        <source>Nature</source>
        <year>2022</year>
        <volume>606</volume>
        <fpage>797</fpage>
        <lpage>803</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-022-04833-8</pub-id>
        <?supplied-pmid 35705814?>
        <pub-id pub-id-type="pmid">35705814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Long</surname>
            <given-names>GV</given-names>
          </name>
          <name>
            <surname>Grob</surname>
            <given-names>J-J</given-names>
          </name>
          <name>
            <surname>Nathan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ribas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Robert</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schadendorf</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Factors predictive of response, disease progression, and overall survival after dabrafenib and trametinib combination treatment: a pooled analysis of individual patient data from randomised trials</article-title>
        <source>Lancet Oncol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>1743</fpage>
        <lpage>1754</lpage>
        <pub-id pub-id-type="doi">10.1016/S1470-2045(16)30578-2</pub-id>
        <?supplied-pmid 27864013?>
        <pub-id pub-id-type="pmid">27864013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Muyas F, Sauer CM, Valle-Inclán JE, Li R, Rahbari R, Mitchell TJ, et al. De novo detection of somatic mutations in high-throughput single-cell profiling data sets. Nat Biotechnol. 2023. Available from: 10.1038/s41587-023-01863-z.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Med</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Med</journal-id>
    <journal-title-group>
      <journal-title>Genome Medicine</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-994X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10726641</article-id>
    <article-id pub-id-type="pmid">38111063</article-id>
    <article-id pub-id-type="publisher-id">1269</article-id>
    <article-id pub-id-type="doi">10.1186/s13073-023-01269-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>De novo identification of expressed cancer somatic mutations from single-cell RNA sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Tianyun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jia</surname>
          <given-names>Hanying</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Song</surname>
          <given-names>Tairan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lv</surname>
          <given-names>Lin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gulhan</surname>
          <given-names>Doga C.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Haishuai</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Guo</surname>
          <given-names>Wei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xi</surname>
          <given-names>Ruibin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Guo</surname>
          <given-names>Hongshan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4709-3374</contrib-id>
        <name>
          <surname>Shen</surname>
          <given-names>Ning</given-names>
        </name>
        <address>
          <email>shenningzju@zju.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.13402.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 700X</institution-id><institution>Department of Hepatobiliary and Pancreatic Surgery of the First Affiliated Hospital &amp; Liangzhu Laboratory, </institution><institution>Zhejiang University School of Medicine, </institution></institution-wrap>Hangzhou, 311121 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05m1p5x56</institution-id><institution-id institution-id-type="GRID">grid.452661.2</institution-id><institution-id institution-id-type="ISNI">0000 0004 1803 6319</institution-id><institution>Kidney Disease Center, </institution><institution>the First Affiliated Hospital, Zhejiang University School of Medicine, </institution></institution-wrap>Zhejiang, 311121 China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution>Department of Biomedical Informatics, </institution><institution>Harvard Medical School, </institution></institution-wrap>Boston, MA 02115 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00a2xv884</institution-id><institution-id institution-id-type="GRID">grid.13402.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 700X</institution-id><institution>College of Computer Science, </institution><institution>Zhejiang University, </institution></institution-wrap>Hangzhou, 311121 Zhejiang China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.512487.d</institution-id><institution>Zhejiang University-University of Edinburgh Institute, School of Medicine, Zhejiang University, </institution></institution-wrap>Jiaxing, 314400 China </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02v51f717</institution-id><institution-id institution-id-type="GRID">grid.11135.37</institution-id><institution-id institution-id-type="ISNI">0000 0001 2256 9319</institution-id><institution>School of Mathematical Sciences and Center for Statistical Science, </institution><institution>Peking University, </institution></institution-wrap>5 Yiheyuan Road, Beijing, 100871 China </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05m1p5x56</institution-id><institution-id institution-id-type="GRID">grid.452661.2</institution-id><institution-id institution-id-type="ISNI">0000 0004 1803 6319</institution-id><institution>Bone Marrow Transplantation Center, The First Affiliated Hospital, Zhejiang University School of Medicine, </institution></institution-wrap>Hangzhou, 310003 Zhejiang China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>15</volume>
    <elocation-id>115</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>12</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023, corrected publication 2024</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Identifying expressed somatic mutations from single-cell RNA sequencing data de novo is challenging but highly valuable. We propose RESA – Recurrently Expressed SNV Analysis, a computational framework to identify expressed somatic mutations from scRNA-seq data. RESA achieves an average precision of 0.77 on three in silico spike-in datasets. In extensive benchmarking against existing methods using 19 datasets, RESA consistently outperforms them. Furthermore, we applied RESA to analyze intratumor mutational heterogeneity in a melanoma drug resistance dataset. By enabling high precision detection of expressed somatic mutations, RESA substantially enhances the reliability of mutational analysis in scRNA-seq. RESA is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ShenLab-Genomics/RESA">https://github.com/ShenLab-Genomics/RESA</ext-link>.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13073-023-01269-1.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Somatic mutations</kwd>
      <kwd>Single-cell RNA sequencing data</kwd>
      <kwd>Recurrently Expressed SNV Analysis</kwd>
      <kwd>High precision</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Leading Innovative and Entrepreneur Team Introduction Program of Zhejiang (CN)</institution>
        </funding-source>
        <award-id>2021R01012</award-id>
        <principal-award-recipient>
          <name>
            <surname>Shen</surname>
            <given-names>Ning</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Zhejiang University Starting Fund</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par15">Somatic mutations are accumulated during cell generations and can transform normal cells into cancer, promote tumor progression, and develop drug resistance. Genetic heterogeneity together with transcriptional heterogeneity are two key aspects that contribute to cancer evolution and drug resistance. Recent studies have attempted to identify somatic mutations, single nucleotide variants (SNVs) in particular, by associating them with transcriptional variations in cancer bulk RNA-seq data [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. However, it remains challenging to connect transcriptional heterogeneity to genetic heterogeneity at the single-cell level. Therefore, identifying somatic mutations carried by RNA at the single-cell level is highly valuable.</p>
    <p id="Par16">Experimental technologies, such as targeted genotyping coupled with scRNA-seq, have been developed to enable the study of expressional and somatic variations together at single-cell level [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref>]. However, the single cells have limited amounts of biological materials, a small number of detectable mutations, and a low signal-to-noise ratio have restricted their application. As a result, computational methods are sought-after to identify expressed somatic mutations from scRNA-seq data. Profiling of scRNA-seq coupled with bulk genotyping, e.g. whole exome sequencing (WES), whole genome sequencing (WGS), and single cell genotyping of selected mutations, of the same sample have been applied to study intratumor heterogeneity and lineage tracing [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]. Although such data can effectively minimize false positives, their design requires thoughtful consideration and can only characterize a limited number of mutations, thus they were not widely adopted.</p>
    <p id="Par17">Computational methods that identify expressed somatic mutations directly from scRNA-seq data de novo are highly desirable, as such methods not only provide orthogonal insights into the intratumor heterogeneity but also face fewer experimental challenges. Most mutational analysis of scRNA-seq use data generated from scRNA-seq technologies with full length library prep, e.g. SMART-seq2 [<xref ref-type="bibr" rid="CR11">11</xref>], for its higher coverage in the gene body compared to the 10X genomics and Drop-seq approach. De novo somatic mutation calling and follow-up analysis have been applied to various biological questions including aging in the human pancreas, Alzheimer’s disease, glioblastoma, lung cancer, etc. [<xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR15">15</xref>]. Methods reported in these studies employ standard variant calling steps that involve quality-based filtering such as sequencing quality or stratification from a curated whitelist of known cancer mutations, following the standard variant calling steps. However, these methods were originally designed for bulk RNA-seq data and their reliability for single-cell RNA-seq data still requires further evaluation [<xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR19">19</xref>].</p>
    <p id="Par18">In this study, we developed a computational framework named Recurrently Expressed SNV Analysis (RESA) that can detect expressed somatic SNVs with high precision directly from scRNA-seq data. RESA is composed of a specific filtering workflow tailored for scRNA-seq data, especially the recurrence of expressed SNVs across cells. Additionally, we introduced a joint logistic regression (RESA-jLR) model that expands the pool of somatic variants by leveraging information from earlier steps. To evaluate the performance of RESA and RESA-jLR, we conducted in silico spike-in experiments using over 800 cells from the human pancreas. Furthermore, we benchmarked RESA and RESA-jLR using real scRNA-seq datasets with matched WES data from 15 cancer cell lines and 4 tumor PDX tissues. RESA is specifically designed for high precision detection of somatic mutations while minimizing noise and artefacts from experimental procedures, so that users can be confident with the reliability of the results (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). Thus, the applications of RESA and RESA-jLR may provide a reliable and integrative view to study intratumor heterogeneity and drug resistance.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>WES and scRNA-seq datasets of cancer cell lines</title>
      <p id="Par19">The exonic somatic mutations for all cancer cell lines tested in this study were processed by the CCLE project and downloaded from CCLE_20Q1_mutations [<xref ref-type="bibr" rid="CR20">20</xref>]. The scRNA-seq for cancer cell lines were downloaded from GSE105451, GSE76312, GSE99795, GSE150993, GSE108383, GSE140440, and GSE69405 respectively.</p>
      <p id="Par20">Specifically, scRNA-seq for JURKAT, SET2 (GSE105451), and K562 (GSE76312) was done using the SMART-seq + and TARGET-seq technologies [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. All other cell lines were done with the Smart-seq2 protocol. LNCaP (GSE99795) was treated with double thymidine for 12 h (hr) to synchronize the population cell cycle, then single cells were collected at 0 h without drug treatment, and 12 h with and without drug treatment [<xref ref-type="bibr" rid="CR21">21</xref>]. HCT116 (GSE150993) live cells and methanol-fixed cells were processed and sequenced respectively [<xref ref-type="bibr" rid="CR22">22</xref>]. Yu-jui Ho et al. sequenced A375 (GSE108383) with and without BRAF inhibitor [<xref ref-type="bibr" rid="CR23">23</xref>]. Similarly, Patricia M Schnepp et al. divided their cells into docetaxel-sensitive and -resistant groups of DU145 (GSE140440) [<xref ref-type="bibr" rid="CR24">24</xref>]. Finally, we analyzed both the cancer cell line NCI-H358 data (GSE69405) and lung adenocarcinoma (LUAD) PDX tumor data from Kyu-Tae Kim et al. [<xref ref-type="bibr" rid="CR25">25</xref>].</p>
      <p id="Par21">Besides, we evaluated the consistency between two experimental replicates of these cell lines after applying RESA-jLR in all applicable cases. We counted the number of detected mutations in each replicate and computed the fold change between the number of detected mutations in replicate 1 and the number of detected mutations in replicate 2. If the result is close to 1, it means the number of detected mutations between two replicates is similar. The consistency shows that our method has stable performance in datasets under similar conditions.</p>
    </sec>
    <sec id="Sec4">
      <title>RESA workflow</title>
      <p id="Par22">RESA comprises three main steps: initial variant calling, filtering and labeling, and modeling and refinement [<xref ref-type="bibr" rid="CR26">26</xref>]. The first step of RESA is to align the sequencing reads to the genome and run through basic mutation calling algorithms with RNA-seq specific parameter settings (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). To minimize aligner and variant caller biases, two independent alignments and two basic variant callers were employed. Next, we run through a series of processing, filtering, and most importantly, cross-cell recurrence counting. In this step, the variants are grouped into 3 categories: 1) a high-confidence set of SNVs that are either putative somatic SNVs or artefacts; 2) a set of filtered-out variants; and 3) a set of undefined SNVs for further refinement (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). The high-confidence set of putative positive somatic variants were labeled as RESA-identified somatic mutations.<fig id="Fig1"><label>Fig. 1</label><caption><p>RESA workflow. <bold>a</bold> Step1 is an initial variant call using two aligners and two mutation calling algorithms. <bold>b</bold> RESA: Variants calling then goes through a series of filtering and labeling, categorizing into a confident set of positive somatic variants and artefacts, and a set of unsure SNVs to refine. <bold>c</bold> RESA-jLR: The confident set of variants is used to build a joint logistic regression model, where the model is applied to make predictions in the unsure set of SNVs to refine and expand the final positive set of somatic SNVs. <bold>d</bold> the detailed workflow of RESA</p></caption><graphic xlink:href="13073_2023_1269_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par23">Denoting RESA identified mutations as “positive” and the putative biases and artefacts variants as “negative”, RESA randomly splits the data into training and test sets. We developed a joint logistic regression classifier that models both quality and sequence-related features independently (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). The joint logistic regression classifier was then applied to make predictions on the set of undefined SNVs. The final set of somatic SNVs identified by RESA-jLR is a combination of positive SNVs from the high-confidence set and predicted positive SNVs from the undefined set using the joint logistic regression model.</p>
    </sec>
    <sec id="Sec5">
      <title>Initial read mapping and variant calling</title>
      <p id="Par24">To reduce the bias in aligners and variant callers, we employed two independent alignment and variant calling methods for each cell's fastq file in the scRNA-seq analysis. The first method consisted of aligning the reads using the widely adopted STAR aligner [<xref ref-type="bibr" rid="CR27">27</xref>], a highly effective read aligner, in a two-pass mode to improve alignment accuracy. Then processing the aligned reads based on recommendations from GATK (gatk/4.0.0.0) [<xref ref-type="bibr" rid="CR28">28</xref>] involving steps such as removing duplicates and recalibrating base quality scores and calling variants using GATK (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). The second method involved aligning the reads using the Minimap2 aligner [<xref ref-type="bibr" rid="CR29">29</xref>], followed by RNA variant calling settings from Strelka [<xref ref-type="bibr" rid="CR30">30</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). Only variants marked as passing the default filtering set by the Strelka algorithm were retained for this method. Therefore, we obtained two sets of candidate variants per cell that were detected by these two pipelines. Our primary reference for downstream analysis was the STAR-GATK procedure which is a widely used combination of read alignment and variant calling pipelines, as we found that the GATK process can aid in identifying and correcting noise and artefacts in the data. The outputs from the STAR-GATK procedure included information that was utilized in subsequent steps.</p>
    </sec>
    <sec id="Sec6">
      <title>RESA</title>
      <p id="Par25">We then annotated and filtered variants from the STAR-GATK pipeline similar to the CTAT-Mutations Pipeline which is designed to detect variants from bulk RNA sequencing data [<xref ref-type="bibr" rid="CR31">31</xref>]. We first annotated the variant location using ANNOVAR and kept only SNVs located in the exonic region for downstream filtering and labeling. Then SNVs that overlapped with RNA editing databases were removed for potential RNA editing events (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). After that, we filtered germline variants generated from matched normal if available, or from population SNP databases such as the genome Aggregation Database(gnomAD) 3.0. Hence, the primary filtered candidate variants from the original STAR-GATK pipeline were kept for further procession.</p>
      <p id="Par26">Next, we checked the concordance between the filtered STAR-GATK pipeline and the second pipeline using RESA. Variants identified by both pipelines were considered for candidate variant set A which represented the intersection of results from these two pipelines, while the variants of the filtered STAR-GATK pipeline which were the elements of the second pipeline were considered for candidate set B. RESA further processed the variant calling outputs by setting additional requirements on read quality, variant quality, strand bias, and variant positional bias. The common variants from the above-mentioned procedures were required to have a minimum read depth of 3 or user-specified site-specific depth.</p>
      <p id="Par27">Importantly, the resulting filtered SNVs for variant set A were stricter or at least comparable to quality-based filtering approaches used in other studies, such as the Quality-filter approach [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR16">16</xref>] referred to as Enge, 2017, for performance comparison.</p>
      <p id="Par28">RESA assumes that cancer cells evolve in a clonal manner and thus expressed somatic mutations have cross-cell recurrence, whereas the noise and artefacts are likely distributed randomly with a small probability of recurrence across the cell population (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). Based on this assumption, RESA set a cross-cell recurrence filter on a pseudo-bulk basis by keeping only SNVs that were detected in at least X number of cells to filter out artefacts, where X (X &gt;  = 3) by default is no less than 10% of the total cell number and can be adjusted by users (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d), which removed background sequencing errors and artefacts from candidate somatic SNVs. This criterion was intended to filter the false positive somatic mutations because we assume that the true positive somatic mutations should at least express a certain number of cells, but it may also remove true positive somatic mutations that are only expressed in very few cells (less than 10%). Furthermore, mutations detected in more than 80% of the total cell number were considered to be germline polymorphisms or artefacts as well. The key assumption is that compared with somatic mutations, germline variants should be detected in most cells at the RNA level.</p>
      <p id="Par29">The upper and lower limit number of cross-cell recurrence were used as parameters in the software and could be adjusted in a user-specified manner. The filtered SNVs from set A were considered putative true somatic variants. Thus, RESA built a putative “true positive” set of somatic variants directly from scRNA-seq data based on cross-cell recurrence and quality-based filtering.</p>
      <p id="Par30">RESA applied several criteria to enable filtering of putative germline mutations: 1) germline variants that were generated from the matched normal data, if available and specified in user input; 2) putative germline variants identified from population SNP databases such as gnomAD 3.0.; 3) putative germline variants with high detection recurrence in the tested cell population.</p>
      <p id="Par31">To build a high-confidence set of noise and artefact SNVs, RESA selected SNVs from set B that failed the above-mentioned criteria, such that putative noise and artefacts had the following properties:1) SNVs did not pass the quality-based filtering as described above, and 2) SNVs did not show any cross-cell recurrence. The remaining SNVs in set B pass the above-mentioned criteria and SNVs in set A failed the criteria were defined as the unsure set, which was subjected to RESA-jLR described below. We applied this selection criteria for each single cell and found very few SNVs overlapping between the positive and negative sets after merging SNVs across the cell population, suggesting a decent separation between our putative positive and negative sets.</p>
    </sec>
    <sec id="Sec7">
      <title>RESA-jLR</title>
      <p id="Par32">RESA employs a process of combining all putative positive and negative sets of somatic SNVs. The input variants to feed RESA-jLR combined all variants in positive and negative sets. Then the input dataset was split into training and test sets with the 3:1 ratio, with 3 quarters of the data used for training the model, and a quarter of the data used as an independent test set to evaluate the model performance. Because the sample size for each class on the training set was often imbalanced, thus, random oversampling was applied to replicate observations in minority classes, thereby rebalancing the dataset. RESA with the joint logistic regression model was the joint composition of two logistic regression models. One model depended on quality-based features such as variant quality, read depth, variant allele fraction, normalized probabilities of genotype, and allele depth. The other model derived its features from sequence-based attributes like mutation types, sequence contexts, and mutation signature components. Quality-based features were generally weighted similarly across datasets, while mutation sequence composition can be more sample-specific; hence, they were modeled differently. We trained the joint logistic regression model using the liblinear library, with L1 regularization applied to the quality-based model and L2 regularization applied to the sequence-based model using one-hot encoding. Each logistic regression model returned probability values for positive and negative classifications, with users being able to specify their thresholds based on these probabilities. Then we combined these two models into an integrated classifier with the following equation:<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left({pos}_{classifier}\right)=\frac{1}{2}{\sum }_{P\in ({P}_{seq}, { P}_{pos})}wP,$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="italic">pos</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">classifier</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">seq</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">pos</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mi>w</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13073_2023_1269_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>Where <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w=\left\{\begin{array}{c}1, if \,P \ge 0.5\\ 0, otherwise\end{array}\right.$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mo>≥</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1269_Article_IEq1.gif"/></alternatives></inline-formula>, <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{seq}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">seq</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1269_Article_IEq2.gif"/></alternatives></inline-formula> and <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{pos}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">pos</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1269_Article_IEq3.gif"/></alternatives></inline-formula> were probabilities to be the positive class of the two regression models. RESA-jLR sets 0.5 as the default threshold, which meant RESA-jLR defined the SNVs as positive if <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left({pos}_{classifier}\right) \ge 0.5$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="italic">pos</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">classifier</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>≥</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1269_Article_IEq4.gif"/></alternatives></inline-formula>. We also included probability as a parameter so that users could modify the thresholds.</p>
      <p id="Par33">After training, we assess the model's performance on the test set using the AUC score. As opposed to accuracy, the AUC score is appropriate for imbalanced datasets. Additionally, we applied the model to the candidate SNVs in the unsure set to refine and extrapolate the putative somatic variant set. This step recovered some true somatic variants filtered out in stringent criteria described earlier and enhanced sensitivity while maintaining high precision.</p>
    </sec>
    <sec id="Sec8">
      <title>Somatic mutation detection by other methods</title>
      <p id="Par34">We conducted a performance evaluation of RESA and RESA-jLR by comparing them to five previously published methods, including Enge 2017, Maynard 2020, BCFtools, VarScan, and Hovestadt 2019. We applied similar filtering criteria and parameters for somatic mutation filtering across all methods.</p>
      <p id="Par35">Somatic mutations were filtered by similar quality criteria which have been adopted in Enge 2017 [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. Specifically, we aligned sequencing data to the hg38 human reference using STAR and called alignment BAM files for different cell lines using GATK HaplotypeCaller. We then filtered out potential artefacts using VariantFilter (-cluster 3; -window 35; -filter QD &lt; 2.0; -filter FS &gt; 30.0). Finally, we employed the GATK variant quality score recalibration pipeline to filter the variation calls and exclude known germline variants.</p>
      <p id="Par36">Moreover, we utilized concord whitelist-based mutation selection which has been adopted in the Maynard 2020 with similar filtering criteria [<xref ref-type="bibr" rid="CR15">15</xref>]. Reads were aligned using STAR aligner, processed as suggested by GATK pipeline (gatk 4.0.0.0). Variants were called by GATK HaplotypeCaller (this process is adopted as part of the STAR-GATK Pipeline) [<xref ref-type="bibr" rid="CR30">30</xref>]. Next, we filtered out variants using the following criteria: 1) variants are located in exonic region; 2) variants have pathogenic effect as predicted by FATHMM; 3) variants have minimum total read depth of 3; 4) variants have been curated in COSMIC database [<xref ref-type="bibr" rid="CR32">32</xref>] in the same tissue type as sample tested. Besides, we also applied the STAR-GATK Pipeline [<xref ref-type="bibr" rid="CR28">28</xref>] from raw sequencing data detecting variants.</p>
      <p id="Par37">BCFtools [<xref ref-type="bibr" rid="CR33">33</xref>] (BCFtools 1.9) and VarScan (Varscan v2.4.4) [<xref ref-type="bibr" rid="CR34">34</xref>] were evaluated for their performances of detecting mutations across scRNA-seq data [<xref ref-type="bibr" rid="CR16">16</xref>]. We aligned reads to hg38 human reference using the BWA-MEM (BWA 0.7.17) and then used the GATK-PICARD pipeline to preprocess the BAM file. For better comparison, we chose the default parameters of these toolkits.</p>
      <p id="Par38">Besides, we created another recurrence-based method based on recurrence rates by following filtering criteria in the Hovestadt 2019 [<xref ref-type="bibr" rid="CR10">10</xref>]. We quantified variants at the genomic position using SAMtools mpileup for preprocessed BAM files in scRNA-seq data and then filtered out variants detected in fewer than three cells or not detected in the genome sequencing data.</p>
    </sec>
    <sec id="Sec9">
      <title>Somatic mutation detection using RESA in in silico spiked-in dataset</title>
      <p id="Par39">In order to further assess the effectiveness of RESA on human tissue datasets, we conducted a test using in silico spiked-in datasets. We hypothesized that scRNA-seq data from healthy juveniles would not contain somatic mutations, with the variants detected more likely to be germline mutations or artefacts resulting from sequencing. To assess the ability to detect somatic mutations in human tissue RNA datasets, we added somatic mutations from 10 distinct cell lines. The inclusion of various types of somatic mutations from different cell lines allowed for the evaluation of the generalization of RESA, as it was exposed to diverse mutation spectrums. And in this experiment, our focus was on the ability to detect add-on somatic mutations to avoid the potential impact on model performance that could arise from using ground truth data filtered by different criteria.</p>
      <p id="Par40">To avoid the subjective factors and controllable preferences, we used an independent tool – BAMSurgeon, a tool that can introduce somatic mutations to BAM files, to generate simulation data [<xref ref-type="bibr" rid="CR35">35</xref>]. To add mutations, we collected three independent real scRNA-seq data of pancreatic epithelial cells from healthy juveniles with SMART-seq2 technology, aged 1 month, 5 years, and 6 years [<xref ref-type="bibr" rid="CR12">12</xref>]. We aligned the raw reads from real scRNA-seq data to GRCh38 (GRCh38.p12) using BWA-MEM 0.7.17 with default parameters to create the original BAM files.</p>
      <p id="Par41">To spike SNV mutations into each scRNA-seq dataset, we used ten cancer cell lines with varying numbers of mutations from CCLE [<xref ref-type="bibr" rid="CR20">20</xref>] as the 'truth' VCF files that contained variant position information and variant allele fraction (VAF). The VAF of SNVs was determined by WES. If the VAF was missing, we replaced the VAF with 0.5. We used addsnv.py with the following relevant settings to spike SNVs in the original BAM files of cells: –mindepth 2 –minmutreads 1 –aligner mem. We then converted the 'burned-in' BAMs to in silico 'spiked-in' FASTQ files using GATK 4.2.3.0 SamToFastq. We identified 'spike-in' SNVs from each cell and reintroduced simulated SNVs to 50% of VCF files generated by the STAR-GATK procedure. Once algorithmic biases were introduced into the cells, we proceeded to analyze the 'spike-in' data using RESA and five other algorithms—Enge 2017 [<xref ref-type="bibr" rid="CR12">12</xref>], Maynard 2020 [<xref ref-type="bibr" rid="CR15">15</xref>], Hovestadt 2019 [<xref ref-type="bibr" rid="CR10">10</xref>], BCFtools [<xref ref-type="bibr" rid="CR16">16</xref>], and VarScan [<xref ref-type="bibr" rid="CR16">16</xref>].</p>
    </sec>
    <sec id="Sec10">
      <title>Method evaluation</title>
      <p id="Par42">To evaluate the performance of different methods, we gathered somatic mutations identified by various methods as mentioned above. We defined WES-identified somatic mutations that were carried in the tested scRNA-seq dataset as the ground truth. In this context, false positives are "false" somatic mutations including germline variants, RNA editing sites, noise, and artefact mutations in scRNA-seq data that are labeled as somatic mutations by RESA. Meanwhile, false negatives refer to true somatic mutations in scRNA-seq that are mislabeled by RESA as "false".</p>
      <p id="Par43">Precision, sensitivity, and F0.5 score were utilized to assess the performance of RESA across datasets. Precision evaluates the proportion of true positives among all the predicted positives, while sensitivity measures the proportion of true positives among all the ground truth positives. The F0.5 score is a commonly used adjusted F-score that assigns greater weight to precision than to sensitivity, given that precision is of greater importance in our algorithm. The F0.5 score satisfies the following equation:<disp-formula id="Equb"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_{0\cdot5}=1.25\cdot\frac{\left(precision\,sensitivity\right)}{0.25\,precision+sensitivity}$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>·</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1.25</mml:mn><mml:mo>·</mml:mo><mml:mfrac><mml:mfenced close=")" open="("><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.166667em"/><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi></mml:mfenced><mml:mrow><mml:mn>0.25</mml:mn><mml:mspace width="0.166667em"/><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1269_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par44">As we developed RESA, our strategy prioritized precision over sensitivity to instill greater confidence. This means our focus was on detecting true somatic mutations while minimizing the impact of artefacts. Even in situations where there is no matched normal WES/WGS data available for comparison, our strategy could still accurately predict somatic mutations.</p>
      <p id="Par45">To show the consistency between replicate experiments, we have presented it by using the overlap coefficient. It is defined as the size of the intersection divided by the smaller of the size in these two datasets.<disp-formula id="Equc"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$overlap \left(X,Y\right)=\frac{\left|X\cap Y\right|}{{\text{min}}\left(\left|X\right|,\left|Y\right|\right)}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:mi>X</mml:mi><mml:mo>∩</mml:mo><mml:mi>Y</mml:mi></mml:mfenced><mml:mrow><mml:mtext>min</mml:mtext><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:mi>X</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced close="|" open="|"><mml:mi>Y</mml:mi></mml:mfenced></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1269_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec11">
      <title>Analyzing primary tumor data</title>
      <p id="Par46">Kyu-Tae Kim used scRNA-seq by SMART-seq and whole-exome sequencing (WES) to examine intratumor heterogeneity in lung adenocarcinoma tumors (GSE69405). A 60-year-old male patient had a treatment-naïve lung cancer tumor, which was surgically excised and inoculated into immunocompromised mice to generate patient-derived xenograft (PDX) tumors. A sample of PDX tumor containing 34 single cells and an additional sample with 43 cells as a biological replicate were sequenced. WES analysis was also done on the patient's blood to obtain the matched normal data and filter out germline mutations.</p>
      <p id="Par47">The raw reads for melanoma scRNA-seq used for mutation identification were obtained from GSE116237 [<xref ref-type="bibr" rid="CR36">36</xref>]. The matched WES data for the PDX sample with two replicates were downloaded from EGAD0000179 [<xref ref-type="bibr" rid="CR37">37</xref>]. Four time points (T0, phase 1, phase 2, and phase 3) were included in the scRNA-seq dataset, but only T0 and phase 3 had matched WES data. To assess the performance of our method using matched WES data, we utilized RESA and RESA-jLR separately on these two time points.</p>
      <p id="Par48">Somatic mutation calling from WES data was carried out similarly to the CCLE project, including aligning WES reads to the GRACh38 reference genome using BWA-MEM 0.7.17, marking duplication with Picard, and avoiding systematic errors by Base Quality Score Recalibration with variant sites identified from the 1000 Genomes Project, dbSNP138, and Mills and 1000G gold standard indels. HaplotyCaller was used to call SNVs for the PDX tumor sample that contained matched normal data such as patient blood WES. The model of scoring variant quality for filtering was developed by VariantRecalibrator and ApplyVQSR under default parameters.</p>
    </sec>
    <sec id="Sec12">
      <title>Re-analyzing melanoma scRNA-seq expression matrix</title>
      <p id="Par49">The gene expression read count table after processing melanoma PDX data for all cells was obtained from GSE116237. The Seurat package was employed for expression analysis, and read counts were log normalized. The top 2000 variably-expressed genes were selected for dimension reduction using PCA. The K-nearest neighbor (KNN) graph was clustered and refined using the Louvain algorithm based on the top 30 transformed PCs from PCA. UMAP was used with a dimension of 20 and applied to the top 30 PCs for data exploration and visualization.</p>
    </sec>
    <sec id="Sec13">
      <title>Analyzing stage-specific somatic mutations</title>
      <p id="Par50">To enhance the sensitivity of our methods, we utilized RESA and RESA-jLR on the melanoma scRNA dataset across four time points. We then assessed stage-specific enrichment by calculating the <italic>p</italic>-value based on the cumulative distribution function of the hypergeometric distribution. We aimed to determine whether the number of cells with a mutant gene was overrepresented in one stage compared to the other stages. For each candidate gene containing a somatic mutation, we counted the number of mutation-carrying cells in each tumor stage and computed the p-value to identify the enrichment at each stage. If a gene passed the defined threshold p-value of 0.05 at a specific stage, we labeled it as enriched at that stage. This indicates that the distribution of the number of mutation-carrying cells is non-uniform and significantly enriched at the specific stage compared to the other stages [<xref ref-type="bibr" rid="CR38">38</xref>].</p>
    </sec>
    <sec id="Sec14">
      <title>Custom analysis and plots</title>
      <p id="Par51">Mutation Signature plots were done using SigProfilerPloting. UMAP plots were done using the Seurat package in R. Other custom plots were done using the Seaborn package in Python and the ggplot2 package in R.</p>
    </sec>
  </sec>
  <sec id="Sec15">
    <title>Results</title>
    <sec id="Sec16">
      <title>Challenges of detecting expressed SNVs in scRNA-seq data</title>
      <p id="Par52">De novo identification of somatic SNVs from scRNA-seq data is challenging due to the sparsity and noisiness of the data. Several factors, including allelic expression, expression abundance of mutant-containing genes, sequencing coverage per cell, variant allele frequency (VAF), and clonality, may contribute to the sparsity of the detectable mutations. To understand various factors that may influence the detectability of somatic mutations in scRNA-seq data, we gathered WES, bulk RNA-seq (bRNA-seq), and scRNA-seq datasets for the melanoma cell line A375. For example, the site for the <italic>BRAF</italic> V600E driver mutation has high coverage (referred to as site-specific depth hereafter) in both WES and bRNA-seq data, whereas only three out of five selected single cells have detectable site-specific depth (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). As indicated by this example, allelic expression as well as sequencing coverage might contribute to the sparsity of somatic mutations detectable from scRNA-seq data, which is also known as the effect of “allelic dropout”. Next, we analyzed scRNA-seq of all A375 cells and observed a significant correlation between sequencing coverage and expressed somatic mutations per cell (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). Concordantly, both site-specific depth and the gene expression levels correlate positively with the number of detectable somatic mutations (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). In addition, scRNA-seq VAF correlates positively with VAF from both bRNA-seq (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d) and WES (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3). Collectively, these results suggest that the detection of somatic mutations in scRNA-seq is jointly shaped by the mutation burden, sequencing coverage of the cell, as well as the sequencing depth and expression level of the mutant allele.<fig id="Fig2"><label>Fig. 2</label><caption><p>Detecting expressed somatic mutations in the A375 cell line and pancreas tissue datasets. <bold>a</bold> Integrative Genomics Viewer (IGV) window shows the hotspot mutation <italic>BRAF</italic> V600E in the A375 cell line. <bold>b</bold> The scatter plot of the percentage of exonic SNVs validated in scRNA-seq against the million reads per cell. <bold>c</bold> The scatter plot shows the expression level against the number of expressed somatic mutations in each gene. <bold>d</bold>, <bold>e</bold>, The bar plot illustrates the distribution of VAF of expressed somatic mutations in scRNA-seq compared with corresponding VAF in bRNA-seq (<bold>d</bold>) and in WES (<bold>e</bold>). <bold>f</bold> The percentage of accumulated expressed SNVs validated in scRNA-seq. <bold>g</bold> The density plot shows the distribution of detected SNVs of each cell after passing the standard variant calling pipeline in the A375 cell line datasets with two conditions</p></caption><graphic xlink:href="13073_2023_1269_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par53">The sparsity of detectable somatic mutations in scRNA-seq data can be alleviated by sequencing a large number of cells (Fig. <xref rid="Fig2" ref-type="fig">2</xref>f). However, de novo identification of expressed somatic mutations following standard variant calling pipelines results in tremendous amounts of noise in the data (Fig. <xref rid="Fig2" ref-type="fig">2</xref>g). One possible explanation for the noise is that currently used mutation calling algorithms failed to take into account the noise and artefact SNVs generated during the experimental procedure. Consistently, a recent study evaluated the performance of several mutations calling algorithms on scRNA-seq data using simulated scRNA-seq reads, and demonstrated that most of the algorithms tested showed satisfying performance with FDR &lt; 0.05 [<xref ref-type="bibr" rid="CR16">16</xref>], suggesting that noise and artefacts carried by the sequencing read can be picked up equally well with actual mutations of the cell. This aligns with our knowledge that the experimental procedures of scRNA-seq, including cell lysis, cDNA conversion, library preparation, etc., may result in arteficial variants that far exceed the number of true variants (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4). Subsequently, the direct application of such mutation calling algorithms on real scRNA-seq data may mislead biological interpretations of the data. Therefore, computational methods that can effectively filter out such experimental noise and artefacts are essential for de novo identification of somatic mutations in scRNA-seq data.</p>
    </sec>
    <sec id="Sec17">
      <title>The computational principle of RESA to identify somatic SNVs from scRNA-seq</title>
      <p id="Par54">We present a computational framework RESA – Recurrently Expressed SNV Analysis, which detects expressed somatic mutations with high precision directly from scRNA-seq data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a-d). We focused on scRNA-seq technologies that capture full length transcripts and single nucleotide variants (SNVs) for somatic mutation analysis. RESA effectively eliminates noise and artefact variants in the scRNA-seq data by applying a series of filtering steps, including cross-cell recurrence. For instance, with the standard variant calling process, about 0.5–0.8 million SNVs were identified in cancer cell lines A375 and HCT116, where numerous noises and artefacts dominate the pool (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5). We found that different variant callers followed with basic filtering barely helped. On the contrary, applying RESA effectively removed the majority of noises and artefacts, and achieved about 75% of true somatic SNVs out of the total SNVs identified by the algorithm (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5c, d). In addition, we developed a joint logistic regression approach following RESA, i.e., RESA-jLR, to filter out noise and artefacts while increasing sensitivity by identifying positive cases from an unsure set of variants. Notably, applying RESA-jLR identified additional somatic SNVs while keeping the proportion of noise and artefacts small (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5).</p>
      <p id="Par55">We validated that RESA-identified somatic mutations maintained a positive VAF correlation between scRNA-seq and WES, as well as scRNA-seq and bRNA-seq across multiple cell lines (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6a, b). In particular, although germline variants are thought to share similar quality properties as somatic mutations, we adopted several approaches to help eliminate germline variants in different circumstances.</p>
      <p id="Par56">We applied RESA-jLR to full-length scRNA-seq data from 15 datasets encompassing 8 cancer cell lines, which were generated by different research groups, employed different experimental protocols, and operated under different experimental conditions (<xref rid="Sec2" ref-type="sec">Methods</xref>, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1). To assess the accuracy of the joint logistic regression model, we evaluated its performance in the independently held-out test sets. The model achieved an AUC ranging from 0.79 to 0.98, with an average AUC of 0.89 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7), suggesting the joint logistic regression model was highly effective. Furthermore, we observed high agreement among most datasets when comparing the feature weights of quality-related features in the quality-based logistic regression. This indicates that the effect of quality-related features on mutation detection could be generalizable (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8a). In contrast, we found that feature weights of sequence-related features were cell type-specific, with high correlation observed only among different experimental conditions of the same cell line (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8b). This demonstrated the adaptable nature of RESA-jLR to specific cell types and the robustness of RESA-jLR across experimental conditions.</p>
    </sec>
    <sec id="Sec18">
      <title>RESA maintains high precision in in silico spike-in scRNA-seq datasets of human tissue</title>
      <p id="Par57">To comprehensively benchmark RESA against other methods in human tissue scRNA-seq data under diverse scenarios, we designed an in silico spike-in experiment (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). Briefly, we collected SMART-seq2 data generated from pancreas tissues of three donors as three baseline datasets, namely 4-month-old (221 cells), 5-year-old (331 cells), and 6-year-old (178 cells), respectively [<xref ref-type="bibr" rid="CR12">12</xref>]. We considered the datasets from these donors to carry predominantly noise and artefacts and expected minimal true somatic mutations as they were generated in body cells after birth. We then collected a total of 77,088 somatic mutations from CCLE WES data of 10 cancer cell lines with varying cancer types and mutation burdens. For each cancer cell line and each baseline dataset, we “spiked-in” somatic SNVs in silico using BAMSurgeon [<xref ref-type="bibr" rid="CR35">35</xref>], followed by performing RESA or other methods to detect somatic mutations. To analyze the effect of coverage per cell and cell number on algorithm performance, we sorted the single cells in decreasing coverage and tested algorithms’ performance on different subsets of the cell population (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, <xref rid="Sec2" ref-type="sec">Methods</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><p>Benchmark RESA to other methods in the in silico spike-in scRNA-seq datasets. <bold>a</bold> Workflow for in silico spike-in. scRNA-seq raw reads of pancreas tissues from 3 healthy juveniles using SMART-seq2 technology in Enge et al. 2017 [<xref ref-type="bibr" rid="CR12">12</xref>] were collected as original BAM files. Somatic SNVs of 10 cancer cell lines covering 5 tissues of origin were identified from WES data. Bamsurgeon spiked cancer cell line somatic SNVs into the original BAM files to produce ‘Burn-in’ BAM files. In silico spike-in scRNA-seq datasets were ordered by the coverage of each cell, split into several subsets, and followed by further evaluations. b, The violin plot illustrates the distribution of coverage in each subset. The error bars display the average and standard deviation of the precision of RESA, RESA-jLR, and the other 5 previously published algorithms. If the minimum value of the error bar is less than 0, 0 is shown. Top: a 4-month-old infant (Blue). Middle: a 5-year-old child (Purple). Bottom: a 6-year-old child (Green). <bold>c</bold> The scatter plot shows precisions and sensitivities in different subsets of 10 cell lines. Points in red are the results of RESA, and points in blue are the results of RESA-jLR. Top: a 4-month-old infant. Middle: 5-year-old child. Bottom: a 6-year-old child. <bold>d</bold> F0.5 score in in silico spike-in scRNA-seq datasets (Wilcoxon rank-sum test, NS: not significant, * <italic>p</italic> &lt; 0.05, ** p &lt; 0.01, *** <italic>p</italic> &lt; 0.001, **** <italic>p</italic> &lt; 0.0001). Top: a 4-month-old infant (Blue). Middle: 5-year-old child (Purple). Bottom: a 6-year-old child (Green). <bold>e</bold> The bar plot illustrates the number of “spiked-in” mutations across 10 cell lines. Top: a 4-month-old infant (Blue). Middle: 5-year-old child (Purple). Bottom: a 6-year-old child (Green)</p></caption><graphic xlink:href="13073_2023_1269_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par58">RESA demonstrated the most consistent and highest precision in all spiked-in scRNA-seq datasets tested, with average precision of 0.84, 0.87, and 0.87 for the three baseline datasets, respectively, followed by RESA-jLR model with average precision of 0.61, 0.66, and 0.76, respectively (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). Among the five previously published methods, Maynard et al. showed the highest average precision. However, the precision varied significantly across different test cases, with an average precision of only 0.2 for all three baseline datasets (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). Furthermore, spike-in results showed that additional cells with lower sequencing coverage led to decreased precision overall, but RESA demonstrated more stable precision compared to the RESA-jLR model (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). This suggests that sequencing coverage at a single cell level might be more crucial for mutation detection than the total number of cells tested. Additionally, we observed that RESA consistently maintained high precision with low variation even with a significant variation in the number of “spiked-in” somatic mutations from different cancer cell lines (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, d). Here we demonstrated that RESA can reach average an precision of 0.86 in primary tissue samples, with an average of 1.8 million reads/cell (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9). Notably, in the in silico spike-in data of a 1-month-old infant, more than 50 cells had less than 1 million reads, yet the average precision for this dataset was approximately 0.87.</p>
      <p id="Par59">The RESA-jLR model complemented the conservative approach used in RESA by demonstrating increased sensitivity at the cost of decreased precision. For instance, the RESA-jLR identified, on average, 20% more new somatic mutations in the test cases from the 5-year-old baseline dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10). We further evaluated the performance using an F0.5 score, a weighted harmonic mean emphasizing more on precision over sensitivity. In test cases with large numbers of “spiked-in” somatic mutations, RESA-jLR outperformed RESA with an increase in sensitivity and a stable precision that resulted in higher F0.5 scores (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c, d, e, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S11), suggesting that RESA-jLR has advantages in datasets with high mutation burden. In addition, through in silico “spike-in” analysis, we demonstrated the superior performance of RESA across different sequencing coverage and cancer cell lines. Our results highlighted the difficulty in balancing precision and sensitivity in scRNA-seq somatic mutation detection tasks.</p>
    </sec>
    <sec id="Sec19">
      <title>RESA achieves higher precision across cancer cell line data</title>
      <p id="Par60">The WES/WGS data available from various cancer cell lines presented us with the opportunity to assess the performance of different methods using orthogonal information. We gathered 15 scRNA-seq datasets covering eight cancer cell lines with somatic mutations from WES available, and compared five previously published methods [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>] with varying strategies to benchmark against the RESA pipeline. Across all 15 datasets, both RESA and RESA-jLR consistently demonstrated substantially higher precision compared to other methods, achieving an average precision of 0.75 (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S12), while RESA-jLR increased sensitivity with slightly decreased precision compared to RESA alone (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S13). The high precision of RESA and RESA-jLR made the identified somatic mutations much more reliable for downstream analysis and interpretations, despite suboptimal sensitivity. The other methods showed variable sensitivity but dramatically lower precision, which diminished the value of these methods (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). Additionally, RESA and RESA-jLR outperformed other methods overall, with RESA-jLR showing marginally higher and more stable F0.5 performance (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). The best-performing method, other than RESA, is the method used by Maynard et al. [<xref ref-type="bibr" rid="CR15">15</xref>] (Methods), which mainly focused on filtering against a curated somatic mutation whitelist combined with tissue source information. Although this filtering of mutations is intuitively reasonable, however, the performances of the Maynard et al. method varied dramatically depending on the dataset used, which confirmed the sporadic nature of cancer somatic mutations in a sample specific manner. In contrast, the somatic mutations identified by RESA between datasets of the same cell line showed remarkable consistency (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14b).<fig id="Fig4"><label>Fig. 4</label><caption><p>Evaluating the performance of RESA with comparison to other methods using WES data across multiple cancer cell lines. <bold>a</bold> Boxplots showing precisions (top) and sensitivities (bottom) of different methods in identifying positive somatic SNVs using WES data as ground truth across 15 scRNA-seq datasets. <bold>b</bold> The scatter plot showing F0.5 scores of different methods in identifying positive somatic SNVs using the number of somatic SNVs in WES data as ground truth across 15 scRNA-seq datasets. <bold>c</bold> Mutation spectra of somatic SNVs identified using all exonic SNVs, all expressed SNVs, RESA-jLR, and the Maynard 2020 approach across 3 scRNA-seq datasets. Pairwise cosine similarity scores were shown next to brackets</p></caption><graphic xlink:href="13073_2023_1269_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par61">Notably, RESA effectively identified somatic SNVs across cancer cells with varying mutation burdens despite sensitivity differences (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14d). In particular, in the case of the JURKAT cell line, RESA detected a median of 449 and 387 somatic SNVs per cell in the SMART-seq and TARGET-seq datasets, respectively. These numbers were over 100 times higher than the somatic mutations detected in experimental multi-omic profiling (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14c, Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S1, Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Table S1) [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>].</p>
      <p id="Par62">Next, we assessed the population-wise mutational spectrum captured by different methods against the WES mutational spectrum, and all expressed SNVs that can potentially be detected in the corresponding scRNA-seq data. We observed that expressed SNVs generally captured the exonic mutational spectra well, with lower numbers of SNVs detected and sparser presentation for low mutation burden samples (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14d). Expressed SNVs detected by RESA-jLR reproduced the mutational spectrum of all expressed SNVs faithfully, particularly in samples with a high mutation burden (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14d). In contrast, Maynard 2020 [<xref ref-type="bibr" rid="CR15">15</xref>], the best-performing method in precision among all other methods, failed to capture the mutational spectra of either expressed or all exonic SNVs (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14d). Therefore, expressed SNVs detected by RESA-jLR from the scRNA-seq data can be used to assess the genomic mutational spectra, particularly in samples with a high mutation burden.</p>
    </sec>
    <sec id="Sec20">
      <title>RESA achieved higher precision across tumor tissue datasets</title>
      <p id="Par63">To further evaluate RESA's performance in real tumor data, we collected four scRNA-seq datasets with matching WES data from two independent studies involving different cancer types. These datasets include two replicates of lung adenocarcinoma tumor xenograft [<xref ref-type="bibr" rid="CR25">25</xref>], and melanoma patient-derived xenograft (PDX) before and after RAF/MEK inhibitor treatment [<xref ref-type="bibr" rid="CR36">36</xref>]. Again, RESA and RESA-jLR achieved the highest precision and F0.5 scores over other methods (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, b, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S15, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S16). In particular, in the lung cancer datasets with matched normal WES available, RESA was able to obtain higher performance using germline variants from matched normal than using publicly available SNP databases to filter out germline variants (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S17), highlighting that germline variants from matched normal should be applied in RESA whenever such data is available. Despite the likelihood of primary tumor samples being more heterogeneous than cancer cell lines, RESA maintained a positive correlation between scRNA-seq VAF and WES VAF, even with large variations in the WES VAF (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c).<fig id="Fig5"><label>Fig. 5</label><caption><p>Benchmark RESA to other methods in PDX tumor datasets. <bold>a</bold> The bar plots illustrate precisions of RESA, RESA-jLR and other methods in a lung cancer PDX tumor from the same patient with 2 replicates. <bold>b</bold> The bar plots illustrate precisions of RESA, RESA-jLR and other methods in melanoma PDX datasets without treatment (T0) and after treatment (Phase3), <bold>c</bold>, <bold>d</bold>, <bold>e</bold>, <bold>f</bold>, Scatter plots showing VAF correlation of SNVs detected by RESA between scRNA-seq and WES in the lung cancer tumor sample with the replicate 1 (<bold>c</bold>) and replicate 2 (<bold>d</bold>), and melanoma datasets without treatment (<bold>e</bold>) and with treatment (<bold>f</bold>)</p></caption><graphic xlink:href="13073_2023_1269_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par64">Melanoma tumors are characterized by UV signatures in their mutational spectra, which can serve as an additional indicator to assess the reliability of RESA. In the above-mentioned time-course study of RAF/MEK inhibition resistance using scRNA-seq datasets from the melanoma PDX model, over 600 single cells were profiled across four time points: T0 (tumor before treatment), phase 1 (tumor shrinking stage after treatment), phase 2 (minimal residual disease stage), and phase 3 (relapsed stage after drug treatment) [<xref ref-type="bibr" rid="CR36">36</xref>]. RESA accurately reproduced the typical mutational spectrum of UV signature in all melanoma datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S18a). Interestingly, the UV signature remains strong with little variation across different clusters or time points of the cell population, despite expression heterogeneity of somatic SNVs and involved genes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S18c). This is consistent with previous knowledge that treatment with mechanism of action (MOA) not involving DNA replication and repair, e.g. BRAF inhibitor dabrafenib, is not expected to induce large mutational changes [<xref ref-type="bibr" rid="CR36">36</xref>]. In addition, we identified the known BRAF V600E driver mutation present in the sample using RESA (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S1), further validating the reliability of RESA.</p>
    </sec>
    <sec id="Sec21">
      <title>RESA identifies drug resistance-associated genes with expressed somatic mutations in a melanoma PDX scRNA-seq dataset</title>
      <p id="Par65">We applied RESA-jLR to the scRNA-seq datasets of the melanoma PDX model, where we identified 575 unique somatic SNVs and their corresponding 524 genes (Methods, Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S1). To investigate the interplay between mutational heterogeneity and transcriptional heterogeneity, we further analyzed the dataset using graph-based clustering to summarize the gene expression heterogeneity (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S18b). By overlaying the four-time points onto the clusters, we identified both shared and unique clusters across timepoints (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a), which confirmed the transcriptional heterogeneity in the scRNA-seq of the melanoma samples throughout different drug treatment stages. For example, cluster 3 represented unique cell groups at the MRD stage (phase 2), whereas cluster 2 showed expression patterns shared by both the tumor shrinking stage (phase 1) and MRD stage (phase 2). We observed that during the MRD stage of phase 2, cell clusters of 0,1,2,3,5 were all present, indicating a coexistence of heterogeneous subclones rather than the dominance of a single subclone despite minimal tumor size. Thus, our gene expression reanalysis validates the existence of multiple subclones with distinct gene expression signatures across different tumor stages.<fig id="Fig6"><label>Fig. 6</label><caption><p>Somatic SNVs enriched in specific stages using RESA. <bold>a</bold> UMAP embedding of scRNA-seq profiles of each stage. <bold>b</bold> Distributions of percentages of cells harboring stage-specific mutations of each stage. (n.s.: <italic>p</italic> &gt; 0.05, *: <italic>p</italic> &lt;  = 0.05, **: <italic>p</italic> &lt;  = 0.01, ***: <italic>p</italic> &lt;  = 0.001, ****: <italic>p</italic> &lt;  = 0.0001) <bold>c</bold> Aggregate expression of log<sub>2</sub> of transcripts per 10,000 reads (color bar) for stage-specific genes detected in more than 10 cells and the number of cells harboring the mutation in each stage (cycle). <bold>d</bold> List of gene set enrichment results for each stage (MSigDB hallmark)</p></caption><graphic xlink:href="13073_2023_1269_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par66">In order to study the mutational heterogeneity during drug response, we defined "stage-specific" somatic mutations as follows (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b,c). While most mutations were found present across all stages, we reasoned that subclonal mutations that contribute to different stages of the tumor should be non-uniformly present. Based on this assumption, we counted the number of cells carrying mutations in each tumor stage and calculated the enrichment accordingly. We then identified mutated genes that were enriched in specific tumor stages of the cell population compared to their wild-type counterparts. Specifically, we detected 72, 75, 88, and 63 mutated genes for the respective stages and focused our following analysis on mutated genes (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b,c, Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Table S1, Methods).</p>
      <p id="Par67">To investigate the mutated gene expression signatures, we tested GSEA curated cancer hallmarks enriched for the stage-specific mutated genes (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d). As expected, mutated genes were enriched in pathways associated with melanoma development and progression, including the p53 pathway, epithelial to mesenchymal transition (EMT) pathway, mTORC1 signaling, androgen response pathway, and UV response [<xref ref-type="bibr" rid="CR39">39</xref>–<xref ref-type="bibr" rid="CR44">44</xref>]. Notably, when comparing hallmarks of mutated genes across different stages, the androgen response pathway, which is associated with melanoma tumor growth and invasion, was enriched exclusively in the MRD stage (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d). Recent clinical research has reported that drug resistance is associated with sex, and males have shorter survival after BRAF-inhibitor monotherapy [<xref ref-type="bibr" rid="CR45">45</xref>, <xref ref-type="bibr" rid="CR46">46</xref>]. Additionally, androgen receptor signaling is associated with the resistance of targeting BRAF [<xref ref-type="bibr" rid="CR45">45</xref>]. Thus, the androgen response pathway may serve as a crucial mechanism for tumor survival in such cases. Therefore, cancer hallmarks that may be disturbed by expressed somatic SNVs may provide valuable orthogonal information beyond expression variation.</p>
    </sec>
  </sec>
  <sec id="Sec22">
    <title>Discussion</title>
    <p id="Par68">Identifying somatic mutations directly from scRNA-seq data has been a long-standing challenge. While attempts have been made, no computational method has been proven widely applicable. We report a computational framework named RESA, which identifies expressed somatic SNVs with high precision directly from the scRNA-seq data. RESA can effectively filter out noise and artefacts generated during the experimental procedure, thereby achieving high precision. In addition, RESA applies a joint logistic regression to expand the putative somatic mutations, which helps increase detection sensitivity while maintaining high precision. We comprehensively benchmarked RESA across datasets both in vitro and in vivo, and demonstrated the reliability of RESA in different scenarios.</p>
    <p id="Par69">In addition to evaluating individual SNVs, RESA also attempts to assess the mutational spectrum of expressed SNVs. High precision detection of somatic SNVs enables reliable mutational signature analysis of the expressed SNVs in scRNA-seq data, thus providing insights into the mechanistic biological processes involved in cancer progression, or revealing potential therapeutic opportunities in the sample of interest.</p>
    <p id="Par70">Balancing precision and sensitivity is tricky. Precision measures the proportion of true somatic mutations identified by RESA out of all somatic mutations suggested by RESA (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). On the other hand, sensitivity measures the proportion of true somatic mutations out of all somatic mutations carried in scRNA-seq data. Previous methods mostly achieve high sensitivity, but their low precisions lead to an excessive amount of noise and artefacts (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). The main purpose of our model is to identify higly reliable somatic mutation, which emphasizes more on precision over sensitivity. So that we can be very confident in the RESA-suggested somatic mutations in cases without matched WES/WGS for evaluation and improved the reliability of downstream analysis. To compensate for the loss of sensitivity, and increase sensitivity, we developed the RESA-jLR modeling step. In addition, we used the F0.5 score to reconcile the performance evaluation balance between precision and sensitivity. As demonstrated in our results, RESA-jLR achieves better performances than RESA in cases of high mutation burden or high sequencing coverage per cell.</p>
    <p id="Par71">VAF represents the fraction of alleles containing mutations. In WES, the VAF value is affected by tumor purity and clonality. In bRNA-seq, the VAF interpretation is further complicated due to allelic and stochastic expression and the abundance of genes containing mutations. However, the VAF estimate from scRNA-seq might be perceived as the deconvolution of bRNA for VAF without the complication of tumor purity as long as only cancer cells are assessed. Interestingly, we observed a positive correlation between scRNA-seq VAF and VAF from both bRNA-seq (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d) and WES (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e) in the A375 cell line data. These results suggest that scRNA-seq VAF might be indicative of the mutant VAF at the bulk level. Notably, we detected somatic mutations from scRNA-seq with a WES VAF as low as 0.13 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3).</p>
    <p id="Par72">Detection of expressed SNVs using RESA may suffer from several limitations. RESA works best in scRNA-seq data that are sequenced relatively deep (1–3 million reads per cell in general), or in samples with relatively high mutation burden. Application to other widely used scRNA-seq technologies like 10X genomics and drop-seq might thus be limited by the nature of shallow sequencing and biased gene region coverage. However, recent studies have made efforts to address the coverage issue by combining bam files of the same cell type in 10X Genomics datasets to detect somatic mutations [<xref ref-type="bibr" rid="CR47">47</xref>]. Taking this into consideration, we acknowledge that RESA could be improved by incorporating this strategy in the future, thereby expanding its potential application areas. Another potential limitation is that this approach is designed to detect clonal somatic mutations instead of rare mutations in the population. Empirically we found that WES VAF above 0.1 can be detectable in scRNA-seq data and RESA. In addition, due to the nature of the scRNA-seq experiment, only mutations with relatively high expression are potentially detectable. Lastly, some somatic mutations expressed in a single cell might not be detectable through WES/WGS, leading to a decreased precision value that underestimates the real precision. Moreover, the clonal divergence between cell cultures that generated WES/WGS data vs. scRNA-seq data might also decrease the precision. Thus, the limited sensitivity of scRNA-seq data as well as RESA might potentially limit its application.</p>
    <p id="Par73">The success of RESA in high precision somatic mutation detection from scRNA-seq data highlights the critical importance of cellular recurrence, whereas prioritizing based on functional prediction or stratification from curated whitelist mutations does not always work well. This is the first study, to the best of our knowledge, that made a direct comparison among the methods emphasizing the above aspects and delivering distinctive results. As more datasets, especially datasets with both scRNA-seq and WES/WEG profiling on the same sample, become available, new methods may be developed with better performance. We believe RESA will provide valuable information to facilitate single cell level genotype to phenotype study in the future.</p>
  </sec>
  <sec id="Sec23">
    <title>Conclusions</title>
    <p id="Par74">In summary, we introduce a computational framework package named RESA that identifies expressed somatic mutations from scRNA-seq de novo. RESA effectively filters out noise and artefacts identified through common variant calling pipelines. We demonstrated the remarkable improvement in precision and F0.5 score of RESA against other methods across multiple test case scenarios. We showcased the application of RESA-jLR to provide novel insights into the potential mutational mechanisms underlying melanoma MRD, and we believe RESA is highly valuable to providing orthogonal insights into the intratumor heterogeneity studies in scRNA-seq datasets.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec24">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13073_2023_1269_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: </bold>Includes 18 figures of additional results. The names of the figure are: <bold>Figure S1. </bold>Workflow illustrates the different strategies between RESA and other methods; <bold>Figure S2.</bold> The correlation between site-specific depth and number of detectable SNVs in scRNA-seq; <bold>Figure S3. </bold>Scatter plots showing VAF correlation of SNVs detected by RESA between scRNA-seq and WES in the A375 cell line; <bold>Figure S4.</bold> Full length scRNA-seq sequencing procedure, steps where noise and artefacts may be introduced are highlighted; <bold>Figure S5. </bold>Comparison between identified somatic SNVs and identified noise and artefacts; <bold>Figure S6.</bold> Scatter plots showing VAF correlation of SNVs detected by RESA between scRNA-seq and WES, as well as scRNA-seq and bRNA-seq in the A375 cell line and LNCaP cell line; <bold>Figure S7.</bold> AUC values of the joint logistic regression model prediction on the test set in 15 tested datasets;<bold> Figure S8.</bold> Correlation of feature weights in quality-based and sequence-based logistic regression; <bold>Figure S9. </bold>The distribution of million reads per cell in in silico spike-in datasets of 1-month-old, 5-year-old, 6-year-old donors; <bold>Figure S10. </bold>The bar plot illustrates the percentage change of the number of expressed SNVs detected by RESA-jLR against RESA-identified SNVs in the in silico spike-in scRNA-seq dataset of a 5-year-old child; <bold>Figure S11.</bold> The bar plot illustrates sensitivity in the in silico spike-in scRNA-seq dataset of 1-month-old, 5-year-old, 6-year-old donors; <bold>Figure S12.</bold> Boxplots showing precisions (top) and sensitivities (bottom) of different methods in identifying positive somatic SNVs using WES data as ground truth across 15 scRNA-seq datasets; <bold>Figure S13. </bold>The bar plot illustrates the sensitivity of 15 cell line datasets;<bold> Figure S14. </bold>Evaluating RESA performance with comparison to other methods; <bold>Figure S15.</bold> The bar plot illustrates sensitivity in PDX tumor datasets; <bold>Figure S16.</bold> Bar plots illustrate the F0.5 scores of RESA, RESA-jLR, and other methods in PDX tumor datasets; <bold>Figure S17.</bold> Lung cancer PDX tumor datasets with the matched normal in two groups of independent cells; <bold>Figure S18. </bold>Reanalysis of a melanoma scRNA-seq dataset using RESA.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13073_2023_1269_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2:</bold> Includes 1 table for cell line data sets used in the study. The name of the table is:<bold> Table S1. </bold>Somatic SNVs detecting by RESA to full-length scRNA-seq data from 15 datasets.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13073_2023_1269_MOESM3_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3:</bold> Includes 1 table of the annotation for cell line data sets used in the study. The name of the table is:<bold> Table S1. </bold>Annotation of each mutation in 15 cell line datasets detected by RESA.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13073_2023_1269_MOESM4_ESM.xlsx">
            <caption>
              <p><bold>Additional file 4:</bold> Includes 1 table of the statistical summary for cell line data sets. The name of the table is:<bold> Table S1.</bold> Summary statistic table of mutations detected by RESA.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13073_2023_1269_MOESM5_ESM.xlsx">
            <caption>
              <p><bold>Additional file 5:</bold> Includes 1 table for melanoma data sets. The name of the table is:<bold> Table S1.</bold> 575 unique somatic SNVs of scRNA-seq of the melanoma detected by RESA, which mapped to 524 genes.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="13073_2023_1269_MOESM6_ESM.xlsx">
            <caption>
              <p><bold>Additional file 6:</bold> Includes 1 table of the stage enrichment for melanoma data sets. The name of the table is:<bold> Table S1.</bold> P values of the Hypergeometric test for stage-specific somatic SNVs enrichment in each stage.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>scRNA-seq</term>
        <def>
          <p id="Par2">Single-cell RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>RESA</term>
        <def>
          <p id="Par3">Recurrently Expressed SNV Analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>MRD</term>
        <def>
          <p id="Par4">Minimal residual disease</p>
        </def>
      </def-item>
      <def-item>
        <term>WGS</term>
        <def>
          <p id="Par5">Whole genome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>WES</term>
        <def>
          <p id="Par6">Whole exome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>RESA-jLR</term>
        <def>
          <p id="Par7">RESA followed by a joint logistic regression</p>
        </def>
      </def-item>
      <def-item>
        <term>VAF</term>
        <def>
          <p id="Par8">Variant allele frequency</p>
        </def>
      </def-item>
      <def-item>
        <term>bRNA-seq</term>
        <def>
          <p id="Par9">Bulk RNA-seq</p>
        </def>
      </def-item>
      <def-item>
        <term>PDX</term>
        <def>
          <p id="Par10">Patient-derived xenograft</p>
        </def>
      </def-item>
      <def-item>
        <term>MOA</term>
        <def>
          <p id="Par11">Mechanism of action</p>
        </def>
      </def-item>
      <def-item>
        <term>EMT</term>
        <def>
          <p id="Par12">Epithelial to mesenchymal transition</p>
        </def>
      </def-item>
      <def-item>
        <term>scWGS</term>
        <def>
          <p id="Par13">Single cell whole genome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>LUAD</term>
        <def>
          <p id="Par14">Lung adenocarcinoma</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>This article has been updated to amend affiliations 1 &amp; 2.</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>
        <bold>Change history</bold>
      </p>
      <p>5/14/2024</p>
      <p>A Correction to this paper has been published: 10.1186/s13073-024-01343-2</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Prof. Peter Park, Prof. Haoxing Xu, and Vinay V. Viswanadham for their helpful discussion and suggestions. We thank Prof. Haoxing Xu, Dr. Jiaming Li, Dr. Xudong Fu, Dr. Zhaoyuan Fang, and Dr. Asif Ashan for critical reading and suggestions on the manuscript. We are also thankful for the technical support by the Core Facilities of Liangzhu Laboratory.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>N.S. designed the project and overall method. N.S. and T.Z. developed, implemented the method and analyzed the data. N.S., T.Z., H.J., and T.S. drafted the manuscript. L.L., D.C.G, H.W., R.X., W.G. and H.G. contributed suggestions. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the Leading Innovative and Entrepreneur Team Introduction Program of Zhejiang (No. 2021R01012) and the Starting Fund from Zhejiang University.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The WES data and bulk RNA-seq data for cancer cell line LNCaP were downloaded through Genomic Data Commons (<ext-link ext-link-type="uri" xlink:href="https://gdc.cancer.gov/">https://gdc.cancer.gov/</ext-link>). The exonic somatic mutations for all cancer cell lines were downloaded from CCLE_20Q1_mutations [<xref ref-type="bibr" rid="CR20">20</xref>]. The scRNA-seq for cancer cell lines were downloaded from GSE105451 [<xref ref-type="bibr" rid="CR4">4</xref>], GSE99795 [<xref ref-type="bibr" rid="CR21">21</xref>], GSE76312 [<xref ref-type="bibr" rid="CR5">5</xref>], GSE150993 [<xref ref-type="bibr" rid="CR22">22</xref>], GSE108383 [<xref ref-type="bibr" rid="CR23">23</xref>], GSE140440 [<xref ref-type="bibr" rid="CR24">24</xref>], and GSE69405 [<xref ref-type="bibr" rid="CR25">25</xref>] respectively. The lung cancer scRNA-seq data and WES were downloaded from GSE69405 [<xref ref-type="bibr" rid="CR25">25</xref>]. The human tissue scRNA-seq data of melanoma were downloaded from GSE81547 [<xref ref-type="bibr" rid="CR35">35</xref>]. The matched WES of melanoma PDX was downloaded from EGAD00001007749 [<xref ref-type="bibr" rid="CR36">36</xref>].</p>
    <p>The source code for the RESA pipeline is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ShenLab-Genomics/RESA">https://github.com/ShenLab-Genomics/RESA</ext-link> [<xref ref-type="bibr" rid="CR26">26</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par75">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par76">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par77">The authors have submitted a patent application for the method. Other than this, the authors declare that they do not have any competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Yizhak K, Aguet F, Kim J, Hess JM, Kübler K, Grimsby J, et al. RNA sequence analysis reveals macroscopic somatic clonal expansion across normal tissues. Science. 2019;364. Available from: 10.1126/science.aaw0726</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">PCAWG Transcriptome Core Group, Calabrese C, Davidson NR, Demircioğlu D, Fonseca NA, He Y, et al. Genomic basis for RNA alterations in cancer. Nature. 2020;578:129–36.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nam</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>K-T</given-names>
          </name>
          <name>
            <surname>Chaligne</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Izzo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Somatic mutations and cell identity linked by Genotyping of Transcriptomes</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>571</volume>
        <fpage>355</fpage>
        <lpage>360</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1367-0</pub-id>
        <?supplied-pmid 31270458?>
        <pub-id pub-id-type="pmid">31270458</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rodriguez-Meira</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Buck</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>S-A</given-names>
          </name>
          <name>
            <surname>Povinelli</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Alcolea</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Louka</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unravelling intratumoral heterogeneity through high-sensitivity single-cell mutational analysis and parallel RNA Sequencing</article-title>
        <source>Mol Cell</source>
        <year>2019</year>
        <volume>73</volume>
        <fpage>1292</fpage>
        <lpage>305.e8</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2019.01.009</pub-id>
        <?supplied-pmid 30765193?>
        <pub-id pub-id-type="pmid">30765193</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giustacchini</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Thongjuea</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Barkas</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Woll</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Povinelli</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Booth</surname>
            <given-names>CAG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomics uncovers distinct molecular signatures of stem cells in chronic myeloid leukemia</article-title>
        <source>Nat Med</source>
        <year>2017</year>
        <volume>23</volume>
        <fpage>692</fpage>
        <lpage>702</lpage>
        <pub-id pub-id-type="doi">10.1038/nm.4336</pub-id>
        <?supplied-pmid 28504724?>
        <pub-id pub-id-type="pmid">28504724</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Petti</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Fiddes</surname>
            <given-names>IT</given-names>
          </name>
          <name>
            <surname>Srivatsan</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>DY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A general approach for detecting expressed mutations in AML cells using single cell RNA-sequencing</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>3660</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-11591-1</pub-id>
        <?supplied-pmid 31413257?>
        <pub-id pub-id-type="pmid">31413257</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">van Galen P, Hovestadt V, Wadsworth MH Ii, Hughes TK, Griffin GK, Battaglia S, et al. Single-Cell RNA-Seq Reveals AML Hierarchies Relevant to Disease Progression and Immunity. Cell. 2019;176:1265–81.e24.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Francis</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Georghiou</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hergert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated single-cell genetic and transcriptional analysis suggests novel drivers of chronic lymphocytic leukemia</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>1300</fpage>
        <lpage>1311</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.217331.116</pub-id>
        <?supplied-pmid 28679620?>
        <pub-id pub-id-type="pmid">28679620</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campbell</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Steif</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zahn</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>clonealign: statistical integration of independent single-cell RNA and DNA sequencing data from human cancers</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>54</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1645-z</pub-id>
        <?supplied-pmid 30866997?>
        <pub-id pub-id-type="pmid">30866997</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hovestadt</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Bihannic</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Filbin</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Baumgartner</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Resolving medulloblastoma cellular architecture by single-cell genomics</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>572</volume>
        <fpage>74</fpage>
        <lpage>79</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1434-6</pub-id>
        <?supplied-pmid 31341285?>
        <pub-id pub-id-type="pmid">31341285</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Picelli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Björklund</surname>
            <given-names>ÅK</given-names>
          </name>
          <name>
            <surname>Faridani</surname>
            <given-names>OR</given-names>
          </name>
          <name>
            <surname>Sagasser</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Winberg</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Smart-seq2 for sensitive full-length transcriptome profiling in single cells</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1096</fpage>
        <lpage>1098</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2639</pub-id>
        <?supplied-pmid 24056875?>
        <pub-id pub-id-type="pmid">24056875</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Enge</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Arda</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Mignardi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Beausang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bottino</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>SK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell analysis of human pancreas reveals transcriptional signatures of aging and somatic mutation patterns</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <fpage>321</fpage>
        <lpage>30.e14</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.09.004</pub-id>
        <?supplied-pmid 28965763?>
        <pub-id pub-id-type="pmid">28965763</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mathys</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Davila-Velderrain</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mohammadi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>JZ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomic analysis of Alzheimer’s disease</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>570</volume>
        <fpage>332</fpage>
        <lpage>337</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1195-2</pub-id>
        <?supplied-pmid 31042697?>
        <pub-id pub-id-type="pmid">31042697</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darmanis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sloan</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Croote</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mignardi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chernikova</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Samghababi</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-Seq analysis of infiltrating neoplastic cells at the migrating front of human glioblastoma</article-title>
        <source>Cell Rep</source>
        <year>2017</year>
        <volume>21</volume>
        <fpage>1399</fpage>
        <lpage>1410</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2017.10.030</pub-id>
        <?supplied-pmid 29091775?>
        <pub-id pub-id-type="pmid">29091775</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maynard</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McCoach</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Rotow</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Haderk</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kerr</surname>
            <given-names>DL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Therapy-induced evolution of human lung cancer revealed by single-cell RNA sequencing</article-title>
        <source>Cell</source>
        <year>2020</year>
        <volume>182</volume>
        <fpage>1232</fpage>
        <lpage>51.e22</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.07.017</pub-id>
        <?supplied-pmid 32822576?>
        <pub-id pub-id-type="pmid">32822576</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systematic comparative analysis of single-nucleotide variant detection methods from single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>242</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1863-4</pub-id>
        <?supplied-pmid 31744515?>
        <pub-id pub-id-type="pmid">31744515</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vu</surname>
            <given-names>TN</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>H-N</given-names>
          </name>
          <name>
            <surname>Calza</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kalari</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pawitan</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Cell-level somatic mutation detection from single-cell RNA sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>4679</fpage>
        <lpage>4687</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz288</pub-id>
        <?supplied-pmid 31028395?>
        <pub-id pub-id-type="pmid">31028395</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Edwards N, Dillard C, Prashant NM, Hongyu L, Yang M, Ulianova E, et al. SCExecute: custom cell barcode-stratified analyses of scRNA-seq data. Bioinformatics. 2023;39. Available from: 10.1093/bioinformatics/btac768</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frohlich</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Anti-HTLV III testing of blood donors and recipients Hawaii experience</article-title>
        <source>Hawaii Med J</source>
        <year>1986</year>
        <volume>45</volume>
        <fpage>391</fpage>
        <lpage>392</lpage>
        <?supplied-pmid 3468095?>
        <pub-id pub-id-type="pmid">3468095</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ghandi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>FW</given-names>
          </name>
          <name>
            <surname>Jané-Valbuena</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kryukov</surname>
            <given-names>GV</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>McDonald</surname>
            <given-names>ER</given-names>
            <suffix>3rd</suffix>
          </name>
          <etal/>
        </person-group>
        <article-title>Next-generation characterization of the cancer cell line encyclopedia</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>569</volume>
        <fpage>503</fpage>
        <lpage>508</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1186-3</pub-id>
        <?supplied-pmid 31068700?>
        <pub-id pub-id-type="pmid">31068700</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Horning</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>C-K</given-names>
          </name>
          <name>
            <surname>Louie</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Jadhav</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Hung</surname>
            <given-names>C-N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq reveals a subpopulation of prostate cancer cells with enhanced cell-cycle-related transcription and attenuated androgen response</article-title>
        <source>Cancer Res</source>
        <year>2018</year>
        <volume>78</volume>
        <fpage>853</fpage>
        <lpage>864</lpage>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-17-1924</pub-id>
        <?supplied-pmid 29233929?>
        <pub-id pub-id-type="pmid">29233929</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>The effect of methanol fixation on single-cell RNA sequencing data</article-title>
        <source>BMC Genomics</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>420</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-021-07744-6</pub-id>
        <?supplied-pmid 34090348?>
        <pub-id pub-id-type="pmid">34090348</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ho</surname>
            <given-names>Y-J</given-names>
          </name>
          <name>
            <surname>Anaparthy</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Molik</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mathew</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Aicher</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq analysis identifies markers of resistance to targeted BRAF inhibitors in melanoma cell populations</article-title>
        <source>Genome Res</source>
        <year>2018</year>
        <volume>28</volume>
        <fpage>1353</fpage>
        <lpage>1363</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.234062.117</pub-id>
        <?supplied-pmid 30061114?>
        <pub-id pub-id-type="pmid">30061114</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schnepp</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Shelley</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wakim</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Mizokami</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomics analysis identifies nuclear protein 1 as a regulator of docetaxel resistance in prostate cancer cells</article-title>
        <source>Mol Cancer Res</source>
        <year>2020</year>
        <volume>18</volume>
        <fpage>1290</fpage>
        <lpage>1301</lpage>
        <pub-id pub-id-type="doi">10.1158/1541-7786.MCR-20-0051</pub-id>
        <?supplied-pmid 32513898?>
        <pub-id pub-id-type="pmid">32513898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>K-T</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>HW</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>H-O</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Seo</surname>
            <given-names>YJ</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell mRNA sequencing identifies subclonal heterogeneity in anti-cancer drug responses of lung adenocarcinoma cells</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>127</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0692-3</pub-id>
        <?supplied-pmid 26084335?>
        <pub-id pub-id-type="pmid">26084335</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Shen N, Zhang T. RESA Github. 2020 <ext-link ext-link-type="uri" xlink:href="https://github.com/ShenLab-Genomics/RESA">https://github.com/ShenLab-Genomics/RESA</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Schlesinger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Drenkow</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zaleski</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jha</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id>
        <?supplied-pmid 23104886?>
        <pub-id pub-id-type="pmid">23104886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Garimella</surname>
            <given-names>KV</given-names>
          </name>
          <name>
            <surname>Maguire</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hartl</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>491</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.806</pub-id>
        <?supplied-pmid 21478889?>
        <pub-id pub-id-type="pmid">21478889</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <?supplied-pmid 29750242?>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Scheffler</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Halpern</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Bekritsky</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Noh</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Källberg</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Strelka2: fast and accurate calling of germline and somatic variants</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>591</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0051-x</pub-id>
        <?supplied-pmid 30013048?>
        <pub-id pub-id-type="pmid">30013048</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Fangal VD. CTAT Mutations: a machine learning based RNA-Seq variant calling pipeline incorporating variant annotation, prioritization, and visualization. 2020; Available from: <ext-link ext-link-type="uri" xlink:href="https://dash.harvard.edu/handle/1/37365605">https://dash.harvard.edu/handle/1/37365605</ext-link></mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tate</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Bamford</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jubb</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Sondka</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Beare</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Bindal</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>COSMIC: the catalogue of somatic mutations in cancer</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D941</fpage>
        <lpage>D947</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1015</pub-id>
        <?supplied-pmid 30371878?>
        <pub-id pub-id-type="pmid">30371878</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <?supplied-pmid 19505943?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koboldt</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wylie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>McLellan</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Mardis</surname>
            <given-names>ER</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>VarScan: variant detection in massively parallel sequencing of individual and pooled samples</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2283</fpage>
        <lpage>2285</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp373</pub-id>
        <?supplied-pmid 19542151?>
        <pub-id pub-id-type="pmid">19542151</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ewing</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Houlahan</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ellrott</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Caloian</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yamaguchi</surname>
            <given-names>TN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Combining tumor genome simulation with crowdsourcing to benchmark somatic single-nucleotide-variant detection</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>623</fpage>
        <lpage>630</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3407</pub-id>
        <?supplied-pmid 25984700?>
        <pub-id pub-id-type="pmid">25984700</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rambow</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Rogiers</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marin-Bejar</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Aibar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Femel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dewaele</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Toward minimal residual disease-directed therapy in melanoma</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>174</volume>
        <fpage>843</fpage>
        <lpage>55.e19</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.06.025</pub-id>
        <?supplied-pmid 30017245?>
        <pub-id pub-id-type="pmid">30017245</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marin-Bejar</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Rogiers</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dewaele</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Femel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Karras</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pozniak</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evolutionary predictability of genetic versus nongenetic resistance to anticancer drugs in melanoma</article-title>
        <source>Cancer Cell</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>1135</fpage>
        <lpage>49.e8</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ccell.2021.05.015</pub-id>
        <?supplied-pmid 34143978?>
        <pub-id pub-id-type="pmid">34143978</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mootha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Gillette</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>15545</fpage>
        <lpage>15550</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id>
        <?supplied-pmid 16199517?>
        <pub-id pub-id-type="pmid">16199517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmidt</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Joyce</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Buquicchio</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ritz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Distel</surname>
            <given-names>RJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The lncRNA SLNCR1 mediates melanoma invasion through a conserved SRA1-like Region</article-title>
        <source>Cell Rep</source>
        <year>2016</year>
        <volume>15</volume>
        <fpage>2025</fpage>
        <lpage>2037</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2016.04.018</pub-id>
        <?supplied-pmid 27210747?>
        <pub-id pub-id-type="pmid">27210747</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Box NF, Vukmer TO, Terzian T. Targeting p53 in melanoma. Pigment Cell Melanoma Res. 2014. p. 8–10.</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stretch</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Gatter</surname>
            <given-names>KC</given-names>
          </name>
          <name>
            <surname>Ralfkiaer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lane</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>AL</given-names>
          </name>
        </person-group>
        <article-title>Expression of mutant p53 in melanoma</article-title>
        <source>Cancer Res</source>
        <year>1991</year>
        <volume>51</volume>
        <fpage>5976</fpage>
        <lpage>5979</lpage>
        <?supplied-pmid 1933861?>
        <pub-id pub-id-type="pmid">1933861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Elsas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zerp</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>van der Flier</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Krüse</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Aarnoudse</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hayward</surname>
            <given-names>NK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Relevance of ultraviolet-induced N-ras oncogene point mutations in development of primary human cutaneous melanoma</article-title>
        <source>Am J Pathol</source>
        <year>1996</year>
        <volume>149</volume>
        <fpage>883</fpage>
        <lpage>893</lpage>
        <?supplied-pmid 8780392?>
        <pub-id pub-id-type="pmid">8780392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Tang Y, Durand S, Dalle S, Caramel J. EMT-Inducing transcription factors, drivers of melanoma phenotype switching, and resistance to treatment. Cancers. 2020;12. Available from: 10.3390/cancers12082154</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yeh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Androgen receptor promotes melanoma metastasis via altering the miRNA-539-3p/USP13/MITF/AXL signals</article-title>
        <source>Oncogene</source>
        <year>2017</year>
        <volume>36</volume>
        <fpage>1644</fpage>
        <lpage>1654</lpage>
        <pub-id pub-id-type="doi">10.1038/onc.2016.330</pub-id>
        <?supplied-pmid 27869170?>
        <pub-id pub-id-type="pmid">27869170</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vellano</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Chelvanambi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Witt</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Daniele</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Androgen receptor blockade promotes response to BRAF/MEK-targeted therapy</article-title>
        <source>Nature</source>
        <year>2022</year>
        <volume>606</volume>
        <fpage>797</fpage>
        <lpage>803</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-022-04833-8</pub-id>
        <?supplied-pmid 35705814?>
        <pub-id pub-id-type="pmid">35705814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Long</surname>
            <given-names>GV</given-names>
          </name>
          <name>
            <surname>Grob</surname>
            <given-names>J-J</given-names>
          </name>
          <name>
            <surname>Nathan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ribas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Robert</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schadendorf</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Factors predictive of response, disease progression, and overall survival after dabrafenib and trametinib combination treatment: a pooled analysis of individual patient data from randomised trials</article-title>
        <source>Lancet Oncol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>1743</fpage>
        <lpage>1754</lpage>
        <pub-id pub-id-type="doi">10.1016/S1470-2045(16)30578-2</pub-id>
        <?supplied-pmid 27864013?>
        <pub-id pub-id-type="pmid">27864013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Muyas F, Sauer CM, Valle-Inclán JE, Li R, Rahbari R, Mitchell TJ, et al. De novo detection of somatic mutations in high-throughput single-cell profiling data sets. Nat Biotechnol. 2023. Available from: 10.1038/s41587-023-01863-z.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Med</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Med</journal-id>
    <journal-title-group>
      <journal-title>Genome Medicine</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-994X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10726641</article-id>
    <article-id pub-id-type="pmid">38111063</article-id>
    <article-id pub-id-type="publisher-id">1269</article-id>
    <article-id pub-id-type="doi">10.1186/s13073-023-01269-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>De novo identification of expressed cancer somatic mutations from single-cell RNA sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Tianyun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jia</surname>
          <given-names>Hanying</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Song</surname>
          <given-names>Tairan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lv</surname>
          <given-names>Lin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gulhan</surname>
          <given-names>Doga C.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Haishuai</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Guo</surname>
          <given-names>Wei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xi</surname>
          <given-names>Ruibin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Guo</surname>
          <given-names>Hongshan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4709-3374</contrib-id>
        <name>
          <surname>Shen</surname>
          <given-names>Ning</given-names>
        </name>
        <address>
          <email>shenningzju@zju.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.13402.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 700X</institution-id><institution>Department of Hepatobiliary and Pancreatic Surgery of the First Affiliated Hospital &amp; Liangzhu Laboratory, </institution><institution>Zhejiang University School of Medicine, </institution></institution-wrap>Hangzhou, 311121 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05m1p5x56</institution-id><institution-id institution-id-type="GRID">grid.452661.2</institution-id><institution-id institution-id-type="ISNI">0000 0004 1803 6319</institution-id><institution>Kidney Disease Center, </institution><institution>the First Affiliated Hospital, Zhejiang University School of Medicine, </institution></institution-wrap>Zhejiang, 311121 China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution>Department of Biomedical Informatics, </institution><institution>Harvard Medical School, </institution></institution-wrap>Boston, MA 02115 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00a2xv884</institution-id><institution-id institution-id-type="GRID">grid.13402.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 700X</institution-id><institution>College of Computer Science, </institution><institution>Zhejiang University, </institution></institution-wrap>Hangzhou, 311121 Zhejiang China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.512487.d</institution-id><institution>Zhejiang University-University of Edinburgh Institute, School of Medicine, Zhejiang University, </institution></institution-wrap>Jiaxing, 314400 China </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02v51f717</institution-id><institution-id institution-id-type="GRID">grid.11135.37</institution-id><institution-id institution-id-type="ISNI">0000 0001 2256 9319</institution-id><institution>School of Mathematical Sciences and Center for Statistical Science, </institution><institution>Peking University, </institution></institution-wrap>5 Yiheyuan Road, Beijing, 100871 China </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05m1p5x56</institution-id><institution-id institution-id-type="GRID">grid.452661.2</institution-id><institution-id institution-id-type="ISNI">0000 0004 1803 6319</institution-id><institution>Bone Marrow Transplantation Center, The First Affiliated Hospital, Zhejiang University School of Medicine, </institution></institution-wrap>Hangzhou, 310003 Zhejiang China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>15</volume>
    <elocation-id>115</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>12</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023, corrected publication 2024</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Identifying expressed somatic mutations from single-cell RNA sequencing data de novo is challenging but highly valuable. We propose RESA – Recurrently Expressed SNV Analysis, a computational framework to identify expressed somatic mutations from scRNA-seq data. RESA achieves an average precision of 0.77 on three in silico spike-in datasets. In extensive benchmarking against existing methods using 19 datasets, RESA consistently outperforms them. Furthermore, we applied RESA to analyze intratumor mutational heterogeneity in a melanoma drug resistance dataset. By enabling high precision detection of expressed somatic mutations, RESA substantially enhances the reliability of mutational analysis in scRNA-seq. RESA is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ShenLab-Genomics/RESA">https://github.com/ShenLab-Genomics/RESA</ext-link>.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13073-023-01269-1.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Somatic mutations</kwd>
      <kwd>Single-cell RNA sequencing data</kwd>
      <kwd>Recurrently Expressed SNV Analysis</kwd>
      <kwd>High precision</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Leading Innovative and Entrepreneur Team Introduction Program of Zhejiang (CN)</institution>
        </funding-source>
        <award-id>2021R01012</award-id>
        <principal-award-recipient>
          <name>
            <surname>Shen</surname>
            <given-names>Ning</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Zhejiang University Starting Fund</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par15">Somatic mutations are accumulated during cell generations and can transform normal cells into cancer, promote tumor progression, and develop drug resistance. Genetic heterogeneity together with transcriptional heterogeneity are two key aspects that contribute to cancer evolution and drug resistance. Recent studies have attempted to identify somatic mutations, single nucleotide variants (SNVs) in particular, by associating them with transcriptional variations in cancer bulk RNA-seq data [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. However, it remains challenging to connect transcriptional heterogeneity to genetic heterogeneity at the single-cell level. Therefore, identifying somatic mutations carried by RNA at the single-cell level is highly valuable.</p>
    <p id="Par16">Experimental technologies, such as targeted genotyping coupled with scRNA-seq, have been developed to enable the study of expressional and somatic variations together at single-cell level [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref>]. However, the single cells have limited amounts of biological materials, a small number of detectable mutations, and a low signal-to-noise ratio have restricted their application. As a result, computational methods are sought-after to identify expressed somatic mutations from scRNA-seq data. Profiling of scRNA-seq coupled with bulk genotyping, e.g. whole exome sequencing (WES), whole genome sequencing (WGS), and single cell genotyping of selected mutations, of the same sample have been applied to study intratumor heterogeneity and lineage tracing [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]. Although such data can effectively minimize false positives, their design requires thoughtful consideration and can only characterize a limited number of mutations, thus they were not widely adopted.</p>
    <p id="Par17">Computational methods that identify expressed somatic mutations directly from scRNA-seq data de novo are highly desirable, as such methods not only provide orthogonal insights into the intratumor heterogeneity but also face fewer experimental challenges. Most mutational analysis of scRNA-seq use data generated from scRNA-seq technologies with full length library prep, e.g. SMART-seq2 [<xref ref-type="bibr" rid="CR11">11</xref>], for its higher coverage in the gene body compared to the 10X genomics and Drop-seq approach. De novo somatic mutation calling and follow-up analysis have been applied to various biological questions including aging in the human pancreas, Alzheimer’s disease, glioblastoma, lung cancer, etc. [<xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR15">15</xref>]. Methods reported in these studies employ standard variant calling steps that involve quality-based filtering such as sequencing quality or stratification from a curated whitelist of known cancer mutations, following the standard variant calling steps. However, these methods were originally designed for bulk RNA-seq data and their reliability for single-cell RNA-seq data still requires further evaluation [<xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR19">19</xref>].</p>
    <p id="Par18">In this study, we developed a computational framework named Recurrently Expressed SNV Analysis (RESA) that can detect expressed somatic SNVs with high precision directly from scRNA-seq data. RESA is composed of a specific filtering workflow tailored for scRNA-seq data, especially the recurrence of expressed SNVs across cells. Additionally, we introduced a joint logistic regression (RESA-jLR) model that expands the pool of somatic variants by leveraging information from earlier steps. To evaluate the performance of RESA and RESA-jLR, we conducted in silico spike-in experiments using over 800 cells from the human pancreas. Furthermore, we benchmarked RESA and RESA-jLR using real scRNA-seq datasets with matched WES data from 15 cancer cell lines and 4 tumor PDX tissues. RESA is specifically designed for high precision detection of somatic mutations while minimizing noise and artefacts from experimental procedures, so that users can be confident with the reliability of the results (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). Thus, the applications of RESA and RESA-jLR may provide a reliable and integrative view to study intratumor heterogeneity and drug resistance.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>WES and scRNA-seq datasets of cancer cell lines</title>
      <p id="Par19">The exonic somatic mutations for all cancer cell lines tested in this study were processed by the CCLE project and downloaded from CCLE_20Q1_mutations [<xref ref-type="bibr" rid="CR20">20</xref>]. The scRNA-seq for cancer cell lines were downloaded from GSE105451, GSE76312, GSE99795, GSE150993, GSE108383, GSE140440, and GSE69405 respectively.</p>
      <p id="Par20">Specifically, scRNA-seq for JURKAT, SET2 (GSE105451), and K562 (GSE76312) was done using the SMART-seq + and TARGET-seq technologies [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. All other cell lines were done with the Smart-seq2 protocol. LNCaP (GSE99795) was treated with double thymidine for 12 h (hr) to synchronize the population cell cycle, then single cells were collected at 0 h without drug treatment, and 12 h with and without drug treatment [<xref ref-type="bibr" rid="CR21">21</xref>]. HCT116 (GSE150993) live cells and methanol-fixed cells were processed and sequenced respectively [<xref ref-type="bibr" rid="CR22">22</xref>]. Yu-jui Ho et al. sequenced A375 (GSE108383) with and without BRAF inhibitor [<xref ref-type="bibr" rid="CR23">23</xref>]. Similarly, Patricia M Schnepp et al. divided their cells into docetaxel-sensitive and -resistant groups of DU145 (GSE140440) [<xref ref-type="bibr" rid="CR24">24</xref>]. Finally, we analyzed both the cancer cell line NCI-H358 data (GSE69405) and lung adenocarcinoma (LUAD) PDX tumor data from Kyu-Tae Kim et al. [<xref ref-type="bibr" rid="CR25">25</xref>].</p>
      <p id="Par21">Besides, we evaluated the consistency between two experimental replicates of these cell lines after applying RESA-jLR in all applicable cases. We counted the number of detected mutations in each replicate and computed the fold change between the number of detected mutations in replicate 1 and the number of detected mutations in replicate 2. If the result is close to 1, it means the number of detected mutations between two replicates is similar. The consistency shows that our method has stable performance in datasets under similar conditions.</p>
    </sec>
    <sec id="Sec4">
      <title>RESA workflow</title>
      <p id="Par22">RESA comprises three main steps: initial variant calling, filtering and labeling, and modeling and refinement [<xref ref-type="bibr" rid="CR26">26</xref>]. The first step of RESA is to align the sequencing reads to the genome and run through basic mutation calling algorithms with RNA-seq specific parameter settings (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). To minimize aligner and variant caller biases, two independent alignments and two basic variant callers were employed. Next, we run through a series of processing, filtering, and most importantly, cross-cell recurrence counting. In this step, the variants are grouped into 3 categories: 1) a high-confidence set of SNVs that are either putative somatic SNVs or artefacts; 2) a set of filtered-out variants; and 3) a set of undefined SNVs for further refinement (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). The high-confidence set of putative positive somatic variants were labeled as RESA-identified somatic mutations.<fig id="Fig1"><label>Fig. 1</label><caption><p>RESA workflow. <bold>a</bold> Step1 is an initial variant call using two aligners and two mutation calling algorithms. <bold>b</bold> RESA: Variants calling then goes through a series of filtering and labeling, categorizing into a confident set of positive somatic variants and artefacts, and a set of unsure SNVs to refine. <bold>c</bold> RESA-jLR: The confident set of variants is used to build a joint logistic regression model, where the model is applied to make predictions in the unsure set of SNVs to refine and expand the final positive set of somatic SNVs. <bold>d</bold> the detailed workflow of RESA</p></caption><graphic xlink:href="13073_2023_1269_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par23">Denoting RESA identified mutations as “positive” and the putative biases and artefacts variants as “negative”, RESA randomly splits the data into training and test sets. We developed a joint logistic regression classifier that models both quality and sequence-related features independently (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). The joint logistic regression classifier was then applied to make predictions on the set of undefined SNVs. The final set of somatic SNVs identified by RESA-jLR is a combination of positive SNVs from the high-confidence set and predicted positive SNVs from the undefined set using the joint logistic regression model.</p>
    </sec>
    <sec id="Sec5">
      <title>Initial read mapping and variant calling</title>
      <p id="Par24">To reduce the bias in aligners and variant callers, we employed two independent alignment and variant calling methods for each cell's fastq file in the scRNA-seq analysis. The first method consisted of aligning the reads using the widely adopted STAR aligner [<xref ref-type="bibr" rid="CR27">27</xref>], a highly effective read aligner, in a two-pass mode to improve alignment accuracy. Then processing the aligned reads based on recommendations from GATK (gatk/4.0.0.0) [<xref ref-type="bibr" rid="CR28">28</xref>] involving steps such as removing duplicates and recalibrating base quality scores and calling variants using GATK (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). The second method involved aligning the reads using the Minimap2 aligner [<xref ref-type="bibr" rid="CR29">29</xref>], followed by RNA variant calling settings from Strelka [<xref ref-type="bibr" rid="CR30">30</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). Only variants marked as passing the default filtering set by the Strelka algorithm were retained for this method. Therefore, we obtained two sets of candidate variants per cell that were detected by these two pipelines. Our primary reference for downstream analysis was the STAR-GATK procedure which is a widely used combination of read alignment and variant calling pipelines, as we found that the GATK process can aid in identifying and correcting noise and artefacts in the data. The outputs from the STAR-GATK procedure included information that was utilized in subsequent steps.</p>
    </sec>
    <sec id="Sec6">
      <title>RESA</title>
      <p id="Par25">We then annotated and filtered variants from the STAR-GATK pipeline similar to the CTAT-Mutations Pipeline which is designed to detect variants from bulk RNA sequencing data [<xref ref-type="bibr" rid="CR31">31</xref>]. We first annotated the variant location using ANNOVAR and kept only SNVs located in the exonic region for downstream filtering and labeling. Then SNVs that overlapped with RNA editing databases were removed for potential RNA editing events (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). After that, we filtered germline variants generated from matched normal if available, or from population SNP databases such as the genome Aggregation Database(gnomAD) 3.0. Hence, the primary filtered candidate variants from the original STAR-GATK pipeline were kept for further procession.</p>
      <p id="Par26">Next, we checked the concordance between the filtered STAR-GATK pipeline and the second pipeline using RESA. Variants identified by both pipelines were considered for candidate variant set A which represented the intersection of results from these two pipelines, while the variants of the filtered STAR-GATK pipeline which were the elements of the second pipeline were considered for candidate set B. RESA further processed the variant calling outputs by setting additional requirements on read quality, variant quality, strand bias, and variant positional bias. The common variants from the above-mentioned procedures were required to have a minimum read depth of 3 or user-specified site-specific depth.</p>
      <p id="Par27">Importantly, the resulting filtered SNVs for variant set A were stricter or at least comparable to quality-based filtering approaches used in other studies, such as the Quality-filter approach [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR16">16</xref>] referred to as Enge, 2017, for performance comparison.</p>
      <p id="Par28">RESA assumes that cancer cells evolve in a clonal manner and thus expressed somatic mutations have cross-cell recurrence, whereas the noise and artefacts are likely distributed randomly with a small probability of recurrence across the cell population (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). Based on this assumption, RESA set a cross-cell recurrence filter on a pseudo-bulk basis by keeping only SNVs that were detected in at least X number of cells to filter out artefacts, where X (X &gt;  = 3) by default is no less than 10% of the total cell number and can be adjusted by users (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d), which removed background sequencing errors and artefacts from candidate somatic SNVs. This criterion was intended to filter the false positive somatic mutations because we assume that the true positive somatic mutations should at least express a certain number of cells, but it may also remove true positive somatic mutations that are only expressed in very few cells (less than 10%). Furthermore, mutations detected in more than 80% of the total cell number were considered to be germline polymorphisms or artefacts as well. The key assumption is that compared with somatic mutations, germline variants should be detected in most cells at the RNA level.</p>
      <p id="Par29">The upper and lower limit number of cross-cell recurrence were used as parameters in the software and could be adjusted in a user-specified manner. The filtered SNVs from set A were considered putative true somatic variants. Thus, RESA built a putative “true positive” set of somatic variants directly from scRNA-seq data based on cross-cell recurrence and quality-based filtering.</p>
      <p id="Par30">RESA applied several criteria to enable filtering of putative germline mutations: 1) germline variants that were generated from the matched normal data, if available and specified in user input; 2) putative germline variants identified from population SNP databases such as gnomAD 3.0.; 3) putative germline variants with high detection recurrence in the tested cell population.</p>
      <p id="Par31">To build a high-confidence set of noise and artefact SNVs, RESA selected SNVs from set B that failed the above-mentioned criteria, such that putative noise and artefacts had the following properties:1) SNVs did not pass the quality-based filtering as described above, and 2) SNVs did not show any cross-cell recurrence. The remaining SNVs in set B pass the above-mentioned criteria and SNVs in set A failed the criteria were defined as the unsure set, which was subjected to RESA-jLR described below. We applied this selection criteria for each single cell and found very few SNVs overlapping between the positive and negative sets after merging SNVs across the cell population, suggesting a decent separation between our putative positive and negative sets.</p>
    </sec>
    <sec id="Sec7">
      <title>RESA-jLR</title>
      <p id="Par32">RESA employs a process of combining all putative positive and negative sets of somatic SNVs. The input variants to feed RESA-jLR combined all variants in positive and negative sets. Then the input dataset was split into training and test sets with the 3:1 ratio, with 3 quarters of the data used for training the model, and a quarter of the data used as an independent test set to evaluate the model performance. Because the sample size for each class on the training set was often imbalanced, thus, random oversampling was applied to replicate observations in minority classes, thereby rebalancing the dataset. RESA with the joint logistic regression model was the joint composition of two logistic regression models. One model depended on quality-based features such as variant quality, read depth, variant allele fraction, normalized probabilities of genotype, and allele depth. The other model derived its features from sequence-based attributes like mutation types, sequence contexts, and mutation signature components. Quality-based features were generally weighted similarly across datasets, while mutation sequence composition can be more sample-specific; hence, they were modeled differently. We trained the joint logistic regression model using the liblinear library, with L1 regularization applied to the quality-based model and L2 regularization applied to the sequence-based model using one-hot encoding. Each logistic regression model returned probability values for positive and negative classifications, with users being able to specify their thresholds based on these probabilities. Then we combined these two models into an integrated classifier with the following equation:<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left({pos}_{classifier}\right)=\frac{1}{2}{\sum }_{P\in ({P}_{seq}, { P}_{pos})}wP,$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="italic">pos</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">classifier</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">seq</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">pos</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mi>w</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13073_2023_1269_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>Where <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w=\left\{\begin{array}{c}1, if \,P \ge 0.5\\ 0, otherwise\end{array}\right.$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mo>≥</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1269_Article_IEq1.gif"/></alternatives></inline-formula>, <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{seq}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">seq</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1269_Article_IEq2.gif"/></alternatives></inline-formula> and <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{pos}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="italic">pos</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13073_2023_1269_Article_IEq3.gif"/></alternatives></inline-formula> were probabilities to be the positive class of the two regression models. RESA-jLR sets 0.5 as the default threshold, which meant RESA-jLR defined the SNVs as positive if <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left({pos}_{classifier}\right) \ge 0.5$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:mi mathvariant="italic">pos</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">classifier</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>≥</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13073_2023_1269_Article_IEq4.gif"/></alternatives></inline-formula>. We also included probability as a parameter so that users could modify the thresholds.</p>
      <p id="Par33">After training, we assess the model's performance on the test set using the AUC score. As opposed to accuracy, the AUC score is appropriate for imbalanced datasets. Additionally, we applied the model to the candidate SNVs in the unsure set to refine and extrapolate the putative somatic variant set. This step recovered some true somatic variants filtered out in stringent criteria described earlier and enhanced sensitivity while maintaining high precision.</p>
    </sec>
    <sec id="Sec8">
      <title>Somatic mutation detection by other methods</title>
      <p id="Par34">We conducted a performance evaluation of RESA and RESA-jLR by comparing them to five previously published methods, including Enge 2017, Maynard 2020, BCFtools, VarScan, and Hovestadt 2019. We applied similar filtering criteria and parameters for somatic mutation filtering across all methods.</p>
      <p id="Par35">Somatic mutations were filtered by similar quality criteria which have been adopted in Enge 2017 [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. Specifically, we aligned sequencing data to the hg38 human reference using STAR and called alignment BAM files for different cell lines using GATK HaplotypeCaller. We then filtered out potential artefacts using VariantFilter (-cluster 3; -window 35; -filter QD &lt; 2.0; -filter FS &gt; 30.0). Finally, we employed the GATK variant quality score recalibration pipeline to filter the variation calls and exclude known germline variants.</p>
      <p id="Par36">Moreover, we utilized concord whitelist-based mutation selection which has been adopted in the Maynard 2020 with similar filtering criteria [<xref ref-type="bibr" rid="CR15">15</xref>]. Reads were aligned using STAR aligner, processed as suggested by GATK pipeline (gatk 4.0.0.0). Variants were called by GATK HaplotypeCaller (this process is adopted as part of the STAR-GATK Pipeline) [<xref ref-type="bibr" rid="CR30">30</xref>]. Next, we filtered out variants using the following criteria: 1) variants are located in exonic region; 2) variants have pathogenic effect as predicted by FATHMM; 3) variants have minimum total read depth of 3; 4) variants have been curated in COSMIC database [<xref ref-type="bibr" rid="CR32">32</xref>] in the same tissue type as sample tested. Besides, we also applied the STAR-GATK Pipeline [<xref ref-type="bibr" rid="CR28">28</xref>] from raw sequencing data detecting variants.</p>
      <p id="Par37">BCFtools [<xref ref-type="bibr" rid="CR33">33</xref>] (BCFtools 1.9) and VarScan (Varscan v2.4.4) [<xref ref-type="bibr" rid="CR34">34</xref>] were evaluated for their performances of detecting mutations across scRNA-seq data [<xref ref-type="bibr" rid="CR16">16</xref>]. We aligned reads to hg38 human reference using the BWA-MEM (BWA 0.7.17) and then used the GATK-PICARD pipeline to preprocess the BAM file. For better comparison, we chose the default parameters of these toolkits.</p>
      <p id="Par38">Besides, we created another recurrence-based method based on recurrence rates by following filtering criteria in the Hovestadt 2019 [<xref ref-type="bibr" rid="CR10">10</xref>]. We quantified variants at the genomic position using SAMtools mpileup for preprocessed BAM files in scRNA-seq data and then filtered out variants detected in fewer than three cells or not detected in the genome sequencing data.</p>
    </sec>
    <sec id="Sec9">
      <title>Somatic mutation detection using RESA in in silico spiked-in dataset</title>
      <p id="Par39">In order to further assess the effectiveness of RESA on human tissue datasets, we conducted a test using in silico spiked-in datasets. We hypothesized that scRNA-seq data from healthy juveniles would not contain somatic mutations, with the variants detected more likely to be germline mutations or artefacts resulting from sequencing. To assess the ability to detect somatic mutations in human tissue RNA datasets, we added somatic mutations from 10 distinct cell lines. The inclusion of various types of somatic mutations from different cell lines allowed for the evaluation of the generalization of RESA, as it was exposed to diverse mutation spectrums. And in this experiment, our focus was on the ability to detect add-on somatic mutations to avoid the potential impact on model performance that could arise from using ground truth data filtered by different criteria.</p>
      <p id="Par40">To avoid the subjective factors and controllable preferences, we used an independent tool – BAMSurgeon, a tool that can introduce somatic mutations to BAM files, to generate simulation data [<xref ref-type="bibr" rid="CR35">35</xref>]. To add mutations, we collected three independent real scRNA-seq data of pancreatic epithelial cells from healthy juveniles with SMART-seq2 technology, aged 1 month, 5 years, and 6 years [<xref ref-type="bibr" rid="CR12">12</xref>]. We aligned the raw reads from real scRNA-seq data to GRCh38 (GRCh38.p12) using BWA-MEM 0.7.17 with default parameters to create the original BAM files.</p>
      <p id="Par41">To spike SNV mutations into each scRNA-seq dataset, we used ten cancer cell lines with varying numbers of mutations from CCLE [<xref ref-type="bibr" rid="CR20">20</xref>] as the 'truth' VCF files that contained variant position information and variant allele fraction (VAF). The VAF of SNVs was determined by WES. If the VAF was missing, we replaced the VAF with 0.5. We used addsnv.py with the following relevant settings to spike SNVs in the original BAM files of cells: –mindepth 2 –minmutreads 1 –aligner mem. We then converted the 'burned-in' BAMs to in silico 'spiked-in' FASTQ files using GATK 4.2.3.0 SamToFastq. We identified 'spike-in' SNVs from each cell and reintroduced simulated SNVs to 50% of VCF files generated by the STAR-GATK procedure. Once algorithmic biases were introduced into the cells, we proceeded to analyze the 'spike-in' data using RESA and five other algorithms—Enge 2017 [<xref ref-type="bibr" rid="CR12">12</xref>], Maynard 2020 [<xref ref-type="bibr" rid="CR15">15</xref>], Hovestadt 2019 [<xref ref-type="bibr" rid="CR10">10</xref>], BCFtools [<xref ref-type="bibr" rid="CR16">16</xref>], and VarScan [<xref ref-type="bibr" rid="CR16">16</xref>].</p>
    </sec>
    <sec id="Sec10">
      <title>Method evaluation</title>
      <p id="Par42">To evaluate the performance of different methods, we gathered somatic mutations identified by various methods as mentioned above. We defined WES-identified somatic mutations that were carried in the tested scRNA-seq dataset as the ground truth. In this context, false positives are "false" somatic mutations including germline variants, RNA editing sites, noise, and artefact mutations in scRNA-seq data that are labeled as somatic mutations by RESA. Meanwhile, false negatives refer to true somatic mutations in scRNA-seq that are mislabeled by RESA as "false".</p>
      <p id="Par43">Precision, sensitivity, and F0.5 score were utilized to assess the performance of RESA across datasets. Precision evaluates the proportion of true positives among all the predicted positives, while sensitivity measures the proportion of true positives among all the ground truth positives. The F0.5 score is a commonly used adjusted F-score that assigns greater weight to precision than to sensitivity, given that precision is of greater importance in our algorithm. The F0.5 score satisfies the following equation:<disp-formula id="Equb"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_{0\cdot5}=1.25\cdot\frac{\left(precision\,sensitivity\right)}{0.25\,precision+sensitivity}$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>·</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1.25</mml:mn><mml:mo>·</mml:mo><mml:mfrac><mml:mfenced close=")" open="("><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.166667em"/><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi></mml:mfenced><mml:mrow><mml:mn>0.25</mml:mn><mml:mspace width="0.166667em"/><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1269_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par44">As we developed RESA, our strategy prioritized precision over sensitivity to instill greater confidence. This means our focus was on detecting true somatic mutations while minimizing the impact of artefacts. Even in situations where there is no matched normal WES/WGS data available for comparison, our strategy could still accurately predict somatic mutations.</p>
      <p id="Par45">To show the consistency between replicate experiments, we have presented it by using the overlap coefficient. It is defined as the size of the intersection divided by the smaller of the size in these two datasets.<disp-formula id="Equc"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$overlap \left(X,Y\right)=\frac{\left|X\cap Y\right|}{{\text{min}}\left(\left|X\right|,\left|Y\right|\right)}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:mi>X</mml:mi><mml:mo>∩</mml:mo><mml:mi>Y</mml:mi></mml:mfenced><mml:mrow><mml:mtext>min</mml:mtext><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:mi>X</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced close="|" open="|"><mml:mi>Y</mml:mi></mml:mfenced></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13073_2023_1269_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec11">
      <title>Analyzing primary tumor data</title>
      <p id="Par46">Kyu-Tae Kim used scRNA-seq by SMART-seq and whole-exome sequencing (WES) to examine intratumor heterogeneity in lung adenocarcinoma tumors (GSE69405). A 60-year-old male patient had a treatment-naïve lung cancer tumor, which was surgically excised and inoculated into immunocompromised mice to generate patient-derived xenograft (PDX) tumors. A sample of PDX tumor containing 34 single cells and an additional sample with 43 cells as a biological replicate were sequenced. WES analysis was also done on the patient's blood to obtain the matched normal data and filter out germline mutations.</p>
      <p id="Par47">The raw reads for melanoma scRNA-seq used for mutation identification were obtained from GSE116237 [<xref ref-type="bibr" rid="CR36">36</xref>]. The matched WES data for the PDX sample with two replicates were downloaded from EGAD0000179 [<xref ref-type="bibr" rid="CR37">37</xref>]. Four time points (T0, phase 1, phase 2, and phase 3) were included in the scRNA-seq dataset, but only T0 and phase 3 had matched WES data. To assess the performance of our method using matched WES data, we utilized RESA and RESA-jLR separately on these two time points.</p>
      <p id="Par48">Somatic mutation calling from WES data was carried out similarly to the CCLE project, including aligning WES reads to the GRACh38 reference genome using BWA-MEM 0.7.17, marking duplication with Picard, and avoiding systematic errors by Base Quality Score Recalibration with variant sites identified from the 1000 Genomes Project, dbSNP138, and Mills and 1000G gold standard indels. HaplotyCaller was used to call SNVs for the PDX tumor sample that contained matched normal data such as patient blood WES. The model of scoring variant quality for filtering was developed by VariantRecalibrator and ApplyVQSR under default parameters.</p>
    </sec>
    <sec id="Sec12">
      <title>Re-analyzing melanoma scRNA-seq expression matrix</title>
      <p id="Par49">The gene expression read count table after processing melanoma PDX data for all cells was obtained from GSE116237. The Seurat package was employed for expression analysis, and read counts were log normalized. The top 2000 variably-expressed genes were selected for dimension reduction using PCA. The K-nearest neighbor (KNN) graph was clustered and refined using the Louvain algorithm based on the top 30 transformed PCs from PCA. UMAP was used with a dimension of 20 and applied to the top 30 PCs for data exploration and visualization.</p>
    </sec>
    <sec id="Sec13">
      <title>Analyzing stage-specific somatic mutations</title>
      <p id="Par50">To enhance the sensitivity of our methods, we utilized RESA and RESA-jLR on the melanoma scRNA dataset across four time points. We then assessed stage-specific enrichment by calculating the <italic>p</italic>-value based on the cumulative distribution function of the hypergeometric distribution. We aimed to determine whether the number of cells with a mutant gene was overrepresented in one stage compared to the other stages. For each candidate gene containing a somatic mutation, we counted the number of mutation-carrying cells in each tumor stage and computed the p-value to identify the enrichment at each stage. If a gene passed the defined threshold p-value of 0.05 at a specific stage, we labeled it as enriched at that stage. This indicates that the distribution of the number of mutation-carrying cells is non-uniform and significantly enriched at the specific stage compared to the other stages [<xref ref-type="bibr" rid="CR38">38</xref>].</p>
    </sec>
    <sec id="Sec14">
      <title>Custom analysis and plots</title>
      <p id="Par51">Mutation Signature plots were done using SigProfilerPloting. UMAP plots were done using the Seurat package in R. Other custom plots were done using the Seaborn package in Python and the ggplot2 package in R.</p>
    </sec>
  </sec>
  <sec id="Sec15">
    <title>Results</title>
    <sec id="Sec16">
      <title>Challenges of detecting expressed SNVs in scRNA-seq data</title>
      <p id="Par52">De novo identification of somatic SNVs from scRNA-seq data is challenging due to the sparsity and noisiness of the data. Several factors, including allelic expression, expression abundance of mutant-containing genes, sequencing coverage per cell, variant allele frequency (VAF), and clonality, may contribute to the sparsity of the detectable mutations. To understand various factors that may influence the detectability of somatic mutations in scRNA-seq data, we gathered WES, bulk RNA-seq (bRNA-seq), and scRNA-seq datasets for the melanoma cell line A375. For example, the site for the <italic>BRAF</italic> V600E driver mutation has high coverage (referred to as site-specific depth hereafter) in both WES and bRNA-seq data, whereas only three out of five selected single cells have detectable site-specific depth (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). As indicated by this example, allelic expression as well as sequencing coverage might contribute to the sparsity of somatic mutations detectable from scRNA-seq data, which is also known as the effect of “allelic dropout”. Next, we analyzed scRNA-seq of all A375 cells and observed a significant correlation between sequencing coverage and expressed somatic mutations per cell (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). Concordantly, both site-specific depth and the gene expression levels correlate positively with the number of detectable somatic mutations (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). In addition, scRNA-seq VAF correlates positively with VAF from both bRNA-seq (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d) and WES (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3). Collectively, these results suggest that the detection of somatic mutations in scRNA-seq is jointly shaped by the mutation burden, sequencing coverage of the cell, as well as the sequencing depth and expression level of the mutant allele.<fig id="Fig2"><label>Fig. 2</label><caption><p>Detecting expressed somatic mutations in the A375 cell line and pancreas tissue datasets. <bold>a</bold> Integrative Genomics Viewer (IGV) window shows the hotspot mutation <italic>BRAF</italic> V600E in the A375 cell line. <bold>b</bold> The scatter plot of the percentage of exonic SNVs validated in scRNA-seq against the million reads per cell. <bold>c</bold> The scatter plot shows the expression level against the number of expressed somatic mutations in each gene. <bold>d</bold>, <bold>e</bold>, The bar plot illustrates the distribution of VAF of expressed somatic mutations in scRNA-seq compared with corresponding VAF in bRNA-seq (<bold>d</bold>) and in WES (<bold>e</bold>). <bold>f</bold> The percentage of accumulated expressed SNVs validated in scRNA-seq. <bold>g</bold> The density plot shows the distribution of detected SNVs of each cell after passing the standard variant calling pipeline in the A375 cell line datasets with two conditions</p></caption><graphic xlink:href="13073_2023_1269_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par53">The sparsity of detectable somatic mutations in scRNA-seq data can be alleviated by sequencing a large number of cells (Fig. <xref rid="Fig2" ref-type="fig">2</xref>f). However, de novo identification of expressed somatic mutations following standard variant calling pipelines results in tremendous amounts of noise in the data (Fig. <xref rid="Fig2" ref-type="fig">2</xref>g). One possible explanation for the noise is that currently used mutation calling algorithms failed to take into account the noise and artefact SNVs generated during the experimental procedure. Consistently, a recent study evaluated the performance of several mutations calling algorithms on scRNA-seq data using simulated scRNA-seq reads, and demonstrated that most of the algorithms tested showed satisfying performance with FDR &lt; 0.05 [<xref ref-type="bibr" rid="CR16">16</xref>], suggesting that noise and artefacts carried by the sequencing read can be picked up equally well with actual mutations of the cell. This aligns with our knowledge that the experimental procedures of scRNA-seq, including cell lysis, cDNA conversion, library preparation, etc., may result in arteficial variants that far exceed the number of true variants (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4). Subsequently, the direct application of such mutation calling algorithms on real scRNA-seq data may mislead biological interpretations of the data. Therefore, computational methods that can effectively filter out such experimental noise and artefacts are essential for de novo identification of somatic mutations in scRNA-seq data.</p>
    </sec>
    <sec id="Sec17">
      <title>The computational principle of RESA to identify somatic SNVs from scRNA-seq</title>
      <p id="Par54">We present a computational framework RESA – Recurrently Expressed SNV Analysis, which detects expressed somatic mutations with high precision directly from scRNA-seq data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a-d). We focused on scRNA-seq technologies that capture full length transcripts and single nucleotide variants (SNVs) for somatic mutation analysis. RESA effectively eliminates noise and artefact variants in the scRNA-seq data by applying a series of filtering steps, including cross-cell recurrence. For instance, with the standard variant calling process, about 0.5–0.8 million SNVs were identified in cancer cell lines A375 and HCT116, where numerous noises and artefacts dominate the pool (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5). We found that different variant callers followed with basic filtering barely helped. On the contrary, applying RESA effectively removed the majority of noises and artefacts, and achieved about 75% of true somatic SNVs out of the total SNVs identified by the algorithm (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5c, d). In addition, we developed a joint logistic regression approach following RESA, i.e., RESA-jLR, to filter out noise and artefacts while increasing sensitivity by identifying positive cases from an unsure set of variants. Notably, applying RESA-jLR identified additional somatic SNVs while keeping the proportion of noise and artefacts small (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5).</p>
      <p id="Par55">We validated that RESA-identified somatic mutations maintained a positive VAF correlation between scRNA-seq and WES, as well as scRNA-seq and bRNA-seq across multiple cell lines (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6a, b). In particular, although germline variants are thought to share similar quality properties as somatic mutations, we adopted several approaches to help eliminate germline variants in different circumstances.</p>
      <p id="Par56">We applied RESA-jLR to full-length scRNA-seq data from 15 datasets encompassing 8 cancer cell lines, which were generated by different research groups, employed different experimental protocols, and operated under different experimental conditions (<xref rid="Sec2" ref-type="sec">Methods</xref>, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1). To assess the accuracy of the joint logistic regression model, we evaluated its performance in the independently held-out test sets. The model achieved an AUC ranging from 0.79 to 0.98, with an average AUC of 0.89 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7), suggesting the joint logistic regression model was highly effective. Furthermore, we observed high agreement among most datasets when comparing the feature weights of quality-related features in the quality-based logistic regression. This indicates that the effect of quality-related features on mutation detection could be generalizable (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8a). In contrast, we found that feature weights of sequence-related features were cell type-specific, with high correlation observed only among different experimental conditions of the same cell line (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8b). This demonstrated the adaptable nature of RESA-jLR to specific cell types and the robustness of RESA-jLR across experimental conditions.</p>
    </sec>
    <sec id="Sec18">
      <title>RESA maintains high precision in in silico spike-in scRNA-seq datasets of human tissue</title>
      <p id="Par57">To comprehensively benchmark RESA against other methods in human tissue scRNA-seq data under diverse scenarios, we designed an in silico spike-in experiment (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). Briefly, we collected SMART-seq2 data generated from pancreas tissues of three donors as three baseline datasets, namely 4-month-old (221 cells), 5-year-old (331 cells), and 6-year-old (178 cells), respectively [<xref ref-type="bibr" rid="CR12">12</xref>]. We considered the datasets from these donors to carry predominantly noise and artefacts and expected minimal true somatic mutations as they were generated in body cells after birth. We then collected a total of 77,088 somatic mutations from CCLE WES data of 10 cancer cell lines with varying cancer types and mutation burdens. For each cancer cell line and each baseline dataset, we “spiked-in” somatic SNVs in silico using BAMSurgeon [<xref ref-type="bibr" rid="CR35">35</xref>], followed by performing RESA or other methods to detect somatic mutations. To analyze the effect of coverage per cell and cell number on algorithm performance, we sorted the single cells in decreasing coverage and tested algorithms’ performance on different subsets of the cell population (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, <xref rid="Sec2" ref-type="sec">Methods</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><p>Benchmark RESA to other methods in the in silico spike-in scRNA-seq datasets. <bold>a</bold> Workflow for in silico spike-in. scRNA-seq raw reads of pancreas tissues from 3 healthy juveniles using SMART-seq2 technology in Enge et al. 2017 [<xref ref-type="bibr" rid="CR12">12</xref>] were collected as original BAM files. Somatic SNVs of 10 cancer cell lines covering 5 tissues of origin were identified from WES data. Bamsurgeon spiked cancer cell line somatic SNVs into the original BAM files to produce ‘Burn-in’ BAM files. In silico spike-in scRNA-seq datasets were ordered by the coverage of each cell, split into several subsets, and followed by further evaluations. b, The violin plot illustrates the distribution of coverage in each subset. The error bars display the average and standard deviation of the precision of RESA, RESA-jLR, and the other 5 previously published algorithms. If the minimum value of the error bar is less than 0, 0 is shown. Top: a 4-month-old infant (Blue). Middle: a 5-year-old child (Purple). Bottom: a 6-year-old child (Green). <bold>c</bold> The scatter plot shows precisions and sensitivities in different subsets of 10 cell lines. Points in red are the results of RESA, and points in blue are the results of RESA-jLR. Top: a 4-month-old infant. Middle: 5-year-old child. Bottom: a 6-year-old child. <bold>d</bold> F0.5 score in in silico spike-in scRNA-seq datasets (Wilcoxon rank-sum test, NS: not significant, * <italic>p</italic> &lt; 0.05, ** p &lt; 0.01, *** <italic>p</italic> &lt; 0.001, **** <italic>p</italic> &lt; 0.0001). Top: a 4-month-old infant (Blue). Middle: 5-year-old child (Purple). Bottom: a 6-year-old child (Green). <bold>e</bold> The bar plot illustrates the number of “spiked-in” mutations across 10 cell lines. Top: a 4-month-old infant (Blue). Middle: 5-year-old child (Purple). Bottom: a 6-year-old child (Green)</p></caption><graphic xlink:href="13073_2023_1269_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par58">RESA demonstrated the most consistent and highest precision in all spiked-in scRNA-seq datasets tested, with average precision of 0.84, 0.87, and 0.87 for the three baseline datasets, respectively, followed by RESA-jLR model with average precision of 0.61, 0.66, and 0.76, respectively (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). Among the five previously published methods, Maynard et al. showed the highest average precision. However, the precision varied significantly across different test cases, with an average precision of only 0.2 for all three baseline datasets (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). Furthermore, spike-in results showed that additional cells with lower sequencing coverage led to decreased precision overall, but RESA demonstrated more stable precision compared to the RESA-jLR model (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). This suggests that sequencing coverage at a single cell level might be more crucial for mutation detection than the total number of cells tested. Additionally, we observed that RESA consistently maintained high precision with low variation even with a significant variation in the number of “spiked-in” somatic mutations from different cancer cell lines (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, d). Here we demonstrated that RESA can reach average an precision of 0.86 in primary tissue samples, with an average of 1.8 million reads/cell (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9). Notably, in the in silico spike-in data of a 1-month-old infant, more than 50 cells had less than 1 million reads, yet the average precision for this dataset was approximately 0.87.</p>
      <p id="Par59">The RESA-jLR model complemented the conservative approach used in RESA by demonstrating increased sensitivity at the cost of decreased precision. For instance, the RESA-jLR identified, on average, 20% more new somatic mutations in the test cases from the 5-year-old baseline dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10). We further evaluated the performance using an F0.5 score, a weighted harmonic mean emphasizing more on precision over sensitivity. In test cases with large numbers of “spiked-in” somatic mutations, RESA-jLR outperformed RESA with an increase in sensitivity and a stable precision that resulted in higher F0.5 scores (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c, d, e, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S11), suggesting that RESA-jLR has advantages in datasets with high mutation burden. In addition, through in silico “spike-in” analysis, we demonstrated the superior performance of RESA across different sequencing coverage and cancer cell lines. Our results highlighted the difficulty in balancing precision and sensitivity in scRNA-seq somatic mutation detection tasks.</p>
    </sec>
    <sec id="Sec19">
      <title>RESA achieves higher precision across cancer cell line data</title>
      <p id="Par60">The WES/WGS data available from various cancer cell lines presented us with the opportunity to assess the performance of different methods using orthogonal information. We gathered 15 scRNA-seq datasets covering eight cancer cell lines with somatic mutations from WES available, and compared five previously published methods [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>] with varying strategies to benchmark against the RESA pipeline. Across all 15 datasets, both RESA and RESA-jLR consistently demonstrated substantially higher precision compared to other methods, achieving an average precision of 0.75 (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S12), while RESA-jLR increased sensitivity with slightly decreased precision compared to RESA alone (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S13). The high precision of RESA and RESA-jLR made the identified somatic mutations much more reliable for downstream analysis and interpretations, despite suboptimal sensitivity. The other methods showed variable sensitivity but dramatically lower precision, which diminished the value of these methods (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). Additionally, RESA and RESA-jLR outperformed other methods overall, with RESA-jLR showing marginally higher and more stable F0.5 performance (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). The best-performing method, other than RESA, is the method used by Maynard et al. [<xref ref-type="bibr" rid="CR15">15</xref>] (Methods), which mainly focused on filtering against a curated somatic mutation whitelist combined with tissue source information. Although this filtering of mutations is intuitively reasonable, however, the performances of the Maynard et al. method varied dramatically depending on the dataset used, which confirmed the sporadic nature of cancer somatic mutations in a sample specific manner. In contrast, the somatic mutations identified by RESA between datasets of the same cell line showed remarkable consistency (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14b).<fig id="Fig4"><label>Fig. 4</label><caption><p>Evaluating the performance of RESA with comparison to other methods using WES data across multiple cancer cell lines. <bold>a</bold> Boxplots showing precisions (top) and sensitivities (bottom) of different methods in identifying positive somatic SNVs using WES data as ground truth across 15 scRNA-seq datasets. <bold>b</bold> The scatter plot showing F0.5 scores of different methods in identifying positive somatic SNVs using the number of somatic SNVs in WES data as ground truth across 15 scRNA-seq datasets. <bold>c</bold> Mutation spectra of somatic SNVs identified using all exonic SNVs, all expressed SNVs, RESA-jLR, and the Maynard 2020 approach across 3 scRNA-seq datasets. Pairwise cosine similarity scores were shown next to brackets</p></caption><graphic xlink:href="13073_2023_1269_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par61">Notably, RESA effectively identified somatic SNVs across cancer cells with varying mutation burdens despite sensitivity differences (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14d). In particular, in the case of the JURKAT cell line, RESA detected a median of 449 and 387 somatic SNVs per cell in the SMART-seq and TARGET-seq datasets, respectively. These numbers were over 100 times higher than the somatic mutations detected in experimental multi-omic profiling (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14c, Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S1, Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Table S1) [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>].</p>
      <p id="Par62">Next, we assessed the population-wise mutational spectrum captured by different methods against the WES mutational spectrum, and all expressed SNVs that can potentially be detected in the corresponding scRNA-seq data. We observed that expressed SNVs generally captured the exonic mutational spectra well, with lower numbers of SNVs detected and sparser presentation for low mutation burden samples (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14d). Expressed SNVs detected by RESA-jLR reproduced the mutational spectrum of all expressed SNVs faithfully, particularly in samples with a high mutation burden (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14d). In contrast, Maynard 2020 [<xref ref-type="bibr" rid="CR15">15</xref>], the best-performing method in precision among all other methods, failed to capture the mutational spectra of either expressed or all exonic SNVs (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S14d). Therefore, expressed SNVs detected by RESA-jLR from the scRNA-seq data can be used to assess the genomic mutational spectra, particularly in samples with a high mutation burden.</p>
    </sec>
    <sec id="Sec20">
      <title>RESA achieved higher precision across tumor tissue datasets</title>
      <p id="Par63">To further evaluate RESA's performance in real tumor data, we collected four scRNA-seq datasets with matching WES data from two independent studies involving different cancer types. These datasets include two replicates of lung adenocarcinoma tumor xenograft [<xref ref-type="bibr" rid="CR25">25</xref>], and melanoma patient-derived xenograft (PDX) before and after RAF/MEK inhibitor treatment [<xref ref-type="bibr" rid="CR36">36</xref>]. Again, RESA and RESA-jLR achieved the highest precision and F0.5 scores over other methods (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, b, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S15, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S16). In particular, in the lung cancer datasets with matched normal WES available, RESA was able to obtain higher performance using germline variants from matched normal than using publicly available SNP databases to filter out germline variants (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S17), highlighting that germline variants from matched normal should be applied in RESA whenever such data is available. Despite the likelihood of primary tumor samples being more heterogeneous than cancer cell lines, RESA maintained a positive correlation between scRNA-seq VAF and WES VAF, even with large variations in the WES VAF (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c).<fig id="Fig5"><label>Fig. 5</label><caption><p>Benchmark RESA to other methods in PDX tumor datasets. <bold>a</bold> The bar plots illustrate precisions of RESA, RESA-jLR and other methods in a lung cancer PDX tumor from the same patient with 2 replicates. <bold>b</bold> The bar plots illustrate precisions of RESA, RESA-jLR and other methods in melanoma PDX datasets without treatment (T0) and after treatment (Phase3), <bold>c</bold>, <bold>d</bold>, <bold>e</bold>, <bold>f</bold>, Scatter plots showing VAF correlation of SNVs detected by RESA between scRNA-seq and WES in the lung cancer tumor sample with the replicate 1 (<bold>c</bold>) and replicate 2 (<bold>d</bold>), and melanoma datasets without treatment (<bold>e</bold>) and with treatment (<bold>f</bold>)</p></caption><graphic xlink:href="13073_2023_1269_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par64">Melanoma tumors are characterized by UV signatures in their mutational spectra, which can serve as an additional indicator to assess the reliability of RESA. In the above-mentioned time-course study of RAF/MEK inhibition resistance using scRNA-seq datasets from the melanoma PDX model, over 600 single cells were profiled across four time points: T0 (tumor before treatment), phase 1 (tumor shrinking stage after treatment), phase 2 (minimal residual disease stage), and phase 3 (relapsed stage after drug treatment) [<xref ref-type="bibr" rid="CR36">36</xref>]. RESA accurately reproduced the typical mutational spectrum of UV signature in all melanoma datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S18a). Interestingly, the UV signature remains strong with little variation across different clusters or time points of the cell population, despite expression heterogeneity of somatic SNVs and involved genes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S18c). This is consistent with previous knowledge that treatment with mechanism of action (MOA) not involving DNA replication and repair, e.g. BRAF inhibitor dabrafenib, is not expected to induce large mutational changes [<xref ref-type="bibr" rid="CR36">36</xref>]. In addition, we identified the known BRAF V600E driver mutation present in the sample using RESA (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S1), further validating the reliability of RESA.</p>
    </sec>
    <sec id="Sec21">
      <title>RESA identifies drug resistance-associated genes with expressed somatic mutations in a melanoma PDX scRNA-seq dataset</title>
      <p id="Par65">We applied RESA-jLR to the scRNA-seq datasets of the melanoma PDX model, where we identified 575 unique somatic SNVs and their corresponding 524 genes (Methods, Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S1). To investigate the interplay between mutational heterogeneity and transcriptional heterogeneity, we further analyzed the dataset using graph-based clustering to summarize the gene expression heterogeneity (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S18b). By overlaying the four-time points onto the clusters, we identified both shared and unique clusters across timepoints (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a), which confirmed the transcriptional heterogeneity in the scRNA-seq of the melanoma samples throughout different drug treatment stages. For example, cluster 3 represented unique cell groups at the MRD stage (phase 2), whereas cluster 2 showed expression patterns shared by both the tumor shrinking stage (phase 1) and MRD stage (phase 2). We observed that during the MRD stage of phase 2, cell clusters of 0,1,2,3,5 were all present, indicating a coexistence of heterogeneous subclones rather than the dominance of a single subclone despite minimal tumor size. Thus, our gene expression reanalysis validates the existence of multiple subclones with distinct gene expression signatures across different tumor stages.<fig id="Fig6"><label>Fig. 6</label><caption><p>Somatic SNVs enriched in specific stages using RESA. <bold>a</bold> UMAP embedding of scRNA-seq profiles of each stage. <bold>b</bold> Distributions of percentages of cells harboring stage-specific mutations of each stage. (n.s.: <italic>p</italic> &gt; 0.05, *: <italic>p</italic> &lt;  = 0.05, **: <italic>p</italic> &lt;  = 0.01, ***: <italic>p</italic> &lt;  = 0.001, ****: <italic>p</italic> &lt;  = 0.0001) <bold>c</bold> Aggregate expression of log<sub>2</sub> of transcripts per 10,000 reads (color bar) for stage-specific genes detected in more than 10 cells and the number of cells harboring the mutation in each stage (cycle). <bold>d</bold> List of gene set enrichment results for each stage (MSigDB hallmark)</p></caption><graphic xlink:href="13073_2023_1269_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par66">In order to study the mutational heterogeneity during drug response, we defined "stage-specific" somatic mutations as follows (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b,c). While most mutations were found present across all stages, we reasoned that subclonal mutations that contribute to different stages of the tumor should be non-uniformly present. Based on this assumption, we counted the number of cells carrying mutations in each tumor stage and calculated the enrichment accordingly. We then identified mutated genes that were enriched in specific tumor stages of the cell population compared to their wild-type counterparts. Specifically, we detected 72, 75, 88, and 63 mutated genes for the respective stages and focused our following analysis on mutated genes (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b,c, Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Table S1, Methods).</p>
      <p id="Par67">To investigate the mutated gene expression signatures, we tested GSEA curated cancer hallmarks enriched for the stage-specific mutated genes (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d). As expected, mutated genes were enriched in pathways associated with melanoma development and progression, including the p53 pathway, epithelial to mesenchymal transition (EMT) pathway, mTORC1 signaling, androgen response pathway, and UV response [<xref ref-type="bibr" rid="CR39">39</xref>–<xref ref-type="bibr" rid="CR44">44</xref>]. Notably, when comparing hallmarks of mutated genes across different stages, the androgen response pathway, which is associated with melanoma tumor growth and invasion, was enriched exclusively in the MRD stage (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d). Recent clinical research has reported that drug resistance is associated with sex, and males have shorter survival after BRAF-inhibitor monotherapy [<xref ref-type="bibr" rid="CR45">45</xref>, <xref ref-type="bibr" rid="CR46">46</xref>]. Additionally, androgen receptor signaling is associated with the resistance of targeting BRAF [<xref ref-type="bibr" rid="CR45">45</xref>]. Thus, the androgen response pathway may serve as a crucial mechanism for tumor survival in such cases. Therefore, cancer hallmarks that may be disturbed by expressed somatic SNVs may provide valuable orthogonal information beyond expression variation.</p>
    </sec>
  </sec>
  <sec id="Sec22">
    <title>Discussion</title>
    <p id="Par68">Identifying somatic mutations directly from scRNA-seq data has been a long-standing challenge. While attempts have been made, no computational method has been proven widely applicable. We report a computational framework named RESA, which identifies expressed somatic SNVs with high precision directly from the scRNA-seq data. RESA can effectively filter out noise and artefacts generated during the experimental procedure, thereby achieving high precision. In addition, RESA applies a joint logistic regression to expand the putative somatic mutations, which helps increase detection sensitivity while maintaining high precision. We comprehensively benchmarked RESA across datasets both in vitro and in vivo, and demonstrated the reliability of RESA in different scenarios.</p>
    <p id="Par69">In addition to evaluating individual SNVs, RESA also attempts to assess the mutational spectrum of expressed SNVs. High precision detection of somatic SNVs enables reliable mutational signature analysis of the expressed SNVs in scRNA-seq data, thus providing insights into the mechanistic biological processes involved in cancer progression, or revealing potential therapeutic opportunities in the sample of interest.</p>
    <p id="Par70">Balancing precision and sensitivity is tricky. Precision measures the proportion of true somatic mutations identified by RESA out of all somatic mutations suggested by RESA (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). On the other hand, sensitivity measures the proportion of true somatic mutations out of all somatic mutations carried in scRNA-seq data. Previous methods mostly achieve high sensitivity, but their low precisions lead to an excessive amount of noise and artefacts (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). The main purpose of our model is to identify higly reliable somatic mutation, which emphasizes more on precision over sensitivity. So that we can be very confident in the RESA-suggested somatic mutations in cases without matched WES/WGS for evaluation and improved the reliability of downstream analysis. To compensate for the loss of sensitivity, and increase sensitivity, we developed the RESA-jLR modeling step. In addition, we used the F0.5 score to reconcile the performance evaluation balance between precision and sensitivity. As demonstrated in our results, RESA-jLR achieves better performances than RESA in cases of high mutation burden or high sequencing coverage per cell.</p>
    <p id="Par71">VAF represents the fraction of alleles containing mutations. In WES, the VAF value is affected by tumor purity and clonality. In bRNA-seq, the VAF interpretation is further complicated due to allelic and stochastic expression and the abundance of genes containing mutations. However, the VAF estimate from scRNA-seq might be perceived as the deconvolution of bRNA for VAF without the complication of tumor purity as long as only cancer cells are assessed. Interestingly, we observed a positive correlation between scRNA-seq VAF and VAF from both bRNA-seq (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d) and WES (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e) in the A375 cell line data. These results suggest that scRNA-seq VAF might be indicative of the mutant VAF at the bulk level. Notably, we detected somatic mutations from scRNA-seq with a WES VAF as low as 0.13 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3).</p>
    <p id="Par72">Detection of expressed SNVs using RESA may suffer from several limitations. RESA works best in scRNA-seq data that are sequenced relatively deep (1–3 million reads per cell in general), or in samples with relatively high mutation burden. Application to other widely used scRNA-seq technologies like 10X genomics and drop-seq might thus be limited by the nature of shallow sequencing and biased gene region coverage. However, recent studies have made efforts to address the coverage issue by combining bam files of the same cell type in 10X Genomics datasets to detect somatic mutations [<xref ref-type="bibr" rid="CR47">47</xref>]. Taking this into consideration, we acknowledge that RESA could be improved by incorporating this strategy in the future, thereby expanding its potential application areas. Another potential limitation is that this approach is designed to detect clonal somatic mutations instead of rare mutations in the population. Empirically we found that WES VAF above 0.1 can be detectable in scRNA-seq data and RESA. In addition, due to the nature of the scRNA-seq experiment, only mutations with relatively high expression are potentially detectable. Lastly, some somatic mutations expressed in a single cell might not be detectable through WES/WGS, leading to a decreased precision value that underestimates the real precision. Moreover, the clonal divergence between cell cultures that generated WES/WGS data vs. scRNA-seq data might also decrease the precision. Thus, the limited sensitivity of scRNA-seq data as well as RESA might potentially limit its application.</p>
    <p id="Par73">The success of RESA in high precision somatic mutation detection from scRNA-seq data highlights the critical importance of cellular recurrence, whereas prioritizing based on functional prediction or stratification from curated whitelist mutations does not always work well. This is the first study, to the best of our knowledge, that made a direct comparison among the methods emphasizing the above aspects and delivering distinctive results. As more datasets, especially datasets with both scRNA-seq and WES/WEG profiling on the same sample, become available, new methods may be developed with better performance. We believe RESA will provide valuable information to facilitate single cell level genotype to phenotype study in the future.</p>
  </sec>
  <sec id="Sec23">
    <title>Conclusions</title>
    <p id="Par74">In summary, we introduce a computational framework package named RESA that identifies expressed somatic mutations from scRNA-seq de novo. RESA effectively filters out noise and artefacts identified through common variant calling pipelines. We demonstrated the remarkable improvement in precision and F0.5 score of RESA against other methods across multiple test case scenarios. We showcased the application of RESA-jLR to provide novel insights into the potential mutational mechanisms underlying melanoma MRD, and we believe RESA is highly valuable to providing orthogonal insights into the intratumor heterogeneity studies in scRNA-seq datasets.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec24">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13073_2023_1269_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: </bold>Includes 18 figures of additional results. The names of the figure are: <bold>Figure S1. </bold>Workflow illustrates the different strategies between RESA and other methods; <bold>Figure S2.</bold> The correlation between site-specific depth and number of detectable SNVs in scRNA-seq; <bold>Figure S3. </bold>Scatter plots showing VAF correlation of SNVs detected by RESA between scRNA-seq and WES in the A375 cell line; <bold>Figure S4.</bold> Full length scRNA-seq sequencing procedure, steps where noise and artefacts may be introduced are highlighted; <bold>Figure S5. </bold>Comparison between identified somatic SNVs and identified noise and artefacts; <bold>Figure S6.</bold> Scatter plots showing VAF correlation of SNVs detected by RESA between scRNA-seq and WES, as well as scRNA-seq and bRNA-seq in the A375 cell line and LNCaP cell line; <bold>Figure S7.</bold> AUC values of the joint logistic regression model prediction on the test set in 15 tested datasets;<bold> Figure S8.</bold> Correlation of feature weights in quality-based and sequence-based logistic regression; <bold>Figure S9. </bold>The distribution of million reads per cell in in silico spike-in datasets of 1-month-old, 5-year-old, 6-year-old donors; <bold>Figure S10. </bold>The bar plot illustrates the percentage change of the number of expressed SNVs detected by RESA-jLR against RESA-identified SNVs in the in silico spike-in scRNA-seq dataset of a 5-year-old child; <bold>Figure S11.</bold> The bar plot illustrates sensitivity in the in silico spike-in scRNA-seq dataset of 1-month-old, 5-year-old, 6-year-old donors; <bold>Figure S12.</bold> Boxplots showing precisions (top) and sensitivities (bottom) of different methods in identifying positive somatic SNVs using WES data as ground truth across 15 scRNA-seq datasets; <bold>Figure S13. </bold>The bar plot illustrates the sensitivity of 15 cell line datasets;<bold> Figure S14. </bold>Evaluating RESA performance with comparison to other methods; <bold>Figure S15.</bold> The bar plot illustrates sensitivity in PDX tumor datasets; <bold>Figure S16.</bold> Bar plots illustrate the F0.5 scores of RESA, RESA-jLR, and other methods in PDX tumor datasets; <bold>Figure S17.</bold> Lung cancer PDX tumor datasets with the matched normal in two groups of independent cells; <bold>Figure S18. </bold>Reanalysis of a melanoma scRNA-seq dataset using RESA.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13073_2023_1269_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2:</bold> Includes 1 table for cell line data sets used in the study. The name of the table is:<bold> Table S1. </bold>Somatic SNVs detecting by RESA to full-length scRNA-seq data from 15 datasets.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13073_2023_1269_MOESM3_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3:</bold> Includes 1 table of the annotation for cell line data sets used in the study. The name of the table is:<bold> Table S1. </bold>Annotation of each mutation in 15 cell line datasets detected by RESA.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13073_2023_1269_MOESM4_ESM.xlsx">
            <caption>
              <p><bold>Additional file 4:</bold> Includes 1 table of the statistical summary for cell line data sets. The name of the table is:<bold> Table S1.</bold> Summary statistic table of mutations detected by RESA.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13073_2023_1269_MOESM5_ESM.xlsx">
            <caption>
              <p><bold>Additional file 5:</bold> Includes 1 table for melanoma data sets. The name of the table is:<bold> Table S1.</bold> 575 unique somatic SNVs of scRNA-seq of the melanoma detected by RESA, which mapped to 524 genes.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="13073_2023_1269_MOESM6_ESM.xlsx">
            <caption>
              <p><bold>Additional file 6:</bold> Includes 1 table of the stage enrichment for melanoma data sets. The name of the table is:<bold> Table S1.</bold> P values of the Hypergeometric test for stage-specific somatic SNVs enrichment in each stage.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>scRNA-seq</term>
        <def>
          <p id="Par2">Single-cell RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>RESA</term>
        <def>
          <p id="Par3">Recurrently Expressed SNV Analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>MRD</term>
        <def>
          <p id="Par4">Minimal residual disease</p>
        </def>
      </def-item>
      <def-item>
        <term>WGS</term>
        <def>
          <p id="Par5">Whole genome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>WES</term>
        <def>
          <p id="Par6">Whole exome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>RESA-jLR</term>
        <def>
          <p id="Par7">RESA followed by a joint logistic regression</p>
        </def>
      </def-item>
      <def-item>
        <term>VAF</term>
        <def>
          <p id="Par8">Variant allele frequency</p>
        </def>
      </def-item>
      <def-item>
        <term>bRNA-seq</term>
        <def>
          <p id="Par9">Bulk RNA-seq</p>
        </def>
      </def-item>
      <def-item>
        <term>PDX</term>
        <def>
          <p id="Par10">Patient-derived xenograft</p>
        </def>
      </def-item>
      <def-item>
        <term>MOA</term>
        <def>
          <p id="Par11">Mechanism of action</p>
        </def>
      </def-item>
      <def-item>
        <term>EMT</term>
        <def>
          <p id="Par12">Epithelial to mesenchymal transition</p>
        </def>
      </def-item>
      <def-item>
        <term>scWGS</term>
        <def>
          <p id="Par13">Single cell whole genome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>LUAD</term>
        <def>
          <p id="Par14">Lung adenocarcinoma</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>This article has been updated to amend affiliations 1 &amp; 2.</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>
        <bold>Change history</bold>
      </p>
      <p>5/14/2024</p>
      <p>A Correction to this paper has been published: 10.1186/s13073-024-01343-2</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Prof. Peter Park, Prof. Haoxing Xu, and Vinay V. Viswanadham for their helpful discussion and suggestions. We thank Prof. Haoxing Xu, Dr. Jiaming Li, Dr. Xudong Fu, Dr. Zhaoyuan Fang, and Dr. Asif Ashan for critical reading and suggestions on the manuscript. We are also thankful for the technical support by the Core Facilities of Liangzhu Laboratory.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>N.S. designed the project and overall method. N.S. and T.Z. developed, implemented the method and analyzed the data. N.S., T.Z., H.J., and T.S. drafted the manuscript. L.L., D.C.G, H.W., R.X., W.G. and H.G. contributed suggestions. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the Leading Innovative and Entrepreneur Team Introduction Program of Zhejiang (No. 2021R01012) and the Starting Fund from Zhejiang University.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The WES data and bulk RNA-seq data for cancer cell line LNCaP were downloaded through Genomic Data Commons (<ext-link ext-link-type="uri" xlink:href="https://gdc.cancer.gov/">https://gdc.cancer.gov/</ext-link>). The exonic somatic mutations for all cancer cell lines were downloaded from CCLE_20Q1_mutations [<xref ref-type="bibr" rid="CR20">20</xref>]. The scRNA-seq for cancer cell lines were downloaded from GSE105451 [<xref ref-type="bibr" rid="CR4">4</xref>], GSE99795 [<xref ref-type="bibr" rid="CR21">21</xref>], GSE76312 [<xref ref-type="bibr" rid="CR5">5</xref>], GSE150993 [<xref ref-type="bibr" rid="CR22">22</xref>], GSE108383 [<xref ref-type="bibr" rid="CR23">23</xref>], GSE140440 [<xref ref-type="bibr" rid="CR24">24</xref>], and GSE69405 [<xref ref-type="bibr" rid="CR25">25</xref>] respectively. The lung cancer scRNA-seq data and WES were downloaded from GSE69405 [<xref ref-type="bibr" rid="CR25">25</xref>]. The human tissue scRNA-seq data of melanoma were downloaded from GSE81547 [<xref ref-type="bibr" rid="CR35">35</xref>]. The matched WES of melanoma PDX was downloaded from EGAD00001007749 [<xref ref-type="bibr" rid="CR36">36</xref>].</p>
    <p>The source code for the RESA pipeline is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ShenLab-Genomics/RESA">https://github.com/ShenLab-Genomics/RESA</ext-link> [<xref ref-type="bibr" rid="CR26">26</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par75">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par76">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par77">The authors have submitted a patent application for the method. Other than this, the authors declare that they do not have any competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Yizhak K, Aguet F, Kim J, Hess JM, Kübler K, Grimsby J, et al. RNA sequence analysis reveals macroscopic somatic clonal expansion across normal tissues. Science. 2019;364. Available from: 10.1126/science.aaw0726</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">PCAWG Transcriptome Core Group, Calabrese C, Davidson NR, Demircioğlu D, Fonseca NA, He Y, et al. Genomic basis for RNA alterations in cancer. Nature. 2020;578:129–36.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nam</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>K-T</given-names>
          </name>
          <name>
            <surname>Chaligne</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Izzo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Somatic mutations and cell identity linked by Genotyping of Transcriptomes</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>571</volume>
        <fpage>355</fpage>
        <lpage>360</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1367-0</pub-id>
        <?supplied-pmid 31270458?>
        <pub-id pub-id-type="pmid">31270458</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rodriguez-Meira</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Buck</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>S-A</given-names>
          </name>
          <name>
            <surname>Povinelli</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Alcolea</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Louka</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unravelling intratumoral heterogeneity through high-sensitivity single-cell mutational analysis and parallel RNA Sequencing</article-title>
        <source>Mol Cell</source>
        <year>2019</year>
        <volume>73</volume>
        <fpage>1292</fpage>
        <lpage>305.e8</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2019.01.009</pub-id>
        <?supplied-pmid 30765193?>
        <pub-id pub-id-type="pmid">30765193</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giustacchini</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Thongjuea</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Barkas</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Woll</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Povinelli</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Booth</surname>
            <given-names>CAG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomics uncovers distinct molecular signatures of stem cells in chronic myeloid leukemia</article-title>
        <source>Nat Med</source>
        <year>2017</year>
        <volume>23</volume>
        <fpage>692</fpage>
        <lpage>702</lpage>
        <pub-id pub-id-type="doi">10.1038/nm.4336</pub-id>
        <?supplied-pmid 28504724?>
        <pub-id pub-id-type="pmid">28504724</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Petti</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Fiddes</surname>
            <given-names>IT</given-names>
          </name>
          <name>
            <surname>Srivatsan</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>DY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A general approach for detecting expressed mutations in AML cells using single cell RNA-sequencing</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>3660</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-11591-1</pub-id>
        <?supplied-pmid 31413257?>
        <pub-id pub-id-type="pmid">31413257</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">van Galen P, Hovestadt V, Wadsworth MH Ii, Hughes TK, Griffin GK, Battaglia S, et al. Single-Cell RNA-Seq Reveals AML Hierarchies Relevant to Disease Progression and Immunity. Cell. 2019;176:1265–81.e24.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Francis</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Georghiou</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hergert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated single-cell genetic and transcriptional analysis suggests novel drivers of chronic lymphocytic leukemia</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>1300</fpage>
        <lpage>1311</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.217331.116</pub-id>
        <?supplied-pmid 28679620?>
        <pub-id pub-id-type="pmid">28679620</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campbell</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Steif</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zahn</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>clonealign: statistical integration of independent single-cell RNA and DNA sequencing data from human cancers</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>54</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1645-z</pub-id>
        <?supplied-pmid 30866997?>
        <pub-id pub-id-type="pmid">30866997</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hovestadt</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Bihannic</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Filbin</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Baumgartner</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Resolving medulloblastoma cellular architecture by single-cell genomics</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>572</volume>
        <fpage>74</fpage>
        <lpage>79</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1434-6</pub-id>
        <?supplied-pmid 31341285?>
        <pub-id pub-id-type="pmid">31341285</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Picelli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Björklund</surname>
            <given-names>ÅK</given-names>
          </name>
          <name>
            <surname>Faridani</surname>
            <given-names>OR</given-names>
          </name>
          <name>
            <surname>Sagasser</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Winberg</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Smart-seq2 for sensitive full-length transcriptome profiling in single cells</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1096</fpage>
        <lpage>1098</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2639</pub-id>
        <?supplied-pmid 24056875?>
        <pub-id pub-id-type="pmid">24056875</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Enge</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Arda</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Mignardi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Beausang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bottino</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>SK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell analysis of human pancreas reveals transcriptional signatures of aging and somatic mutation patterns</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <fpage>321</fpage>
        <lpage>30.e14</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.09.004</pub-id>
        <?supplied-pmid 28965763?>
        <pub-id pub-id-type="pmid">28965763</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mathys</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Davila-Velderrain</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mohammadi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>JZ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomic analysis of Alzheimer’s disease</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>570</volume>
        <fpage>332</fpage>
        <lpage>337</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1195-2</pub-id>
        <?supplied-pmid 31042697?>
        <pub-id pub-id-type="pmid">31042697</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darmanis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sloan</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Croote</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mignardi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chernikova</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Samghababi</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-Seq analysis of infiltrating neoplastic cells at the migrating front of human glioblastoma</article-title>
        <source>Cell Rep</source>
        <year>2017</year>
        <volume>21</volume>
        <fpage>1399</fpage>
        <lpage>1410</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2017.10.030</pub-id>
        <?supplied-pmid 29091775?>
        <pub-id pub-id-type="pmid">29091775</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maynard</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McCoach</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Rotow</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Haderk</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kerr</surname>
            <given-names>DL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Therapy-induced evolution of human lung cancer revealed by single-cell RNA sequencing</article-title>
        <source>Cell</source>
        <year>2020</year>
        <volume>182</volume>
        <fpage>1232</fpage>
        <lpage>51.e22</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.07.017</pub-id>
        <?supplied-pmid 32822576?>
        <pub-id pub-id-type="pmid">32822576</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systematic comparative analysis of single-nucleotide variant detection methods from single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>242</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1863-4</pub-id>
        <?supplied-pmid 31744515?>
        <pub-id pub-id-type="pmid">31744515</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vu</surname>
            <given-names>TN</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>H-N</given-names>
          </name>
          <name>
            <surname>Calza</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kalari</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pawitan</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Cell-level somatic mutation detection from single-cell RNA sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>4679</fpage>
        <lpage>4687</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz288</pub-id>
        <?supplied-pmid 31028395?>
        <pub-id pub-id-type="pmid">31028395</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Edwards N, Dillard C, Prashant NM, Hongyu L, Yang M, Ulianova E, et al. SCExecute: custom cell barcode-stratified analyses of scRNA-seq data. Bioinformatics. 2023;39. Available from: 10.1093/bioinformatics/btac768</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frohlich</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Anti-HTLV III testing of blood donors and recipients Hawaii experience</article-title>
        <source>Hawaii Med J</source>
        <year>1986</year>
        <volume>45</volume>
        <fpage>391</fpage>
        <lpage>392</lpage>
        <?supplied-pmid 3468095?>
        <pub-id pub-id-type="pmid">3468095</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ghandi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>FW</given-names>
          </name>
          <name>
            <surname>Jané-Valbuena</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kryukov</surname>
            <given-names>GV</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>McDonald</surname>
            <given-names>ER</given-names>
            <suffix>3rd</suffix>
          </name>
          <etal/>
        </person-group>
        <article-title>Next-generation characterization of the cancer cell line encyclopedia</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>569</volume>
        <fpage>503</fpage>
        <lpage>508</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1186-3</pub-id>
        <?supplied-pmid 31068700?>
        <pub-id pub-id-type="pmid">31068700</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Horning</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>C-K</given-names>
          </name>
          <name>
            <surname>Louie</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Jadhav</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Hung</surname>
            <given-names>C-N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq reveals a subpopulation of prostate cancer cells with enhanced cell-cycle-related transcription and attenuated androgen response</article-title>
        <source>Cancer Res</source>
        <year>2018</year>
        <volume>78</volume>
        <fpage>853</fpage>
        <lpage>864</lpage>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-17-1924</pub-id>
        <?supplied-pmid 29233929?>
        <pub-id pub-id-type="pmid">29233929</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>The effect of methanol fixation on single-cell RNA sequencing data</article-title>
        <source>BMC Genomics</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>420</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-021-07744-6</pub-id>
        <?supplied-pmid 34090348?>
        <pub-id pub-id-type="pmid">34090348</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ho</surname>
            <given-names>Y-J</given-names>
          </name>
          <name>
            <surname>Anaparthy</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Molik</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mathew</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Aicher</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq analysis identifies markers of resistance to targeted BRAF inhibitors in melanoma cell populations</article-title>
        <source>Genome Res</source>
        <year>2018</year>
        <volume>28</volume>
        <fpage>1353</fpage>
        <lpage>1363</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.234062.117</pub-id>
        <?supplied-pmid 30061114?>
        <pub-id pub-id-type="pmid">30061114</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schnepp</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Shelley</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wakim</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Mizokami</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomics analysis identifies nuclear protein 1 as a regulator of docetaxel resistance in prostate cancer cells</article-title>
        <source>Mol Cancer Res</source>
        <year>2020</year>
        <volume>18</volume>
        <fpage>1290</fpage>
        <lpage>1301</lpage>
        <pub-id pub-id-type="doi">10.1158/1541-7786.MCR-20-0051</pub-id>
        <?supplied-pmid 32513898?>
        <pub-id pub-id-type="pmid">32513898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>K-T</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>HW</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>H-O</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Seo</surname>
            <given-names>YJ</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell mRNA sequencing identifies subclonal heterogeneity in anti-cancer drug responses of lung adenocarcinoma cells</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>127</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0692-3</pub-id>
        <?supplied-pmid 26084335?>
        <pub-id pub-id-type="pmid">26084335</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Shen N, Zhang T. RESA Github. 2020 <ext-link ext-link-type="uri" xlink:href="https://github.com/ShenLab-Genomics/RESA">https://github.com/ShenLab-Genomics/RESA</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Schlesinger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Drenkow</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zaleski</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jha</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id>
        <?supplied-pmid 23104886?>
        <pub-id pub-id-type="pmid">23104886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DePristo</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Garimella</surname>
            <given-names>KV</given-names>
          </name>
          <name>
            <surname>Maguire</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hartl</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>491</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.806</pub-id>
        <?supplied-pmid 21478889?>
        <pub-id pub-id-type="pmid">21478889</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <?supplied-pmid 29750242?>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Scheffler</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Halpern</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Bekritsky</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Noh</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Källberg</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Strelka2: fast and accurate calling of germline and somatic variants</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>591</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0051-x</pub-id>
        <?supplied-pmid 30013048?>
        <pub-id pub-id-type="pmid">30013048</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Fangal VD. CTAT Mutations: a machine learning based RNA-Seq variant calling pipeline incorporating variant annotation, prioritization, and visualization. 2020; Available from: <ext-link ext-link-type="uri" xlink:href="https://dash.harvard.edu/handle/1/37365605">https://dash.harvard.edu/handle/1/37365605</ext-link></mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tate</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Bamford</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jubb</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Sondka</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Beare</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Bindal</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>COSMIC: the catalogue of somatic mutations in cancer</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D941</fpage>
        <lpage>D947</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1015</pub-id>
        <?supplied-pmid 30371878?>
        <pub-id pub-id-type="pmid">30371878</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <?supplied-pmid 19505943?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koboldt</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wylie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>McLellan</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Mardis</surname>
            <given-names>ER</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>VarScan: variant detection in massively parallel sequencing of individual and pooled samples</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2283</fpage>
        <lpage>2285</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp373</pub-id>
        <?supplied-pmid 19542151?>
        <pub-id pub-id-type="pmid">19542151</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ewing</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Houlahan</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ellrott</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Caloian</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yamaguchi</surname>
            <given-names>TN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Combining tumor genome simulation with crowdsourcing to benchmark somatic single-nucleotide-variant detection</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>623</fpage>
        <lpage>630</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3407</pub-id>
        <?supplied-pmid 25984700?>
        <pub-id pub-id-type="pmid">25984700</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rambow</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Rogiers</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marin-Bejar</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Aibar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Femel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dewaele</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Toward minimal residual disease-directed therapy in melanoma</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>174</volume>
        <fpage>843</fpage>
        <lpage>55.e19</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.06.025</pub-id>
        <?supplied-pmid 30017245?>
        <pub-id pub-id-type="pmid">30017245</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marin-Bejar</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Rogiers</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dewaele</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Femel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Karras</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pozniak</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evolutionary predictability of genetic versus nongenetic resistance to anticancer drugs in melanoma</article-title>
        <source>Cancer Cell</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>1135</fpage>
        <lpage>49.e8</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ccell.2021.05.015</pub-id>
        <?supplied-pmid 34143978?>
        <pub-id pub-id-type="pmid">34143978</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mootha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Gillette</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>15545</fpage>
        <lpage>15550</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id>
        <?supplied-pmid 16199517?>
        <pub-id pub-id-type="pmid">16199517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmidt</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Joyce</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Buquicchio</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ritz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Distel</surname>
            <given-names>RJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The lncRNA SLNCR1 mediates melanoma invasion through a conserved SRA1-like Region</article-title>
        <source>Cell Rep</source>
        <year>2016</year>
        <volume>15</volume>
        <fpage>2025</fpage>
        <lpage>2037</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2016.04.018</pub-id>
        <?supplied-pmid 27210747?>
        <pub-id pub-id-type="pmid">27210747</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Box NF, Vukmer TO, Terzian T. Targeting p53 in melanoma. Pigment Cell Melanoma Res. 2014. p. 8–10.</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stretch</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Gatter</surname>
            <given-names>KC</given-names>
          </name>
          <name>
            <surname>Ralfkiaer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lane</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>AL</given-names>
          </name>
        </person-group>
        <article-title>Expression of mutant p53 in melanoma</article-title>
        <source>Cancer Res</source>
        <year>1991</year>
        <volume>51</volume>
        <fpage>5976</fpage>
        <lpage>5979</lpage>
        <?supplied-pmid 1933861?>
        <pub-id pub-id-type="pmid">1933861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Elsas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zerp</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>van der Flier</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Krüse</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Aarnoudse</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hayward</surname>
            <given-names>NK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Relevance of ultraviolet-induced N-ras oncogene point mutations in development of primary human cutaneous melanoma</article-title>
        <source>Am J Pathol</source>
        <year>1996</year>
        <volume>149</volume>
        <fpage>883</fpage>
        <lpage>893</lpage>
        <?supplied-pmid 8780392?>
        <pub-id pub-id-type="pmid">8780392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Tang Y, Durand S, Dalle S, Caramel J. EMT-Inducing transcription factors, drivers of melanoma phenotype switching, and resistance to treatment. Cancers. 2020;12. Available from: 10.3390/cancers12082154</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yeh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Androgen receptor promotes melanoma metastasis via altering the miRNA-539-3p/USP13/MITF/AXL signals</article-title>
        <source>Oncogene</source>
        <year>2017</year>
        <volume>36</volume>
        <fpage>1644</fpage>
        <lpage>1654</lpage>
        <pub-id pub-id-type="doi">10.1038/onc.2016.330</pub-id>
        <?supplied-pmid 27869170?>
        <pub-id pub-id-type="pmid">27869170</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vellano</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Chelvanambi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Witt</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Daniele</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Androgen receptor blockade promotes response to BRAF/MEK-targeted therapy</article-title>
        <source>Nature</source>
        <year>2022</year>
        <volume>606</volume>
        <fpage>797</fpage>
        <lpage>803</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-022-04833-8</pub-id>
        <?supplied-pmid 35705814?>
        <pub-id pub-id-type="pmid">35705814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Long</surname>
            <given-names>GV</given-names>
          </name>
          <name>
            <surname>Grob</surname>
            <given-names>J-J</given-names>
          </name>
          <name>
            <surname>Nathan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ribas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Robert</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schadendorf</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Factors predictive of response, disease progression, and overall survival after dabrafenib and trametinib combination treatment: a pooled analysis of individual patient data from randomised trials</article-title>
        <source>Lancet Oncol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>1743</fpage>
        <lpage>1754</lpage>
        <pub-id pub-id-type="doi">10.1016/S1470-2045(16)30578-2</pub-id>
        <?supplied-pmid 27864013?>
        <pub-id pub-id-type="pmid">27864013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Muyas F, Sauer CM, Valle-Inclán JE, Li R, Rahbari R, Mitchell TJ, et al. De novo detection of somatic mutations in high-throughput single-cell profiling data sets. Nat Biotechnol. 2023. Available from: 10.1038/s41587-023-01863-z.</mixed-citation>
    </ref>
  </ref-list>
</back>
