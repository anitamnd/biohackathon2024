<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Metabolites</journal-id>
    <journal-id journal-id-type="iso-abbrev">Metabolites</journal-id>
    <journal-id journal-id-type="publisher-id">metabolites</journal-id>
    <journal-title-group>
      <journal-title>Metabolites</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2218-1989</issn>
    <publisher>
      <publisher-name>MDPI</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5192445</article-id>
    <article-id pub-id-type="doi">10.3390/metabo6040039</article-id>
    <article-id pub-id-type="publisher-id">metabolites-06-00039</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MetMatch: A Semi-Automated Software Tool for the Comparison and Alignment of LC-HRMS Data from Different Metabolomics Experiments</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Koch</surname>
          <given-names>Stefan</given-names>
        </name>
        <xref ref-type="aff" rid="af1-metabolites-06-00039">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bueschl</surname>
          <given-names>Christoph</given-names>
        </name>
        <xref ref-type="aff" rid="af1-metabolites-06-00039">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Doppler</surname>
          <given-names>Maria</given-names>
        </name>
        <xref ref-type="aff" rid="af1-metabolites-06-00039">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Simader</surname>
          <given-names>Alexandra</given-names>
        </name>
        <xref ref-type="aff" rid="af1-metabolites-06-00039">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Meng-Reiterer</surname>
          <given-names>Jacqueline</given-names>
        </name>
        <xref ref-type="aff" rid="af2-metabolites-06-00039">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lemmens</surname>
          <given-names>Marc</given-names>
        </name>
        <xref ref-type="aff" rid="af2-metabolites-06-00039">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schuhmacher</surname>
          <given-names>Rainer</given-names>
        </name>
        <xref ref-type="aff" rid="af1-metabolites-06-00039">1</xref>
        <xref rid="c1-metabolites-06-00039" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Karp</surname>
          <given-names>Peter D.</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <aff id="af1-metabolites-06-00039"><label>1</label>Center for Analytical Chemistry, Department of Agrobiotechnology (IFA-Tulln), University of Natural Resources and Life Sciences, Vienna (BOKU), Tulln an der Donau 3430, Austria; <email>stefan.koch@boku.ac.at</email> (S.K.); <email>christoph.bueschl@boku.ac.at</email> (C.B.); <email>maria.doppler@boku.ac.at</email> (M.D.); <email>alexandra.simader@boku.ac.at</email> (A.S.)</aff>
    <aff id="af2-metabolites-06-00039"><label>2</label>Institute for Biotechnology in Plant Production, Department of Agrobiotechnology (IFA-Tulln), University of Natural Resources and Life Sciences, Vienna (BOKU), Tulln an der Donau 3430, Austria; <email>jacqueline.reiterer@boku.ac.at</email> (J.M.-R.); <email>marc.lemmens@boku.ac.at</email> (M.L.)</aff>
    <author-notes>
      <corresp id="c1-metabolites-06-00039"><label>*</label>Correspondence: <email>rainer.schuhmacher@boku.ac.at</email>; Tel.: +43-1-47654-97307</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>02</day>
      <month>11</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2016</year>
    </pub-date>
    <volume>6</volume>
    <issue>4</issue>
    <elocation-id>39</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>8</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>10</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2016 by the authors; licensee MDPI, Basel, Switzerland.</copyright-statement>
      <copyright-year>2016</copyright-year>
      <license>
        <license-p><!--CREATIVE COMMONS-->This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC-BY) license (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Due to its unsurpassed sensitivity and selectivity, LC-HRMS is one of the major analytical techniques in metabolomics research. However, limited stability of experimental and instrument parameters may cause shifts and drifts of retention time and mass accuracy or the formation of different ion species, thus complicating conclusive interpretation of the raw data, especially when generated in different analytical batches. Here, a novel software tool for the semi-automated alignment of different measurement sequences is presented. The tool is implemented in the Java programming language, it features an intuitive user interface and its main goal is to facilitate the comparison of data obtained from different metabolomics experiments. Based on a feature list (i.e., processed LC-HRMS chromatograms with mass-to-charge ratio (<italic>m</italic>/<italic>z</italic>) values and retention times) that serves as a reference, the tool recognizes both <italic>m</italic>/<italic>z</italic> and retention time shifts of single or multiple analytical datafiles/batches of interest. MetMatch is also designed to account for differently formed ion species of detected metabolites. Corresponding ions and metabolites are matched and chromatographic peak areas, <italic>m</italic>/<italic>z</italic> values and retention times are combined into a single data matrix. The convenient user interface allows for easy manipulation of processing results and graphical illustration of the raw data as well as the automatically matched ions and metabolites. The software tool is exemplified with LC-HRMS data from untargeted metabolomics experiments investigating phenylalanine-derived metabolites in wheat and T-2 toxin/HT-2 toxin detoxification products in barley.</p>
    </abstract>
    <kwd-group>
      <kwd>feature detection</kwd>
      <kwd>retention time correction</kwd>
      <kwd>metabolite data matching</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="sec1-metabolites-06-00039">
    <title>1. Introduction</title>
    <p>Technological advances in analytical techniques have helped metabolomics to emerge into a valuable discipline for studying metabolic phenotypes caused by various perturbations such as environmental influences, biotic/abiotic factors, or changes in genotype [<xref rid="B1-metabolites-06-00039" ref-type="bibr">1</xref>]. The analysis of metabolites can provide unique insights into biological processes since the metabolome represents the final readout of any biological system [<xref rid="B2-metabolites-06-00039" ref-type="bibr">2</xref>]. Especially untargeted metabolomics experiments generate thousands of features [<xref rid="B3-metabolites-06-00039" ref-type="bibr">3</xref>], which may be unknown at the time of measurement and may turn interesting in later studies. Unlike targeted liquid chromatography coupled to high resolution mass spectrometry (LC-HRMS (liquid chromatography coupled to high resolution mass spectrometry); a list of all abbreviations used throughout this manuscript is provided in “Abbreviations and Terminology”) approaches, an untargeted metabolomics experiment based on full-scan LC-HRMS also allows for retrospective data investigation. In order to get as much information as possible from a single experiment, it can be beneficial to compare novel biological information to former experiments, thus addressing novel biological aspects (e.g., newly identified metabolites) that have not been investigated in former experiments.</p>
    <p>LC-HRMS is one of the most commonly employed analytical techniques in metabolomics research. Chemical compounds are separated by two orthogonal properties, i.e., retention time (Rt) and mass-to-charge ratio (<italic>m</italic>/<italic>z</italic>). Although modern LC-HRMS instruments are well established and robust, the generated raw data tend to show shifts and drifts in both the chromatographic as well as mass spectrometric dimension. The extent of these shifts is more distinct for samples which have been analyzed in different batches or when the time span of data acquisition was rather long (e.g., several weeks or months). Instabilities can be caused by: (i) the instrument (e.g., systematic mass shifts, column age and new hardware such as pumps); (ii) the chemistry of the sample and separation system; and (iii) random variations (e.g., temperature fluctuations) [<xref rid="B4-metabolites-06-00039" ref-type="bibr">4</xref>,<xref rid="B5-metabolites-06-00039" ref-type="bibr">5</xref>]. Furthermore, the ion species formed by the analytes can vary depending on the instrument’s condition (e.g., contaminations in the ion source) and the composition of the mobile phase or sample matrix. Apart from the sheer size of the data, which makes manual analysis impractical, the comparison of different experiments is aggravated by the aforementioned drifts and shifts.</p>
    <p>Several algorithms and software tools have been developed to address this problem. Some of these algorithms are restricted to the use of the total ion current (TIC) chromatogram [<xref rid="B6-metabolites-06-00039" ref-type="bibr">6</xref>,<xref rid="B7-metabolites-06-00039" ref-type="bibr">7</xref>,<xref rid="B8-metabolites-06-00039" ref-type="bibr">8</xref>], whereas most of the more recent approaches do not limit themselves to the chromatographic dimension and also include information from the <italic>m</italic>/<italic>z</italic> dimension [<xref rid="B9-metabolites-06-00039" ref-type="bibr">9</xref>,<xref rid="B10-metabolites-06-00039" ref-type="bibr">10</xref>,<xref rid="B11-metabolites-06-00039" ref-type="bibr">11</xref>]. The process of reducing the aforementioned <italic>m</italic>/<italic>z</italic> and Rt shifts between different LC-HRMS chromatograms is called alignment. The majority of the available tools, such as XCMS [<xref rid="B12-metabolites-06-00039" ref-type="bibr">12</xref>], MZMine [<xref rid="B13-metabolites-06-00039" ref-type="bibr">13</xref>]/MZMine2 [<xref rid="B14-metabolites-06-00039" ref-type="bibr">14</xref>] or the MapAligner tool of OpenMS [<xref rid="B15-metabolites-06-00039" ref-type="bibr">15</xref>], use warping techniques [<xref rid="B4-metabolites-06-00039" ref-type="bibr">4</xref>]. Warping shifts, stretches and/or compresses one or both dimensions (i.e., Rt and <italic>m</italic>/<italic>z</italic>) simultaneously to improve data consistency across different datafiles under investigation [<xref rid="B16-metabolites-06-00039" ref-type="bibr">16</xref>]. The applied warping function can be constant (i.e., a constant shift value across the whole chromatogram), linear (i.e., a constant change in shift over time) or non-linear (i.e., the change in shift is not constant). While many advanced warping algorithms exist [<xref rid="B9-metabolites-06-00039" ref-type="bibr">9</xref>,<xref rid="B17-metabolites-06-00039" ref-type="bibr">17</xref>,<xref rid="B18-metabolites-06-00039" ref-type="bibr">18</xref>], most of them are refined versions of either correlation optimized warping (COW) or dynamic time warping (DTW). Existing simple solutions suffer from various shortcomings such as model assumptions that fail to capture the behavior of real-world data, e.g., when applying a linear Rt shift function. More sophisticated and complex algorithms can yield increasingly accurate results using the non-linear retention time correction function (e.g., by the use of polynomial functions or splines). However, they often have undesirably long runtimes [<xref rid="B4-metabolites-06-00039" ref-type="bibr">4</xref>], which, combined with the fact that many of them are solely command line-based and lack a convenient user interface, hinders them from being widely used in the broad field of metabolomics.</p>
    <p>Here we present a software tool called MetMatch for the user-guided alignment of different LC-HRMS chromatograms. Chromatograms of interest can be aligned to a reference feature list consisting of reference metabolites and their ions (i.e., ID, <italic>m</italic>/<italic>z</italic>, retention time, etc.). The reference feature list can be generated manually or by processing single or multiple LC-HRMS chromatograms with one of the currently available software tools for untargeted metabolomics such as XCMS [<xref rid="B12-metabolites-06-00039" ref-type="bibr">12</xref>], MZMine2 [<xref rid="B14-metabolites-06-00039" ref-type="bibr">14</xref>], or MetExtract [<xref rid="B19-metabolites-06-00039" ref-type="bibr">19</xref>]. The alignment is performed using novel, efficient algorithms that correct offsets in the <italic>m</italic>/<italic>z</italic> as well as non-linear shifts in the Rt dimension. Apart from <italic>m</italic>/<italic>z</italic> and Rt shift correction, the formation of different ion species is also accounted for, which is a distinctive feature of MetMatch. Users can tweak all processing parameters through a simple, convenient and interactive user interface.</p>
    <p>The software is available free of charge for academic, non-commercial use and can be downloaded for Windows from [<xref rid="B20-metabolites-06-00039" ref-type="bibr">20</xref>]. Here, the software is exemplified with LC-HRMS data from untargeted metabolomics experiments investigating phenylalanine-derived metabolites in wheat and T-2 toxin/HT-2 toxin detoxification products in barley as well as artificial test data.</p>
  </sec>
  <sec id="sec2-metabolites-06-00039">
    <title>2. Materials and Methods</title>
    <sec id="sec2dot1-metabolites-06-00039">
      <title>2.1. Computational Workflow</title>
      <p>The general data processing steps performed by MetMatch are outlined in <xref ref-type="fig" rid="metabolites-06-00039-f001">Figure 1</xref>. Apart from generation and import of the reference feature list and output of the resulting data matrix, all processing steps are successively performed on a single datafile and then repeated for every file of a processed dataset. Details regarding the individual processing steps are provided in the following subsections.</p>
    </sec>
    <sec id="sec2dot2-metabolites-06-00039">
      <title>2.2. Inclusion of Alternative Ion Forms (Step 1)</title>
      <p>For each feature specified in the reference feature list, MetMatch generates an extended list of putative other ion adducts to account for differences in ion adduct formation between reference and target. These are typically caused by changes in eluent or other instrumental settings. Possible alternative ion species are provided by the user. If the ion species of a reference feature is known, MetMatch generates new ions based on the mass of the non-charged compound. In case the ion species of the reference feature is unknown, MetMatch first assumes this feature to be any ion species from the user-defined list, and then calculates the feature’s neutral mass and the <italic>m</italic>/<italic>z</italic> values of all putative ion species that can potentially occur for the particular compound.</p>
    </sec>
    <sec id="sec2dot3-metabolites-06-00039">
      <title>2.3. m/z Offset Detection (Steps 2 and 3)</title>
      <p>All signals of a target datafile that are within a certain Rt and <italic>m</italic>/<italic>z</italic> tolerance window (so-called search frame) around each reference feature are parsed from the respective datafile. For each search frame, the <italic>m</italic>/<italic>z</italic> shift of all included signals relative to the reference feature is calculated and weighted by the intensity of the signals. A histogram containing the weighted average <italic>m</italic>/<italic>z</italic> shift of all search frames of the datafile is then constructed. The <italic>m</italic>/<italic>z</italic> shift value of the bin with the highest frequency marks the constant systematic <italic>m</italic>/<italic>z</italic> offset of the respective datafile relative to the reference, as exemplified in <xref ref-type="fig" rid="metabolites-06-00039-f002">Figure 2</xref>. While averaging <italic>m</italic>/<italic>z</italic> shifts between individual search frames helps to properly estimate the overall <italic>m</italic>/<italic>z</italic> offset, multiple chromatographic peaks with similar retention time and <italic>m</italic>/<italic>z</italic> values within single search frames or peaks partly split between neighboring search frames may cause conflicts which are not resolved by MetMatch or any other metabolomics data processing software.</p>
      <p>After the detection of the <italic>m</italic>/<italic>z</italic> offset, <italic>m</italic>/<italic>z</italic> values of all signals inside the chromatogram are corrected by the calculated <italic>m</italic>/<italic>z</italic> shift. Corrected signals with an <italic>m</italic>/<italic>z</italic> deviation higher than a user defined ppm value are rejected, resulting in narrowed search frames.</p>
    </sec>
    <sec id="sec2dot4-metabolites-06-00039">
      <title>2.4. Peak Picking (Step 4)</title>
      <p>Following <italic>m</italic>/<italic>z</italic> offset detection, peak picking is performed on the remaining signals inside each narrowed search frame. Currently three different chromatographic peak picking algorithms have been implemented and can be selected in MetMatch. The MassSpecWavelet algorithm, while being very reliable, has significantly longer runtimes than the other two peak picking algorithms. These are based on Gaussian peak correlation and the Savitzky-Golay filter. For further details, please refer to <xref ref-type="app" rid="app1-metabolites-06-00039">Supplementary Materials Section 1.1</xref>.</p>
    </sec>
    <sec id="sec2dot5-metabolites-06-00039">
      <title>2.5. Rt Shift Detection (Step 5)</title>
      <p>Next, the Rt shift function is determined using all entries from the reference list. <xref ref-type="fig" rid="metabolites-06-00039-f003">Figure 3</xref>a–c outlines the creation of the initial Rt shift matrix, containing Rt shift information of all peaks of a datafile detected during the peak picking step (step 4).</p>
      <p>An iterative algorithm is then applied to deduce an Rt shift function through the Rt shift matrix, as exemplified in <xref ref-type="fig" rid="metabolites-06-00039-f004">Figure 4</xref>. The target peak that is closest to the Rt shift function but still within a user defined maximum tolerance is matched to the reference feature. For further details regarding the Rt shift detection algorithm, please refer to <xref ref-type="app" rid="app1-metabolites-06-00039">Supplementary Materials Section 1.2</xref>.</p>
      <p>After several iterations of the chromatographic alignment algorithm, a sufficient agreement of the correction function with the region of high density of putative matching peaks has been achieved, which can also be visually inspected and accepted/rejected by the user (<xref ref-type="fig" rid="metabolites-06-00039-f003">Figure 3</xref>d).</p>
    </sec>
    <sec id="sec2dot6-metabolites-06-00039">
      <title>2.6. Output of Generated Results (Step 6)</title>
      <p>After the <italic>m/z</italic> and chromatographic alignment steps have been determined, MetMatch applies these corrections to all chromatographic peaks from the reference feature list detected in the respective target chromatogram. This additional, new information (chromatographic peak area, corrected <italic>m/z</italic> value and retention time, calculated <italic>m/z</italic> and Rt shift) for each reference feature and processed target chromatogram are saved as an extended data matrix. Additionally, MetMatch also offers the option to save the processed target chromatograms as new mzXML files, in which all MS signals have been corrected by the determined <italic>m/z</italic> and Rt shifts.</p>
    </sec>
    <sec id="sec2dot7-metabolites-06-00039">
      <title>2.7. Phe-Derived Biological Data</title>
      <p>Two different test cases were chosen to demonstrate the MetMatch software tool. The first involves a dataset from a study investigating the metabolism of the aromatic amino acid phenylalanine (Phe) in wheat ears.</p>
      <p>For generation of the reference feature list, wheat plants of the cultivar “Remus” were grown in a glass house under controlled conditions and inoculated with <sup>13</sup>C<sub>9</sub> phenylalanine solution (~99.5% <sup>13</sup>C). Subsequent LC-HRMS measurement and TracExtract version 2 [<xref rid="B21-metabolites-06-00039" ref-type="bibr">21</xref>] data processing resulted in 151 Phe-derived features, which were detected in the <sup>13</sup>C-Phe-treated sample. In order to increase the number of features on the reference list and thereby enhance <italic>m</italic>/<italic>z</italic> and Rt correction accuracy, plants of the same cultivar were also raised in a tailor made growth chamber with <sup>13</sup>C enrichment of 98.8% as well as under native <sup>12</sup>CO<sub>2</sub> atmosphere in parallel. LC-HRMS analysis and data processing by AllExtract version 2 [<xref rid="B22-metabolites-06-00039" ref-type="bibr">22</xref>] resulted in 1482 features, which exclusively served to enlarge the reference list for matching Phe-derived metabolites in the samples of biological interest. The two resulting feature lists were merged (total of 1549 features) to create the reference feature list (for more details refer to <xref ref-type="app" rid="app1-metabolites-06-00039">Supplementary Materials Section 2.1</xref>) used in <xref ref-type="sec" rid="sec3dot8-metabolites-06-00039">Section 3.8</xref> as well as for artificial data evaluation (<xref ref-type="sec" rid="sec3dot10-metabolites-06-00039">Section 3.10</xref>). The generation of the reference feature list is outlined in <xref ref-type="app" rid="app1-metabolites-06-00039">Supplementary Materials Section 2.2</xref>. It shall also be mentioned that only the information related to features of the native metabolite ions has been used by MetMatch.</p>
      <p>For the target dataset, a study involving the two wheat cultivars “Remus” and “CM-82036” was chosen. Wheat plants (native, no <sup>13</sup>C-labeling) were grown in a glass house, treated with water at the flowering stage and harvested 96 h after inoculation. These samples represent a part of an untargeted metabolomics experiment consisting of about 450 samples, which was carried out in the year 2012. Twenty of these samples have been used in the presented manuscript to demonstrate MetMatch. For more details on the experiment, refer to Warth et al. [<xref rid="B23-metabolites-06-00039" ref-type="bibr">23</xref>]. Samples were prepared and measured with LC-HRMS as described by Bueschl et al. [<xref rid="B22-metabolites-06-00039" ref-type="bibr">22</xref>] on an LTQ Orbitrap XL instrument in August and September 2012. Measurement of the two samples serving as the reference was carried out in December 2015. Between the measurement of the reference and target datasets, the pump of the respective HPLC had been replaced (Accela 600 pump to Accela 1250 pump) and the chromatographic column had been renewed (same type and dimensions, different production charge). All other method parameters and instrumental setup remained constant for all measurements.</p>
    </sec>
    <sec id="sec2dot8-metabolites-06-00039">
      <title>2.8. T-2 Toxin/HT-2 Toxin-Derived Biological Data</title>
      <p>The second test case chosen to demonstrate the developed tool is a study investigating plant-derived metabolites of the mycotoxins T-2 toxin and HT-2 toxin in barley reported by Meng-Reiterer et al. [<xref rid="B24-metabolites-06-00039" ref-type="bibr">24</xref>]. For comparison, matching of results and generation of the reference feature list, two barley samples were treated with native and <sup>13</sup>C-labeled T-2 toxin and HT-2 toxin respectively. Measurements were performed using an LC-Q-TOF-system. The two chromatograms were processed using XCMS version 1.40.0, resulting in 20,682 features. T-2 toxin/HT-2 toxin-derived detoxification products reported by Meng-Reiterer et al. were matched to the list of barley metabolites. The time interval between generating the reference datafiles and measurement of the target files amounted to two years. Degradation of T-2 toxin/HT-2 toxin metabolites could therefore not be excluded. For further details regarding the generation of the reference feature list, please refer to <xref ref-type="app" rid="app1-metabolites-06-00039">Supplementary Materials Section 2.3</xref>.</p>
    </sec>
  </sec>
  <sec id="sec3-metabolites-06-00039">
    <title>3. Results and Discussion</title>
    <p>We present MetMatch, a novel software tool for the comparison and alignment of LC-HRMS data from different metabolomics experiments. MetMatch is implemented in Java 8, as its performance is comparable to C/C++ while offering flexibility and abstraction from low-level operations [<xref rid="B25-metabolites-06-00039" ref-type="bibr">25</xref>]. Additionally, a plethora of high quality Java libraries exists, which helps to reduce development time. Java packages used by MetMatch are listed in <xref ref-type="app" rid="app1-metabolites-06-00039">Supplementary Materials Section 1.3</xref>.</p>
    <p><xref ref-type="fig" rid="metabolites-06-00039-f005">Figure 5</xref> shows a schematic representation of the MetMatch data processing workflow and how it can be integrated into already existing analysis pipelines. Refer to <xref ref-type="sec" rid="sec2-metabolites-06-00039">Section 2</xref> for more details on the internal computational processing steps performed by MetMatch.</p>
    <p>The purpose of the developed tool is to provide a fast, easy and accurate method to automatically detect <italic>m</italic>/<italic>z</italic> and Rt shifts between multiple measurements or LC-HRMS datasets, align all features between reference and individual target files and generate a table of matched metabolic features for further investigation (e.g., statistical processing, metabolite annotation). Due to the successive pairwise matching of target datafiles against a single reference list, MetMatch can also be applied to correct for drifts across a measurement sequence. This can be used to investigate if a dataset exhibited systematic changes in Rt and <italic>m</italic>/<italic>z</italic> shift over time. Usability is facilitated by a comprehensive and interactive user interface (<xref ref-type="fig" rid="metabolites-06-00039-f006">Figure 6</xref>).</p>
    <p>The main motivation behind MetMatch is to support the comparison of results between various metabolomics experiments, for instance the investigation of newly generated biological knowledge (e.g., novel or identified/annotated metabolites) in previous datasets or the comparison of LC-HRMS data from experiments with slightly modified biological conditions or sampling times. <xref ref-type="sec" rid="sec3dot8-metabolites-06-00039">Section 3.8</xref> and <xref ref-type="sec" rid="sec3dot9-metabolites-06-00039">Section 3.9</xref> demonstrate the flexibility of MetMatch with newly characterized, phenylalanine-derived metabolites as well as T-2 toxin/HT-2 toxin detoxification products in barley.</p>
    <sec id="sec3dot1-metabolites-06-00039">
      <title>3.1. Accepted Input Files</title>
      <p>MetMatch requires a list of reference features in the form of a tab-separated values (tsv) file. This list is typically obtained by processing one or more chromatograms with software for data processing of untargeted metabolomics approaches and serves as a reference for further metabolite matching in target datafiles. Each feature must be specified by the retention time (Rt), the mass-to-charge ratio (<italic>m</italic>/<italic>z</italic>), a unique identification number and the identification number of the associated feature group (<xref ref-type="table" rid="metabolites-06-00039-t001">Table 1</xref>). Because of the generic nature of the tsv file format, output from various applications such as XCMS [<xref rid="B12-metabolites-06-00039" ref-type="bibr">12</xref>], MzMine2 [<xref rid="B14-metabolites-06-00039" ref-type="bibr">14</xref>] or MetExtract [<xref rid="B19-metabolites-06-00039" ref-type="bibr">19</xref>] can be used as a reference either directly or after minor modification. Such a reference list can also be created from scratch using any text editor and should at least contain the information specified in <xref ref-type="table" rid="metabolites-06-00039-t001">Table 1</xref>.</p>
      <p>The target chromatograms that are to be matched to the reference list have to be provided in the mzXML file format [<xref rid="B27-metabolites-06-00039" ref-type="bibr">27</xref>]. Most common vendor file formats can be easily converted to mzXML using freely available conversion tools such as ProteoWizard [<xref rid="B28-metabolites-06-00039" ref-type="bibr">28</xref>]. MetMatch also offers the option to load the unprocessed reference LC-HRMS chromatograms in the mzXML format for visualization. These are treated similar to target chromatograms by MetMatch and facilitate the visual assessment of EIC peaks underlying reference features as well as the success of the alignment process.</p>
    </sec>
    <sec id="sec3dot2-metabolites-06-00039">
      <title>3.2. Detection of Differently Formed Ions</title>
      <p>A chemical substance can form different ion species in the ion source of the mass spectrometer, such as protonated molecules ([M + H]<sup>+</sup>) or sodium ([M + Na]<sup>+</sup>) or ammonium ([M + NH<sub>4</sub>]<sup>+</sup>) adducts, each of which is detected at a unique <italic>m</italic>/<italic>z</italic> value. Especially when the ionization conditions vary between measurements (e.g., alteration of mobile phase composition or contamination of MS ion source), the relative fraction of the individual ion species may also change. Because of this, different ion species of the same metabolite might have been formed in the reference and target experiments, which poses a problem during comparison.</p>
      <p>MetMatch addresses this problem by expanding the reference feature list with new alternative ion species. As a result, all ion forms specified on a user-created list are automatically searched for in the target files and matched against the extended reference feature list.</p>
    </sec>
    <sec id="sec3dot3-metabolites-06-00039">
      <title>3.3. m/z Shift Detection</title>
      <p>LC-HRMS data often exhibit small shifts in mass accuracy within analytical batches, even if the MS instrument has been calibrated immediately before the measurements. Therefore, <italic>m</italic>/<italic>z</italic> shifts have to be accounted for, especially when comparing different batches or longer sequences that do not use some method of online mass calibration. Shifts in the <italic>m</italic>/<italic>z</italic> dimension typically show negligible variation within a single file [<xref rid="B4-metabolites-06-00039" ref-type="bibr">4</xref>], which is why MetMatch assumes a constant <italic>m</italic>/<italic>z</italic> offset per file. This constant <italic>m</italic>/<italic>z</italic> offset is estimated using a histogram containing the weighted average <italic>m</italic>/<italic>z</italic> offset of all search frames of a chromatogram file. Search frames are defined as the set of all signals of a chromatogram that fall within a certain user-defined Rt and <italic>m</italic>/<italic>z</italic> tolerance around a reference feature. Using reference histograms, which are generated as outlined in <xref ref-type="sec" rid="sec2dot3-metabolites-06-00039">Section 2.3</xref>, the <italic>m</italic>/<italic>z</italic> shift of the respective target file is determined, which is represented by the bin with the highest number of assigned ion signals.</p>
    </sec>
    <sec id="sec3dot4-metabolites-06-00039">
      <title>3.4. Rt Shift Detection</title>
      <p>While chromatograms within an analytical batch commonly only exhibit retention time shifts of small magnitude (usually less than the width of typical chromatographic peaks), this Rt shift can be more distinctive when comparing chromatograms from different analytical batches. In order to detect these Rt shifts, suitable alignment algorithms have to be employed [<xref rid="B29-metabolites-06-00039" ref-type="bibr">29</xref>]. MetMatch’s Rt shift correction method has been specifically developed for the detection of various forms of Rt shift, ranging from constant offsets to non-linear shifts in retention time.</p>
      <p>It is assumed that most metabolites eluting within a narrow Rt range share a similar Rt shift between different chromatograms. If this assumption is wrong, every alignment attempt solely based on a single Rt shift function yields erroneous results [<xref rid="B30-metabolites-06-00039" ref-type="bibr">30</xref>]. Therefore, most of a chromatogram’s metabolite peaks should locally share an Rt shift, which can be described by a smooth function across a chromatogram. The Rt-alignment algorithm implemented in MetMatch uses an iterative approach to detect this Rt shift function. Since MetMatch provides an animated preview of the algorithm, the resulting function to be used for alignment of chromatograms can immediately be assessed visually and parameter settings can therefore be easily and quickly optimized by the user. When an appropriate balance between global and local alignment has been achieved, the user-guided settings may be applied to all samples in a dataset. The resulting alignment of each chromatogram can then be reviewed and adapted if necessary.</p>
      <p>The applied Rt shift detection method has two limitations: (i) Depending on differences in their chemical structures, some metabolites may change their elution order due to variations in experimental conditions between the reference and target datafiles [<xref rid="B30-metabolites-06-00039" ref-type="bibr">30</xref>]. Based on Rt and <italic>m</italic>/<italic>z</italic> information alone, it is impossible to detect such changes, and therefore these features cannot be correctly matched; (ii) Reference list and target datafiles have to be compatible with regard to their features. If too few compounds/feature groups are shared between both of them, the quality of the resulting estimated Rt shift can decrease significantly. The minimum number of common feature groups has been exemplified with artificial data in <xref ref-type="sec" rid="sec3dot10dot4-metabolites-06-00039">Section 3.10.4</xref>. It is worth mentioning that not all features contained within the reference feature list have to be of biological interest. Additional features may be included only for the purpose of increasing the accuracy of the <italic>m</italic>/<italic>z</italic> and Rt shift detection. We have also chosen this approach in the two experiments described below to exemplify MetMatch.</p>
    </sec>
    <sec id="sec3dot5-metabolites-06-00039">
      <title>3.5. Manual Corrections of Automatically Generated Results</title>
      <p>All processing results can be verified and corrected manually using MetMatch’s interactive user interface. EICs are visualized and can be used to assess the initial signal extraction parameters as well as the quality of the detected peaks. The user is able to easily delete or manually pick peaks if necessary. Furthermore, the weight of individual EIC peaks can be increased according to their likelihood of representing the correctly matched metabolite ions. This way, the user can guide the automated Rt alignment algorithm with useful information in the form of user-verified “anchor” metabolites. Matched peaks are highlighted directly in the corresponding EIC’s and can be visually aligned to assess the automated processing result.</p>
    </sec>
    <sec id="sec3dot6-metabolites-06-00039">
      <title>3.6. Output Format</title>
      <p>The final result of MetMatch’s alignment routine is a tab-separated values (tsv) file containing the matched chromatographic peaks of all processed target chromatograms and datasets. It is essentially an extended reference feature list, containing the additional information derived from the matched chromatograms as exemplified in <xref ref-type="table" rid="metabolites-06-00039-t002">Table 2</xref>. If new ions were detected, they are included as additional rows in the data matrix. For each processed datafile, every matched chromatographic peak is specified by its EIC peak area, Rt and <italic>m</italic>/<italic>z</italic> value as well as their respective offsets by default. Additionally, <italic>m</italic>/<italic>z</italic>- and Rt-shift-corrected mzXML files can also be generated, which will contain all signals of the respective target chromatograms, however, their <italic>m</italic>/<italic>z</italic> and Rt values will be corrected using the MetMatch-derived shifts. Features which were not part of the reference list and were therefore not considered for the <italic>m</italic>/<italic>z</italic> and Rt correction by MetMatch are still corrected and linear interpolation is used whenever needed. These corrected mzXML files can then be viewed or further processed with other software tools capable of reading the mzXML format.</p>
    </sec>
    <sec id="sec3dot7-metabolites-06-00039">
      <title>3.7. Runtimes</title>
      <p>The runtime of MetMatch is linear with respect to the number of files and the number of entries in the reference feature list. Actual runtimes heavily depend on the applied peak-picking algorithm. For further details on the individual peak-picking algorithms, please refer to <xref ref-type="app" rid="app1-metabolites-06-00039">Supplementary Materials Section 1.1</xref>. Typical runtimes of the different algorithms for chromatographic peak picking on an Intel Core 2 Duo (2.8 GHz) are listed in <xref ref-type="app" rid="app1-metabolites-06-00039">Supplementary Materials Table S1</xref>.</p>
    </sec>
    <sec id="sec3dot8-metabolites-06-00039">
      <title>3.8. Evaluation of the Phe-Derived Biological Metabolites</title>
      <p>A metabolomics experiment studying phenylalanine (Phe)-derived metabolites in wheat was chosen as a reference. Seventy-five Phe-derived metabolites were detected and subsequently matched to a previous wheat experiment using MetMatch. Before matching, the reference list was extended to include metabolites that are not of interest (i.e., non-Phe-derived wheat metabolites), but help improve the accuracy of the <italic>m</italic>/<italic>z</italic> and Rt shift calculations. Refer to <xref ref-type="app" rid="app1-metabolites-06-00039">Supplementary Materials Section 2.2</xref>. for details on the creation of the reference feature list. While all features contained in the reference feature list have been used by MetMatch to correct the <italic>m</italic>/<italic>z</italic> and Rt shifts, data evaluation has been limited to the Phe-derived features since only those have been of scientific interest in the respective biological study. Rt shifts were to be expected since the two datasets were generated in the years 2012 and 2015. Furthermore, the HPLC pump and the chromatographic column had been replaced between the two experiments.</p>
      <p>Processing all 22 files using MetMatch took 24 min on an Intel Core 2 Duo (2.8 GHz) with the parameters listed in <xref ref-type="app" rid="app1-metabolites-06-00039">Supplementary Materials Section 2.1</xref>. Matching chromatographic peaks for 92 of the 151 Phe-derived metabolite features contained in the reference feature list were detected in at least five target datafiles using MetMatch. Only 42 of these features were matched if differently formed ion adducts were not accounted for. On average, the software determined an <italic>m</italic>/<italic>z</italic> shift of −3.4 ppm as well as a non-linear retention time shift ranging from 7 to 52 s as illustrated in <xref ref-type="app" rid="app1-metabolites-06-00039">Figure S2 in the Supplementary Materials</xref>.</p>
      <p>To compare the detected Rt shift of MetMatch with another commonly used software tool in the field of metabolomics, the same chromatograms have also been processed and aligned with XCMS. XCMS processing took 73 min on a similar computer (Intel Core 2 Duo, 2.9 GHz, no multithreading). However, XCMS uses an untargeted approach and therefore does not use the reference feature list. The resulting Rt shift functions obtained by MetMatch and XCMS agree across the majority of the Rt range of interest (3 to 36 min). Rt values smaller than 7 min, however, show reduced consensus. The underlying data shows only few signals in this Rt region, and it was not possible to definitively confirm or reject any of the two proposed Rt shifts by means of manual investigation. The calculated retention time shift functions of MetMatch and XCMS were compared using the Pearson correlation coefficient. For this, the calculated retention time shift functions of MetMatch and XCMS were compared pairwise. Between the retention time interval of 3 to 38 min, a mean correlation of 0.858 (standard deviation of 0.042) was calculated. However, for the retention time interval of 7 to 38 min, the average correlation increased to 0.926 (standard deviation of 0.011), which confirms that MetMatch better detected the retention time shifts in areas where more reference features are present and that the detected retention time shift functions of MetMatch and XCMS are very similar. A comparative illustration of the retention time shifts detected by MetMatch and XCMS is shown in <xref ref-type="app" rid="app1-metabolites-06-00039">Figure S2 in Supplementary Materials</xref>.</p>
      <p>MetMatch’s capability of matching different ion species has been tested by means of matching the same target samples as before and additionally using chromatograms measured in negative ionization mode. The used reference feature list only contained ions measured in positive ionization mode. Matching them to the samples obtained in negative ionization mode requires the inclusion of alternative negative adduct ions in the reference feature list. This was automatically done by MetMatch as described in <xref ref-type="sec" rid="sec2dot2-metabolites-06-00039">Section 2.2</xref>. Possible positive (e.g., [M + H]<sup>+</sup>, [M + Na]<sup>+</sup>, [M + NH<sub>4</sub>]<sup>+</sup>) as well as negative (e.g., [M − H]<sup>−</sup>, [M + Na − 2H]<sup>−</sup>, [M + Cl]<sup>−</sup>) ion species had to be provided by the user. <xref ref-type="app" rid="app1-metabolites-06-00039">Figure S3 in Supplementary Materials</xref> shows a comparison of the Rt shift functions obtained by matching positive and negative files to the positive reference feature list. The resulting Rt shifts for positive and negative chromatograms agree well. The Pearson correlation coefficient for chromatograms obtained in the positive and negative ionization modes for the same sample were calculated. On average, a correlation of 0.826 (standard deviation of 0.038) was calculated for the retention time interval of 3 to 38 min. The correlation improved to an average of 0.977 (standard deviation of 0.008) when the retention time interval of 7 to 38 min was used, in which most of the features of the reference feature list were present. This demonstrates that MetMatch was able to match target files and a reference feature list that share no common ion species by extending the reference feature list with alternative putative ion species. Without accounting for differently formed ion species, matching positive and negative ionization data would not be possible in that way.</p>
      <p>To validate the results generated by MetMatch, selected Phe-derived features have been manually investigated in the raw data of reference and target files (Thermo Xcalibur Software, version 2.2). To this end, the correctness and plausibility of the proposed <italic>m</italic>/<italic>z</italic> and Rt shifts was examined for 23 features in 10 files, ranging from low to high <italic>m</italic>/<italic>z</italic>- as well as Rt values. The calculated shift of 19 chromatographic peaks could be confirmed in all files. One peak could not be correctly matched in any file, because it was detected at a very early Rt. Very few other peaks were detected around this Rt, leading to an inaccurate Rt shift function for this Rt region. Two peaks were not matched in some files since their retention time shifts were slightly above the maximum allowed Rt shift tolerance around the Rt shift function. This could have been solved by increasing the tolerance, at the risk of including false positives. One peak could not be reliably matched in all files because of the peak shape (shoulder peak). For a table containing the manually investigated features, please refer to <xref ref-type="app" rid="app1-metabolites-06-00039">Supplementary Materials Table S2</xref>.</p>
      <p>EICs of one of the manually validated chromatographic peaks are shown in <xref ref-type="fig" rid="metabolites-06-00039-f007">Figure 7</xref>. Here, the usefulness of MetMatch becomes apparent, since manual comparison of the two experiments could have easily resulted in an incorrect match.</p>
    </sec>
    <sec id="sec3dot9-metabolites-06-00039">
      <title>3.9. Evaluation of the T-2 Toxin/HT-2 Toxin-Derived Biological Data</title>
      <p>In the second test case, 36 T-2 toxin/HT-2 toxin-derived metabolite ions were matched to a previous barley experiment (<xref ref-type="app" rid="app1-metabolites-06-00039">Supplementary Materials Section 2.3</xref>). Since two years have passed between the two experiments, possible Rt shifts were expected. The reference list was again extended to improve the accuracy of Rt correction. This time, all features detected with an untargeted approach facilitated by XCMS were used as the reference feature list. Processing all five files using MetMatch took 5 min on an Intel Core 2 Duo (2.8 GHz) using the parameters listed in <xref ref-type="app" rid="app1-metabolites-06-00039">Supplementary Materials Section 2.3</xref>. MetMatch determined a non-linear retention time shift ranging from −9 to −24 s as illustrated in <xref ref-type="app" rid="app1-metabolites-06-00039">Figure S4 in Supplementary Materials</xref>.</p>
      <p>Again, the retention time alignment calculated by MetMatch was compared to that detected by XCMS for the same chromatograms. XCMS processing took 40 min on a similar computer (Intel Core 2 Duo, 2.9 GHz, no multithreading). However, it shall be mentioned that XCMS uses an untargeted approach and therefore does not make use of the reference feature list. The resulting Rt shift functions obtained by MetMatch and XCMS agree across the majority of the Rt range of interest (3 to 22 min). Rt values below 5 min, however, show no consensus. The underlying data show only few signals in this Rt region, and thus it was not possible to definitively confirm or reject any of the two proposed Rt shifts by means of manual investigation. Again, the Pearson correlation coefficient was used to calculate the similarity of the retention time shift functions calculated by MetMatch and XCMS. The average correlation was 0.966 (standard deviation of 0.013) in the retention time interval of 4 to 22.5 min, demonstrating that both MetMatch and XCMS calculated very similar retention time shift functions for the chromatograms. An illustration of the retention time shifts detected by MetMatch and XCMS is shown in <xref ref-type="app" rid="app1-metabolites-06-00039">Figure S4 in Supplementary Material</xref>.</p>
      <p>Thirty-two out of 36 T-2 toxin/HT-2 toxin-derived metabolite ions were successfully matched in all target chromatograms. Three chromatographic peaks could not be correctly matched in any file because they were detected at an early Rt. Too few other peaks were detected around this Rt, leading to an inaccurate Rt shift function for this Rt region. One chromatographic peak was missed in two of the files during peak picking, because of its low abundance (peak height lower than 3000 counts) and its poor peak shape.</p>
    </sec>
    <sec id="sec3dot10-metabolites-06-00039">
      <title>3.10. Evaluation of Artificial Data</title>
      <p>While the evaluation of real-world data can provide important insight into the general quality of the resulting matches, knowledge of the true shifts is required in order to properly assess the results generated by MetMatch. To this end, several artificial datasets have been generated to test MetMatch’s performance. For each of these artificial tests, the reference list used in the Phe experiment (<xref ref-type="sec" rid="sec2dot7-metabolites-06-00039">Section 2.7</xref>) has been modified by applying various <italic>m</italic>/<italic>z</italic> and Rt shifts. The original, unmodified reference chromatogram served as the target. These two datasets were then used as input for MetMatch and the generated results were compared to the artificially applied modifications. This approach was used to assess the number of true positives (Tp), false positives (Fp), false negatives (Fn) as well as precision, recall and F-measure. When matching the chromatogram directly to the unmodified reference feature list, results for a match without the need to correct for Rt or <italic>m</italic>/<italic>z</italic> shifts were obtained. This also served as a benchmark for further tests. The results of this match are displayed in <xref ref-type="table" rid="metabolites-06-00039-t003">Table 3</xref>.</p>
      <p>From the 1482 features in the reference list (originating from two separate datafiles, for more details see Materials and Methods), 1446 were correctly matched, while 36 could not be matched. The reference feature list is based on two chromatograms (<xref ref-type="sec" rid="sec2dot7-metabolites-06-00039">Section 2.7</xref>), including some metabolites that were only detected in the chromatogram that was not used as a target here. Therefore, the corresponding EIC peaks of the underlying metabolites were not detectable during peak picking. Moreover, although both MetExtract and MetMatch applied the MassSpecWavelet peak-picking algorithm, slightly different results were obtained. Since the algorithm is applied in the context of two different software tools, which have very similar EIC extraction approaches but do not share a common implementation, the output of the peak-picking algorithm can vary slightly. Even though these chromatographic peaks could not directly be matched to features on the reference list, their expected Rts were correctly interpolated.</p>
      <sec id="sec3dot10dot1-metabolites-06-00039">
        <title>3.10.1. Formation of Different Ion Species</title>
        <p>The automated search for differently formed ion species of the same metabolite is a distinct feature of MetMatch. To estimate the performance of the applied technique, the <italic>m</italic>/<italic>z</italic> values of all features in the reference list have been modified. The goal was to simulate a situation in which all metabolites contained in the reference list constituted the same type of ion species (A1), while for all of these metabolites a single different ion species (A2) was assumed for the target datafiles. Thus, the extended lists contained the <italic>m</italic>/<italic>z</italic> values of hypothetical adducts, which are not part of the original chromatogram. The inclusion of A1 and A2 in the target ion list, which is used to detect alternatively formed ion species, should allow MetMatch to detect all features regardless of their (modified) ion species. The results of this performance test are displayed in <xref ref-type="table" rid="metabolites-06-00039-t004">Table 4</xref>.</p>
        <p>MetMatch successfully matched 1446 chromatographic peaks to features although they were simulated to be present as different ion species. The results are identical to the benchmark evaluation (see above), suggesting that MetMatch is able to match features regardless of their differing ion adducts.</p>
      </sec>
      <sec id="sec3dot10dot2-metabolites-06-00039">
        <title>3.10.2. <italic>m</italic>/<italic>z</italic> Shift Detection</title>
        <p>To test the accuracy and reliability of <italic>m</italic>/<italic>z</italic> shift correction, various modified reference feature lists have been created which display <italic>m</italic>/<italic>z</italic> offsets of −10 to +10 ppm in 1 ppm incremental steps. In total, 21 different lists have been created to assess the difference between the artificially imposed <italic>m</italic>/<italic>z</italic> offset and the value calculated by MetMatch (<xref ref-type="fig" rid="metabolites-06-00039-f008">Figure 8</xref>). The bins used in the underlying <italic>m</italic>/<italic>z</italic> offset calculation were set to a size of 0.01 ppm. Further decreasing the bin size did not increase the accuracy.</p>
        <p>No correlation between the magnitude of artificially imposed <italic>m</italic>/<italic>z</italic> offset and the accuracy of MetMatch with respect to the correctly matched reference features in the target chromatogram has been observed. Differences between imposed and detected <italic>m</italic>/<italic>z</italic> offset were within the range of +0.01 to −0.05 ppm for all simulated cases. This is significantly less than the mass variation across a typical chromatographic peak recorded on the used LTQ Orbitrap instrument. In this test, the observed <italic>m</italic>/<italic>z</italic> discrepancy is explained by the fact that the <italic>m</italic>/<italic>z</italic> values of the reference features were calculated based on two chromatograms (<xref ref-type="sec" rid="sec2dot7-metabolites-06-00039">Section 2.7</xref>). Thus, it is not surprising that the chromatogram, which was matched to this reference list, shows a marginal <italic>m</italic>/<italic>z</italic> deviation.</p>
      </sec>
      <sec id="sec3dot10dot3-metabolites-06-00039">
        <title>3.10.3. Rt Shift Detection</title>
        <p>Six modified reference feature lists were created displaying varying degrees of Rt shift relative to the original chromatogram. The applied retention time transformations are illustrated in <xref ref-type="fig" rid="metabolites-06-00039-f009">Figure 9</xref>, column “Simulated Rt Shift”. On top of the respective systematic shifts, all feature groups were shifted randomly by ±6 s, simulating small Rt shifts observed in real-world data. Additionally, differently formed ion adducts were simulated analogous to <xref ref-type="sec" rid="sec3dot10dot1-metabolites-06-00039">Section 3.10.1</xref>.</p>
        <p>Irrespective of the tested simulation, MetMatch achieved a high degree of correctly matched chromatographic peaks that are almost identical to the benchmark test. Occasionally, values exceeding the benchmark could also be observed due to slight variations in the generated EICs, which sometimes led to different peak-picking results. Although some features were incorrectly matched, the number of Fp (5 to 16) was quite low compared to Tp (1389 to 1448). Some of the Fp originated from the alternative ion species that were added to the reference feature list. In case of the modified reference feature list simulating a discontinuous Rt shift (simulation 3), the lowest number of correctly matched chromatographic peaks to reference features was observed. This is not surprising, since the algorithm tries to detect a continuous Rt shift (see <xref ref-type="sec" rid="sec2dot5-metabolites-06-00039">Section 2.5</xref>) and only approximates the discontinuous shift applied in simulation 3. Especially around the erratic increase, MetMatch failed to fit the theoretical shift correctly. However, the number of 1389 correctly matched chromatographic peaks in contrast to 16 incorrectly matched peaks still corresponds to an F-measure value of 0.962. All other artificial Rt shifts resulted in F-measure values ranging from 0.983 to 0.987, which, compared to the benchmark F-measure value of 0.988, shows that MetMatch reliably detected the applied Rt shifts and produced high quality results.</p>
      </sec>
      <sec id="sec3dot10dot4-metabolites-06-00039">
        <title>3.10.4. Minimum Required Common Feature Groups</title>
        <p>As outlined in <xref ref-type="sec" rid="sec3dot4-metabolites-06-00039">Section 3.4</xref>, a minimum number of feature groups has to be part of the reference feature list as well as the target chromatograms; otherwise, the Rt shift function cannot be reliably calculated. To test how large this number has to be in order to obtain reliable results, the reference feature list of <xref ref-type="sec" rid="sec3dot10dot3-metabolites-06-00039">Section 3.10.3</xref>, simulation 6, has been repeatedly matched to the original chromatogram, as described in <xref ref-type="sec" rid="sec3dot10-metabolites-06-00039">Section 3.10</xref>. The number of common feature groups has been varied from 505 (complete list) to one. Starting from the complete list, subsets of decreasing size (each list being 25% smaller than its predecessor) have been created. This way, 20 reference feature lists with a decreasing number of common feature groups were simulated. Feature groups were deleted at random. This approach was repeated 10 times, cumulating in 200 MetMatch processing runs. The resulting F-measures for the various number of matched feature groups are shown in <xref ref-type="fig" rid="metabolites-06-00039-f010">Figure 10</xref>.</p>
        <p>On average, 159 common feature groups were required to maintain the same accuracy as achieved by 505 common feature groups. All test runs resulted in F-measures greater than 0.9 if at least 89 common feature groups were present. Decreasing the number to 49 common features groups still resulted in F-measures greater than 0.8 for all test runs. Below this number, the accuracy dropped more quickly. However, these numbers might vary for other datasets, as they are highly dependent on the number of isomers in each narrowed search frame (i.e., after <italic>m</italic>/<italic>z</italic> shift correction) as well as the number of narrowed search frames solely containing unrelated peaks. The higher these numbers, the higher the minimum required number of common feature groups.</p>
      </sec>
    </sec>
  </sec>
  <sec id="sec4-metabolites-06-00039">
    <title>4. Conclusions</title>
    <p>Metabolomics is a valuable tool for studying phenotype changes [<xref rid="B1-metabolites-06-00039" ref-type="bibr">1</xref>] and is therefore widely used. Retrospective and comparative analysis of LC-HRMS chromatograms of separate biological experiments is of particular interest since they hold a considerable amount of information that can be used to investigate aspects beyond the scope of their initial acquisition and evaluation [<xref rid="B2-metabolites-06-00039" ref-type="bibr">2</xref>]. However, the reliable, comparative analysis is still an issue, due to shifts and drifts of retention time (Rt) and mass-to-charge ratio (<italic>m</italic>/<italic>z</italic>) or the formation of different ion species caused by the limited stability of experimental and instrument parameters. This holds true when comparing results obtained in multiple analytical batches using the same instrument, and especially when obtained by different instruments [<xref rid="B5-metabolites-06-00039" ref-type="bibr">5</xref>]. Several algorithms and software tools have been proposed to address this problem, but many of them suffer from severe drawbacks such as incorrect model assumptions and long run times [<xref rid="B4-metabolites-06-00039" ref-type="bibr">4</xref>].</p>
    <p>In this respect, MetMatch is a novel software tool for the comparison of LC-HRMS data utilized through a convenient user interface. Chromatograms are matched to a feature list, which can be created manually or by processing one or multiple datafile(s), which serves as a reference. Constant shifts in <italic>m</italic>/<italic>z</italic> are automatically detected and corrected for. Both linear and non-linear Rt shift correction is achieved using a fast, iterative algorithm based on the observation that metabolites/compounds exhibiting similar Rt values within a measurement usually share analogous Rt shifts between measurements. Furthermore, MetMatch is able to account for the formation of different ion species that may be formed under slightly differing experimental conditions. The developed software offers a convenient graphical user interface that allows for easy optimization and verification of every processing step.</p>
    <p>The quality of results obtained by MetMatch was assessed using two different test cases. The first case involved 75 newly characterized Phe-derived metabolites that were matched to a previous wheat experiment. Manual validation of 23 selected features was performed, 19 of which could be confirmed in all 10 inspected target files. Additionally, 36 T-2 toxin/HT-2 toxin-derived metabolite ions were matched to another barley experiment, 32 of which could be manually verified in all three target files. In both cases, MetMatch-derived Rt shifts were very similar to XCMS processing results. Furthermore, software evaluation by means of artificially manipulated reference data showed that MetMatch is well suited to account for the formation of different ion species between reference and target datasets and that both <italic>m</italic>/<italic>z</italic> and Rt shifts are detected with high accuracy (on average, 96.9% of all peaks were correctly matched).</p>
    <p>In conclusion, we think that MetMatch will be a useful tool for the comparative analysis of metabolomics LC-HRMS experiments and we plan to add additional functionalities such as detection of non-linear <italic>m</italic>/<italic>z</italic> shifts and automatic assignment/correction of questionable matched features to further improve accuracy.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>The authors thank Elisabeth Varga and Franz Berthiller for providing technical assistance with the QTOF-LC-HRMS measurements of the T-2/HT-2 example. We also thank the anonymous reviewers for their careful reading of our manuscript and their many insightful comments and suggestions. The Austrian Science Fund (projects: Metabolism of T-2 and HT-2 P26213 and SFB-Fusarium-F37, subproject 3715) and the Government of Lower Austria (projects: NovAlgo and NoBiTUM) are acknowledged for financial support.</p>
  </ack>
  <app-group>
    <app id="app1-metabolites-06-00039">
      <title>Supplementary Materials</title>
      <p>The Supplementary materials are available online at <uri xlink:type="simple" xlink:href="http://www.mdpi.com/2218-1989/6/4/39/s1">http://www.mdpi.com/2218-1989/6/4/39/s1</uri>: Figure S1. Pseudocode of the iterative retention time (Rt) shift detection algorithm; Figure S2. Comparison of the Rt shift detected in the Phe-derived biological experiment using MetMatch and XCMS relative to the selected reference chromatogram; Figure S3. Comparison of the Rt shift detected in the Phe-derived biological experiment using chromatograms obtained in positive and negative ionization mode for the same samples; Figure S4. Comparison of the Rt shift detected in the T-2 toxin/HT-2 toxin–derived biological experiment using MetMatch and XCMS relative to the selected reference chromatograms; Table S1. Sample runtimes measured on an Intel Core 2 Duo (2.8 GHz); Table S2. Manual validation of the results obtained by matching the target dataset to the reference feature list containing Phe-derived metabolites.</p>
      <supplementary-material content-type="local-data" id="metabolites-06-00039-s001">
        <media xlink:href="metabolites-06-00039-s001.pdf">
          <caption>
            <p>Click here for additional data file.</p>
          </caption>
        </media>
      </supplementary-material>
    </app>
  </app-group>
  <notes>
    <title>Author Contributions</title>
    <p>Stefan Koch designed, implemented and tested the MetMatch software and wrote large parts of the manuscript. Christoph Bueschl co-supervised Stefan Koch and performed data processing of the reference datasets. Maria Doppler analyzed the wheat samples with LC-Orbitrap-HRMS. Alexandra Simader verified the MetMatch software. Jacqueline Meng-Reiterer analyzed the T-2/HT-2 samples with LC-QTOF-HRMS. Marc Lemmens was responsible for the biological experiments. Rainer Schuhmacher contributed to the design of MetMatch and supervised the work. All authors contributed to the manuscript and read and approved the final version of the article.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Conflicts of Interest</title>
    <p>The authors declare no conflict of interest.</p>
  </notes>
  <glossary>
    <title>Abbreviations and Terminology</title>
    <p>The following abbreviations and terminologies are used in this manuscript:
<array><tbody><tr><td align="left" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1"><bold>Binning</bold></td><td align="left" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">A range (e.g., <italic>m</italic>/<italic>z</italic> or Rt shift values) is divided into a series of equally long intervals (bins).</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>Dataset</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">A list of LC-HRMS datafiles belonging to one analytical batch, originating from the same experiment.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>EIC</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Extracted ion chromatogram. An EIC represents the abundance/intensity of a certain <italic>m/z</italic> value in each mass spectrum of a chromatogram. The mass spectra are sorted according to their acquisition time relative to injecting the sample into the HPLC instrument. Usually a small deviation from the selected <italic>m/z</italic> value (± ppm; depending on the used HRMS instrument) is allowed to account for minor scan-to-scan <italic>m/z</italic> inconsistencies observed during acquisition of a chromatogram.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>Feature</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">A feature represents a particular metabolite ion of interest. It is characterized by its <italic>m</italic>/<italic>z</italic> value (experimental and theoretical) and retention time (as calculated by the used peak-picking algorithm). Features are usually the result of an untargeted metabolomics data processing approach and typically comprise multiple chromatographic peaks, one per LC-HRMS chromatogram.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>Feature group</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">All features originating from the same chemical substance and hence sharing the same Rt and peak shape.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>F-measure</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Harmonic mean of precision and recall.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>Fn</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">False negatives. Features that were not matched.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>Fp</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">False positives. If a matched feature does not meet the criteria to be considered as Tp, it is an Fp.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>LC-HRMS</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Liquid chromatography coupled to high resolution mass spectrometry.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold><italic>m</italic>/<italic>z</italic></bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Mass-to-charge ratio.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>Peak/Chromatographic peak</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">A chromatographic peak representing a particular feature in a chromatogram. Other than a feature, a peak has a defined <italic>m</italic>/<italic>z</italic> value, a retention time (as defined by the used peak-picking algorithm) as well as a peak area. Peaks are detected by the means of a peak-picking algorithm.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>Peak apex</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">The time at which the most abundant signal of a respective chromatographic peak is detected after injection of the sample into the HPLC instrument.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>Peak center</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">The time at which a chromatographic peak has its center of gravity. (Time) measurement is started with injecting the sample into the HPLC instrument.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>Precision</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Percentage of matched reference features that were correctly matched. Calculation: Number of Tp divided by the number of Tp plus Fp.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>Recall</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Percentage of all reference features that were correctly matched. Calculation: Number of Tp divided by the number of all reference features.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>Reference dataset</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">A single or multiple LC-HRMS datafiles, which are used to generate the reference feature list.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>Reference feature list</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">List of features to which target datasets are matched.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>Rt</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Retention time.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>Rt shift function</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">A function that holds the calculated retention time shift between a target chromatogram relative to the reference feature list. It is used to map the retention times of detected chromatographic peaks in the target chromatogram to the retention time of the features in the reference list.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>Search frame</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Signals of a chromatogram (single datafile) that fall within a certain Rt and <italic>m</italic>/<italic>z</italic> tolerance window around a reference feature. These values have to be slightly larger than the maximum expected shift. (e.g., 1.5 min Rt shift and 10 parts per million (ppm) <italic>m</italic>/<italic>z</italic> shift for a typical LC-HRMS chromatogram).</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>Rt shift array</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">An array containing the Rt shift of all peaks detected within a search frame relative to the retention time of the respective reference feature. First, a search frame is discretized into smaller bins (number of bins is set by the user of MetMatch) each representing a certain Rt offset relative to the retention time of the respective reference feature. Then, those Rt bins for which chromatographic peaks of the respective reference feature were detected in the target chromatogram, are assigned weight values greater than zero (either automatically or user-guided). Any Rt offset bin for which no chromatographic peak was detected, is assigned zero value and thus do not contribute to the Rt shift detection algorithm. The number of entries in each Rt shift array is set by the user during the iterative Rt alignment step. Each entry in the Rt shift array corresponds to a certain Rt deviation between the retention times of the reference features and their corresponding chromatographic peaks in the target chromatograms.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>Rt shift matrix</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">The individual Rt shift arrays of all reference feature groups are concatenated column-wise and sorted by the retention time of their reference feature group. Each column represents a feature group, while rows represent discretized Rt shift values.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>Target dataset</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">A list of LC-HRMS datafiles to be matched to a reference feature list.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><bold>Tp</bold></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">True positives. Matched features are considered Tp if their <italic>m</italic>/<italic>z</italic> deviation is ≤5 ppm and their Rt deviation is ≤8.4 s (manually validated threshold value for the distinction of Tp and Fp in this datafile) relative to the reference feature after shift correction. The formation of different ion species is taken into account when comparing the <italic>m</italic>/<italic>z</italic>.</td></tr></tbody></array>
</p>
  </glossary>
  <ref-list>
    <title>References</title>
    <ref id="B1-metabolites-06-00039">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dettmer</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Aronov</surname>
            <given-names>P.A.</given-names>
          </name>
          <name>
            <surname>Hammock</surname>
            <given-names>B.D.</given-names>
          </name>
        </person-group>
        <article-title>Mass spectrometry-based metabolomics</article-title>
        <source>Mass Spectrom. Rev.</source>
        <year>2007</year>
        <volume>26</volume>
        <fpage>51</fpage>
        <lpage>78</lpage>
        <pub-id pub-id-type="doi">10.1002/mas.20108</pub-id>
        <?supplied-pmid 16921475?>
        <pub-id pub-id-type="pmid">16921475</pub-id>
      </element-citation>
    </ref>
    <ref id="B2-metabolites-06-00039">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fiehn</surname>
            <given-names>O.</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics—The link between genotypes and phenotypes</article-title>
        <source>Plant Mol. Biol.</source>
        <year>2002</year>
        <volume>48</volume>
        <fpage>155</fpage>
        <lpage>171</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1013713905833</pub-id>
        <?supplied-pmid 11860207?>
        <pub-id pub-id-type="pmid">11860207</pub-id>
      </element-citation>
    </ref>
    <ref id="B3-metabolites-06-00039">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patti</surname>
            <given-names>G.J.</given-names>
          </name>
          <name>
            <surname>Yanes</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Siuzdak</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Innovation: Metabolomics: The apogee of the omics trilogy</article-title>
        <source>Nat. Rev. Mol. Cell Biol.</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>263</fpage>
        <lpage>269</lpage>
        <pub-id pub-id-type="doi">10.1038/nrm3314</pub-id>
        <?supplied-pmid 22436749?>
        <pub-id pub-id-type="pmid">22436749</pub-id>
      </element-citation>
    </ref>
    <ref id="B4-metabolites-06-00039">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Ventura</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Prince</surname>
            <given-names>J.T.</given-names>
          </name>
        </person-group>
        <article-title>LC-MS alignment in theory and practice: A comprehensive algorithmic review</article-title>
        <source>Brief. Bioinform.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>104</fpage>
        <lpage>117</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbt080</pub-id>
        <?supplied-pmid 24273217?>
        <pub-id pub-id-type="pmid">24273217</pub-id>
      </element-citation>
    </ref>
    <ref id="B5-metabolites-06-00039">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aberg</surname>
            <given-names>K.M.</given-names>
          </name>
          <name>
            <surname>Alm</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Torgrip</surname>
            <given-names>R.J.</given-names>
          </name>
        </person-group>
        <article-title>The correspondence problem for metabonomics datasets</article-title>
        <source>Anal. Bioanal. Chem.</source>
        <year>2009</year>
        <volume>394</volume>
        <fpage>151</fpage>
        <lpage>162</lpage>
        <pub-id pub-id-type="doi">10.1007/s00216-009-2628-9</pub-id>
        <?supplied-pmid 19198812?>
        <pub-id pub-id-type="pmid">19198812</pub-id>
      </element-citation>
    </ref>
    <ref id="B6-metabolites-06-00039">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kassidas</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>MacGregor</surname>
            <given-names>J.F.</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>P.A.</given-names>
          </name>
        </person-group>
        <article-title>Synchronization of batch trajectories using dynamic time warping</article-title>
        <source>AIChE J.</source>
        <year>1998</year>
        <volume>44</volume>
        <fpage>864</fpage>
        <lpage>875</lpage>
        <pub-id pub-id-type="doi">10.1002/aic.690440412</pub-id>
      </element-citation>
    </ref>
    <ref id="B7-metabolites-06-00039">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nielsen</surname>
            <given-names>N.-P.V.</given-names>
          </name>
          <name>
            <surname>Carstensen</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Smedsgaard</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Aligning of single and multiple wavelength chromatographic profiles for chemometric data analysis using correlation optimised warping</article-title>
        <source>J. Chromatogr. A</source>
        <year>1998</year>
        <volume>805</volume>
        <fpage>17</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1016/S0021-9673(98)00021-1</pub-id>
      </element-citation>
    </ref>
    <ref id="B8-metabolites-06-00039">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eilers</surname>
            <given-names>P.H.</given-names>
          </name>
        </person-group>
        <article-title>Parametric time warping</article-title>
        <source>Anal. Chem.</source>
        <year>2004</year>
        <volume>76</volume>
        <fpage>404</fpage>
        <lpage>411</lpage>
        <pub-id pub-id-type="doi">10.1021/ac034800e</pub-id>
        <?supplied-pmid 14719890?>
        <pub-id pub-id-type="pmid">14719890</pub-id>
      </element-citation>
    </ref>
    <ref id="B9-metabolites-06-00039">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Suits</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Lepre</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Bischoff</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Horvatovich</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Two-dimensional method for time aligning liquid chromatography-mass spectrometry data</article-title>
        <source>Anal. Chem.</source>
        <year>2008</year>
        <volume>80</volume>
        <fpage>3095</fpage>
        <lpage>3104</lpage>
        <pub-id pub-id-type="doi">10.1021/ac702267h</pub-id>
        <?supplied-pmid 18396914?>
        <pub-id pub-id-type="pmid">18396914</pub-id>
      </element-citation>
    </ref>
    <ref id="B10-metabolites-06-00039">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prince</surname>
            <given-names>J.T.</given-names>
          </name>
          <name>
            <surname>Marcotte</surname>
            <given-names>E.M.</given-names>
          </name>
        </person-group>
        <article-title>Chromatographic alignment of ESI-LC-MS proteomics data sets by ordered bijective interpolated warping</article-title>
        <source>Anal. Chem.</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>6140</fpage>
        <lpage>6152</lpage>
        <pub-id pub-id-type="doi">10.1021/ac0605344</pub-id>
        <?supplied-pmid 16944896?>
        <pub-id pub-id-type="pmid">16944896</pub-id>
      </element-citation>
    </ref>
    <ref id="B11-metabolites-06-00039">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Asara</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Adamec</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Ouzzani</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Elmagarmid</surname>
            <given-names>A.K.</given-names>
          </name>
        </person-group>
        <article-title>Data pre-processing in liquid chromatography-mass spectrometry-based proteomics</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>4054</fpage>
        <lpage>4059</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti660</pub-id>
        <?supplied-pmid 16150809?>
        <pub-id pub-id-type="pmid">16150809</pub-id>
      </element-citation>
    </ref>
    <ref id="B12-metabolites-06-00039">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>C.A.</given-names>
          </name>
          <name>
            <surname>Want</surname>
            <given-names>E.J.</given-names>
          </name>
          <name>
            <surname>O’Maille</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Abagyan</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Siuzdak</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Xcms: Processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching, and identification</article-title>
        <source>Anal. Chem.</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>779</fpage>
        <lpage>787</lpage>
        <pub-id pub-id-type="doi">10.1021/ac051437y</pub-id>
        <?supplied-pmid 16448051?>
        <pub-id pub-id-type="pmid">16448051</pub-id>
      </element-citation>
    </ref>
    <ref id="B13-metabolites-06-00039">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katajamaa</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Miettinen</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Oresic</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Mzmine: Toolbox for processing and visualization of mass spectrometry based molecular profile data</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>634</fpage>
        <lpage>636</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btk039</pub-id>
        <?supplied-pmid 16403790?>
        <pub-id pub-id-type="pmid">16403790</pub-id>
      </element-citation>
    </ref>
    <ref id="B14-metabolites-06-00039">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pluskal</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Castillo</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Villar-Briones</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Oresic</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Mzmine 2: Modular framework for processing, visualizing, and analyzing mass spectrometry-based molecular profile data</article-title>
        <source>BMC Bioinform.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>395</fpage>
        <lpage>404</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-395</pub-id>
        <?supplied-pmid 20650010?>
        <pub-id pub-id-type="pmid">20650010</pub-id>
      </element-citation>
    </ref>
    <ref id="B15-metabolites-06-00039">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bertsch</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Gropl</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Kohlbacher</surname>
            <given-names>O.</given-names>
          </name>
        </person-group>
        <article-title>Openms and TOPP: Open source software for LC-MS data analysis</article-title>
        <source>Methods Mol. Biol.</source>
        <year>2011</year>
        <volume>696</volume>
        <fpage>353</fpage>
        <lpage>367</lpage>
        <?supplied-pmid 21063960?>
        <pub-id pub-id-type="pmid">21063960</pub-id>
      </element-citation>
    </ref>
    <ref id="B16-metabolites-06-00039">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bloemberg</surname>
            <given-names>T.G.</given-names>
          </name>
          <name>
            <surname>Gerretzen</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Lunshof</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Wehrens</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Buydens</surname>
            <given-names>L.M.</given-names>
          </name>
        </person-group>
        <article-title>Warping methods for spectroscopic and chromatographic signal alignment: A tutorial</article-title>
        <source>Anal. Chim. Acta</source>
        <year>2013</year>
        <volume>781</volume>
        <fpage>14</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1016/j.aca.2013.03.048</pub-id>
        <?supplied-pmid 23684461?>
        <pub-id pub-id-type="pmid">23684461</pub-id>
      </element-citation>
    </ref>
    <ref id="B17-metabolites-06-00039">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Christin</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Hoefsloot</surname>
            <given-names>H.C.</given-names>
          </name>
          <name>
            <surname>Smilde</surname>
            <given-names>A.K.</given-names>
          </name>
          <name>
            <surname>Suits</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Bischoff</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Horvatovich</surname>
            <given-names>P.L.</given-names>
          </name>
        </person-group>
        <article-title>Time alignment algorithms based on selected mass traces for complex LC-MS data</article-title>
        <source>J. Proteome Res.</source>
        <year>2010</year>
        <volume>9</volume>
        <fpage>1483</fpage>
        <lpage>1495</lpage>
        <pub-id pub-id-type="doi">10.1021/pr9010124</pub-id>
        <?supplied-pmid 20070124?>
        <pub-id pub-id-type="pmid">20070124</pub-id>
      </element-citation>
    </ref>
    <ref id="B18-metabolites-06-00039">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Christin</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Smilde</surname>
            <given-names>A.K.</given-names>
          </name>
          <name>
            <surname>Hoefsloot</surname>
            <given-names>H.C.</given-names>
          </name>
          <name>
            <surname>Suits</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Bischoff</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Horvatovich</surname>
            <given-names>P.L.</given-names>
          </name>
        </person-group>
        <article-title>Optimized time alignment algorithm for LC-MS data: Correlation optimized warping using component detection algorithm-selected mass chromatograms</article-title>
        <source>Anal. Chem.</source>
        <year>2008</year>
        <volume>80</volume>
        <fpage>7012</fpage>
        <lpage>7021</lpage>
        <pub-id pub-id-type="doi">10.1021/ac800920h</pub-id>
        <?supplied-pmid 18715018?>
        <pub-id pub-id-type="pmid">18715018</pub-id>
      </element-citation>
    </ref>
    <ref id="B19-metabolites-06-00039">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bueschl</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Kluger</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Berthiller</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Lirk</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Krska</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Schuhmacher</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Metextract: A new software tool for the automated comprehensive extraction of metabolite-derived LC/MS signals in metabolomics research</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>736</fpage>
        <lpage>738</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts012</pub-id>
        <?supplied-pmid 22238263?>
        <pub-id pub-id-type="pmid">22238263</pub-id>
      </element-citation>
    </ref>
    <ref id="B20-metabolites-06-00039">
      <label>20.</label>
      <element-citation publication-type="webpage">
        <article-title>MetMatch</article-title>
        <comment>Available online: <ext-link ext-link-type="uri" xlink:href="https://metabolomics-ifa.boku.ac.at/MetMatch/index.html">https://metabolomics-ifa.boku.ac.at/MetMatch/index.html</ext-link></comment>
        <date-in-citation>(accessed on 31 October 2016)</date-in-citation>
      </element-citation>
    </ref>
    <ref id="B21-metabolites-06-00039">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kluger</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Bueschl</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Stuckler</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Doppler</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Chassy</surname>
            <given-names>A.W.</given-names>
          </name>
          <name>
            <surname>Waterhouse</surname>
            <given-names>A.L.</given-names>
          </name>
          <name>
            <surname>Rechthaler</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kampleitner</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Thallinger</surname>
            <given-names>G.G.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Untargeted profiling of tracer-derived metabolites using stable isotopic labeling and fast polarity-switching lc-esi-hrms</article-title>
        <source>Anal. Chem.</source>
        <year>2014</year>
        <volume>86</volume>
        <fpage>11533</fpage>
        <lpage>11537</lpage>
        <pub-id pub-id-type="doi">10.1021/ac503290j</pub-id>
        <?supplied-pmid 25372979?>
        <pub-id pub-id-type="pmid">25372979</pub-id>
      </element-citation>
    </ref>
    <ref id="B22-metabolites-06-00039">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bueschl</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Kluger</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Lemmens</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Adam</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Wiesenberger</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Maschietto</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Marocco</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Strauss</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Bodi</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Thallinger</surname>
            <given-names>G.G.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A novel stable isotope labelling assisted workflow for improved untargeted LC-HRMS based metabolomics research</article-title>
        <source>Metabolomics</source>
        <year>2014</year>
        <volume>10</volume>
        <fpage>754</fpage>
        <lpage>769</lpage>
        <pub-id pub-id-type="doi">10.1007/s11306-013-0611-0</pub-id>
        <?supplied-pmid 25057268?>
        <pub-id pub-id-type="pmid">25057268</pub-id>
      </element-citation>
    </ref>
    <ref id="B23-metabolites-06-00039">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Warth</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Parich</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Bueschl</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Schoefbeck</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>N.K.</given-names>
          </name>
          <name>
            <surname>Kluger</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Schuster</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Krska</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Adam</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Lemmens</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GC-MS based targeted metabolic profiling identifies changes in the wheat metabolome following deoxynivalenol treatment</article-title>
        <source>Metabolomics</source>
        <year>2015</year>
        <volume>11</volume>
        <fpage>722</fpage>
        <lpage>738</lpage>
        <pub-id pub-id-type="doi">10.1007/s11306-014-0731-1</pub-id>
        <?supplied-pmid 25972772?>
        <pub-id pub-id-type="pmid">25972772</pub-id>
      </element-citation>
    </ref>
    <ref id="B24-metabolites-06-00039">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meng-Reiterer</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Varga</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Nathanail</surname>
            <given-names>A.V.</given-names>
          </name>
          <name>
            <surname>Bueschl</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Rechthaler</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>McCormick</surname>
            <given-names>S.P.</given-names>
          </name>
          <name>
            <surname>Michlmayr</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Malachova</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Fruhmann</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Adam</surname>
            <given-names>G.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tracing the metabolism of ht-2 toxin and t-2 toxin in barley by isotope-assisted untargeted screening and quantitative LC-HRMS analysis</article-title>
        <source>Anal. Bioanal. Chem.</source>
        <year>2015</year>
        <volume>407</volume>
        <fpage>8019</fpage>
        <lpage>8033</lpage>
        <pub-id pub-id-type="doi">10.1007/s00216-015-8975-9</pub-id>
        <?supplied-pmid 26335000?>
        <pub-id pub-id-type="pmid">26335000</pub-id>
      </element-citation>
    </ref>
    <ref id="B25-metabolites-06-00039">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fourment</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Gillings</surname>
            <given-names>M.R.</given-names>
          </name>
        </person-group>
        <article-title>A comparison of common programming languages used in bioinformatics</article-title>
        <source>BMC Bioinform.</source>
        <year>2008</year>
        <volume>9</volume>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-82</pub-id>
        <?supplied-pmid 18251993?>
        <pub-id pub-id-type="pmid">18251993</pub-id>
      </element-citation>
    </ref>
    <ref id="B26-metabolites-06-00039">
      <label>26.</label>
      <element-citation publication-type="webpage">
        <article-title>Algorithm1</article-title>
        <comment>Available online: <ext-link ext-link-type="uri" xlink:href="https://metabolomics-ifa.boku.ac.at/metmatch/figures/Algorithm1.gif">https://metabolomics-ifa.boku.ac.at/metmatch/figures/Algorithm1.gif</ext-link></comment>
        <date-in-citation>(accessed on 31 October 2016)</date-in-citation>
      </element-citation>
    </ref>
    <ref id="B27-metabolites-06-00039">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedrioli</surname>
            <given-names>P.G.</given-names>
          </name>
          <name>
            <surname>Eng</surname>
            <given-names>J.K.</given-names>
          </name>
          <name>
            <surname>Hubley</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Vogelzang</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Deutsch</surname>
            <given-names>E.W.</given-names>
          </name>
          <name>
            <surname>Raught</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Pratt</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Nilsson</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Angeletti</surname>
            <given-names>R.H.</given-names>
          </name>
          <name>
            <surname>Apweiler</surname>
            <given-names>R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A common open representation of mass spectrometry data and its application to proteomics research</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2004</year>
        <volume>22</volume>
        <fpage>1459</fpage>
        <lpage>1466</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1031</pub-id>
        <?supplied-pmid 15529173?>
        <pub-id pub-id-type="pmid">15529173</pub-id>
      </element-citation>
    </ref>
    <ref id="B28-metabolites-06-00039">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kessner</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Chambers</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Burke</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Agus</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Mallick</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Proteowizard: Open source software for rapid proteomics tools development</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>2534</fpage>
        <lpage>2536</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn323</pub-id>
        <?supplied-pmid 18606607?>
        <pub-id pub-id-type="pmid">18606607</pub-id>
      </element-citation>
    </ref>
    <ref id="B29-metabolites-06-00039">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Podwojski</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Fritsch</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Chamrad</surname>
            <given-names>D.C.</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Sitek</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Stuhler</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Mutzel</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Stephan</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>H.E.</given-names>
          </name>
          <name>
            <surname>Urfer</surname>
            <given-names>W.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Retention time alignment algorithms for LC/MS data must consider non-linear shifts</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>758</fpage>
        <lpage>764</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp052</pub-id>
        <?supplied-pmid 19176558?>
        <pub-id pub-id-type="pmid">19176558</pub-id>
      </element-citation>
    </ref>
    <ref id="B30-metabolites-06-00039">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mitra</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Smilde</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Hoefsloot</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Suits</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Bischoff</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Horvatovich</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Inversion of peak elution order prevents uniform time alignment of complex liquid-chromatography coupled to mass spectrometry datasets</article-title>
        <source>J. Chromatogr. A</source>
        <year>2014</year>
        <volume>1373</volume>
        <fpage>61</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chroma.2014.10.101</pub-id>
        <?supplied-pmid 25482036?>
        <pub-id pub-id-type="pmid">25482036</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="metabolites-06-00039-f001" position="float">
    <label>Figure 1</label>
    <caption>
      <p>Workflow depicting the main data processing steps of MetMatch for a single target chromatogram. If more than one target chromatogram is going to be processed, each of those is successively carried through the steps 2–5 and a single data table containing the (extended) reference list as well as the matched features of every target chromatogram is generated. After processing of the target chromatograms, all new information (chromatographic peak area, corrected <italic>m/z</italic> value and retention time, calculated <italic>m/z</italic> and Rt shift) for each reference feature and processed target chromatogram are saved as an extended data matrix. Moreover, the target chromatograms can optionally be saved as <italic>m/z</italic>- and Rt-shift-corrected mzXML files.</p>
    </caption>
    <graphic xlink:href="metabolites-06-00039-g001"/>
  </fig>
  <fig id="metabolites-06-00039-f002" position="float">
    <label>Figure 2</label>
    <caption>
      <p>Overlay of two histograms showing the distribution of the weighted average mass to charge ratio (<italic>m</italic>/<italic>z</italic>) shifts of all search frames of a target file (blue) relative to a reference file (grey). The baseline frequency of about 200 is caused by unrelated signals, which have a random <italic>m</italic>/<italic>z</italic> shift relative to their respective reference feature. The <italic>m</italic>/<italic>z</italic> shift of signals corresponding to reference features is, however, not random and shows a significant increase around the systematic <italic>m</italic>/<italic>z</italic> offset of the respective file relative to the reference. This causes a maximum around the aforementioned offset. For the illustrated target datafile, this <italic>m</italic>/<italic>z</italic> offset was determined to be −5 ppm.</p>
    </caption>
    <graphic xlink:href="metabolites-06-00039-g002"/>
  </fig>
  <fig id="metabolites-06-00039-f003" position="float">
    <label>Figure 3</label>
    <caption>
      <p>Retention time (Rt) shift detection procedure: (<bold>a</bold>) Extracted ion chromatogram (EIC) of a target chromatogram (blue solid line) with two chromatographic peaks (blue areas) and their peak apexes or centers (blue dotted line), depending on the selected peak picking algorithm. Determination of the chromatographic peak that correctly matches the reference peak (grey) is non-trivial, as the actual Rt shift is unknown; (<bold>b</bold>) All chromatographic peaks detected within a search frame are considered to be putative matching peaks and their Rt deviation relative to the original reference feature is discretized through binning. The resulting array of Rt shift bins is referred to as Rt shift array and is non-zero for all Rt shift bins at which—depending on the selected peak picking algorithm—the apex or center of the respective chromatographic peak has been detected. By default, the retention times of peaks are assigned a weight of 1 (black cells) and bins within a certain tolerance around the peak apex (or center respectively), are assigned linearly decreasing weight values (grey squares). All Rt shift arrays of search frames belonging to the same feature group (and therefore the same metabolite) are merged into a single array (step not shown); (<bold>c</bold>) All feature group Rt shift arrays are then sorted according to the Rt of their respective reference feature group and are concatenated column-wise to form the Rt shift matrix. Any non-zero entry in this matrix corresponds to the Rt shift (∆Rt) of a peak detected within a specific feature group (i.e., column) of the inspected target file. A region of higher density of putatively matching peaks marking the most probable Rt shift across the inspected chromatogram is clearly visible; (<bold>d</bold>) The Rt shift detection algorithm of MetMatch identifies this region of higher peak density by iteratively optimizing a function (red line) to be as close to as many peaks as possible, as outlined in <xref ref-type="fig" rid="metabolites-06-00039-f004">Figure 4</xref>. This function is then used to determine the correctly aligned chromatographic peaks relative to their reference list entry. In the depicted case the aligned peak from the target chromatogram is X + 2.</p>
    </caption>
    <graphic xlink:href="metabolites-06-00039-g003"/>
  </fig>
  <fig id="metabolites-06-00039-f004" position="float">
    <label>Figure 4</label>
    <caption>
      <p>Exemplification of results obtained with the iterative retention time (Rt) shift detection algorithm. For improved illustration, only a certain part of the Rt shift matrix is depicted. (<bold>a</bold>) After construction of the Rt-shift matrix of the inspected target chromatogram (<xref ref-type="fig" rid="metabolites-06-00039-f003">Figure 3</xref>a,b), the Rt shift function (red line) is initially constructed assuming no apparent shift (∆Rt = 0). The orange area highlights the maximum allowed Rt deviation which may be used in the next iteration step; (<bold>b</bold>–<bold>d</bold>) Three successive iteration steps were applied to model the most likely Rt shift of the target chromatogram relative to the reference feature list. The Rt shift matrix used in this exemplification consists of 45 rows and 63 columns. The three iterations of the Rt shift detection algorithm were using a row tolerance (orange area) of 23, 9 and 4 rows, and a column tolerance of 41, 4 and one column, respectively. Each iteration gradually adjusts the retention time correction function more to the region of higher peak density, which finally results in an optimal alignment maximizing the number of correctly aligned chromatographic peaks. The pseudocode of the algorithm for elucidation of the Rt shift correction function is listed in <xref ref-type="app" rid="app1-metabolites-06-00039">Supplementary Materials Figure S1</xref>.</p>
    </caption>
    <graphic xlink:href="metabolites-06-00039-g004"/>
  </fig>
  <fig id="metabolites-06-00039-f005" position="float">
    <label>Figure 5</label>
    <caption>
      <p>Schematic data processing workflow illustrating how MetMatch can be integrated into existing analysis pipelines.</p>
    </caption>
    <graphic xlink:href="metabolites-06-00039-g005"/>
  </fig>
  <fig id="metabolites-06-00039-f006" position="float">
    <label>Figure 6</label>
    <caption>
      <p>MetMatch’s user interface during various processing steps. (<bold>a</bold>) Main window showing the reference feature list and all loaded datafiles. The step indication bar on top helps the user to keep track of the data processing and also serves as a menu bar; (<bold>b</bold>) EICs of reference (black) and target datafiles (blue, green) before Rt alignment; (<bold>c</bold>) Overlay of EICs after Rt alignment; (<bold>d</bold>) Animated Rt shift detection algorithm (animated version available at [<xref rid="B26-metabolites-06-00039" ref-type="bibr">26</xref>]; (<bold>e</bold>) Overlay of Rt shift functions calculated for multiple target datafiles.</p>
    </caption>
    <graphic xlink:href="metabolites-06-00039-g006"/>
  </fig>
  <fig id="metabolites-06-00039-f007" position="float">
    <label>Figure 7</label>
    <caption>
      <p>EIC (alignment before and after retention time (Rt) alignment and mass-to-charge ratio (<italic>m</italic>/<italic>z</italic>)) correction with MetMatch. (<bold>a</bold>) A phenylalanine-derived chromatographic peak was annotated at position 3 in the reference file (black) and thus included in the reference feature list. The target peak (blue) at position 2 would probably be matched to it by means of manual matching or any other alignment approach that does not account for Rt shift; (<bold>b</bold>) Extracted ion chromatograms (EICs) after Rt and <italic>m</italic>/<italic>z</italic> shift correction using MetMatch. When the two corrected EICs are viewed simultaneously, it is apparent that each target peak should be matched to the reference peak denoted by the same ID number and that a systematic <italic>m</italic>/<italic>z</italic> shift is present between the two chromatograms.</p>
    </caption>
    <graphic xlink:href="metabolites-06-00039-g007"/>
  </fig>
  <fig id="metabolites-06-00039-f008" position="float">
    <label>Figure 8</label>
    <caption>
      <p>Box-plot showing the differences between imposed and detected mass-to-charge ratio (<italic>m</italic>/<italic>z</italic>) offset. A chromatogram was matched to 21 modified feature lists obtained by processing the same datafile with MetExtract and artificially imposing <italic>m</italic>/<italic>z</italic> offset values of −10 to +10 ppm, with 1 ppm increments per list.</p>
    </caption>
    <graphic xlink:href="metabolites-06-00039-g008"/>
  </fig>
  <fig id="metabolites-06-00039-f009" position="float">
    <label>Figure 9</label>
    <caption>
      <p>Results for six different simulated retention time (Rt) shifts. The reference chromatogram was matched to six modified feature lists, displaying artificially modified Rt shifts visualized by the black curves. The Rt shifts obtained by MetMatch are shown in red. (<bold>1</bold>) No Rt shift apart from random ± 6 s; (<bold>2</bold>) Monotonically increasing linear Rt shift; (<bold>3</bold>) Discontinuous Rt shift, as may, e.g., happen by a defective LC pump; (<bold>4</bold>) Non-linear Rt shift without inflection; (<bold>5</bold>) Non-linear Rt shift with inflection; (<bold>6</bold>) Complex non-linear Rt shift based on the type of Rt shift observed in the real-world wheat experiment.</p>
    </caption>
    <graphic xlink:href="metabolites-06-00039-g009"/>
  </fig>
  <fig id="metabolites-06-00039-f010" position="float">
    <label>Figure 10</label>
    <caption>
      <p>Illustration of the F-measure range (grey area) and average (black line) for reference feature lists of decreasing size. To estimate the minimum number of entries in the reference feature list, a simulation was carried out. In total, 200 subsets of decreasing size were generated. For each of the generated subsets, the <italic>m</italic>/<italic>z</italic> and Rt alignment step was calculated with MetMatch. The minimum (lower border of grey area), average (black line) and maximum (upper border of grey area) values are illustrated for each of the iterations.</p>
    </caption>
    <graphic xlink:href="metabolites-06-00039-g010"/>
  </fig>
  <table-wrap id="metabolites-06-00039-t001" position="float">
    <object-id pub-id-type="pii">metabolites-06-00039-t001_Table 1</object-id>
    <label>Table 1</label>
    <caption>
      <p>Structure of a typical reference feature list. Each feature is specified by four required values and four optional values relating to its ion species. “Ion ID” is an integer that uniquely identifies a feature. Each feature belongs to a feature group (i.e., metabolite), which is specified in the column “Group ID”. All features with the same “Group ID” are different ions of the same metabolite. “Rt” is the retention time of the feature in minutes and “<italic>m</italic>/<italic>z</italic>” is its mass-to-charge ratio. The remaining columns are optional and used for the generation of differently formed ions if specified.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Ion ID <sup>a</sup></th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Group ID <sup>a</sup></th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Rt <sup>a</sup></th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1"><italic>m</italic>/<italic>z</italic><sup>a</sup></th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Ion Form <sup>b</sup></th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Uncharged Ion Mass <sup>b</sup></th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Ion Charge <sup>b</sup></th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Ionisation Mode <sup>b</sup></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">1</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">1</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">2.78</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">160.075</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[M + H]<sup>+</sup></td>
          <td align="center" valign="middle" rowspan="1" colspan="1">159.068</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">1</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">+</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">2</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">1</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">2.78</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">177.102</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[M + NH<sub>4</sub>]<sup>+</sup></td>
          <td align="center" valign="middle" rowspan="1" colspan="1">159.068</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">1</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">+</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">3</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">2</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">3.19</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">482.296</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[M + NH<sub>4</sub>]<sup>+</sup></td>
          <td align="center" valign="middle" rowspan="1" colspan="1">464.262</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">1</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">+</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">4</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">3</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">3.27</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">330.458</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">[M + NH<sub>4</sub>]<sup>+</sup></td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">312.424</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">1</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">+</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn>
        <p><sup>a</sup> Mandatory information required by MetMatch; <sup>b</sup> optional information (used if provided)</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
  <table-wrap id="metabolites-06-00039-t002" position="float">
    <object-id pub-id-type="pii">metabolites-06-00039-t002_Table 2</object-id>
    <label>Table 2</label>
    <caption>
      <p>Detail of an output feature matrix generated by matching a target chromatogram to the reference feature list from <xref ref-type="table" rid="metabolites-06-00039-t001">Table 1</xref>. The columns “Ion Charge” and “Ionization Mode” have been omitted for simplicity. Features 901–903 are newly generated ion forms that were not contained in the reference list. Trying to align the target chromatogram to the reference without accounting for the formation of different ion species would have resulted in no matches for the displayed features.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Ion ID <sup>a</sup></th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Group ID <sup>a</sup></th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Rt <sup>a</sup></th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1"><italic>m</italic>/<italic>z </italic><sup>a</sup></th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Ion Form <sup>a</sup></th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Uncharged Ion Mass <sup>a</sup></th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Reference Peak Area <sup>a</sup></th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">File Peak Area <sup>b</sup></th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">File Peak Rt <sup>b</sup></th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">File Peak <italic>m</italic>/<italic>z</italic>
<sup>b</sup></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">1 <sup>a</sup></td>
          <td align="center" valign="middle" rowspan="1" colspan="1">1</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">2.78</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">160.075</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[M + H]<sup>+</sup></td>
          <td align="center" valign="middle" rowspan="1" colspan="1">159.068</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">103,038</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">-</td>
          <td align="center" valign="top" rowspan="1" colspan="1">-</td>
          <td align="center" valign="top" rowspan="1" colspan="1">-</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">2 <sup>a</sup></td>
          <td align="center" valign="middle" rowspan="1" colspan="1">1</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">2.78</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">177.102</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[M + NH<sub>4</sub>]<sup>+</sup></td>
          <td align="center" valign="middle" rowspan="1" colspan="1">159.068</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">6,234,458</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">-</td>
          <td align="center" valign="top" rowspan="1" colspan="1">-</td>
          <td align="center" valign="top" rowspan="1" colspan="1">-</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">901 <sup>b</sup></td>
          <td align="center" valign="middle" rowspan="1" colspan="1">1</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">2.78</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">182.057</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[M + Na]<sup>+</sup></td>
          <td align="center" valign="middle" rowspan="1" colspan="1">159.068</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">-</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">3,423,472</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">2.83</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">182.057</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">3 <sup>a</sup></td>
          <td align="center" valign="middle" rowspan="1" colspan="1">2</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">3.19</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">482.296</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[M + NH<sub>4</sub>]<sup>+</sup></td>
          <td align="center" valign="middle" rowspan="1" colspan="1">464.262</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">523,238</td>
          <td align="center" valign="top" rowspan="1" colspan="1">-</td>
          <td align="center" valign="top" rowspan="1" colspan="1">-</td>
          <td align="center" valign="top" rowspan="1" colspan="1">-</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">902 <sup>b</sup></td>
          <td align="center" valign="middle" rowspan="1" colspan="1">2</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">3.19</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">487.251</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[M + Na]<sup>+</sup></td>
          <td align="center" valign="middle" rowspan="1" colspan="1">464.262</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">-</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">2,137,423</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">3.26</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">487.251</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">4 <sup>a</sup></td>
          <td align="center" valign="middle" rowspan="1" colspan="1">3</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">3.27</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">330.458</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">[M + NH<sub>4</sub>]<sup>+</sup></td>
          <td align="center" valign="middle" rowspan="1" colspan="1">312.424</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">13,459,147</td>
          <td align="center" valign="top" rowspan="1" colspan="1">-</td>
          <td align="center" valign="top" rowspan="1" colspan="1">-</td>
          <td align="center" valign="top" rowspan="1" colspan="1">-</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">903 <sup>b</sup></td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">3</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">3.27</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">487.251</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">[M + Na]<sup>+</sup></td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">312.424</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">-</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">15,358,291</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">3.38</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">487.251</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn>
        <p><sup>a</sup> Part of the reference feature list; <sup>b</sup> New column/row added by MetMatch.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
  <table-wrap id="metabolites-06-00039-t003" position="float">
    <object-id pub-id-type="pii">metabolites-06-00039-t003_Table 3</object-id>
    <label>Table 3</label>
    <caption>
      <p>Benchmark results obtained by matching LC-full scan HRMS data of a wheat sample (serving as a target file) to a list of MetExtract-derived features from the same datafile (serving as the reference list).</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Total Number of Features</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Matched Features</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Tp</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Fp</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Fn</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Precision</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Recall</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">F-Measure</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">1482</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">1446</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">1446</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">36</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">100%</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">97.6%</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.988</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap id="metabolites-06-00039-t004" position="float">
    <object-id pub-id-type="pii">metabolites-06-00039-t004_Table 4</object-id>
    <label>Table 4</label>
    <caption>
      <p>Results obtained by matching LC full scan HRMS data of a wheat sample (serving as a target file) to a list of MetExtract-derived features from the same datafile (serving as the reference list) after modifying the <italic>m</italic>/<italic>z</italic> values to simulate the formation of completely different ion species in the reference and target datafile.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Total Number of Features</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Matched Features</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Tp</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Fp</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Fn</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Precision</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Recall</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">F-Measure</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">1482</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">1446</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">1446</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">36</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">100%</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">97.6%</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.988</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-group>
