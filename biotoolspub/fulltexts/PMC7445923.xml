<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7445923</article-id>
    <article-id pub-id-type="publisher-id">3561</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03561-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>OscoNet: inferring oscillatory gene networks</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Cutillo</surname>
          <given-names>Luisa</given-names>
        </name>
        <address>
          <email>l.cutillo@leeds.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Boukouvalas</surname>
          <given-names>Alexis</given-names>
        </name>
        <address>
          <email>alexis.boukouvalas@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marinopoulou</surname>
          <given-names>Elli</given-names>
        </name>
        <address>
          <email>elli.marinopoulou@manchester.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Papalopulu</surname>
          <given-names>Nancy</given-names>
        </name>
        <address>
          <email>Nancy.Papalopulu@manchester.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rattray</surname>
          <given-names>Magnus</given-names>
        </name>
        <address>
          <email>magnus.rattray@manchester.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5379.8</institution-id><institution-id institution-id-type="ISNI">0000000121662407</institution-id><institution>Faculty of Biology, Medicine and Health, University of Manchester, </institution></institution-wrap>Michael Smith Building, Oxford Road, Manchester, M13 9PT UK </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.9909.9</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8403</institution-id><institution>University of Leeds, </institution></institution-wrap>Leeds, UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <issue>Suppl 10</issue>
    <issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. The Supplement Editor declares that they have no competing interests.</issue-sponsor>
    <elocation-id>351</elocation-id>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Oscillatory genes, with periodic expression at the mRNA and/or protein level, have been shown to play a pivotal role in many biological contexts. However, with the exception of the circadian clock and cell cycle, only a few such genes are known. Detecting oscillatory genes from snapshot single-cell experiments is a challenging task due to the lack of time information. Oscope is a recently proposed method to identify co-oscillatory gene pairs using single-cell RNA-seq data. Although promising, the current implementation of Oscope does not provide a principled statistical criterion for selecting oscillatory genes.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We improve the optimisation scheme underlying Oscope and provide a well-calibrated non-parametric hypothesis test to select oscillatory genes at a given FDR threshold. We evaluate performance on synthetic data and three real datasets and show that our approach is more sensitive than the original Oscope formulation, discovering larger sets of known oscillators while avoiding the need for less interpretable thresholds. We also describe how our proposed pseudo-time estimation method is more accurate in recovering the true cell order for each gene cluster while requiring substantially less computation time than the extended nearest insertion approach.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">OscoNet is a robust and versatile approach to detect oscillatory gene networks from snapshot single-cell data addressing many of the limitations of the original Oscope method.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell</kwd>
      <kwd>Network analysis</kwd>
      <kwd>Non-parametric hypothesis test</kwd>
    </kwd-group>
    <conference xlink:href="http://www.bbcc-meetings.it">
      <conf-name>13th Bioinformatics and Computational Biology Conference - BBCC 2018</conf-name>
      <conf-acronym>BBCC 2018</conf-acronym>
      <conf-loc>Naples, Italy</conf-loc>
      <conf-date>19-21 November 2018</conf-date>
    </conference>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Oscillating genes are expressed in a periodic manner leading to alternating appearance and disappearance of the corresponding mRNA and protein. Oscillatory genes have been shown to play a pivotal role in many developmental processes, by enabling individual systems to implement diverse functions [<xref ref-type="bibr" rid="CR1">1</xref>]. To identify oscillatory genes a combination of time-lapse microscopy techniques and fluorescent reporter genes is required, which prohibits the assaying of a large number of potential oscillators. In turn, this limits the ability of the experimenter to uncover novel oscillators.</p>
    <p>Recent developments in single-cell transcriptomics provide the potential to capture genome-wide transcriptional events. However, single-cell RNA-seq (scRNA-seq) experiments, even when done as time series, pose challenges associated in identifying oscillating genes because cells may be asynchronous in vivo or may lose synchronisation in the time required for sample preparation and sequencing.</p>
    <p>To overcome these problems, Leng et al. [<xref ref-type="bibr" rid="CR2">2</xref>] have proposed a computational approach to identify oscillating genes in static, unsynchronised scRNA-seq experiments. They have constructed a parameterised distance between pairs of putative oscillating genes which is minimised for co-oscillating pairs that have the same temporal profile but different phase. Their approach allows gene pairs to be ranked by how close they are according to this co-oscillation distance. However, they do not provide a statistical test to decide which gene pairs are oscillatory.</p>
    <p>In this contribution, we provide a well-calibrated hypothesis test which allows us to remove the less interpretable cut-off in the first step of the Oscope pipeline [<xref ref-type="bibr" rid="CR2">2</xref>]. We do this by selecting gene pairs according to a false discovery rate (FDR) cut-off. Our non-parametric bootstrap approach requires us to optimise the gene-pair distance many times, and therefore we have implemented an efficient optimisation algorithm to minimise the gene-pair distance function. We then construct an undirected network of co-oscillating genes based on all gene pairs which pass the FDR threshold. Community extraction and network analysis methods can then be used to identify statistically significant co-oscillating groups of genes. We also discuss three distinct statistical tests that can be employed to assess the significance of different aspects of the inferred network communities, namely community distinctiveness and enrichment, in terms of both genes (graph vertices) and their co-oscillations (graph edges). We conclude with a description of a simple method to infer pseudo-time for each gene community, inferring a cyclical ordering on a low-dimensional projection.</p>
  </sec>
  <sec id="Sec2">
    <title>Review of the oscope method</title>
    <p>The Oscope method [<xref ref-type="bibr" rid="CR2">2</xref>] uses a paired-sine model and K-medoids clustering to identify groups of oscillatory genes. For each oscillatory group, an extended nearest insertion algorithm (ENI) is used to construct the cyclic order of cells, defined as the order that specifies each cell’s position within one cycle of the oscillation of that group [<xref ref-type="bibr" rid="CR3">3</xref>]. The method requires normalised gene expression and the use of only high mean, high variance genes is recommended [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p>The method relies on the computation of a pairwise gene expression similarity. Let two genes be <italic>X</italic>= sin(<italic>ω</italic><italic>t</italic>+<italic>ϕ</italic>) and <italic>Y</italic>= sin(<italic>ω</italic><italic>t</italic>+<italic>ϕ</italic>+<italic>Ψ</italic><sub><italic>XY</italic></sub>), that is they have identical profiles except for a phase shift <italic>Ψ</italic><sub><italic>XY</italic></sub>. For <italic>N</italic> cells the co-oscillation distance is <italic>d</italic>(<italic>X</italic>,<italic>Y</italic>|<italic>Ψ</italic><sub><italic>XY</italic></sub>):
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \sum_{s=1}^{N}\left[Y_{s}^{2}+X_{s}^{2}-2Y_{s}X_{s}\cos\left(\Psi_{XY}\right)-\sin^{2}\left(\Psi_{XY}\right)\right]   $$ \end{document}</tex-math><mml:math id="M2"><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mfenced close="]" open="["><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>cos</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">XY</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mover><mml:mrow><mml:mo>sin</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mover><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">XY</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2020_3561_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
    <p>The derivation is provided in the <xref rid="MOESM1" ref-type="media">Supplementary Material (Section 3)</xref>. The assumed sinusoidal form is not a major restriction, given that the time <italic>t</italic> is not required in the co-oscillation distance<xref ref-type="fn" rid="Fn1">1</xref>. This is the crucial step in the algorithm as it allows the gene-pair similarity to be estimated without knowledge of the pseudo-time.</p>
    <p>A limitation of this approach is that the cell population is assumed to be homogeneous. Including cell populations that are not relevant to the process under investigation will result in reduced accuracy as the co-oscillation distance will be averaged across both informative and non-informative cells. We therefore recommend to remove irrelevant cell populations prior to the application of the Oscope and OscoNet methods. This can be accomplished by visualisation and clustering methods such as t-SNE and k-means to identify cell populations and using gene markers or other information to characterise each cell cluster.</p>
    <p>In the original Oscope approach, only genes that appear in the top <italic>T</italic>% of the ranked pairwise similarity list are selected for the subsequent K-medoids clustering step. The choice of <italic>T</italic> can have a significant impact on downstream analysis. However, the optimal choice of <italic>T</italic> is not obvious and will likely differ depending on the characteristics of the data, e.g. number of co-oscillatory pairs, technical/biological noise levels, number of cells in the dataset etc. In our work, we instead propose to use a well-calibrated non-parametric test to select gene pairs with a given FDR. Genes that contribute to these gene pairs are then selected for further downstream analysis.</p>
    <p>A further limitation of the Oscope approach is that linearly correlated genes cannot be disambiguated from gene pairs with 0 or <italic>π</italic> phase shift. Therefore a heuristic is used to remove clusters that have a high proportion of similarities with 0 or <italic>π</italic> phase shift.</p>
    <p>Finally, the ENI algorithm is used to estimate pseudo-time per gene cluster. The use of the ENI algorithm is not critical to the algorithm and can be replaced by a computationally more efficient probabilistic approach as we describe below.</p>
  </sec>
  <sec id="Sec3">
    <title>Methods</title>
    <p>Our overall approach is summarised in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Following a quality control step (see <xref rid="Sec16" ref-type="sec">Appendix</xref>), we propose three main phases, namely: building a network of gene co-oscillations using a non-parametric hypothesis test, identify the statistically significant communities in the resulting network and infer pseudo-time for each gene community.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overall approach: A statistical test is used to identify co-oscillatory gene pairs at a given FDR threshold. Genes contributing to these gene pairs are included in a co-oscillation network. The q-value from our co-oscillation test provides an estimate of the number of false links in this network. We can then identify communities in this network and infer the pseudo-time associated with each community</p></caption><graphic xlink:href="12859_2020_3561_Fig1_HTML" id="MO1"/></fig></p>
    <sec id="Sec4">
      <title>Non-parametric test on co-oscillation</title>
      <p>The key insight in the Oscope algorithm is that a gene-pair oscillation score can be defined without requiring a prior estimation of pseudo-time. Rather than specifying a threshold on the number of genes to keep, here we develop a non-parametric hypothesis test to assess the significance of two genes co-oscillating.</p>
      <p>We employ a bootstrap approach which randomly permutes the order of cells for one of the genes in the gene-pair distance estimation in order to perform a statistical test. The cell index is permuted for one gene in a pair and we calculate the resulting pairwise gene similarity <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d\left (X,\mathcal {P}(Y)|\Psi _{XY}\right)$\end{document}</tex-math><mml:math id="M4"><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">XY</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2020_3561_Article_IEq1.gif"/></alternatives></inline-formula> (recall Eq. <xref rid="Equ1" ref-type="">1</xref>) where <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {P}(Y)$\end{document}</tex-math><mml:math id="M6"><mml:mi mathvariant="script">P</mml:mi><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3561_Article_IEq2.gif"/></alternatives></inline-formula> is the permuted cell order for gene <italic>Y</italic>. For each randomisation, we estimate the phase shift by minimising the pairwise distance,
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ d_{perm} = \min_{\Psi_{XY}} d\left(X,\mathcal{P}(Y)|\Psi_{XY}\right) \ .  $$ \end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">perm</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>min</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">XY</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">XY</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="1em"/><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2020_3561_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The <italic>p</italic>-value estimate for the gene pair <italic>XY</italic> is the fraction of times <italic>d</italic><sub><italic>perm</italic></sub>&lt;<italic>d</italic>. Specifically for <italic>B</italic> randomisations the bootstrap <italic>p</italic>-value is
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ p\text{-value}_{XY} = \frac{1}{B} \sum_{i=1}^{B} I\left(d_{perm}^{i} &lt; d\right) \,,  $$ \end{document}</tex-math><mml:math id="M10"><mml:mi>p</mml:mi><mml:msub><mml:mrow><mml:mtext>-value</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">XY</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">perm</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mfenced><mml:mspace width="0.3em"/><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2020_3561_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <inline-formula id="IEq3"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{perm}^{i}$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">perm</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3561_Article_IEq3.gif"/></alternatives></inline-formula> the <italic>i</italic><sup>th</sup> randomisation, <italic>d</italic>=<italic>d</italic>(<italic>X</italic>,<italic>Y</italic>|<italic>Ψ</italic><sub><italic>XY</italic></sub>) the unpermuted pairwise distance and <italic>I</italic>(.) the indicator function, which is 1 when the inequality is true and 0 otherwise.</p>
      <p>In our approach, we need to correct for the effect of multiple hypothesis tests since we are testing many gene pairs. We have selected to use the q-value approach of [<xref ref-type="bibr" rid="CR4">4</xref>] which controls the FDR. The simple Bonferroni correction is too conservative in the case of very large numbers of tests and is also based on an unrealistic assumption that tests are independent. The q-value is an adjustment of the traditional <italic>p</italic>-value where the FDR is minimised based on the distribution of the <italic>p</italic>-values across all the tests performed. The q-value is an estimate of the FDR at a given <italic>p</italic>-value threshold obtained from modelling background (null) and signal contributions to the <italic>p</italic>-value distribution. This approach does not assume independent tests and has been shown to perform well in applications with very large numbers of tests. The q-value provides an estimate of the number of false edges in our co-oscillation network.</p>
      <p>As the bootstrap approach is computationally demanding, we have expressed the distance measure using matrix operations and we provide an efficient implementation. We have implemented the bootstrap test in Python using NumPy vector operations and we have also implemented a faster version in Cython, which allows C code to be called from Python. A performance comparison of the different implementations is given in Fig. <xref rid="Fig2" ref-type="fig">2</xref> wherein we compare our implementation of the pairwise distance calculation (NumPy, Cython) to the standard Oscope [<xref ref-type="bibr" rid="CR2">2</xref>] R implementation. As all three implementations are able to leverage multi-core parallelism, our test is performed across 12 CPU cores. We see that both Numpy and Cython are substantially faster than the iterative R version which uses the Oscope bioconductor package. The Numpy and Cython implementations achieve an average speed-up of 6.5 and 93 respectively. The significant performance improvement allows for the practical use of the bootstrap algorithm. The computational penalty for a fully non-parametric significance test is therefore minimised.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Performance comparison of different Oscope implementations on computing the pairwise oscillating distance. Vertical axis is elapsed time in seconds and horizontal axis is number of genes (G). Standard Oscope [<xref ref-type="bibr" rid="CR2">2</xref>] is an R implementation. All methods use 12 cores and the minimum elapsed time from 2 runs is reported</p></caption><graphic xlink:href="12859_2020_3561_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Network analysis</title>
      <p>We use the gene-pair test to construct a network of genes in which connections denote statistically significant co-oscillation. In the network setting, a variety of algorithms have been developed to extract communities within the entire network. The problem of community detection, or graph partitioning, in a network has been widely studied in a variety of research fields. In the present work, we consider community extraction algorithms based on maximising modularity, a measure of community distinctiveness. The modularity often referred to as <italic>Q</italic>, was defined by [<xref ref-type="bibr" rid="CR5">5</xref>] as the fraction of the edges that fall within a given group of nodes (community partition) minus the expected fraction if edges were distributed at random. The concept of modularity is based on the idea that a random graph is not expected to have a cluster structure. In the “<xref rid="Sec8" ref-type="sec">Synthetic study</xref>” section, we compare three popular community extraction algorithms<xref ref-type="fn" rid="Fn2">2</xref>, namely: <italic>walktrap</italic> [<xref ref-type="bibr" rid="CR6">6</xref>], <italic>fast-greedy</italic> [<xref ref-type="bibr" rid="CR7">7</xref>] and <italic>infomap</italic> [<xref ref-type="bibr" rid="CR8">8</xref>], and find the walktrap algorithm to be the most robust.</p>
      <p>To further interpret the estimated network, which is still highly complex, we tried to identify the underlying community structures [<xref ref-type="bibr" rid="CR9">9</xref>]. The identified communities will allow us to create a large scale map of our network [<xref ref-type="bibr" rid="CR10">10</xref>]. We aim to use individual communities to shed light on the function of the co-oscillation represented by the network itself. Indeed, in biological networks, communities often correspond to functional units of a system. For example in metabolic networks [<xref ref-type="bibr" rid="CR11">11</xref>], such functional groups correspond to cycles or pathways, whereas in the protein-protein interaction networks [<xref ref-type="bibr" rid="CR12">12</xref>], communities correspond to proteins with similar functionality inside a cell.</p>
      <p>To assess the significance of each community, we employ three statistical tests that examine different aspects of the community structure. Our first step is to apply a Wilcoxon test for each community, to compare the distribution of the intra-community edges versus the distribution of the inter-community edges. This tests allows assessing how well-defined a community is and complements the maximisation of the modularity objective during the community extraction stage.</p>
      <p>We then validate our results by cross-referencing with a list of known oscillating targets. To this end, for each identified community, we perform a set of gene enrichment tests with respect to Cell Cycle (CC) related genes (Gene Ontology term GO:0007049). Firstly, we test each community for standard gene enrichment using a hypergeometric test; this test checks whether the genes in every single community are significantly enriched in the list of CC related genes. However, this test only considers membership to a community and does not take into account the within community connections corresponding to gene co-oscillations. For a more stringent test, we also employ a network enrichment test [<xref ref-type="bibr" rid="CR13">13</xref>]. For every community that contains CC related genes, we are performing a network enrichment test between two lists of genes, namely: list <italic>A</italic> - the list of CC related genes in the community, list <italic>B</italic> - the list of all the genes in the community. This test aims at looking at the connection between our target genes to see if their links are statistically significant, hence if there is an enrichment. The main idea behind this test is that, under the null hypothesis of no enrichment, the number of links between two gene sets A and B follows a hypergeometric distribution. This test considers the connectedness among CC related genes within a single community. Therefore, it may be more stringent than the hypergeometric test, given that CC genes, which are only connected through intermediaries in a CC enriched community, are not found to directly co-oscillate. In our results, we show the validation of communities in terms of the Wilcoxon test and the CC enrichment in terms of network enrichment test [<xref ref-type="bibr" rid="CR13">13</xref>].</p>
      <p>We also introduce an index, community density, expressing the fraction of the actual number of edges in a community with respect to the total number of edges in the network. We also provide a relative community density, defined as the fraction of edges in a community given the maximum number of edges feasible in a community of that size.</p>
    </sec>
    <sec id="Sec6">
      <title>Pseudo-time estimation</title>
      <p>We use Laplace Eigenmaps [<xref ref-type="bibr" rid="CR14">14</xref>] to reduce the gene expression space to a two-dimensional latent representation. Laplace Eigenmaps, also known as spectral embedding, is a non-linear dimension reduction method using a spectral decomposition of the graph Laplacian to preserve local distances in the gene expression space. The method is fast to compute as it involves a partial eigenvalue decomposition of a sparse graph matrix, namely the graph Laplacian. Further, the minimisation problem has a unique solution and therefore, does not suffer from local minima. As [<xref ref-type="bibr" rid="CR14">14</xref>] discussed, the method is robust to outliers and noise as only local distances are used to estimate the neighbourhood graph.</p>
      <p>The method consists of
<list list-type="order"><list-item><p>Graph Construction: create sparse adjacency matrix <italic>A</italic> using <italic>n</italic> nearest neighbours.</p></list-item><list-item><p>Graph Laplacian Construction: <italic>L</italic>=<italic>D</italic>−<italic>A</italic>, where <italic>D</italic> is the degree matrix, the number of edges attached to each vertex.</p></list-item><list-item><p>Partial Eigenvalue Decomposition. Find top-<italic>Q</italic> eigenvalues of sparse matrix where <italic>Q</italic> is the dimensionality of the latent space. In our case this is always <italic>Q</italic>=2.</p></list-item></list></p>
      <p>The critical parameter in the algorithm is <italic>n</italic>, the number of nearest neighbours. Our pseudo-time estimation algorithm consists of a search on a grid of values specified by a minimum <italic>m</italic> and a maximum value <italic>M</italic>. For <italic>n</italic>∈{<italic>m</italic>,…,<italic>M</italic>}:
<list list-type="order"><list-item><p>Compute Laplacian eigenmap on 2 dimensions.</p></list-item><list-item><p>pseudo-time: compute angle in radians [−<italic>π</italic>,<italic>π</italic>] by arc tangent. Convert to [0,1].</p></list-item></list></p>
      <p>The latter step imposes a periodic constraint on the pseudo-time: pseudo-time is defined as the angle of a cell in a circle.</p>
      <p>To select the best value for the number of neighbours <italic>n</italic>, we apply a probabilistic periodic model to assess each pseudo-time for all genes in the cluster. We employ a Bayesian Gaussian process latent variable model [<xref ref-type="bibr" rid="CR15">15</xref>] with a one-dimensional periodic kernel. All hyperparameters are optimised except the pseudo-time. We use 25 inducing points to ensure efficient optimisation and calculation of the model likelihood. We then use the marginal model likelihood to select the best pseudo-time and the number of neighbours <italic>n</italic>.</p>
    </sec>
  </sec>
  <sec id="Sec7" sec-type="results">
    <title>Results</title>
    <p>In order to validate our overall approach and compare to the original results in [<xref ref-type="bibr" rid="CR2">2</xref>], we evaluate the ability of OscoNet to identify oscillating groups of genes by applying it both to synthetic data, a microarray time-series study of oscillating genes [<xref ref-type="bibr" rid="CR16">16</xref>] and to the profiles of single undifferentiated human embryonic stem cells (hESCs) [<xref ref-type="bibr" rid="CR17">17</xref>]. For the biological data, we evaluate the enrichment of the discovered clusters with respect to the Gene Ontology CC biological process related genes.</p>
    <sec id="Sec8">
      <title>Synthetic study</title>
      <p>We generate a synthetic dataset of 1000 genes and 100 cells following the setup in [<xref ref-type="bibr" rid="CR2">2</xref>]. We simulate 1000 genes, of which 180 are samples from a sinusoidal function with additive Gaussian noise. The 180 oscillators are simulated in 3 frequency groups, each group containing 60 genes. The relative frequencies of the three groups are proportional to 2:3:6.</p>
      <p>Genes in each group were further exposed to strong or weak signals. Half of the oscillatory genes were simulated as strong oscillators with noise variance <italic>σ</italic><sup>2</sup>. The other half were simulated as weak oscillators with <inline-formula id="IEq4"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma ^{2}_{wk} = (2 \sigma)^{2}$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">wk</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3561_Article_IEq4.gif"/></alternatives></inline-formula>. The starting phase <italic>Φ</italic> varies in different genes within a frequency group. The remaining genes were simulated as independent Gaussian noise.</p>
      <sec id="Sec9">
        <title>Hypothesis test</title>
        <p>We calculate the FDR on all gene pairs, defined as:
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{FDR}=\frac{F}{S}.  $$ \end{document}</tex-math><mml:math id="M16"><mml:mtext>FDR</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2020_3561_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <italic>S</italic> is the estimated number of significant gene pairs and <italic>F</italic> the number of false positive pairs. This is a more stringent criterion than in [<xref ref-type="bibr" rid="CR2">2</xref>], where the number of oscillating genes was used and not co-oscillating pairs.</p>
        <p>The accuracy of the non-parametric test with different number of bootstrap samples and the original Oscope method is shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>a for noise level of <italic>σ</italic><sup>2</sup>=0.05. When considering higher noise levels the results are similar (see <xref rid="MOESM1" ref-type="media">Supplementary</xref>). Very small number of bootstrap samples result into not well-calibrated tests (<italic>B</italic>=100). However, when the number of samples is increased the bootstrap test better approximates the true FDR.
<fig id="Fig3"><label>Fig. 3</label><caption><p>FDR for the synthetic study. The synthetic data was generated using noise variances <italic>σ</italic><sup>2</sup>=[0.05,0.1,0.2,0.3,0.4]. Vertical axis is achieved FDR and horizontal axis the significance level used. Plot (<bold>a</bold>) gives the FDR for noise level <italic>σ</italic><sup>2</sup>=0.05 for different number of bootstrap samples and the Oscope method for different cut-offs. Plot (<bold>b</bold>) compares the effect of different noise levels on the FDR of the bootstrap hypothesis test using 2000 samples</p></caption><graphic xlink:href="12859_2020_3561_Fig3_HTML" id="MO3"/></fig></p>
        <p>When decreasing the desired level of FDR, we observe an elbow effect. At a certain point of significance, the observed FDR is not further reduced as we decrease the desired FDR. This occurs at increasingly smaller thresholds as the number of bootstrap samples is increased. However, we suspect that the number of cells and the variability of gene expression also play a role; when increasing the number of cells for instance, statistical power is expected to increase as we get higher resolution on the tails of the null distribution. Another factor is the amount of noise in the data as is demonstrated in Fig. <xref rid="Fig3" ref-type="fig">3</xref>b where we show the effect of different noise levels on the threshold value of the elbow after which no improvement in FDR is observed. As the noise level decreases, the statistical test is able to achieve lower FDR.</p>
        <p>A possible improvement on our test would be to introduce an explicit model for the tails of the null distribution. Such a semi-parametric bootstrap approach would allow for lower achievable FDR levels as long as the modelling assumptions are accurate.</p>
        <p>The poor performance of standard Oscope can be understood by the nature of the threshold used. At the lowest noise level (0.05) the method correctly identifies all the co-oscillating gene pairs at the default 5% threshold achieving a perfect true positive rate (<italic>T</italic><italic>P</italic><italic>R</italic>=1.0) as does the OscoNet hypothesis test. However the former gets a false positive rate of 10% (<italic>F</italic><italic>P</italic><italic>R</italic>=0.10) while the latter achieves a lower rate of 0.1% (<italic>F</italic><italic>P</italic><italic>R</italic>=0.001). The resulting FDR for Oscope is 0.91 and for OscoNet is 0.09, reflecting the highest sensitivity of the latter. The large FPR achieved by Oscope demonstrates the deficiency of setting such a threshold. In the <xref rid="MOESM1" ref-type="media">Supplementary (Section 1)</xref>, we present the FDR, FPR and TPR achieved across all noise levels.</p>
        <p>Note that a bootstrap test is implemented in the Oscope pipeline after the clustering step to flag clusters that should be removed prior to downstream analysis. As this test is applied after the threshold of the top-ranked pairs of genes, the choice of the threshold has a significant impact on the results. In addition, by applying the bootstrap test on the cluster level, an entire cluster is either kept or removed, whereas our approach maintains all significant gene pairs. We argue our approach is logically more coherent since the clustering should be applied on only significant gene pairs rather than testing for significance after the clustering is completed.</p>
      </sec>
      <sec id="Sec10">
        <title>Comparing community extraction methods</title>
        <p>In order to validate our approach, we want to find densely connected subgraphs, also called communities, in the constructed synthetic graphs. To this aim, we compare three well-known network clustering algorithms available in the <italic>R</italic> package <italic>igraph</italic>, namely: <italic>walktrap</italic>, <italic>fastgreedy</italic> and <italic>infomap</italic>. In <italic>walktrap</italic>, the communities are assigned via random walks [<xref ref-type="bibr" rid="CR6">6</xref>]. The idea is that short random walks tend to stay in the same community. In <italic>fastgreedy</italic>, the communities are estimated via directly optimising a modularity score [<xref ref-type="bibr" rid="CR7">7</xref>]. On the other end, <italic>infomap</italic> aims to find a community structure that minimises the expected description length of a random walker trajectory [<xref ref-type="bibr" rid="CR8">8</xref>]. We refer to the original papers for a detailed description. In an ideal case, true simulated oscillating genes should be clustered in the same community. For each of the five noise levels, as defined in the “<xref rid="Sec8" ref-type="sec">Synthetic study</xref>” section, and for each one of the three community detection algorithms, we compare the recovered network partition to the true underlying one computing the <italic>A</italic><italic>d</italic><italic>j</italic><italic>u</italic><italic>s</italic><italic>t</italic><italic>e</italic><italic>d</italic>
<italic>R</italic><italic>a</italic><italic>n</italic><italic>d</italic>
<italic>I</italic><italic>n</italic><italic>d</italic><italic>e</italic><italic>x</italic> (<italic>ARI</italic>). This measure is a scalar comparing two partitions on the same network. The <italic>ARI</italic> index, first introduced in [<xref ref-type="bibr" rid="CR18">18</xref>], has zero expected value in the case of random partition, and it is 1 in the case of perfect agreement between two partitions. As depicted in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, the index decreases when the level of noise increases and the most stable results are achieved by the <italic>walktrap</italic> algorithm. We therefore select the <italic>walktrap</italic> as the community extraction method in the clustering step of our overall approach.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Comparison of three clustering algorithms on the synthetic network. For each method the ARI (vertical axis) is provided at different noise levels (horizontal axis)</p></caption><graphic xlink:href="12859_2020_3561_Fig4_HTML" id="MO4"/></fig></p>
      </sec>
    </sec>
    <sec id="Sec11">
      <title>cDNA microarray time course</title>
      <p>We applied OscoNet to a microarray time-series study of oscillating genes studied in [<xref ref-type="bibr" rid="CR16">16</xref>].</p>
      <p>Following Leng et al. [<xref ref-type="bibr" rid="CR2">2</xref>], we use experiment 3 from the original study [<xref ref-type="bibr" rid="CR16">16</xref>] where double thymidine block was used to synchronise HeLa cells which were profiled at 48 time points following synchronisation. We start with a set of 41508 probes containing 1134 CC oscillators [<xref ref-type="bibr" rid="CR16">16</xref>]. This corresponds to a set of 9559 genes containing 874 oscillating genes [<xref ref-type="bibr" rid="CR16">16</xref>].</p>
      <p>We filter probes using variance based filtering with a cut-off of 0.9 [<xref ref-type="bibr" rid="CR19">19</xref>]. This results in 4151 probes containing 360 CC oscillators. This filtering step is more stringent than the default test on mean and variance of expression used in the Oscope paper. This filtering step also ensures that the set of probes we consider does not include high error measurements and includes the most informative genes only. In both cases, the data is normalised to [-1, 1].</p>
      <p>Finally, we identify a total of 3884 genes that have at least one significant co-oscillation where the total number co-oscillations is 185,548. This corresponds to a highly sparse network with a sparseness of 0.0123. Here sparseness is defined as the ratio of existing edges to the maximum number of possible edges in the network. All the 60 CC oscillators are present in the network.</p>
      <p>In the following, we summarise the results when applying the standard Oscope approach or respectively our approach. The Oscope approach was applied to the same data using the same normalisation. We utilize the standard paired sine model and only gene pairs with a similarity score in the top 5%. This corresponds to the default setting recommended in Oscope. We apply K-medoids with the maximum number of clusters set to <italic>K</italic>=5. Finally, we remove clusters flagged by Oscope as having mostly linear effects.</p>
      <p>The application of standard Oscope led to the identification of two significant clusters of transcripts: the first cluster includes 72 probes whereof 70 are CC-related and the second cluster includes 136 probes of which 13 are CC-related. We note that no clusters were removed by the linear filtering step of the Oscope pipeline.</p>
      <p>The application of OscoNet to the same dataset led to the identification of 5 significant clusters, according to the Wilcoxon test (significance <italic>α</italic>=0.01) described in the previous section. Singleton communities with a single gene were excluded.</p>
      <p>In Table <xref rid="Tab1" ref-type="table">1</xref> we show all the significant clusters according to the Wilcoxon test ranked by the relative density. Of these five, three have at least one CC probes. Of those three, only one is enriched according to the NEAT and hypergeometric tests with <italic>α</italic>=0.01.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Miroarray data Clusters Significance</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Size</th><th align="left">CC</th><th align="left">Density</th><th align="left">Relative density</th><th align="left">Neat</th><th align="left">Hypergeometric</th></tr></thead><tbody><tr><td align="left">27</td><td align="left">0</td><td align="left">0.00</td><td align="left">0.44</td><td align="left">N/A</td><td align="left">N/A</td></tr><tr><td align="left">265</td><td align="left">239</td><td align="left">0.08</td><td align="left">0.41</td><td align="left">&lt;1<italic>e</italic>−6</td><td align="left">&lt;1<italic>e</italic>−6</td></tr><tr><td align="left">1157</td><td align="left">99</td><td align="left">0.80</td><td align="left">0.22</td><td align="left">0.28</td><td align="left">1.00</td></tr><tr><td align="left">131</td><td align="left">0</td><td align="left">0.01</td><td align="left">0.17</td><td align="left">N/A</td><td align="left">N/A</td></tr><tr><td align="left">82</td><td align="left">1</td><td align="left">0.00</td><td align="left">0.11</td><td align="left">1.00</td><td align="left">1.00</td></tr></tbody></table></table-wrap></p>
      <p>The only CC-enriched community has 239 CC genes out of 265 and is the second-ranked community as per relative density. This community is well-separated from the network and is enriched in CC from both enrichment perspectives, namely traditional enrichment in terms of genes and the network interconnections between the CC genes present in the community.</p>
      <p>Importantly, this community includes the 70 CC related probes identified as co-oscillating by Oscope. Therefore this community gives a more detailed and richer description of the CC processes than the one uncovered by Oscope.</p>
      <sec id="Sec12">
        <title>pseudo-time</title>
        <p>We evaluate the performance of the ENI method of Leng et al. [<xref ref-type="bibr" rid="CR2">2</xref>] and spectral methods on estimating pseudo-time. We run the ENI method using 30000 iterations, with a sliding polynomial of degree 3 and 4 starting points for the polynomial fitting. The pseudo-time order is not changed after approximately 6500 iterations in our experiments even when setting the maximum number of iterations to 100k. The ENI algorithm took on average 5-7 h in our experiments while the spectral method takes less than 1 min including the time to search over the parameter space. This makes the method very easy to use in practice in addition to the superior performance which we now discuss.</p>
        <p>We assess the performance of the method when trained on the 72 gene cluster defined by Oscope and the 265 gene cluster defined by OscoNet. We also evaluate the performance of the pseudo-time on both of these clusters.</p>
        <p>The dimensionality reduction and circle estimated by the spectral method for the two gene clusters is shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. In both cases, the cells can be well-described by a circular path in the 2-D latent space projection of the data.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Microarray data: two-dimensional latent space representation using spectral method. spectral dimensionality reduction trained on the two different clusters. Each cell dot is coloured by the true base cycle stage</p></caption><graphic xlink:href="12859_2020_3561_Fig5_HTML" id="MO5"/></fig></p>
        <p>Our main validation measure is the Spearman correlation of the estimated peak times in the reconstructed gene expression to the ground truth (Table <xref rid="Tab2" ref-type="table">2</xref>). The ground truth has been constructed by folding the time series in [<xref ref-type="bibr" rid="CR16">16</xref>] along every period. ENI provides consistently poor results despite the large iteration count (30k iterations). The spectral method is simple and provides good results. It can also be easily extended in an intuitive manner to cover more complex cases - see the <xref rid="Sec15" ref-type="sec">Conclusions</xref> section. Comparing the pseudo-time achieved by the different clusters using the spectral method, we note that using the larger gene cluster identified by OscoNet (265 genes) results in a more accurate pseudo-time. This is reflected in the higher peak time rank correlation; the larger cluster estimated by OscoNet is more informative on the true time compared to the smaller cluster estimated by Oscope. In the <xref rid="MOESM1" ref-type="media">Supplementary (Section 2)</xref>, the estimated and actual peak times for each gene are shown.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Microarray data: spearman rank correlation of peak times</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left"/><th align="left" colspan="2">Predicting cluster peak time</th></tr><tr><th align="left">Method</th><th align="left">Training</th><th align="left">72</th><th align="left">265</th></tr></thead><tbody><tr><td align="left">Spectral</td><td align="left">72</td><td align="left">0.94</td><td align="left">0.81</td></tr><tr><td align="left"/><td align="left">265</td><td align="left">0.99</td><td align="left">0.83</td></tr><tr><td align="left">ENI</td><td align="left">72</td><td align="left">0.17</td><td align="left">0.28</td></tr><tr><td align="left"/><td align="left">265</td><td align="left">-0.19</td><td align="left">0.14</td></tr></tbody></table></table-wrap></p>
        <p>We also report on the roughness measure of the true time series and the reconstructed version. This encapsulates how smooth a time series is by comparing neighbouring values with smaller values corresponding to a smoother time series; see <xref rid="Sec16" ref-type="sec">Appendix</xref> for details. In Table <xref rid="Tab3" ref-type="table">3</xref> we report the difference of the median roughness of the estimated pseudo-time and true time. Overall the ENI results in an increase in the roughness measure while the Spectral method results in lower values reflecting smoother time courses. The spectral method achieves similar performance under both the smaller Oscope cluster (72 genes) and the larger OscoNet cluster (265). Therefore the differences reported above in peak time accuracy are not caused by smoother time courses.
<table-wrap id="Tab3"><label>Table 3</label><caption><p>Microarray data: change in median roughness</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left"/><th align="left" colspan="2">Predicting gene set</th></tr><tr><th align="left">Method</th><th align="left">Training</th><th align="left">72</th><th align="left">265</th></tr></thead><tbody><tr><td align="left">Spectral</td><td align="left">72</td><td align="left">-0.20</td><td align="left">-0.09</td></tr><tr><td align="left"/><td align="left">265</td><td align="left">-0.19</td><td align="left">-0.10</td></tr><tr><td align="left">ENI</td><td align="left">72</td><td align="left">0.50</td><td align="left">0.38</td></tr><tr><td align="left"/><td align="left">265</td><td align="left">0.56</td><td align="left">0.39</td></tr></tbody></table></table-wrap></p>
        <p>In Fig. <xref rid="Fig6" ref-type="fig">6</xref> we show the gene expression for three genes using the experimental time. In Figures <xref rid="Fig7" ref-type="fig">7</xref> we show the reconstructed base cycle and estimated gene expression. The pseudo-time methods have been estimated using the larger OscoNet cluster. As expected, the ENI profiles are poor due to the poor pseudo-time estimate. The spectral pseudo-time is anticorrelated and therefore provides a mirror image of the true time series profile.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Microarray data: oscillatory gene expression for CDC6, PLK and CCNE1 genes. The true cyclical expression is shown. The length of the base cycle is highlighted in blue background. The green vertical line depicts the peak time within the first cycle</p></caption><graphic xlink:href="12859_2020_3561_Fig6_HTML" id="MO6"/></fig><fig id="Fig7"><label>Fig. 7</label><caption><p>Microarray data: oscillatory gene expression for CDC6, PLK and CCNE1 genes. The cyclical expression and the Oscope-ENI and spectral approach reconstructions are shown. The green vertical line denotes the peak oscillation time</p></caption><graphic xlink:href="12859_2020_3561_Fig7_HTML" id="MO7"/></fig></p>
      </sec>
    </sec>
    <sec id="Sec13">
      <title>Single-cell embryonic stem cells</title>
      <p>To evaluate OscoNet on scRNA-seq data, we analysed profiles of single undifferentiated hESCs as described in Thomson et al. [<xref ref-type="bibr" rid="CR17">17</xref>]. In particular, we analysed three replicate scRNA-seq experiments on H1 hESCs, with a sample size <italic>n</italic>=213.</p>
      <p>We applied our method to <italic>n</italic>=213 samples with <italic>G</italic>=2375 genes following the same steps as [<xref ref-type="bibr" rid="CR2">2</xref>] in terms of quality control. In particular, genes have been filtered by mean level and variance as in [<xref ref-type="bibr" rid="CR2">2</xref>]. A total of 1914 genes have at least one significant co-oscillation with 5057 co-oscillatory pairs found. The sparseness value for the network is 0.001, an order of magnitude smaller than the previous study suggesting a sparser network.</p>
      <p>A total of 677 genes were used to test for CC enrichment. After quality control, 153 CC genes were left of which 134 are subsequently present in the co-oscillatory network.</p>
      <p>The original algorithm in Oscope identified 29 genes as co-oscillating, 21 of which are annotated with the cell cycle process GO-term. The Oscope algorithm was run with default values as previously reported [<xref ref-type="bibr" rid="CR2">2</xref>]. In total the k-medoids Oscope step finds 5 clusters, 2 of which are eliminated by the subsequent linear filtering step. The CC enrichment of each cluster is given in Table <xref rid="Tab4" ref-type="table">4</xref>.
<table-wrap id="Tab4"><label>Table 4</label><caption><p>scRNA-seq: CC enrichment for each Oscope cluster</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Size</th><th align="left">CC</th><th align="left">Significantly linear?</th></tr></thead><tbody><tr><td align="left">7</td><td align="left">0</td><td align="left">Yes</td></tr><tr><td align="left">27</td><td align="left">17</td><td align="left">No</td></tr><tr><td align="left">18</td><td align="left">2</td><td align="left">No</td></tr><tr><td align="left">24</td><td align="left">0</td><td align="left">No</td></tr><tr><td align="left">44</td><td align="left">3</td><td align="left">Yes</td></tr></tbody></table></table-wrap></p>
      <p>After applying OscoNet, we assessed the significance of each community using a Wilcoxon test as described previously. The results are shown in Table <xref rid="Tab5" ref-type="table">5</xref>. Hence we identify six significant communities using the Wilcoxon test (<italic>α</italic>=0.01). As in the previous study, we eliminate singleton communities that contain only one gene.
<table-wrap id="Tab5"><label>Table 5</label><caption><p>scRNA-seq Data Clusters Significance</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Size</th><th align="left">CC</th><th align="left">Density</th><th align="left">Relative density</th><th align="left">Hypergeometric</th><th align="left">Neat</th></tr></thead><tbody><tr><td align="left">4</td><td align="left">1</td><td align="left">&lt;1<italic>e</italic>−4</td><td align="left">0.50</td><td align="left">0.03</td><td align="left">1.00</td></tr><tr><td align="left">6</td><td align="left">0</td><td align="left">&lt;1<italic>e</italic>−4</td><td align="left">0.33</td><td align="left">N/A</td><td align="left">N/A</td></tr><tr><td align="left">77</td><td align="left">32</td><td align="left">0.09</td><td align="left">0.15</td><td align="left">&lt;1<italic>e</italic>−6</td><td align="left">&lt;1<italic>e</italic>−6</td></tr><tr><td align="left">155</td><td align="left">7</td><td align="left">0.14</td><td align="left">0.06</td><td align="left">0.84</td><td align="left">0.48</td></tr><tr><td align="left">188</td><td align="left">11</td><td align="left">0.10</td><td align="left">0.03</td><td align="left">0.65</td><td align="left">0.16</td></tr><tr><td align="left">234</td><td align="left">17</td><td align="left">0.15</td><td align="left">0.03</td><td align="left">0.45</td><td align="left">0.45</td></tr></tbody></table></table-wrap></p>
      <p>Only one community is enriched in nodes and edges according to the hypergeometric and NEAT tests (<italic>α</italic>=0.01). This community is enriched in CC with 32 genes out of 77 belonging to the term GO : 0007049. This community contains the standard Oscope cluster of 29 genes reported in [<xref ref-type="bibr" rid="CR2">2</xref>]. As in the previous study, we find that the OscoNet approach is more sensitive than Oscope identifying a cluster with a superset of CC genes.</p>
      <p>The two highest ranked communities in terms of relative density have a small size of only 4 and 6 genes respectively. These are ranked highly because of their exceptionally small size and are not CC enriched. A threshold on the community size would exclude such small communities.</p>
      <sec id="Sec14">
        <title>pseudo-time</title>
        <p>We compared pseudo-time using the 77 and 29 gene clusters estimated by OscoNet and Oscope respectively. ENI takes an average of 13 h of computing time to estimate the pseudo-time for both clusters while the spectral method requires approximately 30 min. The difference in computing time is that ENI is leveraged the 2-opt algorithm to reduce the likelihood of local minima. In contrast, the spectral method has a unique solution for a given number of neighbours <italic>n</italic> and is quick to evaluate leveraging efficient sparse eigenvalue solvers. The grid search we performed over different values of <italic>n</italic> ensures the robustness of the results.</p>
        <p>In Fig. <xref rid="Fig8" ref-type="fig">8</xref> we show the fit for the spectral method for both gene sets. There is more noise in the data than in the previous case study, and the pattern is less circular. Despite this, the algorithm is able to recover the cell cycle order as we now show.
<fig id="Fig8"><label>Fig. 8</label><caption><p>scRNA-seq: latent space representation using spectral dimensionality reduction trained on the two different clusters. Each cell dot is coloured by the true base cycle stage, namely G1, G2 and S phase</p></caption><graphic xlink:href="12859_2020_3561_Fig8_HTML" id="MO8"/></fig></p>
        <p>We compared the performance of the algorithm estimating pseudo-time using all 460 cells and assessing the separation of CC stages on the labelled subset of cells, which consists of 247 cells. After pseudo-time estimation, we applied the k-means algorithm with <italic>K</italic>=3 to identify the three clusters associated with G1, G2 and S phase. We computed the ARI to contrast the clustering results with the CC labels; the ARI measure is in the range [0,1] with higher values reflecting better agreement between the estimated and true cell cycle stages.</p>
        <p>In Table <xref rid="Tab6" ref-type="table">6</xref> we show the ARI results in comparison to the spectral and ENI method. The performance of the latter is poor, which can be validated when looking at the gene expression output (Fig. <xref rid="Fig9" ref-type="fig">9</xref>). The spectral method provides better accuracy for both gene clusters with an ARI of 0.43 when using the Oscope 29 gene cluster and 0.49 when using the OscoNet 77 gene cluster. The higher ARI for the latter reflects the richer information content of the OscoNet cluster compared to the Oscope cluster; the OscoNet spectral ordering contains fewer cells assigned to an incorrect CC stage than the Oscope spectral ordering as is evident in Fig. <xref rid="Fig9" ref-type="fig">9</xref> for four example genes.
<fig id="Fig9"><label>Fig. 9</label><caption><p>scRNA-seq: Comparing pseudo-time estimation using ENI and the spectral method. Cells have been coloured by the CC stage or as grey when not known, denoted as H1 in the legend. The pseudo-time estimated the ENI method with 29 genes (<bold>a</bold>) and the spectral method with the same 29 genes (<bold>b</bold>) and 77 genes (<bold>c</bold>) respectively are shown. We also report the agreement with the known cell cycle labels using the adjusted rank index (ARI)</p></caption><graphic xlink:href="12859_2020_3561_Fig9_HTML" id="MO9"/></fig><table-wrap id="Tab6"><label>Table 6</label><caption><p>scRNA-seq: ARI on <italic>K</italic>=3 K-mean clustering vs true cell-cycle stage</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Method</th><th align="left">Training</th><th align="left">ARI</th></tr></thead><tbody><tr><td align="left">Spectral</td><td align="left">29</td><td align="left">0.43</td></tr><tr><td align="left"/><td align="left">77</td><td align="left">0.49</td></tr><tr><td align="left">ENI</td><td align="left">29</td><td align="left">0.05</td></tr><tr><td align="left"/><td align="left">77</td><td align="left">0.02</td></tr></tbody></table></table-wrap></p>
        <p>The poor performance of the ENI algorithm is confirmed when looking at the roughness value (Table <xref rid="Tab7" ref-type="table">7</xref>). The ENI algorithm has higher roughness values for all combinations examined while the spectral method achieves similar roughness values with both clusters.
<table-wrap id="Tab7"><label>Table 7</label><caption><p>scRNA-seq data: change in median roughness</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left"/><th align="left" colspan="2">Predicting gene set</th></tr><tr><th align="left">Method</th><th align="left">Training</th><th align="left">29</th><th align="left">77</th></tr></thead><tbody><tr><td align="left">Spectral</td><td align="left">29</td><td align="left">1.25</td><td align="left">1.35</td></tr><tr><td align="left"/><td align="left">77</td><td align="left">1.23</td><td align="left">1.35</td></tr><tr><td align="left">ENI</td><td align="left">29</td><td align="left">1.41</td><td align="left">1.41</td></tr><tr><td align="left"/><td align="left">77</td><td align="left">1.42</td><td align="left">1.40</td></tr></tbody></table></table-wrap></p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec15" sec-type="conclusion">
    <title>Conclusions</title>
    <p>We have presented a well-calibrated hypothesis test that avoids a need for a threshold cut-off on the pairwise distance matrix. Further, our implementation is highly scalable due to the use of parallel vectorisation which has been demonstrated to be orders of magnitude faster than the one used in Oscope.</p>
    <p>We have then performed network analysis to identify statistically significant communities of genes again avoiding any need to set the maximum number of communities as is needed in the K-medoids approach of [<xref ref-type="bibr" rid="CR2">2</xref>]. We have also been able to select the significant communities based on a standard statistical test and assess the significance of enrichment in terms of both genes and their co-oscillatory relationship. We have validated our approach on synthetic data demonstrating that it is well-calibrated with respect to the false discovery rate, unlike [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p>We contrasted our approach to that of Leng et al. [<xref ref-type="bibr" rid="CR2">2</xref>] on both microarray and scRNA-seq data with known oscillators. In both cases, we are able to recover the original Oscope cluster of genes in addition to discovering more oscillators.</p>
    <p>We estimated a unique pseudo-time per gene community using a spectral approach. The spectral approach requires an order of magnitude less computation than the ENI approach proposed in Leng et al. [<xref ref-type="bibr" rid="CR2">2</xref>] and is more accurate as reflected in both peak time correlation in the microarray data and cell cycle stage separation in the single-cell data.</p>
    <p>One issue with our current approach is that for a low number of cells, the small number of possible permutations in the similarity measure reduces the power of the bootstrap hypothesis test resulting in a high minimum achievable FDR. A semi-parametric bootstrap approach should help to increase the power of the test, particularly in case of small numbers of cells and low FDRs, which is typically required.</p>
    <p>Finally, extending this approach as a probabilistic model including the effect of dropout which is prominent in single-cell datasets, may further increase the accuracy of the method and allow for quantification of uncertainty in the resulting co-oscillating gene clusters.</p>
    <p>The pseudo-time model could be extended to use a probabilistic model to estimate pseudo-time while imposing a periodicity constraint jointly. This will also allow for selecting the number of latent dimensions by maximising the model evidence. A probabilistic formulation of Laplace Eigenmaps latent variable model has already been shown [<xref ref-type="bibr" rid="CR20">20</xref>] where the Laplacian Eigenmaps latent variable model is described. In future work, one could extend this class of model, in the probabilistic or deterministic formulation, to include a periodic constraint.</p>
    <p>The method we have presented can be incorporated in a single-cell analysis pipeline to allow biologists to uncover novel periodic dynamic gene regulatory mechanisms. Our approach avoids less interpretable cut-offs and relies on well-calibrated statistical tests. As the availability and size of single-cell whole transcriptome data increases, the non-parametric and automatic nature of our approach will allow for a corresponding increase in resolution of the analysis resulting in a more detailed description of oscillatory gene expression systems.</p>
  </sec>
  <sec id="Sec16">
    <title>Appendix</title>
    <sec id="Sec17">
      <title>Quality control</title>
      <p>In any single-cell pipeline, it is necessary to perform some rudimentary quality control to ensure downstream analysis is not affected by low-quality measurements. In the Oscope pipeline [<xref ref-type="bibr" rid="CR2">2</xref>], a threshold on the mean level and a log-linear cut-off on the variance is applied.</p>
      <p>We prefer using a simpler approach based on variance based filtering with a high variance cut-off of 0.9 [<xref ref-type="bibr" rid="CR19">19</xref>]. This ensures a simple and consistent quality control mechanism that has been shown to remove low quality genes [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
    </sec>
    <sec id="Sec18">
      <title>Roughness measure</title>
      <p>Roughness for a particular gene was defined in [<xref ref-type="bibr" rid="CR21">21</xref>] as
<disp-formula id="Equa"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\frac{1}{\sigma_{g}} \sqrt{ \frac{1}{C-1} \sum_{c=1}^{C-1} \left(x_{g, z_{c}} - x_{g, z_{c+1}} \right)^{2} }$$ \end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math><graphic xlink:href="12859_2020_3561_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> where <italic>σ</italic><sub><italic>g</italic></sub> the standard deviation of gene expression and <inline-formula id="IEq5"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{g, z_{c}}$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3561_Article_IEq5.gif"/></alternatives></inline-formula> is the gene expression for gene <italic>g</italic> at pseudo-time order <italic>z</italic><sub><italic>c</italic></sub>.</p>
      <p>This metric measures the smoothness of the gene expression profile by looking at the differences of consecutive measurements. Smaller values indicate a smoother response.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec19">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2020_3561_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> A supplementary report is available (supplementary.pdf).</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>FDR</term>
        <def>
          <p>False discovery rate</p>
        </def>
      </def-item>
      <def-item>
        <term>ENI</term>
        <def>
          <p>Extended nearest insertion</p>
        </def>
      </def-item>
      <def-item>
        <term>CC</term>
        <def>
          <p>Cell cycle</p>
        </def>
      </def-item>
      <def-item>
        <term>hESCs</term>
        <def>
          <p>Human embryonic stem cells</p>
        </def>
      </def-item>
      <def-item>
        <term>ARI</term>
        <def>
          <p>Adjusted rand index</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p>Intuitively, any monotonic transformation of time will not alter the value of the objective function.</p>
    </fn>
    <fn id="Fn2">
      <label>2</label>
      <p>These are available in the <italic>R</italic> package <italic>igraph</italic>.</p>
    </fn>
    <fn>
      <p>Luisa Cutillo and Alexis Boukouvalas contributed equally to this work.</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Luisa Cutillo and Alexis Boukouvalas are co-first authors.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-020-03561-y.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the Oscope authors for sharing their processed microarray Whitfield data.</p>
    <sec id="d30e2467">
      <title>About this supplement</title>
      <p>This article has been published as part of <italic>BMC Bioinformatics Volume 21 Supplement 10, 2020: Proceedings from the 13th Bioinformatics and Computational Biology International Conference - BBCC2018</italic>. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-21-supplement-10">https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-21-supplement-10</ext-link>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>LC and AB did all the computational work and equally contributed as first authors. MR, NP and EM conceived the study. All authors participated in writing the paper. All authors have read the paper and approve it.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>MR and AB were supported by MRC award MR/M008908/1. LC was supported by H2020-EU EU Marie Curie fellowship CONTESSA (ID: 660388). NP is funded through a Wellcome Trust Senior Research Fellowship (106185/Z/14/Z). EM is funded through a Sir Henry Wellcome Fellowship (201380/Z/16/Z). Publication costs are covered by the University of Manchester Wellcome Trust funds.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All data used in the paper are freely available; see [<xref ref-type="bibr" rid="CR2">2</xref>] for details on download instructions. The OscoNet code is publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/alexisboukouvalas/OscoNet">https://github.com/alexisboukouvalas/OscoNet</ext-link>.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levine</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Elowitz</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Functional roles of pulsing in genetic circuits</article-title>
        <source>Science</source>
        <year>2013</year>
        <volume>342</volume>
        <issue>6163</issue>
        <fpage>1193</fpage>
        <lpage>200</lpage>
        <?supplied-pmid 24311681?>
        <pub-id pub-id-type="pmid">24311681</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leng</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>L-F</given-names>
          </name>
          <name>
            <surname>Barry</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Kendziorski</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Oscope identifies oscillatory genes in unsynchronized single-cell rna-seq experiments</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>10</issue>
        <fpage>947</fpage>
        <lpage>50</lpage>
        <?supplied-pmid 26301841?>
        <pub-id pub-id-type="pmid">26301841</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bacher</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kendziorski</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Design and computational analysis of single-cell rna-sequencing experiments</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <pub-id pub-id-type="pmid">26753840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Statistical significance for genomewide studies</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2003</year>
        <volume>100</volume>
        <issue>16</issue>
        <fpage>9440</fpage>
        <lpage>5</lpage>
        <?supplied-pmid 12883005?>
        <pub-id pub-id-type="pmid">12883005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>MEJ</given-names>
          </name>
          <name>
            <surname>Girvan</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Finding and evaluating community structure in networks</article-title>
        <source>Phys Rev</source>
        <year>2004</year>
        <volume>69</volume>
        <issue>11</issue>
        <fpage>026113</fpage>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Pons</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Latapy</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>Computing Communities in Large Networks Using Random Walks</source>
        <year>2005</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer Berlin Heidelberg</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clauset</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Newman</surname>
            <given-names>MEJ</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Finding community structure in very large networks</article-title>
        <source>Phys Rev E</source>
        <year>2004</year>
        <volume>066111</volume>
        <fpage>70</fpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <mixed-citation publication-type="other">Rosvall M, Bergstrom CT. Maps of information flow reveal community structure in complex networks. PNAS. 2008:105–1118. 10.1073/pnas.0706851105.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Girvan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Newman</surname>
            <given-names>MEJ</given-names>
          </name>
        </person-group>
        <article-title>Community structure in social and biological networks</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2002</year>
        <volume>99</volume>
        <issue>12</issue>
        <fpage>7821</fpage>
        <lpage>6</lpage>
        <?supplied-pmid 12060727?>
        <pub-id pub-id-type="pmid">12060727</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fortunato</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Community detection in graphs</article-title>
        <source>Phys Rep</source>
        <year>2010</year>
        <volume>066111</volume>
        <fpage>75</fpage>
        <lpage>174</lpage>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <mixed-citation publication-type="other">Lawson CE, et al.Metabolic network analysis reveals microbial community interactions in anammox granules. Nat Commun. 2017. 10.1038/ncomms15416.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <mixed-citation publication-type="other">Hermjakob H, et al.The hupo psi’s molecular interaction format–a community standard for the representation of protein interaction data. Nat Biotechnol. 2004:177–83. 10.1038/nbt926.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <mixed-citation publication-type="other">Signorelli M, Vinciotti V, Wit E. Neat: an efficient network enrichment analysis test. BMC Bioinformatics. 2016; 12(352). 10.1186/s12859-016-1203-6.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Belkin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Niyogi</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Laplacian eigenmaps for dimensionality reduction and data representation</article-title>
        <source>Neural Comput</source>
        <year>2003</year>
        <volume>15</volume>
        <issue>6</issue>
        <fpage>1373</fpage>
        <lpage>96</lpage>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <mixed-citation publication-type="other">Titsias MK, Lawrence ND. Bayesian gaussian process latent variable model. In: International Conference on Artificial Intelligence and Statistics. PMLR, Proceedings of the Thirteenth International Conference on Artificial Intelligence and Statistics: 2010. p. 844–51. <ext-link ext-link-type="uri" xlink:href="http://proceedings.mlr.press/v9/titsias10a/titsias10a.pdf">http://proceedings.mlr.press/v9/titsias10a/titsias10a.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Michael</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Whitfield</surname>
            <given-names>GS</given-names>
          </name>
          <name>
            <surname>Saldanha</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>JI</given-names>
          </name>
          <name>
            <surname>Ball</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Alexander</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Matese</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Perou</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Hurt</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>PO</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of genes periodically expressed in the human cell cycle and their expression in tumors</article-title>
        <source>Mol Biol Cell</source>
        <year>2002</year>
        <volume>13</volume>
        <issue>6</issue>
        <fpage>1977</fpage>
        <lpage>2000</lpage>
        <pub-id pub-id-type="pmid">12058064</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thomson</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Itskovitz-Eldor</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shapiro</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Waknitz</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Swiergiel</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>VS</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Embryonic stem cell lines derived from human blastocysts.</article-title>
        <source>Science</source>
        <year>1998</year>
        <volume>282</volume>
        <issue>5391</issue>
        <fpage>1145</fpage>
        <lpage>7</lpage>
        <?supplied-pmid 9804556?>
        <pub-id pub-id-type="pmid">9804556</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubert</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Arabie</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <source>Comparing partitions. Journal of the Classification, pages</source>
        <year>1985</year>
        <volume>2</volume>
        <fpage>193</fpage>
        <lpage>218</lpage>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <mixed-citation publication-type="other">Gentleman R, Carey V, Huber W, Hahne F. genefilter: genefilter: methods for filtering genes from high-throughput experiments; 2020. R package version 1.70.0. <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/bioc/html/genefilter.html">https://bioconductor.org/packages/release/bioc/html/genefilter.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <mixed-citation publication-type="other">Zhengdong L, Sminchisescu C, Carreira-Perpiñán MÁ. People tracking with the laplacian eigenmaps latent variable model In: Platt JC, Koller D, Singer Y, Roweis ST, editors. Advances in neural information processing systems. Curran Associates, Inc.: 2008. p. 1705–12. <ext-link ext-link-type="uri" xlink:href="http://papers.nips.cc/paper/3226-people-tracking-with-the-laplacian-eigenmapslatent-variable-model.pdf">http://papers.nips.cc/paper/3226-people-tracking-with-the-laplacian-eigenmapslatent-variable-model.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reid</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Wernisch</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Pseudotime estimation: deconfounding single cell time series</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>19</issue>
        <fpage>2973</fpage>
        <lpage>80</lpage>
        <?supplied-pmid 27318198?>
        <pub-id pub-id-type="pmid">27318198</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
