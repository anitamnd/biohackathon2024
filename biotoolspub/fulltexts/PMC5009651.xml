<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5009651</article-id>
    <article-id pub-id-type="publisher-id">1212</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-016-1212-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Risk-conscious correction of batch effects: maximising information extraction from high-throughput genomic datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Oytam</surname>
          <given-names>Yalchin</given-names>
        </name>
        <address>
          <email>yalchin.oytam@csiro.au</email>
          <email>yalchinoytam@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sobhanmanesh</surname>
          <given-names>Fariborz</given-names>
        </name>
        <address>
          <email>fsobhanmanesh@yahoo.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Duesing</surname>
          <given-names>Konsta</given-names>
        </name>
        <address>
          <email>konsta.duesing@csiro.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bowden</surname>
          <given-names>Joshua C.</given-names>
        </name>
        <address>
          <email>josh.bowden@csiro.au</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Osmond-McLeod</surname>
          <given-names>Megan</given-names>
        </name>
        <address>
          <email>megan.osmond@csiro.au</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ross</surname>
          <given-names>Jason</given-names>
        </name>
        <address>
          <email>jason.ross@csiro.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>CSIRO, Genomics and Cellular Sciences, Transformational Biology CP, North Ryde, NSW Australia </aff>
      <aff id="Aff2"><label>2</label>CSIRO, Genomics and Cellular Sciences, Advanced Materials CP (Nanosafety), 11 Julius Avenue, North Ryde, NSW 2113 Australia </aff>
      <aff id="Aff3"><label>3</label>CSIRO, IM&amp;T, Science Applications, St Lucia, QLD Australia </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>9</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>9</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>17</volume>
    <issue>1</issue>
    <elocation-id>332</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>12</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>8</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2016</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Batch effects are a persistent and pervasive form of measurement noise which undermine the scientific utility of high-throughput genomic datasets. At their most benign, they reduce the power of statistical tests resulting in actual effects going unidentified. At their worst, they constitute confounds and render datasets useless. Attempting to remove batch effects will result in some of the biologically meaningful component of the measurement (i.e. signal) being lost. We present and benchmark a novel technique, called <italic>Harman</italic>. Harman maximises the removal of batch noise with the constraint that the risk of also losing biologically meaningful component of the measurement is kept to a fraction which is set by the user.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Analyses of three independent publically available datasets reveal that Harman removes more batch noise and preserves more signal at the same time, than the current leading technique. Results also show that Harman is able to identify and remove batch effects no matter what their relative size compared to other sources of variation in the dataset. Of particular advantage for meta-analyses and data integration is Harman’s superior consistency in achieving comparable noise suppression - signal preservation trade-offs across multiple datasets, with differing number of treatments, replicates and processing batches.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>Harman’s ability to better remove batch noise, and better preserve biologically meaningful signal simultaneously within a single study, and maintain the user-set trade-off between batch noise rejection and signal preservation across different studies makes it an effective alternative method to deal with batch effects in high-throughput genomic datasets. Harman is flexible in terms of the data types it can process. It is available publically as an R package (<ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/bioc/html/Harman.html">https://bioconductor.org/packages/release/bioc/html/Harman.html</ext-link>), as well as a compiled Matlab package (<ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.csiro.au/harman/">http://www.bioinformatics.csiro.au/harman/</ext-link>) which does not require a Matlab license to run.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12859-016-1212-5) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Batch effects</kwd>
      <kwd>ComBat</kwd>
      <kwd>High-throughput genomic data</kwd>
      <kwd>Measurement noise</kwd>
      <kwd>Principal component analysis</kwd>
      <kwd>Singular value decomposition</kwd>
      <kwd>Guided PCA</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000943</institution-id>
            <institution>Commonwealth Scientific and Industrial Research Organisation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Transformational Biology Capability Platfrom R3147-1</award-id>
        <award-id>ERRFP-328</award-id>
        <principal-award-recipient>
          <name>
            <surname>Oytam</surname>
            <given-names>Yalchin</given-names>
          </name>
          <name>
            <surname>Duesing</surname>
            <given-names>Konsta</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2016</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Background</title>
    <p>Modern high-throughput genomic datasets are exquisite in their detail. The comprehensive range of measurements contained therein not only ameliorates, at least to a degree, reliance on narrow and specific <italic>a priori</italic> hypotheses, but also makes possible an appreciation of genetic behaviour at its fullest – i.e. at the level of interconnected gene networks. In this sense, modern genomics opens the door to forms of biological knowledge and thinking which would be difficult to attain with traditional methods of experimental biology.</p>
    <p>There are challenges to be met in going from the rich detail in the datasets to a systemic understanding of genes. In our view, these can be separated into two main stages – first the establishment of reliable units of evidence, second the discovery of what these might mean at a global, systemic level. To illustrate via an example, suppose a genome-wide gene expression dataset resulting from an experiment comparing cellular response to a particular treatment against a control group. The first stage is to establish a reliable and exhaustive list of genes that are differentially expressed under the two conditions. The second is to go from the list of individual genes to a functional understanding of gene pathways, activated as a result of the treatment. <italic>Batch effects</italic>, the topic of this manuscript, belong to the first stage of challenges. They are a pervasive form of technical noise, which compromise individual measurements to varying degrees, and affects significantly the ability of analytical means used to identify those that vary between experimental conditions. Batch effects are found in gene expression microarray [<xref ref-type="bibr" rid="CR1">1</xref>], sequencing [<xref ref-type="bibr" rid="CR2">2</xref>], DNA methylation (e.g. [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR4">4</xref>]), copy number variation (e.g. [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]) and proteomic (e.g. [<xref ref-type="bibr" rid="CR7">7</xref>]) datasets.</p>
    <sec id="Sec2">
      <title>Batch effects are structured patterns of distortion</title>
      <p>High-throughput technologies in biology typically require a sequence of delicate and labour intensive procedures, involving a combination of reagents and specialist machinery, conducted under strictly controlled conditions. Frequently, the volume and nature of the work means that the laboratory process is broken into ‘batches’ – each batch consisting of a certain number of replicates to process – performed over a number of days. Batch effects consist of a series of structured patterns of measurement noise each of which permeates all replicates in a given processing batch, and which vary markedly from batch to batch. We describe batch distortion as being <italic>structured</italic>, because it has a spatial character – in the case of microarrays for example, it imprints upon the expression values of probesets depending on the location of their constituent probes [<xref ref-type="bibr" rid="CR1">1</xref>]. A large number of probesets can have their values altered significantly by this kind of distortion, without it being reflected in measures that are not spatially sensitive. To illustrate the point, it is possible to distort the expression value of all probesets completely (by misallocating them the value of their preceding probeset) without at all changing, say, the quantile distribution of probeset values. As such, quantile normalisation techniques such as RMA [<xref ref-type="bibr" rid="CR8">8</xref>] would be of limited use in correcting batch effects [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. A helpful visual metaphor may be to think of a dried watermark, formed by an unintended splash of brush water on a fresh painting. Or rather, a printing machine with a software virus, which makes prints of paintings, produces a certain number of copies at a time, each set with the same ‘watermark’, and that watermark changes randomly from set to set. These ‘watermarks’ cannot be removed from a digital poster, simply by adjusting its mean or quantile intensities of red, green and blue. They can be altered, along with the unaffected parts of the painting and hence causing a ‘smearing’ effect, but not removed.</p>
    </sec>
    <sec id="Sec3">
      <title>Result of a stochastic interaction of process variables?</title>
      <p>Batches being processed in different laboratories, by different personnel, subtle ambient differences (in temperature or humidity) in the same laboratory from one processing day to the next, and changes in reagents have been suggested and explored as the cause of batch effects [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Evidence suggests batch effects are pervasive and persistent under best practice. Indeed, in the studies we conducted [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>], all the above mentioned factors were well controlled – the same laboratory (with controlled temperature and humidity), the same operator, and the same re-agents. Yet the data revealed significant batch effects, accounting for as high as 40 % of the variance in the data. Leek et al. [<xref ref-type="bibr" rid="CR2">2</xref>] make the insightful observation that structured measurement noise such as batch effects are in fact not unique to high-dimensional genomic datasets (e.g. microarray or RNA-seq), or other types of high-dimensional data (e.g., mass spectroscopy), but also affect traditional ‘low-dimensional’ data where just a few measurements are involved. The distinction, they propose, is that batch effects are identifiable in high-dimensional datasets, but not so in traditional datasets and as such go unnoticed. If so, it may be useful to think of batch effects as stemming from a stochastic combination of many of the factors at play during laboratory processing of data capture equipment, which is not readily controllable or avoidable. A more achievable way of managing batch noise may be to dissociate it from the genuine biological signal component of the dataset, and remove it in an effective manner.</p>
    </sec>
    <sec id="Sec4">
      <title>Batch effects have a detrimental effect on the utility of datasets</title>
      <p>In terms of scientific inference, batch effects are most problematic when they are aligned (i.e. strongly correlated) with treatment effects. Table <xref rid="Tab1" ref-type="table">1A</xref> depicts one such example, an extreme yet not uncommon one, where each processing batch contains one type of treatment or experimental condition. The difference between a pair of treatments will be completely confounded by the typically larger difference between the two distinct patterns of batch distortion. An entire group of genes, invariant across the two experimental conditions yet with probesets altered differentially by batch distortion will appear to be differentially expressed [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. Moreover, these false positives may dominate those genes that are differentially expressed across the two experimental conditions, because they are likely to appear to have a larger difference in their expression levels. The common practice of selecting top differentially expressed genes for further analysis and exploration, as ranked by magnitude, may further exacerbate this problem – resulting in the exclusion of differentially expressed genes, in favour of false positives.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Separating samples into processing batches</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Batch 1</th><th>Batch 2</th><th>Batch 3</th><th>Batch 4</th></tr></thead><tbody><tr><td colspan="4">A</td></tr><tr><td>T<sub>1r1</sub> + B<sub>1</sub>
</td><td>T<sub>2r1</sub> + B<sub>2</sub>
</td><td>T<sub>3r1</sub> + B<sub>3</sub>
</td><td>T<sub>4r1</sub> + B<sub>4</sub>
</td></tr><tr><td>T<sub>1r2</sub> + B<sub>1</sub>
</td><td>T<sub>2r2</sub> + B<sub>2</sub>
</td><td>T<sub>3r2</sub> + B<sub>3</sub>
</td><td>T<sub>4r2</sub> + B<sub>4</sub>
</td></tr><tr><td>T<sub>1r3</sub> + B<sub>1</sub>
</td><td>T<sub>2r3</sub> + B<sub>1</sub>
</td><td>T<sub>3r3</sub> + B<sub>3</sub>
</td><td>T<sub>4r3</sub> + B<sub>4</sub>
</td></tr><tr><td>T<sub>1r4</sub> + B<sub>1</sub>
</td><td>T<sub>2r4</sub> + B<sub>2</sub>
</td><td>T<sub>3r4</sub> + B<sub>3</sub>
</td><td>T<sub>4r4</sub> + B<sub>4</sub>
</td></tr><tr><td colspan="4">B</td></tr><tr><td>T<sub>1r1</sub> + B<sub>1</sub>
</td><td>T<sub>1r2</sub> + B<sub>2</sub>
</td><td>T<sub>1r3</sub> + B<sub>3</sub>
</td><td>T<sub>1r4</sub> + B<sub>4</sub>
</td></tr><tr><td>T<sub>2r1</sub> + B<sub>1</sub>
</td><td>T<sub>2r2</sub> + B<sub>2</sub>
</td><td>T<sub>2r3</sub> + B<sub>3</sub>
</td><td>T<sub>2r4</sub> + B<sub>4</sub>
</td></tr><tr><td>T<sub>3r1</sub> + B<sub>1</sub>
</td><td>T<sub>3r2</sub> + B<sub>1</sub>
</td><td>T<sub>3r3</sub> + B<sub>3</sub>
</td><td>T<sub>3r4</sub> + B<sub>4</sub>
</td></tr><tr><td>T<sub>4r1</sub> + B<sub>1</sub>
</td><td>T<sub>4r2</sub> + B<sub>2</sub>
</td><td>T<sub>4r3</sub> + B<sub>3</sub>
</td><td>T<sub>4r4</sub> + B<sub>4</sub>
</td></tr></tbody></table><table-wrap-foot><p>B denotes batch effects, T is treatment and the subscript r is the replicate of that treatment. (A): In this design, each batch consists of one type of treatment. Batch and treatments effects are completely confounded. When we attempt to measure the difference between two treatments, say T<sub>1 </sub>and T<sub>2</sub>, what we are actually measuring is (T<sub>1</sub>-T<sub>2</sub>) + (B<sub>1</sub>-B<sub>2</sub>). Moreover, (B<sub>1</sub>-B<sub>2</sub>) is typically likely to be much larger than (T<sub>1</sub>-T<sub>2</sub>). (B): This represents the optimal experimental design strategy, where all treatments are distributed equally across all batches. There is no confounding here, but differences between B<sub>1</sub>, B<sub>2</sub>, B<sub>3</sub> and B<sub>4</sub> artificially inflate within-treatment differences, and reduce the power of subsequent statistical tests</p></table-wrap-foot></table-wrap></p>
      <p>It is possible to avoid this issue by making batch and treatment effects orthogonal to one another via modified experimental and procedural design. Table <xref rid="Tab1" ref-type="table">1B</xref> depicts the optimal case, where the replicates of each and every treatment are distributed equally across the batches, avoiding any confounding between batch and treatment effects. The closer we come to this ideal design, the less the confounding effect. However, even with ideal experimental design and no confounding of batch and treatment effects, there remains a fundamental problem. Differences between individual batch effects, B<sub>n</sub> in Table <xref rid="Tab1" ref-type="table">1B</xref>, will inflate within-treatment variances, diminishing the power of any between-treatment comparison tests. As a result genes that are actually differentially expressed between two experimental conditions will have their <italic>p</italic>-values elevated and will appear to be not differentially expressed (see also [<xref ref-type="bibr" rid="CR2">2</xref>], p.736). Moreover, different probesets on a particular array are affected differently by batch effects, meaning that some genes will have their <italic>p</italic>-values altered a lot, some less so, and some not at all. This will distort the ranking of genes based on their <italic>p</italic>-value, also distorting the results of rank based false discovery correction methods such as Benjamini-Hochberg ([<xref ref-type="bibr" rid="CR14">14</xref>]; see also [<xref ref-type="bibr" rid="CR13">13</xref>], pp. 9–10).</p>
      <p>The ideal solution to batch effects is to completely dissociate batch noise from genuine biological signal in the dataset, remove all of batch noise and none of the biological signal. In practice, however, removing noise carries with it the risk of also removing biological signal. One fundamental reason for this is that the distinction between signal and noise components, if attainable, is likely to be probabilistic rather than absolute. If genuine biological variance is removed along with batch noise, within-group variances are then artificially deflated making genes that are not differentially expressed appear as though they are. If we had multiple batch correction methods to choose from, the score by which we measure their effectiveness would have two dimensions – how much of the batch noise they remove, and how much of the biological signal they preserve.</p>
    </sec>
    <sec id="Sec5">
      <title>Outline</title>
      <p>In this paper we describe a novel method which dissociates and removes the batch noise component in a dataset, with the constraint that the associated risk of also removing genuine biological signal is quantified and kept to a fraction set by the end user. If we set our confidence limit to .95, this would mean that the probability of some of what we remove not being batch effect but a feature of genuine biological signal is .05. The method works by first separating the data into its principal components. It scans each principal component for variance arising out of batch noise – as manifest by clustering of scores belonging to the same batch – and removes any that is found up to a point where the risk of removing biological signal is no more than the tolerance level set by the user. As the principal components collectively explain all the variance to be found in the dataset, scanning and if necessary correcting each of them means that batch effects are found and corrected, irrespective of how big or small they may be with respect to other factors accounting for the data variance. The principal components after removal of batch noise are recombined and transformed back into the original dataset format, ready to be used for any downstream analysis tailored for the initial dataset, without necessitating any additional data processing. We call this new method <italic>Harman</italic>, meaning (in Turkish and Persian) threshing yard where grain was separated from chaff in the days before Industrialisation. Harman has a precedent in and can be seen as a refinement of the work of Alter and colleagues [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>], who transformed genome-wide expression data into principal components, and then removed some of them entirely which they inferred to be dominated by batch effects.</p>
      <p>ComBat [<xref ref-type="bibr" rid="CR17">17</xref>] is a popular batch removal method, which has been shown to have the best overall performance in a recent comparative study [<xref ref-type="bibr" rid="CR9">9</xref>] of six approaches including [<xref ref-type="bibr" rid="CR18">18</xref>–<xref ref-type="bibr" rid="CR21">21</xref>]. As such it makes for a good standard against which to compare any novel batch removal method. We compare the performance of Harman with that of ComBat in the context of three distinct, publically available genome-wide gene expression datasets. Two of these – an in vitro [<xref ref-type="bibr" rid="CR11">11</xref>] and an in vivo [<xref ref-type="bibr" rid="CR12">12</xref>] study – were generated in our laboratory. The third is the in vitro dataset used in ComBat’s development [<xref ref-type="bibr" rid="CR17">17</xref>]. While all three are microarray datasets, it is important to note that both ComBat and Harman would be applicable in correcting RNA-seq datasets (e.g., [<xref ref-type="bibr" rid="CR22">22</xref>]). We also use Harman regularly to correct large methylation datasets.</p>
      <p>The performance measures used in the study are the removal of (batch) noise, and preservation of (biological) signal. For the sake of objectivity, and in the absence of knowing categorically what is signal and what is noise, we use a third party batch noise quantification to evaluate the two methods, the “guided-PCA” statistic developed by Reese et al., [<xref ref-type="bibr" rid="CR23">23</xref>] (see Additional file <xref rid="MOESM1" ref-type="media">1</xref> for further discussion). Guided-PCA <italic>p</italic>-values can be used as a measure of the probability of batch effects being present in the dataset. As <italic>p</italic>-values are a continuous rather than discrete score, they provide a continuum against which the batch noise suppression of different methods or trade-off settings can be measured. The (inversely) proportional relationship between g-PCA <italic>p</italic>-value and the magnitude of the batch effect as measured by g-PCA is further demonstrated in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>. We compute this for each of the three datasets before correction, and after correction by the two methods. Against this metric, we measure what proportion of the raw data variance is preserved in the corrected datasets. A two-dimensional plot of the probability of batch effect existence and proportion of preserved variance post correction depicts the relative merit of the two batch effect removal methods (see Additional file <xref rid="MOESM1" ref-type="media">1</xref> for a more detailed discussion).</p>
    </sec>
  </sec>
  <sec id="Sec6" sec-type="results">
    <title>Results</title>
    <p>Figure <xref rid="Fig1" ref-type="fig">1a</xref> above shows the batch correction results for Dataset 1, and Fig. <xref rid="Fig1" ref-type="fig">1b</xref> shows the PC plot for the first and second components. With a gPCA <italic>p</italic>-value of .008, the uncorrected dataset has a prevalent batch noise component, also evident in the PC plot. Consistent with this, the most conservative Harman setting with a confidence limit of .99 – which means correction stops when there is just 1 % chance that what is being removed may not be due to batch effects alone – results in a 32 % reduction in data variance. After correction by either method, <italic>p</italic>-value increases significantly suggesting the methods are capable of removing batch noise. The figure also reveals how the confidence limit for Harman operates as a trade-off coefficient between noise rejection and signal preservation. As the threshold is decreased, noise rejection increases as reflected by the gPCA <italic>p</italic>-value, and data variance decreases. The resulting Harman points can be thought of as constituting a performance curve for the correction method – one can choose to be at different points on the curve depending on the trade-off coefficient, but nevetheless is constrained to be on the curve. The ComBat point on the graph is below this curve.<fig id="Fig1"><label>Fig. 1</label><caption><p><bold>a</bold> gPCA <italic>p</italic>-value vs preserved data variance plot for Dataset 1 (Osmond-McLeod, Osmond et al., 2013), showing the scores for data before correction (*gPCA = .008), and after correction by ComBat and Harman batch effect removal methods. For Harman, the fractions in the labels denote the adjustable confidence threshold (=1-probability of overcorrection) for batch noise removal. Hn-.95 is highlighted as it may be the setting of choice for a typical dataset. On the vertical, the larger the <italic>p</italic>-value the lower the probability of batch noise presence as detected by gPCA (Reese et al, 2013). Raw data <italic>p</italic>-value of .008, indicates a prevalent batch noise component in the uncorrected dataset. The figure shows that ComBat falls below the Harman curve, indicating Harman’s superiority in terms of removing batch noise and preserving biological signal in the dataset. <bold>b</bold> First and second PCs for Dataset 1 (Osmond-McLeod, Osmond et al., 2013) before correction. The four colours represent the four processing batches. The shapes represent seven distinct treatments. The clustering of batches indicate the presence of batch effects in the first and second PCs of the data</p></caption><graphic xlink:href="12859_2016_1212_Fig1_HTML" id="MO1"/></fig></p>
    <p>Dataset 2 results are depicted in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. At .037, the gPCA <italic>p</italic>-value for the uncorrected dataset is small enough to indicate the presence of batch effects, if not to the same extent as in Dataset 1. Once again, this is consistent with the PC plot. Figure <xref rid="Fig2" ref-type="fig">2b</xref> indicates a batch effect but not to the same extent as Fig. <xref rid="Fig1" ref-type="fig">1b</xref>. Accordingly, both batch effect correction methods result in higher proportions of preserved data variance when compared to Dataset 1. As with Dataset 1 the gPCA <italic>p</italic>-value increases significantly after correction by either method. For Harman the confidence limit has the same trade-off characteristic between noise rejection and data variance preservation. The ComBat point falls below the Harman curve.<fig id="Fig2"><label>Fig. 2</label><caption><p><bold>a</bold> gPCA <italic>p</italic>-value vs preserved data variance plot for Dataset 2 (Osmond-McLeod, Oytam et al., 2013), showing the scores for data before correction (*gPCA = .037), and after correction by ComBat and Harman batch effect removal methods. For Harman, the fractions in the labels denote the adjustable confidence threshold (=1-probability of overcorrection) for batch noise removal. Hn-.95 is highlighted as it may be the setting of choice for a typical dataset. On the vertical axis, the larger the <italic>p</italic>-value the lower the probability of batch noise presence as detected by gPCA (Reese et al, 2013). Raw data <italic>p</italic>-value of .037, indicates a batch noise component in the uncorrected dataset. The figure shows that ComBat falls below the Harman curve, indicating Harman’s superiority in terms of removing batch noise and preserving biological signal in the dataset. <bold>b</bold> First and second PCs for Dataset 2 (Osmond-McLeod, Oytam et al., 2013) before correction. The three colours represent the three processing batches. The shapes represent four distinct treatments. The clustering of batches (less pronounced than Dataset 1) indicate the presence of batch effects in the first and second PCs of the data</p></caption><graphic xlink:href="12859_2016_1212_Fig2_HTML" id="MO2"/></fig></p>
    <p>Dataset 3 shows (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>), as with Datasets 1 and 2, that gPCA <italic>p</italic>-value increases after correction by ComBat or Harman, and that for the latter the confidence limit sets the trade-off between noise rejection and data variance preservation. It also produces some distinct results. The gPCA <italic>p</italic>-value for the uncorrected data is .225, which indicates that there is much less batch noise in Data 3 than in the other two datasets, if any at all. Indeed, Fig. <xref rid="Fig3" ref-type="fig">3b</xref> indicates that treatment variability (in particular, in the treatment group denoted by “*”) is a larger source of data variance than batch effects in the first two principal components. Harman (.95) removes 17 % (gPCA <italic>p</italic>-value = .52), compared to the 37 % (gPCA <italic>p</italic>-value = .63) it removed from Dataset 1. ComBat removes 49 % (with gPCA <italic>p</italic>-value = 1) of the data variance, about the same proportion it removed from Dataset 1 (48 %; gPCA <italic>p</italic>-value = .233) which has the most prevalent batch effect of all datasets (gPCA <italic>p</italic>-value = .008). Furthermore, Harman (.75) matches ComBat’s gPCA <italic>p</italic>-value of 1 while removing 20 percentage points less data variance.<fig id="Fig3"><label>Fig. 3</label><caption><p><bold>a</bold> gPCA <italic>p</italic>-value vs preserved data variance plot for Dataset 3 (Johnson et al., 2007), showing the scores for data before correction (*gPCA = .225), and after correction by ComBat and Harman batch effect removal methods. For Harman, the fractions in the labels denote the adjustable confidence threshold (=1-probability of overcorrection) for batch noise removal. Hn-.95 is highlighted as it may be the setting of choice for a typical dataset. On the vertical axis, the larger the <italic>p</italic>-value the lower the probability of batch noise presence as detected by gPCA (Reese et al, 2013). Raw data <italic>p</italic>-value of .225, indicates that the batch noise component in Dataset 3 is not as predominant as Datasets 1 and 2. The worst case scenario for both methods is that there is no batch effect in the dataset and what they do remove is genuine biological signal. ComBat removes 49 % (with gPCA <italic>p</italic>-value = 1) of the data variance, which is about the same proportion it removed Dataset 1 (48 %; gPCA <italic>p</italic>-value = .233), which had the most prevalent batch effect (gPCA <italic>p</italic>-value = .008). Harman (Hn.95) removes 17 % (gPCA <italic>p</italic>-value = .52), when it removed 37 % (gPCA <italic>p</italic>-value = .63) from Dataset 1. Hn-75 matches ComBat’s gPCA <italic>p</italic>-value of 1 while removing 20 percentage points less data variance. <bold>b</bold> A plot of first and second PCs for Dataset 3 before correction (Johnson et al., 2007). The three colours represent the three processing batches. The shapes represent four distinct experimental conditions. The figure indicates that within-treatment variability is a larger source of data variance than batch effects in the top two principal components</p></caption><graphic xlink:href="12859_2016_1212_Fig3_HTML" id="MO3"/></fig></p>
    <p>Given the unexpectedly high <italic>p</italic>-value for the raw data, it is worth exploring further. With Harman, it is possible to dissociate the principal components in which it finds and removes batch effects, and whether these are in any way different for Dataset 3 than the other datasets. Table <xref rid="Tab2" ref-type="table">2A</xref> below shows the amount of batch correction applied to the first 8 principle components for the three datasets. A score of 1 means there is no correction. The closer the number to 0, the bigger the correction. The remaining principal components not included in the dataset show no or negligible batch correction. Table <xref rid="Tab2" ref-type="table">2B</xref> shows the proportion of overall data variance explained by each principal component.<table-wrap id="Tab2"><label>Table 2</label><caption><p>The varying nature of batch effects in the three datasets as detected by Harman</p></caption><table frame="hsides" rules="groups"><thead><tr><th>PC indices</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th></tr></thead><tbody><tr><td colspan="9">A. Correction Vector (Hn-.95)</td></tr><tr><td>Dataset 1</td><td>0.26</td><td>0.33</td><td>0.51</td><td>0.9</td><td>0.44</td><td>0.85</td><td>0.74</td><td>1</td></tr><tr><td>Dataset 2</td><td>0.42</td><td>1</td><td>0.93</td><td>1</td><td>0.99</td><td>1</td><td>1</td><td>0.95</td></tr><tr><td>Dataset 3</td><td>0.76</td><td>1</td><td>0.35</td><td>0.69</td><td>1</td><td>1</td><td>1</td><td>1</td></tr><tr><td colspan="9">B. % of data variance explained by PC</td></tr><tr><td>Dataset 1</td><td>43.4 %</td><td>9.5 %</td><td>4.8 %</td><td>4.3 %</td><td>2.7 %</td><td>2.4 %</td><td>2.2 %</td><td>2.0 %</td></tr><tr><td>Dataset 2</td><td>19.1 %</td><td>11.5 %</td><td>6.9 %</td><td>4.6 %</td><td>4.3 %</td><td>4.0 %</td><td>3.6 %</td><td>3.6 %</td></tr><tr><td>Dataset 3</td><td>33.9 %</td><td>17.2 %</td><td>16.0 %</td><td>8.6 %</td><td>5.8 %</td><td>4.5 %</td><td>3.7 %</td><td>3.3 %</td></tr></tbody></table><table-wrap-foot><p>(A) Shows the ‘correction vector’ spanning the first eight principal components for the three datasets resulting from Harman (.95). No or negligible correction were detected for the remaining PCs. A score of 1 means no correction, whereas a score of 0 means maximum correction within the confines of Harman. (B) Shows the relative proportion of overall variance explained by each of the (first eight PCs) for the three datasets</p></table-wrap-foot></table-wrap></p>
    <p>For Datasets 1 and 2 the most of batch related variance is accounted for before the third principal component, which is typically the case given the relative size of batch noise compared to other sources of variation captured in the data. In the case of Dataset 3, there is some correction at the first principal component, none at the second, and the largest correction occurs at the third and fourth principal components. The plot of third and fourth principal components in Fig. <xref rid="Fig4" ref-type="fig">4</xref> shows a clear grouping of scores into processing batches, which suggests that what Harman is identifying and removing as batch noise may indeed be so.<fig id="Fig4"><label>Fig. 4</label><caption><p>A plot of third and fourth PCs for Dataset 3 (Johnson et al., 2007). The three colours represent the three processing batches. The shapes represent four distinct experimental conditions. The clustering of batches indicates the likely presence of batch effects in the third and fourth PCs of the data</p></caption><graphic xlink:href="12859_2016_1212_Fig4_HTML" id="MO4"/></fig></p>
    <p>Variance in the first two principal components is mainly due to within-treatment variability rather than batch effects (Fig. <xref rid="Fig3" ref-type="fig">3</xref>) as mentioned, and yet ComBat removes nearly half of the overall data variance. It may therefore be interesting to see how the first two PCs of the ComBat corrected data look. For a fair comparison, we do the same for Harman at the lowest confidence setting, which maximises the amount of data variance removed. As Fig. <xref rid="Fig5" ref-type="fig">5a</xref> shows Harman brings the batches closer to one another by reducing batch means towards zero, but without changing the distribution of samples within them. ComBat, on the other hand, rearranges samples within batch (Fig. <xref rid="Fig5" ref-type="fig">5b</xref>), and in particular brings the outlying member of the “*” treatment group within about two thirds of the original distance from the remaining three samples in the batch. More broadly, Fig. <xref rid="Fig5" ref-type="fig">5</xref> displays the compressed nature of samples belonging to the same batch in ComBat corrected data (Fig. <xref rid="Fig5" ref-type="fig">5b</xref>) relative to Harman (Fig. <xref rid="Fig5" ref-type="fig">5a</xref>). ComBat, in effect, seems to alter and partially remove the biological variance in the data along with removing batch effects. An analysis of variance also confirms this. While both methods drive variance attributable to batch effects to virtually zero (uncorrected data .128; Harman .00018; ComBat .0053), ComBat also removes 23 % of the variance attributable to treatment (uncorrected data .140; Harman .140; ComBat .108), and about 32 % attributable to within treatment variation (uncorrected data .133; Harman .133; ComBat .090). The analyses of Datasets 1 and 2 also show loss of biological variance resulting from ComBat, but to a lesser extent than Dataset 3.<fig id="Fig5"><label>Fig. 5</label><caption><p><bold>a</bold> A plot of first and second PCs for Dataset 3 (Johnson et al., 2007) after correction by Harman (.10). The three colours represent the three processing batches. The shapes represent four distinct experimental conditions. <bold>b</bold> A plot of first and second PCs for Dataset 3 (Johnson et al., 2007) after correction by ComBat. The three colours represent the three processing batches. The shapes represent four distinct experimental conditions</p></caption><graphic xlink:href="12859_2016_1212_Fig5_HTML" id="MO5"/></fig></p>
    <p>Finally, considering all three datasets, Harman, for a given confidence limit, has a tight range of gPCA <italic>p</italic>-values. For example, for Harman (.95) <italic>p</italic>-values range between .52 and .7 across the three datasets. ComBat varies from .23 to 1.</p>
  </sec>
  <sec id="Sec7" sec-type="discussion">
    <title>Discussion</title>
    <p>We developed Harman, first and foremost, to tackle the double edged problem with batch effects – to optimise batch noise removal with the constraint that the risk of also removing genuine biological variance is quantified and kept to a sensible level determined by the user. We evaluated Harman, comparing its performance as a batch noise removal method to that of ComBat. We chose ComBat as the benchmark, as it is overall the best performing one amongst the existing techniques [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. We used three independent, publically available datasets for this purpose, two of them produced by our laboratory, and the third originally utilised by the developers of ComBat [<xref ref-type="bibr" rid="CR17">17</xref>].</p>
    <p>First of all, gPCA measure we used indicates that Harman and ComBat perform their primary function – they remove batch noise. For all three datasets gPCA <italic>p</italic>-value for batch effect existence increased markedly following batch removal by either method. The confidence limit for Harman does operate as a trade-off coefficient between noise rejection and data variance preservation as expected. As the confidence limit decreased (i.e. tolerance for overcorrection increased), gPCA <italic>p</italic>-value went up and preserved data variance went down.</p>
    <p>Second, the data provide compelling evidence that Harman on the whole may be the one with superior performance. At the outset, our expectation was that ComBat would fall somewhere on the curve formed by Harman at different trade-off settings, except that this point may not always be the optimal one for any given application. As it turned out, for Dataset 1 and Dataset 2 ComBat fell below the performance curve of Harman, meaning that there was always a trade-off setting for Harman which results in better noise rejection and better signal preservation at the same time. In the case of Dataset 1, this was true for all trade-off settings. To put it in perspective, Harman with an extremely cavalier confidence limit of .10 (meaning there is 90 % chance that biological signal is being removed along with batch noise) not only displayed better noise rejection, but preserved more data variance than ComBat (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>). At the conservative extreme, Harman (.99) which stops removing variance if there is just 1 % chance that it might also be removing genuine signal achieved better noise suppression (gPCA <italic>p</italic>-value = .42) than ComBat while preserving 15 percentage points more data variance. At the typical trade-off setting of .95, the value used in the actual studies [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>], Harman returned 63 % data variance with a gPCA <italic>p</italic>-value of .63 against ComBat’s 52 % and with a lower gPCA <italic>p</italic>-value of .23 for Dataset 1. For Dataset 2, Harman (.95) returned 93 % data variance to ComBat’s 79 %, and had a higher gPCA <italic>p</italic>-value (.72 vs .58).</p>
    <p>Its peculiarities notwithstanding, Dataset 3 also provides evidence that Harman’s performance may be superior. The gPCA <italic>p</italic>-value for the raw data was .225, significantly larger than those of Dataset 1 and Dataset 2. Interpreting this result as there not being a batch effect in Dataset 3 is the worst possible scenario for both methods. It means that whatever the methods removed from the dataset was biological signal, not batch noise. Combat preserved less data variance than Harman for all confidence limit settings. Harman (.75) matched ComBat’s gPCA <italic>p</italic>-value of 1 yet preserved 20 percentage points more data variance. The difference between Harman (.95) and Combat was a sizable 31 percentage points.</p>
    <p>Fortunately for the two batch correction methods, and in particular Harman, further exploration revealed that there may have been a batch noise component in Dataset 3. Harman had identified that the noise component in Dataset 3 was predominantly in the third and fourth principal components. A plot of the two principal components (Fig. <xref rid="Fig4" ref-type="fig">4</xref>) showed clearly that samples cluster according to which batch they belong, providing at least subjective evidence that there was a batch noise component. It is unusual for third and fourth principal components to account for more batch noise than the first and second. As a general rule, and as a consequence of batch effects being typically the greatest source of variation in genomic datasets, the earlier the principal component the greater the proportion of batch noise explained. Datasets 1 and 2 constitute typical examples of batch effects, in that first and second principal components account for the bulk of that data’s batch noise component.</p>
    <p>This raises another pertinent point. It has been argued that PCA based batch correction approaches do not work well if batch effects are not the greatest source of variation [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]. As exemplified by Dataset 3, Harman investigates all principal components for batch effects, and is able to identify and remove them no matter what their relative size compared to other sources of variation.</p>
    <p>A further exploration of Dataset 3 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>) revealed that ComBat removed biological variance from the data in the process of removing batch effects. A visual comparison of Fig. <xref rid="Fig5" ref-type="fig">5a and b</xref> reveals the within-batch compression ComBat causes. An analysis of variance confirmed that Harman, in distinction to Combat, removed only the variance attributable to batch effects without altering the biological (i.e between treatment and within-treatment) variance. Removing treatment variance leads to an expected increase in false negatives in comparison tests, and removing within-treatment variance leads to an expected increase in false positives. We should also note that analysis of variance attributes all that is attributable to batch effects. This still makes analysis of variance a revealing metric to compare the two methods, when they are set to remove the entirety of the batch effect as identified by it. In the general case, however, it does not replace a metric like gPCA, which is also sensitive to the underlying likelihood of any variance attributed to batch effects.</p>
    <p>The final point we will discuss is Harman’s consistency in achieving comparable noise suppression - signal preservation trade-offs across different datasets, which is of particular advantage when conducting meta-analyses and genomic data integration from several distinct datasets [<xref ref-type="bibr" rid="CR10">10</xref>]. It would be possible to falsely infer differences between two equivalent datasets, just by being bullish in the removal of batch effects in one, and overly cautious in the other. The three datasets varied in the relative magnitude (Dataset 1 vs Dataset 2) and also nature (Dataset 3 vs Datasets 1 and 2) of their batch noise components. They also varied in the number and size of their processing batches. Yet, after correction by Harman (.95), the resulting datasets had a tight range of gPCA <italic>p</italic>-values, from 0.52 to 0.7. This is not accidental. What Harman removes as batch noise is driven directly by a trade-off coefficient constraining it to approach, but not exceed, a set risk of overcorrection. Furthermore this risk calculation is internally normalised for different batch numbers and sizes (see methods section). ComBat on the other hand, resulted in a relatively wide range of gPCA <italic>p</italic>-values, from 0.23 to 1. This difference in consistency between the two methods is similarly reflected in resultant preserved data variance post correction as a function of the level of batch noise in the raw data. Dataset 1 had a much more prevalent batch noise component than Dataset 3. Accordingly Harman (.95) removed 37 % variance from Dataset 1 and 17 % from Dataset 3, settling for comparable gPCA <italic>p</italic>-value scores (.63 and .52, respectively). Combat, on the other hand removed 48 % from Dataset 1, and yet 49 % from Dataset 3, producing quite different gPCA <italic>p</italic>-value scores (.23 and 1, respectively) in the process.</p>
  </sec>
  <sec id="Sec8" sec-type="conclusion">
    <title>Conclusion</title>
    <p>Considering the issue of batch noise in its totality – the potential impact of its presence (or undercorrection) as well as overcorrection, and the importance of being able to control the trade-off between batch noise rejection and signal preservation especially in relation to studies that span multiple datasets – it is reasonable to state that Harman’s performance as explored in this study makes it the more effective approach to deal with batch effects in high-throughput genomic datasets. Harman is flexible in terms of the data types it can process (e.g. microarray, RNA-seq, methylation). Given its mathematical underpinnings its potential use extends beyond genomic datasets. Of practical significance, it is also able to work with datasets where batch compositions – i.e. the number of experimental conditions, and replicates they contain – are not necessarily the same. It is freely available online as an R package, as well as a compiled Matlab package which does not require a Matlab license to run.</p>
  </sec>
  <sec id="Sec9" sec-type="materials|methods">
    <title>Methods</title>
    <sec id="Sec10">
      <title>The datasets</title>
      <p>In the olfactory stem cell study (Dataset 1), there were six treatment groups plus the control group, each consisting of four replicates, giving a total number of 28 arrays [<xref ref-type="bibr" rid="CR11">11</xref>]. The experiment was performed with four processing batches of seven arrays each, consisting of one replicate from each of the groups. The dataset comprising the genome wide gene expression scores from the 24 Affymetrix Human Gene 1.0 ST arrays, were normalised and background adjusted as a whole using the RMA procedure [<xref ref-type="bibr" rid="CR8">8</xref>] in MATLAB. Batch correction methods, ComBat and Harman were performed on the RMA adjusted dataset.</p>
      <p>The mouse study (Dataset 2) had four groups (three treatment, one control) with six replicates in each group, making a total of 24 arrays [<xref ref-type="bibr" rid="CR12">12</xref>]. There were a total of three processing batches of eight arrays, each consisting of two replicates per group. Affymetrix Mouse Gene 1.0 ST arrays were used in this study. The third dataset is the one used by Johnson et al. ([<xref ref-type="bibr" rid="CR17">17</xref>], p.119). This was another cell study with one treatment, one control, and 2 time points, resulting in 4 distinct (2 treatment x 2 time points) experimental conditions. There were three batches and a total of 12 samples, with each batch consisting of one replicate from each of the experimental conditions. RMA was implemented in the same way as Dataset 1 described above, and batch corrections were applied to RMA adjusted data.</p>
    </sec>
    <sec id="Sec11">
      <title>PCA is an effective means of complexity reduction and data visualisation</title>
      <p>Principal component analysis (PCA) is one of the most widely used techniques of multivariate analysis [<xref ref-type="bibr" rid="CR24">24</xref>]. It is an intuitive way of reducing complexity without any (involuntary) loss of information. A typical gene-expression dataset will have n samples of p (highly inter-related) probesets, where n is typically in the lower range of 10–100, and p is 20,000–40,000. PCA transforms the data into a new set of variables, where n samples are expressed in (n-1) dimensions, and sometimes fewer depending on how extensively inter-related the probesets may be. The new dimensions are the principal components (PCs), which are orthogonal (uncorrelated) to one another, and are ordered according to how much of the data variance they explain. First PC accounts for the largest portion of variance, the second PC accounts for the second most, and the last PC accounts for the least (non-zero) portion of variance. Collectively, principal components account for all of the variance in the data, and as such there is no loss of information. It is also useful to note that principal components are weighted linear sums of the original variables (e.g. probesets) in which the data is expressed.</p>
      <p>PCA is routinely used as a visualisation tool for high-throughput genomics data. It is not viable to visualise a particular sample in a 20,000-dimensional probeset space. A two-dimensional plot of first and second PCs, on the other hand provides meaningful, intelligible information while still representing a significant portion of the variance in the data. Indeed, a table of paired plots of many (if not all) PC’s can be produced, which spans virtually all the variance in the data (e.g. [<xref ref-type="bibr" rid="CR21">21</xref>], p.109, Fig. <xref rid="Fig5" ref-type="fig">5</xref>; “PCplot” function in [<xref ref-type="bibr" rid="CR25">25</xref>]).</p>
    </sec>
    <sec id="Sec12">
      <title>In PC plots batch effects appear as marked differences in batch means</title>
      <p>Plots of (the major) principal components are also a very popular means of displaying batch effects. Batch effects, as captured in a given principal component appear as a shift or offset in the geometric centre of the sample scores which belong to the same batch (see Figs. <xref rid="Fig1" ref-type="fig">1b</xref>, <xref rid="Fig2" ref-type="fig">2b</xref> and <xref rid="Fig4" ref-type="fig">4</xref>; see also [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]). This is not incidental. We can assume, for batch effects, the general model of additive as well as multiplicative noise at the measurement (e.g. probe) level [<xref ref-type="bibr" rid="CR10">10</xref>]. Such measurements are typically log transformed meaning that the resulting noise component is additive only. Moreover, even in the absence of log transformation, as principal components are weighted linear sums of the measurement variables, resulting effect of batch noise will be additive at the level of principal component scores. Because batch effects are by definition common to all samples in a processing batch, they share this additive noise in their PC scores, resulting in an offset in the mean of the batch. Furthermore, what puts these noise related offsets in batch means in sharp contrast is that for a given principal component the sample scores have a mean of zero. Therefore, if not for the batch effects, samples from different (but similarly constituted) processing batches would be statistically equivalent and hence the expected value of batch means would also be zero. In principle, therefore, the more distinct the dispersion of batches, the larger the batch noise component in the dataset.</p>
    </sec>
    <sec id="Sec13">
      <title>From subjective visualisation to quantification of batch noise</title>
      <p>Capture of batch effects as shifts in batch means in a PC coordinate system forms the basis of an objective assessment of batch effect where batch noise is quantified and then potentially removed. If a correction procedure can be established in the PC coordinate system, all that remains is straight forward matrix algebra to transform the (corrected) samples back into the standard data format, as depicted in Fig. <xref rid="Fig6" ref-type="fig">6</xref> (see also [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]).<fig id="Fig6"><label>Fig. 6</label><caption><p>Diagram demonstrates how a potential batch correction procedure may be implemented at each PC. The corrected data can then be transformed from principal components back to the original measurement variables as dimensions. As the dimensionality of the corrected data is identical to the uncorrected original, all downstream analysis of can proceed without requiring any algorithmic adjustments</p></caption><graphic xlink:href="12859_2016_1212_Fig6_HTML" id="MO6"/></fig></p>
      <p>The distinct batch noise variance to be found in each of the PCs can be removed independently, which results in the modification of the corresponding column vector of the PC scores matrix. Once all the PCs are corrected, the modified PC scores matrix is transformed back into the original set of variables, i.e. probesets for our Datasets (1-3). The corrected data would consist of the N samples expressed in p probesets as in the original dataset, except that the batch noise component in probeset values is removed. Eq.1 describes this process, assuming that a <italic>correction</italic> procedure exists.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{c}\left[ Coef{f}_{p\times \left(N-1\right)}, Score{s}_{N\times \left(N-1\right)}\right]=pca\left(dat{a}_{N\times p}\right)\\ {} Correctedscores\left(:,k\right)= Correction\left( Scores\left(:,k\right)\right)\kern1.5em for\kern1em k=1,\dots, N-1\\ {} Correcteddat{a}_{N\times p}=pc{a}^{-1}\left( Correctedscore{s}_{N\times \left(N-1\right)}\right)= Correctedscore{s}_{N\times \left(N-1\right)}* Coef{f}_{\left(N-1\right)\times p}^{\prime}\end{array} $$\end{document}</tex-math><mml:math id="M2"><mml:mtable><mml:mtr><mml:mtd><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="italic">Coef</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="italic">Score</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="italic">Correctedscores</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mo>:</mml:mo><mml:mi>k</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="italic">Correction</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">Scores</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mo>:</mml:mo><mml:mi>k</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mspace width="1.5em"/><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="1em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="italic">Correcteddat</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="italic">Correctedscore</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="italic">Correctedscore</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:mi mathvariant="italic">Coef</mml:mi><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2016_1212_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>It should be mentioned that the probeset means are subtracted from the data prior to <italic>pca</italic>, and then added to the <italic>Correcteddata</italic> after <italic>pca</italic><sup><italic>−1</italic></sup>. As denoted above, <italic>pca</italic><sup><italic>−1</italic></sup> amounts to a matrix multiplication (by the transpose of the <italic>coeff</italic> matrix computed by PCA<italic>)</italic> and the resultant <italic>Correcteddata</italic> is unique.</p>
      <p>The key issue to consider in terms of establishing a correction procedure is the converse of what is described in the previous sub-section. If batch noise to be found in a given principal component is necessarily and exhaustively reflected as shifts in the mean scores of individual batches, can such shifts observed in PC scores be wholly and directly be attributed to batch effects? If there were no batch effects, the expected mean of each batch would be zero because the overall mean of PC scores is zero. And if there were hundreds of samples in a batch, we would expect the actual mean of the batch to be very close to the expected mean. In which case, a satisfactory batch effect correction procedure may amount to no more than removing the batch mean from the scores that constitute that batch. Typically, though, the number of samples in a batch is relatively small. The batch sizes of the datasets we analysed in this study, for example, varied between 4 and 8. We would thus expect that the actual batch means would vary considerably around the expected mean of zero. As such, we would not be able to say without further investigation, whether a particular non-zero batch-mean is a reflection of the existence of batch effects, or whether it is a reasonable variation between the “population mean” (of zero) and that of a small subset from that population. Essentially, the way Harman identifies whether or not batch effects exist in a given principal component of the dataset is by calculating the overall likelihood of the observed deviation of batch means from zero, as a function of the size of batches and the total number of samples.</p>
      <p>It may be helpful to look in detail at how this batch noise quantification works, using Dataset 1 to illustrate the process. There are four batches in this dataset, each possessing one of the four replicates from seven treatments (see Fig. <xref rid="Fig1" ref-type="fig">1b</xref>). What would it mean to assume that there are no batch effects in this data? It would necessarily follow that there is statistically speaking no difference between, say, the square in the cyan batch and the squares in the red, green and blue batches – we have assumed after all that there is no batch specific component to the PC score denoted by the cyan square, or any of the other squares. The difference between four squares would then reflect the variability of the treatment of which they are replicate PC scores. It would also mean that the cyan square in the cyan batch happens to be there by chance. Any of the four squares (i.e. 4 PC scores belonging to that treatment) could have belonged to the cyan batch. This would be true for all of the treatments and their replicates.</p>
      <p>If this is so, then the four batches can be seen as having eventuated from a much larger population of potential batches. Since there are seven treatments in a batch, and each treatment has four replicates, then there are 4<sup>7</sup> possible combinations of PC scores each constituting a potential batch. For the general case, number of possible combinations is:</p>
      <p><inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \prod_{\alpha =1}^{\tau}\left(\begin{array}{c}\hfill {n}_{\alpha}\hfill \\ {}\hfill {k}_{\alpha}\hfill \end{array}\right)} $$\end{document}</tex-math><mml:math id="M4"><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">∏</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>τ</mml:mi></mml:munderover><mml:mrow><mml:mfenced close=")" open="("><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:msub><mml:mi>n</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:msub><mml:mi>k</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mstyle></mml:math><inline-graphic xlink:href="12859_2016_1212_Article_IEq1.gif"/></alternatives></inline-formula>, where</p>
      <p><italic>τ</italic> = number of distinct treatments in a batch,</p>
      <p>n<sub>α</sub> = total number of replicates of treatment α in the study,</p>
      <p>k<sub>α</sub> = number of replicates of treatment α in batch.</p>
      <p>By computing the mean of the potential batches, we can establish the population distribution of batch-means representing the no-batch-effect assumption. We can use this distribution to calculate the empirical likelihood of ending up with the four actual batch-means under the assumption that there are no batch effects.</p>
      <p>The batch-mean population is normally distributed, irrespective of the distribution of measurement variables (e.g. probesets) in the raw dataset. This is because of Central Limit Theorem [<xref ref-type="bibr" rid="CR27">27</xref>], which applies not once but twice. Central Limit Theorem states that populations created from sums or averages of large numbers are normally distributed (asymptotically speaking) irrespective of the underlying distribution of those numbers. PC scores are weighted linear sums of the original measurement variables (i.e. probes), which number in the thousands in typical high throughput datasets, and in the ones we use in this study. Batch-means in turn are weighted linear sums of PC scores. We would also expect the mean of this distribution to be zero, on account of the PC scores adding up to zero. The critical measure derived from the establishment of the population distribution of batch-means is its variance (or standard distribution). Once the batch-mean population is established, it is trivial to compute its variance.</p>
      <p>After establishing the population distribution of batch-means – most crucially, its variance – representing the condition that there are no batch effects, we proceed to calculating the probability (z<sub><italic>b</italic></sub>) of selecting a batch <italic>b</italic> with a particular batch-mean (BM<sub><italic>b</italic></sub>). Each batch mean probability is calculated based on the cumulative distribution function (CDF) of the population distribution [<xref ref-type="bibr" rid="CR28">28</xref>].<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{c}F(x)=CDF\left( normal,0,std,x\right)\\ {}{z}_b= probability\left(B{M}_b\right)=F\left(-\left|B{M}_b\right|\right)\end{array} $$\end{document}</tex-math><mml:math id="M6"><mml:mtable><mml:mtr><mml:mtd><mml:mi>F</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mi>D</mml:mi><mml:mi>F</mml:mi><mml:mfenced close=")" open="(" separators=",,,"><mml:mi mathvariant="italic">normal</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>z</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="italic">probability</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo>−</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2016_1212_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>We negate the absolute value of BM<sub><italic>b</italic></sub> in the formula, as the probability of deviating from the expected batch mean is a function only of the magnitude of the deviation, not its direction. The overall probability (<italic>L</italic>) of the four actual batch-means eventuating, will be a function of the probability of the individual batch-means, with the constraint that they must add up to zero. If there were no constraining equation, L would be the product of the individual batch-mean probabilities. Note that with this constraint, once the three batch-means are chosen, the fourth one is fixed. There are four distinct ways of choosing a set of three batch means in this way. Hence the structure of L becomes:<disp-formula id="Equa"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ L=f\left({z}_1,{z}_2,{z}_3,{z}_4\right)\kern1em with\kern1.5em {\displaystyle \sum_{b=1}^4B{M}_b}=0\kern0ex L=c\left({z}_1{z}_2{z}_3+{z}_1{z}_2{z}_4+{z}_1{z}_3{z}_4+{z}_2{z}_3{z}_4\right) $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="1em"/><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mspace width="1.5em"/><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:munderover><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mstyle></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace linebreak="newline"/><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2016_1212_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>c</italic> is the normalising constant.</p>
      <p>The normalising constant in the equation above plays an important role. First and foremost, we would want <italic>L</italic> to be comparable across different datasets which may have different number of batches. As it stands, <italic>L</italic> is a function of the number of batches in the dataset. Secondly, we would want <italic>L</italic> to range from 0 to 1. The maximum value <italic>L</italic> can have (<italic>L</italic><sub><italic>max</italic></sub><italic>)</italic> in the example above, is when all batch means are equal to the expected mean of zero. In which case, z<sub>i</sub> = 0.5 for all values of i, with <italic>L</italic><sub><italic>max</italic></sub> = <italic>c</italic>(4/8). With <italic>c</italic> thus set to (8/4) to make <italic>L</italic><sub><italic>max</italic></sub> equal to 1,<disp-formula id="Equb"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ L=\frac{8}{4}\left({z}_1{z}_2{z}_3+{z}_1{z}_2{z}_4+{z}_1{z}_3{z}_4+{z}_2{z}_3{z}_4\right) $$\end{document}</tex-math><mml:math id="M10"><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>8</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2016_1212_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The general equation for n batches is:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{l}L=\frac{2^{n-1}}{n}{\displaystyle \sum_{i=1}^n\left({\displaystyle \prod_{j=1}^n{z}_{ij}}\right)\kern2em \mathrm{where}}\kern1em {z}_{ij}={z}_j\kern1.5em  if\kern1em i\ne j\\ {}\kern15em {z}_{ij}=1\kern2em  if\kern1.5em i=j\end{array} $$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mtable columnalign="left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>n</mml:mi></mml:mfrac><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="2em"/><mml:mrow><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mstyle></mml:mrow><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mspace width="1.5em"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/><mml:mspace width="15em"/><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="2em"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="1.5em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2016_1212_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>With <italic>L</italic>, we now have the likelihood of batch-mean dispersion we observe in the PC scores (normalised with respect to no dispersion, i.e. zero batch-means) if there were no batch effects. If <italic>L</italic> is small, we can say with (1-<italic>L</italic>) confidence that there is batch noise in the data.</p>
    </sec>
    <sec id="Sec14">
      <title>Removal of batch noise</title>
      <p>Say the confidence percentage is high – i.e. higher than the smallest value (i.e. confidence limit) at which the user is prepared to say that there are batch effects in the data. This would mean that a portion of the batch-mean dispersion is due to there being batch noise. For a given PC, the scores for the samples can be expressed as:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {s}_{ji}=B{M}_j+{r}_{ji}\kern0.5em ,\kern0.5em i=1:n\kern0.5em \mathrm{and}\ \mathrm{j}=1:\mathrm{b}, $$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.5em"/><mml:mo>,</mml:mo><mml:mspace width="0.5em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>n</mml:mi><mml:mspace width="0.5em"/><mml:mi mathvariant="normal">and</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi mathvariant="normal">b</mml:mi><mml:mtext>,</mml:mtext></mml:math><graphic xlink:href="12859_2016_1212_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>s</italic><sub><italic>ij</italic></sub> is the score corresponding to i<sup>th</sup> sample in batch j with batch-mean <italic>BM</italic><sub><italic>j</italic></sub>, n is the number of samples per batch, and b is the number of batches. <italic>r</italic><sub><italic>ji</italic></sub> thus becomes the distance between the sample score <italic>s</italic><sub><italic>ji</italic></sub> and centre of the batch to which it belongs.</p>
      <p>Removing batch noise would then amount to ‘compressing’ or ‘shrinking’ the observed batch mean dispersion as much as possible, with the constraint that the confidence value is not less than the limit set by the user. In other words, the corrected version of s<sub>ji</sub> can be defined as:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {s}_{ji}(corrected)=k.B{M}_j+{r}_{ji},\kern0.5em 0\le \mathrm{k}&lt;1,\ \mathrm{such}\ \mathrm{that}\ \mathrm{L}\left({z}_j(corrected)\right)=1- confidencelimit $$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="italic">corrected</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>.</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.5em"/><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi mathvariant="normal">k</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">such</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">that</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">L</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="italic">corrected</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi mathvariant="italic">confidencelimit</mml:mi></mml:math><graphic xlink:href="12859_2016_1212_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>In practice, a sufficiently close approximation <inline-formula id="IEq2"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left(\widehat{k}\right) $$\end{document}</tex-math><mml:math id="M18"><mml:mfenced close=")" open="("><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2016_1212_Article_IEq2.gif"/></alternatives></inline-formula> to k can be computed iteratively, starting from 1 and approaching zero in discrete steps (e.g. of .01), recomputing <italic>L</italic> at each step and then choosing the smallest <inline-formula id="IEq3"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \widehat{k} $$\end{document}</tex-math><mml:math id="M20"><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2016_1212_Article_IEq3.gif"/></alternatives></inline-formula>, such that the confidence percentage is not less than the confidence limit. Harman uses an optimised version of this process to ensure that the number of iterations is minimised for computational efficiency. For example, suppose the resulting <italic>L</italic> for a given principal component of the data was only .01, meaning that the observed dispersion of batch means only had 1 % chance of emerging in the absence of any batch noise in the data. The user may have decided that a suitable noise rejection – signal preservation trade-off would result from a confidence limit of .95. The corrected scores would be calculated in accordance with the equation above, by compressing batch means with a suitable <inline-formula id="IEq4"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \widehat{k} $$\end{document}</tex-math><mml:math id="M22"><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2016_1212_Article_IEq4.gif"/></alternatives></inline-formula>, such that <italic>L</italic> = .05. This process is repeated independently for all of the PCs.</p>
      <p>Figure <xref rid="Fig7" ref-type="fig">7</xref> demonstrates the confidence percentage as a function of k for the first three PCs. The points marked on the three curves correspond to Harman (.95), showing the k values which result from setting the confidence limit to 95 %.<fig id="Fig7"><label>Fig. 7</label><caption><p>The plot above demonstrates how the confidence (%) for there being no batch effects reduces as the batch means are compressed proportionately towards zero. The three curves correspond to the first three principal components of Dataset 1. For each point on a given curve, batch means are multiplied by the corresponding value of <italic>k</italic> for the purposes of computing the confidence value. The diamond markers on the curves denote the k values (i.e. the resulting batch mean compression) for a chosen confidence limit of 95 %</p></caption><graphic xlink:href="12859_2016_1212_Fig7_HTML" id="MO7"/></fig></p>
      <p>Figure <xref rid="Fig8" ref-type="fig">8</xref> shows the sample scores for the first and second PCs after correction by Harman (.95). The correction vector, i.e. values of k corresponding to all PCs are included in Table <xref rid="Tab2" ref-type="table">2</xref>.<fig id="Fig8"><label>Fig. 8</label><caption><p>First and second PCs for Dataset 1 (Osmond-McLeod, Osmond et al., 2013) after correction by Harman with a confidence limit of .95. The four colours represent the four processing batches. The shapes represent seven distinct treatments. The clustering of batches before correction (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>) indicate the presence of batch effects in the first and second PCs of the data. After correction, the batch means are reduced to .26 (PC1) and .33 (PC2) of their original values</p></caption><graphic xlink:href="12859_2016_1212_Fig8_HTML" id="MO8"/></fig></p>
      <p>Once all the PCs are corrected, the batch noise free data is expressed in the original variables, as described by Eq.1.</p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec15">
        <title>Additional file</title>
        <p>
          <media position="anchor" xlink:href="12859_2016_1212_MOESM1_ESM.docx" id="MOESM1">
            <label>Additional file 1:</label>
            <caption>
              <p>Contains additional information and discussion on gPCA (Reese et al., 2013). <bold>Table S1.</bold> Demonstrates the inverse proportionality between gPCA <italic>p</italic>-value and the associated ‘delta’ score, reflecting unadjusted relative magnitude of batch effects (Reese et al., 2013). The table shows the scores for all three datasets. <bold>Figure S1.</bold> Contains an Illustration to further help interpret gPCA <italic>p</italic>-value vs preserved data variance plots. (DOCX 60 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>PC</term>
        <def>
          <p>Principal component</p>
        </def>
      </def-item>
      <def-item>
        <term>PCA</term>
        <def>
          <p>Principal component analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>gPCA</term>
        <def>
          <p>Guided-PCA</p>
        </def>
      </def-item>
      <def-item>
        <term>RNA-seq</term>
        <def>
          <p>RNA sequencing</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>Tim Peters and Rob Dunne reviewed earlier versions of the manuscript and made numerous useful suggestions. Bill Wilson and Mike Buckley provided guidance through method development. Sam Moskwa (CSIRO IM&amp;T eResearch Support Grants) provided programming support. Maxine McCall and David Lovell also reviewed the manuscript and provided organisational support through their research programs.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p>CSIRO Transformational Biology Capability Platform and CSIRO Nanosafety Theme provided funding support for this work. They played no direct role in the development of the method presented in this manuscript, or in writing the manuscript.</p>
    </sec>
    <sec id="FPar2">
      <title>Availability of data and material</title>
      <p><ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/bioc/html/Harman.html">https://bioconductor.org/packages/release/bioc/html/Harman.html</ext-link> (R version)</p>
      <p><ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.csiro.au/harman/">http://www.bioinformatics.csiro.au/harman/</ext-link> (Matlab executable version)</p>
      <p><ext-link ext-link-type="uri" xlink:href="https://research.csiro.au/research/harman/">https://research.csiro.au/research/harman/</ext-link> (Matlab executable version)</p>
    </sec>
    <sec id="FPar3">
      <title>Authors’ contributions</title>
      <p>YO conceived Harman, wrote the first Matlab code, and the manuscript. FS further developed the Matlab code and generated the comparison data contained in the manuscript using gPCA. KD contributed to the development of Harman. JB translated the Matlab code into C++ and also co-wrote the R package. MO conducted the experiments associated with datasets 1 and 2. JR co-wrote the R version of Harman as well as contributing to its development. All authors read, edited and approved the final manuscript.</p>
    </sec>
    <sec id="FPar4">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar5">
      <title>Consent for publication</title>
      <p>The manuscript went through an internal review process at CSIRO and received approval to be submitted for publication.</p>
    </sec>
    <sec id="FPar6">
      <title>Ethics approval and consent to participate</title>
      <p>This work concerns existing datasets from published studies.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Scherer</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>Batch effects and noise in microarray experiments: Sources and solutions</source>
        <year>2009</year>
        <publisher-loc>Chichester</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Scharpf</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Bravo</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Simcha</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Geman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Baggerly</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>R a</given-names>
          </name>
        </person-group>
        <article-title>Tackling the widespread and critical impact of batch effects in high-throughput data</article-title>
        <source>Nat Rev Genet</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>10</issue>
        <fpage>733</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2825</pub-id>
        <?supplied-pmid 20838408?>
        <pub-id pub-id-type="pmid">20838408</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harper</surname>
            <given-names>KN</given-names>
          </name>
          <name>
            <surname>Peters</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Gamble</surname>
            <given-names>MV</given-names>
          </name>
        </person-group>
        <article-title>Batch effects and pathway analysis: Two potential perils in cancer studies involving DNA methylation array analysis</article-title>
        <source>Cancer Epidemiol Biomarkers Prev</source>
        <year>2013</year>
        <volume>22</volume>
        <fpage>1052</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1158/1055-9965.EPI-13-0114</pub-id>
        <?supplied-pmid 23629520?>
        <pub-id pub-id-type="pmid">23629520</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McLendon</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bigner</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Van Meir</surname>
            <given-names>EG</given-names>
          </name>
          <name>
            <surname>Brat</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Mastrogianakis</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Mikkelsen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lehman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Aldape</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Alfred Yung</surname>
            <given-names>WK</given-names>
          </name>
          <name>
            <surname>Bogler</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>VandenBerg</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Prados</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Muzny</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scherer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sabo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nazareth</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Alvi</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Yao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hawes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jhangiani</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fowler</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>San Lucas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kovar</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cree</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dinh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Santibanez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Joshi</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Gonzalez-Garay</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Milosavljevic</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Donehower</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Gibbs</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Cibulskis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sougnez</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mahan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wilkinson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ziaugra</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Onofrio</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bloom</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nicol</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ardlie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Baldwin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gabriel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fulton</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>McLellan</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Wallis</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Abbott</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fulton</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Koboldt</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Wendl</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Osborne</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Dunford-Shore</surname>
            <given-names>BH</given-names>
          </name>
          <name>
            <surname>Miner</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Delehaunty</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Markovic</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Swift</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Courtney</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Pohl</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Abbott</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hawkins</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Leong</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Haipek</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wiechert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vickery</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dooling</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Chinwalla</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Weinstock</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Mardis</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Winckler</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Verhaak</surname>
            <given-names>RGW</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>O’Kelly</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Alexe</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Beroukhim</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Carter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chiang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gould</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Korn</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mermel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Monti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Parkin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stransky</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Weir</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Garraway</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meyerson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Protopopov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Perna</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Aronson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sathiamoorthy</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Yao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wiedemeyer</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Won Kong</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kohane</surname>
            <given-names>IS</given-names>
          </name>
          <name>
            <surname>Seidman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Kucherlapati</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>PW</given-names>
          </name>
          <name>
            <surname>Cope</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Herman</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Weisenberger</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Van Den Berg</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Van Neste</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mi Yi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schuebel</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Baylin</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Absher</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>JZ</given-names>
          </name>
          <name>
            <surname>Southwick</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Brady</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Aggarwal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sherlock</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Brooks</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Spellman</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Purdom</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Jakkula</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Lapuk</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Marr</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Dorton</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gi Choi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ray</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Durinck</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Vranizan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Van Name</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Fontenay</surname>
            <given-names>GV</given-names>
          </name>
          <name>
            <surname>Ngai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Conboy</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Parvin</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Feiler</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Gray</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Brennan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Socci</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Olshen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Lash</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schultz</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Reva</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Antipin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Stukalov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gross</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Cerami</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Qing Wang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>L-X</given-names>
          </name>
          <name>
            <surname>Seshan</surname>
            <given-names>VE</given-names>
          </name>
          <name>
            <surname>Villafania</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cavatore</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Borsu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Viale</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gerald</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ladanyi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Perou</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Neil Hayes</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Topal</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Hoadley</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Qi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Balu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Penny</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bittner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shelton</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lenkiewicz</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Beasley</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sanders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kahn</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sfeir</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nassau</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hickey</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Weinstein</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Barker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gerhard</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Vockley</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Compton</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Vaught</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fielding</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ferguson</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Schaefer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Madhavan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Buetow</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Good</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Guyer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ozenberger</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Peterson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive genomic characterization defines human glioblastoma genes and core pathways</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>455</volume>
        <fpage>1061</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/nature07385</pub-id>
        <pub-id pub-id-type="pmid">18772890</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gibbs</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Belmont</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Hardenbol</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Willis</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ch’ang</surname>
            <given-names>L-Y</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tam</surname>
            <given-names>PK-H</given-names>
          </name>
          <name>
            <surname>Tsui</surname>
            <given-names>L-C</given-names>
          </name>
          <name>
            <surname>Waye</surname>
            <given-names>MMY</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>JT-F</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Chee</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Galver</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Kruglyak</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Oliphant</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Montpetit</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hudson</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Chagnon</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ferretti</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Leboeuf</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Phillips</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Verner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kwok</surname>
            <given-names>P-Y</given-names>
          </name>
          <name>
            <surname>Duan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lind</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Rice</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Saccone</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Taillon-Miller</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nakamura</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sekine</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sorimachi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tsunoda</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yoshino</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bentley</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Deloukas</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Powell</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Altshuler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gabriel</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Matsuda</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Fukushima</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Macer</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Suda</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Rotimi</surname>
            <given-names>CN</given-names>
          </name>
          <name>
            <surname>Adebamowo</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Aniagwu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Matthew</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Nkwodimmah</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Royal</surname>
            <given-names>CDM</given-names>
          </name>
          <name>
            <surname>Leppert</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Dixon</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>Cunningham</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kanani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Thorisson</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Chakravarti</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>PE</given-names>
          </name>
          <name>
            <surname>Cutler</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Kashuk</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Donnelly</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Marchini</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McVean</surname>
            <given-names>GAT</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Cardon</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Weir</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Mullikin</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Sherry</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Feolo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Altshuler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Schaffner</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dunston</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Kato</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Niikawa</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Knoppers</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Foster</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Clayton</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>VO</given-names>
          </name>
          <name>
            <surname>Watkin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gibbs</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Belmont</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Sodergren</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Weinstock</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Fulton</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>Rogers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Birren</surname>
            <given-names>BW</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Godbout</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wallenburg</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>L’Archevêque</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bellemare</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Todani</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fujita</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Holden</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>EH</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>FS</given-names>
          </name>
          <name>
            <surname>Brooks</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>McEwen</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Guyer</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Peterson</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Spiegel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sung</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Zacharia</surname>
            <given-names>LF</given-names>
          </name>
          <name>
            <surname>Kennedy</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dunn</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Seabrook</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Shillito</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Skene</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Valle</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Clayton</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Jorde</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Belmont</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Chakravarti</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cho</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Duster</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Foster</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Jasperse</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Knoppers</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Kwok</surname>
            <given-names>P-Y</given-names>
          </name>
          <name>
            <surname>Licinio</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Ossorio</surname>
            <given-names>PN</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>VO</given-names>
          </name>
          <name>
            <surname>Rotimi</surname>
            <given-names>CN</given-names>
          </name>
          <name>
            <surname>Royal</surname>
            <given-names>CDM</given-names>
          </name>
          <name>
            <surname>Spallone</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Terry</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>EH</given-names>
          </name>
          <name>
            <surname>Nickerson</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Altshuler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bentley</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Boehnke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cardon</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Deloukas</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Douglas</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Gabriel</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Hudson</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Hudson</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Kruglyak</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kwok</surname>
            <given-names>P-Y</given-names>
          </name>
          <name>
            <surname>Nakamura</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Nussbaum</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Royal</surname>
            <given-names>CDM</given-names>
          </name>
          <name>
            <surname>Schaffner</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Sherry</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>The International HapMap Project</article-title>
        <source>Nature</source>
        <year>2003</year>
        <volume>426</volume>
        <fpage>789</fpage>
        <lpage>96</lpage>
        <pub-id pub-id-type="doi">10.1038/nature02168</pub-id>
        <pub-id pub-id-type="pmid">14685227</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dick</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Foroud</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Flury</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Bowman</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Rau</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Moe</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Samavedy</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>El-Mallakh</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Manji</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Glitz</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Smiley</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hahn</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Widmark</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>McKinney</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sutton</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ballas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Grice</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Berrettini</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Byerley</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Coryell</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>DePaulo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>MacKinnon</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Gershon</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Kelsoe</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>McMahon</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>McInnis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Scheftner</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Nurnberger</surname>
            <given-names>JI</given-names>
          </name>
        </person-group>
        <article-title>Genomewide linkage analyses of bipolar disorder: a new sample of 250 pedigrees from the National Institute of Mental Health Genetics Initiative</article-title>
        <source>Am J Hum Genet</source>
        <year>2003</year>
        <volume>73</volume>
        <fpage>107</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1086/376562</pub-id>
        <?supplied-pmid 12772088?>
        <pub-id pub-id-type="pmid">12772088</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gregori</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Villarreal</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Méndez</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Sánchez</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Baselga</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Villanueva</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Batch effects correction improves the sensitivity of significance tests in spectral counting-based comparative discovery proteomics</article-title>
        <source>J Proteomics</source>
        <year>2012</year>
        <volume>75</volume>
        <fpage>3938</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jprot.2012.05.005</pub-id>
        <?supplied-pmid 22588121?>
        <pub-id pub-id-type="pmid">22588121</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Hobbs</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Collin</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Beazer-Barclay</surname>
            <given-names>YD</given-names>
          </name>
          <name>
            <surname>Antonellis</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Scherf</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>Exploration, normalization, and summaries of high density oligonucleotide array probe level data</article-title>
        <source>Biostatistics</source>
        <year>2003</year>
        <volume>4</volume>
        <issue>2</issue>
        <fpage>249</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/4.2.249</pub-id>
        <?supplied-pmid 12925520?>
        <pub-id pub-id-type="pmid">12925520</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Grennan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Badner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gershon</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Removing batch effects in analysis of expression microarray data: An evaluation of six batch adjustment methods</article-title>
        <source>PLoS One</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>2</issue>
        <fpage>e17238</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0017238</pub-id>
        <?supplied-pmid 21386892?>
        <pub-id pub-id-type="pmid">21386892</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lazar</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Meganck</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Taminau</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Steenhoff</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Coletta</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Molter</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Weiss-Solís</surname>
            <given-names>DY</given-names>
          </name>
          <name>
            <surname>Duque</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bersini</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nowé</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Batch effect removal methods for microarray gene expression data integration: A survey</article-title>
        <source>Brief Bioinform</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>469</fpage>
        <lpage>90</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbs037</pub-id>
        <?supplied-pmid 22851511?>
        <pub-id pub-id-type="pmid">22851511</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Osmond-McLeod</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Osmond</surname>
            <given-names>RIW</given-names>
          </name>
          <name>
            <surname>Oytam</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>McCall</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Feltis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mackay-Sim</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wood</surname>
            <given-names>S a</given-names>
          </name>
          <name>
            <surname>Cook</surname>
            <given-names>AL</given-names>
          </name>
        </person-group>
        <article-title>Surface coatings of ZnO nanoparticles mitigate differentially a host of transcriptional, protein and signalling responses in primary human olfactory cells</article-title>
        <source>Part Fibre Toxicol</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>54</fpage>
        <pub-id pub-id-type="doi">10.1186/1743-8977-10-54</pub-id>
        <?supplied-pmid 24144420?>
        <pub-id pub-id-type="pmid">24144420</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Osmond-McLeod</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Oytam</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kirby</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Gomez-Fernandez</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Baxter</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>McCall</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Dermal absorption and short-term biological impact in hairless mice from sunscreens containing zinc oxide nano- or larger particles</article-title>
        <source>Nanotoxicology</source>
        <year>2013</year>
        <volume>5390</volume>
        <issue>2010</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Harrington</surname>
            <given-names>C a</given-names>
          </name>
          <name>
            <surname>Vartanian</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Coldren</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Churchill</surname>
            <given-names>G a</given-names>
          </name>
        </person-group>
        <article-title>Randomization in laboratory procedure is key to obtaining reproducible microarray results</article-title>
        <source>PLoS One</source>
        <year>2008</year>
        <volume>3</volume>
        <issue>11</issue>
        <fpage>e3724</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0003724</pub-id>
        <?supplied-pmid 19009020?>
        <pub-id pub-id-type="pmid">19009020</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J R Stat Soc</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alter</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>PO</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Singular value decomposition for genome-wide expression data processing and modeling</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2000</year>
        <volume>97</volume>
        <fpage>10101</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.97.18.10101</pub-id>
        <?supplied-pmid 10963673?>
        <pub-id pub-id-type="pmid">10963673</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nielsen</surname>
            <given-names>TO</given-names>
          </name>
          <name>
            <surname>West</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Linn</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Alter</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Knowling</surname>
            <given-names>M a</given-names>
          </name>
          <name>
            <surname>O’Connell</surname>
            <given-names>JX</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fero</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sherlock</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pollack</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>PO</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Van De Rijn</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Molecular characterisation of soft tissue tumours: A gene expression study</article-title>
        <source>Lancet</source>
        <year>2002</year>
        <volume>359</volume>
        <fpage>1301</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1016/S0140-6736(02)08270-3</pub-id>
        <pub-id pub-id-type="pmid">11965276</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rabinovic</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Adjusting batch effects in microarray expression data using empirical Bayes methods</article-title>
        <source>Biostatistics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>118</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxj037</pub-id>
        <?supplied-pmid 16632515?>
        <pub-id pub-id-type="pmid">16632515</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Capturing heterogeneity in gene expression studies by surrogate variable analysis</article-title>
        <source>PLoS Genet</source>
        <year>2007</year>
        <volume>3</volume>
        <issue>9</issue>
        <fpage>1724</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.0030161</pub-id>
        <?supplied-pmid 17907809?>
        <pub-id pub-id-type="pmid">17907809</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schumacher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scherer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sanoudou</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Megherbi</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Davison</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tong</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hong</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Elloumi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tillinghast</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Herman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bushel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Woods</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A comparison of batch effect removal methods for enhancement of prediction performance using MAQC-II microarray gene expression data</article-title>
        <source>Pharmacogenomics J</source>
        <year>2010</year>
        <volume>10</volume>
        <issue>4</issue>
        <fpage>278</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1038/tpj.2010.57</pub-id>
        <?supplied-pmid 20676067?>
        <pub-id pub-id-type="pmid">20676067</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sims</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Smethurst</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Hey</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Okoniewski</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Pepper</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Howell</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>RB</given-names>
          </name>
        </person-group>
        <article-title>The removal of multiplicative, systematic bias allows integration of breast cancer gene expression datasets - improving meta-analysis and prediction of prognosis</article-title>
        <source>BMC Med Genomics</source>
        <year>2008</year>
        <volume>1</volume>
        <fpage>42</fpage>
        <pub-id pub-id-type="doi">10.1186/1755-8794-1-42</pub-id>
        <?supplied-pmid 18803878?>
        <pub-id pub-id-type="pmid">18803878</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benito</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Xiang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Perou</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Marron</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Adjustment of systematic microarray data biases</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>105</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg385</pub-id>
        <?supplied-pmid 14693816?>
        <pub-id pub-id-type="pmid">14693816</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Voom: precision weights unlock linear model analysis tools for RNA-seq read counts</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>R29</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2014-15-2-r29</pub-id>
        <?supplied-pmid 24485249?>
        <pub-id pub-id-type="pmid">24485249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Reese SE, Archer KJ, Therneau TM, Atkinson EJ, Vachon CM, De Andrade M, J.-P. A. P. a Kocher, Eckel-Passow JE. A new statistic for identifying batch effects in high-throughput genomic data that uses guided principal component analysis. Bioinformatics. 2013;29(22):2877–83</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jolliffe</surname>
            <given-names>IT</given-names>
          </name>
        </person-group>
        <article-title>Principal Component Analysis, Second Edition</article-title>
        <source>Encycl Stat Behav Sci</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>487</fpage>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Reese</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <source>The gPCA Package for Identifying Batch Effects in High-Throughput Genomic Data</source>
        <year>2013</year>
        <fpage>1</fpage>
        <lpage>8</lpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alter</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>PO</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Generalized singular value decomposition for comparative analysis of genome-scale expression data sets of two different organisms</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2003</year>
        <volume>100</volume>
        <fpage>3351</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0530258100</pub-id>
        <?supplied-pmid 12631705?>
        <pub-id pub-id-type="pmid">12631705</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Billingsley</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <source>Probability &amp; Measure</source>
        <year>1995</year>
        <edition>3</edition>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Draghici</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <source>Data Analysis Tools for DNA Microarrays</source>
        <year>2003</year>
        <publisher-loc>Boca Raton</publisher-loc>
        <publisher-name>Chapman &amp; hall / CRC</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
