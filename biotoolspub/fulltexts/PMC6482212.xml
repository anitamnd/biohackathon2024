<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Mol Biosci</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Mol Biosci</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Mol. Biosci.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Molecular Biosciences</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2296-889X</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6482212</article-id>
    <article-id pub-id-type="doi">10.3389/fmolb.2019.00025</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Molecular Biosciences</subject>
        <subj-group>
          <subject>Original Research</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Anncolvar: Approximation of Complex Collective Variables by Artificial Neural Networks for Analysis and Biasing of Molecular Simulations</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Trapl</surname>
          <given-names>Dalibor</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/674839/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Horvacanin</surname>
          <given-names>Izabela</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/678189/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mareska</surname>
          <given-names>Vaclav</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/718440/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ozcelik</surname>
          <given-names>Furkan</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/718055/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Unal</surname>
          <given-names>Gozde</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/571305/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Spiwok</surname>
          <given-names>Vojtech</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="c001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/358602/overview"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Department of Biochemistry and Microbiology, University of Chemistry and Technology in Prague</institution>, <addr-line>Prague</addr-line>, <country>Czechia</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Faculty of Science, University of Zagreb</institution>, <addr-line>Zagreb</addr-line>, <country>Croatia</country></aff>
    <aff id="aff3"><sup>3</sup><institution>Computer Engineering Department, Istanbul Technical University</institution>, <addr-line>Istanbul</addr-line>, <country>Turkey</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Elena Papaleo, Danish Cancer Society Research Center, Denmark</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Carlo Camilloni, University of Milan, Italy; Massimiliano Bonomi, Institut Pasteur, France</p>
      </fn>
      <corresp id="c001">*Correspondence: Vojtech Spiwok <email>spiwokv@vscht.cz</email></corresp>
      <fn fn-type="other" id="fn001">
        <p>This article was submitted to Biological Modeling and Simulation, a section of the journal Frontiers in Molecular Biosciences</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>4</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>6</volume>
    <elocation-id>25</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>1</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>01</day>
        <month>4</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2019 Trapl, Horvacanin, Mareska, Ozcelik, Unal and Spiwok.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Trapl, Horvacanin, Mareska, Ozcelik, Unal and Spiwok</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>The state of a molecular system can be described in terms of collective variables. These low-dimensional descriptors of molecular structure can be used to monitor the state of the simulation, to calculate free energy profiles or to accelerate rare events by a bias potential or a bias force. Frequent calculation of some complex collective variables may slow down the simulation or analysis of trajectories. Moreover, many collective variables cannot be explicitly calculated for newly sampled structures. In order to address this problem, we developed a new package called <italic>anncolvar</italic>. This package makes it possible to build and train an artificial neural network model that approximates a collective variable. It can be used to generate an input for the open-source enhanced sampling simulation PLUMED package, so the collective variable can be monitored and biased by methods available in this program. The computational efficiency and the accuracy of <italic>anncolvar</italic> are demonstrated on selected molecular systems (cyclooctane derivative, Trp-cage miniprotein) and selected collective variables (Isomap, molecular surface area).</p>
    </abstract>
    <kwd-group>
      <kwd>metadynamics</kwd>
      <kwd>neural networks</kwd>
      <kwd>molecular dynamics simulation</kwd>
      <kwd>collective variables</kwd>
      <kwd>free energy simulations</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source id="cn001">Ministerstvo Školství, Mládeže a Tělovýchovy<named-content content-type="fundref-id">10.13039/501100001823</named-content></funding-source>
        <award-id rid="cn001">LTC18074</award-id>
        <award-id rid="cn001">LM2015047</award-id>
        <award-id rid="cn001">LM2015042</award-id>
        <award-id rid="cn001">LM2015085</award-id>
      </award-group>
      <award-group>
        <funding-source id="cn002">European Cooperation in Science and Technology<named-content content-type="fundref-id">10.13039/501100000921</named-content></funding-source>
      </award-group>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="0"/>
      <equation-count count="0"/>
      <ref-count count="38"/>
      <page-count count="9"/>
      <word-count count="6303"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>Introduction</title>
    <p>Molecular dynamics simulation makes it possible to simulate any molecular process at the atomic level. In principle, structural and thermodynamical properties of a protein can be predicted by simulation of its folding and unfolding. Similarly, structure and stability of a protein-ligand complex can be predicted by simulation of binding and unbinding. Unfortunately, many molecular processes either cannot be simulated or their simulation is far from routine due to enormous computational costs of the molecular dynamics simulation method.</p>
    <p>Several enhanced sampling methods have been developed in order to address this problem (Spiwok et al., <xref rid="B29" ref-type="bibr">2015a</xref>). Some of these methods, such as umbrella sampling (Torrie and Valleau, <xref rid="B35" ref-type="bibr">1977</xref>) or metadynamics (Laio and Parrinello, <xref rid="B16" ref-type="bibr">2002</xref>), use a bias potential or a bias force to destabilize frequently sampled states and to enhance sampling of poorly sampled states. Tempering methods enhance sampling by means of elevated temperature (Abrams and Bussi, <xref rid="B2" ref-type="bibr">2014</xref>). There are methods combining tempering and biasing as well as methods based on completely different principles.</p>
    <p>Biased simulations usually require one or more preselected degrees of freedom on which the bias force or potential is applied. These degrees of freedom are referred to as collective variables (CVs). There are two technical prerequisites for CVs to be applicable in biased simulations. Firstly, a CV must be a function of atomic coordinates of the molecular system, i.e., it must be possible to calculate the value of a CV at every step of the simulation solely from atomic coordinates. Secondly, it must be possible to convert the force acting on the CV into forces acting on individual atoms, i.e., it must be possible to calculate the first derivative of the CV with respect to atomic Cartesian coordinates. Beside these technical prerequisites, in order to efficiently enhance sampling it is necessary to cover all slow motions in the molecular systems by few CVs.</p>
    <p>There are many promising CVs that do not fulfill these requirements and therefore cannot be directly used in biased simulations. These include, for example, the results of non-linear dimensionality reduction methods (Das et al., <xref rid="B11" ref-type="bibr">2006</xref>). There are examples of other CVs that fulfill these requirements; however, their calculation is computationally expensive. In order to make biased simulation with these CVs possible, we and others introduced approximations tailored for biased simulations (Branduardi et al., <xref rid="B5" ref-type="bibr">2007</xref>; Spiwok and Králová, <xref rid="B30" ref-type="bibr">2011</xref>; Spiwok et al., <xref rid="B31" ref-type="bibr">2015b</xref>; Pazúriková et al., <xref rid="B24" ref-type="bibr">2017</xref>).</p>
    <p>Recent development of neural network algorithms allows the usage of artificial neural networks for the purpose of CV approximation. The advantage of neural networks is the fact that many of them are trained by the backpropagation algorithm (Goodfellow et al., <xref rid="B14" ref-type="bibr">2016</xref>), which requires easy calculation of the derivatives of the output with respect to the input. This is exactly what is needed to convert forces acting on a CV into forces acting on atoms. Application of neural network models may also benefit from the current development of neural networks, which has lead to a number of new toolkits and programs.</p>
    <p>Multiple recent studies have tested machine learning approaches to design collective variables for biased simulation to study thermodynamics and kinetics of molecular transitions (Galvelis and Sugita, <xref rid="B13" ref-type="bibr">2017</xref>; Chen and Ferguson, <xref rid="B9" ref-type="bibr">2018</xref>; Guo et al., <xref rid="B15" ref-type="bibr">2018</xref>; Mardt et al., <xref rid="B19" ref-type="bibr">2018</xref>; Pérez et al., <xref rid="B25" ref-type="bibr">2018</xref>; Seo et al., <xref rid="B28" ref-type="bibr">2018</xref>; Sultan and Pande, <xref rid="B33" ref-type="bibr">2018</xref>; Wehmeyer and Noé, <xref rid="B38" ref-type="bibr">2018</xref>). In this work we describe a new tool <italic>anncolvar</italic> for approximation of an arbitrary CV. Its function is outlined in <xref ref-type="fig" rid="F1">Figure 1</xref>. This tool requires a set of structures, either a simulation trajectory or any other set of structures. For the sake of simplicity we will call this set a training trajectory. It must be accompanied with precomputed values of CVs. These data are used to train a simple neural network to approximate the value of CVs for other out-of-sample structures. It generates an input to a popular enhanced sampling program PLUMED (Bonomi et al., <xref rid="B4" ref-type="bibr">2009</xref>; Tribello et al., <xref rid="B36" ref-type="bibr">2014</xref>). The CV approximated by <italic>anncolvar</italic> can be calculated <italic>a posteriori</italic> for any 3D structure or trajectory. Furthermore, it can be used in metadynamics or other enhanced sampling methods available in PLUMED. This approach was tested on conformational changes of a cyclooctane derivative and Trp-cage mini-protein folding. Isomap (Tenenbaum et al., <xref rid="B34" ref-type="bibr">2000</xref>) low-dimensional embeddings used as CVs in the metadynamics simulation of the former system represent CVs that cannot be calculated explicitly from Cartesian coordinates. Solvent-accessible surface area (SASA) used as a CV in simulations of the later system represents a CV that can be calculated explicitly from Cartesian coordinates, but such calculation is slow.</p>
    <fig id="F1" position="float">
      <label>Figure 1</label>
      <caption>
        <p>Schematic representation of <italic>anncolvar</italic> function. Three input files are needed for training: (i). reference structure (in PDB) of the molecule located in the center of box with one corner with coordinates [0, 0, 0] and size of [<italic>l</italic><sub><italic>x</italic></sub>, <italic>l</italic><sub><italic>y</italic></sub>, <italic>l</italic><sub><italic>z</italic></sub>], (ii) training trajectory (without molecules broken by periodic boundary condition) and, (iii) file containing precomputed values of the CV for each snapshot of the training trajectory. The program generates the input file for PLUMED. In PLUMED the molecule is fit to the template (reference structure) and the CV is calculated by neural network.</p>
      </caption>
      <graphic xlink:href="fmolb-06-00025-g0001"/>
    </fig>
    <p>The program can be accessed for free at <ext-link ext-link-type="uri" xlink:href="https://github.com/spiwokv/anncolvar">https://github.com/spiwokv/anncolvar</ext-link> or via PyPI.</p>
  </sec>
  <sec sec-type="methods" id="s2">
    <title>Methods</title>
    <sec>
      <title>Use of Anncolvar</title>
      <p>The program <italic>anncolvar</italic> is written in <italic>Python</italic> and uses packages <italic>mdtraj</italic> (McGibbon et al., <xref rid="B21" ref-type="bibr">2015</xref>), <italic>numpy</italic> (Oliphant, <xref rid="B23" ref-type="bibr">2006</xref>) and <italic>keras</italic> (Cholet, 2018)<xref ref-type="fn" rid="fn0001"><sup>1</sup></xref>. The machine learning package <italic>keras</italic> runs on top of one of three machine learning backends, namely <italic>TensorFlow, Theano</italic> or <italic>CNTK</italic>. Before installation of <italic>anncolvar</italic> it is necessary to install one of these backends. The package <italic>anncolvar</italic> was tested with <italic>TensorFlow</italic> on a laptop, personal computer and HPC cluster, with <italic>Theano</italic> on HPC cluster and with all three backends in continuous integration environment Travis-CI. Installation of other libraries may be required in order to enable use of GPU acceleration on GPU-equipped computers. Additionally, one needs to install <italic>Python</italic> (<italic>Python</italic> 2.7 and <italic>Python</italic> 3.6 were tested) and package management library <italic>PyPI</italic>.</p>
      <p>Once the backend is installed, <italic>anncolvar</italic> can be installed by typing:</p>
      <preformat>
pip install numpy cython
pip install anncolvar
</preformat>
      <p>(or with <italic>sudo</italic>, depending on user rights and type of installation).</p>
      <p><italic>PyPI</italic> installs all required python libraries. Successful installation can be checked by typing:</p>
      <preformat>
anncolvar -h
</preformat>
      <p>to print help. <italic>Anncolvar</italic> can be also installed from Anaconda Cloud (<ext-link ext-link-type="uri" xlink:href="https://anaconda.org/spiwokv/anncolvar">https://anaconda.org/spiwokv/anncolvar</ext-link>).</p>
      <p>The program <italic>anncolvar</italic> is written in a way so that it requires a preprepared reference structure and a training trajectory. The reference structure is a single structure of the molecular system in PDB format. It is used as a template for RMSD fitting in order to remove translational and rotational motions. Furthermore, input data for artificial neural networks are typically scaled to lie between 0 and 1. The reference structure is used in this process. It must be prepared to fulfill following requirements:</p>
      <list list-type="order">
        <list-item>
          <p>It may contain only atoms intended for the analysis. Atoms not intended for the analysis, such as hydrogen atoms, must be deleted. The program <italic>anncolvar</italic> does not ask which atoms are to be analyzed and which are not. Numbering of atoms should not be changed by deletion of unwanted atoms, e.g., if atoms 2, 3, 5, 6, 8, etc. are deleted, the remaining atoms must be numbered 1, 4, 7, etc., not 1, 2, 3, etc.</p>
        </list-item>
        <list-item>
          <p>It must be centered in a reasonably large box with coordinates of one corner set to [0,0,0] and the diagonal corner set to [<italic>l</italic><sub>x</sub>, <italic>l</italic><sub>y</sub>, <italic>l</italic><sub>z</sub>] (cubic boxes were used in this work). The size of the box must be sufficient to accommodate the analyzed molecule in all snapshots of the simulation (the program returns an error message if this fails). In the preprocessing step done by <italic>anncolvar</italic> the coordinates are fitted to the reference structure and then divided by <italic>l</italic><sub>x</sub>, <italic>l</italic><sub>y</sub> and <italic>l</italic><sub>z</sub> to lie between 0 and 1. The reference structure can be generated, for example, in Gromacs by a command:</p>
        </list-item>
      </list>
      <preformat>
gmx editconf -f input.pdb -o reference.pdb -box 6 6 6 -c
</preformat>
      <p>for a box with <italic>l</italic><sub>x</sub> = <italic>l</italic><sub>y</sub> = <italic>l</italic><sub>z</sub> = 6 nm. The values of <italic>l</italic><sub>x</sub>, <italic>l</italic><sub>y</sub> and <italic>l</italic><sub>z</sub> must be specified by options <monospace>-boxx</monospace>, <monospace>-boxy</monospace> and <monospace>-boxz</monospace>.</p>
      <p>The training trajectory must be prepared to fulfill following requirements:</p>
      <list list-type="order">
        <list-item>
          <p>It may contain only atoms intended for the analysis, i.e., the same atoms as in the reference structure.</p>
        </list-item>
        <list-item>
          <p>The molecule must not be broken due to periodic boundary condition.</p>
        </list-item>
      </list>
      <p>Fitting to a template is done by <italic>mdtraj</italic> library in <italic>anncolvar</italic>. For special fitting protocols it is possible to fit the training trajectory before running <italic>anncolvar</italic> and switch off fitting in <italic>anncolvar</italic> by <monospace>-nofit</monospace> option.</p>
      <p>Finally, the program requires a set of precalculated values of collective variables for each snapshot of the training trajectory (option <bold>-c</bold>). This must be a space-separated file with a column containing values of the CV in the order of snapshots in the training trajectory. The index of the column can be specified by <monospace>-col</monospace> (e.g., <monospace>-col 2</monospace> for the second column).</p>
      <p>The program makes it possible to modify the design of the neural network, namely the number of hidden layers (1, 2, or 3 is supported), activation functions in each layer (keras activation functions are supported), and the details of optimization (loss function, batch size and optimization algorithm). The results are written to a text output file for easy visualization of the correlation between original and predicted CV values. This output file controlled by <bold>-o</bold> option contains predicted and original values in the first and the second column, respectively. The third column indicates whether the value was used in the training (TR) or test (TE) set. Stratification of data into the training and test sets is controlled by <monospace>-test</monospace> (size of test set) and <monospace>-shuffle</monospace> (whether snapshots of the trajectory are or are not shuffled before the stratification).</p>
      <p>Input file for the PLUMED open-source library for analyzing and biasing molecular dynamics simulations (Tribello et al., <xref rid="B36" ref-type="bibr">2014</xref>) is also provided (<monospace>-plumed</monospace> option). This file (default name <italic>plumed.dat</italic>) makes it possible without much changes to calculate the CV for a trajectory (by PLUMED driver) or to monitor the value of the CV during a simulation. Application of the output PLUMED file in metadynamics or other enhanced sampling method supported by PLUMED requires minor changes easy for an experienced PLUMED user. In case the training trajectory and the biased simulation use a different atom numbering, it is necessary to renumber atoms in the PLUMED input file. The reference file is used as a template for fitting of the molecule in order to remove rotational and translational degrees of freedom. It may be necessary to modify the PDB format to fulfill the requirements of PLUMED.</p>
      <p>Proper function of <italic>anncolvar</italic> can be checked by recalculation of the CV in the training trajectory using <italic>plumed driver</italic> utility followed by comparison with the text output of <italic>anncolvar</italic>.</p>
      <p>A sample training may be executed by:</p>
      <preformat>
anncolvar -i traj.xtc -p reference.pdb -c results_isomap -col 2 \
-boxx 1 -boxy 1 -boxz 1 -layers 1 -layer1 64 -epochs 2000 \
-o corr1.txt -plumed plumed1.dat
</preformat>
      <p>This carries out 2,000 epochs of training on an artificial neural network with the training trajectory in <italic>traj.xtc</italic> (Gromacs format), reference structure in <italic>reference.pdb</italic> and precalculated CV values in <italic>results_isomap</italic> (in the second column). The artificial neural network was composed of one hidden layer with 64 neurons with sigmoid (default) activation function.</p>
    </sec>
    <sec>
      <title>Simulation Details</title>
      <p>All simulations were carried out in Gromacs 5.1.1 (Abraham et al., <xref rid="B1" ref-type="bibr">2015</xref>) with PLUMED 2.4 (Tribello et al., <xref rid="B36" ref-type="bibr">2014</xref>).</p>
      <p>Cyclooctane derivative (<italic>trans</italic>,<italic>trans</italic>-1,2,4-trifluorocyclooctane) was simulated as described elsewhere (Spiwok and Králová, <xref rid="B30" ref-type="bibr">2011</xref>). Briefly, it was simulated in General AMBER force field (Wang et al., <xref rid="B37" ref-type="bibr">2004</xref>) in vacuum using stochastic dynamics integrator with 1 fs step and without constraints. Temperature was kept constant at 300 K using Parrinello-Bussi thermostat (Bussi et al., <xref rid="B7" ref-type="bibr">2007</xref>). Electrostatics was modeled without cut-off. The set of 8,375 reference structures was kindly provided by Brown and co-workers (Brown et al., <xref rid="B6" ref-type="bibr">2008</xref>). They were generated by Brown and co-workers using a systematic generation algorithm as described in their work (Brown et al., <xref rid="B6" ref-type="bibr">2008</xref>).</p>
      <p>Trp-cage was modeled using Amber99SB-ILDN (Lindorff-Larsen et al., <xref rid="B18" ref-type="bibr">2010</xref>) force field. The protein was placed in a periodic box of size 7 × 7 × 7 nm (metadynamics, MTD) or 3.548 × 3.896 × 3.389 nm (parallel tempering metadynamics, PT-MTD) containing 11,128 (MTD) (Laio and Parrinello, <xref rid="B16" ref-type="bibr">2002</xref>) or 1,366 (PT-METAD) (Bussi et al., <xref rid="B8" ref-type="bibr">2006</xref>) water molecules and one chloride anion. Step of molecular dynamics simulation was set to 2 fs. All bonds were constrained. Electrostatics was modeled by Particle-mesh Ewald method (Darden et al., <xref rid="B10" ref-type="bibr">1993</xref>). Temperature was kept constant using Parrinello-Bussi thermostat (Bussi et al., <xref rid="B7" ref-type="bibr">2007</xref>).</p>
      <p>For MTD, the system was minimized by steepest descent algorithm. This was followed by 100 ps simulation in NVT and 100 ps simulation in NVT ensemble. This was followed by 100 ns well tempered metadynamics (Barducci et al., <xref rid="B3" ref-type="bibr">2008</xref>) at 300 K.</p>
      <p>For PT-MTD, the system was minimized by steepest descent algorithm. This was followed by 100 ps simulation in NVT and 100 ps simulation in NVT ensemble. The system was preequilibrated by 500 ps NVT simulations at 32 temperatures: 278.0, 287.0, 295.0, 303.0, 312.0, 321.0, 329.0, 338.0, 346.0, 355.0, 365.0, 375.0, 385.0, 396.0, 406.0, 416.0, 427.0, 437.0, 448.0, 459.0, 470.0, 482.0, 493.0, 505.0, 517.0, 528.0, 539.0, 551.0, 562.0, 573.0, 584.0, and 595.0 K. After that PT-METAD was performed at same temperatures. Replica exchange attempts were made every picosecond.</p>
      <p>Trajectory of 208 μs simulation of Trp-cage folding/unfolding was kindly provided by D. E. Shaw Research (Darden et al., <xref rid="B10" ref-type="bibr">1993</xref>). It was converted to Gromacs format and prepared by Gromacs tools for analysis in <italic>anncolvar</italic>.</p>
    </sec>
  </sec>
  <sec id="s3">
    <title>Results and Discussions</title>
    <sec>
      <title>Cyclooctane Derivative Conformational Transitions</title>
      <p>Cyclooctane non-symmetric derivative (<italic>trans</italic>,<italic>trans</italic>-1,2,4-trifluorocyclooctane) was introduced as a model molecular system by Brown and co-workers (Brown et al., <xref rid="B6" ref-type="bibr">2008</xref>; Martin et al., <xref rid="B20" ref-type="bibr">2010</xref>). They generated more than one million of conformations of this molecule by a systematic geometry-based algorithm. Then they filtered this set to obtain a set of 8,375 non-redundant structures. These structures were analyzed by a non-linear dimensionality method Isomap (Tenenbaum et al., <xref rid="B34" ref-type="bibr">2000</xref>). Brown and co-workers demonstrated that it is possible to describe conformation of the model molecule using just three low-dimensional Isomap embeddings (see <xref ref-type="fig" rid="F2">Figure 2A</xref> for the reproduction of the results of Brown and co-workers) (Brown et al., <xref rid="B6" ref-type="bibr">2008</xref>).</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p>Three-dimensional Isomap embeddings of <italic>trans</italic>,<italic>trans</italic>-1,2,4-trifluorocyclooctane <bold>(A)</bold> and its approximation using <italic>anncolvar</italic>
<bold>(B)</bold>. Isomap embeddings in <bold>(A)</bold> and <bold>(B)</bold> were rotated by angle [0.00 rad, 2.40 rad, −0.55 rad] for better clarity. Training set points are in gray, test set points are in different colors depending on whether they were used to train Isomap embedding 1, 2, or 3. Comparison of Isomap embeddings 1 <bold>(C)</bold>, 2 <bold>(D)</bold>, and 3 <bold>(E)</bold> original (horizontal) vs. approximated by <italic>anncolvar</italic> (vertical). Training set points are in black, test set points are in red. Distribution of differences between original and predicted CVs can be found in <xref ref-type="supplementary-material" rid="SM1">Figure S1</xref>.</p>
        </caption>
        <graphic xlink:href="fmolb-06-00025-g0002"/>
      </fig>
      <p>It is very challenging to use low-dimensional embeddings as CVs in biased simulations. For this, it is necessary to calculate a low-dimensional embedding for a new out-of-sample structure. Furthermore, in order to apply biasing forces on a molecular structure it is necessary to calculate derivatives of the low-dimensional embedding with respect to the Cartesian coordinates. Unfortunately, using Isomap and most other non-linear methods it is not possible to directly calculate neither low dimensional embeddings for a new out-of-sample structure, nor their derivatives. For this purpose we have tested the Property Map Collective Variables (Spiwok and Králová, <xref rid="B30" ref-type="bibr">2011</xref>), an extension of Path Collective Variables (Branduardi et al., <xref rid="B5" ref-type="bibr">2007</xref>). An interesting alternative is application of autoencoders recently used by Chen and Ferguson (<xref rid="B9" ref-type="bibr">2018</xref>).</p>
      <p>Here we test an artificial neural network performed by <italic>anncolvar</italic> to approximate Isomap embeddings. The set of 8,375 structures provided by Brown et al. (<xref rid="B6" ref-type="bibr">2008</xref>) was analyzed by Isomap to obtain three low-dimensional embeddings (<xref ref-type="fig" rid="F2">Figure 2A</xref>). Next we use them to train a neural network to approximate these embeddings. Briefly, we used the command:</p>
      <preformat>
anncolvar -i traj_fit.xtc -p reference.pdb \
-c results_isomap -col 2 \
-boxx 1 -boxy 1 -boxz 1 \
-layers 3 -layer1 8 -layer2 8 -layer3 8 \
-actfun1 sigmoid -actfun2 sigmoid -actfun3 sigmoid \
-optim adam -loss mean_squared_error \
-epochs 1000 -batch 256 \
-o low1.txt -plumed plumed1.dat
</preformat>
      <p>The set of 8,375 structures was stored in Gromacs format in <italic>traj_fit.xtc</italic>. A reference structure was stored in the file <italic>reference.pdb</italic>. It was centered in the cubic box of size 1 nm with the corners at [0,0,0], [0,0,1], … [1,1,1] (in nm). Isomap low-dimensional embeddings were stored in the file <italic>results_isomap</italic> (space-separated, with structure ID and Isomap embedding 1, 2, and 3 in each column). This carried out 1,000 epochs of training (ADAM optimizer, mean square error loss function) of a network composed of an input layer with 72 neurons (for Cartesian coordinates of 24 atoms) and three hidden layers, each with eight neurons with the sigmoid activation function. By default, 10% of randomly selected structures are used as the test set and remaining as the training set.</p>
      <p>This was repeated for the second and third Isomap coordinates (with <monospace>-col 3</monospace> and <monospace>4</monospace>, respectively). The resulting PLUMED input files were combined manually to one PLUMED input file. It was also necessary to renumber atoms due to a different numbering in the original data set and used force field.</p>
      <p>There were visible differences between original Isomap embeddings and values approximated by <italic>anncolvar</italic> (<xref ref-type="fig" rid="F2">Figure 2</xref>), nevertheless, these differences do not affect the functionality of embeddings. Pearson correlations of original and anncolvar-predicted Isomap low-dimensional embeddings were higher than 0.997. There was no significant difference between correlations in the training and test sets.</p>
      <p>Next, the PLUMED input file was edited to enable metadynamics (Laio and Parrinello, <xref rid="B16" ref-type="bibr">2002</xref>) with all three Isomap embeddings used as CVs. Hills were added every 1 ps with constant height of 0.2 kJ·mol<sup>−1</sup> and width 0.02 (for all three Isomap CVs). The results of 100 ns metadynamics are depicted in <xref ref-type="fig" rid="F3">Figure 3</xref>. The simulation started from one of boat-chair conformation located in the central “hourglass.” After ~20 ns all eight boat-chair conformations were flooded and the system started to explore one of boat conformations at the “equator.” After ~30 ns it started to explore the crown conformation at the “south pole.” At time ~50 ns also the inverted crown at the “north pole” was sampled. The convergence was assessed as the evolution of free energy difference between crown and boat-chair (see <xref ref-type="supplementary-material" rid="SM1">Figure S2</xref>). The free energy surface was visualized by Mayavi (Ramachandran and Varoquaux, <xref rid="B27" ref-type="bibr">2011</xref>) and PoVRay (Persistence of Vision, 2018)<xref ref-type="fn" rid="fn0002"><sup>2</sup></xref>. The resulting free energy surface (<xref ref-type="fig" rid="F3">Figure 3B</xref>) is in good agreement with the results of our previous studies (Spiwok and Králová, <xref rid="B30" ref-type="bibr">2011</xref>; Pazúriková et al., <xref rid="B24" ref-type="bibr">2017</xref>).</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p>Sampling of CVs in 100 ns metadynamics with Isomap low-dimensional embeddings calculated by <italic>anncolvar</italic>
<bold>(A)</bold>. Free energy surface depicted as an isosurface (in violet) at + 30 kJ·mol<sup>−1</sup> (relative to the global free energy minimum) <bold>(B)</bold>. Isomap embeddings were rotated by angle [0.00 rad, 2.40 rad, −0.55 rad] for better clarity.</p>
        </caption>
        <graphic xlink:href="fmolb-06-00025-g0003"/>
      </fig>
    </sec>
    <sec>
      <title>Trp-Cage Folding</title>
      <p>Intuitively solvent-accessible surface area (SASA) of a protein is likely to be an interesting CV for protein folding simulation, because SASA of a protein in the folded state is likely to be smaller than for the unfolded state, which is one of requirements for a CV to be successful. For this purpose we used a 208-μs trajectory of Trp-cage miniprotein kindly provided by D. E. Shaw Research (Lindorff-Larsen et al., <xref rid="B17" ref-type="bibr">2011</xref>). We admit that this is not solution to the “chicken-and-egg problem” [as discussed by (Chen and Ferguson, <xref rid="B9" ref-type="bibr">2018</xref>)], because we cannot train the neural network without a long simulation trajectory with folding and unfolding events. Reinforcement learning (Nandy and Biswas, <xref rid="B22" ref-type="bibr">2018</xref>) may be solution to this problem, but it is out of scope of this manuscript.</p>
      <p>The trajectory provided by D. E. Shaw Research was converted to Gromacs format and SASA was calculated for 1,044,000 frames using <italic>gmx sasa</italic> tool from the Gromacs package (Abraham et al., <xref rid="B1" ref-type="bibr">2015</xref>). Next, a neural network was trained in <italic>anncolvar</italic> to approximate SASA. It contained 432 neurons in the input layer (for coordinates of 144 atoms placed in a cubic box of size 6 nm) and one hidden layer with 32 sigmoid neurons. The set of 10% of randomly selected structures was used as the test set and remaining as the training set. This provided a good 0.976 correlation (Pearson) between SASA calculated by <italic>gmx sasa</italic> and predicted by <italic>anncolvar</italic> (<xref ref-type="fig" rid="F4">Figure 4</xref>).</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p>Comparison of SASA calculated by <italic>gmx sasa</italic> (horizontal) and predicted by <italic>anncolvar</italic> (vertical). The line shows the diagonal (<italic>y</italic> = <italic>x</italic>).</p>
        </caption>
        <graphic xlink:href="fmolb-06-00025-g0004"/>
      </fig>
      <p>We also examined the effect of training set size on <italic>anncolvar</italic> performance. The observed effect was small. The Pearson correlation coefficient for reference and predicted values ranged from 0.9750 (50% of trajectory frames used) to 0.9756 (90% of trajectory frames used), both using 1,000 epochs. We also tested training using a sub-optimal training set. Unfolded structures (RMSD form NMR structure &gt;0.25 nm on all atoms, 879,759 structures) were selected from the trajectory and used as a training set. The resulting neural network predicts SASA with relatively good accuracy (Pearson correlation coefficient 0.96 for all structures and 0.77 for folded structures, see <xref ref-type="supplementary-material" rid="SM1">Figure S7</xref>). We plan to test <italic>anncolvar</italic> trained on sub-optimal training sets in future.</p>
      <p>In order to evaluate performance of <italic>anncolvar</italic> we decided to estimate costs of SASA calculation by conventional program (<italic>gmx sasa</italic> from Gromacs package) and to compare it with <italic>anncolvar</italic>. The program <italic>gmx sasa</italic> calculates SASA of Trp-cage in approximately one millisecond. This corresponds to reasonably good performance of ~0.6 s/ps or 10 min/ns. However, for biasing it is necessary to calculate not only SASA, but also its derivatives <italic>d</italic>SASA/<italic>dx</italic>. Methods for calculation of analytical surface derivatives have been reported in literature (Sridharan et al., <xref rid="B32" ref-type="bibr">1995</xref>), but their implementation into available simulation packages would require intensive coding. In order to use numerical derivatives it would be necessary to evaluate delta SASA for incremental changes Δ<italic>r</italic> of all coordinates of all atoms. This would downgrade performance to ~days/ns. There are approaches that can be applied to address this problem, such as evaluation of CVs in multiple time steps (Ferrarotti et al., <xref rid="B12" ref-type="bibr">2015</xref>), parallelization or GPU offloading. However, all these approaches either require intensive changes in a code or they may have other disadvantages.</p>
      <p>The PLUMED input file was used to drive metadynamics (Laio and Parrinello, <xref rid="B16" ref-type="bibr">2002</xref>) and parallel tempering metadynamics (PT-METAD) (Bussi et al., <xref rid="B8" ref-type="bibr">2006</xref>) with SASA as a collective variable. Similarly to cyclooctane derivative it was necessary to manually edit <italic>plumed.dat</italic> file because of different atom numbering in the D. E. Shaw Research data set and the force field we used. Since formation of secondary structure is very important and potentially the slow step of Trp-cage folding, another CV was used to enhance formation of secondary structure. We selected an alpha helical content of a protein structure (ALPHARMSD) (Pietrucci and Laio, <xref rid="B26" ref-type="bibr">2009</xref>) collective variable with parameters set to default in PLUMED. Well-tempered metadynamics was performed with hills of height 1 kJ·mol<sup>−1</sup> added every 1 ps with hill widths 1 nm<sup>2</sup> for SASA and 1 for ALPHARMSD, respectively. Bias factor of well-tempered metadynamics was set to 15 (Barducci et al., <xref rid="B3" ref-type="bibr">2008</xref>). Unfortunately, 100 ns metadynamics starting from the folded structure lead to quick unfolding but not to folding (see Supporting Information, <xref ref-type="supplementary-material" rid="SM1">Figure S3</xref>).</p>
      <p>Therefore, in order to enhance sampling in degrees of freedom that cannot be addressed by the applied CVs we replaced metadynamics by PT-METAD (Bussi et al., <xref rid="B8" ref-type="bibr">2006</xref>). The system was simulated at 32 temperatures ranging from 278.0 to 595.0 K. Metadynamics parameters were not changed. The plot in <xref ref-type="supplementary-material" rid="SM1">Figure S4</xref> demonstrated significant overlap of potential energy histograms, which is a prerequisite for a reasonable replica exchange rate. During a PT-METAD (50 ns in each replica) we observed eight folding events (recognized by visual inspection of “demuxed” trajectories, see Supporting Information, <xref ref-type="supplementary-material" rid="SM1">Figure S5</xref>). This is in contrast to a parallel tempering molecular dynamics simulation with otherwise same parameters (without metadynamics), where no folding events were observed.</p>
      <p>The size of box in PT-METAD was small to increase replica exchange probability and thus to reduce required number of replicas. We admit that this increases risk of self-interaction artifacts in folding simulations. We visually examined folding simulation trajectories and discovered examples of self-interactions (see <xref ref-type="supplementary-material" rid="SM1">Figure S6</xref>). These interactions were relatively short-living. Moreover, we believe that self-interactions complicate, not facilitate, folding. Therefore, neural network approximated SASA can be seen as a successful CV.</p>
      <p>Free energy surfaces were calculated from Gaussian hills accumulated at each temperature in PT-METAD (<xref ref-type="fig" rid="F5">Figure 5</xref>). Free energy surfaces are in a good agreement with the results from literature (Lindorff-Larsen et al., <xref rid="B17" ref-type="bibr">2011</xref>). At low temperatures there were two free energy minima with approximately same value of free energy. One at CVs [~17 nm<sup>2</sup>, ~6] corresponds to the folded structure. The second one at CVs [~21 nm<sup>2</sup>, ~0.5] corresponds to the unfolded structure. The fact that both minima have approximately same free energy value is in agreement with the fact that in an unbiased simulation (Lindorff-Larsen et al., <xref rid="B17" ref-type="bibr">2011</xref>) the system spends approximately same time in unfolded and folded state. At slightly elevated temperatures the minimum corresponding to the folded state becomes more shallow and at high temperature it becomes almost indistinguishable. Other states, such as those with higher helical content or low-SASA states with low helical content, were predicted as energetically unfavorable.</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p>Free energy surfaces of Trp-cage calculated by PT-METAD with SASA and Alpha RMSD collective variables at four selected temperatures.</p>
        </caption>
        <graphic xlink:href="fmolb-06-00025-g0005"/>
      </fig>
      <p>One of the motivations for development of <italic>anncolvar</italic> was the potential speed gain compared to Path Collective Variables and Property Map. These two approaches require multiple RMSD-fitting processes in each step. This problem has been addressed by Close Structure algorithm (Pazúriková et al., <xref rid="B24" ref-type="bibr">2017</xref>), which reduces the number of RMSD-fitting processes, but still requires multiple RMSD-fitting processes in some steps of the simulation. The approach presented here requires only one RMSD-fitting in each step. RMSD-fitting free approaches (such as those using interatomic distances) are not supported by <italic>anncolvar</italic>, but can be used in future if it turns out to be a viable strategy.</p>
      <p>For the cyclooctane derivative, metadynamics was significantly slower than unbiased simulation (~40 ns·day<sup>−1</sup> vs. ~7 μs·day<sup>−1</sup> on single CPU). However, this can be explained by the fact that not only CV calculation, but also calculation of the bias potential takes large proportion of CPU load in the system much smaller (24 atoms) than biomolecular systems with explicit solvents. On the other hand, the situation was much more favorable in biomolecular systems with an explicit solvent. Metadynamics (Trp-cage with 11,128 water and one chloride) was approximately twice slower than corresponding unbiased simulation (both on 8 CPU cores). Examination of one part (5 ns) of metadynamics simulation revealed that metadynamics force calculation accounts for 78% of total force calculations and 59% of total calculations. Similarly PT-METAD (Trp-cage with 1,366 waters and one chloride) was also approximately twice slower than corresponding unbiased parallel tempering simulation (both on 32 CPU cores).</p>
      <p>Neural networks architectures used in this study were relatively small to avoid slowing down of simulations. They are not deep enough to be called deep learning. There are several options to improve the program in order to enable deeper neural network models. For example, we plan to enable loading of weights and biases into PLUMED as text files. This would also simplify file handling. There is also space for parallelization and GPU offloading. We plan to work on this in near future.</p>
      <p>In this work we used two different data sets to train the neural network. The first was generated by a systematic conformer generation. The second was generated by a long molecular dynamics simulation. Both approaches require that the structure corresponding to the free energy minimum is present in the training data set. This leads to the “chicken-and-egg problem” discussed by Chen and Ferguson (Chen and Ferguson, <xref rid="B9" ref-type="bibr">2018</xref>). We have to know the structure of folded protein (or at least it must be present in the training data set without knowing that it is the folded one) in order to simulate folding of the protein. Therefore, the approach outlined in this work is suitable to study protein folding mechanisms with known folded structure, but it is not suitable for <italic>de novo</italic> structure prediction. Generative machine learning models, which involve models that can make accurate prediction outside the training set as they learn a broad distribution of the training set, may be useful to address this problem. Reinforcement learning can be another answer to this problem.</p>
    </sec>
  </sec>
  <sec id="s4">
    <title>Author Contributions</title>
    <p>All authors contributed to the code of anncolvar. DT, IH, and VM: tested the code; DT, IH, and VS: carried out simulations, all authors contributed to the manuscript.</p>
    <sec>
      <title>Conflict of Interest Statement</title>
      <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <p>Authors would like to thank Brown et al. and D. E. Shaw Research for data used in this work.</p>
  </ack>
  <fn-group>
    <fn id="fn0001">
      <p><sup>1</sup>Cholet, F., and co-workers, <ext-link ext-link-type="uri" xlink:href="https://keras.io">https://keras.io</ext-link>, 2019.</p>
    </fn>
    <fn id="fn0002">
      <p><sup>2</sup>Persistence of Vision Pty. Ltd., <ext-link ext-link-type="uri" xlink:href="http://www.povray.org">http://www.povray.org</ext-link>, 2018.</p>
    </fn>
  </fn-group>
  <fn-group>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding.</bold> This work was funded by COST action OpenMultiMed (CA15120, Ministry of Education, Youth and Sports of the Czech Republic LTC18074), specific university research (Ministry of Education, Youth and Sports of the Czech Republic 21-SVV/2019) and Czech National Infrastructure for Biological Data (ELIXIR CZ, Ministry of Education, Youth and Sports of the Czech Republic LM2015047). Computational resources were provided by the CESNET LM2015042 and the CERIT Scientific Cloud LM2015085, provided under the program Projects of Large Research, Development, and Innovations Infrastructures.</p>
    </fn>
  </fn-group>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link ext-link-type="uri" xlink:href="https://www.frontiersin.org/articles/10.3389/fmolb.2019.00025/full#supplementary-material">https://www.frontiersin.org/articles/10.3389/fmolb.2019.00025/full#supplementary-material</ext-link></p>
    <supplementary-material content-type="local-data" id="SM1">
      <media xlink:href="Data_Sheet_1.PDF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abraham</surname><given-names>M. J.</given-names></name><name><surname>Murtola</surname><given-names>T.</given-names></name><name><surname>Schulz</surname><given-names>R.</given-names></name><name><surname>Páll</surname><given-names>S.</given-names></name><name><surname>Smith</surname><given-names>J. C.</given-names></name><name><surname>Hess</surname><given-names>B.</given-names></name><etal/></person-group> (<year>2015</year>). <article-title>GROMACS: High performance molecular simulations through multi-level parallelism from laptops to supercomputers</article-title>. <source>SoftwareX</source>
<volume>1–2</volume>, <fpage>19</fpage>–<lpage>25</lpage>. <pub-id pub-id-type="doi">10.1016/j.softx.2015.06.001</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abrams</surname><given-names>C.</given-names></name><name><surname>Bussi</surname><given-names>G.</given-names></name></person-group> (<year>2014</year>). <article-title>Enhanced sampling in molecular dynamics using metadynamics, replica-exchange, and temperature-acceleration</article-title>. <source>Entropy</source>
<volume>16</volume>, <fpage>163</fpage>–<lpage>199</lpage>. <pub-id pub-id-type="doi">10.3390/e16010163</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barducci</surname><given-names>A.</given-names></name><name><surname>Bussi</surname><given-names>G.</given-names></name><name><surname>Parrinello</surname><given-names>M.</given-names></name></person-group> (<year>2008</year>). <article-title>Well-tempered metadynamics: a smoothly converging and tunable free-energy method</article-title>. <source>Phys. Rev. Lett.</source>
<volume>100</volume>:<fpage>020603</fpage>. <pub-id pub-id-type="doi">10.1103/PhysRevLett.100.020603</pub-id><?supplied-pmid 18232845?><pub-id pub-id-type="pmid">18232845</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonomi</surname><given-names>M.</given-names></name><name><surname>Branduardi</surname><given-names>D.</given-names></name><name><surname>Bussi</surname><given-names>G.</given-names></name><name><surname>Camilloni</surname><given-names>C.</given-names></name><name><surname>Provasi</surname><given-names>D.</given-names></name><name><surname>Raiteri</surname><given-names>P.</given-names></name><etal/></person-group> (<year>2009</year>). <article-title>PLUMED: a portable plugin for free-energy calculations with molecular dynamics</article-title>. <source>Comput. Phys. Commun</source>. <volume>180</volume>, <fpage>1961</fpage>–<lpage>1972</lpage>. <pub-id pub-id-type="doi">10.1016/j.cpc.2009.05.011</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Branduardi</surname><given-names>D.</given-names></name><name><surname>Gervasio</surname><given-names>F. L.</given-names></name><name><surname>Parrinello</surname><given-names>M.</given-names></name></person-group> (<year>2007</year>). <article-title>From A to B in free energy space</article-title>. <source>J. Chem. Phys.</source>
<volume>126</volume>:<fpage>054103</fpage>. <pub-id pub-id-type="doi">10.1063/1.2432340</pub-id><?supplied-pmid 17302470?><pub-id pub-id-type="pmid">17302470</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>W. M.</given-names></name><name><surname>Martin</surname><given-names>S.</given-names></name><name><surname>Pollock</surname><given-names>S. N.</given-names></name><name><surname>Coutsias</surname><given-names>E. A.</given-names></name><name><surname>Watson</surname><given-names>J.-P.</given-names></name></person-group> (<year>2008</year>). <article-title>Algorithmic dimensionality reduction for molecular structure analysis</article-title>. <source>J. Chem. Phys.</source>
<volume>129</volume>:<fpage>064118</fpage>. <pub-id pub-id-type="doi">10.1063/1.2968610</pub-id><?supplied-pmid 18715062?><pub-id pub-id-type="pmid">18715062</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bussi</surname><given-names>G.</given-names></name><name><surname>Donadio</surname><given-names>D.</given-names></name><name><surname>Parrinello</surname><given-names>M.</given-names></name></person-group> (<year>2007</year>). <article-title>Canonical sampling through velocity rescaling</article-title>. <source>J. Chem. Phys.</source>
<volume>126</volume>:<fpage>014101</fpage>. <pub-id pub-id-type="doi">10.1063/1.2408420</pub-id><?supplied-pmid 17212484?><pub-id pub-id-type="pmid">17212484</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bussi</surname><given-names>G.</given-names></name><name><surname>Gervasio</surname><given-names>F. L.</given-names></name><name><surname>Laio</surname><given-names>A.</given-names></name><name><surname>Parrinello</surname><given-names>M.</given-names></name></person-group> (<year>2006</year>). <article-title>Free-energy landscape for β hairpin folding from combined parallel tempering and metadynamics</article-title>. <source>J. Am. Chem. Soc.</source>
<volume>128</volume>, <fpage>13435</fpage>–<lpage>13441</lpage>. <pub-id pub-id-type="doi">10.1021/ja062463w</pub-id><?supplied-pmid 17031956?><pub-id pub-id-type="pmid">17031956</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>W.</given-names></name><name><surname>Ferguson</surname><given-names>A. L.</given-names></name></person-group> (<year>2018</year>). <article-title>Molecular enhanced sampling with autoencoders: on-the-fly collective variable discovery and accelerated free energy landscape exploration</article-title>. <source>J. Comput. Chem.</source>
<volume>39</volume>, <fpage>2079</fpage>–<lpage>2102</lpage>. <pub-id pub-id-type="doi">10.1002/jcc.25520</pub-id><?supplied-pmid 30368832?><pub-id pub-id-type="pmid">30368832</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Darden</surname><given-names>T.</given-names></name><name><surname>York</surname><given-names>D.</given-names></name><name><surname>Pedersen</surname><given-names>L.</given-names></name></person-group> (<year>1993</year>). <article-title>Particle mesh Ewald: An N.log(N) method for Ewald sums in large systems</article-title>. <source>J. Chem. Phys.</source>
<volume>98</volume>:<fpage>10089</fpage>
<pub-id pub-id-type="doi">10.1063/1.464397</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Das</surname><given-names>P.</given-names></name><name><surname>Moll</surname><given-names>M.</given-names></name><name><surname>Stamati</surname><given-names>H.</given-names></name><name><surname>Kavraki</surname><given-names>L. E.</given-names></name><name><surname>Clementi</surname><given-names>C.</given-names></name></person-group> (<year>2006</year>). <article-title>Low-dimensional, free-energy landscapes of protein-folding reactions by nonlinear dimensionality reduction</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source>
<volume>103</volume>, <fpage>9885</fpage>–<lpage>9890</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.0603553103</pub-id><?supplied-pmid 16785435?><pub-id pub-id-type="pmid">16785435</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferrarotti</surname><given-names>M. J.</given-names></name><name><surname>Bottaro</surname><given-names>S.</given-names></name><name><surname>Pérez-Villa</surname><given-names>A.</given-names></name><name><surname>Bussi</surname><given-names>G.</given-names></name></person-group> (<year>2015</year>). <article-title>Accurate multiple time step in biased molecular simulations</article-title>. <source>J. Chem. Theory Comput.</source>
<volume>11</volume>, <fpage>139</fpage>–<lpage>146</lpage>. <pub-id pub-id-type="doi">10.1021/ct5007086</pub-id><?supplied-pmid 26574212?><pub-id pub-id-type="pmid">26574212</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Galvelis</surname><given-names>R.</given-names></name><name><surname>Sugita</surname><given-names>Y.</given-names></name></person-group> (<year>2017</year>). <article-title>Neural network and nearest neighbor algorithms for enhancing sampling of molecular dynamics</article-title>. <source>J. Chem. Theory Comput.</source>
<volume>13</volume>, <fpage>2489</fpage>–<lpage>2500</lpage>. <pub-id pub-id-type="doi">10.1021/acs.jctc.7b00188</pub-id><?supplied-pmid 28437616?><pub-id pub-id-type="pmid">28437616</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Goodfellow</surname><given-names>I.</given-names></name><name><surname>Bengio</surname><given-names>Y.</given-names></name><name><surname>Courville</surname><given-names>A.</given-names></name></person-group> (<year>2016</year>). <source>Deep Learning</source>. <publisher-loc>Cambridge, MA</publisher-loc>: <publisher-name>MIT Press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>A. Z.</given-names></name><name><surname>Sevgen</surname><given-names>E.</given-names></name><name><surname>Sidky</surname><given-names>H.</given-names></name><name><surname>Whitmer</surname><given-names>J. K.</given-names></name><name><surname>Hubbell</surname><given-names>J. A.</given-names></name><name><surname>de Pablo</surname><given-names>J. J.</given-names></name></person-group> (<year>2018</year>). <article-title>Adaptive enhanced sampling by force-biasing using neural networks</article-title>. <source>J. Chem. Phys.</source>
<volume>148</volume>, <fpage>134108</fpage>–<lpage>134109</lpage>. <pub-id pub-id-type="doi">10.1063/1.5020733</pub-id><?supplied-pmid 29626875?><pub-id pub-id-type="pmid">29626875</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laio</surname><given-names>A.</given-names></name><name><surname>Parrinello</surname><given-names>M.</given-names></name></person-group> (<year>2002</year>). <article-title>Escaping free-energy minima</article-title>. <source>Proc Natl. Acad. Sci. U.S.A.</source>
<volume>99</volume>, <fpage>12562</fpage>–<lpage>12566</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.202427399</pub-id><?supplied-pmid 12271136?><pub-id pub-id-type="pmid">12271136</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindorff-Larsen</surname><given-names>K.</given-names></name><name><surname>Piana</surname><given-names>S.</given-names></name><name><surname>Dror</surname><given-names>R. O.</given-names></name><name><surname>Shaw</surname><given-names>D. E.</given-names></name></person-group> (<year>2011</year>). <article-title>How fast-folding proteins fold</article-title>. <source>Science</source>. <volume>334</volume>, <fpage>517</fpage>–<lpage>520</lpage>. <pub-id pub-id-type="doi">10.1126/science.1208351</pub-id><?supplied-pmid 22034434?><pub-id pub-id-type="pmid">22034434</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindorff-Larsen</surname><given-names>K.</given-names></name><name><surname>Piana</surname><given-names>S.</given-names></name><name><surname>Palmo</surname><given-names>K.</given-names></name><name><surname>Maragakis</surname><given-names>P.</given-names></name><name><surname>Klepeis</surname><given-names>J. L.</given-names></name><name><surname>O'Dror</surname><given-names>R.</given-names></name><etal/></person-group>. (<year>2010</year>). <article-title>Improved side-chain torsion potentials for the Amber ff99SB protein force field</article-title>. <source>Proteins</source>. <volume>78</volume>, <fpage>1950</fpage>–<lpage>1958</lpage>. <pub-id pub-id-type="doi">10.1002/prot.22711</pub-id><?supplied-pmid 20408171?><pub-id pub-id-type="pmid">20408171</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mardt</surname><given-names>A.</given-names></name><name><surname>Pasquali</surname><given-names>L.</given-names></name><name><surname>Wu</surname><given-names>H.</given-names></name><name><surname>Noé</surname><given-names>F.</given-names></name></person-group> (<year>2018</year>). <article-title>VAMPnets for deep learning of molecular kinetics</article-title>. <source>Nat. Commun.</source>
<volume>9</volume>:<fpage>5</fpage>
<pub-id pub-id-type="doi">10.1038/s41467-017-02388-1</pub-id><pub-id pub-id-type="pmid">29295994</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>S.</given-names></name><name><surname>Thompson</surname><given-names>A.</given-names></name><name><surname>Coutsias</surname><given-names>E. A.</given-names></name><name><surname>Watson</surname><given-names>J.-P.</given-names></name></person-group> (<year>2010</year>). <article-title>Topology of cyclo-octane energy landscape</article-title>. <source>J. Chem. Phys.</source>
<volume>132</volume>:<fpage>234115</fpage>. <pub-id pub-id-type="doi">10.1063/1.3445267</pub-id><?supplied-pmid 20572697?><pub-id pub-id-type="pmid">20572697</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McGibbon</surname><given-names>R. T.</given-names></name><name><surname>Beauchamp</surname><given-names>K. A.</given-names></name><name><surname>Harrigan</surname><given-names>M. P.</given-names></name><name><surname>Klein</surname><given-names>C.</given-names></name><name><surname>Swails</surname><given-names>J. M.</given-names></name><name><surname>Hernández</surname><given-names>C. X.</given-names></name><etal/></person-group>. (<year>2015</year>). <article-title>MDTraj: a modern open library for the analysis of molecular dynamics trajectories</article-title>. <source>Biophys. J.</source><volume>109</volume>, <fpage>1528</fpage>–<lpage>1532</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpj.2015.08.015</pub-id><?supplied-pmid 26488642?><pub-id pub-id-type="pmid">26488642</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Nandy</surname><given-names>A.</given-names></name><name><surname>Biswas</surname><given-names>M.</given-names></name></person-group> (<year>2018</year>). <source>Reinforcement Learning</source>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Apress Media</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Oliphant</surname><given-names>T. E.</given-names></name></person-group> (<year>2006</year>). <source>A Guide to NumPy</source>. <publisher-loc>Spanish Fork, UT</publisher-loc>: <publisher-name>Trelgol Publishing</publisher-name>. <?supplied-pmid 26307428?></mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pazúriková</surname><given-names>J.</given-names></name><name><surname>Krenek</surname><given-names>A.</given-names></name><name><surname>Spiwok</surname><given-names>V.</given-names></name><name><surname>Šimková</surname><given-names>M.</given-names></name></person-group> (<year>2017</year>). <article-title>Reducing the number of mean-square deviation calculations with floating close structure in metadynamics</article-title>. <source>J. Chem. Phys.</source>
<volume>146</volume>:<fpage>115101</fpage>. <pub-id pub-id-type="doi">10.1063/1.4978296</pub-id><?supplied-pmid 28330370?><pub-id pub-id-type="pmid">28330370</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pérez</surname><given-names>A.</given-names></name><name><surname>Martínez-Rosell</surname><given-names>G.</given-names></name><name><surname>De Fabritiis</surname><given-names>G.</given-names></name></person-group> (<year>2018</year>). <article-title>Simulations meet machine learning in structural biology</article-title>. <source>Curr. Opin. Struct. Biol.</source>
<volume>49</volume>, <fpage>139</fpage>–<lpage>144</lpage>. <pub-id pub-id-type="doi">10.1016/j.sbi.2018.02.004</pub-id><?supplied-pmid 29477048?><pub-id pub-id-type="pmid">29477048</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pietrucci</surname><given-names>F.</given-names></name><name><surname>Laio</surname><given-names>A.</given-names></name></person-group> (<year>2009</year>). <article-title>A collective variable for the efficient exploration of protein beta-structures with metadynamics: application to sh3 and gb1</article-title>. <source>J. Chem. Theory Comput.</source>
<volume>5</volume>, <fpage>2197</fpage>–<lpage>2201</lpage>. <pub-id pub-id-type="doi">10.1021/ct900202f</pub-id><pub-id pub-id-type="pmid">26616604</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramachandran</surname><given-names>P.</given-names></name><name><surname>Varoquaux</surname><given-names>G.</given-names></name></person-group> (<year>2011</year>). <article-title>Mayavi: 3D visualization of scientific data</article-title>. <source>IEEE. Comput. Sci. Eng.</source>
<volume>13</volume>, <fpage>40</fpage>–<lpage>51</lpage>. <pub-id pub-id-type="doi">10.1109/MCSE.2011.35</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seo</surname><given-names>B.</given-names></name><name><surname>Kim</surname><given-names>S.</given-names></name><name><surname>Lee</surname><given-names>M.</given-names></name><name><surname>Lee</surname><given-names>Y.-W.</given-names></name><name><surname>Lee</surname><given-names>W. B.</given-names></name></person-group> (<year>2018</year>). <article-title>Driving conformational transitions in the feature space of autoencoder neural network</article-title>. <source>J. Phys. Chem. C</source>
<volume>122</volume>, <fpage>23224</fpage>–<lpage>23229</lpage>. <pub-id pub-id-type="doi">10.1021/acs.jpcc.8b08496</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spiwok</surname><given-names>V.</given-names></name><name><surname>Hošek</surname><given-names>P.</given-names></name><name><surname>Šućur</surname><given-names>Z.</given-names></name></person-group> (<year>2015a</year>). <article-title>Enhanced sampling techniques in biomolecular simulations</article-title>. <source>Biotech. Adv.</source>
<volume>6</volume>(<issue>pt 2</issue>), <fpage>1130</fpage>–<lpage>1140</lpage>. <pub-id pub-id-type="doi">10.1016/j.biotechadv.2014.11.011</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spiwok</surname><given-names>V.</given-names></name><name><surname>Králová</surname><given-names>B.</given-names></name></person-group> (<year>2011</year>). <article-title>Metadynamics in the conformational space nonlinearly dimensionally reduced by Isomap</article-title>. <source>J. Chem. Phys.</source>
<volume>135</volume>:<fpage>224504</fpage>. <pub-id pub-id-type="doi">10.1063/1.3660208</pub-id><?supplied-pmid 22168700?><pub-id pub-id-type="pmid">22168700</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spiwok</surname><given-names>V.</given-names></name><name><surname>Oborský</surname><given-names>P.</given-names></name><name><surname>Pazúriková</surname><given-names>J.</given-names></name><name><surname>Krenek</surname><given-names>A.</given-names></name><name><surname>Králová</surname><given-names>B.</given-names></name></person-group> (<year>2015b</year>). <article-title>Nonlinear vs. linear biasing in Trp-cage folding simulations</article-title>. <source>J. Chem. Phys.</source>
<volume>142</volume>:<fpage>115101</fpage>. <pub-id pub-id-type="doi">10.1063/1.4914828</pub-id><?supplied-pmid 25796266?><pub-id pub-id-type="pmid">25796266</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sridharan</surname><given-names>S.</given-names></name><name><surname>Nicholls</surname><given-names>A.</given-names></name><name><surname>Sharp</surname><given-names>K. A.</given-names></name></person-group> (<year>1995</year>). <article-title>A rapid method for calculating derivatives of solvent accessible surface areas of molecules</article-title>. <source>J. Comput. Chem.</source>
<volume>16</volume>, <fpage>1038</fpage>–<lpage>1044</lpage>. <pub-id pub-id-type="doi">10.1002/jcc.540160810</pub-id></mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sultan</surname><given-names>M. M.</given-names></name><name><surname>Pande</surname><given-names>V. S.</given-names></name></person-group> (<year>2018</year>). <article-title>Automated design of collective variables using supervised machine learning</article-title>. <source>J. Chem. Phys.</source>
<volume>149</volume>:<fpage>094106</fpage>. <pub-id pub-id-type="doi">10.1063/1.5029972</pub-id><?supplied-pmid 30195289?><pub-id pub-id-type="pmid">30195289</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tenenbaum</surname><given-names>J. B.</given-names></name><name><surname>de Silva</surname><given-names>V.</given-names></name><name><surname>Langford</surname><given-names>J. C.</given-names></name></person-group> (<year>2000</year>). <article-title>A global geometric framework for nonlinear dimensionality reduction</article-title>. <source>Science</source>
<volume>290</volume>, <fpage>2319</fpage>–<lpage>2323</lpage>. <pub-id pub-id-type="doi">10.1126/science.290.5500.2319</pub-id><?supplied-pmid 11125149?><pub-id pub-id-type="pmid">11125149</pub-id></mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Torrie</surname><given-names>G. M.</given-names></name><name><surname>Valleau</surname><given-names>J. P.</given-names></name></person-group> (<year>1977</year>). <article-title>Nonphysical sampling distributions in monte carlo free-energy estimation: umbrella sampling</article-title>. <source>J. Comput. Phys.</source>
<volume>23</volume>, <fpage>187</fpage>–<lpage>199</lpage>. <pub-id pub-id-type="doi">10.1016/0021-9991(77)90121-8</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tribello</surname><given-names>G. A.</given-names></name><name><surname>Bonomi</surname><given-names>M.</given-names></name><name><surname>Branduardi</surname><given-names>D.</given-names></name><name><surname>Camilloni</surname><given-names>C.</given-names></name><name><surname>Bussi</surname><given-names>G.</given-names></name></person-group> (<year>2014</year>). <article-title>PLUMED 2: new feathers for an old bird</article-title>. <source>Comput. Phys. Commun.</source>
<volume>185</volume>, <fpage>604</fpage>–<lpage>613</lpage>. <pub-id pub-id-type="doi">10.1016/j.cpc.2013.09.018</pub-id></mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>J.</given-names></name><name><surname>Wolf</surname><given-names>R. M.</given-names></name><name><surname>Caldwell</surname><given-names>J. W.</given-names></name><name><surname>Kollman</surname><given-names>P. A.</given-names></name><name><surname>Case</surname><given-names>D. A.</given-names></name></person-group> (<year>2004</year>). <article-title>Development and testing of a general amber force field</article-title>. <source>J. Comput. Chem.</source>
<volume>25</volume>, <fpage>1157</fpage>–<lpage>1174</lpage>. <pub-id pub-id-type="doi">10.1002/jcc.20035</pub-id><?supplied-pmid 15116359?><pub-id pub-id-type="pmid">15116359</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wehmeyer</surname><given-names>C.</given-names></name><name><surname>Noé</surname><given-names>F.</given-names></name></person-group> (<year>2018</year>). <article-title>Time-lagged autoencoders: deep learning of slow collective variables for molecular kinetics</article-title>. <source>J. Chem. Phys.</source>
<volume>148</volume>:<fpage>241703</fpage>. <pub-id pub-id-type="doi">10.1063/1.5011399</pub-id><?supplied-pmid 29960344?><pub-id pub-id-type="pmid">29960344</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
