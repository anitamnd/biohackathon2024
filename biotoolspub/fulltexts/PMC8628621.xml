<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PeerJ</journal-id>
    <journal-id journal-id-type="iso-abbrev">PeerJ</journal-id>
    <journal-id journal-id-type="publisher-id">peerj</journal-id>
    <journal-title-group>
      <journal-title>PeerJ</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2167-8359</issn>
    <publisher>
      <publisher-name>PeerJ Inc.</publisher-name>
      <publisher-loc>San Diego, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8628621</article-id>
    <article-id pub-id-type="publisher-id">12450</article-id>
    <article-id pub-id-type="doi">10.7717/peerj.12450</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Computational Biology</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Evolutionary Studies</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><monospace>treedata.table</monospace>: a wrapper for <monospace>data.table</monospace> that enables fast manipulation of large phylogenetic trees matched to data</article-title>
    </title-group>
    <contrib-group>
      <contrib id="author-1" contrib-type="author" corresp="yes">
        <name>
          <surname>Román Palacios</surname>
          <given-names>Cristian</given-names>
        </name>
        <email>cromanpa@g.ucla.edu</email>
        <email>cromanpa94@arizona.edu</email>
        <xref rid="aff-1" ref-type="aff">1</xref>
        <xref rid="aff-2" ref-type="aff">2</xref>
      </contrib>
      <contrib id="author-2" contrib-type="author">
        <name>
          <surname>Wright</surname>
          <given-names>April</given-names>
        </name>
        <xref rid="aff-3" ref-type="aff">3</xref>
      </contrib>
      <contrib id="author-3" contrib-type="author">
        <name>
          <surname>Uyeda</surname>
          <given-names>Josef</given-names>
        </name>
        <xref rid="aff-4" ref-type="aff">4</xref>
      </contrib>
      <aff id="aff-1"><label>1</label><institution>Department of Atmospheric and Oceanic Sciences; Department of Earth, Planetary, and Space Sciences, Institute of the Environment and Sustainability; Center for Diverse Leadership in Science, University of California, Los Angeles</institution>, <city>Los Angeles</city>, <state>CA</state>, <country>United States of America</country></aff>
      <aff id="aff-2"><label>2</label><institution>School of Information, University of Arizona</institution>, <city>Tucson</city>, <state>AZ</state>, <country>United States of America</country></aff>
      <aff id="aff-3"><label>3</label><institution>Biology Department, Southeastern Louisiana University</institution>, <city>Hammond</city>, <state>LA</state>, <country>United States of America</country></aff>
      <aff id="aff-4"><label>4</label><institution>Department of Biological Sciences, Virginia Polytechnic Institute and State University (Virginia Tech)</institution>, <city> Blacksburg</city>, <state>VA</state>, <country>United States of America</country></aff>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Gillespie</surname>
          <given-names>Joseph</given-names>
        </name>
      </contrib>
    </contrib-group>
    <pub-date pub-type="epub" date-type="pub" iso-8601-date="2021-11-26">
      <day>26</day>
      <month>11</month>
      <year iso-8601-date="2021">2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>e12450</elocation-id>
    <history>
      <date date-type="received" iso-8601-date="2021-07-27">
        <day>27</day>
        <month>7</month>
        <year iso-8601-date="2021">2021</year>
      </date>
      <date date-type="accepted" iso-8601-date="2021-10-18">
        <day>18</day>
        <month>10</month>
        <year iso-8601-date="2021">2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>©2021 Román Palacios et al.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Román Palacios et al.</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, reproduction and adaptation in any medium and for any purpose provided that it is properly attributed. For attribution, the original author(s), title, publication source (PeerJ) and either DOI or URL of the article must be cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="https://peerj.com/articles/12450"/>
    <abstract>
      <p>The number of terminals in phylogenetic trees has significantly increased over the last decade. This trend reflects recent advances in next-generation sequencing, accessibility of public data repositories, and the increased use of phylogenies in many fields. Despite <monospace>R</monospace> being central to the analysis of phylogenetic data, manipulation of phylogenetic comparative datasets remains slow, complex, and poorly reproducible. Here, we describe the first <monospace>R</monospace> package extending the functionality and syntax of <monospace>data.table</monospace> to explicitly deal with phylogenetic comparative datasets. <monospace>treedata.table</monospace> significantly increases speed and reproducibility during the data manipulation steps involved in the phylogenetic comparative workflow in <monospace>R</monospace>. The latest release of <monospace>treedata.table</monospace> is currently available through <monospace>CRAN</monospace> (<ext-link xlink:href="https://cran.r-project.org/web/packages/treedata.table/" ext-link-type="uri">https://cran.r-project.org/web/packages/treedata.table/</ext-link>). Additional documentation can be accessed through rOpenSci (<ext-link xlink:href="https://ropensci.github.io/treedata.table/" ext-link-type="uri">https://ropensci.github.io/treedata.table/</ext-link>).</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>Data.table</kwd>
      <kwd>Evolution</kwd>
      <kwd>Phylogenetics</kwd>
      <kwd>Phylogenetic comparative analyses</kwd>
      <kwd>R Package</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source> Nantucket Phylogeny DevelopeR Workshop</funding-source>
        <award-id> NSF DBI-1759940</award-id>
      </award-group>
      <award-group id="fund-2">
        <funding-source> National Institute of General Medical Sciences of the National Institutes of Health</funding-source>
        <award-id> P2O GM103424-18</award-id>
      </award-group>
      <award-group id="fund-3">
        <funding-source> NSF</funding-source>
        <award-id> DEB-1208912</award-id>
      </award-group>
      <funding-statement>This package was partially developed during the “Nantucket phylogeny developeR workshop”, organized by Liam J. Revell (NSF DBI-1759940). April Wright was supported by an Institutional Development Award (IDeA) from the National Institute of General Medical Sciences of the National Institutes of Health under grant number P2O GM103424-18. Josef Uyeda was funded on NSF DEB-1208912 to Luke Harmon in creating <monospace>treeplyr</monospace>, which served as a precursor for this project and code. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>The number and size of published phylogenetic trees have exponentially increased over the years (<xref rid="fig-1" ref-type="fig">Fig. 1</xref>; <xref rid="ref-15" ref-type="bibr">Smith et al., 2011</xref>; <xref rid="ref-3" ref-type="bibr">Fitzjohn et al., 2014</xref>; <xref rid="ref-16" ref-type="bibr">Smith &amp; Brown, 2018</xref>). Ongoing biodiversity sequencing efforts have triggered the development of phylogenetic computational methods able to deal with datasets involving hundreds of thousands of taxa (<xref rid="ref-7" ref-type="bibr">McMahon et al., 2015</xref>). For instance, the early development of MAFFT (<xref rid="ref-6" ref-type="bibr">Katoh, 2002</xref>) significantly decreased computational times required to perform sequence alignment on molecular datasets with thousands of species. Similarly, RAxML (<xref rid="ref-18" ref-type="bibr">Stamatakis, 2006</xref>), <monospace>PATHd8</monospace> (<xref rid="ref-19" ref-type="bibr">Tamura et al., 2012</xref>), and <monospace>TreePL</monospace> (<xref rid="ref-17" ref-type="bibr">Smith &amp; O’Meara, 2012</xref>) greatly reduced computational times during the inference and absolute dating of phylogenetic trees including thousands of species. Given the unprecedented pace at which phylogenetic data is accumulating (<xref rid="ref-12" ref-type="bibr">Piel et al., 2000</xref>; <xref rid="ref-13" ref-type="bibr">Redelings &amp; Holder, 2017</xref>), updating the current comparative phylogenetic workflow to cope with the increasing size of phylogenetic trees is now more critical than ever. Attention should be paid to the development of faster, computationally efficient, and more user-friendly implementations in <monospace>R</monospace> that further increase reproducibility. The <monospace>R</monospace> language (<xref rid="ref-20" ref-type="bibr">R Core Team, 2013</xref>) is now central to research utilizing phylogenetic comparative methods, and many essential packages and educational materials are made available using this language (<xref rid="ref-4" ref-type="bibr">Harmon, 2019</xref>). The latest release of <monospace>treedata.table</monospace> is available through <monospace>CRAN</monospace> (<ext-link xlink:href="https://cran.r-project.org/web/packages/treedata.table/" ext-link-type="uri">https://cran.r-project.org/web/packages/treedata.table/</ext-link>). More information about the <monospace>treedata.table</monospace>
<monospace>R</monospace> package can be found in rOpenSci (<ext-link xlink:href="https://ropensci.github.io/treedata.table/" ext-link-type="uri">https://ropensci.github.io/treedata.table/</ext-link>).</p>
    <fig position="float" id="fig-1">
      <object-id pub-id-type="doi">10.7717/peerj.12450/fig-1</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Temporal change in phylogenetic tree sizes between 1978 and 2020 based on 927 publications for different animal and plant groups.</title>
        <p>We used a LOESS smoothing to depict the temporal trend in tree size over time. Data was retrieved from the Open Tree of Life (<xref rid="ref-14" ref-type="bibr">Redelings et al., 2019</xref>) using the rotl <monospace>R</monospace> package (<xref rid="ref-9" ref-type="bibr">Michonneau, Brown &amp; Winter, 2016</xref>). A linear regression that accounted for lineage identity indicated the significant increase in tree size over time (<italic toggle="yes">R</italic><sup>2</sup> = 0.2077, <italic toggle="yes">p</italic> &lt; 0.001).</p>
      </caption>
      <graphic xlink:href="peerj-09-12450-g001" position="float"/>
    </fig>
    <sec>
      <title>A short description of <monospace>data.table</monospace></title>
      <p><monospace>treedata.table</monospace> heavily relies on <monospace>data.table</monospace>, an R package that enables high-performance extended functionality for data tables (<xref rid="ref-2" ref-type="bibr">Dowle &amp; Srinivasan, 2019</xref>). <monospace>data.table</monospace> is not only faster than other packages implemented in R, but also is significantly more efficient than tools in other languages such as <monospace>Python</monospace> and <monospace>Julia</monospace> (<xref rid="ref-1" ref-type="bibr">db-benchmark project, 2021</xref>). In addition to speed, <monospace>data.table</monospace> has a syntactic structure that is clear and simple to follow. Only three elements are basic to <monospace>data.table</monospace>’s primary function: <monospace>DT[i, j, by]</monospace>. First, the <italic toggle="yes"><monospace>i</monospace></italic> section is used to specify the rows to be considered in filtering or subsetting operations. Second, the <italic toggle="yes"><monospace>j</monospace></italic> section indicates the changes happening in the columns (<italic toggle="yes">e.g.</italic>, adding new ones, changing existing ones). Third, the <monospace>by</monospace> section is used to perform operations based on grouping variables. A brief but more exhaustive introduction to <monospace>data.table</monospace> can be found in the <monospace>data.table</monospace>’s vignette and wiki.</p>
      <p>Data manipulation can be performed through numerous approaches in <monospace>R</monospace>. Each of these alternatives have their own particular advantages. For instance, packages in the <monospace>tidyverse</monospace> (<italic toggle="yes">e.g.</italic>, <monospace>dplyr</monospace>) are in general designed to increase readability and flexibility during data munging steps (<xref rid="ref-22" ref-type="bibr">Wickham et al., 2019a</xref>; <xref rid="ref-23" ref-type="bibr">Wickham et al., 2019b</xref>). Data wrangling in <monospace>base R</monospace> is largely standard and in general more stable over time than other approaches. Here, we focus on extending the functionality of <monospace>data.table</monospace>, a package that is generally faster and more concise than other approaches, for dealing with phylogenetic comparative datasets.</p>
    </sec>
    <sec>
      <title>The <monospace>treedata.table</monospace> workflow</title>
      <p><monospace>treedata.table</monospace> is a wrapper for <monospace>data.table</monospace> designed for phylogenetic analyses that matches a phylogeny to a <monospace>data.table</monospace> (<xref rid="table-1" ref-type="table">Table 1</xref>). After an initial tree/data matching step, <monospace>treedata.table</monospace> continuously preserves the tree/data matching across <monospace>data.table</monospace> operations. <monospace>treedata.table</monospace> also allows users to run functions from other phylogenetic packages on the processed <monospace>treedata.table</monospace> objects. Below, we briefly explain the general workflow under <monospace>treedata.table</monospace>.</p>
      <table-wrap position="float" id="table-1">
        <object-id pub-id-type="doi">10.7717/peerj.12450/table-1</object-id>
        <label>Table 1</label>
        <caption>
          <title>Brief descriptions of the functions implemented in <monospace>treedata.table</monospace>.</title>
          <p>We list functions under eight different categories and provide a brief outline of their main uses.</p>
        </caption>
        <alternatives>
          <graphic xlink:href="peerj-09-12450-g004" position="float"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Category</th>
                <th rowspan="1" colspan="1">Function</th>
                <th rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1"><monospace>treedata.table</monospace> object creation</td>
                <td rowspan="1" colspan="1">
                  <monospace>as.treedata.table</monospace>
                </td>
                <td rowspan="1" colspan="1">Initial step of the workflow in <monospace>treedata.table</monospace>. Matches a character matrix (of class <monospace>data.frame</monospace>) to a single (of class <monospace>phylo</monospace>) or multiple trees (class <monospace>multiPhylo</monospace>)</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Drop taxa from <monospace>treedata.table</monospace> objects</td>
                <td rowspan="1" colspan="1">
                  <monospace>droptreedata.table</monospace>
                </td>
                <td rowspan="1" colspan="1">Drops taxa from a <monospace>treedata.table</monospace> object</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Data manipulation</td>
                <td rowspan="1" colspan="1">[</td>
                <td rowspan="1" colspan="1">Performs <monospace>data.table</monospace> operations on an object of class <monospace>treedata.table</monospace></td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Data extraction</td>
                <td rowspan="1" colspan="1">[[</td>
                <td rowspan="1" colspan="1">Extracts a named vector from an object of class <monospace>treedata.table</monospace></td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1">
                  <monospace>extractVector</monospace>
                </td>
                <td rowspan="1" colspan="1">Returns a named vector from a <monospace>treedata.table</monospace> object</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1">
                  <monospace>pulltreedata.table</monospace>
                </td>
                <td rowspan="1" colspan="1">Returns a character matrix or tree(s) from a <monospace>treedata.table</monospace> object</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Run functions from other packages</td>
                <td rowspan="1" colspan="1">
                  <monospace>tdt</monospace>
                </td>
                <td rowspan="1" colspan="1">Runs a function on a <monospace>treedata.table</monospace> object</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Detect character type</td>
                <td rowspan="1" colspan="1">
                  <monospace>detectCharacterType</monospace>
                </td>
                <td rowspan="1" colspan="1">Detects whether a character is continuous or discrete</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1">
                  <monospace>detectAllCharacters</monospace>
                </td>
                <td rowspan="1" colspan="1">Applies <monospace>detectCharacterType</monospace> over an entire character matrix</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1">filterMatrix</td>
                <td rowspan="1" colspan="1">Filters a matrix, returning either all continuous or all discrete characters</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Examine <monospace>treedata.table</monospace> objects</td>
                <td rowspan="1" colspan="1">
                  <monospace>summary</monospace>
                </td>
                <td rowspan="1" colspan="1">Summarizes <monospace>treedata.table</monospace> objects by presenting the number of discrete and continious characters, missing values, and general changes to the original <monospace>treedata.table</monospace> object</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1">
                  <monospace>print</monospace>
                </td>
                <td rowspan="1" colspan="1">Print method <monospace>treedata.table</monospace> objects</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1">
                  <monospace>head, tail</monospace>
                </td>
                <td rowspan="1" colspan="1">Returns the first or last part of an <monospace>treedata.table</monospace> object</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Inspect column/row names</td>
                <td rowspan="1" colspan="1">
                  <monospace>hasNames</monospace>
                </td>
                <td rowspan="1" colspan="1">Row and column name check</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1">
                  <monospace>forceNames</monospace>
                </td>
                <td rowspan="1" colspan="1">Force names for rows, columns or both</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>(1) <bold>Tree and character matrix matching:</bold> Using the <monospace>treedata.table</monospace> package begins with creating a <monospace>treedata.table</monospace> object. as.<monospace>treedata.table</monospace> function matches the <monospace>tip.labels</monospace> of the phylogeny to a column of names in the <monospace>data.frame</monospace>.</p>
      <p>(2) <bold><monospace>treedata.table</monospace></bold>
<bold>operations:</bold> two main functions allow users to make changes to <monospace>treedata.table</monospace> objects. Changes are reciprocal between trees and data.</p>
      <list list-type="simple" id="list-1">
        <list-item>
          <label> (A)</label>
          <p><bold>Explicitly dropping taxa:</bold> Taxa in <monospace>treedata.table</monospace> objects can be dropped using the <monospace>droptreedata.table</monospace> function. Dropped taxa results are removed from the character matrix and trees.</p>
        </list-item>
        <list-item>
          <label> (B)</label>
          <p><bold>Data operations:</bold> The most powerful functionality of <monospace>treedata.table</monospace> is related to functions calling <monospace>data.table</monospace>. The [ function, taking the same arguments as the analog function in <monospace>data.table</monospace>, can be used to subset rows, select, and/or compute statistics on columns in the character matrix of the <monospace>treedata.table</monospace> object (<monospace>DT[i, j,</monospace> by]). Operations changing the number of rows in the character matrix will also affect the corresponding taxa in the tree.</p>
        </list-item>
      </list>
      <p>(3) <bold>Data extraction from</bold>
<bold><monospace>treedata.table</monospace></bold>
<bold>objects:</bold> Users can independently extract trees and character matrices from <monospace>treedata.table</monospace> objects using the <monospace>pulltreedata.table</monospace> function. The $ operator is also a valid alternative to <monospace>pulltreedata.table</monospace>. Two additional functions ([[ and <monospace>extractVectors</monospace>) can be used to extract named vectors from <monospace>treedata.table</monospace> objects. These operations streamline formatting of data into the various different input requirements of R functions from other phylogenetics packages.</p>
      <p>(4) <bold>Using external functions in</bold>
<bold><monospace>treedata.table</monospace></bold>
<bold>objects:</bold> the <monospace>tdt</monospace> function enables users to easily run external functions on <monospace>treedata.table</monospace> objects directly. Specifically, <monospace>tdt</monospace> passes data and tree attributes from a given <monospace>treedata.table</monospace> object as arguments to functions implemented in other packages.</p>
      <p>(5) <bold>Additional functions</bold>: treedata.tree includes additional functions to detect and filter character matrices by character types (continuous or discrete; <monospace>detectCharacterType, detectAllCharacters</monospace>, and <monospace>filterMatrix</monospace>). Other functions can be used to examine (<monospace>head, tail, print</monospace>) and describe (<monospace>summary</monospace>) objects of class <monospace>treedata.table</monospace>. Finally, two additional functions can be used to inspect and force column and row names in character matrices (<monospace>hasNames, forceNames</monospace>).</p>
    </sec>
    <sec>
      <title>Using <monospace>treedata.table</monospace></title>
      <p>This brief step-by-step tutorial is based on <monospace>treeplyr</monospace>’s <italic toggle="yes">Anolis</italic> example data, including 100 tips and 11 characters (see also <xref rid="supp-1" ref-type="supplementary-material">Appendices S1</xref>–<xref rid="supp-2" ref-type="supplementary-material">S2</xref>):</p>
      <p>
        <monospace>library(treedata.table)</monospace>
      </p>
      <p>
        <monospace>data(anolis)</monospace>
      </p>
      <p>To use all the functionalities in <monospace>treedata.table</monospace>, we first construct a <monospace>treedata.table</monospace> object using the <monospace>as.treedata.table</monospace> function, which performs an exact name match between the tip labels of the tree and the column in the dataset with the most matches.</p>
      <p>
        <monospace>td &lt;- as.<monospace>treedata.table</monospace> (tree = anolis$phy, data = anolis$dat)</monospace>
      </p>
      <p>The resulting object can be inspected using the <monospace>summary(), head(), tail()</monospace>, and <monospace>print()</monospace> functions. For instance, we can see a description of the <monospace>treedata.tree</monospace> object using the <monospace>summary()</monospace> function:</p>
      <p>
        <monospace>summary(td)</monospace>
      </p>
      <p>Next, we can perform data manipulation steps on the resulting <monospace>treedata.table</monospace> object. For instance, we can extract the SVL column (snout-vent length) using the $ function and [ operator, as follows:</p>
      <p>
        <monospace>td$dat[,’SVL’]</monospace>
      </p>
      <p>A named vector of the same trait (SVL) can also be extracted using <monospace>td[[”SVL”]]</monospace> or <monospace>extractVector(td, ’SVL’)</monospace>. However, <monospace>extractVector</monospace> further supports extraction of multiple traits. For instance, the following code will extract two named vectors: one for SVL and another for ecomorph.</p>
      <p>
        <monospace>extractVector(td, ’SVL’,’ecomorph’)</monospace>
      </p>
      <p>The real power in <monospace>treedata.table</monospace> is in co-indexing the tree and table based on functions from <monospace>data.table</monospace>. We can use <monospace>data.table</monospace> syntax to subset the <monospace>treedata.table</monospace> object and include only the first representative from each ecomorph in the <italic toggle="yes">Anolis</italic> dataset.</p>
      <p>
        <monospace>td[, head(.SD, 1), by = ”ecomorph”]</monospace>
      </p>
      <p>We can also subset the <italic toggle="yes">Anolis</italic> dataset to include a single species per ecomorph and island:</p>
      <p>
        <monospace>td[, head(.SD, 1), by = .(ecomorph, island)]</monospace>
      </p>
      <p>Furthermore, we can create a new variable summarizing SVL+hostility for only Cuban anoles:</p>
      <p>
        <monospace>td[island == ”Cuba”, .(Index = SVL + hostility)]</monospace>
      </p>
      <p>While the options for data manipulations are infinite, the matching between the tree and data attributes is always constant. Finally, users can pass data and trees in <monospace>treedata.table</monospace> objects as arguments to functions in other packages. For instance, below we use the <monospace>tdt</monospace> function in <monospace>treedata.table</monospace> to fit a continuous model of trait evolution for SVL in <monospace>geiger</monospace> (<xref rid="ref-5" ref-type="bibr">Harmon et al., 2008</xref>; <xref rid="ref-11" ref-type="bibr">Pennell et al., 2014</xref>):</p>
      <p>
        <monospace>tdt(td, fitContinuous(phy, extractVector(td, ’SVL’), model=”BM”))</monospace>
      </p>
      <p>All the functions explained above can handle multiple trees. For instance, below we fit the same model of continuous trait evolution on SVL based on a <monospace>multiPhylo</monospace> tree for the <italic toggle="yes">Anolis</italic> dataset:</p>
      <p>
        <monospace>trees &lt;- list(anolis$phy,anolis$phy)</monospace>
      </p>
      <p>
        <monospace>class(trees) &lt;- “multiPhylo”</monospace>
      </p>
      <p>
        <monospace>td &lt;- as.<monospace>treedata.table</monospace> (tree=trees, data=anolis$dat)</monospace>
      </p>
      <p>
        <monospace>tdt(td, fitContinuous(phy, extractVector(td, ‘SVL’), model=”BM”))</monospace>
      </p>
      <p>The introductory vignette to <monospace>treedata.table</monospace> (<ext-link xlink:href="https://ropensci.github.io/treedata.table/articles/AA_treedata.table_intro_english.html" ext-link-type="uri">https://ropensci.github.io/treedata.table/articles/AA_treedata.table_intro_english.html</ext-link>, <ext-link xlink:href="https://ropensci.github.io/treedata.table/articles/AB_treedata.table_intro_spanish.html" ext-link-type="uri">https://ropensci.github.io/treedata.table/articles/AB_treedata.table_intro_spanish.html</ext-link>) contains further information on the functions outlined above and in <xref rid="table-1" ref-type="table">Table 1</xref>.</p>
    </sec>
    <sec>
      <title>Computational performance</title>
      <sec>
        <title>Alternatives to <monospace>treedata.table</monospace></title>
        <p>Keeping trees and data objects separated in the R environment is a standard practice. Changes to trees and data are typically performed independently using a combination of functions implemented in <monospace>ape</monospace> (<xref rid="ref-10" ref-type="bibr">Paradis &amp; Schliep, 2018</xref>), <monospace>base</monospace> (<xref rid="ref-20" ref-type="bibr">R Core Team, 2013</xref>), <monospace>data.table</monospace> (<xref rid="ref-2" ref-type="bibr">Dowle &amp; Srinivasan, 2019</xref>), or in the <monospace>tidyverse</monospace> (<xref rid="ref-22" ref-type="bibr">Wickham et al., 2019a</xref>; <xref rid="ref-23" ref-type="bibr">Wickham et al., 2019b</xref>). However, to our knowledge, <monospace>treeplyr</monospace> (<xref rid="ref-21" ref-type="bibr">Uyeda &amp; Harmon, 2020</xref>) and <monospace>tidytree</monospace> (<xref rid="ref-24" ref-type="bibr">Yu, 2021</xref>), both based on <monospace>dplyr</monospace> (<xref rid="ref-22" ref-type="bibr">Wickham et al., 2019a</xref>; <xref rid="ref-23" ref-type="bibr">Wickham et al., 2019b</xref>), are to our knowledge, the only packages that are able to perform simultaneous operations on combined tree/data objects in R (<xref rid="table-2" ref-type="table">Table 2</xref>). We note that while <monospace>data.table, treeplyr</monospace>, and <monospace>dplyr</monospace> share similar functionalities, their philosophy and syntax are strikingly different. Differences between these packages ultimately relate to “source” package they rely on (<italic toggle="yes">i.e.</italic>, <monospace>data.table</monospace> or <monospace>dplyr</monospace>). For instance, although <monospace>data.table</monospace> uses shorter syntax relative to <monospace>dplyr</monospace>, the pipe operator and the use of verbs in <monospace>dplyr</monospace> makes this later package more intuitive and easier to debug. Therefore, although our package <monospace>treedata.table</monospace> only extends the functionality of <monospace>data.table</monospace> s into the phylogenetic comparative workflow, this largely unexplored framework in the field will enable users to take advantage the speed and syntax of that is inherent to <monospace>data.table</monospace>.</p>
        <table-wrap position="float" id="table-2">
          <object-id pub-id-type="doi">10.7717/peerj.12450/table-2</object-id>
          <label>Table 2</label>
          <caption>
            <title>Functions in different R packages (including <monospace>treedata.table</monospace>) with similar functions on matched tree/data objects.</title>
          </caption>
          <alternatives>
            <graphic xlink:href="peerj-09-12450-g005" position="float"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th rowspan="1" colspan="1">Package</th>
                  <th rowspan="1" colspan="1">Function</th>
                  <th rowspan="1" colspan="1">Tree/data-matched object manipulation</th>
                  <th rowspan="1" colspan="1">Reference</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td rowspan="1" colspan="1">
                    <monospace>treedata.table</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <monospace>as.treedata.table</monospace>
                  </td>
                  <td rowspan="1" colspan="1"><monospace>data.table</monospace> syntax</td>
                  <td rowspan="1" colspan="1">This study</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <monospace>geiger</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <monospace>treedata</monospace>
                  </td>
                  <td rowspan="1" colspan="1">Not supported</td>
                  <td rowspan="1" colspan="1"><xref rid="ref-5" ref-type="bibr">Harmon et al. (2008)</xref>, <xref rid="ref-11" ref-type="bibr">Pennell et al. (2014)</xref></td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <monospace>tidytree</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <monospace>treedata</monospace>
                  </td>
                  <td rowspan="1" colspan="1"><monospace>dplyr</monospace> verbs after using <monospace>tibble::as_tibble()</monospace></td>
                  <td rowspan="1" colspan="1">
                    <xref rid="ref-24" ref-type="bibr">Yu (2021)</xref>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <monospace>treeplyr</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <monospace>make.treedata</monospace>
                  </td>
                  <td rowspan="1" colspan="1"><monospace>dplyr</monospace> verbs</td>
                  <td rowspan="1" colspan="1">
                    <xref rid="ref-21" ref-type="bibr">Uyeda &amp; Harmon (2020)</xref>
                  </td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
      </sec>
      <sec>
        <title>Methods</title>
        <p>We used the <monospace>microbenchmark</monospace> (<xref rid="ref-8" ref-type="bibr">Mersmann, 2019</xref>) function under default parameters to compare the performance of functions in <monospace>treedata.table</monospace> to other packages (<xref rid="supp-3" ref-type="supplementary-material">Appendix S3</xref>). First, we compared the performance in the initial tree/data matching step between <monospace>treedata.table</monospace> and <monospace>treeplyr</monospace> (<monospace>treedata.table</monospace>::as.<monospace>treedata.table</monospace> () and <monospace>treeplyr::make.treedata()</monospace>). We simulated trees with 10, 40, and 100 tips using rtree function in ape (<xref rid="ref-10" ref-type="bibr">Paradis &amp; Schliep, 2018</xref>). Additionally, we generated random character matrices (50 discrete and 50 continuous traits) matching 90% of tips in the tree. Second, we compared the performance of data operations in <monospace>treedata.table</monospace> relative to <monospace>data.table</monospace> (<xref rid="ref-2" ref-type="bibr">Dowle &amp; Srinivasan, 2019</xref>), <monospace>base</monospace> (<xref rid="ref-20" ref-type="bibr">R Core Team, 2013</xref>), <monospace>treeplyr</monospace> (<xref rid="ref-21" ref-type="bibr">Uyeda &amp; Harmon, 2020</xref>), and <monospace>dplyr</monospace> (<xref rid="ref-22" ref-type="bibr">Wickham et al., 2019a</xref>; <xref rid="ref-23" ref-type="bibr">Wickham et al., 2019b</xref>). This time, we simulated trees with 1000, 10000, and 500000 tips using the <monospace>rtree</monospace> function in <monospace>ape</monospace>. Again, we generated random character matrices (50 discrete and 50 continuous traits) matching 90% of tips in simulated trees. We compared the performance of <monospace>treedata.table</monospace>::[, <monospace>data.table</monospace>::[ <monospace>treeplyr</monospace>::%&gt;%, <monospace>dplyr</monospace>::%&gt;%, and the equivalent functions in base when (1) subsampling the full dataset for rows matching a single level in one discrete character, and (2) estimating the sum and mean of two continuous traits based on the groups of a second discrete character. In <monospace>data.table</monospace> syntax for this process would be:</p>
        <p>
          <monospace>td$dat[Disc1 == ”A”, .(sum(Cont2), mean(Cont3)), by = Disc10]</monospace>
        </p>
      </sec>
      <sec>
        <title>Results</title>
        <p><monospace>treedata.table</monospace> was &gt;400% faster than <monospace>treeplyr</monospace> during the initial data/tree matching step (<xref rid="fig-2" ref-type="fig">Fig. 2</xref>). For instance, combining a dataset with 10 tips to a character matrix of 40 traits (10% of unmatched tips), <monospace>as.treedata.table</monospace> takes an average of 12.314 ms (range = 8.100–27.479 ms) relative to the 64.198 ms that were needed in <monospace>treeplyr</monospace> (range = 48.407–166.328 ms). Differences in the performance between these two functions also scale with the number of taxa. Next, we examined the performance of data operations in <monospace>treedata.table</monospace> relative to <monospace>data.table, base</monospace>, <monospace>treeplyr</monospace>, and <monospace>dplyr</monospace> (<xref rid="fig-3" ref-type="fig">Fig. 3</xref>). We found that the simultaneous processing of phylogenetic trees in <monospace>treedata.table</monospace>’s compromised the speed of our package by 90% relative to <monospace>data.table</monospace>. However, data manipulation in <monospace>treedata.table</monospace> (which simultaneously processes phylogenies) is still significantly faster than in other commonly used packages for data manipulation only, such as <monospace>base</monospace> (&gt;35%), treeplyr (&gt;60%), and <monospace>dplyr</monospace> (&gt;90%). The higher speed performance of <monospace>treedata.table</monospace> relative to other functions also increases with the size of the dataset.</p>
        <fig position="float" id="fig-2">
          <object-id pub-id-type="doi">10.7717/peerj.12450/fig-2</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Results for the <monospace>treedata.table</monospace> microbenchmark during tree/data matching steps.</title>
            <p>Estimates of the timing during the tree/data matching steps under <monospace>treedata.table</monospace> are shown in relation to treeplyr. We show median and lower/upper quartiles times for the performance of each package.</p>
          </caption>
          <graphic xlink:href="peerj-09-12450-g002" position="float"/>
        </fig>
        <fig position="float" id="fig-3">
          <object-id pub-id-type="doi">10.7717/peerj.12450/fig-3</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Results for the <monospace>treedata.table</monospace> microbenchmark during data manipulation.</title>
            <p>We compare the performance of <monospace>treedata.table</monospace> against <monospace>data.table</monospace>, base, treeplyr, and dplyr. We show median and lower/upper quartiles times for the performance of each package.</p>
          </caption>
          <graphic xlink:href="peerj-09-12450-g003" position="float"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>Current limitations of <monospace>treedata.table</monospace></title>
      <p>The current release of <monospace>treedata.table</monospace> can handle <monospace>phylo</monospace> and <monospace>multiPhylo</monospace> objects. A single character matrix is shared across all the trees in the <monospace>treedata.table</monospace> object. Additionally, all the trees and the only character matrix in the same <monospace>treedata.table</monospace> object are forced to have the same tip-level sampling. We acknowledge that partial tree/data matching is desirable in some situations. For instance, users may be interested in performing analyses on trees that, despite having different tip-level sampling, partially overlap with a common character matrix. Similarly, users may be interested in using multiple character matrices instead of only one. Future releases of the <monospace>treedata.table</monospace> package will focus on relaxing some restrictions on the tree/data matching.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>Here we describe the first R package that extends the functionality and syntax of <monospace>data.table</monospace> for performing operations in phylogenetic comparative datasets. We also note that <monospace>treedata.table</monospace> significantly improves the speed of the analytical workflow when compared to alternative methods for manipulating phylogenetic comparative data. <monospace>treedata.table</monospace> is expected to increase code reproducibility while simplifying the complexity of scripts. Finally, data manipulation in <monospace>treedata.table</monospace>, which is significantly faster than in other commonly used packages, will allow researchers to quickly perform data manipulation on large datasets without requiring outstanding computational resources.</p>
  </sec>
  <sec sec-type="supplementary-material" id="supplemental-information">
    <title>Supplemental Information</title>
    <supplementary-material id="supp-1" position="float" content-type="local-data">
      <object-id pub-id-type="doi">10.7717/peerj.12450/supp-1</object-id>
      <label>Supplemental Information 1</label>
      <caption>
        <title>Getting started with the <monospace>treedata.table</monospace> package</title>
      </caption>
      <media xlink:href="peerj-09-12450-s001.rmd">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="supp-2" position="float" content-type="local-data">
      <object-id pub-id-type="doi">10.7717/peerj.12450/supp-2</object-id>
      <label>Supplemental Information 2</label>
      <caption>
        <title>Breve introducción al paquete <monospace>treedata.table</monospace></title>
        <p>Getting started with the <monospace>treedata.table</monospace> package in Spanish.</p>
      </caption>
      <media xlink:href="peerj-09-12450-s002.rmd">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="supp-3" position="float" content-type="local-data">
      <object-id pub-id-type="doi">10.7717/peerj.12450/supp-3</object-id>
      <label>Supplemental Information 3</label>
      <caption>
        <title>R script used to perform performance comparison between <monospace>treedata.table</monospace> and other methods</title>
      </caption>
      <media xlink:href="peerj-09-12450-s003.r">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="supp-4" position="float" content-type="local-data">
      <object-id pub-id-type="doi">10.7717/peerj.12450/supp-4</object-id>
      <label>Supplemental Information 4</label>
      <caption>
        <title>R script used to generate <xref rid="fig-1" ref-type="fig">Fig. 1</xref></title>
      </caption>
      <media xlink:href="peerj-09-12450-s004.r">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Luke Harmon for his contributions that laid the groundwork for the current package. The authors thank Hugo Gruson, Kari Norman, Julia Gustavsen, Luna L. Sanchéz, and Guangchuang Yu for helpful comments during review in rOpenSci and PeerJ. Heidi E. Steiner revised an early version of the manuscript and assisted with logo design.</p>
  </ack>
  <sec sec-type="additional-information">
    <title>Additional Information and Declarations</title>
    <fn-group content-type="competing-interests">
      <title>Competing Interests</title>
      <fn id="conflict-1" fn-type="COI-statement">
        <p>The authors declare there are no competing interests.</p>
      </fn>
    </fn-group>
    <fn-group content-type="author-contributions">
      <title>Author Contributions</title>
      <fn id="contribution-1" fn-type="con">
        <p><xref rid="author-1" ref-type="contrib">Cristian Román Palacios</xref>, <xref rid="author-2" ref-type="contrib">April Wright</xref> and <xref rid="author-3" ref-type="contrib">Josef Uyeda</xref> conceived and designed the experiments, performed the experiments, analyzed the data, prepared figures and/or tables, authored or reviewed drafts of the paper, and approved the final draft.</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Data Availability</title>
      <fn id="addinfo-1">
        <p>The following information was supplied regarding data availability:</p>
        <p>The <monospace>treedata.table</monospace> is available at <ext-link xlink:href="https://ropensci.github.io/treedata.table/index.html" ext-link-type="uri">https://ropensci.github.io/treedata.table/index.html</ext-link>.</p>
      </fn>
    </fn-group>
  </sec>
  <ref-list content-type="authoryear">
    <title>References</title>
    <ref id="ref-1">
      <label>db-benchmark project (2021)</label>
      <element-citation publication-type="data">
        <person-group person-group-type="author">
          <collab>db-benchmark project</collab>
        </person-group>
        <year iso-8601-date="2021">2021</year>
        <data-title>Database-like ops benchmark</data-title>
        <uri xlink:href="https://h2oai.github.io/db-benchmark/">https://h2oai.github.io/db-benchmark/</uri>
        <date-in-citation content-type="access-date" iso-8601-date="2021-09-13">13 September 2021</date-in-citation>
      </element-citation>
    </ref>
    <ref id="ref-2">
      <label>Dowle &amp; Srinivasan (2019)</label>
      <element-citation publication-type="data">
        <person-group person-group-type="author">
          <name>
            <surname>Dowle</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Srinivasan</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2019">2019</year>
        <data-title>data.table: extension of ‘data.frame’</data-title>
        <uri xlink:href="https://CRAN.R-project.org/package=data.table">https://CRAN.R-project.org/package=data.table</uri>
        <date-in-citation content-type="access-date" iso-8601-date="2020-08-26">26 August 2020</date-in-citation>
        <version designator="1.12.6">R package version 1.12.6</version>
      </element-citation>
    </ref>
    <ref id="ref-3">
      <label>Fitzjohn et al. (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fitzjohn</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Pennell</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Zanne</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Stevens</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Tank</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Cornwell</surname>
            <given-names>WK</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2014">2014</year>
        <article-title>How much of the world is woody?</article-title>
        <source>Journal of Ecology</source>
        <volume>102</volume>
        <fpage>1266</fpage>
        <lpage>1272</lpage>
        <pub-id pub-id-type="doi">10.1111/1365-2745.12260</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-4">
      <label>Harmon (2019)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Harmon</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2019">2019</year>
        <source>Phylogenetic comparative methods</source>
        <uri xlink:href="https://lukejharmon.github.io/pcm/pdf/phylogeneticComparativeMethods.pdf"> https://lukejharmon.github.io/pcm/pdf/phylogeneticComparativeMethods.pdf</uri>
      </element-citation>
    </ref>
    <ref id="ref-5">
      <label>Harmon et al. (2008)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harmon</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Weir</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Brock</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Glor</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Challenger</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2008">2008</year>
        <article-title>GEIGER: investigating evolutionary radiations</article-title>
        <source>Bioinformatics</source>
        <volume>24</volume>
        <issue>1</issue>
        <fpage>129</fpage>
        <lpage>131</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm538</pub-id>
        <pub-id pub-id-type="pmid">18006550</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-6">
      <label>Katoh (2002)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2002">2002</year>
        <article-title>MAFFT: a novel method for rapid multiple sequence alignment based on fast Fourier transform</article-title>
        <source>Nucleic Acids Research</source>
        <volume>30</volume>
        <fpage>3059</fpage>
        <lpage>3066</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkf436</pub-id>
        <pub-id pub-id-type="pmid">12136088</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-7">
      <label>McMahon et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McMahon</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Deepak</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fernández-Baca</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Boss</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sanderson</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2015">2015</year>
        <article-title>STBase: one million species trees for comparative biology</article-title>
        <source>PLOS ONE</source>
        <volume>10</volume>
        <issue>2</issue>
        <elocation-id>e0117987</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0117987</pub-id>
        <pub-id pub-id-type="pmid">25679219</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-8">
      <label>Mersmann (2019)</label>
      <element-citation publication-type="data">
        <person-group person-group-type="author">
          <name>
            <surname>Mersmann</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2019">2019</year>
        <data-title>microbenchmark: accurate timing functions</data-title>
        <version designator="1.4-7">R package version</version>
        <uri xlink:href="https://CRAN.R-project.org/package=microbenchmark">https://CRAN.R-project.org/package=microbenchmark</uri>
        <date-in-citation content-type="access-date" iso-8601-date="2020-08-26">26 August 2020</date-in-citation>
      </element-citation>
    </ref>
    <ref id="ref-9">
      <label>Michonneau, Brown &amp; Winter (2016)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Michonneau</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Winter</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2016">2016</year>
        <article-title>rotl: an r package to interact with the open tree of life data</article-title>
        <source>Methods in Ecology and Evolution</source>
        <volume>7</volume>
        <fpage>1476</fpage>
        <lpage>1481</lpage>
        <pub-id pub-id-type="doi">10.1111/2041-210X.12593</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-10">
      <label>Paradis &amp; Schliep (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paradis</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Schliep</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2018">2018</year>
        <article-title>ape 5.0: an environment for modern phylogenetics and evolutionary analyses in R</article-title>
        <source>Bioinformatics</source>
        <volume>35</volume>
        <fpage>526</fpage>
        <lpage>528</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty633</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-11">
      <label>Pennell et al. (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pennell</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Eastman</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Slater</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Uyeda</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>FitzJohn</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Alfaro</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Harmon</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2014">2014</year>
        <article-title>geiger v2.0: an expanded suite of methods for fitting macroevolutionary models to phylogenetic trees</article-title>
        <source>Bioinformatics</source>
        <volume>30</volume>
        <issue>15</issue>
        <fpage>2216</fpage>
        <lpage>2218</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu181</pub-id>
        <pub-id pub-id-type="pmid">24728855</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-12">
      <label>Piel et al. (2000)</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Piel</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Donoghue</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Sanderson</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Netherlands</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2000">2000</year>
        <article-title>TreeBASE: a database of phylogenetic information</article-title>
        <conf-name>Proceedings of the 2nd international workshop of species 2000</conf-name>
      </element-citation>
    </ref>
    <ref id="ref-13">
      <label>Redelings &amp; Holder (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Redelings</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Holder</surname>
            <given-names>MT</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2017">2017</year>
        <article-title>A supertree pipeline for summarizing phylogenetic and taxonomic information for millions of species</article-title>
        <source>PeerJ</source>
        <volume>5</volume>
        <elocation-id>e3058</elocation-id>
        <pub-id pub-id-type="doi">10.7717/peerj.3058</pub-id>
        <pub-id pub-id-type="pmid">28265520</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-14">
      <label>Redelings et al. (2019)</label>
      <element-citation publication-type="software">
        <person-group person-group-type="author">
          <name>
            <surname>Redelings</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sanchez Reyes</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>Cranston</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Allman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Holder</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>McTavish</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2019">2019</year>
        <version designator="12.3">Version 12.3</version>
        <data-title>Open tree of life synthetic tree. Zenodo</data-title>
        <pub-id pub-id-type="doi">10.5281/zenodo.3937741</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-15">
      <label>Smith et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Beaulieu</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Donoghue</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2011">2011</year>
        <article-title>Understanding angiosperm diversification using small and large phylogenetic trees</article-title>
        <source>American Journal of Botany</source>
        <volume>98</volume>
        <fpage>404</fpage>
        <lpage>414</lpage>
        <pub-id pub-id-type="doi">10.3732/ajb.1000481</pub-id>
        <pub-id pub-id-type="pmid">21613134</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-16">
      <label>Smith &amp; Brown (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>JW</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2018">2018</year>
        <article-title>Constructing a broadly inclusive seed plant phylogeny</article-title>
        <source>American Journal of Botany</source>
        <volume>105</volume>
        <fpage>302</fpage>
        <lpage>314</lpage>
        <pub-id pub-id-type="doi">10.1002/ajb2.1019</pub-id>
        <pub-id pub-id-type="pmid">29746720</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-17">
      <label>Smith &amp; O’Meara (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>O’Meara</surname>
            <given-names>BC</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2012">2012</year>
        <article-title>treePL: divergence time estimation using penalized likelihood for large phylogenies</article-title>
        <source>Bioinformatics</source>
        <volume>28</volume>
        <fpage>2689</fpage>
        <lpage>2690</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts492</pub-id>
        <pub-id pub-id-type="pmid">22908216</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-18">
      <label>Stamatakis (2006)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2006">2006</year>
        <article-title>RAxML-VI-HPC: maximum likelihood-based phylogenetic analyses with thousands of taxa and mixed models</article-title>
        <source>Bioinformatics</source>
        <volume>22</volume>
        <fpage>2688</fpage>
        <lpage>2690</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl446</pub-id>
        <pub-id pub-id-type="pmid">16928733</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-19">
      <label>Tamura et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tamura</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Battistuzzi</surname>
            <given-names>FU</given-names>
          </name>
          <name>
            <surname>Billing-Ross</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Murillo</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Filipski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2012">2012</year>
        <article-title>Estimating divergence times in large molecular phylogenies</article-title>
        <source>Proceedings of the National Academy of Sciences of the United States of America</source>
        <volume>109</volume>
        <fpage>19333</fpage>
        <lpage>19338</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1213199109</pub-id>
        <pub-id pub-id-type="pmid">23129628</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-20">
      <label>R Core Team (2013)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>R Core Team</collab>
        </person-group>
        <year iso-8601-date="2013">2013</year>
        <data-title>R: a language and environment for statistical computing</data-title>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
        <publisher-loc>Vienna</publisher-loc>
        <uri xlink:href="http://www.r-project.org/">http://www.r-project.org/</uri>
        <date-in-citation content-type="access-date" iso-8601-date="2020-08-26">26 August 2020</date-in-citation>
      </element-citation>
    </ref>
    <ref id="ref-21">
      <label>Uyeda &amp; Harmon (2020)</label>
      <element-citation publication-type="data">
        <person-group person-group-type="author">
          <name>
            <surname>Uyeda</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Harmon</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2020">2020</year>
        <data-title>treeplyr: ’dplyr’ functionality for matched tree and data objects</data-title>
        <version designator="0.1.9">R package version 0.1.9. GitHub</version>
        <uri xlink:href="https://github.com/uyedaj/treeplyr">https://github.com/uyedaj/treeplyr</uri>
        <date-in-citation content-type="access-date" iso-8601-date="2020-08-26">26 August 2020</date-in-citation>
      </element-citation>
    </ref>
    <ref id="ref-22">
      <label>Wickham et al. (2019a)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Averick</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bryan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>D’Agostino</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Grolemund</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Henry</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hester</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kuhn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pedersen</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bache</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ooms</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Seidel</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Spinu</surname>
            <given-names>Vitalie</given-names>
          </name>
          <name>
            <surname>Takahashi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Vaughan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wilke</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Woo</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Yutani</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2019">2019a</year>
        <article-title>Welcome to the tidyverse</article-title>
        <source>Journal of Open Source Software</source>
        <volume>4</volume>
        <fpage>1686</fpage>
      </element-citation>
    </ref>
    <ref id="ref-23">
      <label>Wickham et al. (2019b)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>François</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Henry</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2019">2019b</year>
        <article-title>dplyr: A Grammar of Data Manipulation</article-title>
        <volume>26</volume>
        <version designator="0.8.3">R package version 0.8.3</version>
        <uri xlink:href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</uri>
        <date-in-citation content-type="access-date" iso-8601-date="2020-08-26">26 August 2020</date-in-citation>
      </element-citation>
    </ref>
    <ref id="ref-24">
      <label>Yu (2021)</label>
      <element-citation publication-type="data">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2021">2021</year>
        <article-title>tidytree: a tidy tool for phylogenetic tree data manipulation</article-title>
        <version designator="0.3.5">R package version 0.3.5</version>
        <uri xlink:href="https://CRAN.R-project.org/package=tidytree">https://CRAN.R-project.org/package=tidytree</uri>
        <date-in-citation content-type="access-date" iso-8601-date="2021-09-14">14 September 2021</date-in-citation>
      </element-citation>
    </ref>
  </ref-list>
</back>
