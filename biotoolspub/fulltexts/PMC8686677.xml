<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8686677</article-id>
    <article-id pub-id-type="pmid">34601556</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab663</article-id>
    <article-id pub-id-type="publisher-id">btab663</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RLM: fast and simplified extraction of read-level methylation metrics from bisulfite sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hetzel</surname>
          <given-names>Sara</given-names>
        </name>
        <aff><institution>Department of Genome Regulation, Max Planck Institute for Molecular Genetics</institution>, Berlin, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Giesselmann</surname>
          <given-names>Pay</given-names>
        </name>
        <aff><institution>Department of Genome Regulation, Max Planck Institute for Molecular Genetics</institution>, Berlin, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Reinert</surname>
          <given-names>Knut</given-names>
        </name>
        <aff><institution>Department of Mathematics and Informatics, Freie Universität</institution>, Berlin, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Meissner</surname>
          <given-names>Alexander</given-names>
        </name>
        <aff><institution>Department of Genome Regulation, Max Planck Institute for Molecular Genetics</institution>, Berlin, <country country="DE">Germany</country></aff>
        <aff><institution>Department of Biology, Chemistry and Pharmacy, Freie Universität</institution>, Berlin, <country country="DE">Germany</country></aff>
        <aff><institution>Department of Stem Cell and Regenerative Biology, Harvard University</institution>, Cambridge, MA 02138, <country country="US">USA</country></aff>
        <aff><institution>Broad Institute of MIT and Harvard</institution>, Cambridge, MA 02142, <country country="US">USA</country></aff>
        <xref rid="btab663-cor1" ref-type="corresp"/>
        <!--meissner@molgen.mpg.de-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0723-4980</contrib-id>
        <name>
          <surname>Kretzmer</surname>
          <given-names>Helene</given-names>
        </name>
        <aff><institution>Department of Genome Regulation, Max Planck Institute for Molecular Genetics</institution>, Berlin, <country country="DE">Germany</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Alkan</surname>
          <given-names>Can</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab663-cor1">To whom correspondence should be addressed. <email>meissner@molgen.mpg.de</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-10-02">
      <day>02</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>02</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>21</issue>
    <fpage>3934</fpage>
    <lpage>3935</lpage>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>11</day>
        <month>8</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>07</day>
        <month>9</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>08</day>
        <month>10</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab663.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Bisulfite sequencing data provide value beyond the straightforward methylation assessment by analyzing single-read patterns. Over the past years, various metrics have been established to explore this layer of information. However, limited compatibility with alignment tools, reference genomes or the measurements they provide present a bottleneck for most groups to routinely perform read-level analysis. To address this, we developed RLM, a fast and scalable tool for the computation of several frequently used read-level methylation statistics. RLM supports standard alignment tools, works independently of the reference genome and handles most sequencing experiment designs. RLM can process large input files with a billion reads in just a few hours on common workstations.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p><ext-link xlink:href="https://github.com/sarahet/RLM" ext-link-type="uri">https://github.com/sarahet/RLM</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Max Planck Society</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004189</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Bisulfite sequencing experiments are the gold standard to measure DNA methylation at single-CpG resolution (<xref rid="btab663-B2" ref-type="bibr">Frommer <italic toggle="yes">et al.</italic>, 1992</xref>). Besides the average CpG methylation level across a cell population, each read contains information about the methylation of a single molecule present within a cell (<xref rid="btab663-B10" ref-type="bibr">Scherer <italic toggle="yes">et al.</italic>, 2020</xref>). This information can be used when analyzing the heterogeneity of a cell population or comparing samples of different conditions such as healthy and tumor. Different metrics have been established in order to quantify heterogeneity within and across cells based on single-read methylation patterns. Measurements of population heterogeneity include methylation entropy and epipolymorphism, which are based on so-called epialleles, assessing the patterns of methylated and unmethylated CpGs that can occur in a 4-mer of consecutive CpGs spanned by the same reads (16 epialleles are possible for a single 4-mer) (<xref rid="btab663-B5" ref-type="bibr">Landan <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btab663-B13" ref-type="bibr">Xie <italic toggle="yes">et al.</italic>, 2011</xref>). Additionally, the heterogeneity within a single read can be classified as concordant or discordant, which can then be aggregated across reads as the percent of discordant reads (PDR), thus again measuring the heterogeneity across different cells (<xref rid="btab663-B6" ref-type="bibr">Landau <italic toggle="yes">et al.</italic>, 2014</xref>). Similarly, the number of transitions from methylated to unmethylated CpGs on a read can be used and aggregated per CpG to determine the level of heterogeneity (read transition score or RTS) (<xref rid="btab663-B1" ref-type="bibr">Charlton <italic toggle="yes">et al.</italic>, 2018</xref>).</p>
    <p>So far, studies that have analyzed read-level DNA methylation heterogeneity often utilized custom scripts for this purpose (<xref rid="btab663-B5" ref-type="bibr">Landan <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btab663-B6" ref-type="bibr">Landau <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btab663-B13" ref-type="bibr">Xie <italic toggle="yes">et al.</italic>, 2011</xref>). Only few tools are available that implement one or more of such metrics; however, they are limited in their usability by requiring a specific alignment tool, reference genome or additional input such as the exact position of CpGs of interest (<xref rid="btab663-B3" ref-type="bibr">He <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="btab663-B10" ref-type="bibr">Scherer <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab663-B11" ref-type="bibr">Scott <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
    <p>Here, we present RLM, a fast and scalable tool that implements established and frequently used inter- and intramolecular metrics of DNA methylation at the read level from bisulfite sequencing experiments. RLM is applicable for any reference genome, a wide range of library protocols and works with input alignment files from multiple commonly used alignment tools. Additionally, it automatically accounts for potential errors and biases caused by sequencing artifacts, mapping quality and overlapping read pairs.</p>
  </sec>
  <sec>
    <title>2 Implementation and features</title>
    <p>RLM is a standalone C++-based tool implemented using SeqAn (<xref rid="btab663-B8" ref-type="bibr">Reinert <italic toggle="yes">et al.</italic>, 2017</xref>). As input, RLM accepts BAM or SAM files from the common bisulfite alignment tools BSMAP, BISMARK, segemehl and GEM (<xref rid="btab663-B4" ref-type="bibr">Krueger and Andrews, 2011</xref>; <xref rid="btab663-B7" ref-type="bibr">Otto <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btab663-B9" ref-type="bibr">Santiago et al., 2012</xref>; <xref rid="btab663-B12" ref-type="bibr">Xi and Li, 2009</xref>). RLM can run with single- or paired-end sequencing data from different protocols such as whole genome bisulfite sequencing and target enrichment approaches but also reduced representation bisulfite sequencing (RRBS). To account for the artificially introduced nucleotides in RRBS experiments, CpGs at the end of the first read (and beginning of the second read) can be omitted from the analysis. Generally, reads that do not represent a primary alignment, are polymerase chain reaction duplicates, fail the quality control or do not pass a user-defined mapping quality filter are discarded.</p>
    <p>For single-end input, RLM streams across the records of the input file and extracts information about the methylation status of a CpG based on the corresponding reference genome and the BAM file tag that represents the origin and mapping orientation of each read (e.g. ‘ZS’ tag for BSMAP). Reads with sequencing errors at the position of a CpG, indels or reads that span less than three CpGs are discarded.</p>
    <p>For paired-end sequencing experiments, reads are filtered analogous to single-end experiments. Both mates are processed independently except for overlapping mates, which are merged and processed as a single, contiguous read maximizing the information that can be extracted when using downstream measurements dependent on four consecutive CpGs such as entropy. Additionally, we avoid two quantifications of the same genomic fragment, which would bias the analysis of cell population heterogeneity. To enable this, reads are kept in memory until the mate has been read and are removed from memory afterwards. If one mate needs to be excluded from the analysis, the other read will be processed independently to improve coverage.</p>
    <p>Depending on the research question of interest, RLM offers multiple outputs that can be requested separately or all at once by the user.</p>
    <p><italic toggle="yes">Single-read information</italic>: For every read with at least three CpGs, the methylation status for each CpG, the average methylation, the transition score and the discordance are reported. The transition score is defined as the number of transitions between methylated and unmethylated CpGs divided by the number of possible transitions. This file is mandatory output as the information collected here is used for the other output files.</p>
    <p><italic toggle="yes">RTS and PDR</italic>: For every CpG spanned by a user-defined minimum number of reads, the RTS and PDR across all reads spanning the CpG are reported. Additionally, the corresponding methylation rate based on the reads considered for the read-level measurements is provided.</p>
    <p><italic toggle="yes">Entropy and epipolymorphism</italic>: For every 4-mer of consecutive CpGs spanned by a user-defined minimum number of reads, the entropy and epipolymorphism are calculated and reported together with the average methylation rate of the complete 4-mer based on the reads considered for read-level metrics. Additionally, the frequencies for all epialleles leading to the respective metrics are provided.</p>
    <p>To complement the reported scores, RLM ships a standalone R script that provides users with a report including summary statistics and figures. Additionally, the documentation contains guidelines for its interpretation and use cases. The runtime of RLM scales linearly with the input size for both paired- and single-end modes. Large datasets with up to one billion reads can be processed in few hours with modest memory requirements (detailed performance analysis and comparison with other existing tools in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Data</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab663_Supplementary_Data</label>
      <media xlink:href="btab663_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgement</title>
    <p>We thank R. Rahn and E. Seiler for helpful suggestions regarding the implementation.</p>
    <sec>
      <title>Funding</title>
      <p>This work has been supported by the Max Planck Society.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References </title>
    <ref id="btab663-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Charlton</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Global delay in nascent strand DNA methylation</article-title>. <source>Nat. Struct. Mol. Biol</source>., <volume>25</volume>, <fpage>327</fpage>–<lpage>332</lpage>.<pub-id pub-id-type="pmid">29531288</pub-id></mixed-citation>
    </ref>
    <ref id="btab663-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frommer</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1992</year>) <article-title>A genomic sequencing protocol that yields a positive display of 5-methylcytosine residues in individual DNA strands</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>89</volume>, <fpage>1827</fpage>–<lpage>1831</lpage>.<pub-id pub-id-type="pmid">1542678</pub-id></mixed-citation>
    </ref>
    <ref id="btab663-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>He</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>DMEAS: DNA methylation entropy analysis software</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>2044</fpage>–<lpage>2045</lpage>.<pub-id pub-id-type="pmid">23749987</pub-id></mixed-citation>
    </ref>
    <ref id="btab663-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krueger</surname><given-names>F.</given-names></string-name>, <string-name><surname>Andrews</surname><given-names>S.R.</given-names></string-name></person-group> (<year>2011</year>) <article-title>Bismark: a flexible aligner and methylation caller for Bisulfite-Seq applications</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>1571</fpage>–<lpage>1572</lpage>.<pub-id pub-id-type="pmid">21493656</pub-id></mixed-citation>
    </ref>
    <ref id="btab663-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Landan</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>Epigenetic polymorphism and the stochastic formation of differentially methylated regions in normal and cancerous tissues</article-title>. <source>Nat. Genet</source>., <volume>44</volume>, <fpage>1207</fpage>–<lpage>1214</lpage>.<pub-id pub-id-type="pmid">23064413</pub-id></mixed-citation>
    </ref>
    <ref id="btab663-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Landau</surname><given-names>D.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Locally disordered methylation forms the basis of intratumor methylome variation in chronic lymphocytic leukemia</article-title>. <source>Cancer Cell</source>, <volume>26</volume>, <fpage>813</fpage>–<lpage>825</lpage>.<pub-id pub-id-type="pmid">25490447</pub-id></mixed-citation>
    </ref>
    <ref id="btab663-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Otto</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>Fast and sensitive mapping of bisulfite-treated sequencing data</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>1698</fpage>–<lpage>1704</lpage>.<pub-id pub-id-type="pmid">22581174</pub-id></mixed-citation>
    </ref>
    <ref id="btab663-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reinert</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>The SeqAn C++ template library for efficient sequence analysis: a resource for programmers</article-title>. <source>J. Biotechnol</source>., <volume>261</volume>, <fpage>157</fpage>–<lpage>168</lpage>.<pub-id pub-id-type="pmid">28888961</pub-id></mixed-citation>
    </ref>
    <ref id="btab663-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Santiago</surname><given-names>M.-S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>The GEM mapper: fast, accurate and versatile alignment by filtration</article-title>. <source>Nat. Methods</source>, <volume>9</volume>, <fpage>1185</fpage>–<lpage>1188</lpage>.<pub-id pub-id-type="pmid">23103880</pub-id></mixed-citation>
    </ref>
    <ref id="btab663-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scherer</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Quantitative comparison of within-sample heterogeneity scores for DNA methylation data</article-title>. <source>Nucleic Acids Res</source>., <volume>48</volume>, <fpage>e46</fpage>.<pub-id pub-id-type="pmid">32103242</pub-id></mixed-citation>
    </ref>
    <ref id="btab663-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scott</surname><given-names>C.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Identification of cell type-specific methylation signals in bulk whole genome bisulfite sequencing data</article-title>. <source>Genome Biol</source>., <volume>21</volume>, <fpage>156</fpage>.<pub-id pub-id-type="pmid">32605651</pub-id></mixed-citation>
    </ref>
    <ref id="btab663-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xi</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Li</surname><given-names>W.</given-names></string-name></person-group> (<year>2009</year>) <article-title>BSMAP: whole genome bisulfite sequence MAPping program</article-title>. <source>BMC Bioinformatics</source>, <volume>10</volume>, <fpage>232</fpage>.<pub-id pub-id-type="pmid">19635165</pub-id></mixed-citation>
    </ref>
    <ref id="btab663-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xie</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) <article-title>Genome-wide quantitative assessment of variation in DNA methylation patterns</article-title>. <source>Nucleic Acids Res</source>., <volume>39</volume>, <fpage>4099</fpage>–<lpage>4108</lpage>.<pub-id pub-id-type="pmid">21278160</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
