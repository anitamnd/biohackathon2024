<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8434731</article-id>
    <article-id pub-id-type="publisher-id">4352</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04352-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SWnet: a deep learning model for drug response prediction from cancer genomic signatures and compound chemical structures</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Zuo</surname>
          <given-names>Zhaorui</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Penglei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Xiaowei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tian</surname>
          <given-names>Li</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ge</surname>
          <given-names>Hui</given-names>
        </name>
        <address>
          <email>hui.ge@novartis.com</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9715-6674</contrib-id>
        <name>
          <surname>Qian</surname>
          <given-names>Dahong</given-names>
        </name>
        <address>
          <email>dahong.qian@sjtu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.16821.3c</institution-id><institution-id institution-id-type="ISNI">0000 0004 0368 8293</institution-id><institution>Institute of Medical Robotics, </institution><institution>Shanghai Jiao Tong University, </institution></institution-wrap>2F of the Translational Medicine Building, No. 800 Dongchuan Road, Shanghai, 200000 China </aff>
      <aff id="Aff2"><label>2</label>Novartis Institutes for Biomedical Research, 4218 Jinke Road, Pudong, Shanghai, 201203 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>434</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>8</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">One of the major challenges in precision medicine is accurate prediction of individual patient’s response to drugs. A great number of computational methods have been developed to predict compounds activity using genomic profiles or chemical structures, but more exploration is yet to be done to combine genetic mutation, gene expression, and cheminformatics in one machine learning model.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We presented here a novel deep-learning model that integrates gene expression, genetic mutation, and chemical structure of compounds in a multi-task convolutional architecture. We applied our model to the Genomics of Drug Sensitivity in Cancer (GDSC) and Cancer Cell Line Encyclopedia (CCLE) datasets. We selected relevant cancer-related genes based on oncology genetics database and L1000 landmark genes, and used their expression and mutations as genomic features in model training. We obtain the cheminformatics features for compounds from PubChem or ChEMBL. Our finding is that combining gene expression, genetic mutation, and cheminformatics features greatly enhances the predictive performance.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">We implemented an extended Graph Neural Network for molecular graphs and Convolutional Neural Network for gene features. With the employment of multi-tasking and self-attention functions to monitor the similarity between compounds, our model outperforms recently published methods using the same training and testing datasets.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-021-04352-9.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Deep learning</kwd>
      <kwd>Genomics</kwd>
      <kwd>Cheminformatics</kwd>
      <kwd>Drug response</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Natural Science Foundation of China</institution>
        </funding-source>
        <award-id>81974276</award-id>
        <principal-award-recipient>
          <name>
            <surname>Qian</surname>
            <given-names>Dahong</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Novartis Institutes for Biomedical Research Shanghai</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par19">In the past decade, the concept of personalized medicine has been widely accepted with the advance of molecular medicine and genomics, seeking to underpin the association between individuals’ biological background and drugs response. Identification of molecular biomarkers is now a common practice in clinical studies, especially in the field of cancer therapy. The availability of genomics data and therapeutic agents make cancer an ideal field for the study of precision medicine that aims to match patient’s molecular background with the selection of drugs. In addition, understanding the interplay between biology and drugs chemical properties is also a key to the practice of drug repositioning. Research in the field of cancer has gained deep insights into its molecular features [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. While clinical studies of drug response is expensive, a comprehensive catalogue of stable cancer cell lines that captures patient’s molecular features has been used for large-scale in vitro screening of anticancer drugs [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. Data from these studies provide rich sources for investigating the nature of drug–gene interaction, and can provide meaningful guidance to clinical practice.</p>
    <p id="Par20">Since large-scale screening datasets have become publicly available, the computational community has made great efforts in developing predictive models that link gene-level signatures directly with drug response [<xref ref-type="bibr" rid="CR7">7</xref>]. A variety of machine learning techniques [<xref ref-type="bibr" rid="CR8">8</xref>] have been evaluated, including elastic net, regularized matrix factorization, sparse-linear/non-linear regressions, kernel methods, network-based methods, and ensemble models. Valuable insights were gained from these studies, such as the predictive power of different genomic data types, the performance of different algorithms and the benefit of incorporating prior knowledge [<xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR14">14</xref>]. Chemical structures can also be used to predict drug activity in a comparable fashion [<xref ref-type="bibr" rid="CR15">15</xref>]. Some studies have tried to integrate genomic and chemical signatures in a predictive model. Several previously published methods showed that combining chemical structural information and cell lines’ molecular profile could improve <inline-formula id="IEq2"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$IC_{50}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>50</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq2.gif"/></alternatives></inline-formula> prediction accuracy [<xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR22">22</xref>].</p>
    <p id="Par21">We have developed a novel deep-learning predictive model, self-attention gene weight layer network (SWnet), that aims to leverage the current advancement of machine learning methods and integrate genomics and cheminformatics. Our method has unique characteristics compared to existing methods: (1) with the application of Graph Neural Network (GNN), we converted the 2D representations of chemicals into continuous vectors in the latent space; (2) we used the gene weight layer to combine the information of gene mutation and gene expression, and then used the multi-task model to extract the interaction information of chemical structure and genetics to improve the prediction accuracy; (3) we applied self-attention mechanism [<xref ref-type="bibr" rid="CR23">23</xref>] to incorporate the structural similarity between compounds into model training.</p>
    <p id="Par22">SWnet was trained and validated using the Genomics of Drug Sensitivity in Cancer (GDSC) dataset [<xref ref-type="bibr" rid="CR5">5</xref>] and Cancer Cell Line Encyclopedia (CCLE) dataset [<xref ref-type="bibr" rid="CR24">24</xref>]. We compared our result to a few recent studies that represent the most advanced methods in the field and showed that our predictive model outperformed other methods trained on the same dataset.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Training and testing data</title>
      <p id="Par23">Genomics of Drug Sensitivity in Cancer (GDSC) is the largest public resource of anticancer drug sensitivity screening using over 1000 human cancer cell lines. Drugs in GDSC are comprised of approved drugs, experimental drugs in clinical trials, and tool compounds. The Cancer Cell Line Encyclopedia (CCLE) is another commonly used resource with genomic profiling of cancer cell lines, which allows predictive modelling of anticancer drug sensitivity [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]. The structures of compounds in GDSC and CCLE were obtained from PubChem or ChEMBL [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]. The Simplified Molecular Input Line Entry System (SMILES) was converted to Morgan fingerprints using RDKit [<xref ref-type="bibr" rid="CR27">27</xref>] and the similarity between compounds was determined by Tanimoto distance. The structures of compounds from GDSC belong to 209 Bemis-Murcko scaffold and can be further grouped into 56 clusters based on chemical fingerprints (with linkage type of UPGMA, and distance of 0.6 by Tanimoto distance), showing a high level of chemical diversity.</p>
      <p id="Par24">Sensitivity is measured by the natural log-transformed half maximal inhibitory concentration (<inline-formula id="IEq3"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$IC_{50}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>50</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq3.gif"/></alternatives></inline-formula>). Cell lines have been extensively characterized at molecular level. We used gene expression and genetic mutation as biological features in our model training. The original expression matrix (RMA value from Array Express) was normalized to z-score per cell line. The binary mutation matrix was produced by collapsing all the somatic nonsynonymous mutations for each gene, regardless of the genomic location.</p>
      <p id="Par25">The high dimension of the genomic feature matrices is likely to cause overfitting. Subsets of genes based on biological functions could be selected to reduce the dimension, as proposed by other studies [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR28">28</xref>]. We selected genes based on the following criteria: (1) relevance to cancer based on the Catalogue of Somatic Mutations in Cancer (COSMIC) database [<xref ref-type="bibr" rid="CR3">3</xref>]; (2) gene expression showing non-redundancy, which means that a subset of genes are selected to represent the whole expression profile of the transcriptome. According to Broad L1000 project [<xref ref-type="bibr" rid="CR6">6</xref>], this set of genes has been shown to be sufficient to predict the transcriptome change upon drug treatment. We used the gene set to reduce the possibility of overfitting. Finally, we merged the two gene lists and obtained 1478 genes across 1018 cell lines, whose expression and mutation represent the genomic features in model training.</p>
    </sec>
    <sec id="Sec4">
      <title>Model architecture</title>
      <sec id="Sec5">
        <title>Dual convergence model architecture</title>
        <p id="Par26">Our deep-learning model adopted a dual convergence architecture as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, which means the mutations and expression of genes and chemical structures of drugs information were modelled separately since they contained different types of information. The two were later merged into one prediction model. Genomic signatures and molecular graphs were processed in parallel through GNN and Convolutional Neural Network (CNN) layers to extract independent features, which were then concatenated. The gene branch in SWnet used 3 convolutional layers and 1 fully connected layer to generate gene embeddings. Then the embeddings of molecule and gene were concatenated and input into a prediction subnetwork, which consists of convolutional layer, pooling layer and batch normalization layer, to extract high-level features. Finally, the high-level features were input to fully connected layer to predict <inline-formula id="IEq4"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$IC_{50}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>50</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq4.gif"/></alternatives></inline-formula>. It is noted that we used 1D CNNs in gene branch and prediction subnetwork to decrease the number of trainable parameters, therefore reducing the complexity of our model to avoid the risk of overfitting and improve the model performance. Based on dual convergence architecture, we also integrated multi-task learning and self-attention mechanism to further improve the performance. We described the architecture in more details in the following sections.</p>
      </sec>
      <sec id="Sec6">
        <title>Parsing of compound chemical structures using graph method</title>
        <p id="Par27">There are many representations of chemical structures in the field of machine learning, such as molecular fingerprints, text-based representations (SMILES/INCHI), graph-based and 3D structure &amp; surface. There are two main methods to encode molecules using continuous embedding vectors. One method is to use RNNs in variants autoencoder deep-learning network to generate continuous embedding vectors from SMILES [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR30">30</xref>]. The other method is to learn features from graph-structured inputs [<xref ref-type="bibr" rid="CR31">31</xref>–<xref ref-type="bibr" rid="CR33">33</xref>].</p>
        <p id="Par28">In our study, we implemented an extended Graph Neural Network (GNN) [<xref ref-type="bibr" rid="CR34">34</xref>] for molecular graphs. Normally, we represent a graph as <inline-formula id="IEq5"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G = (V,E)$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq5.gif"/></alternatives></inline-formula>, where <italic>V</italic> is the set of nodes and <italic>E</italic> is the set of edges. For a molecule, <inline-formula id="IEq6"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_i \in V$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq6.gif"/></alternatives></inline-formula> represents the <italic>i</italic>th atom and <inline-formula id="IEq7"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{ij} \in E$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq7.gif"/></alternatives></inline-formula> represents the chemical bond between <italic>i</italic>th atom and <italic>j</italic>th atom. The GNN takes a graph <italic>G</italic> as input, then produces a graph-level representation <inline-formula id="IEq8"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h_G \in R^d$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq8.gif"/></alternatives></inline-formula>. In our extended GNN, we used <italic>r</italic>-radius subgraphs [<xref ref-type="bibr" rid="CR9">9</xref>] to solve the issue that representation learning was ineffective due to the low model complexity. The <italic>r</italic>-radius subgraphs were induced by the neighboring nodes and edges within radius <italic>r</italic> from a node. Different from that in normal GNNs, in the extended GNN, we randomly initialized embedding for <italic>r</italic>-radius node and <italic>r</italic>-radius edge, and then updated the representation by backpropagation.</p>
        <p id="Par29">The process of GNN for molecular graphs can be described as a transition function and an output function. Figure <xref rid="Fig2" ref-type="fig">2</xref> illustrates the general GNN architecture for molecular graphs. The transition function iteratively updates the node information by combining its neighboring nodes and edges, and the output function maps the node-level feature vectors to graph-level representation. The extended GNN has transition function for nodes and edges respectively, and updates the current node embedding through leveraging previous node and edge embeddings. For edge transition, we updated the edge embedding <inline-formula id="IEq9"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{ij}^{(t+1)}$$\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq9.gif"/></alternatives></inline-formula> through both end node embeddings <inline-formula id="IEq10"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_i^{t+1}$$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq10.gif"/></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_j^{t+1}$$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq11.gif"/></alternatives></inline-formula> as follows:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} e_{ij}^{(t+1)}&amp;= \sigma (e_{ij}^{(t)}+g_{ij}^{(t)}) \end{aligned}$$\end{document}</tex-math><mml:math id="M22" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4352_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} g_{ij}^{(t)}&amp;= f(w_e(v_i^{(t)}+v_j^{(t)}+b_e)) \end{aligned}$$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4352_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M26"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq12.gif"/></alternatives></inline-formula> is the element-wise sigmoid function and <italic>f</italic> is a non-linear activation function like ReLU, <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_e \in R^{d \times d}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>×</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq13.gif"/></alternatives></inline-formula> and <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_e \in R^d$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq14.gif"/></alternatives></inline-formula> are the trainable parameters and bias vector respectively, <italic>d</italic> is the dimension of edge embedding vector.<fig id="Fig1"><label>Fig. 1</label><caption><p>The overview of model architecture. Chemical structure, gene expression and genetic mutation serve as input of the model. Graph neural network encoded the drugs and convolutional neural network extracted gene expression and genetic mutation features simultaneously. Through self-attention, we incorporated the chemical similarity into the input to train gene weight layer <inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W'$$\end{document}</tex-math><mml:math id="M32"><mml:msup><mml:mi>W</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq15.gif"/></alternatives></inline-formula>. Gene weight layer <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W'$$\end{document}</tex-math><mml:math id="M34"><mml:msup><mml:mi>W</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq16.gif"/></alternatives></inline-formula> combined gene expression, genetic mutation and drug similarity. Then the model concatenated drug vector and genetic vector to predict the <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$IC_{50}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>50</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq17.gif"/></alternatives></inline-formula></p></caption><graphic xlink:href="12859_2021_4352_Fig1_HTML" id="MO3"/></fig><fig id="Fig2"><label>Fig. 2</label><caption><p>The overview of GNN architecture. <bold>a</bold> The process of updating node embedding through neighboring nodes. <bold>b</bold> The process of updating embedding through side node embedding. <bold>c</bold> The final graph after the transition function. <bold>d</bold> The graph-level representation through arithmetic mean of all node embeddings</p></caption><graphic xlink:href="12859_2021_4352_Fig2_HTML" id="MO4"/></fig></p>
        <p id="Par30">We used similar iterative procedure for node transition, and we update the <italic>i</italic>th node embedding <inline-formula id="IEq18"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_i^{t+1} \in R^d$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq18.gif"/></alternatives></inline-formula> at time step <inline-formula id="IEq19"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t+1$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq19.gif"/></alternatives></inline-formula> through the following transition function:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} v_i^{(t+1)}&amp;= \sigma \left( v_i^{(t)}+\sum _{j \in N(i)}h_{ij}^{(t)}\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M42" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4352_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} h_{ij}^{(t)}&amp;= f\left( w_n \begin{bmatrix} v_j^{(t)}\\ e_{ij}^{(t)} \end{bmatrix} +b_n\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M44" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4352_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq20"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_n \in R^{d \times 2d}$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>×</mml:mo><mml:mn>2</mml:mn><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq20.gif"/></alternatives></inline-formula> and <inline-formula id="IEq21"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_n \in R^d$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq21.gif"/></alternatives></inline-formula> are the trainable parameter matrix and bias vector respectively, and <italic>N</italic>(<italic>i</italic>) is the set of neighboring indices of <italic>i</italic>. The extended GNN computes the <italic>i</italic>th node embedding through combining the edge embedding and the neighboring node embedding iteratively, and the node gradually obtains global information on the graph.</p>
        <p id="Par31">The next operation takes the graph-level representation as input which is from the output function. Our output function is an arithmetic mean of all node embedding from transition function as follows:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} h_{G}=\frac{1}{N}\sum _{i=1}^{N}v_i^{(t)} \end{aligned}$$\end{document}</tex-math><mml:math id="M50" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4352_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <italic>N</italic> is the number of nodes in the graph. While this is a simple operation to obtain the graph-level representation, it works well in practice.</p>
        <p id="Par32">The graph-level representation extracted by GNN embedded the 2D structure information of molecules into the feature vector, compared with the binary fingerprints used by other methods [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR35">35</xref>], it effectively avoids the problem of sparse features. We think the graph-level representation extracted by GNN can benefit our task.</p>
      </sec>
      <sec id="Sec7">
        <title>Weight vector/matrix to evaluate the significance of genetic mutation</title>
        <p id="Par33">Most published research use only gene expression data or only genetic mutation data to train models [<xref ref-type="bibr" rid="CR18">18</xref>]. We wanted to integrate these two data types, so we added a weight layer to the deep learning model. In this way, the mutation status of each gene is fed into the model with a weight that can be trained. As shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, a combined feature for gene is calculated as:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} geneCom = geneExp + geneVar * {w'} \end{aligned}$$\end{document}</tex-math><mml:math id="M52" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>E</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow/><mml:mo>∗</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4352_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <italic>geneCom</italic> is the combination of expression (<italic>geneExp</italic>) and mutation (<italic>geneVar</italic>). <inline-formula id="IEq22"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w'$$\end{document}</tex-math><mml:math id="M54"><mml:msup><mml:mi>w</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq22.gif"/></alternatives></inline-formula> represents the weight for genetic mutation. <inline-formula id="IEq23"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$*$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq23.gif"/></alternatives></inline-formula> represents the vector dot product. The feature of each gene is the gene expression value plus the product of genetic mutation value and weight by Eq.(<xref rid="Equ6" ref-type="">6</xref>). We have two kinds of weights: one is single weight vector whose dimension is <italic>w</italic> (1, 1478), and the other is multi-weight vector whose dimension is <italic>W</italic> (<italic>N</italic>, 1478). <italic>N</italic> is the number of anticancer drugs. Thus, for each compound, we trained for a vector <italic>w</italic> (1, 1478) that represented the significance of mutant genes. In the later section, we will show how to train the multi-layer weight matrix.<fig id="Fig3"><label>Fig. 3</label><caption><p>Gene weight layer. Gene feature was combined as the sum of normalized gene expression value and a weight adjusted genetic mutation value. Two ways of generating the mutation component were tested. <bold>a</bold> Single weight layer: a common weight vector <inline-formula id="IEq24"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w'$$\end{document}</tex-math><mml:math id="M58"><mml:msup><mml:mi>w</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq24.gif"/></alternatives></inline-formula> was applied to all genetic mutations without considering the heterogeneity of gene-drug relationship. <bold>b</bold> Multiple weight layers: a weight matrix <inline-formula id="IEq25"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W'$$\end{document}</tex-math><mml:math id="M60"><mml:msup><mml:mi>W</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq25.gif"/></alternatives></inline-formula> was applied to account for the heterogeneity of gene-drug relationship so that each drug would have its own weight vector for genetic mutation</p></caption><graphic xlink:href="12859_2021_4352_Fig3_HTML" id="MO9"/></fig></p>
      </sec>
      <sec id="Sec8">
        <title>Multi-task learning</title>
        <p id="Par34">Multi-task learning (MTL) problem is defined as multiple supervised learning tasks considered together [<xref ref-type="bibr" rid="CR12">12</xref>]. In the previous section, we described a multi-layer weight matrix to measure the interaction between individual compound and genetic mutation. Each layer (vector of size <inline-formula id="IEq26"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1*1478$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mn>1</mml:mn><mml:mrow/><mml:mo>∗</mml:mo><mml:mn>1478</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq26.gif"/></alternatives></inline-formula>) is thus independent, and the simplest approach would be to solve these tasks independently through separating the dataset by compounds. However, it has been shown in previous studies that MTL can improve the performance [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR36">36</xref>]. Since each task has the same model structure, we trained the 221 tasks all at once, using a common MSE loss for all drugs.</p>
      </sec>
      <sec id="Sec9">
        <title>Self-attention</title>
        <p id="Par35">For the multi-task model described in previous section, each drug has its own gene weight parameters, which are supposed to be relevant to the drug itself. But we believe that similar drugs may have similar gene weight parameters. To take into consideration the similarity between drugs’ chemical structures, we applied a self-attention method, which uses drug similarity matrix to update the parameters of gene weight layer.</p>
        <p id="Par36">An attention function can be described as a query and a set of key-value pairs to an outputs, where the query, keys, values and output are all vectors. The output is computed as a weighted sum of the values, where the weight assigned to each value is computed by compatibility of the query with the corresponding key [<xref ref-type="bibr" rid="CR23">23</xref>].<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Attention(Q,K,V)=softmax(a(Q,K))V \end{aligned}$$\end{document}</tex-math><mml:math id="M64" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4352_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula><italic>Q</italic>, <italic>K</italic> represent SMILES of compounds. <italic>V</italic> represents weight parameters of gene weight layer. <italic>a</italic>(<italic>Q</italic>, <italic>K</italic>) is an alignment function [<xref ref-type="bibr" rid="CR20">20</xref>] which gives scores how well the inputs and the outputs match, and we normalized the scores by softmax function. The softmax function is a normalized exponential function as follows:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} softmax(x)_i = \frac{e^{x_i}}{\sum _{j=1}^{d}e^{x_j}}, \quad for \; i=1,\ldots ,d \; and \; x=(x_1,\ldots ,x_d) \in R^d \end{aligned}$$\end{document}</tex-math><mml:math id="M66" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>d</mml:mi></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.277778em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mspace width="0.277778em"/><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.277778em"/><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4352_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>In our model, the calculation process is shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. First, we used RDKit Tools to calculate the similarity of Morgan fingerprints between compounds to obtain <italic>a</italic>(<italic>Q</italic>, <italic>K</italic>). Then we performed matrix multiplication with the weight matrix. <italic>a</italic>(<italic>Q</italic>, <italic>K</italic>) represents the similarity matrix between all compounds. The output <inline-formula id="IEq27"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W'$$\end{document}</tex-math><mml:math id="M68"><mml:msup><mml:mi>W</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq27.gif"/></alternatives></inline-formula> has the same dimension as <italic>W</italic>, but contains drug similarity information. Figure <xref rid="Fig1" ref-type="fig">1</xref> illustrates the self-attention mechanism for <inline-formula id="IEq28"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$IC_{50}$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>50</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq28.gif"/></alternatives></inline-formula> prediction.</p>
        <p id="Par37">For the drug response prediction of a new drug, its corresponding <italic>w</italic> could be calculated from the trained <inline-formula id="IEq29"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w'$$\end{document}</tex-math><mml:math id="M72"><mml:msup><mml:mi>w</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq29.gif"/></alternatives></inline-formula>. The calculation process is described in Fig. <xref rid="Fig4" ref-type="fig">4</xref>a–c. This way, the drug response prediction for new drugs will be more accurate.<fig id="Fig4"><label>Fig. 4</label><caption><p>Self-attention calculation process. <bold>a</bold> Function <italic>a</italic> calculates the similarity between drugs. <bold>b</bold> The softmax function calculates the proportion of similarity score. <bold>c</bold> For one compound, through matrix multiplication, the weight layer will have compound similarity features. <bold>d</bold> The <inline-formula id="IEq30"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W'$$\end{document}</tex-math><mml:math id="M74"><mml:msup><mml:mi>W</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq30.gif"/></alternatives></inline-formula> layer will be updated during the training process and finally reflects the contribution of genetic mutation to each drug’s sensitivity. By multiplying the <italic>W</italic> layer with the softmax matrix, drug–drug similarity is taken into account</p></caption><graphic xlink:href="12859_2021_4352_Fig4_HTML" id="MO12"/></fig></p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Other methods for comparison</title>
      <p id="Par38">We selected four previously published methods for comparison. We used Mean Square Error (MSE) and <inline-formula id="IEq31"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R^2$$\end{document}</tex-math><mml:math id="M76"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq31.gif"/></alternatives></inline-formula> to evaluate the performance of models. The MSE metric measures the average squared difference between the predicted values <inline-formula id="IEq32"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{y_i}$$\end{document}</tex-math><mml:math id="M78"><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq32.gif"/></alternatives></inline-formula> and the actual values <inline-formula id="IEq33"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_i$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq33.gif"/></alternatives></inline-formula>, it is calculated as follows:<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} MSE = \frac{1}{N}\sum _{i=1}^{N}(y_i-\hat{y_i})^2 \end{aligned}$$\end{document}</tex-math><mml:math id="M82" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4352_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where the <italic>N</italic> represents the number of samples. The <inline-formula id="IEq34"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R^2$$\end{document}</tex-math><mml:math id="M84"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq34.gif"/></alternatives></inline-formula> quantifies the degree of any linear correlation between the predicted values <inline-formula id="IEq35"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{y_i}$$\end{document}</tex-math><mml:math id="M86"><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq35.gif"/></alternatives></inline-formula> and the actual values <inline-formula id="IEq36"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_i$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq36.gif"/></alternatives></inline-formula>, it is calculated as follows:<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} R^2 = 1-\frac{\sum _{i}^{N}(y_i-\hat{y_i})^2}{\sum _{i}^{N}(y_i-{\bar{y}})^2}, \quad where \; {\bar{y}} = \frac{1}{N}\sum _{i}^{N}y_i \end{aligned}$$\end{document}</tex-math><mml:math id="M90" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>w</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.277778em"/><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4352_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>These methods were all trained and tested on GDSC and CCLE datasets. <list list-type="order"><list-item><p id="Par39">Kernelized Bayesian multi-task learning (KBMTL). This method formulated a novel Bayesian algorithm that combines kernel-based non-linear dimensionality reduction and binary classification or regression [<xref ref-type="bibr" rid="CR11">11</xref>]. The joint Bayesian formulation projects data points into a shared subspace and learns predictive models for all drugs in this subspace. In our paper, we used the Gaussian kernel with <inline-formula id="IEq37"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sqrt{25000}$$\end{document}</tex-math><mml:math id="M92"><mml:msqrt><mml:mn>25000</mml:mn></mml:msqrt></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq37.gif"/></alternatives></inline-formula> kernel width to calculate similarity between cell lines. The parameters were (<inline-formula id="IEq38"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _\lambda$$\end{document}</tex-math><mml:math id="M94"><mml:msub><mml:mi>α</mml:mi><mml:mi>λ</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq38.gif"/></alternatives></inline-formula>, <inline-formula id="IEq39"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _\lambda$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mi>β</mml:mi><mml:mi>λ</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq39.gif"/></alternatives></inline-formula>, <inline-formula id="IEq40"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _\epsilon$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mi>α</mml:mi><mml:mi>ϵ</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq40.gif"/></alternatives></inline-formula>, <inline-formula id="IEq41"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _h$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mi>σ</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq41.gif"/></alternatives></inline-formula>, <inline-formula id="IEq42"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _h$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mi>σ</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq42.gif"/></alternatives></inline-formula>, R) = (1,1,1,1,0.1,1,10) and we used 200 iterations in all the experiments for KBMTL.</p></list-item><list-item><p id="Par40">Similarity-regularized matrix factorization (SRMF). This method predicted anticancer drug responses of cell lines by using chemical structures of drugs and baseline gene expression levels in cell lines [<xref ref-type="bibr" rid="CR14">14</xref>]. Specifically, chemical structural similarity of drugs and gene expression profile similarity of cell lines were considered as regularization terms, which were incorporated to the drug response matrix factorization model. We used Morgan fingerprint to calculate the drug similarity matrix in our paper. And the regularization parameters in SRMF were (<italic>K</italic>, <inline-formula id="IEq43"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _l$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi>λ</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq43.gif"/></alternatives></inline-formula>, <inline-formula id="IEq44"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _d$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mi>λ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq44.gif"/></alternatives></inline-formula>, <inline-formula id="IEq45"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _c$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mi>λ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq45.gif"/></alternatives></inline-formula>) = (45, <inline-formula id="IEq46"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^{-3}$$\end{document}</tex-math><mml:math id="M110"><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq46.gif"/></alternatives></inline-formula>, 0, <inline-formula id="IEq47"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^{-3}$$\end{document}</tex-math><mml:math id="M112"><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq47.gif"/></alternatives></inline-formula>). Finally, we used 50 iterations in all the experiments for SRMF.</p></list-item><list-item><p id="Par41">Weighted Graph Regularized Matrix Factorization (WGRMF). This method constructed a <italic>p</italic>-nearest neighbor graph to sparsify drug similarity matrix and cell line similarity matrix, respectively [<xref ref-type="bibr" rid="CR37">37</xref>]. Using the sparse matrices in the graph regularization terms, it performed matrix factorization to generate the latent matrices for drugs and cell lines in anticancer drug response prediction task. We used Morgan fingerprint to calculate the drug similarity matrix in our paper. The regularization parameters used in our paper were (<italic>k</italic>, <italic>p</italic>, <inline-formula id="IEq48"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _l$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mi>λ</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq48.gif"/></alternatives></inline-formula>, <inline-formula id="IEq49"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _d$$\end{document}</tex-math><mml:math id="M116"><mml:msub><mml:mi>λ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq49.gif"/></alternatives></inline-formula>, <inline-formula id="IEq50"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _c$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mi>λ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq50.gif"/></alternatives></inline-formula>) = (182, 20, 1, 2, <inline-formula id="IEq51"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^{-5}$$\end{document}</tex-math><mml:math id="M120"><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq51.gif"/></alternatives></inline-formula>) for GDSC dataset and (<italic>k</italic>, <italic>p</italic>
<inline-formula id="IEq52"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _l$$\end{document}</tex-math><mml:math id="M122"><mml:msub><mml:mi>λ</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq52.gif"/></alternatives></inline-formula>, <inline-formula id="IEq53"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _d$$\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mi>λ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq53.gif"/></alternatives></inline-formula>, <inline-formula id="IEq54"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _c$$\end{document}</tex-math><mml:math id="M126"><mml:msub><mml:mi>λ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq54.gif"/></alternatives></inline-formula>) = (24, 10, 1, 2, 1) for CCLE dataset. Finally, we used 50 iterations in all the experiments for WGRMF.</p></list-item><list-item><p id="Par42">Cancer Drug Response profile scan (CDRscan). This paper employed a deep learning dual convergence architecture, where the genomic mutational fingerprints of cell lines and the molecular fingerprints of drugs were processed individually, and then merged by ‘virtual docking’, an in silico modelling of drug treatment [<xref ref-type="bibr" rid="CR35">35</xref>]. By inputting molecular fingerprints of drugs, they achieved better <inline-formula id="IEq55"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$IC_{50}$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>50</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq55.gif"/></alternatives></inline-formula> prediction result.</p></list-item><list-item><p id="Par43">Graph convolutional network for drug response prediction (GraphDRP). In GraphDRP [<xref ref-type="bibr" rid="CR22">22</xref>], drugs were represented in molecular graphs directly capturing the bonds among atoms. Meanwhile, cell lines were depicted as binary vectors of genomic aberrations. The features of drugs and cell lines were learned by the convolutional layers, and then the combination of drug and cell line features were used to predict <inline-formula id="IEq56"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$IC_{50}$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>50</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq56.gif"/></alternatives></inline-formula> value. In our paper, we used GIN graph model in GrapDRP to learn the representation of the drug in GDSC and CCLE datasets.</p></list-item></list></p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Results</title>
    <p id="Par44">In this section, we showed the performance of our method on GDSC and CCLE datasets. Meanwhile, we studied the effect of gene weight layer, multi-task, self-attention and different <italic>r</italic>-radius GNN for our model on GDSC dataset. We designed three experiments. The first is the initial model with single matrix of gene weight layer. The second is MTL model with multiple matrices of gene weight layer. The third is self-attention model base on MTL but with increased similarity feature of drugs. The three experiments are with different <italic>r</italic>-radius (<italic>r</italic> = 1, 2, 3). As shown in Table <xref rid="Tab3" ref-type="table">3</xref>, after introducing the self-attention mechanism, the performance has been significantly improved. In addition, the trained gene weight layer helped to identify genes whose mutation status may strongly influence the prediction of drug ecacy.</p>
    <sec id="Sec12">
      <title>Performance on GDSC and CCLE datasets</title>
      <p id="Par45">GDSC data was pre-processed according to Methods Section Training and testing data. The final GDSC dataset consists of 983 cell lines with 1478 gene-level signatures and 221 drugs. A total of 177,128 instances of “chemical structure + gene signature vs. drug sensitivity” were in the final input for training the deep learning models (removing missing values where drug sensitivity is not available). The CCLE dataset consists of 24 compounds, covering 469 distinct cell lines for a total of 10853 instances.</p>
      <p id="Par46">In order to train and test the model, we randomly divided the GDSC dataset into the training (159415 instances) and testing (17,713 instances) sets, and split the CCLE dataset into the training (9767 instances) and testing (1086 instances) sets, which corresponded to 90% and 10% of the total instances, respectively.</p>
      <p id="Par47">Compared with previously published methods, our deep learning model shows superior predictive performance (Table <xref rid="Tab1" ref-type="table">1</xref>). Other models extracted features in all gene expression to achieve good predictive performance, but it is very difficult to extract really effective features from so many gene expression datasets. Different from other papers, CDRscan used mutation position to train model. They selected sequence variation information at 28328 positions from 567 genes in CGC [<xref ref-type="bibr" rid="CR38">38</xref>].<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of performances with previously published methods</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset</th><th align="left">Model</th><th align="left">MSE</th><th align="left"><inline-formula id="IEq57"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R^2$$\end{document}</tex-math><mml:math id="M132"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq57.gif"/></alternatives></inline-formula></th></tr></thead><tbody><tr><td align="left" rowspan="6">GDSC</td><td align="left">KBMTL</td><td align="left">1.2642</td><td align="left">0.8225</td></tr><tr><td align="left">SRMF</td><td align="left">0.9874</td><td align="left">0.8614</td></tr><tr><td align="left">WGRMF</td><td align="left">0.9844</td><td align="left">0.8618</td></tr><tr><td align="left">GraphDRP</td><td align="left">1.2586</td><td align="left">0.8229</td></tr><tr><td align="left">CDRscan</td><td align="left">2.1525</td><td align="left">0.6978</td></tr><tr><td align="left">SWnet</td><td align="left"><bold>0.9384</bold></td><td align="left"><bold>0.8683</bold></td></tr><tr><td align="left" rowspan="6">CCLE</td><td align="left">KBMTL</td><td align="left">1.9480</td><td align="left">0.5439</td></tr><tr><td align="left">SRMF</td><td align="left">1.2565</td><td align="left">0.7058</td></tr><tr><td align="left">WGRMF</td><td align="left">1.3026</td><td align="left">0.6950</td></tr><tr><td align="left">GraphDRP</td><td align="left">1.3121</td><td align="left">0.6928</td></tr><tr><td align="left">CDRscan</td><td align="left">1.1960</td><td align="left">0.7200</td></tr><tr><td align="left">SWnet</td><td align="left"><bold>1.1604</bold></td><td align="left"><bold>0.7283</bold></td></tr></tbody></table><table-wrap-foot><p>Bold values represents the result is the best performance among the models participating in the comparison</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec13">
      <title>Single weight layer</title>
      <p id="Par48">In this section, we discussed the effectiveness of genetic mutation features and gene weight layer. To study the influence of genetic mutation on model performance, we trained SWnet without gene weight layer. In Table <xref rid="Tab2" ref-type="table">2</xref>, we input two data types into SWnet gene branch: (1) gene expression only; (2) gene expression plus genetic mutation. As shown in Table <xref rid="Tab2" ref-type="table">2</xref>, the best MSE is 0.9727 when the gene expression features as input and <inline-formula id="IEq58"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r = 2$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq58.gif"/></alternatives></inline-formula> for radius. Meanwhile, the best MSE is 0.9853 when the gene expression and genetic mutation as input and <inline-formula id="IEq59"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r = 2$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq59.gif"/></alternatives></inline-formula> for radius. From the results we could see that the introduction of genetic mutation through simple addition would change the distribution of gene expression data and lead to the deterioration of training results.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance of model training without gene weight layer in different <italic>r</italic>-radius</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Features</th><th align="left"><italic>r</italic>-radius</th><th align="left">MSE</th><th align="left"><inline-formula id="IEq60"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R^2$$\end{document}</tex-math><mml:math id="M138"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq60.gif"/></alternatives></inline-formula></th></tr></thead><tbody><tr><td align="left" rowspan="3">Gene expression</td><td align="left">1</td><td align="left">1.0765</td><td align="left">0.8489</td></tr><tr><td align="left">2</td><td align="left"><bold>0.9727</bold></td><td align="left"><bold>0.8634</bold></td></tr><tr><td align="left">3</td><td align="left">1.0763</td><td align="left">0.8489</td></tr><tr><td align="left" rowspan="3">Gene expression + genetic mutation</td><td align="left">1</td><td align="left">1.0663</td><td align="left">0.8503</td></tr><tr><td align="left">2</td><td align="left"><bold>0.9853</bold></td><td align="left"><bold>0.8616</bold></td></tr><tr><td align="left">3</td><td align="left">1.1061</td><td align="left">0.8447</td></tr></tbody></table><table-wrap-foot><p>Bold values represents the result is the best performance among the models participating in the comparison</p></table-wrap-foot></table-wrap><table-wrap id="Tab3"><label>Table 3</label><caption><p>Performance of model training with different weight layers, self-attention, or <italic>r</italic>-radius</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Weight layer</th><th align="left">Self-attention</th><th align="left"><italic>r</italic>-radius</th><th align="left">MSE</th><th align="left"><inline-formula id="IEq61"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R^2$$\end{document}</tex-math><mml:math id="M140"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq61.gif"/></alternatives></inline-formula></th></tr></thead><tbody><tr><td align="left">Single</td><td align="left">No</td><td align="left">1</td><td align="left">1.0848</td><td align="left">0.8477</td></tr><tr><td align="left">Single</td><td align="left">No</td><td align="left">2</td><td align="left"><bold>0.9804</bold></td><td align="left"><bold>0.8623</bold></td></tr><tr><td align="left">Single</td><td align="left">No</td><td align="left">3</td><td align="left">1.0694</td><td align="left">0.8498</td></tr><tr><td align="left">Multi</td><td align="left">No</td><td align="left">1</td><td align="left">1.0654</td><td align="left">0.8504</td></tr><tr><td align="left">Multi</td><td align="left">No</td><td align="left">2</td><td align="left">1.0078</td><td align="left">0.8585</td></tr><tr><td align="left">Multi</td><td align="left">No</td><td align="left">3</td><td align="left"><bold>0.9767</bold></td><td align="left"><bold>0.8628</bold></td></tr><tr><td align="left">Multi</td><td align="left">Yes</td><td align="left">1</td><td align="left">1.0724</td><td align="left">0.8495</td></tr><tr><td align="left">Multi</td><td align="left">Yes</td><td align="left">2</td><td align="left">0.9785</td><td align="left">0.8626</td></tr><tr><td align="left">Multi</td><td align="left">Yes</td><td align="left">3</td><td align="left"><bold>0.9384</bold></td><td align="left"><bold>0.8683</bold></td></tr><tr><td align="left">Multi</td><td align="left">Yes</td><td align="left">4</td><td align="left">0.9917</td><td align="left">0.8608</td></tr><tr><td align="left">Multi</td><td align="left">Yes</td><td align="left">5</td><td align="left">1.2083</td><td align="left">0.8304</td></tr></tbody></table><table-wrap-foot><p>Bold values represents the result is the best performance among the models participating in the comparison</p></table-wrap-foot></table-wrap></p>
      <p id="Par49">To study the significance of gene weight layer on model, we used the gene weight layer in Table <xref rid="Tab3" ref-type="table">3</xref> to combine the gene expression and genetic mutation. We tried applying the gene weight layer to the following: (1) genetic mutation only; (2) gene expression only; (3) genetic mutation and gene expression. Our model performed the best (<inline-formula id="IEq62"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$MSE = 0.9384$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mn>0.9384</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq62.gif"/></alternatives></inline-formula>) when we applied the gene weight layer to genetic mutation only. Based on this experimental result, we finally decided to apply the gene weight layer to the genetic mutation only. In Table <xref rid="Tab3" ref-type="table">3</xref>, when <inline-formula id="IEq63"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r = 2$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq63.gif"/></alternatives></inline-formula> radius, single weight layer without self-attention, the MSE is 0.9804. It is smaller than 0.9853, illustrating that through gene weight layer the two genetic traits are dynamically combined, achieving better performance than simple addition strategy. However, Table <xref rid="Tab3" ref-type="table">3</xref> shows that in single gene weight layer, <inline-formula id="IEq64"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r = 2$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq64.gif"/></alternatives></inline-formula>, the MSE is 0.9804, bigger than 0.9727 in Table <xref rid="Tab2" ref-type="table">2</xref>. This means the single weight layer has little side effects on model training. Taking genetic mutation data as input means more features are introduced into the model. Meanwhile, GNN is a deeper model, harder to train than CNN. This leads to the fact that during SWnet training, back propagation is more inclined to GNN network training, so as to obtain better MSE results. On the other hand, although our CNN gene branch added single weight layer, it has little effect on model training.</p>
      <p id="Par50">In fact, before training GNN as drug feature extract model, we have trained a model of SWnet with a similar structure. Its drug feature extraction is realized through the convolutional neural network and the input feature is fingerprints. When we did simple addition of the gene features, MSE was 1.0223. If we combined the gene features through gene weight layer, MSE was 0.9912. This indicates that the convolutional layer can make the genetic mutation participate in the training of the model well and improve the performance of the model. It is worth mentioning that although single weight layer has little effect on SWnet when drug branch is GNN, the MSE is 0.9804, better than CNN drug branch whose MSE is 0.9912.</p>
    </sec>
    <sec id="Sec14">
      <title>Multi-task and self-attention</title>
      <p id="Par51">In section “Single weight layer”, we have solved the problem of how to input both gene expression and genetic mutations through single gene weight layer. In this section, we discussed how to design the gene weight layer to balance the complexity between GNN and CNN. First, we introduced multi-task learning. The single gene weight layer was upgraded to multiple gene weight layer. Each drug corresponded to a single gene weight layer at a specific location. However, there are too many weight layers to train, resulting in the model’s predictive performance degradation. As shown in Table <xref rid="Tab3" ref-type="table">3</xref> when using multi-weight layers and <inline-formula id="IEq65"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r = 3$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq65.gif"/></alternatives></inline-formula> without self-attention, the MSE is 0.9911.</p>
      <p id="Par52">Then we introduced self-attention mechanism to improve gene branch of the model. With self-attention structure, drug similarity enhanced the training of multi-weight layers, and then gene expression and genetic mutation features can be better fused together. As shown in Table <xref rid="Tab3" ref-type="table">3</xref>, when <inline-formula id="IEq66"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r = 3$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq66.gif"/></alternatives></inline-formula> and using multi-weight layers and self-attention, the <inline-formula id="IEq67"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$MSE = 0.9384$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mn>0.9384</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq67.gif"/></alternatives></inline-formula> and <inline-formula id="IEq68"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R^2 = 0.8583$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>0.8583</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq68.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec15">
      <title>Different <italic>r</italic>-radius</title>
      <p id="Par53">In section “Single weight layer” and section “Multi-task and self-attention” we have learned that the relative complexity of GNN and CNN determines the predictive ability of the model. With different <italic>r</italic>-radius subgraphs in GNN, we can adjust the complexity of the GNN branch. So we designed all experiments with different <italic>r</italic>-radius.</p>
      <p id="Par54">As shown in Table <xref rid="Tab3" ref-type="table">3</xref>, single gene weight SWnet achieved the best performance when <inline-formula id="IEq69"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r = 2$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq69.gif"/></alternatives></inline-formula> radius, self-attention SWnet achieved the best performance when <inline-formula id="IEq70"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r = 3$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq70.gif"/></alternatives></inline-formula> radius. Compared the two model, since self-attention SWnet contained multiple matrix <italic>W</italic> and self-attention mechanism, it has more ability to extract molecule feature, therefore the GNN branch can be more complicated. Self-attention SWnet became overfitting when <inline-formula id="IEq71"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r = 4$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq71.gif"/></alternatives></inline-formula> radius. Meanwhile, single gene layer SWnet model is simpler than self-attention SWnet, it means that the model would become overfitting faster when <inline-formula id="IEq72"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r = 3$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq72.gif"/></alternatives></inline-formula> radius.</p>
    </sec>
    <sec id="Sec16">
      <title>Relationship between drug targets and genetic mutation status revealed by the gene weight layer</title>
      <p id="Par55">The trained gene weight layer reflected the normalized contribution of the binary genetic mutation status to the prediction of drug efficacy. To explore biological relevance of the model, genes with <inline-formula id="IEq73"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$weight=1$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mi>w</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq73.gif"/></alternatives></inline-formula> have been identified for each drug, which represents the genetic mutation with the strongest predictive power. Proteins encoded by these genes might interact among themselves or interact with the drug targets. We identified these connections from protein–protein interaction database [<xref ref-type="bibr" rid="CR39">39</xref>]. The protein–protein interactions were illustrated for BRAF inhibitors and BCL2 inhibitors (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). Connections within 2 degrees from the target were shown in the network. For BRAF, two of the drugs (AZ628 and Dabrafenib) have their strongest predictive genes directly interacting with BRAF. For the other 3 BRAF inhibitors, there is at least one strongest predictive gene connected with BRAF within the second degree. The same was observed for BCL2 inhibitors. Interestingly, TP53 serves as a connection hub in the BCL2 case and SRC in the BRAF case. It is known that BCL2 and TP53 are two important nodes in the apoptosis signaling pathway and it has been reported that combining TP53 activation and BCL2 inhibition could result in synthetic lethality in AML [<xref ref-type="bibr" rid="CR40">40</xref>]. Similarly, BRAF V600E mutation and SRC mutations have been found to be mutually exclusive in colorectal cancer patients, and both could serve as molecular markers for prognosis [<xref ref-type="bibr" rid="CR41">41</xref>]. Lists of genes with <inline-formula id="IEq74"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$weight=1$$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:mi>w</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq74.gif"/></alternatives></inline-formula> for each drug are available in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1. These protein–protein interactions indicated the relevance of the gene weights in our model.<fig id="Fig5"><label>Fig. 5</label><caption><p>Physical interactions often occur among drug target proteins and proteins encoded by genes with the highest weight (<inline-formula id="IEq75"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$weight=1$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:mi>w</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq75.gif"/></alternatives></inline-formula>). <bold>a</bold> Five BRAF inhibitors were included in the training data. Genes with <inline-formula id="IEq76"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$weight=1$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:mi>w</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq76.gif"/></alternatives></inline-formula> were extracted from the gene weight layer after model training, and their interactions with BRAF were analyzed in the String database. Connections within 2 degrees from BRAF were shown, grouped by drug. <bold>b</bold> Three BCL2 inhibitors was included in the training data. Analysis procedure was the same as above. The network showed connections within 2 degrees from BCL2</p></caption><graphic xlink:href="12859_2021_4352_Fig5_HTML" id="MO15"/></fig></p>
    </sec>
    <sec id="Sec17">
      <title>Split training data with cell lines</title>
      <p id="Par56">To further explore the generalization ability of the model, we split the data set by cell lines, so that part of the genomic information never participated in the model training. We randomly divided training data with cell lines and trained GNN with different <italic>r</italic>-radius subgraphs, resulting in 159913 instances (90%) for training and 17215 instances (10%) for testing. As shown in Table <xref rid="Tab4" ref-type="table">4</xref>, the MSE is 2.2793 when single weight layer with <inline-formula id="IEq77"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r = 3$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq77.gif"/></alternatives></inline-formula> radius. Since the cell lines are of different tissue lineages, the performance of the model is not as good as that when all the cell lines appeared in the training dataset. Meanwhile, when <inline-formula id="IEq78"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r = 2$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq78.gif"/></alternatives></inline-formula> and using multi-weight layers and self-attention, the <inline-formula id="IEq79"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$MSE = 2.2840$$\end{document}</tex-math><mml:math id="M176"><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mn>2.2840</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq79.gif"/></alternatives></inline-formula>. This result is close to single layer SWnet. Due to weak cell line similarity, the different <italic>r</italic>-radius subgraphs have little effects of model performance.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Performance of SWnet in terms of MSE in random split dataset by cell lines with different r-radius subgraphs</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Weight layer</th><th align="left">Self-attention</th><th align="left"><italic>r</italic>-radius</th><th align="left">MSE</th><th align="left"><inline-formula id="IEq80"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R^2$$\end{document}</tex-math><mml:math id="M178"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq80.gif"/></alternatives></inline-formula></th></tr></thead><tbody><tr><td align="left">Single</td><td align="left">No</td><td align="left">1</td><td align="left">2.3090</td><td align="left">0.6756</td></tr><tr><td align="left">Single</td><td align="left">No</td><td align="left">2</td><td align="left">2.3102</td><td align="left">0.6755</td></tr><tr><td align="left">Single</td><td align="left">No</td><td align="left">3</td><td align="left"><bold>2.2793</bold></td><td align="left"><bold>0.6799</bold></td></tr><tr><td align="left">Multi</td><td align="left">Yes</td><td align="left">1</td><td align="left">2.2975</td><td align="left">0.6773</td></tr><tr><td align="left">Multi</td><td align="left">Yes</td><td align="left">2</td><td align="left"><bold>2.2840</bold></td><td align="left"><bold>0.6792</bold></td></tr><tr><td align="left">Multi</td><td align="left">Yes</td><td align="left">3</td><td align="left">2.3304</td><td align="left">0.6726</td></tr></tbody></table><table-wrap-foot><p>Bold values represents the result is the best performance among the models participating in the comparison</p></table-wrap-foot></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec18">
    <title>Conclusion</title>
    <p id="Par57">In this paper, we proposed a new end-to-end deep learning model called SWnet. With the gene weight layer, we input the gene expression and genetic mutation at once. We used GNN to encode chemical structures of drugs with different <italic>r</italic>. We predicted the <inline-formula id="IEq81"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$IC_{50}$$\end{document}</tex-math><mml:math id="M180"><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>50</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4352_Article_IEq81.gif"/></alternatives></inline-formula> based on gene signatures and molecular graphs and achieved better predictive performance than methods reported in previous literatures. We used the self-attention mechanism for the first time to explore the interactions between genetics and chemical structure of drugs.</p>
    <p id="Par58">SWnet combined genomic signatures and molecular graphs for drug efficacy prediction. We applied SWnet to GDSC and CCLE dataset, and showed that SWnet outperformed other models. With more datasets becoming available in the public domain, we envision training SWnet with more datasets and eventually using SWnet for in silico drug screenings. This model holds great promise for cancer therapy and precision medicine.</p>
    <p id="Par59">It is worth noting that the molecular structure information extracted by GNN is important for drug response prediction, where we applied the extend GNN to extract graph-level representation for molecule in this work. However, we used a simple arithmetic mean to get the graph-level representation from node-level representations. We believe that there will be more effective ways to extract the graph-level representation. We will improve the current GNN for more effective node information fusion in molecular graph.</p>
    <p id="Par60">The complex deep learning model SWnet can hardly be well-trained when it deals with a small dataset. In the future, we will design a GNN with a simpler structure to encode the drug structure to fit small datasets. We will try to fix the weight parameters for common atoms when updating node features in molecule. This may make GNN focus more on the structure of the molecule and the special atoms in it, and it will make it easier to train GNN with small datasets.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec19">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2021_4352_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1.</bold> Drug and genes information for efficacy prediction.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>GDSC</term>
        <def>
          <p id="Par4">Genomics of drug sensitivity in cancer</p>
        </def>
      </def-item>
      <def-item>
        <term>CCLE</term>
        <def>
          <p id="Par5">Cancer cell line encyclopedia</p>
        </def>
      </def-item>
      <def-item>
        <term>GNN</term>
        <def>
          <p id="Par6">Graph neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>CNN</term>
        <def>
          <p id="Par7">Convolutional neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>SWnet</term>
        <def>
          <p id="Par8">Self-attention gene weight layer network</p>
        </def>
      </def-item>
      <def-item>
        <term>SMILES</term>
        <def>
          <p id="Par9">Simplified molecular input line entry system</p>
        </def>
      </def-item>
      <def-item>
        <term>
          <inline-formula id="IEq1">
            <alternatives>
              <tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$IC_{50}$$\end{document}</tex-math>
              <mml:math id="M182">
                <mml:mrow>
                  <mml:mi>I</mml:mi>
                  <mml:msub>
                    <mml:mi>C</mml:mi>
                    <mml:mn>50</mml:mn>
                  </mml:msub>
                </mml:mrow>
              </mml:math>
              <inline-graphic xlink:href="12859_2021_4352_Article_IEq1.gif"/>
            </alternatives>
          </inline-formula>
        </term>
        <def>
          <p id="Par10">Half maximal inhibitory concentration</p>
        </def>
      </def-item>
      <def-item>
        <term>COSMIC</term>
        <def>
          <p id="Par11">Catalogue of somatic mutations in cancer</p>
        </def>
      </def-item>
      <def-item>
        <term>MTL</term>
        <def>
          <p id="Par12">Multi-task learning</p>
        </def>
      </def-item>
      <def-item>
        <term>MSE</term>
        <def>
          <p id="Par13">Mean square error</p>
        </def>
      </def-item>
      <def-item>
        <term>KBMTL</term>
        <def>
          <p id="Par14">Kernelized Bayesian multi-task learning</p>
        </def>
      </def-item>
      <def-item>
        <term>SRMF</term>
        <def>
          <p id="Par15">Similarity-regularized matrix factorization</p>
        </def>
      </def-item>
      <def-item>
        <term>WGRMF</term>
        <def>
          <p id="Par16">Weighted graph regularized matrix factorization</p>
        </def>
      </def-item>
      <def-item>
        <term>CDRscan</term>
        <def>
          <p id="Par17">Cancer drug response profile scan</p>
        </def>
      </def-item>
      <def-item>
        <term>GraphDRP</term>
        <def>
          <p id="Par18">Graph convolutional network for drug response prediction</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Zhaorui Zuo and Penglei Wang have contributed equally to this work</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Novartis team for its sponsorship and discussion, and with special thanks to Xinyi Yang and Yangjunyi Li for prior work that links to the ideation of this study.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>ZZ, HG, and DQ contributed to the study design; XC, LT data acquisition and data analysis; ZZ and PW model construction, code validation, data analysis, ZZ, PW and XC interpreted the results. ZZ, PW and XC prepared the figures and drafted the manuscript. ZZ, XC, PW, LT, HG and DQ edited and revised the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work has been supported in part by National Natural Science Foundation of China Grant 81974276 and by Novartis sponsorship. The funding bodies played no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Source code can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/zuozhaorui/SWnet.git">https://github.com/zuozhaorui/SWnet.git</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par61">Not applicable.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent for publication</title>
      <p id="Par62">Not applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par63">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barretina</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Caponigro</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Stransky</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Venkatesan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Margolin</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Lehár</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kryukov</surname>
            <given-names>GV</given-names>
          </name>
          <name>
            <surname>Sonkin</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The cancer cell line encyclopedia enables predictive modelling of anticancer drug sensitivity</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>483</volume>
        <issue>7391</issue>
        <fpage>603</fpage>
        <lpage>607</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11003</pub-id>
        <pub-id pub-id-type="pmid">22460905</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weinstein</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Collisson</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Mills</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>KRM</given-names>
          </name>
          <name>
            <surname>Ozenberger</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Ellrott</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shmulevich</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stuart</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>The cancer genome atlas pan-cancer analysis project</article-title>
        <source>Nat Genet</source>
        <year>2013</year>
        <volume>45</volume>
        <issue>10</issue>
        <fpage>1113</fpage>
        <lpage>1120</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2764</pub-id>
        <pub-id pub-id-type="pmid">24071849</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tate</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Bamford</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jubb</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Sondka</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Beare</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Bindal</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Boutselakis</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>CG</given-names>
          </name>
          <name>
            <surname>Creatore</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dawson</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cosmic: the catalogue of somatic mutations in cancer</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>941</fpage>
        <lpage>947</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1015</pub-id>
        <pub-id pub-id-type="pmid">30462257</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shoemaker</surname>
            <given-names>RH</given-names>
          </name>
        </person-group>
        <article-title>The nci60 human tumour cell line anticancer drug screen</article-title>
        <source>Nat Rev Cancer</source>
        <year>2006</year>
        <volume>6</volume>
        <issue>10</issue>
        <fpage>813</fpage>
        <lpage>823</lpage>
        <pub-id pub-id-type="doi">10.1038/nrc1951</pub-id>
        <pub-id pub-id-type="pmid">16990858</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Soares</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Greninger</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Edelman</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Lightfoot</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Forbes</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bindal</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Beare</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>IR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomics of drug sensitivity in cancer (GDSC): a resource for therapeutic biomarker discovery in cancer cells</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>41</volume>
        <issue>D1</issue>
        <fpage>955</fpage>
        <lpage>961</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks1111</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Narayan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Corsello</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Peck</surname>
            <given-names>DD</given-names>
          </name>
          <name>
            <surname>Natoli</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Gould</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Tubelli</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Asiedu</surname>
            <given-names>JK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A next generation connectivity map: L1000 platform and the first 1,000,000 profiles</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <issue>6</issue>
        <fpage>1437</fpage>
        <lpage>1452</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.10.049</pub-id>
        <pub-id pub-id-type="pmid">29195078</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Costello</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Heiser</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Georgii</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gönen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Menden</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Bansal</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hintsanen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Mpindi</surname>
            <given-names>J-P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A community effort to assess and improve drug sensitivity prediction algorithms</article-title>
        <source>Nat Biotechnol</source>
        <year>2014</year>
        <volume>32</volume>
        <issue>12</issue>
        <fpage>1202</fpage>
        <lpage>1212</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2877</pub-id>
        <pub-id pub-id-type="pmid">24880487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>A survey and systematic assessment of computational methods for drug response prediction</article-title>
        <source>Brief Bioinform</source>
        <year>2020</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>232</fpage>
        <lpage>246</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbz164</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Costa F, De Grave K. Fast neighborhood subgraph pairwise distance kernel. In: ICML;2010.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Rappaport N, Nativ N, Stelzer G, Twik M, Guan-Golan Y, Iny Stein T, Bahir I, Belinky F, Morrey CP, Safran M et al. Malacards: an integrated compendium for diseases and their annotation. Database. 2013;2013.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gönen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Margolin</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>Drug susceptibility prediction against a panel of drugs using kernelized Bayesian multitask learning</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>17</issue>
        <fpage>556</fpage>
        <lpage>563</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tan</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Prediction of anti-cancer drug response by kernelized multi-task learning</article-title>
        <source>Artif Intell Med</source>
        <year>2016</year>
        <volume>73</volume>
        <fpage>70</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1016/j.artmed.2016.09.004</pub-id>
        <pub-id pub-id-type="pmid">27926382</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ammad-Ud-Din</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Wennerberg</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Aittokallio</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Systematic identification of feature combinations for predicting drug response with Bayesian multi-view multi-task linear regression</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>14</issue>
        <fpage>359</fpage>
        <lpage>368</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx266</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>Improved anticancer drug response prediction in cell lines using matrix factorization with similarity regularization</article-title>
        <source>BMC Cancer</source>
        <year>2017</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1186/s12885-016-3022-6</pub-id>
        <pub-id pub-id-type="pmid">28049525</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Polyakov</surname>
            <given-names>VR</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Perez</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Profile-QSAR 2.0: kinase virtual screening accuracy comparable to four-concentration ic50s for realistically novel compounds</article-title>
        <source>J Chem Inf Model</source>
        <year>2017</year>
        <volume>57</volume>
        <issue>8</issue>
        <fpage>2077</fpage>
        <lpage>2088</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.7b00166</pub-id>
        <pub-id pub-id-type="pmid">28651433</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ammad-Ud-Din</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Georgii</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gonen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Laitinen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kallioniemi</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Wennerberg</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Poso</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kaski</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Integrative and personalized QSAR analysis in cancer by kernelized Bayesian matrix factorization</article-title>
        <source>J Chem Inf Model</source>
        <year>2014</year>
        <volume>54</volume>
        <issue>8</issue>
        <fpage>2347</fpage>
        <lpage>2359</lpage>
        <pub-id pub-id-type="doi">10.1021/ci500152b</pub-id>
        <pub-id pub-id-type="pmid">25046554</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Xi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A novel heterogeneous network-based method for drug response prediction in cancer cell lines</article-title>
        <source>Sci Rep</source>
        <year>2018</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">29311619</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manica</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Oskooei</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Born</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Subramanian</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Sáez-Rodríguez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rodríguez Martínez</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Toward explainable anticancer compound sensitivity prediction via multimodal attention-based convolutional encoders</article-title>
        <source>Mol Pharm</source>
        <year>2019</year>
        <volume>16</volume>
        <issue>12</issue>
        <fpage>4797</fpage>
        <lpage>4806</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.molpharmaceut.9b00520</pub-id>
        <pub-id pub-id-type="pmid">31618586</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baptista</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Rocha</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Deep learning for drug response prediction in cancer</article-title>
        <source>Brief Bioinform</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>360</fpage>
        <lpage>379</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbz171</pub-id>
        <pub-id pub-id-type="pmid">31950132</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Bahdanau D, Cho K, Bengio Y. Neural machine translation by jointly learning to align and translate. 2014. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1409.0473">arXiv:1409.0473</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Deepcdr: a hybrid graph convolutional network for predicting cancer drug response</article-title>
        <source>Bioinformatics.</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>i911</fpage>
        <lpage>i918</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa822</pub-id>
        <pub-id pub-id-type="pmid">33381841</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>T-T</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>GTT</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Le</surname>
            <given-names>D-H</given-names>
          </name>
        </person-group>
        <article-title>Graph convolutional networks for drug response prediction</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinform</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1109/TCBB.2021.3060430</pub-id>
        <?supplied-pmid 34260355?>
        <pub-id pub-id-type="pmid">34260355</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Vaswani A, Shazeer N, Parmar N, Uszkoreit J, Jones L, Gomez AN, Kaiser L, Polosukhin I. Attention is all you need. 2017. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1706.03762">arXiv:1706.03762</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ghandi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>FW</given-names>
          </name>
          <name>
            <surname>Jané-Valbuena</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kryukov</surname>
            <given-names>GV</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>McDonald</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Barretina</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gelfand</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Bielski</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Next-generation characterization of the cancer cell line encyclopedia</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>569</volume>
        <issue>7757</issue>
        <fpage>503</fpage>
        <lpage>508</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1186-3</pub-id>
        <pub-id pub-id-type="pmid">31068700</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaulton</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bellis</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Bento</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Chambers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Davies</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hersey</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Light</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>McGlinchey</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Michalovich</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Al-Lazikani</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chembl: a large-scale bioactivity database for drug discovery</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>D1</issue>
        <fpage>1100</fpage>
        <lpage>1107</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr777</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gindulyte</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Shoemaker</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Thiessen</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pubchem 2019 update: improved access to chemical data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>1102</fpage>
        <lpage>1109</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1033</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Landrum</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <source>RDKit: open-source cheminformatics software</source>
        <year>2016</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Özgül</surname>
            <given-names>OF</given-names>
          </name>
          <name>
            <surname>Bardak</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ekşioğlu</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Sabuncuoğlu</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Drug response prediction by ensemble learning and drug-induced gene expression signatures</article-title>
        <source>Genomics</source>
        <year>2019</year>
        <volume>111</volume>
        <issue>5</issue>
        <fpage>1078</fpage>
        <lpage>1088</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ygeno.2018.07.002</pub-id>
        <pub-id pub-id-type="pmid">31533900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Kusner MJ, Paige B, Hernández-Lobato JM. Grammar variational autoencoder. In: International conference on machine learning, pp. 1945–1954;2017.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gómez-Bombarelli</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Duvenaud</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hernández-Lobato</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Sánchez-Lengeling</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sheberla</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Aguilera-Iparraguirre</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hirzel</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Adams</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Aspuru-Guzik</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Automatic chemical design using a data-driven continuous representation of molecules</article-title>
        <source>ACS Cent Sci</source>
        <year>2018</year>
        <volume>4</volume>
        <issue>2</issue>
        <fpage>268</fpage>
        <lpage>276</lpage>
        <pub-id pub-id-type="doi">10.1021/acscentsci.7b00572</pub-id>
        <pub-id pub-id-type="pmid">29532027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scarselli</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gori</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tsoi</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Hagenbuchner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Monfardini</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>The graph neural network model</article-title>
        <source>IEEE Trans Neural Networks</source>
        <year>2008</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>61</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1109/TNN.2008.2005605</pub-id>
        <pub-id pub-id-type="pmid">19068426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Li Y, Tarlow D, Brockschmidt M, Zemel R. Gated graph sequence neural networks. 2015. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1511.05493">arXiv:1511.05493</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Veličković P, Cucurull G, Casanova A, Romero A, Lio P, Bengio Y. Graph attention networks.2017. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1710.10903">arXiv:1710.10903</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsubaki</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tomii</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sese</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Compound-protein interaction prediction with end-to-end learning of neural networks for graphs and sequences</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>2</issue>
        <fpage>309</fpage>
        <lpage>318</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty535</pub-id>
        <pub-id pub-id-type="pmid">29982330</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>H-J</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>K-Y</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shin</surname>
            <given-names>J-M</given-names>
          </name>
        </person-group>
        <article-title>Cancer drug response profile scan (CDRscan): a deep learning model that predicts drug effectiveness from cancer genomic signature</article-title>
        <source>Sci Rep</source>
        <year>2018</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="pmid">29311619</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caruana</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Multitask learning</article-title>
        <source>Mach Learn</source>
        <year>1997</year>
        <volume>28</volume>
        <issue>1</issue>
        <fpage>41</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1007379606734</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guan</surname>
            <given-names>N-N</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C-C</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J-Q</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Piao</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Anticancer drug response prediction in cell lines using weighted graph regularized matrix factorization</article-title>
        <source>Mol Therapy-Nucleic Acids</source>
        <year>2019</year>
        <volume>17</volume>
        <fpage>164</fpage>
        <lpage>174</lpage>
        <pub-id pub-id-type="doi">10.1016/j.omtn.2019.05.017</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Futreal</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Coin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Down</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hubbard</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wooster</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rahman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Stratton</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>A census of human cancer genes</article-title>
        <source>Nat Rev Cancer</source>
        <year>2004</year>
        <volume>4</volume>
        <issue>3</issue>
        <fpage>177</fpage>
        <lpage>183</lpage>
        <pub-id pub-id-type="doi">10.1038/nrc1299</pub-id>
        <pub-id pub-id-type="pmid">14993899</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Szklarczyk</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gable</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Lyon</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Junge</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wyder</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Simonovic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Doncheva</surname>
            <given-names>NT</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>String v11: protein-protein association networks with increased coverage, supporting functional discovery in genome-wide experimental datasets</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>607</fpage>
        <lpage>613</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1131</pub-id>
        <pub-id pub-id-type="pmid">30335158</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ruvolo</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Mu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Leverson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Nichols</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Reed</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Konopleva</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Andreeff</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Synthetic lethality of combined Bcl-2 inhibition and p53 activation in AML: mechanisms and superior antileukemic efficacy</article-title>
        <source>Cancer Cell</source>
        <year>2017</year>
        <volume>32</volume>
        <issue>6</issue>
        <fpage>748</fpage>
        <lpage>760</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ccell.2017.11.003</pub-id>
        <pub-id pub-id-type="pmid">29232553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shimada</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Muneoka</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Nagahashi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ichikawa</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tajima</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hirose</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ando</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nakano</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sakata</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kameyama</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BRAF v600e and SRC mutations as molecular markers for predicting prognosis and conversion surgery in stage iv colorectal cancer</article-title>
        <source>Sci Rep</source>
        <year>2019</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="pmid">30626917</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
