<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10165836</article-id>
    <article-id pub-id-type="publisher-id">5304</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05304-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Model selection and robust inference of mutational signatures using Negative Binomial non-negative matrix factorization</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Pelizzola</surname>
          <given-names>Marta</given-names>
        </name>
        <address>
          <email>marta@math.au.dk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Laursen</surname>
          <given-names>Ragnhild</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hobolth</surname>
          <given-names>Asger</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.7048.b</institution-id><institution-id institution-id-type="ISNI">0000 0001 1956 2722</institution-id><institution>Department of Mathematics, </institution><institution>Aarhus University, </institution></institution-wrap>Aarhus, Denmark </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>187</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>4</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">The spectrum of mutations in a collection of cancer genomes can be described by a mixture of a few mutational signatures. The mutational signatures can be found using non-negative matrix factorization (NMF). To extract the mutational signatures we have to assume a distribution for the observed mutational counts and a number of mutational signatures. In most applications, the mutational counts are assumed to be Poisson distributed, and the rank is chosen by comparing the fit of several models with the same underlying distribution and different values for the rank using classical model selection procedures. However, the counts are often overdispersed, and thus the Negative Binomial distribution is more appropriate.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We propose a Negative Binomial NMF with a patient specific dispersion parameter to capture the variation across patients and derive the corresponding update rules for parameter estimation. We also introduce a novel model selection procedure inspired by cross-validation to determine the number of signatures. Using simulations, we study the influence of the distributional assumption on our method together with other classical model selection procedures. We also present a simulation study with a method comparison where we show that state-of-the-art methods are highly overestimating the number of signatures when overdispersion is present. We apply our proposed analysis on a wide range of simulated data and on two real data sets from breast and prostate cancer patients. On the real data we describe a residual analysis to investigate and validate the model choice.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">With our results on simulated and real data we show that our model selection procedure is more robust at determining the correct number of signatures under model misspecification. We also show that our model selection procedure is more accurate than the available methods in the literature for finding the true number of signatures. Lastly, the residual analysis clearly emphasizes the overdispersion in the mutational count data. The code for our model selection procedure and Negative Binomial NMF is available in the R package SigMoS and can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/MartaPelizzola/SigMoS">https://github.com/MartaPelizzola/SigMoS</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05304-1.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Cancer genomics</kwd>
      <kwd>Cross-validation</kwd>
      <kwd>Model checking</kwd>
      <kwd>Model selection</kwd>
      <kwd>Mutational signatures</kwd>
      <kwd>Negative Binomial</kwd>
      <kwd>Non-negative matrix factorization</kwd>
      <kwd>Poisson</kwd>
    </kwd-group>
    <kwd-group xml:lang="--">
      <title>AMS Classification</title>
      <kwd>92-08</kwd>
      <kwd>92-10</kwd>
      <kwd>62-08</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par4">Somatic mutations occur relatively often in the human genome and are mostly neutral. However, the accumulation of harmful mutations in a genome can lead to cancer. The summary of somatic mutations observed in a tumor is called a mutational profile and can often be associated with factors such as aging [<xref ref-type="bibr" rid="CR1">1</xref>], UV light [<xref ref-type="bibr" rid="CR2">2</xref>] or tobacco smoking [<xref ref-type="bibr" rid="CR3">3</xref>]. A mutational profile is thus a mixture of mutational processes that are represented by mutational signatures. Several signatures have been identified from the mutational profiles and associated with different cancer types [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. The importance of mutational signatures thus lies in their association with the mutational processes causing cancer. Having more insights into the causes of cancer is a prerequisite for better understanding the role that genetics plays in the development of the disease and eventually also for discovering potential treatment.</p>
    <p id="Par5">A common strategy to derive the mutational signatures is non-negative matrix factorization [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR8">8</xref>]. Different approaches to estimate the signature and the exposure matrices from mutational count data have been extensively described in [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>].</p>
    <p id="Par6">Non-negative matrix factorization (NMF) is a factorization of a given matrix <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V \in {\mathbb{N}}_0^{\text{N} \times \text{M}}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>V</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">N</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mtext>N</mml:mtext><mml:mo>×</mml:mo><mml:mtext>M</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq1.gif"/></alternatives></inline-formula> into the product of two non-negative matrices <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W \in {\mathbb{R}}_+^{\text{N} \times \text{K}}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>W</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mtext>N</mml:mtext><mml:mo>×</mml:mo><mml:mtext>K</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq2.gif"/></alternatives></inline-formula> and <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H \in {\mathbb{R}}_+^{\text{K} \times \text{M}}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>H</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mtext>K</mml:mtext><mml:mo>×</mml:mo><mml:mtext>M</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq3.gif"/></alternatives></inline-formula> such that<disp-formula id="Equ16"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}V \approx WH.\end{aligned}$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>V</mml:mi><mml:mo>≈</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula>The rank K of the lower-dimensional matrices <italic>W</italic> and <italic>H</italic> is much smaller than N and M.</p>
    <p id="Par7">In cancer genomics, the mutational matrix <italic>V</italic> contains the mutational counts for different patients, also referred to as mutational profiles. The number of rows N is the number of patients and the number of columns M is the number of different mutation types. In this paper we use the single-base-substitution-96 mutational context [<xref ref-type="bibr" rid="CR11">11</xref>] where <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{M} = 96$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mtext>M</mml:mtext><mml:mo>=</mml:mo><mml:mn>96</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq4.gif"/></alternatives></inline-formula> (corresponding to the 6 base mutations when assuming strand symmetry times the 4 flanking nucleotides on each side, i.e. <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4 \cdot 6 \cdot 4 = 96$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mn>4</mml:mn><mml:mo>·</mml:mo><mml:mn>6</mml:mn><mml:mo>·</mml:mo><mml:mn>4</mml:mn><mml:mo>=</mml:mo><mml:mn>96</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq5.gif"/></alternatives></inline-formula>). The matrix <italic>H</italic> consists of K mutational signatures defined by probability vectors over the different mutation types. In the matrix <italic>W</italic>, each row contains the weights of the signatures for the corresponding patient. In this context, the weights are usually referred to as the exposures of the different signatures.</p>
    <p id="Par8">To estimate <italic>W</italic> and <italic>H</italic> we need to choose a model and a rank K for the data <italic>V</italic>. These two decisions are highly related as the optimal rank of the data <italic>V</italic> is often chosen by comparing the fit under a certain model for many different values of K. The optimal K is then found using a model selection procedure such as Akaike Information Criterion (AIC), Bayesian Information Criterion (BIC) or similar approaches described in “<xref rid="Sec12" ref-type="sec">Estimating the number of signatures</xref>” section. Most methods used in the literature [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>] for choosing the rank are based on the likelihood value, which depends on the assumed model. For mutational counts the usual model assumption is the Poisson distribution [<xref ref-type="bibr" rid="CR6">6</xref>]<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} V_{nm} \sim \text{Po}((WH)_{nm}), \end{aligned}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Po</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>W</italic> and <italic>H</italic> are estimated using the algorithm from [<xref ref-type="bibr" rid="CR14">14</xref>] that minimizes the generalized Kullback–Leibler divergence. The algorithm is equivalent to maximum likelihood estimation, as the negative log-likelihood function for the Poisson model is equal to the generalized Kullback–Leibler up to an additive constant. We observe that this model assumption is often inadequate. In particular, we observe overdispersion in the mutational counts, i.e. a situation where the variance in the data is greater than what is expected under the assumed model. This is a well known issue when modeling count data in biology [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
    <p id="Par9">We therefore suggest using a model where the mutational counts follow a Negative Binomial distribution that has an additional parameter to explain the overdispersion in the data. In recent years, this model is becoming more popular to model the dispersion in mutational counts [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. The Negative Binomial NMF is discussed in [<xref ref-type="bibr" rid="CR18">18</xref>], where it is applied to recommender systems, and it has recently been used in the context of cancer mutations in [<xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR21">21</xref>]. In Lyu et al. [<xref ref-type="bibr" rid="CR20">20</xref>] a supervised Negative Binomial NMF model is applied to mutational counts from different cancers which uses cancer types as metadata. Their aim is to obtain signatures with a clear etiology, which could be used to classify different cancer types. Vöhringer et al. [<xref ref-type="bibr" rid="CR21">21</xref>] extends the analysis by including several genomic features and uses tensors instead of the mutational count matrix to account for the different features. Lastly, [<xref ref-type="bibr" rid="CR19">19</xref>] applies Bayesian inference to extract mutational signatures and provide different probabilistic models for the signatures. Among the models implemented in this method also the Negative Binomial model is considered as a natural extension of the Poisson model.</p>
    <p id="Par10">For mutational count data, we extend the Negative Binomial NMF model by including patient specific dispersion which has not been included in the aforementioned works using the Negative Binomial model. The extended model is referred to as NB<sub>N</sub>-NMF, where N is the number of dispersion parameters (equivalent to the number of patients). We investigate when and why NB<sub>N</sub>-NMF is more suitable for mutational counts than the usual Poisson NMF (Po-NMF). In particular we evaluate the goodness of fit for mutational counts using a residual-based approach. Despite the recent efforts, we still believe, as it has also been mentioned in [<xref ref-type="bibr" rid="CR22">22</xref>], that a great amount of research has been focusing on improving the performance of NMF algorithms given an underlying model and less attention has been directed to the choice of the underlying model given the data and application.</p>
    <p id="Par11">Since the number of signatures depends on the chosen distributional assumption, we suggest using NB<sub>N</sub>-NMF and we also propose a novel model selection framework to choose the number of signatures. We show that our model selection procedure is more robust toward inappropriate model assumptions compared to classical methods (AIC and BIC) and other methods currently used in the literature such as <inline-formula id="IEq9"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M16"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq9.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR23">23</xref>], <inline-formula id="IEq10"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SparseSignatures}$$\end{document}</tex-math><mml:math id="M18"><mml:mi mathvariant="monospace">SparseSignatures</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq10.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR8">8</xref>], <inline-formula id="IEq11"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigneR}$$\end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="monospace">SigneR</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq11.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR13">13</xref>], <inline-formula id="IEq12"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{sigfit}$$\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="monospace">sigfit</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq12.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR19">19</xref>], and <inline-formula id="IEq13"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SignatureAnalyzer}$$\end{document}</tex-math><mml:math id="M24"><mml:mi mathvariant="monospace">SignatureAnalyzer</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq13.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR24">24</xref>]. We use both simulated and real data to validate our proposed model selection procedure against other methods. We chose one classical data set and analyze it in “<xref rid="Sec6" ref-type="sec">Breast cancer data</xref>” section and a larger data set from prostate cancer (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). The latter is a subset of the available data from the Pan-Cancer Analysis of Whole Genomes (PCAWG) database [<xref ref-type="bibr" rid="CR25">25</xref>], thus it corresponds to one of the largest available data sets for a single cancer type.</p>
    <p id="Par12">In comparison to the results published in [<xref ref-type="bibr" rid="CR20">20</xref>] and in [<xref ref-type="bibr" rid="CR21">21</xref>], our work is not exploiting the information coming from different cancer types or from different genomic features. However, we provide a patient specific dispersion component to account for the high variance between patients and derive the update steps for parameter estimation in the NB<sub>N</sub>-NMF. Furthermore, we propose a model selection procedure which proves to be robust to model misspecification.</p>
    <p id="Par13">We have implemented our methods in the R package SigMoS (Signatures Model Selection) that includes NB<sub>N</sub>-NMF and the model selection procedure. The R package is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/MartaPelizzola/SigMoS">https://github.com/MartaPelizzola/SigMoS</ext-link>. The package also contains the simulated and real data used in this paper.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par14">In this section we describe the results of our approach on both simulated and real data. Details on the method are provided in “<xref rid="Sec9" ref-type="sec">Methods</xref>” section. In short, we propose a Negative Binomial model applied to mutational count data with a patient specific dispersion coefficient. The matrices <italic>W</italic> and <italic>H</italic> are estimated with a majorization–minimization (MM) procedure, and we propose to use Negative Binomial maximum likelihood estimation (MLE) for estimating the dispersion parameters. Additionally, we introduce a new algorithm based on cross-validation to estimate the number of signatures for a given data set.</p>
    <p id="Par15">For simulated data we present a study on Negative Binomial simulated data with different levels of dispersion where results from AIC, BIC, <inline-formula id="IEq16"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M26"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq16.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR23">23</xref>], <inline-formula id="IEq17"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SparseSignatures}$$\end{document}</tex-math><mml:math id="M28"><mml:mi mathvariant="monospace">SparseSignatures</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq17.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR8">8</xref>], <inline-formula id="IEq18"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigneR}$$\end{document}</tex-math><mml:math id="M30"><mml:mi mathvariant="monospace">SigneR</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq18.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR13">13</xref>], <inline-formula id="IEq19"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{sigfit}$$\end{document}</tex-math><mml:math id="M32"><mml:mi mathvariant="monospace">sigfit</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq19.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR19">19</xref>] and <inline-formula id="IEq20"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SignatureAnalyzer}$$\end{document}</tex-math><mml:math id="M34"><mml:mi mathvariant="monospace">SignatureAnalyzer</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq20.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR24">24</xref>] are compared with our proposed model selection procedure. These results are discussed in “<xref rid="Sec3" ref-type="sec">Simulation study</xref>” section, where we show that our method performs well and is robust to model misspecification. Our method is applied to the 21 breast cancer patients from [<xref ref-type="bibr" rid="CR6">6</xref>] in “<xref rid="Sec6" ref-type="sec">Breast cancer data</xref>” section, and to 286 prostate cancer patients from [<xref ref-type="bibr" rid="CR25">25</xref>] in “<xref rid="Sec7" ref-type="sec">Prostate cancer data</xref>” section. The goodness of fit of the different models are evaluated using a residual analysis that shows a clear overdispersion with the Poisson model. The use of residual plots to evaluate the goodness of fit is a common strategy in statistics; some examples can be found in [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>].</p>
    <sec id="Sec3">
      <title>Simulation study</title>
      <p id="Par16">We simulated our data following the procedure of [<xref ref-type="bibr" rid="CR8">8</xref>] using the signatures from [<xref ref-type="bibr" rid="CR5">5</xref>]. We simulated 100 data sets for each scenario and varied the number of patients, the number of signatures and the model for the noise in the mutational count data. We considered 20, 100 and 300 patients and either 5 or 10 signatures following [<xref ref-type="bibr" rid="CR28">28</xref>] which states that the number of common signatures in each organ is usually between 5 and 10. For each simulation run we use signature 1 and 5 from [<xref ref-type="bibr" rid="CR5">5</xref>], as they have been shown to be shared across all cancer types, and then we sample at random three or eight additional signatures from this set. The exposures are simulated from a Negative Binomial model with mean 6000 and dispersion parameter 1.5 as in [<xref ref-type="bibr" rid="CR8">8</xref>]. This choice is based on estimates from the real data in [<xref ref-type="bibr" rid="CR29">29</xref>]. The mutational count data is then generated as the product of the exposure and signature matrix. Lastly, Poisson noise, Negative Binomial noise with dispersion parameter <inline-formula id="IEq21"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \in \{10, 200\}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>α</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>200</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq21.gif"/></alternatives></inline-formula> or uniformly sampled in [10, 500] are added to the mutational counts. The values of the patient specific dispersion are inspired from the data set in “<xref rid="Sec6" ref-type="sec">Breast cancer data</xref>” section. A lower <inline-formula id="IEq22"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M38"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq22.gif"/></alternatives></inline-formula> is associated with higher dispersion, however the actual level of dispersion associated to a given <inline-formula id="IEq23"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M40"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq23.gif"/></alternatives></inline-formula> value depends on the absolute mutational counts as can be seen from the variance in Eq. (<xref rid="Equ5" ref-type="disp-formula">5</xref>). Therefore it is not possible to directly compare these values with the ones estimated for the real data.</p>
      <sec id="Sec4">
        <title>Simulation results</title>
        <p id="Par17">The effect of the model assumption on the estimated number of signatures using AIC, BIC (see Eqs. (<xref rid="Equ14" ref-type="disp-formula">14</xref>) and (<xref rid="Equ15" ref-type="disp-formula">15</xref>)) and SigMoS as model selection procedures is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Figure <xref rid="Fig1" ref-type="fig">1</xref>a summarizes results for all simulation studies and for each study. This figure displays the proportion of scenarios where the true number of signatures is correctly estimated from the different methods: the darker the green color the higher is this proportion. This shows that our proposed approach is estimating the number of signatures accurately and is much more robust to model misspecifications compared to AIC and BIC. For example, when the true model has a small dispersion of <inline-formula id="IEq24"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 200$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq24.gif"/></alternatives></inline-formula> and the Poisson model is assumed, the difference between the performance of SigMoS and of AIC and BIC is already substantial. Here, AIC and BIC are never estimating the true number of signatures correctly, whereas our SigMoS procedure estimates the correct number of signatures in most cases (<inline-formula id="IEq25"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 85\%$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>85</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq25.gif"/></alternatives></inline-formula>). The table also shows that the higher the dispersion in the model, the harder it is to estimate the true number of signatures even when the correct model is specified.<fig id="Fig1"><label>Fig. 1</label><caption><p>Results from AIC, BIC, and SigMoS based on Po-NMF and NB<sub>N</sub>-NMF using simulated data. Each method is applied on different simulated data sets for four different types of noise: Poisson and Negative Binomial with dispersion parameter <inline-formula id="IEq27"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 10, 200$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq27.gif"/></alternatives></inline-formula> and <inline-formula id="IEq28"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \sim U(10,500)$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mi>α</mml:mi><mml:mo>∼</mml:mo><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>500</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq28.gif"/></alternatives></inline-formula>. <bold>a</bold> The proportion of simulation runs where the number of signatures is correctly estimated. The true number of signatures varies in <inline-formula id="IEq29"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{5,10\}$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq29.gif"/></alternatives></inline-formula> and the number of patients in <inline-formula id="IEq30"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{20,100,300\}$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>300</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq30.gif"/></alternatives></inline-formula>. The rectangular boxes highlight the results shown in <bold>b</bold>. The results are based on 100 simulation runs for scenarios with 20 and 100 patients and on 20 simulation runs for scenarios with 300 patients. <bold>b</bold> The estimated number of signatures in the range from 2 to 20 for 100 patients, where the true number of signatures is five</p></caption><graphic xlink:href="12859_2023_5304_Fig1_HTML" id="MO3"/></fig></p>
        <p id="Par18">Figure <xref rid="Fig1" ref-type="fig">1</xref>b depicts the actual estimated number of signatures in the range from 2 to 20 for the 100 data sets with 5 signatures and 100 patients. This clearly shows that the higher the overdispersion in the model, the more is the number of signatures overestimated. Assuming Poisson in the case of <inline-formula id="IEq31"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 200$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq31.gif"/></alternatives></inline-formula> we see that AIC is already overestimating the number of signatures. Here, these additional signatures are needed to explain the noise that is not accounted for by the Poisson model. Having an even higher overdispersion makes both AIC and BIC highly overestimate the number of signatures to a value that is plausibly much higher than 20. Even high overdispersion does not influence our SigMoS procedure in the same way and our approach is still estimating the true number of signatures for a large proportion of the scenarios. Assuming the Negative Binomial model all of the three methods have a really high performance, as the Negative Binomial accounts for both low and high dispersion.</p>
        <p id="Par19">In the simulation study from Fig. <xref rid="Fig1" ref-type="fig">1</xref>b we also consider the accuracy of the MLE for the <inline-formula id="IEq32"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M56"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq32.gif"/></alternatives></inline-formula> value in the two scenarios where each patient has the same <inline-formula id="IEq33"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M58"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq33.gif"/></alternatives></inline-formula>. Our approach estimates the true <inline-formula id="IEq34"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M60"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq34.gif"/></alternatives></inline-formula> with high accuracy when the dispersion is high i.e.  <inline-formula id="IEq35"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\alpha }} \in [9.21, 11.78]$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>9.21</mml:mn><mml:mo>,</mml:mo><mml:mn>11.78</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq35.gif"/></alternatives></inline-formula> for <inline-formula id="IEq36"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 10$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq36.gif"/></alternatives></inline-formula>, <inline-formula id="IEq37"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M66"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq37.gif"/></alternatives></inline-formula> is slightly overestimated when the dispersion is low: for <inline-formula id="IEq38"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 200$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq38.gif"/></alternatives></inline-formula> we find <inline-formula id="IEq39"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\alpha }} \in [225.8, 292.7]$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>225.8</mml:mn><mml:mo>,</mml:mo><mml:mn>292.7</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq39.gif"/></alternatives></inline-formula>. However, according to Fig. <xref rid="Fig1" ref-type="fig">1</xref>b this small bias does not affect the performance of our model selection procedure.</p>
      </sec>
      <sec id="Sec5">
        <title>Method comparison</title>
        <p id="Par20">Several methods have been proposed in the literature for estimating the number of signatures in cancer data. In the following we present the results of a comparison between our method and four commonly used methods in the literature: <inline-formula id="IEq40"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M72"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq40.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR23">23</xref>], <inline-formula id="IEq41"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SparseSignatures}$$\end{document}</tex-math><mml:math id="M74"><mml:mi mathvariant="monospace">SparseSignatures</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq41.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR8">8</xref>], <inline-formula id="IEq42"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SignatureAnalyzer}$$\end{document}</tex-math><mml:math id="M76"><mml:mi mathvariant="monospace">SignatureAnalyzer</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq42.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR24">24</xref>], <inline-formula id="IEq43"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{sigfit}$$\end{document}</tex-math><mml:math id="M78"><mml:mi mathvariant="monospace">sigfit</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq43.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR19">19</xref>], and <inline-formula id="IEq44"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigneR}$$\end{document}</tex-math><mml:math id="M80"><mml:mi mathvariant="monospace">SigneR</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq44.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR13">13</xref>]. <inline-formula id="IEq45"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M82"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq45.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR23">23</xref>] extracts mutational signatures by applying NMF to 100 normalized Poisson resampled input matrices for different values for the number of signatures. The number of mutational signatures is then estimated by evaluating the stability of mutational signatures and choosing the solution with the lowest number of signatures among the stable solutions that describe the data well. <inline-formula id="IEq46"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SparseSignatures}$$\end{document}</tex-math><mml:math id="M84"><mml:mi mathvariant="monospace">SparseSignatures</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq46.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR8">8</xref>] provides an alternative cross-validation approach where the test set is defined by setting 1% of the entries in the count matrix to 0. Then NMF is iteratively applied to the modified count matrix and the entries are updated at each iteration. The resulting signature and exposure matrices are used to predict the entries of the matrix corresponding to the test set. <inline-formula id="IEq47"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SignatureAnalyzer}$$\end{document}</tex-math><mml:math id="M86"><mml:mi mathvariant="monospace">SignatureAnalyzer</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq47.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR24">24</xref>], on the other hand, proposes a procedure where a Bayesian model is used and maximum a posteriori estimates are found with a majorize-minimization algorithm. <inline-formula id="IEq48"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{sigfit}$$\end{document}</tex-math><mml:math id="M88"><mml:mi mathvariant="monospace">sigfit</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq48.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR19">19</xref>] presents an R package providing different options for extracting and refitting signatures and exposures by Bayesian inference under different models. They propose a framework where a Multinomial, Normal, Poisson or Negative Binomial model (with mutation type specific dispersion parameter) can be used. The number of signatures is estimated using the elbow method by looking at changes in the accuracy of re-estimating the data with the extracted signatures and exposures. In our comparison we use the Poisson and Negative Binomial models within the <inline-formula id="IEq49"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{sigfit}$$\end{document}</tex-math><mml:math id="M90"><mml:mi mathvariant="monospace">sigfit</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq49.gif"/></alternatives></inline-formula> package and refer to them as <inline-formula id="IEq50"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {sigfit\text{- }Po}$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mi mathvariant="monospace">sigfit</mml:mi><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">Po</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq50.gif"/></alternatives></inline-formula> and <inline-formula id="IEq51"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {sigfit\text{- }NB}$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mi mathvariant="monospace">sigfit</mml:mi><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">NB</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq51.gif"/></alternatives></inline-formula>. Lastly, with <inline-formula id="IEq52"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigneR}$$\end{document}</tex-math><mml:math id="M96"><mml:mi mathvariant="monospace">SigneR</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq52.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR13">13</xref>] an empirical Bayesian approach based on BIC is used to estimate the number of mutational signatures.</p>
        <p id="Par21">For our method comparison, we run all methods on the simulated data from Fig. <xref rid="Fig1" ref-type="fig">1</xref>b. For each method and simulation setup we only allow the number of signatures to vary from two to eight due to the long running time of some of these methods.</p>
        <p id="Par22">Figure <xref rid="Fig2" ref-type="fig">2</xref> shows that, when Poisson data are simulated almost all methods have a very good performance and can recover the true number of signatures in most of the simulations. The poor performance of <inline-formula id="IEq53"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SparseSignatures}$$\end{document}</tex-math><mml:math id="M98"><mml:mi mathvariant="monospace">SparseSignatures</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq53.gif"/></alternatives></inline-formula> could be affected by not having a fixed background signature. Indeed, the improved performance of <inline-formula id="IEq54"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SparseSignatures}$$\end{document}</tex-math><mml:math id="M100"><mml:mi mathvariant="monospace">SparseSignatures</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq54.gif"/></alternatives></inline-formula> when a background signature is included has also been shown in [<xref ref-type="bibr" rid="CR8">8</xref>]. <inline-formula id="IEq55"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {sigfit\text{- }Po}$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mi mathvariant="monospace">sigfit</mml:mi><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">Po</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq55.gif"/></alternatives></inline-formula> is based on a more heuristic method and tends to underestimate the true number of signatures. When Negative Binomial noise is added to the simulated data with a moderate dispersion (<inline-formula id="IEq56"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 200$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq56.gif"/></alternatives></inline-formula>), <inline-formula id="IEq57"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {sigfit\text{- }Po}$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mi mathvariant="monospace">sigfit</mml:mi><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">Po</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq57.gif"/></alternatives></inline-formula>, <inline-formula id="IEq58"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SignatureAnalyzer}$$\end{document}</tex-math><mml:math id="M108"><mml:mi mathvariant="monospace">SignatureAnalyzer</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq58.gif"/></alternatives></inline-formula> and <inline-formula id="IEq59"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigneR}$$\end{document}</tex-math><mml:math id="M110"><mml:mi mathvariant="monospace">SigneR</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq59.gif"/></alternatives></inline-formula> have low power emphasizing the importance of correctly specifying the distribution for these methods, whereas our proposed approach (regardless of the distributional assumption), <inline-formula id="IEq60"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {sigfit\text{- }NB}$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mi mathvariant="monospace">sigfit</mml:mi><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">NB</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq60.gif"/></alternatives></inline-formula>, <inline-formula id="IEq61"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M114"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq61.gif"/></alternatives></inline-formula> and <inline-formula id="IEq62"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SparseSignatures}$$\end{document}</tex-math><mml:math id="M116"><mml:mi mathvariant="monospace">SparseSignatures</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq62.gif"/></alternatives></inline-formula> maintain good power. For patient specific dispersion also the power of <inline-formula id="IEq63"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SparseSignatures}$$\end{document}</tex-math><mml:math id="M118"><mml:mi mathvariant="monospace">SparseSignatures</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq63.gif"/></alternatives></inline-formula> and <inline-formula id="IEq64"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M120"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq64.gif"/></alternatives></inline-formula> decreases. Lastly, the power of <inline-formula id="IEq65"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {sigfit\text{- }NB}$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mi mathvariant="monospace">sigfit</mml:mi><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">NB</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq65.gif"/></alternatives></inline-formula> decreases for high dispersion (<inline-formula id="IEq66"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 10$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq66.gif"/></alternatives></inline-formula>): here the distributional assumptions are correctly specified, however this is a heuristic approach to estimate the number of signatures which tends to be less precise than SigMoS. Indeed, good performance is achieved with our proposed approach even under high dispersion if the correct distribution is assumed. These results demonstrate that SigMoS is accurate for detecting the correct number of signatures and it performs well also in situations with overdispersion compared to other methods.<fig id="Fig2"><label>Fig. 2</label><caption><p>Method comparison using simulated data. Each method is applied on the data sets from Fig. <xref rid="Fig1" ref-type="fig">1</xref>b and, for each data set, the value of the estimated number of signatures is kept. We test values for the number of signatures from two to eight for Poisson noise and Negative Binomial noise with <inline-formula id="IEq67"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = \{10, 200 \}$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>200</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq67.gif"/></alternatives></inline-formula>, and a patient specific dispersion parameter <inline-formula id="IEq68"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \sim U(10,500)$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mi>α</mml:mi><mml:mo>∼</mml:mo><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>500</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq68.gif"/></alternatives></inline-formula></p></caption><graphic xlink:href="12859_2023_5304_Fig2_HTML" id="MO4"/></fig></p>
        <p id="Par23">For this set of simulations we also checked the quality of the estimated signatures. We sampled 10 runs for each scenario from Fig. <xref rid="Fig2" ref-type="fig">2</xref> and calculated the cosine similarity between the estimated signatures and the true ones used for simulations. The results for all methods are shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref> where we display the average cosine similarity over 10 runs for each method and each scenario. For this study we fixed the number of signatures to five for all methods, which may favour methods such as <inline-formula id="IEq69"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SignatureAnalyzer}$$\end{document}</tex-math><mml:math id="M130"><mml:mi mathvariant="monospace">SignatureAnalyzer</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq69.gif"/></alternatives></inline-formula>, <inline-formula id="IEq70"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{sigfit}$$\end{document}</tex-math><mml:math id="M132"><mml:mi mathvariant="monospace">sigfit</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq70.gif"/></alternatives></inline-formula> or <inline-formula id="IEq71"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigneR}$$\end{document}</tex-math><mml:math id="M134"><mml:mi mathvariant="monospace">SigneR</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq71.gif"/></alternatives></inline-formula> that usually overestimate the number of signatures. Nonetheless, these results also show that SigMoS combined with the Negative Binomial model and <inline-formula id="IEq72"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {sigfit\text{- }NB}$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:mi mathvariant="monospace">sigfit</mml:mi><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">NB</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq72.gif"/></alternatives></inline-formula> are the methods that are able to retain the highest accuracy also with high levels of overdispersion (namely <inline-formula id="IEq73"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 10$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq73.gif"/></alternatives></inline-formula>). <inline-formula id="IEq74"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M140"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq74.gif"/></alternatives></inline-formula> and <inline-formula id="IEq75"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigneR}$$\end{document}</tex-math><mml:math id="M142"><mml:mi mathvariant="monospace">SigneR</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq75.gif"/></alternatives></inline-formula> also show good accuracy especially when the overdispersion is low and under the Poisson model. These results, combined with those in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, show that for real data where the variance may be higher than the one accounted for under the Poisson model, using a Negative Binomial model is essential. Indeed, this distributional assumption leads to high accuracy in the estimated signatures and SigMoS combined with the Negative Binomial model is able to maintain high accuracy and also correctly infer the true number of signatures.<fig id="Fig3"><label>Fig. 3</label><caption><p>Quality of estimated signatures using simulated data. Each method is applied on 10 randomly sampled data sets from Fig. <xref rid="Fig1" ref-type="fig">1</xref>b and, for each data set, the value of the estimated number of signatures is fixed to 5. We show the quality of the estimated signatures measured by cosine similarity for all methods with Poisson noise and Negative Binomial noise with <inline-formula id="IEq76"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 10, 200$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq76.gif"/></alternatives></inline-formula>, and a patient specific dispersion parameter <inline-formula id="IEq77"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \sim U(10,500)$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:mi>α</mml:mi><mml:mo>∼</mml:mo><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>500</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq77.gif"/></alternatives></inline-formula></p></caption><graphic xlink:href="12859_2023_5304_Fig3_HTML" id="MO5"/></fig></p>
        <p id="Par24">We additionally compared our method to an independent set of simulated data from [<xref ref-type="bibr" rid="CR30">30</xref>]. Here, the authors propose an alternative cross-validation procedure for estimating the number of signatures and describe a method comparison where <inline-formula id="IEq78"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M148"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq78.gif"/></alternatives></inline-formula>, <inline-formula id="IEq79"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SignatureAnalyzer}$$\end{document}</tex-math><mml:math id="M150"><mml:mi mathvariant="monospace">SignatureAnalyzer</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq79.gif"/></alternatives></inline-formula> and <inline-formula id="IEq80"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigneR}$$\end{document}</tex-math><mml:math id="M152"><mml:mi mathvariant="monospace">SigneR</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq80.gif"/></alternatives></inline-formula> are included. We considered their 20 simulated data sets comprising of 200 patients and 9 signatures each and we run SigMoS under both the Negative Binomial and the Poisson model. The signatures used for this set of simulations have been taken from the PCAWG breast cancer study [<xref ref-type="bibr" rid="CR4">4</xref>] where two pairs of signatures are highly similar, namely signatures SBS1 and SBS5 as well as SBS2 and SBS13, and their exposures have been resampled jointly when generating the data. It is not surprising that our method often estimates less than 9 signatures (7 or 8 signatures are reconstructed in most of the scenarios). We compared these results to the ones in [<xref ref-type="bibr" rid="CR30">30</xref>] where a method based on cross-validation is proposed to estimate the number of signatures. Here, an extensive method comparison is available showing the accuracy in estimating the true signatures. We provide similar results in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S1 and S2 where our method is run with Po-NMF and NB<sub>N</sub>-NMF. Comparing these results to Fig. S9 in [<xref ref-type="bibr" rid="CR30">30</xref>], we can see that most methods tend to estimate less than 9 signatures and that the accuracy of the signatures estimated by SigMoS is always higher or comparable to the ones estimated by the other methods.</p>
        <p id="Par25">These results indicate that our proposed approach is robust to different simulation set ups, has very good performance on a wide range of scenarios, and provides more accurate estimates of the underlying number of signatures and of the actual mutational signatures when compared to other methods available in the literature, suggesting that it will also be robust when applied to real data. Computational cost results for our method in terms of memory usage and time until convergence as a function of the number of patients are available in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S2. SigMoS runs on a standard laptop with Intel Core i7 processor in less than a few minutes and uses less than 25 gigabase of memory for data sets with up to 500 patients and 5 signatures. Both memory consumption and running time increase linearly with the number of patients, but even large data sets can be run fairly quickly on a standard laptop (for 1000 patients SigMoS used up to 100 GB and the running time went up to 7 min for the slowest scenarios).</p>
      </sec>
    </sec>
    <sec id="Sec6">
      <title>Breast cancer data</title>
      <p id="Par26">This data set consists of the mutational counts from the 21 breast cancer patients that has previously been described and analyzed in several papers [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. The data can be found through the link <ext-link ext-link-type="uri" xlink:href="ftp://ftp.sanger.ac.uk/pub/cancer/AlexandrovEtAl">ftp://ftp.sanger.ac.uk/pub/cancer/AlexandrovEtAl</ext-link> from [<xref ref-type="bibr" rid="CR11">11</xref>] and have been extensively analyzed in [<xref ref-type="bibr" rid="CR4">4</xref>].</p>
      <p id="Par27">In Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, we have applied SigMoS and BIC to choose the number of signatures for both Po-NMF and NB<sub>N</sub>-NMF. We have included the BIC to compare with the SigMoS method as it provides similar results to the state-of-the-art methods. SigMoS indicates to use three signatures for both methods. This is in line with the results of our simulation study, where we show that our model selection is robust to model misspecification. According to BIC, six signatures are needed for Po-NMF whereas only three signatures should be used with NB<sub>N</sub>-NMF which emphasizes the importance of a correct model choice when using BIC. In this framework and in “<xref rid="Sec7" ref-type="sec">Prostate cancer data</xref>” section we compared SigMoS to BIC, as Fig. <xref rid="Fig1" ref-type="fig">1</xref> shows that this is more robust than AIC. BIC is also often used as model selection criteria in the analysis of real data sets in the literature. We refer to “<xref rid="Sec5" ref-type="sec">Method comparison</xref>” section for comparisons with other state-of-the-art methods.<fig id="Fig4"><label>Fig. 4</label><caption><p>Results for Po-NMF and NB<sub>N</sub>-NMF applied to a data set with 21 breast cancer patients. <bold>a</bold> The optimal number of signatures estimated from SigMoS and BIC when using Po-NMF and NB<sub>N</sub>-NMF. <bold>b</bold> The residual plots for Po-NMF and <inline-formula id="IEq87"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M154"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq87.gif"/></alternatives></inline-formula>-NMF when assuming the estimated number of signatures from SigMoS i.e. 3 signatures in both cases. The lines in the top plot correspond to two times the expected variance under the chosen distributional assumption. As the <inline-formula id="IEq88"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq88.gif"/></alternatives></inline-formula>-NMF holds 21 different expected variances, we have chosen to plot the median, minimum and maximum variance among the 21. The second plots show the normalized residuals. The vertical blue and red lines depict the theoretical quantiles and the gray lines show the observed quantiles</p></caption><graphic xlink:href="12859_2023_5304_Fig4_HTML" id="MO6"/></fig></p>
      <p id="Par28">For three signatures we show in Fig. <xref rid="Fig4" ref-type="fig">4</xref>b the corresponding raw residuals <inline-formula id="IEq89"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{nm} = V_{nm} - (WH)_{nm}$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq89.gif"/></alternatives></inline-formula> to determine the best fitting model. The residuals are plotted against the expected mean <inline-formula id="IEq90"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(WH)_{nm}$$\end{document}</tex-math><mml:math id="M160"><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq90.gif"/></alternatives></inline-formula>, as the variance in both the Poisson and Negative Binomial model depends on this value. The colored lines in the residual plots correspond to <inline-formula id="IEq91"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm 2\sigma$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mo>±</mml:mo><mml:mn>2</mml:mn><mml:mi>σ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq91.gif"/></alternatives></inline-formula> for the Poisson and the Negative Binomial distribution, respectively. The variance <inline-formula id="IEq92"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma ^2$$\end{document}</tex-math><mml:math id="M164"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq92.gif"/></alternatives></inline-formula> can be derived from Eq. (<xref rid="Equ5" ref-type="disp-formula">5</xref>) for the Negative Binomial model and is equal to the mean for the Poisson model.</p>
      <p id="Par29">For Po-NMF we observe a clear overdispersion in the residuals, which suggests to use a Negative Binomial model. In the residual plot for the <inline-formula id="IEq93"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M166"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq93.gif"/></alternatives></inline-formula>-NMF we see that the residuals have a much better fit to the variance structure, which is indicated by the colored lines. The quantile lines in the lower panel with normalized residuals again show that the quantiles from the <inline-formula id="IEq94"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M168"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq94.gif"/></alternatives></inline-formula>-NMF are much closer to the theoretical ones, suggesting that the Negative Binomial model is better suited for this data. The patient specific dispersion is very diverse in this data as the <inline-formula id="IEq95"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M170"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq95.gif"/></alternatives></inline-formula> values for the first 20 patients are between 16 (very high dispersion) and 550 (moderate dispersion) and the last patient has <inline-formula id="IEq96"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _{21} = 26083$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>21</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>26083</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq96.gif"/></alternatives></inline-formula>.</p>
      <p id="Par30">We compare the signatures found by our method to the available signatures in the COSMIC database [<xref ref-type="bibr" rid="CR5">5</xref>] downloaded from <ext-link ext-link-type="uri" xlink:href="https://cancer.sanger.ac.uk/cosmic">https://cancer.sanger.ac.uk/cosmic</ext-link>. We find that our three reconstructed signatures are similar to signatures SBS1, SBS2, SBS3. The corresponding cosine similarities are reported in Table <xref rid="Tab1" ref-type="table">1</xref> and show high similarity between our reconstructed signatures and the ones from the COSMIC database especially for SBS2 and SBS3. Indeed, a cosine similarity of 0.8 has been used as threshold in [<xref ref-type="bibr" rid="CR31">31</xref>] to group similar signatures, suggesting that SigMoS is able to identify relevant signatures in the COSMIC database. According to the results in [<xref ref-type="bibr" rid="CR4">4</xref>] SBS1 and SBS2 are found across most cancer types and a large proportion of breast cancer samples showing these two signatures has been found. SBS3 has also been found in a large proportion of breast cancer samples and it also has high mutational burden in breast cancer tumors. SBS3 has also been associated to the BRCA1/2 mutation [<xref ref-type="bibr" rid="CR4">4</xref>]. The validation of our signatures with the COSMIC database shows that in this case SigMoS can correctly infer signatures that have been proved to be strongly associated with breast cancer.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Cosine similarity for the breast cancer data set between the signatures extracted by SigMoS and the ones in the COSMIC database</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">SBS1</th><th align="left">SBS2</th><th align="left">SBS3</th></tr></thead><tbody><tr><td align="left">Po-NMF</td><td align="left">0.65</td><td align="left">0.76</td><td align="left">0.79</td></tr><tr><td align="left"><inline-formula id="IEq97"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M174"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq97.gif"/></alternatives></inline-formula>-NMF</td><td align="left">0.62</td><td align="left">0.76</td><td align="left">0.80</td></tr></tbody></table><table-wrap-foot><p>The COSMIC signature with the highest cosine similarity is shown for each signature estimated by SigMoS</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec7">
      <title>Prostate cancer data</title>
      <p id="Par31">We also considered a more recent data set from the Pan-Cancer Analysis of Whole Genomes (PCAWG) database [<xref ref-type="bibr" rid="CR25">25</xref>] where 2782 patients from different cancer types are available. The mutational counts from the full PCAWG database can be found at <ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#%21Synapse:syn11726620">https://www.synapse.org/#!Synapse:syn11726620</ext-link>. From this data set, we extracted mutational counts for all the 286 prostate cancer patients and used them directly for our analysis.</p>
      <p id="Par32">We chose again both the Poisson and Negative Binomial as underlying distributions for the NMF and in both cases we applied SigMoS for determining the number of signatures. We present the results in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. Figure <xref rid="Fig5" ref-type="fig">5</xref>a shows again that our model selection procedure is more stable under model misspecification compared to BIC: the estimated number of signatures is changing from 9 to 4 between the two model assumptions for BIC, but only from 6 to 5 for SigMoS. As for Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, the residuals in Fig. <xref rid="Fig5" ref-type="fig">5</xref>b show that the <inline-formula id="IEq98"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M176"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq98.gif"/></alternatives></inline-formula>-NMF model provides a much better fit to the data than the Po-NMF. The estimated values for the patient specific dispersion are <inline-formula id="IEq99"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _n \in [1.4,4279]$$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1.4</mml:mn><mml:mo>,</mml:mo><mml:mn>4279</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq99.gif"/></alternatives></inline-formula> with a median of 140 (corresponding to a quite large dispersion).<fig id="Fig5"><label>Fig. 5</label><caption><p>Results for Po-NMF and <inline-formula id="IEq100"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M180"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq100.gif"/></alternatives></inline-formula>-NMF applied to a data set with 286 prostate cancer patients from the PCAWG database [<xref ref-type="bibr" rid="CR25">25</xref>]. <bold>a</bold> The optimal number of signatures estimated from SigMoS and BIC when using Po-NMF and <inline-formula id="IEq101"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M182"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq101.gif"/></alternatives></inline-formula>-NMF. <bold>b</bold> The residual plots for Po-NMF and <inline-formula id="IEq102"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M184"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq102.gif"/></alternatives></inline-formula>-NMF when assuming the estimated number of signatures from SigMoS i.e. 5 and 6 signatures. The lines in the first plot correspond to two times the expected variance under the chosen distributional assumption. For <inline-formula id="IEq103"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M186"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq103.gif"/></alternatives></inline-formula>-NMF, the colored lines in the top plot show the median, minimum and maximum variance among the patients. The bottom plots show the normalized residuals. The vertical blue and red lines depict the theoretical quantiles and the gray lines the observed quantiles</p></caption><graphic xlink:href="12859_2023_5304_Fig5_HTML" id="MO7"/></fig></p>
      <p id="Par33">As for the previous section we compare our reconstructed signatures with the ones in the COSMIC database. Table <xref rid="Tab2" ref-type="table">2</xref> shows the cosine similarity between the signatures extracted by SigMoS and the most similar ones from the COSMIC repository. Here, <inline-formula id="IEq104"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M188"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq104.gif"/></alternatives></inline-formula>-NMF provides much better results in terms of signatures estimation showing the importance of accounting for overdispersion. Indeed, <inline-formula id="IEq105"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M190"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq105.gif"/></alternatives></inline-formula>-NMF finds signatures SBS1, SBS5, SBS8, SBS18, SBS37. These signatures are all largely present in prostate cancer either for their presence in many prostate tumor samples or for their contribution in terms of number of mutations per tumor or for both reasons combined. On the contrary, signatures SBS6 and SBS36 are not found in prostate cancer, showing that <inline-formula id="IEq106"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M192"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq106.gif"/></alternatives></inline-formula>-NMF is more accurate.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Cosine similarity for the Prostate cancer data set between the signatures extracted by SigMoS and the ones in the COSMIC database</p></caption><graphic position="anchor" xlink:href="12859_2023_5304_Tab2_HTML" id="MO10"/><table-wrap-foot><p>The COSMIC signature with the highest cosine similarity is shown for each signature estimated by SigMoS. Signatures found in many prostate samples or having high mutation counts on prostate samples are highlighted in colour in the table</p></table-wrap-foot></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p id="Par34">Mutational profiles from cancer patients are a widely used source of information and NMF is often applied to these data in order to identify signatures associated with cancer types. We propose a new approach to perform the analysis and signature extraction from mutational count data where we emphasize the importance of validating the model using residual analysis, and we propose a robust model selection procedure.</p>
    <p id="Par35">We use the Negative Binomial model as an alternative to the commonly used Poisson model as the Negative Binomial can account for the high dispersion in the data. As a further extension of this model, we allow the Negative Binomial to have a patient specific variability component to account for heterogeneous variance across patients.</p>
    <p id="Par36">We propose a model selection approach for choosing the number of signatures. As we show in “<xref rid="Sec3" ref-type="sec">Simulation study</xref>” section this method works well with both Negative Binomial and Poisson data, and it is a robust procedure for choosing the number of signatures. We note that the choice of the divergence measure for the <italic>cost</italic> function in Algorithm 2 is not trivial and may favor one or the other model and thus a comparison of the costs between different NMF methods is not possible. For example, in our framework, we use the Kullback–Leibler divergence which would favor the Poisson model. This means that a direct comparison between the cost values for Po-NMF and <inline-formula id="IEq108"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M194"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq108.gif"/></alternatives></inline-formula>-NMF is not feasible. To check the goodness of fit and choose between the Poisson model and the Negative Binomial model we propose to use the residuals instead.</p>
    <p id="Par37">In Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S4, we investigated the role of the cost function in our model selection by including the Frobenius norm and Itakura–Saito (IS) [<xref ref-type="bibr" rid="CR32">32</xref>] divergence measure from [<xref ref-type="bibr" rid="CR33">33</xref>], where the authors propose a fast implementation of the NMF algorithm with general Bregman divergence. In this investigation the cost function did not influence the optimal number of signatures. The only difference was how the cost values differed among the NMF methods, as each cost function favored the models differently. Therefore we chose to use the Kullback–Leibler divergence and compared the methods with the residual analysis.</p>
    <p id="Par38">Less signatures are found when accounting for overdispersion with the Negative Binomial model. Indeed, there is no need to have additional signatures explaining noise, which we assume is the case for the Poisson model. We show that the Negative Binomial model is more suitable and therefore believe the corresponding signatures are more accurate. This can be helpful when working with mutational profiles for being able to better associate signatures with cancer types and for a clearer interpretation of the signatures when analyzing mutational count data. For example, the recent results in [<xref ref-type="bibr" rid="CR28">28</xref>] use a large data set with several different cancer types and show that there exists a set of common signatures that is shared across organs and a set of rare signatures that are only found with a sufficiently large sample size. To recover the common signatures the patients with unusual mutational profiles were excluded as they are introducing additional variance in the signature estimation procedure. We speculate that changing the Poisson assumption in this approach with the Negative Binomial distribution could provide a simpler and more robust way to extract common signatures. Indeed, the Negative Binomial model allows for more variability in the data and our simulation results and residual plots in “<xref rid="Sec2" ref-type="sec">Results</xref>” section show that the Negative Binomial distribution is beneficial for stable signature estimation. In this work we have focused on single base substitutions, but the Negative Binomial NMF can be highly beneficial also for analyzing indels or other variant types. In [<xref ref-type="bibr" rid="CR4">4</xref>] they discuss that mutational matrices corresponding to indels harbor more variation which means that more flexible models than the Poisson are needed in this situation.</p>
    <p id="Par39">The workflow for analyzing the data, and the procedures in Algorithms 1 and 2 are available in the R package SigMoS at <ext-link ext-link-type="uri" xlink:href="https://github.com/MartaPelizzola/SigMoS">https://github.com/MartaPelizzola/SigMoS</ext-link>.</p>
  </sec>
  <sec id="Sec9">
    <title>Methods</title>
    <p id="Par40">This section is structured as follows: in “<xref rid="Sec10" ref-type="sec">Negative Binomial model for mutational counts</xref>” section we describe the Negative Binomial model applied to mutational count data. Then we propose an extension where a patient specific dispersion coefficient is used. The majorization–minimization (MM) procedure for patient specific dispersion <inline-formula id="IEq109"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ \alpha _1, \ldots , \alpha _N \}$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq109.gif"/></alternatives></inline-formula> can be found in “<xref rid="Sec11" ref-type="sec">Patient specific NB<sub>N</sub>-NMF</xref>” section. In our application, we propose to use Negative Binomial maximum likelihood estimation (MLE) for <inline-formula id="IEq110"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M198"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq110.gif"/></alternatives></inline-formula> and <inline-formula id="IEq111"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ \alpha _n: 1 \le n \le N \}$$\end{document}</tex-math><mml:math id="M200"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq111.gif"/></alternatives></inline-formula> instead of the grid search adopted in [<xref ref-type="bibr" rid="CR18">18</xref>]. The pseudocode shown in the initial steps of Algorithm 1 describes this approach for patient specific dispersion. For shared dispersion among all patients and mutation types we simply set <inline-formula id="IEq112"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = \alpha _1 = \cdots = \alpha _N$$\end{document}</tex-math><mml:math id="M202"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq112.gif"/></alternatives></inline-formula> in Algorithm 1. Lastly, in “<xref rid="Sec12" ref-type="sec">Estimating the number of signatures</xref>” section we describe our proposed algorithm to estimate the number of signatures.</p>
    <sec id="Sec10">
      <title>Negative Binomial model for mutational counts</title>
      <p id="Par41">In this section we argue why the Negative Binomial model in [<xref ref-type="bibr" rid="CR18">18</xref>] is a natural model for the number of somatic mutations in a cancer patient. We start by illustrating the equivalence of the Negative Binomial to the more natural Beta-Binomial model as a motivation for our model choice.</p>
      <p id="Par42">Assume a certain mutation type can occur in <inline-formula id="IEq113"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M204"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq113.gif"/></alternatives></inline-formula> triplets along the genome with a probability <italic>p</italic>. Then it is natural to model the mutational counts with a binomial distribution [<xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR35">35</xref>]<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} V_{nm} \sim \text{Bin}(\tau ,p). \end{aligned}$$\end{document}</tex-math><mml:math id="M206" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Bin</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>However, [<xref ref-type="bibr" rid="CR36">36</xref>] observed that the probability of a mutation varies along the genome and is correlated with both expression levels and DNA replication timing. We therefore introduce the Beta-Binomial model<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} V_{nm}|&amp;p \sim \text{Bin}( \tau , p) \\&amp;p \sim \text{Beta}(\alpha , \beta ), \end{aligned} \end{aligned}$$\end{document}</tex-math><mml:math id="M208" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∼</mml:mo><mml:mtext>Bin</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where the beta prior on the probability <italic>p</italic> models the heterogeneity of the probability of a mutation for the different mutation types due to the high variance along the genome. As <italic>p</italic> follows a Beta distribution, its expected value is <inline-formula id="IEq114"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbb{E}[p] = {\alpha }/{(\alpha + \beta )}$$\end{document}</tex-math><mml:math id="M210"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq114.gif"/></alternatives></inline-formula>. For mutational counts, the number of triplets <inline-formula id="IEq115"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M212"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq115.gif"/></alternatives></inline-formula> is extremely large and the probability of mutation <italic>p</italic> is very small. In the data described in [<xref ref-type="bibr" rid="CR36">36</xref>] there are typically between 1 and 10 mutations per megabase with an average of 4 mutations per megabase (<inline-formula id="IEq116"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau \approx 10^6$$\end{document}</tex-math><mml:math id="M214"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>≈</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq116.gif"/></alternatives></inline-formula>). This means <inline-formula id="IEq117"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbb{E}[p] = {\alpha }/{(\alpha + \beta )} \approx 4 \cdot 10^{-6}$$\end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mn>4</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq117.gif"/></alternatives></inline-formula> and thus, for mutational counts in cancer genomes we have that <inline-formula id="IEq118"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta&gt;&gt; \alpha$$\end{document}</tex-math><mml:math id="M218"><mml:mrow><mml:mi>β</mml:mi><mml:mo>&gt;</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq118.gif"/></alternatives></inline-formula>. As <inline-formula id="IEq119"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M220"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq119.gif"/></alternatives></inline-formula> is large and <italic>p</italic> is small, the Binomial model is very well approximated by the Poisson model <inline-formula id="IEq120"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{Bin}(\tau , p) \backsimeq \text{Pois}(\tau p)$$\end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:mtext>Bin</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋍</mml:mo><mml:mtext>Pois</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq120.gif"/></alternatives></inline-formula>. This distributional equivalence of Poisson and Binomial when <inline-formula id="IEq121"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M224"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq121.gif"/></alternatives></inline-formula> is large and <italic>p</italic> is small is well known. This also means that the models (<xref rid="Equ1" ref-type="disp-formula">1</xref>) and (<xref rid="Equ2" ref-type="disp-formula">2</xref>) are approximately equivalent with <inline-formula id="IEq122"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau p = (WH)_{nm}$$\end{document}</tex-math><mml:math id="M226"><mml:mrow><mml:mi>τ</mml:mi><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq122.gif"/></alternatives></inline-formula>.</p>
      <p id="Par43">The Beta and Gamma distributions are also approximately equivalent in our setting. Indeed, as <inline-formula id="IEq123"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta&gt;&gt; \alpha$$\end{document}</tex-math><mml:math id="M228"><mml:mrow><mml:mi>β</mml:mi><mml:mo>&gt;</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq123.gif"/></alternatives></inline-formula>, the Beta density can be approximated by the Gamma density in the following way<disp-formula id="Equ17"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{p^{\alpha - 1}(1-p)^{\beta - 1}}{B(\alpha , \beta )}&amp;= \frac{p^{\alpha - 1}}{\Gamma (\alpha )} (\beta -1+\alpha )(\beta -1 + (\alpha -1)) \cdots (\beta -1) (1-p)^{\beta - 1} \\&amp;\approx \frac{p^{\alpha - 1}}{\Gamma (\alpha )} \beta ^\alpha (e^{-p})^{\beta }. \end{aligned}$$\end{document}</tex-math><mml:math id="M230" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⋯</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>≈</mml:mo><mml:mfrac><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mi>β</mml:mi><mml:mi>α</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>β</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula>Therefore, for mutational counts, the model in (<xref rid="Equ3" ref-type="disp-formula">3</xref>) is equivalent to<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} V_{nm}|&amp;p \sim \text{Po}( \tau p) \\&amp;p \sim \text{Gamma}(\alpha , \beta ). \end{aligned} \end{aligned}$$\end{document}</tex-math><mml:math id="M232" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∼</mml:mo><mml:mtext>Po</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∼</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>Since the Negative Binomial model is a Gamma–Poisson model we can also write the model as<disp-formula id="Equ18"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} V_{nm} \sim \text{NB} \left( \alpha , \frac{\tau }{\beta + \tau }\right) \backsimeq \text{NB} \left( \alpha , \frac{ \tau \mathbb{E}[ p]}{\alpha + \tau \mathbb{E}[p]}\right) \backsimeq \text{NB}\left( \alpha , \frac{(WH)_{nm}}{\alpha + (WH)_{nm}} \right) ,\end{aligned}$$\end{document}</tex-math><mml:math id="M234" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>NB</mml:mtext><mml:mfenced close=")" open="("><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mfrac><mml:mi>τ</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>⋍</mml:mo><mml:mtext>NB</mml:mtext><mml:mfenced close=")" open="("><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mi>τ</mml:mi><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>⋍</mml:mo><mml:mtext>NB</mml:mtext><mml:mfenced close=")" open="("><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula>where the last parametrization is equivalent to the one in [<xref ref-type="bibr" rid="CR18">18</xref>]. In the first distributional equivalence we use <inline-formula id="IEq124"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbb{E}[p] \approx \frac{\alpha }{\beta }$$\end{document}</tex-math><mml:math id="M236"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mfrac><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq124.gif"/></alternatives></inline-formula> and in the second we use <inline-formula id="IEq125"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau \mathbb{E}[ p] = (WH)_{nm}$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:mi>τ</mml:mi><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq125.gif"/></alternatives></inline-formula>. Compared to the Beta-Binomial model, the Negative Binomial model has one fewer parameter and is analytically more tractable. The mean and variance of this model are given by<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathbb{E}[V_{nm}] = (WH)_{nm} \quad \text{and} \quad \text{Var}(V_{nm}) = (WH)_{nm} \left( 1 + \frac{(WH)_{nm}}{\alpha }\right) . \end{aligned}$$\end{document}</tex-math><mml:math id="M240" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:mtext>Var</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mi>α</mml:mi></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>When <inline-formula id="IEq126"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \rightarrow \infty$$\end{document}</tex-math><mml:math id="M242"><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq126.gif"/></alternatives></inline-formula> above, the Negative Binomial model converges to the more commonly used Poisson model as <inline-formula id="IEq127"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{Var}(V_{nm}) \downarrow (WH)_{nm}$$\end{document}</tex-math><mml:math id="M244"><mml:mrow><mml:mtext>Var</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">↓</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq127.gif"/></alternatives></inline-formula>. As shown in this section, the Negative Binomial model can be seen both as an extension of the Poisson model and as equivalent to the Beta-Binomial model. Thus, we opted to implement a Negative Binomial NMF model for mutational count data. More details on the approximation of the Negative Binomial to the Beta-Binomial distribution can also be found in [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
    </sec>
    <sec id="Sec11">
      <title>Patient specific NB<sub>N</sub>-NMF</title>
      <p id="Par44">In this section we describe our patient specific Negative Binomial non-negative matrix factorization NB<sub>N</sub>-NMF model and the corresponding estimation procedure.</p>
      <p id="Par45">Gouvert et al. [<xref ref-type="bibr" rid="CR18">18</xref>], Lyu et al. [<xref ref-type="bibr" rid="CR20">20</xref>] and Vöhringer et al. [<xref ref-type="bibr" rid="CR21">21</xref>] present a Negative Binomial model where <inline-formula id="IEq130"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M246"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq130.gif"/></alternatives></inline-formula> is shared across all observations. However, the probability of a mutation in (<xref rid="Equ3" ref-type="disp-formula">3</xref>) is highly variable across patients (see e.g. mutational burden in [<xref ref-type="bibr" rid="CR28">28</xref>] and our discussion in “<xref rid="Sec6" ref-type="sec">Breast cancer data</xref>” section), thus we extend the Negative Binomial NMF model from [<xref ref-type="bibr" rid="CR18">18</xref>] by allowing patient specific dispersion. We noticed that the variability among different patients is usually much higher than the one among different mutation types, thus we decided to focus on patient specific dispersion.</p>
      <p id="Par46">The entries in <italic>V</italic> are modeled as<disp-formula id="Equ19"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}V_{nm} \sim \text{NB}\left( \alpha _n, \frac{(WH^T)_{nm}}{\alpha _n + (WH^T)_{nm}}\right) , \end{aligned}$$\end{document}</tex-math><mml:math id="M248" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>NB</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:msup><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:msup><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq131"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _n$$\end{document}</tex-math><mml:math id="M250"><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq131.gif"/></alternatives></inline-formula> is the dispersion coefficient of each patient, and the corresponding Gamma–Poisson hierarchical model can be rewritten as:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;V_{nm}|a_{nm} \sim \text{Po}(a_{nm}(WH)_{nm}) \nonumber \\&amp;a_{nm} \sim \text{Gamma}(\alpha _n, \alpha _n). \end{aligned}$$\end{document}</tex-math><mml:math id="M252" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Po</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>Here <inline-formula id="IEq132"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_{nm}$$\end{document}</tex-math><mml:math id="M254"><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq132.gif"/></alternatives></inline-formula> is the parameter responsible for the variability in the Negative Binomial model. Note that <inline-formula id="IEq133"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb{E}}[a_{nm}] = 1$$\end{document}</tex-math><mml:math id="M256"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq133.gif"/></alternatives></inline-formula> and <inline-formula id="IEq134"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{Var}(a_{nm}) = 1/\alpha _n$$\end{document}</tex-math><mml:math id="M258"><mml:mrow><mml:mtext>Var</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq134.gif"/></alternatives></inline-formula>.</p>
      <p id="Par47">Now we can write the Negative Binomial log-likelihood function with patent specific <inline-formula id="IEq135"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _n$$\end{document}</tex-math><mml:math id="M260"><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq135.gif"/></alternatives></inline-formula><disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \ell (W,H;V)&amp;= \sum _{n=1}^N \sum _{m=1}^M \Bigg \{ \log { \left( {\begin{array}{c}\alpha _n + V_{nm} - 1\\ \alpha _n\end{array}}\right) } + V_{nm} \log \left( { \frac{(WH)_{nm}}{\alpha _n + (WH)_{nm}}}\right) \nonumber \\&amp;\quad + \alpha _n \log \left( { 1 - \frac{(WH)_{nm}}{\alpha _n + (WH)_{nm}} } \right) \Bigg \}, \end{aligned}$$\end{document}</tex-math><mml:math id="M262" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo>;</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">{</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>and recognize the negative of the log-likelihood function as proportional to the following divergence:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} d_N(V||WH)&amp;= \sum _{n=1}^N \left\{ \sum _{m=1}^M V_{nm} \log \left( \frac{V_{nm}}{ (WH)_{nm}}\right) - (\alpha _n + V_{nm}) \log \left( \frac{\alpha _n + V_{nm}}{\alpha _n + (WH)_{nm}} \right) \right\} \end{aligned}$$\end{document}</tex-math><mml:math id="M264" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mfenced close="}" open="{"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mfenced><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>assuming fixed <inline-formula id="IEq136"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _1, \ldots , \alpha _N$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq136.gif"/></alternatives></inline-formula>. This is a divergence measure as <inline-formula id="IEq137"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_N(V||WH) = 0$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq137.gif"/></alternatives></inline-formula> when <inline-formula id="IEq138"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V = WH$$\end{document}</tex-math><mml:math id="M270"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq138.gif"/></alternatives></inline-formula> and <inline-formula id="IEq139"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_N(V||WH)&gt;0$$\end{document}</tex-math><mml:math id="M272"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq139.gif"/></alternatives></inline-formula> for <inline-formula id="IEq140"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V \ne WH$$\end{document}</tex-math><mml:math id="M274"><mml:mrow><mml:mi>V</mml:mi><mml:mo>≠</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq140.gif"/></alternatives></inline-formula>. We can show this by defining <inline-formula id="IEq141"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g(t) = (V_{nm}+t)\log \left( { (V_{nm}+t)}/{((WH)_{nm}+t) }\right)$$\end{document}</tex-math><mml:math id="M276"><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq141.gif"/></alternatives></inline-formula> and realize <inline-formula id="IEq142"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_N(V||WH) = g(0) - g(\alpha ) \ge 0$$\end{document}</tex-math><mml:math id="M278"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq142.gif"/></alternatives></inline-formula> because <inline-formula id="IEq143"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g'(t)\le 0$$\end{document}</tex-math><mml:math id="M280"><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq143.gif"/></alternatives></inline-formula> with equality only when <inline-formula id="IEq144"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V = WH$$\end{document}</tex-math><mml:math id="M282"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq144.gif"/></alternatives></inline-formula>. The term <inline-formula id="IEq145"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log { \left( {\begin{array}{c}\alpha _n + V_{nm} - 1\\ \alpha _n\end{array}}\right) }$$\end{document}</tex-math><mml:math id="M284"><mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq145.gif"/></alternatives></inline-formula> in the likelihood is a constant we can remove and then we have added the constants <inline-formula id="IEq146"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{nm} \log (V_{nm})$$\end{document}</tex-math><mml:math id="M286"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq146.gif"/></alternatives></inline-formula>, <inline-formula id="IEq147"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _{n} \log (\alpha _{n})$$\end{document}</tex-math><mml:math id="M288"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq147.gif"/></alternatives></inline-formula> and <inline-formula id="IEq148"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(V_{nm} + \alpha _n) \log (V_{nm} + \alpha _n)$$\end{document}</tex-math><mml:math id="M290"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq148.gif"/></alternatives></inline-formula>.</p>
      <p id="Par48">Following the steps in [<xref ref-type="bibr" rid="CR18">18</xref>], we will update <italic>W</italic> and <italic>H</italic> one at a time, while the other is assumed fixed. We will show the procedure for updating <italic>H</italic> using a fixed <italic>W</italic> and its current value <inline-formula id="IEq149"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H^t$$\end{document}</tex-math><mml:math id="M292"><mml:msup><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq149.gif"/></alternatives></inline-formula>. First we construct a majorizing function <inline-formula id="IEq150"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G(H, H^t)$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq150.gif"/></alternatives></inline-formula> for <inline-formula id="IEq151"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_N(V||WH)$$\end{document}</tex-math><mml:math id="M296"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq151.gif"/></alternatives></inline-formula> with the constraint that <inline-formula id="IEq152"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G(H, H) = d_N(V||WH)$$\end{document}</tex-math><mml:math id="M298"><mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq152.gif"/></alternatives></inline-formula>. The first term in Eq. (<xref rid="Equ8" ref-type="disp-formula">8</xref>) can be majorized using Jensen’s inequality leading to<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} d_N(V||WH)&amp;= \sum _{n=1}^N \sum _{m=1}^M \Bigg \{ \{ V_{nm} \log \left( \frac{V_{nm}}{\sum _{k=1}^K W_{nk}H_{km}} \right) \nonumber \\&amp;\quad - (\alpha _n + V_{nm}) \log \left( \frac{\alpha _n + V_{nm}}{\alpha _n + \sum _{k=1}^K W_{nk}H_{km}} \right) \Bigg \} \nonumber \\ {}&amp;\le \sum _{n=1}^N \sum _{m=1}^M\Bigg \{ V_{nm} \log V_{nm} - V_{nm} \sum _{k=1}^K \beta _{k} \log \frac{W_{nk}H_{km}}{\beta _{k}} \nonumber \\ {}&amp;\quad + (\alpha _n + V_{nm}) \log \left( \frac{\alpha _n + \sum _{k=1}^K W_{nk}H_{km}}{\alpha _n + V_{nm}} \right) \Bigg \} \end{aligned}$$\end{document}</tex-math><mml:math id="M300" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">{</mml:mo></mml:mrow><mml:mo stretchy="false">{</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>≤</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">{</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq153"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{k} = {W_{nk}H_{km}^t}/{\sum _{k=1}^K W_{nk}H^t_{km}}$$\end{document}</tex-math><mml:math id="M302"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq153.gif"/></alternatives></inline-formula>. The second term can be majorized with the tangent line using the concavity property of the logarithm:<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} d_N(V||WH)&amp;= \sum _{n=1}^N \sum _{m=1}^M \Bigg \{ V_{nm} \log V_{nm} - V_{nm} \sum _{k=1}^K \beta _{k} \log \frac{W_{nk}H_{km}}{\beta _{k}} \nonumber \\ {}&amp;\quad + (\alpha _n + V_{nm}) \log \left( \frac{\alpha _n + \sum _{k=1}^K W_{nk}H_{km}}{\alpha _n + V_{nm}} \right) \Bigg \} \nonumber \\ {}&amp;\le \sum _{n=1}^N \sum _{m=1}^M \Bigg \{ V_{nm} \log V_{nm} - V_{nm} \sum _{k=1}^K \beta _{k} \log \frac{W_{nk}H_{km}}{\beta _{k}} \nonumber \\ {}&amp;\quad + (\alpha _n + V_{nm}) \log \left( \frac{\alpha _n + (WH^t)_{nm}}{\alpha _n + V_{nm}} \right) \nonumber \\ {}&amp;\quad + \frac{W_{nm}}{\alpha _n + (WH^t)_{nm}}(H_{nm} - H^t_{nm}) \Bigg \} = G(H, H^t). \end{aligned}$$\end{document}</tex-math><mml:math id="M304" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">{</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>≤</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">{</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:msup><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:msup><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">}</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>Lastly, we need to show that <inline-formula id="IEq154"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G(H, H) = d_N(V||WH)$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq154.gif"/></alternatives></inline-formula>. This follows from<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} G(H, H)&amp;= \sum _{n=1}^N \sum _{m=1}^M \Bigg \{ V_{nm} \log V_{nm} - V_{nm} \sum _{k=1}^K \beta _{k} \log \frac{W_{nk}H_{km}}{\beta _{k}} \nonumber \\&amp;\quad + (\alpha _n + V_{nm}) \log \left( \frac{\alpha _n + (WH)_{nm}}{\alpha _n + V_{nm}} \right) + \frac{W_{nm}}{\alpha _n + (WH)_{nm}}(H_{nm} - H_{nm}) \Bigg \} \nonumber \\&amp;= \sum _{n=1}^N \sum _{m=1}^M \Bigg \{ V_{nm} \log V_{nm} - V_{nm}\sum _{k=1}^K \frac{W_{nk}H_{km}}{\sum _{k=1}^K W_{nk}H_{km}} \log \frac{W_{nk}H_{km}}{\frac{W_{nk}H_{km}}{\sum _{k=1}^K W_{nk}H_{km}}} \nonumber \\&amp;\quad - (\alpha _n + V_{nm}) \log \left( \frac{\alpha _n + V_{nm}}{\alpha _n + \sum _{k=1}^K W_{nk}H_{km}} \right) \Bigg \} \nonumber \\&amp;= \sum _{n=1}^N \sum _{m=1}^M \Bigg \{ V_{nm} \log V_{nm} - V_{nm} \cdot 1 \cdot \log \left( \sum _{k=1}^K W_{nk}H_{km} \right) \nonumber \\&amp;\quad - (\alpha _n + V_{nm}) \log \left( \frac{\alpha _n + V_{nm}}{\alpha _n + \sum _{k=1}^K W_{nk}H_{km}} \right) \Bigg \} \nonumber \\&amp;= \sum _{n=1}^N \sum _{m=1}^M \Bigg \{ V_{nm} \log \left( \frac{V_{nm}}{\sum _{k=1}^K W_{nk}H_{km}}\right) \nonumber \\&amp;\quad - (\alpha _n + V_{nm}) \log \left( \frac{\alpha _n + V_{nm}}{\alpha _n + \sum _{k=1}^K W_{nk}H_{km}} \right) \Bigg \} \nonumber \\&amp;= d_N(V||WH). \end{aligned}$$\end{document}</tex-math><mml:math id="M308" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">{</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">{</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">{</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mn>1</mml:mn><mml:mo>·</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">{</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>Having defined the majorizing function <inline-formula id="IEq155"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G(H, H^t)$$\end{document}</tex-math><mml:math id="M310"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq155.gif"/></alternatives></inline-formula> in Eq. (<xref rid="Equ10" ref-type="disp-formula">10</xref>), we can derive the following multiplicative update for <italic>H</italic>:<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} H_{km}^{t+1} = H_{km}^t \frac{\sum _{n=1}^N \frac{V_{nm}}{(WH^t)_{nm}} W_{nk}}{\sum _{n=1}^N \frac{V_{nm} + \alpha _n}{(WH^t)_{nm} + \alpha _n} W_{nk}}. \end{aligned}$$\end{document}</tex-math><mml:math id="M312" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:msup><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:msup><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula>Similar calculations can be carried out for <italic>W</italic> to obtain the following update:<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} W^{t+1}_{nk} = W^t_{nk} \frac{\sum _{m=1}^M \frac{V_{nm}}{(W^tH)_{nm}} H_{km}}{\sum _{m=1}^M \frac{V_{nm} + \alpha _n}{(W^tH)_{nm} + \alpha _n} H_{km}}. \end{aligned}$$\end{document}</tex-math><mml:math id="M314" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula>It is straightforward to see that when <inline-formula id="IEq156"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _n = \alpha$$\end{document}</tex-math><mml:math id="M316"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq156.gif"/></alternatives></inline-formula> for all <inline-formula id="IEq157"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n = 1, \ldots , N$$\end{document}</tex-math><mml:math id="M318"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq157.gif"/></alternatives></inline-formula> then the updates for <italic>W</italic> and <italic>H</italic> equal those in [<xref ref-type="bibr" rid="CR18">18</xref>]. Additionally, as shown in [<xref ref-type="bibr" rid="CR18">18</xref>] when <inline-formula id="IEq158"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \rightarrow \infty$$\end{document}</tex-math><mml:math id="M320"><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq158.gif"/></alternatives></inline-formula> the updates of the Po-NMF [<xref ref-type="bibr" rid="CR14">14</xref>] are recovered.</p>
      <p id="Par49">In our application, we find maximum likelihood estimates (MLEs) of <inline-formula id="IEq159"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _1, \ldots , \alpha _N$$\end{document}</tex-math><mml:math id="M322"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq159.gif"/></alternatives></inline-formula> based on the Negative Binomial likelihood using Newton–Raphson together with the estimate of <italic>WH</italic> from Po-NMF. We opted for this more precise estimation procedure for <inline-formula id="IEq160"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _1, \ldots , \alpha _N$$\end{document}</tex-math><mml:math id="M324"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq160.gif"/></alternatives></inline-formula> instead of the grid search approach used in [<xref ref-type="bibr" rid="CR18">18</xref>]. Final estimates of <italic>W</italic> and <italic>H</italic> are then found by minimizing the divergence in Eq. (<xref rid="Equ8" ref-type="disp-formula">8</xref>) by the iterative majorize-minimization procedure. The <inline-formula id="IEq161"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M326"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq161.gif"/></alternatives></inline-formula>-NMF procedure is described in Algorithm 1 below. The model in [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR20">20</xref>] is similar except <inline-formula id="IEq162"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _1 = \cdots = \alpha _N = \alpha$$\end{document}</tex-math><mml:math id="M328"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq162.gif"/></alternatives></inline-formula>.</p>
      <p id="Par50">It is well known that NMF can result in non-unique solutions [<xref ref-type="bibr" rid="CR38">38</xref>]. Following these findings on the non-uniqueness and the effect of different initializations, all our results are based on five random initializations for each NMF solution.<graphic position="anchor" xlink:href="12859_2023_5304_Figa_HTML" id="MO23"/></p>
    </sec>
    <sec id="Sec12">
      <title>Estimating the number of signatures</title>
      <p id="Par51">Estimating the number of signatures is a difficult problem when using NMF. More generally, estimating the number of components for mixture models or the number of clusters is a well known challenge in applied statistics.</p>
      <p id="Par52">Examples of the complexity of this problem can be found in the <italic>K</italic>-means clustering algorithm and in Gaussian mixture models where the number of clusters K has to be provided for the methods. A detailed description of these challenges can be found in [<xref ref-type="bibr" rid="CR39">39</xref>]. Estimating the number of components is also a critical issue for mixed membership models. Some examples can be found in [<xref ref-type="bibr" rid="CR40">40</xref>, <xref ref-type="bibr" rid="CR41">41</xref>].</p>
      <p id="Par53">Classical procedures to perform model selection are the AIC<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text{AIC} = -2\ln L + 2n_{prm} \end{aligned}$$\end{document}</tex-math><mml:math id="M330" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>AIC</mml:mtext><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo>ln</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">prm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula>and the Bayesian Information Criterion (BIC)<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text{BIC} = -2\ln L + \ln (n_{obs}) n_{prm} \end{aligned}$$\end{document}</tex-math><mml:math id="M332" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>BIC</mml:mtext><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo>ln</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mo>ln</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">prm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq163"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ln L$$\end{document}</tex-math><mml:math id="M334"><mml:mrow><mml:mo>ln</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq163.gif"/></alternatives></inline-formula> is the estimated log-likelihood value, <inline-formula id="IEq164"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{obs}$$\end{document}</tex-math><mml:math id="M336"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq164.gif"/></alternatives></inline-formula> is the number of observations and <inline-formula id="IEq165"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{prm}$$\end{document}</tex-math><mml:math id="M338"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">prm</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq165.gif"/></alternatives></inline-formula> the number of parameters to be estimated. The two criteria attempt to balance the fit to the data (measured by <inline-formula id="IEq166"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-2\ln L$$\end{document}</tex-math><mml:math id="M340"><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo>ln</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq166.gif"/></alternatives></inline-formula>) and the complexity of the model (measured by the scaled number of free parameters). We have <inline-formula id="IEq167"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{obs} = \text{N}$$\end{document}</tex-math><mml:math id="M342"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>N</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq167.gif"/></alternatives></inline-formula> where N is the number of patients, so <inline-formula id="IEq168"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ln (n_{obs}) &gt; 2$$\end{document}</tex-math><mml:math id="M344"><mml:mrow><mml:mo>ln</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq168.gif"/></alternatives></inline-formula> if <inline-formula id="IEq169"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{N} \ge 8$$\end{document}</tex-math><mml:math id="M346"><mml:mrow><mml:mtext>N</mml:mtext><mml:mo>≥</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq169.gif"/></alternatives></inline-formula>, which means that in our context the number of parameters has a higher influence for BIC compared to AIC because real data sets always have at least tens of patients. Additionally, the structure of the mutational matrix <italic>V</italic> can lead to two different strategies for choosing <inline-formula id="IEq170"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{obs}$$\end{document}</tex-math><mml:math id="M348"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq170.gif"/></alternatives></inline-formula> when BIC is used. Indeed, the number of observations in this context can be set as the total number of counts (i.e.  <inline-formula id="IEq171"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \cdot M$$\end{document}</tex-math><mml:math id="M350"><mml:mrow><mml:mi>N</mml:mi><mml:mo>·</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq171.gif"/></alternatives></inline-formula>) or as the number of patients N, leading to an ambiguity in the definition of this criterion. Verity and Nichols [<xref ref-type="bibr" rid="CR41">41</xref>] also presents results on the performance of AIC and BIC, where the power is especially low for BIC. AIC provides higher stability in the scenario from [<xref ref-type="bibr" rid="CR41">41</xref>], however it does not seem suitable in our situation due to a small penalty term.</p>
      <p id="Par54">A very popular model selection procedure is cross-validation. In Gelman et al. [<xref ref-type="bibr" rid="CR42">42</xref>] they compare various model selection methods including AIC and cross-validation. Here, the authors recommend to use cross-validation as they demonstrate that the other methods fail in some circumstances. In Luo et al. [<xref ref-type="bibr" rid="CR43">43</xref>] they also show that cross-validation has better performance than the other considered methods, including AIC and BIC. Both papers evaluate the predictive fit to compare different methods.</p>
      <sec id="Sec13">
        <title>Model selection for NMF</title>
        <p id="Par55">For NMF we propose an approach for estimating the rank which is highly inspired by cross-validation. As for classical cross-validation we split the patients in <italic>V</italic> in a training and a test set multiple times.</p>
        <p id="Par56">Since all the parameters in the model i.e. <italic>W</italic> and <italic>H</italic> are free parameters it means that the exposures for the patients in the test set are unknown from the estimation of the training set. The patients in the training set give an estimation of the signatures and the exposures of the patients in the training set. One could argue to fix the signatures from the training set and re-estimate exposures for the test set, but we observed that this lead to an overestimation of the test set.</p>
        <p id="Par57">Instead we have chosen to fix the exposures to the ones estimated from the full data. This means our evaluation on the test set is a combination of estimated signatures from the training set and exposures from the full data. The idea is to exploit the fact that the signature matrix should be robust to changes in the patients included in the training set. If the estimated signatures are truly explaining the main patterns in the data, then we expect the signatures obtained from the training set to be similar to the ones from the full data. Therefore the product of the exposures from the full data and the signatures from the training set should give a good approximation of the test set, if the number of signatures is appropriate. We tested this assumption on a real data set with hypermutated patients which may lead to patient specific signatures in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S3 and we find that our method is robust to the removal of the hypermutated patient.</p>
        <p id="Par58">Inputs for the procedure are the data <italic>V</italic>, an NMF method, the number of signatures K, the number of splits into training and test <italic>J</italic> and the <italic>cost</italic> function. We evaluate the model for a range of values of K and then select the model with the lowest cost. The NMF methods we are using here are either Po-NMF from [<xref ref-type="bibr" rid="CR14">14</xref>] or <inline-formula id="IEq172"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M352"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq172.gif"/></alternatives></inline-formula>-NMF in Algorithm 1, but any NMF method could be applied.</p>
        <p id="Par59">A visualization of our model selection algorithm can be found in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. First, we consider the full mutational matrix <italic>V</italic> and we apply the chosen NMF algorithm to obtain an estimate for both <italic>W</italic> and <italic>H</italic>. Afterwards, for each iteration, we sample 90% of the patients randomly to create the training set and determine the remaining 10% as our test set. We then apply the chosen NMF method to the mutational counts of the training set obtaining an estimate <inline-formula id="IEq173"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{train}$$\end{document}</tex-math><mml:math id="M354"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">train</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq173.gif"/></alternatives></inline-formula> and <inline-formula id="IEq174"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{train}$$\end{document}</tex-math><mml:math id="M356"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">train</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq174.gif"/></alternatives></inline-formula>.<fig id="Fig6"><label>Fig. 6</label><caption><p>SigMoS procedure for a given number of signatures K and a count matrix <italic>V</italic>. Pseudocode can be found in Algorithm 2</p></caption><graphic xlink:href="12859_2023_5304_Fig6_HTML" id="MO26"/></fig></p>
        <p id="Par60">Now, as for classical cross-validation, we want to evaluate our model on the test set. To evaluate the model here, we use the full data: indeed, we multiply the exposures relative to the patients in the test set estimated on the full data <inline-formula id="IEq175"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{test}^j$$\end{document}</tex-math><mml:math id="M358"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">test</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq175.gif"/></alternatives></inline-formula> times the corresponding signatures estimated from the training set <inline-formula id="IEq176"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{train}^j$$\end{document}</tex-math><mml:math id="M360"><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">train</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq176.gif"/></alternatives></inline-formula>. As the order of the estimated signatures from the full data can be different to the one in the training set we reorder the exposures in <inline-formula id="IEq177"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{test}^j$$\end{document}</tex-math><mml:math id="M362"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">test</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq177.gif"/></alternatives></inline-formula> with respect to the signatures in <inline-formula id="IEq178"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{train}^j$$\end{document}</tex-math><mml:math id="M364"><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">train</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq178.gif"/></alternatives></inline-formula>. We determine the order by calculating the cosine similarity between the signatures in <inline-formula id="IEq179"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{train}^j$$\end{document}</tex-math><mml:math id="M366"><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">train</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq179.gif"/></alternatives></inline-formula> and those in <italic>H</italic>. We use the prediction of the test data to evaluate the model computing the distance between the true data <inline-formula id="IEq180"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{test}^j$$\end{document}</tex-math><mml:math id="M368"><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">test</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq180.gif"/></alternatives></inline-formula> and their prediction <inline-formula id="IEq181"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{predict}^j$$\end{document}</tex-math><mml:math id="M370"><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">predict</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq181.gif"/></alternatives></inline-formula>with a suitable <italic>cost</italic> function. This procedure is iterated <italic>J</italic> times leading to <italic>J</italic> cost values <inline-formula id="IEq182"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_j$$\end{document}</tex-math><mml:math id="M372"><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq182.gif"/></alternatives></inline-formula>, <inline-formula id="IEq183"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j=1, \ldots , J$$\end{document}</tex-math><mml:math id="M374"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq183.gif"/></alternatives></inline-formula>. The median of these values is calculated for each number of signatures K. We call this procedure SigMoS and summarize it in Algorithm 2. The optimal K is the one with the lowest cost. We use the generalized Kullback–Leibler divergence as a cost function and discuss the choice of cost function in “<xref rid="Sec8" ref-type="sec">Discussion</xref>” section. We compare the influence of the model choice for our procedure to AIC and BIC. We also compare to <inline-formula id="IEq184"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M376"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq184.gif"/></alternatives></inline-formula>, <inline-formula id="IEq185"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SignatureAnalyzer}$$\end{document}</tex-math><mml:math id="M378"><mml:mi mathvariant="monospace">SignatureAnalyzer</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq185.gif"/></alternatives></inline-formula>, <inline-formula id="IEq186"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigneR}$$\end{document}</tex-math><mml:math id="M380"><mml:mi mathvariant="monospace">SigneR</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq186.gif"/></alternatives></inline-formula> and <inline-formula id="IEq187"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SparseSignatures}$$\end{document}</tex-math><mml:math id="M382"><mml:mi mathvariant="monospace">SparseSignatures</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq187.gif"/></alternatives></inline-formula> as these are recently introduced methods in the literature and examine the results from this comparison in “<xref rid="Sec3" ref-type="sec">Simulation study</xref>” section.<graphic position="anchor" xlink:href="12859_2023_5304_Figb_HTML" id="MO27"/></p>
      </sec>
    </sec>
    <sec id="Sec14">
      <title>Code for method comparison</title>
      <p id="Par61">For <inline-formula id="IEq188"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M384"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq188.gif"/></alternatives></inline-formula> we used the <inline-formula id="IEq189"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M386"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq189.gif"/></alternatives></inline-formula> Python package with <inline-formula id="IEq190"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {minimum\_signatures}$$\end{document}</tex-math><mml:math id="M388"><mml:mrow><mml:mi mathvariant="monospace">minimum</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">signatures</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq190.gif"/></alternatives></inline-formula> equal to two, <inline-formula id="IEq191"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {maximum\_signatures}$$\end{document}</tex-math><mml:math id="M390"><mml:mrow><mml:mi mathvariant="monospace">maximum</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">signatures</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq191.gif"/></alternatives></inline-formula> equal to eight and <inline-formula id="IEq192"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {opportunity\_genome}$$\end{document}</tex-math><mml:math id="M392"><mml:mrow><mml:mi mathvariant="monospace">opportunity</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">genome</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq192.gif"/></alternatives></inline-formula> equal to “GRCh37”. For <inline-formula id="IEq193"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SparseSignatures}$$\end{document}</tex-math><mml:math id="M394"><mml:mi mathvariant="monospace">SparseSignatures</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq193.gif"/></alternatives></inline-formula> we use the function <inline-formula id="IEq194"><alternatives><tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{nmfLassoCV}$$\end{document}</tex-math><mml:math id="M396"><mml:mi mathvariant="monospace">nmfLassoCV</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq194.gif"/></alternatives></inline-formula> with <inline-formula id="IEq195"><alternatives><tex-math id="M397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {normalize\_counts}$$\end{document}</tex-math><mml:math id="M398"><mml:mrow><mml:mi mathvariant="monospace">normalize</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">counts</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq195.gif"/></alternatives></inline-formula> being set to FALSE and <inline-formula id="IEq196"><alternatives><tex-math id="M399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {lambda\_values\_alpha}$$\end{document}</tex-math><mml:math id="M400"><mml:mrow><mml:mi mathvariant="monospace">lambda</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">values</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">alpha</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq196.gif"/></alternatives></inline-formula> and <inline-formula id="IEq197"><alternatives><tex-math id="M401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {lambda\_values\_beta}$$\end{document}</tex-math><mml:math id="M402"><mml:mrow><mml:mi mathvariant="monospace">lambda</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">values</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">beta</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq197.gif"/></alternatives></inline-formula> to zero. All the other parameters are set to their default values. When applying <inline-formula id="IEq198"><alternatives><tex-math id="M403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SignatureAnalyzer}$$\end{document}</tex-math><mml:math id="M404"><mml:mi mathvariant="monospace">SignatureAnalyzer</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq198.gif"/></alternatives></inline-formula> we used the following command <inline-formula id="IEq199"><alternatives><tex-math id="M405">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{python}$$\end{document}</tex-math><mml:math id="M406"><mml:mi mathvariant="monospace">python</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq199.gif"/></alternatives></inline-formula>
<inline-formula id="IEq200"><alternatives><tex-math id="M407">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {SignatureAnalyzer\text{- }GPU.py \quad \text{- }\text{- }data \quad f \quad \text{- }\text{- }prior\_on\_W \quad L1}$$\end{document}</tex-math><mml:math id="M408"><mml:mrow><mml:mi mathvariant="monospace">SignatureAnalyzer</mml:mi><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">GPU</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="monospace">py</mml:mi><mml:mspace width="1em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">data</mml:mi><mml:mspace width="1em"/><mml:mi mathvariant="monospace">f</mml:mi><mml:mspace width="1em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">prior</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">on</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">W</mml:mi><mml:mspace width="1em"/><mml:mi mathvariant="monospace">L</mml:mi><mml:mn mathvariant="monospace">1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq200.gif"/></alternatives></inline-formula>
<inline-formula id="IEq201"><alternatives><tex-math id="M409">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {\text{- }\text{- }prior\_on\_H \quad L2 \text{- }\text{- }output\_dir \quad d \quad \text{- }\text{- }max\_iter \quad 1000000 \quad \text{- }\text{- }tolerance \quad 1e-7}$$\end{document}</tex-math><mml:math id="M410"><mml:mrow><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">prior</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">on</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">H</mml:mi><mml:mspace width="1em"/><mml:mi mathvariant="monospace">L</mml:mi><mml:mn mathvariant="monospace">2</mml:mn><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">output</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">dir</mml:mi><mml:mspace width="1em"/><mml:mi mathvariant="monospace">d</mml:mi><mml:mspace width="1em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">max</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">iter</mml:mi><mml:mspace width="1em"/><mml:mn mathvariant="monospace">1000000</mml:mn><mml:mspace width="1em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">tolerance</mml:mi><mml:mspace width="1em"/><mml:mn mathvariant="monospace">1</mml:mn><mml:mi mathvariant="monospace">e</mml:mi><mml:mo>-</mml:mo><mml:mn mathvariant="monospace">7</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq201.gif"/></alternatives></inline-formula>
<inline-formula id="IEq202"><alternatives><tex-math id="M411">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt { \text{- }\text{- }K0 \quad 8}$$\end{document}</tex-math><mml:math id="M412"><mml:mrow><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">K</mml:mi><mml:mn mathvariant="monospace">0</mml:mn><mml:mspace width="1em"/><mml:mn mathvariant="monospace">8</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq202.gif"/></alternatives></inline-formula>. For <inline-formula id="IEq203"><alternatives><tex-math id="M413">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigneR}$$\end{document}</tex-math><mml:math id="M414"><mml:mi mathvariant="monospace">SigneR</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq203.gif"/></alternatives></inline-formula> we used the default options.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec15">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5304_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold>. Supplementary material.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Simon Opstrup Drue and two anonymous reviewers for helpful comments and suggestions on an earlier version of this manuscript.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>MP, RL and AH contributed to the design of the research. MP and RL wrote the code for software, simulations and data analysis and wrote the first version of the manuscript. All authors contributed to writing the manuscript, read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>The research reported in this publication is supported by the Novo Nordisk Foundation. MP acknowledges funding of the Austrian Science Fund (FWF Doctoral Program Vienna Graduate School of Population Genetics”, DK W1225-B20).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The code for our model selection procedure and Negative Binomial NMF and for the simulations is available in the R package SigMoS and can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/MartaPelizzola/SigMoS">https://github.com/MartaPelizzola/SigMoS</ext-link>. The real data used in “<xref rid="Sec6" ref-type="sec">Breast cancer data</xref>” section are available at <ext-link ext-link-type="uri" xlink:href="ftp://ftp.sanger.ac.uk/pub/cancer/AlexandrovEtAl">ftp://ftp.sanger.ac.uk/pub/cancer/AlexandrovEtAl</ext-link> from [<xref ref-type="bibr" rid="CR11">11</xref>]. The real data used in “<xref rid="Sec7" ref-type="sec">Prostate cancer data</xref>” section can be found at <ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#%21Synapse:syn11726620">https://www.synapse.org/#!Synapse:syn11726620</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par62">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par63">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par64">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Risques</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Kennedy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Aging and the rise of somatic cancer-associated mutations in normal tissues</article-title>
        <source>PLoS Genet</source>
        <year>2018</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>e1007108</fpage>
        <pub-id pub-id-type="doi">10.1371/JOURNAL.PGEN.1007108</pub-id>
        <?supplied-pmid 29300727?>
        <pub-id pub-id-type="pmid">29300727</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shibai</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Takahashi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ishizawa</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Motooka</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Nakamura</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ying</surname>
            <given-names>B-W</given-names>
          </name>
          <name>
            <surname>Tsuru</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Mutation accumulation under UV radiation in Escherichia coli</article-title>
        <source>Sci Rep</source>
        <year>2017</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-017-15008-1</pub-id>
        <pub-id pub-id-type="pmid">28127051</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Ju</surname>
            <given-names>YS</given-names>
          </name>
          <name>
            <surname>Haase</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Van Loo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Martincorena</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Totoki</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Fujimoto</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nakagawa</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shibata</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Vineis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Phillips</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Stratton</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>Mutational signatures associated with tobacco smoking in human cancer</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>354</volume>
        <issue>6312</issue>
        <fpage>618</fpage>
        <lpage>622</lpage>
        <pub-id pub-id-type="doi">10.1126/SCIENCE.AAG0299</pub-id>
        <?supplied-pmid 27811275?>
        <pub-id pub-id-type="pmid">27811275</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Haradhvala</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Tian Ng</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Boot</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Covington</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Gordenin</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Bergstrom</surname>
            <given-names>EN</given-names>
          </name>
          <name>
            <surname>Islam</surname>
            <given-names>SMA</given-names>
          </name>
          <name>
            <surname>Lopez-Bigas</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Klimczak</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Morganella</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sabarinathan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Mustonen</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rozen</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Stratton</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>The repertoire of mutational signatures in human cancer</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>578</volume>
        <issue>7793</issue>
        <fpage>94</fpage>
        <lpage>101</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-1943-3</pub-id>
        <?supplied-pmid 32025018?>
        <pub-id pub-id-type="pmid">32025018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tate</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Bamford</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jubb</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Sondka</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Beare</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Bindal</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Boutselakis</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>CG</given-names>
          </name>
          <name>
            <surname>Creatore</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dawson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Fish</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Harsha</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hathaway</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jupe</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Kok</surname>
            <given-names>CY</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ponting</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ramshaw</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Rye</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Speedy</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Stefancsik</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Forbes</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>COSMIC: the catalogue of somatic mutations in cancer</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>941</fpage>
        <lpage>947</lpage>
        <pub-id pub-id-type="doi">10.1093/NAR/GKY1015</pub-id>
        <pub-id pub-id-type="pmid">30462257</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wedge</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Stratton</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>Deciphering signatures of mutational processes operative in human cancer</article-title>
        <source>Cell Rep</source>
        <year>2013</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>264</fpage>
        <lpage>259</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2012.12.008</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Wedge</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Van Loo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Greenman</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Raine</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stebbings</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Menzies</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Leroy</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ramakrishna</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rance</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lau</surname>
            <given-names>KW</given-names>
          </name>
          <name>
            <surname>Mudie</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Varela</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>McBride</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Bignell</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Cooke</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Shlien</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gamble</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Whitmore</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Maddison</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tarpey</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Davies</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Papaemmanuil</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>McLaren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Teague</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Jönsson</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Garber</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Silver</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Miron</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Fatima</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Boyault</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Langerod</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tutt</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Martens</surname>
            <given-names>JWM</given-names>
          </name>
          <name>
            <surname>Aparicio</surname>
            <given-names>SAJR</given-names>
          </name>
          <name>
            <surname>Borg</surname>
            <given-names>Å</given-names>
          </name>
          <name>
            <surname>Salomon</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Borresen-Dale</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Neuberger</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Futreal</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Stratton</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>Mutational processes molding the genomes of 21 breast cancers</article-title>
        <source>Cell</source>
        <year>2012</year>
        <volume>149</volume>
        <issue>5</issue>
        <fpage>979</fpage>
        <lpage>993</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2012.04.024</pub-id>
        <?supplied-pmid 22608084?>
        <pub-id pub-id-type="pmid">22608084</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sidow</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ramazzotti</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>De novo mutational signature discovery in tumor genomes using SparseSignatures</article-title>
        <source>PLoS Comput Biol</source>
        <year>2021</year>
        <volume>17</volume>
        <issue>6</issue>
        <fpage>1009119</fpage>
        <pub-id pub-id-type="doi">10.1371/JOURNAL.PCBI.1009119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baez-Ortega</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gori</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Computational approaches for discovery of mutational signatures in cancer</article-title>
        <source>Brief Bioinform</source>
        <year>2017</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>77</fpage>
        <lpage>88</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbx082</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Omichessan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Severi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Perduca</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Computational tools to detect signatures of mutational processes in DNA from tumours: a review and empirical comparison of performance</article-title>
        <source>PLoS ONE</source>
        <year>2019</year>
        <volume>14</volume>
        <issue>9</issue>
        <fpage>0221235</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0221235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wedge</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Aparicio</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Behjati</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Biankin</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Bignell</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Bolli</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Borg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Børresen-Dale</surname>
            <given-names>A-L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Signatures of mutational processes in human cancer</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>500</volume>
        <issue>7463</issue>
        <fpage>415</fpage>
        <lpage>421</lpage>
        <pub-id pub-id-type="doi">10.1038/nature12477</pub-id>
        <?supplied-pmid 23945592?>
        <pub-id pub-id-type="pmid">23945592</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fischer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Illingworth</surname>
            <given-names>CJR</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Mustonen</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>EMu: Probabilistic inference of mutational processes and their localization in the cancer genome</article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>4</issue>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-4-r39</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosales</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Drummond</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Valieris</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dias-Neto</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Da Silva</surname>
            <given-names>IT</given-names>
          </name>
        </person-group>
        <article-title>signeR: an empirical Bayesian approach to mutational signature discovery</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>1</issue>
        <fpage>8</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw572</pub-id>
        <?supplied-pmid 27591080?>
        <pub-id pub-id-type="pmid">27591080</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>DD</given-names>
          </name>
          <name>
            <surname>Seung</surname>
            <given-names>HS</given-names>
          </name>
        </person-group>
        <article-title>Learning the parts of objects by non-negative matrix factorization</article-title>
        <source>Nature</source>
        <year>1999</year>
        <volume>401</volume>
        <issue>6755</issue>
        <fpage>788</fpage>
        <lpage>791</lpage>
        <pub-id pub-id-type="doi">10.1038/44565</pub-id>
        <?supplied-pmid 10548103?>
        <pub-id pub-id-type="pmid">10548103</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bliss</surname>
            <given-names>CI</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Fitting the negative binomial distribution to biological data</article-title>
        <source>Biometrics</source>
        <year>1953</year>
        <volume>9</volume>
        <issue>2</issue>
        <fpage>176</fpage>
        <pub-id pub-id-type="doi">10.2307/3001850</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martincorena</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Raine</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gerstung</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dawson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Haase</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Van Loo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Davies</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Stratton</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Universal patterns of selection in cancer and somatic tissues</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <issue>5</issue>
        <fpage>1029</fpage>
        <lpage>104121</lpage>
        <pub-id pub-id-type="doi">10.1016/J.CELL.2017.09.042</pub-id>
        <?supplied-pmid 29056346?>
        <pub-id pub-id-type="pmid">29056346</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McGillivray</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lochovsky</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>NIMBus: a negative binomial regression based integrative method for mutation burden analysis</article-title>
        <source>BMC Bioinform 2020 21:1</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1186/S12859-020-03758-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gouvert</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Oberlin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fevotte</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Negative binomial matrix factorization</article-title>
        <source>IEEE Signal Process Lett</source>
        <year>2020</year>
        <volume>27</volume>
        <fpage>815</fpage>
        <lpage>819</lpage>
        <pub-id pub-id-type="doi">10.1109/LSP.2020.2991613</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Gori K, Baez-Ortega A. sigfit: flexible Bayesian inference of mutational signatures; 2018. 10.1101/372896</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lyu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Garret</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rätsch</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lehmann</surname>
            <given-names>KV</given-names>
          </name>
        </person-group>
        <article-title>Mutational signature learning with supervised negative binomial non-negative matrix factorization</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>Suppl-1</issue>
        <fpage>154</fpage>
        <lpage>160</lpage>
        <pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/BTAA473</pub-id>
        <pub-id pub-id-type="pmid">31250908</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vöhringer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hoeck</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Cuppen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gerstung</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Learning mutational signatures and their multidimensional genomic properties with TensorSignatures</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>3628</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-23551-9</pub-id>
        <?supplied-pmid 34131135?>
        <pub-id pub-id-type="pmid">34131135</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Févotte</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bertin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Durrieu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Nonnegative matrix factorization with the Itakura–Saito divergence: with application to music analysis</article-title>
        <source>Neural Comput</source>
        <year>2009</year>
        <volume>21</volume>
        <issue>3</issue>
        <fpage>793</fpage>
        <lpage>830</lpage>
        <pub-id pub-id-type="doi">10.1162/NECO.2008.04-08-771</pub-id>
        <?supplied-pmid 18785855?>
        <pub-id pub-id-type="pmid">18785855</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Islam</surname>
            <given-names>SMA</given-names>
          </name>
          <name>
            <surname>Díaz-Gay</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Barnes</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vangara</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bergstrom</surname>
            <given-names>EN</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Vella</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Teague</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Clapham</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Moody</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Senkin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>YR</given-names>
          </name>
          <name>
            <surname>Riva</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gruber</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Steele</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Otlu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Khandekar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Abbasi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Humphreys</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Syulyukina</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Brady</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Alexandrov</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Pillay</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Adams</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Martincorena</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Wedge</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Landi</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Brennan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stratton</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Rozen</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
        </person-group>
        <article-title>Uncovering novel mutational signatures by de novo extraction with SigProfilerExtractor</article-title>
        <source>Cell Genomics</source>
        <year>2022</year>
        <volume>2</volume>
        <issue>11</issue>
        <fpage>100179</fpage>
        <pub-id pub-id-type="doi">10.1016/j.xgen.2022.100179</pub-id>
        <?supplied-pmid 36388765?>
        <pub-id pub-id-type="pmid">36388765</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taylor-Weiner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aguet</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Haradhvala</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Gosai</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Anand</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ardlie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>EMV</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Scaling computational genomics to millions of individuals with GPUs</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1836-7</pub-id>
        <pub-id pub-id-type="pmid">30606230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Pan-cancer analysis of whole genomes</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>578</volume>
        <issue>7793</issue>
        <fpage>82</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-1969-6</pub-id>
        <pub-id pub-id-type="pmid">32025007</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cook</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>Exploring partial residual plots</article-title>
        <source>Technometrics</source>
        <year>1993</year>
        <volume>35</volume>
        <issue>4</issue>
        <fpage>351</fpage>
        <lpage>362</lpage>
        <pub-id pub-id-type="doi">10.1080/00401706.1993.10485350</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Miles J. Residual plot. 2014. 10.1002/9781118445112.stat06619.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Degasperi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Amarante</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Martinez-Martinez</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koh</surname>
            <given-names>GCC</given-names>
          </name>
          <name>
            <surname>Dias</surname>
            <given-names>JML</given-names>
          </name>
          <name>
            <surname>Heskin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chmelova</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rinaldi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>VYW</given-names>
          </name>
          <name>
            <surname>Nanda</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Momen</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Perez-Gil</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Memari</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Badja</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shooter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Czarnecki</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Davies</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ambrose</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Arumugam</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bevers</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bleda</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Boardman-Pretty</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Boustred</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Brittain</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Caulfield</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>GC</given-names>
          </name>
          <name>
            <surname>Fowler</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Giess</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hamblin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Henderson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hubbard</surname>
            <given-names>TJP</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Kasperaviciute</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kayikci</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kousathanas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lahnstein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Leigh</surname>
            <given-names>SEA</given-names>
          </name>
          <name>
            <surname>Leong</surname>
            <given-names>IUS</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Maleady-Crowe</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>McEntagart</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Minneci</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Moutsianas</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mueller</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Murugaesu</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Need</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>O’Donovan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Odhams</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Patch</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Perez-Gil</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pereira</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Pullinger</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rahim</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rendon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rogers</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Savage</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sawant</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Siddiq</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sieghart</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Sosinsky</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stuckey</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tanguy</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tavares</surname>
            <given-names>ALT</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>ERA</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Tucci</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Welland</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Witkowska</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wood</surname>
            <given-names>SM</given-names>
          </name>
        </person-group>
        <article-title>Substitution mutational signatures in whole-genome sequenced cancers in the UK population</article-title>
        <source>Science</source>
        <year>2022</year>
        <volume>376</volume>
        <issue>6591</issue>
        <fpage>9283</fpage>
        <pub-id pub-id-type="doi">10.1126/science.abl9283</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Nik-Zainal S, Davies H, Staaf J, Ramakrishna M, Glodzik D, Zou X, Martincorena I, Alexandrov LB, Martin S, Wedge DC, Loo PV, Ju YS, Smid M, Brinkman AB, Morganella S, Aure MR, Lingjærde OC, Langerød A, Ringnér M, Ahn S-M, Boyault S, Brock JE, Broeks A, Butler A, Desmedt C, Dirix L, Dronov S, Fatima A, Foekens JA, Gerstung M, Hooijer GKJ, Jang SJ, Jones DR, Kim H-Y, King TA, Krishnamurthy S, Lee HJ, Lee J-Y, Li Y, McLaren S, Menzies A, Mustonen V, O’Meara S, Pauporté I, Pivot X, Purdie CA, Raine K, Ramakrishnan K, Rodríguez-González FG, Romieu G, Sieuwerts AM, Simpson PT, Shepherd R, Stebbings L, Stefansson OA, Teague J, Tommasi S, Treilleux I, den Eynden GGV, Vermeulen P, Vincent-Salomon A, Yates L, Caldas C, van’t Veer L, Tutt A, Knappskog S, Tan BKT, Jonkers J, Borg Å, Ueno NT, Sotiriou C, Viari A, Futreal PA, Campbell PJ, Span PN, Laere SV, Lakhani SR, Eyfjord JE, Thompson AM, Birney E, Stunnenberg HG, van de Vijver MJ, Martens JWM, Børresen-Dale A-L, Richardson AL, Kong G, Thomas G, Stratton MR. Landscape of somatic mutations in 560 breast cancer whole-genome sequences. Nature 2016;534(7605):47–54. 10.1038/nature17676</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>XR</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Landi</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>SUITOR: selecting the number of mutational signatures through cross-validation</article-title>
        <source>PLoS Comput Biol</source>
        <year>2022</year>
        <volume>18</volume>
        <issue>4</issue>
        <fpage>1009309</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1009309</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pei</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Decoding whole-genome mutational signatures in 37 human pan-cancers by denoising sparse autoencoder neural network</article-title>
        <source>Oncogene</source>
        <year>2020</year>
        <volume>39</volume>
        <issue>27</issue>
        <fpage>5031</fpage>
        <lpage>5041</lpage>
        <pub-id pub-id-type="doi">10.1038/s41388-020-1343-z</pub-id>
        <?supplied-pmid 32528130?>
        <pub-id pub-id-type="pmid">32528130</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Févotte</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Idier</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Algorithms for nonnegative matrix factorization with the <inline-formula id="IEq205"><alternatives><tex-math id="M415">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M416"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq205.gif"/></alternatives></inline-formula>-divergence</article-title>
        <source>Neural Comput</source>
        <year>2011</year>
        <volume>23</volume>
        <issue>9</issue>
        <fpage>2421</fpage>
        <lpage>2456</lpage>
        <pub-id pub-id-type="doi">10.1162/NECO_a_00168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Li L, Lebanon G, Park H. Fast Bregman divergence NMF using Taylor expansion and coordinate descent. In: Proceedings of the 18th ACM SIGKDD international conference on knowledge discovery and data mining. 2012.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weinhold</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jacobsen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schultz</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide analysis of noncoding regulatory mutations in cancer</article-title>
        <source>Nat Genet</source>
        <year>2014</year>
        <volume>46</volume>
        <issue>11</issue>
        <fpage>1160</fpage>
        <lpage>1165</lpage>
        <pub-id pub-id-type="doi">10.1038/NG.3101</pub-id>
        <?supplied-pmid 25261935?>
        <pub-id pub-id-type="pmid">25261935</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lochovsky</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Khurana</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>LARVA: an integrative framework for large-scale analysis of recurrent variants in noncoding annotations</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>17</issue>
        <fpage>8123</fpage>
        <lpage>8134</lpage>
        <pub-id pub-id-type="doi">10.1093/NAR/GKV803</pub-id>
        <?supplied-pmid 26304545?>
        <pub-id pub-id-type="pmid">26304545</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Stojanov</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Polak</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kryukov</surname>
            <given-names>GV</given-names>
          </name>
          <name>
            <surname>Cibulskis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sivachenko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Carter</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mermel</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Kiezun</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hammerman</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Drier</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ramos</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Pugh</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Stransky</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Helman</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sougnez</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ambrogio</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Nickerson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Shefler</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Cortés</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Auclair</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Saksena</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Voet</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dicara</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lichtenstein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Heiman</surname>
            <given-names>DI</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Imielinski</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hernandez</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hodis</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Baca</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dulak</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lohr</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Landau</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Melendez-Zajgla</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hidalgo-Miranda</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McCarroll</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Mora</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Crompton</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Onofrio</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Parkin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Winckler</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ardlie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gabriel</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>CWM</given-names>
          </name>
          <name>
            <surname>Biegel</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Stegmaier</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bass</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Garraway</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Meyerson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Gordenin</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Sunyaev</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Mutational heterogeneity in cancer and the search for new cancer-associated genes</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>499</volume>
        <issue>7457</issue>
        <fpage>214</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1038/nature12213</pub-id>
        <?supplied-pmid 23770567?>
        <pub-id pub-id-type="pmid">23770567</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Teerapabolarn</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Negative Binomial approximation to the Beta Binomial distribution</article-title>
        <source>Int J Pure Appl Math</source>
        <year>2015</year>
        <volume>98</volume>
        <issue>1</issue>
        <fpage>39</fpage>
        <lpage>43</lpage>
        <pub-id pub-id-type="doi">10.12732/ijpam.v98i1.5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Laursen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hobolth</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A sampling algorithm to compute the set of feasible solutions for non-negative matrix factorization with an arbitrary rank</article-title>
        <source>SIAM J Matrix Anal Appl</source>
        <year>2022</year>
        <volume>43</volume>
        <issue>1</issue>
        <fpage>257</fpage>
        <lpage>273</lpage>
        <pub-id pub-id-type="doi">10.1137/20M1378971</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gupta</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Datta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Das</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Fast automatic estimation of the number of clusters from the minimum inter-center distance for k-means clustering</article-title>
        <source>Pattern Recogn Lett</source>
        <year>2018</year>
        <volume>116</volume>
        <fpage>72</fpage>
        <lpage>79</lpage>
        <pub-id pub-id-type="doi">10.1016/J.PATREC.2018.09.003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pritchard</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Donnelly</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Inference of population structure using multilocus genotype data</article-title>
        <source>Genetics</source>
        <year>2000</year>
        <volume>155</volume>
        <issue>2</issue>
        <fpage>945</fpage>
        <lpage>959</lpage>
        <pub-id pub-id-type="doi">10.1093/genetics/155.2.945</pub-id>
        <?supplied-pmid 10835412?>
        <pub-id pub-id-type="pmid">10835412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Verity</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nichols</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Estimating the number of subpopulations (K) in structured populations</article-title>
        <source>Genetics</source>
        <year>2016</year>
        <volume>203</volume>
        <issue>4</issue>
        <fpage>1827</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.115.180992</pub-id>
        <?supplied-pmid 27317680?>
        <pub-id pub-id-type="pmid">27317680</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gelman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hwang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vehtari</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Understanding predictive information criteria for Bayesian models</article-title>
        <source>Stat Comput</source>
        <year>2013</year>
        <volume>24</volume>
        <issue>6</issue>
        <fpage>997</fpage>
        <lpage>1016</lpage>
        <pub-id pub-id-type="doi">10.1007/S11222-013-9416-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Al-Harbi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Al-Harbi</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Performances of LOO and WAIC as IRT model selection methods</article-title>
        <source>Psychol Test Assess Model</source>
        <year>2017</year>
        <volume>59</volume>
        <issue>2</issue>
        <fpage>183</fpage>
        <lpage>205</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10165836</article-id>
    <article-id pub-id-type="publisher-id">5304</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05304-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Model selection and robust inference of mutational signatures using Negative Binomial non-negative matrix factorization</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Pelizzola</surname>
          <given-names>Marta</given-names>
        </name>
        <address>
          <email>marta@math.au.dk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Laursen</surname>
          <given-names>Ragnhild</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hobolth</surname>
          <given-names>Asger</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.7048.b</institution-id><institution-id institution-id-type="ISNI">0000 0001 1956 2722</institution-id><institution>Department of Mathematics, </institution><institution>Aarhus University, </institution></institution-wrap>Aarhus, Denmark </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>187</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>4</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">The spectrum of mutations in a collection of cancer genomes can be described by a mixture of a few mutational signatures. The mutational signatures can be found using non-negative matrix factorization (NMF). To extract the mutational signatures we have to assume a distribution for the observed mutational counts and a number of mutational signatures. In most applications, the mutational counts are assumed to be Poisson distributed, and the rank is chosen by comparing the fit of several models with the same underlying distribution and different values for the rank using classical model selection procedures. However, the counts are often overdispersed, and thus the Negative Binomial distribution is more appropriate.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We propose a Negative Binomial NMF with a patient specific dispersion parameter to capture the variation across patients and derive the corresponding update rules for parameter estimation. We also introduce a novel model selection procedure inspired by cross-validation to determine the number of signatures. Using simulations, we study the influence of the distributional assumption on our method together with other classical model selection procedures. We also present a simulation study with a method comparison where we show that state-of-the-art methods are highly overestimating the number of signatures when overdispersion is present. We apply our proposed analysis on a wide range of simulated data and on two real data sets from breast and prostate cancer patients. On the real data we describe a residual analysis to investigate and validate the model choice.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">With our results on simulated and real data we show that our model selection procedure is more robust at determining the correct number of signatures under model misspecification. We also show that our model selection procedure is more accurate than the available methods in the literature for finding the true number of signatures. Lastly, the residual analysis clearly emphasizes the overdispersion in the mutational count data. The code for our model selection procedure and Negative Binomial NMF is available in the R package SigMoS and can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/MartaPelizzola/SigMoS">https://github.com/MartaPelizzola/SigMoS</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05304-1.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Cancer genomics</kwd>
      <kwd>Cross-validation</kwd>
      <kwd>Model checking</kwd>
      <kwd>Model selection</kwd>
      <kwd>Mutational signatures</kwd>
      <kwd>Negative Binomial</kwd>
      <kwd>Non-negative matrix factorization</kwd>
      <kwd>Poisson</kwd>
    </kwd-group>
    <kwd-group xml:lang="--">
      <title>AMS Classification</title>
      <kwd>92-08</kwd>
      <kwd>92-10</kwd>
      <kwd>62-08</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par4">Somatic mutations occur relatively often in the human genome and are mostly neutral. However, the accumulation of harmful mutations in a genome can lead to cancer. The summary of somatic mutations observed in a tumor is called a mutational profile and can often be associated with factors such as aging [<xref ref-type="bibr" rid="CR1">1</xref>], UV light [<xref ref-type="bibr" rid="CR2">2</xref>] or tobacco smoking [<xref ref-type="bibr" rid="CR3">3</xref>]. A mutational profile is thus a mixture of mutational processes that are represented by mutational signatures. Several signatures have been identified from the mutational profiles and associated with different cancer types [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. The importance of mutational signatures thus lies in their association with the mutational processes causing cancer. Having more insights into the causes of cancer is a prerequisite for better understanding the role that genetics plays in the development of the disease and eventually also for discovering potential treatment.</p>
    <p id="Par5">A common strategy to derive the mutational signatures is non-negative matrix factorization [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR8">8</xref>]. Different approaches to estimate the signature and the exposure matrices from mutational count data have been extensively described in [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>].</p>
    <p id="Par6">Non-negative matrix factorization (NMF) is a factorization of a given matrix <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V \in {\mathbb{N}}_0^{\text{N} \times \text{M}}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>V</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">N</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mtext>N</mml:mtext><mml:mo>×</mml:mo><mml:mtext>M</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq1.gif"/></alternatives></inline-formula> into the product of two non-negative matrices <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W \in {\mathbb{R}}_+^{\text{N} \times \text{K}}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>W</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mtext>N</mml:mtext><mml:mo>×</mml:mo><mml:mtext>K</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq2.gif"/></alternatives></inline-formula> and <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H \in {\mathbb{R}}_+^{\text{K} \times \text{M}}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>H</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mtext>K</mml:mtext><mml:mo>×</mml:mo><mml:mtext>M</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq3.gif"/></alternatives></inline-formula> such that<disp-formula id="Equ16"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}V \approx WH.\end{aligned}$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>V</mml:mi><mml:mo>≈</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula>The rank K of the lower-dimensional matrices <italic>W</italic> and <italic>H</italic> is much smaller than N and M.</p>
    <p id="Par7">In cancer genomics, the mutational matrix <italic>V</italic> contains the mutational counts for different patients, also referred to as mutational profiles. The number of rows N is the number of patients and the number of columns M is the number of different mutation types. In this paper we use the single-base-substitution-96 mutational context [<xref ref-type="bibr" rid="CR11">11</xref>] where <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{M} = 96$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mtext>M</mml:mtext><mml:mo>=</mml:mo><mml:mn>96</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq4.gif"/></alternatives></inline-formula> (corresponding to the 6 base mutations when assuming strand symmetry times the 4 flanking nucleotides on each side, i.e. <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4 \cdot 6 \cdot 4 = 96$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mn>4</mml:mn><mml:mo>·</mml:mo><mml:mn>6</mml:mn><mml:mo>·</mml:mo><mml:mn>4</mml:mn><mml:mo>=</mml:mo><mml:mn>96</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq5.gif"/></alternatives></inline-formula>). The matrix <italic>H</italic> consists of K mutational signatures defined by probability vectors over the different mutation types. In the matrix <italic>W</italic>, each row contains the weights of the signatures for the corresponding patient. In this context, the weights are usually referred to as the exposures of the different signatures.</p>
    <p id="Par8">To estimate <italic>W</italic> and <italic>H</italic> we need to choose a model and a rank K for the data <italic>V</italic>. These two decisions are highly related as the optimal rank of the data <italic>V</italic> is often chosen by comparing the fit under a certain model for many different values of K. The optimal K is then found using a model selection procedure such as Akaike Information Criterion (AIC), Bayesian Information Criterion (BIC) or similar approaches described in “<xref rid="Sec12" ref-type="sec">Estimating the number of signatures</xref>” section. Most methods used in the literature [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>] for choosing the rank are based on the likelihood value, which depends on the assumed model. For mutational counts the usual model assumption is the Poisson distribution [<xref ref-type="bibr" rid="CR6">6</xref>]<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} V_{nm} \sim \text{Po}((WH)_{nm}), \end{aligned}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Po</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>W</italic> and <italic>H</italic> are estimated using the algorithm from [<xref ref-type="bibr" rid="CR14">14</xref>] that minimizes the generalized Kullback–Leibler divergence. The algorithm is equivalent to maximum likelihood estimation, as the negative log-likelihood function for the Poisson model is equal to the generalized Kullback–Leibler up to an additive constant. We observe that this model assumption is often inadequate. In particular, we observe overdispersion in the mutational counts, i.e. a situation where the variance in the data is greater than what is expected under the assumed model. This is a well known issue when modeling count data in biology [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
    <p id="Par9">We therefore suggest using a model where the mutational counts follow a Negative Binomial distribution that has an additional parameter to explain the overdispersion in the data. In recent years, this model is becoming more popular to model the dispersion in mutational counts [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. The Negative Binomial NMF is discussed in [<xref ref-type="bibr" rid="CR18">18</xref>], where it is applied to recommender systems, and it has recently been used in the context of cancer mutations in [<xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR21">21</xref>]. In Lyu et al. [<xref ref-type="bibr" rid="CR20">20</xref>] a supervised Negative Binomial NMF model is applied to mutational counts from different cancers which uses cancer types as metadata. Their aim is to obtain signatures with a clear etiology, which could be used to classify different cancer types. Vöhringer et al. [<xref ref-type="bibr" rid="CR21">21</xref>] extends the analysis by including several genomic features and uses tensors instead of the mutational count matrix to account for the different features. Lastly, [<xref ref-type="bibr" rid="CR19">19</xref>] applies Bayesian inference to extract mutational signatures and provide different probabilistic models for the signatures. Among the models implemented in this method also the Negative Binomial model is considered as a natural extension of the Poisson model.</p>
    <p id="Par10">For mutational count data, we extend the Negative Binomial NMF model by including patient specific dispersion which has not been included in the aforementioned works using the Negative Binomial model. The extended model is referred to as NB<sub>N</sub>-NMF, where N is the number of dispersion parameters (equivalent to the number of patients). We investigate when and why NB<sub>N</sub>-NMF is more suitable for mutational counts than the usual Poisson NMF (Po-NMF). In particular we evaluate the goodness of fit for mutational counts using a residual-based approach. Despite the recent efforts, we still believe, as it has also been mentioned in [<xref ref-type="bibr" rid="CR22">22</xref>], that a great amount of research has been focusing on improving the performance of NMF algorithms given an underlying model and less attention has been directed to the choice of the underlying model given the data and application.</p>
    <p id="Par11">Since the number of signatures depends on the chosen distributional assumption, we suggest using NB<sub>N</sub>-NMF and we also propose a novel model selection framework to choose the number of signatures. We show that our model selection procedure is more robust toward inappropriate model assumptions compared to classical methods (AIC and BIC) and other methods currently used in the literature such as <inline-formula id="IEq9"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M16"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq9.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR23">23</xref>], <inline-formula id="IEq10"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SparseSignatures}$$\end{document}</tex-math><mml:math id="M18"><mml:mi mathvariant="monospace">SparseSignatures</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq10.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR8">8</xref>], <inline-formula id="IEq11"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigneR}$$\end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="monospace">SigneR</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq11.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR13">13</xref>], <inline-formula id="IEq12"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{sigfit}$$\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="monospace">sigfit</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq12.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR19">19</xref>], and <inline-formula id="IEq13"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SignatureAnalyzer}$$\end{document}</tex-math><mml:math id="M24"><mml:mi mathvariant="monospace">SignatureAnalyzer</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq13.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR24">24</xref>]. We use both simulated and real data to validate our proposed model selection procedure against other methods. We chose one classical data set and analyze it in “<xref rid="Sec6" ref-type="sec">Breast cancer data</xref>” section and a larger data set from prostate cancer (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). The latter is a subset of the available data from the Pan-Cancer Analysis of Whole Genomes (PCAWG) database [<xref ref-type="bibr" rid="CR25">25</xref>], thus it corresponds to one of the largest available data sets for a single cancer type.</p>
    <p id="Par12">In comparison to the results published in [<xref ref-type="bibr" rid="CR20">20</xref>] and in [<xref ref-type="bibr" rid="CR21">21</xref>], our work is not exploiting the information coming from different cancer types or from different genomic features. However, we provide a patient specific dispersion component to account for the high variance between patients and derive the update steps for parameter estimation in the NB<sub>N</sub>-NMF. Furthermore, we propose a model selection procedure which proves to be robust to model misspecification.</p>
    <p id="Par13">We have implemented our methods in the R package SigMoS (Signatures Model Selection) that includes NB<sub>N</sub>-NMF and the model selection procedure. The R package is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/MartaPelizzola/SigMoS">https://github.com/MartaPelizzola/SigMoS</ext-link>. The package also contains the simulated and real data used in this paper.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par14">In this section we describe the results of our approach on both simulated and real data. Details on the method are provided in “<xref rid="Sec9" ref-type="sec">Methods</xref>” section. In short, we propose a Negative Binomial model applied to mutational count data with a patient specific dispersion coefficient. The matrices <italic>W</italic> and <italic>H</italic> are estimated with a majorization–minimization (MM) procedure, and we propose to use Negative Binomial maximum likelihood estimation (MLE) for estimating the dispersion parameters. Additionally, we introduce a new algorithm based on cross-validation to estimate the number of signatures for a given data set.</p>
    <p id="Par15">For simulated data we present a study on Negative Binomial simulated data with different levels of dispersion where results from AIC, BIC, <inline-formula id="IEq16"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M26"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq16.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR23">23</xref>], <inline-formula id="IEq17"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SparseSignatures}$$\end{document}</tex-math><mml:math id="M28"><mml:mi mathvariant="monospace">SparseSignatures</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq17.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR8">8</xref>], <inline-formula id="IEq18"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigneR}$$\end{document}</tex-math><mml:math id="M30"><mml:mi mathvariant="monospace">SigneR</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq18.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR13">13</xref>], <inline-formula id="IEq19"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{sigfit}$$\end{document}</tex-math><mml:math id="M32"><mml:mi mathvariant="monospace">sigfit</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq19.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR19">19</xref>] and <inline-formula id="IEq20"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SignatureAnalyzer}$$\end{document}</tex-math><mml:math id="M34"><mml:mi mathvariant="monospace">SignatureAnalyzer</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq20.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR24">24</xref>] are compared with our proposed model selection procedure. These results are discussed in “<xref rid="Sec3" ref-type="sec">Simulation study</xref>” section, where we show that our method performs well and is robust to model misspecification. Our method is applied to the 21 breast cancer patients from [<xref ref-type="bibr" rid="CR6">6</xref>] in “<xref rid="Sec6" ref-type="sec">Breast cancer data</xref>” section, and to 286 prostate cancer patients from [<xref ref-type="bibr" rid="CR25">25</xref>] in “<xref rid="Sec7" ref-type="sec">Prostate cancer data</xref>” section. The goodness of fit of the different models are evaluated using a residual analysis that shows a clear overdispersion with the Poisson model. The use of residual plots to evaluate the goodness of fit is a common strategy in statistics; some examples can be found in [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>].</p>
    <sec id="Sec3">
      <title>Simulation study</title>
      <p id="Par16">We simulated our data following the procedure of [<xref ref-type="bibr" rid="CR8">8</xref>] using the signatures from [<xref ref-type="bibr" rid="CR5">5</xref>]. We simulated 100 data sets for each scenario and varied the number of patients, the number of signatures and the model for the noise in the mutational count data. We considered 20, 100 and 300 patients and either 5 or 10 signatures following [<xref ref-type="bibr" rid="CR28">28</xref>] which states that the number of common signatures in each organ is usually between 5 and 10. For each simulation run we use signature 1 and 5 from [<xref ref-type="bibr" rid="CR5">5</xref>], as they have been shown to be shared across all cancer types, and then we sample at random three or eight additional signatures from this set. The exposures are simulated from a Negative Binomial model with mean 6000 and dispersion parameter 1.5 as in [<xref ref-type="bibr" rid="CR8">8</xref>]. This choice is based on estimates from the real data in [<xref ref-type="bibr" rid="CR29">29</xref>]. The mutational count data is then generated as the product of the exposure and signature matrix. Lastly, Poisson noise, Negative Binomial noise with dispersion parameter <inline-formula id="IEq21"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \in \{10, 200\}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>α</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>200</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq21.gif"/></alternatives></inline-formula> or uniformly sampled in [10, 500] are added to the mutational counts. The values of the patient specific dispersion are inspired from the data set in “<xref rid="Sec6" ref-type="sec">Breast cancer data</xref>” section. A lower <inline-formula id="IEq22"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M38"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq22.gif"/></alternatives></inline-formula> is associated with higher dispersion, however the actual level of dispersion associated to a given <inline-formula id="IEq23"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M40"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq23.gif"/></alternatives></inline-formula> value depends on the absolute mutational counts as can be seen from the variance in Eq. (<xref rid="Equ5" ref-type="disp-formula">5</xref>). Therefore it is not possible to directly compare these values with the ones estimated for the real data.</p>
      <sec id="Sec4">
        <title>Simulation results</title>
        <p id="Par17">The effect of the model assumption on the estimated number of signatures using AIC, BIC (see Eqs. (<xref rid="Equ14" ref-type="disp-formula">14</xref>) and (<xref rid="Equ15" ref-type="disp-formula">15</xref>)) and SigMoS as model selection procedures is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Figure <xref rid="Fig1" ref-type="fig">1</xref>a summarizes results for all simulation studies and for each study. This figure displays the proportion of scenarios where the true number of signatures is correctly estimated from the different methods: the darker the green color the higher is this proportion. This shows that our proposed approach is estimating the number of signatures accurately and is much more robust to model misspecifications compared to AIC and BIC. For example, when the true model has a small dispersion of <inline-formula id="IEq24"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 200$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq24.gif"/></alternatives></inline-formula> and the Poisson model is assumed, the difference between the performance of SigMoS and of AIC and BIC is already substantial. Here, AIC and BIC are never estimating the true number of signatures correctly, whereas our SigMoS procedure estimates the correct number of signatures in most cases (<inline-formula id="IEq25"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 85\%$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>85</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq25.gif"/></alternatives></inline-formula>). The table also shows that the higher the dispersion in the model, the harder it is to estimate the true number of signatures even when the correct model is specified.<fig id="Fig1"><label>Fig. 1</label><caption><p>Results from AIC, BIC, and SigMoS based on Po-NMF and NB<sub>N</sub>-NMF using simulated data. Each method is applied on different simulated data sets for four different types of noise: Poisson and Negative Binomial with dispersion parameter <inline-formula id="IEq27"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 10, 200$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq27.gif"/></alternatives></inline-formula> and <inline-formula id="IEq28"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \sim U(10,500)$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mi>α</mml:mi><mml:mo>∼</mml:mo><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>500</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq28.gif"/></alternatives></inline-formula>. <bold>a</bold> The proportion of simulation runs where the number of signatures is correctly estimated. The true number of signatures varies in <inline-formula id="IEq29"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{5,10\}$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq29.gif"/></alternatives></inline-formula> and the number of patients in <inline-formula id="IEq30"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{20,100,300\}$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>300</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq30.gif"/></alternatives></inline-formula>. The rectangular boxes highlight the results shown in <bold>b</bold>. The results are based on 100 simulation runs for scenarios with 20 and 100 patients and on 20 simulation runs for scenarios with 300 patients. <bold>b</bold> The estimated number of signatures in the range from 2 to 20 for 100 patients, where the true number of signatures is five</p></caption><graphic xlink:href="12859_2023_5304_Fig1_HTML" id="MO3"/></fig></p>
        <p id="Par18">Figure <xref rid="Fig1" ref-type="fig">1</xref>b depicts the actual estimated number of signatures in the range from 2 to 20 for the 100 data sets with 5 signatures and 100 patients. This clearly shows that the higher the overdispersion in the model, the more is the number of signatures overestimated. Assuming Poisson in the case of <inline-formula id="IEq31"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 200$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq31.gif"/></alternatives></inline-formula> we see that AIC is already overestimating the number of signatures. Here, these additional signatures are needed to explain the noise that is not accounted for by the Poisson model. Having an even higher overdispersion makes both AIC and BIC highly overestimate the number of signatures to a value that is plausibly much higher than 20. Even high overdispersion does not influence our SigMoS procedure in the same way and our approach is still estimating the true number of signatures for a large proportion of the scenarios. Assuming the Negative Binomial model all of the three methods have a really high performance, as the Negative Binomial accounts for both low and high dispersion.</p>
        <p id="Par19">In the simulation study from Fig. <xref rid="Fig1" ref-type="fig">1</xref>b we also consider the accuracy of the MLE for the <inline-formula id="IEq32"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M56"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq32.gif"/></alternatives></inline-formula> value in the two scenarios where each patient has the same <inline-formula id="IEq33"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M58"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq33.gif"/></alternatives></inline-formula>. Our approach estimates the true <inline-formula id="IEq34"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M60"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq34.gif"/></alternatives></inline-formula> with high accuracy when the dispersion is high i.e.  <inline-formula id="IEq35"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\alpha }} \in [9.21, 11.78]$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>9.21</mml:mn><mml:mo>,</mml:mo><mml:mn>11.78</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq35.gif"/></alternatives></inline-formula> for <inline-formula id="IEq36"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 10$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq36.gif"/></alternatives></inline-formula>, <inline-formula id="IEq37"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M66"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq37.gif"/></alternatives></inline-formula> is slightly overestimated when the dispersion is low: for <inline-formula id="IEq38"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 200$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq38.gif"/></alternatives></inline-formula> we find <inline-formula id="IEq39"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\alpha }} \in [225.8, 292.7]$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>225.8</mml:mn><mml:mo>,</mml:mo><mml:mn>292.7</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq39.gif"/></alternatives></inline-formula>. However, according to Fig. <xref rid="Fig1" ref-type="fig">1</xref>b this small bias does not affect the performance of our model selection procedure.</p>
      </sec>
      <sec id="Sec5">
        <title>Method comparison</title>
        <p id="Par20">Several methods have been proposed in the literature for estimating the number of signatures in cancer data. In the following we present the results of a comparison between our method and four commonly used methods in the literature: <inline-formula id="IEq40"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M72"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq40.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR23">23</xref>], <inline-formula id="IEq41"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SparseSignatures}$$\end{document}</tex-math><mml:math id="M74"><mml:mi mathvariant="monospace">SparseSignatures</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq41.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR8">8</xref>], <inline-formula id="IEq42"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SignatureAnalyzer}$$\end{document}</tex-math><mml:math id="M76"><mml:mi mathvariant="monospace">SignatureAnalyzer</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq42.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR24">24</xref>], <inline-formula id="IEq43"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{sigfit}$$\end{document}</tex-math><mml:math id="M78"><mml:mi mathvariant="monospace">sigfit</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq43.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR19">19</xref>], and <inline-formula id="IEq44"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigneR}$$\end{document}</tex-math><mml:math id="M80"><mml:mi mathvariant="monospace">SigneR</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq44.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR13">13</xref>]. <inline-formula id="IEq45"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M82"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq45.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR23">23</xref>] extracts mutational signatures by applying NMF to 100 normalized Poisson resampled input matrices for different values for the number of signatures. The number of mutational signatures is then estimated by evaluating the stability of mutational signatures and choosing the solution with the lowest number of signatures among the stable solutions that describe the data well. <inline-formula id="IEq46"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SparseSignatures}$$\end{document}</tex-math><mml:math id="M84"><mml:mi mathvariant="monospace">SparseSignatures</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq46.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR8">8</xref>] provides an alternative cross-validation approach where the test set is defined by setting 1% of the entries in the count matrix to 0. Then NMF is iteratively applied to the modified count matrix and the entries are updated at each iteration. The resulting signature and exposure matrices are used to predict the entries of the matrix corresponding to the test set. <inline-formula id="IEq47"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SignatureAnalyzer}$$\end{document}</tex-math><mml:math id="M86"><mml:mi mathvariant="monospace">SignatureAnalyzer</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq47.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR24">24</xref>], on the other hand, proposes a procedure where a Bayesian model is used and maximum a posteriori estimates are found with a majorize-minimization algorithm. <inline-formula id="IEq48"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{sigfit}$$\end{document}</tex-math><mml:math id="M88"><mml:mi mathvariant="monospace">sigfit</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq48.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR19">19</xref>] presents an R package providing different options for extracting and refitting signatures and exposures by Bayesian inference under different models. They propose a framework where a Multinomial, Normal, Poisson or Negative Binomial model (with mutation type specific dispersion parameter) can be used. The number of signatures is estimated using the elbow method by looking at changes in the accuracy of re-estimating the data with the extracted signatures and exposures. In our comparison we use the Poisson and Negative Binomial models within the <inline-formula id="IEq49"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{sigfit}$$\end{document}</tex-math><mml:math id="M90"><mml:mi mathvariant="monospace">sigfit</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq49.gif"/></alternatives></inline-formula> package and refer to them as <inline-formula id="IEq50"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {sigfit\text{- }Po}$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mi mathvariant="monospace">sigfit</mml:mi><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">Po</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq50.gif"/></alternatives></inline-formula> and <inline-formula id="IEq51"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {sigfit\text{- }NB}$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mi mathvariant="monospace">sigfit</mml:mi><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">NB</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq51.gif"/></alternatives></inline-formula>. Lastly, with <inline-formula id="IEq52"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigneR}$$\end{document}</tex-math><mml:math id="M96"><mml:mi mathvariant="monospace">SigneR</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq52.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR13">13</xref>] an empirical Bayesian approach based on BIC is used to estimate the number of mutational signatures.</p>
        <p id="Par21">For our method comparison, we run all methods on the simulated data from Fig. <xref rid="Fig1" ref-type="fig">1</xref>b. For each method and simulation setup we only allow the number of signatures to vary from two to eight due to the long running time of some of these methods.</p>
        <p id="Par22">Figure <xref rid="Fig2" ref-type="fig">2</xref> shows that, when Poisson data are simulated almost all methods have a very good performance and can recover the true number of signatures in most of the simulations. The poor performance of <inline-formula id="IEq53"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SparseSignatures}$$\end{document}</tex-math><mml:math id="M98"><mml:mi mathvariant="monospace">SparseSignatures</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq53.gif"/></alternatives></inline-formula> could be affected by not having a fixed background signature. Indeed, the improved performance of <inline-formula id="IEq54"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SparseSignatures}$$\end{document}</tex-math><mml:math id="M100"><mml:mi mathvariant="monospace">SparseSignatures</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq54.gif"/></alternatives></inline-formula> when a background signature is included has also been shown in [<xref ref-type="bibr" rid="CR8">8</xref>]. <inline-formula id="IEq55"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {sigfit\text{- }Po}$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mi mathvariant="monospace">sigfit</mml:mi><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">Po</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq55.gif"/></alternatives></inline-formula> is based on a more heuristic method and tends to underestimate the true number of signatures. When Negative Binomial noise is added to the simulated data with a moderate dispersion (<inline-formula id="IEq56"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 200$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq56.gif"/></alternatives></inline-formula>), <inline-formula id="IEq57"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {sigfit\text{- }Po}$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mi mathvariant="monospace">sigfit</mml:mi><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">Po</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq57.gif"/></alternatives></inline-formula>, <inline-formula id="IEq58"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SignatureAnalyzer}$$\end{document}</tex-math><mml:math id="M108"><mml:mi mathvariant="monospace">SignatureAnalyzer</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq58.gif"/></alternatives></inline-formula> and <inline-formula id="IEq59"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigneR}$$\end{document}</tex-math><mml:math id="M110"><mml:mi mathvariant="monospace">SigneR</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq59.gif"/></alternatives></inline-formula> have low power emphasizing the importance of correctly specifying the distribution for these methods, whereas our proposed approach (regardless of the distributional assumption), <inline-formula id="IEq60"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {sigfit\text{- }NB}$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mi mathvariant="monospace">sigfit</mml:mi><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">NB</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq60.gif"/></alternatives></inline-formula>, <inline-formula id="IEq61"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M114"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq61.gif"/></alternatives></inline-formula> and <inline-formula id="IEq62"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SparseSignatures}$$\end{document}</tex-math><mml:math id="M116"><mml:mi mathvariant="monospace">SparseSignatures</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq62.gif"/></alternatives></inline-formula> maintain good power. For patient specific dispersion also the power of <inline-formula id="IEq63"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SparseSignatures}$$\end{document}</tex-math><mml:math id="M118"><mml:mi mathvariant="monospace">SparseSignatures</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq63.gif"/></alternatives></inline-formula> and <inline-formula id="IEq64"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M120"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq64.gif"/></alternatives></inline-formula> decreases. Lastly, the power of <inline-formula id="IEq65"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {sigfit\text{- }NB}$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mi mathvariant="monospace">sigfit</mml:mi><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">NB</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq65.gif"/></alternatives></inline-formula> decreases for high dispersion (<inline-formula id="IEq66"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 10$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq66.gif"/></alternatives></inline-formula>): here the distributional assumptions are correctly specified, however this is a heuristic approach to estimate the number of signatures which tends to be less precise than SigMoS. Indeed, good performance is achieved with our proposed approach even under high dispersion if the correct distribution is assumed. These results demonstrate that SigMoS is accurate for detecting the correct number of signatures and it performs well also in situations with overdispersion compared to other methods.<fig id="Fig2"><label>Fig. 2</label><caption><p>Method comparison using simulated data. Each method is applied on the data sets from Fig. <xref rid="Fig1" ref-type="fig">1</xref>b and, for each data set, the value of the estimated number of signatures is kept. We test values for the number of signatures from two to eight for Poisson noise and Negative Binomial noise with <inline-formula id="IEq67"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = \{10, 200 \}$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>200</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq67.gif"/></alternatives></inline-formula>, and a patient specific dispersion parameter <inline-formula id="IEq68"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \sim U(10,500)$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mi>α</mml:mi><mml:mo>∼</mml:mo><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>500</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq68.gif"/></alternatives></inline-formula></p></caption><graphic xlink:href="12859_2023_5304_Fig2_HTML" id="MO4"/></fig></p>
        <p id="Par23">For this set of simulations we also checked the quality of the estimated signatures. We sampled 10 runs for each scenario from Fig. <xref rid="Fig2" ref-type="fig">2</xref> and calculated the cosine similarity between the estimated signatures and the true ones used for simulations. The results for all methods are shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref> where we display the average cosine similarity over 10 runs for each method and each scenario. For this study we fixed the number of signatures to five for all methods, which may favour methods such as <inline-formula id="IEq69"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SignatureAnalyzer}$$\end{document}</tex-math><mml:math id="M130"><mml:mi mathvariant="monospace">SignatureAnalyzer</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq69.gif"/></alternatives></inline-formula>, <inline-formula id="IEq70"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{sigfit}$$\end{document}</tex-math><mml:math id="M132"><mml:mi mathvariant="monospace">sigfit</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq70.gif"/></alternatives></inline-formula> or <inline-formula id="IEq71"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigneR}$$\end{document}</tex-math><mml:math id="M134"><mml:mi mathvariant="monospace">SigneR</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq71.gif"/></alternatives></inline-formula> that usually overestimate the number of signatures. Nonetheless, these results also show that SigMoS combined with the Negative Binomial model and <inline-formula id="IEq72"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {sigfit\text{- }NB}$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:mi mathvariant="monospace">sigfit</mml:mi><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">NB</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq72.gif"/></alternatives></inline-formula> are the methods that are able to retain the highest accuracy also with high levels of overdispersion (namely <inline-formula id="IEq73"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 10$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq73.gif"/></alternatives></inline-formula>). <inline-formula id="IEq74"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M140"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq74.gif"/></alternatives></inline-formula> and <inline-formula id="IEq75"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigneR}$$\end{document}</tex-math><mml:math id="M142"><mml:mi mathvariant="monospace">SigneR</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq75.gif"/></alternatives></inline-formula> also show good accuracy especially when the overdispersion is low and under the Poisson model. These results, combined with those in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, show that for real data where the variance may be higher than the one accounted for under the Poisson model, using a Negative Binomial model is essential. Indeed, this distributional assumption leads to high accuracy in the estimated signatures and SigMoS combined with the Negative Binomial model is able to maintain high accuracy and also correctly infer the true number of signatures.<fig id="Fig3"><label>Fig. 3</label><caption><p>Quality of estimated signatures using simulated data. Each method is applied on 10 randomly sampled data sets from Fig. <xref rid="Fig1" ref-type="fig">1</xref>b and, for each data set, the value of the estimated number of signatures is fixed to 5. We show the quality of the estimated signatures measured by cosine similarity for all methods with Poisson noise and Negative Binomial noise with <inline-formula id="IEq76"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 10, 200$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq76.gif"/></alternatives></inline-formula>, and a patient specific dispersion parameter <inline-formula id="IEq77"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \sim U(10,500)$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:mi>α</mml:mi><mml:mo>∼</mml:mo><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>500</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq77.gif"/></alternatives></inline-formula></p></caption><graphic xlink:href="12859_2023_5304_Fig3_HTML" id="MO5"/></fig></p>
        <p id="Par24">We additionally compared our method to an independent set of simulated data from [<xref ref-type="bibr" rid="CR30">30</xref>]. Here, the authors propose an alternative cross-validation procedure for estimating the number of signatures and describe a method comparison where <inline-formula id="IEq78"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M148"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq78.gif"/></alternatives></inline-formula>, <inline-formula id="IEq79"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SignatureAnalyzer}$$\end{document}</tex-math><mml:math id="M150"><mml:mi mathvariant="monospace">SignatureAnalyzer</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq79.gif"/></alternatives></inline-formula> and <inline-formula id="IEq80"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigneR}$$\end{document}</tex-math><mml:math id="M152"><mml:mi mathvariant="monospace">SigneR</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq80.gif"/></alternatives></inline-formula> are included. We considered their 20 simulated data sets comprising of 200 patients and 9 signatures each and we run SigMoS under both the Negative Binomial and the Poisson model. The signatures used for this set of simulations have been taken from the PCAWG breast cancer study [<xref ref-type="bibr" rid="CR4">4</xref>] where two pairs of signatures are highly similar, namely signatures SBS1 and SBS5 as well as SBS2 and SBS13, and their exposures have been resampled jointly when generating the data. It is not surprising that our method often estimates less than 9 signatures (7 or 8 signatures are reconstructed in most of the scenarios). We compared these results to the ones in [<xref ref-type="bibr" rid="CR30">30</xref>] where a method based on cross-validation is proposed to estimate the number of signatures. Here, an extensive method comparison is available showing the accuracy in estimating the true signatures. We provide similar results in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S1 and S2 where our method is run with Po-NMF and NB<sub>N</sub>-NMF. Comparing these results to Fig. S9 in [<xref ref-type="bibr" rid="CR30">30</xref>], we can see that most methods tend to estimate less than 9 signatures and that the accuracy of the signatures estimated by SigMoS is always higher or comparable to the ones estimated by the other methods.</p>
        <p id="Par25">These results indicate that our proposed approach is robust to different simulation set ups, has very good performance on a wide range of scenarios, and provides more accurate estimates of the underlying number of signatures and of the actual mutational signatures when compared to other methods available in the literature, suggesting that it will also be robust when applied to real data. Computational cost results for our method in terms of memory usage and time until convergence as a function of the number of patients are available in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S2. SigMoS runs on a standard laptop with Intel Core i7 processor in less than a few minutes and uses less than 25 gigabase of memory for data sets with up to 500 patients and 5 signatures. Both memory consumption and running time increase linearly with the number of patients, but even large data sets can be run fairly quickly on a standard laptop (for 1000 patients SigMoS used up to 100 GB and the running time went up to 7 min for the slowest scenarios).</p>
      </sec>
    </sec>
    <sec id="Sec6">
      <title>Breast cancer data</title>
      <p id="Par26">This data set consists of the mutational counts from the 21 breast cancer patients that has previously been described and analyzed in several papers [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. The data can be found through the link <ext-link ext-link-type="uri" xlink:href="ftp://ftp.sanger.ac.uk/pub/cancer/AlexandrovEtAl">ftp://ftp.sanger.ac.uk/pub/cancer/AlexandrovEtAl</ext-link> from [<xref ref-type="bibr" rid="CR11">11</xref>] and have been extensively analyzed in [<xref ref-type="bibr" rid="CR4">4</xref>].</p>
      <p id="Par27">In Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, we have applied SigMoS and BIC to choose the number of signatures for both Po-NMF and NB<sub>N</sub>-NMF. We have included the BIC to compare with the SigMoS method as it provides similar results to the state-of-the-art methods. SigMoS indicates to use three signatures for both methods. This is in line with the results of our simulation study, where we show that our model selection is robust to model misspecification. According to BIC, six signatures are needed for Po-NMF whereas only three signatures should be used with NB<sub>N</sub>-NMF which emphasizes the importance of a correct model choice when using BIC. In this framework and in “<xref rid="Sec7" ref-type="sec">Prostate cancer data</xref>” section we compared SigMoS to BIC, as Fig. <xref rid="Fig1" ref-type="fig">1</xref> shows that this is more robust than AIC. BIC is also often used as model selection criteria in the analysis of real data sets in the literature. We refer to “<xref rid="Sec5" ref-type="sec">Method comparison</xref>” section for comparisons with other state-of-the-art methods.<fig id="Fig4"><label>Fig. 4</label><caption><p>Results for Po-NMF and NB<sub>N</sub>-NMF applied to a data set with 21 breast cancer patients. <bold>a</bold> The optimal number of signatures estimated from SigMoS and BIC when using Po-NMF and NB<sub>N</sub>-NMF. <bold>b</bold> The residual plots for Po-NMF and <inline-formula id="IEq87"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M154"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq87.gif"/></alternatives></inline-formula>-NMF when assuming the estimated number of signatures from SigMoS i.e. 3 signatures in both cases. The lines in the top plot correspond to two times the expected variance under the chosen distributional assumption. As the <inline-formula id="IEq88"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq88.gif"/></alternatives></inline-formula>-NMF holds 21 different expected variances, we have chosen to plot the median, minimum and maximum variance among the 21. The second plots show the normalized residuals. The vertical blue and red lines depict the theoretical quantiles and the gray lines show the observed quantiles</p></caption><graphic xlink:href="12859_2023_5304_Fig4_HTML" id="MO6"/></fig></p>
      <p id="Par28">For three signatures we show in Fig. <xref rid="Fig4" ref-type="fig">4</xref>b the corresponding raw residuals <inline-formula id="IEq89"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{nm} = V_{nm} - (WH)_{nm}$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq89.gif"/></alternatives></inline-formula> to determine the best fitting model. The residuals are plotted against the expected mean <inline-formula id="IEq90"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(WH)_{nm}$$\end{document}</tex-math><mml:math id="M160"><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq90.gif"/></alternatives></inline-formula>, as the variance in both the Poisson and Negative Binomial model depends on this value. The colored lines in the residual plots correspond to <inline-formula id="IEq91"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm 2\sigma$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mo>±</mml:mo><mml:mn>2</mml:mn><mml:mi>σ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq91.gif"/></alternatives></inline-formula> for the Poisson and the Negative Binomial distribution, respectively. The variance <inline-formula id="IEq92"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma ^2$$\end{document}</tex-math><mml:math id="M164"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq92.gif"/></alternatives></inline-formula> can be derived from Eq. (<xref rid="Equ5" ref-type="disp-formula">5</xref>) for the Negative Binomial model and is equal to the mean for the Poisson model.</p>
      <p id="Par29">For Po-NMF we observe a clear overdispersion in the residuals, which suggests to use a Negative Binomial model. In the residual plot for the <inline-formula id="IEq93"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M166"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq93.gif"/></alternatives></inline-formula>-NMF we see that the residuals have a much better fit to the variance structure, which is indicated by the colored lines. The quantile lines in the lower panel with normalized residuals again show that the quantiles from the <inline-formula id="IEq94"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M168"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq94.gif"/></alternatives></inline-formula>-NMF are much closer to the theoretical ones, suggesting that the Negative Binomial model is better suited for this data. The patient specific dispersion is very diverse in this data as the <inline-formula id="IEq95"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M170"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq95.gif"/></alternatives></inline-formula> values for the first 20 patients are between 16 (very high dispersion) and 550 (moderate dispersion) and the last patient has <inline-formula id="IEq96"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _{21} = 26083$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>21</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>26083</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq96.gif"/></alternatives></inline-formula>.</p>
      <p id="Par30">We compare the signatures found by our method to the available signatures in the COSMIC database [<xref ref-type="bibr" rid="CR5">5</xref>] downloaded from <ext-link ext-link-type="uri" xlink:href="https://cancer.sanger.ac.uk/cosmic">https://cancer.sanger.ac.uk/cosmic</ext-link>. We find that our three reconstructed signatures are similar to signatures SBS1, SBS2, SBS3. The corresponding cosine similarities are reported in Table <xref rid="Tab1" ref-type="table">1</xref> and show high similarity between our reconstructed signatures and the ones from the COSMIC database especially for SBS2 and SBS3. Indeed, a cosine similarity of 0.8 has been used as threshold in [<xref ref-type="bibr" rid="CR31">31</xref>] to group similar signatures, suggesting that SigMoS is able to identify relevant signatures in the COSMIC database. According to the results in [<xref ref-type="bibr" rid="CR4">4</xref>] SBS1 and SBS2 are found across most cancer types and a large proportion of breast cancer samples showing these two signatures has been found. SBS3 has also been found in a large proportion of breast cancer samples and it also has high mutational burden in breast cancer tumors. SBS3 has also been associated to the BRCA1/2 mutation [<xref ref-type="bibr" rid="CR4">4</xref>]. The validation of our signatures with the COSMIC database shows that in this case SigMoS can correctly infer signatures that have been proved to be strongly associated with breast cancer.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Cosine similarity for the breast cancer data set between the signatures extracted by SigMoS and the ones in the COSMIC database</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">SBS1</th><th align="left">SBS2</th><th align="left">SBS3</th></tr></thead><tbody><tr><td align="left">Po-NMF</td><td align="left">0.65</td><td align="left">0.76</td><td align="left">0.79</td></tr><tr><td align="left"><inline-formula id="IEq97"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M174"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq97.gif"/></alternatives></inline-formula>-NMF</td><td align="left">0.62</td><td align="left">0.76</td><td align="left">0.80</td></tr></tbody></table><table-wrap-foot><p>The COSMIC signature with the highest cosine similarity is shown for each signature estimated by SigMoS</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec7">
      <title>Prostate cancer data</title>
      <p id="Par31">We also considered a more recent data set from the Pan-Cancer Analysis of Whole Genomes (PCAWG) database [<xref ref-type="bibr" rid="CR25">25</xref>] where 2782 patients from different cancer types are available. The mutational counts from the full PCAWG database can be found at <ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#%21Synapse:syn11726620">https://www.synapse.org/#!Synapse:syn11726620</ext-link>. From this data set, we extracted mutational counts for all the 286 prostate cancer patients and used them directly for our analysis.</p>
      <p id="Par32">We chose again both the Poisson and Negative Binomial as underlying distributions for the NMF and in both cases we applied SigMoS for determining the number of signatures. We present the results in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. Figure <xref rid="Fig5" ref-type="fig">5</xref>a shows again that our model selection procedure is more stable under model misspecification compared to BIC: the estimated number of signatures is changing from 9 to 4 between the two model assumptions for BIC, but only from 6 to 5 for SigMoS. As for Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, the residuals in Fig. <xref rid="Fig5" ref-type="fig">5</xref>b show that the <inline-formula id="IEq98"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M176"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq98.gif"/></alternatives></inline-formula>-NMF model provides a much better fit to the data than the Po-NMF. The estimated values for the patient specific dispersion are <inline-formula id="IEq99"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _n \in [1.4,4279]$$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1.4</mml:mn><mml:mo>,</mml:mo><mml:mn>4279</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq99.gif"/></alternatives></inline-formula> with a median of 140 (corresponding to a quite large dispersion).<fig id="Fig5"><label>Fig. 5</label><caption><p>Results for Po-NMF and <inline-formula id="IEq100"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M180"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq100.gif"/></alternatives></inline-formula>-NMF applied to a data set with 286 prostate cancer patients from the PCAWG database [<xref ref-type="bibr" rid="CR25">25</xref>]. <bold>a</bold> The optimal number of signatures estimated from SigMoS and BIC when using Po-NMF and <inline-formula id="IEq101"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M182"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq101.gif"/></alternatives></inline-formula>-NMF. <bold>b</bold> The residual plots for Po-NMF and <inline-formula id="IEq102"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M184"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq102.gif"/></alternatives></inline-formula>-NMF when assuming the estimated number of signatures from SigMoS i.e. 5 and 6 signatures. The lines in the first plot correspond to two times the expected variance under the chosen distributional assumption. For <inline-formula id="IEq103"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M186"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq103.gif"/></alternatives></inline-formula>-NMF, the colored lines in the top plot show the median, minimum and maximum variance among the patients. The bottom plots show the normalized residuals. The vertical blue and red lines depict the theoretical quantiles and the gray lines the observed quantiles</p></caption><graphic xlink:href="12859_2023_5304_Fig5_HTML" id="MO7"/></fig></p>
      <p id="Par33">As for the previous section we compare our reconstructed signatures with the ones in the COSMIC database. Table <xref rid="Tab2" ref-type="table">2</xref> shows the cosine similarity between the signatures extracted by SigMoS and the most similar ones from the COSMIC repository. Here, <inline-formula id="IEq104"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M188"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq104.gif"/></alternatives></inline-formula>-NMF provides much better results in terms of signatures estimation showing the importance of accounting for overdispersion. Indeed, <inline-formula id="IEq105"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M190"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq105.gif"/></alternatives></inline-formula>-NMF finds signatures SBS1, SBS5, SBS8, SBS18, SBS37. These signatures are all largely present in prostate cancer either for their presence in many prostate tumor samples or for their contribution in terms of number of mutations per tumor or for both reasons combined. On the contrary, signatures SBS6 and SBS36 are not found in prostate cancer, showing that <inline-formula id="IEq106"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M192"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq106.gif"/></alternatives></inline-formula>-NMF is more accurate.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Cosine similarity for the Prostate cancer data set between the signatures extracted by SigMoS and the ones in the COSMIC database</p></caption><graphic position="anchor" xlink:href="12859_2023_5304_Tab2_HTML" id="MO10"/><table-wrap-foot><p>The COSMIC signature with the highest cosine similarity is shown for each signature estimated by SigMoS. Signatures found in many prostate samples or having high mutation counts on prostate samples are highlighted in colour in the table</p></table-wrap-foot></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p id="Par34">Mutational profiles from cancer patients are a widely used source of information and NMF is often applied to these data in order to identify signatures associated with cancer types. We propose a new approach to perform the analysis and signature extraction from mutational count data where we emphasize the importance of validating the model using residual analysis, and we propose a robust model selection procedure.</p>
    <p id="Par35">We use the Negative Binomial model as an alternative to the commonly used Poisson model as the Negative Binomial can account for the high dispersion in the data. As a further extension of this model, we allow the Negative Binomial to have a patient specific variability component to account for heterogeneous variance across patients.</p>
    <p id="Par36">We propose a model selection approach for choosing the number of signatures. As we show in “<xref rid="Sec3" ref-type="sec">Simulation study</xref>” section this method works well with both Negative Binomial and Poisson data, and it is a robust procedure for choosing the number of signatures. We note that the choice of the divergence measure for the <italic>cost</italic> function in Algorithm 2 is not trivial and may favor one or the other model and thus a comparison of the costs between different NMF methods is not possible. For example, in our framework, we use the Kullback–Leibler divergence which would favor the Poisson model. This means that a direct comparison between the cost values for Po-NMF and <inline-formula id="IEq108"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M194"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq108.gif"/></alternatives></inline-formula>-NMF is not feasible. To check the goodness of fit and choose between the Poisson model and the Negative Binomial model we propose to use the residuals instead.</p>
    <p id="Par37">In Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S4, we investigated the role of the cost function in our model selection by including the Frobenius norm and Itakura–Saito (IS) [<xref ref-type="bibr" rid="CR32">32</xref>] divergence measure from [<xref ref-type="bibr" rid="CR33">33</xref>], where the authors propose a fast implementation of the NMF algorithm with general Bregman divergence. In this investigation the cost function did not influence the optimal number of signatures. The only difference was how the cost values differed among the NMF methods, as each cost function favored the models differently. Therefore we chose to use the Kullback–Leibler divergence and compared the methods with the residual analysis.</p>
    <p id="Par38">Less signatures are found when accounting for overdispersion with the Negative Binomial model. Indeed, there is no need to have additional signatures explaining noise, which we assume is the case for the Poisson model. We show that the Negative Binomial model is more suitable and therefore believe the corresponding signatures are more accurate. This can be helpful when working with mutational profiles for being able to better associate signatures with cancer types and for a clearer interpretation of the signatures when analyzing mutational count data. For example, the recent results in [<xref ref-type="bibr" rid="CR28">28</xref>] use a large data set with several different cancer types and show that there exists a set of common signatures that is shared across organs and a set of rare signatures that are only found with a sufficiently large sample size. To recover the common signatures the patients with unusual mutational profiles were excluded as they are introducing additional variance in the signature estimation procedure. We speculate that changing the Poisson assumption in this approach with the Negative Binomial distribution could provide a simpler and more robust way to extract common signatures. Indeed, the Negative Binomial model allows for more variability in the data and our simulation results and residual plots in “<xref rid="Sec2" ref-type="sec">Results</xref>” section show that the Negative Binomial distribution is beneficial for stable signature estimation. In this work we have focused on single base substitutions, but the Negative Binomial NMF can be highly beneficial also for analyzing indels or other variant types. In [<xref ref-type="bibr" rid="CR4">4</xref>] they discuss that mutational matrices corresponding to indels harbor more variation which means that more flexible models than the Poisson are needed in this situation.</p>
    <p id="Par39">The workflow for analyzing the data, and the procedures in Algorithms 1 and 2 are available in the R package SigMoS at <ext-link ext-link-type="uri" xlink:href="https://github.com/MartaPelizzola/SigMoS">https://github.com/MartaPelizzola/SigMoS</ext-link>.</p>
  </sec>
  <sec id="Sec9">
    <title>Methods</title>
    <p id="Par40">This section is structured as follows: in “<xref rid="Sec10" ref-type="sec">Negative Binomial model for mutational counts</xref>” section we describe the Negative Binomial model applied to mutational count data. Then we propose an extension where a patient specific dispersion coefficient is used. The majorization–minimization (MM) procedure for patient specific dispersion <inline-formula id="IEq109"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ \alpha _1, \ldots , \alpha _N \}$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq109.gif"/></alternatives></inline-formula> can be found in “<xref rid="Sec11" ref-type="sec">Patient specific NB<sub>N</sub>-NMF</xref>” section. In our application, we propose to use Negative Binomial maximum likelihood estimation (MLE) for <inline-formula id="IEq110"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M198"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq110.gif"/></alternatives></inline-formula> and <inline-formula id="IEq111"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ \alpha _n: 1 \le n \le N \}$$\end{document}</tex-math><mml:math id="M200"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq111.gif"/></alternatives></inline-formula> instead of the grid search adopted in [<xref ref-type="bibr" rid="CR18">18</xref>]. The pseudocode shown in the initial steps of Algorithm 1 describes this approach for patient specific dispersion. For shared dispersion among all patients and mutation types we simply set <inline-formula id="IEq112"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = \alpha _1 = \cdots = \alpha _N$$\end{document}</tex-math><mml:math id="M202"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq112.gif"/></alternatives></inline-formula> in Algorithm 1. Lastly, in “<xref rid="Sec12" ref-type="sec">Estimating the number of signatures</xref>” section we describe our proposed algorithm to estimate the number of signatures.</p>
    <sec id="Sec10">
      <title>Negative Binomial model for mutational counts</title>
      <p id="Par41">In this section we argue why the Negative Binomial model in [<xref ref-type="bibr" rid="CR18">18</xref>] is a natural model for the number of somatic mutations in a cancer patient. We start by illustrating the equivalence of the Negative Binomial to the more natural Beta-Binomial model as a motivation for our model choice.</p>
      <p id="Par42">Assume a certain mutation type can occur in <inline-formula id="IEq113"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M204"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq113.gif"/></alternatives></inline-formula> triplets along the genome with a probability <italic>p</italic>. Then it is natural to model the mutational counts with a binomial distribution [<xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR35">35</xref>]<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} V_{nm} \sim \text{Bin}(\tau ,p). \end{aligned}$$\end{document}</tex-math><mml:math id="M206" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Bin</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>However, [<xref ref-type="bibr" rid="CR36">36</xref>] observed that the probability of a mutation varies along the genome and is correlated with both expression levels and DNA replication timing. We therefore introduce the Beta-Binomial model<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} V_{nm}|&amp;p \sim \text{Bin}( \tau , p) \\&amp;p \sim \text{Beta}(\alpha , \beta ), \end{aligned} \end{aligned}$$\end{document}</tex-math><mml:math id="M208" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∼</mml:mo><mml:mtext>Bin</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where the beta prior on the probability <italic>p</italic> models the heterogeneity of the probability of a mutation for the different mutation types due to the high variance along the genome. As <italic>p</italic> follows a Beta distribution, its expected value is <inline-formula id="IEq114"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbb{E}[p] = {\alpha }/{(\alpha + \beta )}$$\end{document}</tex-math><mml:math id="M210"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq114.gif"/></alternatives></inline-formula>. For mutational counts, the number of triplets <inline-formula id="IEq115"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M212"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq115.gif"/></alternatives></inline-formula> is extremely large and the probability of mutation <italic>p</italic> is very small. In the data described in [<xref ref-type="bibr" rid="CR36">36</xref>] there are typically between 1 and 10 mutations per megabase with an average of 4 mutations per megabase (<inline-formula id="IEq116"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau \approx 10^6$$\end{document}</tex-math><mml:math id="M214"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>≈</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq116.gif"/></alternatives></inline-formula>). This means <inline-formula id="IEq117"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbb{E}[p] = {\alpha }/{(\alpha + \beta )} \approx 4 \cdot 10^{-6}$$\end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mn>4</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq117.gif"/></alternatives></inline-formula> and thus, for mutational counts in cancer genomes we have that <inline-formula id="IEq118"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta&gt;&gt; \alpha$$\end{document}</tex-math><mml:math id="M218"><mml:mrow><mml:mi>β</mml:mi><mml:mo>&gt;</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq118.gif"/></alternatives></inline-formula>. As <inline-formula id="IEq119"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M220"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq119.gif"/></alternatives></inline-formula> is large and <italic>p</italic> is small, the Binomial model is very well approximated by the Poisson model <inline-formula id="IEq120"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{Bin}(\tau , p) \backsimeq \text{Pois}(\tau p)$$\end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:mtext>Bin</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋍</mml:mo><mml:mtext>Pois</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq120.gif"/></alternatives></inline-formula>. This distributional equivalence of Poisson and Binomial when <inline-formula id="IEq121"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau$$\end{document}</tex-math><mml:math id="M224"><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq121.gif"/></alternatives></inline-formula> is large and <italic>p</italic> is small is well known. This also means that the models (<xref rid="Equ1" ref-type="disp-formula">1</xref>) and (<xref rid="Equ2" ref-type="disp-formula">2</xref>) are approximately equivalent with <inline-formula id="IEq122"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau p = (WH)_{nm}$$\end{document}</tex-math><mml:math id="M226"><mml:mrow><mml:mi>τ</mml:mi><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq122.gif"/></alternatives></inline-formula>.</p>
      <p id="Par43">The Beta and Gamma distributions are also approximately equivalent in our setting. Indeed, as <inline-formula id="IEq123"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta&gt;&gt; \alpha$$\end{document}</tex-math><mml:math id="M228"><mml:mrow><mml:mi>β</mml:mi><mml:mo>&gt;</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq123.gif"/></alternatives></inline-formula>, the Beta density can be approximated by the Gamma density in the following way<disp-formula id="Equ17"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{p^{\alpha - 1}(1-p)^{\beta - 1}}{B(\alpha , \beta )}&amp;= \frac{p^{\alpha - 1}}{\Gamma (\alpha )} (\beta -1+\alpha )(\beta -1 + (\alpha -1)) \cdots (\beta -1) (1-p)^{\beta - 1} \\&amp;\approx \frac{p^{\alpha - 1}}{\Gamma (\alpha )} \beta ^\alpha (e^{-p})^{\beta }. \end{aligned}$$\end{document}</tex-math><mml:math id="M230" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⋯</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>≈</mml:mo><mml:mfrac><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mi>β</mml:mi><mml:mi>α</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>β</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula>Therefore, for mutational counts, the model in (<xref rid="Equ3" ref-type="disp-formula">3</xref>) is equivalent to<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} V_{nm}|&amp;p \sim \text{Po}( \tau p) \\&amp;p \sim \text{Gamma}(\alpha , \beta ). \end{aligned} \end{aligned}$$\end{document}</tex-math><mml:math id="M232" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∼</mml:mo><mml:mtext>Po</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∼</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>Since the Negative Binomial model is a Gamma–Poisson model we can also write the model as<disp-formula id="Equ18"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} V_{nm} \sim \text{NB} \left( \alpha , \frac{\tau }{\beta + \tau }\right) \backsimeq \text{NB} \left( \alpha , \frac{ \tau \mathbb{E}[ p]}{\alpha + \tau \mathbb{E}[p]}\right) \backsimeq \text{NB}\left( \alpha , \frac{(WH)_{nm}}{\alpha + (WH)_{nm}} \right) ,\end{aligned}$$\end{document}</tex-math><mml:math id="M234" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>NB</mml:mtext><mml:mfenced close=")" open="("><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mfrac><mml:mi>τ</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>⋍</mml:mo><mml:mtext>NB</mml:mtext><mml:mfenced close=")" open="("><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mi>τ</mml:mi><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>⋍</mml:mo><mml:mtext>NB</mml:mtext><mml:mfenced close=")" open="("><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula>where the last parametrization is equivalent to the one in [<xref ref-type="bibr" rid="CR18">18</xref>]. In the first distributional equivalence we use <inline-formula id="IEq124"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbb{E}[p] \approx \frac{\alpha }{\beta }$$\end{document}</tex-math><mml:math id="M236"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mfrac><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq124.gif"/></alternatives></inline-formula> and in the second we use <inline-formula id="IEq125"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau \mathbb{E}[ p] = (WH)_{nm}$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:mi>τ</mml:mi><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq125.gif"/></alternatives></inline-formula>. Compared to the Beta-Binomial model, the Negative Binomial model has one fewer parameter and is analytically more tractable. The mean and variance of this model are given by<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathbb{E}[V_{nm}] = (WH)_{nm} \quad \text{and} \quad \text{Var}(V_{nm}) = (WH)_{nm} \left( 1 + \frac{(WH)_{nm}}{\alpha }\right) . \end{aligned}$$\end{document}</tex-math><mml:math id="M240" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:mtext>Var</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mi>α</mml:mi></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>When <inline-formula id="IEq126"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \rightarrow \infty$$\end{document}</tex-math><mml:math id="M242"><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq126.gif"/></alternatives></inline-formula> above, the Negative Binomial model converges to the more commonly used Poisson model as <inline-formula id="IEq127"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{Var}(V_{nm}) \downarrow (WH)_{nm}$$\end{document}</tex-math><mml:math id="M244"><mml:mrow><mml:mtext>Var</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">↓</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq127.gif"/></alternatives></inline-formula>. As shown in this section, the Negative Binomial model can be seen both as an extension of the Poisson model and as equivalent to the Beta-Binomial model. Thus, we opted to implement a Negative Binomial NMF model for mutational count data. More details on the approximation of the Negative Binomial to the Beta-Binomial distribution can also be found in [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
    </sec>
    <sec id="Sec11">
      <title>Patient specific NB<sub>N</sub>-NMF</title>
      <p id="Par44">In this section we describe our patient specific Negative Binomial non-negative matrix factorization NB<sub>N</sub>-NMF model and the corresponding estimation procedure.</p>
      <p id="Par45">Gouvert et al. [<xref ref-type="bibr" rid="CR18">18</xref>], Lyu et al. [<xref ref-type="bibr" rid="CR20">20</xref>] and Vöhringer et al. [<xref ref-type="bibr" rid="CR21">21</xref>] present a Negative Binomial model where <inline-formula id="IEq130"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M246"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq130.gif"/></alternatives></inline-formula> is shared across all observations. However, the probability of a mutation in (<xref rid="Equ3" ref-type="disp-formula">3</xref>) is highly variable across patients (see e.g. mutational burden in [<xref ref-type="bibr" rid="CR28">28</xref>] and our discussion in “<xref rid="Sec6" ref-type="sec">Breast cancer data</xref>” section), thus we extend the Negative Binomial NMF model from [<xref ref-type="bibr" rid="CR18">18</xref>] by allowing patient specific dispersion. We noticed that the variability among different patients is usually much higher than the one among different mutation types, thus we decided to focus on patient specific dispersion.</p>
      <p id="Par46">The entries in <italic>V</italic> are modeled as<disp-formula id="Equ19"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}V_{nm} \sim \text{NB}\left( \alpha _n, \frac{(WH^T)_{nm}}{\alpha _n + (WH^T)_{nm}}\right) , \end{aligned}$$\end{document}</tex-math><mml:math id="M248" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>NB</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:msup><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:msup><mml:mi>H</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq131"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _n$$\end{document}</tex-math><mml:math id="M250"><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq131.gif"/></alternatives></inline-formula> is the dispersion coefficient of each patient, and the corresponding Gamma–Poisson hierarchical model can be rewritten as:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;V_{nm}|a_{nm} \sim \text{Po}(a_{nm}(WH)_{nm}) \nonumber \\&amp;a_{nm} \sim \text{Gamma}(\alpha _n, \alpha _n). \end{aligned}$$\end{document}</tex-math><mml:math id="M252" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Po</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>Here <inline-formula id="IEq132"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_{nm}$$\end{document}</tex-math><mml:math id="M254"><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq132.gif"/></alternatives></inline-formula> is the parameter responsible for the variability in the Negative Binomial model. Note that <inline-formula id="IEq133"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb{E}}[a_{nm}] = 1$$\end{document}</tex-math><mml:math id="M256"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq133.gif"/></alternatives></inline-formula> and <inline-formula id="IEq134"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{Var}(a_{nm}) = 1/\alpha _n$$\end{document}</tex-math><mml:math id="M258"><mml:mrow><mml:mtext>Var</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq134.gif"/></alternatives></inline-formula>.</p>
      <p id="Par47">Now we can write the Negative Binomial log-likelihood function with patent specific <inline-formula id="IEq135"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _n$$\end{document}</tex-math><mml:math id="M260"><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq135.gif"/></alternatives></inline-formula><disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \ell (W,H;V)&amp;= \sum _{n=1}^N \sum _{m=1}^M \Bigg \{ \log { \left( {\begin{array}{c}\alpha _n + V_{nm} - 1\\ \alpha _n\end{array}}\right) } + V_{nm} \log \left( { \frac{(WH)_{nm}}{\alpha _n + (WH)_{nm}}}\right) \nonumber \\&amp;\quad + \alpha _n \log \left( { 1 - \frac{(WH)_{nm}}{\alpha _n + (WH)_{nm}} } \right) \Bigg \}, \end{aligned}$$\end{document}</tex-math><mml:math id="M262" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo>;</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">{</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>and recognize the negative of the log-likelihood function as proportional to the following divergence:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} d_N(V||WH)&amp;= \sum _{n=1}^N \left\{ \sum _{m=1}^M V_{nm} \log \left( \frac{V_{nm}}{ (WH)_{nm}}\right) - (\alpha _n + V_{nm}) \log \left( \frac{\alpha _n + V_{nm}}{\alpha _n + (WH)_{nm}} \right) \right\} \end{aligned}$$\end{document}</tex-math><mml:math id="M264" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mfenced close="}" open="{"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mfenced><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>assuming fixed <inline-formula id="IEq136"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _1, \ldots , \alpha _N$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq136.gif"/></alternatives></inline-formula>. This is a divergence measure as <inline-formula id="IEq137"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_N(V||WH) = 0$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq137.gif"/></alternatives></inline-formula> when <inline-formula id="IEq138"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V = WH$$\end{document}</tex-math><mml:math id="M270"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq138.gif"/></alternatives></inline-formula> and <inline-formula id="IEq139"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_N(V||WH)&gt;0$$\end{document}</tex-math><mml:math id="M272"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq139.gif"/></alternatives></inline-formula> for <inline-formula id="IEq140"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V \ne WH$$\end{document}</tex-math><mml:math id="M274"><mml:mrow><mml:mi>V</mml:mi><mml:mo>≠</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq140.gif"/></alternatives></inline-formula>. We can show this by defining <inline-formula id="IEq141"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g(t) = (V_{nm}+t)\log \left( { (V_{nm}+t)}/{((WH)_{nm}+t) }\right)$$\end{document}</tex-math><mml:math id="M276"><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq141.gif"/></alternatives></inline-formula> and realize <inline-formula id="IEq142"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_N(V||WH) = g(0) - g(\alpha ) \ge 0$$\end{document}</tex-math><mml:math id="M278"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq142.gif"/></alternatives></inline-formula> because <inline-formula id="IEq143"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g'(t)\le 0$$\end{document}</tex-math><mml:math id="M280"><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq143.gif"/></alternatives></inline-formula> with equality only when <inline-formula id="IEq144"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V = WH$$\end{document}</tex-math><mml:math id="M282"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq144.gif"/></alternatives></inline-formula>. The term <inline-formula id="IEq145"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log { \left( {\begin{array}{c}\alpha _n + V_{nm} - 1\\ \alpha _n\end{array}}\right) }$$\end{document}</tex-math><mml:math id="M284"><mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq145.gif"/></alternatives></inline-formula> in the likelihood is a constant we can remove and then we have added the constants <inline-formula id="IEq146"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{nm} \log (V_{nm})$$\end{document}</tex-math><mml:math id="M286"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq146.gif"/></alternatives></inline-formula>, <inline-formula id="IEq147"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _{n} \log (\alpha _{n})$$\end{document}</tex-math><mml:math id="M288"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq147.gif"/></alternatives></inline-formula> and <inline-formula id="IEq148"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(V_{nm} + \alpha _n) \log (V_{nm} + \alpha _n)$$\end{document}</tex-math><mml:math id="M290"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq148.gif"/></alternatives></inline-formula>.</p>
      <p id="Par48">Following the steps in [<xref ref-type="bibr" rid="CR18">18</xref>], we will update <italic>W</italic> and <italic>H</italic> one at a time, while the other is assumed fixed. We will show the procedure for updating <italic>H</italic> using a fixed <italic>W</italic> and its current value <inline-formula id="IEq149"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H^t$$\end{document}</tex-math><mml:math id="M292"><mml:msup><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq149.gif"/></alternatives></inline-formula>. First we construct a majorizing function <inline-formula id="IEq150"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G(H, H^t)$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq150.gif"/></alternatives></inline-formula> for <inline-formula id="IEq151"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_N(V||WH)$$\end{document}</tex-math><mml:math id="M296"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq151.gif"/></alternatives></inline-formula> with the constraint that <inline-formula id="IEq152"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G(H, H) = d_N(V||WH)$$\end{document}</tex-math><mml:math id="M298"><mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq152.gif"/></alternatives></inline-formula>. The first term in Eq. (<xref rid="Equ8" ref-type="disp-formula">8</xref>) can be majorized using Jensen’s inequality leading to<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} d_N(V||WH)&amp;= \sum _{n=1}^N \sum _{m=1}^M \Bigg \{ \{ V_{nm} \log \left( \frac{V_{nm}}{\sum _{k=1}^K W_{nk}H_{km}} \right) \nonumber \\&amp;\quad - (\alpha _n + V_{nm}) \log \left( \frac{\alpha _n + V_{nm}}{\alpha _n + \sum _{k=1}^K W_{nk}H_{km}} \right) \Bigg \} \nonumber \\ {}&amp;\le \sum _{n=1}^N \sum _{m=1}^M\Bigg \{ V_{nm} \log V_{nm} - V_{nm} \sum _{k=1}^K \beta _{k} \log \frac{W_{nk}H_{km}}{\beta _{k}} \nonumber \\ {}&amp;\quad + (\alpha _n + V_{nm}) \log \left( \frac{\alpha _n + \sum _{k=1}^K W_{nk}H_{km}}{\alpha _n + V_{nm}} \right) \Bigg \} \end{aligned}$$\end{document}</tex-math><mml:math id="M300" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">{</mml:mo></mml:mrow><mml:mo stretchy="false">{</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>≤</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">{</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq153"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{k} = {W_{nk}H_{km}^t}/{\sum _{k=1}^K W_{nk}H^t_{km}}$$\end{document}</tex-math><mml:math id="M302"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq153.gif"/></alternatives></inline-formula>. The second term can be majorized with the tangent line using the concavity property of the logarithm:<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} d_N(V||WH)&amp;= \sum _{n=1}^N \sum _{m=1}^M \Bigg \{ V_{nm} \log V_{nm} - V_{nm} \sum _{k=1}^K \beta _{k} \log \frac{W_{nk}H_{km}}{\beta _{k}} \nonumber \\ {}&amp;\quad + (\alpha _n + V_{nm}) \log \left( \frac{\alpha _n + \sum _{k=1}^K W_{nk}H_{km}}{\alpha _n + V_{nm}} \right) \Bigg \} \nonumber \\ {}&amp;\le \sum _{n=1}^N \sum _{m=1}^M \Bigg \{ V_{nm} \log V_{nm} - V_{nm} \sum _{k=1}^K \beta _{k} \log \frac{W_{nk}H_{km}}{\beta _{k}} \nonumber \\ {}&amp;\quad + (\alpha _n + V_{nm}) \log \left( \frac{\alpha _n + (WH^t)_{nm}}{\alpha _n + V_{nm}} \right) \nonumber \\ {}&amp;\quad + \frac{W_{nm}}{\alpha _n + (WH^t)_{nm}}(H_{nm} - H^t_{nm}) \Bigg \} = G(H, H^t). \end{aligned}$$\end{document}</tex-math><mml:math id="M304" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">{</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>≤</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">{</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:msup><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:msup><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">}</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>Lastly, we need to show that <inline-formula id="IEq154"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G(H, H) = d_N(V||WH)$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq154.gif"/></alternatives></inline-formula>. This follows from<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} G(H, H)&amp;= \sum _{n=1}^N \sum _{m=1}^M \Bigg \{ V_{nm} \log V_{nm} - V_{nm} \sum _{k=1}^K \beta _{k} \log \frac{W_{nk}H_{km}}{\beta _{k}} \nonumber \\&amp;\quad + (\alpha _n + V_{nm}) \log \left( \frac{\alpha _n + (WH)_{nm}}{\alpha _n + V_{nm}} \right) + \frac{W_{nm}}{\alpha _n + (WH)_{nm}}(H_{nm} - H_{nm}) \Bigg \} \nonumber \\&amp;= \sum _{n=1}^N \sum _{m=1}^M \Bigg \{ V_{nm} \log V_{nm} - V_{nm}\sum _{k=1}^K \frac{W_{nk}H_{km}}{\sum _{k=1}^K W_{nk}H_{km}} \log \frac{W_{nk}H_{km}}{\frac{W_{nk}H_{km}}{\sum _{k=1}^K W_{nk}H_{km}}} \nonumber \\&amp;\quad - (\alpha _n + V_{nm}) \log \left( \frac{\alpha _n + V_{nm}}{\alpha _n + \sum _{k=1}^K W_{nk}H_{km}} \right) \Bigg \} \nonumber \\&amp;= \sum _{n=1}^N \sum _{m=1}^M \Bigg \{ V_{nm} \log V_{nm} - V_{nm} \cdot 1 \cdot \log \left( \sum _{k=1}^K W_{nk}H_{km} \right) \nonumber \\&amp;\quad - (\alpha _n + V_{nm}) \log \left( \frac{\alpha _n + V_{nm}}{\alpha _n + \sum _{k=1}^K W_{nk}H_{km}} \right) \Bigg \} \nonumber \\&amp;= \sum _{n=1}^N \sum _{m=1}^M \Bigg \{ V_{nm} \log \left( \frac{V_{nm}}{\sum _{k=1}^K W_{nk}H_{km}}\right) \nonumber \\&amp;\quad - (\alpha _n + V_{nm}) \log \left( \frac{\alpha _n + V_{nm}}{\alpha _n + \sum _{k=1}^K W_{nk}H_{km}} \right) \Bigg \} \nonumber \\&amp;= d_N(V||WH). \end{aligned}$$\end{document}</tex-math><mml:math id="M308" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">{</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">{</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">{</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mn>1</mml:mn><mml:mo>·</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">{</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>Having defined the majorizing function <inline-formula id="IEq155"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G(H, H^t)$$\end{document}</tex-math><mml:math id="M310"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq155.gif"/></alternatives></inline-formula> in Eq. (<xref rid="Equ10" ref-type="disp-formula">10</xref>), we can derive the following multiplicative update for <italic>H</italic>:<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} H_{km}^{t+1} = H_{km}^t \frac{\sum _{n=1}^N \frac{V_{nm}}{(WH^t)_{nm}} W_{nk}}{\sum _{n=1}^N \frac{V_{nm} + \alpha _n}{(WH^t)_{nm} + \alpha _n} W_{nk}}. \end{aligned}$$\end{document}</tex-math><mml:math id="M312" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:msup><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>W</mml:mi><mml:msup><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula>Similar calculations can be carried out for <italic>W</italic> to obtain the following update:<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} W^{t+1}_{nk} = W^t_{nk} \frac{\sum _{m=1}^M \frac{V_{nm}}{(W^tH)_{nm}} H_{km}}{\sum _{m=1}^M \frac{V_{nm} + \alpha _n}{(W^tH)_{nm} + \alpha _n} H_{km}}. \end{aligned}$$\end{document}</tex-math><mml:math id="M314" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">nk</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">nm</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">km</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula>It is straightforward to see that when <inline-formula id="IEq156"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _n = \alpha$$\end{document}</tex-math><mml:math id="M316"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq156.gif"/></alternatives></inline-formula> for all <inline-formula id="IEq157"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n = 1, \ldots , N$$\end{document}</tex-math><mml:math id="M318"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq157.gif"/></alternatives></inline-formula> then the updates for <italic>W</italic> and <italic>H</italic> equal those in [<xref ref-type="bibr" rid="CR18">18</xref>]. Additionally, as shown in [<xref ref-type="bibr" rid="CR18">18</xref>] when <inline-formula id="IEq158"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \rightarrow \infty$$\end{document}</tex-math><mml:math id="M320"><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq158.gif"/></alternatives></inline-formula> the updates of the Po-NMF [<xref ref-type="bibr" rid="CR14">14</xref>] are recovered.</p>
      <p id="Par49">In our application, we find maximum likelihood estimates (MLEs) of <inline-formula id="IEq159"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _1, \ldots , \alpha _N$$\end{document}</tex-math><mml:math id="M322"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq159.gif"/></alternatives></inline-formula> based on the Negative Binomial likelihood using Newton–Raphson together with the estimate of <italic>WH</italic> from Po-NMF. We opted for this more precise estimation procedure for <inline-formula id="IEq160"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _1, \ldots , \alpha _N$$\end{document}</tex-math><mml:math id="M324"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq160.gif"/></alternatives></inline-formula> instead of the grid search approach used in [<xref ref-type="bibr" rid="CR18">18</xref>]. Final estimates of <italic>W</italic> and <italic>H</italic> are then found by minimizing the divergence in Eq. (<xref rid="Equ8" ref-type="disp-formula">8</xref>) by the iterative majorize-minimization procedure. The <inline-formula id="IEq161"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M326"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq161.gif"/></alternatives></inline-formula>-NMF procedure is described in Algorithm 1 below. The model in [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR20">20</xref>] is similar except <inline-formula id="IEq162"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _1 = \cdots = \alpha _N = \alpha$$\end{document}</tex-math><mml:math id="M328"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq162.gif"/></alternatives></inline-formula>.</p>
      <p id="Par50">It is well known that NMF can result in non-unique solutions [<xref ref-type="bibr" rid="CR38">38</xref>]. Following these findings on the non-uniqueness and the effect of different initializations, all our results are based on five random initializations for each NMF solution.<graphic position="anchor" xlink:href="12859_2023_5304_Figa_HTML" id="MO23"/></p>
    </sec>
    <sec id="Sec12">
      <title>Estimating the number of signatures</title>
      <p id="Par51">Estimating the number of signatures is a difficult problem when using NMF. More generally, estimating the number of components for mixture models or the number of clusters is a well known challenge in applied statistics.</p>
      <p id="Par52">Examples of the complexity of this problem can be found in the <italic>K</italic>-means clustering algorithm and in Gaussian mixture models where the number of clusters K has to be provided for the methods. A detailed description of these challenges can be found in [<xref ref-type="bibr" rid="CR39">39</xref>]. Estimating the number of components is also a critical issue for mixed membership models. Some examples can be found in [<xref ref-type="bibr" rid="CR40">40</xref>, <xref ref-type="bibr" rid="CR41">41</xref>].</p>
      <p id="Par53">Classical procedures to perform model selection are the AIC<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text{AIC} = -2\ln L + 2n_{prm} \end{aligned}$$\end{document}</tex-math><mml:math id="M330" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>AIC</mml:mtext><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo>ln</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">prm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula>and the Bayesian Information Criterion (BIC)<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text{BIC} = -2\ln L + \ln (n_{obs}) n_{prm} \end{aligned}$$\end{document}</tex-math><mml:math id="M332" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>BIC</mml:mtext><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo>ln</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mo>ln</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">prm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5304_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq163"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ln L$$\end{document}</tex-math><mml:math id="M334"><mml:mrow><mml:mo>ln</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq163.gif"/></alternatives></inline-formula> is the estimated log-likelihood value, <inline-formula id="IEq164"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{obs}$$\end{document}</tex-math><mml:math id="M336"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq164.gif"/></alternatives></inline-formula> is the number of observations and <inline-formula id="IEq165"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{prm}$$\end{document}</tex-math><mml:math id="M338"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">prm</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq165.gif"/></alternatives></inline-formula> the number of parameters to be estimated. The two criteria attempt to balance the fit to the data (measured by <inline-formula id="IEq166"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-2\ln L$$\end{document}</tex-math><mml:math id="M340"><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo>ln</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq166.gif"/></alternatives></inline-formula>) and the complexity of the model (measured by the scaled number of free parameters). We have <inline-formula id="IEq167"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{obs} = \text{N}$$\end{document}</tex-math><mml:math id="M342"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>N</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq167.gif"/></alternatives></inline-formula> where N is the number of patients, so <inline-formula id="IEq168"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ln (n_{obs}) &gt; 2$$\end{document}</tex-math><mml:math id="M344"><mml:mrow><mml:mo>ln</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq168.gif"/></alternatives></inline-formula> if <inline-formula id="IEq169"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{N} \ge 8$$\end{document}</tex-math><mml:math id="M346"><mml:mrow><mml:mtext>N</mml:mtext><mml:mo>≥</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq169.gif"/></alternatives></inline-formula>, which means that in our context the number of parameters has a higher influence for BIC compared to AIC because real data sets always have at least tens of patients. Additionally, the structure of the mutational matrix <italic>V</italic> can lead to two different strategies for choosing <inline-formula id="IEq170"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{obs}$$\end{document}</tex-math><mml:math id="M348"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq170.gif"/></alternatives></inline-formula> when BIC is used. Indeed, the number of observations in this context can be set as the total number of counts (i.e.  <inline-formula id="IEq171"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \cdot M$$\end{document}</tex-math><mml:math id="M350"><mml:mrow><mml:mi>N</mml:mi><mml:mo>·</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq171.gif"/></alternatives></inline-formula>) or as the number of patients N, leading to an ambiguity in the definition of this criterion. Verity and Nichols [<xref ref-type="bibr" rid="CR41">41</xref>] also presents results on the performance of AIC and BIC, where the power is especially low for BIC. AIC provides higher stability in the scenario from [<xref ref-type="bibr" rid="CR41">41</xref>], however it does not seem suitable in our situation due to a small penalty term.</p>
      <p id="Par54">A very popular model selection procedure is cross-validation. In Gelman et al. [<xref ref-type="bibr" rid="CR42">42</xref>] they compare various model selection methods including AIC and cross-validation. Here, the authors recommend to use cross-validation as they demonstrate that the other methods fail in some circumstances. In Luo et al. [<xref ref-type="bibr" rid="CR43">43</xref>] they also show that cross-validation has better performance than the other considered methods, including AIC and BIC. Both papers evaluate the predictive fit to compare different methods.</p>
      <sec id="Sec13">
        <title>Model selection for NMF</title>
        <p id="Par55">For NMF we propose an approach for estimating the rank which is highly inspired by cross-validation. As for classical cross-validation we split the patients in <italic>V</italic> in a training and a test set multiple times.</p>
        <p id="Par56">Since all the parameters in the model i.e. <italic>W</italic> and <italic>H</italic> are free parameters it means that the exposures for the patients in the test set are unknown from the estimation of the training set. The patients in the training set give an estimation of the signatures and the exposures of the patients in the training set. One could argue to fix the signatures from the training set and re-estimate exposures for the test set, but we observed that this lead to an overestimation of the test set.</p>
        <p id="Par57">Instead we have chosen to fix the exposures to the ones estimated from the full data. This means our evaluation on the test set is a combination of estimated signatures from the training set and exposures from the full data. The idea is to exploit the fact that the signature matrix should be robust to changes in the patients included in the training set. If the estimated signatures are truly explaining the main patterns in the data, then we expect the signatures obtained from the training set to be similar to the ones from the full data. Therefore the product of the exposures from the full data and the signatures from the training set should give a good approximation of the test set, if the number of signatures is appropriate. We tested this assumption on a real data set with hypermutated patients which may lead to patient specific signatures in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S3 and we find that our method is robust to the removal of the hypermutated patient.</p>
        <p id="Par58">Inputs for the procedure are the data <italic>V</italic>, an NMF method, the number of signatures K, the number of splits into training and test <italic>J</italic> and the <italic>cost</italic> function. We evaluate the model for a range of values of K and then select the model with the lowest cost. The NMF methods we are using here are either Po-NMF from [<xref ref-type="bibr" rid="CR14">14</xref>] or <inline-formula id="IEq172"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox{NB}_\text{N}$$\end{document}</tex-math><mml:math id="M352"><mml:msub><mml:mtext>NB</mml:mtext><mml:mtext>N</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq172.gif"/></alternatives></inline-formula>-NMF in Algorithm 1, but any NMF method could be applied.</p>
        <p id="Par59">A visualization of our model selection algorithm can be found in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. First, we consider the full mutational matrix <italic>V</italic> and we apply the chosen NMF algorithm to obtain an estimate for both <italic>W</italic> and <italic>H</italic>. Afterwards, for each iteration, we sample 90% of the patients randomly to create the training set and determine the remaining 10% as our test set. We then apply the chosen NMF method to the mutational counts of the training set obtaining an estimate <inline-formula id="IEq173"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{train}$$\end{document}</tex-math><mml:math id="M354"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">train</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq173.gif"/></alternatives></inline-formula> and <inline-formula id="IEq174"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{train}$$\end{document}</tex-math><mml:math id="M356"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">train</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq174.gif"/></alternatives></inline-formula>.<fig id="Fig6"><label>Fig. 6</label><caption><p>SigMoS procedure for a given number of signatures K and a count matrix <italic>V</italic>. Pseudocode can be found in Algorithm 2</p></caption><graphic xlink:href="12859_2023_5304_Fig6_HTML" id="MO26"/></fig></p>
        <p id="Par60">Now, as for classical cross-validation, we want to evaluate our model on the test set. To evaluate the model here, we use the full data: indeed, we multiply the exposures relative to the patients in the test set estimated on the full data <inline-formula id="IEq175"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{test}^j$$\end{document}</tex-math><mml:math id="M358"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">test</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq175.gif"/></alternatives></inline-formula> times the corresponding signatures estimated from the training set <inline-formula id="IEq176"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{train}^j$$\end{document}</tex-math><mml:math id="M360"><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">train</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq176.gif"/></alternatives></inline-formula>. As the order of the estimated signatures from the full data can be different to the one in the training set we reorder the exposures in <inline-formula id="IEq177"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{test}^j$$\end{document}</tex-math><mml:math id="M362"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">test</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq177.gif"/></alternatives></inline-formula> with respect to the signatures in <inline-formula id="IEq178"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{train}^j$$\end{document}</tex-math><mml:math id="M364"><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">train</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq178.gif"/></alternatives></inline-formula>. We determine the order by calculating the cosine similarity between the signatures in <inline-formula id="IEq179"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{train}^j$$\end{document}</tex-math><mml:math id="M366"><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi mathvariant="italic">train</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq179.gif"/></alternatives></inline-formula> and those in <italic>H</italic>. We use the prediction of the test data to evaluate the model computing the distance between the true data <inline-formula id="IEq180"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{test}^j$$\end{document}</tex-math><mml:math id="M368"><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">test</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq180.gif"/></alternatives></inline-formula> and their prediction <inline-formula id="IEq181"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{predict}^j$$\end{document}</tex-math><mml:math id="M370"><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">predict</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq181.gif"/></alternatives></inline-formula>with a suitable <italic>cost</italic> function. This procedure is iterated <italic>J</italic> times leading to <italic>J</italic> cost values <inline-formula id="IEq182"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_j$$\end{document}</tex-math><mml:math id="M372"><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq182.gif"/></alternatives></inline-formula>, <inline-formula id="IEq183"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j=1, \ldots , J$$\end{document}</tex-math><mml:math id="M374"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq183.gif"/></alternatives></inline-formula>. The median of these values is calculated for each number of signatures K. We call this procedure SigMoS and summarize it in Algorithm 2. The optimal K is the one with the lowest cost. We use the generalized Kullback–Leibler divergence as a cost function and discuss the choice of cost function in “<xref rid="Sec8" ref-type="sec">Discussion</xref>” section. We compare the influence of the model choice for our procedure to AIC and BIC. We also compare to <inline-formula id="IEq184"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M376"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq184.gif"/></alternatives></inline-formula>, <inline-formula id="IEq185"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SignatureAnalyzer}$$\end{document}</tex-math><mml:math id="M378"><mml:mi mathvariant="monospace">SignatureAnalyzer</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq185.gif"/></alternatives></inline-formula>, <inline-formula id="IEq186"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigneR}$$\end{document}</tex-math><mml:math id="M380"><mml:mi mathvariant="monospace">SigneR</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq186.gif"/></alternatives></inline-formula> and <inline-formula id="IEq187"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SparseSignatures}$$\end{document}</tex-math><mml:math id="M382"><mml:mi mathvariant="monospace">SparseSignatures</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq187.gif"/></alternatives></inline-formula> as these are recently introduced methods in the literature and examine the results from this comparison in “<xref rid="Sec3" ref-type="sec">Simulation study</xref>” section.<graphic position="anchor" xlink:href="12859_2023_5304_Figb_HTML" id="MO27"/></p>
      </sec>
    </sec>
    <sec id="Sec14">
      <title>Code for method comparison</title>
      <p id="Par61">For <inline-formula id="IEq188"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M384"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq188.gif"/></alternatives></inline-formula> we used the <inline-formula id="IEq189"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigProfilerExtractor}$$\end{document}</tex-math><mml:math id="M386"><mml:mi mathvariant="monospace">SigProfilerExtractor</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq189.gif"/></alternatives></inline-formula> Python package with <inline-formula id="IEq190"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {minimum\_signatures}$$\end{document}</tex-math><mml:math id="M388"><mml:mrow><mml:mi mathvariant="monospace">minimum</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">signatures</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq190.gif"/></alternatives></inline-formula> equal to two, <inline-formula id="IEq191"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {maximum\_signatures}$$\end{document}</tex-math><mml:math id="M390"><mml:mrow><mml:mi mathvariant="monospace">maximum</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">signatures</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq191.gif"/></alternatives></inline-formula> equal to eight and <inline-formula id="IEq192"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {opportunity\_genome}$$\end{document}</tex-math><mml:math id="M392"><mml:mrow><mml:mi mathvariant="monospace">opportunity</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">genome</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq192.gif"/></alternatives></inline-formula> equal to “GRCh37”. For <inline-formula id="IEq193"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SparseSignatures}$$\end{document}</tex-math><mml:math id="M394"><mml:mi mathvariant="monospace">SparseSignatures</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq193.gif"/></alternatives></inline-formula> we use the function <inline-formula id="IEq194"><alternatives><tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{nmfLassoCV}$$\end{document}</tex-math><mml:math id="M396"><mml:mi mathvariant="monospace">nmfLassoCV</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq194.gif"/></alternatives></inline-formula> with <inline-formula id="IEq195"><alternatives><tex-math id="M397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {normalize\_counts}$$\end{document}</tex-math><mml:math id="M398"><mml:mrow><mml:mi mathvariant="monospace">normalize</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">counts</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq195.gif"/></alternatives></inline-formula> being set to FALSE and <inline-formula id="IEq196"><alternatives><tex-math id="M399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {lambda\_values\_alpha}$$\end{document}</tex-math><mml:math id="M400"><mml:mrow><mml:mi mathvariant="monospace">lambda</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">values</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">alpha</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq196.gif"/></alternatives></inline-formula> and <inline-formula id="IEq197"><alternatives><tex-math id="M401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {lambda\_values\_beta}$$\end{document}</tex-math><mml:math id="M402"><mml:mrow><mml:mi mathvariant="monospace">lambda</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">values</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">beta</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq197.gif"/></alternatives></inline-formula> to zero. All the other parameters are set to their default values. When applying <inline-formula id="IEq198"><alternatives><tex-math id="M403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SignatureAnalyzer}$$\end{document}</tex-math><mml:math id="M404"><mml:mi mathvariant="monospace">SignatureAnalyzer</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq198.gif"/></alternatives></inline-formula> we used the following command <inline-formula id="IEq199"><alternatives><tex-math id="M405">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{python}$$\end{document}</tex-math><mml:math id="M406"><mml:mi mathvariant="monospace">python</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq199.gif"/></alternatives></inline-formula>
<inline-formula id="IEq200"><alternatives><tex-math id="M407">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {SignatureAnalyzer\text{- }GPU.py \quad \text{- }\text{- }data \quad f \quad \text{- }\text{- }prior\_on\_W \quad L1}$$\end{document}</tex-math><mml:math id="M408"><mml:mrow><mml:mi mathvariant="monospace">SignatureAnalyzer</mml:mi><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">GPU</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="monospace">py</mml:mi><mml:mspace width="1em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">data</mml:mi><mml:mspace width="1em"/><mml:mi mathvariant="monospace">f</mml:mi><mml:mspace width="1em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">prior</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">on</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">W</mml:mi><mml:mspace width="1em"/><mml:mi mathvariant="monospace">L</mml:mi><mml:mn mathvariant="monospace">1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq200.gif"/></alternatives></inline-formula>
<inline-formula id="IEq201"><alternatives><tex-math id="M409">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt {\text{- }\text{- }prior\_on\_H \quad L2 \text{- }\text{- }output\_dir \quad d \quad \text{- }\text{- }max\_iter \quad 1000000 \quad \text{- }\text{- }tolerance \quad 1e-7}$$\end{document}</tex-math><mml:math id="M410"><mml:mrow><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">prior</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">on</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">H</mml:mi><mml:mspace width="1em"/><mml:mi mathvariant="monospace">L</mml:mi><mml:mn mathvariant="monospace">2</mml:mn><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">output</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">dir</mml:mi><mml:mspace width="1em"/><mml:mi mathvariant="monospace">d</mml:mi><mml:mspace width="1em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">max</mml:mi><mml:mi>_</mml:mi><mml:mi mathvariant="monospace">iter</mml:mi><mml:mspace width="1em"/><mml:mn mathvariant="monospace">1000000</mml:mn><mml:mspace width="1em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">tolerance</mml:mi><mml:mspace width="1em"/><mml:mn mathvariant="monospace">1</mml:mn><mml:mi mathvariant="monospace">e</mml:mi><mml:mo>-</mml:mo><mml:mn mathvariant="monospace">7</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq201.gif"/></alternatives></inline-formula>
<inline-formula id="IEq202"><alternatives><tex-math id="M411">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathtt { \text{- }\text{- }K0 \quad 8}$$\end{document}</tex-math><mml:math id="M412"><mml:mrow><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mtext mathvariant="monospace">-</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="monospace">K</mml:mi><mml:mn mathvariant="monospace">0</mml:mn><mml:mspace width="1em"/><mml:mn mathvariant="monospace">8</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq202.gif"/></alternatives></inline-formula>. For <inline-formula id="IEq203"><alternatives><tex-math id="M413">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{SigneR}$$\end{document}</tex-math><mml:math id="M414"><mml:mi mathvariant="monospace">SigneR</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq203.gif"/></alternatives></inline-formula> we used the default options.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec15">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5304_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold>. Supplementary material.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Simon Opstrup Drue and two anonymous reviewers for helpful comments and suggestions on an earlier version of this manuscript.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>MP, RL and AH contributed to the design of the research. MP and RL wrote the code for software, simulations and data analysis and wrote the first version of the manuscript. All authors contributed to writing the manuscript, read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>The research reported in this publication is supported by the Novo Nordisk Foundation. MP acknowledges funding of the Austrian Science Fund (FWF Doctoral Program Vienna Graduate School of Population Genetics”, DK W1225-B20).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The code for our model selection procedure and Negative Binomial NMF and for the simulations is available in the R package SigMoS and can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/MartaPelizzola/SigMoS">https://github.com/MartaPelizzola/SigMoS</ext-link>. The real data used in “<xref rid="Sec6" ref-type="sec">Breast cancer data</xref>” section are available at <ext-link ext-link-type="uri" xlink:href="ftp://ftp.sanger.ac.uk/pub/cancer/AlexandrovEtAl">ftp://ftp.sanger.ac.uk/pub/cancer/AlexandrovEtAl</ext-link> from [<xref ref-type="bibr" rid="CR11">11</xref>]. The real data used in “<xref rid="Sec7" ref-type="sec">Prostate cancer data</xref>” section can be found at <ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/#%21Synapse:syn11726620">https://www.synapse.org/#!Synapse:syn11726620</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par62">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par63">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par64">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Risques</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Kennedy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Aging and the rise of somatic cancer-associated mutations in normal tissues</article-title>
        <source>PLoS Genet</source>
        <year>2018</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>e1007108</fpage>
        <pub-id pub-id-type="doi">10.1371/JOURNAL.PGEN.1007108</pub-id>
        <?supplied-pmid 29300727?>
        <pub-id pub-id-type="pmid">29300727</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shibai</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Takahashi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ishizawa</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Motooka</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Nakamura</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ying</surname>
            <given-names>B-W</given-names>
          </name>
          <name>
            <surname>Tsuru</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Mutation accumulation under UV radiation in Escherichia coli</article-title>
        <source>Sci Rep</source>
        <year>2017</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-017-15008-1</pub-id>
        <pub-id pub-id-type="pmid">28127051</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Ju</surname>
            <given-names>YS</given-names>
          </name>
          <name>
            <surname>Haase</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Van Loo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Martincorena</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Totoki</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Fujimoto</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nakagawa</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shibata</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Vineis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Phillips</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Stratton</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>Mutational signatures associated with tobacco smoking in human cancer</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>354</volume>
        <issue>6312</issue>
        <fpage>618</fpage>
        <lpage>622</lpage>
        <pub-id pub-id-type="doi">10.1126/SCIENCE.AAG0299</pub-id>
        <?supplied-pmid 27811275?>
        <pub-id pub-id-type="pmid">27811275</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Haradhvala</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Tian Ng</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Boot</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Covington</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Gordenin</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Bergstrom</surname>
            <given-names>EN</given-names>
          </name>
          <name>
            <surname>Islam</surname>
            <given-names>SMA</given-names>
          </name>
          <name>
            <surname>Lopez-Bigas</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Klimczak</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Morganella</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sabarinathan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Mustonen</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rozen</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Stratton</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>The repertoire of mutational signatures in human cancer</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>578</volume>
        <issue>7793</issue>
        <fpage>94</fpage>
        <lpage>101</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-1943-3</pub-id>
        <?supplied-pmid 32025018?>
        <pub-id pub-id-type="pmid">32025018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tate</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Bamford</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jubb</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Sondka</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Beare</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Bindal</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Boutselakis</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>CG</given-names>
          </name>
          <name>
            <surname>Creatore</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dawson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Fish</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Harsha</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hathaway</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jupe</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Kok</surname>
            <given-names>CY</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ponting</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ramshaw</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Rye</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Speedy</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Stefancsik</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Forbes</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>COSMIC: the catalogue of somatic mutations in cancer</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>941</fpage>
        <lpage>947</lpage>
        <pub-id pub-id-type="doi">10.1093/NAR/GKY1015</pub-id>
        <pub-id pub-id-type="pmid">30462257</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wedge</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Stratton</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>Deciphering signatures of mutational processes operative in human cancer</article-title>
        <source>Cell Rep</source>
        <year>2013</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>264</fpage>
        <lpage>259</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2012.12.008</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Wedge</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Van Loo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Greenman</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Raine</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stebbings</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Menzies</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Leroy</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ramakrishna</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rance</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lau</surname>
            <given-names>KW</given-names>
          </name>
          <name>
            <surname>Mudie</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Varela</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>McBride</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Bignell</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Cooke</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Shlien</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gamble</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Whitmore</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Maddison</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tarpey</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Davies</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Papaemmanuil</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>McLaren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Teague</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Jönsson</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Garber</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Silver</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Miron</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Fatima</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Boyault</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Langerod</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tutt</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Martens</surname>
            <given-names>JWM</given-names>
          </name>
          <name>
            <surname>Aparicio</surname>
            <given-names>SAJR</given-names>
          </name>
          <name>
            <surname>Borg</surname>
            <given-names>Å</given-names>
          </name>
          <name>
            <surname>Salomon</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Borresen-Dale</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Neuberger</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Futreal</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Stratton</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>Mutational processes molding the genomes of 21 breast cancers</article-title>
        <source>Cell</source>
        <year>2012</year>
        <volume>149</volume>
        <issue>5</issue>
        <fpage>979</fpage>
        <lpage>993</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2012.04.024</pub-id>
        <?supplied-pmid 22608084?>
        <pub-id pub-id-type="pmid">22608084</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sidow</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ramazzotti</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>De novo mutational signature discovery in tumor genomes using SparseSignatures</article-title>
        <source>PLoS Comput Biol</source>
        <year>2021</year>
        <volume>17</volume>
        <issue>6</issue>
        <fpage>1009119</fpage>
        <pub-id pub-id-type="doi">10.1371/JOURNAL.PCBI.1009119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baez-Ortega</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gori</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Computational approaches for discovery of mutational signatures in cancer</article-title>
        <source>Brief Bioinform</source>
        <year>2017</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>77</fpage>
        <lpage>88</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbx082</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Omichessan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Severi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Perduca</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Computational tools to detect signatures of mutational processes in DNA from tumours: a review and empirical comparison of performance</article-title>
        <source>PLoS ONE</source>
        <year>2019</year>
        <volume>14</volume>
        <issue>9</issue>
        <fpage>0221235</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0221235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wedge</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Aparicio</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Behjati</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Biankin</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Bignell</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Bolli</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Borg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Børresen-Dale</surname>
            <given-names>A-L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Signatures of mutational processes in human cancer</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>500</volume>
        <issue>7463</issue>
        <fpage>415</fpage>
        <lpage>421</lpage>
        <pub-id pub-id-type="doi">10.1038/nature12477</pub-id>
        <?supplied-pmid 23945592?>
        <pub-id pub-id-type="pmid">23945592</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fischer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Illingworth</surname>
            <given-names>CJR</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Mustonen</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>EMu: Probabilistic inference of mutational processes and their localization in the cancer genome</article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>4</issue>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-4-r39</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosales</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Drummond</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Valieris</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dias-Neto</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Da Silva</surname>
            <given-names>IT</given-names>
          </name>
        </person-group>
        <article-title>signeR: an empirical Bayesian approach to mutational signature discovery</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>1</issue>
        <fpage>8</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw572</pub-id>
        <?supplied-pmid 27591080?>
        <pub-id pub-id-type="pmid">27591080</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>DD</given-names>
          </name>
          <name>
            <surname>Seung</surname>
            <given-names>HS</given-names>
          </name>
        </person-group>
        <article-title>Learning the parts of objects by non-negative matrix factorization</article-title>
        <source>Nature</source>
        <year>1999</year>
        <volume>401</volume>
        <issue>6755</issue>
        <fpage>788</fpage>
        <lpage>791</lpage>
        <pub-id pub-id-type="doi">10.1038/44565</pub-id>
        <?supplied-pmid 10548103?>
        <pub-id pub-id-type="pmid">10548103</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bliss</surname>
            <given-names>CI</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Fitting the negative binomial distribution to biological data</article-title>
        <source>Biometrics</source>
        <year>1953</year>
        <volume>9</volume>
        <issue>2</issue>
        <fpage>176</fpage>
        <pub-id pub-id-type="doi">10.2307/3001850</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martincorena</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Raine</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gerstung</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dawson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Haase</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Van Loo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Davies</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Stratton</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Universal patterns of selection in cancer and somatic tissues</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <issue>5</issue>
        <fpage>1029</fpage>
        <lpage>104121</lpage>
        <pub-id pub-id-type="doi">10.1016/J.CELL.2017.09.042</pub-id>
        <?supplied-pmid 29056346?>
        <pub-id pub-id-type="pmid">29056346</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McGillivray</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lochovsky</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>NIMBus: a negative binomial regression based integrative method for mutation burden analysis</article-title>
        <source>BMC Bioinform 2020 21:1</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1186/S12859-020-03758-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gouvert</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Oberlin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fevotte</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Negative binomial matrix factorization</article-title>
        <source>IEEE Signal Process Lett</source>
        <year>2020</year>
        <volume>27</volume>
        <fpage>815</fpage>
        <lpage>819</lpage>
        <pub-id pub-id-type="doi">10.1109/LSP.2020.2991613</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Gori K, Baez-Ortega A. sigfit: flexible Bayesian inference of mutational signatures; 2018. 10.1101/372896</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lyu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Garret</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rätsch</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lehmann</surname>
            <given-names>KV</given-names>
          </name>
        </person-group>
        <article-title>Mutational signature learning with supervised negative binomial non-negative matrix factorization</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>Suppl-1</issue>
        <fpage>154</fpage>
        <lpage>160</lpage>
        <pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/BTAA473</pub-id>
        <pub-id pub-id-type="pmid">31250908</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vöhringer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hoeck</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Cuppen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gerstung</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Learning mutational signatures and their multidimensional genomic properties with TensorSignatures</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>3628</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-23551-9</pub-id>
        <?supplied-pmid 34131135?>
        <pub-id pub-id-type="pmid">34131135</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Févotte</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bertin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Durrieu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Nonnegative matrix factorization with the Itakura–Saito divergence: with application to music analysis</article-title>
        <source>Neural Comput</source>
        <year>2009</year>
        <volume>21</volume>
        <issue>3</issue>
        <fpage>793</fpage>
        <lpage>830</lpage>
        <pub-id pub-id-type="doi">10.1162/NECO.2008.04-08-771</pub-id>
        <?supplied-pmid 18785855?>
        <pub-id pub-id-type="pmid">18785855</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Islam</surname>
            <given-names>SMA</given-names>
          </name>
          <name>
            <surname>Díaz-Gay</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Barnes</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vangara</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bergstrom</surname>
            <given-names>EN</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Vella</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Teague</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Clapham</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Moody</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Senkin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>YR</given-names>
          </name>
          <name>
            <surname>Riva</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gruber</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Steele</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Otlu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Khandekar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Abbasi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Humphreys</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Syulyukina</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Brady</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Alexandrov</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Pillay</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Adams</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Martincorena</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Wedge</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Landi</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Brennan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stratton</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Rozen</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
        </person-group>
        <article-title>Uncovering novel mutational signatures by de novo extraction with SigProfilerExtractor</article-title>
        <source>Cell Genomics</source>
        <year>2022</year>
        <volume>2</volume>
        <issue>11</issue>
        <fpage>100179</fpage>
        <pub-id pub-id-type="doi">10.1016/j.xgen.2022.100179</pub-id>
        <?supplied-pmid 36388765?>
        <pub-id pub-id-type="pmid">36388765</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taylor-Weiner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aguet</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Haradhvala</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Gosai</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Anand</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ardlie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>EMV</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Scaling computational genomics to millions of individuals with GPUs</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1836-7</pub-id>
        <pub-id pub-id-type="pmid">30606230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Pan-cancer analysis of whole genomes</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>578</volume>
        <issue>7793</issue>
        <fpage>82</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-1969-6</pub-id>
        <pub-id pub-id-type="pmid">32025007</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cook</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>Exploring partial residual plots</article-title>
        <source>Technometrics</source>
        <year>1993</year>
        <volume>35</volume>
        <issue>4</issue>
        <fpage>351</fpage>
        <lpage>362</lpage>
        <pub-id pub-id-type="doi">10.1080/00401706.1993.10485350</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Miles J. Residual plot. 2014. 10.1002/9781118445112.stat06619.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Degasperi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Amarante</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Martinez-Martinez</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koh</surname>
            <given-names>GCC</given-names>
          </name>
          <name>
            <surname>Dias</surname>
            <given-names>JML</given-names>
          </name>
          <name>
            <surname>Heskin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chmelova</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rinaldi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>VYW</given-names>
          </name>
          <name>
            <surname>Nanda</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Momen</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Perez-Gil</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Memari</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Badja</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shooter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Czarnecki</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Davies</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ambrose</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Arumugam</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bevers</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bleda</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Boardman-Pretty</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Boustred</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Brittain</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Caulfield</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>GC</given-names>
          </name>
          <name>
            <surname>Fowler</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Giess</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hamblin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Henderson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hubbard</surname>
            <given-names>TJP</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Kasperaviciute</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kayikci</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kousathanas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lahnstein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Leigh</surname>
            <given-names>SEA</given-names>
          </name>
          <name>
            <surname>Leong</surname>
            <given-names>IUS</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Maleady-Crowe</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>McEntagart</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Minneci</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Moutsianas</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mueller</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Murugaesu</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Need</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>O’Donovan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Odhams</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Patch</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Perez-Gil</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pereira</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Pullinger</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rahim</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rendon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rogers</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Savage</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sawant</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Siddiq</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sieghart</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Sosinsky</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stuckey</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tanguy</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tavares</surname>
            <given-names>ALT</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>ERA</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Tucci</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Welland</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Witkowska</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wood</surname>
            <given-names>SM</given-names>
          </name>
        </person-group>
        <article-title>Substitution mutational signatures in whole-genome sequenced cancers in the UK population</article-title>
        <source>Science</source>
        <year>2022</year>
        <volume>376</volume>
        <issue>6591</issue>
        <fpage>9283</fpage>
        <pub-id pub-id-type="doi">10.1126/science.abl9283</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Nik-Zainal S, Davies H, Staaf J, Ramakrishna M, Glodzik D, Zou X, Martincorena I, Alexandrov LB, Martin S, Wedge DC, Loo PV, Ju YS, Smid M, Brinkman AB, Morganella S, Aure MR, Lingjærde OC, Langerød A, Ringnér M, Ahn S-M, Boyault S, Brock JE, Broeks A, Butler A, Desmedt C, Dirix L, Dronov S, Fatima A, Foekens JA, Gerstung M, Hooijer GKJ, Jang SJ, Jones DR, Kim H-Y, King TA, Krishnamurthy S, Lee HJ, Lee J-Y, Li Y, McLaren S, Menzies A, Mustonen V, O’Meara S, Pauporté I, Pivot X, Purdie CA, Raine K, Ramakrishnan K, Rodríguez-González FG, Romieu G, Sieuwerts AM, Simpson PT, Shepherd R, Stebbings L, Stefansson OA, Teague J, Tommasi S, Treilleux I, den Eynden GGV, Vermeulen P, Vincent-Salomon A, Yates L, Caldas C, van’t Veer L, Tutt A, Knappskog S, Tan BKT, Jonkers J, Borg Å, Ueno NT, Sotiriou C, Viari A, Futreal PA, Campbell PJ, Span PN, Laere SV, Lakhani SR, Eyfjord JE, Thompson AM, Birney E, Stunnenberg HG, van de Vijver MJ, Martens JWM, Børresen-Dale A-L, Richardson AL, Kong G, Thomas G, Stratton MR. Landscape of somatic mutations in 560 breast cancer whole-genome sequences. Nature 2016;534(7605):47–54. 10.1038/nature17676</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>XR</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Landi</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>SUITOR: selecting the number of mutational signatures through cross-validation</article-title>
        <source>PLoS Comput Biol</source>
        <year>2022</year>
        <volume>18</volume>
        <issue>4</issue>
        <fpage>1009309</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1009309</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pei</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Decoding whole-genome mutational signatures in 37 human pan-cancers by denoising sparse autoencoder neural network</article-title>
        <source>Oncogene</source>
        <year>2020</year>
        <volume>39</volume>
        <issue>27</issue>
        <fpage>5031</fpage>
        <lpage>5041</lpage>
        <pub-id pub-id-type="doi">10.1038/s41388-020-1343-z</pub-id>
        <?supplied-pmid 32528130?>
        <pub-id pub-id-type="pmid">32528130</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Févotte</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Idier</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Algorithms for nonnegative matrix factorization with the <inline-formula id="IEq205"><alternatives><tex-math id="M415">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M416"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5304_Article_IEq205.gif"/></alternatives></inline-formula>-divergence</article-title>
        <source>Neural Comput</source>
        <year>2011</year>
        <volume>23</volume>
        <issue>9</issue>
        <fpage>2421</fpage>
        <lpage>2456</lpage>
        <pub-id pub-id-type="doi">10.1162/NECO_a_00168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Li L, Lebanon G, Park H. Fast Bregman divergence NMF using Taylor expansion and coordinate descent. In: Proceedings of the 18th ACM SIGKDD international conference on knowledge discovery and data mining. 2012.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weinhold</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jacobsen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schultz</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide analysis of noncoding regulatory mutations in cancer</article-title>
        <source>Nat Genet</source>
        <year>2014</year>
        <volume>46</volume>
        <issue>11</issue>
        <fpage>1160</fpage>
        <lpage>1165</lpage>
        <pub-id pub-id-type="doi">10.1038/NG.3101</pub-id>
        <?supplied-pmid 25261935?>
        <pub-id pub-id-type="pmid">25261935</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lochovsky</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Khurana</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>LARVA: an integrative framework for large-scale analysis of recurrent variants in noncoding annotations</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>17</issue>
        <fpage>8123</fpage>
        <lpage>8134</lpage>
        <pub-id pub-id-type="doi">10.1093/NAR/GKV803</pub-id>
        <?supplied-pmid 26304545?>
        <pub-id pub-id-type="pmid">26304545</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Stojanov</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Polak</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kryukov</surname>
            <given-names>GV</given-names>
          </name>
          <name>
            <surname>Cibulskis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sivachenko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Carter</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mermel</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Kiezun</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hammerman</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Drier</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ramos</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Pugh</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Stransky</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Helman</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sougnez</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ambrogio</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Nickerson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Shefler</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Cortés</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Auclair</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Saksena</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Voet</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dicara</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lichtenstein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Heiman</surname>
            <given-names>DI</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Imielinski</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hernandez</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hodis</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Baca</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dulak</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lohr</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Landau</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Melendez-Zajgla</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hidalgo-Miranda</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McCarroll</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Mora</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Crompton</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Onofrio</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Parkin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Winckler</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ardlie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gabriel</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>CWM</given-names>
          </name>
          <name>
            <surname>Biegel</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Stegmaier</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bass</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Garraway</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Meyerson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Gordenin</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Sunyaev</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Mutational heterogeneity in cancer and the search for new cancer-associated genes</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>499</volume>
        <issue>7457</issue>
        <fpage>214</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1038/nature12213</pub-id>
        <?supplied-pmid 23770567?>
        <pub-id pub-id-type="pmid">23770567</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Teerapabolarn</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Negative Binomial approximation to the Beta Binomial distribution</article-title>
        <source>Int J Pure Appl Math</source>
        <year>2015</year>
        <volume>98</volume>
        <issue>1</issue>
        <fpage>39</fpage>
        <lpage>43</lpage>
        <pub-id pub-id-type="doi">10.12732/ijpam.v98i1.5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Laursen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hobolth</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A sampling algorithm to compute the set of feasible solutions for non-negative matrix factorization with an arbitrary rank</article-title>
        <source>SIAM J Matrix Anal Appl</source>
        <year>2022</year>
        <volume>43</volume>
        <issue>1</issue>
        <fpage>257</fpage>
        <lpage>273</lpage>
        <pub-id pub-id-type="doi">10.1137/20M1378971</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gupta</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Datta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Das</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Fast automatic estimation of the number of clusters from the minimum inter-center distance for k-means clustering</article-title>
        <source>Pattern Recogn Lett</source>
        <year>2018</year>
        <volume>116</volume>
        <fpage>72</fpage>
        <lpage>79</lpage>
        <pub-id pub-id-type="doi">10.1016/J.PATREC.2018.09.003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pritchard</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Donnelly</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Inference of population structure using multilocus genotype data</article-title>
        <source>Genetics</source>
        <year>2000</year>
        <volume>155</volume>
        <issue>2</issue>
        <fpage>945</fpage>
        <lpage>959</lpage>
        <pub-id pub-id-type="doi">10.1093/genetics/155.2.945</pub-id>
        <?supplied-pmid 10835412?>
        <pub-id pub-id-type="pmid">10835412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Verity</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nichols</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Estimating the number of subpopulations (K) in structured populations</article-title>
        <source>Genetics</source>
        <year>2016</year>
        <volume>203</volume>
        <issue>4</issue>
        <fpage>1827</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.115.180992</pub-id>
        <?supplied-pmid 27317680?>
        <pub-id pub-id-type="pmid">27317680</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gelman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hwang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vehtari</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Understanding predictive information criteria for Bayesian models</article-title>
        <source>Stat Comput</source>
        <year>2013</year>
        <volume>24</volume>
        <issue>6</issue>
        <fpage>997</fpage>
        <lpage>1016</lpage>
        <pub-id pub-id-type="doi">10.1007/S11222-013-9416-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Al-Harbi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Al-Harbi</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Performances of LOO and WAIC as IRT model selection methods</article-title>
        <source>Psychol Test Assess Model</source>
        <year>2017</year>
        <volume>59</volume>
        <issue>2</issue>
        <fpage>183</fpage>
        <lpage>205</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
