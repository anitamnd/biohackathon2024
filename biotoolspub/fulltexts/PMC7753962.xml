<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_ISCI101913 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEgr6 jpg ?>
<?FILEgr7 jpg ?>
<?FILEgr8 jpg ?>
<?FILEgr9 jpg ?>
<?FILEfx1 jpg ?>
<?FILEmmc1 pdf ?>
<?FILEmmc2 zip ?>
<?FILEmmc3 zip ?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">iScience</journal-id>
    <journal-id journal-id-type="iso-abbrev">iScience</journal-id>
    <journal-title-group>
      <journal-title>iScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2589-0042</issn>
    <publisher>
      <publisher-name>Elsevier</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7753962</article-id>
    <article-id pub-id-type="pii">S2589-0042(20)31110-X</article-id>
    <article-id pub-id-type="doi">10.1016/j.isci.2020.101913</article-id>
    <article-id pub-id-type="publisher-id">101913</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CellO: comprehensive and hierarchical cell type classification of human cells with the Cell Ontology</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au1">
        <name>
          <surname>Bernstein</surname>
          <given-names>Matthew N.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au2">
        <name>
          <surname>Ma</surname>
          <given-names>Zhongjie</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author" id="au3">
        <name>
          <surname>Gleicher</surname>
          <given-names>Michael</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">2</xref>
        <xref rid="fn1" ref-type="fn">4</xref>
      </contrib>
      <contrib contrib-type="author" id="au4">
        <name>
          <surname>Dewey</surname>
          <given-names>Colin N.</given-names>
        </name>
        <email>colin.dewey@wisc.edu</email>
        <xref rid="aff2" ref-type="aff">2</xref>
        <xref rid="aff3" ref-type="aff">3</xref>
        <xref rid="fn1" ref-type="fn">4</xref>
        <xref rid="fn2" ref-type="fn">5</xref>
        <xref rid="cor1" ref-type="corresp">∗</xref>
      </contrib>
      <aff id="aff1"><label>1</label>Morgridge Institute for Research, Madison, WI 53715, USA</aff>
      <aff id="aff2"><label>2</label>Department of Computer Sciences, University of Wisconsin - Madison, Madison, WI 53706, USA</aff>
      <aff id="aff3"><label>3</label>Department of Biostatistics and Medical Informatics, University of Wisconsin - Madison, Madison, WI 53792, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>∗</label>Corresponding author <email>colin.dewey@wisc.edu</email></corresp>
      <fn id="fn1">
        <label>4</label>
        <p id="ntpara0010">Senior author</p>
      </fn>
      <fn id="fn2">
        <label>5</label>
        <p id="ntpara0015">Lead contact</p>
      </fn>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>08</day>
      <month>12</month>
      <year>2020</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <day>22</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>08</day>
      <month>12</month>
      <year>2020</year>
    </pub-date>
    <volume>24</volume>
    <issue>1</issue>
    <elocation-id>101913</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>10</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>2</day>
        <month>12</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 The Authors</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="CC BY-NC-ND" xlink:href="http://creativecommons.org/licenses/by-nc-nd/4.0/">
        <license-p>This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="abs0010">
      <title>Summary</title>
      <p>Cell type annotation is a fundamental task in the analysis of single-cell RNA-sequencing data. In this work, we present CellO, a machine learning-based tool for annotating human RNA-seq data with the Cell Ontology. CellO enables accurate and standardized cell type classification of cell clusters by considering the rich hierarchical structure of known cell types. Furthermore, CellO comes pre-trained on a comprehensive data set of human, healthy, untreated primary samples in the Sequence Read Archive. CellO's comprehensive training set enables it to run out of the box on diverse cell types and achieves competitive or even superior performance when compared to existing state-of-the-art methods. Lastly, CellO's linear models are easily interpreted, thereby enabling exploration of cell-type-specific expression signatures across the ontology. To this end, we also present the CellO Viewer: a web application for exploring CellO's models across the ontology.</p>
    </abstract>
    <abstract abstract-type="graphical" id="abs0015">
      <title>Graphical abstract</title>
      <fig id="undfig1" position="anchor">
        <graphic xlink:href="fx1"/>
      </fig>
    </abstract>
    <abstract abstract-type="author-highlights" id="abs0020">
      <title>Highlights</title>
      <p>
        <list list-type="simple" id="ulist0010">
          <list-item id="u0010">
            <label>•</label>
            <p id="p0010">CellO hierarchically annotates single-cell RNA-seq data using the Cell Ontology</p>
          </list-item>
          <list-item id="u0015">
            <label>•</label>
            <p id="p0015">CellO is pre-trained on a comprehensive data set comprising diverse cell types</p>
          </list-item>
          <list-item id="u0020">
            <label>•</label>
            <p id="p0020">CellO achieves superior or comparable performance with existing methods</p>
          </list-item>
          <list-item id="u0025">
            <label>•</label>
            <p id="p0025">The CellO Viewer is a novel web application for exploring CellO's trained models</p>
          </list-item>
        </list>
      </p>
    </abstract>
    <abstract abstract-type="teaser" id="abs0025">
      <p>Genomics; Classification of Bioinformatical Subject; Genomic Analysis</p>
    </abstract>
    <kwd-group id="kwrds0010">
      <title>Subject areas</title>
      <kwd>Genomics</kwd>
      <kwd>Classification of Bioinformatical Subject</kwd>
      <kwd>Genomic Analysis</kwd>
    </kwd-group>
  </article-meta>
  <notes>
    <p id="misc0010">Published: January 22, 2021</p>
  </notes>
</front>
<body>
  <sec id="sec1">
    <title>Introduction</title>
    <p id="p0030">Cell type annotation is a fundamental task in the analysis of single-cell RNA-sequencing (scRNA-seq) data. Recently, a number of computational tools have been developed for automating the cell type annotation task. Nonetheless, many of these tools suffer from certain disadvantages that inhibit their use. First, many existing methods require the user to provide either a set of marker genes associated with each cell type (<xref rid="bib47" ref-type="bibr">Zhang et al., 2019a</xref>; <xref rid="bib37" ref-type="bibr">Pliner et al. 2019</xref>) or a suitable training data set with cells already annotated with cell type labels (<xref rid="bib26" ref-type="bibr">Ma and Pellegrini 2020</xref>; <xref rid="bib2" ref-type="bibr">Alquicira-Hernandez et al., 2019</xref>; <xref rid="bib43" ref-type="bibr">Tan and Cahan 2019</xref>). Marker gene-based approaches are challenged by the fact that there is not a canonical set of marker genes for most cell types (<xref rid="bib48" ref-type="bibr">Zhang et al., 2019b</xref>). Furthermore, finding an appropriate and labeled training set that contains all of the cell types in the target data set can be challenging, especially considering that existing approaches are sensitive to the chosen training set (<xref rid="bib1" ref-type="bibr">Abdelaal et al., 2019</xref>).</p>
    <p id="p0035">Second, many existing methods use flat classification. Flat classification suffers from the possibility that predictions are logically inconsistent with the hierarchy of cell types. Specifically, for a given query, a flat classifier may output a probability for a cell type that is larger than the classifier's output for its parent cell type in the hierarchy (<xref rid="bib34" ref-type="bibr">Obozinski et al., 2008</xref>). Such incoherent outputs reduce the scientific usefulness of the classifier. We assert that framing the cell type classification task as that of hierarchical classification against the Cell Ontology (<xref rid="bib6" ref-type="bibr">Bard et al. 2005</xref>) poses a number of advantages over flat classification. The Cell Ontology provides a comprehensive hierarchy of animal cell types encoded as a directed acyclic graph (DAG). This DAG provides a rich source of prior knowledge to the cell type classification task that remains un-utilized in flat classification. In addition, if the algorithm is uncertain about which specific cell type the cell may be, the use of a hierarchy allows the algorithm to place a cell internally within the graph rather than at a leaf node. Thus, for cells whose specific cell types are absent from the training set, a classifier that uses a hierarchy is capable of providing more informative output than simply claiming that the cell is “uncertain” as is implemented by some flat classifiers such as ACTINN (<xref rid="bib26" ref-type="bibr">Ma and Pellegrini 2020</xref>).</p>
    <p id="p0040">Finally, those methods that do perform hierarchical classification do not make use of the rich hierarchical relationships between known cell types encoded by the Cell Ontology. For example, CHETAH (<xref rid="bib17" ref-type="bibr">de Kanter et al., 2019</xref>) classifies cells against a hierarchy; however, CHETAH infers this hierarchy from the data rather than utilizing the existing hierarchy encoded by the Cell Ontology. Garnett (<xref rid="bib37" ref-type="bibr">Pliner et al. 2019</xref>) utilizes a hierarchy of cell types; however, these hierarchies must be pre-specified by the user. Furthermore, Garnett requires that each cell within the hierarchy be associated with a set of marker genes. To the best of our knowledge, the only method that utilizes the graph structure of an ontology for the task at hand is URSA (<xref rid="bib20" ref-type="bibr">Lee et al., 2013</xref>), which classifies gene expression profiles against the BRENDA Tissue Ontology (<xref rid="bib13" ref-type="bibr">Gremse et al., 2011</xref>).</p>
    <p id="p0045">In this work, we present Cell Ontology-based Classification (CellO), a tool for annotating cells against the graph-structured Cell Ontology (<xref rid="fig1" ref-type="fig">Figure 1</xref>A). CellO is a discriminative, supervised machine learning approach for classifying clusters of cells in scRNA-seq data. CellO comes pre-trained on a comprehensive data set comprising the majority human primary samples in the Sequence Read Archive (SRA; <xref rid="bib21" ref-type="bibr">Leinonen et al., 2011</xref>) and therefore arrives ready to run on diverse scRNA-seq data sets. CellO offers a complementary approach to marker gene-based methods for scenarios in which the test set contains cell types with poorly characterized marker genes.<fig id="fig1"><label>Figure 1</label><caption><p>Overview of CellO</p><p>(A) A schematic overview of CellO's hierarchical classification approach. CellO performs hierarchical classification with the Cell Ontology. Given a gene expression profile, CellO annotates the cell with a set of cell types (gray nodes) that are consistent with the hierarchical structure of the Cell Ontology.</p><p>(B) We compare CellO to eight recent cell type annotation methods regarding the criteria we surmise are desirable in a cell type classification approach: whether the method (1) arrives pre-trained and can run out of the box, (2) incorporates a hierarchy of cell types, (3) specifically uses the Cell Ontology as its hierarchy, (4) requires cell-type-specific marker genes, (5) uses a model that can be interrogated to better understand how it arrived at its decision, and (6) whether the method operates on clusters or single cells. We compare CellO to scMatch (<xref rid="bib15" ref-type="bibr">Hou et al. 2019</xref>), SingleR (<xref rid="bib4" ref-type="bibr">Aran et al., 2019</xref>), scCatch (<xref rid="bib40" ref-type="bibr">Shao et al., 2020</xref>), CHETAH (<xref rid="bib17" ref-type="bibr">de Kanter et al., 2019</xref>), Garnett (<xref rid="bib37" ref-type="bibr">Pliner et al. 2019</xref>), CellAssign (<xref rid="bib47" ref-type="bibr">Zhang et al., 2019a</xref>), ACTINN (<xref rid="bib26" ref-type="bibr">Ma and Pellegrini 2020</xref>), scPred (<xref rid="bib2" ref-type="bibr">Alquicira-Hernandez et al., 2019</xref>), CaSTLe (<xref rid="bib24" ref-type="bibr">Lieberman et al. 2018</xref>), and SingleCellNet (<xref rid="bib43" ref-type="bibr">Tan and Cahan 2019</xref>). CellO meets more desirable criteria than existing methods.</p><p>(C) Euler diagrams of the cell types within the bulk RNA-seq expression profiles used to train CellO. This training set comprises most primary cell bulk RNA-seq samples within the SRA and consists of diverse cell types spanning various tissues, developmental stages, and stages of differentiation. These diagrams were created with nVenn (<xref rid="bib35" ref-type="bibr">Pérez-Silva et al. 2018</xref>).</p></caption><graphic xlink:href="gr1"/></fig></p>
    <p id="p0050">Lastly, CellO makes extensive use of linear models, which are particularly amenable to interpretation. To enable their interpretation, we present a web-based tool, the CellO Viewer, for exploring the cell type expression signals uncovered by the model (<ext-link ext-link-type="uri" xlink:href="https://uwgraphics.github.io/CellOViewer/" id="intref0010">https://uwgraphics.github.io/CellOViewer/</ext-link>). We benchmarked CellO on a collection of diverse single-cell data sets and found CellO capable of accurately annotating data sets that existing state-of-the-art and ready-to-run (i.e. come pre-trained) annotation methods were unable to accurately annotate, thus highlighting CellO's ability to annotate diverse data sets out of the box. Through its use of the Cell Ontology, its comprehensive training set, and the interpretability of its models, CellO is a practical tool for scRNA-seq cell type annotation (<xref rid="fig1" ref-type="fig">Figure 1</xref>B).</p>
  </sec>
  <sec id="sec2">
    <title>Results</title>
    <sec id="sec2.1">
      <title>A comprehensive curated RNA-seq data set of human primary cells</title>
      <p id="p0055">In order to capture robust cell type signals, we sought a data set of bulk RNA-seq samples comprising only healthy primary cells that originate from cells that have been isolated based on phenotypic characteristics downstream of gene expression itself (such as cell surface proteins). We thus avoid the circularity in using ground truth cell type labels determined by gene expression (via the expression of cell-type-specific marker genes) as are often provided in scRNA-seq data sets. We did not wish to include cells that underwent multiple passages, were diseased, or underwent other treatments, such as <italic>in vitro</italic> differentiation because these conditions alter gene expression. We therefore curated a data set from the SRA consisting of healthy, untreated, primary cells. To do so efficiently, we leveraged the annotations provided by the MetaSRA project (<xref rid="bib8" ref-type="bibr">Bernstein et al. 2017</xref>), which includes sample-specific information including cell type, disease state, and sample type. We then manually curated the samples selected via the MetaSRA by both annotating technical variables and refining cell type annotations (<xref rid="mmc1" ref-type="supplementary-material">Transparent Methods</xref>).</p>
      <p id="p0060">This curation effort resulted in a data set comprising 4,293 bulk RNA-seq samples from 264 studies. These samples were labeled with 310 cell type terms, of which 113 were the most specific cell types in our data set (i.e., no sample in our data was labeled with a descendant cell type term). These cell types were diverse, spanning multiple stages of development and differentiation (<xref rid="fig1" ref-type="fig">Figure 1</xref>C). We uniformly quantified and normalized (via log transcripts per million) gene expression from the raw RNA-seq data for these samples (<xref rid="fig2" ref-type="fig">Figure 2</xref>A, <xref rid="mmc1" ref-type="supplementary-material">Transparent Methods</xref>). To the best of our knowledge, this data set is the largest and most diverse set of bulk RNA-seq samples derived from only primary cells. Prior to this work, the most comprehensive bulk primary cell transcriptomic data set was compiled by (<xref rid="bib3" ref-type="bibr">Aran et al. 2017</xref>), which contains data for 64 cell types from 6 studies. Although our data set consists of only RNA-seq data, this prior data set included samples assayed with several other technologies, such as microarrays. Another comprehensive set of primary cell expression data was collected by <xref rid="bib27" ref-type="bibr">Mabbott et al. (2013)</xref>, which contain primary cell data from 745 samples from 105 studies; however, these data are exclusively from microarrays.<fig id="fig2"><label>Figure 2</label><caption><p>Overview of analyses and CellO's algorithm</p><p>(A) A schematic illustration of the data sets and analyses performed in this study. Initial candidate bulk RNA-seq samples were selected from the SRA via the MetaSRA, filtered for errors, and quantified using the kallisto algorithm (<xref rid="bib9" ref-type="bibr">Bray et al., 2016</xref>), which resulted in a comprehensive bulk RNA-seq training set consisting of healthy, human primary cells. This training set was split into a pre-training and validation set for tuning the parameters of the binary classifiers, as well as for evaluating the graph correction methods (<xref rid="mmc1" ref-type="supplementary-material">Transparent Methods</xref>). The full bulk RNA-seq data set was then used to train the final models that were then evaluated on three sets of scRNA-seq data. The first set consisted of an aggregation of diverse non-droplet-based data sets from the SRA. The second data set consisted of FAC-sorted PBMCs from <xref rid="bib49" ref-type="bibr">Zheng et al. (2017)</xref>. The third set consisted of primary lung tumor cells from <xref rid="bib19" ref-type="bibr">Laughney et al. (2020)</xref>.</p><p>(B) A schematic illustration of CellO's classification procedure. First, for a given sample, the raw classifier probabilities are corrected with the cell ontology using IR (if CLR is used, this step is not necessary). We illustrate one edge of the graph whose incident nodes have probabilities that are logically inconsistent with the hierarchy and thus require correction because the child node has a higher probability than the parent. Once corrected, cell types whose raw probabilities meet their respective decision threshold are selected. Among these, the most specific cell types (i.e., lowest in the ontology) are examined and the cell type with the highest output probability is selected. CellO outputs this final selected cell type along with all ancestor terms.</p></caption><graphic xlink:href="gr2"/></fig></p>
    </sec>
    <sec id="sec2.2">
      <title>Applications of hierarchical classification methods</title>
      <p id="p0065">We frame the cell type classification task as hierarchical classification against the Cell Ontology's DAG. The hierarchical classification task is inherently a multi-label classification task where each input sample (i.e., cell) is mapped to a “set” of output labels (i.e.<italic>,</italic> cell types). Hierarchical classification extends multi-label classification by further requiring that the output labels are “consistent” with the labels' DAG. That is, for each label in a given output set of labels, the label's parent labels are also in the output set (<xref rid="fig1" ref-type="fig">Figure 1</xref>A). Moreover, when training a hierarchical classifier, samples that are annotated with specific labels (<italic>i.e.</italic>, terms that are lower in the DAG) can be aggregated in order to train the classifier to recognize more general, ancestral labels in the DAG.</p>
      <p id="p0070">We implemented two strategies for performing hierarchical classification against the Cell Ontology's DAG that both come packaged with CellO. First, we implemented cascaded logistic regression (CLR; <xref rid="bib34" ref-type="bibr">Obozinski et al., 2008</xref>), which entails classifying a sample in a top-down fashion from the root of the ontology downward via a collection of binary classifiers. Specifically, each binary classifier is associated with a cell type and is trained to classify a sample conditioned on the sample belonging to all of the cell type's parents in the ontology.</p>
      <p id="p0075">Next, we implemented a collection of one-vs-rest binary classifiers for each cell type in the DAG. We will refer to this as the “independent classifiers” approach. This approach suffers from the possibility that the classifiers' outputs will be inconsistent with the hierarchical structure of the ontology. An inconsistency occurs when the output probability for a given cell type exceeds that of one of its parent cell types in the ontology (<xref rid="fig2" ref-type="fig">Figure 2</xref>B). We tested the use of independent logistic regression classifiers and found inconsistencies to be a frequent source of errors. Specifically, we performed leave-study-out cross-validation on the full set of bulk RNA-seq data and examined the consistency of all edges that were adjacent to at least one cell type whose classifier produced a non-negligible probability (&gt;0.01) of the sample originating from that cell type. Of these edges, 12.1% were inconsistent (<xref rid="mmc1" ref-type="supplementary-material">Figure S1</xref>). Nearly all samples (&gt;99%) contained at least one inconsistent edge and 34% of samples contained at least one severely inconsistent edge in which the child classifier's probability exceeded the parent classifier's probability by at least 0.25. We will use the term “correction” to refer to the task of reconciling the outputs of independent classifiers with a hierarchy (<xref rid="fig2" ref-type="fig">Figure 2</xref>B).</p>
      <p id="p0080">To date, the one correction method that has been applied to the task at hand is Bayesian network correction (BNC), which is implemented in the URSA tool (<xref rid="bib20" ref-type="bibr">Lee et al., 2013</xref>). Therefore, as a baseline, we implemented a BNC algorithm following the description in <xref rid="bib20" ref-type="bibr">Lee et al. (2013)</xref> (<xref rid="mmc1" ref-type="supplementary-material">Transparent Methods</xref>). We also tested two correction methods that have yet to be applied to the cell type classification task: isotonic regression correction (IR; <xref rid="bib34" ref-type="bibr">Obozinski et al., 2008</xref>) and a heuristic procedure called the True Path Rule (TPR; <xref rid="bib33" ref-type="bibr">Notaro et al., 2017</xref>). IR uses a projection-based approach for correction that entails finding a set of consistent output cell type probabilities that minimize the sum of squared differences to the raw, and possibly inconsistent, classifier output probabilities. In contrast, TPR uses a heuristic procedure that involves a bottom-up pass through the ontology such that the outputs of children classifiers are averaged with the output of the parent classifier to allow information flow across the ontology graph.</p>
      <p id="p0085">To test these correction methods, we first partitioned the bulk RNA-seq data set into a pre-training and validation set (<xref rid="fig2" ref-type="fig">Figure 2</xref>A; <xref rid="mmc1" ref-type="supplementary-material">Transparent Methods</xref>). Using this validation set, we performed a grid search to find the optimal parameters for training each binary logistic regression classifier, and given the optimal set of parameters, compared how well the aforementioned correction methods either enhanced or degraded accuracy over the samples in the validation set. Overall, we find that IR and TPR output probabilities similar to those output by the independent classifiers in regards to both average precision scores across the cell types in the validation set (<xref rid="fig3" ref-type="fig">Figure 3</xref>A) and precision-recall curves when considering each sample-cell type pair as an independent prediction (<xref rid="fig3" ref-type="fig">Figure 3</xref>B). This indicates that IR and TPR do not degrade performance in comparison to independent classifiers. In contrast, we found that the BNC approach significantly degraded performance (<xref rid="fig3" ref-type="fig">Figures 3</xref>A and 3B). We note that these results are in line with work by <xref rid="bib34" ref-type="bibr">Obozinski et al (2008)</xref>, which demonstrates that IR outperforms BNC on the hierarchical protein function prediction task. Although both IR and TPR yielded similar results, we use IR as our correction method of choice due to its simplicity.<fig id="fig3"><label>Figure 3</label><caption><p>Reconciling the outputs of independent classifiers with a hierarchy</p><p>(A) Average precision scores across all cell types for the independent classifiers (Ind.), as well as for IR, TPR, and BNC on the validation set.</p><p>(B) Each paired sample and cell type prediction was considered independently. The set of all such predictions was ordered according to their prediction probability and the corresponding precision-recall curve was constructed for the independent classifiers, IR, TPR, and BNC.</p></caption><graphic xlink:href="gr3"/></fig></p>
      <p id="p0090">We also used this partition of the bulk RNA-seq samples to tune the parameters of the CLR algorithm (<xref rid="mmc1" ref-type="supplementary-material">Transparent Methods</xref>). We found that after tuning, both IR and CLR achieved similar median F1-scores and median average precisions across cell types on the validation set (<xref rid="mmc1" ref-type="supplementary-material">Figure S13</xref>), and therefore, both are included in the CellO software and evaluated throughout the remainder of this study.</p>
    </sec>
    <sec id="sec2.3">
      <title>Comparison to existing methods</title>
      <p id="p0095">We trained both CLR and IR on the full set of bulk RNA-seq samples in order to test their performance on single-cell data (<xref rid="fig2" ref-type="fig">Figure 2</xref>A). We note that training a single-cell classifier with bulk RNA-seq data may lead to models being poorly calibrated to the sparse single-cell expression profiles. To address this challenge, we first cluster single-cell data using the Leiden community detection algorithm (<xref rid="bib44" ref-type="bibr">Traag et al. 2019</xref>) using the default resolution parameter of 1.0, as implemented in the Scanpy Python package (<xref rid="bib45" ref-type="bibr">Wolf et al. 2018</xref>), and then compute each cluster's mean expression profile. The mean expression profiles are less sparse than those of the individual cells and thus better resemble the bulk RNA-seq data on which the algorithms were trained. CellO first classifies each cluster based on its mean expression profile and then assigns each cell to its cluster's assigned cell types.</p>
      <p id="p0100">We compiled a data set consisting of 7,366 healthy primary cells originating from non-droplet-based RNA-seq assays, such as SMART-Seq2 (<xref rid="bib36" ref-type="bibr">Picelli et al., 2013</xref>) and MARS-seq (<xref rid="bib16" ref-type="bibr">Jaitin et al., 2014</xref>), from the SRA in a manner similar to that used for compiling the bulk RNA-seq training data. This data set originated from 14 studies and were labeled with 125 cell type terms, of which 32 were most specific to the data. Of these cells, 4,936 were of cell types that were included in the bulk RNA-seq training set. This subset of cells originate from 12 studies and were labeled with 71 cell type terms of which 16 were most specific to the data set. We note that for many of the cells used in this analysis, the ground-truth cell types provided by the authors of the data were determined via <italic>in silico</italic> and/or manual approaches (e.g. via heuristic marker gene-based approaches), and thus, this analysis can be understood as an analysis of the “consistency” between the cell types as annotated by the authors and those annotated by the automated methods explored in this work.</p>
      <p id="p0105">We use the subset of 4,936 cells to evaluate IR, CLR, as well as a baseline one-nearest-neighbor (1NN) algorithm that simply returns the cell type labels of the most similar sample in the training set to the query expression profile using Pearson correlation as the similarity metric. We evaluated two aspects of these algorithms' classifications. First, we compute the average precision (a measure of area under the precision-recall curve) on each cell type's output probabilities. Second, for each cell, we evaluate a set of binary yes-no decisions for each cell type that result from thresholding the raw output probabilities and enforcing each cell to be annotated with only one most specific cell type (<xref rid="fig2" ref-type="fig">Figure 2</xref>B; <xref rid="mmc1" ref-type="supplementary-material">Transparent Methods</xref>). We evaluate these binary decisions using precision, recall, and F1-score (harmonic mean of precision and recall). We modified the evaluation metrics to take into account samples that were labeled with a general cell type but not a specific cell type (e.g. T cell versus CD8+ T cell; <xref rid="mmc1" ref-type="supplementary-material">Transparent Methods</xref>).</p>
      <p id="p0110">We found that IR and CLR outperformed 1NN according to F1-score, precision, and average precision (<xref rid="fig4" ref-type="fig">Figures 4</xref>A, 4B, and 4C). Specifically, IR, CLR, and 1NN produced median F1-scores of 0.81, 0.85, and 0.63, respectively, across all cell types. The cell types on which classification performance was poor were generally more specific and clustered within the hierarchy (<xref rid="fig4" ref-type="fig">Figure 4</xref>D). We note that CellO's average precision scores across cell types tend to be higher than its F1-scores (<xref rid="fig4" ref-type="fig">Figure 4</xref>D). This discrepancy indicates that CellO is doing well at discriminating among these cell types; however, the decision thresholds used by CellO to output hard classifications for some cell types may be non-optimal. We hypothesize that this is due to some classifiers being poorly calibrated, especially for cell types lower in the ontology. This may be due to there being fewer “studies” in the training set generating these cell types, and thus, for a given cell type, CellO's binary classifiers may be more prone to fitting the batch effects present in these fewer studies (<xref rid="mmc1" ref-type="supplementary-material">Figure S16</xref>).<fig id="fig4"><label>Figure 4</label><caption><p>Results on non-droplet-based single-cell data</p><p>CellO's performance on the 4,936 non-droplet-based cells considering only cells whose cell types are present in the bulk RNA-seq training set. We compare the distributions of (A) F1-score, (B) precision, and (C) average precision across all such cell types. (D) The subgraph spanning the non-droplet-based cells where each cell type is colored according to CellO's (IR) F1-score (top) as well as by average precision (bottom).</p></caption><graphic xlink:href="gr4"/></fig></p>
      <p id="p0115">We also compared CellO to two existing methods, scMatch (<xref rid="bib15" ref-type="bibr">Hou et al. 2019</xref>) and SingleR (<xref rid="bib4" ref-type="bibr">Aran et al., 2019</xref>). scMatch and SingleR are most comparable to CellO because they come packaged with comprehensive reference data sets of human cells. Like CellO, these methods are designed to run out of the box on diverse single-cell data sets. scMatch comes packaged with a reference data set comprising data from the FANTOM5 project (<xref rid="bib25" ref-type="bibr">Lizio et al., 2017</xref>). SingleR comes packaged with two comprehensive human reference data sets: a data set comprising data from the Blueprint (<xref rid="bib11" ref-type="bibr">Fernández et al., 2016</xref>) and ENCODE (<xref rid="bib41" ref-type="bibr">Sloan et al., 2016</xref>) projects and a reference set from the Human Primary Cell Atlas (<xref rid="bib27" ref-type="bibr">Mabbott et al., 2013</xref>). We also built a reference set for SingleR from CellO's training set in order to isolate methodological differences between SingleR and CellO. Unfortunately, scMatch does not support the creation of a custom reference set, and therefore, we were unable to perform this experiment with scMatch. To enable a comparison between scMatch, SingleR, and CellO, we project the outputs of scMatch and SingleR onto the Cell Ontology in order to evaluate scMatch and SingleR within the hierarchical classification framework. Specifically, for a given cell annotated by one of these methods with some cell type <italic>C</italic>, we also annotate the cell with all ancestors of <italic>C</italic> according to the Cell Ontology.</p>
      <p id="p0120">First, we note that CellO's training sets included over 50% more of the cell types in this test set compared to those of scMatch and SingleR. In fact, most cell types in this test set, such as pancreatic islet cell types, are absent from scMatch and SingleR's reference sets, thus indicating that a user would be required to supply their own reference set for annotating these cell types (<xref rid="fig5" ref-type="fig">Figure 5</xref>A). We thus evaluated each method on only cell types that exist in each respective method's prepackaged reference set and found that CellO outperformed existing approaches (<xref rid="fig5" ref-type="fig">Figure 5</xref>B). SingleR performed poorly with CellO's training set, which may be due to the high number of samples in CellO's training set, the high number genes (i.e. including non-coding genes), and the fact that CellO contains bulk RNA-seq samples at a higher level in the ontology (<xref rid="mmc1" ref-type="supplementary-material">Figure S4</xref>A). We note that, in this analysis, for a given method, we may remove from the analysis a specific cell type that is absent from a given method's training set (e.g. stomach epithelial cell), but we would keep an ancestral cell type term (e.g. epithelial cell) if the method's training set contains a sample labeled with this ancestral term (e.g. a sample labeled as intestinal epithelial cell).<fig id="fig5"><label>Figure 5</label><caption><p>Comparison of CellO to existing approaches on non-droplet-based single-cell data</p><p>Evaluating CellO, SingleR, and scMatch on the non-droplet-based cells.</p><p>(A) The fraction of cell types in the single-cell test data set that are also present in each method's training set. IR and CLR are not shown separately because they share the same training set. We evaluate SingleR's built in reference sets from the Human Primary Cell Atlas (HPCA) and BluePrint + ENCODE (BE).</p><p>(B) The distribution of both F1-scores (left) and precisions (right) for only those cell types that are in each method's training set. We compare CellO to scMatch, SingleR with the Human Primary Cell Atlas (HPCA), and SingleR with the Blueprint + ENCODE reference (BE). Note each distribution evaluates different sets of cell types depending on the particular subset of cell types present in each method's training set.</p></caption><graphic xlink:href="gr5"/></fig></p>
      <p id="p0125">Next, we evaluated CellO on fluorescence-activated cell sorted (FAC-sorted) f peripheral blood mononuclear cells (PBMC's) from <xref rid="bib49" ref-type="bibr">Zheng et al. (2017)</xref> that were sequenced with Chromium 10x. We selected this data set because it is one of the few droplet-based data sets for which the cell type labels are determined phenotypically (via sorting) rather than computationally (via expression analysis). To reflect the size of typical single-cell data sets, we subsampled 2,000 cells from each of the ten sorted cell types and aggregated these cells together creating a data set consisting of 20,000 cells. We first compared IR and CLR to the 1NN baseline and again found that IR and CLR outperformed 1NN with respect to median F1-score, although the difference between IR/CLR and 1NN was smaller than in the comparison than on the aforementioned non-droplet-based scRNA-seq data set (<xref rid="fig6" ref-type="fig">Figure 6</xref>D). Specifically, IR, CLR, and 1NN produced median F1-scores of 0.97, 0.96, and 0.95, respectively, across all cell types.<fig id="fig6"><label>Figure 6</label><caption><p>Results on 10x PBMC data</p><p>(A and B) (A) The subgraph of the Cell Ontology spanning the 10x PBMC data set from <xref rid="bib49" ref-type="bibr">Zheng et al. (2017)</xref>. Each cell type is colored according to CellO's (IR) F1-score, as well as (B) average precision.</p><p>(C) UMAP plots of the single-cell data set where cells are colored by their true cell type (top), as well as the most specific predicted cell type (i.e. lowest in the ontology) as output by CellO (bottom).</p><p>(D) Boxplots displaying the distribution of F1-scores across all cell types for IR, CLR, 1NN, scMatch, SingleR with the Human Primary Cell Atlas (HPCA), SingleR with the Blueprint + ENCODE reference (BE), and SingleR with the Monaco et al. reference (M).</p></caption><graphic xlink:href="gr6"/></fig></p>
      <p id="p0130">Next, we compared CellO to scMatch and SingleR on this PBMC data set. In this analysis, we also ran SingleR using an immune-specific reference set of purified immune cells from <xref rid="bib30" ref-type="bibr">Monaco et al. (2019)</xref>. The cell types in this data set are better represented in scMatch and SingleR's respective reference sets, and thus, a comparison between CellO and these methods on this data better isolates performance differences between these methods. Like scMatch and SingleR, CellO struggled to accurately classify the T cell subtypes (<xref rid="fig6" ref-type="fig">Figures 6</xref>A–6C, <xref rid="mmc1" ref-type="supplementary-material">S2</xref>C, <xref rid="mmc1" ref-type="supplementary-material">S3</xref>, and <xref rid="mmc1" ref-type="supplementary-material">S4</xref>B). Among the methods compared here, SingleR with the Monaco et al. reference set most accurately classified the T cell subtypes (<xref rid="mmc1" ref-type="supplementary-material">Figure S3</xref>), though we note that this reference set is specialized for immune cell types, whereas the other reference sets, including CellO's, are more broad. We also note that CellO produced high average precision scores on most cell types including many of these T cell subtypes. Again, this indicates that CellO's classifiers have learned to discriminate between these cell types; however, the threshold for calling these cell types may be non-optimal.</p>
    </sec>
    <sec id="sec2.4">
      <title>Inspection of performance on challenging and diseased samples</title>
      <p id="p0135">We examined CellO's classifications on three challenging data sets. Two of these data sets comprised subsets of the 7,366 cells from non-droplet-based assays and are challenging because they contained cells for which their combination of cell types was absent from CellO's training set. First, we examined CellO's accuracy on 1,978 healthy pancreatic islet cells from <xref rid="bib39" ref-type="bibr">Segerstolpe et al. (2016)</xref>, which includes cell types that are absent from the bulk RNA-seq training set, specifically ductal cells, acinar cells, epsilon cells, and delta cells. We found that CellO was able to correctly annotate the acinar cells as glandular epithelial cells, which is an ancestral cell type to acinar cells in the Cell Ontology (<xref rid="fig7" ref-type="fig">Figures 7</xref>A and <xref rid="mmc1" ref-type="supplementary-material">S2</xref>A). This highlights the advantage of classifying against a hierarchy in that it enables CellO to annotate cells with a term higher in the ontology DAG when it is unsure about a cell's more specific cell type. We also note that a number of cells were uncharacterized in the original study due to not meeting a stringent quality control filter. CellO annotated many of these cells as pancreatic A cells (a.k.a. pancreatic alpha cells), which is plausible owing to both their close position to annotated A cells according to UMAP, which is known to preserve some level of global structure in high dimensional data (<xref rid="bib7" ref-type="bibr">Becht et al., 2018</xref>), as well as the fact that A cells were found to be the most abundant endocrine cell type in <xref rid="bib39" ref-type="bibr">Segerstolpe et al. (2016)</xref> of those that passed their stringent quality control filtering.<fig id="fig7"><label>Figure 7</label><caption><p>Examination of CellO's performance on difficult data sets</p><p>(A) UMAP plots of all healthy cells in <xref rid="bib39" ref-type="bibr">Segerstolpe et al. (2016)</xref> including cells for which their specific cell types are not present in CellO's bulk RNA-seq training set. Cells are colored according to their true cell type (left) and (IR) predicted cell type (right). Highlighted are CellO's predictions made on pancreatic acinar cells (top right ovals), as well as a subset of uncharacterized pancreatic epithelial cells predicted as A cells (center ovals).</p><p>(B) UMAP plots of human, embryonic neural cells from <xref rid="bib28" ref-type="bibr">La Manno et al. (2016)</xref>. Cells are colored according to their true cell type (left) and predicted cell type (right). Highlighted are CellO's predictions made on both the microglial and glial cells and note that CellO annotates these cells using terms that are higher in the ontology's graph than their true terms.</p></caption><graphic xlink:href="gr7"/></fig></p>
      <p id="p0140">We also further examined CellO's classification on 1,977 fetal neural cells from <xref rid="bib28" ref-type="bibr">La Manno et al. (2016)</xref>. Although the bulk RNA-seq training data contain samples of both embryonic cells and cells of various neural cell types, they do not contain any sample labeled as both neural cell and embryonic cell. Despite this discrepancy, CellO was able to annotate these cells with reasonable cell type labels (<xref rid="fig7" ref-type="fig">Figures 7</xref>B and <xref rid="mmc1" ref-type="supplementary-material">S2</xref>B). We note that the microglial cells were annotated as phagocytes, which are an ancestral term to microglial cells in the Cell Ontology. Similarly, CellO annotated the glial cells as neuron associated cells. These examples again highlight CellO's ability to annotate cells with a term higher in the ontology DAG when it is unsure about a cell's more specific cell type.</p>
      <p id="p0145">Finally, we examined CellO's classification on eight lung adenocarcinoma tumor samples from <xref rid="bib19" ref-type="bibr">Laughney et al. (2020)</xref> that were sequenced with 10x. This data set provides a good, yet challenging test set for CellO due to (a) the heterogeneity of constituent cell types, (b) the fact that it contains cell types absent from CellO's training set, and (c) these cells originate from diseased tissue, thereby providing insight into how CellO will perform on non-healthy samples. We compared CellO's output to the annotations provided by the authors, which were the result of a custom, <italic>in silico</italic> cell type annotation pipeline.</p>
      <p id="p0150">Overall, we found a high correspondence between the labels provided by CellO and the authors' annotation pipeline (<xref rid="fig8" ref-type="fig">Figures 8</xref>; <xref rid="mmc1" ref-type="supplementary-material">Figures S5</xref>–S12). When the two methods differed, we attempted to determine which method is likely to be correct using manual inspection of known marker genes and in many of these discrepancies, CellO produced the correct cell type labels. For example, in tumor LX675 and LX682, CellO correctly annotates putative endothelial cells (<xref rid="fig8" ref-type="fig">Figures 8</xref>; <xref rid="mmc1" ref-type="supplementary-material">Figure S5</xref>), based on expression of PECAM1 (<xref rid="fig8" ref-type="fig">Figure 8</xref>C) and CD34 (data not shown), whereas the authors of these data labeled these as epithelial cells. In tumor LX675, CellO labeled the myeloid dendritic cell population as CD1c+ myeloid dendritic cells, a more specific cell type than that provided by the authors (<xref rid="fig8" ref-type="fig">Figure 8</xref>). In tumor LX682, CellO correctly annotates the putative fibroblasts as evidenced by their expression of FAP (<xref rid="bib38" ref-type="bibr">Puré and Blomberg 2018</xref>) (<xref rid="mmc1" ref-type="supplementary-material">Figure S5</xref>) and S100A4 (<xref rid="bib42" ref-type="bibr">Strutz et al., 1995</xref>; data not shown). In tumor LX679, CellO appears to correctly annotate the plasmacytoid dendritic cell population as evidenced by the expression of IL3RA (<xref rid="mmc1" ref-type="supplementary-material">Figure S6</xref>), a known marker for this cell type (<xref rid="bib10" ref-type="bibr">Collin et al. 2013</xref>). We also note that for cells whose likely true cell types are absent from CellO's training set, CellO was able to label these cells using a correct but more general cell type. For example, in tumor LX675, mast cells were absent from CellO's training set, yet CellO accurately labeled these cells as hematopoietic cells (<xref rid="fig8" ref-type="fig">Figure 8</xref>). Similarly, when CellO was unsure of the labels for cells of cell types for which training data were sparse, such as for plasma cells and pericytes, CellO labeled these cells as more general cell type terms lymphocyte of B lineage and connective tissue cell, respectively (<xref rid="fig8" ref-type="fig">Figure 8</xref>). Lastly, we note some of the most clear-cut cases in which the authors' pipeline produced correct labels but CellO erred. For example, in tumor LX679, CellO labeled many of the epithelial cell types as prostate epithelial cells (<xref rid="mmc1" ref-type="supplementary-material">Figure S6</xref>), which is clearly incorrect given that these are lung tumor samples. Other errors produced by CellO are due to rarer cell types within the sample clustering together with a more common, similar cell type. For example, in tumor LX682, the myeloid dendritic cells are labeled by CellO as macrophages due to these cells clustering together with the macrophage population (<xref rid="mmc1" ref-type="supplementary-material">Figure S5</xref>).<fig id="fig8"><label>Figure 8</label><caption><p>Examination of CellO on diseased cells</p><p>(A) UMAP plots of lung adenocarcinoma tumor LX675 from <xref rid="bib19" ref-type="bibr">Laughney et al. (2020)</xref> colored by CellO's output using IR and a Leiden resolution parameter of 1.0 (left) and the original cell type labels provided by the authors. We highlight four subpopulations comprising putative CD1C + myeloid dendritic cells (top left), endothelial cells (top right), plasma cells (bottom left), and mast cells (bottom right).</p><p>(B) The legend for coloring cells in (A).</p><p>(C) UMAP plots of cells colored by their expression, in units log(TPM+1), of CD1C, a marker for CDC1+ myeloid dendritic cells, PECAM1, a marker for endothelial cells, SDC1, a marker for plasma cells, and KIT, a marker for mast cells.</p></caption><graphic xlink:href="gr8"/></fig></p>
    </sec>
    <sec id="sec2.5">
      <title>Evaluation of robustness to clustering</title>
      <p id="p0155">In order to test CellO's robustness to cluster granularity when clustering single-cell data, we tested CellO on the Zheng et al. PBMC data set and Laughney et al. lung cancer data set using differing values for Leiden's resolution parameter. On the Zheng et al. data set, we tested CellO with five values for the resolution parameter and found both CLR and IR to perform similarly across these settings (<xref rid="mmc1" ref-type="supplementary-material">Figure S15</xref>). In contrast to the Zheng et al. data set, the lack of robust ground-truth labels for the Laughney et al. data set made it difficult to perform a similar assessment. Instead, on this data set, we ran CellO using the default resolution of 1.0, as well as a higher resolution of 8.0, and then manually inspected the differences in the outputs produced by these two settings (<xref rid="mmc1" ref-type="supplementary-material">Figures S5–S12</xref>). Overall, we found that the higher resolution led CellO to classify clusters with more granularity but at the cost of some errors. For example, on tumor LX679 and LX682, CellO was able to correctly classify the putative myeloid dendritic cells at the resolution of 8.0, whereas at the default resolution of 1.0, these cells were labeled incorrectly as alveolar macrophages (<xref rid="mmc1" ref-type="supplementary-material">Figures S5</xref> and <xref rid="mmc1" ref-type="supplementary-material">S6</xref>). This is likely due to the fact that the dendritic cells were subsumed into the macrophage cluster at the lower resolution. However, in other instances, the higher resolution led to errors. These errors are likely due to the fact that at a more granular clustering resolution, each cluster's mean expression value remained sparse due to the averaging of fewer cells. For example, in tumor LX679, cells correctly labeled as respiratory epithelial cells at a resolution of 1.0 were incorrectly labeled as prostate epithelial cells at a resolution of 8.0 (<xref rid="mmc1" ref-type="supplementary-material">Figure S6</xref>).</p>
    </sec>
    <sec id="sec2.6">
      <title>User-friendly software</title>
      <p id="p0160">We provide a Python package for running CellO, using either IR or CLR, on a user-provided gene expression matrix (<ext-link ext-link-type="uri" xlink:href="https://github.com/deweylab/CellO" id="intref0015">https://github.com/deweylab/CellO</ext-link>). CellO reduces the burden of reformatting and preprocessing an input expression matrix by accepting a variety of input file formats, including comma or tab-separated text files and HDF5, and by accepting expression data in a variety of units including counts or transcripts per million (TPM). To address the scenario in which the input data set's genes do not match those expected by the pre-trained classifiers, we provide functionality for a user to re-train the models on the bulk RNA-seq training set with a custom gene set. On a personal laptop, training a new classifier took 31 minutes to train IR and 11 minutes to train CLR on the full set of 58,243 GENCODE genes. Training time is reduced when trained on a smaller set of genes (e.g., only protein-coding genes). We also note that the time required for CellO to perform classification is low because of the fact that it uses pre-trained logistic regression classifiers operating on cluster-averaged expression profiles. On the <xref rid="bib49" ref-type="bibr">Zheng et al. (2017)</xref> data set, CellO took six minutes to run on a personal laptop (including time for clustering), whereas scMatch required six hours and nine minutes (run with five cores), and SingleR required between nine and 22 minutes depending on the reference set used. Finally, we note that the relative performance of IR and CLR varies across cell types. To guide a user on their selection of either IR or CLR, we provide the average precision values achieved by both methods on each cell type in the bulk RNA-seq validation set (<xref rid="mmc2" ref-type="supplementary-material">Table S1</xref>, Bulk RNA-seq Validation Set Metrics). We also provide average precision values and F1-scores achieved by both methods on each cell type on the test set of 4,936 non-droplet-based single cells whose cell types were present in the bulk RNA-seq training set (<xref rid="mmc3" ref-type="supplementary-material">Table S2</xref>, Single-cell RNA-seq Test Set Metrics).</p>
      <p id="p0165">Lastly, we note that due to CellO's comprehensive training set, which comprises cell types from many organs and tissues, some of CellO's errors are due to CellO annotating cells using a cell type that is unique to a tissue type that differs from the known tissue type of the target sample. For example, in some lung cancer tumors from Laughney et al., endothelial cells were classified as “endothelial cell of the umbilical vein” (<xref rid="mmc1" ref-type="supplementary-material">Figures S5</xref>, <xref rid="mmc1" ref-type="supplementary-material">S6</xref>, and <xref rid="mmc1" ref-type="supplementary-material">S9</xref>), which is clearly incorrect given that these samples were taken from the lung. This error is likely due to the fact that the endothelial cells in CellO's training set largely originate from umbilical cord samples. Because these errors can be easily caught by the user, the CellO package enables a user to fix such errors by enabling the user to supply a blacklist of tissue types that do not pertain to the target sample. CellO then uses edges between the Cell Ontology and the Uberon ontology (which encodes anatomical entities; <xref rid="bib31" ref-type="bibr">Mungall et al., 2012</xref>) to filter out cell types from CellO's output that are uniquely located in the blacklisted tissue types. For example, by blacklisting the Uberon term “umbilical vein”, CellO correctly classifies the endothelial cells from Laughney et al.</p>
    </sec>
    <sec id="sec2.7">
      <title>Interpretability of models</title>
      <p id="p0170">CellO makes extensive use of linear models, which are particularly amenable to interpretation especially when the coefficients are sparse (<xref rid="bib12" ref-type="bibr">Gleicher 2013</xref>). Although CellO's models are not regularized to be sparse (as in <xref rid="bib12" ref-type="bibr">Gleicher 2013</xref>), we sparsify them by selecting the top ten genes per cell type according to the magnitude of the coefficients associated with each gene within each cell type's one-vs-rest binary classification model, which is used for CellO's IR classifier. To enable their interpretation, we present a web-based tool, the CellO Viewer, for exploring these discriminative genes uncovered by the models (<ext-link ext-link-type="uri" xlink:href="https://uwgraphics.github.io/CellOViewer/" id="intref0020">https://uwgraphics.github.io/CellOViewer/</ext-link>). The tool supports two modes of operation: a “cell-centric” mode (<xref rid="fig9" ref-type="fig">Figure 9</xref>A) and a “gene-centric” mode (<xref rid="fig9" ref-type="fig">Figure 9</xref>B). In the cell-centric mode, the user can select cell types via a graphical display of the Cell Ontology in order to view and compare the most important genes for distinguishing those cell types. In the gene-centric view, the user can select genes and explore which cell types these genes are most important for distinguishing from the remaining cell types. The CellO Viewer uses an interactive display of the Cell Ontology's graph to enable the user to navigate between cell types across the ontology.<fig id="fig9"><label>Figure 9</label><caption><p>The CellO Viewer</p><p>Screenshots of the CellO Viewer web application for enabling the exploration of cell-type-specific expression signatures across the Cell Ontology.</p><p>(A) Comparing the top ten genes between CD4+ T cells and CD8+ T cells (red nodes in the Graph View) ranked by the magnitude of their coefficients in their corresponding models. Genes that are shared between the two lists are highlighted with the same color. The CellO Viewer displays genes whose expressions are both positively correlated (green) and negatively correlated (red) with the selected cell types.</p><p>(B) A screenshot of the gene-centric mode of the CellO Viewer with GFAP, an astrocyte marker, selected. For a given selected gene, the CellO Viewer will display the cell types within the DAG (top) and in list form (bottom) for which the selected gene appears within the top ten genes ranked by each model's coefficients.</p></caption><graphic xlink:href="gr9"/></fig></p>
      <p id="p0175">We found that across diverse cell types, many known cell-type-specific marker genes were recovered by the CellO models and are presented by the CellO Viewer. For example, CD3D, CD3E, and CD3G, which are canonical markers for T cells, were all present within the top ten genes ranked according to the magnitude of their coefficients within the binary logistic regression model used for distinguishing T cells from all other cell types. Similarly, CD4 and CD8 were present in the top genes for the CD4+ T cell and CD8+ T cell models, respectively (<xref rid="fig9" ref-type="fig">Figure 9</xref>). In a more complex example, the genes GCG, LOXL4, DPP4, GC, and FAP, known markers for pancreatic alpha cells, and INS, IAPP, and ADCYAP1, known markers for pancreatic beta cells <xref rid="bib39" ref-type="bibr">Segerstolpe et al. (2016)</xref>, all appear within the top ten genes for their respective cell types.</p>
      <p id="p0180">Interestingly, certain genes appear in the top ten coefficients for broad cell types but not more specific cell types, indicating that CellO is able to find signals specific to broad cell type categories. For example, DDX4 appeared in the top ten genes for distinguishing germ line cells but did not appear within the top ten genes for any of the more specific germ cell subtypes. DDX4 is known to be expressed in germ cells across both sexes (<xref rid="bib14" ref-type="bibr">Hickford et al., 2011</xref>). Similarly, the gene NRG1 appeared in the top ten genes for distinguishing precursor cells but did not appear within the top ten genes for any of the more specific cell types that are descendents of precursor cells within the ontology. NRG1 is known to play a role in the development of a number of organ systems (<xref rid="bib22" ref-type="bibr">Lemmens et al. 2007</xref>; <xref rid="bib29" ref-type="bibr">Mei and Xiong 2008</xref>).</p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Discussion</title>
    <p id="p0185">In this work, we explore the application of hierarchical classification algorithms to cell type classification with the Cell Ontology using a well-curated set of human primary cell RNA-seq samples. This data set may prove useful for future investigations of cell type expression patterns or for use in cell type deconvolution methods (<xref rid="bib4" ref-type="bibr">Aran et al., 2019</xref>; <xref rid="bib32" ref-type="bibr">Newman et al., 2015</xref>). We demonstrate that the trained classifiers perform well across cell types in diverse single-cell data sets and outperformed existing cell type annotation methods when trained on their comprehensive reference sets. We packaged these classifiers into an easy-to-run Python package called CellO.</p>
    <p id="p0190">In our exploration of methods for correcting the independent one-vs-rest classifiers, we found that discriminative methods outperformed the generative BNC approach implemented in URSA (<xref rid="bib20" ref-type="bibr">Lee et al., 2013</xref>). We hypothesize that BNC suffers in comparison due to two causes. First, BNC's probabilistic model makes strong assumptions regarding the generative process of classifier scores and true cell type assignments. Second, BNC requires estimating the conditional probability distribution of each classifier's output scores (i.e., distance from the decision boundary) conditioned on the true cell type labels, which may be difficult to estimate accurately given the limited quantity of training data available for each cell type.</p>
    <p id="p0195">By using linear models, CellO's trained parameters are easily interpreted as cell-type-specific signatures across the ontology. However, we note that since certain cell types undergo similar sorting and preparation procedures (e.g., fluorescence-activated cell sorting), it remains unclear to what extent these procedures affect gene expression and thus confound cell type. We sought to mitigate this effect by using data from a diversity of studies. We also note that the CLR algorithm may help to further mitigate this effect since the binary classifiers trained in this framework for each cell type condition on the sample belonging to the parent cell types. Thus, for a given cell type, if samples of its parent cell types were prepared through similar procedures, the learned model parameters for that cell type will better capture biological cell type signatures.</p>
    <sec id="sec3.1">
      <title>Limitations of the study</title>
      <p id="p0200">There are a number of avenues that require further investigation. First, future work will entail curating comprehensive training sets from the SRA for other species such as mouse. This work will rely partly on future inclusion of standardized mouse metadata in the MetaSRA.</p>
      <p id="p0205">Second, CellO is a cluster-based annotation method, and thus, its accuracy relies, in part, on the robustness of the clustering algorithm. If the clustering is too coarse, rare cell types may be missed. If clustering is too fine, the algorithm may not be combining enough data to accurately annotate each cluster. Determining the optimal clustering in scRNA-seq data is a challenging, open problem that will require further investigation (<xref rid="bib18" ref-type="bibr">Kiselev et al. 2019</xref>). Nonetheless, we demonstrated that CellO accurately classified a number of diverse data sets using Leiden's default parameter in the Scanpy package.</p>
      <p id="p0210">Third, we note that calibrating discriminative models trained on bulk RNA-seq data and applying them to single-cell data is challenging. In this work, we developed techniques for closing the gap between the performance of CellO when evaluated with average precision versus when evaluated with F1-score. The very high average precision scores across many cell types indicate that CellO is learning an accurate representation of these cell types and that with better calibration, CellO's accuracy when making binary yes-no decisions for each cell type could be improved. Future work will investigate alternative approaches to calibrating CellO's models in order to improve CellO's binary cell type decisions.</p>
      <p id="p0215">Fourth, the Cell Ontology encodes anatomical and functional relationships between cell types; however, there exist a number of other relationships between cell types that could be utilized to improve accuracy. Such examples include lineage-based relationships (i.e., one cell type derives from another cell type; <xref rid="bib46" ref-type="bibr">Yuan et al., 2020</xref>) or evolutionary relationships between extant cell types and ancient cell types (<xref rid="bib5" ref-type="bibr">Arendt et al., 2016</xref>; <xref rid="bib23" ref-type="bibr">Liang et al., 2018</xref>). For example, the evolutionary relationships between cell types may be utilized to address inconsistencies in the independent classifiers approach that arise when certain cell types share a parent cell type via the currently encoded “is a” relationship but are purported to have divergent evolutionary origins.</p>
      <p id="p0220">Fifth and finally, we expect the performance of hierarchical classifiers to improve as both more data are collected and as the Cell Ontology is expanded. Most importantly, we expect the calibration of the classifiers to improve as more training data become available for each cell type. More training data will be collected both as data are continually added to the SRA and as improvements are made to the SRA's metadata, thereby allowing retrieval of previously undiscovered primary cell samples.</p>
    </sec>
    <sec id="sec3.2">
      <title>Resource availability</title>
      <sec id="sec3.2.1">
        <title>Lead contact</title>
        <p id="p0225">Further information and requests for resources should be directed to and will be fulfilled by the Lead Contact, Colin Dewey (<ext-link ext-link-type="uri" xlink:href="mailto:colin.dewey@wisc.edu" id="intref0025">colin.dewey@wisc.edu</ext-link>).</p>
      </sec>
      <sec sec-type="data-availability" id="sec3.2.2">
        <title>Data and code availability</title>
        <p id="p0230">A Python package for running CellO can be found on GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/deweylab/CellO" id="intref0030">https://github.com/deweylab/CellO</ext-link>. The data used in this work can be found on <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.4289064" id="intref0035">https://doi.org/10.5281/zenodo.4289064</ext-link>. The CellO Viewer can be accessed at <ext-link ext-link-type="uri" xlink:href="https://uwgraphics.github.io/CellOViewer/" id="intref0040">https://uwgraphics.github.io/CellOViewer/</ext-link>. The code implementing the CellO Viewer can be found on GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/uwgraphics/CellOViewer" id="intref0045">https://github.com/uwgraphics/CellOViewer</ext-link>. All code for performing the experiments in this work can be found on GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/deweylab/cell-type-classification-paper" id="intref0050">https://github.com/deweylab/cell-type-classification-paper</ext-link>.</p>
      </sec>
      <sec id="sec3.2.3">
        <title>Materials availability</title>
        <p id="p0235">This study did not generate new unique reagents.</p>
      </sec>
    </sec>
  </sec>
  <sec id="sec4">
    <title>Methods</title>
    <p id="p0240">All methods can be found in the accompanying <xref rid="mmc1" ref-type="supplementary-material">Transparent methods supplemental file</xref>.</p>
  </sec>
</body>
<back>
  <ref-list id="cebib0010">
    <title>References</title>
    <ref id="bib1">
      <element-citation publication-type="journal" id="sref1">
        <person-group person-group-type="author">
          <name>
            <surname>Abdelaal</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Michielsen</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Cats</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Hoogduin</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Mei</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Marcel</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Reinders</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Ahmed</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>
        <source>Genome Biol.</source>
        <volume>20</volume>
        <year>2019</year>
        <fpage>194</fpage>
        <pub-id pub-id-type="pmid">31500660</pub-id>
      </element-citation>
    </ref>
    <ref id="bib2">
      <element-citation publication-type="journal" id="sref2">
        <person-group person-group-type="author">
          <name>
            <surname>Alquicira-Hernandez</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Anuja</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>H.P.</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Joseph</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Powell</surname>
          </name>
        </person-group>
        <article-title>scPred: accurate supervised method for cell-type classification from single-cell RNA-seq data</article-title>
        <source>Genome Biol.</source>
        <volume>20</volume>
        <year>2019</year>
        <fpage>264</fpage>
        <pub-id pub-id-type="pmid">31829268</pub-id>
      </element-citation>
    </ref>
    <ref id="bib3">
      <element-citation publication-type="journal" id="sref3">
        <person-group person-group-type="author">
          <name>
            <surname>Aran</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Butte</surname>
            <given-names>A.J.</given-names>
          </name>
        </person-group>
        <article-title>xCell: digitally portraying the tissue cellular heterogeneity landscape</article-title>
        <source>Genome Biol.</source>
        <volume>18</volume>
        <year>2017</year>
        <fpage>220</fpage>
        <pub-id pub-id-type="pmid">29141660</pub-id>
      </element-citation>
    </ref>
    <ref id="bib4">
      <element-citation publication-type="journal" id="sref4">
        <person-group person-group-type="author">
          <name>
            <surname>Aran</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Looney</surname>
            <given-names>A.P.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Fong</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Hsu</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Chak</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Naikawadi</surname>
            <given-names>R.P.</given-names>
          </name>
          <name>
            <surname>Wolters</surname>
            <given-names>P.J.</given-names>
          </name>
          <name>
            <surname>Abate</surname>
            <given-names>A.R.</given-names>
          </name>
        </person-group>
        <article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>
        <source>Nat. Immunol.</source>
        <volume>20</volume>
        <year>2019</year>
        <fpage>163</fpage>
        <lpage>172</lpage>
        <pub-id pub-id-type="pmid">30643263</pub-id>
      </element-citation>
    </ref>
    <ref id="bib5">
      <element-citation publication-type="journal" id="sref5">
        <person-group person-group-type="author">
          <name>
            <surname>Arendt</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Musser</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>C.V.H.</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Cepko</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Erwin</surname>
            <given-names>D.H.</given-names>
          </name>
          <name>
            <surname>Pavlicev</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Schlosser</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Widder</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Laubichler</surname>
            <given-names>M.D.</given-names>
          </name>
        </person-group>
        <article-title>The origin and evolution of cell types</article-title>
        <source>Nat. Rev. Genet.</source>
        <volume>17</volume>
        <year>2016</year>
        <fpage>744</fpage>
        <lpage>757</lpage>
        <pub-id pub-id-type="pmid">27818507</pub-id>
      </element-citation>
    </ref>
    <ref id="bib6">
      <element-citation publication-type="journal" id="sref6">
        <person-group person-group-type="author">
          <name>
            <surname>Bard</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Rhee</surname>
            <given-names>S.Y.</given-names>
          </name>
          <name>
            <surname>Ashburner</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>An ontology for cell types</article-title>
        <source>Genome Biol.</source>
        <year>2005</year>
        <pub-id pub-id-type="doi">10.1186/gb-2005-6-2-r21</pub-id>
      </element-citation>
    </ref>
    <ref id="bib7">
      <element-citation publication-type="journal" id="sref7">
        <person-group person-group-type="author">
          <name>
            <surname>Becht</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>McInnes</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Healy</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Charles-Antoine</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Kwok</surname>
            <given-names>I.W.H.</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>L.G.</given-names>
          </name>
          <name>
            <surname>Ginhoux</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Newell</surname>
            <given-names>E.W.</given-names>
          </name>
        </person-group>
        <article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <pub-id pub-id-type="doi">10.1038/nbt.4314</pub-id>
      </element-citation>
    </ref>
    <ref id="bib8">
      <element-citation publication-type="journal" id="sref8">
        <person-group person-group-type="author">
          <name>
            <surname>Bernstein</surname>
            <given-names>M.N.</given-names>
          </name>
          <name>
            <surname>Doan</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Dewey</surname>
            <given-names>C.N.</given-names>
          </name>
        </person-group>
        <article-title>MetaSRA: normalized human sample-specific metadata for the sequence Read archive</article-title>
        <source>Bioinformatics</source>
        <volume>33</volume>
        <year>2017</year>
        <fpage>2914</fpage>
        <lpage>2923</lpage>
        <pub-id pub-id-type="pmid">28535296</pub-id>
      </element-citation>
    </ref>
    <ref id="bib9">
      <element-citation publication-type="journal" id="sref9">
        <person-group person-group-type="author">
          <name>
            <surname>Bray</surname>
            <given-names>N.L.</given-names>
          </name>
          <name>
            <surname>Pimentel</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Melsted</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Near-optimal probabilistic RNA-seq quantification</article-title>
        <source>Nat. Biotechnol.</source>
        <volume>34</volume>
        <year>2016</year>
        <fpage>525</fpage>
        <lpage>527</lpage>
        <pub-id pub-id-type="pmid">27043002</pub-id>
      </element-citation>
    </ref>
    <ref id="bib10">
      <element-citation publication-type="journal" id="sref10">
        <person-group person-group-type="author">
          <name>
            <surname>Collin</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>McGovern</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Haniffa</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Human dendritic cell subsets</article-title>
        <source>Immunology</source>
        <volume>140</volume>
        <year>2013</year>
        <fpage>22</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="pmid">23621371</pub-id>
      </element-citation>
    </ref>
    <ref id="bib11">
      <element-citation publication-type="journal" id="sref11">
        <person-group person-group-type="author">
          <name>
            <surname>Fernández</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>de la Torre</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Royo</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Puiggròs</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Moncunill</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Fragkogianni</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>L.</given-names>
          </name>
          <collab>BLUEPRINT Consortium</collab>
          <name>
            <surname>Flicek</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>The blueprint data analysis portal</article-title>
        <source>Cell Syst.</source>
        <volume>3</volume>
        <year>2016</year>
        <fpage>491</fpage>
        <lpage>495.e5</lpage>
        <pub-id pub-id-type="pmid">27863955</pub-id>
      </element-citation>
    </ref>
    <ref id="bib12">
      <element-citation publication-type="journal" id="sref12">
        <person-group person-group-type="author">
          <name>
            <surname>Gleicher</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Explainers: expert explorations with crafted projections</article-title>
        <source>IEEE Trans. Vis. Comput. Graph.</source>
        <volume>19</volume>
        <year>2013</year>
        <fpage>2042</fpage>
        <lpage>2051</lpage>
        <pub-id pub-id-type="pmid">24051770</pub-id>
      </element-citation>
    </ref>
    <ref id="bib13">
      <element-citation publication-type="journal" id="sref13">
        <person-group person-group-type="author">
          <name>
            <surname>Gremse</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ida</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Grote</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Scheer</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Ebeling</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Schomburg</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>The BRENDA tissue ontology (BTO): the first all-integrating ontology of all organisms for enzyme sources</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>39</volume>
        <year>2011</year>
        <fpage>D507</fpage>
        <lpage>D513</lpage>
        <pub-id pub-id-type="pmid">21030441</pub-id>
      </element-citation>
    </ref>
    <ref id="bib14">
      <element-citation publication-type="journal" id="sref14">
        <person-group person-group-type="author">
          <name>
            <surname>Hickford</surname>
            <given-names>D.E.</given-names>
          </name>
          <name>
            <surname>Stephen</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Pask</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Renfree</surname>
            <given-names>M.B.</given-names>
          </name>
        </person-group>
        <article-title>DDX4 (VASA) is conserved in germ cell development in marsupials and monotremes</article-title>
        <source>Biol. Reprod.</source>
        <volume>85</volume>
        <year>2011</year>
        <fpage>733</fpage>
        <lpage>743</lpage>
        <pub-id pub-id-type="pmid">21653890</pub-id>
      </element-citation>
    </ref>
    <ref id="bib15">
      <element-citation publication-type="journal" id="sref15">
        <person-group person-group-type="author">
          <name>
            <surname>Hou</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Elena</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Alistair</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Forrest</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>scMatch: a single-cell gene expression profile Annotation tool using reference datasets</article-title>
        <source>Bioinformatics</source>
        <volume>35</volume>
        <year>2019</year>
        <fpage>4688</fpage>
        <lpage>4695</lpage>
        <pub-id pub-id-type="pmid">31028376</pub-id>
      </element-citation>
    </ref>
    <ref id="bib16">
      <element-citation publication-type="journal" id="sref16">
        <person-group person-group-type="author">
          <name>
            <surname>Jaitin</surname>
            <given-names>D.A.</given-names>
          </name>
          <name>
            <surname>Kenigsberg</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Keren-Shaul</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Elefant</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Zaretsky</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Alexander</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Massively parallel single-cell RNA-seq for marker-free decomposition of tissues into cell types</article-title>
        <source>Science</source>
        <volume>343</volume>
        <year>2014</year>
        <fpage>776</fpage>
        <lpage>779</lpage>
        <pub-id pub-id-type="pmid">24531970</pub-id>
      </element-citation>
    </ref>
    <ref id="bib17">
      <element-citation publication-type="journal" id="sref17">
        <person-group person-group-type="author">
          <name>
            <surname>de Kanter</surname>
            <given-names>J.K.</given-names>
          </name>
          <name>
            <surname>Lijnzaad</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Candelli</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Margaritis</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Frank</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Holstege</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>CHETAH: a selective, hierarchical cell type identification method for single-cell rna sequencing</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>47</volume>
        <year>2019</year>
        <fpage>e95</fpage>
        <pub-id pub-id-type="pmid">31226206</pub-id>
      </element-citation>
    </ref>
    <ref id="bib18">
      <element-citation publication-type="journal" id="sref18">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>V.Y.</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>T.S.</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>Challenges in unsupervised clustering of single-cell RNA-seq data</article-title>
        <source>Nat. Rev.</source>
        <volume>20</volume>
        <year>2019</year>
        <fpage>273</fpage>
        <lpage>282</lpage>
      </element-citation>
    </ref>
    <ref id="bib19">
      <element-citation publication-type="journal" id="sref19">
        <person-group person-group-type="author">
          <name>
            <surname>Laughney</surname>
            <given-names>A.M.</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Nathaniel</surname>
            <given-names>R.C.</given-names>
          </name>
          <name>
            <surname>Bakhoum</surname>
            <given-names>S.F.</given-names>
          </name>
          <name>
            <surname>Setty</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Lavallée</surname>
            <given-names>V.P.</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Masilionis</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Carr</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Kottapalli</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Regenerative lineages and immune-mediated pruning in lung cancer metastasis</article-title>
        <source>Nat. Med.</source>
        <volume>26</volume>
        <year>2020</year>
        <fpage>259</fpage>
        <lpage>269</lpage>
        <pub-id pub-id-type="pmid">32042191</pub-id>
      </element-citation>
    </ref>
    <ref id="bib20">
      <element-citation publication-type="journal" id="sref20">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>Y.S.</given-names>
          </name>
          <name>
            <surname>Krishnan</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Olga</surname>
            <given-names>G.T.</given-names>
          </name>
        </person-group>
        <article-title>Ontology-aware classification of tissue and cell-type signals in gene expression profiles across platforms and technologies</article-title>
        <source>Bioinformatics</source>
        <volume>29</volume>
        <year>2013</year>
        <fpage>3036</fpage>
        <lpage>3044</lpage>
        <pub-id pub-id-type="pmid">24037214</pub-id>
      </element-citation>
    </ref>
    <ref id="bib21">
      <element-citation publication-type="journal" id="sref21">
        <person-group person-group-type="author">
          <name>
            <surname>Leinonen</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Sugawara</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>International Nucleotide Sequence Database Collaboration</surname>
          </name>
        </person-group>
        <article-title>The sequence Read archive</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>39</volume>
        <year>2011</year>
        <fpage>D19</fpage>
        <lpage>D21</lpage>
        <pub-id pub-id-type="pmid">21062823</pub-id>
      </element-citation>
    </ref>
    <ref id="bib22">
      <element-citation publication-type="journal" id="sref22">
        <person-group person-group-type="author">
          <name>
            <surname>Lemmens</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Doggen</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>de Keulenaer</surname>
            <given-names>G.W.</given-names>
          </name>
        </person-group>
        <article-title>Role of neuregulin-1/ErbB signaling in cardiovascular physiology and disease: implications for therapy of heart failure</article-title>
        <source>Circulation</source>
        <volume>116</volume>
        <year>2007</year>
        <fpage>954</fpage>
        <lpage>960</lpage>
        <pub-id pub-id-type="pmid">17709650</pub-id>
      </element-citation>
    </ref>
    <ref id="bib23">
      <element-citation publication-type="journal" id="sref23">
        <person-group person-group-type="author">
          <name>
            <surname>Liang</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Musser</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Cloutier</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Prum</surname>
            <given-names>R.O.</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>G.P.</given-names>
          </name>
        </person-group>
        <article-title>Pervasive correlated evolution in gene expression shapes cell and tissue type transcriptomes</article-title>
        <source>Genome Biol. Evol.</source>
        <volume>10</volume>
        <year>2018</year>
        <fpage>538</fpage>
        <lpage>552</lpage>
        <pub-id pub-id-type="pmid">29373668</pub-id>
      </element-citation>
    </ref>
    <ref id="bib24">
      <element-citation publication-type="journal" id="sref24">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Rokach</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Shay</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>CaSTLe - classification of single cells by transfer learning: harnessing the power of publicly available single cell RNA sequencing experiments to annotate new experiments</article-title>
        <source>PLoS One</source>
        <volume>13</volume>
        <year>2018</year>
        <fpage>e0205499</fpage>
        <pub-id pub-id-type="pmid">30304022</pub-id>
      </element-citation>
    </ref>
    <ref id="bib25">
      <element-citation publication-type="journal" id="sref25">
        <person-group person-group-type="author">
          <name>
            <surname>Lizio</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Harshbarger</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Abugessaisa</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Noguchi</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Kondo</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Severin</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Mungall</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Arenillas</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Mathelier</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Medvedeva</surname>
            <given-names>Y.A.</given-names>
          </name>
        </person-group>
        <article-title>Update of the FANTOM web resource: high resolution transcriptome of diverse cell types in mammals</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>45</volume>
        <year>2017</year>
        <fpage>D737</fpage>
        <lpage>D743</lpage>
        <pub-id pub-id-type="pmid">27794045</pub-id>
      </element-citation>
    </ref>
    <ref id="bib26">
      <element-citation publication-type="journal" id="sref26">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Pellegrini</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>ACTINN: automated identification of cell types in single cell RNA sequencing</article-title>
        <source>Bioinformatics</source>
        <volume>36</volume>
        <year>2020</year>
        <fpage>533</fpage>
        <lpage>538</lpage>
        <pub-id pub-id-type="pmid">31359028</pub-id>
      </element-citation>
    </ref>
    <ref id="bib27">
      <element-citation publication-type="journal" id="sref27">
        <person-group person-group-type="author">
          <name>
            <surname>Mabbott</surname>
            <given-names>N.A.</given-names>
          </name>
          <name>
            <surname>Kenneth Baillie</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Freeman</surname>
            <given-names>T.C.</given-names>
          </name>
          <name>
            <surname>Hume</surname>
            <given-names>D.A.</given-names>
          </name>
        </person-group>
        <article-title>An expression Atlas of human primary cells: inference of gene function from coexpression networks</article-title>
        <source>BMC Genomics</source>
        <volume>14</volume>
        <year>2013</year>
        <fpage>632</fpage>
        <pub-id pub-id-type="pmid">24053356</pub-id>
      </element-citation>
    </ref>
    <ref id="bib28">
      <element-citation publication-type="journal" id="sref28">
        <person-group person-group-type="author">
          <name>
            <surname>La Manno</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Gyllborg</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Codeluppi</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Nishimura</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Salto</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Amit</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Borm</surname>
            <given-names>L.E.</given-names>
          </name>
          <name>
            <surname>Stott</surname>
            <given-names>S.R.W.</given-names>
          </name>
          <name>
            <surname>Toledo</surname>
            <given-names>E.M.</given-names>
          </name>
          <name>
            <surname>Villaescusa</surname>
            <given-names>J.C.</given-names>
          </name>
        </person-group>
        <article-title>Molecular diversity of midbrain development in mouse, human, and stem cells</article-title>
        <source>Cell</source>
        <volume>167</volume>
        <year>2016</year>
        <fpage>566</fpage>
        <lpage>580.e19</lpage>
        <pub-id pub-id-type="pmid">27716510</pub-id>
      </element-citation>
    </ref>
    <ref id="bib29">
      <element-citation publication-type="journal" id="sref29">
        <person-group person-group-type="author">
          <name>
            <surname>Mei</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Xiong</surname>
            <given-names>W.C.</given-names>
          </name>
        </person-group>
        <article-title>Neuregulin 1 in neural development, synaptic plasticity and schizophrenia</article-title>
        <source>Nat. Rev. Neurosci.</source>
        <volume>9</volume>
        <year>2008</year>
        <fpage>437</fpage>
        <lpage>452</lpage>
        <pub-id pub-id-type="pmid">18478032</pub-id>
      </element-citation>
    </ref>
    <ref id="bib30">
      <element-citation publication-type="journal" id="sref30">
        <person-group person-group-type="author">
          <name>
            <surname>Monaco</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Mustafah</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Hwang</surname>
            <given-names>Y.Y.</given-names>
          </name>
          <name>
            <surname>Carré</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Burdin</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Visan</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Ceccarelli</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Poidinger</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>RNA-seq signatures normalized by mRNA abundance allow absolute deconvolution of human immune cell types</article-title>
        <source>Cell Rep.</source>
        <volume>26</volume>
        <year>2019</year>
        <fpage>1627</fpage>
        <lpage>1640.e7</lpage>
        <pub-id pub-id-type="pmid">30726743</pub-id>
      </element-citation>
    </ref>
    <ref id="bib31">
      <element-citation publication-type="journal" id="sref31">
        <person-group person-group-type="author">
          <name>
            <surname>Mungall</surname>
            <given-names>C.J.</given-names>
          </name>
          <name>
            <surname>Torniai</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Gkoutos</surname>
            <given-names>G.V.</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>S.E.</given-names>
          </name>
          <name>
            <surname>Haendel</surname>
            <given-names>M.A.</given-names>
          </name>
        </person-group>
        <article-title>Uberon, an integrative multi-species anatomy ontology</article-title>
        <source>Genome Biol.</source>
        <volume>13</volume>
        <year>2012</year>
        <fpage>R5</fpage>
        <pub-id pub-id-type="pmid">22293552</pub-id>
      </element-citation>
    </ref>
    <ref id="bib32">
      <element-citation publication-type="journal" id="sref32">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>A.M.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C.L.</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>M.R.</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Chuong</surname>
            <given-names>D.H.</given-names>
          </name>
          <name>
            <surname>Maximilian</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Alizadeh</surname>
            <given-names>A.A.</given-names>
          </name>
        </person-group>
        <article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>
        <source>Nat. Methods</source>
        <volume>12</volume>
        <year>2015</year>
        <fpage>453</fpage>
        <lpage>457</lpage>
        <pub-id pub-id-type="pmid">25822800</pub-id>
      </element-citation>
    </ref>
    <ref id="bib33">
      <element-citation publication-type="journal" id="sref33">
        <person-group person-group-type="author">
          <name>
            <surname>Notaro</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Schubach</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>P.N.</given-names>
          </name>
          <name>
            <surname>Valentini</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Prediction of human phenotype ontology terms by means of hierarchical ensemble methods</article-title>
        <source>BMC Bioinformatics</source>
        <volume>18</volume>
        <year>2017</year>
        <fpage>449</fpage>
        <pub-id pub-id-type="pmid">29025394</pub-id>
      </element-citation>
    </ref>
    <ref id="bib34">
      <element-citation publication-type="journal" id="sref34">
        <person-group person-group-type="author">
          <name>
            <surname>Obozinski</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Lanckriet</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Grant</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>M.I.</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>W.S.</given-names>
          </name>
        </person-group>
        <article-title>Consistent probabilistic outputs for protein function prediction</article-title>
        <source>Genome Biol.</source>
        <volume>9</volume>
        <year>2008</year>
        <fpage>S6</fpage>
      </element-citation>
    </ref>
    <ref id="bib35">
      <element-citation publication-type="journal" id="sref35">
        <person-group person-group-type="author">
          <name>
            <surname>Pérez-Silva</surname>
            <given-names>J.G.</given-names>
          </name>
          <name>
            <surname>Araujo-Voces</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Quesada</surname>
            <given-names>V.</given-names>
          </name>
        </person-group>
        <article-title>nVenn: generalized, quasi-proportional venn and euler diagrams</article-title>
        <source>Bioinformatics</source>
        <volume>34</volume>
        <year>2018</year>
        <fpage>2322</fpage>
        <lpage>2324</lpage>
        <pub-id pub-id-type="pmid">29949954</pub-id>
      </element-citation>
    </ref>
    <ref id="bib36">
      <element-citation publication-type="journal" id="sref36">
        <person-group person-group-type="author">
          <name>
            <surname>Picelli</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Björklund</surname>
            <given-names>Å.K.</given-names>
          </name>
          <name>
            <surname>Faridani</surname>
            <given-names>O.R.</given-names>
          </name>
          <name>
            <surname>Sagasser</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Winberg</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Smart-seq2 for sensitive full-length transcriptome profiling in single cells</article-title>
        <source>Nat. Methods</source>
        <volume>10</volume>
        <year>2013</year>
        <fpage>1096</fpage>
        <lpage>1098</lpage>
        <pub-id pub-id-type="pmid">24056875</pub-id>
      </element-citation>
    </ref>
    <ref id="bib37">
      <element-citation publication-type="journal" id="sref37">
        <person-group person-group-type="author">
          <name>
            <surname>Pliner</surname>
            <given-names>H.A.</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>Supervised classification enables rapid annotation of cell atlases</article-title>
        <source>Nat. Methods</source>
        <volume>16</volume>
        <year>2019</year>
        <fpage>983</fpage>
        <lpage>986</lpage>
        <pub-id pub-id-type="pmid">31501545</pub-id>
      </element-citation>
    </ref>
    <ref id="bib38">
      <element-citation publication-type="journal" id="sref38">
        <person-group person-group-type="author">
          <name>
            <surname>Puré</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Blomberg</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Pro-tumorigenic roles of fibroblast activation protein in cancer: back to the basics</article-title>
        <source>Oncogene</source>
        <volume>37</volume>
        <year>2018</year>
        <fpage>4343</fpage>
        <lpage>4357</lpage>
        <pub-id pub-id-type="pmid">29720723</pub-id>
      </element-citation>
    </ref>
    <ref id="bib39">
      <element-citation publication-type="journal" id="sref39">
        <person-group person-group-type="author">
          <name>
            <surname>Segerstolpe</surname>
            <given-names>Å.</given-names>
          </name>
          <name>
            <surname>Palasantza</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Eliasson</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>E.M.</given-names>
          </name>
          <name>
            <surname>Anne-Christine</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Picelli</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Sabirsh</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Clausen</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Bjursell</surname>
            <given-names>M.K.</given-names>
          </name>
        </person-group>
        <article-title>Single-cell transcriptome profiling of human pancreatic islets in Health and type 2 diabetes</article-title>
        <source>Cell Metab.</source>
        <volume>24</volume>
        <year>2016</year>
        <fpage>593</fpage>
        <lpage>607</lpage>
        <pub-id pub-id-type="pmid">27667667</pub-id>
      </element-citation>
    </ref>
    <ref id="bib40">
      <element-citation publication-type="journal" id="sref40">
        <person-group person-group-type="author">
          <name>
            <surname>Shao</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Xue</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Ni</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>X.</given-names>
          </name>
        </person-group>
        <article-title>scCATCH: automatic annotation on cell types of clusters from single-cell RNA sequencing data</article-title>
        <source>iScience</source>
        <volume>23</volume>
        <year>2020</year>
        <fpage>100882</fpage>
        <pub-id pub-id-type="pmid">32062421</pub-id>
      </element-citation>
    </ref>
    <ref id="bib41">
      <element-citation publication-type="journal" id="sref41">
        <person-group person-group-type="author">
          <name>
            <surname>Sloan</surname>
            <given-names>C.A.</given-names>
          </name>
          <name>
            <surname>Esther</surname>
            <given-names>T.C.</given-names>
          </name>
          <name>
            <surname>Davidson</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Venkat</surname>
            <given-names>S.M.</given-names>
          </name>
          <name>
            <surname>Strattan</surname>
            <given-names>J.S.</given-names>
          </name>
          <name>
            <surname>Hitz</surname>
            <given-names>B.C.</given-names>
          </name>
          <name>
            <surname>Gabdank</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Narayanan</surname>
            <given-names>A.K.</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>B.T.</given-names>
          </name>
        </person-group>
        <article-title>ENCODE data at the ENCODE portal</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>44</volume>
        <year>2016</year>
        <fpage>D726</fpage>
        <lpage>D732</lpage>
        <pub-id pub-id-type="pmid">26527727</pub-id>
      </element-citation>
    </ref>
    <ref id="bib42">
      <element-citation publication-type="journal" id="sref42">
        <person-group person-group-type="author">
          <name>
            <surname>Strutz</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Okada</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>C.W.</given-names>
          </name>
          <name>
            <surname>Danoff</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Carone</surname>
            <given-names>R.L.</given-names>
          </name>
          <name>
            <surname>Tomaszewski</surname>
            <given-names>J.E.</given-names>
          </name>
          <name>
            <surname>Neilson</surname>
            <given-names>E.G.</given-names>
          </name>
        </person-group>
        <article-title>Identification and characterization of a fibroblast marker: FSP1</article-title>
        <source>J. Cell Biol.</source>
        <volume>130</volume>
        <year>1995</year>
        <fpage>393</fpage>
        <lpage>405</lpage>
        <pub-id pub-id-type="pmid">7615639</pub-id>
      </element-citation>
    </ref>
    <ref id="bib43">
      <element-citation publication-type="journal" id="sref43">
        <person-group person-group-type="author">
          <name>
            <surname>Tan</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Cahan</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>SingleCellNet: a computational tool to classify single cell RNA-seq data across platforms and across species</article-title>
        <source>Cell Syst.</source>
        <volume>9</volume>
        <year>2019</year>
        <fpage>207</fpage>
        <lpage>213.e2</lpage>
        <pub-id pub-id-type="pmid">31377170</pub-id>
      </element-citation>
    </ref>
    <ref id="bib44">
      <element-citation publication-type="journal" id="sref44">
        <person-group person-group-type="author">
          <name>
            <surname>Traag</surname>
            <given-names>V.A.</given-names>
          </name>
          <name>
            <surname>Waltman</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>van Eck</surname>
            <given-names>N.J.</given-names>
          </name>
        </person-group>
        <article-title>From louvain to leiden: guaranteeing well-connected communities</article-title>
        <source>Sci. Rep.</source>
        <volume>9</volume>
        <year>2019</year>
        <fpage>5233</fpage>
        <pub-id pub-id-type="pmid">30914743</pub-id>
      </element-citation>
    </ref>
    <ref id="bib45">
      <element-citation publication-type="journal" id="sref45">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>F.A.</given-names>
          </name>
          <name>
            <surname>Angerer</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>F.J.</given-names>
          </name>
        </person-group>
        <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>
        <source>Genome Biol.</source>
        <volume>19</volume>
        <year>2018</year>
        <fpage>15</fpage>
        <pub-id pub-id-type="pmid">29409532</pub-id>
      </element-citation>
    </ref>
    <ref id="bib46">
      <element-citation publication-type="journal" id="sref46">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X.</given-names>
          </name>
        </person-group>
        <article-title>Alignment of cell lineage trees elucidates genetic programs for the development and evolution of cell types</article-title>
        <source>iScience</source>
        <volume>23</volume>
        <year>2020</year>
        <fpage>101273</fpage>
        <pub-id pub-id-type="pmid">32599560</pub-id>
      </element-citation>
    </ref>
    <ref id="bib47">
      <element-citation publication-type="journal" id="sref47">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>A.W.</given-names>
          </name>
          <name>
            <surname>O’Flanagan</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Chavez</surname>
            <given-names>E.A.</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>J.L.P.</given-names>
          </name>
          <name>
            <surname>Ceglia</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Wiens</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Walters</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Hewitson</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>Probabilistic cell-type Assignment of single-cell RNA-seq for tumor microenvironment profiling</article-title>
        <source>Nat. Methods</source>
        <volume>16</volume>
        <year>2019</year>
        <fpage>1007</fpage>
        <lpage>1015</lpage>
        <pub-id pub-id-type="pmid">31501550</pub-id>
      </element-citation>
    </ref>
    <ref id="bib48">
      <element-citation publication-type="journal" id="sref48">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Lan</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Quan</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>CellMarker: a manually curated resource of cell markers in human and mouse</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>47</volume>
        <year>2019</year>
        <fpage>D721</fpage>
        <lpage>D728</lpage>
        <pub-id pub-id-type="pmid">30289549</pub-id>
      </element-citation>
    </ref>
    <ref id="bib49">
      <element-citation publication-type="journal" id="sref49">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>G.X.</given-names>
          </name>
          <name>
            <surname>Terry</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Belgrader</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Bent</surname>
            <given-names>Z.W.</given-names>
          </name>
          <name>
            <surname>Ryan</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Ziraldo</surname>
            <given-names>S.B.</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>T.D.</given-names>
          </name>
          <name>
            <surname>McDermott</surname>
            <given-names>G.P.</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>
        <source>Nat. Commun.</source>
        <volume>8</volume>
        <year>2017</year>
        <fpage>14049</fpage>
        <pub-id pub-id-type="pmid">28091601</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="appsec2" sec-type="supplementary-material">
    <title>Supplemental information</title>
    <p id="p0265">
      <supplementary-material content-type="local-data" id="mmc1">
        <caption>
          <title>Document S1. Transparent methods and Figures S1–S16</title>
        </caption>
        <media xlink:href="mmc1.pdf"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc2">
        <caption>
          <title>Table S1. Per-cell type metrics on bulk rna-seq validation set, related to figure 2A</title>
        </caption>
        <media xlink:href="mmc2.zip"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc3">
        <caption>
          <title>Table S2. Per-cell type metrics on non-droplet-based scrna-seq test set, related to Figure 2A</title>
        </caption>
        <media xlink:href="mmc3.zip"/>
      </supplementary-material>
    </p>
  </sec>
  <ack id="ack0010">
    <title>Acknowledgments</title>
    <p id="p0245">M.N.B. thanks Gary H. Bernstein, John Steill, Ron Stewart, and Christina Kendziorski for helpful conversations. This project has been made possible in part by grant U54 AI117924 from the <funding-source id="gs1"><institution-wrap><institution-id institution-id-type="doi">10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source> and grant 2018-182626 from the <funding-source id="gs2">Chan Zuckerberg Initiative DAF</funding-source>, an advised fund of <funding-source id="gs3"><institution-wrap><institution-id institution-id-type="doi">10.13039/100000923</institution-id><institution>Silicon Valley Community Foundation</institution></institution-wrap></funding-source>. M.N.B. acknowledges support of the Computation and Informatics in Biology and Medicine Training Program funded by grant: 5T15LM007359 from the National Institutes of Health. M.N.B. also acknowledges support from the <funding-source id="gs5">Morgridge Institute for Research</funding-source>. M.G. acknowledges support from the <funding-source id="gs6"><institution-wrap><institution-id institution-id-type="doi">10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source> award 1841349.</p>
    <sec id="sec5">
      <title>Author contributions</title>
      <p id="p0250">M.N.B. led the conceptual development of the ideas present in this article and implemented both the CellO software and experiments. C.N.D. supervised the conceptual development and implementation of the software and experiments. M.N.B. and C.N.D. wrote the manuscript. Z.M. implemented the CellO Viewer. M.G. supervised the development of the CellO Viewer. M.N.B., Z.M., M.G., and C.N.D. contributed to the conceptual design of the CellO Viewer.</p>
    </sec>
    <sec sec-type="COI-statement" id="sec6">
      <title>Declaration of interests</title>
      <p id="p0255">The authors declare no competing interests.</p>
    </sec>
  </ack>
  <fn-group>
    <fn id="appsec1" fn-type="supplementary-material">
      <p id="p0260">Supplemental information can be found online at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.isci.2020.101913" id="intref0055">https://doi.org/10.1016/j.isci.2020.101913</ext-link>.</p>
    </fn>
  </fn-group>
</back>
