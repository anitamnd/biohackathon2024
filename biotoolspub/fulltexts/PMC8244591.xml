<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName nlm2jats3.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Microbiol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Microbiol</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Microbiol.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Microbiology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1664-302X</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8244591</article-id>
    <article-id pub-id-type="doi">10.3389/fmicb.2021.649517</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Microbiology</subject>
        <subj-group>
          <subject>Methods</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Decentralized Investigation of Bacterial Outbreaks Based on Hashed cgMLST</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Deneke</surname>
          <given-names>Carlus</given-names>
        </name>
        <xref ref-type="corresp" rid="c001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/733208/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Uelze</surname>
          <given-names>Laura</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brendebach</surname>
          <given-names>Holger</given-names>
        </name>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/522603/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tausch</surname>
          <given-names>Simon H.</given-names>
        </name>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/723754/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Malorny</surname>
          <given-names>Burkhard</given-names>
        </name>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/305409/overview"/>
      </contrib>
    </contrib-group>
    <aff><institution>Department Biological Safety, German Federal Institute for Risk Assessment</institution>, <addr-line>Berlin</addr-line>, <country>Germany</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Kristin Hegstad, University Hospital of North Norway, Norway</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Magaly Toro, University of Chile, Chile; Shabarinath Srikumar, United Arab Emirates University, United Arab Emirates</p>
      </fn>
      <corresp id="c001">*Correspondence: Carlus Deneke, <email>carlus.deneke@bfr.bund.de</email></corresp>
      <fn fn-type="other" id="fn004">
        <p>This article was submitted to Evolutionary and Genomic Microbiology, a section of the journal Frontiers in Microbiology</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>12</volume>
    <elocation-id>649517</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>3</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2021 Deneke, Uelze, Brendebach, Tausch and Malorny.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Deneke, Uelze, Brendebach, Tausch and Malorny</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Whole-genome sequencing (WGS)-based outbreak investigation has proven to be a valuable method for the surveillance of bacterial pathogens. Its utility has been successfully demonstrated using both gene-by-gene (cgMLST or wgMLST) and single-nucleotide polymorphism (SNP)-based approaches. Among the obstacles of implementing a WGS-based routine surveillance is the need for an exchange of large volumes of sequencing data, as well as a widespread reluctance to share sequence and metadata in public repositories, together with a lacking standardization of suitable bioinformatic tools and workflows. To address these issues, we present <italic>chewieSnake</italic>, an intuitive and simple-to-use cgMLST workflow. <italic>ChewieSnake</italic> builds on the allele calling software chewBBACA and extends it by the concept of allele hashing. The resulting hashed allele profiles can be readily compared between laboratories without the need of a central allele nomenclature. The workflow fully automates the computation of the allele distance matrix, cluster membership, and phylogeny and summarizes all important findings in an interactive HTML report. Furthermore, <italic>chewieSnake</italic> can join allele profiles generated at different laboratories and identify shared clusters, including a stable and intercommunicable cluster nomenclature, thus facilitating a joint outbreak investigation. We demonstrate the feasibility of the proposed approach with a thorough method comparison using publically available sequencing data for <italic>Salmonella enterica</italic>. However, <italic>chewieSnake</italic> is readily applicable to all bacterial taxa, provided that a suitable cgMLST scheme is available. The workflow is freely available as an open-source tool and can be easily installed via conda or docker.</p>
    </abstract>
    <kwd-group>
      <kwd>cgMLST</kwd>
      <kwd>WGS typing</kwd>
      <kwd>molecular surveillance</kwd>
      <kwd>comparative microbial genomics</kwd>
      <kwd>
        <italic>Salmonella</italic>
      </kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source id="cn001">Bundesministerium für Gesundheit<named-content content-type="fundref-id">10.13039/501100003107</named-content></funding-source>
      </award-group>
      <award-group>
        <funding-source id="cn002">Horizon 2020 Framework Programme<named-content content-type="fundref-id">10.13039/100010661</named-content></funding-source>
      </award-group>
    </funding-group>
    <counts>
      <fig-count count="3"/>
      <table-count count="3"/>
      <equation-count count="0"/>
      <ref-count count="41"/>
      <page-count count="12"/>
      <word-count count="0"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="S1">
    <title>Introduction</title>
    <p>Whole-genome sequencing (WGS)-based typing approaches allow the highly discriminatory comparison of the similarity of bacterial genomes. The results are used for the investigation of disease outbreaks, source attribution, contamination control, and surveillance of bacterial pathogens (<xref rid="B10" ref-type="bibr">Franz et al., 2016</xref>; <xref rid="B30" ref-type="bibr">Ronholm et al., 2016</xref>; <xref rid="B16" ref-type="bibr">Jagadeesan et al., 2019</xref>). A number of sequence-based typing approaches exist, each with their own advantages and drawbacks (<xref rid="B36" ref-type="bibr">Uelze et al., 2020b</xref>). Generally, the analysis of single-nucleotide polymorphisms (SNPs) is considered the method with the highest resolution. In particular, the National Center for Biotechnology Information (NCBI) pathogen detection pipeline is an SNP-based molecular typing system for global microbial surveillance based on publically available sequencing data<sup><xref ref-type="fn" rid="footnote1">1</xref></sup>. Another high-resolution typing approach is the core genome/whole-genome multilocus sequence typing (cg/wgMLST), which was derived from the concept of classic multilocus sequence typing (MLST), with the distinction that the initial seven-gene multi-locus scheme was expanded to hundreds or thousands of gene loci (<xref rid="B21" ref-type="bibr">Maiden et al., 2013</xref>). CgMLST is a gene-by-gene approach, which functions by aligning complete or draft genome assemblies to a scheme consisting of a set of loci and a collection of associated numbered allele sequences. One of the advantages of cgMLST is that no outbreak specific reference is required, and therefore, it is a suitable and unbiased method to identify possible clusters from samples from an entire species. During the allele calling step, each locus is searched in the assembly, and if it matches an existing allele sequence, the number of that allele is assigned. In the case that an allele sequence is not yet contained in the scheme, a new allele number is created, and the allele sequence is added for future inquiries. From the set of allele numbers for each locus, a so-called allele profile is derived. The similarity between two or several genomes is estimated by comparing their respective allele profiles and calculating the total number of different alleles. Allele differences are first determined pairwise, before a distance matrix is derived by cross-comparison for all samples. Finally, a phylogenetic tree can be computed from the distance matrix through various clustering techniques such as neighbor-joining, minimum-spanning trees, or hierarchical clustering. Large minimum-spanning trees can be visualized, e.g., with grapeTree<sup><xref ref-type="fn" rid="footnote2">2</xref></sup> (<xref rid="B41" ref-type="bibr">Zhou et al., 2018</xref>) or PHLYOViZ<sup><xref ref-type="fn" rid="footnote3">3</xref></sup> (<xref rid="B9" ref-type="bibr">Francisco et al., 2012</xref>).</p>
    <p>Core genome multilocus sequence typing clustering results are dependent on the choice of cgMLST scheme, with the number and type of loci being of great importance. The loci for each scheme should be chosen carefully to account for the unique genetic background of different species. Generally, the chosen loci should be part of the core genome (hence the name) of a taxonomic group and as such be present in the majority of all isolates of this group. A number of cgMLST schemes for major species are curated by various (at times commercial) organizations and research groups, such as Enterobase<sup><xref ref-type="fn" rid="footnote4">4</xref></sup>, Institut Pasteur<sup><xref ref-type="fn" rid="footnote5">5</xref></sup>, Ridom SeqSphere+<sup><xref ref-type="fn" rid="footnote6">6</xref></sup>, or chewBACCA<sup><xref ref-type="fn" rid="footnote7">7</xref></sup>, and can often be obtained freely from their websites.</p>
    <p>One major disadvantage of a classic numbered cgMLST allele sequence scheme is that results from different laboratories, even when using the same scheme, are not directly comparable. This is caused by the fact that different local instances of an (initially identical) cgMLST scheme quickly diverge from each other, as new allele sequences are added, leading to the assignment of the same allele number for different allele sequences, or of the same allele sequence to be attributed to two or more different allele numbers. This can only be prevented by real-time synchronization of the local allele database with a (centrally) curated cgMLST allele nomenclature server, as implemented in Ridom SeqSphere and chewieNS (<xref rid="B22" ref-type="bibr">Mamede et al., 2020</xref>).</p>
    <p>One possible solution is the replacement of chronologically numbered allele numbers with numbers or strings that are directly related to the underlying allele sequence. Using the allele sequence itself is impractical, as it hugely increases the size of an allele profile. Alternatively, <italic>allele hashes</italic> can be derived directly and unambiguously from the allele sequence. Allele hashes uniquely map the nucleotide sequence into a fixed-size hash value. Thus, independently discovered, identical allele sequences always result in the identical allele hash. This has the major advantage of allowing a decentralized nomenclature-free allocation of sequencing types, with no need for harmonization with a central unit. The practicability of the hashing approach has been demonstrated by the bioinformatic tool SISTR (<xref rid="B38" ref-type="bibr">Yoshida et al., 2016</xref>) for the purpose of serotyping <italic>Salmonella</italic> spp. and for <italic>Clostridium difficile</italic> in (<xref rid="B7" ref-type="bibr">Eyre et al., 2019</xref>).</p>
    <p>Existing bioinformatic cgMLST standalone tools differ not only in their implemented cgMLST scheme but also in their specific allele calling algorithm and whether the source code is freely available, i.e., open- or closed-source. Two popular commercial solutions (source code not freely available) with a graphical user interface (GUI), which can be run on Windows systems, are Ridom SeqSphere+<sup><xref ref-type="fn" rid="footnote8">8</xref></sup> and Bionumerics<sup><xref ref-type="fn" rid="footnote9">9</xref></sup>. Both employ a closed system with a central nomenclature server. In comparison, two open-source, command-line tools, MentaLiST (<xref rid="B8" ref-type="bibr">Feijao et al., 2018</xref>) and chewBACCA (<xref rid="B32" ref-type="bibr">Silva et al., 2018</xref>), allow users to utilize their own cgMLST scheme. ChewBBACA is a comprehensive pipeline for cgMLST calling, as well as for the creation of new cgMLST schemes. The allele calling algorithm of chewBACCA considers the Blast Score Ratio in order to determine the allele sequences. Among the advantages of chewBBACA is that it automatically incorporates novel alleles into a scheme. Its usability has furthermore been demonstrated in numerous studies (<xref rid="B20" ref-type="bibr">Macedo et al., 2019</xref>; <xref rid="B19" ref-type="bibr">Lüth et al., 2020</xref>; <xref rid="B26" ref-type="bibr">Pinto et al., 2020</xref>; <xref rid="B35" ref-type="bibr">Uelze et al., 2020a</xref>).</p>
    <p>Here, we present <italic>chewieSnake</italic>, an automated analysis pipeline that encompasses the whole analysis process from reads or draft assemblies to a final user-friendly cgMLST report. The pipeline implements chewBBACA for allele calling and performs allele hashing, computation of an allele distance (AD) matrix, and a minimum-spanning tree, as well as a clustering analysis by AD. The analysis results are summarized in an interactive HTML report.</p>
    <p>We demonstrate the workflow’s usability by analyzing a large public database for <italic>Salmonella enterica</italic> and validate it by comparing it to two publically available, state-of-the-art methods—Enterobase and NCBI pathogen detection. Additionally, we simulate a scenario of decentralized allele calling and central cluster analysis.</p>
    <p>Finally, we want to emphasize that the presented method is not restricted to <italic>Salmonella</italic> spp. but is readily applicable to all bacterial taxa, provided a suitable cgMLST scheme is available.</p>
  </sec>
  <sec id="S2">
    <title>Methods</title>
    <sec id="S2.SS1">
      <title>Implementation and Availability</title>
      <p>The provided software consists of two workflows—<italic>chewieSnake</italic> and <italic>chewieSnake_join</italic>. Additionally, several modules of the software are available on their own and can be applied in conjunction with other analysis workflows. The software is available open-source<sup><xref ref-type="fn" rid="footnote10">10</xref></sup> and can be easily installed using bioconda (<xref rid="B12" ref-type="bibr">Grüning et al., 2018</xref>) or docker (<xref rid="B23" ref-type="bibr">Merkel, 2014</xref>).</p>
      <sec id="S2.SS1.SSS1">
        <title><italic>ChewieSnake</italic> Workflow</title>
        <p><italic>ChewieSnake</italic> implements a workflow for allele calling, computation of the ADs, and a minimum-spanning tree, with analysis results summarized in an interactive HTML report. Central to the workflow is the concept of allele hashes that allow a nomenclature free comparison of allele profiles (see <xref ref-type="fig" rid="F1">Figure 1</xref>).</p>
        <fig id="F1" position="float">
          <label>FIGURE 1</label>
          <caption>
            <p>Schematic representation of the <italic>chewieSnake</italic> workflow. The workflow starts from a set of assemblies (fasta data) or a set of raw reads (fastq data), which are then assembled into fasta files. On these, cgMLST allele calling is performed using the tool chewBBACA, utilizing a designated cgMLST scheme, to which newly found alleles are added in the process. The resulting allele profiles are converted to hashed allele profiles. All profiles are subsequently combined; and an allele distance matrix and a minimum-spanning tree phylogeny are computed with the tool GrapeTree. Then, cluster types are generated by hierarchical clustering at different allele distance thresholds. Finally, the results are summarized in an interactive HTML report.</p>
          </caption>
          <graphic xlink:href="fmicb-12-649517-g001"/>
        </fig>
        <sec id="S2.SS1.SSS1.Px1">
          <title>Snakemake workflow</title>
          <p>The workflow consists of a Snakemake pipeline (<xref rid="B17" ref-type="bibr">Koster and Rahmann, 2012</xref>) with a set of assemblies (or sequencing reads) as input listed in a sample sheet. Snakemake resolves all dependencies in a directed acyclic graph (DAG), runs all necessary components for each sample, merges all results, and renders the final HTML report using Rmarkdown (<xref rid="B29" ref-type="bibr">rmarkdown, 2020</xref>) (see also <xref ref-type="supplementary-material" rid="FS1">Supplementary Figure 1</xref>). The design of the workflow is such that samples may be added continuously without the need to re-compute analysis results for previously analyzed samples, thus optimizing the computational time/resources for maintaining an allele profile database containing a large number of samples. Nevertheless, the clustering, phylogeny, and report are updated whenever new samples are provided.</p>
        </sec>
        <sec id="S2.SS1.SSS1.Px2">
          <title>Allele calling</title>
          <p>The basis for the central allele calling step is the assembly based allele caller chewBBACA (<xref rid="B32" ref-type="bibr">Silva et al., 2018</xref>). Its main concept lies in the identification of coding sequences (CDSs) using prodigal (<xref rid="B14" ref-type="bibr">Hyatt et al., 2010</xref>). While existing alleles are detected via exact sequence matching, novel alleles are quality controlled via a BLASTP routine. For the usage of chewBBACA in a Snakemake workflow—and in particular to allow the continuous addition of samples—a fixed version (2.12.0) was included in the <italic>chewieSnake</italic> repository with minor adaptations to their output: chewBBACA is called for one sample at a time, and the output is stored in a folder with the sample’s name. Possibly conflicting parallel writing to the allele database is blocked.</p>
        </sec>
        <sec id="S2.SS1.SSS1.Px3">
          <title>Allele hashing</title>
          <p>The allele profiles as provided from chewBBACA are reformatted into a GrapeTree compatible format; and for each sample, the allele numbers—as provided in the applied cgMLST scheme—are converted into allele hashes. This step guarantees that the same allele hash is assigned for any identical allele sequence. Thus, independent identification of alleles for different samples and on different computing facilities always leads to the same allele hash and therefore clustering result.</p>
          <p>The provided function <italic>alleleprofile_hasher.py</italic> looks up the allele sequence for each allele number in an allele profile in the scheme and computes a CRC32 hash using python’s zlib package, yielding a unique integer.</p>
          <p>The function <italic>alleleprofile_hasher.py</italic> can be used as a standalone program, e.g., if a user prefers to use their own analysis workflow (based on chewBBACA) and thus allows the nomenclature free sharing of allele profiles regardless of the presented <italic>chewieSnake</italic> workflow.</p>
        </sec>
        <sec id="S2.SS1.SSS1.Px4">
          <title>Unique hashed sequence types</title>
          <p>To generate unique sequence types for each sample (hashIDs), the hashing approach is also applied. For each allele profile, the allele hashes (including possibly missing loci) are combined into a single string, and a hash value of the string provides the unique sequence type. It should be noted that this approach is stricter than clustering samples at 0 AD, since missing alleles are explicitly accounted for.</p>
          <p>The provided function <italic>hashID.py</italic> can be used standalone, thus enabling users to infer hashed sequence type for any kind of allele profile.</p>
        </sec>
        <sec id="S2.SS1.SSS1.Px5">
          <title>Allele distance matrix and minimum-spanning tree</title>
          <p>Based on the allele profiles, the workflow uses GrapeTree (<xref rid="B41" ref-type="bibr">Zhou et al., 2018</xref>) for the computation of the AD matrix. GrapeTree allows the computation of the distance in various ways, which differ in how missing alleles are treated. In addition, GrapeTree is also used to infer the phylogeny of all samples with minimum-spanning trees. The resulting Newick file can be readily rendered with GrapeTree’s graphic visualization software or other phylogenetic visualization tools. This step and all subsequent steps are repeated whenever new sample data are added to the workflow.</p>
        </sec>
        <sec id="S2.SS1.SSS1.Px6">
          <title>Sample clustering</title>
          <p><italic>ChewieSnake</italic> hierarchically clusters the distance matrix of all samples (using, e.g., single linkage or average linkage hierarchical clustering) using the R-function <italic>hclust</italic> (<xref rid="B27" ref-type="bibr">R Core Team, 2013</xref>). Subsequently, given the clustering, a set of pre-defined thresholds assign cluster numbers to all samples at different thresholds—using dendextend (<xref rid="B11" ref-type="bibr">Galili, 2015</xref>). This provides so-called <italic>cluster addresses</italic> or <italic>cluster zip-codes</italic>, which allow an additional description of the relatedness of a set of samples. This is a similar approach to SNP addressed in SnapperDB (<xref rid="B5" ref-type="bibr">Dallman et al., 2018</xref>) or HierCC in Enterobase (<xref rid="B40" ref-type="bibr">Zhou et al., 2020b</xref>).</p>
          <p>The function <italic>Clustering_DistanceMatrix.R</italic> is provided in the scripts directory and can be used standalone for any kind of distance matrix, including SNP distance matrices.</p>
        </sec>
        <sec id="S2.SS1.SSS1.Px7">
          <title>HTML report</title>
          <p>After processing and collection of all sample data, the entire dataset is summarized in an interactive user-friendly HTML report. The report is organized into different tabs and designed with the aim to give all scientists (regardless of bioinformatic background) access to the most important results:</p>
          <p>In the <italic>Allele statistics</italic> tab, key quality assessment parameters of the allele calling step are shown for each sample, such as the number of alleles found—as well as the reason for missing alleles. The <italic>Allele distance table</italic> tab features a searchable table with all pairwise ADs. The <italic>Allele distance matrix</italic> tab provides a colored and zoomable visualization of the distance matrix. The <italic>Clustering</italic> tab presents a searchable table of the clustering address at the pre-defined thresholds. Furthermore, single-linkage trees are printed for all identified clusters at the pre-defined cluster threshold. The <italic>Minimum-spanning tree</italic> tab displays a simple (static) visualization of the phylogenetic tree. Lastly, the tabs <italic>Links to files</italic>, <italic>Config and parameters</italic>, and <italic>Help</italic> give further directions for more detailed analysis and enable optimal reproducibility.</p>
          <p>An example report for a small test set can be found at <ext-link ext-link-type="uri" xlink:href="https://bfr_bioinformatics.gitlab.io/chewieSnake/report_chewiesnake.html">https://bfr_bioinformatics.gitlab.io/chewieSnake/report_chewiesnake.html</ext-link>.</p>
        </sec>
        <sec id="S2.SS1.SSS1.Px8">
          <title>User input and parameter choice</title>
          <p>The user has control over a large set of parameters, which are available with the command <italic>chewieSnake.py–help</italic>.</p>
          <p>Importantly, if only reads are available for analysis, <italic>chewieSnake</italic> can also be given a set of reads as input, which it then trims using fastp (<xref rid="B3" ref-type="bibr">Chen et al., 2018</xref>) and subsequently assembles into draft genomes using shovill<sup><xref ref-type="fn" rid="footnote11">11</xref></sup>, before proceeding with the Snakemake workflow. Further important parameter choices are the GrapeTree distance method (see above), the clustering method, and thresholds, as well as chewBBACA specific parameters. All parameters are transparently saved and included in the report for reproducibility.</p>
        </sec>
        <sec id="S2.SS1.SSS1.Px9">
          <title>Possibilities in <italic>chewieSnake</italic> for inter-lab –comparison</title>
          <p>The <italic>chewieSnake</italic> workflow contains the –comparison option to compare a set of query data with a pre-computed allele profile. This allows the identification of clusters between query data and comparison data. The workflow processes the query data in the same fashion as described above. When the (hashed) allele profiles are computed, these are joined with the comparison allele profiles. Next, all samples from the comparison allele profiles that match to any of the query data within a predefined <italic>joining_threshold</italic> are extracted; and a distance matrix, distance table (query vs. comparison data), and a minimum-spanning tree are computed. Again, all findings are summarized in an HTML report, highlighting the matches between the two datasets. In conclusion, this approach allows a quick screening of a potentially large comparison allele database for matches to queries of interest, e.g., in an outbreak situation. This strategy might also be useful when a comparison of newly sequenced data to existing allele data is desired.</p>
          <p>An example report is provided at <ext-link ext-link-type="uri" xlink:href="https://bfr_bioinformatics.gitlab.io/chewieSnake/report_chewiesnake_comparison.html">https://bfr_bioinformatics.gitlab.io/chewieSnake/report_chewiesnake_comparison.html</ext-link>.</p>
        </sec>
      </sec>
      <sec id="S2.SS1.SSS2">
        <title><italic>ChewieSnake_Join</italic> Workflow</title>
        <p>The central allele hashing concept within the <italic>chewieSnake</italic> workflow allows the nomenclature-free comparison of allele profiles generated by different laboratories. To facilitate the comparison and establish an inter-laboratory outbreak clustering nomenclature, the <italic>chewieSnake_join</italic> workflow conducts all necessary steps from individual <italic>chewieSnake</italic> results to a joined clustering report. The conceptual model is depicted in <xref ref-type="fig" rid="F2">Figure 2A</xref>, whereas the essential steps are shown in <xref ref-type="fig" rid="F2">Figure 2B</xref>. In the following, we describe the core elements of the workflow in more detail.</p>
        <fig id="F2" position="float">
          <label>FIGURE 2</label>
          <caption>
            <p>Schematic representation of the c<italic>hewieSnake_join</italic> workflow. <bold>(A)</bold> A set of laboratories locally employ the <italic>chewieSnake</italic> workflow to process incoming raw sequencing data. The resulting allele profiles are stored in individual allele databases, which are subsequently joined with the <italic>chewieSnake_join</italic> workflow. In addition, the <italic>chewieSnake_join</italic> workflow computes a joined cgMLST report. <bold>(B)</bold> Detailed description of the <italic>chewieSnake_join</italic> workflow. From the joined allele profiles, the allele distance matrix is computed, followed by cluster typing of the entire dataset. Detailed reports for each cluster as well as an overall report summarize the results in an interactive HTML format.</p>
          </caption>
          <graphic xlink:href="fmicb-12-649517-g002"/>
        </fig>
        <sec id="S2.SS1.SSS2.Px1">
          <title>Compiling pre-computed allele data from a set of laboratories</title>
          <p>All laboratories setup and run the <italic>chewieSnake</italic> workflow independently on their set of data. Laboratories can validate their results by inspecting the allele quality and the local clustering results.</p>
          <p>The central results (provided in the files allele_profiles.tsv, allele_statistics.tsv, timestamps.tsv) need to be collected from each laboratory. The location of all files is provided in an <italic>allele sheet</italic> (a tsv file containing each laboratories’ acronym, as well as paths to the allele profiles, allele statistics, and timestamps). This is the input to the <italic>chewieSnake_join</italic> workflow.</p>
          <p>The contributed data can be updated continuously. On each execution of <italic>chewieSnake_join</italic>, the workflow identifies new samples and repeats subsequent steps automatically where necessary.</p>
        </sec>
        <sec id="S2.SS1.SSS2.Px2">
          <title>Joining allele and associated data</title>
          <p>The individual allele profiles (and other files) are joined into single files, and a file tying the laboratory of origin to the sample name is generated. Subsequently, in analogy to the <italic>chewieSnake</italic> workflow, a distance matrix and minimum-spanning tree are computed on the basis of the full dataset.</p>
        </sec>
        <sec id="S2.SS1.SSS2.Px3">
          <title>Cluster and subcluster identification</title>
          <p>The joined AD matrix is input to the clustering module of <italic>chewieSnake_join</italic>. Again, hierarchical clustering together with a predefined threshold divides the dataset into individual clusters (and unrelated orphan samples). Since the clustering may assign new cluster numbers each time it is invoked, special emphasis is put on a stable clustering nomenclature: The cluster numbers are matched to a list of cluster names (which can be numbers such as <italic>CT_0001</italic> or predefined names such as <italic>Cluster_Kairo</italic>), whenever the clustering is repeated, e.g., after addition of more samples. Hereby, it is guaranteed that the same cluster name is assigned to the same set of samples. Exceptions such as the merging of two or more clusters are considered and handled adequately. In a similar fashion, for the samples in each cluster, a subclustering at a lower subclustering threshold is performed—again using stable names such as alpha and beta—thus allowing an intercommunicable cluster nomenclature at a finer level.</p>
        </sec>
        <sec id="S2.SS1.SSS2.Px4">
          <title>Additional options and parameters</title>
          <p>Apart from setting clustering methods and thresholds, a number of additional options can be invoked in <italic>chewieSnake_join</italic>.</p>
          <p>In particular, individual representative samples can be matched to external cluster names (using the <italic>–external_cluster_names</italic> flag). For instance, the latter can describe epidemiologically defined clusters—independent from the molecular data. <italic>ChewieSnake_join</italic> links these external cluster names to the internal cluster names, which may aid the tracking of established clusters in the report (see below). Additionally, samples can be assigned to e.g., serovars or larger clades using the <italic>–serovar_info</italic> flag. Again, this might facilitate the cluster analysis provided in the report. The matching of these additional data proceeds by providing a list of representative samples and their association to external clusters and serovar, respectively. <italic>ChewieSnake_join</italic> associates these representative samples to the identified clusters, and this association becomes accessible in the report.</p>
          <p>The pool of names for the cluster naming can be modified by providing a list of available cluster names with the <italic>–cluster_names</italic> flag.</p>
          <p>All available options and parameters can be inspected using <italic>chewieSnake_join.py–help</italic>.</p>
        </sec>
        <sec id="S2.SS1.SSS2.Px5">
          <title>Joined HTML report</title>
          <p>Central to the facilitation of a joined outbreak analysis is the <italic>chewiesnake_join</italic> HTML report. This report summarizes all findings from the data aggregation and clustering. It is organized into different tabs, as follows.</p>
          <p>The <italic>Overview tab</italic> condenses the information about samples per laboratories, date of sample analysis, and number of clusters shared between laboratories. The <italic>Cluster summary</italic> tab provides the central information for the clustering analysis in a first (searchable) table that is organized by cluster. It provides readily accessible information such as cluster size, latest updates, duration (age) of cluster, cluster nomenclature, and the matching to external cluster names and serovar. Another table lists all samples and their respective cluster assignments. The <italic>Orphans</italic> tab displays all samples that, under the chosen threshold, do not belong to any existing cluster, together with their distance to the closest cluster. The <italic>Inter-cluster relation</italic> tab describes the more global relationship between clusters. The <italic>Allele QC</italic> tab allows an inspection of the allele quality for the entire dataset. The tabs <italic>Links to files</italic>, <italic>Config and parameters</italic>, and <italic>Help</italic> provide additional information.</p>
          <p>An example report is provided at <ext-link ext-link-type="uri" xlink:href="https://bfr_bioinformatics.gitlab.io/chewieSnake/report_chewiesnake_join.html">https://bfr_bioinformatics.gitlab.io/chewieSnake/report_chewiesnake_join.html</ext-link>.</p>
          <p>For each identified cluster, a more detailed cluster report is available. This report summarizes the subclusters, the AD matrix of all samples in the cluster, the time evolution of the cluster (according to the timestamps of the analyses), and the cluster’s and all subcluster’s phylogeny.</p>
          <p>An example report is provided at <ext-link ext-link-type="uri" xlink:href="https://bfr_bioinformatics.gitlab.io/chewieSnake/clustering/CT_0004/clusterreport.html">https://bfr_bioinformatics.gitlab.io/chewieSnake/clustering/CT_0004/clusterreport.html</ext-link>.</p>
        </sec>
      </sec>
    </sec>
    <sec id="S2.SS2">
      <title>Dataset for Evaluation</title>
      <sec id="S2.SS2.SSS1">
        <title>Raw Data</title>
        <p>In total, 1,263 WGS sequencing data were obtained from BioProject <ext-link ext-link-type="DDBJ/EMBL/GenBank" xlink:href="PRJEB31846">PRJEB31846</ext-link>. The dataset comprises diverse <italic>S. enterica</italic> serovars collected between the years 1999 and 2019 and sequenced by the National Reference Laboratory for <italic>Salmonella</italic> using the Nextera XT or DNA Flex kit (Illumina GmbH, München, Germany) on Illumina MiSeq and NextSeq instruments. The data are described in more detail in (<xref rid="B37" ref-type="bibr">Uelze et al., 2019</xref>).</p>
      </sec>
      <sec id="S2.SS2.SSS2">
        <title>Assembly</title>
        <p>Data were trimmed [with fastp (<xref rid="B3" ref-type="bibr">Chen et al., 2018</xref>), version 0.19.5] and assembled [with shovill-spades (see text footnote 11), version 1.1.0] using the AQUAMIS pipeline<sup><xref ref-type="fn" rid="footnote12">12</xref></sup> (version v1.2.0) (<xref rid="B6" ref-type="bibr">Deneke et al., 2021</xref>). All samples passed basic quality checks, such as sufficient base quality, coverage depth, genome length, and contig number. Furthermore, no evidence for sample contamination was detected. The assemblies are available under <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4338293">https://zenodo.org/record/4338293</ext-link>.</p>
      </sec>
      <sec id="S2.SS2.SSS3">
        <title>cgMLST Scheme</title>
        <p>The cgMLST scheme for <italic>Salmonella</italic> was downloaded on June 11, 2018, from Enterobase (<xref rid="B39" ref-type="bibr">Zhou et al., 2020a</xref>) using the web API. As the sequencing data were published at a later date, this ensured that the downloaded cgMLST scheme did not already contain allele numbers from our dataset. Only this strategy allows an unbiased analysis of the allele calling process and in particular the assignment/identification of novel alleles, as would be the case for newly generated sequencing data unknown to a specific reference allele database. The scheme is available under <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4724927">https://</ext-link>
<ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4724927">zenodo.org/record/4724927</ext-link>.</p>
      </sec>
      <sec id="S2.SS2.SSS4">
        <title>Allele Calling</title>
        <p>The assembled draft genomes were analyzed using the <italic>chewieSnake</italic> workflow. All parameters and software versions are specified in the <xref ref-type="supplementary-material" rid="SM2">Supplementary Data Sheet 2</xref>. The resulting <italic>chewieSnake</italic> report is available under <ext-link ext-link-type="uri" xlink:href="https://bfr_bioinformatics.gitlab.io/chewiesnake_publicationdata/chewiesnake/cgmlst_report.html">https://bfr_bioinformatics.gitlab.io/chewiesnake_publicationdata/chewiesnake/cgmlst_report.html</ext-link>.</p>
      </sec>
      <sec id="S2.SS2.SSS5">
        <title>Simulation of Decentralized Analysis</title>
        <p>The dataset was split randomly into three non-overlapping sub-datasets. The membership of each sample is listed within <xref ref-type="supplementary-material" rid="SM1">Supplementary Data Sheet 1</xref>. A cgMLST analysis with <italic>chewieSnake</italic> (with the same software version and parameters as for the full dataset) was performed separately on each sub-dataset. For each analysis, an identical but separate allele database was employed.</p>
        <p>In order to simulate a decentralized surveillance system over a given time span, the timestamp files—which originally contain the date of the analyses—were modified to random dates from the period of January 2020 to October 2020. Other than for visualization purposes, this had no impact on the analyses.</p>
        <p>Results were joined using the <italic>chewieSnake</italic> joining workflow (see above). All parameters are specified in the <xref ref-type="supplementary-material" rid="SM2">Supplementary Data Sheet 2</xref>. The resulting joined report is available under <ext-link ext-link-type="uri" xlink:href="https://bfr_bioinformatics.gitlab.io/chewiesnake_publicationdata/chewiesnake_join/report.html">https://bfr_bioinformatics.gitlab.io/chewiesnake_publicationdata/chewiesnake_join/report.html</ext-link>.</p>
      </sec>
      <sec id="S2.SS2.SSS6">
        <title>Enterobase Data</title>
        <p>Available cgMLST metadata for Bioproject <ext-link ext-link-type="DDBJ/EMBL/GenBank" xlink:href="PRJEB31846">PRJEB31846</ext-link> were searched and downloaded from <ext-link ext-link-type="uri" xlink:href="https://enterobase.warwick.ac.uk/species/index/senterica">https://enterobase.warwick.ac.uk/species/index/senterica</ext-link> on November 2, 2020. The set of allele profiles was downloaded on November 2, 2020, and subsequently filtered for all entries of BioProject <ext-link ext-link-type="DDBJ/EMBL/GenBank" xlink:href="PRJEB31846">PRJEB31846</ext-link>. A total of 1,158 data were also found on Enterobase.</p>
        <p>An AD matrix was computed from the allele profiles using GrapeTree in complete analogy to the <italic>chewieSnake</italic> workflow. Subsequently, the distance matrix was hierarchically clustered, and a cluster address was assigned using the provided script <italic>Clustering_DistanceMatrix.R.</italic> Thus, all analysis steps from the allele profiles were identical to the <italic>chewieSnake</italic> workflow.</p>
      </sec>
      <sec id="S2.SS2.SSS7">
        <title>National Center for Biotechnology Information Data</title>
        <p><italic>Salmonella</italic> SNP distances were obtained from NCBI Pathogen detection<sup><xref ref-type="fn" rid="footnote13">13</xref></sup> on September 10, 2020, corresponding to version PDG000000002.1968. With the use of a custom script, the pairwise SNP distances were filtered such that all distances of pairs originating from Biosamples associated with BioProject <ext-link ext-link-type="DDBJ/EMBL/GenBank" xlink:href="PRJEB31846">PRJEB31846</ext-link> were retained. Overall, 811 samples were part of an SNP cluster on NCBI pathogen, and the samples were found in 120 distinct SNP clusters. Note that the definition of an SNP cluster on NCBI pathogen does not correspond to the hierarchical clustering studied in this contribution but rather to the set of samples with the same reference for SNP calling.</p>
        <p>For this analysis, the SNP distance data were hierarchically clustered, and cluster numbers were assigned to each sample using a custom script in the same fashion as described above.</p>
      </sec>
    </sec>
    <sec id="S2.SS3">
      <title>Methods for Comparison Analysis</title>
      <sec id="S2.SS3.SSS1">
        <title>Comparison of Pairwise Distances</title>
        <p>Pairwise distances of each method were obtained as described in the individual sections above. Each resulting distance matrix was read into R and converted to a linearized table with the pair’s sample names as keys. The linearized distance tables resulting from different methods were matched using the keys, followed by redundancy and self-hits removal. Based on these distance-method-comparison tables (provided in the <xref ref-type="supplementary-material" rid="SM1">Supplementary Data sheet 1</xref>), the Spearman correlation was computed, and the pairwise distance comparison plots were drawn (<xref ref-type="fig" rid="F3">Figures 3A,B</xref>).</p>
        <fig id="F3" position="float">
          <label>FIGURE 3</label>
          <caption>
            <p>Pairwise distances show very high method congruence. <bold>(A)</bold> Comparison of allele distance between Enterobase and <italic>chewieSnake</italic>. <bold>(B)</bold> Comparison of NCBI_pathogen SNP and <italic>chewieSnake</italic> allele distance. The gray shading indicates the frequency of observed pairwise distances. Both figures show the very high concordance between the different methods. This is also reflected in the Spearman correlation coefficients (0.984 and 0.973). The slope of a linear fit (red line) to the NCBI_SNP and <italic>chewieSnake</italic> comparison is ∼1.73; i.e., on average, 1 allele difference corresponds to 1.73 single-nucleotide polymorphisms. For the computation of sensitivity and specificity, the green lines mark clustering thresholds. All points in the lower left quadrant are counted as true positives, and all points in the upper right quadrant as true negatives, whereas the points in the top left and bottom right quadrants are false positives and false negatives, respectively. Using these thresholds also leads to the high adjusted Wallace and adjusted Rand coefficients (see <xref rid="T1" ref-type="table">Tables 1</xref>, <xref rid="T2" ref-type="table">2</xref>). Though overall the agreement is very high, some remaining differences at low distances may still influence interpretation of the very fine-grained phylogeny. Note that for the Enterobase comparison, only distances below 85 AD were displayed.</p>
          </caption>
          <graphic xlink:href="fmicb-12-649517-g003"/>
        </fig>
      </sec>
      <sec id="S2.SS3.SSS2">
        <title>Computation of Sensitivity/Specificity Values</title>
        <p>For each method combination, the pairwise distances of all sample pairs were obtained and a distance threshold was chosen, such that samples could be grouped into possible related clusters. Though no single fixed threshold is sufficient and advisable for the differentiation of outbreak to non-outbreak strains (<xref rid="B33" ref-type="bibr">Simon et al., 2018</xref>; <xref rid="B28" ref-type="bibr">Radomski et al., 2019</xref>), an allele threshold of 10 is considered suitable for an initial clustering (<xref rid="B1" ref-type="bibr">Besser et al., 2019</xref>; <xref rid="B34" ref-type="bibr">Uelze et al., 2021</xref>). For comparability with cgMLST clustering results, an SNP threshold of 17 was chosen (see section “Comparison With National Center for Biotechnology Information Pathogen Single-Nucleotide Polymorphism Results” for details), which is in agreement with <xref rid="B24" ref-type="bibr">Pightling et al. (2018)</xref>. If the pairwise distance was below or above the threshold for both methods under comparison, it was considered as true positive (TP) or true negative (TN), respectively. If the pairwise distance was below the threshold for only one of the methods under comparison, it was considered as false positives (FPs) (method 1) or false negatives (FNs) (method 2) (see also <xref ref-type="fig" rid="F3">Figure 3</xref>). From the TP, TN, FN, and FP values, the corresponding values for specificity and sensitivity were derived.</p>
      </sec>
      <sec id="S2.SS3.SSS3">
        <title>Comparison of Clustering</title>
        <p>The distance matrices resulting from each method were hierarchically clustered and divided into clusters addresses using the thresholds described above. Direction-dependent concordance of clustering, expressed by the adjusted Wallace coefficient, was calculated with the Comparing Partitions online tool available at <ext-link ext-link-type="uri" xlink:href="http://www.comparingpartitions.info">http://www.comparingpartitions.info</ext-link> (<xref rid="B2" ref-type="bibr">Carriço et al., 2006</xref>). The adjusted Wallace coefficient allows the direct interpretation of clustering results, ensuring that an agreement is not caused by chance (<xref rid="B25" ref-type="bibr">Pinto et al., 2008</xref>; <xref rid="B31" ref-type="bibr">Severiano et al., 2011</xref>). The same resource also enables the computation of the adjusted Rand index, which allows the estimation of the global congruence of two typing approaches (<xref rid="B13" ref-type="bibr">Hubert and Arabie, 1985</xref>).</p>
      </sec>
    </sec>
  </sec>
  <sec id="S3">
    <title>Results</title>
    <sec id="S3.SS1">
      <title><italic>ChewieSnake</italic> Workflow</title>
      <p>We developed <italic>chewieSnake</italic>, an end-to-end analysis workflow for allele calling, allele profile clustering, and computation of a minimum-spanning tree (see <xref ref-type="fig" rid="F1">Figure 1</xref>). Its core components rely on a number of state-of-the-art bioinformatic tools including chewBBACA and GrapeTree. Central to the workflow is the concept of allele hashes that allow a nomenclature-free comparison of allele profiles.</p>
      <p>From the user perspective, <italic>chewieSnake</italic> provides an intuitive and simple-to-use workflow that orchestrates all necessary steps from a set of reads or assemblies to a highly informative, interactive cgMLST report displaying sample relatedness and their phylogeny.</p>
      <p>Thus, <italic>chewieSnake</italic> enables scientists without profound bioinformatic background to perform a set of complex tasks for a reproducible high-throughput analysis that can be readily applied in outbreak investigations.</p>
      <p>Moreover, <italic>chewieSnake</italic>’s built-in hashing algorithm includes the possibility to directly compare allele data generated independently, for instance, on different sites. In particular, the <italic>chewieSnake_join</italic> workflow provides a straightforward and easy-to-implement method for a distributed outbreak investigation system. The workflow provides users with highly informative HTML reports, which allow the quick identification of shared clusters between laboratories, the definition of a common cluster nomenclature, and detailed reports for each identified cluster (see <xref ref-type="fig" rid="F2">Figure 2</xref>).</p>
      <p>The <italic>chewieSnake</italic> workflow and program codes are fully open-source and can be obtained from <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/bfr_bioinformatics/chewieSnake">https://gitlab.com/bfr_bioinformatics/chewieSnake</ext-link>. Details on the workflow components are given in section “Implementation and Availability.”</p>
    </sec>
    <sec id="S3.SS2">
      <title>Workflow Validation</title>
      <sec id="S3.SS2.SSS1">
        <title>Summary of <italic>ChewieSnake</italic> Analysis</title>
        <p>The dataset contains WGS data of 1,263 sequenced <italic>S. enterica</italic> isolates from BioProject <ext-link ext-link-type="DDBJ/EMBL/GenBank" xlink:href="PRJEB31846">PRJEB31846</ext-link>. All samples could be analyzed with <italic>chewieSnake</italic>, and sufficient loci for cgMLST analysis were found. On average, 97.8% of the loci were found, and an allele sequence could be identified. More than 95% of all loci were found for all but two samples. The sample with the least fraction featured 94.3% of all loci, corresponding to 170 missing loci. Therefore, sufficient targets/loci for cgMLST analysis could be found for all samples.</p>
        <p>Overall, we detected 33,387 novel alleles not previously known to the cgMLST scheme. For each sample, we found 26.4 novel alleles on average, with only 17% of the samples containing no novel allele. Furthermore, novel alleles were evenly found at the beginning and end of the experiment, showing no signs of saturation (see <xref ref-type="supplementary-material" rid="FS3">Supplementary Figure 3</xref>). Thus, finding novel alleles is very common, and properly treating these alleles is key for a comparable data analysis (see also <xref ref-type="supplementary-material" rid="FS4">Supplementary Figure 4</xref>).</p>
        <p>For a distance cutoff of 10, we found that the data separate into 170 different clusters containing at least two samples. A total of 439 samples did not cluster within the threshold (orphan samples) (see also <xref ref-type="supplementary-material" rid="FS2">Supplementary Figure 2</xref>).</p>
      </sec>
      <sec id="S3.SS2.SSS2">
        <title>Repeatability of Analysis</title>
        <p>We repeated the entire analysis using the original, unaltered Enterobase scheme, i.e., by running <italic>chewieSnake</italic> on the same dataset again. Overall, we found large repeatability. The same novel alleles were identified in both datasets and assigned the identical allele hashes. Thus, an identical allele sequence consistently leads to an identical allele hash. Moreover, the same number of clusters was detected.</p>
        <p>However, in some cases, minor allele differences were found. Among the epidemiologically relevant sample pairs with distances below 20 AD, 2% of the sample pairs differed by 1 AD. The reason for these differences lies in the different order of execution of the sample allele calling (which is not pre-determined by Snakemake but randomly assigned on each execution) and the treatment of novel alleles by chewBBACA. The strict BLASTP step in chewBBACA might discard novel alleles, while the allele might be counted as an exact match if the allele sequence is already known to the database. If a sample featured a missing locus in the first analysis, but in the second analysis an allele difference was found on this locus, the allele difference would be reduced by 1 in the first analysis compared with the second. Indeed, 720 and 562 loci were missing in only one of the analyses, but not both.</p>
        <p>The <xref ref-type="supplementary-material" rid="SM2">Supplementary File 1</xref> provides a more detailed analysis of the dataset. The analysis of the dataset is summarized in the cgmlst report <ext-link ext-link-type="uri" xlink:href="https://bfr_bioinformatics.gitlab.io/chewiesnake_publicationdata/chewiesnake/cgmlst_report.html">https://bfr_bioinformatics.gitlab.io/chewiesnake_publicationdata/chewiesnake/cgmlst_report.html</ext-link>.</p>
      </sec>
      <sec id="S3.SS2.SSS3">
        <title>Comparison With Enterobase</title>
        <p>The comparison between all sample combinations reveals a very high concordance between Enterobase and <italic>chewieSnake</italic> ADs with a Spearman correlation of 0.984 (see <xref ref-type="fig" rid="F3">Figure 3A</xref>). Most distances are found at or near a line with slope 1 (a linear regression reveals a slope of 1.02). This extends also to high ADs (see <xref ref-type="supplementary-material" rid="FS5">Supplementary Figure 5</xref>). A histogram of the method differences of epidemiologically relevant sample pairs (i.e., within 30 AD) reveals that distances mostly differ by one or two alleles only, with a mean of non-zero method differences of 1.8 AD. We also found a tendency of higher distances in Enterobase (see also <xref ref-type="supplementary-material" rid="FS6">Supplementary Figure 6</xref>).</p>
        <p>When performing a threshold analysis at 10 AD, sample pairs are found with 0.96 sensitivity and 0.99 specificity within or outside the same distance threshold (amounting to an accuracy of 0.99). Moreover, a closer look at the FPs and FNs reveals that the misclassified samples differ by a few (mostly one or two) allele differences only. Thus, these apparent misclassifications result from the assumption of a fixed threshold. The maximum AD in Enterobase for a sample pair within 10 AD in <italic>chewieSnake</italic> cluster was 15, and the average of all putatively misclassified pairs in Enterobase was 11.8.</p>
        <p>When hierarchically clustering the distance matrix obtained by both methods, the (direction-dependent) adjusted Wallace coefficient was 0.955 and 0.975 (see <xref rid="T1" ref-type="table">Table 1</xref>). The adjusted Rand index also reveals a high method congruence (see <xref rid="T2" ref-type="table">Table 2</xref>).</p>
        <table-wrap id="T1" position="float">
          <label>TABLE 1</label>
          <caption>
            <p>(Direction-dependent) adjusted Wallace coefficient for all method comparisons.</p>
          </caption>
          <table frame="hsides" rules="groups" cellspacing="5" cellpadding="5">
            <thead>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1"/>
                <td valign="top" align="center" rowspan="1" colspan="1">
                  <italic>chewieSnake</italic>
                </td>
                <td valign="top" align="center" rowspan="1" colspan="1">
                  <italic>chewieSnake_join</italic>
                </td>
                <td valign="top" align="center" rowspan="1" colspan="1">Enterobase</td>
                <td valign="top" align="center" rowspan="1" colspan="1">NCBI pathogen</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">
                  <italic>chewieSnake</italic>
                </td>
                <td valign="top" align="center" rowspan="1" colspan="1">1</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.992</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.955</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.922</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">
                  <italic>chewieSnake_join</italic>
                </td>
                <td valign="top" align="center" rowspan="1" colspan="1">1.000</td>
                <td valign="top" align="center" rowspan="1" colspan="1">1</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.964</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.931</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">Enterobase</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.975</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.975</td>
                <td valign="top" align="center" rowspan="1" colspan="1">1</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.935</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">NCBI pathogen</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.968</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.968</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.964</td>
                <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <attrib>
              <italic>For each method, the distance matrix was hierarchically clustered using single-linkage trees. The clustering is based on a cluster threshold of 10 for the cgMLST methods and of 17 for the SNP method (NCBI). SNP, single-nucleotide polymorphism; NCBI, National Center for Biotechnology Information.</italic>
            </attrib>
          </table-wrap-foot>
        </table-wrap>
        <table-wrap id="T2" position="float">
          <label>TABLE 2</label>
          <caption>
            <p>Discriminatory power according to adjusted Rand index.</p>
          </caption>
          <table frame="hsides" rules="groups" cellspacing="5" cellpadding="5">
            <thead>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1"/>
                <td valign="top" align="center" rowspan="1" colspan="1">
                  <italic>chewieSnake</italic>
                </td>
                <td valign="top" align="center" rowspan="1" colspan="1">
                  <italic>chewieSnake_join</italic>
                </td>
                <td valign="top" align="center" rowspan="1" colspan="1">Enterobase</td>
                <td valign="top" align="center" rowspan="1" colspan="1">NCBI pathogen</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">
                  <italic>chewieSnake</italic>
                </td>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
                <td valign="top" align="justify" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">
                  <italic>chewieSnake_join</italic>
                </td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.996</td>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
                <td valign="top" align="justify" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">Enterobase</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.965</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.969</td>
                <td rowspan="1" colspan="1"/>
                <td valign="top" align="justify" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">NCBI pathogen</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.944</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.949</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.949</td>
                <td valign="top" align="justify" rowspan="1" colspan="1"/>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <attrib>
              <italic>All methods show very high discriminatory power, above &gt;0.94. Noteworthy is that <italic>chewieSnake</italic> and <italic>chewieSnake_join</italic> have a nearly perfect accordance. NCBI, National Center for Biotechnology Information.</italic>
            </attrib>
          </table-wrap-foot>
        </table-wrap>
        <p>It is important to note that very similar conclusions can be drawn from different allele thresholds. Evidently, method differences by one or two alleles have a larger impact on clusters determined at lower compared with larger distance thresholds. Thus, a very low threshold may lead to a decrease in the cluster congruence. However, fixed thresholds are most relevant for linking samples to outbreak clusters, while for a closer analysis of the phylogeny, the exact tree topology is more useful.</p>
      </sec>
      <sec id="S3.SS2.SSS4">
        <title>Comparison With National Center for Biotechnology Information Pathogen Single-Nucleotide Polymorphism Results</title>
        <p>Overall, there is a linear relationship between SNP and AD (see <xref ref-type="fig" rid="F3">Figure 3B</xref>). A linear model fit reveals that statistically 1 AD corresponds to 1.73 SNP differences. The Spearman correlation reads 0.973. This suggests that samples within an AD of 10 should have an SNP distance of smaller or equal to 17 (definition of TPs). A threshold analysis shows a concordant clustering decision of 95% between cgMLST and SNP analysis (sensitivity—all points in the lower left quadrant in <xref ref-type="fig" rid="F3">Figure 3B</xref>). Similarly, both methods agree on assigning a sample pair in 96% of all cases not to be part of a cluster (see <xref ref-type="fig" rid="F3">Figure 3B</xref>).</p>
        <p>We hierarchically clustered the distance matrices from both methods (cgMLST and SNP.) The resulting (direction-dependent) adjusted Wallace coefficient was 0.922 and 0.968, respectively (see <xref rid="T1" ref-type="table">Table 1</xref>). In addition, the adjusted Rand index reveals a high method congruence (see <xref rid="T2" ref-type="table">Table 2</xref>). Again, similar conclusions can also be drawn from different allele and SNP thresholds.</p>
        <p>At small distances, i.e., well below the applied threshold, SNP and ADs are more scattered than between the cgMLST approaches. Thus, although samples can be concordantly associated with outbreak clusters, the detailed phylogeny may differ. This is, however, not surprising given the very different nature of SNP and cgMLST approaches.</p>
        <p><xref rid="T1" ref-type="table">Table 1</xref> also yields the congruence between the reference methods Enterobase and NCBI pathogen. It shows that the adjusted Wallace coefficient between <italic>chewieSnake</italic> and the reference methods was even higher than the congruence among the reference methods.</p>
      </sec>
      <sec id="S3.SS2.SSS5">
        <title>Simulated Decentralized cgMLST Analysis</title>
        <p>The concordance between the <italic>chewieSnake</italic> analysis on the entire dataset (centralized approach, see above) and a simulated decentralized <italic>chewieSnake_join</italic> analysis has been evaluated. For the latter, the original dataset was randomly divided into three equally sized, non-overlapping subsets, analyzed individually with <italic>chewieSnake</italic> and joined subsequently with <italic>chewieSnake_join</italic> (see section “Methods”).</p>
        <p>The ADs obtained from centrally and decentrally analyzed samples are nearly identical—the Spearman correlation is 1 (0.9999997). <xref rid="T3" ref-type="table">Table 3</xref> shows that at almost all thresholds with the same number of clusters were identified (the only exception was 160 vs. 159 distinct clusters at 5 AD). Furthermore, almost all sample pairs fall into the same 10 AD cluster, amounting to over 99.9% sensitivity and specificity. In the three exceptions, the sample pairs had 10 AD and 11 AD, respectively, not leading to a different epidemiological interpretation. The (direction-dependent) adjusted Wallace coefficient was 0.992 and 1.000, respectively (see <xref rid="T1" ref-type="table">Table 1</xref>). The adjusted Rand index reads 0.996 as well, demonstrating that centralized and decentralized allele calling is fully compatible (see <xref rid="T2" ref-type="table">Table 2</xref>).</p>
        <table-wrap id="T3" position="float">
          <label>TABLE 3</label>
          <caption>
            <p>Cluster counts for <italic>chewieSnake</italic> and simulated <italic>chewieSnake_join</italic> analysis.</p>
          </caption>
          <table frame="hsides" rules="groups" cellspacing="5" cellpadding="5">
            <thead>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1"/>
                <td valign="top" align="center" rowspan="1" colspan="1">1,000</td>
                <td valign="top" align="center" rowspan="1" colspan="1">200</td>
                <td valign="top" align="center" rowspan="1" colspan="1">100</td>
                <td valign="top" align="center" rowspan="1" colspan="1">50</td>
                <td valign="top" align="center" rowspan="1" colspan="1">20</td>
                <td valign="top" align="center" rowspan="1" colspan="1">10</td>
                <td valign="top" align="center" rowspan="1" colspan="1">5</td>
                <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">
                  <italic>chewieSnake</italic>
                </td>
                <td valign="top" align="center" rowspan="1" colspan="1">50</td>
                <td valign="top" align="center" rowspan="1" colspan="1">71</td>
                <td valign="top" align="center" rowspan="1" colspan="1">83</td>
                <td valign="top" align="center" rowspan="1" colspan="1">97</td>
                <td valign="top" align="center" rowspan="1" colspan="1">150</td>
                <td valign="top" align="center" rowspan="1" colspan="1">170</td>
                <td valign="top" align="center" rowspan="1" colspan="1">159</td>
                <td valign="top" align="center" rowspan="1" colspan="1">102</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">
                  <italic>chewieSnake_join</italic>
                </td>
                <td valign="top" align="center" rowspan="1" colspan="1">50</td>
                <td valign="top" align="center" rowspan="1" colspan="1">71</td>
                <td valign="top" align="center" rowspan="1" colspan="1">83</td>
                <td valign="top" align="center" rowspan="1" colspan="1">97</td>
                <td valign="top" align="center" rowspan="1" colspan="1">150</td>
                <td valign="top" align="center" rowspan="1" colspan="1">170</td>
                <td valign="top" align="center" rowspan="1" colspan="1">160</td>
                <td valign="top" align="center" rowspan="1" colspan="1">102</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <attrib>
              <italic>The number of identified clusters agrees at all different thresholds with a single difference for CT_5.</italic>
            </attrib>
          </table-wrap-foot>
        </table-wrap>
        <p>The origin of the detected small differences was found to be the same, as discussed in the repeatability analysis of the <italic>chewieSnake</italic> analysis (see above). Importantly, the allele calling always leads to the same allele sequence and hence the same allele hash. Instead, the differences are due to the different execution order of the samples’ allele calling, which impacts the discovery of novel alleles and exclusion of loci in chewBBACA. Potential allele differences between a sample pair may be masked when in one sample the locus was classified for instance as a <italic>non-informative paralogous hit</italic>. This classification is, however, subject to whether the allele was already known to the scheme prior to the allele calling. For the present dataset, 246 loci in samples in the centralized dataset and 191 loci in samples in the decentralized dataset were discarded as paralogues. Additionally, eight loci were discarded as being too close to a contig border. Hence, subtle but epidemiologically negligible differences may occur due to the different order of samples during the allele calling step of chewBBACA.</p>
      </sec>
    </sec>
  </sec>
  <sec id="S4">
    <title>Discussion</title>
    <p>In this study, we demonstrated the broad utility and validity of our newly developed end-to-end cgMLST analysis workflow. The method successfully determines clusters fully unsupervised without the need of user intervention. The proposed approach works both for a centralized data analysis, as well for a decentralized analysis followed by central clustering. This is a unique feature of the implemented allele hashing algorithm. Thus, the research community benefits from a versatile, easy-to-use tool that can be readily applied for molecular surveillance. It shall be noted that the presented method is readily applicable to all taxa where a suitable cgMLST scheme is available.</p>
    <p>In comparison with existing approaches, for example, Ridom SeqSphere+ (with <ext-link ext-link-type="uri" xlink:href="http://cgMLST.org">cgMLST.org</ext-link>) or the very recent contribution chewieNS (<xref rid="B22" ref-type="bibr">Mamede et al., 2020</xref>), <italic>chewieSnake</italic> does not rely on a central allele nomenclature. In the case of chewieNS, chewBBACA is also implemented as the underlying allele calling software and thus is prone to the same distinction between exactly determined and newly inferred alleles. The chewieNS approach functions without an allele hashing step on the user side, but as a downside, it introduces the requirement to synchronize the scheme prior to every allele calling. The synchronization is critical for ensuring comparable allele numbers and might be challenging in outbreak situations, when suspected samples may be sequenced and analyzed at different sites at the same time. Nonetheless, if a nomenclature-based solution has been used to create allele profiles at different sites, the <italic>chewieSnake_join</italic> workflow can be used for merging of the allele results and a joint cluster interpretation. Also, the concept of allele hashing could be directly incorporated in the allele calling software, e.g., in future upgrades of chewBBACA.</p>
    <p>As pointed out above, the discovered remaining differences between central and decentralized approaches are not related to the hashing algorithm but rather to unique features of the underlying chewBBACA software. These issues could therefore only be remedied by substantial changes to the chewBBACA allele calling algorithms. However, as discussed previously, the effect on cluster detection is negligible.</p>
    <p>Results of <italic>chewieSnake</italic> are in strong agreement with Enterobase, although both approaches differ substantially regarding their implementation. This might be somewhat expected given that both methods rely on the same cgMLST scheme. Our analyses revealed that distances in Enterobase tend to be larger, which are mainly caused by the greater number of loci available in Enterobase. Due to the CDS prediction step in chewBBACA, fewer loci are accessible in <italic>chewieSnake</italic>, leading to a smaller effective scheme size in the latter.</p>
    <p>The accuracy for correct cluster detection was furthermore confirmed by comparison with an independent complementary method—SNP calling from NCBI pathogen detection. Overall, we found a very high consistency. As anticipated, ADs and SNP distances are not fully comparable. On the one hand, an allele pair might differ by more than one SNP—thus, the AD underestimates the SNP distance. On the other hand, allele differences might originate from other mutation events such as indels (insertions and deletions) and are therefore not characterized as an SNP. In the latter, allele difference might also overestimate the SNP distance. Nonetheless, the large concordance between SNP and cgMLST results also boosts confidence for the epidemiological assessment.</p>
    <p>Alternatives to self-hosted and open-source cgMLST analysis workflows such as <italic>chewieSnake</italic> are central analysis systems such as Enterobase (<xref rid="B39" ref-type="bibr">Zhou et al., 2020a</xref>) (or also NCBI pathogen detection (see text footnote 1), INNUENDO (<xref rid="B18" ref-type="bibr">Llarena et al., 2018</xref>), etc.]. Among the advantages are greater standardization, more rigid control of parameters, and a larger data pool [e.g., NCBI pathogen and Enterobase incorporate all data from NCBI sequence read archive (SRA)]. Conversely, these approaches limit flexibility in terms of changing parameters and selecting a scheme and a species of choice. Also, <italic>chewieSnake</italic> and in particular its decentralized feature might render it more easy to share data and results when data confidentiality concerns apply. Furthermore, given that the amount of data present in public repositories (and consequently their computational needs) grow exponentially, <italic>chewieSnake</italic> is our approach to envision future tractability in terms of lean computing and storage resources by decentralizing and outsourcing the core analysis steps to the data providers.</p>
    <p>In addition to the presented novel methods, the detailed analysis and contributed data provide an excellent dataset for the validation of further methods (and parameters/schemes). For this aim, one simply needs to compute a distance matrix and either compare the pairwise distances or cluster the distance matrix to a desired threshold for the imputation of relevant metrics such as the adjusted Wallace coefficient (see a more detailed sketch in the <xref ref-type="supplementary-material" rid="SM2">Supplementary Data sheet 2</xref> and the provided scripts). It is worth noting that the validation approach of this contribution is also in agreement with the forthcoming ISO 23418 titled “Whole genome sequencing for typing and genomic characterization of foodborne bacteria—General requirements and guidance (<xref rid="B15" ref-type="bibr">ISO/DIS 23418, 2020</xref>)” for validation of bioinformatic software, in particular by validating with publicly accessible data and methods. However, the present analysis also indicates that further harmonization of bioinformatic approaches is needed (<xref rid="B16" ref-type="bibr">Jagadeesan et al., 2019</xref>; <xref rid="B4" ref-type="bibr">Coipan et al., 2020</xref>). In the cases where this is not possible (e.g., cgMLST vs. SNP), the expected differences in the epidemiological interpretation from different methods need to be further discussed within the research community.</p>
  </sec>
  <sec sec-type="data-availability" id="S5">
    <title>Data Availability Statement</title>
    <p>The developed software can be found in <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/bfr_bioinformatics/chewieSnake">https://gitlab.com/bfr_bioinformatics/chewieSnake</ext-link>, as well as in bioconda and Docker Hub (<ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/bfrbioinformatics/chewiesnake">https://hub.docker.com/r/bfrbioinformatics/chewiesnake</ext-link>). The raw data analyzed for this study can be found in BioProject <ext-link ext-link-type="DDBJ/EMBL/GenBank" xlink:href="PRJEB31846">PRJEB31846</ext-link>. The assembled genome data can be found under <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4338293">https://zenodo.org/record/4338293</ext-link> and the used cgMLST scheme under <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4724927">https://zenodo.org/record/4724927</ext-link>. The workflows’ analyses can be found in <ext-link ext-link-type="uri" xlink:href="https://bfr_bioinformatics.gitlab.io/chewiesnake_publicationdata">https://bfr_bioinformatics.gitlab.io/chewiesnake_publicationdata</ext-link>. All further relevant data for reproducing the results can be found in the <xref ref-type="supplementary-material" rid="SM1">Supplementary Data Sheets 1</xref>, <xref ref-type="supplementary-material" rid="SM2">2</xref>.</p>
  </sec>
  <sec id="S6">
    <title>Author Contributions</title>
    <p>CD, LU, ST, and BM designed the project. CD wrote the software with support from HB and ST. CD, LU, and ST conducted the analysis. All authors wrote and approved the manuscript.</p>
  </sec>
  <sec sec-type="COI-statement" id="conf1">
    <title>Conflict of Interest</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding.</bold> The BfR has received financial support from the Federal Government for LU on the basis of a resolution of the German Bundestag and funded by the Ministry of Health within the framework of the project Integrated Genome-Based Surveillance of <italic>Salmonella</italic> (GenoSalmSurv), decision ZMVI1-2518FSB709 of November 26, 2018. HB was funded by the BeONE project within the One Health European Joint Programme (OHEJP) (JRP27-R2-FBZ-BeONE).</p>
    </fn>
  </fn-group>
  <ack>
    <p>We are grateful for the continuous collaboration with the German Federal State laboratories, which provided us with the <italic>Salmonella</italic> isolates for sequencing. We are thankful to the Binfis from the 4th Microbial Bioinformatics Hackathon where the hashing concept was discussed. We also thank the project partners from the GenoSalmSurv project for continuous testing and feedback.</p>
  </ack>
  <fn-group>
    <fn id="footnote1">
      <label>1</label>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pathogens/">https://www.ncbi.nlm.nih.gov/pathogens/</ext-link>
      </p>
    </fn>
    <fn id="footnote2">
      <label>2</label>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://achtman-lab.github.io/GrapeTree/MSTree_holder.html">https://achtman-lab.github.io/GrapeTree/MSTree_holder.html</ext-link>
      </p>
    </fn>
    <fn id="footnote3">
      <label>3</label>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://online.phyloviz.net/index">https://online.phyloviz.net/index</ext-link>
      </p>
    </fn>
    <fn id="footnote4">
      <label>4</label>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://enterobase.warwick.ac.uk/">https://enterobase.warwick.ac.uk/</ext-link>
      </p>
    </fn>
    <fn id="footnote5">
      <label>5</label>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://bigsdb.pasteur.fr/">https://bigsdb.pasteur.fr/</ext-link>
      </p>
    </fn>
    <fn id="footnote6">
      <label>6</label>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://www.cgmlst.org/ncs">https://www.cgmlst.org/ncs</ext-link>
      </p>
    </fn>
    <fn id="footnote7">
      <label>7</label>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://chewbbaca.online/">https://chewbbaca.online/</ext-link>
      </p>
    </fn>
    <fn id="footnote8">
      <label>8</label>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://www.ridom.de/seqsphere/">https://www.ridom.de/seqsphere/</ext-link>
      </p>
    </fn>
    <fn id="footnote9">
      <label>9</label>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://www.applied-maths.com/applications/wgmlst">https://www.applied-maths.com/applications/wgmlst</ext-link>
      </p>
    </fn>
    <fn id="footnote10">
      <label>10</label>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/bfr_bioinformatics/chewieSnake">https://gitlab.com/bfr_bioinformatics/chewieSnake</ext-link>
      </p>
    </fn>
    <fn id="footnote11">
      <label>11</label>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://github.com/tseemann/shovill">https://github.com/tseemann/shovill</ext-link>
      </p>
    </fn>
    <fn id="footnote12">
      <label>12</label>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/bfr_bioinformatics/AQUAMIS">https://gitlab.com/bfr_bioinformatics/AQUAMIS</ext-link>
      </p>
    </fn>
    <fn id="footnote13">
      <label>13</label>
      <p>
        <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nlm.nih.gov/pathogen/Results/Salmonella/">ftp://ftp.ncbi.nlm.nih.gov/pathogen/Results/Salmonella/</ext-link>
      </p>
    </fn>
  </fn-group>
  <sec id="S9" sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link ext-link-type="uri" xlink:href="https://www.frontiersin.org/articles/10.3389/fmicb.2021.649517/full#supplementary-material">https://www.frontiersin.org/articles/10.3389/fmicb.2021.649517/full#supplementary-material</ext-link></p>
    <supplementary-material content-type="local-data" id="SM1">
      <media xlink:href="Data_Sheet_1.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SM2">
      <media xlink:href="Data_Sheet_2.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="FS1">
      <media xlink:href="Image_1.PDF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="FS2">
      <media xlink:href="Image_2.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="FS3">
      <media xlink:href="Image_3.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="FS4">
      <media xlink:href="Image_4.PDF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="FS5">
      <media xlink:href="Image_5.PDF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="FS6">
      <media xlink:href="Image_6.PDF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Besser</surname><given-names>J. M.</given-names></name><name><surname>Carleton</surname><given-names>H. A.</given-names></name><name><surname>Trees</surname><given-names>E.</given-names></name><name><surname>Stroika</surname><given-names>S. G.</given-names></name><name><surname>Hise</surname><given-names>K.</given-names></name><name><surname>Wise</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2019</year>). <article-title>Interpretation of whole-genome sequencing for enteric disease surveillance and outbreak investigation.</article-title>
<source><italic>Foodborne Pathog. Dis.</italic></source>
<volume>16</volume>
<fpage>504</fpage>–<lpage>512</lpage>. <pub-id pub-id-type="doi">10.1089/fpd.2019.2650</pub-id>
<?supplied-pmid 31246502?><pub-id pub-id-type="pmid">31246502</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carriço</surname><given-names>J. A.</given-names></name><name><surname>Silva-Costa</surname><given-names>C.</given-names></name><name><surname>Melo-Cristino</surname><given-names>J.</given-names></name><name><surname>Pinto</surname><given-names>F. R.</given-names></name><name><surname>de Lencastre</surname><given-names>H.</given-names></name><name><surname>Almeida</surname><given-names>J. S.</given-names></name><etal/></person-group> (<year>2006</year>). <article-title>Illustration of a common framework for relating multiple typing methods by application to macrolide-resistant <italic>Streptococcus pyogenes</italic>.</article-title>
<source><italic>J. Clin. Microbiol.</italic></source>
<volume>44</volume>
<fpage>2524</fpage>–<lpage>2532</lpage>. <pub-id pub-id-type="doi">10.1128/jcm.02536-05</pub-id>
<?supplied-pmid 16825375?><pub-id pub-id-type="pmid">16825375</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>S.</given-names></name><name><surname>Zhou</surname><given-names>Y.</given-names></name><name><surname>Chen</surname><given-names>Y.</given-names></name><name><surname>Gu</surname><given-names>J.</given-names></name></person-group> (<year>2018</year>). <article-title>fastp: an ultra-fast all-in-one FASTQ preprocessor.</article-title>
<source><italic>Bioinformatics</italic></source>
<volume>34</volume>
<fpage>i884</fpage>–<lpage>i890</lpage>.<pub-id pub-id-type="pmid">30423086</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coipan</surname><given-names>C. E.</given-names></name><name><surname>Dallman</surname><given-names>T. J.</given-names></name><name><surname>Brown</surname><given-names>D.</given-names></name><name><surname>Hartman</surname><given-names>H.</given-names></name><name><surname>van der Voort</surname><given-names>M.</given-names></name><name><surname>van den Berg</surname><given-names>R. R.</given-names></name><etal/></person-group> (<year>2020</year>). <article-title>Concordance of SNP- and allele-based typing workflows in the context of a large-scale international <italic>Salmonella</italic> Enteritidis outbreak investigation.</article-title>
<source><italic>Microb. Genom.</italic></source>
<volume>26</volume>:<issue>e000318</issue>. <pub-id pub-id-type="doi">10.1099/mgen.0.000318</pub-id>
<?supplied-pmid 32101514?><pub-id pub-id-type="pmid">32101514</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dallman</surname><given-names>T.</given-names></name><name><surname>Ashton</surname><given-names>P.</given-names></name><name><surname>Schafer</surname><given-names>U.</given-names></name><name><surname>Jironkin</surname><given-names>A.</given-names></name><name><surname>Painset</surname><given-names>A.</given-names></name><name><surname>Shaaban</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>SnapperDB: a database solution for routine sequencing analysis of bacterial isolates.</article-title>
<source><italic>Bioinformatics</italic></source>
<volume>34</volume>
<fpage>3028</fpage>–<lpage>3029</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty212</pub-id>
<?supplied-pmid 29659710?><pub-id pub-id-type="pmid">29659710</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deneke</surname><given-names>C.</given-names></name><name><surname>Brendebach</surname><given-names>H.</given-names></name><name><surname>Uelze</surname><given-names>L.</given-names></name><name><surname>Borowiak</surname><given-names>M.</given-names></name><name><surname>Malorny</surname><given-names>B.</given-names></name><name><surname>Tausch</surname><given-names>S. H.</given-names></name></person-group> (<year>2021</year>). <article-title>Species-specific quality control, assembly and contamination detection in microbial isolate sequences with AQUAMIS.</article-title>
<source><italic>Genes</italic></source>
<volume>12</volume>:<issue>644</issue>. <pub-id pub-id-type="doi">10.3390/genes12050644</pub-id>
<?supplied-pmid 33926025?><pub-id pub-id-type="pmid">33926025</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eyre</surname><given-names>D. W.</given-names></name><name><surname>Peto</surname><given-names>T. E. A.</given-names></name><name><surname>Crook</surname><given-names>D. W.</given-names></name><name><surname>Walker</surname><given-names>A. S.</given-names></name><name><surname>Wilcox</surname><given-names>M. H.</given-names></name></person-group> (<year>2019</year>). <article-title>Hash-based core genome multilocus sequence typing for <italic>Clostridium difficile</italic>.</article-title>
<source><italic>J. Clin. Microbiol.</italic></source>
<volume>58</volume>:<issue>e001037-19</issue>.</mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feijao</surname><given-names>P.</given-names></name><name><surname>Yao</surname><given-names>H.-T.</given-names></name><name><surname>Fornika</surname><given-names>D.</given-names></name><name><surname>Gardy</surname><given-names>J.</given-names></name><name><surname>Hsiao</surname><given-names>W.</given-names></name><name><surname>Chauve</surname><given-names>C.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>MentaLiST - a fast MLST caller for large MLST schemes.</article-title>
<source><italic>Microb. Genom.</italic></source>
<volume>4</volume>:<issue>e000146</issue>.</mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Francisco</surname><given-names>A. P.</given-names></name><name><surname>Vaz</surname><given-names>C.</given-names></name><name><surname>Monteiro</surname><given-names>P. T.</given-names></name><name><surname>Melo-Cristino</surname><given-names>J.</given-names></name><name><surname>Ramirez</surname><given-names>M.</given-names></name><name><surname>Carriço</surname><given-names>J. A.</given-names></name></person-group> (<year>2012</year>). <article-title>PHYLOViZ: phylogenetic inference and data visualization for sequence based typing methods.</article-title>
<source><italic>BMC Bioinform.</italic></source>
<volume>13</volume>:<issue>87</issue>. <pub-id pub-id-type="doi">10.1186/1471-2105-13-87</pub-id>
<?supplied-pmid 22568821?><pub-id pub-id-type="pmid">22568821</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franz</surname><given-names>E.</given-names></name><name><surname>Gras</surname><given-names>L. M.</given-names></name><name><surname>Dallman</surname><given-names>T.</given-names></name></person-group> (<year>2016</year>). <article-title>Significance of whole genome sequencing for surveillance, source attribution and microbial risk assessment of foodborne pathogens.</article-title>
<source><italic>Curr. Opin. Food Sci.</italic></source>
<volume>8</volume>
<fpage>74</fpage>–<lpage>79</lpage>. <pub-id pub-id-type="doi">10.1016/j.cofs.2016.04.004</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Galili</surname><given-names>T.</given-names></name></person-group> (<year>2015</year>). <article-title>dendextend: an R package for visualizing, adjusting and comparing trees of hierarchical clustering.</article-title>
<source><italic>Bioinformatics</italic></source>
<volume>31</volume>
<fpage>3718</fpage>–<lpage>3720</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btv428</pub-id>
<?supplied-pmid 26209431?><pub-id pub-id-type="pmid">26209431</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grüning</surname><given-names>B.</given-names></name><name><surname>Dale</surname><given-names>R.</given-names></name><name><surname>Sjödin</surname><given-names>A.</given-names></name><name><surname>Chapman</surname><given-names>B. A.</given-names></name><name><surname>Rowe</surname><given-names>J.</given-names></name><name><surname>Tomkins-Tinch</surname><given-names>C. H.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>Bioconda: sustainable and comprehensive software distribution for the life sciences.</article-title>
<source><italic>Nat. Methods</italic></source>
<volume>15</volume>
<fpage>475</fpage>–<lpage>476</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-018-0046-7</pub-id>
<?supplied-pmid 29967506?><pub-id pub-id-type="pmid">29967506</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hubert</surname><given-names>L.</given-names></name><name><surname>Arabie</surname><given-names>P.</given-names></name></person-group> (<year>1985</year>). <article-title>Comparing partitions.</article-title>
<source><italic>J. Classif.</italic></source>
<volume>2</volume>
<fpage>193</fpage>–<lpage>218</lpage>. <pub-id pub-id-type="doi">10.1007/bf01908075</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hyatt</surname><given-names>D.</given-names></name><name><surname>Chen</surname><given-names>G.-L.</given-names></name><name><surname>LoCascio</surname><given-names>P. F.</given-names></name><name><surname>Land</surname><given-names>M. L.</given-names></name><name><surname>Larimer</surname><given-names>F. W.</given-names></name><name><surname>Hauser</surname><given-names>L. J.</given-names></name></person-group> (<year>2010</year>). <article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification.</article-title>
<source><italic>BMC Bioinform.</italic></source>
<volume>11</volume>:<issue>119</issue>. <pub-id pub-id-type="doi">10.1186/1471-2105-11-119</pub-id>
<?supplied-pmid 20211023?><pub-id pub-id-type="pmid">20211023</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="book"><collab>ISO/DIS 23418</collab> (<year>2020</year>). <source><italic>Microbiology of the Food Chain—Whole Genome Sequencing for Typing and Genomic Characterization of Foodborne Bacteria—General Requirements and Guidance, (German and English Version).</italic></source>
<publisher-loc>Geneva</publisher-loc>: <publisher-name>International Organization for Standardization.</publisher-name></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jagadeesan</surname><given-names>B.</given-names></name><name><surname>Gerner-Smidt</surname><given-names>P.</given-names></name><name><surname>Allard</surname><given-names>M. W.</given-names></name><name><surname>Leuillet</surname><given-names>S.</given-names></name><name><surname>Winkler</surname><given-names>A.</given-names></name><name><surname>Xiao</surname><given-names>Y.</given-names></name><etal/></person-group> (<year>2019</year>). <article-title>The use of next generation sequencing for improving food safety: translation into practice.</article-title>
<source><italic>Food Microbiol.</italic></source>
<volume>79</volume>
<fpage>96</fpage>–<lpage>115</lpage>. <pub-id pub-id-type="doi">10.1016/j.fm.2018.11.005</pub-id>
<?supplied-pmid 30621881?><pub-id pub-id-type="pmid">30621881</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koster</surname><given-names>J.</given-names></name><name><surname>Rahmann</surname><given-names>S.</given-names></name></person-group> (<year>2012</year>). <article-title>Snakemake - a scalable bioinformatics workflow engine.</article-title>
<source><italic>Bioinformatics</italic></source>
<volume>28</volume>
<fpage>2520</fpage>–<lpage>2522</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts480</pub-id>
<?supplied-pmid 22908215?><pub-id pub-id-type="pmid">22908215</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Llarena</surname><given-names>A.</given-names></name><name><surname>Ribeiro-Gonçalves</surname><given-names>B. F.</given-names></name><name><surname>Nuno Silva</surname><given-names>D.</given-names></name><name><surname>Halkilahti</surname><given-names>J.</given-names></name><name><surname>Machado</surname><given-names>M. P.</given-names></name><name><surname>Da Silva</surname><given-names>M. S.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>INNUENDO: a cross-sectoral platform for the integration of genomics in the surveillance of food-borne pathogens.</article-title>
<source><italic>EFSA Support Publ.</italic></source>
<volume>15</volume>:<issue>1498E</issue>. <pub-id pub-id-type="doi">10.2903/sp.efsa.2018.EN-1498</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lüth</surname><given-names>S.</given-names></name><name><surname>Deneke</surname><given-names>C.</given-names></name><name><surname>Kleta</surname><given-names>S.</given-names></name><name><surname>Al Dahouk</surname><given-names>S.</given-names></name></person-group> (<year>2020</year>). <article-title>Translatability of WGS typing results can simplify data exchange for surveillance and control of <italic>Listeria monocytogenes</italic>.</article-title>
<source><italic>Microb. Genom.</italic></source>
<volume>7</volume>:<issue>491</issue>. <pub-id pub-id-type="doi">10.1099/mgen.0.000491</pub-id>
<?supplied-pmid 33275089?><pub-id pub-id-type="pmid">33275089</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Macedo</surname><given-names>R.</given-names></name><name><surname>Pinto</surname><given-names>M.</given-names></name><name><surname>Borges</surname><given-names>V.</given-names></name><name><surname>Nunes</surname><given-names>A.</given-names></name><name><surname>Oliveira</surname><given-names>O.</given-names></name><name><surname>Portugal</surname><given-names>I.</given-names></name><etal/></person-group> (<year>2019</year>). <article-title>Evaluation of a gene-by-gene approach for prospective whole-genome sequencing-based surveillance of multidrug resistant <italic>Mycobacterium tuberculosis</italic>.</article-title>
<source><italic>Tuberculosis</italic></source>
<volume>115</volume>
<fpage>81</fpage>–<lpage>88</lpage>. <pub-id pub-id-type="doi">10.1016/j.tube.2019.02.006</pub-id>
<?supplied-pmid 30948181?><pub-id pub-id-type="pmid">30948181</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maiden</surname><given-names>M.</given-names></name><name><surname>van Rensburg</surname><given-names>M.</given-names></name><name><surname>Bray</surname><given-names>J.</given-names></name><name><surname>Earle</surname><given-names>S. G.</given-names></name><name><surname>Ford</surname><given-names>S. A.</given-names></name><name><surname>Jolley</surname><given-names>K. A.</given-names></name><etal/></person-group> (<year>2013</year>). <article-title>MLST revisited: the gene-by-gene approach to bacterial genomics.</article-title>
<source><italic>Nat. Rev. Microbiol.</italic></source>
<volume>11</volume>
<fpage>728</fpage>–<lpage>736</lpage>. <pub-id pub-id-type="doi">10.1038/nrmicro3093</pub-id>
<?supplied-pmid 23979428?><pub-id pub-id-type="pmid">23979428</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mamede</surname><given-names>R.</given-names></name><name><surname>Vila-Cerqueira</surname><given-names>P.</given-names></name><name><surname>Silva</surname><given-names>M.</given-names></name><name><surname>Carriço</surname><given-names>J. A.</given-names></name><name><surname>Ramirez</surname><given-names>M.</given-names></name></person-group> (<year>2020</year>). <article-title>Chewie Nomenclature Server (chewie-NS): a deployable nomenclature server for easy sharing of core and whole genome MLST schemas.</article-title>
<source><italic>Nucleic Acids Res.</italic></source>
<volume>49</volume>
<fpage>D660</fpage>–<lpage>D666</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkaa889</pub-id>
<?supplied-pmid 33068420?><pub-id pub-id-type="pmid">33068420</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Merkel</surname><given-names>D.</given-names></name></person-group> (<year>2014</year>). <article-title>Docker: lightweight Linux containers for consistent development and deployment.</article-title>
<source><italic>Linux J.</italic></source>
<volume>2</volume>:<issue>2</issue>.</mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pightling</surname><given-names>A. W.</given-names></name><name><surname>Pettengill</surname><given-names>J. B.</given-names></name><name><surname>Luo</surname><given-names>Y.</given-names></name><name><surname>Baugher</surname><given-names>J. D.</given-names></name><name><surname>Rand</surname><given-names>H.</given-names></name><name><surname>Strain</surname><given-names>E.</given-names></name></person-group> (<year>2018</year>). <article-title>Interpreting whole-genome sequence analyses of foodborne bacteria for regulatory applications and outbreak investigations.</article-title>
<source><italic>Front. Microbiol.</italic></source>
<volume>9</volume>:<issue>1482</issue>. <pub-id pub-id-type="doi">10.3389/fmicb.2018.01482</pub-id>
<?supplied-pmid 30042741?><pub-id pub-id-type="pmid">30042741</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pinto</surname><given-names>F. R.</given-names></name><name><surname>Melo-Cristino</surname><given-names>J.</given-names></name><name><surname>Ramirez</surname><given-names>M. A.</given-names></name></person-group> (<year>2008</year>). <article-title>Confidence interval for the wallace coefficient of concordance and its application to microbial typing methods.</article-title>
<source><italic>PLoS One</italic></source>
<volume>3</volume>:<issue>e3696</issue>. <pub-id pub-id-type="doi">10.1371/journal.pone.0003696</pub-id>
<?supplied-pmid 19002246?><pub-id pub-id-type="pmid">19002246</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pinto</surname><given-names>M.</given-names></name><name><surname>Borges</surname><given-names>V.</given-names></name><name><surname>Isidro</surname><given-names>J.</given-names></name><name><surname>Rodrigues</surname><given-names>J. C.</given-names></name><name><surname>Vieira</surname><given-names>L.</given-names></name><name><surname>Borrego</surname><given-names>M. J.</given-names></name><etal/></person-group> (<year>2020</year>). <article-title><italic>Neisseria gonorrhoeae</italic> clustering to reveal major European whole-genome-sequencing-based genogroups in association with antimicrobial resistance.</article-title>
<source><italic>Microb. Genom.</italic></source>
<volume>7</volume>:<issue>481</issue>. <pub-id pub-id-type="doi">10.1099/mgen.0.000481</pub-id>
<?supplied-pmid 33245688?><pub-id pub-id-type="pmid">33245688</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="book"><collab>R Core Team</collab> (<year>2013</year>). <source><italic>R: A Language and Environment for Statistical Computing.</italic></source>
<publisher-loc>Vienna</publisher-loc>: <publisher-name>R Foundation for Statistical Computing</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Radomski</surname><given-names>N.</given-names></name><name><surname>Cadel-Six</surname><given-names>S.</given-names></name><name><surname>Cherchame</surname><given-names>E.</given-names></name><name><surname>Felten</surname><given-names>A.</given-names></name><name><surname>Barbet</surname><given-names>P.</given-names></name><name><surname>Palma</surname><given-names>F.</given-names></name><etal/></person-group> (<year>2019</year>). <article-title>A simple and robust statistical method to define genetic relatedness of samples related to outbreaks at the genomic scale - application to retrospective <italic>Salmonella</italic> foodborne outbreak investigations.</article-title>
<source><italic>Front. Microbiol.</italic></source>
<volume>10</volume>:<issue>2413</issue>. <pub-id pub-id-type="doi">10.3389/fmicb.2019.02413</pub-id>
<?supplied-pmid 31708892?><pub-id pub-id-type="pmid">31708892</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal"><collab>rmarkdown</collab> (<year>2020</year>). <source><italic>Dynamic rmarkdown: Dynamic Documents for R. R package version 2.5..</italic></source> Available online at: <ext-link ext-link-type="uri" xlink:href="https://rmarkdown.rstudio.com">https://rmarkdown.rstudio.com</ext-link></mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ronholm</surname><given-names>J.</given-names></name><name><surname>Nasheri</surname><given-names>N.</given-names></name><name><surname>Petronella</surname><given-names>N.</given-names></name><name><surname>Pagotto</surname><given-names>F.</given-names></name></person-group> (<year>2016</year>). <article-title>Navigating microbiological food safety in the era of whole-genome sequencing.</article-title>
<source><italic>Clin. Microbiol. Rev.</italic></source>
<volume>29</volume>
<fpage>837</fpage>–<lpage>857</lpage>. <pub-id pub-id-type="doi">10.1128/cmr.00056-16</pub-id>
<?supplied-pmid 27559074?><pub-id pub-id-type="pmid">27559074</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Severiano</surname><given-names>A.</given-names></name><name><surname>Pinto</surname><given-names>F. R.</given-names></name><name><surname>Ramirez</surname><given-names>M.</given-names></name><name><surname>Carriço</surname><given-names>J. A.</given-names></name></person-group> (<year>2011</year>). <article-title>Adjusted wallace coefficient as a measure of congruence between typing methods.</article-title>
<source><italic>J. Clin. Microbiol.</italic></source>
<volume>49</volume>
<fpage>3997</fpage>–<lpage>4000</lpage>.<pub-id pub-id-type="pmid">21918028</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Silva</surname><given-names>M.</given-names></name><name><surname>Machado</surname><given-names>M. P.</given-names></name><name><surname>Silva</surname><given-names>D. N.</given-names></name><name><surname>Rossi</surname><given-names>M.</given-names></name><name><surname>Moran-Gilad</surname><given-names>J.</given-names></name><name><surname>Santos</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>chewBBACA: a complete suite for gene-by-gene schema creation and strain identification.</article-title>
<source><italic>Microb. Genom.</italic></source>
<volume>4</volume>:<issue>e000166</issue>.</mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simon</surname><given-names>S.</given-names></name><name><surname>Trost</surname><given-names>E.</given-names></name><name><surname>Bender</surname><given-names>J.</given-names></name><name><surname>Fuchs</surname><given-names>S.</given-names></name><name><surname>Malorny</surname><given-names>B.</given-names></name><name><surname>Rabsch</surname><given-names>W.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>Evaluation of WGS based approaches for investigating a food-borne outbreak caused by <italic>Salmonella enterica</italic> serovar Derby in Germany.</article-title>
<source><italic>Food Microbiol.</italic></source>
<volume>71</volume>
<fpage>46</fpage>–<lpage>54</lpage>. <pub-id pub-id-type="doi">10.1016/j.fm.2017.08.017</pub-id>
<?supplied-pmid 29366468?><pub-id pub-id-type="pmid">29366468</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uelze</surname><given-names>L.</given-names></name><name><surname>Becker</surname><given-names>N.</given-names></name><name><surname>Borowiak</surname><given-names>M.</given-names></name><name><surname>Busch</surname><given-names>U.</given-names></name><name><surname>Dangel</surname><given-names>A.</given-names></name><name><surname>Deneke</surname><given-names>C.</given-names></name><etal/></person-group> (<year>2021</year>). <article-title>Toward an integrated genome-based surveillance of <italic>Salmonella enterica</italic> in Germany.</article-title>
<source><italic>Front. Microbiol.</italic></source>
<volume>12</volume>:<issue>626941</issue>. <pub-id pub-id-type="doi">10.3389/fmicb.2021.626941</pub-id>
<?supplied-pmid 33643254?><pub-id pub-id-type="pmid">33643254</pub-id></mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uelze</surname><given-names>L.</given-names></name><name><surname>Borowiak</surname><given-names>M.</given-names></name><name><surname>Brinks</surname><given-names>E.</given-names></name><name><surname>Deneke</surname><given-names>C.</given-names></name><name><surname>Stingl</surname><given-names>K.</given-names></name><name><surname>Kleta</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2020a</year>). <article-title>German-wide interlaboratory study compares consistency, accuracy and reproducibility of whole-genome short read sequencing.</article-title>
<source><italic>Front. Microbiol.</italic></source>
<volume>11</volume>:<issue>e0573972</issue>. <pub-id pub-id-type="doi">10.3389/fmicb.2020.573972</pub-id>
<?supplied-pmid 33013811?><pub-id pub-id-type="pmid">33013811</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uelze</surname><given-names>L.</given-names></name><name><surname>Grützke</surname><given-names>J.</given-names></name><name><surname>Borowiak</surname><given-names>M.</given-names></name><name><surname>Hammerl</surname><given-names>J. A.</given-names></name><name><surname>Juraschek</surname><given-names>K.</given-names></name><name><surname>Deneke</surname><given-names>C.</given-names></name><etal/></person-group> (<year>2020b</year>). <article-title>Typing methods based on whole genome sequencing data.</article-title>
<source><italic>One Health Outlook</italic></source>
<volume>2</volume>:<issue>3</issue>.</mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uelze</surname><given-names>L.</given-names></name><name><surname>Borowiak</surname><given-names>M.</given-names></name><name><surname>Deneke</surname><given-names>C.</given-names></name><name><surname>Szabó</surname><given-names>I.</given-names></name><name><surname>Fischer</surname><given-names>J.</given-names></name><name><surname>Tausch</surname><given-names>S. H.</given-names></name><etal/></person-group> (<year>2019</year>). <article-title>Performance and accuracy of four open-source tools for <italic>in silico</italic> serotyping of <italic>Salmonella</italic> spp. based on whole-genome short-read sequencing data.</article-title>
<source><italic>Appl. Environ. Microbiol.</italic></source>
<volume>86</volume>:<issue>e002265-19</issue>.</mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoshida</surname><given-names>C. E.</given-names></name><name><surname>Kruczkiewicz</surname><given-names>P.</given-names></name><name><surname>Laing</surname><given-names>C. R.</given-names></name><name><surname>Lingohr</surname><given-names>E. J.</given-names></name><name><surname>Gannon</surname><given-names>V. P. J.</given-names></name><name><surname>Nash</surname><given-names>J. H. E.</given-names></name><etal/></person-group> (<year>2016</year>). <article-title>The <italic>Salmonella in silico</italic> typing resource (SISTR): an open web-accessible tool for rapidly typing and subtyping draft <italic>Salmonella</italic> genome assemblies.</article-title>
<source><italic>PLoS One</italic></source>
<volume>11</volume>:<issue>e0147101</issue>. <pub-id pub-id-type="doi">10.1371/journal.pone.0147101</pub-id>
<?supplied-pmid 26800248?><pub-id pub-id-type="pmid">26800248</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>Z.</given-names></name><name><surname>Alikhan</surname><given-names>N.-F.</given-names></name><name><surname>Mohamed</surname><given-names>K.</given-names></name><name><surname>Fan</surname><given-names>Y.</given-names></name></person-group><collab>The Agama Study Group, and Achtman M.</collab> (<year>2020a</year>). <article-title>The EnteroBase user’s guide, with case studies on <italic>Salmonella</italic> transmissions, <italic>Yersinia pestis</italic> phylogeny, and <italic>Escherichia</italic> core genomic diversity.</article-title>
<source><italic>Genome Res.</italic></source>
<volume>30</volume>
<fpage>138</fpage>–<lpage>152</lpage>. <pub-id pub-id-type="doi">10.1101/gr.251678.119</pub-id>
<?supplied-pmid 31809257?><pub-id pub-id-type="pmid">31809257</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>Z.</given-names></name><name><surname>Charlesworth</surname><given-names>J.</given-names></name><name><surname>Achtman</surname><given-names>M.</given-names></name></person-group> (<year>2020b</year>). <article-title>HierCC: a multi-level clustering scheme for population assignments based on core genome MLST.</article-title>
<source><italic>bioRxiv</italic></source> [Preprint]. <pub-id pub-id-type="doi">10.1101/2020.11.25.397539v1</pub-id></mixed-citation>
    </ref>
    <ref id="B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>Z.</given-names></name><name><surname>Alikhan</surname><given-names>N.-F.</given-names></name><name><surname>Sergeant</surname><given-names>M. J.</given-names></name><name><surname>Luhmann</surname><given-names>N.</given-names></name><name><surname>Vaz</surname><given-names>C.</given-names></name><name><surname>Francisco</surname><given-names>A. P.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>GrapeTree: visualization of core genomic relationships among 100,000 bacterial pathogens.</article-title>
<source><italic>Genome Res.</italic></source>
<volume>28</volume>
<fpage>1395</fpage>–<lpage>1404</lpage>. <pub-id pub-id-type="doi">10.1101/gr.232397.117</pub-id>
<?supplied-pmid 30049790?><pub-id pub-id-type="pmid">30049790</pub-id></mixed-citation>
    </ref>
  </ref-list>
  <glossary>
    <title>Abbreviations</title>
    <def-list id="DL1">
      <def-item>
        <term>AD</term>
        <def>
          <p>allele distance</p>
        </def>
      </def-item>
      <def-item>
        <term>API</term>
        <def>
          <p>application programming interface</p>
        </def>
      </def-item>
      <def-item>
        <term>BLAST</term>
        <def>
          <p>basic local alignment search tool</p>
        </def>
      </def-item>
      <def-item>
        <term>CDS</term>
        <def>
          <p>coding sequence</p>
        </def>
      </def-item>
      <def-item>
        <term>cgMLST</term>
        <def>
          <p>core genome MLST</p>
        </def>
      </def-item>
      <def-item>
        <term>DAG</term>
        <def>
          <p>directed acyclic graph</p>
        </def>
      </def-item>
      <def-item>
        <term>DNA</term>
        <def>
          <p>deoxyribonucleic acid</p>
        </def>
      </def-item>
      <def-item>
        <term>HTML</term>
        <def>
          <p>hypertext markup language</p>
        </def>
      </def-item>
      <def-item>
        <term>INDELs</term>
        <def>
          <p>insertion and deletions</p>
        </def>
      </def-item>
      <def-item>
        <term>ISO</term>
        <def>
          <p>International Organization for Standardization</p>
        </def>
      </def-item>
      <def-item>
        <term>NCBI</term>
        <def>
          <p>National Center for Biotechnology Information</p>
        </def>
      </def-item>
      <def-item>
        <term>MLST</term>
        <def>
          <p>multilocus sequence typing</p>
        </def>
      </def-item>
      <def-item>
        <term>NGS</term>
        <def>
          <p>next-generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p>single-nucleotide polymorphism</p>
        </def>
      </def-item>
      <def-item>
        <term>SRA</term>
        <def>
          <p>sequence read archive</p>
        </def>
      </def-item>
      <def-item>
        <term>ST</term>
        <def>
          <p>sequence type</p>
        </def>
      </def-item>
      <def-item>
        <term>wgMLST</term>
        <def>
          <p>whole-genome MLST</p>
        </def>
      </def-item>
      <def-item>
        <term>WGS</term>
        <def>
          <p>whole-genome sequencing.</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
</back>
