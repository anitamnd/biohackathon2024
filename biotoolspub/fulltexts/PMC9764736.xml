<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9764736</article-id>
    <article-id pub-id-type="publisher-id">9004</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-022-09004-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>XCVATR: detection and characterization of variant impact on the Embeddings of single -cell and bulk RNA-sequencing samples</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9696-1118</contrib-id>
        <name>
          <surname>Harmanci</surname>
          <given-names>Arif</given-names>
        </name>
        <address>
          <email>arif.o.harmanci@uth.tmc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Harmanci</surname>
          <given-names>Akdes Serin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Klisch</surname>
          <given-names>Tiemo J.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Patel</surname>
          <given-names>Akash J.</given-names>
        </name>
        <address>
          <email>Akash.Patel@bcm.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.267308.8</institution-id><institution-id institution-id-type="ISNI">0000 0000 9206 2401</institution-id><institution>University of Texas Health Science Center, School of Biomedical Informatics, Center for Secure Artificial intelligence For hEalthcare (SAFE), Center for Precision Health, </institution></institution-wrap>Houston, USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.39382.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 2160 926X</institution-id><institution>Department of Neurosurgery, Baylor College of Medicine, </institution></institution-wrap>Houston, TX 77030 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.416975.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 2200 2638</institution-id><institution>Jan and Dan Duncan Neurological Research Institute, Texas Children’s Hospital, </institution></institution-wrap>Houston, TX 77030 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.39382.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 2160 926X</institution-id><institution>Department of Molecular and Human Genetics, Baylor College of Medicine, </institution></institution-wrap>Houston, TX 77030 USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.39382.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 2160 926X</institution-id><institution>Department of Otolaryngology – Head and Neck Surgery, Baylor College of Medicine, </institution></institution-wrap>Houston, TX 77030 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>841</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>9</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>11</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">RNA-sequencing has become a standard tool for analyzing gene activity in bulk samples and at the single-cell level. By increasing sample sizes and cell counts, this technique can uncover substantial information about cellular transcriptional states. Beyond quantification of gene expression, RNA-seq can be used for detecting variants, including single nucleotide polymorphisms, small insertions/deletions, and larger variants, such as copy number variants. Notably, joint analysis of variants with cellular transcriptional states may provide insights into the impact of mutations, especially for complex and heterogeneous samples. However, this analysis is often challenging due to a prohibitively high number of variants and cells, which are difficult to summarize and visualize. Further, there is a dearth of methods that assess and summarize the association between detected variants and cellular transcriptional states.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here, we introduce XCVATR (e<bold>X</bold>pressed <bold>C</bold>lusters of <bold>V</bold>ariant <bold>A</bold>lleles in <bold>T</bold>ranscriptome p<bold>R</bold>ofiles), a method that identifies variants and detects local enrichment of expressed variants within embedding of samples and cells in single-cell and bulk RNA-seq datasets. XCVATR visualizes local “clumps” of small and large-scale variants and searches for patterns of association between each variant and cellular states, as described by the coordinates of cell embedding, which can be computed independently using any type of distance metrics, such as principal component analysis or t-distributed stochastic neighbor embedding. Through simulations and analysis of real datasets, we demonstrate that XCVATR can detect enrichment of expressed variants and provide insight into the transcriptional states of cells and samples. We next sequenced 2 new single cell RNA-seq tumor samples and applied XCVATR. XCVATR revealed subtle differences in CNV impact on tumors.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">XCVATR is publicly available to download from <ext-link ext-link-type="uri" xlink:href="https://github.com/harmancilab/XCVATR">https://github.com/harmancilab/XCVATR</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12864-022-09004-7.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single cell RNA-sequencing</kwd>
      <kwd>Embedding</kwd>
      <kwd>Genetic variation</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par26">Gene expression profiling generates large datasets that contain information about the activity levels of all genes in the transcriptome for a large number of samples. Analysis of these complex and high-dimensional data can uncover hidden expression patterns for driver genes, such as disease markers [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], delineate the transcriptional architecture of disease pathophysiology [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>], and help to formulate new hypotheses [<xref ref-type="bibr" rid="CR5">5</xref>]. RNA-sequencing (RNA-seq), wherein cDNA generated from isolated RNA is sequenced and quantified to estimate of gene expression levels, is the standard approach for profiling gene expression in large samples [<xref ref-type="bibr" rid="CR6">6</xref>]. Unlike gene expression arrays, which only provide estimates of gene expression levels, RNA-seq can also determine allele-specific expression, facilitate expression quantitative trait locus (eQTL) mapping [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref>], detect small polymorphisms [<xref ref-type="bibr" rid="CR10">10</xref>], and large copy number variants (CNVs) [<xref ref-type="bibr" rid="CR11">11</xref>], and elucidate transcriptional dynamics [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. The decreasing cost of sequencing has facilitated analysis of very large sample sizes that include thousands of samples [<xref ref-type="bibr" rid="CR14">14</xref>] and hundreds of tissues [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. Further, advances in single-cell sequencing technologies [<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR19">19</xref>] have allowed gene expression profiling at the single-cell level for thousands of cells, encompassing hundreds of cell types and cellular states. Consequently, the amount of information that must be summarized and interpreted is increasing at a challenging pace.</p>
    <p id="Par27">One of the main difficulties researchers face when analyzing large datasets is efficiently summarizing the massive quantities of biological information. To analyze thousands of samples or cells in a meaningful manner [<xref ref-type="bibr" rid="CR20">20</xref>], it is first necessary to decrease dimensionality of the data by embedding the cells with methods such as principal component analysis (PCA) or t-distributed stochastic neighbor embedding (t-SNE). Embedding enables the transcriptomic state of cells to be summarized and puts them in a simple perspective so that they can be clustered [<xref ref-type="bibr" rid="CR21">21</xref>] for differential expression analysis [<xref ref-type="bibr" rid="CR22">22</xref>], cell-type assignment [<xref ref-type="bibr" rid="CR23">23</xref>], and integration with other datasets across multiple modalities [<xref ref-type="bibr" rid="CR24">24</xref>]. Critically, while numerous embedding techniques have been proposed [<xref ref-type="bibr" rid="CR25">25</xref>], they have mostly been used for visualization purposes only. Thus, further work is needed to fully utilize the embedding space in downstream analyses.</p>
    <p id="Par28">Here, we propose a novel method for the detection, integration, and visualization of genetic variation within the embedding space from single-cell and bulk RNA-seq datasets. Motivation for developing this method stems from our observation that cells with similar mutations generally cluster together in “clumps”, and analyzing such clumps can yield interesting insights and facilitate generation of novel hypotheses. For example, a driver mutation might induce a specific transcriptional state, which causes cells harboring the mutation to cluster in the embedding coordinates. The most consequential variants are large-scale CNVs that show clear clumping patterns in t-SNE and PCA embeddings of gene expression analyses. Our approach, named XCVATR (e<bold>X</bold>pressed <bold>C</bold>lusters of <bold>V</bold>ariant <bold>A</bold>lleles in <bold>T</bold>ranscriptome p<bold>R</bold>ofiles), is a flexible and integrated framework for detecting, filtering, and analyzing mutations, so as to determine their association with the distances that are defined by the cell-embedding techniques (i.e.<italic>,</italic> spatial enrichment of mutations on the embedding space).</p>
    <p id="Par29">XCVATR is different from clustering methods that use variant calls to cluster cells [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>] in two main ways. First, XCVATR maps the variant allele frequencies (AFs) on an existing embedding and detects local patterns of enrichment for the expressed alleles (i.e., spatial correlation between the expressed variant [<xref ref-type="bibr" rid="CR28">28</xref>] AFs and embedding coordinates). This is distinct from clustering methods that define the distance metric using the variants themselves. Second, unlike clustering algorithms that aim to identify cell clusters to optimize global clustering of the cells, XCVATR identifies local patterns. In addition, XCVATR is a self-contained framework for the detection, annotation, and filtering of small variants, as well as for the detection and visualization of associations between variant AFs and the embedding space. Thus, there is no dependency on other methods, and the parameters for variant calling and filtering can be explicitly controlled.</p>
    <p id="Par30">A major component of XCVATR is the embedding that is used to summarize cellular transcriptomic states and define cell–cell distances. XCVATR expects the embedding to preserve locality information, such that cells close to one another in the embedding space are biologically similar. This is a reasonable expectation for popular dimensionality reduction techniques, such as PCA, t-SNE, and uniform manifold approximation and projection (UMAP). Among these, t-SNE and UMAP probabilistically preserve locality (i.e.<italic>,</italic> there is a random component in the embedding). Here, we demonstrate that locality information is fairly well-preserved, even with the presence of randomness in the embedding. We note, however, that the opposite statement does not have to hold. That is, we do not expect all biologically similar cells to map close to each other in the embedding space, as this strict requirement would require the embedding to preserve biological information almost exactly [<xref ref-type="bibr" rid="CR29">29</xref>]. Furthermore, it is not necessary to analyze the association of variants with embedding coordinates and geometry. Overall, XCVATR combines various components of general RNA-seq analysis into one flexible package for identifying, filtering, and visualizing variants at different levels (e.g., at variant level, gene level, and large scale events), while also analyzing their spatial distributions. Thus, we expect that this will be a useful tool for detecting genetic variants and assessing their biological impact in single-cell and bulk RNA-seq datasets.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par31">We first overview the XCVATR algorithm then we present the main results.</p>
    <sec id="Sec3">
      <title>Overview of XCVATR algorithm</title>
      <p id="Par32">Figure <xref rid="Fig1" ref-type="fig">1</xref> outlines the steps of the XCVATR algorithm, which are summarized below (see Methods for more details). Input to XCVATR is a mapped-read file, such as a BAM file. While this is typical for single-cell (sc)RNA-seq data, bulk datasets contain many BAM files (i.e., one for each replicate), and these can also be used in the analysis without any extra pre-processing.<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic overview of the XCVATR algorithm workflow. <bold>a</bold> Illustration of single nucleotide variant (SNV)/ insertion and deletion (indel) processing steps. The reads (blue dashes) are used to generate strand-specific pileups (only one strand is shown). These pileups are used to detect variants and generate a list of candidate SNVs and indels. Variants are filtered with respect to the Single Nucleotide Polymorphism Database (dbSNP) and their impact on protein-coding genes. Next, reads supporting reference and alternate alleles are counted for each variant in each cell; counts are stored in the allelic count matrix and are used to estimate variant read-level allele frequencies (AFs). In parallel, the reads mapping to each gene for each cell are counted in the quantification matrix, which is used to compute the cell embeddings and the cell–cell distance matrix. Variant AFs are mapped onto the embedding coordinates for visualization. <bold>b</bold> The illustration of the copy number variation (CNV) processing steps. The CNV segments are pooled, and the breakpoints are pooled and sorted on each chromosome separately. Consecutive breakpoints are used to define the set of minimal CNV segments that do not overlap with any breakpoint. Each new CNV segment is assigned a value of 0 or 1 for each cell based on their amplification/deletion (amp/del) status in that cell; these data are used to generate the binary matrix, which is mapped on the embedding to visualize clumps. <bold>c</bold> Clump detection steps. Read-level AFs are first smoothed on the embedding coordinates, and local maxima representing the clump centers are identified. This is followed by assignment of <italic>z</italic>-scores by read-depth (RD)-aware shuffling. Finally, the significant clumps are compared and visualized</p></caption><graphic xlink:href="12864_2022_9004_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par33">By default, XCVATR relies on the distance matrix between cells (or samples) that is generated based on transcriptomic profiles. The first step in constructing this distance matrix is read count quantification for each cell (or sample), which is used for computing either the embedding coordinates of the cells or building the distance matrix directly from the expression levels. It is worth noting that XCVATR can also make use of distance matrices that are computed by other means, such as proteomic distances that are estimated from measurement of protein expression levels [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>].</p>
      <p id="Par34">Next, XCVATR performs detection and annotation of the genetic variants. Variant detection is designed to include an integrated and flexible single nucleotide variant (SNV)/insertion and deletion (indel) calling step into XCVATR’s variant clump detection analysis. XCVATR generates pileups to identify candidate SNVs, which are then passed through several filters, such as total coverage, strand bias, and mapping qualities. This strategy is similar to that used by the VarScan suite of variant callers [<xref ref-type="bibr" rid="CR32">32</xref>, <xref ref-type="bibr" rid="CR33">33</xref>]. Notably, variant detection can also be parametrized in a relaxed manner, allowing users to evaluate clumps for variants that may be missed with conventional pipelines (e.g., variants with low AFs). We hypothesized that such relaxed variant calling can still be meaningful, as the variants will be further filtered in the context of variant clumping analysis in XCVATR. We therefore suggest that variant calls from XCVATR should only be used for clumping analysis and not for other downstream analyses. However, existing variant call sets (e.g.<italic>,</italic> VCF files) generated by other pipelines, such as GATK [<xref ref-type="bibr" rid="CR34">34</xref>] and Mutect [<xref ref-type="bibr" rid="CR35">35</xref>], can be provided as input, thereby skipping the variant detection step.</p>
      <p id="Par35">Variant annotation is integrated into XCVATR to make the workflow more flexible and complete. This is because although there are well-established protocols for variant annotation, such as VEP [<xref ref-type="bibr" rid="CR36">36</xref>] and AnnoVar [<xref ref-type="bibr" rid="CR37">37</xref>], these methods occasionally change over time, making it challenging to integrate their output and provide reproducibility. Therefore, XCVATR performs variant annotation to provide a stable and flexible filter for selecting variants with respect to impact. XCVATR takes the variant annotation file (e.g.<italic>,</italic> GTF or GFF) and annotates the detected variants with respect to their impact on the protein sequence. These variants are then filtered to identify and include the most impactful mutations (See Methods for more details on annotation and variant calling filters).</p>
      <sec id="Sec4">
        <title>Allele counting</title>
        <p id="Par36">For SNVs and small indels, XCVATR counts the number of mapped reads for each variant that support the alternative and reference alleles (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). Using this information, XCAVTR builds a matrix and computes the estimated alternative AFs of each variant. These are then used as scores to assess a variant’s existence in each cell.</p>
        <p id="Par37">For CNVs, XCVATR relies on an existing call set. CNVs are first separated into amplifications and deletions and then analyzed at two different scales. This is because CNVs are distinct compared to small variants, in that they can cover large domains that are as long as chromosomal arms. Therefore, to analyze CNVs at different length scales, XCVATR performs clumping analysis at both large scale (i.e., chromosome arm-length scale) and at segment-level scale. Large-scale CNV analysis includes possible deletion and amplification events for each of the 44 chromosomal arms. For these, XCVATR first builds a binary count matrix that is analogous to the alternative allele count matrix generated for small variants (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). Each entry in this matrix indicates the existence of the CNV (row) in the corresponding cell (column). At the segment-level scale, each CNV is treated as a separate variant. However, because the CNVs identified in each cell can overlap, XCVATR first identifies the smallest set of non-overlapping CNV segments by overlapping the CNVs from cells and identifying the minimal set of common variants (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). Next, these common variants are used to build a binary count matrix similar to the large-scale matrix. XCVATR counts each of the common and disjoint events as a separate variant and performs variant clump analysis.</p>
        <p id="Par38">After the alleles are counted, XCVATR can optionally analyze the variants by identifying and selecting the most impactful variant in each cell (or sample) for each protein-coding gene. This will filter out many variants and provide the user with a clearer view of the clumps at the gene level. In addition, this gene-level summarization of the annotations is important when different mutations in a driver gene can display the same clumping behavior (See Analysis of Bulk Meningioma RNA-seq Samples).</p>
      </sec>
      <sec id="Sec5">
        <title>Aggregated rare variant summarization and visualization</title>
        <p id="Par39">We hypothesized that variants with low population frequency, by default using The Single Nucleotide Polymorphism Database (dbSNP) [<xref ref-type="bibr" rid="CR38">38</xref>], are enriched among sample-specific (i.e., <italic>de-novo</italic> or singleton) mutations and somatic mutations (in the case of neoplastic samples). Additionally, sample-specific variants should be present at similar proportions in normal cells relative to tumors or any type of neoplastic cell. To visualize the rare variant fraction in each cell, XCVATR uses the rare variant read-level AF call matrix and computes the fraction of expressed alternative alleles of rare variants among the accessible rare variants. In this way, XCVATR generates a normalized measure of rare variant content in each cell’s expressional state. This aggregated rare variant summarization and visualization step may help to incorporate population-level variant frequency information into the embeddings (i.e.<italic>,</italic> transcriptional states). XCVATR can also visualize existing metadata, such as assigned cell types, jointly with the aggregated rare variant fractions.</p>
      </sec>
      <sec id="Sec6">
        <title>Smoothing scale selection on the embedding</title>
        <p id="Par40">XCVATR next performs a multiscale analysis of the distance matrices to identify variant clumps. This approach is similar to the multiscale filters that are used to identify blobs in images [<xref ref-type="bibr" rid="CR39">39</xref>–<xref ref-type="bibr" rid="CR41">41</xref>]. Each scale defines a neighborhood around a cell in the embedding coordinates and is used to smooth the AFs with a Gaussian filter that is centered on the cell and decreases with increasing distance from this center cell. The scales, however, must be tuned to the distance metric or the embedding coordinates. XCVATR performs a scale selection to tune the analysis to the selected cell–cell distance metric. For each cell, XCVATR identifies <italic>N</italic><sub><italic>ν</italic></sub> cells that are closest to it (i.e.<italic>,</italic> neighbors), thus defining the close neighborhood of each cell. XCVATR then scans neighborhood size, as follows:<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left(0.1\times {N}_{cells}\right)&gt;{N}_{\nu }&gt;\max \left(0.01\times {N}_{cells},10\right)$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mfenced close=")" open="("><mml:mn>0.1</mml:mn><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">cells</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>ν</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mo movablelimits="true">max</mml:mo><mml:mfenced close=")" open="("><mml:mn>0.01</mml:mn><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">cells</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>10</mml:mn></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12864_2022_9004_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>selecting those that include between 1% (or 10 cells, if lower) and 10% of cells in the sample (<italic>N</italic><sub><italic>cells</italic></sub>). It then computes the minimum and maximum radii for each cell that satisfies the above condition. XCVATR identifies the medians of the minimum and maximum radii over all cells and uses these final minimum and maximum radii (<italic>σ</italic><sub><italic>min</italic></sub>, <italic>σ</italic><sub><italic>max</italic></sub>) for multiscale analysis. This computation can be performed efficiently, since the distance matrix (unless it is provided) can be computed quickly from the embedding coordinates using fast matrix multiplications. Neighbor detection is then performed by sorting the distances and selecting the closest <italic>N</italic><sub><italic>ν</italic></sub> cell (or samples). After this step, only the closest neighbors are processed by XCVATR.</p>
      </sec>
      <sec id="Sec7">
        <title>Variant clump candidate selection</title>
        <p id="Par41">One of the challenges in clump detection is the large number of cells that need to be analyzed in different scales. To decrease the search space and reduce the cost of modeling, XCVATR performs a cell-centered analysis, wherein it does not aim to model the whole embedding space, but rather focuses on the cells, such that each detected clump is centered around a specific cell (or sample). This is a reasonable expectation, as the expected clumps are larger than the cell–cell distances, and therefore, clump detection should be accurate even when clumps are centered around cells.</p>
        <p id="Par42">From visual evaluation of the variant AF distributions on embeddings, the number of clumps were observed to be much smaller than the number of samples or cells. Motivated by this, we designed a clump-center-candidate pre-selection that decreases the search space for the clump centers. Given a smoothing scale <italic>σ</italic><sub><italic>a</italic></sub> at the scale <italic>a</italic>, XCVATR computes a smoothed AF value for each cell, as follows:<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{\phi}}_i^{(a)}=\frac{1}{\left|{N}_{\nu}^{(a)}(i)\right|}\times {\sum}_{k\in {N}_{\nu}^{(a)}(i)\backslash i}{\phi}_j\times \exp \left(-\frac{d_{i,j}^2}{\sigma_a^2}\right)$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:msubsup><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mfenced close="|" open="|"><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mfrac><mml:mo>×</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">\</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mfrac><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12864_2022_9004_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>where <italic>ϕ</italic><sub><italic>j</italic></sub> denotes the alternative AF of the variant in the <italic>j</italic><sup><italic>th</italic></sup> cell (1 &gt; <italic>ϕ</italic><sub><italic>j</italic></sub> &gt; 0), <italic>d</italic><sub><italic>i</italic>, <italic>j</italic></sub> denotes the distance between the <italic>i</italic><sup><italic>th</italic></sup> and <italic>j</italic><sup><italic>th</italic></sup> cells in the sample, and <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{\nu}^{(a)}(i)$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9004_Article_IEq1.gif"/></alternatives></inline-formula> indicates the set of indices for the cells that are in the vicinity of the <italic>i</italic><sup><italic>th</italic></sup> cell for the scale <italic>a</italic>. From the above equation, the smoothed AF of the <italic>i</italic><sup><italic>th</italic></sup> cell, <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{\phi}}_i^{(a)}$$\end{document}</tex-math><mml:math id="M8"><mml:msubsup><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2022_9004_Article_IEq2.gif"/></alternatives></inline-formula>, is higher when its neighborhood contains many cells with high AFs. In addition, the smoothed AF depends on the scaling parameter <italic>σ</italic><sub><italic>a</italic></sub>, and each scale is processed independently from other scales. XCVATR then identifies potential variant clump centers in the embedding coordinates by determining the set of cells whose neighborhoods contain cells that are strictly lower in terms of smoothed AF (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c), that is, the cells whose smoothed AF is the “local maximum”. These cells are considered candidates:<disp-formula id="Equc"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_a=\left\{i\left|\forall j\in {N}_{\nu}^{(a)}(i):{\overline{\phi}}_i^{(a)}&gt;{\overline{\phi}}_j^{(a)}\right.\right\}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mi>i</mml:mi><mml:mfenced open="|"><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:msubsup><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfenced></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12864_2022_9004_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>where <italic>C</italic><sub><italic>a</italic></sub> denotes the indices of cells that are clump centers. An advantage of this multiscale processing is that the above condition does not rely on any thresholding or modeling and fits naturally to the distribution of smoothed AF data on the embedding. In addition, we observed that the number of locally maximal clump center cells is at least 1–2 orders of magnitude smaller than the number of cells. Thus, the number of clumps that need to be scored decreases substantially with little impact on accuracy (See below).</p>
      </sec>
      <sec id="Sec8">
        <title>Specification of position and size of clumps</title>
        <p id="Par43">Up to this point, we have identified each clump by the cell at its center, which specifies the position of the clump in the embedding space. In addition to the center, it is also necessary to define the radius of the clump, so that its size can be determined. For this, XCVATR makes use of the scale parameter at which the clump is identified (i.e.<italic>, σ</italic><sub><italic>a</italic></sub> at scale <italic>a</italic>). Thus, all cells that are closer than <italic>σ</italic><sub><italic>a</italic></sub> to the center of a given clump are assigned to this clump.</p>
      </sec>
      <sec id="Sec9">
        <title>Variant clump evaluation by read-depth (RD)-aware permutation</title>
        <p id="Par44">For each candidate clump center cell in <italic>C</italic><sub><italic>a</italic></sub> (<italic>a</italic><sup><italic>th</italic></sup> scale), the corresponding smoothed AF is compared to an empirical background. To this end, XCVATR utilizes a permutation test to assign significance to each candidate clump center by permuting the AF of all cells (including non-candidates) and computing the smoothed AF (described above) for each candidate with permuted AF’s. This is repeated <italic>Κ</italic> times. For each permutation, the smoothed AFs are computed for every candidate clump center, and this is used to build an empirical background (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). XCVATR then computes a <italic>z</italic>-score that is used to rank the clumps and assigns final scores, as follows:<disp-formula id="Equd"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{\phi }=\frac{{\overline{\phi}}_i^{(a)}-{\mu}_{\phi }}{\delta_{\phi }}$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>ϕ</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>ϕ</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12864_2022_9004_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par45">It is important to ensure that the AF provides new information and does not simply recapitulate the geometry imposed by the embedding coordinates. This may occur, for example, when some cells are expressing a cell-specific marker that is not expressed at all in other cells. In this case, a non-impactful germline variant may be expressed in this cell population, whereas other cells will show no expression of the variant. In such a scenario, a naïve approach would determine that this variant exhibits a clump comprised of the cells where the gene is expressed. This would be an uninteresting clump that emerges based on the cell-type specificity of the gene. To filter out these clumps, XCVATR sets a threshold, <italic>τ</italic>, on the total read depth at which a variant (Sum of reference and alternate read counts) is expressed in each cell and estimates a <italic>z</italic>-score using this read depth as a co-variate. This allows the clumps to be evaluated and filtered with respect to RD bias. In order to further filter the clumps, XCVATR also computes the significance of enrichment for expressed alternative alleles at both the read level and the cell (or sample) level in each clump.</p>
      </sec>
      <sec id="Sec10">
        <title>Assessment of read-level alternate allele expression enrichment in clumps</title>
        <p id="Par46">Given the clumps identified for a variant, XCVATR first computes the total number of alternate and reference reads from all cells (i.e., counts in the bulk sample). These bulk-allele counts are used as a baseline alternate AF for the corresponding variant, which we denote by <inline-formula id="IEq3"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A{F}_{alt}^{(bulk)}$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>A</mml:mi><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="italic">alt</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9004_Article_IEq3.gif"/></alternatives></inline-formula>. Next, for each clump, the total alternative allele supporting reads and total reads are computed using only the cells in this clump. At scale <italic>a</italic>, for the <italic>b</italic><sup><italic>th</italic></sup> clump, the allelic counts are used to compute the read-level modified binomial <italic>P</italic>-value, with bulk alternate allele frequency is used as the flipping probability, using the binomial function <inline-formula id="IEq4"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Bin\left({n}_{alt}^{\left(a;b\right)},{n}_{ref}^{\left(a;b\right)};p=A{F}_{alt}^{(bulk)}\right)$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">alt</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup><mml:mo>;</mml:mo><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="italic">alt</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9004_Article_IEq4.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq5"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{ref}^{\left(a;b\right)}$$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2022_9004_Article_IEq5.gif"/></alternatives></inline-formula> and <inline-formula id="IEq6"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{alt}^{\left(a;b\right)}$$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">alt</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2022_9004_Article_IEq6.gif"/></alternatives></inline-formula> denote the number of reads supporting the reference and alternate alleles, respectively, for the corresponding variant. This binomial <italic>P</italic>-value estimates the significance for enrichment of alternate allele-supporting reads in clump <italic>b</italic>, when compared to randomly assigning reads to all cells with the probability, <italic>p</italic> = <italic>AF</italic><sub><italic>bulk</italic></sub>.</p>
      </sec>
      <sec id="Sec11">
        <title>Assessment of cellular-level alternate allele expression enrichment in clumps</title>
        <p id="Par47">Next, XCVATR computes enrichment of alternate AFs at the cell level. At scale <italic>a</italic>, XCVATR counts the cells in clump <italic>b</italic> having alternate AFs above <italic>η</italic>. XCVATR then counts the number of cells in the whole sample for which the alternate AF is above <italic>η</italic>. These values are used to compute significance for enrichment of alternate alleles at the cell level with Fisher’s exact test, by building a contingency table of cell counts in the bulk sample and in each clump, as follows:<table-wrap id="Taba"><table frame="hsides" rules="groups"><thead><tr><th>Variant <bold><italic>k</italic></bold></th><th>Number of cells whose AF &gt; <bold><italic>η</italic></bold></th><th>Number of<break/>cells whose AF &lt; <bold><italic>η</italic></bold></th></tr></thead><tbody><tr><td><bold>Clump</bold><bold><italic>b</italic></bold><bold>identified at scale</bold><bold><italic>a</italic></bold></td><td><inline-formula id="IEq7"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{\eta}^{\left(a;b\right)}(j)$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9004_Article_IEq7.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq8"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_0^{\left(a;b\right)}(j)-{c}_{\eta}^{\left(a;b\right)}(j)$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mn>0</mml:mn><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9004_Article_IEq8.gif"/></alternatives></inline-formula></td></tr><tr><td><bold>Bulk</bold></td><td><inline-formula id="IEq9"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{\eta}^{(bulk)}$$\end{document}</tex-math><mml:math id="M26"><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2022_9004_Article_IEq9.gif"/></alternatives></inline-formula></td><td><inline-formula id="IEq10"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_0^{(bulk)}-{c}_{\eta}^{(bulk)}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9004_Article_IEq10.gif"/></alternatives></inline-formula></td></tr></tbody></table></table-wrap></p>
        <p id="Par48">where <inline-formula id="IEq11"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{\eta}^{\left(a;b\right)}(j)$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9004_Article_IEq11.gif"/></alternatives></inline-formula> indicates the number of cells in clump <italic>b</italic> at scale <italic>a</italic>, with AF &gt; <italic>η</italic>, and <inline-formula id="IEq12"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{\eta}^{(bulk)}$$\end{document}</tex-math><mml:math id="M32"><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2022_9004_Article_IEq12.gif"/></alternatives></inline-formula> indicates the number of all cells (i.e., bulk sample) for which AF &gt; <italic>η</italic>. Fisher’s exact test evaluates enrichment of a clump’s AF statistics in comparison to the whole bulk sample. In particular, this test filters out cases where one cell in a small clump displays a high AF, while other cells in the clump express the alternate allele only at low levels, which may still pass the read-level enrichment filter. Thus, the read-level and cell-level enrichment estimates are used to filter out clumps (with <italic>P</italic> &lt; 0.05) exhibiting low levels of enrichment in comparison to the bulk sample at the read and cell (or sample) level.</p>
        <p id="Par49">Finally, XCVATR computes the effective radius for each clump by iterating over the cells closest to the clump’s center cell. In this way, cells in the neighborhood surrounding the clump’s center are analyzed as they expand in radius. For each neighborhood, the area where cell-level enrichment is maximized (i.e., Fisher’s exact test <italic>P</italic>-value is minimized) is selected as the effective radius of the clump. Finally, the clump centers and the scale at which they are identified, permutation <italic>z</italic>-scores, alternate allele enrichment statistics, and effective radii are reported in the output.</p>
      </sec>
      <sec id="Sec12">
        <title>Visualization</title>
        <p id="Par50">XCVATR provides visualization of the clumps on the embedding coordinates for each variant. This enables users to manually evaluate the variants and can also be helpful for visualizing cell-type specifications and phenotypic properties in relation to the clumps. Visualization utilities are implemented in R and directly make use of the data generated by XCVATR.</p>
      </sec>
    </sec>
    <sec id="Sec13">
      <title>Analysis of detected variants and clump testing</title>
      <p id="Par51">To investigate the frequencies of identified variants from existing RNA-seq data, we measured the alternative AFs of detected variants in bulk (from 160 meningioma patients [<xref ref-type="bibr" rid="CR42">42</xref>]) and scRNA-seq datasets (BT_S2 glioblastoma sample from Darmanis et al. [<xref ref-type="bibr" rid="CR43">43</xref>]) using XCVATR. We generally observed that the detected variants in the bulk dataset exhibit an AF spectrum that is dominated by alternate AFs of 0 and 100% (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a), with a slight enrichment at 50%. For the single-cell dataset, consistent with previous studies [<xref ref-type="bibr" rid="CR26">26</xref>], we found that a substantial proportion of the mutations are expressed in a small fraction of cells (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b,c). Thus, our results provide evidence justifying the development of XCVATR.<fig id="Fig2"><label>Fig. 2</label><caption><p>Clumping and variant statistics for existing RNA-sequencing (RNA-seq) datasets. <bold>a</bold> Read-level alternative AF distribution of variants from bulk meningioma RNA-seq data [<xref ref-type="bibr" rid="CR42">42</xref>]. <bold>b</bold> Read-level frequencies of variants from single-cell (sc)RNA-seq data using the BT_S2 sample glioblastoma sample from Darmanis et al. [<xref ref-type="bibr" rid="CR43">43</xref>] <bold>c</bold> Distribution of the fractions of cells containing variants in single-cell data; the x-axis shows the fraction of cells that contain variants, and the y-axis shows the density. <bold>d</bold> Clumping statistics for large-scale deletions and for <bold>e</bold> large-scale amplifications. Boxplots show the distribution of distances between the nearest CNV-harboring cells (red) and same plot with shuffled AF data (blue). <bold>f</bold> Clumping statistics for SNVs/indels in the BT_S2 dataset; x-axis shows the read-level AFs for selecting cells used in the analysis. Boxplots are shown for each AF cutoff, corresponding to read-level (red) and AF-shuffled (blue) data. <bold>g</bold> Number of unique cells (y-axis) at closest-neighbor rank in neighborhoods of increasing size (x-axis) for the BT_S2 dataset over 100 independent t-distributed stochastic neighbor embedding (t-SNE) runs generated by SEURAT. Numbers of unique neighbors for randomized (blue) and real data (red) are shown. <bold>h</bold> Simulated clump detection accuracy. Clump detection sensitivity (left), number of detected clumps (middle), and distance between real and detected clumps are shown (right); x-axes show the distance weight, and colors indicate the AF weight used for clump simulation. <bold>i</bold> Distribution of variant-harboring cell enrichment, with (red) and without (blue) RD-aware shuffling for clump detection</p></caption><graphic xlink:href="12864_2022_9004_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par52">We next tested our hypothesis that variant clumps are present in t-SNE embeddings. Although we can manually observe these clumps, it is useful to have automated and objective tools for validating their existence and measuring their prevalence. To determine whether such variant clumps frequently occur in embedding coordinates, we computed the average distance between cells containing variants with high alternate AFs. If these cells are closer to each other than expected by random chance, this provides empirical evidence for detectable general clumping behavior of variants. Using the Darmanis et al. BT_S2 dataset [<xref ref-type="bibr" rid="CR43">43</xref>], we computed the distribution of distances between the closest cells that contain variants with alternate AFs greater than <italic>η</italic>. We also computed the same distribution in shuffled data, such that the AF shuffling is performed in a RD aware manner to prevent RD bias (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d–f). We found that for SNVs/indels, as the AF cutoff, <italic>η</italic>, increases, cells containing variants with high alternate AFs are closer to each other relative to the shuffled data (Fig. <xref rid="Fig2" ref-type="fig">2</xref>f). Notably, this clumping behavior is much clearer when we performed the same analysis with CNVs (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d,e). In this case, we computed the cell–cell distance distributions for cells containing CNVs (i.e., amplifications and deletions) and found that the distribution of distances is much smaller in the real compared to the shuffled datasets for both deletions and amplifications (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d,e). This observation that CNVs exhibit a much stronger clumping effect than SNVs and indels may result from the fact that CNVs have a stronger impact on the transcriptional state of the cells. Critically, these results provide evidence for the general clumping of cells with respect to SNV, indel, and CNV frequencies.</p>
    </sec>
    <sec id="Sec14">
      <title>Robustness of local statistics</title>
      <p id="Par53">We further evaluated the robustness of local distance statistics from the t-SNE coordinates that are used for embedding of scRNA-seq data. This is necessary because as a probabilistic embedding technique, t-SNE requires a seed for the pseudorandom-number generator [<xref ref-type="bibr" rid="CR44">44</xref>]. When the seed is changed, or when t-SNE is ran twice with the same seed, the embedding coordinates are changed. However, robustness of sample locality is essential for XCVATR clumping analysis, as this algorithm is designed to detect the local clumping of cells harboring variants with high alternate AFs. Therefore, to test the local robustness of t-SNE embedding coordinates, we first ran t-SNE on the Darmanis et al. dataset [<xref ref-type="bibr" rid="CR43">43</xref>], using the SEURAT package [<xref ref-type="bibr" rid="CR45">45</xref>] with default parameters. The t-SNE coordinates are generated 100 times, changing the seed number with every run. Next, for each cell, we identified neighborhoods of increasing size, containing up to 600 of the closest neighboring cells (out of 1170 cells total). For each of the 100 embeddings, we computed the number of unique cells within these neighborhoods and plotted the average number of unique cells at each neighborhood size (Fig. <xref rid="Fig2" ref-type="fig">2</xref>g). We also compared this locality information with an identifier-shuffled dataset, where we permutated the cell identities at each embedding and then computed locality preservation for each neighborhood size. We found that, compared to the shuffled data, real data show strong preservation of the embedding. At each neighborhood size, which determines the rank or strength of locality, the real dataset contains, on average, between one and three unique cells among their closest neighbors. In addition, this average does not change with increasing neighborhood size (i.e.<italic>,</italic> increasing closest-neighbor rank in Fig. <xref rid="Fig2" ref-type="fig">2</xref>g). For shuffled data, the average number of unique cells is as high as 60 cells at small localities. It should be noted that these results only attest to the robustness of locality statistics. For neighborhoods covering more than 25% of the cells, the randomized and real locality statistics are very similar, which suggests that clumps containing more than 25% of the cells (i.e.<italic>,</italic> neighborhoods with approximately 300 cells in Fig. <xref rid="Fig2" ref-type="fig">2</xref>g) may be non-robust and non-reproducible between different runs of t-SNE.</p>
    </sec>
    <sec id="Sec15">
      <title>Accuracy of clump detection</title>
      <p id="Par54">Next, we tested the accuracy of our multiscale clump detection approach by simulating clumps and running XCVATR to detect these simulated clumps. To ensure realistic data, we simulated variant clumps on the t-SNE embedding coordinates with the AFs of known variants identified within the 1170 cells from Darmanis et al. [<xref ref-type="bibr" rid="CR43">43</xref>] (See Methods). For this analysis, a cell is randomly selected and designated as the known clump center. We use two parameters to define a clump: the first is the scale parameter, which determines the radius of the simulated clump, and the second is the strength of the clump (referred to as “AF weight”). AF weight is tuned by a parameter that forces high AFs to be assigned closer to the center of the simulated clump and thus determines strength of the AF distribution around the clump. Given the clump center cell, we assign a “sampling weight” to every other cell, which depends on the distance to the center cell and the AF of the current cell. These sampling weights are used to shuffle the AFs on the embedding, such that cells with high sampling weights (i.e., close to the clump center and having a high AF) are shuffled close to the clump center (See Methods). This simulation strategy allows us to make use of existing data rather than generating synthetic datasets, which can introduce synthetic biases.</p>
      <p id="Par55">We simulated five different distance weights and six different AF weight parameters, and for each parameter combination, we chose 100 randomly selected clump centers. To illustrate the effect of the parameters, consider two cells whose respective AFs are 0.99 and 0.01. The simulation assigns sampling weights equal to 0.997 and 0.238, respectively, when (AF weight, distance weight) is set to (0.4, 0.005) and distance to the clump center is at 5% of the embedding radius. When the distance weight is increased to 0.05, the sampling weights are 0.999 and 0.858, respectively, indicating that the cells have a more similar probability of being sampled at this distance. When AF weight is decreased to 0.2, the sampling weights become almost identical at 0.999, and 0.926, respectively. Thus, shuffling generates non-trivial and challenging clumps for testing XCVATR.</p>
      <p id="Par56">For each simulation, an alternate read count matrix is generated from the shuffled AF data for the 1170 cells in the simulated dataset and is input to XCVATR. Accuracy of the simulation is then evaluated by comparison of the known clump centers to the clump centers detected by XCVATR. Any clump that is detected within less than 1% of the whole embedding space radius is deemed a match. We evaluated the fraction of times XCVATR was able to correctly identify the cells at the center of the clumps (Fig. <xref rid="Fig2" ref-type="fig">2</xref>h, left) and recorded the number of clumps identified by XCVATR (Fig. <xref rid="Fig2" ref-type="fig">2</xref>h, right). In addition, we measured the distance between simulated and detected clumps (Fig. <xref rid="Fig2" ref-type="fig">2</xref>h, right). Overall, we found that XCVATR can accurately identify and summarize clump centers, with a sensitivity higher than 90% for most parameter combinations, and the number of clumps is bound at fewer than 15 clumps. For less challenging cases (i.e.<italic>,</italic> low distance weights and higher AF weights), we observed an increase in detection accuracy, fewer total detected clumps, and decreased distance between simulated and predicted clumps.</p>
      <p id="Par57">We also evaluated how RD-aware permutation impacts the identified clumps. To this end, we identified clumps from the Darmanis et al. dataset [<xref ref-type="bibr" rid="CR43">43</xref>] with and without RD-aware shuffling. We then plotted the distribution of cell-level enrichment of alternative alleles, as determined by Fisher’s exact test <italic>P</italic>-values, for the clumps detected with and without RD-aware shuffling (Fig. <xref rid="Fig2" ref-type="fig">2</xref>i). We found that RD-aware shuffling enables detection of clumps with a greater enrichment for cells expressing alternative alleles. This analysis provides evidence that RD-aware shuffling can be helpful for identifying clumps that are enriched for cells expressing alternative alleles.</p>
    </sec>
    <sec id="Sec16">
      <title>XCVATR analysis of a glioblastoma scRNA-seq dataset</title>
      <p id="Par58">To demonstrate data analysis with XCVATR, we first used the dataset generated by Darmanis et al. [<xref ref-type="bibr" rid="CR43">43</xref>], which contains scRNA-seq of tissue from four patients with glioblastoma brain tumors, sequenced using Smart-Seq2 technology [<xref ref-type="bibr" rid="CR46">46</xref>]. A key advantage of Smart-Seq2 is that it provides more uniform coverage compared to technologies such as Drop-Seq and 10X Genomics, in which there is a 3′-bias on the transcript [<xref ref-type="bibr" rid="CR47">47</xref>]. While this bias can potentially affect the variant detection step, XCVATR does not require the variants to be complete, as each one is analyzed independent of other variants.</p>
      <p id="Par59">Here, we found 3590 cells from the metadata (in all samples) that were processed and mapped using Hisat2 and used the embedding coordinates from the t-SNE analysis performed in the original study. After initial inspection of the samples, we focused on one with the id “BT_S2”, which contains the most impactful events in terms of CNVs, SNVs, and indels. After calling variants with XCVATR for 1170 cells, XCVATR identified 201,600 mutations in total that are annotated. After filtering with respect to allele frequencies, 74,575 mutations remained. Further filtering of the mutations with respect to impact, 776 mutations are found to be damaging. The final gene-level summarization of the mutations yielded 687 genes that harbor a damaging mutation (Methods). We first focused on the rare variant fractions in each cell by filtering out variants whose dbSNP population AFs are greater than 1%, as we hypothesized that variants with very low population frequencies are either sample-specific mutations (<italic>de-novo</italic> or singletons) or somatic mutations. We found that rare variants are more highly represented in the immune cells and less represented in the neurons (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a).<fig id="Fig3"><label>Fig. 3</label><caption><p>XCVATR analysis of the BT_S2 glioblastoma sample from the Darmanis et al. scRNA-seq dataset [<xref ref-type="bibr" rid="CR43">43</xref>]. <bold>a</bold> Boxplots showing the distribution of expressed rare allele fractions in the corresponding cell types. Middle whiskers show the median, and the bottom and top whiskers indicate the 1st and 3rd quartiles, respectively. <bold>b</bold> Example of a clump with the 17q deletion. Clumps detected by XCVATR are shown with blue ellipses; each dot represents a cell, with the AF indicated by color (red, high; white, low). <bold>c</bold> Examples of other large deletions detected by clumps; plots show AFs. <bold>d</bold> Mutation in <italic>TP53</italic> (tumor protein 53) that is identified as a clump in the tumor cells. The smoothed AF is shown on the right, and the RD for each cell is shown below. <bold>e</bold> SNVs in the <italic>TCTN3</italic> (tectonic family member 3) and <italic>MTG1</italic> (mitochondrial GTPase 1) genes. Top plots show the AFs, and bottom plots show the RD for each cell. <bold>f</bold> Distribution of expressed COSMIC variant fraction on cells</p></caption><graphic xlink:href="12864_2022_9004_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par60">We next ran XCVATR on the CNVs (identified by CaSpER) and short variants. We focused on the large-scale CNVs and evaluated the initial clump centers detected by XCVATR in the first pass of the multiscale decomposition for amplifications (Fig. S<xref rid="MOESM1" ref-type="media">1</xref>) and deletions (Fig. S<xref rid="MOESM1" ref-type="media">2</xref>). As expected, XCVATR decreases the search space substantially by focusing the clump search on a sparse set of cells. After clump scoring, we assessed the final set of clump calls. Figure <xref rid="Fig3" ref-type="fig">3</xref>b shows an example of a clump that is detected by XCVATR for a deletion of chromosome arm 17q, which is identified as the top clump among other large-scale deletions. This is a well-known deletion that is observed in glioblastoma tumors, and two clumps with the 17q deletion are identified for this population of malignant cells. We included distributions of representative clumps that are detected for deletions on chromosome arms 17p, 10q, and 22q (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c), which are reported as the top CNVs. In addition, XCVATR identified clumps identified by deletions of chromosome arms of 4 and 13 (Table S<xref rid="MOESM1" ref-type="media">1</xref>) and amplifications of chromosomal arms of 7, 20, and 21 (Table S<xref rid="MOESM1" ref-type="media">2</xref>), which are frequently altered in tumors. While these results are partially expected, they also corroborate the clump detection performed by XCVATR.</p>
      <p id="Par61">We next analyzed the SNVs and indels identified by XCVATR. XCVATR identified numerous clumps that form in the embeddings at different scales (Table S<xref rid="MOESM1" ref-type="media">3</xref>). One of the top deleterious variants detected by XCVATR is in <italic>TP53</italic> (tumor protein 53), which encodes the well-known DNA-repair protein p53 (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). This mutation is also marked as deleterious in the Catalogue of Somatic Mutations in Cancer (COSMIC) database [<xref ref-type="bibr" rid="CR48">48</xref>]. Smoothed AF signals indicate that there is a clear enrichment of the alternate allele in malignant cells. The RD at which each cell harbors the variant is shown in the bottom panel (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d), thereby allowing users to manually inspect for RD biases. We also identified variants in several other genes, including <italic>TCTN3</italic> (tectonic family member 3) [<xref ref-type="bibr" rid="CR49">49</xref>] and <italic>MTG1</italic> (mitochondrial GTPase 1), which form significant clumps on the same set of cells (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e). Interestingly, these genes are also mutated in some of the normal cells, as observed on the t-SNE embedding, which could result from misclassification of cells. Critically, these results suggest that clump detection can provide additional insight in analysis of tumor scRNA-seq datasets.</p>
      <p id="Par62">We next focused joint analysis and visualization of multiple variants. This is advantageous to evaluate the effect of a set of variants that can collectively impact global expression levels concordantly and help identify cell types or transcriptional programs. We focused on the COSMIC catalogue of variants as they are most relevant to cancer literature. We calculated the average fraction of the 363 expressed COSMIC variants in each cell and visually evaluated the smoothed fractions on the embedding using XCVATR’s smoothing function (Fig. <xref rid="Fig3" ref-type="fig">3</xref>f). We found that there is a clear enrichment of the COSMIC variant expressions that coincide with neoplastic cell populations in the embedding. As a baseline, we selected 363 random variants from the detected variants and performed pooling and computed the expressed fraction of random variants. We repeated this permutation 20 times. Overall, the maximum of the expressed variant fraction is on average much smaller for the randomly selected variants compared to the actual COSMIC variants (0.05 vs 0.0082+/− 0.0012). This result demonstrates that COSMIC variant pooling is substantially different from a permuted set and potentially contains biologically relevant signal. In summary, this analysis demonstrates that analysis and visualization of different variant sets can provide useful insight into detection of different cell types with respect to their expressed variant profiles.</p>
    </sec>
    <sec id="Sec17">
      <title>Copy number variant analysis of a meningioma scRNA-seq dataset</title>
      <p id="Par63">We next analyzed new scRNA-seq datasets generated by our group that include two samples (referred to as frontal and postal) obtained from the brain of a patient with meningioma tumors. The frontal sample is from the primary meningioma tumor. This primary tumor metastasized within the patient’s brain to another location, and the metastasized tumor was extracted to yield the postal sample. Both samples were sequenced using the 10X Genomics scRNA-seq platform, and reads were mapped with the CellRanger software suite. The SEURAT package was then used to filter out low-quality cells (i.e.<italic>,</italic> those with low coverage, high mitochondrial reads, and potential doublets) and to generate the t-SNE embedding coordinates from CellRanger read counts. We identified CNVs in these samples with CaSpER, and using the embedding data and the CNVs, we performed clump detection in XCVATR. For these samples, we also identified the CNVs from an existing genotyping array of the bulk tumor samples using the DNAcopy algorithm [<xref ref-type="bibr" rid="CR50">50</xref>]. We analyzed the CNVs identified in both the scRNA-seq and genotyping array datasets and found that tumor cells predominantly contain the 1p and 22q large-scale (i.e., chromosome arm) deletions (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, b). As such, XCVATR does not assign high clumping scores to these deletions.<fig id="Fig4"><label>Fig. 4</label><caption><p>Analysis of the expressed variants and CNV clumps in our meningioma scRNA-seq dataset. Clumps identified for the <bold>a</bold> 1p and <bold>b</bold> 22q deletions. Bottom plots show the counts of cells harboring the CNVs. Clumps identified for the <bold>c</bold> 11p, <bold>d</bold> 14q, and <bold>e</bold> 18q deletions in the frontal sample. Clumps are highlighted by the blue ellipses, smoothed AFs are shown in the middle row, and distribution of smoothed AFs are shown in bottom row. Clumps identified for the <bold>f</bold> 11p, <bold>g</bold> 14q, and <bold>h</bold> 18q deletions in the postal sample. Clumps are highlighted by the blue ellipses, and smoothed AFs are shown in the bottom row. <bold>i</bold> Segment-level deletions on chromosome 1p in the frontal sample; x-axis shows the genomic coordinates, and y-axis shows the <italic>z</italic>-scores assigned by XCVATR to each segment. Cytobands on the genomic coordinates are indicated by rectangles of alternating colors, with the cytoband name shown at top. The segments on 1p36 and 1p22 with higher clumping scores are boxed in red, dashed rectangles. Clumping scores for segments on chromosome 1p in the frontal <bold>j</bold> and postal <bold>k</bold> sample are shown</p></caption><graphic xlink:href="12864_2022_9004_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par64">We then focused on the 11p, 14q, and 18q deletions (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c–h) that were identified in both the genotyping array and the scRNA-seq data. XCVATR identified strong overlapping clumps for these deletions, and the smoothed AFs indicate a clear enrichment of these deletions in tumor cells. When clumping patterns in the frontal and postal samples are compared, notable differences are observed, with the postal samples (Fig. <xref rid="Fig4" ref-type="fig">4</xref>f–h) showing additional clumps compared to the frontal samples (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c–e). These clumping differences in frontal and postal samples are more visible when the smoothed AF plots are compared (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c–h). Based on these observations, we hypothesize that differential or comparative visualization analysis with XCVATR can provide a complement to existing computational methods and yield additional insights.</p>
      <p id="Par65">We also examined segment-level events in the frontal and postal scRNA-seq samples using XCVATR. For this analysis, we used the segment-level CNVs reported by CaSpER and visualized these events in XCVATR by mapping the clumping <italic>z</italic>-scores on the genomic coordinates. Among the 5623 deletion segments, in the frontal sample, we found that segment-level deletions at 1p.36 (a well-known locus deleted in tumors) exhibit higher clumping scores relative to the other segments in chromosomal arm 1p (Fig. <xref rid="Fig4" ref-type="fig">4</xref>i). Additionally, deletions in a relatively short segment covering 1p.22.1 and 1p.22.2 (described previously) are assigned high clumping scores in the frontal sample (Fig. <xref rid="Fig4" ref-type="fig">4</xref>j). However, these regions do not exhibit high clumping scores in the postal sample (Fig. <xref rid="Fig4" ref-type="fig">4</xref>k). Chromosome arm 22q exhibits more uniform clumping behavior [<xref ref-type="bibr" rid="CR51">51</xref>] in both the frontal and postal samples, whereas arms 14q and 18q show differences in clump scores at the segment level.</p>
      <p id="Par66">We also analyzed the potential impact of dropout events on clump identification. Drop-outs refer to observation of zero read count on genes and are caused by stochastic sampling of RNA molecules from the library. While drop-outs have been treated wide as technical factors, number of studies have found that they provide biologically useful information about cell clustering [<xref ref-type="bibr" rid="CR52">52</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>), and identification of rare cell types. We estimated drop-out rates for each chromosome in our samples by calculating the fraction of protein-coding genes with exactly zero RNA-seq reads in each cell and found approximately 86% overall drop-out rate. When dropouts are estimated for each chromosome, we found that dropout events reflect the deletion patterns on the chromosomes 22, 10, 18, 14, 11, and 1 (Fig. S<xref rid="MOESM1" ref-type="media">3</xref>).</p>
    </sec>
    <sec id="Sec18">
      <title>XCVATR analysis of bulk meningioma RNA-Seq samples</title>
      <p id="Par67">Lastly, we used XCVATR to analyze SNVs and indels in an existing bulk RNA-seq dataset obtained from a cohort of 160 meningioma patients [<xref ref-type="bibr" rid="CR42">42</xref>]. Variants were detected and annotated with XCVATR (See Methods) and filtered with respect to impact and population frequency (See Methods); identified variants were summarized to gene-level events. We then constructed the gene expression matrix, performed t-SNE to generate the embedding coordinates of the data, and ran XCVATR to identify strong variant clumps. In order to evaluate the effect of t-SNE parameters (i.e.<italic>,</italic> the perplexity parameter, number of top variable genes, and minimum expression cutoff) on clump detection, we ran t-SNE with 180 different parameter combinations and then ran XCVATR with each of the resulting embeddings. Analysis of the genes associated with the top-scoring clumps revealed that these clumps are associated with mutations in the <italic>KLF4</italic> (Kruppel-like factor 4), <italic>AKT1</italic> (AKT serine/threonine kinase 1), and <italic>TRAF7</italic> (TNF receptor-associated factor 7) genes (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a–d). These were the genes most frequently reported by XCVATR among the 180 different embedding parameter combinations used, and notably, mutations in these genes are extensively reported as recurrent events in meningioma tumors [<xref ref-type="bibr" rid="CR53">53</xref>]. In contrast, clumps associated with mutations in <italic>NF2</italic> (neurofibromin 2), a common driver of meningioma, scored lower in the XCVATR clump analysis (Fig. <xref rid="Fig5" ref-type="fig">5</xref>e). Upon inspection of the data, we conclude that this likely results from low coverage of the <italic>NF2</italic> gene in most samples, which also contain chromosome 22 deletions. Overall, these results provide evidence that XCVATR can help to uncover biologically relevant mutations in bulk RNA-seq samples.<fig id="Fig5"><label>Fig. 5</label><caption><p>Analysis of an existing bulk RNA-seq dataset containing 160 meningioma samples. <bold>a</bold> Graph showing the average number of clumps for each gene detected by XCVATR with 180 different t-SNE parameter combinations. Genes are shown on the x-axis, and the average hits for each gene are shown on the y-axis. The top-three genes are boxed in the dashed, red rectangle. Clumps detected by XCVATR for the <bold>b</bold>
<italic>AKT1</italic> (AKT serine/threonine kinase 1), <bold>c</bold>
<italic>TRAF7</italic> (TNF receptor-associated factor 7), and <bold>d</bold>
<italic>KLF4</italic> (Kruppel-like factor 4) genes. Read coverage is shown at bottom. <bold>e</bold> Clumps associated with mutations in the <italic>NF2</italic> gene. Read coverage is shown in the bottom plot</p></caption><graphic xlink:href="12864_2022_9004_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec19">
    <title>Discussion</title>
    <p id="Par68">In this study, we present XCVATR, a method that analyzes the spatial enrichment of expressed variant alleles in bulk and scRNA-seq data to identify local clumps in cell and sample embeddings. XCVATR makes use of local spatial geometry from the embedding and multiscale analysis to provide a comprehensive workflow for detecting expressed variant clumps. By visualizing these clumps on the embeddings, they can provide insight into driver genes and key mutations underlying pathophysiological states.</p>
    <p id="Par69">Critically, to provide maximal levels of user control, XCVATR integrates variant detection, annotation, filtering, and clump detection in one package and therefore does not explicitly require any particular variant-calling methods, such as GATK [<xref ref-type="bibr" rid="CR54">54</xref>]. We believe that this high level of control on variant calls is especially important to make variant calling as relaxed as possible and provide a comprehensive set of variant calls, which can then be stringently filtered at the clump-detection stage. This allows rare somatic variants in cancer samples to be more inclusively analyzed relative to existing pipelines that may miss rare variants with their default calibrated parameters [<xref ref-type="bibr" rid="CR55">55</xref>].</p>
    <p id="Par70">One of the current limitations of our method is that the concept of a clump needs more refinement and should be more discretely defined (Additional file <xref rid="MOESM1" ref-type="media">1</xref>). In addition, the different embedding strategies should be surveyed to evaluate how embedding strategy and dimensions impact clump identification. The concept of a clump is similar to peak in ChIP-Seq analysis (1D clumps) [<xref ref-type="bibr" rid="CR56">56</xref>, <xref ref-type="bibr" rid="CR57">57</xref>] and blob detection (2D clumps) in image analysis [<xref ref-type="bibr" rid="CR41">41</xref>, <xref ref-type="bibr" rid="CR58">58</xref>]. New methods can be proposed that make use of multiscale decomposition of graphs using Gaussian and wavelet-based techniques to build multiscale pyramid representations and statistical modeling of the clumps in these representations. On a separate note, the technical factors such as drop-out can have complex impact on detection and analysis of CNVs and should be carefully analyzed and interpreted because they can provide useful biological insight into detection of malignant cells and rare cell populations [<xref ref-type="bibr" rid="CR52">52</xref>].</p>
    <p id="Par71">It is useful to place XCVATR in the context of other tools that use variants detected from RNA-seq data for downstream applications, such as building phylogenetic trees and cell clustering [<xref ref-type="bibr" rid="CR27">27</xref>], identifying phenotype-genotype associations [<xref ref-type="bibr" rid="CR59">59</xref>], and measuring allele-specific expression [<xref ref-type="bibr" rid="CR60">60</xref>]. Critically, although variant detection and variant-level analysis of scRNA-seq data have been reported in a number of studies, XCVATR can be distinguished from other available methods based on two major differences. First, these methods require variants to be identified a priori using specialized pipelines that require variant callers, such as GATK or Mutect. However, we believe that these pipelines can be too stringently tuned, and thus may miss low-frequency variants, such as those present in tumor samples [<xref ref-type="bibr" rid="CR61">61</xref>]. This is reasonable since these pipelines aim to identify variants that can be used in any context. Appropriate stringency is particularly important for detecting somatic variants vs. germline variants (i.e.<italic>,</italic> those present in normal tissues), as somatic variants may be expressed at very low AFs in RNA-seq data. To circumvent this, XCVATR utilizes a general and relaxed variant detection approach and allows user control of the SNV/indel detection parameters. In addition, these variants are used only in the context of clump detection and are filtered by the XCVATR downstream clump-detection criteria. We therefore expect that XCVATR will be most useful for samples with high somatic heterogeneity, such as tumor samples.</p>
    <p id="Par72">A second feature that distinguishes XCVATR from other methods is that many of these existing approaches focus primarily on SNVs and indels, with only very limited attention to CNVs. Although these other methods could be adapted to cluster cells with respect to CNVs, this is not a trivial change, as CNVs exhibit very different statistics compared to SNVs/indels. We have accounted for these differences in XCVATR and included CNV analysis as an integral part of our pipeline. Overall, we show that XCVATR provides a complete workflow for detection, annotation, filtering, analysis, and visualization of large- and small-scale variants in both bulk and scRNA-seq data, which is advantageous for ease of usage and installation. Further, our data suggest that XCVATR can provide valuable insight into associations between variant alleles and cellular transcriptional states, particularly for heterogeneous samples containing rare variants, such as tumors.</p>
  </sec>
  <sec id="Sec20">
    <title>Conclusions</title>
    <p id="Par73">Detection of variant association within expression embedding provides important insight into how transcriptional programs are impacted by variation. In addition, our analysis has provided evidence that variants detected at the cellular level can be useful for comparing different cell types in terms of variant impact and burden. The presented method is flexible and can be integrated into analyses of single and bulk-level RNA-sequencing datasets.</p>
  </sec>
  <sec id="Sec21">
    <title>Methods</title>
    <p id="Par74">XCVATR takes aligned BAM-formatted mapped-read files as input. Bulk datasets that contain many BAM files, such as those with one BAM file per sample, can also be input to XCVATR. XCVATR makes use of SAMtools to process BAM files and depends on a SAMtools installation. XCVATR also depends on an R installation for visualization of results.</p>
    <sec id="Sec22">
      <title>Quantification and distance matrix generation</title>
      <p id="Par75">As the first step, reads for each gene from each cell (or sample) are counted. XCVATR makes extensive use of the “CB:Z:” tag that is assigned by the CellRanger software suite for assigning reads to different cells. This tag is also used internally by XCVATR to process bulk samples, so that the same implementation can handle single-cell and bulk samples. The count matrix is used for generating an embedding of the cells in lower dimensions that will be used for detection of variant clumps on the embeddings. The count matrix can also be used for building a cell-to-cell distance matrix. Currently, XCVATR is able to generate t-SNE- and UMAP [<xref ref-type="bibr" rid="CR62">62</xref>]-based embeddings of cells in lower dimensions and can use the distances from these embeddings. For single-cell datasets, XCVATR can also use the SEURAT package to generate the t-SNE/PCA/UMAP-based embeddings, and for bulk samples, it utilizes the “rtsne” function in R.</p>
    </sec>
    <sec id="Sec23">
      <title>Variant detection and annotation</title>
      <p id="Par76">XCVATR generates coverage pileups for each nucleotide at each position to detect variants. This step can be optionally skipped if there is an existing variant call set (i.e.<italic>,</italic> a VCF file) generated by another pipeline, such as GATK [<xref ref-type="bibr" rid="CR34">34</xref>] or Mutect [<xref ref-type="bibr" rid="CR35">35</xref>]. Users can provide these as input and skip the variant detection step.</p>
    </sec>
    <sec id="Sec24">
      <title>SNV detection</title>
      <p id="Par77">To identify SNVs, reads are first deduplicated (by default using SAMtools) and mapping-quality filtered reads (mapping quality &gt; 30, by default) from all cells are used to generate strand-specific pileups at each position on the genome. That is, reads mapping only to the positive and negative strand are used to build the positive-strand and negative-strand pileups, respectively. Next, positions on the pileups are filtered with respect to a minimum alternate AF cutoff and a minimum number of reads that support alternate alleles. XCVATR also filters variants with respect to strand bias, using the strand-specific pileups. Stranded RNA-seq signals must be analyzed without the strand bias parameter. By default, XCVATR uses a total read coverage of at least 10 and a minimum of four mutation-supporting alternative reads, with a minimum alternative AF of 0.2. This filtering-based variant calling method is similar to that used by the VarScan suite of variant callers. For single-cell datasets, XCVATR identifies variants from a BAM file containing the reads from all cells, whereas for bulk datasets, XCVATR analyzes each file/sample separately.</p>
    </sec>
    <sec id="Sec25">
      <title>Indel detection</title>
      <p id="Par78">XCVATR scans all reads and identifies those that support indels by inspecting CIGAR strings in each read. Indel-containing reads are clustered to identify insertions and deletions and then filtered with respect to mapQ, AF, and strand bias.</p>
    </sec>
    <sec id="Sec26">
      <title>Variant annotation</title>
      <p id="Par79">XCVATR uses a GTF- or GFF-formatted annotation file and annotates variants based on their impact on protein-coding sequences. Currently, XCVATR does not annotate impact of non-coding elements. XCVATR maps variants onto the transcripts that are specified in the GTF/GFF files. Variants are then classified with respect to their location: coding sequence (CDS), splice site (two nucleotides at the 5′ and 3′ ends of introns), start/stop codons. CDS mutations are mapped onto the gene sequence, and impacts on coding are evaluated. For SNVs, variants are classified as synonymous, non-synonymous, splice-altering, or start/stop loss; these are the most important impacts that can be assessed in XCVATR. For indels, variants are classified as frameshift/in-frame (CDS-overlapping length in a multiple of three indicates in-frame), splice-altering, or start/stop loss. We have performed extensive comparison of XCVATR annotations to annotations provided by VEP and observed very high concordance.</p>
    </sec>
    <sec id="Sec27">
      <title>Variant filtering</title>
      <p id="Par80">The mutations that are detected in previous step are filtered to decrease computational burden. XCVATR filters the variants by:<list list-type="order"><list-item><p id="Par81">dbSNP allele frequency lower than 1%</p></list-item><list-item><p id="Par82">Variant annotation belonging to one of the damaging classes, which are one of the classes<list list-type="alpha-lower"><list-item><p id="Par83">non-synonymous,</p></list-item><list-item><p id="Par84">nonsense (Early stop codon anywhere on the transcript),</p></list-item><list-item><p id="Par85">splice loss by acceptor/donor variants,</p></list-item><list-item><p id="Par86">inframe/frame-shift indels,</p></list-item><list-item><p id="Par87">stop-disruption.</p></list-item></list></p></list-item></list></p>
    </sec>
    <sec id="Sec28">
      <title>Allele counting</title>
      <p id="Par88">For SNVs and small indels, XCVATR counts the number of reads that support the corresponding variants from the BAM file. The “CB:Z” tag is used to assign reads to cells. For each variant, XCVATR tracks the number of reads supporting the alternate and reference alleles.</p>
      <p id="Par89">CNV variants are first separated into amplifications and deletions (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). For large-scale (chromosome arm length) CNVs, XCVATR makes use of the call matrix and generates a count matrix (similar to the allele count matrix) that indicates the existence of a deletion/amplification for the each of the 44 chromosomal arms. For segment-level CNVs, breakpoints of all CNV segments from all cells are pooled and sorted. The sorted breakpoint list is used to define the minimal set of CNV segments whose coordinates do not overlap with breakpoints (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b), and this minimal set of segments is used to build a binary count matrix similar to the large-scale matrix.</p>
    </sec>
    <sec id="Sec29">
      <title>Gene-level summarization of SNVs/Indels</title>
      <p id="Par90">Following allele counting, XCVATR iterates over each cell and each gene and assigns allele counts from mutations with the highest impact to each gene, as follows:<disp-formula id="Eque"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${sAF}_{g_l, cel{l}_i}=\underset{\left\{\forall \operatorname{var}\in {\textrm{V}}_{{\textrm{g}}_{\textrm{l}}}\right\}}{\max}\left({vAF}_{cel{l}_i}^{va{r}_k}\ |\ {vAF}_{cel{l}_i}^{va{r}_k}&gt;0;\forall va{r}_m\in {V}_{g_l}, impact\left( va{r}_k\right)&gt; impact\left( va{r}_m\right)\right)$$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">sAF</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">max</mml:mo><mml:mfenced close="}" open="{"><mml:mo>∀</mml:mo><mml:mo>var</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mtext>V</mml:mtext><mml:msub><mml:mtext>g</mml:mtext><mml:mtext>l</mml:mtext></mml:msub></mml:msub></mml:mfenced></mml:munder><mml:mfenced close=")" open="("><mml:msubsup><mml:mrow><mml:mi mathvariant="italic">vAF</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mspace width="4pt"/><mml:mo stretchy="false">|</mml:mo><mml:mspace width="4pt"/></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="italic">vAF</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>;</mml:mo><mml:mo>∀</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mfenced close=")" open="("><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mfenced close=")" open="("><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mfenced></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12864_2022_9004_Article_Eque.gif" position="anchor"/></alternatives></disp-formula>where the summarized AF for gene <italic>g</italic><sub><italic>l</italic></sub> is set as the AF of the variant <italic>k</italic> whose impact is highest among the variants that overlap with <italic>g</italic><sub><italic>l</italic></sub>, which are denoted by <inline-formula id="IEq13"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${V}_{g_l}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi>V</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12864_2022_9004_Article_IEq13.gif"/></alternatives></inline-formula>. This gene-level summarization accounts for the positioning of the variants and removes some of the information. It is worth noting that summarization is an optional step, as clump detection can be performed at the variant level.</p>
    </sec>
    <sec id="Sec30">
      <title>COSMIC variant frequency assignment to cells</title>
      <p id="Par91">XCVATR can also be used to summarize multiple mutations to analyze different variant-sets. We used COSMIC catalog of cancer variants as it is most prevalent to cancer genomics. XCVATR first overlaps all the detected mutations with COSMIC catalog of variants. Next, for each cell, XCVATR calculates the fraction of COSMIC variants that harbor expression above a certain cutoff. Finally, each cell is assigned an “expressed COSMIC variant fraction” that is calculated as the total number of COSMIC variants expressed in the cell divided by all of the COSMIC mutations in the sample.</p>
    </sec>
    <sec id="Sec31">
      <title>Smoothing scale selection on the embedding</title>
      <p id="Par92">Each scale in the multiscale clump analysis defines the neighborhood around a cell and is used to determine the size of the Gaussian filter around the center cell. Scales are selected to match the scale of the distance metric (or the embedding coordinates). For each cell, XCVATR identifies the <italic>N</italic><sub><italic>ν</italic></sub> cells that are closest neighbors and calculates neighborhood sizes that cover between 1% (or 10 cells, if lower) and 10% of the cells in the sample (<italic>N</italic><sub><italic>cells</italic></sub>), as follows<disp-formula id="Equf"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left(0.1\times {N}_{cells}\right)&gt;{N}_{\nu }&gt;\max \left(0.01\times {N}_{cells},10\right)$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mrow><mml:mfenced close=")" open="("><mml:mn>0.1</mml:mn><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">cells</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>ν</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mo movablelimits="true">max</mml:mo><mml:mfenced close=")" open="("><mml:mn>0.01</mml:mn><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">cells</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>10</mml:mn></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12864_2022_9004_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par93">It then computes each neighborhood radius, which is defined as the distance from the furthest cell to the current center cell. The minimum and maximum scales (<italic>σ</italic><sub><italic>min</italic></sub>, <italic>σ</italic><sub><italic>max</italic></sub>) are defined as the median of the neighborhood radii of all cells computed at the minimum and maximum neighborhood sizes <italic>N</italic><sub><italic>ν</italic></sub> defined above. These scales are used for smoothing the AFs and identifying the variant clumps.</p>
    </sec>
    <sec id="Sec32">
      <title>Variant clump candidate selection</title>
      <p id="Par94">Given a smoothing scale <italic>σ</italic><sub><italic>a</italic></sub> at the scale <italic>a</italic>, XCVATR computes a smoothed AF value for each cell using Gaussian filtering around the cell, as follows:<disp-formula id="Equg"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{\phi}}_i^{(a)}=\frac{1}{\left|{N}_{\nu}^{(a)}(i)\right|}\times {\sum}_{k\in {N}_{\nu}^{(a)}(i)\backslash i}{\phi}_j\times \exp \left(-\frac{d_{i,j}^2}{\sigma_a^2}\right)$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mrow><mml:msubsup><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mfenced close="|" open="|"><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mfrac><mml:mo>×</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">\</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mfrac><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12864_2022_9004_Article_Equg.gif" position="anchor"/></alternatives></disp-formula>where <italic>ϕ</italic><sub><italic>j</italic></sub> denotes that alternative AF of the variant in the <italic>j</italic><sup><italic>th</italic></sup> cell (1 &gt; <italic>ϕ</italic><sub><italic>j</italic></sub> &gt; 0), <italic>d</italic><sub><italic>i</italic>, <italic>j</italic></sub> denotes the distance between the <italic>i</italic><sup><italic>th</italic></sup> and <italic>j</italic><sup><italic>th</italic></sup> cells in the sample, and <inline-formula id="IEq14"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{\nu}^{(a)}(i)$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9004_Article_IEq14.gif"/></alternatives></inline-formula> indicates the set of indices for the cells that are in the vicinity of the <italic>i</italic><sup><italic>th</italic></sup> cell for the scale <italic>a</italic>. XCVATR then identifies candidate clump centers as the cells whose smoothed AF is a local maximum among its neighbors (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c, step 2), as follows:<disp-formula id="Equh"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_a=\left\{i\left|\forall j\in {N}_{\nu}^{(a)}(i):{\overline{\phi}}_i^{(a)}&gt;{\overline{\phi}}_j^{(a)}\right.\right\}$$\end{document}</tex-math><mml:math id="M44" display="block"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mi>i</mml:mi><mml:mfenced open="|"><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:msubsup><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfenced></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12864_2022_9004_Article_Equh.gif" position="anchor"/></alternatives></disp-formula>where <italic>C</italic><sub><italic>a</italic></sub> denotes the indices of cells that are clump centers.</p>
    </sec>
    <sec id="Sec33">
      <title>Specification of position and size of clumps</title>
      <p id="Par95">The scale at which a clump is discovered (i.e.<italic>, σ</italic><sub><italic>a</italic></sub>) is used to define the initial size of each clump.</p>
    </sec>
    <sec id="Sec34">
      <title>Variant clump evaluation by RD-aware permutation</title>
      <p id="Par96">For clump center candidate cell <italic>C</italic><sub><italic>a</italic></sub> (<italic>a</italic><sup><italic>th</italic></sup> scale), XCVATR permutes the AFs <italic>Κ</italic> times and computes the smoothed AF for every candidate. XCVATR then computes a <italic>z</italic>-score that is used to rank the clumps, as follows:<disp-formula id="Equi"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Z}_{\phi }=\frac{{\overline{\phi}}_i^{(a)}-{\mu}_{\phi }}{\delta_{\phi }}$$\end{document}</tex-math><mml:math id="M46" display="block"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>ϕ</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>ϕ</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12864_2022_9004_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par97">AFs of cells whose coverage is greater than <italic>τ</italic> are used for shuffling, whereas other cells are not shuffled and are not used for the permutation test. This allows XCVATR to control for RD biases.</p>
    </sec>
    <sec id="Sec35">
      <title>Read-level enrichment of alternate allele expression in clumps</title>
      <p id="Par98">XCVATR first counts the total number of alternative and reference reads in all cells. These represent the baseline (bulk) read-level alternate AF. For each clump, the total alternate allele-supporting reads and total reads are counted. At scale <italic>a</italic>, for the <italic>b</italic><sup><italic>th</italic></sup> clump, these are used to compute the read-level modified binomial <italic>P</italic>-value, as follows:<disp-formula id="Equj"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Bin\left({n}_{alt}^{\left(a;b\right)},{n}_{ref}^{\left(a;b\right)};p=A{F}_{alt}^{(bulk)}\right)={\sum}_{\begin{array}{c}{n}_{alt}^{\left(a;b\right)}&gt;r&gt;1;\\ {}t=\left({n}_{ref}^{\left(a;b\right)}+{n}_{alt}^{\left(a;b\right)}-r\right)\end{array}}\left(\begin{array}{c}{n}_{ref}^{\left(a;b\right)}+{n}_{alt}^{\left(a;b\right)}\\ {}i\end{array}\right){p}^r\times {\left(1-p\right)}^t$$\end{document}</tex-math><mml:math id="M48" display="block"><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">alt</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup><mml:mo>;</mml:mo><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="italic">alt</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">alt</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mi>r</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow/><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">alt</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup><mml:mo>-</mml:mo><mml:mi>r</mml:mi></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">alt</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow/><mml:mi>i</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msup><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mfenced></mml:mrow><mml:mi>t</mml:mi></mml:msup></mml:mrow></mml:math><graphic xlink:href="12864_2022_9004_Article_Equj.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq15"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{ref}^{\left(a;b\right)}$$\end{document}</tex-math><mml:math id="M50"><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2022_9004_Article_IEq15.gif"/></alternatives></inline-formula> and <inline-formula id="IEq16"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{alt}^{\left(a;b\right)}$$\end{document}</tex-math><mml:math id="M52"><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">alt</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2022_9004_Article_IEq16.gif"/></alternatives></inline-formula> denote the number of reads that support alternate and the reference alleles, respectively. For the corresponding variant in the <italic>b</italic><sup><italic>th</italic></sup> clump identified in scale <italic>a</italic>:<disp-formula id="Equk"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{ref}^{\left(a;b\right)}={\sum}_{j\in {N}_v^{\left(a;b\right)}}{n}_{ref}(j),{n}_{alt}^{\left(a;b\right)}={\sum}_{j\in {N}_v^{\left(a;b\right)}}{n}_{alt}(j)$$\end{document}</tex-math><mml:math id="M54" display="block"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mi>v</mml:mi><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">alt</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mi>v</mml:mi><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">alt</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12864_2022_9004_Article_Equk.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq17"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_v^{\left(a;b\right)}$$\end{document}</tex-math><mml:math id="M56"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>v</mml:mi><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2022_9004_Article_IEq17.gif"/></alternatives></inline-formula> denotes the neighborhood of the cell at the center of clump <italic>b</italic> at the scale <italic>a</italic>, and <italic>n</italic><sub><italic>ref</italic></sub>(<italic>j</italic>) indicates the number of reference alleles in cell <italic>j</italic>. In the above equation, the flip probability is chosen as <inline-formula id="IEq18"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p=A{F}_{bulk}=\frac{n_{alt}^{(bulk)}}{n_{alt}^{(bulk)}+{n}_{ref}^{(bulk)}}$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="italic">bulk</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">alt</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">alt</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9004_Article_IEq18.gif"/></alternatives></inline-formula>, which represents the alternative AF of the variant in the whole bulk sample. The binomial <italic>P</italic>-value estimates enrichment of the alternative allele-supporting reads in the clump <italic>b</italic> when compared to randomly assigning reads to all cells with probability <italic>p</italic> = <italic>AF</italic><sub><italic>bulk</italic></sub>.</p>
    </sec>
    <sec id="Sec36">
      <title>Cell-level enrichment of alternate allele expression in the clumps</title>
      <p id="Par99">At scale <italic>a</italic>, XCVATR counts the cells in clump <italic>b</italic> with alternative AFs above <italic>η</italic> (By default 0.5). Next, XCVATR counts the number of cells in the whole sample for which the alternative AF is above <italic>η</italic>. These values are used to compute a significance of the enrichment of alternative alleles at cell level using Fisher’s exact test, as follows:<disp-formula id="Equl"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F{E}^{\left(a;b\right)}= FE\left({c}_{\eta}^{\left(a;b\right)}(j),{c}_0^{\left(a;b\right)}(j);{c}_{\eta}^{(bulk)},{c}_0^{(bulk)}\right)$$\end{document}</tex-math><mml:math id="M60" display="block"><mml:mrow><mml:mi>F</mml:mi><mml:msup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msup><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mn>0</mml:mn><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>;</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12864_2022_9004_Article_Equl.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq19"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{\eta}^{\left(a;b\right)}(j)$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9004_Article_IEq19.gif"/></alternatives></inline-formula> indicates the number of cells in clump <italic>b</italic> at scale <italic>a</italic>, for which AF exceeds <italic>η</italic>:<disp-formula id="Equm"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{\eta}^{\left(a;b\right)}(j)={\sum}_jI\left({\phi}_j^{\left(a;b\right)}&gt;\eta \right).$$\end{document}</tex-math><mml:math id="M64" display="block"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>j</mml:mi><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>;</mml:mo><mml:mi>b</mml:mi></mml:mfenced></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mi>η</mml:mi></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12864_2022_9004_Article_Equm.gif" position="anchor"/></alternatives></disp-formula>and <inline-formula id="IEq20"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{\eta}^{(bulk)}$$\end{document}</tex-math><mml:math id="M66"><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2022_9004_Article_IEq20.gif"/></alternatives></inline-formula> denotes the number of cells among all the cells (i.e.<italic>,</italic> bulk) for which the AF exceeds <italic>η</italic>. The read-level and cell-level enrichment estimates are used to filter out clumps that exhibit low levels of enrichment in comparison to the bulk sample at read and cell (or sample) level.</p>
    </sec>
    <sec id="Sec37">
      <title>Filtering of the clumps detected by XCVATR</title>
      <p id="Par100">We recommend downstream filtering of the clumps identified by XCVATR and further visualization to make sure relevant clumps are properly assessed. We suggest using the assigned clump z-score (greater than 2), number of cells that harbor the mutation (greater than 10), and cell-level and read-level significance <italic>p</italic>-values (Smaller than 5%). The users can choose to adjust these filters since different datasets may have higher or lower coverage of mutations and some cell populations may be rare.</p>
    </sec>
    <sec id="Sec38">
      <title>Visualization</title>
      <p id="Par101">XCVATR makes use of R scripts to visualize clumps on the embedding coordinates. The visualization utilities are implemented in R and directly make use of the data generated by XCVATR.</p>
    </sec>
    <sec id="Sec39">
      <title>Clump simulation for testing clump detection accuracy</title>
      <p id="Par102">Clump simulation starts by selection of a random cell among the 1170 cells in BT_S2 sample of Darmanis et al. dataset [<xref ref-type="bibr" rid="CR43">43</xref>]. Given the simulated clump center cell, we then shuffle the AFs of all other cells based on their distance and AFs. This shuffling is performed by starting from the closest neighbor of the clump center, randomly sampling a cell to this position (without replacement), then moving to the next neighbor. It is repeated until no cells are left without an AF. To simulate a clump shape, we used two parameters while sampling: “distance weight”, <italic>δ</italic>, and “AF weight”, <italic>α</italic>. Given that we are sampling the AF for the cell whose distance to the clump center is <italic>d</italic><sub><italic>i</italic></sub>, the weight of the cell is assigned as:<disp-formula id="Equn"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_i= pow\left({\phi}_i,\alpha \cdot \exp \left(-1\cdot \delta \cdot {d}_i\right)\right),$$\end{document}</tex-math><mml:math id="M68" display="block"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>·</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>·</mml:mo><mml:mi>δ</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12864_2022_9004_Article_Equn.gif" position="anchor"/></alternatives></disp-formula>where <italic>w</italic><sub><italic>i</italic></sub> denotes the weight for the <italic>i</italic><sup><italic>th</italic></sup> cell, and <italic>pow</italic>(<italic>a</italic>, <italic>b</italic>) = <italic>a</italic><sup><italic>b</italic></sup>. Sampling weights are proportional to the probability of selecting the cells, and at long distances (i.e., large <italic>d</italic><sub><italic>i</italic></sub>), the sampling weights of all cells (regardless of <italic>ϕ</italic><sub><italic>i</italic></sub>) are almost equal to each other (i.e., <italic>w</italic><sub><italic>i</italic></sub> = 1). When the distance to the simulated clump center is small, sampling weights for cells with higher AFs are higher compared to sampling weights for cells with lower AFs, such that shuffling “attracts” high AFs closer to the clump center. After sampling weights are assigned to all cells, a cell is randomly selected, whereby the probability of the selected cell <italic>i</italic> is proportional to <italic>w</italic><sub><italic>i</italic></sub>. The selected cell’s alternative and reference allele counts are copied to the current cell-of-focus (at distance <italic>d</italic><sub><italic>i</italic></sub>), and the selected cell is removed from the list of cells to ensure the same cell is not assigned twice. This sampling process is continued until all cells are assigned with an AF.</p>
    </sec>
    <sec id="Sec40">
      <title>CNV calling by CaSpER</title>
      <p id="Par103">The CaSpER [<xref ref-type="bibr" rid="CR11">11</xref>] algorithm was used to detect CNVs. For each dataset, normal cells (e.g., immune cells) are used as controls to identify somatic CNVs in tumor cells.</p>
    </sec>
    <sec id="Sec41">
      <title>Single-cell meningioma analysis</title>
      <p id="Par104">Postal and frontal meningioma samples were sequenced at the MD Anderson Epigenetics Core. CellRanger was run with default parameters, and we then used default parameters in the SEURAT package to filter out dead cells and doublets and generate the UMAP embedding of tumor cells.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec42">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12864_2022_9004_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: Supplementary Table 1.</bold> The list of deletion clumps detected by XCVATR in Darmanis et al. dataset. We report the large-scale deletions, the reported z-score, number of cells that support the deletion, and the scale at which the clump is detected. <bold>Supplementary Table 2.</bold> The list of amplification clumps detected by XCVATR in Darmanis et al. dataset. We report the large-scale amplifications, the reported z-score, number of cells that support the amplification, and the scale at which the clump is detected. <bold>Supplementary Table 3.</bold> The gene-level variant clumps detected in Darmanis et al. dataset. The impacted genes, z-score, number of cells with gene mutation, and the clump scale is reported. <bold>Supplementary Figure 1.</bold> Left panel shows the embedding coordinates for each chromosome that is used by XCVATR to search for potential amplification clumps. Color scale indicates the smoothed allele frequency of the amplification in the vicinity of the candidate clump center. Chromosomes with strong clump candidate centers are depicted with red rectangles. Right panel shows the distribution of the smoothed allele frequency around the candidate clump centers at each chromosome. <bold>Supplementary Figure 2.</bold> Left panel shows the embedding coordinates for each chromosome that is used by XCVATR to search for potential deletion clumps. Color scale indicates the smoothed allele frequency of the amplification in the vicinity of the candidate clump center. Right panel shows the distribution of the smoothed allele frequency around the candidate clump centers at each chromosome. <bold>Supplementary Figure 3.</bold> Estimated drop-out rate for each chromosome in meningioma samples. X-axis shows the chromosome and y-axis shows the estimate of drop-out rates.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>XCVATR</term>
        <def>
          <p id="Par4">Expressed Clusters of Variant Alleles in Transcriptome Profiles</p>
        </def>
      </def-item>
      <def-item>
        <term>GATK</term>
        <def>
          <p id="Par5">Genome analysis toolkit</p>
        </def>
      </def-item>
      <def-item>
        <term>dbSNP</term>
        <def>
          <p id="Par6">The single nucleotide polymorphism database</p>
        </def>
      </def-item>
      <def-item>
        <term>GTF/GFF</term>
        <def>
          <p id="Par7">Gene transfer format / General feature format</p>
        </def>
      </def-item>
      <def-item>
        <term>COSMIC</term>
        <def>
          <p id="Par8">Catalog of somatic mutations in cancer</p>
        </def>
      </def-item>
      <def-item>
        <term>t-SNE</term>
        <def>
          <p id="Par9">t-distributed stochastic neighbor embedding</p>
        </def>
      </def-item>
      <def-item>
        <term>UMAP</term>
        <def>
          <p id="Par10">Uniform manifold approximation and projection</p>
        </def>
      </def-item>
      <def-item>
        <term>PCA</term>
        <def>
          <p id="Par11">Principal component analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>eQTL</term>
        <def>
          <p id="Par12">Expression Quantitative Trait Locus</p>
        </def>
      </def-item>
      <def-item>
        <term>CDS</term>
        <def>
          <p id="Par13">Coding sequence</p>
        </def>
      </def-item>
      <def-item>
        <term>RD</term>
        <def>
          <p id="Par14">Read depth</p>
        </def>
      </def-item>
      <def-item>
        <term>AF</term>
        <def>
          <p id="Par15">Allele frequency</p>
        </def>
      </def-item>
      <def-item>
        <term>MAF</term>
        <def>
          <p id="Par16">Minor allele frequency</p>
        </def>
      </def-item>
      <def-item>
        <term>RNA-seq</term>
        <def>
          <p id="Par17">RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>scRNA-seq</term>
        <def>
          <p id="Par18">Single cell RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>CNV</term>
        <def>
          <p id="Par19">Copy number variant</p>
        </def>
      </def-item>
      <def-item>
        <term>SNV</term>
        <def>
          <p id="Par20">Single nucleotide variant</p>
        </def>
      </def-item>
      <def-item>
        <term>Indel</term>
        <def>
          <p id="Par21">Insertion/deletion</p>
        </def>
      </def-item>
      <def-item>
        <term>BAM</term>
        <def>
          <p id="Par22">Binary alignment map</p>
        </def>
      </def-item>
      <def-item>
        <term>SAM</term>
        <def>
          <p id="Par23">Sequence alignment map</p>
        </def>
      </def-item>
      <def-item>
        <term>HMM</term>
        <def>
          <p id="Par24">Hidden Markov model</p>
        </def>
      </def-item>
      <def-item>
        <term>mapQ</term>
        <def>
          <p id="Par25">Mapping quality</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Arif Harmanci and Akdes Serin Harmanci contributed equally to this work.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We acknowledge the support and thank the Information Technology Department of The University of Texas Health Science Center Houston.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>AH and ASH conceived the methodological ideas, gathered datasets, and designed and implemented experiments. AJP and TJK collected samples, prepared libraries, and for single cell sequencing, generated the datasets. AH and ASH drafted the manuscript. All authors edited and approved the final manuscript.</p>
    <sec id="FPar1">
      <title>Authors’ information</title>
      <p id="Par105">Not Applicable.</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>During this work, AH was supported by startup funds from The University of Texas Health Science Center, Houston. ASH was supported by startup funds from Baylor College of Medicine. AJP was supported by the NINDS (K08NS102474) and the Roderick D. MacDonald Fund. The Human Tissue Acquisition &amp; Pathology Core at Baylor College of Medicine is funded through P30 Cancer Center Support Grant NCI-CA125123. The funding bodies played no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The scRNA-seq datasets from Darmanis et al. [<xref ref-type="bibr" rid="CR43">43</xref>] are available from the Gene Expression Omnibus (GEO) database with the accession number: GSE84465. 160 sample Meningioma RNA-seq dataset is downloaded from Patel et al. [<xref ref-type="bibr" rid="CR42">42</xref>] The 10X single cell sequencing data and the sample information for 2 meningioma tumors are deposited to GEO database under accession identifier GSE213544.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par106">All patients provided written informed consent, and tumor tissues were collected under the protocol number H-35355 that was reviewed and approved by an institutional review board (IRB) at Baylor College of Medicine. All procedures performed in studies involving human participant were in accordance with the ethical standards of the Baylor College of Medicine and with the 1964 Helsinki declaration and its later amendments or comparable ethical standards.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent for publication</title>
      <p id="Par107">Not applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par108">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lunnon</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A blood gene expression marker of early Alzheimer’s disease</article-title>
        <source>J Alzheimers Dis</source>
        <year>2013</year>
        <volume>33</volume>
        <fpage>737</fpage>
        <lpage>753</lpage>
        <pub-id pub-id-type="doi">10.3233/JAD-2012-121363</pub-id>
        <pub-id pub-id-type="pmid">23042217</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arisi</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene expression biomarkers in the brain of a mouse model for Alzheimer’s disease: mining of microarray data by logic classification and feature selection</article-title>
        <source>J Alzheimers Dis</source>
        <year>2011</year>
        <volume>24</volume>
        <fpage>721</fpage>
        <lpage>738</lpage>
        <pub-id pub-id-type="doi">10.3233/JAD-2011-101881</pub-id>
        <pub-id pub-id-type="pmid">21321390</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identifying critical transitions and their leading biomolecular networks in complex diseases</article-title>
        <source>Sci Rep</source>
        <year>2012</year>
        <volume>2</volume>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/srep00813</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>ZP</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Aihara</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Detecting early-warning signals for sudden deterioration of complex diseases by dynamical network biomarkers</article-title>
        <source>Sci Rep</source>
        <year>2012</year>
        <volume>2</volume>
        <fpage>1</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/srep00342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fielden</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Zacharewski</surname>
            <given-names>TR</given-names>
          </name>
        </person-group>
        <article-title>Challenges and limitations of gene expression profiling in mechanistic and predictive toxicology</article-title>
        <source>Toxicol Sci</source>
        <year>2001</year>
        <volume>60</volume>
        <fpage>6</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1093/toxsci/60.1.6</pub-id>
        <pub-id pub-id-type="pmid">11222867</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>
        <source>Nat Rev Genet</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2484</pub-id>
        <pub-id pub-id-type="pmid">19015660</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Deelen P, et al. Calling genotypes from public RNA-sequencing data enables identification of genetic variants that affect gene-expression levels. Genome Med. 2015;7:1-13.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rozowsky</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>AlleleSeq: analysis of allele-specific expression and binding in a network framework</article-title>
        <source>Mol Syst Biol</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>522</fpage>
        <pub-id pub-id-type="doi">10.1038/msb.2011.54</pub-id>
        <pub-id pub-id-type="pmid">21811232</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ardlie</surname>
            <given-names>KG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The genotype-tissue expression (GTEx) pilot analysis: multitissue gene regulation in humans</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>348</volume>
        <issue>80</issue>
        <fpage>648</fpage>
        <lpage>660</lpage>
        <pub-id pub-id-type="pmid">25954001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Piskol</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ramaswami</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Reliable identification of genomic variants from RNA-seq data</article-title>
        <source>Am J Hum Genet</source>
        <year>2013</year>
        <volume>93</volume>
        <fpage>641</fpage>
        <lpage>651</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2013.08.008</pub-id>
        <pub-id pub-id-type="pmid">24075185</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Serin Harmanci</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Harmanci</surname>
            <given-names>AO</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>CaSpER identifies and visualizes CNV events by integrative analysis of single-cell or bulk RNA-sequencing data</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-13779-x</pub-id>
        <pub-id pub-id-type="pmid">31911652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>La Manno</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA velocity of single cells</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>560</volume>
        <fpage>494</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0414-6</pub-id>
        <pub-id pub-id-type="pmid">30089906</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saelens</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cannoodt</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Todorov</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>A comparison of single-cell trajectory inference methods</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>547</fpage>
        <lpage>554</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0071-9</pub-id>
        <pub-id pub-id-type="pmid">30936559</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taliun</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sequencing of 53,831 diverse genomes from the NHLBI TOPMed program</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>590</volume>
        <fpage>290</fpage>
        <lpage>299</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-03205-y</pub-id>
        <pub-id pub-id-type="pmid">33568819</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Consortium</surname>
            <given-names>TG</given-names>
          </name>
        </person-group>
        <article-title>The genotype-tissue expression (GTEx) project</article-title>
        <source>Nat Genet</source>
        <year>2013</year>
        <volume>45</volume>
        <fpage>580</fpage>
        <lpage>585</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2653</pub-id>
        <pub-id pub-id-type="pmid">23715323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aguet</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genetic effects on gene expression across human tissues</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>550</volume>
        <fpage>204</fpage>
        <lpage>213</lpage>
        <pub-id pub-id-type="doi">10.1038/nature24277</pub-id>
        <pub-id pub-id-type="pmid">29022597</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ziegenhain</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparative analysis of single-cell RNA sequencing methods</article-title>
        <source>Mol Cell</source>
        <year>2017</year>
        <volume>65</volume>
        <fpage>631</fpage>
        <lpage>643.e4</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2017.01.023</pub-id>
        <pub-id pub-id-type="pmid">28212749</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Single cell analysis: from technology to biology and medicine</article-title>
        <source>Single Cell Biol</source>
        <year>2014</year>
        <volume>3</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ning</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-seq technologies and related computational data analysis</article-title>
        <source>Front Genet</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>317</fpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2019.00317</pub-id>
        <pub-id pub-id-type="pmid">31024627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hie</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computational methods for single-cell RNA sequencing</article-title>
        <source>Annu Rev Biomed Data Sci</source>
        <year>2020</year>
        <volume>3</volume>
        <fpage>339</fpage>
        <lpage>364</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-biodatasci-012220-100601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duò</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A systematic performance evaluation of clustering methods for single-cell RNA-seq data</article-title>
        <source>F1000Research</source>
        <year>2020</year>
        <volume>7</volume>
        <fpage>1141</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.15666.3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Nabavi</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Comparative analysis of differential gene expression analysis tools for single-cell RNA sequencing data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>40</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-019-2599-6</pub-id>
        <pub-id pub-id-type="pmid">30658573</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdelaal</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>194</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1795-z</pub-id>
        <pub-id pub-id-type="pmid">31500660</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Argelaguet</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cuomo</surname>
            <given-names>ASE</given-names>
          </name>
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Computational principles and challenges in single-cell data integration</article-title>
        <source>Nat Biotechnol</source>
        <year>2021</year>
        <volume>39</volume>
        <fpage>1202</fpage>
        <lpage>1215</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-021-00895-7</pub-id>
        <pub-id pub-id-type="pmid">33941931</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luecken</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Current best practices in single-cell RNA-seq analysis: a tutorial</article-title>
        <source>Mol Syst Biol</source>
        <year>2019</year>
        <volume>15</volume>
        <fpage>e8746</fpage>
        <pub-id pub-id-type="doi">10.15252/msb.20188746</pub-id>
        <pub-id pub-id-type="pmid">31217225</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Minn</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>NR</given-names>
          </name>
        </person-group>
        <article-title>DENDRO: genetic heterogeneity profiling and subclone detection by single-cell RNA sequencing</article-title>
        <source>Genome Biol</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>10</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1922-x</pub-id>
        <pub-id pub-id-type="pmid">31937348</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fasterius</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Uhlén</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Al-Khalili Szigyarto</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-seq variant analysis for exploration of genetic heterogeneity in cancer</article-title>
        <source>Sci Rep</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-019-45934-1</pub-id>
        <pub-id pub-id-type="pmid">30626917</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Petti</surname>
            <given-names>AA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A general approach for detecting expressed mutations in AML cells using single cell RNA-sequencing</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-11591-1</pub-id>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heiser</surname>
            <given-names>CN</given-names>
          </name>
          <name>
            <surname>Lau</surname>
            <given-names>KS</given-names>
          </name>
        </person-group>
        <article-title>A quantitative framework for evaluating single-cell data structure preservation by dimensionality reduction techniques</article-title>
        <source>Cell Rep</source>
        <year>2020</year>
        <volume>31</volume>
        <fpage>107576</fpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2020.107576</pub-id>
        <pub-id pub-id-type="pmid">32375029</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reimegård</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A combined approach for single-cell mRNA and intracellular protein expression analysis</article-title>
        <source>Commun Biol</source>
        <year>2021</year>
        <volume>4</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1038/s42003-021-02142-w</pub-id>
        <pub-id pub-id-type="pmid">33398033</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Specht</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell proteomic and transcriptomic analysis of macrophage heterogeneity using SCoPE2</article-title>
        <source>Genome Biol</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>50</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02267-5</pub-id>
        <pub-id pub-id-type="pmid">33504367</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koboldt</surname>
            <given-names>DC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>VarScan 2: somatic mutation and copy number alteration discovery in cancer by exome sequencing</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>568</fpage>
        <lpage>576</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.129684.111</pub-id>
        <pub-id pub-id-type="pmid">22300766</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koboldt</surname>
            <given-names>DC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>VarScan: variant detection in massively parallel sequencing of individual and pooled samples</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2283</fpage>
        <lpage>2285</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp373</pub-id>
        <pub-id pub-id-type="pmid">19542151</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The genome analysis toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>1297</fpage>
        <lpage>1303</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id>
        <pub-id pub-id-type="pmid">20644199</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cibulskis</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sensitive detection of somatic point mutations in impure and heterogeneous cancer samples</article-title>
        <source>Nat Biotechnol</source>
        <year>2013</year>
        <volume>31</volume>
        <fpage>213</fpage>
        <lpage>219</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2514</pub-id>
        <pub-id pub-id-type="pmid">23396013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McLaren</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Ensembl variant effect predictor</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>122</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0974-4</pub-id>
        <pub-id pub-id-type="pmid">27268795</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hakonarson</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>ANNOVAR: functional annotation of genetic variants from high-throughput sequencing data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>e164</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq603</pub-id>
        <pub-id pub-id-type="pmid">20601685</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sherry</surname>
            <given-names>ST</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DbSNP: the NCBI database of genetic variation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>308</fpage>
        <lpage>311</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/29.1.308</pub-id>
        <pub-id pub-id-type="pmid">11125122</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Multiscale median filter for image denoising</article-title>
        <source>International conference on signal processing proceedings, ICSP</source>
        <year>2010</year>
        <fpage>2617</fpage>
        <lpage>2620</lpage>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berry</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <article-title>FellWalker-A clump identification algorithm</article-title>
        <source>Astron Comput</source>
        <year>2015</year>
        <volume>10</volume>
        <fpage>22</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ascom.2014.11.004</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Collins</surname>
            <given-names>RT</given-names>
          </name>
        </person-group>
        <article-title>Mean-shift blob tracking through scale space</article-title>
        <source>2003 IEEE Comput. Soc. Conf. Comput. Vis. Pattern recognition, 2003. Proceedings</source>
        <year>2003</year>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patel</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular profiling predicts meningioma recurrence and reveals loss of DREAM complex repression in aggressive tumors</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2019</year>
        <volume>116</volume>
        <fpage>21715</fpage>
        <lpage>21726</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1912858116</pub-id>
        <pub-id pub-id-type="pmid">31591222</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darmanis</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-Seq analysis of infiltrating neoplastic cells at the migrating front of human glioblastoma</article-title>
        <source>Cell Rep</source>
        <year>2017</year>
        <volume>21</volume>
        <fpage>1399</fpage>
        <lpage>1410</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2017.10.030</pub-id>
        <pub-id pub-id-type="pmid">29091775</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">William H. Press, Saul A. Teukolsky, William T. Vetterling and Brian P. Flannery. Numerical recipes in C—the art of scientific computing. In: Comput Math with Appl, vol. 19. 1990.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive integration of single-cell data</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <fpage>1888</fpage>
        <lpage>1902.e21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Picelli</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Full-length RNA-seq from single cells using smart-seq2</article-title>
        <source>Nat Protoc</source>
        <year>2014</year>
        <volume>9</volume>
        <fpage>171</fpage>
        <lpage>181</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2014.006</pub-id>
        <pub-id pub-id-type="pmid">24385147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Phipson B, Zappia L, Oshlack A. Gene length and detection bias in single cell RNA sequencing protocols. F1000Research. 2017;6:595.</mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tate</surname>
            <given-names>JG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>COSMIC: the catalogue of somatic mutations in Cancer</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D941</fpage>
        <lpage>D947</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1015</pub-id>
        <pub-id pub-id-type="pmid">30371878</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thomas</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TCTN3 mutations cause Mohr-Majewski syndrome</article-title>
        <source>Am J Hum Genet</source>
        <year>2012</year>
        <volume>91</volume>
        <fpage>372</fpage>
        <lpage>378</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2012.06.017</pub-id>
        <pub-id pub-id-type="pmid">22883145</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Seshan</surname>
            <given-names>VE</given-names>
          </name>
          <name>
            <surname>Olshen</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>Package ‘DNAcopy’ title DNA copy number data analysis</source>
        <year>2021</year>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wong</surname>
            <given-names>KK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A comprehensive analysis of common copy-number variations in the human genome</article-title>
        <source>Am J Hum Genet</source>
        <year>2007</year>
        <volume>80</volume>
        <fpage>91</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="doi">10.1086/510560</pub-id>
        <pub-id pub-id-type="pmid">17160897</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qiu</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Embracing the dropouts in single-cell RNA-seq analysis</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-14976-9</pub-id>
        <pub-id pub-id-type="pmid">31911652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clark</surname>
            <given-names>VE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomic analysis of non-NF2 meningiomas reveals mutations in TRAF7, KLF4, AKT1, and SMO</article-title>
        <source>Science (80- )</source>
        <year>2013</year>
        <volume>339</volume>
        <fpage>1077</fpage>
        <lpage>1080</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1233009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hasan</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Performance evaluation of indel calling tools using real short-read data</article-title>
        <source>Hum Genomics</source>
        <year>2015</year>
        <volume>9</volume>
        <fpage>20</fpage>
        <pub-id pub-id-type="doi">10.1186/s40246-015-0042-2</pub-id>
        <pub-id pub-id-type="pmid">26286629</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chakraborty</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Arora</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Begg</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Using somatic variant richness to mine signals from rare variants in the cancer genome</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-13402-z</pub-id>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harmanci</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rozowsky</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>MUSIC: identification of enriched regions in ChIP-Seq experiments using a mappability-corrected multiscale signal processing framework</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>474</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0474-3</pub-id>
        <pub-id pub-id-type="pmid">25292436</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Knijnenburg</surname>
            <given-names>TA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiscale representation of genomic signals</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>689</fpage>
        <lpage>694</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2924</pub-id>
        <pub-id pub-id-type="pmid">24727652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Damerval</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Meignen</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Blob detection with wavelet maxima lines</article-title>
        <source>IEEE Signal Process Lett</source>
        <year>2007</year>
        <volume>14</volume>
        <fpage>39</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1109/LSP.2006.879830</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poirion</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ching</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Garmire</surname>
            <given-names>LX</given-names>
          </name>
        </person-group>
        <article-title>Using single nucleotide variations in single-cell RNA-seq to identify subpopulations and genotype-phenotype linkage</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-07170-5</pub-id>
        <pub-id pub-id-type="pmid">29317637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>SCALE: modeling allele-specific gene expression by single-cell RNA sequencing</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>74</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1200-8</pub-id>
        <pub-id pub-id-type="pmid">28446220</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systematic comparative analysis of single-nucleotide variant detection methods from single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>242</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1863-4</pub-id>
        <pub-id pub-id-type="pmid">31744515</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>McInnes</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Healy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Melville</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>UMAP: uniform manifold approximation and projection for dimension reduction</source>
        <year>2018</year>
      </element-citation>
    </ref>
  </ref-list>
</back>
