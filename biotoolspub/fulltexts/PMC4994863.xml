<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4994863</article-id>
    <article-id pub-id-type="pmid">27179027</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkw430</article-id>
    <article-categories>
      <subj-group subj-group-type="hwp-journal-coll">
        <subject>7</subject>
        <subject>9</subject>
        <subject>24</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Methods Online</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TSCAN: Pseudo-time reconstruction and evaluation in single-cell RNA-seq
analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ji</surname>
          <given-names>Zhicheng</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ji</surname>
          <given-names>Hongkai</given-names>
        </name>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <aff id="AFF1">Department of Biostatistics, Johns Hopkins University Bloomberg School of
Public Health, 615 North Wolfe Street, Baltimore, MD 21205, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="COR1"><label>*</label>To whom correspondence should be addressed. Tel: +1
4109553517; Fax: +1 4109550958; Email: <email>hji@jhu.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>27</day>
      <month>7</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>5</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>5</month>
      <year>2016</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>44</volume>
    <issue>13</issue>
    <fpage>e117</fpage>
    <lpage>e117</lpage>
    <history>
      <date date-type="accepted">
        <day>05</day>
        <month>5</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>10</day>
        <month>4</month>
        <year>2016</year>
      </date>
      <date date-type="received">
        <day>01</day>
        <month>9</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2016. Published by Oxford University Press on behalf of
Nucleic Acids Research.</copyright-statement>
      <copyright-year>2016</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative
Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted
reuse, distribution, and reproduction in any medium, provided the original work is
properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:title="pdf" xlink:href="gkw430.pdf"/>
    <abstract>
      <p>When analyzing single-cell RNA-seq data, constructing a pseudo-temporal path to order
cells based on the gradual transition of their transcriptomes is a useful way to study
gene expression dynamics in a heterogeneous cell population. Currently, a limited number
of computational tools are available for this task, and quantitative methods for comparing
different tools are lacking. Tools for Single Cell Analysis (TSCAN) is a software tool
developed to better support <italic>in silico</italic>
pseudo-<underline>T</underline>ime reconstruction in
<underline>S</underline>ingle-<underline>C</underline>ell RNA-seq
<underline>AN</underline>alysis. TSCAN uses a cluster-based minimum spanning tree (MST)
approach to order cells. Cells are first grouped into clusters and an MST is then
constructed to connect cluster centers. Pseudo-time is obtained by projecting each cell
onto the tree, and the ordered sequence of cells can be used to study dynamic changes of
gene expression along the pseudo-time. Clustering cells before MST construction reduces
the complexity of the tree space. This often leads to improved cell ordering. It also
allows users to conveniently adjust the ordering based on prior knowledge. TSCAN has a
graphical user interface (GUI) to support data visualization and user interaction.
Furthermore, quantitative measures are developed to objectively evaluate and compare
different pseudo-time reconstruction methods. TSCAN is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/zji90/TSCAN">https://github.com/zji90/TSCAN</ext-link> and as a Bioconductor package.</p>
    </abstract>
    <counts>
      <page-count count="17"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>cover-date</meta-name>
        <meta-value>27 July 2016</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>Single-cell RNA-seq is a transformative technology that allows researchers to measure
transcriptomes of individual cells (<xref rid="B1" ref-type="bibr">1</xref>,<xref rid="B2" ref-type="bibr">2</xref>). Unlike single-cell RNA-seq, conventional RNA-seq (also
referred to as ‘bulk RNA-seq’) (<xref rid="B3" ref-type="bibr">3</xref>,<xref rid="B4" ref-type="bibr">4</xref>) or microarray (<xref rid="B5" ref-type="bibr">5</xref>,<xref rid="B6" ref-type="bibr">6</xref>) experiments are used to measure average
gene expression of a cell population. In many applications, the cell population is
heterogeneous and contains multiple cell types. As a result, the average transcriptome of
the population may fail to capture important transcriptional signals in individual cells.
Sometimes, using the population average to study cell type specific behavior can also be
misleading due to Simpson's paradox (<xref rid="B7" ref-type="bibr">7</xref>,<xref rid="B8" ref-type="bibr">8</xref>). With the ability to measure the transcriptome of each
individual cell, single-cell RNA-seq is capable of generating a higher resolution view of
the gene expression landscape in a heterogeneous cell population (<xref rid="B9" ref-type="bibr">9</xref>–<xref rid="B11" ref-type="bibr">11</xref>). This can lead to a more
accurate molecular characterization of a complex biological phenomenon (<xref rid="B12" ref-type="bibr">12</xref>).</p>
    <p>As demonstrated by (<xref rid="B8" ref-type="bibr">8</xref>), one useful way to gain
biological insights from single-cell RNA-seq data is to computationally order cells
according to the gradual transition of their transcriptomes. For example, in a cell
differentiation process, cells can evolve at different speeds. A sample of cells collected
at a particular time point during differentiation can actually contain cells representing
different differentiation stages. Using single-cell RNA-seq data, one may construct an
ordered sequence of cells to describe the gradual transition of the single-cell
transcriptome. If this <italic>in silico</italic> order is consistent with
cells’ true differentiation stages, then by analyzing how gene expression changes along this
ordered sequence of cells, one will be able to obtain insights on the transcriptome dynamics
during the differentiation process. The process of ordering cells <italic>in
silico</italic> is called pseudo-time reconstruction because it mimics a procedure that
places cells on a time axis. Despite the use of the term ‘time’, ‘pseudo-time
reconstruction’ can more generally refer to any cell ordering procedure regardless of
whether the ordering has a time interpretation (e.g. the ordering of cells may reflect
cells’ spatial order rather than their temporal order).</p>
    <p>Several computational methods have been proposed to analyze single-cell genomic data such
as single-cell mass cytometry data (<xref rid="B13" ref-type="bibr">13</xref>–<xref rid="B15" ref-type="bibr">15</xref>) and single-cell gene expression data (<xref rid="B8" ref-type="bibr">8</xref>,<xref rid="B16" ref-type="bibr">16</xref>–<xref rid="B19" ref-type="bibr">19</xref>). However, for pseudo-time reconstruction in
single-cell RNA-seq data, there are only a limited number of methods that have been
systematically tested and have easily accessible software tools. In (<xref rid="B8" ref-type="bibr">8</xref>), an unsupervised approach Monocle was proposed to solve this problem.
Monocle uses a minimum spanning tree (MST) to describe the transition structure among cells.
The backbone of the tree is extracted to serve as the pseudo-time axis to place cells in
order. A similar unsupervised spanning-tree approach has also been used previously for
analyzing flow cytometry data (<xref rid="B15" ref-type="bibr">15</xref>). As an
unsupervised approach, pseudo-time reconstruction based on spanning trees does not require
any prior information on cell ordering. When temporal order information is available, an
alternative approach to analyzing single-cell gene expression dynamics is to use such
information to supervise the analysis. An example of this supervised approach is SCUBA
(<xref rid="B16" ref-type="bibr">16</xref>). SCUBA uses bifurcation analysis to recover
biological lineages from single-cell gene expression data collected from multiple time
points. Here, the multiple time points in a time course experiment are used to supervise the
cell ordering and analyses of gene expression dynamics in cell differentiation processes. By
using the available time information, supervised methods can be more accurate than
unsupervised methods. However, in applications where time information is not available (e.g.
if one needs to analyze a heterogeneous cell population from a single disease sample rather
than from a time course experiment), the supervised approach is not applicable and one has
to rely on unsupervised methods. For these reasons, both supervised and unsupervised methods
are useful. The primary focus of this article is the unsupervised approach.</p>
    <p>One potential limitation of Monocle is that its tree is constructed to connect individual
cells. Since the cell number is large, the tree space is highly complex. Tree inference in
such a complex space is associated with high variability and can be highly unstable. As a
result, the optimal tree found by the algorithm may not represent cells’ true biological
order. This can be illustrated using a toy example in Figure <xref ref-type="fig" rid="F1">1A</xref>–<xref ref-type="fig" rid="F1">C</xref>. Here dots represent cells placed in a
two dimensional space (e.g. the space corresponding to the top two principal components of
the gene expression profiles), and the true biological time runs top-down vertically. The
MST solution is not unique. Figure <xref ref-type="fig" rid="F1">1A</xref> and <xref ref-type="fig" rid="F1">B</xref> show two possible solutions. When a slight measurement
noise pushes the cell labeled by ‘*’ away from other cells, the tree in Figure <xref ref-type="fig" rid="F1">1A</xref> can easily become a better solution based on the MST
algorithm. However, this solution places cells in an order different from their true
biological order. One approach that may alleviate this problem is to reduce the complexity
of the tree space. This is analogous to the bias-variance tradeoff in the statistics and
machine learning literature. For instance, if one clusters similar cells together as in
Figure <xref ref-type="fig" rid="F1">1C</xref> and then constructs a tree to connect the
cluster centers, recovering the true time-axis becomes easier. In this article, we exploit
this idea to develop Tools for Single Cell Analysis (TSCAN), a new tool for pseudo-time
reconstruction. One additional advantage offered by clustering cells is that users can more
easily adjust the order of tree nodes (i.e. cell clusters) manually if they want to do so,
since the number of clusters usually is not big. By contrast, manually specifying the order
of hundreds of cells is much more difficult.</p>
    <fig id="F1" orientation="portrait" position="float">
      <label>Figure 1.</label>
      <caption>
        <p>TSCAN Overview. (<bold>A</bold>–<bold>B</bold>) A toy example illustrating a limitation
of cell-based MST. Here cells (blue circles) are placed in a two dimensional space, and
the true biological time runs top-down. An MST that connects cells is not unique. Both
(A) and (B) are possible solutions. (B) is more consistent with the truth. However, in
reality, random measurement noise may shift the cell labeled by ‘*’ away from other
cells as indicated by the arrow and dashed lines. As a result, (B) is no longer an MST.
The MST in (A) on the other hand does not reflect the true order of cells.
(<bold>C</bold>) The true time-axis can be found if one first groups similar cells
into clusters and then constructs an MST to connect cluster centers. (<bold>D</bold>)
TSCAN first constructs cluster-based MST (five clusters of cells encoded by different
colors are shown as an example; numbers indicate cluster centers). The tree can have
multiple paths (e.g. 1-2-3-4 or 1-2-3-5). TSCAN orders cells along each path by
projecting each cell onto the tree edge. (<bold>E</bold>) The number of principal
components to retain is determined by finding the best piecewise linear fit consisting
of two lines (dashed).</p>
      </caption>
      <graphic xlink:href="gkw430fig1"/>
    </fig>
    <p>Another limitation of existing tools is that they are mostly command-line driven and do not
allow users to interactively adjust or fine-tune the analysis. For example, users often want
to use their existing knowledge such as marker genes to filter out contamination cells,
determine the time origin or manually change the order of certain tree nodes. However, these
operations are not convenient for a command-line driven software tool such as Monocle. TSCAN
addresses this limitation by providing a graphical user interface (GUI) (Figure <xref ref-type="fig" rid="F2">2</xref>). Using the GUI, users can interactively and conveniently
incorporate prior biological information into the pseudo-time reconstruction analysis.</p>
    <fig id="F2" orientation="portrait" position="float">
      <label>Figure 2.</label>
      <caption>
        <p>TSCAN graphical user interface. Left panel contains function menus and tools for
setting parameters. Right panel displays data and results. The top scatter plot shows
the MST constructed for the LPS data (see Results). Cells (dots) are displayed based on
their first two principal components. Clusters of cells are indicated by different
colors. Numbers are cluster centers. Expression level of a marker gene BCL3 is shown for
each cell. Larger marker size means higher expression. The bottom plot shows the average
BCL3 expression for each tree node, standardized across all nodes to have zero mean and
unit standard deviation.</p>
      </caption>
      <graphic xlink:href="gkw430fig2"/>
    </fig>
    <p>Last but not least, when several different pseudo-time reconstruction methods are
available, being able to evaluate and compare them to identify the best solution is
important. However, how to evaluate different pseudo-time reconstruction methods is also an
open problem. Objective measures for comparing different methods are still lacking. This
article introduces several quantitative measures for evaluating different cell ordering
methods. Using these objective measures, we show that TSCAN is capable of providing more
reliable unsupervised pseudo-time reconstruction results compared to alternative
methods.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>Problem formulation</title>
      <p>Consider a representative sample of <italic>N</italic> cells drawn from a
heterogeneous cell population. Suppose the transcriptome <inline-formula><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf {Y}_i$\end{document}</tex-math></inline-formula> of each cell
<italic>i</italic> ∈ {1, 2, …, <italic>N</italic>} has been
profiled using single-cell RNA-seq. Here, <inline-formula><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf {Y}_i$\end{document}</tex-math></inline-formula> is a <italic>G</italic> dimensional vector consisting of gene expression measurements for <italic>G</italic> genes. Assume that <inline-formula><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf {Y}_i$\end{document}</tex-math></inline-formula> is appropriately
transformed (e.g. by taking logarithm) and normalized across cells. The single cell
ordering problem, also called pseudo-time reconstruction, is to place cells in an order
based on the gradual transition of <inline-formula><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf {Y}_i$\end{document}</tex-math></inline-formula>.</p>
      <p>TSCAN orders cells in three steps. First, cells with similar gene expression profiles are
grouped into clusters. Second, a MST is constructed to connect all cluster centers.
Finally, cells are projected to the tree backbone to determine their pseudo-time and order
(Figure <xref ref-type="fig" rid="F1">1D</xref>). Once cells are ordered, users may use
the ordered sequence to study cell state transition and gene expression dynamics in the
underlying biological process from which the cells are sampled.</p>
    </sec>
    <sec id="SEC2-2">
      <title>Preprocessing</title>
      <p>Before pseudo-time reconstruction, the raw gene expression data are processed as follows.
First, genes with zero read count in all samples are excluded. Second, in order to
alleviate the effect of drop-out events (<xref rid="B20" ref-type="bibr">20</xref>) on the
subsequent analyses, genes with similar expression patterns are grouped into clusters by
hierarchical clustering (using Euclidean distance and complete linkage). The number of
clusters is set to be 5% of the total number of genes with non-zero expression. For each
cluster and each cell, the expression measurements of all genes in the cluster are
averaged to produce a cluster-level expression which will be used for subsequent MST
construction. The drop-out event refers to the phenomenon that expressed genes, some of
which are highly expressed, may have zero read count in some cells as their molecules may
not be captured and amplified by chance. This is a common phenomenon in single-cell
RNA-seq data. By averaging across many genes, the cluster-level expression is more stable
and has smaller estimation variance compared to the measurements of individual genes. This
can help to dilute the impact of drop-out events.</p>
      <p>After gene clustering, single-cell transcriptome for cell <italic>i</italic>
becomes a <italic>H</italic> dimensional vector <inline-formula><tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf {E}_i$\end{document}</tex-math></inline-formula>. Here,
<italic>H</italic> is the number of gene clusters.
<inline-formula><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf
            {E}_i$\end{document}</tex-math></inline-formula> still has high dimension, and many components in this
vector are still correlated. The dimensionality makes visualization and statistical
modeling difficult. For this reason, TSCAN further reduces the dimension of
<inline-formula><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf
            {E}_i$\end{document}</tex-math></inline-formula> using principal component analysis (PCA). Briefly,
<inline-formula><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf
            {E}_i$\end{document}</tex-math></inline-formula> from all cells are organized into a <italic>H</italic> × <italic>N</italic> matrix
<inline-formula><tex-math id="M12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf
            {E}$\end{document}</tex-math></inline-formula>. Each row corresponds to a gene cluster. The matrix is
standardized such that expression values within each row have zero mean and unit standard
deviation. Then PCA is run on the standardized matrix, and the top <italic>K</italic> principal components (PCs) are retained. After PCA, the <italic>H</italic> dimensional vector <inline-formula><tex-math id="M13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf {E}_i$\end{document}</tex-math></inline-formula> is mapped to a lower dimensional space
and becomes a <italic>K</italic> dimensional vector <inline-formula><tex-math id="M14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf {\tilde{E}}_i$\end{document}</tex-math></inline-formula>.
Here, <italic>K</italic> is much smaller than <italic>H</italic>.</p>
      <p>In order to determine <italic>K</italic> (i.e. how many PCs to retain),
TSCAN uses the following criterion. First, let λ<sub>i</sub> be the data variance
explained by the <italic>ith</italic> PC. Define <inline-formula><tex-math id="M15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v_i \equiv \sqrt{\lambda
            _i}$\end{document}</tex-math></inline-formula>. <inline-formula><tex-math id="M16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v$\end{document}</tex-math></inline-formula><sub><italic>i</italic></sub> is a
non-increasing function of <italic>i</italic>. This function can be
approximated using a continuous piecewise linear model <inline-formula><tex-math id="M17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v$\end{document}</tex-math></inline-formula><sub>i</sub> = <italic>f</italic>(<italic>i</italic>) + ε where ε represents noise
and <italic>f</italic>(<italic>i</italic>) consists of two
regression lines (Figure <xref ref-type="fig" rid="F1">1E</xref>): <disp-formula id="M1"><label>(1)</label><tex-math id="M18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} f(i) =
              \left\lbrace \begin{array}{@{}l@{\quad }l@{}}\alpha _0+\alpha _1 *i &amp; \mbox{if} \
              i \le k \\ \beta _0+\beta _1 *i &amp; \mbox{if} \ i&gt;k \end{array}\right. \nonumber
              \\ s.t. \ \alpha _0+\alpha _1 *k = \beta _0+\beta _1 *k
            \end{eqnarray*}\end{document}</tex-math></disp-formula> TSCAN computes the least squares fit of this
model using the first 20 PCs. The fitted model varies when one changes <italic>k</italic>. TSCAN tries different <italic>k</italic> ∈ [2, 19]
and finds the <italic>k</italic> that produces the smallest squared error,
<inline-formula><tex-math id="M19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sum\nolimits_{i = 1}^{20}
              {{{[{v_{\rm i}} - f(i)]}^2}}$\end{document}</tex-math></inline-formula>. This <italic>k</italic> will be used as the number of PCs to retain.</p>
    </sec>
    <sec id="SEC2-3">
      <title>Cell clustering</title>
      <p>After dimension reduction, cells with similar expression profiles are grouped into
clusters using the model-based clustering approach described in (<xref rid="B21" ref-type="bibr">21</xref>). The clustering is performed using the <italic>mclust</italic> (<xref rid="B22" ref-type="bibr">22</xref>) package in R which fits a
mixture of multivariate normal distributions to the data <inline-formula><tex-math id="M20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf {\tilde{E}}_i$\end{document}</tex-math></inline-formula>. The
variance-covariance matrix for each normal component in this mixture is designated as
‘ellipsoidal, varying volume, shape and orientation’. The number of clusters is chosen by
<italic>mclust</italic> using the Bayesian Information Criterion (BIC).
After model fitting, the posterior probability that each cell belongs to each cluster can
be computed. Cells are assigned to clusters based on the largest posterior probability.
For each cluster, the cluster mean of <inline-formula><tex-math id="M21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf {\tilde{E}}_i$\end{document}</tex-math></inline-formula> is treated as the
cluster center. Instead of using the cluster number determined by <italic>mclust</italic> based on BIC, users also have the option to specify their own cluster
number.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Ordering cell clusters by MST</title>
      <p>Next, TSCAN constructs a minimum spanning tree to connect all cluster centers. In a
connected and undirected graph, a spanning tree is a subgraph that is a tree and connects
all the vertices (or ‘nodes’). Suppose each edge in the graph has a length equal to the
Euclidean distance between the two nodes (i.e. cluster centers) connected by the edge. A
MST is a spanning tree with the smallest total edge length among all possible spanning
trees. Unlike the MST approach used by Monocle where the tree is constructed to connect
individual cells, the MST in TSCAN is constructed to connect clusters of cells. Clustering
cells reduces the variability and complexity of the tree space. The cluster level MST
therefore may yield better and more stable estimates of the tree backbone which largely
determines the cell ordering. Another advantage of clustering is that it dramatically
reduces the number of tree nodes, so that it becomes easier for users to interactively
fine-tune the analysis later (e.g. manually adjust the order of tree nodes).</p>
      <p>A tree may have multiple branches. By default, we define the main path of the tree (solid
lines in Figure <xref ref-type="fig" rid="F1">1D</xref>) as the path with the largest
number of clusters. If more than one path has the same largest number of clusters, the
path with the largest number of cells becomes the main path. The main path has two ends.
Without other information, one end will be randomly picked up as the origin of the path.
Alternatively, users can specify one end as the origin themselves using information such
as marker gene expression. After the main path and its origin are determined, TSCAN will
enumerate all branching paths starting from the origin. For instance, assume cluster 1 in
Figure <xref ref-type="fig" rid="F1">1D</xref> is chosen as the origin, then TSCAN will
report a main path 1-2-3-4 and a branching path 1-2-3-5. If the cluster order generated by
the algorithm is not satisfactory to users, they have options to manually specify the
paths and the order of clusters along each path.</p>
    </sec>
    <sec id="SEC2-5">
      <title>Cell ordering and pseudo-time calculation</title>
      <p>Once the cluster-level ordering is determined, individual cells are projected onto tree
edges to create cell-level ordering along the main path and each branching path. For each
path, all clusters on the path are collected. All cells in these clusters will be ordered
along the path as follows. Let <italic>C</italic><sub>i</sub> (i = 1, 2, ...,
<italic>M</italic>) indicate the ordered clusters, where <italic>M</italic> is the number of clusters on the ordered path. Suppose
<inline-formula><tex-math id="M22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf
              {\tilde{E}}^{(i)}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf {\tilde{E}}^{(j)}$\end{document}</tex-math></inline-formula>
are the cluster centers for two neighboring clusters <italic>C</italic><sub>i</sub> and <italic>C</italic><sub>j</sub> in the path, and
suppose <italic>C</italic><sub>i</sub> precedes <italic>C</italic><sub>j</sub> in the ordering. The edge that connects the two clusters is
determined by <inline-formula><tex-math id="M24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf {v}_{ij} =
              \mathbf {\tilde{E}}^{(j)}-\mathbf {\tilde{E}}^{(i)}$\end{document}</tex-math></inline-formula>, and
the projection of cell <italic>k</italic> to the edge is determined by the
inner product <inline-formula><tex-math id="M25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf {v}_{ij}^T
              \mathbf {\tilde{E}}_k/ ||\mathbf {v}_{ij}||$\end{document}</tex-math></inline-formula> where ||.||
is the <italic>l</italic><sup>2</sup>-norm of a vector. Cells in cluster
<italic>C</italic><sub>1</sub> are all projected onto the edge that
connects <italic>C</italic><sub>1</sub> and <italic>C</italic><sub>2</sub>. Cells in cluster <italic>C</italic><sub>M</sub>
are all projected onto the edge that connects <italic>C</italic><sub>M −
1</sub> and <italic>C</italic><sub>M</sub>. Cells from an intermediate
cluster <italic>C</italic><sub>m</sub>(1 &lt; m &lt; <italic>M</italic>) are divided into two groups according to whether they are closer to the
center of cluster <italic>C</italic><sub>m − 1</sub> or to the center of
cluster <italic>C</italic><sub>m + 1</sub> in terms of Euclidean distances.
Cells closer to the center of cluster <italic>C</italic><sub>m − 1</sub> are
projected onto the edge that connects clusters <italic>C</italic><sub>m −
1</sub> and <italic>C</italic><sub>m</sub>, while cells closer to the
center of cluster <italic>C</italic><sub>m + 1</sub> are mapped to the edge
connecting clusters <italic>C</italic><sub>m</sub> and <italic>C</italic><sub>m + 1</sub>.</p>
      <p>Cell orderings are determined in three steps. First, for cells which are in the same
cluster and are projected onto the same edge, their order is determined by the projected
values on the edge. Second, within each cluster, the order of cells projected onto
different edges is determined by the order of edges, which is given by the cluster-level
ordering. Third, the order of cells in different clusters is determined by the order of
clusters. In this way, all cells can be placed in order.</p>
      <p>Once cells are ordered, pseudo-time is computed for each ordered path. For a given path,
the order of a cell on the path is set to be its pseudo-time. For instance, the
pseudo-time for the <italic>kth</italic> cell on a path is set to <italic>k</italic>. The pseudo-time is constructed separately for the main path and
each branching path.</p>
    </sec>
    <sec id="SEC2-6">
      <title>Detecting differentially expressed genes</title>
      <p>After cells are ordered, one can detect differentially expressed genes following the
approach in Monocle (<xref rid="B8" ref-type="bibr">8</xref>). A generalized additive
model (GAM, effective degrees of freedom = 3) (<xref rid="B23" ref-type="bibr">23</xref>)
is fitted for each gene to describe the functional relationship between its expression and
pseudo-time. The GAM is fitted using the <italic>mgcv</italic> (<xref rid="B23" ref-type="bibr">23</xref>) package in R. The model is then compared to a null
model that assumes constant expression along the pseudo-temporal path. The <italic>P</italic>-value is computed using a likelihood ratio test and then
converted to false discovery rate (FDR) using the method in (<xref rid="B24" ref-type="bibr">24</xref>). By default, genes with FDR &lt;0.05 are reported as differential.
As in Monocle, the <italic>P</italic>-value and FDR are computed based on
assuming that cell ordering is given. They do not consider uncertainties in cell ordering
and that, instead of being determined by experiment design, cell ordering is derived from
the same data used for analyzing differential expression. We note that how to evaluate
statistical significance that further accounts for these additional uncertainties remains
an open problem. It requires development of more sophisticated methods and a systematic
investigation of how these additional uncertainties affect different methods (e.g. how
<italic>P</italic>-values change when one treats cell ordering as an
unknown parameter inferred from the data). These investigations are beyond the scope of
the current study as the main focus of this article is how to improve and evaluate cell
ordering.</p>
    </sec>
    <sec id="SEC2-7">
      <title>Method evaluation</title>
      <p>We use three methods to evaluate cell ordering performance. The first approach evaluates
cell ordering accuracy based on the ordering expected by independent sources of
information. It is assumed that external information not used in pseudo-time
reconstruction is available to evaluate the pairwise order of cells. Formally, let π
denote an ordered path of <italic>N</italic><sub>π</sub> cells produced by a
particular pseudo-time reconstruction method. Let <italic>g</italic>(π,
<italic>i, j</italic>) be a score that characterizes how well the order of
the <italic>ith</italic> and <italic>jth</italic> cells in the
ordered path π matches their expected order based on the external information. We define
pseudo-temporal ordering score (POS) for cell ordering π as the sum of <italic>g</italic>(π, <italic>i, j</italic>) for all pairs of cells:
<disp-formula id="M2"><label>(2)</label><tex-math id="M26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} POS_{\pi } = \sum _{i=1}^{N_{\pi }-1}\sum _{j: j &gt;i} g(\pi , i,
              j) \end{equation*}\end{document}</tex-math></disp-formula> Cell orderings π produced by different
pseudo-time reconstruction methods can then be compared based on the POS score.</p>
      <p>As a concrete example, suppose one has single-cell RNA-seq data collected from a time
course experiment. In such an experiment, the data collection time is known. For the
purpose of evaluating unsupervised pseudo-time reconstruction methods, one can pool cells
from all time points together, pretend that the data collection time for each cell is
unknown, and apply different methods to reconstruct pseudo-time. Different methods will
then be evaluated by comparing their cell ordering results to the order of cells based on
the true data collection time. For instance, if one has <italic>N</italic>
cells collected at <italic>V</italic> time points during a differentiation
process. Among the <italic>N</italic> cells, <italic>N</italic><inline-formula><tex-math id="M27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v$\end{document}</tex-math></inline-formula> cells are from time <italic>T</italic><inline-formula><tex-math id="M28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v$\end{document}</tex-math></inline-formula> (<italic>T</italic><sub>1</sub> &lt;
<italic>T</italic><sub>2</sub> &lt; ⋅⋅⋅ &lt; <italic>T</italic><sub><italic>V</italic></sub>). Consider the <italic>ith</italic> cell and the <italic>jth</italic> cell in the
ordered path π where <italic>i</italic> precedes <italic>j</italic> (i.e. <italic>i</italic> &lt; <italic>j</italic>).
One can define the pairwise score <italic>g</italic>(π, <italic>i, j</italic>) as follows: <list list-type="order"><list-item><p>If the two cells are originally collected at the same time point (e.g. they are
both from <italic>T</italic><inline-formula><tex-math id="M29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v$\end{document}</tex-math></inline-formula>), then <italic>g</italic>(π, <italic>i, j</italic>) = 0.</p></list-item><list-item><p>Otherwise, if the <italic>ith</italic> cell is collected from time
point <italic>T</italic><inline-formula><tex-math id="M30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v$\end{document}</tex-math></inline-formula> and the <italic>jth</italic> cell is collected from time point <italic>T</italic><sub><italic>u</italic></sub>, then <italic>g</italic>(π, <italic>i, j</italic>) = (<italic>u</italic> − <inline-formula><tex-math id="M31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v$\end{document}</tex-math></inline-formula>)/<italic>D</italic><sub>π</sub>.
The value <italic>u</italic> − <inline-formula><tex-math id="M32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v$\end{document}</tex-math></inline-formula> is positive if
<inline-formula><tex-math id="M33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v$\end{document}</tex-math></inline-formula> represents an earlier time point, or negative if
<inline-formula><tex-math id="M34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v$\end{document}</tex-math></inline-formula> represents a time later than <italic>u</italic>.</p></list-item></list></p>
      <p>The denominator <italic>D</italic><sub>π</sub> above is chosen to normalize
POS so that <italic>POS</italic><sub>π</sub> ∈ [ − 1, 1] (i.e. the maximal
and minimal POS among all possible orderings of cells within each path π is 1 and −1,
respectively). Based on this definition, a cell ordering more consistent with the known
data collection time will have higher POS score. <italic>POS</italic><sub>π</sub> = 1 indicates that the order of cells produced by pseudo-time
reconstruction perfectly matches the order determined by the data collection time. <italic>POS</italic><sub>π</sub> = −1 indicates that the order of cells produced by
pseudo-time reconstruction is in the opposite direction compared to the order determined
by the data collection time. Using POS to evaluate cell ordering is based on assuming that
the external information (i.e. the true data collection time in this example) can roughly
reflect the true biological order of cells (e.g. the differentiation stage of cells). In
reality, since cells collected at each time point are heterogeneous, it is possible that
some cells collected at an earlier (less differentiated) time point in the differentiation
time course are actually more differentiated than certain cells collected at a later time
point. Despite this, it is often reasonable to expect that cells collected at the earlier
time point ‘on average’ should be less differentiated than cells collected at the later
time point. Therefore, the external information (i.e. the data collection time) used here
can still roughly reflect the true biological order of cells and can be used as a
surrogate to evaluate the cell ordering performance.</p>
      <p>The second approach evaluates robustness of cell ordering by perturbing the original
single-cell RNA-seq data set (see below). Each cell ordering method is applied to both the
original data set and the perturbed data. Cell orderings produced by the original and
perturbed data are then compared. To quantify the similarity between cell orderings in two
pseudo-temporal paths π<sub>1</sub> and π<sub>2</sub>, let <italic>A</italic>
be the union of cells in π<sub>1</sub> and π<sub>2</sub>, let |<italic>A</italic>| be the cardinality of <italic>A</italic> (i.e. the number of
distinct cells in π<sub>1</sub> and π<sub>2</sub>), and define the similarity score
between π<sub>1</sub> and π<sub>2</sub> as: <disp-formula id="M3"><label>(3)</label><tex-math id="M35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} s_{\pi
              _1,\pi _2} = \frac{2}{|A|(|A|-1)}\sum _{i,j \in A; i \ne j} h(\pi _1, \pi _2, i, j)
              \end{equation*}\end{document}</tex-math></disp-formula> Here, <italic>h</italic>(π<sub>1</sub>, π<sub>2</sub>, <italic>i, j</italic>) = 1 if the
order of two cells <italic>i</italic> and <italic>j</italic>
remains the same in π<sub>1</sub> and π<sub>2</sub> (i.e. <italic>i</italic>
appears before or after <italic>j</italic> in both orderings), and <italic>h</italic>(π<sub>1</sub>, π<sub>2</sub>, <italic>i,
j</italic>) = 0 otherwise. If either <italic>i</italic> or <italic>j</italic> occurs only in one path (e.g. <italic>i</italic> is
in π<sub>1</sub> but not π<sub>2</sub>), the orderings between <italic>i</italic> and <italic>j</italic> in π<sub>1</sub> and π<sub>2</sub> are
viewed as inconsistent, and <italic>h</italic>(π<sub>1</sub>, π<sub>2</sub>,
<italic>i, j</italic>) is also set to zero. A higher similarity score
indicates that the two orderings π<sub>1</sub> and π<sub>2</sub> are more similar to each
other, whereas a lower score indicates a larger deviation between the two orderings.</p>
      <p>In this article, two different approaches were used to perturb data: cell-level
perturbation and expression-level perturbation. For cell-level perturbation, <italic>x</italic> percent (<italic>x</italic> = 95%, 90% or 75%) of
cells were randomly sampled from the original data set to serve as the perturbed data. The
gene expression profile of each cell remained unchanged. For expression-level
perturbation, we retained all cells in the original data set but added simulated noise to
their gene expression profiles (i.e. <inline-formula><tex-math id="M36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf {Y}$\end{document}</tex-math></inline-formula>). To generate noise, the
average expression value of each gene across all cells was computed and then subtracted
from the gene's expression value in each cell. Residuals obtained in this way were scaled
by multiplying with a scaling factor κ (κ = 5%, 10% or 25%). The scaled residuals were
then permuted and added back to the original expression values of the gene. For each
perturbation method and parameter value (<italic>x</italic> or κ), the
original data were independently perturbed 100 times to generate 100 perturbed data sets.
For each perturbed data set, similarity score between the original and perturbed orderings
was computed. Finally, the average similarity score from the 100 perturbations was
calculated to measure the robustness of each pseudo-time reconstruction method.</p>
      <p>The third approach evaluates the ability of a cell ordering method to detect known
differentially expressed genes along the ordered cell path. Given a test data set, one can
collect genes known to be differentially expressed along the biologically ordered sequence
of cells and treat them as the gold standard. One can then detect differential genes along
the pseudo-time axis and compare different methods based on how they rank gold standard
genes.</p>
    </sec>
    <sec id="SEC2-8">
      <title>TSCAN package and GUI</title>
      <p>TSCAN is implemented as a Bioconductor package using the statistical programming language
R. It can be run both in a command-line mode and through a GUI. The GUI is developed using
the shiny package in R. It allows users to conveniently construct, visualize and tune cell
ordering. For example, one can use the GUI to interactively trim unwanted cells based on
expression levels of user-specified marker genes. One can also change the cluster-level
ordering and then recompute the pseudo-time. TSCAN is open source, and it is freely
available at <ext-link ext-link-type="uri" xlink:href="https://github.com/zji90/TSCAN">https://github.com/zji90/TSCAN</ext-link>. Its bioconductor package can be downloaded
from <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/release/bioc/html/TSCAN.html">http://www.bioconductor.org/packages/release/bioc/html/TSCAN.html</ext-link>. An
installation guide is provided in Supplementary Materials.</p>
    </sec>
    <sec id="SEC2-9">
      <title>Data sets</title>
      <p>Three data sets were compiled from the literature to evaluate TSCAN. The first data set
consists of single-cell RNA-seq samples from differentiating human skeletal muscle
myoblasts (HSMM) (<xref rid="B8" ref-type="bibr">8</xref>). It contains 271 cells
collected at 0, 24, 48 and 72 h after switching human myoblasts to low serum. The second
data set consists of single-cell RNA-seq samples collected after stimulating
bone-marrow-derived dendritic cells by lipopolysaccharide (LPS) (<xref rid="B25" ref-type="bibr">25</xref>). A total of 306 cells collected at 1, 2, 4 and 6 h after the
stimulation were used for our analysis. The third data set consists of single-cell RNA-seq
samples from hippocampal quiescent neural stem cells (qNSC) (<xref rid="B26" ref-type="bibr">26</xref>). It contains 172 cells collected from the same cell population. For
all data sets, the normalized gene expression values (fragments per kilo base pairs per
million total reads for HSMM and transcripts per million total reads for LPS and qNSC)
were log2 transformed after adding a pseudo-count of 1. After the raw data
<inline-formula><tex-math id="M37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf
            {Y}_i$\end{document}</tex-math></inline-formula> were processed to <inline-formula><tex-math id="M38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf {E}_i$\end{document}</tex-math></inline-formula>,
<inline-formula><tex-math id="M39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf
            {E}_i$\end{document}</tex-math></inline-formula> was used as input for different methods (i.e. TSCAN,
Monocle, Waterfall, SCUBA and Wanderlust below) to construct pseudo-time. The normalized
data for <inline-formula><tex-math id="M40">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf
            {Y}_i$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf {E}_i$\end{document}</tex-math></inline-formula> are available at the
TSCAN GitHub website (<ext-link ext-link-type="uri" xlink:href="https://github.com/zji90/TSCANdata">https://github.com/zji90/TSCANdata</ext-link>). The correspondence between sample
identifiers and sample collection time in the experiment is provided in Supplementary
Table S1.</p>
    </sec>
    <sec id="SEC2-10">
      <title>Comparisons with other methods</title>
      <p>Supplementary Table S2 compares TSCAN with a number of other single cell data analysis
methods. Among these methods, MARS-seq (<xref rid="B17" ref-type="bibr">17</xref>) and
SINCE-PCR (<xref rid="B19" ref-type="bibr">19</xref>) do not have associated software for
others to use. SPADE (<xref rid="B15" ref-type="bibr">15</xref>) and viSNE (<xref rid="B13" ref-type="bibr">13</xref>) are developed for analyzing mass cytometry or flow
cytometry data, and they do not provide a cell ordering function. Diffusion map (<xref rid="B27" ref-type="bibr">27</xref>) is a dimension reduction technique used to define
differentiation trajectories. It cannot perform cell ordering itself. The scLVM method
(<xref rid="B18" ref-type="bibr">18</xref>) primarily focuses on identifying cell
subpopulations. Again, it cannot order cells. For the above reasons, these methods are not
compared with TSCAN in our subsequent data analyses.</p>
      <p>Among the remaining methods, Monocle is designed to handle unsupervised cell ordering of
single-cell RNA-seq and has a software package. Wanderlust (<xref rid="B14" ref-type="bibr">14</xref>) is originally developed for mass or flow cytometry data. It uses a
graph-based trajectory detection algorithm to order cells under the assumption that there
is no branch. We tailored its MATLAB code to allow it to take single-cell RNA-seq data as
input. SCUBA (<xref rid="B16" ref-type="bibr">16</xref>), as discussed before, is a
supervised approach. However, the SCUBA package also provides an option for unsupervised
cell ordering which is based on fitting a principal curve to the data and then mapping
cells onto the curve. Waterfall is a data analysis pipeline used by (<xref rid="B26" ref-type="bibr">26</xref>) to construct pseudo-time for their qNSC data. Similar to TSCAN,
Waterfall first groups cells using k-means clustering before pseudo-time reconstruction.
However, as an in-house data analysis pipeline, Waterfall does not have an associated
software tool, and the pipeline cannot be directly used to analyze other data sets without
manually editing the code. Also, an objective evaluation of the effects of cell clustering
on cell ordering was not provided in (<xref rid="B26" ref-type="bibr">26</xref>). A
systematic comparison among different pseudo-time reconstruction methods discussed above
is still lacking. In order to benchmark the unsupervised cell ordering performance of
TSCAN, we compared it with Monocle, Wanderlust, unsupervised SCUBA and Waterfall in our
subsequent data analyses.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <p>We evaluated TSCAN using the three data sets, HSMM, LPS and qNSC, described above. HSMM and
LPS data sets contain cells collected from multiple time points in time course experiments.
The actual data collection time provides important external information for evaluating cell
orderings produced by unsupervised pseudo-time reconstruction methods. In our evaluation,
cells from different time points were pooled together. We pretended that their data
collection time were unknown. We applied different pseudo-time reconstruction methods to
order these cells. Methods were then compared in terms of their accuracy, robustness and
ability to detect known differentially expressed genes. Accuracy was characterized by the
POS score computed using cells’ actual data collection time. Robustness was characterized by
the cell ordering similarity between the original and perturbed data. In the qNSC data set,
all cells were collected from the same cell population. Since there was no external
information such as multiple time points to calculate the POS score, we only evaluated
robustness and the ability to detect known differentially expressed genes in this data
set.</p>
    <sec id="SEC3-1">
      <title>HSMM analysis using <italic>a priori</italic> chosen genes for
pseudo-time reconstruction</title>
      <p>We first evaluated the performance of TSCAN using the HSMM data set, originally analyzed
by (<xref rid="B8" ref-type="bibr">8</xref>) using Monocle. In the original Monocle
analysis conducted by (<xref rid="B8" ref-type="bibr">8</xref>), the pseudo-time was
constructed using 518 genes chosen <italic>a priori</italic> before ordering
the single-cell RNA-seq data. These genes were derived by comparing different
differentiation time points and therefore are known to be associated with myoblast
differentiation. They represent a strong piece of prior knowledge for pseudo-time
reconstruction. In real applications, if one has strong prior information such as these
518 genes, one can use them as the input (to replace <inline-formula><tex-math id="M42">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf {E}_i$\end{document}</tex-math></inline-formula>) for TSCAN and Monocle to
construct MST. We first performed analyses in this way by using the same 518 genes for
pseudo-time reconstruction. Figure <xref ref-type="fig" rid="F3">3A</xref> and <xref ref-type="fig" rid="F3">B</xref> show the cluster-level MST constructed by TSCAN.
Consistent with the original Monocle results reported in (<xref rid="B8" ref-type="bibr">8</xref>), TSCAN also detected two branches of biological process: the default main
path 1-3-5-2 and a branching path 1-3-5-4. For the main path 1-3-5-2, neither Monocle nor
TSCAN can determine whether node 1 or 2 should be the starting time point without other
information. Therefore, the path has two possible directions. By default, TSCAN randomly
picks one direction. However, if users have marker genes to inform the direction of the
pseudo-temporal path, they can use this information in TSCAN. To illustrate, ENO3 is a
marker gene for myoblast differentiation. Its expression is expected to increase as the
differentiation progresses. After providing ENO3 as a marker gene, TSCAN displays its
expression in each tree node. In this way, one can see that cluster 1 has low ENO3
expression while cluster 2 has high ENO3 expression (Figure <xref ref-type="fig" rid="F3">3C</xref>). Thus, the starting time point should be in cluster 1. As reported in (<xref rid="B8" ref-type="bibr">8</xref>), the branching path in the MST constructed by Monocle
was driven by contaminating interstitial mesenchymal cells, and SPHK1 is a marker gene for
these contaminating cells. Consistent with this, displaying SPHK1 expression in the TSCAN
tree nodes shows that cluster 4 in the branching path 1-3-5-4 had high SPHK1 expression
(Figure <xref ref-type="fig" rid="F3">3D</xref>), indicating that this branch was driven
by contaminating cells. Thus, the branching path 1-3-5-4 was not further analyzed.</p>
      <fig id="F3" orientation="portrait" position="float">
        <label>Figure 3.</label>
        <caption>
          <p>TSCAN analysis in HSMM data set using 518 <italic>a priori</italic>
chosen genes for pseudo-time reconstruction. (<bold>A</bold>) MST reported by TSCAN is
shown in the three-dimensional space spanned by the first three PCs of
<inline-formula><tex-math id="M43">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf
                {E}$\end{document}</tex-math></inline-formula>. (<bold>B</bold>) Users can display cells and MST
in chosen PCs (e.g. PC1 and PC2). (<bold>C</bold>) Mean expression level of ENO3 in
each cluster. (<bold>D</bold>) Mean expression level of SPHK1 in each cluster. Values
in (C) and (D) are both standardized across all clusters to have zero mean and unit
SD.</p>
        </caption>
        <graphic xlink:href="gkw430fig3"/>
      </fig>
      <p>For both Monocle and TSCAN, we calculated the POS score along their reported main path.
The cell ordering along each path reported by each method is provided in Supplementary
Table S3. According to (<xref rid="B8" ref-type="bibr">8</xref>), the main path produced
by Monocle in this analysis corresponds to myoblast differentiation which is the
biological process of interest. Figure <xref ref-type="fig" rid="F4">4A</xref> shows the
POS scores. TSCAN outperformed Monocle in terms of the POS.</p>
      <fig id="F4" orientation="portrait" position="float">
        <label>Figure 4.</label>
        <caption>
          <p>Evaluation results for different methods in HSMM data set where pseudo-time was
constructed based on 518 <italic>a priori</italic> chosen genes.
(<bold>A</bold>) POS score. (<bold>B</bold>) Robustness measured by the average
similarity score from 100 independent perturbations. The heat map shows robustness of
each method in each perturbation scheme. Cell Perturb: cell-level perturbation. Expr
Perturb: expression-level perturbation. (<bold>C</bold>) Mean rank of gold standard
genes. (<bold>D</bold>) Number of detected gold standard genes among top differential
genes.</p>
        </caption>
        <graphic xlink:href="gkw430fig4"/>
      </fig>
      <p>In order to understand how cell clustering affects the cell ordering performance, we
tested a modified TSCAN (nocluTSCAN) in which the cell clustering step was skipped and MST
was constructed directly to connect individual cells based on <inline-formula><tex-math id="M44">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\tilde{\mathbf {E}}_i$\end{document}</tex-math></inline-formula>. The
analyzed path and direction were then determined as above by using SPHK1 to exclude the
contamination path and using ENO3 to determine the time origin. The comparison between
TSCAN and nocluTSCAN was well-controlled since everything was the same for these two
algorithms except for the use of cell clustering by TSCAN. By contrast, the performance
difference between Monocle and TSCAN represents a combined effect of many factors since
many of their implementation details are different. Many of these differences are
difficult to control for as they are hidden in the computer code.</p>
      <p>We also tested a marker-gene-only approach (marker) in which cells are directly ordered
using the expression level of a marker gene (ENO3). Here, in order to conduct a relatively
fair comparison with TSCAN, the marker-gene-only approach was only applied to cells from
the analyzed TSCAN path (i.e. 1-3-5-2), and cells from the contaminated TSCAN branch (i.e.
the branch with cluster 4) were excluded from this analysis. This yielded cell orderings
in Supplementary Table S3. The comparison between the marker-gene-only approach and TSCAN
can reveal whether the other genes used for pseudo-time reconstruction contribute
additional information not provided by the marker gene (i.e. ENO3 in this example) for
ordering cells.</p>
      <p>As shown by Figure <xref ref-type="fig" rid="F4">4A</xref>, TSCAN had the best
performance based on POS. It not only performed better than Monocle, but also outperformed
nocluTSCAN and the marker-only approach, indicating that cell clustering and using
multiple genes for ordering cells were both helpful for improving the pseudo-time
reconstruction.</p>
      <p>Next, we compared robustness of different methods based on cell ordering similarity
between the original and perturbed data. Figure <xref ref-type="fig" rid="F4">4B</xref>
shows the similarity scores when the perturbed data were generated by randomly subsampling
75%, 90% or 95% of cells from the original data set (cell-level perturbation) or by adding
5%, 10% or 25% random noise to the original gene expression values (expression-level
perturbation). For each perturbed data set, the same protocol and marker genes as
described above were used to determine the path direction and eliminate contaminating
branch. Compared to Monocle and nocluTSCAN, TSCAN consistently produced higher similarity
scores in all perturbation schemes (Figure <xref ref-type="fig" rid="F4">4B</xref>). This
shows that cell clustering increased the stability (or equivalently, reduced the
variability) of cell ordering when data were perturbed. The marker-gene-only approach was
also more robust than Monocle and nocluTSCAN, and it showed similar level of robustness
compared to TSCAN (Figure <xref ref-type="fig" rid="F4">4B</xref>). The robustness of the
marker gene approach was not unexpected. For cell-level perturbation, genes’ expression
values in each cell did not change. Consequently, the order of any pair of cells based on
a marker gene's expression remained the same. The difference between the pseudo-temporal
path in the original data and the path in the perturbed data in the marker gene approach
mainly reflects the fact that these two paths did not contain the same set of cells. Note
that not all cells in the original data were retained in the perturbed data set. Also,
contaminating branches of MST constructed by TSCAN were excluded from our marker-gene-only
analyses, and the contaminating branches in the original and perturbed data could contain
different sets of cells. For expression-level perturbation, noises added to gene
expression values represented 5–25% of the cross-cell variation of the true biological
signal. Consequently, the pairwise order of many cells was still driven by the biological
variation and hence remained unchanged in the marker-gene-based ordering.</p>
      <p>It is important to point out that robustness alone is not sufficient to indicate good
cell ordering performance. For instance, suppose each cell has an arbitrary name. If cells
are ordered based on cell name rather than gene expression profile, the order of any pair
of cells will remain the same regardless of how gene expression values are perturbed. As a
result, the cell ordering is robust, but it does not have any biological meaning since the
cell names are arbitrary. This is similar to the well-known variance-bias tradeoff in
statistics: an estimator with zero variance may have huge bias. For this reason,
robustness of a pseudo-time reconstruction method needs to be interpreted in the context
of whether it leads to improved cell ordering accuracy (e.g. increased POS score).
Although the marker-gene-only approach was more robust than Monocle and nocluTSCAN (Figure
<xref ref-type="fig" rid="F4">4B</xref>), its cell ordering accuracy was lower than
Monocle and TSCAN (Figure <xref ref-type="fig" rid="F4">4A</xref>), indicating that its
bias-variance tradeoff is not optimal. By contrast, TSCAN was not only more robust (Figure
<xref ref-type="fig" rid="F4">4B</xref>) but also ordered cells more accurately (Figure
<xref ref-type="fig" rid="F4">4A</xref>) than Monocle and nocluTSCAN.</p>
      <p>For each method, we next detected differentially expressed genes along the ordered main
path of cells. We ranked genes based on FDR, and then different methods were compared
based on their ability to find genes known to be involved in the biological process in
question. For the HSMM data set, we compiled 13 genes (ENO3 excluded) known to be involved
in myoblast differentiation according to (<xref rid="B8" ref-type="bibr">8</xref>)
(Supplementary Table S4). Figure <xref ref-type="fig" rid="F4">4C</xref> shows the mean
rank of these gold standard genes in the differential gene analysis. A smaller mean rank
indicates better performance (i.e. gold standard genes are more likely to be ranked on
top). Figure <xref ref-type="fig" rid="F4">4D</xref> shows the number of gold standard
genes found in the top 200, 400, …, 2000 genes ranked by each method. Monocle and TSCAN
had very similar results in this analysis, and both methods outperformed nocluTSCAN and
the marker gene approach.</p>
      <p>Besides TSCAN, we investigated two other ways to perform cell-clustering-based
pseudo-time reconstruction. First, we replaced mclust by k-means clustering in the cell
clustering step of TSCAN while keeping all other procedures the same (k-means TSCAN).
Unlike mclust which allows ellipsoidal shape of clusters, k-means clustering only allows
clusters with circle shape. In order to determine the cluster number of k-means, we used
an approach similar to Figure <xref ref-type="fig" rid="F1">1E</xref>, with its y-axis
changed to the proportion of total data variance unexplained by the cluster structure
(Supplementary Materials). Second, we tested the Waterfall algorithm (<xref rid="B26" ref-type="bibr">26</xref>) which also uses k-means to cluster cells before
cell ordering (Supplementary Materials). Waterfall does not provide a way to choose
cluster number based on the data. Its cluster number was fixed to 10 which is the default
value in Waterfall codes. Both the k-means TSCAN and Waterfall produced more robust cell
ordering than Monocle and nocluTSCAN (Figure <xref ref-type="fig" rid="F4">4B</xref>).
However, their cell ordering accuracy did not outperform Monocle and was clearly worse
than TSCAN, as indicated by the POS score (Figure <xref ref-type="fig" rid="F4">4A</xref>)
and differential gene detection performance (Figure <xref ref-type="fig" rid="F4">4C</xref> and <xref ref-type="fig" rid="F4">D</xref>). This suggests that although
k-means TSCAN and Waterfall reduced the cell ordering variability, their bias-variance
tradeoff was not optimal for improving the cell ordering accuracy.</p>
      <p>We also tested unsupervised SCUBA (i.e. the principal-curve-based SCUBA) and Wanderlust.
For SCUBA, low expression of the marker gene ENO3 was used to determine the path origin.
Wanderlust was run by using the cell with the highest ENO3 gene expression as the path
origin (because the lowest ENO3 expression was zero, and zero occurred in many cells,
making the choice of path origin not unique). The cell ordering reported by Wanderlust was
then reversed so that the reversed path had low ENO3 expression at the beginning and high
ENO3 expression at the end. The same approach was also used in other test data sets below
to run the Wanderlust analyses. For both methods, after cells were ordered, GAM was used
to detect differentially expressed genes as in TSCAN. Both Wanderlust and SCUBA were more
robust than Monocle and nocluTSCAN (Figure <xref ref-type="fig" rid="F4">4B</xref>).
However, they both had lower cell ordering accuracy compared to TSCAN (Figure <xref ref-type="fig" rid="F4">4A</xref>, <xref ref-type="fig" rid="F4">C</xref> and <xref ref-type="fig" rid="F4">D</xref>). In fact, TSCAN produced the highest POS score (Figure
<xref ref-type="fig" rid="F4">4A</xref>) and best differential gene detection
performance (Figure <xref ref-type="fig" rid="F4">4C</xref> and <xref ref-type="fig" rid="F4">D</xref>).</p>
      <p>As demonstrated in (<xref rid="B8" ref-type="bibr">8</xref>), cell orderings based on
pseudo-time may reveal gene expression patterns that cannot be discovered by bulk gene
expression data. MEF2C and MYH2 are two genes involved in the HSMM differentiation. It is
known that these two genes should have increasing expression during the differentiation,
and the expression of MEF2C should start increasing earlier than the increase of MYH2
(<xref rid="B8" ref-type="bibr">8</xref>). Based on the average bulk gene expression at
different time points, it was not clear that MEF2C had a monotone increasing pattern, nor
was it clear which gene started to increase first (Supplementary Figure S1). By contrast,
all single-cell analysis methods tested here were able to recover the overall increasing
pattern of MEF2C and MYH2 along their analyzed pseudo-time axes, although in Monocle,
k-means TSCAN, Waterfall, SCUBA and Wanderlust, MEF2C decreased a little before increasing
(Supplementary Figure S2). Compared to the other methods, the temporal expression curves
fitted by TSCAN and nocluTSCAN more clearly showed that MEF2C increased earlier than the
increase of MYH2 (Supplementary Figure S2).</p>
      <p>Based on all the analyses above, TSCAN was the method that provided the best overall
performance. It offered the best cell ordering accuracy among all tested methods and
improved cell ordering robustness compared to methods without using cell clustering (i.e.
Monocle and nocluTSCAN).</p>
    </sec>
    <sec id="SEC3-2">
      <title>HSMM analysis without using <italic>a priori</italic> chosen genes for
pseudo-time reconstruction</title>
      <p>In real applications, the prior information for pseudo-time reconstruction such as the
518 genes used above is not always available. When no such prior information is available,
pseudo-time reconstruction has to rely on all genes in the RNA-seq data. To evaluate the
performance of TSCAN in such a scenario, we repeated the previous analysis but constructed
pseudo-time without using the 518 <italic>a priori</italic> chosen genes.
Instead, the <inline-formula><tex-math id="M45">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf
              {E}_i$\end{document}</tex-math></inline-formula> used for TSCAN was derived from all genes in the
single-cell RNA-seq data using the protocol described in Materials and Methods. We also
used <inline-formula><tex-math id="M46">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf
            {E}_i$\end{document}</tex-math></inline-formula> instead of <inline-formula><tex-math id="M47">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf {Y}_i$\end{document}</tex-math></inline-formula> as the input for Monocle,
Waterfall, SCUBA and Wanderlust in order to make the method comparison relatively fair. Of
note, the dimensionality of <inline-formula><tex-math id="M48">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf {Y}_i$\end{document}</tex-math></inline-formula> was also beyond the capacity that the
Monocle software was able to handle.</p>
      <p>Pseudo-temporal paths generated by different methods are provided in Supplementary Table
S3. The default main path given by TSCAN (Figure <xref ref-type="fig" rid="F5">5A</xref>,
path 3-1-2) contained a cluster of cells with high expression in SPHK1 (Figure <xref ref-type="fig" rid="F5">5D</xref>), indicating that the main path was contaminated by
interstitial mesenchymal cells and may not reflect myoblast differentiation. In such a
scenario, TSCAN allows users to manually tune the analysis. For instance, with the GUI,
one can conveniently visualize the expression of marker genes (Figure <xref ref-type="fig" rid="F5">5B</xref>) such as SPHK1 (Figure <xref ref-type="fig" rid="F5">5D</xref>,
marker for contamination) and ENO3 (Figure <xref ref-type="fig" rid="F5">5E</xref>, marker
for myoblast differentiation). Since SPHK1 is highly expressed in cluster 3, we chose to
study path 2-1-4 which represents the myoblast differentiation. According to the
increasing ENO3 pattern, one can specify that cluster 2 should be the path origin.
Alternatively, one can also manually define a path by specifying the clusters and their
order in the path (Figure <xref ref-type="fig" rid="F5">5C</xref>). In this example, both
ways yielded the same path 2-1-4. Similar to TSCAN, the main path in Monocle was also
contaminated by cells with high SPHK1 expression (Supplementary Table S3). However,
Monocle does not provide an interface to help users conveniently incorporate such marker
gene information and tune ordering. Users would need to be experienced in programming in
order to adjust the analysis. In comparison, the TSCAN GUI allows users unfamiliar with
programming to visualize and tune the ordering. Therefore, it lowers the bar for users to
customize the pseudo-time analyses and can save them time and effort.</p>
      <fig id="F5" orientation="portrait" position="float">
        <label>Figure 5.</label>
        <caption>
          <p>Demonstration of GUI and TSCAN analysis of HSMM data using all genes for pseudo-time
reconstruction. (<bold>A</bold>) MST constructed by TSCAN using all genes.
(<bold>B</bold>) Users can choose a marker gene in GUI to visualize its expression.
(<bold>C</bold>) Users can define a path by specifying the clusters to include and
their ordering. (<bold>D</bold>) The average expression of SPHK1 in each cluster.
(<bold>E</bold>) The average expression of ENO3 in each cluster.</p>
        </caption>
        <graphic xlink:href="gkw430fig5"/>
      </fig>
      <p>After using high expression of SPHK1 to exclude the contaminating branch and using low
expression of ENO3 to determine the origin of the pseudo-temporal path for each method
(Supplementary Table S3), different methods were then compared.</p>
      <p>In terms of cell ordering accuracy, TSCAN had the highest POS score (Figure <xref ref-type="fig" rid="F6">6A</xref>) and the best mean rank of gold standard genes (Figure
<xref ref-type="fig" rid="F6">6C</xref>) among all methods. It also had the highest
power for detecting the gold standard differential genes (Figure <xref ref-type="fig" rid="F6">6D</xref>). In terms of robustness, methods based on cell clustering (TSCAN,
k-means TSCAN, Waterfall) were more robust than methods that did not use cell clustering
(Monocle, nocluTSCAN), as shown by the increased similarity scores between the original
and perturbed data (Figure <xref ref-type="fig" rid="F6">6B</xref>).</p>
      <fig id="F6" orientation="portrait" position="float">
        <label>Figure 6.</label>
        <caption>
          <p>Evaluation results for different methods in HSMM data where pseudo-time was
constructed using all genes. (<bold>A</bold>) POS score. (<bold>B</bold>) Robustness
measured by the average similarity score from 100 independent perturbations.
(<bold>C</bold>) Mean rank of gold standard genes. (<bold>D</bold>) Number of
detected gold standard genes among top differential genes.</p>
        </caption>
        <graphic xlink:href="gkw430fig6"/>
      </fig>
      <p>Besides comparing cell orderings from the original and perturbed data, we also compared
cell orderings constructed using and not using the 518 prior genes. To do so, similarity
score between the cell ordering reported in this section and the ordering reported in the
previous section was computed for each method. Supplementary Figure S3A shows that TSCAN
and the marker gene approach produced higher similarity scores than other methods,
suggesting that they produced the most consistent cell ordering results. For each method,
we also compared the consistency of differentially expressed genes detected by using and
not using the 518 prior genes for pseudo-time reconstruction. For each analysis (i.e.
using or not using the 518 prior genes), we obtained the top <italic>R</italic> ranked differential genes. The number of common genes between these two
analyses was then counted and plotted as a function of <italic>R</italic> in
Supplementary Figure S3B. Supplementary Figure S3C shows a similar analysis with a more
stringent definition of common genes. Here, any gene that did not change in the same
direction along the two pseudo-temporal paths (i.e. the fitted GAM functions from the two
analyses have negative correlation) was not counted as a common gene even if the gene was
identified by both analyses among their top <italic>R</italic> genes. After
excluding these inconsistent genes from the common gene list, the number of genes remained
in the common gene list was then shown as a function of <italic>R</italic>.
In both Supplementary Figures S3B and S3C, TSCAN and the marker gene approach showed
higher consistency than the other methods. Compared to the marker gene approach, TSCAN
cell ordering was more accurate according to the POS score and differential gene detection
performance (Figure <xref ref-type="fig" rid="F6">6A</xref>, <xref ref-type="fig" rid="F6">C</xref> and <xref ref-type="fig" rid="F6">D</xref>). Thus, our results show that TSCAN
can make the ordering results less dependent on the availability of prior genes and at the
same time provide the best accuracy compared to the other methods.</p>
      <p>When comparing the expression patterns of MEF2C and MYH2 along the pseudo-time axis,
Monocle and Wanderlust failed to reveal the temporal order of MEF2C and MYH2, and the
increasing pattern of these genes also became less clear (Figure <xref ref-type="fig" rid="F7">7</xref>). In Waterfall, MEF2C first decreased and then increased, and the
temporal order of MEF2C and MYH2 was not very clear. By contrast, the other methods
successfully revealed the increasing pattern of MEF2C and MYH2 in this analysis. Their
results also more clearly show that MEF2C increased before the increase of MYH2 (Figure
<xref ref-type="fig" rid="F7">7</xref>).</p>
      <fig id="F7" orientation="portrait" position="float">
        <label>Figure 7.</label>
        <caption>
          <p>MEF2C and MYH2 expression patterns in HSMM data set where pseudo-time was constructed
using all genes. The expression of each gene in each cell is plotted as a function of
cell order on the pseudo-time axis. The solid curves are the fitted GAM function. The
dashed curve is the GAM fit for ENO3, the marker gene used to determine the path
direction.</p>
        </caption>
        <graphic xlink:href="gkw430fig7"/>
      </fig>
      <p>Overall, our analyses again show that TSCAN produced the most accurate cell ordering
results, and it was more robust than methods without cell clustering.</p>
    </sec>
    <sec id="SEC3-3">
      <title>LPS analysis</title>
      <p>For the LPS data, we reconstructed pseudo-time without using strong prior knowledge such
as the 518 <italic>a priori</italic> chosen genes in the HSMM analysis. The
analyses were run based on <inline-formula><tex-math id="M49">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf
              {E}_i$\end{document}</tex-math></inline-formula> which was computed using all genes following the
protocol described in Materials and Methods. All methods only found one main path without
branching paths (Supplementary Table S3). To determine the direction of the path, we used
BCL3 as a marker gene. BCL3 is known to be involved in the response to viral and bacterial
stimulus, and its expression level is expected to increase after LPS stimulation. Figure
<xref ref-type="fig" rid="F2">2</xref> shows the expression of this marker gene in the
TSCAN GUI. Accordingly, cluster 1 was determined as the origin of the pseudo-time axis.
Comparing different methods based on POS score again shows that TSCAN had the best
accuracy (Figure <xref ref-type="fig" rid="F8">8A</xref>, BCL3 was used as the marker gene
for the marker-gene-only approach). Methods based on cell clustering (TSCAN, k-means
TSCAN, Waterfall) were more robust than those not using cell clustering (Monocle and
nocluTSCAN) (Figure <xref ref-type="fig" rid="F8">8B</xref>). To evaluate different
methods based on differentially expressed genes, we compiled 125 known marker genes (BCL3
excluded) from (<xref rid="B25" ref-type="bibr">25</xref>) (Supplementary Table S4).
Figure <xref ref-type="fig" rid="F8">8C</xref> and <xref ref-type="fig" rid="F8">D</xref>
show the mean rank of these gold standard genes and the number of gold standard genes
found in the top ranked genes reported by each method respectively. Again, TSCAN
outperformed all other methods.</p>
      <fig id="F8" orientation="portrait" position="float">
        <label>Figure 8.</label>
        <caption>
          <p>Evaluation results for different methods in LPS data set. (<bold>A</bold>) POS score.
(<bold>B</bold>) Robustness measured by the average similarity score from 100
independent perturbations. (<bold>C</bold>) Mean rank of gold standard genes.
(<bold>D</bold>) Number of detected gold standard genes among top differential
genes.</p>
        </caption>
        <graphic xlink:href="gkw430fig8"/>
      </fig>
      <p>As a specific example, Figure <xref ref-type="fig" rid="F9">9</xref> shows the expression
level of a gold standard gene STAT2 for the LPS data (<xref rid="B25" ref-type="bibr">25</xref>). STAT2 expression is expected to increase after LPS stimulation. One can see
that the TSCAN result was most consistent with the known increasing pattern of STAT2. By
contrast, the increasing pattern of STAT2 was much less clear in cell orderings produced
by all the other approaches. In Monocle, nocluTSCAN, k-means TSCAN, Waterfall, SCUBA and
Wanderlust, STAT2 first increased and then decreased. In the marker gene approach, the
increasing pattern was weak compared to the high variability of cells around the fitted
curve.</p>
      <fig id="F9" orientation="portrait" position="float">
        <label>Figure 9.</label>
        <caption>
          <p>STAT2 expression patterns in LPS data set. STAT2 expression in each cell is plotted
as a function of cell order on the pseudo-time axis. The orange curve is the fitted
GAM function.</p>
        </caption>
        <graphic xlink:href="gkw430fig9"/>
      </fig>
    </sec>
    <sec id="SEC3-4">
      <title>qNSC analysis</title>
      <p>Lastly, we compared different methods using the qNSC data set. This data set does not
have multiple time points or experimental conditions. A prior gene set for cell ordering
was also not available. We therefore run the analyses based on <inline-formula><tex-math id="M50">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathbf {E}_i$\end{document}</tex-math></inline-formula> computed
using all genes as described in Materials and Methods. All methods produced one single
path without branches. To determine the path direction, we used FOXG1 as a marker gene.
FOXG1 is known to be critically involved in proliferative adult NPCs. Low expression of
FOXG1 was used to indicate the origin of the path.</p>
      <p>In the qNSC analysis, the POS score cannot be calculated because external information
such as data collection time is not available. Therefore, we only evaluated each method's
robustness and its ability to detect known differential genes. For the differential gene
analysis, 1999 known marker genes (excluding FOXG1) were compiled from (<xref rid="B26" ref-type="bibr">26</xref>) to serve as the gold standard (Supplementary Table
S4). Once again, methods using cell clustering (TSCAN, k-means TSCAN, Waterfall) improved
robustness of cell ordering compared to those without using cell clustering (Monocle,
nocluTSCAN) (Figure <xref ref-type="fig" rid="F10">10A</xref>). TSCAN offered the best
mean rank of gold standard genes among all methods (Figure <xref ref-type="fig" rid="F10">10B</xref>), and it also had the highest power for detecting the gold standard
differential genes (Figure <xref ref-type="fig" rid="F10">10C</xref>). Supplementary
Figure S4 shows the expression level of a gold standard gene SOX9. As a down-regulated
transcription factor, SOX9 expression is expected to decrease along the pseudo-time (<xref rid="B26" ref-type="bibr">26</xref>). TSCAN and Waterfall results were consistent with
this known decreasing pattern of SOX9, and the decreasing pattern was most evident in
TSCAN. By contrast, SOX9 expression first increased and then decreased in Monocle,
nocluTSCAN and SCUBA. For k-means TSCAN, SOX9 expression first decreased and then
increased. For the marker-gene-only approach and Wanderlust, SOX9 expression slightly
increased. Overall, TSCAN performed the best among all methods.</p>
      <fig id="F10" orientation="portrait" position="float">
        <label>Figure 10.</label>
        <caption>
          <p>Evaluation results for different methods in qNSC data set. (<bold>A</bold>)
Robustness measured by the average similarity score from 100 independent
perturbations. (<bold>B</bold>) Mean rank of gold standard genes. (<bold>C</bold>)
Number of detected gold standard genes among top differential genes.</p>
        </caption>
        <graphic xlink:href="gkw430fig10"/>
      </fig>
    </sec>
    <sec id="SEC3-5">
      <title>The graphical user interface (GUI)</title>
      <p>TSCAN has a GUI. As discussed above, the GUI in TSCAN allows users to visualize marker
genes and tune main paths and cluster-level orderings. Besides these functions, the GUI
also provides multiple trimming criteria for users to efficiently trim unwanted cells. For
example, to exclude cells with high expression in two genes PDGFRA and SPHK1 in HSMM data
set, one can set up two trimming criteria such as PDGFRA &gt; 1 and SPHK1 &gt; 1
(Supplementary Figure S5A) and TSCAN will exclude cells meeting both criteria
(Supplementary Figure S5B). Finally, the GUI can be used to visualize expression of
user-specified genes along pseudo-time as heat maps. For example, Supplementary Figure S5C
visualizes the expression of two genes CCNA2 and CCNB2 after obtaining the pseudo-time
ordering in HSMM data. Together, these functions make the pseudo-time analyses of
single-cell RNA-seq data more convenient and user-friendly.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>In summary, TSCAN offers a new tool to support pseudo-time analysis of single-cell RNA-seq
data. As demonstrated by our results, this approach robustly provides competitive
performance based on different criteria. By comparing methods using and not using cell
clustering, we have shown that cell clustering is a useful technique for reducing the
variability and improving the accuracy of the MST-based pseudo-time analysis. Although the
cell clustering idea has also been used previously in Waterfall, a systematic evaluation of
the impact of cell clustering on cell ordering was not provided in the Waterfall study
(<xref rid="B26" ref-type="bibr">26</xref>). Besides the development and systematic
evaluation of the TSCAN algorithm, we also developed a GUI for TSCAN. The GUI of TSCAN
provides users with the flexibility to interactively explore and adjust the analysis
results.</p>
    <p>In order to evaluate TSCAN and other unsupervised pseudo-time reconstruction methods, we
used two time course data sets with multiple time points, HSMM and LPS, and intentionally
avoided using any information on data collection time in our pseudo-time analyses. In this
way, the data collection time can provide an independent source of information for
evaluating the accuracy of cell ordering via POS score. Such an evaluation cannot be done if
the test data set has only one time point. This explains why we used HSMM and LPS for
evaluation even though in principle such data could be analyzed in other ways. For instance,
one could perform supervised rather than unsupervised analysis to order cells.
Alternatively, one could perform an initial analysis to identify differentially expressed
genes between different data collection time points and then use them as prior genes
(similar to the 518 prior genes for HSMM) to order cells. Unlike the HSMM and LPS data, the
qNSC data set represents a different situation faced by many investigators. Here,
single-cell RNA-seq data are collected from only one biological condition rather than from
multiple time points or conditions. In such a scenario, supervised methods that use data
collection time information to order cells cannot be applied, and one cannot compare
different time points or conditions to find differential genes and use them as prior genes
for cell ordering. It is therefore important to be able to perform unsupervised pseudo-time
analysis such as TSCAN.</p>
    <p>Besides TSCAN, this article also introduced several methods to quantitatively evaluate cell
ordering performance. We expect that these evaluation methods will continue to be useful in
the future for evaluating other pseudo-time reconstruction algorithms. Although TSCAN was
tested using RNA-seq, in principle it should not be difficult to tailor this approach to
other data types should single-cell data for those data types become available in the
future.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>SUPPLEMENTARY DATA</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_44_13_e117__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gkw430_nar-02567-met-g-2015-File005.pdf"/>
      <media xlink:role="associated-file" mimetype="text" mime-subtype="html" xlink:href="supp_gkw430_nar-02567-met-g-2015-File007.xlsx.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="supp_gkw430_nar-02567-met-g-2015-File009.xlsx"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="supp_gkw430_nar-02567-met-g-2015-File011.xlsx"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="supp_gkw430_nar-02567-met-g-2015-File013.xlsx"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors would like to thank Dr Hongjun Song and Dr Jaehoon Shin for providing qNSC data
and helpful discussions on Waterfall. The authors would also like to thank Dr Ben Sherwood
for his suggestions on improving the manuscript.</p>
  </ack>
  <sec id="SEC5">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/lookup/suppl/doi:10.1093/nar/gkw430/-/DC1">Supplementary Data</ext-link> are available at NAR Online.</p>
  </sec>
  <sec id="SEC6">
    <title>FUNDING</title>
    <p>National Institutes of Health (NIH) [R01HG006282]. Funding for open access charge: National
Institutes of Health (NIH) [R01HG006282].</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Barbacioru</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Nordman</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Bodeau</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Tuch</surname>
            <given-names>B.B.</given-names>
          </name>
          <name>
            <surname>Siddiqui</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title>
        <source>Nat. Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>377</fpage>
        <lpage>382</lpage>
        <pub-id pub-id-type="pmid">19349980</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Barbacioru</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Bao</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Nordman</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Lao</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Surani</surname>
            <given-names>M. A.</given-names>
          </name>
        </person-group>
        <article-title>Tracing the derivation of embryonic stem cells from the inner cell mass by
single-cell RNA-Seq analysis</article-title>
        <source>Cell Stem Cell</source>
        <year>2010</year>
        <volume>6</volume>
        <fpage>468</fpage>
        <lpage>478</lpage>
        <pub-id pub-id-type="pmid">20452321</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortazavi</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>B.A.</given-names>
          </name>
          <name>
            <surname>McCue</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Schaeffer</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Wold</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>
        <source>Nat. Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>621</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="pmid">18516045</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="pmid">19015660</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schena</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Shalon</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>R. W.</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>P.O.</given-names>
          </name>
        </person-group>
        <article-title>Quantitative monitoring of gene expression patterns with a complementary
DNA microarray</article-title>
        <source>Science</source>
        <year>1995</year>
        <volume>270</volume>
        <fpage>467</fpage>
        <lpage>470</lpage>
        <pub-id pub-id-type="pmid">7569999</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schulze</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Downward</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Navigating gene expression using microarrays–a technology
review</article-title>
        <source>Nat. Cell Biol.</source>
        <year>2001</year>
        <volume>3</volume>
        <fpage>E190</fpage>
        <lpage>E195</lpage>
        <pub-id pub-id-type="pmid">11483980</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simpson</surname>
            <given-names>E.H.</given-names>
          </name>
        </person-group>
        <article-title>The interpretation of interaction in contingency tables</article-title>
        <source>J. Roy. Stat. Soc. B</source>
        <year>1951</year>
        <volume>13</volume>
        <fpage>238</fpage>
        <lpage>241</lpage>
      </element-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Cacchiarelli</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Grimsby</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Pokharel</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Morse</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Lennon</surname>
            <given-names>N.J.</given-names>
          </name>
          <name>
            <surname>Livak</surname>
            <given-names>K.J.</given-names>
          </name>
          <name>
            <surname>Mikkelsen</surname>
            <given-names>T.S.</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>J.L.</given-names>
          </name>
        </person-group>
        <article-title>The dynamics and regulators of cell fate decisions are revealed by
pseudotemporal ordering of single cells</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>381</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="pmid">24658644</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Islam</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Kjllquist</surname>
            <given-names>U.</given-names>
          </name>
          <name>
            <surname>Moliner</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Zajac</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J.B.</given-names>
          </name>
          <name>
            <surname>Lönnerberg</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Linnarsson</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Characterization of the single-cell transcriptional landscape by highly
multiplex RNA-seq</article-title>
        <source>Genome Res.</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>1160</fpage>
        <lpage>1167</lpage>
        <pub-id pub-id-type="pmid">21543516</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramsköld</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y.C.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Faridani</surname>
            <given-names>O.R.</given-names>
          </name>
          <name>
            <surname>Daniels</surname>
            <given-names>G.A.</given-names>
          </name>
          <name>
            <surname>Khrebtukova</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Loring</surname>
            <given-names>J.F.</given-names>
          </name>
          <name>
            <surname>Laurent</surname>
            <given-names>L.C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Full-length mRNA-Seq from single-cell levels of RNA and individual
circulating tumor cells</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2012</year>
        <volume>30</volume>
        <fpage>777</fpage>
        <lpage>782</lpage>
        <pub-id pub-id-type="pmid">22820318</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Treutlein</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Brownfield</surname>
            <given-names>D.G.</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>A.R.</given-names>
          </name>
          <name>
            <surname>Neff</surname>
            <given-names>N.F.</given-names>
          </name>
          <name>
            <surname>Mantalas</surname>
            <given-names>G.L.</given-names>
          </name>
          <name>
            <surname>Espinoza</surname>
            <given-names>F.H.</given-names>
          </name>
          <name>
            <surname>Desai</surname>
            <given-names>T.J.</given-names>
          </name>
          <name>
            <surname>Krasnow</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Quake</surname>
            <given-names>S.R.</given-names>
          </name>
        </person-group>
        <article-title>Reconstructing lineage hierarchies of the distal lung epithelium using
single-cell RNA-seq</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>509</volume>
        <fpage>371</fpage>
        <lpage>375</lpage>
        <pub-id pub-id-type="pmid">24739965</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saliba</surname>
            <given-names>A.E.</given-names>
          </name>
          <name>
            <surname>Westermann</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Gorski</surname>
            <given-names>S.A.</given-names>
          </name>
          <name>
            <surname>Vogel</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-seq: advances and future challenges</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>8845</fpage>
        <lpage>8860</lpage>
        <pub-id pub-id-type="pmid">25053837</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amir</surname>
            <given-names>el-A.D.</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>K.L.</given-names>
          </name>
          <name>
            <surname>Tadmor</surname>
            <given-names>M.D.</given-names>
          </name>
          <name>
            <surname>Simonds</surname>
            <given-names>E.F.</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>J.H.</given-names>
          </name>
          <name>
            <surname>Bendall</surname>
            <given-names>S.C.</given-names>
          </name>
          <name>
            <surname>Shenfeld</surname>
            <given-names>D.K.</given-names>
          </name>
          <name>
            <surname>Krishnaswamy</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>G.P.</given-names>
          </name>
          <name>
            <surname>Pe'er</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>viSNE enables visualization of high dimensional single-cell data and
reveals phenotypic heterogeneity of leukemia</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2013</year>
        <volume>31</volume>
        <fpage>545</fpage>
        <lpage>552</lpage>
        <pub-id pub-id-type="pmid">23685480</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bendall</surname>
            <given-names>S.C.</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>K.L.</given-names>
          </name>
          <name>
            <surname>Amir</surname>
            <given-names>el-A.D.</given-names>
          </name>
          <name>
            <surname>Tadmor</surname>
            <given-names>M.D.</given-names>
          </name>
          <name>
            <surname>Simonds</surname>
            <given-names>E.F.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>T.J.</given-names>
          </name>
          <name>
            <surname>Shenfeld</surname>
            <given-names>D.K.</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>G.P.</given-names>
          </name>
          <name>
            <surname>Pe'er</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>Single-cell trajectory detection uncovers progression and regulatory
coordination in human B cell development</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>157</volume>
        <fpage>714</fpage>
        <lpage>725</lpage>
        <pub-id pub-id-type="pmid">24766814</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qiu</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Simonds</surname>
            <given-names>E.F.</given-names>
          </name>
          <name>
            <surname>Bendall</surname>
            <given-names>S.C.</given-names>
          </name>
          <name>
            <surname>Gibbs</surname>
            <given-names>K.D.</given-names>
            <suffix>Jr</suffix>
          </name>
          <name>
            <surname>Bruggner</surname>
            <given-names>R.V.</given-names>
          </name>
          <name>
            <surname>Linderman</surname>
            <given-names>M.D.</given-names>
          </name>
          <name>
            <surname>Sachs</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>G.P.</given-names>
          </name>
          <name>
            <surname>Plevritis</surname>
            <given-names>S.K.</given-names>
          </name>
        </person-group>
        <article-title>Extracting a cellular hierarchy from high-dimensional cytometry data with
SPADE</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2011</year>
        <volume>29</volume>
        <fpage>886</fpage>
        <lpage>891</lpage>
        <pub-id pub-id-type="pmid">21964415</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marco</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Karp</surname>
            <given-names>R.L.</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Robson</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Hart</surname>
            <given-names>A.H.</given-names>
          </name>
          <name>
            <surname>Trippa</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>G.C.</given-names>
          </name>
        </person-group>
        <article-title>Bifurcation analysis of single-cell gene expression data reveals epigenetic
landscape</article-title>
        <source>Proc. Natl. Acad. Sci. U.S.A.</source>
        <year>2014</year>
        <volume>111</volume>
        <fpage>E5643</fpage>
        <lpage>E5650</lpage>
        <pub-id pub-id-type="pmid">25512504</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jaitin</surname>
            <given-names>D.A.</given-names>
          </name>
          <name>
            <surname>Kenigsberg</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Keren-Shaul</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Elefant</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Zaretsky</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Mildner</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel single-cell RNA-seq for marker-free decomposition of
tissues into cell types</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>343</volume>
        <fpage>776</fpage>
        <lpage>779</lpage>
        <pub-id pub-id-type="pmid">24531970</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buettner</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Natarajan</surname>
            <given-names>K.N.</given-names>
          </name>
          <name>
            <surname>Casale</surname>
            <given-names>F.P.</given-names>
          </name>
          <name>
            <surname>Proserpio</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Scialdone</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>F.J.</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>S.A.</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>J.C.</given-names>
          </name>
          <name>
            <surname>Stegle</surname>
            <given-names>O.</given-names>
          </name>
        </person-group>
        <article-title>Computational analysis of cell-to-cell heterogeneity in single-cell
RNA-sequencing data reveals hidden subpopulations of cells</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>155</fpage>
        <lpage>160</lpage>
        <pub-id pub-id-type="pmid">25599176</pub-id>
      </element-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dalerba</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Kalisky</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Sahoo</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Rajendran</surname>
            <given-names>P.S.</given-names>
          </name>
          <name>
            <surname>Rothenberg</surname>
            <given-names>M.E.</given-names>
          </name>
          <name>
            <surname>Leyrat</surname>
            <given-names>A.A.</given-names>
          </name>
          <name>
            <surname>Sim</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Okamoto</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Johnston</surname>
            <given-names>D.M.</given-names>
          </name>
          <name>
            <surname>Qian</surname>
            <given-names>D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell dissection of transcriptional heterogeneity in human colon
tumors</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2011</year>
        <volume>29</volume>
        <fpage>1120</fpage>
        <lpage>1127</lpage>
        <pub-id pub-id-type="pmid">22081019</pub-id>
      </element-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kharchenko</surname>
            <given-names>P.V.</given-names>
          </name>
          <name>
            <surname>Silberstein</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Scadden</surname>
            <given-names>D.T.</given-names>
          </name>
        </person-group>
        <article-title>Bayesian approach to single-cell differential expression
analysis</article-title>
        <source>Nat. Methods.</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>740</fpage>
        <lpage>742</lpage>
        <pub-id pub-id-type="pmid">24836921</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fraley</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Raftery</surname>
            <given-names>A. E.</given-names>
          </name>
        </person-group>
        <article-title>Model-based clustering, discriminant analysis, and density
estimation</article-title>
        <source>J. Am. Stat. Assoc.</source>
        <year>2002</year>
        <volume>97</volume>
        <fpage>611</fpage>
        <lpage>631</lpage>
      </element-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Chris</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Adrian</surname>
            <given-names>E.R.T.</given-names>
          </name>
          <name>
            <surname>Brendan</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Luca</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>mclust Version 4 for R: Normal mixture modeling for model-based clustering,
classification, and density estimation</article-title>
        <source>Technical Report</source>
        <year>2012</year>
        <publisher-loc>Washington D.C</publisher-loc>
        <publisher-name>Department of Statistics, University of
Washington</publisher-name>
        <comment>No. 597</comment>
      </element-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>S.N.</given-names>
          </name>
        </person-group>
        <article-title>Fast stable restricted maximum likelihood and marginal likelihood
estimation of semiparametric generalized linear models</article-title>
        <source>J. Roy. Stat. Soc. B.</source>
        <year>2011</year>
        <volume>73</volume>
        <fpage>3</fpage>
        <lpage>36</lpage>
      </element-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: A practical and powerful approach to
multiple testing</article-title>
        <source>J. Roy. Stat. Soc. B</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amit</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Garber</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Chevrier</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Leite</surname>
            <given-names>A.P.</given-names>
          </name>
          <name>
            <surname>Donner</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Eisenhaure</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Guttman</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Grenier</surname>
            <given-names>J.K.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Zuk</surname>
            <given-names>O.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unbiased reconstruction of a mammalian transcriptional network mediating
pathogen responses</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>326</volume>
        <fpage>257</fpage>
        <lpage>263</lpage>
        <pub-id pub-id-type="pmid">19729616</pub-id>
      </element-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shin</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Berg</surname>
            <given-names>D.A.</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Shin</surname>
            <given-names>J.Y.</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Bonaguidi</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Enikolopov</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Nauen</surname>
            <given-names>D.W.</given-names>
          </name>
          <name>
            <surname>Christian</surname>
            <given-names>K.M.</given-names>
          </name>
          <name>
            <surname>Ming</surname>
            <given-names>G.L.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-Cell RNA-Seq with Waterfall Reveals Molecular Cascades underlying
Adult Neurogenesis</article-title>
        <source>Cell Stem Cell</source>
        <year>2015</year>
        <volume>17</volume>
        <fpage>360</fpage>
        <lpage>372</lpage>
        <pub-id pub-id-type="pmid">26299571</pub-id>
      </element-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haghverdi</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Buettner</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>F.J.</given-names>
          </name>
        </person-group>
        <article-title>Diffusion maps for high-dimensional single-cell analysis of differentiation
data</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>2989</fpage>
        <lpage>2998</lpage>
        <pub-id pub-id-type="pmid">26002886</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
