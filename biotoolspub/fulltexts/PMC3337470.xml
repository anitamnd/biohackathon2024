<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">G3 (Bethesda)</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genetics</journal-id>
    <journal-id journal-id-type="hwp">ggg</journal-id>
    <journal-id journal-id-type="pmc">ggg</journal-id>
    <journal-id journal-id-type="publisher-id">ggg</journal-id>
    <journal-title-group>
      <journal-title>G3: Genes|Genomes|Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2160-1836</issn>
    <publisher>
      <publisher-name>Genetics Society of America</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3337470</article-id>
    <article-id pub-id-type="pmid">22540033</article-id>
    <article-id pub-id-type="publisher-id">GGG_001297</article-id>
    <article-id pub-id-type="doi">10.1534/g3.111.001297</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Investigations</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Simulated Data for Genomic Selection and Genome-Wide Association Studies Using a Combination of Coalescent and Gene Drop Methods</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hickey</surname>
          <given-names>John M.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">*</xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gorjanc</surname>
          <given-names>Gregor</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>†</sup>
        </xref>
      </contrib>
      <aff id="aff1"><label>*</label>School of Environmental and Rural Science, University of New England, Armidale, 2351 New South Wales, Australia</aff>
      <aff id="aff2"><label>†</label>Department of Animal Science, Biotechnical Faculty, University of Ljubljana, 1230 Domžale, Slovenia</aff>
    </contrib-group>
    <author-notes>
      <fn>
        <p>Supporting information is available online at <ext-link ext-link-type="uri" xlink:href="http://www.g3journal.org/lookup/suppl/doi:10.1534/g3.111.001297/-/DC1">http://www.g3journal.org/lookup/suppl/doi:10.1534/g3.111.001297/-/DC1</ext-link></p>
      </fn>
      <corresp id="cor1"><label>1</label>Corresponding author: School of Environmental and Rural Science, University of New England, Armidale, 2351 New South Wales, Australia E-mail: <email>john.hickey@une.edu.au</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>4</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2012</year>
    </pub-date>
    <volume>2</volume>
    <issue>4</issue>
    <fpage>425</fpage>
    <lpage>427</lpage>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>9</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>09</day>
        <month>11</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2012 Hickey, Gorjanc</copyright-statement>
      <copyright-year>2012</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/3.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution Unported License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/3.0/">http://creativecommons.org/licenses/by/3.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:title="pdf" xlink:type="simple" xlink:href="425.pdf"/>
    <abstract>
      <p>An approach is described for simulating data sequence, genotype, and phenotype data to study genomic selection and genome-wide association studies (GWAS). The simulation method, implemented in a software package called AlphaDrop, can be used to simulate genomic data and phenotypes with flexibility in terms of the historical population structure, recent pedigree structure, distribution of quantitative trait loci effects, and with sequence and single nucleotide polymorphism-phased alleles and genotypes. Ten replicates of a representative scenario used to study genomic selection in livestock were generated and have been made publically available. The simulated data sets were structured to encompass a spectrum of additive quantitative trait loci effect distributions, relationship structures, and single nucleotide polymorphism chip densities.</p>
    </abstract>
    <kwd-group>
      <kwd>genome-wide association studies (GWAS)</kwd>
      <kwd>shared data resources</kwd>
      <kwd>GenPred</kwd>
      <kwd>simulation method</kwd>
      <kwd>quantitative trait loci (QTL)</kwd>
      <kwd>pedigrees</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name> DJS Export </meta-name>
        <meta-value>v1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <p>Simulation studies have made important contributions to the advancement of animal and plant breeding. With many breeding programs now incorporating genomic information at great expense, simulation is both useful and necessary to compare, at low cost, the potential that different analysis methods have to increase the accuracy of estimating breeding values and to compare the alternative structures of breeding programs. Furthermore, simulation can be used to test and benchmark software packages. Recently, many alternative strategies for simulation have been applied within the context of livestock. These strategies use different ways to simulate data, have distributions of quantitative trait loci (QTL) effects, and have different relationship structures. This complicates the comparison of the results and conclusions drawn from the different studies. The first objective of this note was to describe a simple simulation method that can be used to simulate animal or plant genomic data and phenotypes with flexibility in terms of historical population structure, recent pedigree structure, distribution of QTL effects, and with sequence and single nucleotide polymorphism (SNP)-phased alleles and genotypes. The second objective of this note was to provide a set of publically available simulated data sets that cover a spectrum of QTL distributions, relationship structures, and SNP densities. The data were simulated to represent a livestock population and mimic some of the scenarios in which genomic selection is applied.</p>
  <sec sec-type="materials|methods" id="s1">
    <title>Materials and Methods</title>
    <sec id="s2">
      <title>Method of simulation</title>
      <p>A system to simulate sequence, SNP, and QTL data using a combination of coalescent and gene drop methods was developed. The system is packaged in a Fortran 95 program called AlphaDrop, which calls the Markovian Coalescence Simulator (MaCS) (<xref rid="bib2" ref-type="bibr">Chen <italic>et al.</italic> 2009</xref>). AlphaDrop has full flexibility in terms of number of chromosomes, QTL, and SNP chips and their density, pedigree structure, and whether the underlying sequence data are outputted. Through the use of MaCS, full flexibility is available in terms of the structure and size of the ancestral population. QTL effects are restricted to being additive and sampled from normal or gamma distributions. MaCS and AlphaDrop are each controlled by a single specification file, examples of which are given in the <ext-link ext-link-type="uri" xlink:href="http://www.g3journal.org/lookup/suppl/doi:10.1534/g3.111.001297/-/DC1">supporting information</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://www.g3journal.org/lookup/suppl/doi:10.1534/g3.111.001297/-/DC1/FileS1.zip">File S1</ext-link>.</p>
      <p>Briefly, AlphaDrop starts by setting up the data structures in terms of SNP chips and pedigree. It then calls MaCS, which simulates a sample of haplotypes with sequence information for each chromosome according to the specified ancestral population and mutation and recombination rates. AlphaDrop then drops these haplotypes through a pedigree with a recombination rate assuming 1 recombination event every 100 centimorgans (cM) but no mutation. Internally or externally generated pedigrees can be used. Currently the internal pedigrees are restricted to mammalian species. To simulate data for other species, such as plant species, an externally created pedigree needs to be supplied. The base generation of the pedigree is the most recent generation of the ancestral population simulated using MaCS. Next, the segregating sites are sampled at random to become SNP markers, and a number of SNP chips of different density are provided. The user has full control over the number and density of these chips. The full sequence and phased data can also be outputted if required.</p>
      <p>AlphaDrop then selects two samples of segregating sites to possibly become QTL. These are called candidate QTL. The first set comprises a user-specified number of candidate QTL selected at random from across the genome. The second set comprises a user-specified number of candidate QTL selected at random from across the genome with the restriction that the minor allele frequency must be less than a certain threshold. This restriction was designed to facilitate the possibility that QTL have lower minor allele frequency than SNP. Four different traits are then generated assuming an additive genetic model. The first pair of traits is generated using the unrestricted candidate QTL loci. For the first trait (PolyUnres), the allele substitution effect at each QTL locus is sampled from a normal distribution with a mean of zero and standard deviation of one unit. For the second trait (GammaUnres), a random subset of the unrestricted set of candidate QTL loci are selected and the allele substitution effect at each QTL locus is sampled from a gamma distribution with a user-specified shape and scale parameter and a 50% chance of being positive or negative. The second pair of traits (PolyRes and GammaRes) is generated in the same way as the first pair except that the candidate QTL comprise a set with the restriction that their minor allele frequency could not exceed a user specified threshold.</p>
      <p>Phenotypes with user-defined heritability are generated for each trait. To ensure that the heritability of the four traits remains constant, the residual variance is scaled relative to the variance of the breeding values of individuals in the base generation of the pedigree, which was given by <bold>a</bold>′<bold>a</bold>/(<italic>n</italic> − 1), where <bold>a</bold> is a vector of breeding value of individuals in the base generation and <italic>n</italic> is the number of individuals in that generation.</p>
      <p>AlphaDrop efficiently stores sequence information, and this makes the simulation of sequence data in large pedigrees computationally feasible. Gametes comprise strings of 0s and 1s, representing SNP alleles. Gametes can therefore be thought of as large binary numbers and represented as integers. AlphaDrop breaks gametes into haplotypes of a certain length. Each haplotype can be represented as long integer, and these long integers are only decompressed into their binary numbers where a recombination occurs.</p>
    </sec>
    <sec id="s3">
      <title>Simulated data sets</title>
      <p>Ten replicates of a livestock data structure were simulated. The structure was designed to cover a spectrum of QTL distributions, relationship structures, and SNP chip densities and to mimic some of the scenarios in which genomic selection is applied. In each replicate sequence data for 4000 base haplotypes for each of 30 chromosomes was simulated using the MaCS (<xref rid="bib2" ref-type="bibr">Chen <italic>et al.</italic> 2009</xref>). The 30 chromosomes were each 100 cM in length comprising approximately 10<sup>8</sup> base pairs and were simulated using a per site mutation rate of 2.5*10<sup>−8</sup> and an effective population size (Ne) of 100 in the final generation of the sequence simulation. The reduction of Ne in the preceding generations was modeled with a Ne 1000 years ago of 1256, a Ne 10,000 years ago of 4350, and a Ne 100,000 years ago of 43,500 with linear changes in between. This reflects estimates by <xref rid="bib4" ref-type="bibr">Villa-Angulo <italic>et al.</italic> (2009)</xref> for the Holstein population.</p>
      <p>A pedigree was simulated comprising 10 generations of individuals, with 50 sires per generation, 10 dams per sire, and 2 offspring per dam. Base individuals in the pedigree had their gametes randomly sampled from the 4000 haplotypes of the sequence simulation allowing for recombination according to the genetic distance using 1% probability of a recombination event per cM. Subsequent generations in the pedigree had their gametes generated through Mendelian inheritance with recombination. The total number of segregating sites across the resulting genome was approximately 1,670,000. A set of 9000 segregating sites were randomly selected from the sequence to be used as candidate QTL loci in two different ways, one a randomly sampled set and the other being a randomly sampled set with the restriction that their minor allele frequency could not exceed 0.30. In addition, a random samples of 60,000 and 300,000 segregating sites was selected from the sequence to be used as SNP on two different SNP chips.</p>
      <p>Four different traits were simulated assuming an additive genetic model. The first pair of traits was generated using the 9000 unrestricted candidate QTL loci. For the first trait (PolyUnres), the allele substitution effect at each QTL locus was sampled from a normal distribution with a mean of zero and standard deviation of one unit. For the second trait (GammaUnres), a random subset of 900 of the candidate QTL loci were selected and their allele substitution effects at each QTL locus were sampled from a gamma distribution with a shape of 0.4 and scale of 1.66 (<xref rid="bib6" ref-type="bibr">Meuwissen <italic>et al.</italic> 2001</xref>) and a 50% chance of being positive or negative. The second pair of traits (PolyRes and GammaRes) was generated in the same way as the first pair except that the candidate QTL loci comprised the 9000 with the restriction that their minor allele frequency could not exceed 0.30. Phenotypes with a heritability of 0.25 were generated for each trait.</p>
    </sec>
    <sec id="s4">
      <title>Training and validation data sets</title>
      <p>Subsets of the data were extracted for training and validation. The training set comprised the 2000 individuals in generations 4 and 5 (<italic>i.e.</italic> 1000 animals in each generation). Three validation sets were extracted, consisting of 1500 animals, with 500 animals sampled at random from each of generations 6, 8, and 10. The structure of the training and testing data sets are illustrated in <xref ref-type="fig" rid="fig1">Figure 1</xref>.</p>
      <fig id="fig1" fig-type="figure" position="float">
        <label>Figure 1</label>
        <caption>
          <p>Structure of training and testing data sets.</p>
        </caption>
        <graphic xlink:href="425f1"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s5">
    <title>Discussion</title>
    <p>A system to simulate data for the study of genomic selection in livestock and plants was developed. The system, which combines coalescent and gene drop methods, was designed to be simple and flexible. It makes routine simulation of sequence data for large pedigrees possible. Other genome simulation packages are publically available, such as Fregene (<xref rid="bib1" ref-type="bibr">Chadeau-Hyam <italic>et al.</italic> 2008</xref>), HaploSim (<xref rid="bib3" ref-type="bibr">Coster <italic>et al.</italic> 2010</xref>), and QMSim (<xref rid="bib5" ref-type="bibr">Sargolzaei and Schenkel 2009</xref>). However, given that these packages are based on gene dropping approaches they are less computationally efficient in comparison with the combination of coalescent and gene drop approaches presented here. There are important questions relating to the simulation of genomic data that remain to be resolved. It is not clear whether coalescent or gene drop methods generate realistic genomic data and whether simple additive genetic models are sufficient. Like the simulated data from all other packages, the data simulated by AlphaDrop may not fully reflect the structure of real data. However, the presented approach uses realistic mutation rates, recombination rates, evolution of historical effective population sizes, and numbers of nucleotide base pairs to reflect whole genome level sequence. Simulated data would benefit from having standardized methods to validate its quality. Further development of AlphaDrop is ongoing.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supporting Information</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_2_4_425__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="x-zip-compressed" xlink:href="supp_2.4.425_FileS1.zip"/>
      <media xlink:role="associated-file" mimetype="text" mime-subtype="plain" xlink:href="supp_2.4.425_SimulatedDataDescription.txt"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>We thank Brian Kinghorn, Hans Daetwyler, Julius van der Werf, Sam Clark, and Gustavo de los Campos for their useful discussions. This research was funded by the Australian Research Council project LP100100880 of which Genus Pty, Aviagen LTD, and Pfizer are co-funders. The simulated data sets are available in the <ext-link ext-link-type="uri" xlink:href="http://www.g3journal.org/lookup/suppl/doi:10.1534/g3.111.001297/-/DC1">supporting information</ext-link>. AlphaDrop, and its source code, is available from <ext-link ext-link-type="uri" xlink:href="http://sites.google.com/site/hickeyjohn/workstuff">http://sites.google.com/site/hickeyjohn/workstuff</ext-link>.</p>
    <p>The authors declare that they have no competing interests.</p>
  </ack>
  <fn-group>
    <fn>
      <p>Edited by Dirk-Jan de Koning and Lauren M. McIntyre</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>Literature Cited</title>
    <ref id="bib1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chadeau-Hyam</surname><given-names>M</given-names></name><name><surname>Hoggart</surname><given-names>C. J.</given-names></name><name><surname>O’Reilly</surname><given-names>P. F.</given-names></name><name><surname>Whittaker</surname><given-names>J. C.</given-names></name><name><surname>De Lorio</surname><given-names>M.</given-names></name><etal/></person-group>, <year>2008</year> <article-title>Fregene: Simulation of realistic sequence-level data in populations and ascertained samples</article-title>. <source>BMC Bioinformatics</source><volume>9</volume>: <fpage>364</fpage><pub-id pub-id-type="pmid">18778480</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>G. K.</given-names></name><name><surname>Marjoram</surname><given-names>P.</given-names></name><name><surname>Wall</surname><given-names>J. D.</given-names></name></person-group>, <year>2009</year> <article-title>Fast and flexible simulation of DNA sequence data</article-title>. <source>Genome Res.</source><volume>19</volume>: <fpage>136</fpage>–<lpage>142</lpage><pub-id pub-id-type="pmid">19029539</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coster</surname><given-names>A. J.</given-names></name><name><surname>Bastiaansen</surname><given-names>W. M.</given-names></name><name><surname>Calus</surname><given-names>M. P. L.</given-names></name><name><surname>Van Arendonk</surname><given-names>J. A. M.</given-names></name><name><surname>Bovenhuis</surname><given-names>H.</given-names></name></person-group>, <year>2010</year> <article-title>Sensitivity of methods for estimating breeding values using genetic markers to the number of QTL and distribution of QTL variance</article-title>. <source>Genet. Sel. Evol.</source><volume>42</volume>: <fpage>9</fpage><pub-id pub-id-type="pmid">20302681</pub-id></mixed-citation>
    </ref>
    <ref id="bib6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meuwissen</surname><given-names>T. H. E.</given-names></name><name><surname>Hayes</surname><given-names>B. J.</given-names></name><name><surname>Goddard</surname><given-names>M. E.</given-names></name></person-group>, <year>2001</year> <article-title>Prediction of total genetic value using genome-wide dense marker maps</article-title>. <source>Genetics</source><volume>157</volume>: <fpage>1819</fpage>–<lpage>1829</lpage><pub-id pub-id-type="pmid">11290733</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Villa-Angulo</surname><given-names>R.</given-names></name><name><surname>Matukumalli</surname><given-names>L. K.</given-names></name><name><surname>Gill</surname><given-names>C. A.</given-names></name><name><surname>Choi</surname><given-names>J.</given-names></name><name><surname>Van Tassell</surname><given-names>C. P.</given-names></name><etal/></person-group>, <year>2009</year> <article-title>High-resolution haplotype block structure in the cattle genome</article-title>. <source>BMC Genet.</source><volume>10</volume>: <fpage>19</fpage><pub-id pub-id-type="pmid">19393054</pub-id></mixed-citation>
    </ref>
    <ref id="bib5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sargolzaei</surname><given-names>M.</given-names></name><name><surname>Schenkel</surname><given-names>F. S.</given-names></name></person-group>, <year>2009</year> <article-title>QMSim: A large scale genome simulator for livestock</article-title>. <source>Bioinformatics</source><volume>25</volume>: <fpage>680</fpage>–<lpage>681</lpage><pub-id pub-id-type="pmid">19176551</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
