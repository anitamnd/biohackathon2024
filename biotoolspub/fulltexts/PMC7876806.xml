<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7876806</article-id>
    <article-id pub-id-type="publisher-id">3979</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-03979-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Detecting differentially methylated regions using a fast wavelet-based approach to functional association analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9690-3890</contrib-id>
        <name>
          <surname>Denault</surname>
          <given-names>William R. P.</given-names>
        </name>
        <address>
          <email>william.denault@fhi.no</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jugessur</surname>
          <given-names>Astanand</given-names>
        </name>
        <address>
          <email>astanand.jugessur@fhi.no</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.418193.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 1541 4204</institution-id><institution>Department of Genetics and Bioinformatics, </institution><institution>Norwegian Institute of Public Health, </institution></institution-wrap>Oslo, Norway </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.418193.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 1541 4204</institution-id><institution>Centre for Fertility and Health, </institution><institution>Norwegian Institute of Public Health, </institution></institution-wrap>Oslo, Norway </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.7914.b</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 7443</institution-id><institution>Department of Global Public Health and Primary Care, </institution><institution>University of Bergen, </institution></institution-wrap>Bergen, Norway </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>61</elocation-id>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>9</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>1</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">We present here a computational shortcut to improve a powerful wavelet-based method by Shim and Stephens (Ann Appl Stat 9(2):665–686, 2015. 10.1214/14-AOAS776) called WaveQTL that was originally designed to identify DNase I hypersensitivity quantitative trait loci (dsQTL).</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">WaveQTL relies on permutations to evaluate the significance of an association. We applied a recent method by Zhou and Guan (J Am Stat Assoc 113(523):1362–1371, 2017. 10.1080/01621459.2017.1328361) to boost computational speed, which involves calculating the distribution of Bayes factors and estimating the significance of an association by simulations rather than permutations. We called this simulation-based approach “fast functional wavelet” (FFW), and tested it on a publicly available DNA methylation (DNAm) dataset on colorectal cancer. The simulations confirmed a substantial gain in computational speed compared to the permutation-based approach in WaveQTL. Furthermore, we show that FFW controls the type I error satisfactorily and has good power for detecting differentially methylated regions.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Our approach has broad utility and can be applied to detect associations between different types of functions and phenotypes. As more and more DNAm datasets are being made available through public repositories, an attractive application of FFW would be to re-analyze these data and identify associations that might have been missed by previous efforts. The full R package for FFW is freely available at GitHub <ext-link ext-link-type="uri" xlink:href="https://github.com/william-denault/ffw">https://github.com/william-denault/ffw</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Wavelets</kwd>
      <kwd>DNA methylation</kwd>
      <kwd>EWAS</kwd>
      <kwd>Association analysis</kwd>
      <kwd>Epigenetics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100005416</institution-id>
            <institution>Norges Forskningsråd</institution>
          </institution-wrap>
        </funding-source>
        <award-id>249779</award-id>
        <award-id>262700</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par15">Despite the recent surge of interest in functional association analysis of various types of high-dimensional data, e.g., those from biomechanical research [<xref ref-type="bibr" rid="CR1">1</xref>], quantitative trait loci (QTL) mapping [<xref ref-type="bibr" rid="CR2">2</xref>], genome-wide association studies (GWASes) [<xref ref-type="bibr" rid="CR3">3</xref>], and epigenome-wide association studies (EWASes) [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>], the majority of genome-wide screenings are still largely based on testing one SNP or one CpG at a time (single-point analysis). Single-point analyses are limited because they incur a substantial multiple-testing burden and ignore the genomic context of the association. Bump-hunting methods [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR6">6</xref>] can, to some extent, alleviate these issues by detecting a predetermined difference in the spatially ordered variables (e.g., SNPs or CpGs) that correlate with the trait or disease under scrutiny. However, as the name implies, bump-hunting methods can only analyze a single bump at a time, failing to consider the combined effect of multiple bumps in a given region. Besides the lack of power [<xref ref-type="bibr" rid="CR5">5</xref>], bump-hunting methods also rely on a re-sampling procedure, such as bootstrapping or permutation, which makes them computationally more intensive (for details, see [<xref ref-type="bibr" rid="CR4">4</xref>]).</p>
    <p id="Par16">To help address these methodological shortcomings, we developed a wavelet-based method to enable the detection of more complex signals than those present in a single bump. Although several methods are now available for functional association analysis based on wavelets [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref>], they do not scale well in terms of computational time when the sample size (<italic>n</italic>) or the number of regions (<italic>R</italic>) becomes exceedingly large (e.g., when <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n\approx 1000$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>n</mml:mi><mml:mo>≈</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq1.gif"/></alternatives></inline-formula> or <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R &gt; 1000$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>R</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq2.gif"/></alternatives></inline-formula>). As wavelet coefficients are not independent, Lee and Morris [<xref ref-type="bibr" rid="CR5">5</xref>] and Ma and Soriano [<xref ref-type="bibr" rid="CR9">9</xref>] proposed searching for associations between a trait and a function by using wavelet regression that takes into account the dependencies between the wavelet coefficients. However, this requires the use of a re-sampling procedure such as Markov Chain Monte Carlo (MCMC) (exemplified in [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]) or the computation of complex analytical posterior distributions as in Ma and Soriano [<xref ref-type="bibr" rid="CR9">9</xref>]. To address these issues, Shim and Stephens [<xref ref-type="bibr" rid="CR8">8</xref>] proposed simplifying the modeling by omitting the dependencies and using a likelihood ratio test to search for associations between a trait and a function. This simplification is, however, still limited because of the need for permutations to evaluate the significance of the likelihood ratio.</p>
    <p id="Par17">In our current approach, which we call “Fast Functional Wavelet” (FFW), we combine the framework of Shim and Stephens [<xref ref-type="bibr" rid="CR8">8</xref>] with recent results on the theoretical null distribution of Bayes factors by Zhou and Guan [<xref ref-type="bibr" rid="CR10">10</xref>]. Our approach allows a fast emulation of the test statistic in Shim and Stephens [<xref ref-type="bibr" rid="CR8">8</xref>] and reduces the computational time considerably. The main difference between FFW and WaveQTL is that FFW requires regressing the trait of interest on the wavelet coefficients, regardless of the application. Hence, the design matrix for association is kept constant across all the screened regions. This simple modification enables the null distribution of the test statistic to be simulated using only a <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\chi ^2 _1$$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mi>χ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq3.gif"/></alternatives></inline-formula> distribution, thereby circumventing the need for extensive permutations to assess the significance of a region. By keeping the design matrix for association constant across the screened regions, and using the results of Zhou and Guan [<xref ref-type="bibr" rid="CR10">10</xref>], we can show that the same distribution can be used to emulate the null distribution of each regional test. This null distribution depends on a single parameter that is easily computed. Keeping the design matrix constant across the screened regions can lead to a reverse regression, resulting in shrunken estimates and a potential loss of power (see Fuller, Chapter 1 [<xref ref-type="bibr" rid="CR11">11</xref>]). Besides making the null distribution easier to emulate, reverse regression also allows the analysis of a wider variety of traits (continuous, binary, or count).</p>
    <p id="Par18">Although the focus of the current paper is on DNAm data, we describe FFW more broadly to highlight its utility for other types of high-dimensional data, such as those from a GWAS [<xref ref-type="bibr" rid="CR3">3</xref>], dsQTL analysis [<xref ref-type="bibr" rid="CR2">2</xref>], and functional data from biomechanical research [<xref ref-type="bibr" rid="CR1">1</xref>].</p>
  </sec>
  <sec id="Sec2">
    <title>Description of our wavelet-based approach</title>
    <p id="Par19">There are different types of wavelets, and readers interested in a more comprehensive introduction to wavelets are referred to Nason [<xref ref-type="bibr" rid="CR12">12</xref>]. In our application here (FFW), we only consider the simplest type of wavelet—the Haar wavelet.</p>
    <sec id="Sec3">
      <title>Processing</title>
      <p id="Par20">For simplicity, we consider genetic regions composed of evenly-spaced variables of length <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^J$$\end{document}</tex-math><mml:math id="M8"><mml:msup><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq4.gif"/></alternatives></inline-formula>. As the assumption of evenly-spaced variables rarely holds in practice, we use the approach of Kovac and Silverman [<xref ref-type="bibr" rid="CR13">13</xref>] to handle this limitation in our software implementation. Their approach mainly consists of using an interpolation on the observed data to obtain evenly-spaced variables of length <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^J$$\end{document}</tex-math><mml:math id="M10"><mml:msup><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq5.gif"/></alternatives></inline-formula>.</p>
      <p id="Par21">A given region is defined as a compound of <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_1,\ldots X_{2^J}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:msup><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:msup></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq6.gif"/></alternatives></inline-formula>, with <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^J$$\end{document}</tex-math><mml:math id="M14"><mml:msup><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq7.gif"/></alternatives></inline-formula> spatially-ordered variables. Suppose we observe these <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^J$$\end{document}</tex-math><mml:math id="M16"><mml:msup><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq8.gif"/></alternatives></inline-formula> variables for <italic>n</italic> individuals; we then denote <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_{i,k}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq9.gif"/></alternatives></inline-formula> as the <italic>k</italic>th observation of the <italic>i</italic>th variable. The wavelet coefficients for the individual <italic>k</italic> are defined as follows. For wavelet coefficients corresponding to the highest scale or resolution (i.e., <italic>J</italic>), and for <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in \llbracket 1,2^{J-1}\rrbracket$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>〚</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>J</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>〛</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq10.gif"/></alternatives></inline-formula><disp-formula id="Equ18"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\tilde{X}}_{J,i,k}= X_{2i,k} -X_{2i-1,k} \end{aligned}$$\end{document}</tex-math><mml:math id="M22" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>J</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula>These wavelet coefficients correspond to local differences between adjacent variables. For a lower scale (i.e., <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j &lt; J$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq11.gif"/></alternatives></inline-formula>), the corresponding wavelet coefficients are computed as follows:<disp-formula id="Equ19"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\tilde{X}}_{j,i,k}= \check{X}_{j+1,2i,k} -\check{X}_{j+1,2i-1,k} \end{aligned}$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">ˇ</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">ˇ</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\check{X}_{j,2i,k}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">ˇ</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq12.gif"/></alternatives></inline-formula>, is defined as:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \check{X}_{j,2i,k} = {\left\{ \begin{array}{ll} \forall i \in \llbracket 1,2^{J-1}\rrbracket , X_{2i,k} + X_{2i-1,k}, &amp;{} \hbox { if}\ j=J \\ \forall i \in \llbracket 1,2^{j-1}\rrbracket , \check{X}_{j+1,2i,k} + \check{X}_{j+1,2i-1,k}, &amp;{} \hbox { if}\ 1\le j &lt; J \end{array}\right. } \end{aligned}$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">ˇ</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>〚</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>J</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>〛</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="0.333333em"/><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>〚</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>〛</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">ˇ</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">ˇ</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mspace width="0.333333em"/><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><inline-formula id="IEq13"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\check{X}_{j,2i,k}$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">ˇ</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq13.gif"/></alternatives></inline-formula> correspond to the scaled average of the adjacent variables for individual <italic>k</italic> (for further details, see Nason [<xref ref-type="bibr" rid="CR14">14</xref>]). Finally, the wavelet coefficients for the lowest scale (i.e., 0) are computed as follows:<disp-formula id="Equ20"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\tilde{X}}_{0,1,k}= \sum _{i=1}^{2^J} X_{i,k} \end{aligned}$$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:msup></mml:munderover><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ20.gif" position="anchor"/></alternatives></disp-formula>The procedure described above is known as Mallat’s pyramid algorithm for signal processing [<xref ref-type="bibr" rid="CR15">15</xref>]. To ease comprehension, we denote <inline-formula id="IEq14"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tilde{X}}_{jl}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq14.gif"/></alternatives></inline-formula> as the random variable representing the wavelet coefficient at the scale <italic>j</italic>, with <inline-formula id="IEq15"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \le j \le J$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq15.gif"/></alternatives></inline-formula>, and at the location <italic>l</italic>, with <inline-formula id="IEq16"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \le l \le 2^{j-1}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>l</mml:mi><mml:mo>≤</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq16.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec4">
      <title>Modeling</title>
      <p id="Par22">We first summarize the work of Shim and Stephens [<xref ref-type="bibr" rid="CR8">8</xref>] before presenting our main methodological contributions in the “<xref rid="Sec7" ref-type="sec">Significance of a region</xref>” section further below.</p>
      <p id="Par23">To identify associations between a region and a phenotype (denoted as <inline-formula id="IEq17"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi$$\end{document}</tex-math><mml:math id="M42"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq17.gif"/></alternatives></inline-formula> hereafter), we assess whether specific scales are associated with <inline-formula id="IEq18"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi$$\end{document}</tex-math><mml:math id="M44"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq18.gif"/></alternatives></inline-formula> at different locations. Let <inline-formula id="IEq19"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi$$\end{document}</tex-math><mml:math id="M46"><mml:mi>π</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq19.gif"/></alternatives></inline-formula> be a vector of length <italic>J</italic>, where <inline-formula id="IEq20"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\forall j \in [0:J], \pi _j \in [0,1]$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>:</mml:mo><mml:mi>J</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq20.gif"/></alternatives></inline-formula> and <inline-formula id="IEq21"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _j$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>π</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq21.gif"/></alternatives></inline-formula> represents the proportion of wavelet coefficients at scale <italic>j</italic> associated with <inline-formula id="IEq22"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi$$\end{document}</tex-math><mml:math id="M52"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq22.gif"/></alternatives></inline-formula>. To assess the significance of a given genetic region, we test the following hypothesis:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} H_0:\pi =(0,\ldots ,0) vs H_1:\exists j \in [0:J], \pi _j \ne 0 \end{aligned}$$\end{document}</tex-math><mml:math id="M54" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mi>π</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>v</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mo>∃</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>:</mml:mo><mml:mi>J</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>In the next sections, we describe the test statistic (likelihood ratio), how its different components are computed, and how its significance is tested.</p>
      <sec id="Sec5">
        <title>Bayes factors</title>
        <p id="Par24">To test for associations between <inline-formula id="IEq23"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi$$\end{document}</tex-math><mml:math id="M56"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq23.gif"/></alternatives></inline-formula> and the wavelet coefficient <inline-formula id="IEq24"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tilde{X}}_{jl}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq24.gif"/></alternatives></inline-formula> for a given region, we use the Normal-Inverse-Gamma (NIG) prior to perform a regression between each wavelet coefficient and <inline-formula id="IEq25"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi$$\end{document}</tex-math><mml:math id="M60"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq25.gif"/></alternatives></inline-formula>. Note that our framework easily allows confounders to be incorporated into the regression models. We quantile-transform each wavelet coefficient across the individuals to reduce the proportion of spurious associations due to distribution-related issues.</p>
        <p id="Par25">The association models for each scale and location are defined as follows:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;M_0: {\tilde{X}}_{jl} = \beta _{jl,0} +\beta _{jl,C}C+\epsilon \nonumber \\&amp;M_1: {\tilde{X}}_{jl} = \beta _{jl,0} + \beta _{jl,1}\Phi +\beta _{jl,C}C+\epsilon \end{aligned}$$\end{document}</tex-math><mml:math id="M62" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mi>C</mml:mi><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mi>C</mml:mi><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <italic>C</italic> is a matrix of dimension <inline-formula id="IEq26"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c \times n$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi>c</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq26.gif"/></alternatives></inline-formula>, <inline-formula id="IEq27"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{jl,C}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq27.gif"/></alternatives></inline-formula> is a matrix of dimension <inline-formula id="IEq28"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \times c$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq28.gif"/></alternatives></inline-formula> and <inline-formula id="IEq29"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon \sim N(0, \sigma ^2)$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq29.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq30"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma ^2$$\end{document}</tex-math><mml:math id="M72"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq30.gif"/></alternatives></inline-formula> is unknown. Next, we compute the Bayes factors of the wavelet regression <italic>jl</italic> using the closed form provided by Zhou and Guan [<xref ref-type="bibr" rid="CR10">10</xref>] for the NIG prior.</p>
      </sec>
      <sec id="Sec6">
        <title>Ratio statistic</title>
        <p id="Par26">Our goal is to assess the significance of the vector <inline-formula id="IEq31"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi = (\pi _0,\ldots , \pi _j,\ldots ,\pi _J)$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mi>π</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq31.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq32"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _j$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mi>π</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq32.gif"/></alternatives></inline-formula> represents the proportion of wavelet coefficients at scale <italic>j</italic> associated with <inline-formula id="IEq33"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi$$\end{document}</tex-math><mml:math id="M78"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq33.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq34"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tilde{X}}$$\end{document}</tex-math><mml:math id="M80"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq34.gif"/></alternatives></inline-formula> is the wavelet representation of the individual functions. To test the significance of <inline-formula id="IEq35"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi$$\end{document}</tex-math><mml:math id="M82"><mml:mi>π</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq35.gif"/></alternatives></inline-formula>, we construct a test statistic by computing the following likelihood ratio:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \Lambda (\pi , {\tilde{X}}, \Phi ) = \frac{p( {\tilde{X}} |\pi , \Phi ) }{p( {\tilde{X}} |\pi \equiv 0, \Phi )} \end{aligned}$$\end{document}</tex-math><mml:math id="M84" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">Λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo stretchy="false">|</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo stretchy="false">|</mml:mo><mml:mi>π</mml:mi><mml:mo>≡</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>Following the approach of Shim and Stephens [<xref ref-type="bibr" rid="CR8">8</xref>], we denote <inline-formula id="IEq36"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _{jl}$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq36.gif"/></alternatives></inline-formula> as the random variable with support <inline-formula id="IEq37"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{0,1\}$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq37.gif"/></alternatives></inline-formula>. Thus, <inline-formula id="IEq38"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _{jl}=1$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq38.gif"/></alternatives></inline-formula> if the wavelet coefficient <inline-formula id="IEq39"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tilde{X}}_{jl}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq39.gif"/></alternatives></inline-formula> is associated with <inline-formula id="IEq40"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi$$\end{document}</tex-math><mml:math id="M94"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq40.gif"/></alternatives></inline-formula>, and 0 if not. We consider <inline-formula id="IEq41"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi$$\end{document}</tex-math><mml:math id="M96"><mml:mi>π</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq41.gif"/></alternatives></inline-formula> as a hyperparameter of <inline-formula id="IEq42"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma _{jl}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq42.gif"/></alternatives></inline-formula>; i.e.,<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} p(\gamma _{jl} =1| \pi ) = \pi _j \end{aligned}$$\end{document}</tex-math><mml:math id="M100" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>Shim and Stephens [<xref ref-type="bibr" rid="CR8">8</xref>] assume independence between the wavelet coefficients. However, this may not to hold in practice [<xref ref-type="bibr" rid="CR16">16</xref>]. Under the assumption of independence of the wavelet coefficients, we can rewrite <xref rid="Equ4" ref-type="">4</xref> as:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \Lambda (\pi , {\tilde{x}}, \Phi )&amp;= \prod _{j,l} \frac{p( {\tilde{x}}_{jl} |\pi _j, \Phi ) }{p( {\tilde{x}}_{jl} |\pi _j = 0, \Phi )} \end{aligned}$$\end{document}</tex-math><mml:math id="M102" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;= \prod _{j,l} \frac{\pi _j p( {\tilde{x}} |\gamma _{jl}=1, \Phi ) + (1-\pi _j) p( {\tilde{x}} |\gamma _{jl}=0, \Phi ) }{p( {\tilde{x}} |\gamma _{jl}=0, \Phi )} \end{aligned}$$\end{document}</tex-math><mml:math id="M104" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>We denote <inline-formula id="IEq43"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$BF_{jl} ({\tilde{x}},\Phi ) = \frac{p( {\tilde{x}}_{jl} |\gamma _{jl}=1, \Phi ) }{p( {\tilde{x}}_{jl} |\gamma _{jl}= 0, \Phi )}$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq43.gif"/></alternatives></inline-formula> as the Bayes factor of the association between the wavelet coefficient at scale <italic>s</italic> and location <italic>l</italic>. Using this notation, we can rewrite <xref rid="Equ7" ref-type="">7</xref> as:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \Lambda (\pi , {\tilde{x}}, \Phi ) = \prod _{j,l} \left[ \pi _j BF_{jl} +(1-\pi _j)\right] \end{aligned}$$\end{document}</tex-math><mml:math id="M108" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">Λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:msub><mml:mi>π</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>B</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>We then compute the likelihood ratio statistic by maximizing the lambda statistics over <inline-formula id="IEq44"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi$$\end{document}</tex-math><mml:math id="M110"><mml:mi>π</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq44.gif"/></alternatives></inline-formula> and estimating <inline-formula id="IEq45"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\pi }}$$\end{document}</tex-math><mml:math id="M112"><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq45.gif"/></alternatives></inline-formula> using the EM algorithm.<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\hat{\Lambda }} ({\tilde{x}}, \Phi ) = max_{ \pi \in [0,1]^J} \Lambda (\pi , {\tilde{x}}, \Phi ) \end{aligned}$$\end{document}</tex-math><mml:math id="M114" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>π</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mi>J</mml:mi></mml:msup></mml:mrow></mml:msub><mml:mi mathvariant="normal">Λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec7">
        <title>Significance of a region</title>
        <p id="Par27">As the distribution of <inline-formula id="IEq46"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Lambda$$\end{document}</tex-math><mml:math id="M116"><mml:mi mathvariant="normal">Λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq46.gif"/></alternatives></inline-formula> is unknown, we simulate <inline-formula id="IEq47"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Lambda$$\end{document}</tex-math><mml:math id="M118"><mml:mi mathvariant="normal">Λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq47.gif"/></alternatives></inline-formula> under <inline-formula id="IEq48"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0$$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq48.gif"/></alternatives></inline-formula> by simulating <inline-formula id="IEq49"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$BF_{jl}$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="italic">jl</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq49.gif"/></alternatives></inline-formula> under <inline-formula id="IEq50"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0$$\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq50.gif"/></alternatives></inline-formula>. Recently, Zhou and Guan [<xref ref-type="bibr" rid="CR10">10</xref>] showed that, under <inline-formula id="IEq51"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0$$\end{document}</tex-math><mml:math id="M126"><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq51.gif"/></alternatives></inline-formula> and a wide spectrum of priors, the Bayes factors (including the NIG prior) follow a specific distribution for a Gaussian model. More precisely,<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} 2log(BF) = \lambda _1 Q_1+ log(1-\lambda _1)+\epsilon \end{aligned}$$\end{document}</tex-math><mml:math id="M128" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>2</mml:mn><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq52"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q_1$$\end{document}</tex-math><mml:math id="M130"><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq52.gif"/></alternatives></inline-formula> is a non-central chi-squared random variable with <inline-formula id="IEq53"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$df=1$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:mi>d</mml:mi><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq53.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq54"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon = O(1)$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq54.gif"/></alternatives></inline-formula> and its non-centrality parameter has a closed-form. The parameter <inline-formula id="IEq55"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _1$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq55.gif"/></alternatives></inline-formula> is the largest eigenvalue of <inline-formula id="IEq56"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X\left( X^t X+ V_b ^{-1}\right) ^{-1}X^t$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:mi>X</mml:mi><mml:msup><mml:mfenced close=")" open="("><mml:msup><mml:mi>X</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mi>X</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>b</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>X</mml:mi><mml:mi>t</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq56.gif"/></alternatives></inline-formula>, where <italic>X</italic> is the design matrix. Specifically, <inline-formula id="IEq57"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X= \left( {\mathbf {1}},Y, C^t\right)$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mn mathvariant="bold">1</mml:mn><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mi>t</mml:mi></mml:msup></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq57.gif"/></alternatives></inline-formula> and <inline-formula id="IEq58"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_b=diag( \sigma _b ^2 )$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq58.gif"/></alternatives></inline-formula> (<inline-formula id="IEq59"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _b$$\end{document}</tex-math><mml:math id="M144"><mml:msub><mml:mi>σ</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq59.gif"/></alternatives></inline-formula> is the prior effect size of the NIG prior for the intercept and the covariates). By keeping the design matrix constant across the regions, <inline-formula id="IEq60"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _1$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq60.gif"/></alternatives></inline-formula> stays the same for all the regions and only needs to be computed once. The non-centrality parameter is region-dependent in general, but it is exactly zero when the null hypothesis of the Bayes factor is <inline-formula id="IEq61"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{jl,1}=0$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq61.gif"/></alternatives></inline-formula>. Zhou and Guan [<xref ref-type="bibr" rid="CR10">10</xref>] showed that, for <italic>df</italic> = 1, <inline-formula id="IEq62"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q_1$$\end{document}</tex-math><mml:math id="M150"><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq62.gif"/></alternatives></inline-formula> is asymptotically equal to the likelihood ratio test statistic for Gaussian linear models. In other words, <inline-formula id="IEq63"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q_1$$\end{document}</tex-math><mml:math id="M152"><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq63.gif"/></alternatives></inline-formula> is equal to a simple chi-squared statistic with one degree of freedom. Therefore, we use the approximation in Eq. (<xref rid="Equ11" ref-type="">11</xref>) for the distribution of the Bayes factors. Note also that Zhou and Guan [<xref ref-type="bibr" rid="CR10">10</xref>] showed that this approximation is exact when using a Normal prior.<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} 2log(BF) \approx \lambda _1 \chi ^2_1+ log(1-\lambda _1) \end{aligned}$$\end{document}</tex-math><mml:math id="M154" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>2</mml:mn><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>χ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>By using this approximation, it is only necessary to compute a single parameter for all the regions. We can then perform <italic>M</italic> independent simulations of the vector of Bayes factors under <inline-formula id="IEq64"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0$$\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq64.gif"/></alternatives></inline-formula>. This corresponds to <italic>M</italic> vectors of length <inline-formula id="IEq65"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^{J}$$\end{document}</tex-math><mml:math id="M158"><mml:msup><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq65.gif"/></alternatives></inline-formula>, corresponding to the number of wavelet coefficients. Next, for each simulated vector of Bayes factors <inline-formula id="IEq66"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$BF_m$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq66.gif"/></alternatives></inline-formula>, we compute the simulated likelihood ratio <inline-formula id="IEq67"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\Lambda }}_{ m } = max_{ \pi \in [0,1]^J} \Lambda (\pi ,BF_m)$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>π</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mi>J</mml:mi></mml:msup></mml:mrow></mml:msub><mml:mi mathvariant="normal">Λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq67.gif"/></alternatives></inline-formula> using the procedure described above. Monte Carlo methods for p value estimation can then be applied to the set of observed statistics.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Simulations and application</title>
    <p id="Par28">We performed a set of simulations to evaluate the gain in computational time with FFW and to assess the significance of the test statistic. We also evaluated the statistical power of FFW using a realistically simulated dataset. Lastly, we ran a sensitivity analysis for the priors to assess the sensitivity of FFW according to the choice of prior. All the simulations were performed on an ordinary laptop, equipped with an Intel(R) i7-700HQ 2.80 GHz processor and 8 GB of RAM.</p>
    <sec id="Sec9">
      <title>Gain in computational time</title>
      <p id="Par29">We performed separate EWASes using FFW and WaveQTL, and report the run time for different sample sizes. Figure <xref rid="Fig1" ref-type="fig">1</xref> illustrates the substantial gain in computational time with FFW. The green and orange curves represent the total time it took to perform an EWAS based on DNAm data generated on the Illumina 450K platform (using the same pre-processing steps as in the “<xref rid="Sec11" ref-type="sec">Power and prior sensitivity analysis</xref>” section).<fig id="Fig1"><label>Fig. 1</label><caption><p>Comparison of the computational time under <inline-formula id="IEq68"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_0$$\end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq68.gif"/></alternatives></inline-formula> when performing an EWAS with FFW and WaveQTL for different sample sizes. The y-axis has been log-transformed. The green curve indicates the computational time using the permutation procedure described by Besag and Clifford [<xref ref-type="bibr" rid="CR29">29</xref>], which is based on a maximum of 10 permutations being larger than the observed test statistics (the set up is according to Shim and Stephens [<xref ref-type="bibr" rid="CR8">8</xref>]). The orange curve indicates the computational time using FFW. The blue line indicates the computational time of the simulations required in FFW, which remains constant with increasing sample size</p></caption><graphic xlink:href="12859_2021_3979_Fig1_HTML" id="MO15"/></fig></p>
      <p id="Par30">The data used to estimate the computational time were generated as follows. First, we simulate each individual’s DNAm profile using independent and identically distributed (iid) uniform random variables on [0, 1]. More precisely, we simulate each individual’s DNAm as being generated by the Illumina 450K array, by simulating the value of each probe on the array using a random variable on [0, 1]. Next, we apply the same pre-processing steps as in the “<xref rid="Sec11" ref-type="sec">Power and prior sensitivity analysis</xref>” section, resulting in 4731 regions to test for association.</p>
      <p id="Par31">Finally, in the “<xref rid="Sec14" ref-type="sec">Computational cost</xref>” section of the <xref ref-type="sec" rid="Sec13">Appendix</xref>, we derive the theoretical computational cost for WaveQTL and FFW.</p>
    </sec>
    <sec id="Sec10">
      <title>Type I error</title>
      <p id="Par32">We estimated the type I error for four distinct scenarios and performed simulations under the assumption of no association, using the test functions <italic>block</italic>, <italic>bump</italic>, <italic>heaviSine</italic>, and <italic>doppler</italic> as previously described in Donoho and Johnstone [<xref ref-type="bibr" rid="CR17">17</xref>]. The different functions are illustrated in Fig. <xref rid="Fig2" ref-type="fig">2</xref> (adapted from Donoho and Johnstone [<xref ref-type="bibr" rid="CR17">17</xref>]).<fig id="Fig2"><label>Fig. 2</label><caption><p>Test functions evaluated for type I error. Top left: Block; top right: Doppler; bottom left: HeaviSine; and bottom right: Bump</p></caption><graphic xlink:href="12859_2021_3979_Fig2_HTML" id="MO16"/></fig></p>
      <p id="Par33">For each simulation <italic>s</italic>, we propose the following model of association. For each test function <italic>T</italic>, we perform the following simulation, and using <italic>T</italic>, we generate a population of observed functions as follows:<disp-formula id="Equ21"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f_k(x) = a_k\times T(x)+ \epsilon \end{aligned}$$\end{document}</tex-math><mml:math id="M166" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ21.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq69"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_k$$\end{document}</tex-math><mml:math id="M168"><mml:msub><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq69.gif"/></alternatives></inline-formula> is the individual amplitude of the test function, with <inline-formula id="IEq70"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a\sim N\left( 0,1 \right)$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:mi>a</mml:mi><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq70.gif"/></alternatives></inline-formula> and <inline-formula id="IEq71"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon \sim N\left( 0,1 \right)$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq71.gif"/></alternatives></inline-formula>. We denote <italic>F</italic> as the set of observed functions. We then generate <inline-formula id="IEq72"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_k \sim N\left( 0,1 \right)$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq72.gif"/></alternatives></inline-formula>, which represents a continuous trait not associated with the considered test function. Next, we wavelet-transform each individual function <inline-formula id="IEq73"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_k$$\end{document}</tex-math><mml:math id="M176"><mml:msub><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq73.gif"/></alternatives></inline-formula> and quantile-transform each wavelet coefficient in the population. We then compute the likelihood ratio <inline-formula id="IEq74"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\Lambda }} ({\tilde{F}}, Y )_s$$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq74.gif"/></alternatives></inline-formula>, as well as <inline-formula id="IEq75"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{1_s}$$\end{document}</tex-math><mml:math id="M180"><mml:msub><mml:mi>λ</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq75.gif"/></alternatives></inline-formula>, which is the largest eigenvalue of <inline-formula id="IEq76"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X\left( X^t X+ V_b ^{-1}\right) ^{-1}X^t$$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:mi>X</mml:mi><mml:msup><mml:mfenced close=")" open="("><mml:msup><mml:mi>X</mml:mi><mml:mi>t</mml:mi></mml:msup><mml:mi>X</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>b</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>X</mml:mi><mml:mi>t</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq76.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq77"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X= \left( {\mathbf {1}},Y\right)$$\end{document}</tex-math><mml:math id="M184"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mn mathvariant="bold">1</mml:mn><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq77.gif"/></alternatives></inline-formula> and <inline-formula id="IEq78"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_b=diag( \sigma _b ^2 )$$\end{document}</tex-math><mml:math id="M186"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq78.gif"/></alternatives></inline-formula> (<inline-formula id="IEq79"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _b$$\end{document}</tex-math><mml:math id="M188"><mml:msub><mml:mi>σ</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq79.gif"/></alternatives></inline-formula> is the prior effect size of the NIG prior for the intercept and the covariate). We simulate <inline-formula id="IEq80"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\Lambda }} ({\tilde{F}}, Y )_s$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq80.gif"/></alternatives></inline-formula>
<inline-formula id="IEq81"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M=10^6$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq81.gif"/></alternatives></inline-formula> times using<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} 2log(BF) \approx \lambda _{1_s} \chi ^2_1+ log(1-\lambda _{1_s}) \end{aligned}$$\end{document}</tex-math><mml:math id="M194" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>2</mml:mn><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:msub></mml:msub><mml:msubsup><mml:mi>χ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula>These simulations are denoted as <inline-formula id="IEq82"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\Lambda }} ({\tilde{F}}, Y )^m_s$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq82.gif"/></alternatives></inline-formula>. We compute the Monte Carlo p value as<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\hat{p}}_s =\frac{ Card\left( m, {\hat{\Lambda }} ({\tilde{F}}, Y )_s \ge {\hat{\Lambda }} ({\tilde{F}}, Y )^m_s \right) +1}{M+1} \end{aligned}$$\end{document}</tex-math><mml:math id="M198" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mover accent="true"><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:mfenced><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula>This procedure is repeated 75,000 times for each sample size and type of test function (<italic>block</italic>, <italic>bump</italic>, <italic>heaviSine</italic>, and <italic>doppler</italic>). Table <xref rid="Tab1" ref-type="table">1</xref> summarizes the estimated type I errors for different sample sizes and test functions. These results show that the type I errors are handled satisfactorily for all the function types and sample sizes.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Estimated type I error for different sample sizes and test functions</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Test function</th><th align="left" rowspan="2"><italic>n</italic></th><th align="left" colspan="4"><inline-formula id="IEq83"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M200"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq83.gif"/></alternatives></inline-formula> level</th></tr><tr><th align="left">0.0500</th><th align="left">0.0100</th><th align="left">0.0010</th><th align="left">0.0001</th></tr></thead><tbody><tr><td align="left">Block</td><td char="." align="char">100</td><td char="." align="char">0.49980</td><td char="." align="char">0.00992</td><td char="." align="char">0.00111</td><td char="." align="char">0.00017</td></tr><tr><td align="left">Block</td><td char="." align="char">500</td><td char="." align="char">0.50048</td><td char="." align="char">0.00978</td><td char="." align="char">0.00105</td><td char="." align="char">0.00009</td></tr><tr><td align="left">Block</td><td char="." align="char">1000</td><td char="." align="char">0.49950</td><td char="." align="char">0.01028</td><td char="." align="char">0.00090</td><td char="." align="char">0.00014</td></tr><tr><td align="left">Bump</td><td char="." align="char">100</td><td char="." align="char">0.50040</td><td char="." align="char">0.01026</td><td char="." align="char">0.00111</td><td char="." align="char">0.00004</td></tr><tr><td align="left">Bump</td><td char="." align="char">500</td><td char="." align="char">0.50182</td><td char="." align="char">0.01040</td><td char="." align="char">0.00080</td><td char="." align="char">0.00009</td></tr><tr><td align="left">Bump</td><td char="." align="char">1000</td><td char="." align="char">0.50050</td><td char="." align="char">0.00961</td><td char="." align="char">0.00098</td><td char="." align="char">0.00008</td></tr><tr><td align="left">HeaviSine</td><td char="." align="char">100</td><td char="." align="char">0.50007</td><td char="." align="char">0.00982</td><td char="." align="char">0.00085</td><td char="." align="char">0.00009</td></tr><tr><td align="left">HeaviSine</td><td char="." align="char">500</td><td char="." align="char">0.49956</td><td char="." align="char">0.00975</td><td char="." align="char">0.00091</td><td char="." align="char">0.00007</td></tr><tr><td align="left">HeaviSine</td><td char="." align="char">1000</td><td char="." align="char">0.49965</td><td char="." align="char">0.01026</td><td char="." align="char">0.00103</td><td char="." align="char">0.00009</td></tr><tr><td align="left">Doppler</td><td char="." align="char">100</td><td char="." align="char">0.50054</td><td char="." align="char">0.01014</td><td char="." align="char">0.00097</td><td char="." align="char">0.00009</td></tr><tr><td align="left">Doppler</td><td char="." align="char">500</td><td char="." align="char">0.50089</td><td char="." align="char">0.01007</td><td char="." align="char">0.00100</td><td char="." align="char">0.00008</td></tr><tr><td align="left">Doppler</td><td char="." align="char">1000</td><td char="." align="char">0.49916</td><td char="." align="char">0.01037</td><td char="." align="char">0.00095</td><td char="." align="char">0.00013</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec11">
      <title>Power and prior sensitivity analysis</title>
      <p id="Par34">To evaluate the power and performance of FFW on DNAm data, we used the same dataset as in Lee and Morris [<xref ref-type="bibr" rid="CR5">5</xref>]. This dataset is a combination of 26 methylation profiles on chromosome 3, containing a total of 75,069 probes. Every patient’s methylation profile was measured twice, once in cancer cells and once in control cells. The phenotype (<italic>Y</italic>) is thus a binary indicator corresponding to a cancer (<italic>Y</italic> = 1) or control (<italic>Y</italic> = 0) cell.</p>
      <p id="Par35">The simulations are designed as follows. The true mean methylation level is kept identical for all the probes except the 1901 loci that were previously found to be differentially methylated in Irizarry et al. [<xref ref-type="bibr" rid="CR18">18</xref>]. For these 1901 probes, the mean methylation levels were made to be different between cases and controls according to the difference reported by Irizarry and colleagues [<xref ref-type="bibr" rid="CR18">18</xref>].</p>
      <p id="Par36">The above simulations are designed to ensure that the two groups have the same DNAm profile for all CpGs except the 1901 loci reported to be differentially methylated in Irizarry et al. [<xref ref-type="bibr" rid="CR18">18</xref>]. For further information regarding the simulated data, readers are referred to the Supporting Information section in Lee and Morris [<xref ref-type="bibr" rid="CR5">5</xref>].</p>
      <p id="Par37">The dataset itself is available at <ext-link ext-link-type="uri" xlink:href="http://odin.mdacc.tmc.edu/%7ejmorris/simulated_data.Rdata">http://odin.mdacc.tmc.edu/~jmorris/simulated_data.Rdata</ext-link>.</p>
      <p id="Par38"><italic>Pre-processing</italic> As CpG sites are not evenly spaced in the genome, the wavelet transform is well-suited for modeling such sites as a function, provided there is a sufficiently large number of measurements. We pre-processed the DNAm data by dividing the genome into smaller regions containing at least 10 CpGs, with any two adjacent CpGs separated by a maximum distance of 500 base pairs. This criterion is similar to the one used by Jenkinson et al. [<xref ref-type="bibr" rid="CR19">19</xref>], where the authors studied regions of 3 Kb containing at least 10 CpGs.</p>
      <p id="Par39">The above pre-processing step resulted in a total of 1213 regions, containing 1875 of the 1901 CpGs in Irizarry et al. [<xref ref-type="bibr" rid="CR18">18</xref>] that were scattered across 89 of the 1213 defined regions. For each region, we investigated whether the CpG patterns varied between case (<italic>n</italic> = 13) and control (<italic>n</italic> = 13) cells. As each region contains at least 10 CpGs, we used a depth of analysis of 3. We then ran FFW and WaveQTL for different values of the standard deviation of the prior on the previously defined regions. Finally, for each method and standard deviation of the prior, we computed the p value for each region and the corresponding false discovery rate (FDR) using the Benjamini–Hochberg procedure [<xref ref-type="bibr" rid="CR20">20</xref>]. Figure <xref rid="Fig3" ref-type="fig">3</xref> shows the consistency of FFW according to different standard deviations of the prior. This figure also shows that FFW and WaveQTL have similar power.<fig id="Fig3"><label>Fig. 3</label><caption><p>Assessing the sensitivity of the standard deviations of the prior. Each curve represents the number of DNAm regions detected at a given FDR and according to different standard deviations of the prior. The solid curves are the output of FFW; the dashed curves are the output of WaveQTL</p></caption><graphic xlink:href="12859_2021_3979_Fig3_HTML" id="MO17"/></fig></p>
      <p id="Par40">To evaluate the type I error of FFW for various standard deviations of the prior, we used the above dataset of cancer and control cells to generate the test statistics under the null. We performed 50 screenings of the dataset by permuting the phenotype in each screening. This corresponds to 56,500 observations of the test statistics under the null for different standard deviations of the prior. Table <xref rid="Tab2" ref-type="table">2</xref> summarizes the estimated type I errors for different standard deviations of the prior. The calibration is slightly worse than the one displayed in Table <xref rid="Tab1" ref-type="table">1</xref>, which might be because the approximation used here is only valid asymptotically (see Eq. <xref rid="Equ11" ref-type="">11</xref>). Moreover, only 26 individuals were available for analysis in the case-control dataset, and we only considered independent samples in our modeling. Even though the dataset contained repeated measurements, the estimations were similar across the different priors. As was the case with statistical power, Fig. <xref rid="Fig3" ref-type="fig">3</xref> also shows that FFW and WaveQTL have a similar performance.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Estimated type I error for different standard deviations of the prior</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Prior <inline-formula id="IEq84"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _b$$\end{document}</tex-math><mml:math id="M202"><mml:msub><mml:mi>σ</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq84.gif"/></alternatives></inline-formula></th><th align="left" colspan="4"><inline-formula id="IEq85"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M204"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq85.gif"/></alternatives></inline-formula> level</th></tr><tr><th align="left">0.0500</th><th align="left">0.0100</th><th align="left">0.0010</th><th align="left">0.0001</th></tr></thead><tbody><tr><td align="left">0.1</td><td char="." align="char">0.0416</td><td char="." align="char">0.0183</td><td char="." align="char">0.0016</td><td char="." align="char">0.0008</td></tr><tr><td align="left">0.2</td><td char="." align="char">0.0451</td><td char="." align="char">0.0145</td><td char="." align="char">0.0019</td><td char="." align="char">0.0012</td></tr><tr><td align="left">0.5</td><td char="." align="char">0.0451</td><td char="." align="char">0.0236</td><td char="." align="char">0.0020</td><td char="." align="char">0.0010</td></tr><tr><td align="left">1</td><td char="." align="char">0.0478</td><td char="." align="char">0.0119</td><td char="." align="char">0.0019</td><td char="." align="char">0.0009</td></tr><tr><td align="left">2</td><td char="." align="char">0.0500</td><td char="." align="char">0.0110</td><td char="." align="char">0.0017</td><td char="." align="char">0.0009</td></tr><tr><td align="left">5</td><td char="." align="char">0.0522</td><td char="." align="char">0.0210</td><td char="." align="char">0.0017</td><td char="." align="char">0.0008</td></tr></tbody></table></table-wrap></p>
      <p id="Par41">We assessed the power of FFW according to the number of differentially methylated CpGs per region (Table <xref rid="Tab3" ref-type="table">3</xref>). We computed the average proportion of truly associated regions across different standard deviations of the prior for each FDR level and the number of differentially methylated CpGs per region. FFW had higher power for regions containing a large number of differentially methylated CpGs (Table <xref rid="Tab3" ref-type="table">3</xref>). We also computed the power according to the number of differentially methylated CpGs per region using WaveQTL. We found the same power estimates as those shown in Table <xref rid="Tab3" ref-type="table">3</xref>. This is unexpected, considering the relatively small number of truly associated regions (<italic>n</italic> = 89). Figure <xref rid="Fig3" ref-type="fig">3</xref> also shows slight differences between FFW and WaveQTL in relation to FDR. Still, these discrepancies are negligible and indicate that the two approaches have similar power (Additional file <xref rid="MOESM1" ref-type="media">1</xref>). Figure <xref rid="MOESM1" ref-type="media">4</xref> shows matching ROC curves for FFW and WaveQTL, which indicate that the two methods have the same power. We suspect that, since WaveQTL estimates the p value using an early-stopping Monte Carlo approximation based on 10,000 permutations, the estimated FDR might be slightly more conservative than the one obtained based on simulations. However, when we rank the regions by FDR, we obtained the same ranking for WaveQTL as for FFW. As ROC curves are invariant if the ranking of the regions does not change, we obtain the same ROC curves as a result.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Estimated power according to the number of differentially methylated CpGs per region</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">FDR</th><th align="left" colspan="4">Number of CpGs</th></tr><tr><th align="left">1–10</th><th align="left">11–20</th><th align="left">21–30</th><th align="left"><inline-formula id="IEq86"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge$$\end{document}</tex-math><mml:math id="M206"><mml:mo>≥</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq86.gif"/></alternatives></inline-formula> 30</th></tr></thead><tbody><tr><td align="left">0.01</td><td char="." align="char">0.000</td><td char="." align="char">0.101</td><td char="." align="char">0.094</td><td char="." align="char">0.385</td></tr><tr><td align="left">0.05</td><td char="." align="char">0.117</td><td char="." align="char">0.182</td><td char="." align="char">0.254</td><td char="." align="char">0.58</td></tr><tr><td align="left">0.10</td><td char="." align="char">0.150</td><td char="." align="char">0.256</td><td char="." align="char">0.348</td><td char="." align="char">0.564</td></tr><tr><td align="left">0.15</td><td char="." align="char">0.233</td><td char="." align="char">0.291</td><td char="." align="char">0.370</td><td char="." align="char">0.564</td></tr><tr><td align="left">0.20</td><td char="." align="char">0.300</td><td char="." align="char">0.302</td><td char="." align="char">0.370</td><td char="." align="char">0.577</td></tr></tbody></table></table-wrap></p>
      <p id="Par42">To compare FFW with another wavelet-based method, we repeated the same analyses using the “Wavelet-based Functional Mixed Models” (WFMM) method by Morris and Carrol [<xref ref-type="bibr" rid="CR7">7</xref>] on the same dataset as above. WFMM can be used to detect DMRs [<xref ref-type="bibr" rid="CR5">5</xref>], and, more generally, to detect signals via wavelet regression. The authors used an empirical Bayes approach to perform a regularization of the estimated effects. Their model can thus take into account a larger range of correlations between the observed DNAm profiles in each individual. WFMM is thus able to handle repeated measures of DNAm.</p>
      <p id="Par43">WFMM processed all the 75,069 CpG sites in one go and computed the posterior probability for each of the CpGs being above a set threshold (here 0.05) for being associated with cancer. We ran WFMM by specifying the correlation structure between the observations. Following the approach of Lee and Morris [<xref ref-type="bibr" rid="CR5">5</xref>], we transformed the posterior probabilities of the CpGs into Bayesian FDR [<xref ref-type="bibr" rid="CR5">5</xref>]. To compare the performance of WFMM against that of FFW, we first need to provide a regional significance criterion for WFMM. We used the minimum Bayesian FDR value for all the CpGs within a region of interest to assign a regional significance criterion. After running WFMM on the entire dataset, we used the minimum Bayesian FDR value for each of these regions to assess significance.</p>
      <p id="Par44">The results showed that WFMM had higher power than FFW, detecting all the 89 regions with an FDR below 0.01. This difference in power might be due to the refined modeling proposed by Morris and Carrol [<xref ref-type="bibr" rid="CR7">7</xref>], which takes advantage of the correlations between DNAm profiles. Notably, Lee and Morris [<xref ref-type="bibr" rid="CR5">5</xref>] showed that taking these correlations into account resulted in a systematic gain in power. In terms of computational time, however, WFMM took more than 6 h to complete the screening of 1213 regions, whereas FFW took a minute.</p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Discussion</title>
    <p id="Par45">This paper reports on a computational shortcut for improving the wavelet-based approach proposed by Shim and Stephens [<xref ref-type="bibr" rid="CR8">8</xref>]. We drew inspiration from the work of both Shim and Stephens [<xref ref-type="bibr" rid="CR8">8</xref>] and Zhou and Guan [<xref ref-type="bibr" rid="CR10">10</xref>] to develop a faster functional modeling that is applicable to a wider variety of functions and phenotypes. The approach of Shim and Stephens [<xref ref-type="bibr" rid="CR8">8</xref>] was designed to identify dsQTL. Here, we show that wavelet-based approaches can also be used to detect differentially methylated regions (DMRs). Both WaveQTL by Shim and Stephens [<xref ref-type="bibr" rid="CR8">8</xref>] and FFW offer a more flexible approach to modeling functions than conventional single-point testing. By keeping the design matrix constant across the screened regions and using simulations instead of permutations, we show that FFW is faster than WaveQTL. In addition, FFW controls the type I error satisfactorily for large sample sizes.</p>
    <p id="Par46">Reverse regression is a very useful tool for reducing the overall computational burden. However, the downside of reverse regression is that the coefficients from the analysis may become less interpretable. If the objective of a study is to estimate the effect of a particular wavelet in a given DNAm region, then one needs to rerun the procedure using individual wavelet coefficients as exposures. Therefore, FFW might function better as an initial screening tool to gain important biological insights from the DNAm data. For other types of data, such as those from biomechanical research, the wavelet coefficients are more directly interpretable. For example, if a researcher is interested in studying the effect of a particular treatment on motor function, e.g., leg function in the strength-dexterity test [<xref ref-type="bibr" rid="CR21">21</xref>], FFW would lend itself easily to such an analysis.</p>
    <p id="Par47">An additional methodological constraint is the need to assign a given value for <italic>J</italic> in the applications of FFW. We chose a cutoff of <italic>J</italic> = 3 because of the requirement for the screened regions to contain least 10 CpGs, with any two adjacent CpGs separated by a maximum distance of 500 base pairs. In general, we advise choosing as large of a <italic>J</italic> as possible, while restricting <inline-formula id="IEq87"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^J &lt; \kappa$$\end{document}</tex-math><mml:math id="M208"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:msup><mml:mo>&lt;</mml:mo><mml:mi>κ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq87.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq88"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa$$\end{document}</tex-math><mml:math id="M210"><mml:mi>κ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq88.gif"/></alternatives></inline-formula> is an integer larger than 4. This can be written as <inline-formula id="IEq89"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J=max _j\{ 2^j &lt; \kappa \}$$\end{document}</tex-math><mml:math id="M212"><mml:mrow><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:msup><mml:mo>&lt;</mml:mo><mml:mi>κ</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq89.gif"/></alternatives></inline-formula> when analyzing regions containing at least <inline-formula id="IEq90"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa$$\end{document}</tex-math><mml:math id="M214"><mml:mi>κ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq90.gif"/></alternatives></inline-formula> CpGs. In our current application, this corresponded to <italic>J</italic> = 3. Nevertheless, it is possible to choose a different <italic>J</italic> for each region. Given the test statistic depends on <italic>J</italic>, choosing a different <italic>J</italic> for each genetic region would require the test statistic to be simulated for different values of <italic>J</italic>. As shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, one can quickly simulate the test statistic. Therefore, simulating different values of <italic>J</italic> is likely to have a negligible impact on the overall run time.</p>
    <p id="Par48">FFW is well-powered to detect DMRs containing more than 10 CpGs, even when the CpGs only have small effects. However, FFW has lesser power for detecting DMRs containing only a few CpGs (<inline-formula id="IEq91"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le 10$$\end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq91.gif"/></alternatives></inline-formula>). Although it is less powerful than WFMM [<xref ref-type="bibr" rid="CR5">5</xref>], FFW has the advantage of being significantly faster in terms of computational time. WFMM took more than 6 h to process one chromosome for 26 individuals, whereas FFW took a minute. We thus expect WFMM to become exceedingly slow if there is a need to scale up the analysis to include hundreds of individuals and data from denser DNAm platforms, such as the Illumina 850K, or those from whole-genome bisulfite sequencing [<xref ref-type="bibr" rid="CR22">22</xref>]. Therefore, FFW is a useful complementary tool for the rapid scanning of EWAS datasets to detect DMRs that can subsequently be used in downstream fine-mapping efforts. An attractive application of FFW would be to re-analyze DNAm data from previously published EWASes that are publicly available through, e.g., the Gene Expression Omnibus (GEO) database [<xref ref-type="bibr" rid="CR23">23</xref>].</p>
    <p id="Par49">In future developments, we plan to extend FFW to also include phenotypes on non-ordered scales, e.g., blood types and psychiatric phenotypes. Such phenotypes are routinely treated in a case-control fashion and analyzed using multinomial regression owing to the prohibitively large computational burden. However, by exploiting reverse regression, as we do here, the phenotypes can be re-coded and readily included in the predictor matrix. Reverse regression also enables FFW to easily adapt to the setting of a phenome-wide association study (PheWAS), in which multiple phenotypes are interrogated simultaneously ([<xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR26">26</xref>]). As highlighted by our analyses, this development is further simplified by the results of Zhou and Guan [<xref ref-type="bibr" rid="CR10">10</xref>], showing that the parameter of the Bayes factors law depends primarily on the singular values of the regression matrix and the number of parameters tested. As the regression matrix remains constant across all loci, locations, and scales, these parameters only need to be computed once, thus enabling a fast computation of p values. This makes FFW a highly versatile method for analyzing phenotypes that do not lend themselves easily to either single-point or bump-hunting methods.</p>
    <p id="Par50">FFW is distributed as an <bold><italic>R</italic></bold> package. The package contains the analysis code and a data visualization tool to enable a more detailed inspection of the detected regions. The full <bold><italic>R</italic></bold> package is freely available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/william-denault/ffw">https://github.com/william-denault/ffw</ext-link>), and a comprehensive example run of the package is provided in the help function <italic>ffw</italic>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec13">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2021_3979_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: Figure S4</bold>. ROC curves at given standard deviations of the prior. The thin solid curves are the output of FFW; the thick dashed curves are the output of WaveQTL. The ROC curves match for standard deviations of the prior of 0.5 and 1.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App2">
      <sec id="Sec14">
        <title>Appendix</title>
        <sec id="Sec15">
          <title>Computational cost</title>
          <p id="Par55">Here, we discuss the improvement in computational cost using FFW. Let <italic>R</italic> be the number of regions to screen for associations (i.e., the number of tests to be performed). When considering a Bonferroni correction for <italic>R</italic> tests, the number of permutations or simulations needed to obtain sufficiently precise p values for a multiple testing correction of <inline-formula id="IEq92"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{0.05}{R}$$\end{document}</tex-math><mml:math id="M218"><mml:mfrac><mml:mrow><mml:mn>0.05</mml:mn></mml:mrow><mml:mi>R</mml:mi></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq92.gif"/></alternatives></inline-formula> is of the order <inline-formula id="IEq93"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O\left( R^2\right)$$\end{document}</tex-math><mml:math id="M220"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="("><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq93.gif"/></alternatives></inline-formula> (see Knijnenburg et al. [<xref ref-type="bibr" rid="CR27">27</xref>]). The computational cost of performing a linear regression is <inline-formula id="IEq94"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O\left( np^2+p^3\right)$$\end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="("><mml:mi>n</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq94.gif"/></alternatives></inline-formula>, where <italic>n</italic> is the number of observations and <italic>p</italic> is the number of variables. For every screened region, we perform <inline-formula id="IEq95"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^J$$\end{document}</tex-math><mml:math id="M224"><mml:msup><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq95.gif"/></alternatives></inline-formula> linear regressions. The complexity of the wavelet transform is equal to the number of observed variables, which is <inline-formula id="IEq96"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^J$$\end{document}</tex-math><mml:math id="M226"><mml:msup><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq96.gif"/></alternatives></inline-formula> in our case. It follows that the combined computational cost using WaveQTL for a full screening of <italic>R</italic> regions and the permutation procedure is:<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} O\left( 2^{J} \left( np^2+p^3 +e \right) \left( 1+R^2\right) R+ 2^{J}R\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M228" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="("><mml:msup><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:msup><mml:mfenced close=")" open="("><mml:mi>n</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>e</mml:mi></mml:mfenced><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfenced><mml:mi>R</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:msup><mml:mi>R</mml:mi></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula>where <italic>e</italic> is the average number of iterations of the EM algorithm. Using early-stopping methods described by Gandy [<xref ref-type="bibr" rid="CR28">28</xref>] and Besag and Clifford [<xref ref-type="bibr" rid="CR29">29</xref>] for deriving Monte Carlo p values, the computational cost can be further reduced to:<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} O\left( 2^{J} \left( np^2+p^3 +e \right) \left( 1+S\right) R+ 2^{J}R\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M230" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="("><mml:msup><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:msup><mml:mfenced close=")" open="("><mml:mi>n</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>e</mml:mi></mml:mfenced><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>S</mml:mi></mml:mfenced><mml:mi>R</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:msup><mml:mi>R</mml:mi></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>where <italic>S</italic> is the expected number of steps of the early-stopping Monte Carlo p values method, with <inline-formula id="IEq97"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S \le R^2$$\end{document}</tex-math><mml:math id="M232"><mml:mrow><mml:mi>S</mml:mi><mml:mo>≤</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq97.gif"/></alternatives></inline-formula>. The first term in Eq. (<xref rid="Equ15" ref-type="">15</xref>) is the number of regressions to be performed, including the ones for the permutation as well as for the cost of the EM algorithm. The second term is the overall cost of the wavelet transform.</p>
          <p id="Par56">Early-stopping methods, such as the methods of Gandy [<xref ref-type="bibr" rid="CR28">28</xref>] or Besag and Clifford [<xref ref-type="bibr" rid="CR29">29</xref>], are algorithms that estimate p values in a sequential fashion. As in most applications, the interesting p values are the small p values. Early-stopping methods aim at avoiding using a lot of computational power on large p values. Therefore, when it is likely that the test p value is large, such algorithms stop and move on to the next p value to be estimated. Early-stopping methods thus aim at focusing only on the interesting tests and allocating most of the computational power to those. The <italic>simctest</italic>
<italic>R</italic> package contains most of recent early-stopping algorithms, and include the method of Gandy [<xref ref-type="bibr" rid="CR28">28</xref>].</p>
          <p id="Par57">Using FFW, and neglecting the cost of simulations, we obtain a computational cost of:<disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} O\left( 2^{J} \left( np^2+p^3 \right) R+ 2^{J}R +e\left( R+R^2\right) \right) \end{aligned}$$\end{document}</tex-math><mml:math id="M234" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="("><mml:msup><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:msup><mml:mfenced close=")" open="("><mml:mi>n</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mfenced><mml:mi>R</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:msup><mml:mi>R</mml:mi><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mi>R</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula>where the first term is the computational cost of all the regressions performed, the second term is the overall cost of the wavelet transform, and the third term is the number of iterations performed by the EM algorithm. The <italic>R</italic> term is for running the EM algorithm for each region, and the <inline-formula id="IEq98"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R^2$$\end{document}</tex-math><mml:math id="M236"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq98.gif"/></alternatives></inline-formula> term is for running the EM algorithm for each simulation used to assess the significance of each region. Using early-stopping rules for Monte Carlo p values, this can be further reduced to:<disp-formula id="Equ17"><label>17</label><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} O\left( 2^{J} \left( np^2+p^3 \right) R+ 2^{J}R +e\left( R+S'\right) \right) \end{aligned}$$\end{document}</tex-math><mml:math id="M238" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="("><mml:msup><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:msup><mml:mfenced close=")" open="("><mml:mi>n</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mfenced><mml:mi>R</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:msup><mml:mi>R</mml:mi><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mi>R</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_3979_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq99"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S'$$\end{document}</tex-math><mml:math id="M240"><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq99.gif"/></alternatives></inline-formula> is the number of iterations needed to assess the significance of the smallest p value using the early-stopping rules for Monte Carlo p values (<inline-formula id="IEq100"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S' \le R^2$$\end{document}</tex-math><mml:math id="M242"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≤</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq100.gif"/></alternatives></inline-formula>). In essence, this procedure reduces the degree of the polynomial cost of the region by one. In addition, the term <inline-formula id="IEq101"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( np^2+p^3\right)$$\end{document}</tex-math><mml:math id="M244"><mml:mfenced close=")" open="("><mml:mi>n</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq101.gif"/></alternatives></inline-formula>, which carries part of the computational burden, is now only associated with a first-order polynomial in <italic>R</italic> and no longer associated with a third and second-degree polynomial. In a scenario in which all the regions have <inline-formula id="IEq102"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2^J$$\end{document}</tex-math><mml:math id="M246"><mml:msup><mml:mn>2</mml:mn><mml:mi>J</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_3979_Article_IEq102.gif"/></alternatives></inline-formula> variables, the first term would thus represent the overall cost corresponding to the single-point testing strategy.
</p>
        </sec>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>DMR</term>
        <def>
          <p id="Par4">Differentially methylated region</p>
        </def>
      </def-item>
      <def-item>
        <term>DNAm</term>
        <def>
          <p id="Par5">DNA methylation</p>
        </def>
      </def-item>
      <def-item>
        <term>dsQTL</term>
        <def>
          <p id="Par6">DNase I hypersensitivity quantitative trait locus</p>
        </def>
      </def-item>
      <def-item>
        <term>EWAS</term>
        <def>
          <p id="Par7">Epigenome-wide association study</p>
        </def>
      </def-item>
      <def-item>
        <term>FDR</term>
        <def>
          <p id="Par8">False discovery rate</p>
        </def>
      </def-item>
      <def-item>
        <term>GEO</term>
        <def>
          <p id="Par9">Gene Expression Omnibus</p>
        </def>
      </def-item>
      <def-item>
        <term>GWAS</term>
        <def>
          <p id="Par10">Genome-wide association study</p>
        </def>
      </def-item>
      <def-item>
        <term>MCMC</term>
        <def>
          <p id="Par11">Markov Chain Monte Carlo</p>
        </def>
      </def-item>
      <def-item>
        <term>NIG</term>
        <def>
          <p id="Par12">Normal-inverse gamma</p>
        </def>
      </def-item>
      <def-item>
        <term>PheWAS</term>
        <def>
          <p id="Par13">Phenome-wide association study</p>
        </def>
      </def-item>
      <def-item>
        <term>QTL</term>
        <def>
          <p id="Par14">Quantitative trait locus</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1186/s12859-021-03979-y.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Dr. Håkon K. Gjessing for his valuable comments on earlier drafts of the manuscript. We also thank Drs. Lee and Morris [<xref ref-type="bibr" rid="CR5">5</xref>] for making their DNAm data freely available to the wider research community.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>WD and AJ conceptualized the study. WD proposed the use of the approach by Zhou and Guan [<xref ref-type="bibr" rid="CR10">10</xref>] to enhance the computation of Shim and Stephens [<xref ref-type="bibr" rid="CR8">8</xref>] and drafted the first version of the manuscript. WD also wrote the R package and performed the simulations. AJ provided overall scientific input as well as editorial assistance in drafting the manuscript to its current form. Both authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This project was funded in part by a grant from the Research Council of Norway (RCN) (Grant 249779). Additional funding was provided by RCN through its Centres of Excellence funding scheme (Grant 262700). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The full R package for FFW is freely available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/william-denault/ffw">https://github.com/william-denault/ffw</ext-link>), and a comprehensive example run of the package is provided in the help function <italic>ffw</italic>. The data supporting the findings of this study are openly available at <ext-link ext-link-type="uri" xlink:href="http://odin.mdacc.tmc.edu/%7ejmorris/simulated_data.Rdata">http://odin.mdacc.tmc.edu/~jmorris/simulated_data.Rdata</ext-link>.</p>
  </notes>
  <notes id="FPar2">
    <title>Ethics approval and consent to participate</title>
    <p id="Par51">Not applicable.</p>
  </notes>
  <notes id="FPar3">
    <title>Consent for publication</title>
    <p id="Par52">Not applicable.</p>
  </notes>
  <notes id="FPar4" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par53">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cahouët</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Luc</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>David</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Static optimal estimation of joint accelerations for inverse dynamics problem solution</article-title>
        <source>J Biomech</source>
        <year>2002</year>
        <volume>35</volume>
        <issue>11</issue>
        <fpage>1507</fpage>
        <lpage>1513</lpage>
        <pub-id pub-id-type="doi">10.1016/S0021-9290(02)00176-8</pub-id>
        <?supplied-pmid 12413970?>
        <pub-id pub-id-type="pmid">12413970</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Degner</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Pai</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Pique-Regi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Veyrieras</surname>
            <given-names>J-B</given-names>
          </name>
          <name>
            <surname>Gaffney</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Pickrell</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>De Leon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Michelini</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lewellen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Crawford</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gilad</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pritchard</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>DNase I sensitivity QTLs are a major determinant of human expression variation</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>482</volume>
        <issue>7385</issue>
        <fpage>390</fpage>
        <lpage>394</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10808</pub-id>
        <?supplied-pmid 22307276?>
        <pub-id pub-id-type="pmid">22307276</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vsevolozhskaya</surname>
            <given-names>OA</given-names>
          </name>
          <name>
            <surname>Zaykin</surname>
            <given-names>DV</given-names>
          </name>
          <name>
            <surname>Greenwood</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>Functional analysis of variance for association studies</article-title>
        <source>PLoS ONE</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>9</issue>
        <fpage>105074</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0105074</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Murakami</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Fallin</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Feinberg</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Bump hunting to identify differentially methylated regions in epigenetic epidemiology studies</article-title>
        <source>Int J Epidemiol</source>
        <year>2012</year>
        <volume>41</volume>
        <issue>1</issue>
        <fpage>200</fpage>
        <lpage>209</lpage>
        <pub-id pub-id-type="doi">10.1093/ije/dyr238</pub-id>
        <?supplied-pmid 22422453?>
        <pub-id pub-id-type="pmid">22422453</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Identification of differentially methylated loci using wavelet-based functional mixed models</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>5</issue>
        <fpage>664</fpage>
        <lpage>672</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv659</pub-id>
        <?supplied-pmid 26559505?>
        <pub-id pub-id-type="pmid">26559505</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>NI</given-names>
          </name>
        </person-group>
        <article-title>Bump hunting in high-dimensional data</article-title>
        <source>Stat Comput</source>
        <year>1999</year>
        <volume>9</volume>
        <issue>2</issue>
        <fpage>123</fpage>
        <lpage>143</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1008894516817</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morris</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Carroll</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <article-title>Wavelet-based functional mixed models</article-title>
        <source>J R Stat Soc Ser B (Stat Methodol)</source>
        <year>2006</year>
        <volume>68</volume>
        <issue>2</issue>
        <fpage>179</fpage>
        <lpage>199</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1467-9868.2006.00539.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shim</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Wavelet-based genetic association analysis of functional phenotypes arising from high-throughput sequencing assays</article-title>
        <source>Ann Appl Stat</source>
        <year>2015</year>
        <volume>9</volume>
        <issue>2</issue>
        <fpage>665</fpage>
        <lpage>686</lpage>
        <pub-id pub-id-type="doi">10.1214/14-AOAS776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Soriano</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Efficient functional ANOVA through wavelet-domain Markov groves</article-title>
        <source>J Am Stat Assoc</source>
        <year>2018</year>
        <volume>113</volume>
        <issue>522</issue>
        <fpage>802</fpage>
        <lpage>818</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.2017.1286241</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Guan</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>On the null distribution of Bayes factors in linear regression</article-title>
        <source>J Am Stat Assoc</source>
        <year>2017</year>
        <volume>113</volume>
        <issue>523</issue>
        <fpage>1362</fpage>
        <lpage>1371</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.2017.1328361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Fuller</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <source>Measurement error models</source>
        <year>1987</year>
        <edition>1</edition>
        <publisher-loc>Hoboken</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Nason</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <source>Wavelet methods in statistics with R. Use R!</source>
        <year>2008</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kovac</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Silverman</surname>
            <given-names>BW</given-names>
          </name>
        </person-group>
        <article-title>Extending the scope of wavelet regression methods by coefficient-dependent thresholding</article-title>
        <source>J Am Stat Assoc</source>
        <year>2000</year>
        <volume>95</volume>
        <issue>449</issue>
        <fpage>172</fpage>
        <lpage>183</lpage>
        <pub-id pub-id-type="doi">10.2307/2669536</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nason</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Sachs</surname>
            <given-names>RV</given-names>
          </name>
          <name>
            <surname>Kroisandt</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Wavelet processes and adaptive estimation of the evolutionary wavelet spectrum</article-title>
        <source>J R Stat Soc Ser B (Stat Methodol)</source>
        <year>2000</year>
        <volume>62</volume>
        <issue>2</issue>
        <fpage>271</fpage>
        <lpage>292</lpage>
        <pub-id pub-id-type="doi">10.1111/1467-9868.00231</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Mallat</surname>
            <given-names>S.G</given-names>
          </name>
        </person-group>
        <source>A wavelet tour of signal processing: the sparse way</source>
        <year>2009</year>
        <edition>3rd</edition>
        <publisher-loc>Amsterdam</publisher-loc>
        <publisher-name>Elsevier/Academic Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jentsch</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kirch</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>How much information does dependence between wavelet coefficients contain?</article-title>
        <source>J Am Stat Assoc</source>
        <year>2016</year>
        <volume>111</volume>
        <issue>515</issue>
        <fpage>1330</fpage>
        <lpage>45</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.2015.1093945</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Donoho</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Johnstone</surname>
            <given-names>IM</given-names>
          </name>
        </person-group>
        <article-title>Ideal spatial adaptation by wavelet shrinkage</article-title>
        <source>Biometrika</source>
        <year>1994</year>
        <volume>81</volume>
        <issue>3</issue>
        <fpage>425</fpage>
        <lpage>455</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/81.3.425</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Ladd-Acosta</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Montano</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Onyango</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cui</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Gabo</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Rongione</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Webster</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Potash</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sabunciyan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Feinberg</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>The human colon cancer methylome shows similar hypo- and hypermethylation at conserved tissue-specific CpG island shores</article-title>
        <source>Nat Genet</source>
        <year>2009</year>
        <volume>41</volume>
        <issue>2</issue>
        <fpage>178</fpage>
        <lpage>186</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.298</pub-id>
        <?supplied-pmid 19151715?>
        <pub-id pub-id-type="pmid">19151715</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jenkinson</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pujadas</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Goutsias</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Feinberg</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>Potential energy landscapes identify the information-theoretic nature of the epigenome</article-title>
        <source>Nat Genet</source>
        <year>2017</year>
        <volume>49</volume>
        <issue>5</issue>
        <fpage>719</fpage>
        <lpage>729</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3811</pub-id>
        <?supplied-pmid 28346445?>
        <pub-id pub-id-type="pmid">28346445</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J Roy Stat Soc Ser B (Methodol)</source>
        <year>1995</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>289</fpage>
        <lpage>300</lpage>
        <pub-id pub-id-type="doi">10.1111/j.2517-6161.1995.tb02031.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lyle</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Valero-Cuevas</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Gregor</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Powers</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>Control of dynamic foot-ground interactions in male and female soccer athletes: Females exhibit reduced dexterity and higher limb stiffness during landing</article-title>
        <source>J Biomech</source>
        <year>2014</year>
        <volume>47</volume>
        <issue>2</issue>
        <fpage>512</fpage>
        <lpage>517</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jbiomech.2013.10.038</pub-id>
        <?supplied-pmid 24275440?>
        <pub-id pub-id-type="pmid">24275440</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Suzuki</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wos</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Johnston</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>DeGrazia</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ishii</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bloom</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zody</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Germer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Greally</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Whole-genome bisulfite sequencing with improved accuracy and cost</article-title>
        <source>Genome Res</source>
        <year>2018</year>
        <volume>28</volume>
        <issue>9</issue>
        <fpage>1364</fpage>
        <lpage>1371</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.232587.117</pub-id>
        <?supplied-pmid 30093547?>
        <pub-id pub-id-type="pmid">30093547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barrett</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wilhite</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Ledoux</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Evangelista</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>IF</given-names>
          </name>
          <name>
            <surname>Tomashevsky</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Sherman</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Holko</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yefanov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Robertson</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Serova</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Soboleva</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>NCBI GEO: archive for functional genomics data sets-update</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <issue>D1</issue>
        <fpage>991</fpage>
        <lpage>995</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks1193</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Multiple phenotype association tests using summary statistics in genome-wide association studies</article-title>
        <source>Biometrics</source>
        <year>2018</year>
        <volume>74</volume>
        <issue>1</issue>
        <fpage>165</fpage>
        <lpage>175</lpage>
        <pub-id pub-id-type="doi">10.1111/biom.12735</pub-id>
        <?supplied-pmid 28653391?>
        <pub-id pub-id-type="pmid">28653391</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Denny</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Ritchie</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Basford</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Pulley</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Bastarache</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Brown-Gentry</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Masys</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Roden</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Crawford</surname>
            <given-names>DC</given-names>
          </name>
        </person-group>
        <article-title>PheWAS: demonstrating the feasibility of a phenome-wide scan to discover gene-disease associations</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>9</issue>
        <fpage>1205</fpage>
        <lpage>1210</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq126</pub-id>
        <?supplied-pmid 20335276?>
        <pub-id pub-id-type="pmid">20335276</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Verma</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lucas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Verma</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Josyula</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hartzel</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Lavage</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Leader</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ritchie</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Pendergrass</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>PheWAS and beyond: the landscape of associations with medical diagnoses and clinical measures across 38,662 individuals from Geisinger</article-title>
        <source>Am J Hum Genet</source>
        <year>2018</year>
        <volume>102</volume>
        <issue>4</issue>
        <fpage>592</fpage>
        <lpage>608</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2018.02.017</pub-id>
        <?supplied-pmid 29606303?>
        <pub-id pub-id-type="pmid">29606303</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Knijnenburg</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Wessels</surname>
            <given-names>LFA</given-names>
          </name>
          <name>
            <surname>Reinders</surname>
            <given-names>MJT</given-names>
          </name>
          <name>
            <surname>Shmulevich</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Fewer permutations, more accurate P-values</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>12</issue>
        <fpage>161</fpage>
        <lpage>168</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp211</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gandy</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Sequential implementation of Monte Carlo tests with uniformly bounded resampling risk</article-title>
        <source>J Am Stat Assoc</source>
        <year>2009</year>
        <volume>104</volume>
        <issue>488</issue>
        <fpage>1504</fpage>
        <lpage>1511</lpage>
        <pub-id pub-id-type="doi">10.1198/jasa.2009.tm08368</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Besag</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Clifford</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Sequential Monte Carlo p-values</article-title>
        <source>Biometrika</source>
        <year>1991</year>
        <volume>78</volume>
        <issue>2</issue>
        <fpage>301</fpage>
        <lpage>304</lpage>
        <pub-id pub-id-type="doi">10.2307/2337256</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
