<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3562068</article-id>
    <article-id pub-id-type="pmid">23220575</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bts695</article-id>
    <article-id pub-id-type="publisher-id">bts695</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group>
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ChromoZoom: a flexible, fluid, web-based genome browser</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pak</surname>
          <given-names>Theodore R.</given-names>
        </name>
        <xref ref-type="aff" rid="bts695-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="bts695-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Roth</surname>
          <given-names>Frederick P.</given-names>
        </name>
        <xref ref-type="aff" rid="bts695-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="bts695-AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="bts695-AFF1">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="bts695-AFF1">
          <sup>5</sup>
        </xref>
        <xref ref-type="corresp" rid="bts695-COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="bts695-AFF1"><sup>1</sup>Donnelly Centre, University of Toronto, Toronto, ON M5S3E1,
<sup>2</sup>Samuel Lunenfeld Research Institute, Mt. Sinai Hospital, Toronto, ON M5G1X5,
<sup>3</sup>Department of Molecular Genetics, <sup>4</sup>Department of Computer Science,
University of Toronto, Toronto, ON M5S3E1, Canada and <sup>5</sup>Center for Cancer Systems
Biology, Dana-Farber Cancer Institute, Boston, MA 02115, USA</aff>
    <author-notes>
      <corresp id="bts695-COR1">*To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Alfonso Valencia</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>2</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>12</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>6</day>
      <month>12</month>
      <year>2012</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>29</volume>
    <issue>3</issue>
    <fpage>384</fpage>
    <lpage>386</lpage>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>5</month>
        <year>2012</year>
      </date>
      <date date-type="rev-recd">
        <day>31</day>
        <month>10</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>11</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2012. Published by Oxford University
Press.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/3.0/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons
Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/3.0/">http://creativecommons.org/licenses/by/3.0/</ext-link>), which permits
unrestricted reuse, distribution, and reproduction in any medium, provided the original
work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> Current web-based genome browsers require repetitious user input to
scroll over long distances, alter the drawing density of elements or zoom through multiple
orders of magnitude. Generally, either the server or the client is responsible for the
majority of data processing, resulting in either servers having to receive and handle data
relevant only to one user, or clients redundantly processing widely viewed data.
ChromoZoom pre-renders and caches general-use tracks into tiled images on the server and
serves them in an interactive web interface with inertial scrolling and precise, fluent
zooming via the mouse wheel or trackpad. Custom tracks in several formats can be rendered
by client-side code alongside the pre-rendered tracks, minimizing server load because of
user-specific rendering and eliminating the need to transmit private data. ChromoZoom
thereby enables rapid and simultaneous exploration of curated, experimental and personal
genomic datasets.</p>
      <p><bold>Availability:</bold> Human and yeast genome researchers may browse recent
assemblies within ChromoZoom at <ext-link ext-link-type="uri" xlink:href="http://chromozoom.org/">http://chromozoom.org/</ext-link>. Source code is available at <ext-link ext-link-type="uri" xlink:href="http://github.com/rothlab/chromozoom/">http://github.com/rothlab/chromozoom/</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>fritz.roth@utoronto.ca</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/bts695/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic>
online.</p>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>Genome browsers have become an essential tool for experimental and computational
biologists. Among well-known web-based browsers, the UCSC Genome Browser has gained
popularity for its ready availability, comprehensive library of genomes and curated data and
the ability to display custom data uploaded by researchers (<xref ref-type="bibr" rid="bts695-B2">Dreszer <italic>et al.,</italic> 2011</xref>; <xref ref-type="bibr" rid="bts695-B6">Nielsen <italic>et al.</italic>, 2010</xref>). Overlaying experimental
data (e.g. sequence variation) onto curated tracks (e.g. gene predictions) allows for the
formulation and verification of biological hypotheses. Researchers unfamiliar with a newly
encountered locus can inspect it within a genome browser to determine the gene layout or
potential regulatory elements and design polymerase chain reaction or other experiments.</p>
    <p>Although many researchers have become familiar with the UCSC browser and others like
GBrowse (<xref ref-type="bibr" rid="bts695-B9">Stein <italic>et al.</italic>, 2002</xref>),
Ensembl (<xref ref-type="bibr" rid="bts695-B8">Stalker <italic>et al.</italic>, 2004</xref>)
and the NCBI Map Viewer (<xref ref-type="bibr" rid="bts695-B11">Wheeler <italic>et
al.</italic>, 2003</xref>), these tools originated before the advent of modern web
interfaces that use less page transitions and more data dynamically loaded using
Asynchronous JavaScript and extensible mark-up language (AJAX) and HTML5 techniques. Some
have attempted to incorporate aspects of the ‘rich internet application’
experience into their interfaces—for example, each of the aforementioned browsers now
allow the user to drag the track to move the current view—but none had a user
interface allowing smooth navigation equivalent to Google Maps, for example, animated
transitions while zooming and the absence of loading interruptions throughout all
navigational operations.</p>
    <p>In response, ‘next-generation’ browsers like AnnoJ (<ext-link ext-link-type="uri" xlink:href="http://www.annoj.org">http://www.annoj.org</ext-link>), JBrowse (<xref ref-type="bibr" rid="bts695-B7">Skinner <italic>et al.,</italic> 2009</xref>) and ABrowse
(<xref ref-type="bibr" rid="bts695-B4">Kong <italic>et al.</italic>, 2012</xref>) have
been built to take advantage of modern web technologies, adding more seamless interactions
that preserve the user’s sense of location while traversing the massive
‘landscape’ of a genome. AnnoJ and JBrowse render most genomic data on the
browser-side, the former drawing pixels on HTML5 Canvas elements and the latter manipulating
standard HTML elements. However, both require preprocessing of custom data by an
administrator before it can be rendered within the browser; neither accept flat files via
the web interface in the manner of the UCSC browser. ABrowse renders all data to tiled
images, but cannot zoom smoothly and requires custom data to be fully uploaded to the
server—which can be prohibitive for large datasets. Finally, none of the browsers
features inertial scrolling, a feature popularized by iOS and Google Maps whereby a
scrollable surface can be ‘thrown’ with a finger or the cursor to move across
long distances.</p>
  </sec>
  <sec id="SEC2">
    <title>2 FEATURES</title>
    <p>ChromoZoom attempts to improve the interactivity introduced by
‘next-generation’ genome browsers while adding custom data capabilities and the
familiar rendering styles of established browsers like UCSC. The full-window interface can
maximize use of vertical display space by wrapping tracks into multiple lines, much like
paragraph text. General-use tracks can be added via a dropdown menu (<xref ref-type="fig" rid="bts695-F1">Fig. 1</xref>A); the layout updates dynamically. The user can drag lines
horizontally and vertically, and they can also ‘throw’ the line with the mouse
to scroll smoothly through the genome. Motion of the tracks is <italic>never</italic>
interrupted, preserving the user’s sense of location throughout all navigation
operations. <fig id="bts695-F1" position="float"><label>Fig. 1.</label><caption><p>The ChromoZoom web
interface. (<bold>A</bold>) Select tracks to be displayed. (<bold>B</bold>) Zoom from
genome view to individual base pairs. (<bold>C</bold>) Resize tracks to automatically
unpack features. (<bold>D</bold>) Orange line warns of cropped data. (<bold>E</bold>)
Autocomplete for keyword searching. (<bold>F</bold>) Custom tooltips with feature
details. (<bold>G</bold>) Add custom data tracks from local files or remote
URLs</p></caption><graphic xlink:href="bts695f1p"/></fig></p>
    <p>To zoom in and out, the user can use a familiar slider and buttons (<xref ref-type="fig" rid="bts695-F1">Fig. 1</xref>B) or keyboard shortcuts to move all the way from the
genome-wide view to the base pair level, or they can position their mouse cursor and use a
scroll wheel or trackpad to zoom continuously and precisely at any visible location (a
feature unique to ChromoZoom). To see more detail, the user can vertically resize the track
using its side label (<xref ref-type="fig" rid="bts695-F1">Fig. 1</xref>C), which will
‘unpack’ individual elements and labels as completely as vertical space allows.
An orange warning line appears if elements are being cropped by the edge of the track (<xref ref-type="fig" rid="bts695-F1">Fig. 1</xref>D). Users can also reorder tracks by dragging
the labels in the sidebar and remove them using the ‘show tracks…’ menu.
A search bar allows users to specify coordinates or coordinate ranges, for example,
‘chr1:12340-12350’, or keywords like ‘MSH2’, which display a
dropdown of matching features (<xref ref-type="fig" rid="bts695-F1">Fig. 1</xref>E).
Tooltips appear when the user hovers over track features (<xref ref-type="fig" rid="bts695-F1">Fig. 1</xref>F), and a click loads a feature description page from the
UCSC Browser. A full comparison of features with other current web-based genome browsers is
provided in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/bts695/-/DC1">Supplementary Table S1</ext-link>.</p>
    <p>ChromoZoom is the first online genome browser to provide client-side parsing
<italic>and</italic> rendering of user-provided custom data, initiated by clicking the
‘custom tracks … ’ button (<xref ref-type="fig" rid="bts695-F1">Fig.
1</xref>G). Browser Extensible Data (BED) tracks containing range-based features and
‘wiggle’ (WIG) tracks of continuous quantitative data, formatted according to
UCSC’s guidelines (<ext-link ext-link-type="uri" xlink:href="http://genome.ucsc.edu/FAQ/FAQformat.html">http://genome.ucsc.edu/FAQ/FAQformat.html</ext-link>), can be read from the
client’s local disk or a public URL and are plotted adjacent to the normal tracks. The
full suite of zooming, panning, reordering and expansion interactions applies equally to
custom tracks. For large datasets, the user can provide a track line with a bigDataUrl
pointing to a pre-indexed BED or WIG data file in bigBed/bigWig format (<xref ref-type="bibr" rid="bts695-B3">Kent <italic>et al.</italic>, 2010</xref>) or sequence
variations in tabix-compressed Variant Call Format, VCFTabix, (<xref ref-type="bibr" rid="bts695-B1">Danacek <italic>et al.</italic>, 2011</xref>; <xref ref-type="bibr" rid="bts695-B5">Li, 2011</xref>), again formatted to UCSC’s guidelines, and the
application will seamlessly fetch data for the current view with AJAX and render graphical
data within the browser. ChromoZoom is, therefore, ideal for exploration of experimental
data by researchers, enabling the visualization of custom results alongside a dynamic
representation of curated genomic information.</p>
  </sec>
  <sec id="SEC3">
    <title>3 IMPLEMENTATION</title>
    <p>ChromoZoom uses a local installation of the UCSC Genome Browser to generate and pre-cache
tiled PNG images (via Ruby scripts). Rake (‘Ruby make’) directs the creation of
a configuration (YAML) file for each genome, the capture of tile images and the creation of
a JSON file to initialize the web interface. A Ruby extension written in C maximizes
image-processing performance. ImageMagick is used for many image operations and the Nokogiri
library for HTML parsing. The eight tracks available on <ext-link ext-link-type="uri" xlink:href="http://chromozoom.org/for">http://chromozoom.org/for</ext-link> the hg19 assembly and the 19 tracks for the sacCer3
assembly consume 64 GB and 5.4 GB of disk space, respectively. Tile generation scripts are
run in parallel across a computing cluster.</p>
    <p>Because all general-use track data are converted to static tile images, they can be served
efficiently via an Apache web server, a small amount of PHP, and appropriate use of HTTP
cache directives. Tokyo Tyrant, a fast on-disk hash table, stores the tile images and caches
search queries. The front-end is constructed on top of jQuery and the jQuery UI widget
framework. Many HTML5 features are used, such as SVG, the Canvas and File APIs and Web
Workers. Web Workers allow computation on custom track data to be moved to independent
JavaScript threads to avoid locking the browser UI. JavaScript for handling custom tracks
has been designed for straightforward addition of new data formats and drawing styles.</p>
    <p>The visual style is influenced by Edward Tufte’s principle of maximizing the data-ink
ratio (<xref ref-type="bibr" rid="bts695-B10">Tufte, 2001</xref>). Repetitive high-order
digits are removed from the Base Position track, the data are placed front and centre with
minimalistic borders and labelling, and control widgets are kept in the margin and in
collapsed format until activated by the user.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_29_3_384__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="msword" xlink:href="supp_bts695_Pak_ChromoZoom_S1.doc"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors thank members of the Roth laboratory, in particular Takafumi Yamaguchi and
Joseph Mellor, for providing design suggestions and sample custom track data. They thank
David Haussler and W. James Kent for advice and encouragement and the Genome Bioinformatics
Group at UC Santa Cruz for making source code, data and documentation for the UCSC Genome
Browser (<ext-link ext-link-type="uri" xlink:href="http://genome.ucsc.edu/">http://genome.ucsc.edu/</ext-link>) publicly
available.</p>
    <p><italic>Funding</italic>: <funding-source>National Institutes of Health</funding-source>
(<award-id>HG004233</award-id>, <award-id>HL107440</award-id>); <funding-source>Ontario
Research Fund—Research Excellence Award; Canadian Institute for Advanced Research
Fellowship; Canada Excellence Research Chair</funding-source> (to F.P.R.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="bts695-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Danacek</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The variant call format and VCFtools</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2156</fpage>
        <lpage>2158</lpage>
        <pub-id pub-id-type="pmid">21653522</pub-id>
      </element-citation>
    </ref>
    <ref id="bts695-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dreszer</surname>
            <given-names>TR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The UCSC Genome Browser database: extensions and updates
2011</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2011</year>
        <volume>40</volume>
        <fpage>D918</fpage>
        <lpage>D923</lpage>
        <pub-id pub-id-type="pmid">22086951</pub-id>
      </element-citation>
    </ref>
    <ref id="bts695-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BigWig and BigBed: enabling browsing of large distributed
datasets</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>2204</fpage>
        <lpage>2207</lpage>
        <pub-id pub-id-type="pmid">20639541</pub-id>
      </element-citation>
    </ref>
    <ref id="bts695-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kong</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ABrowse—a customizable next-generation genome browser
framework</article-title>
        <source>BMC Bioinformatics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>2</fpage>
        <pub-id pub-id-type="pmid">22222089</pub-id>
      </element-citation>
    </ref>
    <ref id="bts695-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Tabix: fast retrieval of sequence features from generic TAB-delimited
files</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>718</fpage>
        <lpage>719</lpage>
        <pub-id pub-id-type="pmid">21208982</pub-id>
      </element-citation>
    </ref>
    <ref id="bts695-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nielsen</surname>
            <given-names>CB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Visualizing genomes: techniques and challenges</article-title>
        <source>Nat. Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>S1</fpage>
        <lpage>S11</lpage>
        <pub-id pub-id-type="pmid">20238439</pub-id>
      </element-citation>
    </ref>
    <ref id="bts695-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Skinner</surname>
            <given-names>ME</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>JBrowse: a next-generation genome browser</article-title>
        <source>Genome Res.</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>1630</fpage>
        <lpage>1638</lpage>
        <pub-id pub-id-type="pmid">19570905</pub-id>
      </element-citation>
    </ref>
    <ref id="bts695-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stalker</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Ensembl web site: mechanics of a genome browser</article-title>
        <source>Genome Res.</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>951</fpage>
        <lpage>955</lpage>
        <pub-id pub-id-type="pmid">15123591</pub-id>
      </element-citation>
    </ref>
    <ref id="bts695-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stein</surname>
            <given-names>LD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The generic genome browser: a building block for a model organism system
database</article-title>
        <source>Genome Res.</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>1599</fpage>
        <lpage>1610</lpage>
        <pub-id pub-id-type="pmid">12368253</pub-id>
      </element-citation>
    </ref>
    <ref id="bts695-B10">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Tufte</surname>
            <given-names>ER</given-names>
          </name>
        </person-group>
        <source>The Visual Display of Quantitative Information</source>
        <year>2001</year>
        <edition>2nd</edition>
        <publisher-loc>Cheshire, CT</publisher-loc>
        <publisher-name>Graphics Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="bts695-B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wheeler</surname>
            <given-names>DL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Database resources of the National Center for Biotechnology</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>28</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="pmid">12519941</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
