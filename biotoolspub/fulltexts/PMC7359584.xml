<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7359584</article-id>
    <article-id pub-id-type="publisher-id">6886</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-020-06886-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MethylStar: A fast and robust pre-processing pipeline for bulk or single-cell whole-genome bisulfite sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Shahryary</surname>
          <given-names>Yadollah</given-names>
        </name>
        <address>
          <email>y.shahryary@tum.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hazarika</surname>
          <given-names>Rashmi R.</given-names>
        </name>
        <address>
          <email>rashmi.hazarika@tum.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Johannes</surname>
          <given-names>Frank</given-names>
        </name>
        <address>
          <email>frank@johanneslab.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.6936.a</institution-id><institution-id institution-id-type="ISNI">0000000123222966</institution-id><institution>Technical University of Munich, Institute for Advanced Study (IAS), </institution></institution-wrap>Lichtenbergstr. 2a, Garching, 85748 Germany </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.6936.a</institution-id><institution-id institution-id-type="ISNI">0000000123222966</institution-id><institution>Technical University of Munich, Department of Plant Sciences, </institution></institution-wrap>Liesel-Beckmann-Str. 2, Freising, 85354 Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>479</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>3</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>6</day>
        <month>7</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Whole-Genome Bisulfite Sequencing (WGBS) is a Next Generation Sequencing (NGS) technique for measuring DNA methylation at base resolution. Continuing drops in sequencing costs are beginning to enable high-throughput surveys of DNA methylation in large samples of individuals and/or single cells. These surveys can easily generate hundreds or even thousands of WGBS datasets in a single study. The efficient pre-processing of these large amounts of data poses major computational challenges and creates unnecessary bottlenecks for downstream analysis and biological interpretation.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">To offer an efficient analysis solution, we present MethylStar, a fast, stable and flexible pre-processing pipeline for WGBS data. MethylStar integrates well-established tools for read trimming, alignment and methylation state calling in a highly parallelized environment, manages computational resources and performs automatic error detection. MethylStar offers easy installation through a dockerized container with all preloaded dependencies and also features a user-friendly interface designed for experts/non-experts. Application of MethylStar to WGBS from Human, Maize and <italic>A. thaliana</italic> shows favorable performance in terms of speed and memory requirements compared with existing pipelines.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">MethylStar is a fast, stable and flexible pipeline for high-throughput pre-processing of bulk or single-cell WGBS data. Its easy installation and user-friendly interface should make it a useful resource for the wider epigenomics community. MethylStar is distributed under GPL-3.0 license and source code is publicly available for download from github <ext-link ext-link-type="uri" xlink:href="https://github.com/jlab-code/MethylStar">https://github.com/jlab-code/MethylStar</ext-link>. Installation through a docker image is available from <ext-link ext-link-type="uri" xlink:href="http://jlabdata.org/methylstar.tar.gz">http://jlabdata.org/methylstar.tar.gz</ext-link></p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>DNA methylation</kwd>
      <kwd>Whole genome bisulfite sequencing</kwd>
      <kwd>NGS</kwd>
      <kwd>Pipeline</kwd>
      <kwd>Single cell</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Whole-Genome Bisulfite Sequencing (WGBS) is a Next Generation Sequencing (NGS) technique for measuring DNA methylation at base resolution. As a result of continuing drops in sequencing costs, an increasing number of laboratories and international consortia (e.g. IHEC, SYSCID, BLUEPRINT, EpiDiverse, NIH ROADMAP, Arabidopsis 1001 Epigenomes, Genomes and physical Maps) are adopting WGBS as the method of choice to survey DNA methylation in large population samples or in collections of cell lines and tissue types, either in bulk or at the single-cell level [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Such surveys can easily generate hundreds or even thousands of WGBS datasets in a single study. A broad array of software solutions for the downstream analysis of bulk and single-cell WGBS data have been developed in recent years. These include tools for data normalization (e.g. RnBeads [<xref ref-type="bibr" rid="CR3">3</xref>], SWAN [<xref ref-type="bibr" rid="CR4">4</xref>], ChAMP [<xref ref-type="bibr" rid="CR5">5</xref>]), detection of differentially methylated regions (DMRs) (e.g. Methylkit [<xref ref-type="bibr" rid="CR6">6</xref>], DMRcaller [<xref ref-type="bibr" rid="CR7">7</xref>], Methylpy [<xref ref-type="bibr" rid="CR8">8</xref>], metilene [<xref ref-type="bibr" rid="CR9">9</xref>]), imputation of methylomes from bulk WGBS data (e.g. METHimpute [<xref ref-type="bibr" rid="CR10">10</xref>]), imputation of single-cell methylomes (e.g. Melissa [<xref ref-type="bibr" rid="CR11">11</xref>], deepCpG [<xref ref-type="bibr" rid="CR12">12</xref>]) and dropouts in single-cell data (e.g. SCRABBLE [<xref ref-type="bibr" rid="CR13">13</xref>]).</p>
    <p>However, these downstream analysis tools are dependent on the output of a number of data pre-processing steps, such as quality control (e.g. FastQC (<ext-link ext-link-type="uri" xlink:href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc">https://www.bioinformatics.babraham.ac.uk/projects/fastqc</ext-link>), QualiMap [<xref ref-type="bibr" rid="CR14">14</xref>], NGS QC toolkit [<xref ref-type="bibr" rid="CR15">15</xref>]), de-multiplexing of sequence reads, adapter trimming (e.g. Trimmomatic [<xref ref-type="bibr" rid="CR16">16</xref>], TrimGalore (<ext-link ext-link-type="uri" xlink:href="https://github.com/FelixKrueger/TrimGalore">https://github.com/FelixKrueger/TrimGalore</ext-link>), Cutadapt [<xref ref-type="bibr" rid="CR17">17</xref>]), alignment of reads to a reference genome and generation of methylation calls (e.g. BSseeker2 [<xref ref-type="bibr" rid="CR18">18</xref>], BSseeker3 [<xref ref-type="bibr" rid="CR19">19</xref>], Bismark [<xref ref-type="bibr" rid="CR20">20</xref>], BSMap [<xref ref-type="bibr" rid="CR21">21</xref>], bwa-meth (<ext-link ext-link-type="uri" xlink:href="https://github.com/brentp/bwa-meth/">https://github.com/brentp/bwa-meth/</ext-link>), BRAT-nova [<xref ref-type="bibr" rid="CR22">22</xref>], BiSpark [<xref ref-type="bibr" rid="CR23">23</xref>], WALT [<xref ref-type="bibr" rid="CR24">24</xref>], segemehl [<xref ref-type="bibr" rid="CR25">25</xref>]). From a computational standpoint, data pre-processing is by far the most time-consuming step in the entire bulk or single-cell WGBS analysis workflow (Fig.<xref rid="Fig1" ref-type="fig">1</xref>). In an effort to help streamline the pre-processing of WGBS data several pipelines have been published in recent years. These include nf-core/methylseq [<xref ref-type="bibr" rid="CR26">26</xref>], gemBS [<xref ref-type="bibr" rid="CR27">27</xref>], Bicycle [<xref ref-type="bibr" rid="CR28">28</xref>] and Methylpy, some of which are currently employed by several epigenetic consortia. gemBS, Bicycle and Methylpy integrate data pre-processing and analysis steps using their own custom trimming and/or alignment tools (see Table <xref rid="Tab1" ref-type="table">1</xref>). By contrast, nf-core/methylseq implements well-established NGS tools, such as TrimGalore for read trimming and Bismark and bwa-meth/MethylDackel for alignment. The nf-core/methylseq framework is built using Nextflow [<xref ref-type="bibr" rid="CR29">29</xref>], and aims to provide reproducible pipeline templates that can be easily adapted by both developers as well as experimentalists. Despite these efforts, the installation and execution of these pipelines is not trivial and often require substantial bioinformatic support. Moreover, managing the run times of these pipelines for large numbers of WGBS datasets (i.e. in the order of hundreds or thousands) relies on substantial manual input, such as launching of parallel jobs on a compute cluster and collecting output files from temporary folders.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Basic workflow of MethylStar showing the pipeline architecture. The left panel shows a standard BS-Seq workflow and on the right are the different components of the MethylStar pipeline integrated as 3 different layers viz. Python, Shell and R. All steps of the pipeline have been parallelized using GNU parallel. MethylStar offers the option for “Quick run” (indicated in red) which runs all steps sequentially in one go or each component can be executed separately. MethylStar incorporates all pre-processing steps of a standard BS-Seq workflow and generates standard outputs that can be used for input into several downstream analysis tools</p></caption><graphic xlink:href="12864_2020_6886_Fig1_HTML" id="MO1"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Table showing different features of MethylStar as compared to other BS-seq pipelines</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Methylpy</th><th align="left">MethylStar</th><th align="left">methylseq</th><th align="left">gemBS</th><th align="left">Bicycle</th></tr></thead><tbody><tr><td align="left" colspan="6">Pipeline Features</td></tr><tr><td align="left">Multi-threading</td><td align="left"/><td align="left"><italic>√</italic></td><td align="left"><italic>√</italic></td><td align="left"><italic>√</italic></td><td align="left"><italic>√</italic></td></tr><tr><td align="left">language</td><td align="left">Python</td><td align="left">Python, shell, R</td><td align="left">Java</td><td align="left">C, Python</td><td align="left">Java</td></tr><tr><td align="left">distribution</td><td align="left">github, PyPI</td><td align="left">GitHub</td><td align="left">Github</td><td align="left">GitHub</td><td align="left">Github</td></tr><tr><td align="left"/><td align="left">(Apache license)</td><td align="left">(GNU GPL3)</td><td align="left">(MIT license)</td><td align="left">(GNU GPL3)</td><td align="left">(GNU GPL3)</td></tr><tr><td align="left">Installation &amp;</td><td align="left">pip install, install</td><td align="left">Docker, install</td><td align="left">Docker,</td><td align="left">Docker,</td><td align="left">Docker</td></tr><tr><td align="left">configuration</td><td align="left">dependencies</td><td align="left">dependencies</td><td align="left">Singularity,</td><td align="left">Singularity</td><td align="left"/></tr><tr><td align="left"/><td align="left"/><td align="left"/><td align="left">Conda</td><td align="left"/><td align="left"/></tr><tr><td align="left">User-interface</td><td align="left">-</td><td align="left"><italic>√</italic></td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr><tr><td align="left">Single/paired-end</td><td align="left"><italic>√</italic></td><td align="left"><italic>√</italic></td><td align="left"><italic>√</italic></td><td align="left"><italic>√</italic></td><td align="left"><italic>√</italic></td></tr><tr><td align="left">Input data</td><td align="left">Single-cell, WGBS,</td><td align="left">WGBS, Single-cell</td><td align="left">WGBS</td><td align="left">RRBS, WGBS,</td><td align="left">WGBS</td></tr><tr><td align="left"/><td align="left">singlecell NOMe-seq, PBAT</td><td align="left">(PBAT)</td><td align="left"/><td align="left">PBAT</td><td align="left"/></tr><tr><td align="left" colspan="6">Pipe steps</td></tr><tr><td align="left">adapter trimming</td><td align="left">Cutadapt</td><td align="left">Trimmomatic</td><td align="left">TrimGalore</td><td align="left">-</td><td align="left">bicycle analyzemethylation</td></tr><tr><td align="left">alignment</td><td align="left">bowtie/bowtie2</td><td align="left">Bismark</td><td align="left">Bismark,</td><td align="left">gem3</td><td align="left">bicycle align/</td></tr><tr><td align="left"/><td align="left"/><td align="left"/><td align="left">bwa-meth</td><td align="left"/><td align="left">bowtie/bowtie2</td></tr><tr><td align="left">remove PCR</td><td align="left">Picard</td><td align="left">Bismark</td><td align="left">Bismark, Picard</td><td align="left">Bscall</td><td align="left">bicycle analyzemethylation</td></tr><tr><td align="left">duplicates</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">methylation</td><td align="left"><italic>√</italic></td><td align="left">ProcessBismarAln,</td><td align="left">Bismark,</td><td align="left">Bscall</td><td align="left">bicycle</td></tr><tr><td align="left">calling</td><td align="left"/><td align="left">Bismark</td><td align="left">MethylDackel</td><td align="left"/><td align="left">analyzemethylation, GATK</td></tr><tr><td align="left">imputation of</td><td align="left">-</td><td align="left">METHimpute</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr><tr><td align="left">missing cytosines</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">DMR calling</td><td align="left"><italic>√</italic></td><td align="left">-</td><td align="left">-</td><td align="left">-</td><td align="left">bicycle analyze</td></tr><tr><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">differential</td></tr><tr><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">methylation</td></tr><tr><td align="left">SNP calling</td><td align="left">-</td><td align="left">-</td><td align="left">-</td><td align="left">Bscall</td><td align="left">-</td></tr><tr><td align="left">Alignment QC</td><td align="left">-</td><td align="left">Bismark</td><td align="left">Qualimap</td><td align="left"><italic>√</italic></td><td align="left"><italic>√</italic></td></tr><tr><td align="left">summary reports</td><td align="left"><italic>√</italic></td><td align="left">FastQC</td><td align="left">Bismark,</td><td align="left"><italic>√</italic></td><td align="left"><italic>√</italic></td></tr><tr><td align="left"/><td align="left"/><td align="left"/><td align="left">MultiQC, Preseq</td><td align="left"/><td align="left"/></tr><tr><td align="left">Methylation</td><td align="left">BigWig</td><td align="left">BigWig, bedGraph</td><td align="left">-</td><td align="left">BigWig,</td><td align="left">BigWig</td></tr><tr><td align="left">visualization</td><td align="left"/><td align="left"/><td align="left"/><td align="left">bedGraph</td><td align="left"/></tr></tbody></table></table-wrap></p>
    <p>In an attempt to address these issues, we have developed MethylStar, a fast, stable and flexible pre-processing pipeline for WGBS data. MethylStar integrates well-established NGS tools for read trimming, alignment and methylation state calling in a highly parallelized environment, manages computational resources and performs automatic error detection. MethylStar offers easy installation through a dockerized container with all preloaded dependencies and also features a user-friendly interface designed for experts/non-experts. Application of MethylStar to WGBS from Human, Maize and <italic>A. thaliana</italic> shows favorable performance in terms of speed and memory requirements compared with existing pipelines.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Core pipeline NGS components</title>
      <p>In its current implementation, MethylStar integrates processing of raw fastq reads for both single- and paired-end data with options for adapter trimming, quality control (fastQC) and removal of PCR duplicates (Bismark software suite). Read alignment and cytosine context extraction is performed with the Bismark software suite. Alignments can be performed for WGBS and Post-bisulfite adaptor tagging (PBAT) approaches for single-cell libraries. Bismark was chosen because it features one of the most sensitive aligners, resulting in comparatively high mapping efficiency, low mapping bias and good genomic coverage [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>]. Finally, cytosine-level methylation calls are (optionally) obtained with METHimpute, a Hidden Markov Model for inferring the methylation status/level of individual cytosines, even in the presence of low sequencing depth and/or missing data. All the different data processing steps have been optimized for speed and performance (see below), and can run on local machines as well as on larger compute nodes.</p>
    </sec>
    <sec id="Sec4">
      <title>User interface</title>
      <p>MethylStar features a lightweight python-based user interface, which is particularly useful for bench-scientists who are not familiar with command-line scripting. The aim of the interface is to improve useability and to reduce human error arising from typing mistakes or from the misspecification of parameter settings during pipeline configuration. The interface offers configuration templates that can be easily re-used for subsequent samples/projects, thus ensuring consistency and repeatability of data analysis projects. Unlike many web-based or graphical-based interfaces, the MethylStar interface does not require additional resources and/or dependencies. Users navigate through an index menu and run selected pipeline components by typing the menu index of choice. We designed the interface for both experts and non-experts. Non-experts are able to execute all pipeline commands without having to edit a single bash script, while advanced users can easily configure additional parameters and install software/tools (e.g. most recent/legacy version of a software) to integrate with MethylStar by simply specifying path variables. Finally, users can configure email addresses to receive automatic notifications when a job completed or failed. A video demonstrating the use of the interface can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/jlab-code/MethylStar#MethylStar_tutorial_on_YouTube">https://github.com/jlab-code/MethylStar#MethylStar_tutorial_on_YouTube</ext-link>.</p>
    </sec>
    <sec id="Sec5">
      <title>Pipeline architecture, optimization of parallel processes and memory usage</title>
      <p>The pipeline architecture comprises three main layers (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The first layer is the interactive command-line user interface implemented in Python to simplify the process of configuring software settings and running MethylStar. The second layer consists of shell scripts, and handles low-level processes, efficiently coordinates the major software components and manages computational resources. The final layer is implemented in R, and is used to call METHimpute and to generate output files that are compatible with a number of publicly available DMR-callers such as Methylkit, DMRcaller and bigWig files for visualization in Genome Browsers such as JBrowse [<xref ref-type="bibr" rid="CR32">32</xref>]. All outputs are provided in standard data formats for downstream analysis.</p>
      <p>All components/steps of the pipeline have been parallelized using GNU Parallel (<ext-link ext-link-type="uri" xlink:href="https://www.gnu.org/software/parallel/">https://www.gnu.org/software/parallel/</ext-link>) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The user can either set the number of parallel jobs manually for each pipeline component, or can opt to use the inbuilt parallel option from the “configuration” option of the menu. The inbuilt parallel implementation is also available under the “Quick Run” option. This latter option detects the number of parallel processes/jobs automatically for each pipeline component based on available system cores/threads and memory, thus allowing the user to run the entire steps of the pipeline in one go.</p>
      <p>In the parallel implementation of all pipeline steps, we use genome size (in base pairs) as an additional factor in the optimization of computational resources. For example, in the analysis of <italic>A. thaliana</italic> samples (genome size ∼135 mega base pairs), our parallel implementation of Trimmomatic (a java tool) sets the optimal number of jobs to 12 on a system with 88 cores and 386 GB RAM. This setting allocates (12 jobs ×8 threads) =96 threads for trimming (java threads) and (12 jobs ×1 threads) =12 threads to the gzip tools (default no. of threads fixed to 8 in the pipeline). By contrast, for read trimming in Maize (genome size ∼2500 mega base pairs), the optimal number of jobs is set to 5. In the parallel implementation of Bismark alignment step under a similar system configuration, while running paired-end reads from <italic>A. thaliana</italic>, we optimally set the number of jobs to 4. This setting allocates (4 jobs ×8 files/threads) =32 threads to Bowtie2 and (4 jobs ×8 files/threads ×2) =64 threads to the bismark alignment tool (default no. of threads fixed to 8 in the internal bismark parallel argument). In a similar way, for deduplicate_bismark, the optimal number of jobs is set to (1/4th of total 88 cores) =22. For bismark_methylation_extractor it is set as 4, which allocates (4 jobs ×8 threads) =32 threads each to itself and to Bowtie tools as well as a few additional cores to gzip and samtools streams. In this way, the maximum number of threads never exceeds the total number of available cores, which in turn allows other jobs such as file compression, I/O operations to be performed simultaneously. Under the “Quick Run” option we have parallelized R processes such as the extraction of methylation calls from BAM files (post PCR duplicates removal) by bypassing the Bismark methylation extractor step and by passing these calls directly onto METHimpute for imputation of missing cytosines (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).</p>
    </sec>
    <sec id="Sec6">
      <title>Automatic error handling and detection</title>
      <p>MethylStar issues user-friendly messages related to configuration errors such as non-existing paths to input/output folders, low disk space, incorrect file extensions, non-empty folders. In addition, we have introduced checkpoints for each individual component of the pipeline so that a job can be resumed easily from the nearest checkpoint in the unlikely event of system failure (e.g. disk issues, file corruption, user interruption). MethylStar accepts intermediate files such as BAM files, CX-reports etc., and is able to process these new files together with pre-existing files in the folder. MethylStar issues user-friendly warnings before resuming each run. For instance, if a given folder is non-empty it will ask for user permission to continue, and issues a message that files with pre-existing names will be overwritten.</p>
    </sec>
    <sec id="Sec7">
      <title>Running MethylStar</title>
      <p>The user can choose to run each pipeline component individually, and customize software settings at each step by editing the configuration file, which is available as an option through the interactive command-line user interface. The user interface displays the available options as an index menu, and users can execute specific pipeline steps. Some of the key configuration parameters include setting file paths to input and output data, options for handling large batches of samples, file format conversions, as well as options for deleting auxiliary files that are generated during intermediate analysis steps. Our interactive user interface aids in the fast execution of complex commands and will be particularly effective for users who are less familiar with command line scripting. As an alternative, MethylStar also features a “Quick Run option”, which allows the user to run all pipeline steps in one go using default configuration settings (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).</p>
    </sec>
    <sec id="Sec8">
      <title>Installation and documentation</title>
      <p>MethylStar can be easily installed via a Docker image. This includes all the softwares, libraries and packages within the container, and thus solves any dependency issues. Advanced users can edit the existing docker container and build their own image.</p>
      <p>Detailed description about installation and running the pipeline is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/jlab-code/MethylStar">https://github.com/jlab-code/MethylStar</ext-link>.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Results and discussion</title>
    <sec id="Sec10">
      <title>Benchmarking of speed</title>
      <p>To demonstrate MethylStar’s performance we analyzed bulk WGBS data from a selection of 200 <italic>A. thaliana</italic> ecotypes (paired-end, 295 GB, ∼8.63× depth, 85.66% genome coverage, GSE54292), 75 Maize strains (paired-end, 209 GB, ∼0.36× depth, ∼22.12% genome coverage, GSE39232) and 88 Human H1 cell lines (single-end, 82 GB, ∼0.12× depth, ∼10.62% genome coverage, GSM429321). MethylStar was compared with Methylpy, nf-core/methylseq and gemBS. All pipelines were run with default parameters on a computing cluster with a total of 88 cores (CPU 2.2 GHz with 378 GB RAM). Speed performance was assessed for a series of batch sizes (<italic>A. thaliana</italic>: 50, 100, 150, 200 samples; Human H1 cell line: 22, 44, 66, 88 samples; Maize: 15, 30, 45, 60, 75 samples) and was restricted to a fixed number of jobs (=32), (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a-c and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). Although gemBS achieved the fastest processing times for the <italic>A. thaliana</italic> samples, MethylStar clearly outperformed the other pipelines when applied to the more complex genomes of Maize and Human, which are computationally more expansive and resource-demanding (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b-c). For instance, for 88 Human WGBS samples (82 GB of data), MethylStar showed a 75.61% reduction in processing time relative to gemBS, the second fastest pipeline (∼909 mins vs. ∼3727 mins). Extrapolating from these numbers, we expect that for 1000 Human WGBS samples, MethylStar could save about ∼22.24 days of run time (4 × faster). To show that MethylStar can also be applied to single-cell WGBS data, we analyzed DNA methylation of 200 single cells from Human early embryo tissue (paired-end, 845 GB, ∼0.38× depth, ∼9.97% genome coverage, GSE81233) split into batches of 100 and 200 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). MethylStar’s processing times were compared to Methylpy which also supports single-cell data. For 100 cells, MethylStar required only ∼2225 mins as compared to ∼5518 mins required by Methylpy. Hence, MethylStar presents an efficient analysis solution for deep single-cell WGBS experiments.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Performance of MethylStar as compared with other BS-Seq analysis pipelines viz. Methylpy, nf-core/methylseq and gemBS in (<bold>a</bold>) <italic>A. thaliana</italic> (<bold>b</bold>) Maize (<bold>c</bold>) H1 cell line and (<bold>d</bold>) scBS-Seq samples. CPU processing time taken by METHimpute was not included in the current benchmarking process as there is no equivalent method in the other pipelines to compare with. Because of the very long run times observed for the <italic>A. thaliana</italic> data, Methylpy and Methylseq were no longer considered for benchmarking of speed in Maize and H1 cell line samples. All pipelines were run using 32 jobs. (<bold>e</bold>) Peak memory usage as a function of time for 10 random <italic>A. thaliana</italic> samples. (<bold>f</bold>) Time taken by each component of MethylStar. X-axis shows the individual components of MethylStar where the dot with lighter shade of orange indicates -without parallel and darker shade of orange indicates - with parallel implementation of MethylStar. On the y-axis is the time in mins. The size of the dot indicates the peak memory usage in MB by each component</p></caption><graphic xlink:href="12864_2020_6886_Fig2_HTML" id="MO2"/></fig></p>
      <p>To demonstrate that MethylStar’s processing speed does not come at the expense of poor read alignments, we analysed the read mapping statistics of 50 samples each of <italic>A. thaliana</italic>, Maize, Human H1 cell line and single-cell Human data using MethylStar, Methylpy, nf-core/methylseq and gemBS. Our results show that MethylStar and nf-core/methylseq, both of which employ the Bismark alignment tool, provide the most accurate and sensitive alignments. This observation that is consistent with recent benchmarking results [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>]. By contrast, Methylpy and gemBS use their own inbuilt aligners and generally display poorer alignment statistics. Interestingly, although gemBS was the fastest pipeline for the <italic>A. thaliana</italic> samples, the percentage of ambiguously mapped reads was considerably higher than that of MethylStar, thus demonstrating a trade-off between speed and mapping performance. We also noticed that the percentage of ambiguously mapped reads by gemBS was even further increased in the case of the Maize samples (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1 and Table S1). This could indicate that gemBS’s alignment performance is particularly challenged in complex plant genomes, although this hypothesis should be explored in more detail.</p>
    </sec>
    <sec id="Sec11">
      <title>Memory usage statistics</title>
      <p>Along with benchmarking of speed, we also evaluated the performance of the MethylStar, gemBS, nf-core/methylseq and Methylpy pipelines in terms of system memory utilization using the MemoryProfiler (<ext-link ext-link-type="uri" xlink:href="https://github.com/pythonprofilers/memory_profiler">https://github.com/pythonprofilers/memory_profiler</ext-link>) python module (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e). We assessed the CPU time versus peak/max memory of all the 4 pipelines (default settings) on a computing cluster (specifications above). For 10 random samples from the above <italic>A. thaliana</italic> benchmarking dataset (paired-end, 16 GB, GSE54292) MethylStar and Methylpy showed the best balance between peak memory usage (∼12000 MB and ∼15000 MB, respectively) and total run time (∼177 mins and ∼333 mins, respectively). In contrast, nf-core/methylseq and gemBS exhibited strong trade-offs between memory usage and speed, with nf-core/methylseq showing the lowest peak memory usage (∼700 MB) but the longest CPU time (∼697 mins), and gemBS the highest peak memory usage (∼21000 MB) but the shortest run time (∼42 mins) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5).</p>
      <p>Furthermore, we inspected the run times of MethylStar’s individual pipeline components, both with and without parallel implementation (Fig. <xref rid="Fig2" ref-type="fig">2</xref>f and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3). Our results clearly show that the parallel implementation is considerably faster for all components; however, it is accompanied by a higher peak memory usage. For instance, the implementation of the Bismark alignment step required ∼141 mins (with parallel) as compared to ∼210 mins (without parallel), a ∼33% reduction in processing time. However, in exchange, peak memory usage was increased by ∼65%. Thus, with sufficient computational resources, MethylStar’s parallel implementation of Bismark alignment can be very effective in handling large numbers of read alignments in considerably less amount of time (Fig. <xref rid="Fig2" ref-type="fig">2</xref>f).</p>
      <p>We further benchmarked memory usage using 10 random samples from the above Maize dataset (paired-end, 23 GB, GSE39232). For this analysis, we focused on gemBS and MethylStar due to their shorter processing times for these datasets as compared to nf-core/methylseq and Methylpy. For these Maize dataset, gemBS’s peak memory usage was ∼110000 MB as compared to ∼81000 MB for MethylStar (∼1.3 times less memory), (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4) with a total run time of ∼667 mins and ∼508 mins, respectively. We observed a 76% reduction in processing times of Maize samples using the parallel implementation of MethylStar pipeline (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4) as compared to the without parallel implementation. Taken together, these benchmarking results clearly show that MethylStar exhibits favorable performance in terms of processing time and memory, and that it is therefore an efficient solution for the pre-processing of large numbers of samples even on a computing cluster with limited resources.</p>
    </sec>
  </sec>
  <sec id="Sec12" sec-type="conclusion">
    <title>Conclusion</title>
    <p>MethylStar is a fast, stable and flexible pipeline for the high-throughput analysis of bulk or single-cell WGBS data. Its easy installation and user-friendly interface should make it a useful resource for the wider epigenomics community.</p>
  </sec>
  <sec id="Sec13">
    <title>Availability and requirements</title>
    <p>Project name: MethylStarProject home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/jlab-code/MethylStar">https://github.com/jlab-code/MethylStar</ext-link>Operating system(s): Cross-platformProgramming language: Python, Shell, R License: GPL-3.0</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec14">
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="12864_2020_6886_MOESM1_ESM.pdf">
          <caption>
            <p><bold>Additional file 1</bold> Supplementary figures and data tables (pdf format) showing mapping statistics, processing times and memory usage of different pipelines benchmarked.</p>
          </caption>
        </media>
      </supplementary-material>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>WGBS</term>
        <def>
          <p>Whole-genome bisulfite sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>NGS</term>
        <def>
          <p>Next generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>DMRs</term>
        <def>
          <p>Differentially methylated regions</p>
        </def>
      </def-item>
      <def-item>
        <term>QC</term>
        <def>
          <p>Quality control</p>
        </def>
      </def-item>
      <def-item>
        <term>PCR</term>
        <def>
          <p>Polymerase chain reaction</p>
        </def>
      </def-item>
      <def-item>
        <term>PBAT</term>
        <def>
          <p>Post-bisulfite adaptor tagging</p>
        </def>
      </def-item>
      <def-item>
        <term>CX-reports</term>
        <def>
          <p>Cytosine context (CG, CHG, CHH) report for all cytosines</p>
        </def>
      </def-item>
      <def-item>
        <term>BAM</term>
        <def>
          <p>Binary alignment map</p>
        </def>
      </def-item>
      <def-item>
        <term>RAM</term>
        <def>
          <p>Random-access memory</p>
        </def>
      </def-item>
      <def-item>
        <term>CPU</term>
        <def>
          <p>Central processing unit</p>
        </def>
      </def-item>
      <def-item>
        <term>MB</term>
        <def>
          <p>Mega bytes</p>
        </def>
      </def-item>
      <def-item>
        <term>GB</term>
        <def>
          <p>Giga bytes</p>
        </def>
      </def-item>
      <def-item>
        <term>I/O</term>
        <def>
          <p>Input/output</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12864-020-06886-3.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Markus List for his suggestion to use a docker container for version control.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>FJ, RRH and YS conceptualized the method. YS and RRH developed, implemented and tested the pipeline. RRH, FJ and YS wrote the paper. FJ supervised the project. All authors have read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>FJ, YS, RRH acknowledge support from the Technical University of Munich-Institute for Advanced Study funded by the German Excellent Initiative and the European Seventh Framework Programme under grant agreement no. 291763. FJ and YS were also supported by the SFB Sonderforschungsbereich924 of the Deutsche Forschungsgemeinschaft(DFG).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Not applicable</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p>Not applicable</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Keown</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Kurihara</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Castanon</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lucero</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nery</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Sandoval</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Bui</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sejnowski</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Harkins</surname>
            <given-names>TT</given-names>
          </name>
          <name>
            <surname>Mukamel</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Behrens</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Ecker</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>Single-cell methylomes identify neuronal subtypes and regulatory elements in mammalian cortex</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>357</volume>
        <issue>6351</issue>
        <fpage>600</fpage>
        <lpage>4</lpage>
        <?supplied-pmid 28798132?>
        <pub-id pub-id-type="pmid">28798132</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lian</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Qiao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Single-cell DNA methylome sequencing of human preimplantation embryos</article-title>
        <source>Nat Genet</source>
        <year>2018</year>
        <volume>50</volume>
        <issue>1</issue>
        <fpage>12</fpage>
        <lpage>9</lpage>
        <?supplied-pmid 29255258?>
        <pub-id pub-id-type="pmid">29255258</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Müller</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Scherer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Assenov</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lutsik</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lengauer</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bock</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Rnbeads 2.0: comprehensive analysis of DNA methylation data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="pmid">30606230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maksimovic</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>SWAN: Subset-quantile within array normalization for illumina infinium HumanMethylation450 BeadChips</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>6</issue>
        <fpage>44</fpage>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tian</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Webster</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Beck</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Feber</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Teschendorff</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>ChAMP: updated methylation analysis pipeline for Illumina BeadChips</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>24</issue>
        <fpage>3982</fpage>
        <lpage>4</lpage>
        <?supplied-pmid 28961746?>
        <pub-id pub-id-type="pmid">28961746</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Akalin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kormaksson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Garrett-Bakelman</surname>
            <given-names>FE</given-names>
          </name>
          <name>
            <surname>Figueroa</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Melnick</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>methylKit: a comprehensive R package for the analysis of genome-wide DNA methylation profiles</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>10</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Catoni</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tsang</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Greco</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Zabet</surname>
            <given-names>NR</given-names>
          </name>
        </person-group>
        <article-title>DMRcaller: a versatile R/Bioconductor package for detection and visualization of differentially methylated regions in CpG and non-CpG contexts</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <issue>19</issue>
        <fpage>114</fpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schultz</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Whitaker</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Hariharan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mukamel</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rajagopal</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nery</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Urich</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sejnowski</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ecker</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>Human body epigenome maps reveal noncanonical DNA methylation variation</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>523</volume>
        <issue>7559</issue>
        <fpage>212</fpage>
        <lpage>6</lpage>
        <?supplied-pmid 26030523?>
        <pub-id pub-id-type="pmid">26030523</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jühling</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kretzmer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bernhart</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Otto</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Hoffmann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>metilene: Fast and sensitive calling of differentially methylated regions from bisulfite sequencing data</article-title>
        <source>Genome Res</source>
        <year>2016</year>
        <volume>26</volume>
        <issue>2</issue>
        <fpage>256</fpage>
        <lpage>62</lpage>
        <?supplied-pmid 26631489?>
        <pub-id pub-id-type="pmid">26631489</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taudt</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Roquis</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Vidalis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wardenaar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Johannes</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Colomé-Tatché</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>METHimpute: imputation-guided construction of complete methylomes from WGBS data</article-title>
        <source>BMC Genomics</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="pmid">29291715</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kapourani</surname>
            <given-names>C-A</given-names>
          </name>
          <name>
            <surname>Sanguinetti</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Melissa: Bayesian clustering and imputation of single-cell methylomes</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="pmid">30606230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Angermueller</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Reik</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>DeepCpG: accurate prediction of single-cell DNA methylation states using deep learning</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="pmid">28077169</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>SCRABBLE: single-cell RNA-seq imputation constrained by bulk RNA-seq data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>88</fpage>
        <?supplied-pmid 31060596?>
        <pub-id pub-id-type="pmid">31060596</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Okonechnikov</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Conesa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>García-Alcalde</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Qualimap 2: advanced multi-sample quality control for high-throughput sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>2</issue>
        <fpage>292</fpage>
        <lpage>4</lpage>
        <?supplied-pmid 26428292?>
        <pub-id pub-id-type="pmid">26428292</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patel</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>NGS QC Toolkit: a toolkit for quality control of next generation sequencing data</article-title>
        <source>PLOS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>2</issue>
        <fpage>30619</fpage>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolger</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lohse</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Usadel</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Trimmomatic: a flexible trimmer for illumina sequence data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>15</issue>
        <fpage>2114</fpage>
        <lpage>20</lpage>
        <?supplied-pmid 4103590?>
        <pub-id pub-id-type="pmid">24695404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cutadapt removes adapter sequences from high-throughput sequencing reads</article-title>
        <source>EMBnet. journal</source>
        <year>2011</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>10</fpage>
        <lpage>2</lpage>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Fiziev</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cokus</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>MQ</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>P-Y</given-names>
          </name>
          <name>
            <surname>Pellegrini</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>BS-Seeker2: a versatile aligning pipeline for bisulfite sequencing data</article-title>
        <source>BMC Genomics</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>774</fpage>
        <?supplied-pmid 24206606?>
        <pub-id pub-id-type="pmid">24206606</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>KYY</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y-J</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>P-Y</given-names>
          </name>
        </person-group>
        <article-title>Bs-Seeker3: ultrafast pipeline for bisulfite sequencing</article-title>
        <source>BMC Bioinformatics</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>111</fpage>
        <?supplied-pmid 29614954?>
        <pub-id pub-id-type="pmid">29614954</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krueger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Bismark: a flexible aligner and methylation caller for Bisulfite-Seq applications</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>11</issue>
        <fpage>1571</fpage>
        <lpage>2</lpage>
        <?supplied-pmid 21493656?>
        <pub-id pub-id-type="pmid">21493656</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>BSMAP: whole genome bisulfite sequence MAPping program</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">19118496</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harris</surname>
            <given-names>EY</given-names>
          </name>
          <name>
            <surname>Ounit</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lonardi</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>BRAT-nova: fast and accurate mapping of bisulfite-treated reads</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>17</issue>
        <fpage>2696</fpage>
        <lpage>8</lpage>
        <?supplied-pmid 27153660?>
        <pub-id pub-id-type="pmid">27153660</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soe</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chae</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>BiSpark: a Spark-based highly scalable aligner for bisulfite sequencing data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">29291722</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>WALT: fast and accurate read mapping for bisulfite sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>22</issue>
        <fpage>3507</fpage>
        <lpage>9</lpage>
        <?supplied-pmid 27466624?>
        <pub-id pub-id-type="pmid">27466624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Otto</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Hoffmann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Lacking alignments? the next-generation sequencing mapper segemehl revisited</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>13</issue>
        <fpage>1837</fpage>
        <lpage>43</lpage>
        <?supplied-pmid 24626854?>
        <pub-id pub-id-type="pmid">24626854</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ewels</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Peltzer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fillinger</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Alneberg</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Garcia</surname>
            <given-names>MU</given-names>
          </name>
          <name>
            <surname>Di Tommaso</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Nahnsen</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The nf-core framework for community-curated bioinformatics pipelines</article-title>
        <source>Nat Biotechnol</source>
        <year>2020</year>
        <volume>38</volume>
        <issue>3</issue>
        <fpage>276</fpage>
        <lpage>8</lpage>
        <?supplied-pmid 32055031?>
        <pub-id pub-id-type="pmid">32055031</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <mixed-citation publication-type="other">Merkel A, Fernández-Callejo M, Casals E, Marco-Sola S, Schuyler R, Gut IG, Heath SC. gemBS: high throughput processing for DNA methylation data from bisulfite sequencing. Bioinformatics. 2018; 35(5):737–42. https://doi.org/10.1093/bioinformatics/bty690, <ext-link ext-link-type="uri" xlink:href="https://doi.org/oup.prod.sis.lan/bioinformatics/article-pdf/35/5/737/27994742/bty690.pdf">https://doi.org/oup.prod.sis.lan/bioinformatics/article-pdf/35/5/737/27994742/bty690.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <mixed-citation publication-type="other">Graña O, López-Fernández H, Fdez-Riverola F, González Pisano D, Glez-Peña D. Bicycle: a bioinformatics pipeline to analyze bisulfite sequencing data. Bioinformatics. 2017; 34(8):1414–5. https://doi.org/10.1093/bioinformatics/btx778, <ext-link ext-link-type="uri" xlink:href="https://doi.org/oup.prod.sis.lan/bioinformatics/article-pdf/34/8/1414/25119980/btx778.pdf">https://doi.org/oup.prod.sis.lan/bioinformatics/article-pdf/34/8/1414/25119980/btx778.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di Tommaso</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chatzou</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Floden</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Barja</surname>
            <given-names>PP</given-names>
          </name>
          <name>
            <surname>Palumbo</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Nextflow enables reproducible computational workflows</article-title>
        <source>Nature Biotechnol</source>
        <year>2017</year>
        <volume>35</volume>
        <issue>4</issue>
        <fpage>316</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">28398311</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chatterjee</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stockwell</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Rodger</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Morison</surname>
            <given-names>IM</given-names>
          </name>
        </person-group>
        <article-title>Comparison of alignment software for genome-wide bisulphite sequence data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>10</issue>
        <fpage>79</fpage>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Omony</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nussbaumer</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gutzat</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>DNA methylation analysis in plants: review of computational tools and future perspectives</article-title>
        <source>Brief Bioinform</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>3</issue>
        <fpage>906</fpage>
        <lpage>18</lpage>
        <?supplied-pmid 31220217?>
        <pub-id pub-id-type="pmid">31220217</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Skinner</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Uzilov</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>Mungall</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>IH</given-names>
          </name>
        </person-group>
        <article-title>Jbrowse: a next-generation genome browser</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <issue>9</issue>
        <fpage>1630</fpage>
        <lpage>8</lpage>
        <?supplied-pmid 19570905?>
        <pub-id pub-id-type="pmid">19570905</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
