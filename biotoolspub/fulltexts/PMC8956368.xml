<?DTDIdentifier.IdentifierValue -//IEEE//DTD IEEE Journals JATS-based DTD v1.7//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journals.dtd?>
<?SourceDTD.Version 1-7?>
<?ConverterInfo.XSLTName ieee2jats3.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">IEEE/ACM Trans Comput Biol Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">IEEE/ACM Trans Comput Biol Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">0065500</journal-id>
    <journal-id journal-id-type="publisher-id">TCBB</journal-id>
    <journal-id journal-id-type="coden">ITCBCY</journal-id>
    <journal-title-group>
      <journal-title>Ieee/Acm Transactions on Computational Biology and Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1545-5963</issn>
    <issn pub-type="epub">1557-9964</issn>
    <publisher>
      <publisher-name>IEEE</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8956368</article-id>
    <article-id pub-id-type="pmid">34255632</article-id>
    <article-id pub-id-type="doi">10.1109/TCBB.2021.3096455</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TNet: Transmission Network Inference Using Within-Host Strain Diversity and its Application to Geographical Tracking of COVID-19 Spread</article-title>
    </title-group>
    <contrib-group>
      <contrib id="contrib1" contrib-type="author">
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-1782-3703</contrib-id>
        <name-alternatives>
          <name content-type="display">
            <surname>Dhar</surname>
            <given-names>Saurav</given-names>
          </name>
          <name content-type="index">
            <surname>Dhar</surname>
            <given-names>Saurav</given-names>
          </name>
        </name-alternatives>
        <xref rid="aff1" ref-type="aff"/>
        <xref rid="bio1" ref-type="bio"/>
        <email>saurav.dhar@uconn.edu</email>
      </contrib>
      <contrib id="contrib2" contrib-type="author">
        <name-alternatives>
          <name content-type="display">
            <surname>Zhang</surname>
            <given-names>Chengchen</given-names>
          </name>
          <name content-type="index">
            <surname>Zhang</surname>
            <given-names>Chengchen</given-names>
          </name>
        </name-alternatives>
        <xref rid="aff1" ref-type="aff"/>
        <xref rid="bio2" ref-type="bio"/>
        <email>chengchen.zhang@uconn.edu</email>
      </contrib>
      <contrib id="contrib3" contrib-type="author">
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-4818-0237</contrib-id>
        <name-alternatives>
          <name content-type="display">
            <surname>Măndoiu</surname>
            <given-names>Ion I.</given-names>
          </name>
          <name content-type="index">
            <surname>Mandoiu</surname>
            <given-names>Ion I.</given-names>
          </name>
        </name-alternatives>
        <xref rid="aff1" ref-type="aff"/>
        <xref rid="bio3" ref-type="bio"/>
        <email>ion.mandoiu@uconn.edu</email>
      </contrib>
      <contrib id="contrib4" contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-0039-2596</contrib-id>
        <name-alternatives>
          <name content-type="display">
            <surname>Bansal</surname>
            <given-names>Mukul S.</given-names>
          </name>
          <name content-type="index">
            <surname>Bansal</surname>
            <given-names>Mukul S.</given-names>
          </name>
        </name-alternatives>
        <xref rid="aff1" ref-type="aff"/>
        <xref rid="bio4" ref-type="bio"/>
        <email>mukul.bansal@uconn.edu</email>
      </contrib>
      <author-comment>
        <p>(Corresponding author: Mukul S. Bansal.)</p>
      </author-comment>
    </contrib-group>
    <aff id="aff1">
      <institution-wrap>
        <institution content-type="division">Department of Computer Science &amp; Engineering</institution>
        <institution content-type="institution">University of Connecticut</institution>
      </institution-wrap>
      <city>Storrs</city>
      <state>CT</state>
      <postal-code>06269</postal-code>
      <country>USA</country>
    </aff>
    <pub-date pub-type="collection" iso-8601-date="2022-01">
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-07-13">
      <day>13</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <volume>19</volume>
    <issue>1</issue>
    <fpage>230</fpage>
    <lpage>242</lpage>
    <history>
      <date date-type="received" iso-8601-date="2020-12-06">
        <day>06</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd" iso-8601-date="2021-07-03">
        <day>03</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="accepted" iso-8601-date="2021-07-08">
        <day>08</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="currentversion" iso-8601-date="2022-02-03">
        <day>03</day>
        <month>2</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-year>2021</copyright-year>
      <copyright-holder content-type="IEEE">IEEE</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/">https://www.ieee.org/publications/rights/index.html</ali:license_ref>
        <license-p>Personal use is permitted, but republication/redistribution requires IEEE permission.
See <ext-link ext-link-type="uri" xlink:href="https://www.ieee.org/publications/rights/index.html">https://www.ieee.org/publications/rights/index.html</ext-link> for more information.</license-p>
      </license>
      <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" content-type="COVID-19" end_date="2099-01-01" specific-use="promo" start_date="2021-07-29"/>
    </permissions>
    <self-uri content-type="xml">tcbb-bansal-3096455.xml</self-uri>
    <self-uri content-type="print">tcbb-bansal-3096455.pdf</self-uri>
    <self-uri content-type="online">tcbb-bansal-3096455.pdf</self-uri>
    <abstract>
      <p>The inference of disease transmission networks is an important problem in epidemiology. One popular approach for building transmission networks is to reconstruct a phylogenetic tree using sequences from disease strains sampled from infected hosts and infer transmissions based on this tree. However, most existing phylogenetic approaches for transmission network inference are highly computationally intensive and cannot take within-host strain diversity into account. Here, we introduce a new phylogenetic approach for inferring transmission networks, <italic>TNet</italic>, that addresses these limitations. TNet uses multiple strain sequences from each sampled host to infer transmissions and is simpler and more accurate than existing approaches. Furthermore, TNet is highly scalable and able to distinguish between ambiguous and unambiguous transmission inferences. We evaluated TNet on a large collection of 560 simulated transmission networks of various sizes and diverse host, sequence, and transmission characteristics, as well as on 10 real transmission datasets with known transmission histories. Our results show that TNet outperforms two other recently developed methods, phyloscanner and SharpTNI, that also consider within-host strain diversity. We also applied TNet to a large collection of SARS-CoV-2 genomes sampled from infected individuals in many countries around the world, demonstrating how our inference framework can be adapted to accurately infer geographical transmission networks. TNet is freely available from <uri xlink:href="https://compbio.engr.uconn.edu/software/TNet/">https://compbio.engr.uconn.edu/software/TNet/</uri>.</p>
    </abstract>
    <kwd-group kwd-group-type="AuthorFree">
      <kwd>Disease transmission networks</kwd>
      <kwd>epidemiology</kwd>
      <kwd>algorithms</kwd>
      <kwd>HCV</kwd>
      <kwd>COVID-19</kwd>
      <kwd>geographical transmission networks</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution content-type="institution">National Science Foundation</institution>
            <institution-id institution-id-type="fundref">10.13039/100000001</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>CCF 1618347</award-id>
      </award-group>
      <funding-statement>This work was supported in part by U.S National Science Foundation (NSF) Award CCF 1618347 to IM and MSB.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="12"/>
      <table-count count="1"/>
      <ref-count count="37"/>
      <page-count count="13"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <label>1</label>
    <title>Introduction</title>
    <p>The accurate inference of disease transmission networks is fundamental to understanding and containing the spread of infectious diseases <xref rid="ref3" ref-type="bibr">[3]</xref>, <xref rid="ref16" ref-type="bibr">[16]</xref>, <xref rid="ref27" ref-type="bibr">[27]</xref>. A key challenge with inferring transmission networks, particularly those of rapidly evolving RNA and retroviruses <xref rid="ref11" ref-type="bibr">[11]</xref>, is that they exist in the host as “clouds” of closely related sequences. These variants are referred to as <italic>quasispecies</italic>
<xref rid="ref8" ref-type="bibr">[8]</xref>, <xref rid="ref9" ref-type="bibr">[9]</xref>, <xref rid="ref23" ref-type="bibr">[23]</xref>, <xref rid="ref24" ref-type="bibr">[24]</xref>, <xref rid="ref36" ref-type="bibr">[36]</xref>, and the resulting genetic diversity of the strains circulating within a host has important implications for efficiency of transmission, disease progression, drug/vaccine resistance, etc. <xref rid="ref2" ref-type="bibr">[2]</xref>, <xref rid="ref10" ref-type="bibr">[10]</xref>, <xref rid="ref14" ref-type="bibr">[14]</xref>, <xref rid="ref19" ref-type="bibr">[19]</xref>, <xref rid="ref26" ref-type="bibr">[26]</xref>. The availability of quasispecies, or sequences from multiple strains per infected host, also has direct relevance for inferring transmission networks and has the potential to make such inference easier and far more accurate <xref rid="ref33" ref-type="bibr">[33]</xref>, <xref rid="ref37" ref-type="bibr">[37]</xref>. Yet, while the advent of next-generation sequencing technologies has revolutionized the study of quasispecies, most existing transmission network inference methods are unable to make use of multiple distinct strain sequences per host.</p>
    <p>Existing methods for inferring transmission networks can be classified into two categories: Those based on constructing and analyzing sequence similarity or relatedness graphs, and those based on constructing and analyzing phylogenetic trees for the infecting strains. Many methods based on sequence similarity or relatedness graph analysis exist and several recently developed methods in this category are also able to take into account multiple distinct strain sequences per host <xref rid="ref15" ref-type="bibr">[15]</xref>, <xref rid="ref22" ref-type="bibr">[22]</xref>, <xref rid="ref32" ref-type="bibr">[32]</xref>. However, similarity/relatedness based methods can suffer from a lack of resolution and are often unable to infer transmission directions or complete transmission histories. Phylogeny-based methods <xref rid="ref7" ref-type="bibr">[7]</xref>, <xref rid="ref18" ref-type="bibr">[18]</xref>, <xref rid="ref21" ref-type="bibr">[21]</xref>, <xref rid="ref27" ref-type="bibr">[27]</xref>, <xref rid="ref37" ref-type="bibr">[37]</xref> attempt to overcome these limitations by constructing and analyzing phylogenies of the infecting strains. We refer to these strain phylogenies as <italic>transmission phylogenies</italic>. These phylogeny-based methods infer transmission networks by computing a host assignment for each node of the transmission phylogeny, where this phylogeny is either first constructed independently or is co-estimated along with the host assignment. Leaves of the transmission phylogeny are labelled by the host from which they are sampled, and an ancestral host assignment is then inferred for each node/edge of the phylogeny. This ancestral host assignment defines the transmission network, where a transmission event is inferred along any edge connecting two nodes labeled with different hosts. If the phylogeny is rooted then the direction of transmission is also easily inferred. This is illustrated in <xref rid="fig1" ref-type="fig">Fig. 1</xref>.</p>
    <fig position="float" id="fig1">
      <label>Fig. 1.</label>
      <caption>
        <p><italic>Phylogeny-based transmission network inference.</italic> The figure shows a simple example with three infected individuals <inline-formula><tex-math notation="LaTeX" id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$A$\end{document}</tex-math><alternatives><mml:math id="M2"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq1-3096455.jpg"/></alternatives></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$B$\end{document}</tex-math><alternatives><mml:math id="M4"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq2-3096455.jpg"/></alternatives></inline-formula>, and <inline-formula><tex-math notation="LaTeX" id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C$\end{document}</tex-math><alternatives><mml:math id="M6"><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq3-3096455.jpg"/></alternatives></inline-formula>, represented here by the three different colors, where <inline-formula><tex-math notation="LaTeX" id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$A$\end{document}</tex-math><alternatives><mml:math id="M8"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq4-3096455.jpg"/></alternatives></inline-formula> has three viral variants while <inline-formula><tex-math notation="LaTeX" id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$B$\end{document}</tex-math><alternatives><mml:math id="M10"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq5-3096455.jpg"/></alternatives></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C$\end{document}</tex-math><alternatives><mml:math id="M12"><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq6-3096455.jpg"/></alternatives></inline-formula> have two each. The tree on the left depicts the transmission phylogeny for the seven sampled strains, with each of these strains colored by the host from which it was sampled. The tree in the middle shows a hypothetical assignment of hosts to ancestral nodes of the transmission phylogeny. This ancestral host assignment can then be used to infer the transmission network shown on the right, with <inline-formula><tex-math notation="LaTeX" id="M13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$A$\end{document}</tex-math><alternatives><mml:math id="M14"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq7-3096455.jpg"/></alternatives></inline-formula> responsible for transmission to both <inline-formula><tex-math notation="LaTeX" id="M15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$B$\end{document}</tex-math><alternatives><mml:math id="M16"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq8-3096455.jpg"/></alternatives></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="M17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C$\end{document}</tex-math><alternatives><mml:math id="M18"><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq9-3096455.jpg"/></alternatives></inline-formula>.</p>
      </caption>
      <graphic xlink:href="bansa1-3096455" position="float"/>
    </fig>
    <p>Several sophisticated phylogeny-based methods have been developed over the last few years. These include BEASTlier <xref rid="ref18" ref-type="bibr">[18]</xref>, SCOTTI <xref rid="ref5" ref-type="bibr">[5]</xref>, phybreak <xref rid="ref21" ref-type="bibr">[21]</xref>, TransPhylo <xref rid="ref7" ref-type="bibr">[7]</xref>, phyloscanner <xref rid="ref37" ref-type="bibr">[37]</xref>, Nextstrain/Augur <xref rid="ref17" ref-type="bibr">[17]</xref>, and BadTrIP <xref rid="ref4" ref-type="bibr">[4]</xref>. Among these, only SCOTTI <xref rid="ref5" ref-type="bibr">[5]</xref>, BadTrIP <xref rid="ref4" ref-type="bibr">[4]</xref>, and phyloscanner <xref rid="ref37" ref-type="bibr">[37]</xref> can explicitly consider multiple strain sequences per host. BEASTlier <xref rid="ref18" ref-type="bibr">[18]</xref> also allows for the presence of multiple sequences per host, but requires that all sequences from the same host be clustered together on the phylogeny, a precondition that is often violated in practice. Among the methods that explicitly consider multiple strain sequences per host, SCOTTI, BadTrIP, and BEASTlier are model-based and highly computationally intensive, relying on the use of Markov Chain Monte Carlo (MCMC) algorithms for inference. These methods also require several difficult-to-estimate epidemiological parameters, such as infection times, and make several strong assumptions about pathogen evolution and the underlying transmission network. Thus, phyloscanner<xref rid="ref37" ref-type="bibr">[37]</xref> is the only previous method that is able to take advantage of multiple sequences per host and that is also computationally efficient, easy to use, and scalable to large datasets.</p>
    <p>In this work, we introduce a new phylogenetic approach, TNet, for inferring transmission networks. TNet uses multiple strain sequences from each sampled host to infer transmissions and is simpler and more accurate than existing approaches. TNet uses an extended version of the classical Sankoff algorithm <xref rid="ref29" ref-type="bibr">[29]</xref> from the phylogenetics literature for ancestral host assignment, where the extension makes it possible to efficiently compute support values for individual transmission edges based on a sampling of optimal host assignments where the number of back-transmissions (or reinfections by descendant disease strains) is minimized. TNet is parameter-free and highly scalable and can be easily applied within seconds to datasets with hundreds of strain sequences and hosts. In recent independent work, Sashittal <italic>et al.</italic>
<xref rid="ref30" ref-type="bibr">[30]</xref> developed a new method called SharpTNI that is based on similar ideas to TNet. SharpTNI is based on an NP-hard problem formulation that seeks to find parsimonious ancestral host assignments minimizing the number of co-transmissions <xref rid="ref30" ref-type="bibr">[30]</xref>. The authors provide an efficient heuristic for this problem that is based on uniform sampling of parsimonious ancestral host assignments (not necessarily minimizing co-transmissions) and subsequently filtering them to only keep those assignments among the samples that minimize co-transmissions <xref rid="ref30" ref-type="bibr">[30]</xref>. Thus, both TNet and SharpTNI are based on the idea of parsimonious ancestral host assignments and on aggregating across the diversity of possible solutions obtained through some kind of sampling of optimal solutions. The primary distinction between the two methods is the strategy employed for sampling of the optimal solutions, with SharpTNI minimizing co-transmissions and TNet minimizing back-transmissions.</p>
    <p>We evaluated TNet, SharpTNI, and phyloscanner on a large collection of 560 simulated transmission networks of various sizes and representing a wide range of host, sequence, and transmission characteristics, as well as on 10 real transmission datasets with known transmission histories. We found that both TNet and SharpTNI significantly outperformed phyloscanner under all tested conditions and all datasets, yielding more accurate transmission networks for both simulated and real datasets. Between TNet and SharpTNI, we found that both methods performed similarly on the real datasets but that TNet clearly showed better accuracy on the simulated datasets. Furthermore, we show how our transmission network inference framework can be adapted to infer disease transmission across geographical regions, with different countries or geographical regions acting as “hosts”. To demonstrate the feasibility and evaluate the performance of our framework in this setting, we applied our method to a large collection of SARS-CoV-2 genomes sampled from infected individuals in many countries around the world and inferred the international COVID-19 transmission network. Using available epidemiological ground truth data, we found that the COVID-19 transmission network inferred using our framework was significantly more accurate than the corresponding network inferred by the popular Nextstrain tool <xref rid="ref17" ref-type="bibr">[17]</xref>. SharpTNI could not be applied to this large COVID-19 dataset due to lack of scalability (manifested as runtime errors). TNet is freely available open-source from <uri xlink:href="https://compbio.engr.uconn.edu/software/TNet/">https://compbio.engr.uconn.edu/software/TNet/</uri>.</p>
    <p>A preliminary version of this work appeared in the proceedings of ISBRA 2020 <xref rid="ref6" ref-type="bibr">[6]</xref>. The current manuscript substantially expands upon the preliminary version and includes many additional technical and algorithmic details, several additional figures/tables to better explain the algorithm and results, and more detailed analysis of experimental results. Importantly, we also newly demonstrate how our inference framework can be adapted to infer disease transmission across geographical regions, and apply our method to a large collection of SARS-CoV-2 genomes sampled from infected individuals in many countries around the world to infer the global COVID-19 transmission network as well as a US state-level transmission network (<xref rid="sec6" ref-type="sec">Section 6</xref>).</p>
    <p>The remainder of this manuscript is organized as follows. The next section provides basic definitions and preliminaries. <xref rid="sec3" ref-type="sec">Section 3</xref> describes our core algorithmic framework. <xref rid="sec4" ref-type="sec">Section 4</xref> describes the simulated datasets, real HCV dataset, and experimental methodology. Experimental results appear in <xref rid="sec5" ref-type="sec">Section 5</xref>. <xref rid="sec6" ref-type="sec">Section 6</xref> describes the application of our method to large-scale COVID-19 data and includes the results of this analysis. <xref rid="sec7" ref-type="sec">Section 7</xref> gives concluding remarks.</p>
  </sec>
  <sec id="sec2">
    <label>2</label>
    <title>Basic Definitions and Preliminaries</title>
    <p>Given a rooted tree <inline-formula><tex-math notation="LaTeX" id="M19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M20"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq10-3096455.jpg"/></alternatives></inline-formula>, we denote its node set, edge set, and leaf set by <inline-formula><tex-math notation="LaTeX" id="M21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$V(T)$\end{document}</tex-math><alternatives><mml:math id="M22"><mml:mrow><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq11-3096455.jpg"/></alternatives></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="M23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$E(T)$\end{document}</tex-math><alternatives><mml:math id="M24"><mml:mrow><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq12-3096455.jpg"/></alternatives></inline-formula>, and <inline-formula><tex-math notation="LaTeX" id="M25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${Le}(T)$\end{document}</tex-math><alternatives><mml:math id="M26"><mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq13-3096455.jpg"/></alternatives></inline-formula> respectively. The root node of <inline-formula><tex-math notation="LaTeX" id="M27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M28"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq14-3096455.jpg"/></alternatives></inline-formula> is denoted by <inline-formula><tex-math notation="LaTeX" id="M29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${rt}(T)$\end{document}</tex-math><alternatives><mml:math id="M30"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq15-3096455.jpg"/></alternatives></inline-formula>, the parent of a node <inline-formula><tex-math notation="LaTeX" id="M31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v \in V(T)$\end{document}</tex-math><alternatives><mml:math id="M32"><mml:mrow><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq16-3096455.jpg"/></alternatives></inline-formula> by <inline-formula><tex-math notation="LaTeX" id="M33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${pa}_T(v)$\end{document}</tex-math><alternatives><mml:math id="M34"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq17-3096455.jpg"/></alternatives></inline-formula>, its set of children by <inline-formula><tex-math notation="LaTeX" id="M35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${Ch}_T(v)$\end{document}</tex-math><alternatives><mml:math id="M36"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq18-3096455.jpg"/></alternatives></inline-formula>, and the (maximal) subtree of <inline-formula><tex-math notation="LaTeX" id="M37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M38"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq19-3096455.jpg"/></alternatives></inline-formula> rooted at <inline-formula><tex-math notation="LaTeX" id="M39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v$\end{document}</tex-math><alternatives><mml:math id="M40"><mml:mi>v</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq20-3096455.jpg"/></alternatives></inline-formula> by <inline-formula><tex-math notation="LaTeX" id="M41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T(v)$\end{document}</tex-math><alternatives><mml:math id="M42"><mml:mrow><mml:mi>T</mml:mi><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq21-3096455.jpg"/></alternatives></inline-formula>. The set of <italic>internal nodes</italic> of <inline-formula><tex-math notation="LaTeX" id="M43">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M44"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq22-3096455.jpg"/></alternatives></inline-formula>, denoted <inline-formula><tex-math notation="LaTeX" id="M45">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$I(T)$\end{document}</tex-math><alternatives><mml:math id="M46"><mml:mrow><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq23-3096455.jpg"/></alternatives></inline-formula>, is defined to be <inline-formula><tex-math notation="LaTeX" id="M47">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$V(T) \setminus {Le}(T)$\end{document}</tex-math><alternatives><mml:math id="M48"><mml:mrow><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>∖</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq24-3096455.jpg"/></alternatives></inline-formula>. A rooted tree is <italic>binary</italic> if all of its internal nodes have exactly two children. In this work, the term <italic>tree</italic> refers to a rooted binary tree.</p>
    <sec id="sec2.1">
      <label>2.1</label>
      <title>Problem Formulation</title>
      <p>Let <inline-formula><tex-math notation="LaTeX" id="M49">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M50"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq25-3096455.jpg"/></alternatives></inline-formula> denote the transmission phylogeny constructed from the genetic sequences of the infecting strains (i.e., pathogens) sampled from the infected hosts under consideration. Note that such trees can be easily constructed using standard phylogenetic methods such as RAxML <xref rid="ref34" ref-type="bibr">[34]</xref>. These trees can also be rooted relatively accurately using either standard phylogenetic rooting techniques or by using a related sequence from a previous outbreak of the same disease as an outgroup. Let <inline-formula><tex-math notation="LaTeX" id="M51">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$H = \lbrace h_1, h_2, \ldots, h_n\rbrace$\end{document}</tex-math><alternatives><mml:math id="M52"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>...</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq26-3096455.jpg"/></alternatives></inline-formula> denote the set of <inline-formula><tex-math notation="LaTeX" id="M53">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n$\end{document}</tex-math><alternatives><mml:math id="M54"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq27-3096455.jpg"/></alternatives></inline-formula> hosts under consideration. We assume that each leaf of <inline-formula><tex-math notation="LaTeX" id="M55">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M56"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq28-3096455.jpg"/></alternatives></inline-formula> is labeled with the host from <inline-formula><tex-math notation="LaTeX" id="M57">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$H$\end{document}</tex-math><alternatives><mml:math id="M58"><mml:mi>H</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq29-3096455.jpg"/></alternatives></inline-formula> from which the corresponding strain sequence was obtained. <xref rid="fig1" ref-type="fig">Fig. 1</xref> shows an example of such a tree and its leaf labeling, where the labeling is depicted using the different colors.</p>
      <p>Observe that each internal node of <inline-formula><tex-math notation="LaTeX" id="M59">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M60"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq30-3096455.jpg"/></alternatives></inline-formula> represents an ancestral strain sequence that existed in some infected host. Moreover, each internal node (or bifurcation) represents either intra-host diversification and evolution of that ancestral strain or a transmission event where that ancestral strain is transmitted from one host to another along one of the child edges. Thus, each node of <inline-formula><tex-math notation="LaTeX" id="M61">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M62"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq31-3096455.jpg"/></alternatives></inline-formula> is associated with an infected host. Given <inline-formula><tex-math notation="LaTeX" id="M63">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t \in V(T)$\end{document}</tex-math><alternatives><mml:math id="M64"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq32-3096455.jpg"/></alternatives></inline-formula>, we denote the host associated with node <inline-formula><tex-math notation="LaTeX" id="M65">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t$\end{document}</tex-math><alternatives><mml:math id="M66"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq33-3096455.jpg"/></alternatives></inline-formula> by <inline-formula><tex-math notation="LaTeX" id="M67">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h(t)$\end{document}</tex-math><alternatives><mml:math id="M68"><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq34-3096455.jpg"/></alternatives></inline-formula>. Note that internal nodes may represent strains from hosts that do not appear in <inline-formula><tex-math notation="LaTeX" id="M69">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$H$\end{document}</tex-math><alternatives><mml:math id="M70"><mml:mi>H</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq35-3096455.jpg"/></alternatives></inline-formula>, i.e., strains from unsampled hosts, and so there may be <inline-formula><tex-math notation="LaTeX" id="M71">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t \in I(T)$\end{document}</tex-math><alternatives><mml:math id="M72"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq36-3096455.jpg"/></alternatives></inline-formula> for which <inline-formula><tex-math notation="LaTeX" id="M73">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h(t) \not\in H$\end{document}</tex-math><alternatives><mml:math id="M74"><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>∉</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq37-3096455.jpg"/></alternatives></inline-formula>. Given an ancestral host assignment for <inline-formula><tex-math notation="LaTeX" id="M75">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M76"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq38-3096455.jpg"/></alternatives></inline-formula>, i.e., given <inline-formula><tex-math notation="LaTeX" id="M77">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h(t)$\end{document}</tex-math><alternatives><mml:math id="M78"><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq39-3096455.jpg"/></alternatives></inline-formula> for each <inline-formula><tex-math notation="LaTeX" id="M79">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t \in I(T)$\end{document}</tex-math><alternatives><mml:math id="M80"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq40-3096455.jpg"/></alternatives></inline-formula>, the implied transmission network can be easily inferred as follows: A transmission edge is inferred from host <inline-formula><tex-math notation="LaTeX" id="M81">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$x$\end{document}</tex-math><alternatives><mml:math id="M82"><mml:mi>x</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq41-3096455.jpg"/></alternatives></inline-formula> to host <inline-formula><tex-math notation="LaTeX" id="M83">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$y$\end{document}</tex-math><alternatives><mml:math id="M84"><mml:mi>y</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq42-3096455.jpg"/></alternatives></inline-formula> if there is an edge <inline-formula><tex-math notation="LaTeX" id="M85">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$({pa}(t), t) \in E(T)$\end{document}</tex-math><alternatives><mml:math id="M86"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq43-3096455.jpg"/></alternatives></inline-formula>, where <inline-formula><tex-math notation="LaTeX" id="M87">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h({pa}(t)) = x$\end{document}</tex-math><alternatives><mml:math id="M88"><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq44-3096455.jpg"/></alternatives></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="M89">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h(t) = y$\end{document}</tex-math><alternatives><mml:math id="M90"><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq45-3096455.jpg"/></alternatives></inline-formula>. Note that each transmission edge in the reconstructed transmission network may represent either direct transmission or indirect transmission through one or more unsampled hosts. Thus, to reconstruct transmission networks it suffices to compute <inline-formula><tex-math notation="LaTeX" id="M91">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h(t)$\end{document}</tex-math><alternatives><mml:math id="M92"><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq46-3096455.jpg"/></alternatives></inline-formula> for each <inline-formula><tex-math notation="LaTeX" id="M93">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t \in I(T)$\end{document}</tex-math><alternatives><mml:math id="M94"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq47-3096455.jpg"/></alternatives></inline-formula>.</p>
      <p>TNet (along with SharpTNI) is based on finding ancestral host assignments that minimize the number of inter-host transmission events on <inline-formula><tex-math notation="LaTeX" id="M95">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M96"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq48-3096455.jpg"/></alternatives></inline-formula>. The utility of such parsimonious ancestral host assignment for transmission network inference when multiple strain sequences per host are available was first systematically demonstrated by Romero-Severson <italic>et al.</italic>
<xref rid="ref27" ref-type="bibr">[27]</xref> and later developed further by Wymant <italic>et al.</italic>
<xref rid="ref37" ref-type="bibr">[37]</xref> in their phyloscanner method. The basic computational problem under this formulation can be stated as follows:</p>
      <statement content-type="other" id="other1">
        <title>Problem 1 (Optimal ancestral host assignment).</title>
        <p>Given a transmission phylogeny <inline-formula><tex-math notation="LaTeX" id="M97">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M98"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq49-3096455.jpg"/></alternatives></inline-formula> on strain sequences sampled from a set <inline-formula><tex-math notation="LaTeX" id="M99">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$H = \lbrace h_1, h_2, \ldots, h_n\rbrace$\end{document}</tex-math><alternatives><mml:math id="M100"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>...</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq50-3096455.jpg"/></alternatives></inline-formula> of <inline-formula><tex-math notation="LaTeX" id="M101">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n$\end{document}</tex-math><alternatives><mml:math id="M102"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq51-3096455.jpg"/></alternatives></inline-formula> infected hosts, compute <inline-formula><tex-math notation="LaTeX" id="M103">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h(t)$\end{document}</tex-math><alternatives><mml:math id="M104"><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq52-3096455.jpg"/></alternatives></inline-formula> for each <inline-formula><tex-math notation="LaTeX" id="M105">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t \in I(T)$\end{document}</tex-math><alternatives><mml:math id="M106"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq53-3096455.jpg"/></alternatives></inline-formula> such that the number of edges <inline-formula><tex-math notation="LaTeX" id="M107">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(t^{\prime }, t^{\prime \prime }) \in E$\end{document}</tex-math><alternatives><mml:math id="M108"><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq54-3096455.jpg"/></alternatives></inline-formula> for which <inline-formula><tex-math notation="LaTeX" id="M109">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h(t^{\prime }) \ne h(t^{\prime \prime })$\end{document}</tex-math><alternatives><mml:math id="M110"><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>≠</mml:mo><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq55-3096455.jpg"/></alternatives></inline-formula> is minimized.</p>
      </statement>
      <p>Problem <xref rid="other1" ref-type="statement">1</xref> is equivalent to the well-known small parsimony problem in phylogenetics and can be solved efficiently using the classical Fitch <xref rid="ref13" ref-type="bibr">[13]</xref> and Sankoff <xref rid="ref29" ref-type="bibr">[29]</xref> algorithms. In TNet, we solve a modified version of the problem above that considers all possible optimal ancestral host assignments and samples greedily among them to minimize the number of back-transmissions (or reinfections by descendant disease strains). To accomplish this goal efficiently, TNet uses an extended version of Sankoff's algorithm. For completeness, a brief description of Sankoff's algorithm appears below. We later show how to extend that algorithm to perform our special sampling.</p>
    </sec>
    <sec id="sec2.2">
      <label>2.2</label>
      <title>Computing an Optimal Ancestral Host Assignment</title>
      <p>Sankoff's algorithm uses a simple bottom-up dynamic programming approach. Given a node <inline-formula><tex-math notation="LaTeX" id="M111">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t \in V(T)$\end{document}</tex-math><alternatives><mml:math id="M112"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq56-3096455.jpg"/></alternatives></inline-formula> and a host <inline-formula><tex-math notation="LaTeX" id="M113">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h_i \in H$\end{document}</tex-math><alternatives><mml:math id="M114"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq57-3096455.jpg"/></alternatives></inline-formula>, we define the <italic>cost</italic>
<inline-formula><tex-math notation="LaTeX" id="M115">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C(t, h_i)$\end{document}</tex-math><alternatives><mml:math id="M116"><mml:mrow><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq58-3096455.jpg"/></alternatives></inline-formula> to be the minimum number of inter-host transmission events required on subtree <inline-formula><tex-math notation="LaTeX" id="M117">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T(t)$\end{document}</tex-math><alternatives><mml:math id="M118"><mml:mrow><mml:mi>T</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq59-3096455.jpg"/></alternatives></inline-formula> under the constraint that <inline-formula><tex-math notation="LaTeX" id="M119">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h(t) = h_i$\end{document}</tex-math><alternatives><mml:math id="M120"><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq60-3096455.jpg"/></alternatives></inline-formula>. Let <inline-formula><tex-math notation="LaTeX" id="M121">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C(t)$\end{document}</tex-math><alternatives><mml:math id="M122"><mml:mrow><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq61-3096455.jpg"/></alternatives></inline-formula> denote the vector <inline-formula><tex-math notation="LaTeX" id="M123">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\langle C(t, h_i), C(t, h_2), \ldots, C(t, h_n) \rangle$\end{document}</tex-math><alternatives><mml:math id="M124"><mml:mrow><mml:mo>〈</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>...</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq62-3096455.jpg"/></alternatives></inline-formula>. The Sankoff algorithm performs a post-order traversal of <inline-formula><tex-math notation="LaTeX" id="M125">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M126"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq63-3096455.jpg"/></alternatives></inline-formula> and computes <inline-formula><tex-math notation="LaTeX" id="M127">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C(t)$\end{document}</tex-math><alternatives><mml:math id="M128"><mml:mrow><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq64-3096455.jpg"/></alternatives></inline-formula> at each <inline-formula><tex-math notation="LaTeX" id="M129">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t \in V(T)$\end{document}</tex-math><alternatives><mml:math id="M130"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq65-3096455.jpg"/></alternatives></inline-formula> using the following recurrence relations.</p>
      <p>If <inline-formula><tex-math notation="LaTeX" id="M131">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t \in {Le}(T)$\end{document}</tex-math><alternatives><mml:math id="M132"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq66-3096455.jpg"/></alternatives></inline-formula>, then the dynamic programming table can be initialised as follows:
<disp-formula id="deqn1"><tex-math notation="LaTeX" id="M133">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}
\begin{equation*}
C(t, h_i)=\left\lbrace \begin{array}{ll}0, &amp; \text{if } h(t) = h_i, \\ 
\infty, &amp; \text{otherwise}. \end{array}\right. \tag{1}
\end{equation*}

\end{document}</tex-math><alternatives><mml:math id="M134"><mml:mrow><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4.pt"/><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>∞</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="bansal-eq1-3096455.jpg" position="anchor"/></alternatives></disp-formula></p>
      <p>If <inline-formula><tex-math notation="LaTeX" id="M135">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t \in I(T)$\end{document}</tex-math><alternatives><mml:math id="M136"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq67-3096455.jpg"/></alternatives></inline-formula>, and <inline-formula><tex-math notation="LaTeX" id="M137">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t^{\prime }$\end{document}</tex-math><alternatives><mml:math id="M138"><mml:msup><mml:mi>t</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq68-3096455.jpg"/></alternatives></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="M139">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t^{\prime \prime }$\end{document}</tex-math><alternatives><mml:math id="M140"><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq69-3096455.jpg"/></alternatives></inline-formula> denote the two children of <inline-formula><tex-math notation="LaTeX" id="M141">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t$\end{document}</tex-math><alternatives><mml:math id="M142"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq70-3096455.jpg"/></alternatives></inline-formula>, then
<disp-formula id="deqn2"><tex-math notation="LaTeX" id="M143">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}
\begin{equation*}
\begin{split} C(t, h_i) = &amp; \min _{j \in \lbrace 1, \ldots, n\rbrace } \left\lbrace C(t^{\prime }, h_j) + p(h_i, h_j) \right\rbrace \\ 
&amp; + \min _{j \in \lbrace 1, \ldots, n\rbrace } \left\lbrace C(t^{\prime \prime }, h_j) + p(h_i, h_j) \right\rbrace, \end{split} \tag{2}
\end{equation*}

\end{document}</tex-math><alternatives><mml:math id="M144"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo form="prefix" movablelimits="true">min</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>...</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mfenced close="}" open="{" separators=""><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:munder><mml:mo form="prefix" movablelimits="true">min</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>...</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mfenced close="}" open="{" separators=""><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="bansal-eq2-3096455.jpg" position="anchor"/></alternatives></disp-formula>
where <inline-formula><tex-math notation="LaTeX" id="M145">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$p(h_i, h_j) = 0$\end{document}</tex-math><alternatives><mml:math id="M146"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq71-3096455.jpg"/></alternatives></inline-formula> if <inline-formula><tex-math notation="LaTeX" id="M147">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$i = j$\end{document}</tex-math><alternatives><mml:math id="M148"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq72-3096455.jpg"/></alternatives></inline-formula>, and <inline-formula><tex-math notation="LaTeX" id="M149">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$p(h_i, h_j) = 1$\end{document}</tex-math><alternatives><mml:math id="M150"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq73-3096455.jpg"/></alternatives></inline-formula> if <inline-formula><tex-math notation="LaTeX" id="M151">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$i \ne j$\end{document}</tex-math><alternatives><mml:math id="M152"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq74-3096455.jpg"/></alternatives></inline-formula>.</p>
      <p>This recurrence relation is guaranteed to compute each cost <inline-formula><tex-math notation="LaTeX" id="M153">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C(t, h_i)$\end{document}</tex-math><alternatives><mml:math id="M154"><mml:mrow><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq75-3096455.jpg"/></alternatives></inline-formula> correctly (follows from the correctness of Sankoff's algorithm). The minimum number of inter-host transmission events required by any ancestral host assignment on <inline-formula><tex-math notation="LaTeX" id="M155">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M156"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq76-3096455.jpg"/></alternatives></inline-formula> is given by <inline-formula><tex-math notation="LaTeX" id="M157">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\min _i \lbrace C({rt}(T), h_i)\rbrace$\end{document}</tex-math><alternatives><mml:math id="M158"><mml:mrow><mml:msub><mml:mo form="prefix" movablelimits="true">min</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq77-3096455.jpg"/></alternatives></inline-formula>, and an actual optimal ancestral host assignment can be easily obtained by backtracking. We point out that the greedy algorithm of Fitch <xref rid="ref13" ref-type="bibr">[13]</xref> can also be used to compute minimum number of inter-host transmission events required by any ancestral host assignment on <inline-formula><tex-math notation="LaTeX" id="M159">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M160"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq78-3096455.jpg"/></alternatives></inline-formula>; however, Fitch's algorithm cannot be extended to keep track of all possible optimal ancestral host assignments. We therefore use (an extension of) Sankoff's algorithm as the basis for TNet.</p>
      <p>It is easy to see that the time complexity of the above algorithm is <inline-formula><tex-math notation="LaTeX" id="M161">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$O(mn^2)$\end{document}</tex-math><alternatives><mml:math id="M162"><mml:mrow><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq79-3096455.jpg"/></alternatives></inline-formula>, where <inline-formula><tex-math notation="LaTeX" id="M163">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$m = {Le}(T)$\end{document}</tex-math><alternatives><mml:math id="M164"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq80-3096455.jpg"/></alternatives></inline-formula>, i.e., the total number of strain sequences sampled from all hosts, and <inline-formula><tex-math notation="LaTeX" id="M165">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n = |H|$\end{document}</tex-math><alternatives><mml:math id="M166"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mi>H</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq81-3096455.jpg"/></alternatives></inline-formula>, i.e., the number of infected hosts in the analysis. In fact, by exploiting the fact that <inline-formula><tex-math notation="LaTeX" id="M167">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$p(\cdot, \cdot)$\end{document}</tex-math><alternatives><mml:math id="M168"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq82-3096455.jpg"/></alternatives></inline-formula> is always either 2, 1 or 0, the algorithm can be implemented to run in <inline-formula><tex-math notation="LaTeX" id="M169">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$O(mn)$\end{document}</tex-math><alternatives><mml:math id="M170"><mml:mrow><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq83-3096455.jpg"/></alternatives></inline-formula> time (details are straightforward and therefore omitted.)</p>
    </sec>
  </sec>
  <sec id="sec3">
    <label>3</label>
    <title>Algorithmic Details</title>
    <p>A key methodological and algorithmic innovation responsible for the improved accuracy of TNet (and also of SharpTNI) is the explicit and principled consideration of variability in optimal ancestral host assignments. More precisely, TNet recognizes that there are often a very large number of distinct optimal ancestral host assignments and it samples the space of all optimal ancestral host assignments in a manner that preferentially preserves optimal ancestral host assignments (described in detail below). TNet then aggregates across these samples to compute a support value for each edge in the final transmission network. This approach is illustrated in <xref rid="fig2" ref-type="fig">Fig. 2</xref>. Thus, the core computational problem solved by TNet can be formulated as follows:</p>
    <fig position="float" id="fig2">
      <label>Fig. 2.</label>
      <caption>
        <p><italic>Accounting for multiple optima in transmission network inference.</italic> The tree on the left depicts the transmission phylogeny for the seven strains sampled from three infected individuals <inline-formula><tex-math notation="LaTeX" id="M171">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$A$\end{document}</tex-math><alternatives><mml:math id="M172"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq84-3096455.jpg"/></alternatives></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="M173">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$B$\end{document}</tex-math><alternatives><mml:math id="M174"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq85-3096455.jpg"/></alternatives></inline-formula>, and <inline-formula><tex-math notation="LaTeX" id="M175">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C$\end{document}</tex-math><alternatives><mml:math id="M176"><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq86-3096455.jpg"/></alternatives></inline-formula>, represented here by the three different colors. This tree admits two distinct optimal ancestral host assignments as shown in the figure. These two optimal ancestral host assignments can then be together used to infer a transmission network, as shown on the right, in which each edge has a support value. The support value of a transmission edge is defined to be the percentage of optimal ancestral host assignments that imply that transmission edge.</p>
      </caption>
      <graphic xlink:href="bansa2-3096455" position="float"/>
    </fig>
    <statement content-type="definition" id="definition2">
      <title>Definition 3.1 (Back-Transmission).</title>
      <p>Given a transmission phylogeny <inline-formula><tex-math notation="LaTeX" id="M177">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M178"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq87-3096455.jpg"/></alternatives></inline-formula> on strain sequences sampled from a set <inline-formula><tex-math notation="LaTeX" id="M179">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$H = \lbrace h_1, h_2, \ldots, h_n\rbrace$\end{document}</tex-math><alternatives><mml:math id="M180"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>...</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq88-3096455.jpg"/></alternatives></inline-formula> of <inline-formula><tex-math notation="LaTeX" id="M181">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n$\end{document}</tex-math><alternatives><mml:math id="M182"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq89-3096455.jpg"/></alternatives></inline-formula> infected hosts and an ancestral host assignment <inline-formula><tex-math notation="LaTeX" id="M183">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$A$\end{document}</tex-math><alternatives><mml:math id="M184"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq90-3096455.jpg"/></alternatives></inline-formula> for <inline-formula><tex-math notation="LaTeX" id="M185">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M186"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq91-3096455.jpg"/></alternatives></inline-formula>, we say that a host <inline-formula><tex-math notation="LaTeX" id="M187">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h_i$\end{document}</tex-math><alternatives><mml:math id="M188"><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="bansal-ieq92-3096455.jpg"/></alternatives></inline-formula> has a back-transmission in <inline-formula><tex-math notation="LaTeX" id="M189">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$A$\end{document}</tex-math><alternatives><mml:math id="M190"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq93-3096455.jpg"/></alternatives></inline-formula> if and only if there exist nodes <inline-formula><tex-math notation="LaTeX" id="M191">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v$\end{document}</tex-math><alternatives><mml:math id="M192"><mml:mi>v</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq94-3096455.jpg"/></alternatives></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="M193">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v^{\prime }$\end{document}</tex-math><alternatives><mml:math id="M194"><mml:msup><mml:mi>v</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq95-3096455.jpg"/></alternatives></inline-formula> in <inline-formula><tex-math notation="LaTeX" id="M195">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$V(T)$\end{document}</tex-math><alternatives><mml:math id="M196"><mml:mrow><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq96-3096455.jpg"/></alternatives></inline-formula> such that (i) <inline-formula><tex-math notation="LaTeX" id="M197">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v^{\prime }$\end{document}</tex-math><alternatives><mml:math id="M198"><mml:msup><mml:mi>v</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq97-3096455.jpg"/></alternatives></inline-formula> is a descendant of <inline-formula><tex-math notation="LaTeX" id="M199">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v$\end{document}</tex-math><alternatives><mml:math id="M200"><mml:mi>v</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq98-3096455.jpg"/></alternatives></inline-formula> in <inline-formula><tex-math notation="LaTeX" id="M201">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M202"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq99-3096455.jpg"/></alternatives></inline-formula>, (ii) <inline-formula><tex-math notation="LaTeX" id="M203">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h(v) = h(v^{\prime })$\end{document}</tex-math><alternatives><mml:math id="M204"><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq100-3096455.jpg"/></alternatives></inline-formula> under <inline-formula><tex-math notation="LaTeX" id="M205">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$A$\end{document}</tex-math><alternatives><mml:math id="M206"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq101-3096455.jpg"/></alternatives></inline-formula>, and (iii) there exists node <inline-formula><tex-math notation="LaTeX" id="M207">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v^{\prime \prime }$\end{document}</tex-math><alternatives><mml:math id="M208"><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq102-3096455.jpg"/></alternatives></inline-formula> along the <inline-formula><tex-math notation="LaTeX" id="M209">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$v - v^{\prime }$\end{document}</tex-math><alternatives><mml:math id="M210"><mml:mrow><mml:mi>v</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq103-3096455.jpg"/></alternatives></inline-formula> path for which <inline-formula><tex-math notation="LaTeX" id="M211">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h(v^{\prime \prime }) \ne h(v)$\end{document}</tex-math><alternatives><mml:math id="M212"><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>≠</mml:mo><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq104-3096455.jpg"/></alternatives></inline-formula>. The total number of back-transmissions implied by <inline-formula><tex-math notation="LaTeX" id="M213">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$A$\end{document}</tex-math><alternatives><mml:math id="M214"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq105-3096455.jpg"/></alternatives></inline-formula> on <inline-formula><tex-math notation="LaTeX" id="M215">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M216"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq106-3096455.jpg"/></alternatives></inline-formula> equals the number of hosts with back-transmissions.</p>
    </statement>
    <statement content-type="other" id="other3">
      <title>Problem 2 (Minimum back-transmission sampling).</title>
      <p>Given a transmission phylogeny <inline-formula><tex-math notation="LaTeX" id="M217">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M218"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq107-3096455.jpg"/></alternatives></inline-formula> on strain sequences sampled from a set <inline-formula><tex-math notation="LaTeX" id="M219">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$H = \lbrace h_1, h_2, \ldots, h_n\rbrace$\end{document}</tex-math><alternatives><mml:math id="M220"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>...</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq108-3096455.jpg"/></alternatives></inline-formula> of <inline-formula><tex-math notation="LaTeX" id="M221">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n$\end{document}</tex-math><alternatives><mml:math id="M222"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq109-3096455.jpg"/></alternatives></inline-formula> infected hosts, let <inline-formula><tex-math notation="LaTeX" id="M223">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {O}$\end{document}</tex-math><alternatives><mml:math id="M224"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq110-3096455.jpg"/></alternatives></inline-formula> denote the set containing all distinct optimal ancestral host assignments for <inline-formula><tex-math notation="LaTeX" id="M225">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M226"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq111-3096455.jpg"/></alternatives></inline-formula>. Further, let <inline-formula><tex-math notation="LaTeX" id="M227">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {O}^{\prime }$\end{document}</tex-math><alternatives><mml:math id="M228"><mml:msup><mml:mi mathvariant="script">O</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq112-3096455.jpg"/></alternatives></inline-formula> denote the subset of <inline-formula><tex-math notation="LaTeX" id="M229">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {O}$\end{document}</tex-math><alternatives><mml:math id="M230"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq113-3096455.jpg"/></alternatives></inline-formula> that implies the fewest back-transmissions in the resulting transmission network. Compute an optimal ancestral host assignment from <inline-formula><tex-math notation="LaTeX" id="M231">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {O}^{\prime }$\end{document}</tex-math><alternatives><mml:math id="M232"><mml:msup><mml:mi mathvariant="script">O</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq114-3096455.jpg"/></alternatives></inline-formula> such that each element of <inline-formula><tex-math notation="LaTeX" id="M233">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {O}^{\prime }$\end{document}</tex-math><alternatives><mml:math id="M234"><mml:msup><mml:mi mathvariant="script">O</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq115-3096455.jpg"/></alternatives></inline-formula> has an equal probability of being computed.</p>
    </statement>
    <p><xref rid="fig3" ref-type="fig">Fig. 3</xref> shows an example of minimum back-transmission sampling. Observe that the actual number of optimal ancestral host assignments (both <inline-formula><tex-math notation="LaTeX" id="M235">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {O}$\end{document}</tex-math><alternatives><mml:math id="M236"><mml:mi mathvariant="script">O</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq116-3096455.jpg"/></alternatives></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="M237">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {O}^{\prime }$\end{document}</tex-math><alternatives><mml:math id="M238"><mml:msup><mml:mi mathvariant="script">O</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq117-3096455.jpg"/></alternatives></inline-formula>) can grow exponentially in the number of hosts <inline-formula><tex-math notation="LaTeX" id="M239">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n$\end{document}</tex-math><alternatives><mml:math id="M240"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq118-3096455.jpg"/></alternatives></inline-formula>. Thus, by solving the sampling problem above instead, TNet seeks to efficiently account for the diversity within optimal ancestral host assignments with minimum back-transmissions, without explicitly having to enumerate them all.</p>
    <p>Note that SharpTNI, developed independently and contemporaneously to TNet, performs a similar sampling among all optimal ancestral host assignments, but employs a different optimality objective. Specifically, SharpTNI seeks to sample optimal ancestral host assignments that minimize the number of <italic>co-transmissions</italic>, i.e., minimize the number of inter-host edges in the transmission network.</p>
    <sec id="sec3.1">
      <label>3.1</label>
      <title>Minimum Back-Transmission Sampling of Optimal Host Assignments</title>
      <p>TNet approximates minimum back-transmission sampling by combining uniform sampling of ancestral host assignments with a greedy procedure to assign specific hosts to internal nodes. This is accomplished by suitably extending and modifying Sankoff's algorithm. Note that Sankoff's algorithm computes, at each node <inline-formula><tex-math notation="LaTeX" id="M241">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t \in V(T)$\end{document}</tex-math><alternatives><mml:math id="M242"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq119-3096455.jpg"/></alternatives></inline-formula> and for each host <inline-formula><tex-math notation="LaTeX" id="M243">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h_i \in H$\end{document}</tex-math><alternatives><mml:math id="M244"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq120-3096455.jpg"/></alternatives></inline-formula>, the minimum number of inter-host transmission events required on subtree <inline-formula><tex-math notation="LaTeX" id="M245">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T(t)$\end{document}</tex-math><alternatives><mml:math id="M246"><mml:mrow><mml:mi>T</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq121-3096455.jpg"/></alternatives></inline-formula> under the constraint that <inline-formula><tex-math notation="LaTeX" id="M247">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h(t) = h_i$\end{document}</tex-math><alternatives><mml:math id="M248"><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq122-3096455.jpg"/></alternatives></inline-formula>, denoted <inline-formula><tex-math notation="LaTeX" id="M249">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C(t, h_i)$\end{document}</tex-math><alternatives><mml:math id="M250"><mml:mrow><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq123-3096455.jpg"/></alternatives></inline-formula>. To perform our minimum back-transmission sampling, we must keep track of the number of optimal ancestral host assignments associated with each subproblem <inline-formula><tex-math notation="LaTeX" id="M251">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C(t, h_i)$\end{document}</tex-math><alternatives><mml:math id="M252"><mml:mrow><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq124-3096455.jpg"/></alternatives></inline-formula> considered in the dynamic programming algorithm. We therefore define the following: For any <inline-formula><tex-math notation="LaTeX" id="M253">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t \in V(T)$\end{document}</tex-math><alternatives><mml:math id="M254"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq125-3096455.jpg"/></alternatives></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="M255">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h_i \in H$\end{document}</tex-math><alternatives><mml:math id="M256"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq126-3096455.jpg"/></alternatives></inline-formula>, let <inline-formula><tex-math notation="LaTeX" id="M257">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N(t, h_i)$\end{document}</tex-math><alternatives><mml:math id="M258"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq127-3096455.jpg"/></alternatives></inline-formula> denote the number of distinct optimal host assignments for the subtree <inline-formula><tex-math notation="LaTeX" id="M259">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T(t)$\end{document}</tex-math><alternatives><mml:math id="M260"><mml:mrow><mml:mi>T</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq128-3096455.jpg"/></alternatives></inline-formula> under the constraint that <inline-formula><tex-math notation="LaTeX" id="M261">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h(t) = h_i$\end{document}</tex-math><alternatives><mml:math id="M262"><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq129-3096455.jpg"/></alternatives></inline-formula>. Each <inline-formula><tex-math notation="LaTeX" id="M263">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N(\cdot, \cdot)$\end{document}</tex-math><alternatives><mml:math id="M264"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq130-3096455.jpg"/></alternatives></inline-formula> can be computed during the same post-order traversal used to compute the <inline-formula><tex-math notation="LaTeX" id="M265">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C(\cdot, \cdot)$\end{document}</tex-math><alternatives><mml:math id="M266"><mml:mrow><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq131-3096455.jpg"/></alternatives></inline-formula> values as shown below.</p>
      <p>If <inline-formula><tex-math notation="LaTeX" id="M267">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t \in {Le}(T)$\end{document}</tex-math><alternatives><mml:math id="M268"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq132-3096455.jpg"/></alternatives></inline-formula>, then the dynamic programming table for <inline-formula><tex-math notation="LaTeX" id="M269">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N(\cdot, \cdot)$\end{document}</tex-math><alternatives><mml:math id="M270"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq133-3096455.jpg"/></alternatives></inline-formula> can be initialised as follows:
<disp-formula id="deqn3"><tex-math notation="LaTeX" id="M271">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}
\begin{equation*}
N(t, h_i)=\left\lbrace \begin{array}{ll}1, &amp; \text{if } h(t) = h_i, \\ 
0, &amp; \text{otherwise}. \end{array}\right. \tag{3}
\end{equation*}

\end{document}</tex-math><alternatives><mml:math id="M272"><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4.pt"/><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>3</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="bansal-eq3-3096455.jpg" position="anchor"/></alternatives></disp-formula></p>
      <p>If <inline-formula><tex-math notation="LaTeX" id="M273">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t \in I(T)$\end{document}</tex-math><alternatives><mml:math id="M274"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq134-3096455.jpg"/></alternatives></inline-formula>, and <inline-formula><tex-math notation="LaTeX" id="M275">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t^{\prime }$\end{document}</tex-math><alternatives><mml:math id="M276"><mml:msup><mml:mi>t</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq135-3096455.jpg"/></alternatives></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="M277">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t^{\prime \prime }$\end{document}</tex-math><alternatives><mml:math id="M278"><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq136-3096455.jpg"/></alternatives></inline-formula> denote the two children of <inline-formula><tex-math notation="LaTeX" id="M279">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t$\end{document}</tex-math><alternatives><mml:math id="M280"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq137-3096455.jpg"/></alternatives></inline-formula>, then <inline-formula><tex-math notation="LaTeX" id="M281">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N(t, h_i)$\end{document}</tex-math><alternatives><mml:math id="M282"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq138-3096455.jpg"/></alternatives></inline-formula> can be computed based on optimal host assignments at <inline-formula><tex-math notation="LaTeX" id="M283">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t^{\prime }$\end{document}</tex-math><alternatives><mml:math id="M284"><mml:msup><mml:mi>t</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq139-3096455.jpg"/></alternatives></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="M285">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t^{\prime \prime }$\end{document}</tex-math><alternatives><mml:math id="M286"><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq140-3096455.jpg"/></alternatives></inline-formula> and their corresponding <inline-formula><tex-math notation="LaTeX" id="M287">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N(\cdot, \cdot)$\end{document}</tex-math><alternatives><mml:math id="M288"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq141-3096455.jpg"/></alternatives></inline-formula> values. Let <inline-formula><tex-math notation="LaTeX" id="M289">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X^{\prime } \subseteq H$\end{document}</tex-math><alternatives><mml:math id="M290"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>⊆</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq142-3096455.jpg"/></alternatives></inline-formula> denote the host assignments for <inline-formula><tex-math notation="LaTeX" id="M291">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t^{\prime }$\end{document}</tex-math><alternatives><mml:math id="M292"><mml:msup><mml:mi>t</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq143-3096455.jpg"/></alternatives></inline-formula> that are optimal given a host assignment of <inline-formula><tex-math notation="LaTeX" id="M293">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h_i$\end{document}</tex-math><alternatives><mml:math id="M294"><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="bansal-ieq144-3096455.jpg"/></alternatives></inline-formula> at <inline-formula><tex-math notation="LaTeX" id="M295">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t$\end{document}</tex-math><alternatives><mml:math id="M296"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq145-3096455.jpg"/></alternatives></inline-formula>. Likewise, let <inline-formula><tex-math notation="LaTeX" id="M297">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X^{\prime \prime } \subseteq H$\end{document}</tex-math><alternatives><mml:math id="M298"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mo>⊆</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq146-3096455.jpg"/></alternatives></inline-formula> denote the host assignments for <inline-formula><tex-math notation="LaTeX" id="M299">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t^{\prime \prime }$\end{document}</tex-math><alternatives><mml:math id="M300"><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq147-3096455.jpg"/></alternatives></inline-formula> that are optimal given a host assignment of <inline-formula><tex-math notation="LaTeX" id="M301">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h_i$\end{document}</tex-math><alternatives><mml:math id="M302"><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="bansal-ieq148-3096455.jpg"/></alternatives></inline-formula> at <inline-formula><tex-math notation="LaTeX" id="M303">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t$\end{document}</tex-math><alternatives><mml:math id="M304"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq149-3096455.jpg"/></alternatives></inline-formula>. More precisely, <inline-formula><tex-math notation="LaTeX" id="M305">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X^{\prime } = \lbrace h_j \in H \mid C(t^{\prime }, h_j) + p(h_i, h_j) \text{ is minimized}\rbrace$\end{document}</tex-math><alternatives><mml:math id="M306"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>H</mml:mi><mml:mo>∣</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="4.pt"/><mml:mtext>is</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>minimized</mml:mtext><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq150-3096455.jpg"/></alternatives></inline-formula>, and <inline-formula><tex-math notation="LaTeX" id="M307">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X^{\prime \prime } = \lbrace h_j \in H \mid C(t^{\prime \prime }, h_j) + p(h_i, h_j) \text{ is minimized}\rbrace$\end{document}</tex-math><alternatives><mml:math id="M308"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>H</mml:mi><mml:mo>∣</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="4.pt"/><mml:mtext>is</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>minimized</mml:mtext><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq151-3096455.jpg"/></alternatives></inline-formula>. Then, <inline-formula><tex-math notation="LaTeX" id="M309">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N(t, h_i)$\end{document}</tex-math><alternatives><mml:math id="M310"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq152-3096455.jpg"/></alternatives></inline-formula> can be computed as follows:
<disp-formula id="deqn4"><tex-math notation="LaTeX" id="M311">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}
\begin{equation*}
N(t, h_i) = \left(\sum _{x \in X^{\prime }} N(t^{\prime }, x)\right) \times \left(\sum _{x \in X^{\prime \prime }} N(t^{\prime \prime }, x)\right). \tag{4}
\end{equation*}

\end{document}</tex-math><alternatives><mml:math id="M312"><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:munder><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>.</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>4</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="bansal-eq4-3096455.jpg" position="anchor"/></alternatives></disp-formula></p>
      <p>Observe that the total number of distinct ancestral host assignments for <inline-formula><tex-math notation="LaTeX" id="M313">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M314"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq153-3096455.jpg"/></alternatives></inline-formula> is given by <inline-formula><tex-math notation="LaTeX" id="M315">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sum _{x \in X} N({rt}(t), x)$\end{document}</tex-math><alternatives><mml:math id="M316"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq154-3096455.jpg"/></alternatives></inline-formula>, where <inline-formula><tex-math notation="LaTeX" id="M317">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X = \text{argmin}_{y \in H} \lbrace C({rt}(T), y)\rbrace$\end{document}</tex-math><alternatives><mml:math id="M318"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mtext>argmin</mml:mtext><mml:mrow><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq155-3096455.jpg"/></alternatives></inline-formula>.</p>
      <p>This yields the following theorem.</p>
      <statement content-type="theorem" id="theorem4">
        <title>Theorem 3.1.</title>
        <p>Given a transmission phylogeny <inline-formula><tex-math notation="LaTeX" id="M319">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M320"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq156-3096455.jpg"/></alternatives></inline-formula> on <inline-formula><tex-math notation="LaTeX" id="M321">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$m$\end{document}</tex-math><alternatives><mml:math id="M322"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq157-3096455.jpg"/></alternatives></inline-formula> strain sequences sampled from a set <inline-formula><tex-math notation="LaTeX" id="M323">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$H = \lbrace h_1, h_2, \ldots, h_n\rbrace$\end{document}</tex-math><alternatives><mml:math id="M324"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>...</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq158-3096455.jpg"/></alternatives></inline-formula> of <inline-formula><tex-math notation="LaTeX" id="M325">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n$\end{document}</tex-math><alternatives><mml:math id="M326"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq159-3096455.jpg"/></alternatives></inline-formula> infected hosts, the number <inline-formula><tex-math notation="LaTeX" id="M327">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N(t, h_i)$\end{document}</tex-math><alternatives><mml:math id="M328"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq160-3096455.jpg"/></alternatives></inline-formula> for each <inline-formula><tex-math notation="LaTeX" id="M329">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t \in V(G)$\end{document}</tex-math><alternatives><mml:math id="M330"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq161-3096455.jpg"/></alternatives></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="M331">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h_i \in H$\end{document}</tex-math><alternatives><mml:math id="M332"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq162-3096455.jpg"/></alternatives></inline-formula> can be correctly computed in <inline-formula><tex-math notation="LaTeX" id="M333">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$O(mn^2)$\end{document}</tex-math><alternatives><mml:math id="M334"><mml:mrow><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq163-3096455.jpg"/></alternatives></inline-formula> time.</p>
      </statement>
      <statement content-type="proof" id="proof1">
        <title>Proof.</title>
        <p>From the correctness of Sankoff's algorithm (described in <xref rid="sec2" ref-type="sec">Section 2</xref>), we already know that all costs <inline-formula><tex-math notation="LaTeX" id="M335">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C(\cdot, \cdot)$\end{document}</tex-math><alternatives><mml:math id="M336"><mml:mrow><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq164-3096455.jpg"/></alternatives></inline-formula> can be correctly computed in <inline-formula><tex-math notation="LaTeX" id="M337">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$O(mn^2)$\end{document}</tex-math><alternatives><mml:math id="M338"><mml:mrow><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq165-3096455.jpg"/></alternatives></inline-formula> time. Once all costs <inline-formula><tex-math notation="LaTeX" id="M339">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C(\cdot, \cdot)$\end{document}</tex-math><alternatives><mml:math id="M340"><mml:mrow><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq166-3096455.jpg"/></alternatives></inline-formula> have been computed, the <inline-formula><tex-math notation="LaTeX" id="M341">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N(\cdot, \cdot)$\end{document}</tex-math><alternatives><mml:math id="M342"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq167-3096455.jpg"/></alternatives></inline-formula> numbers can be computed by executing a post-order traversal of <inline-formula><tex-math notation="LaTeX" id="M343">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M344"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq168-3096455.jpg"/></alternatives></inline-formula> and applying Equations <xref rid="deqn3" ref-type="disp-formula">(3)</xref> and <xref rid="deqn4" ref-type="disp-formula">(4)</xref> at each node of <inline-formula><tex-math notation="LaTeX" id="M345">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M346"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq169-3096455.jpg"/></alternatives></inline-formula>.</p>
        <p><italic>Correctness.</italic> It suffices to prove the correctness of Equations <xref rid="deqn3" ref-type="disp-formula">(3)</xref> and <xref rid="deqn4" ref-type="disp-formula">(4)</xref>. This is easy to see for <xref rid="deqn3" ref-type="disp-formula">(3)</xref>, where the number of optimal assignments at a leaf is either 1 or 0 depending on whether the specific host under consideration is the true host or not. We therefore focus on establishing the correctness of Equation <xref rid="deqn4" ref-type="disp-formula">(4)</xref>.</p>
        <p>Let <inline-formula><tex-math notation="LaTeX" id="M347">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t$\end{document}</tex-math><alternatives><mml:math id="M348"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq170-3096455.jpg"/></alternatives></inline-formula> be any node in <inline-formula><tex-math notation="LaTeX" id="M349">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$I(T)$\end{document}</tex-math><alternatives><mml:math id="M350"><mml:mrow><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq171-3096455.jpg"/></alternatives></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="M351">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h_i$\end{document}</tex-math><alternatives><mml:math id="M352"><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="bansal-ieq172-3096455.jpg"/></alternatives></inline-formula> be some host from <inline-formula><tex-math notation="LaTeX" id="M353">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$H$\end{document}</tex-math><alternatives><mml:math id="M354"><mml:mi>H</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq173-3096455.jpg"/></alternatives></inline-formula>. Let <inline-formula><tex-math notation="LaTeX" id="M355">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t^{\prime }$\end{document}</tex-math><alternatives><mml:math id="M356"><mml:msup><mml:mi>t</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq174-3096455.jpg"/></alternatives></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="M357">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t^{\prime \prime }$\end{document}</tex-math><alternatives><mml:math id="M358"><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq175-3096455.jpg"/></alternatives></inline-formula> denote the two children of <inline-formula><tex-math notation="LaTeX" id="M359">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t$\end{document}</tex-math><alternatives><mml:math id="M360"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq176-3096455.jpg"/></alternatives></inline-formula>. Using an induction hypothesis, let us assume that the numbers <inline-formula><tex-math notation="LaTeX" id="M361">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N(t^{\prime }, h_j)$\end{document}</tex-math><alternatives><mml:math id="M362"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq177-3096455.jpg"/></alternatives></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="M363">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N(t^{\prime \prime }, h_j)$\end{document}</tex-math><alternatives><mml:math id="M364"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq178-3096455.jpg"/></alternatives></inline-formula> have been computed correctly for each <inline-formula><tex-math notation="LaTeX" id="M365">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h_j \in H$\end{document}</tex-math><alternatives><mml:math id="M366"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq179-3096455.jpg"/></alternatives></inline-formula>. As in Equation <xref rid="deqn4" ref-type="disp-formula">(4)</xref>, let <inline-formula><tex-math notation="LaTeX" id="M367">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X^{\prime } = \lbrace h_j \in H \mid C(t^{\prime }, h_j) + p(h_i, h_j) \text{ is minimized}\rbrace$\end{document}</tex-math><alternatives><mml:math id="M368"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>H</mml:mi><mml:mo>∣</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="4.pt"/><mml:mtext>is</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>minimized</mml:mtext><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq180-3096455.jpg"/></alternatives></inline-formula>, and <inline-formula><tex-math notation="LaTeX" id="M369">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X^{\prime \prime } = \lbrace h_j \in H \mid C(t^{\prime \prime }, h_j) + p(h_i, h_j) \text{ is minimized}\rbrace$\end{document}</tex-math><alternatives><mml:math id="M370"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>H</mml:mi><mml:mo>∣</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="4.pt"/><mml:mtext>is</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>minimized</mml:mtext><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq181-3096455.jpg"/></alternatives></inline-formula>. By definition, any host from <inline-formula><tex-math notation="LaTeX" id="M371">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X^{\prime }$\end{document}</tex-math><alternatives><mml:math id="M372"><mml:msup><mml:mi>X</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq182-3096455.jpg"/></alternatives></inline-formula> assigned to <inline-formula><tex-math notation="LaTeX" id="M373">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t^{\prime }$\end{document}</tex-math><alternatives><mml:math id="M374"><mml:msup><mml:mi>t</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq183-3096455.jpg"/></alternatives></inline-formula> and from <inline-formula><tex-math notation="LaTeX" id="M375">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X^{\prime \prime }$\end{document}</tex-math><alternatives><mml:math id="M376"><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq184-3096455.jpg"/></alternatives></inline-formula> assigned to <inline-formula><tex-math notation="LaTeX" id="M377">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t^{\prime \prime }$\end{document}</tex-math><alternatives><mml:math id="M378"><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq185-3096455.jpg"/></alternatives></inline-formula> yields an optimal host assignment for the subproblem associated with <inline-formula><tex-math notation="LaTeX" id="M379">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N(t, h_i)$\end{document}</tex-math><alternatives><mml:math id="M380"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq186-3096455.jpg"/></alternatives></inline-formula>. Observe that the total number of optimal host assignments for the subtree <inline-formula><tex-math notation="LaTeX" id="M381">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T(t^{\prime })$\end{document}</tex-math><alternatives><mml:math id="M382"><mml:mrow><mml:mi>T</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq187-3096455.jpg"/></alternatives></inline-formula>, under the constraint that <inline-formula><tex-math notation="LaTeX" id="M383">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t$\end{document}</tex-math><alternatives><mml:math id="M384"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq188-3096455.jpg"/></alternatives></inline-formula> is assigned host <inline-formula><tex-math notation="LaTeX" id="M385">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h_i$\end{document}</tex-math><alternatives><mml:math id="M386"><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="bansal-ieq189-3096455.jpg"/></alternatives></inline-formula>, is given by <inline-formula><tex-math notation="LaTeX" id="M387">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sum _{x \in X^{\prime }} N(t^{\prime }, x)$\end{document}</tex-math><alternatives><mml:math id="M388"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq190-3096455.jpg"/></alternatives></inline-formula>. Likewise, the total number of optimal host assignments for the subtree <inline-formula><tex-math notation="LaTeX" id="M389">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T(t^{\prime \prime })$\end{document}</tex-math><alternatives><mml:math id="M390"><mml:mrow><mml:mi>T</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq191-3096455.jpg"/></alternatives></inline-formula>, under the constraint that <inline-formula><tex-math notation="LaTeX" id="M391">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t$\end{document}</tex-math><alternatives><mml:math id="M392"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq192-3096455.jpg"/></alternatives></inline-formula> is assigned host <inline-formula><tex-math notation="LaTeX" id="M393">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h_i$\end{document}</tex-math><alternatives><mml:math id="M394"><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="bansal-ieq193-3096455.jpg"/></alternatives></inline-formula>, is given by <inline-formula><tex-math notation="LaTeX" id="M395">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sum _{x \in X^{\prime \prime }} N(t^{\prime \prime }, x)$\end{document}</tex-math><alternatives><mml:math id="M396"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq194-3096455.jpg"/></alternatives></inline-formula>. Since these optimal host assignments for <inline-formula><tex-math notation="LaTeX" id="M397">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t^{\prime }$\end{document}</tex-math><alternatives><mml:math id="M398"><mml:msup><mml:mi>t</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq195-3096455.jpg"/></alternatives></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="M399">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t^{\prime \prime }$\end{document}</tex-math><alternatives><mml:math id="M400"><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>'</mml:mo><mml:mo>'</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="bansal-ieq196-3096455.jpg"/></alternatives></inline-formula> are independent of each other (they depend only on the host assignment at <inline-formula><tex-math notation="LaTeX" id="M401">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t$\end{document}</tex-math><alternatives><mml:math id="M402"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq197-3096455.jpg"/></alternatives></inline-formula>), the number <inline-formula><tex-math notation="LaTeX" id="M403">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N(t, h_i)$\end{document}</tex-math><alternatives><mml:math id="M404"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq198-3096455.jpg"/></alternatives></inline-formula> must equal the product of the two sums. Thus, Equation <xref rid="deqn4" ref-type="disp-formula">(4)</xref> correctly computes <inline-formula><tex-math notation="LaTeX" id="M405">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N(t, h_i)$\end{document}</tex-math><alternatives><mml:math id="M406"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq199-3096455.jpg"/></alternatives></inline-formula>. Induction on the nodes of <inline-formula><tex-math notation="LaTeX" id="M407">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M408"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq200-3096455.jpg"/></alternatives></inline-formula> completes this proof.</p>
        <p><italic>Time Complexity.</italic> Observe that there are a total of <inline-formula><tex-math notation="LaTeX" id="M409">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$O(mn)$\end{document}</tex-math><alternatives><mml:math id="M410"><mml:mrow><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq201-3096455.jpg"/></alternatives></inline-formula>
<inline-formula><tex-math notation="LaTeX" id="M411">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N(\cdot, \cdot)$\end{document}</tex-math><alternatives><mml:math id="M412"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq202-3096455.jpg"/></alternatives></inline-formula> numbers to be computed. Each of these numbers is computed by directly applying either Equations <xref rid="deqn3" ref-type="disp-formula">(3)</xref> or <xref rid="deqn4" ref-type="disp-formula">(4)</xref>. Equation <xref rid="deqn3" ref-type="disp-formula">(3)</xref> can be applied in <inline-formula><tex-math notation="LaTeX" id="M413">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$O(1)$\end{document}</tex-math><alternatives><mml:math id="M414"><mml:mrow><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq203-3096455.jpg"/></alternatives></inline-formula> time, while Equation <xref rid="deqn4" ref-type="disp-formula">(4)</xref> can be applied in <inline-formula><tex-math notation="LaTeX" id="M415">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$O(n)$\end{document}</tex-math><alternatives><mml:math id="M416"><mml:mrow><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq204-3096455.jpg"/></alternatives></inline-formula> time. Thus, computing all <inline-formula><tex-math notation="LaTeX" id="M417">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N(\cdot, \cdot)$\end{document}</tex-math><alternatives><mml:math id="M418"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq205-3096455.jpg"/></alternatives></inline-formula> requires a total of <inline-formula><tex-math notation="LaTeX" id="M419">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$O(mn^2)$\end{document}</tex-math><alternatives><mml:math id="M420"><mml:mrow><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq206-3096455.jpg"/></alternatives></inline-formula> time.</p>
      </statement>
      <p>After all <inline-formula><tex-math notation="LaTeX" id="M421">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N(\cdot, \cdot)$\end{document}</tex-math><alternatives><mml:math id="M422"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq207-3096455.jpg"/></alternatives></inline-formula> numbers have been computed, we perform our greedy sampling procedure using probabilistic backtracking. The basic idea is to perform a pre-order traversal of <inline-formula><tex-math notation="LaTeX" id="M423">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M424"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq208-3096455.jpg"/></alternatives></inline-formula> and make a final host assignment at the current node based on the number of optimal ancestral host assignments available for each optimal choice at that node, while preferentially preserving the parent host assignment. This is described in detail in Procedure <italic>GreedyProbabilisticBacktracking</italic> below. This procedure assumes that all costs <inline-formula><tex-math notation="LaTeX" id="M425">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C(\cdot, \cdot)$\end{document}</tex-math><alternatives><mml:math id="M426"><mml:mrow><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq209-3096455.jpg"/></alternatives></inline-formula> and numbers <inline-formula><tex-math notation="LaTeX" id="M427">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N(\cdot, \cdot)$\end{document}</tex-math><alternatives><mml:math id="M428"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq210-3096455.jpg"/></alternatives></inline-formula> have already been computed.</p>
      <list list-type="simple" list-content="algorithm" id="algorithm1">
        <label>Procedure.</label>
        <title>GreedyProbabilisticBacktracking</title>
        <list-item>
          <label>1:</label>
          <p>Let <inline-formula><tex-math notation="LaTeX" id="M429">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\alpha = \min _i \lbrace C({rt}(T), h_i)\rbrace$\end{document}</tex-math><alternatives><mml:math id="M430"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mo form="prefix" movablelimits="true">min</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq211-3096455.jpg"/></alternatives></inline-formula>.</p>
        </list-item>
        <list-item>
          <label>2:</label>
          <p><bold>for</bold> each <inline-formula><tex-math notation="LaTeX" id="M431">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t \in I(T)$\end{document}</tex-math><alternatives><mml:math id="M432"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq212-3096455.jpg"/></alternatives></inline-formula> in a pre-order traversal of <inline-formula><tex-math notation="LaTeX" id="M433">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T$\end{document}</tex-math><alternatives><mml:math id="M434"><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq213-3096455.jpg"/></alternatives></inline-formula>
<bold>do</bold></p>
        </list-item>
        <list-item>
          <label>3:</label>
          <p>
            <bold>if</bold>
            <inline-formula>
              <tex-math notation="LaTeX" id="M435">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t = {rt}(T)$\end{document}</tex-math>
              <alternatives>
                <mml:math id="M436">
                  <mml:mrow>
                    <mml:mi>t</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:mi>r</mml:mi>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mi>T</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:math>
                <inline-graphic xlink:href="bansal-ieq214-3096455.jpg"/>
              </alternatives>
            </inline-formula>
            <bold>then</bold>
          </p>
        </list-item>
        <list-item>
          <label>4:</label>
          <p>Let <inline-formula><tex-math notation="LaTeX" id="M437">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X = \lbrace h_i \in H \mid C({rt}(T), h_i) = \alpha \rbrace$\end{document}</tex-math><alternatives><mml:math id="M438"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>H</mml:mi><mml:mo>∣</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq215-3096455.jpg"/></alternatives></inline-formula>.</p>
        </list-item>
        <list-item>
          <label>5:</label>
          <p>For each <inline-formula><tex-math notation="LaTeX" id="M439">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h_i \in X$\end{document}</tex-math><alternatives><mml:math id="M440"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq216-3096455.jpg"/></alternatives></inline-formula>, assign <inline-formula><tex-math notation="LaTeX" id="M441">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h(t) = h_i$\end{document}</tex-math><alternatives><mml:math id="M442"><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq217-3096455.jpg"/></alternatives></inline-formula> with probability <inline-formula><tex-math notation="LaTeX" id="M443">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\frac{N(t, h_i)}{\sum _{h_j \in X} N(t, h_j)}$\end{document}</tex-math><alternatives><mml:math id="M444"><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="bansal-ieq218-3096455.jpg"/></alternatives></inline-formula>.</p>
        </list-item>
        <list-item>
          <label>6:</label>
          <p>
            <bold>if</bold>
            <inline-formula>
              <tex-math notation="LaTeX" id="M445">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t \ne {rt}(T)$\end{document}</tex-math>
              <alternatives>
                <mml:math id="M446">
                  <mml:mrow>
                    <mml:mi>t</mml:mi>
                    <mml:mo>≠</mml:mo>
                    <mml:mrow>
                      <mml:mi>r</mml:mi>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mi>T</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:math>
                <inline-graphic xlink:href="bansal-ieq219-3096455.jpg"/>
              </alternatives>
            </inline-formula>
            <bold>then</bold>
          </p>
        </list-item>
        <list-item>
          <label>7:</label>
          <p>Let <inline-formula><tex-math notation="LaTeX" id="M447">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X = \lbrace h_i \in H \mid C(t, h_i) + p(h({pa}(t)), h_i) \text{ is minimized}\rbrace$\end{document}</tex-math><alternatives><mml:math id="M448"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>H</mml:mi><mml:mo>∣</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="4.pt"/><mml:mtext>is</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>minimized</mml:mtext><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq220-3096455.jpg"/></alternatives></inline-formula>.</p>
        </list-item>
        <list-item>
          <label>8:</label>
          <p>
            <bold>if</bold>
            <inline-formula>
              <tex-math notation="LaTeX" id="M449">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h({pa}(t)) \in X$\end{document}</tex-math>
              <alternatives>
                <mml:math id="M450">
                  <mml:mrow>
                    <mml:mi>h</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mi>t</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mo>)</mml:mo>
                    <mml:mo>∈</mml:mo>
                    <mml:mi>X</mml:mi>
                  </mml:mrow>
                </mml:math>
                <inline-graphic xlink:href="bansal-ieq221-3096455.jpg"/>
              </alternatives>
            </inline-formula>
            <bold>then</bold>
          </p>
        </list-item>
        <list-item>
          <label>9:</label>
          <p>Assign <inline-formula><tex-math notation="LaTeX" id="M451">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h(t) = h({pa}(t))$\end{document}</tex-math><alternatives><mml:math id="M452"><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq222-3096455.jpg"/></alternatives></inline-formula>.</p>
        </list-item>
        <list-item>
          <label>10:</label>
          <p>
            <bold>if</bold>
            <inline-formula>
              <tex-math notation="LaTeX" id="M453">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h({pa}(t)) \not\in X$\end{document}</tex-math>
              <alternatives>
                <mml:math id="M454">
                  <mml:mrow>
                    <mml:mi>h</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mi>t</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mo>)</mml:mo>
                    <mml:mo>∉</mml:mo>
                    <mml:mi>X</mml:mi>
                  </mml:mrow>
                </mml:math>
                <inline-graphic xlink:href="bansal-ieq223-3096455.jpg"/>
              </alternatives>
            </inline-formula>
            <bold>then</bold>
          </p>
        </list-item>
        <list-item>
          <label>11:</label>
          <p>For each <inline-formula><tex-math notation="LaTeX" id="M455">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h_i \in X$\end{document}</tex-math><alternatives><mml:math id="M456"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq224-3096455.jpg"/></alternatives></inline-formula>, assign <inline-formula><tex-math notation="LaTeX" id="M457">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h(t) = h_i$\end{document}</tex-math><alternatives><mml:math id="M458"><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq225-3096455.jpg"/></alternatives></inline-formula> with probability <inline-formula><tex-math notation="LaTeX" id="M459">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\frac{N(t, h_i)}{\sum _{h_j \in X} N(t, h_j)}$\end{document}</tex-math><alternatives><mml:math id="M460"><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="bansal-ieq226-3096455.jpg"/></alternatives></inline-formula>.</p>
        </list-item>
      </list>
      <p>The procedure above preferentially assigns each internal node the same host assignment as that node's parent, if such an assignment is optimal. This strategy is based on the following straightforward observation: If the host assignment of an internal node <inline-formula><tex-math notation="LaTeX" id="M461">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t$\end{document}</tex-math><alternatives><mml:math id="M462"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq227-3096455.jpg"/></alternatives></inline-formula>
<italic>could</italic> be the same as that of its parent (while remaining optimal), i.e., <inline-formula><tex-math notation="LaTeX" id="M463">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h(t) = h({pa}(t))$\end{document}</tex-math><alternatives><mml:math id="M464"><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq228-3096455.jpg"/></alternatives></inline-formula> is optimal, then assigning a different optimal mapping <inline-formula><tex-math notation="LaTeX" id="M465">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h(t) \ne h({pa}(t))$\end{document}</tex-math><alternatives><mml:math id="M466"><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>≠</mml:mo><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq229-3096455.jpg"/></alternatives></inline-formula> can result in a transmission edge back to <inline-formula><tex-math notation="LaTeX" id="M467">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h({pa}(t))$\end{document}</tex-math><alternatives><mml:math id="M468"><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq230-3096455.jpg"/></alternatives></inline-formula>, effectively implying a reinfection of host <inline-formula><tex-math notation="LaTeX" id="M469">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$h({pa}(t))$\end{document}</tex-math><alternatives><mml:math id="M470"><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq231-3096455.jpg"/></alternatives></inline-formula> by a descendant disease strain. Thus, the goal of TNet's sampling strategy is to strike a balance between sampling the diversity of optimal ancestral host assignments but avoiding sampling solutions with unnecessary back-transmissions.</p>
    </sec>
    <sec id="sec3.2">
      <label>3.2</label>
      <title>Aggregation Across Multiple Optima</title>
      <p>As illustrated in <xref rid="fig2" ref-type="fig">Fig. 2</xref>, aggregating across the sampled optimal ancestral host assignments can be used to improve transmission network inference by distinguishing between high-support and low-support transmission edges. Specifically, each directed edge in the transmission network can be assigned a support value based on the percentage of sampled optimal ancestral host assignments that imply that transmission edge. For example, in <xref rid="fig2" ref-type="fig">Fig. 2</xref>, the first sampled optimal host assignment (shown on the top) implies the two transmission edges <inline-formula><tex-math notation="LaTeX" id="M471">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(A \rightarrow B)$\end{document}</tex-math><alternatives><mml:math id="M472"><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>→</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq232-3096455.jpg"/></alternatives></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="M473">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(A \rightarrow C)$\end{document}</tex-math><alternatives><mml:math id="M474"><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>→</mml:mo><mml:mi>C</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq233-3096455.jpg"/></alternatives></inline-formula>, and the second sampled optimal host assignment (shown at the bottom) implies the two transmission edges <inline-formula><tex-math notation="LaTeX" id="M475">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(A \rightarrow B)$\end{document}</tex-math><alternatives><mml:math id="M476"><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>→</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq234-3096455.jpg"/></alternatives></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="M477">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(C \rightarrow A)$\end{document}</tex-math><alternatives><mml:math id="M478"><mml:mrow><mml:mo>(</mml:mo><mml:mi>C</mml:mi><mml:mo>→</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq235-3096455.jpg"/></alternatives></inline-formula>. By aggregating over these two transmission networks, an <italic>edge-weighted</italic> transmission network can be inferred, as shown on the right of the figure. This aggregated transmission network contains three directed edges, <inline-formula><tex-math notation="LaTeX" id="M479">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(A \rightarrow B)$\end{document}</tex-math><alternatives><mml:math id="M480"><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>→</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq236-3096455.jpg"/></alternatives></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="M481">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(A \rightarrow C)$\end{document}</tex-math><alternatives><mml:math id="M482"><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>→</mml:mo><mml:mi>C</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq237-3096455.jpg"/></alternatives></inline-formula>, and <inline-formula><tex-math notation="LaTeX" id="M483">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(C \rightarrow A)$\end{document}</tex-math><alternatives><mml:math id="M484"><mml:mrow><mml:mo>(</mml:mo><mml:mi>C</mml:mi><mml:mo>→</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq238-3096455.jpg"/></alternatives></inline-formula>, where the weight of each edge captures the percentage of sampled optimal ancestral host assignments that support that edge. Since <inline-formula><tex-math notation="LaTeX" id="M485">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(A \rightarrow B)$\end{document}</tex-math><alternatives><mml:math id="M486"><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>→</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq239-3096455.jpg"/></alternatives></inline-formula> is inferred by both sampled ancestral host assignments, and <inline-formula><tex-math notation="LaTeX" id="M487">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(A \rightarrow C)$\end{document}</tex-math><alternatives><mml:math id="M488"><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>→</mml:mo><mml:mi>C</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq240-3096455.jpg"/></alternatives></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="M489">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(C \rightarrow A)$\end{document}</tex-math><alternatives><mml:math id="M490"><mml:mrow><mml:mo>(</mml:mo><mml:mi>C</mml:mi><mml:mo>→</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq241-3096455.jpg"/></alternatives></inline-formula> are each inferred by one of the two sampled ancestral host assignments, there support values are 100, 50, and 50 percent, respectively. By executing TNet multiple times on the same transmission phylogeny (100 times per tree in our experimental study), these support values for edges can be estimated very accurately.</p>
    </sec>
    <sec id="sec3.3">
      <label>3.3</label>
      <title>Accounting for Phylogenetic Inference Error</title>
      <p>In addition to capturing the uncertainty of minimum back-transmission ancestral host assignments, which we show how to handle above, a second key source of inference uncertainty is phylogenetic error, i.e., errors in the inferred transmission phylogeny. Phyloscanner <xref rid="ref37" ref-type="bibr">[37]</xref> accounts for such phylogenetic error by aggregating results across multiple transmission phylogenies (e.g., derived from different genomic regions of the samples strains, bootstrap replicates, etc.). We employ the same approach with TNet, aggregating the transmission network across multiple transmission phylogenies, in addition to the aggregation across multiple optimal ancestral host assignments per transmission phylogeny.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <label>4</label>
    <title>Datasets and Evaluation Methodology</title>
    <p><italic>Simulated Datasets.</italic> To evaluate the performance of TNet, SharpTNI, and phyloscanner, we generated a number of simulated viral transmission data sets across a variety of parameters. These datasets were generated using FAVITES <xref rid="ref25" ref-type="bibr">[25]</xref>, which can simultaneous simulate transmission networks, phylogenetic trees, and sequences. The simulated contact networks consisted of 1000 individuals, with each individual connected to other individuals through 100 outgoing edges preferentially attached to high-degree nodes using the Barabasi-Albert model <xref rid="ref1" ref-type="bibr">[1]</xref>. On these contact networks, we simulated datasets with (i) four types of transmission networks using both Susceptible-Exposed-Infected-Recovered (SEIR) and Susceptible-Infected-Recovered (SIR) <xref rid="ref20" ref-type="bibr">[20]</xref> models with two different infection rates for each, (ii) number of viruses sampled per host (5, 10, and 20), (iii) three different nucleotide sequence lengths (1000nt, 500nt, and 250nt), and (iv) three different rates of with-in host sequence evolution (normal, half, and double). This resulted in 560 different transmission network datasets representing 28 different parameter combinations. Further details on the construction and specific parameters used for these simulated datasets appear in <xref rid="ref33" ref-type="bibr">[33]</xref>.</p>
    <p>These 560 simulated datasets had between 35 and 1400 sequences (i.e., leaves in the corresponding transmission phylogeny), with an average of 287.44 leaves. The maximum number of hosts per tree was 75, with an average of 26.72.</p>
    <p><italic>Data From Real HCV Outbreaks.</italic> We also evaluated the accuracies of TNet, SharpTNI, and phyloscanner on real datasets of HCV outbreaks made available by the CDC <xref rid="ref32" ref-type="bibr">[32]</xref>. This collection consists 10 different datasets, each representing a separate HCV outbreak. Each of these outbreak data sets contains between 2 and 19 infected hosts and a few dozen to a few hundred strain sequences. The approximate transmission network is known for each of these datasets through CDC's monitoring and epidemiological efforts. In each of the 10 cases, this estimated transmission network consists of a single known host infecting all the other hosts in that network.</p>
    <p><italic>Evaluating Transmission Network Inference Accuracy.</italic> For all simulated and real datasets, we constructed transmission phylogenies using RAxML and used RAxML's own balanced rooting procedure to root them <xref rid="ref34" ref-type="bibr">[34]</xref>. Note that TNet, SharpTNI, and phyloscanner all require rooted transmission phylogenies. To account for phylogenetic uncertainty and error, we computed 100 bootstrap replicates for each simulated and real dataset. For SharpTNI we used the efficient heuristic implementation for evaluation (not the exponential-time exact solution). All TNet results were based on aggregating across 100 sampled optimal host assignments per transmission phylogeny, and all SharpTNI results were aggregated across that subset of 100 samples that had minimum co-transmission cost, per transmission phylogeny. Results for all methods were aggregated across the different bootstrap replicates to account for phylogenetic uncertainty and yield edge-weighted transmission networks. To convert such edge-weighted transmission networks into unweighted transmission networks, we used the same 0.5 (or 50 percent) tree-support threshold used by phyloscanner in <xref rid="ref37" ref-type="bibr">[37]</xref>. Thus, all directed edges with an edge-weight of at least 0.5 (or 50 percent) tree-support were retained in the final inferred transmission network and other edges were deleted. For a fair evaluation, none of the methods were provided with any epidemiological information such as sampling times or infection times. Finally, since both TNet and SharpTNI build upon uniform sampling procedures for optimal ancestral host assignments (minimizing the total number of inter-host transmissions), we also report results for uniform random sampling of optimal ancestral host assignments, as implemented in TNet, as a baseline.</p>
    <p>To evaluate the accuracies of these final inferred transmission networks, we computed <italic>precision</italic> (i.e., the fraction of inferred edges in the transmission network that are also in the true network), <italic>recall</italic> (i.e., the fraction of true transmission network edges that are also in the inferred network), and <italic>F1 scores</italic> (i.e., harmonic mean of precision and recall).</p>
  </sec>
  <sec id="sec5">
    <label>5</label>
    <title>Experimental Results</title>
    <sec id="sec5.1">
      <label>5.1</label>
      <title>Simulated Data Results</title>
      <p><italic>Accuracy of Single Samples.</italic> We first considered the impact of inferring the transmission network using only a single optimal solution, i.e., without any aggregation across samples or bootstrap replicates. <xref rid="fig4" ref-type="fig">Fig. 4</xref> shows the results of this analysis. As the figure shows, TNet has by far the best overall accuracy, with precision, recall, and F1 scores of 0.72, 0.75, and 0.73, respectively. Phyloscanner showed the greatest precision at 0.828 but had significantly lower recall and F1 at 0.522 and 0.626, respectively. SharpTNI performed slightly better than a random optimal solution (uniform sampling), with precision, recall, and F1 scores of 0.68, 0.71, and 0.694, respectively, compared to 0.67, 0.71, and 0.687, respectively, for a randomly sampled optimal solution.</p>
      <p><italic>Impact of Sampling Multiple Optimal Solutions.</italic> For improved accuracy, both TNet and SharpTNI rely on aggregation across multiple samples per transmission phylogeny. Note that, when aggregating across multiple optimal ancestral host assignments, the final transmission network is obtained by applying a cutoff for the edge support values. For example, in <xref rid="fig2" ref-type="fig">Fig. 2</xref>, at a cutoff threshold of 100 percent, only a single transmission from <inline-formula><tex-math notation="LaTeX" id="M491">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(A \rightarrow B)$\end{document}</tex-math><alternatives><mml:math id="M492"><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>→</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq242-3096455.jpg"/></alternatives></inline-formula> would be inferred, while with a cutoff threshold of 50 percent, all three transmission edges shown in the figure would be inferred. We studied the impact of multiple sample aggregation by considering two natural sampling cutoff thresholds: 50 and 100 percent. As <xref rid="fig5" ref-type="fig">Fig. 5</xref> shows, results improve as multiple optimal are considered. Specifically, for the 50 percent sampling cutoff threshold, we found that the overall accuracy of all methods improves as multiple samples are considered. For TNet, precision, recall, and F1 score all increase to 0.73, 0.75, and 0.74, respectively. For SharpTNI, precision and F1 score increase significantly to 0.76 and 0.72, respectively, while recall decreases slightly to 0.706. Surprisingly, we found that uniform random sampling outperformed SharpTNI, with precision, recall, and F1 score of 0.77, 0.70, and 0.73, respectively.</p>
      <fig position="float" id="fig3">
        <label>Fig. 3.</label>
        <caption>
          <p><italic>Minimizing back-transmissions in transmission network inference.</italic> The tree on the left depicts the transmission phylogeny for six strains sampled from two infected individuals <inline-formula><tex-math notation="LaTeX" id="M493">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$A$\end{document}</tex-math><alternatives><mml:math id="M494"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq243-3096455.jpg"/></alternatives></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="M495">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$B$\end{document}</tex-math><alternatives><mml:math id="M496"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq244-3096455.jpg"/></alternatives></inline-formula>, represented by the two different colors. Two possible optimal host assignments for this transmission phylogeny are shown on the right. The optimal host assignment shown on top invokes a back-transmission (transmission from <inline-formula><tex-math notation="LaTeX" id="M497">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$B$\end{document}</tex-math><alternatives><mml:math id="M498"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq245-3096455.jpg"/></alternatives></inline-formula> to <inline-formula><tex-math notation="LaTeX" id="M499">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$A$\end{document}</tex-math><alternatives><mml:math id="M500"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq246-3096455.jpg"/></alternatives></inline-formula> and later back from <inline-formula><tex-math notation="LaTeX" id="M501">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$A$\end{document}</tex-math><alternatives><mml:math id="M502"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq247-3096455.jpg"/></alternatives></inline-formula> to <inline-formula><tex-math notation="LaTeX" id="M503">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$B$\end{document}</tex-math><alternatives><mml:math id="M504"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq248-3096455.jpg"/></alternatives></inline-formula>). The optimal host assignment shown at the bottom does not invoke any back-transmissions and would be a minimum back-transmission host assignment.</p>
        </caption>
        <graphic xlink:href="bansa3-3096455" position="float"/>
      </fig>
      <fig position="float" id="fig4">
        <label>Fig. 4.</label>
        <caption>
          <p><italic>Accuracy of methods using single samples.</italic> This figure plots precision, recall, and F1 scores for the different methods without any aggregation of results across multiple samples or bootstrap replicates. Results are averaged across the 560 simulated datasets.</p>
        </caption>
        <graphic xlink:href="bansa4-3096455" position="float"/>
      </fig>
      <fig position="float" id="fig5">
        <label>Fig. 5.</label>
        <caption>
          <p><italic>Accuracy of methods using multiple samples on a single transmission phylogeny.</italic> This figure plots average precision, recall, and F1 scores for random sampling, sharpTNI, and TNet when 100 samples are used on a single transmission phylogeny. Values reported are averaged across all 560 simulated datasets, and results are shown for both 50 and 100 percent sampling cutoff thresholds.</p>
        </caption>
        <graphic xlink:href="bansa5-3096455" position="float"/>
      </fig>
      <p>The figure also shows the clear tradeoff between precision and recall as the sampling cutoff threshold is increased. Specifically, for the 100 percent sampling cutoff threshold, the precision of all methods increases significantly, but overall F1 score falls to 0.65 and 0.64 for SharpTNI and random sampling, respectively. Surprisingly, recall only decreases slightly for TNet, and its overall F1 score remains 0.74 even for the 100 percent sampling cutoff threshold.</p>
      <p><italic>Accuracy on Multiple Bootstrapped Transmission Phylogenies.</italic> To further improve inference accuracy, results can be aggregated across the different bootstrap replicates to account for phylogenetic uncertainty. We therefore ran phyloscanner, TNet, and SharpTNI with 100 transmission phylogeny estimates (bootstrap replicates) per dataset. (We tested for the impact of using varying numbers of bootstrap replicates, trying 25, 50, and 100, but found that results were roughly identical in each case. We therefore report results for only the 100 bootstrap analyses.) As <xref rid="fig6" ref-type="fig">Fig. 6</xref> shows, for the 50 percent sampling cutoff threshold, the accuracies of all methods improve over the corresponding single-tree results, with particularly notable improvements in precision. For the 100 percent sampling cutoff threshold, the precision of all methods improves further, but for phyloscanner and SharpTNI this comes at the expense of large reductions in recall. TNet continues to be best performing method overall for both sampling cutoff thresholds, with precision, recall, and F1 score of 0.79, 0.73, and 0.76, respectively, at the 50 percent sampling cutoff threshold, and 0.82, 0.71, and 0.754, respectively at the 100 percent sampling cutoff threshold.</p>
      <fig position="float" id="fig6">
        <label>Fig. 6.</label>
        <caption>
          <p><italic>Transmission network inference accuracy when multiple transmission phylogenies are used.</italic> This figure plots average precision, recall, and F1 scores for phyloscanner, random sampling, sharpTNI, and TNet when 100 bootstrap replicate transmission phylogenies are used for transmission network inference. Values reported are averaged across all 560 simulated datasets, and results are shown for both 50 and 100 percent sampling cutoff thresholds.</p>
        </caption>
        <graphic xlink:href="bansa6-3096455" position="float"/>
      </fig>
      <p><italic>Precision-Recall Characteristics of SharpTNI and TNet.</italic> The results above shed light on the differences between the sampling strategies (i.e, objective functions) used by SharpTNI and TNet, revealing that SharpTNI tends to have higher precision but much lower recall. Thus, depending on use case, either SharpTNI or TNet may be the method of choice. We also note that random sampling shows similar accuracy and precision-recall characteristics as SharpTNI, suggesting that SharpTNI may not offer much improvement over the much simpler random sampling strategy.</p>
      <p><italic>Impact of Transmission Network Parameters.</italic> To study the impact of transmission network simulation parameters on relative inference accuracy, we separately partitioned the 560 datasets by transmission network model, mutation rates, number of viruses sampled per host, and sequence length. As expected, we found that the accuracies of all methods increased as sequence length was increased, and that the accuracies of all methods except phyloscanner increased as the number of viruses sampled per host increased. Overall, we found that the relative accuracies of the methods were not significantly impacted by mutation rates, number of viruses sampled per host, and sequence length, i.e., while the accuracies of all methods increased or decreased as these parameters were changed, the relative accuracies of the four methods generally remained the same (results not shown). However, we found that the transmission network model, i.e., SIR or SEIR, had an impact on the relative accuracies of the methods. Specifically, as <xref rid="table1" ref-type="table">Table 1</xref> shows, we found that (1) sharpTNI shows a slightly higher F1 score than TNet on the SIR datasets when the 50 percent sampling cutoff threshold is used, and (2) TNet performs substantially better than all other methods under the SEIR model, at both the 50 and 100 percent sampling cutoff thresholds. Notably, TNet clearly remains the most accurate method even for SIR datasets when the 100 percent sampling cutoff threshold is used.</p>
      <table-wrap position="float" id="table1">
        <label>TABLE 1</label>
        <caption>
          <title>Transmission Network Inference Accuracy Under SIR and SEIR Models</title>
        </caption>
        <alternatives>
          <graphic xlink:href="bansa.t1-3096455" position="float"/>
          <table frame="box" rules="all" cellpadding="5">
            <colgroup span="1">
              <col span="5"/>
            </colgroup>
            <thead>
              <tr>
                <th colspan="1" rowspan="1"/>
                <th colspan="1" rowspan="1">Phyloscanner</th>
                <th colspan="1" rowspan="1">Random sampling</th>
                <th colspan="1" rowspan="1">SharpTNI</th>
                <th colspan="1" rowspan="1">TNet</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="1" rowspan="1">SIR model at 50% sampling threshold</td>
                <td colspan="1" rowspan="1">0.642</td>
                <td colspan="1" rowspan="1">0.715</td>
                <td colspan="1" rowspan="1">
                  <bold>0.727</bold>
                </td>
                <td colspan="1" rowspan="1">0.713</td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">SEIR model at 50% sampling threshold</td>
                <td colspan="1" rowspan="1">0.684</td>
                <td colspan="1" rowspan="1">0.76</td>
                <td colspan="1" rowspan="1">0.772</td>
                <td colspan="1" rowspan="1">
                  <bold>0.806</bold>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">SIR model at 100% sampling threshold</td>
                <td colspan="1" rowspan="1">0.642</td>
                <td colspan="1" rowspan="1">0.636</td>
                <td colspan="1" rowspan="1">0.65</td>
                <td colspan="1" rowspan="1">
                  <bold>0.706</bold>
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">SEIR model at 100% sampling threshold</td>
                <td colspan="1" rowspan="1">0.684</td>
                <td colspan="1" rowspan="1">0.625</td>
                <td colspan="1" rowspan="1">0.661</td>
                <td colspan="1" rowspan="1">
                  <bold>0.802</bold>
                </td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <p>The table shows average F1 scores for phyloscanner, random sampling, sharpTNI, and TNet when 100 bootstrap replicate transmission phylogenies are used for transmission network inference. Average F1 scores are reported separately for the 280 datasets smulated under the SIR model and the 280 datasets simulated under the SEIR model. Results are shown for both 50 and 100 percent sampling cutoff thresholds.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>To understand why TNet shows substantially better accuracy than the other methods on SEIR datasets, we analyzed the SIR and SEIR datasets further. We observed that the key difference between them is that the basic reproduction number, which captures the average number of other individuals infected by any infected individual, and referred to as <inline-formula><tex-math notation="LaTeX" id="M505">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$R_0$\end{document}</tex-math><alternatives><mml:math id="M506"><mml:msub><mml:mi>R</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="bansal-ieq249-3096455.jpg"/></alternatives></inline-formula>, averaged 1.71 for the SIR datasets but 3.58 for the SEIR datasets. This helps explain the substantially improved performance of TNet on SEIR datasets, since transmission networks with higher <inline-formula><tex-math notation="LaTeX" id="M507">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$R_0$\end{document}</tex-math><alternatives><mml:math id="M508"><mml:msub><mml:mi>R</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="bansal-ieq250-3096455.jpg"/></alternatives></inline-formula> may benefit from TNet's host assignment strategy, which preferentially propagates parent host assignments to their children. This analysis suggests that TNet may be especially effective at inferring transmission networks for diseases that spread primarily through <italic>super-spreader</italic> events <xref rid="ref35" ref-type="bibr">[35]</xref>.</p>
    </sec>
    <sec id="sec5.2">
      <label>5.2</label>
      <title>HCV Dataset Results</title>
      <p>We applied TNet, SharpTNI, and phyloscanner to the 10 real HCV datasets using 100 bootstrap replicates per dataset. We found that both TNet and SharpTNI performed almost identically on these datasets, and that both dramatically outperformed phyloscanner on the real datasets in terms of both precision and recall (and, consequently, F1 scores). <xref rid="fig7" ref-type="fig">Fig. 7</xref> shows these results averaged across the 10 real datasets. As the figure shows, both TNet and SharpTNI have identical F1 scores for the 50 and 100 percent sampling cutoff thresholds, with both methods showing F1 scores of 0.57 and 0.56, respectively. In contrast, phyloscanner shows much lower precision and recall, with an F1 score of only 0.22. Random sampling had slightly worse performance than TNet and SharpTNI at both the 50 and 100 percent sampling cutoff thresholds. At the 100 percent sampling cutoff threshold, we observe the same precision-recall characteristics seen in the simulated datasets, with SharpTNI showing higher precision but lower recall.</p>
      <fig position="float" id="fig7">
        <label>Fig. 7.</label>
        <caption>
          <p><italic>Transmission network inference accuracy across the 10 real HCV datasets.</italic> This figure plots average precision, recall, and F1 scores for phyloscanner, random sampling, sharpTNI, and TNet on the 10 real HCV datasets with known transmission histories. Results are shown for both 50 and 100 percent sampling cutoff thresholds.</p>
        </caption>
        <graphic xlink:href="bansa7-3096455" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec id="sec6">
    <label>6</label>
    <title>COVID-19 Analysis</title>
    <p>The ongoing COVID-19 pandemic has resulted in the availability of completely sequenced SARS-CoV-2 genomes from thousands of infected individuals across dozens of countries; see, e.g., the GISAID resource <xref rid="ref12" ref-type="bibr">[12]</xref>. Among a multitude of other uses, this rich dataset allows for the estimation of a global transmission network of the spread of COVID-19. For example, the popular Nextstrain tool (<uri xlink:href="https://nextstrain.org/">https://nextstrain.org/</uri>) computes and provides a regularly updated SARS-CoV-2 phylogeny and associated transmission network between geographical regions <xref rid="ref17" ref-type="bibr">[17]</xref>. To evaluate the ability of TNet to infer such geographical spread/transmission networks, we applied TNet, along with the random sampling algorithm implemented in TNet, to a large collection of SARS-CoV-2 genomes. For this analysis, countries serve as hosts and the sampled SARS-CoV-2 genomes (only one genome per infected individual) from the infected individuals in each country serve as the sampled strains for that country/host. We also repeated the analysis at the state level for SARS-CoV-2 strains from USA. We compared the resulting transmission networks against those inferred by the widely used Nextstrain tool, evaluating inference accuracy using the available epidemiological information about country of exposure for each SARS-CoV-2 genome used in the analysis. SharpTNI could not be used for this analysis since it was not able to scale to this large dataset and resulted in runtime errors.</p>
    <sec id="sec6.1">
      <label>6.1</label>
      <title>Description of the Dataset</title>
      <p>We downloaded all complete, high-coverage SARS-CoV-2 genomes available through GISAID <xref rid="ref12" ref-type="bibr">[12]</xref> on June 12, 2020. Each of these sequences had between 29000 and 31000 base pairs. We then removed sequences from all countries with fewer than 10 sequences. We then removed duplicate sequences within each country, but keeping at least 10 sequences per country (i.e., if removing duplicates for a country resulted in fewer then 10 sequences for that country, then we allowed some duplicates to remain). Since some countries had a very large number of sequences in the dataset, we then down-sampled sequences from such countries to create a more equitable distribution of sequences per country. Specifically, if a country had more than 100 sequences, we randomly chose 100 sequences for that country. This resulted in a dataset of 2123 SARS-CoV-2 strain sequences from across 59 countries.</p>
      <p>We aligned the 2123 sequences using Clustal Omega<xref rid="ref31" ref-type="bibr">[31]</xref> and reconstructed maximum likelihood phylogenies using RAxML <xref rid="ref34" ref-type="bibr">[34]</xref> under the GTRGAMMA model. In all, we constructed one maximum likelihood phylogeny along with 10 bootstrap replicates. The resulting 11 phylogenies were rooted and dated using TreeTime <xref rid="ref28" ref-type="bibr">[28]</xref>, which is also used by the Nextstrain pipeline.</p>
      <p>This dataset of 2123 SARS-CoV-2 sequences, including sequence alignment, metadata, and reconstructed phylogenetic trees, is freely available from: <uri xlink:href="https://compbio.engr.uconn.edu/global_covid-19_dataset/">https://compbio.engr.uconn.edu/global_covid-19_dataset/</uri>.</p>
    </sec>
    <sec id="sec6.2">
      <label>6.2</label>
      <title>Geographical Transmission Network Inference</title>
      <p>We applied TNet, random sampling, and the Nextstrain/Augur tool to this dataset to infer international (country-to-country) transmission networks. Observe that such <italic>geographical transmission networks</italic> are distinct from usual disease transmission networks in that (i) most pairs of countries or geographical regions can be expected to be connected through transmission edges, and (ii) transmissions between pairs of counties likely occur in both directions. Thus, the information of interest in geographical transmission networks is not merely the presence of edges between pairs of countries/regions, but the <italic>magnitude</italic> and <italic>time periods</italic> of transmission. Accordingly, in our inferred transmission networks, each transmission edge between an ordered pair of countries <inline-formula><tex-math notation="LaTeX" id="M509">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(A, B)$\end{document}</tex-math><alternatives><mml:math id="M510"><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq251-3096455.jpg"/></alternatives></inline-formula> is labeled with the following additional information:<list list-type="simple"><list-item><label>1)</label><p>The number of separate transmission events from <inline-formula><tex-math notation="LaTeX" id="M511">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$A$\end{document}</tex-math><alternatives><mml:math id="M512"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq252-3096455.jpg"/></alternatives></inline-formula> to <inline-formula><tex-math notation="LaTeX" id="M513">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$B$\end{document}</tex-math><alternatives><mml:math id="M514"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq253-3096455.jpg"/></alternatives></inline-formula>.</p></list-item><list-item><label>2)</label><p>The number of such separate transmissions occurring during each month (December 2019 through May 2020).</p></list-item></list></p>
      <p>This information can be directly obtained from the optimal host assignments computed by each method by assigning a date to each internal node of the phylogenetic trees used for the inference (which we obtained using TreeTime, as described above) and then counting the number of edges <inline-formula><tex-math notation="LaTeX" id="M515">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$({pa}(x), x)$\end{document}</tex-math><alternatives><mml:math id="M516"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq254-3096455.jpg"/></alternatives></inline-formula> in the host-assigned phylogeny for which <inline-formula><tex-math notation="LaTeX" id="M517">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${pa}(x)$\end{document}</tex-math><alternatives><mml:math id="M518"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="bansal-ieq255-3096455.jpg"/></alternatives></inline-formula> is assigned host <inline-formula><tex-math notation="LaTeX" id="M519">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$A$\end{document}</tex-math><alternatives><mml:math id="M520"><mml:mi>A</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq256-3096455.jpg"/></alternatives></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="M521">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$x$\end{document}</tex-math><alternatives><mml:math id="M522"><mml:mi>x</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq257-3096455.jpg"/></alternatives></inline-formula> is assigned host <inline-formula><tex-math notation="LaTeX" id="M523">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$B$\end{document}</tex-math><alternatives><mml:math id="M524"><mml:mi>B</mml:mi></mml:math><inline-graphic xlink:href="bansal-ieq258-3096455.jpg"/></alternatives></inline-formula>.</p>
      <p>For TNet and random sampling, we inferred the geographical transmission network by applying those methods to the 10 bootstrap replicate phylogenies, computing 100 samples for each. This resulted in 1000 optimal host assignments for each of these two methods. To compute a single geographical transmission network from these 1000 host assignments, we averaged the numbers of inferred transmission events between ordered pair of countries for each time period over all 1000 host assignments. Since Nextstrain/augur is not based on sampling, we computed the geographical transmission network for Nextstrain by using the maximum likelihood phylogeny from RAxML.</p>
    </sec>
    <sec id="sec6.3">
      <label>6.3</label>
      <title>Evaluation of Geographical Transmission Networks</title>
      <p>We performed two kinds of comparisons between the geographical transmission networks inferred by the three different methods. First, we used the available “ground-truth” data available for each strain included in the analysis. Specifically, we used the known country/region of exposure, likely inferred through contact tracing, available in the metadata for each SARS-CoV-2 sequence. This allowed us to use the host assignment for the parent of each leaf node in the host-assigned phylogenies and infer the accuracy of those assignments for each method by comparing to the known country/region of exposure for that leaf. For TNet and random sampling, which use multiple trees and samples, we used the most frequently assigned host for each parent node as its final assignment. Note that for 17 of the 2123 sequences the country of exposure was a country that was not included in our analysis.</p>
      <p>Second, we performed a systematic comparison of the geographical transmission networks inferred by the three methods by identifying, for each method, the top five most frequent spreader countries for each time period (month) and the top five receiving countries for each time period. We also repeated this comparative analysis with respect to United States of America (USA) by identifying the top five spreaders to USA and top five recipients from USA during each time period.</p>
    </sec>
    <sec id="sec6.4">
      <label>6.4</label>
      <title>Results</title>
      <p><italic>Overall Accuracies of the Methods Based on Ground-Truth.</italic> By comparing the international transmission networks inferred by the three methods against the known country of exposure available for each SARS-CoV-2 sequence, we found that TNet significantly outperformed Nextstrain and that random sampling dramatically outperformed both Nextstrain and TNet. Specifically, Nextstrain, TNet, and random sampling were able to correctly determine the country of exposure correctly for 67, 71, and 85 percent of the sequences, respectively. These results are shown in <xref rid="fig8" ref-type="fig">Fig. 8</xref>.</p>
      <fig position="float" id="fig8">
        <label>Fig. 8.</label>
        <caption>
          <p>Accuracy of Nextstrain, TNet, and random sampling on the COVID-19 dataset based on the known country of exposure available for each SARS-CoV-2 sequence.</p>
        </caption>
        <graphic xlink:href="bansa8-3096455" position="float"/>
      </fig>
      <p>It is worth noting that the superiority of random sampling over TNet is not surprising for this application. This is because, for geographical transmission networks, there is no expectation that back-transmissions should be rare. In fact, back-transmissions are expected to occur freely and frequently. Thus, random sampling is expected to outperform TNet for geographical transmission network inference. Surprisingly, TNet still outperforms Nextstrain in this analysis. These results suggest that our random sampling framework may prove highly useful for estimating geographical transmission networks as well as for estimating other transmission networks in other settings where back-transmissions can occur freely.</p>
      <p><italic>Comparison of Inferred International Transmission Networks.</italic> To systematically compare the international transmission networks inferred by the three methods, we computed, for each method, the top five most frequent spreader countries for each time period (month) and the top five receiving countries for each time period. <xref rid="fig9" ref-type="fig">Figs. 9</xref> and <xref rid="fig10" ref-type="fig">10</xref> show the results of this analysis. As the figures show, there is both agreement and disagreement between the transmission networks inferred by the three methods. Considering spreader countries (<xref rid="fig9" ref-type="fig">Fig. 9</xref>), we find that there is agreement among all methods that China was the primary spreader during December 2019 and January 2020, but that it ceases to be among the top five spreaders February 2020 onward. On the other hand, while Nextstrain infers that the majority of spread from China occurred in January 2020, TNet and random sampling both infer that the majority of the spread from China occurred in December 2019. All methods also agree that February 2020 was the most active month for the spread of COVID-19, and that international spread was essentially over by April 2020. For most months, there is considerable variation in the top spreader countries identified by the three methods; for instance, for December 2019, only one country is common among the top five inferred by Nextrain and either of other two methods, and only two are in common between TNet and random sampling. Notably, both TNet and random sampling identity USA as an early and important contributor to the spread of COVID-19, while Nextstrain does not include USA in its top five list until March 2020. Considering receiver countries (<xref rid="fig10" ref-type="fig">Fig. 10</xref>), we find that there is generally more agreement between the three methods. For instance, all methods agree that generally Asian countries and Australia acted as major recipients during December 2019 and January 2020, and that European countries became the major receivers during February and March 2020. The methods also mostly agree that USA was a major recipient during all months from December 2019 to March 2020.</p>
      <fig position="float" id="fig9">
        <label>Fig. 9.</label>
        <caption>
          <p>Top five spreader countries inferred by Nextstrain, TNet, and Random Sampling during each month from December 2019 through April 2020.</p>
        </caption>
        <graphic xlink:href="bansa9-3096455" position="float"/>
      </fig>
      <fig position="float" id="fig10">
        <label>Fig. 10.</label>
        <caption>
          <p>Top five receiver countries inferred by Nextstrain, TNet, and Random Sampling during each month from December 2019 through April 2020.</p>
        </caption>
        <graphic xlink:href="bansa10-3096455" position="float"/>
      </fig>
      <p>To further analyse the differences between these transmission networks, we used USA as the “base” country and identified the top five spreaders to USA and top five recipients from USA during each time period. These results are shown in Supplementary Figs. S1 and S2, which can be found on the Computer Society Digital Library at <uri xlink:href="http://doi.ieeecomputersociety.org/10.1109/TCBB.2021.3096455">http://doi.ieeecomputersociety.org/10.1109/TCBB.2021.3096455</uri>. Considering spreader countries (Supplementary Fig. S1, available online), we find that there is generally good agreement between the top five lists of TNet and random sampling for the months December 2019 through February 2020, but that they have significant differences from the top five lists inferred by Nextstrain for the same periods. However, all methods agree that China was the primary spreader to USA in December 2019 and January 2020 and that France was the primary spreader in March 2020. Considering receiver countries (Supplementary Fig. S2, available online), we find considerable agreement between between the top five lists of TNet and random sampling for the months December 2019 through March 2020. However, as with spreader countries, there are considerable differences between the top five countries for each period inferred by Nextstrain and those inferred by TNet or random sampling. However, all methods identify Canada and France as major receivers of COVID-19 from USA. Notably, TNet and random sampling also identity China as a major recipient of infections from USA during December 2919 and January 2020, and identify Taiwan as one of the top receivers of infections from USA.</p>
      <p><italic>State-Level Analysis.</italic> We also repeated the above analysis to infer the state-level transmission network within USA. We downloaded available SARS-CoV-2 sequences from USA in July 2020 using the same process as described above, and this resulted in a dataset of 1801 SARS-CoV-2 sequences from 30 states, with each state represented by between 10 and 100 sequences. We applied the three methods to this dataset, computing a sequence alignment and phylogenetic trees using the same methods described before, and obtained the geographical (state-to-state) transmission network implied by each method. We compared the transmission networks inferred by the three methods against the known state of exposure available for each SARS-CoV-2 sequence. (Note that for 10 of the 1801 sequences the state of exposure was a country or state that was not included in our analysis.) As before, we found that TNet significantly outperformed Nextstrain and that random sampling dramatically outperformed both Nextstrain and TNet. Specifically, Nextstrain, TNet, and random sampling were able to correctly determine the state of exposure correctly for 65, 73, and 86 percent of the sequences, respectively.</p>
      <p>As before, we also compared the state-level transmission networks inferred by the three method by inferring the top five most frequent spreader and receiver states for each time period (month). These results are shown in <xref rid="fig11" ref-type="fig">Figs. 11</xref> and <xref rid="fig12" ref-type="fig">12</xref>. As these figures show, TNet and random sampling generally agree in their lists of top spreaders and receivers, but that those lists differ significantly from those inferred by Nextstrain. For instance, Nextstrain infers Virginia and Pennsylvania as the top two spreader states during February 2020, but these states do not feature in the top five spreader lists for TNet and random sampling during any time period. All methods agree that the months of February and March 2020 had, by far, the most spread of COVID-19, and that the top spreader states in March were New York and California.</p>
      <p><italic>Running Time and Scalability.</italic> A key strength of TNet (and also the implementation of the random sampling method in TNet) is that it is extremely fast and highly scalable. For example, each run of TNet on the global COVID-19 dataset with 2123 sequences required only 1.2 seconds using a single core on a commodity desktop computer with a 3.00 GHz 6-core Intel i5-8500 CPU and 16 GB of RAM. Thus, the entire TNet (and also random sampling) analysis consisting of 1000 runs (computing 100 sample host assignments for each of the 10 bootstrap phylogenies) took less than 20 minutes.</p>
      <fig position="float" id="fig11">
        <label>Fig. 11.</label>
        <caption>
          <p>Top five spreader states in USA inferred by Nextstrain, TNet, and Random Sampling during each month from Dec. 2019 through June 2020.</p>
        </caption>
        <graphic xlink:href="bansa11-3096455" position="float"/>
      </fig>
      <fig position="float" id="fig12">
        <label>Fig. 12.</label>
        <caption>
          <p>Top five receiver states in USA inferred by Nextstrain, TNet, and Random Sampling during each month from Dec. 2019 through June 2020.</p>
        </caption>
        <graphic xlink:href="bansa12-3096455" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec id="sec7">
    <label>7</label>
    <title>Discussion</title>
    <p>In this paper, we introduced TNet, a new method for transmission network inference when multiple strain sequences are sampled from the infected hosts. TNet has two distinguishing features: First, it systematically accounts for variability among different optimal solutions to efficiently compute support values for individual transmission edges and improve transmission inference accuracy, and second, its objective function seeks to find those optimal host assignments that minimize the number of back-transmissions. TNet is based on a relatively simple parsimony-based formulation and is parameter-free and highly scalable. It can be easily applied within seconds to datasets with many hundreds of strain sequences and hosts. As our experimental results on both simulated and real datasets show, TNet is highly accurate and significantly outperforms phyloscanner. We find that TNet also outperforms SharpTNI, a distinct but very similar method developed independently and published recently. We also show how TNet as well as the closely related random sampling method (also implemented in TNet) can be used to infer geographical transmission networks and our analysis using large-scale COVID-19 data demonstrates how TNet and random sampling both significantly outperform the popular Nextstrain/Augur method.</p>
    <p>Going forward, several aspects of TNet can be tested and improved further. The simulated datasets used in our experimental study assume that all infected hosts have been sampled. It would be useful to test how accuracy decreases as fewer and fewer infected hosts are sampled. Phyloscanner employs a simple technique to estimate if an ancestral host assignment may be to an unsampled host, and a similar technique could be used in TNet. Currently, TNet does not make use of branch lengths or of overall strain diversity within hosts, and these could be used to further improve the accuracy of ancestral host assignment and transmission network inference. Likewise, it should be possible to easily model contact-network information within the TNet framework, simply by having different penalties (or costs) for transmissions between connected hosts versus unconnected hosts. Finally, the potential of random sampling for inferring geographical transmission networks is worth investigating and developing further.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>The authors would like to thank Dr. Pavel Skums, Georgia State University, and the Centers for Disease Control for sharing their HCV outbreak data, and all authors/organizations who shared their COVID-19 data through GISAID (see supplement for link to full list, available online). The authors would also like to thank Samuel Sledzieski for sharing the simulated transmission network datasets. Chengchen Zhang contributed to this work.</p>
    <p>Funding: This work was supported in part by U.S National Science Foundation (NSF) Award CCF 1618347 to IM and MSB.</p>
  </ack>
  <bio id="bio1">
    <p><xref rid="contrib1" ref-type="contrib">Saurav Dhar</xref> received the BSc degree in computer science and engineering from the Bangladesh University of Engineering and Technology in 2017. He is currently working toward the master's degree in computer science and engineering with the University of Connecticut, USA. His research interests include algorithm development, bioinformatics, and machine learning.</p>
  </bio>
  <bio id="bio2">
    <p><xref rid="contrib2" ref-type="contrib">Chengchen Zhang</xref> received the BS degree in computer science and engineering and the BA degree in economics from the University of Connecticut, USA, in 2018, and the MS degree in computer science from the University of California at San Diego, USA, in 2020. He is currently a software engineer in San Diego, USA.</p>
  </bio>
  <bio id="bio3">
    <p><xref rid="contrib3" ref-type="contrib">Ion I. Măndoiu</xref> received the MS degree in computer science from Bucharest University in 1992 and the PhD degree in computer science from the Georgia Institute of Technology in 2000. He is currently a professor of computer science and engineering with the University of Connecticut. He has authored or coauthored more than 130 refereed articles in journals and conference proceedings and 13 book chapters, and has also co-edited 11 conference proceedings and two books published in the Wiley Book Series on Bioinformatics. His research interests include bioinformatics and computational genomics, with a special focus on the development of computational methods for the analysis of high-throughput sequencing data.</p>
  </bio>
  <bio id="bio4">
    <p><xref rid="contrib4" ref-type="contrib">Mukul S. Bansal</xref> received the PhD degree in computer science from Lowa State University in 2009. He is currently an associate professor with the Department of Computer Science and Engineering, University of Connecticut, USA. His research interests include computational biology and bioinformatics, with an emphasis on computational molecular evolution. He was an Edmond J. Safra postdoctoral fellow with the School of Computer Science, Tel Aviv University till December 2010 and a postdoctoral associate with Computer Science and Artificial Intelligence Laboratory, Massachusetts Institute of Technology till August 2013.</p>
  </bio>
  <ref-list>
    <title>References</title>
    <ref id="ref1">
      <label>[1]</label>
      <mixed-citation publication-type="book" publication-format="print"><person-group person-group-type="author"><string-name><given-names>R.</given-names><surname>Albert</surname></string-name> and <string-name><given-names>A.-L.</given-names><surname>Barabási</surname></string-name></person-group>. <source>Statistical Mechanics of Complex Networks</source>. <publisher-loc>Notre Dame, IN, USA</publisher-loc>: <publisher-name>Univ. Notre Dame</publisher-name>, <year>2002</year>.</mixed-citation>
    </ref>
    <ref id="ref2">
      <label>[2]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>N.</given-names><surname>Beerenwinkel</surname></string-name>, <etal>et al.</etal></person-group>, “<article-title>Computational methods for the design of effective therapies against drug resistant HIV strains</article-title>,” <source>Bioinformatics</source>, vol. <volume>21</volume>, pp. <fpage>3943</fpage>–<lpage>3950</lpage>, <year>2005</year>.<pub-id pub-id-type="pmid">16144807</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <label>[3]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>D.</given-names><surname>Clutter</surname></string-name>, <etal>et al.</etal></person-group>, “<article-title>Trends in the molecular epidemiology and genetic mechanisms of transmitted human immunodeficiency virus type 1 drug resistance in a large US clinic population</article-title>,” <source>Clin. Infect. Dis.</source>, vol. <volume>68</volume>, no. <issue>2</issue>, pp. <fpage>213</fpage>–<lpage>221</lpage>, <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="ref4">
      <label>[4]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>N.</given-names><surname>De Maio</surname></string-name>, <string-name><given-names>C. J.</given-names><surname>Worby</surname></string-name>, <string-name><given-names>D. J.</given-names><surname>Wilson</surname></string-name>, and <string-name><given-names>N.</given-names><surname>Stoesser</surname></string-name></person-group>, “<article-title>Bayesian reconstruction of transmission within outbreaks using genomic variants</article-title>,” <source>PLoS Comput. Biol.</source>, vol. <volume>14</volume>, no. <issue>4</issue>, pp. <fpage>1</fpage>–<lpage>23</lpage>, <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="ref5">
      <label>[5]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>N.</given-names><surname>De Maio</surname></string-name>, <string-name><given-names>C.-H.</given-names><surname>Wu</surname></string-name>, and <string-name><given-names>D. J.</given-names><surname>Wilson</surname></string-name></person-group>, “<article-title>SCOTTI: Efficient reconstruction of transmission within outbreaks with the structured coalescent</article-title>,” <source>PLoS Comput. Biol.</source>, vol. <volume>12</volume>, no. <issue>9</issue>, pp. <fpage>1</fpage>–<lpage>23</lpage>, <year>2016</year>.</mixed-citation>
    </ref>
    <ref id="ref6">
      <label>[6]</label>
      <mixed-citation publication-type="confproc" publication-format="print"><person-group person-group-type="author"><string-name><given-names>S.</given-names><surname>Dhar</surname></string-name>, <string-name><given-names>C.</given-names><surname>Zhang</surname></string-name>, <string-name><given-names>I.</given-names><surname>Mandoiu</surname></string-name>, and <string-name><given-names>M. S.</given-names><surname>Bansal</surname></string-name></person-group>, “<article-title>TNet: Phylogeny-based inference of disease transmission networks using within-host strain diversity</article-title>,” in <source>Proc. Int. Symp. Bioinf. Res. Appl.</source>, <conf-date>2020</conf-date>, pp. <fpage>203</fpage>–<lpage>216</lpage>.</mixed-citation>
    </ref>
    <ref id="ref7">
      <label>[7]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>X.</given-names><surname>Didelot</surname></string-name>, <string-name><given-names>C.</given-names><surname>Fraser</surname></string-name>, <string-name><given-names>J.</given-names><surname>Gardy</surname></string-name>, <string-name><given-names>C.</given-names><surname>Colijn</surname></string-name>, and <string-name><given-names>H.</given-names><surname>Malik</surname></string-name></person-group>, “<article-title>Genomic infectious disease epidemiology in partially sampled and ongoing outbreaks</article-title>,” <source>Mol. Biol. Evol.</source>, vol. <volume>34</volume>, no. <issue>4</issue>, pp. <fpage>997</fpage>–<lpage>1007</lpage>, <year>2017</year>.<pub-id pub-id-type="pmid">28100788</pub-id></mixed-citation>
    </ref>
    <ref id="ref8">
      <label>[8]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>E.</given-names><surname>Domingo</surname></string-name>, <etal>et al.</etal></person-group>, “<article-title>The quasispecies (extremely heterogeneous) nature of viral RNA genome populations: Biological relevance – Review</article-title>,” <source>Gene</source>, vol. <volume>40</volume>, pp. <fpage>1</fpage>–<lpage>8</lpage>, <year>1985</year>.</mixed-citation>
    </ref>
    <ref id="ref9">
      <label>[9]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>E.</given-names><surname>Domingo</surname></string-name> and <string-name><given-names>J.</given-names><surname>Holland</surname></string-name></person-group>, “<article-title>RNA virus mutations and fitness for survival</article-title>,” <source>Annu. Rev. Microbiol.</source>, vol. <volume>51</volume>, pp. <fpage>151</fpage>–<lpage>178</lpage>, <year>1997</year>.<pub-id pub-id-type="pmid">9343347</pub-id></mixed-citation>
    </ref>
    <ref id="ref10">
      <label>[10]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>D. D. P. D.</given-names><surname>Kwong</surname></string-name>, and <string-name><given-names>G. J.</given-names><surname>Nabel</surname></string-name></person-group>, “<article-title>The rational design of an AIDS vaccine</article-title>,” <source>Cell</source>, vol. <volume>124</volume>, pp. <fpage>677</fpage>–<lpage>681</lpage>, <year>2006</year>.<pub-id pub-id-type="pmid">16497577</pub-id></mixed-citation>
    </ref>
    <ref id="ref11">
      <label>[11]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>J. W.</given-names><surname>Drake</surname></string-name> and <string-name><given-names>J. J.</given-names><surname>Holland</surname></string-name></person-group>, “<article-title>Mutation rates among RNA viruses</article-title>,” <source>Proc. Nat. Acad. Sci. USA</source>, vol. <volume>96</volume>, no. <issue>24</issue>, pp. <fpage>13910</fpage>–<lpage>13913</lpage>, <conf-date>1999</conf-date>.</mixed-citation>
    </ref>
    <ref id="ref12">
      <label>[12]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>S.</given-names><surname>Elbe</surname></string-name> and <string-name><given-names>G.</given-names><surname>Buckland-Merrett</surname></string-name></person-group>, “<article-title>Data, disease and diplomacy: Gisaid's innovative contribution to global health</article-title>,” <source>Glob. Challenges</source>, vol. <volume>1</volume>, no. <issue>1</issue>, pp. <fpage>33</fpage>–<lpage>46</lpage>, <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="ref13">
      <label>[13]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>W.</given-names><surname>Fitch</surname></string-name></person-group>, “<article-title>Towards defining the course of evolution: Minimum change for a specified tree topology</article-title>,” <source>Syst. Zool.</source>, vol. <volume>20</volume>, pp. <fpage>406</fpage>–<lpage>416</lpage>, <year>1971</year>.</mixed-citation>
    </ref>
    <ref id="ref14">
      <label>[14]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>B.</given-names><surname>Gaschen</surname></string-name>, <etal>et al.</etal></person-group>, “<article-title>Diversity considerations in HIV-1 vaccine selection</article-title>,” <source>Science</source>, vol. <volume>296</volume>, pp. <fpage>2354</fpage>–<lpage>2360</lpage>, <year>2002</year>.<pub-id pub-id-type="pmid">12089434</pub-id></mixed-citation>
    </ref>
    <ref id="ref15">
      <label>[15]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>O.</given-names><surname>Glebova</surname></string-name>, <etal>et al.</etal></person-group>, “<article-title>Inference of genetic relatedness between viral quasispecies from sequencing data</article-title>,” <source>BMC Genomic.</source>, vol. <volume>18</volume>, no. <issue>Suppl 10</issue>, <year>2017</year>, Art. no. 918.</mixed-citation>
    </ref>
    <ref id="ref16">
      <label>[16]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>A.</given-names><surname>Grulich</surname></string-name>, <etal>et al.</etal></person-group>, “<article-title>A10 using the molecular epidemiology of HIV transmission in New South Wales to inform public health response: Assessing the representativeness of linked phylogenetic data</article-title>,” <source>Virus Evol.</source>, vol. <volume>4</volume>, no. <issue>suppl_1</issue>, <year>2018</year>, Art. no. vey010.009.</mixed-citation>
    </ref>
    <ref id="ref17">
      <label>[17]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>J.</given-names><surname>Hadfield</surname></string-name>, <etal>et al.</etal></person-group>, “<article-title>Nextstrain: real-time tracking of pathogen evolution</article-title>,” <source>Bioinformatics</source>, vol. <volume>34</volume>, no. <issue>23</issue>, pp. <fpage>4121</fpage>–<lpage>4123</lpage>, <year>2018</year>.<pub-id pub-id-type="pmid">29790939</pub-id></mixed-citation>
    </ref>
    <ref id="ref18">
      <label>[18]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>M.</given-names><surname>Hall</surname></string-name>, <string-name><given-names>M.</given-names><surname>Woolhouse</surname></string-name>, and <string-name><given-names>A.</given-names><surname>Rambaut</surname></string-name></person-group>, “<article-title>Epidemic reconstruction in a phylogenetics framework: Transmission trees as partitions of the node set</article-title>,” <source>PLoS Comp. Biol.</source>, vol. <volume>11</volume>, no. <issue>12</issue>, <year>2015</year>, Art. no. e1004613.</mixed-citation>
    </ref>
    <ref id="ref19">
      <label>[19]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>J.</given-names><surname>Holland</surname></string-name>, <string-name><given-names>J.</given-names><surname>de la Torre</surname></string-name>, and <string-name><given-names>D.</given-names><surname>Steinhauer</surname></string-name></person-group>, “<article-title>RNA virus populations as quasispecies</article-title>,” <source>Curr. Top. Microbiol. Immunol.</source>, vol. <volume>176</volume>, pp. <fpage>1</fpage>–<lpage>20</lpage>, <year>1992</year>.</mixed-citation>
    </ref>
    <ref id="ref20">
      <label>[20]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>W. O.</given-names><surname>Kermack</surname></string-name>, <string-name><given-names>A. G.</given-names><surname>McKendrick</surname></string-name>, and <string-name><given-names>G. T.</given-names><surname>Walker</surname></string-name></person-group>, “<article-title>A contribution to the mathematical theory of epidemics</article-title>,” <source>Proc. Roy. Soc. London</source>, vol. <volume>115</volume>, no. <issue>772</issue>, pp. <fpage>700</fpage>–<lpage>721</lpage>, <conf-date>1927</conf-date>.</mixed-citation>
    </ref>
    <ref id="ref21">
      <label>[21]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>D.</given-names><surname>Klinkenberg</surname></string-name>, <string-name><given-names>J. A.</given-names><surname>Backer</surname></string-name>, <string-name><given-names>X.</given-names><surname>Didelot</surname></string-name>, <string-name><given-names>C.</given-names><surname>Colijn</surname></string-name>, and <string-name><given-names>J.</given-names><surname>Wallinga</surname></string-name></person-group>,“<article-title>Simultaneous inference of phylogenetic and transmission trees in infectious disease outbreaks</article-title>,” <source>PLoS Comput. Biol.</source>, vol. <volume>13</volume>, no. <issue>5</issue>, <year>2017</year>, Art. no. e1005495.</mixed-citation>
    </ref>
    <ref id="ref22">
      <label>[22]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>S. L.</given-names><surname>Kosakovsky Pond</surname></string-name>, <string-name><given-names>S.</given-names><surname>Weaver</surname></string-name>, <string-name><given-names>A. J.</given-names><surname>Leigh Brown</surname></string-name>, and <string-name><given-names>J. O.</given-names><surname>Wertheim</surname></string-name></person-group>, “<article-title>HIV-TRACE (transmission cluster engine): A tool for large scale molecular epidemiology of HIV-1 and other rapidly evolving pathogens</article-title>,” <source>Mol. Biol. Evol.</source>, vol. <volume>35</volume>, no. <issue>7</issue>, pp. <fpage>1812</fpage>–<lpage>1819</lpage>, <year>2018</year>.<pub-id pub-id-type="pmid">29401317</pub-id></mixed-citation>
    </ref>
    <ref id="ref23">
      <label>[23]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>M. E. M. J.</given-names><surname>McCaskill</surname></string-name>, and <string-name><given-names>P.</given-names><surname>Schuster</surname></string-name></person-group>, “<article-title>The molecular quasi-species</article-title>,” <source>Adv. Chem. Phys.</source>, vol. <volume>75</volume>, pp. <fpage>149</fpage>–<lpage>263</lpage>, <year>1989</year>.</mixed-citation>
    </ref>
    <ref id="ref24">
      <label>[24]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>M.</given-names><surname>Martell</surname></string-name>, <etal>et al.</etal></person-group>, “<article-title>Hepatitis C virus (HCV) circulates as a population of different but closely related genomes: Quasispecies nature of HCV genome distribution</article-title>,” <source>J. Virol.</source>, vol. <volume>66</volume>, pp. <fpage>3225</fpage>–<lpage>3229</lpage>, <year>1992</year>.<pub-id pub-id-type="pmid">1313927</pub-id></mixed-citation>
    </ref>
    <ref id="ref25">
      <label>[25]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>N.</given-names><surname>Moshiri</surname></string-name>, <string-name><given-names>J. O.</given-names><surname>Wertheim</surname></string-name>, <string-name><given-names>M.</given-names><surname>Ragonnet-Cronin</surname></string-name>, and <string-name><given-names>S.</given-names><surname>Mirarab</surname></string-name></person-group>, “<article-title>FAVITES: Simultaneous simulation of transmission networks, phylogenetic trees and sequences</article-title>,” <source>Bioinformatics</source>, vol. <volume>35</volume>, no. <issue>11</issue>, pp. <fpage>1852</fpage>–<lpage>1861</lpage>, <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="ref26">
      <label>[26]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>S.-Y.</given-names><surname>Rhee</surname></string-name>, <string-name><given-names>T.</given-names><surname>Liu</surname></string-name>, <string-name><given-names>S.</given-names><surname>Holmes</surname></string-name>, and <string-name><given-names>R.</given-names><surname>Shafer</surname></string-name></person-group>, “<article-title>HIV-1 subtype B protease and reverse transcriptase amino acid covariation</article-title>,” <source>PLOS Comput. Biol.</source>, vol. <volume>3</volume>, no. <issue>5</issue>, <year>2007</year>, Art. no. e87.</mixed-citation>
    </ref>
    <ref id="ref27">
      <label>[27]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>E. O.</given-names><surname>Romero-Severson</surname></string-name>, <string-name><given-names>I.</given-names><surname>Bulla</surname></string-name>, and <string-name><given-names>T.</given-names><surname>Leitner</surname></string-name></person-group>, “<article-title>Phylogenetically resolving epidemiologic linkage</article-title>,” <source>Proc. Nat. Acad. Sci. USA</source>, vol. <volume>113</volume>, no. <issue>10</issue>, pp. <fpage>2690</fpage>–<lpage>2695</lpage>, <conf-date>2016</conf-date>.</mixed-citation>
    </ref>
    <ref id="ref28">
      <label>[28]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>P.</given-names><surname>Sagulenko</surname></string-name>, <string-name><given-names>V.</given-names><surname>Puller</surname></string-name>, and <string-name><given-names>R. A.</given-names><surname>Neher</surname></string-name></person-group>, “<article-title>Treetime: Maximum-likelihood phylodynamic analysis</article-title>,” <source>Virus Evol.</source>, vol. <volume>4</volume>, no. <issue>1</issue>, <year>2018</year>, Art. no. vex042.</mixed-citation>
    </ref>
    <ref id="ref29">
      <label>[29]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>D.</given-names><surname>Sankoff</surname></string-name></person-group>, “<article-title>Minimal mutation trees of sequences</article-title>,” <source>SIAM J. Appl. Math.</source>, vol. <volume>28</volume>, no. <issue>1</issue>, pp. <fpage>35</fpage>–<lpage>42</lpage>, <year>1975</year>.</mixed-citation>
    </ref>
    <ref id="ref30">
      <label>[30]</label>
      <mixed-citation publication-type="periodical" publication-format="print"><person-group person-group-type="author"><string-name><given-names>P.</given-names><surname>Sashittal</surname></string-name> and <string-name><given-names>M.</given-names><surname>El-Kebir</surname></string-name></person-group>, “<article-title>SharpTNI: Counting and sampling parsimonious transmission networks under a weak bottleneck</article-title>,” <year>2019</year>, bioRxiv 842237.</mixed-citation>
    </ref>
    <ref id="ref31">
      <label>[31]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>F.</given-names><surname>Sievers</surname></string-name> and <string-name><given-names>D. G.</given-names><surname>Higgins</surname></string-name></person-group>, “<article-title>Clustal Omega</article-title>,” <source>Curr. Protocols Bioinf.</source>, vol. <volume>48</volume>, no. <issue>1</issue>, pp. <fpage>3.13.1</fpage>–<lpage>3.13.16</lpage>, <year>2014</year>.</mixed-citation>
    </ref>
    <ref id="ref32">
      <label>[32]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>P.</given-names><surname>Skums</surname></string-name>, <etal>et al.</etal></person-group>, “<article-title>QUENTIN: Reconstruction of disease transmissions from viral quasispecies genomic data</article-title>,” <source>Bioinformatics</source>, vol. <volume>34</volume>, no. <issue>1</issue>, pp. <fpage>163</fpage>–<lpage>170</lpage>, <year>2018</year>.<pub-id pub-id-type="pmid">29304222</pub-id></mixed-citation>
    </ref>
    <ref id="ref33">
      <label>[33]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>S.</given-names><surname>Sledzieski</surname></string-name>, <string-name><given-names>C.</given-names><surname>Zhang</surname></string-name>, <string-name><given-names>I.</given-names><surname>Mandoiu</surname></string-name>, and <string-name><given-names>M. S.</given-names><surname>Bansal</surname></string-name></person-group>, “<article-title>TreeFix-TP: Phylogenetic error-correction for infectious disease transmission network inference</article-title>,” <source>Biocomputing</source>, vol. <volume>26</volume>, pp. <fpage>119</fpage>–<lpage>130</lpage>, <year>2021</year>.<pub-id pub-id-type="pmid">33691010</pub-id></mixed-citation>
    </ref>
    <ref id="ref34">
      <label>[34]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>A.</given-names><surname>Stamatakis</surname></string-name></person-group>, “<article-title>RAxML version 8: A tool for phylogenetic analysis and post-analysis of large phylogenies</article-title>,” <source>Bioinformatics</source>, vol. <volume>30</volume>, no. <issue>9</issue>, pp. <fpage>1312</fpage>–<lpage>1313</lpage>, <year>2014</year>.<pub-id pub-id-type="pmid">24451623</pub-id></mixed-citation>
    </ref>
    <ref id="ref35">
      <label>[35]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>R. A.</given-names><surname>Stein</surname></string-name></person-group>, “<article-title>Super-spreaders in infectious diseases</article-title>,” <source>Int. J. Infect. Dis.</source>, vol. <volume>15</volume>, no. <issue>8</issue>, pp. <fpage>e510</fpage>–<lpage>e513</lpage>, <year>2011</year>.<pub-id pub-id-type="pmid">21737332</pub-id></mixed-citation>
    </ref>
    <ref id="ref36">
      <label>[36]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>D.</given-names><surname>Steinhauer</surname></string-name> and <string-name><given-names>J.</given-names><surname>Holland</surname></string-name></person-group>, “<article-title>Rapid evolution of RNA viruses</article-title>,” <source>Annu. Rev. Microbiol.</source>, vol. <volume>41</volume>, pp. <fpage>409</fpage>–<lpage>433</lpage>, <year>1987</year>.<pub-id pub-id-type="pmid">3318675</pub-id></mixed-citation>
    </ref>
    <ref id="ref37">
      <label>[37]</label>
      <mixed-citation publication-type="journal" publication-format="print"><person-group person-group-type="author"><string-name><given-names>C.</given-names><surname>Wymant</surname></string-name>, <etal>et al.</etal></person-group>, “<article-title>PHYLOSCANNER: Inferring transmission from within- and between-host pathogen genetic diversity</article-title>,” <source>Mol. Biol. Evol.</source>, vol. <volume>35</volume>, no. <issue>3</issue>, pp. <fpage>719</fpage>–<lpage>733</lpage>, <year>2017</year>.</mixed-citation>
    </ref>
  </ref-list>
</back>
