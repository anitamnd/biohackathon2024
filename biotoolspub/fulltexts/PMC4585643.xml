<?DTDIdentifier.IdentifierValue -//NPG//DTD XML Article//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName NPG_XML_Article.dtd?>
<?SourceDTD.Version 2.7.10?>
<?ConverterInfo.XSLTName nature2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4585643</article-id>
    <article-id pub-id-type="pii">srep14283</article-id>
    <article-id pub-id-type="doi">10.1038/srep14283</article-id>
    <article-id pub-id-type="pmid">26381817</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SeqMule: automated pipeline for analysis of human exome/genome sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Guo</surname>
          <given-names>Yunfei</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ding</surname>
          <given-names>Xiaolei</given-names>
        </name>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shen</surname>
          <given-names>Yufeng</given-names>
        </name>
        <xref ref-type="aff" rid="a4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lyon</surname>
          <given-names>Gholson J.</given-names>
        </name>
        <xref ref-type="aff" rid="a5">5</xref>
        <xref ref-type="aff" rid="a6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Kai</given-names>
        </name>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="aff" rid="a2">2</xref>
        <xref ref-type="aff" rid="a6">6</xref>
        <xref ref-type="aff" rid="a7">7</xref>
      </contrib>
      <aff id="a1"><label>1</label><institution>Zilkha Neurogenetic Institute, University of Southern California</institution>, Los Angeles, CA 90033, <country>USA</country></aff>
      <aff id="a2"><label>2</label><institution>Department of Preventive Medicine, Keck School of Medicine, University of Southern California</institution>, Los Angeles, CA 90032, <country>USA</country></aff>
      <aff id="a3"><label>3</label><institution>School of Forestry and Environment, Nanjing Forestry University</institution>, Nanjing, Jiangsu 210037, <country>China</country></aff>
      <aff id="a4"><label>4</label><institution>Departments of Systems Biology and Biomedical Informatics, Columbia University</institution>, New York, NY 10032, <country>USA</country></aff>
      <aff id="a5"><label>5</label><institution>Stanley Institute for Cognitive Genomics, Cold Spring Harbor Laboratory</institution>, New York, NY 11797, <country>USA</country></aff>
      <aff id="a6"><label>6</label><institution>Utah Foundation for Biomedical Research</institution>, 150 S 100 W, Provo, UT, 84601, <country>USA</country></aff>
      <aff id="a7"><label>7</label><institution>Department of Psychiatry &amp; Behavioral Sciences, Keck School of Medicine, University of Southern California</institution>, Los Angeles, CA 90033, <country>USA</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email>kaiwang@usc.edu</email>
      </corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>09</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>5</volume>
    <elocation-id>14283</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>02</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>08</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2015, Macmillan Publishers Limited</copyright-statement>
      <copyright-year>2015</copyright-year>
      <copyright-holder>Macmillan Publishers Limited</copyright-holder>
      <license xmlns:xlink="http://www.w3.org/1999/xlink" license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <!--author-paid-->
        <license-p>This work is licensed under a Creative Commons Attribution 4.0 International License. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in the credit line; if the material is not included under the Creative Commons license, users will need to obtain permission from the license holder to reproduce the material. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p>
      </license>
    </permissions>
    <abstract>
      <p>Next-generation sequencing (NGS) technology has greatly helped us identify disease-contributory variants for Mendelian diseases. However, users are often faced with issues such as software compatibility, complicated configuration, and no access to high-performance computing facility. Discrepancies exist among aligners and variant callers. We developed a computational pipeline, SeqMule, to perform automated variant calling from NGS data on human genomes and exomes. SeqMule integrates computational-cluster-free parallelization capability built on top of the variant callers, and facilitates normalization/intersection of variant calls to generate consensus set with high confidence. SeqMule integrates 5 alignment tools, 5 variant calling algorithms and accepts various combinations all by one-line command, therefore allowing highly flexible yet fully automated variant calling. In a modern machine (2 Intel Xeon X5650 CPUs, 48 GB memory), when fast turn-around is needed, SeqMule generates annotated VCF files in a day from a 30X whole-genome sequencing data set; when more accurate calling is needed, SeqMule generates consensus call set that improves over single callers, as measured by both Mendelian error rate and consistency. SeqMule supports Sun Grid Engine for parallel processing, offers turn-key solution for deployment on Amazon Web Services, allows quality check, Mendelian error check, consistency evaluation, HTML-based reports. SeqMule is available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://seqmule.openbioinformatics.org">http://seqmule.openbioinformatics.org</ext-link>.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <p>The development of next-generation sequencing (NGS) technologies has dramatically changed the landscape of human genetics research<xref ref-type="bibr" rid="b1">1</xref><xref ref-type="bibr" rid="b2">2</xref><xref ref-type="bibr" rid="b3">3</xref><xref ref-type="bibr" rid="b4">4</xref><xref ref-type="bibr" rid="b5">5</xref><xref ref-type="bibr" rid="b6">6</xref>. Identifying disease-contributory variants for various human genetic diseases will greatly improve diagnosis and facilitate development of therapies.</p>
  <p>However, besides discrepancies associated with sequencing platforms<xref ref-type="bibr" rid="b7">7</xref>, there is still considerable variation across variant calling algorithms; for example, we previously reported SNV concordance of only 57.4% for 5 bioinformatics pipelines (SOAP, BWA-GATK, BWA-SNVer, GNUMAP, BWA-SAMtools), while 0.5–5.1% variants were called as unique to each pipeline<xref ref-type="bibr" rid="b8">8</xref>. Performance of aligners also varies under different sequencing error rates and indel distribution<xref ref-type="bibr" rid="b9">9</xref>. Yet few published pipelines offer two or more alternative aligner and variant calling programs<xref ref-type="bibr" rid="b10">10</xref><xref ref-type="bibr" rid="b11">11</xref><xref ref-type="bibr" rid="b12">12</xref><xref ref-type="bibr" rid="b13">13</xref><xref ref-type="bibr" rid="b14">14</xref>. While some workflow management systems do provide more flexibility<xref ref-type="bibr" rid="b10">10</xref><xref ref-type="bibr" rid="b11">11</xref><xref ref-type="bibr" rid="b12">12</xref><xref ref-type="bibr" rid="b13">13</xref>, local installation and configuration is highly challenging for average users. Therefore, there is a strong community need for a comprehensive and flexible pipeline that allows easy execution and integration of multiple tools.</p>
  <p>There are multiple challenges for building such a pipeline. Installation and configuration poses the first problem, and the severity of this problem is evidenced by numerous attempts to address it<xref ref-type="bibr" rid="b15">15</xref><xref ref-type="bibr" rid="b16">16</xref><xref ref-type="bibr" rid="b17">17</xref>. Software libraries such as Bioconductor<xref ref-type="bibr" rid="b15">15</xref> and Bioperl<xref ref-type="bibr" rid="b16">16</xref>, and web-based interfaces [e.g.<xref ref-type="bibr" rid="b17">17</xref>] all aim to provide ease of access. The diversity of bioinformatics tools has paradoxically given rise to one more layer of complexity. In a typical variant calling analysis, 4 to 6 tools might be required to perform QC (quality check), alignment, sorting, and variant calling. Ideally, the output from one program can be fed into another one as is. In real-world scenarios, this might not be the case. For instance, GATK does not accept output from SOAP2 aligner. Another issue is that constant and asynchronous development of the software would, from time to time, lead to loss of compatibility and break down of what was working. Even if compatibility issues can be solved, reproducibility will be difficult to maintain across highly heterogeneous pipelines. A pre-packaged virtual machine (VM) provides users with an alternative to address this problem<xref ref-type="bibr" rid="b18">18</xref><xref ref-type="bibr" rid="b19">19</xref><xref ref-type="bibr" rid="b20">20</xref>. However, having two operating systems running on the same machine means at least 1 CPU core and a few gigabytes of memory must be reserved for the host OS, and unavoidably limits the computational resources available for the guest system. Adding another layer of operating system also increases computational overhead by 13% to 28% compared with performance on a native system<xref ref-type="bibr" rid="b19">19</xref>. Finally, VM implementation reduces flexibility of software tools as a bundle and becomes difficult to deploy for average users without informatics skills.</p>
  <p>To address the discrepancy issues without compromising ease of use, performance and reproducibility, we developed a computational pipeline, SeqMule, which performs a series of automated steps for identifying variants from NGS data. It integrates 5 alignment tools, 5 variant calling algorithms, and allows various combinations of them via modifying a text-based, human-readable configuration file. The intersection of sets of variants from different combinations of tools can be extracted to achieve higher accuracy, both in terms of sensitivity and specificity. Most setup procedure and analyses can be done with one-line commands. SeqMule also provides cluster-free parallel capability built on top of the variant callers, which could drastically reduce the time for variant calling by about an approximately linear factor of <italic>N</italic> (<italic>N</italic> is number of CPU cores). As far as we know, only GATK Queue and FreeBayes provide such parallelism among variant callers, but users have to manually set up a Queue or generate a region file for parallel processing. At the end of analysis, an HTML-based report will be prepared to show an overview for every step of the analysis, which helps assure users of data quality and appropriate analysis settings. We believe that SeqMule will be useful to easily and efficiently obtain variant calls from NGS data, and improve variant calling consistency and accuracy.</p>
  <sec disp-level="1" sec-type="materials|methods">
    <title>Material and Methods</title>
    <sec disp-level="2">
      <title>Workflow</title>
      <p>Currently, SeqMule integrates 5 popular mapping tools: BWA (including BWA-backtrack and BWA-MEM), Bowtie, Bowtie2, SOAP2, SNAP<xref ref-type="bibr" rid="b21">21</xref><xref ref-type="bibr" rid="b22">22</xref><xref ref-type="bibr" rid="b23">23</xref><xref ref-type="bibr" rid="b24">24</xref><xref ref-type="bibr" rid="b25">25</xref>, 5 variant calling algorithms: GATK (including GATKLite and version 3), SAMtools, VarScan 2, Freebayes, SOAPsnp<xref ref-type="bibr" rid="b26">26</xref><xref ref-type="bibr" rid="b27">27</xref><xref ref-type="bibr" rid="b28">28</xref><xref ref-type="bibr" rid="b29">29</xref> and some accessory programs: FastQC, Picard, tabix and VCFtools<xref ref-type="bibr" rid="b30">30</xref>. Tools were selected based on their popularity, ease of use and performance. Of note, SNAP can be orders of magnitude faster compared with the popular aligner BWA-MEM<xref ref-type="bibr" rid="b25">25</xref><xref ref-type="bibr" rid="b31">31</xref>. All tools and related packages, except for those without open-source license, can be downloaded and installed by one single command with no need for root access. We actively maintain a list of programs and their related source code, database files to make sure there is no compatibility conflict under default settings.</p>
      <p>A workflow scheme is shown in <xref ref-type="fig" rid="f1">Fig. 1</xref>. SeqMule takes FASTQ, gzipped FASTQ or BAM as input. Quality scores in FASTQ can be encoded either in Phred+33 scheme or in Phred+64 scheme. For FASTQ, SeqMule can automatically decide which scheme is used by examining the beginning of input. Other necessary files for analysis, including reference genomes, alignment indexes, known variant databases, can be downloaded via one-line built-in command from SeqMule website. In a typical pipeline, input data goes through QC, alignment, sorting, indexing, PCR duplicate removal, variant calling and report generation. All steps use default parameters. Reads with mapping quality larger than 30 (20 for SNAP) will be used for variant calling by default. Variants will be filtered following either recommended best practice (for GATK) or by depth threshold of 10 unless otherwise stated.</p>
      <p>Multi-sample variant calling can be used if multiple sets of input data from the same lineage are supplied. BAM and VCF files are generated in the end. The VCF files are ready for downstream annotation and filtering analysis, which means users can feed them either to locally installed ANNOVAR program<xref ref-type="bibr" rid="b32">32</xref> or to wANNOVAR web server<xref ref-type="bibr" rid="b17">17</xref>.</p>
      <p>To allow various combinations of aligners and variant callers, SeqMule uses a specifically designed configuration file. The configuration file consists of key, value pairs in the form of ‘key=value’. Keys are categorized as global options, programs and local options, each with different prefixes. The prefixes for program keys also determine whether this program is mandatory and exclusive at a particular step. Programs can be either enabled or disabled by assigning 1 or 0 to the value of the corresponding keys. All settings are written in plain English with embedded help documentation alongside. Over 40 different combinations of aligners and variant callers have been tested and their configurations are readily available in ‘misc/predefined_config’ directory under SeqMule installation path. More combinations are left for the users to explore.</p>
    </sec>
    <sec disp-level="2">
      <title>Built-in parallel processing</title>
      <p>Analysis can be run in a parallel fashion either via native support by variant callers (e.g. multi-processing option inside GATK) or via SeqMule’s built-in multi-processing framework. As is shown in <xref ref-type="fig" rid="f2">Fig. 2</xref>, when SeqMule’s built-in multi-processing is enabled, it splits the genome into multiple equally sized bins, writes those bins into <italic>N</italic> BED files (<italic>N</italic> for number of CPU cores), and launches multiple processes to call variants over each region.</p>
      <p>Each bin will be large enough to minimize the overhead costs of small bins, and small enough to have fine-grained genomic intervals. Currently the minimum bin size is set to be 50 Kbp while the maximum is 1 Mbp. All bins are assigned to each process by rotation (<xref ref-type="fig" rid="f2">Fig. 2</xref>) so that two adjacent bins will not be analyzed by the same process. This assignment-by-rotation strategy is designed to avoid having too many reads processed by one thread due to uneven coverage<xref ref-type="bibr" rid="b33">33</xref>, therefore, all processes are expected to finish in similar amount of time. We compared variant calling time consumption under different max bin sizes using sample NA12878 from 1000 Genomes Project. Variants were called by SAMtools with 12 concurrent processes. <xref ref-type="supplementary-material" rid="S1">Table S1</xref> shows that the standard deviation increases as the max bin size grows from 500 Kbp to 20 Mbp. However, the maximum running time of child processes, or simply put, the overall variant calling time, does not necessarily increase as the max bin size becomes larger. Variant calling is fastest (194.9 minutes) when max bin size is 1 Mbp. All processes will be spawned by fork on a single machine, and so there is no need for cluster infrastructure. Different processes communicate with each other through a script file recording the status and command of each step. An execution manager (the parent process) is responsible for monitoring, starting and stopping all processes. Because some analyses may take hours or days to finish, the execution manager is designed to be able to stop and then resume the pipeline at any step. This feature comes in handy when users have to adjust some parameters (e.g. memory limit) after SeqMule aborts due to errors.</p>
    </sec>
    <sec disp-level="2">
      <title>Support for cluster environment</title>
      <p>SeqMule supports analyzing large number of samples via Sun Grid Engine (SGE), a popular job scheduling system in cluster environment. Internally, when SeqMule generates tasks for each step for every sample, it also specifies their dependencies. The relationship results in a task dependency graph (TDG) with tasks as nodes and task interactions as edges. SeqMule then uses topological sorting to rearrange these tasks in linear fashion such that if task A is dependent on output from task B, task A will be put behind task B. Upon running, SeqMule runs tasks one by one and will not start a task unless all its dependent tasks are finished. With this design in place, many samples can be processed in parallel due to their nature of independence. When SGE is available, SeqMule submits each task to SGE and waits for it to finish.</p>
    </sec>
    <sec disp-level="2">
      <title>Consensus result generation</title>
      <p>For SNVs, variant calls with the same chromosome and position fields are considered overlapping. Only such variants will be combined in consensus records. To combine two overlapping SNVs, alternative alleles in each record will be put together while the chromosome, position and reference columns remain unchanged.</p>
      <p>For non-SNV variants, primarily consisting of indels, records with same chromosome, position and reference allele fields are considered overlapping. After combining, alternative alleles from all records will be put together. Same indels might be presented in different ways by different algorithms. For example, both ‘TGGG TGG‘ and ‘TG T’ can denote deletion of a G allele, but it is hard to tell which G is deleted in the first case<xref ref-type="bibr" rid="b8">8</xref>. In this circumstance, we apply ‘variant normalization’ in Vt (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://github.com/atks/vt">https://github.com/atks/vt</ext-link>) to first normalize all VCF files to the same standard before combining them. During normalization, all alleles will be left (5′) and right (3′) trimmed to remove superfluous nucleotides and be moved to the leftmost positions. Nevertheless, it is expected that concordance rate between different tools for indels are less than that for SNVs<xref ref-type="bibr" rid="b8">8</xref>.</p>
      <p>When multiple samples are present in the same VCF file, it will be split into single-sample VCF before merging. After all VCFs from the same sample are merged, the resulting VCFs will be combined into one multi-sample VCF. Variant quality and genotype quality from the first input file will appear in the combined VCF. The files to be merged will be sorted based on the following priority: GATK&gt;SAMtools&gt;FreeBayes&gt;VarScan&gt;SOAPsnp. We assign variants ‘PASS’ in the filter field only if they are unfiltered in any one of the input VCF files. Consensus calls can be generated in different ways. Users are able to specify the minimum number of files in which each consensus call appears. For example, "2-out-of-4" consensus calls represent the calls found in at least 2 out of 4 input files.</p>
    </sec>
    <sec disp-level="2">
      <title>Analysis summary</title>
      <p>When an analysis starts or finishes, SeqMule automatically examines the FASTQ, BAM, VCF and generates an HTML-based report showing various statistics. Important statistics include, but are not limited to, coverage curve, average coverage, coverage over capture region, percentage of capture region covered by at least N reads, Ti/Tv ratio, Heterozygote/Homozygote ratio. FASTQ statistics are calculated by FastQC; alignment statistics come from SAMtools; coverage statistics are done by SAMtools and SeqMule’s built-in program; VCFtools output most of the variant statistics.</p>
      <p>Besides automatic generation of summary statistics, users can manually feed SeqMule with a multi-sample VCF from a family trio and obtain Mendelian error rates. The VCF file will first be converted to MAP and PED format used in PLINK<xref ref-type="bibr" rid="b34">34</xref> to record all genotypes in a more compact fashion, Subsequently pedigree information, based on user specification, is added to the PED file. At last, SeqMule iterates through all variants in the offspring and counts number of calls with 0, 1, 2 IBS (identical by state) alleles from father or mother, number of allele drop-in events, number of allele drop-out events. The Mendelian error rate calculation is implemented with VCFtools, mendelFix<xref ref-type="bibr" rid="b35">35</xref> along with custom Perl code.</p>
      <p>In accordance with its multi-caller feature, SeqMule also generates a Venn Diagram for users to inspect overlapping of variant sets from different callers. Variants are split into SNVs and non-SNVs. Chromosome, position, reference allele and alternative allele of SNVs are used to determine whether two variants overlap. For non-SNVs, besides variant-normalization, records will first be intervalized by ignoring reference alleles and alternative alleles, and then extended 10 bp towards both ends. The extended intervals for each non-SNV are used to determine whether two variants overlap. This feature is implemented with VennDigram package<xref ref-type="bibr" rid="b36">36</xref> and custom Perl code.</p>
    </sec>
  </sec>
  <sec disp-level="1" sec-type="results">
    <title>Results</title>
    <sec disp-level="2">
      <title>Consistency and accuracy evaluation</title>
      <p>To demonstrate the consistency of calls on identical samples, we analyzed 3 data sets for NA12878 obtained from the 1000 Genomes project<xref ref-type="bibr" rid="b37">37</xref> (sequenced by HiSeq and hereafter referred to as HiSeq-1000G) and from AllSeq (sequenced by HiSeq X Ten and hereafter referred to as HiSeqX-D, HiSeqX-J). For each data set, 4 variant callers, FreeBayes, SAMtools, VarScan and GATK HaplotypeCaller (GATK-HC) were used to call variants, then the results from 4 callers were merged in different ways to obtain consensus calls. For each variant calling method, we plotted a Venn diagram comparing the overlapping of variants among the 3 data sets (<xref ref-type="fig" rid="f3">Fig. 3</xref>). The concordance rates range from 91.89% ~ 94.37% among all variant callers and consensus calls while GATK HaplotypeCaller calls give the highest concordance (94.37%).</p>
      <p>As common variants are usually easy to detect, we later used ANNOVAR to filter the variants by minor allele frequency (MAF). Variants with MAF &gt; 1% (1000 genomes project, October, 2014 release, European population) were discarded. The results (<xref ref-type="fig" rid="f4">Fig. 4</xref>) show that for rare and novel variants, consistency rates are considerably lower, ranging from 69.10% ~ 87.69%. It suggests that most of the inconsistency in variant calling can be attributed to rare and novel variants. 4-out-of-4 consensus calls show the highest concordance (87.69%) under this scenario.</p>
      <p>In addition to consistency, we also examined the precision, sensitivity and specificity. The 1000 genomes data set for NA12878 (HiSeq-1000G) was used in this case. All consensus calls and variants called by individual callers were compared with the gold standard from Genome In a Bottle (GIB) project and an Illumina HumanOmni2.5-8v1 SNP array (<xref ref-type="supplementary-material" rid="S1">Figure S1-S2</xref>). For the comparison with GIB gold standard, precision rates range from 97.1% to 99.5% with GATK-HC being the highest; sensitivity rates range from 97.1% to 98.4%, with GATK-HC being the highest; specificity rates are all close to 100%. However, as the GIB gold standard was generated by GATK-HC, there is no doubt that the result is biased in favor of GATK. For the comparison with SNP array, precision rates range from 99.6% to 99.8% with 4-out-of-4 consensus calls being the highest; sensitivity rates range from 96.7% to 97.4% with 2-out-of-4 consensus call and GATK-HC both being the highest; specificity rates are all above 99.5%. These numbers show that all individual callers and consensus calls can give us accurate results in the regions covered by GIB gold standard and SNP array, indicating that the room for improvement may be somewhat limited.</p>
    </sec>
    <sec disp-level="2">
      <title>Aligner consistency evaluation</title>
      <p>To our knowledge, there is little comparison in literature regarding different aligners in the context of variant calling. It has been reported that there is differential performance for aligners when sequencing error rates and indel frequencies and sizes are varying<xref ref-type="bibr" rid="b9">9</xref>, so it is sensible to expect discrepancies associated with variant calling for different aligners. We used 2 variant callers, SAMtools and FreeBayes, and 3 aligners, BWA-MEM, Bowtie2 and SNAP, for each caller to evaluate concordance of variant calling on an exome data set<xref ref-type="bibr" rid="b38">38</xref>. Results in <xref ref-type="fig" rid="f5">Fig. 5</xref> show that concordance rates for SNVs are 77.31% for SAMtools, 78.43% for FreeBayes, respectively; concordance rates for non-SNVs (after normalization and extension) are 49.73% for SAMtools, 50.61% for FreeBayes, respectively. These results suggest that aligners may account for a considerable amount of difference in variant calling.</p>
    </sec>
    <sec disp-level="2">
      <title>Mendelian error evaluation</title>
      <p>As family-based analysis is critical in Mendelian disease studies, we went on to examine Mendelian error rate by different methods in a previously published exome sequencing study on a family trio<xref ref-type="bibr" rid="b38">38</xref>. Two types of errors were counted: allele drop-in and allele drop-out. Allele drop-in (ADI) means that an offspring presents an allele that does not appear in either parent. Allele drop-out (ADO) means that an offspring misses an allele that should have been inherited from the parents. Sum of ADI and ADO is the total number of Mendelian errors. Mendelian error rate is the ratio of all Mendelian errors to all variant calls shared by the family trio (i.e. not marked as missing in any family member).</p>
      <p>The result (<xref ref-type="supplementary-material" rid="S1">Table S2</xref>) shows that individual variant callers generally returns 41.1 to 52.6 thousand trio calls with error rates between 1.78% and 2.88%. Among them, FreeBayes gives us the most trio calls (52.6 K) and GATK-HC gives us the lowest error rate (1.78%). For a single variant caller, it is hard to predict whether error rate is higher if the overall number of trio calls is small. In contrast, when we have fewer consensus trio calls, the Mendelian error rate is also lower. The lowest Mendelian error rate we can get is 0.66%, from 4-out-of-4 consensus calls for this data set, with 35.7 thousand trio calls. As most of our interests lie in rare and novel variants, we did variants filtering based on MAF. Variants with MAF &gt;1% (1000 genomes project, October, 2014 release, European population) were discarded. The results show that generally Mendelian error rates become larger for rare and novel variants, ranging from 0.53% to 6.48% (<xref ref-type="supplementary-material" rid="S1">Table S3</xref>, <xref ref-type="fig" rid="f6">Fig. 6</xref>). Again, the lowest error rate was achieved by 4-out-of-4 consensus calls (0.53%), with nearly five thousand trio calls. Compared with results from individual callers, the consensus-call approach has more stable performance. It is also more flexible in that users can reduce Mendelian error rate when needed. In trio-based sequencing studies, researchers may want to examine the most reliable set of calls first to find low-hanging fruits, before delving deep into noisier call sets to find additional candidates.</p>
    </sec>
    <sec disp-level="2">
      <title>Performance evaluation</title>
      <p>To evaluate the computational resources consumed by SeqMule, we used a whole genome sequencing data set (mentioned before as HiSeqX-D) with 818 million 151-bp paired end reads (30X coverage) for benchmarking. BWA-MEM or SNAP was used as the aligner. PicardTools was used to remove PCR duplicates. GATK HaploTypeCaller or FreeBayes was used to call variants. We used a machine equipped with 12-core Intel Xeon 2.66 GHz CPU and 48 Gigabytes of memory.</p>
      <p><xref ref-type="table" rid="t1">Table 1</xref> details the computation time of SeqMule under different pipeline configurations. As is shown, conventional BWA-MEM and GATK-HC combination takes over 50 hours to analyze a whole genome, whereas SNAP+FreeBayes combination needs 36.3 hours. With quick mode (SeqMule’s built-in parallel framework) enabled, variant calling can run up to 12 times faster (12 CPU cores). However, this comes with the tradeoff of increased memory usage. For example, when speed is of primary concern, users can use the SNAP+FreeBayes combination. This combination requires less than 21 hours of running time and 31.3 Gigabytes of memory with quick mode enabled.</p>
      <p>For users who are interested in analyzing exome data sets, we also did a similar comparison using an exome data set (138.8 million 90 bp-long paired-end reads, 113X coverage in target region). BWA-MEM was used as the aligner. PicardTools was used to remove PCR duplicates. GATK-HC was used to call variants. As is shown in <xref ref-type="supplementary-material" rid="S1">Table S4</xref>, using more CPUs or processes reduces the running time in general. With quick mode enabled, variant calling can run 2 to 7 times faster depending on number of CPU cores used. On a machine with same configuration, the shortest running time is 317 minutes for the BWA-MEM + GATK-HC combination, and 264 minutes for the SNAP+FreeBayes combination (not shown in <xref ref-type="supplementary-material" rid="S1">Table S4</xref>).</p>
      <p>In the exome analysis, the running time for GATK-HC does not seem to vary with number of CPU cores when quick mode is disabled. This is perhaps due to the fact that GATK’s HaplotypeCaller only supports parallel execution with “-nct” option (enable multiple CPU threads per data thread) which does not scale well and has a constant overhead. The configuration files used are “snap_freebayes.config”, “bwa_gatk_HaplotypeCaller_norealn_norecal.config”. They can be found in seqmule/misc/predefined_config/. The software used includes FastQC (v0.11.2), Picard (v1.115), SAMtools (v0.1.19–44428cd), FreeBayes (v0.9.14-14-gb00b735), SNAP (v1.0beta.16), BWA-MEM (v0.7.10-r789), GATK (v3.1-1-g07a4bf8).</p>
    </sec>
    <sec disp-level="2">
      <title>Mendelian disease disease-contributory variant identification</title>
      <p>We used exome sequencing data from a previously reported family trio<xref ref-type="bibr" rid="b38">38</xref> to demonstrate the applicability and ease of use of SeqMule. The proband is a 28-year-old Caucasian male diagnosed with idiopathic hemolytic anemia. This phenotype was not observed either in his parents nor his siblings. With Agilent SureSelect Human All Exon kit and Illumina HiSeq 2000, we obtained 97 million paired-end reads per sample with designed capture regions covered at 82x on average. Initial alignment was done by BWA-MEM algorithm, followed by Picard removal of duplicates. GATK HaplotypeCaller, SAMtools, VarScan were then used to call variants. Multi-sample variant calling was enabled, so all 3 samples were supplied to each of the variant callers. We filtered results based on criteria recommended by each algorithm. Subsequently we extracted consensus variants from 3 sets of filtered variants (in 3-out-of-3 fashion), and reduced number of variants from 34 thousand per caller to 31 thousand on average. These steps were performed by executing one single SeqMule command given that the combination of aligner and variant callers has been tested before.</p>
      <p>Next we utilized the ANNOVAR “variants reduction” pipeline<xref ref-type="bibr" rid="b32">32</xref>, under a recessive disease model. Synonymous, non-splicing variants and variants observed in the 1000 Genomes Projects and NHLBI-ESP 6500 exome project with minor allele frequency (MAF) &gt;1% in European populations<xref ref-type="bibr" rid="b39">39</xref> were filtered out. The filtering was done with one single ANNOVAR command for each subject (variants_reduction.pl -protocol nonsyn_splicing,1000g2012apr_all,esp6500_ea,recessive -operation g,f,f,m -aaf_threshold 0.01 input.father.avinput annovar/humandb/ -buildver hg19).</p>
      <p>In the remaining variants, father and son shared 236 variants, while mother and son shared 253. There are 64 genes overlapping between the two sets of shared variants, 32 of which are homozygous and 6 are compound heterozygous in the proband. Manual examination of candidate genes easily identified mutations in <italic>PKLR</italic> that likely contribute to the disease. <italic>PKLR</italic> harbours two heterozygous variants that are predicted by multiple scores to be deleterious, and has been confirmed by us as the disease-contributory gene in biochemical tests<xref ref-type="bibr" rid="b38">38</xref>. This example demonstrated that SeqMule can reveal disease-contributory variants easily with minimal efforts from the users, therefore greatly facilitating genetic studies on human genetic diseases.</p>
    </sec>
  </sec>
  <sec disp-level="1" sec-type="discussion">
    <title>Discussion</title>
    <p>In summary, SeqMule is a comprehensive, user-friendly, flexible and efficient tool for analyzing human exome and genome sequencing data. Five alignment tools, five variant callers and various accessory programs are included to provide users with numerous choices.</p>
    <p>Different call sets can be integrated to produce more reliable results in terms of consistency and Mendelian error rate. However, if users are solely interested in rare variants and <italic>de novo</italic> point mutations from family-based samples, they will have more gain in power and Mendelian consistency by using more specialized tools such as PolyMutt<xref ref-type="bibr" rid="b40">40</xref>, DenovoGear<xref ref-type="bibr" rid="b41">41</xref> and FamSeq<xref ref-type="bibr" rid="b42">42</xref>. Test results on our own data suggest that PolyMutt can dramatically reduce Mendelian errors (0.2% for FreeBayes, 0.0% for GATK-HC, 0.3% for SAMtools, data same as in <xref ref-type="fig" rid="f6">Fig. 6</xref>) by utilizing a family-aware calling framework. When sample size is large, variant quality can also be improved by imputation-based methods<xref ref-type="bibr" rid="b43">43</xref>.</p>
    <p>SeqMule’s built-in parallel processing capability can improve current variant calling by a number of times without involving high-performance computing infrastructure or complicated configuration. Besides all of these features, SeqMule uses one-line commands for complicated tasks wherever possible, making it extremely easy to download, install, configure and run a large number of bioinformatics tools.</p>
    <p>Popular bioinformatics platforms, such as Galaxy, make a number of bioinformatics tools very accessible. Users just upload their data and start analysis right away. But the restricted storage, limited data transfer speed and prolonged job queuing time makes it impractical to use when users have non-trivial amount of data.</p>
    <p>The option of launching a Galaxy instance<xref ref-type="bibr" rid="b44">44</xref> or other pipeline in the cloud is likely to overcome some of the obstacles mentioned above without cumbersome local installation. But, as a free, public resource open to all biologists, such a platform is usually built towards serving a large population who are not only interested in variant discovery, but also many other types of analyses. In contrast, SeqMule is tailored for exome or genome sequence analysis in the context of human genetic disease study and therefore hosts many features optimized for this purpose, such as consensus call generation, multi-sample variant calling, Mendelian error rate statistics, and HTML-based summary, among other things. Besides, SeqMule is more agile because new tools, once they are integrated into SeqMule by developers, can be added with just one update command (see SeqMule’s manual).</p>
    <p>In addition to platform solutions, there are quite a few standalone pipelines for variant analysis, such as HugeSeq<xref ref-type="bibr" rid="b45">45</xref>, ngs_backbone<xref ref-type="bibr" rid="b46">46</xref> and bcbio-nextgen (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://github.com/chapmanb/bcbio-nextgen">https://github.com/chapmanb/bcbio-nextgen</ext-link>). HugeSeq integrates one aligner and two SNP/indel callers (SAMtools and GATK), and was last updated one year ago. ngs_backbone integrates one aligner (BWA) and one variant caller (GATK). bcbio-nextgen has two aligners (BWA, NovoAlign) and four variant callers (GATK, FreeBayes, Platypus, SAMtools). Since NovoAlign is a proprietary aligner not free to all researchers, none of these pipelines provides alternative open-source mappers. In view of discrepancies associated with aligners<xref ref-type="bibr" rid="b9">9</xref> (<xref ref-type="fig" rid="f5">Fig. 5</xref>), it is important to offer users multiple open-source alignment programs.</p>
    <p>Many users have used SeqMule to analyze their sequencing data and obtained meaningful results<xref ref-type="bibr" rid="b47">47</xref><xref ref-type="bibr" rid="b48">48</xref><xref ref-type="bibr" rid="b49">49</xref>. With the rapid development and deployment of next-generation sequencing technologies, we expect that SeqMule will facilitate analysis of the upcoming massive amounts of sequencing data to expedite discoveries for human genetic diseases.</p>
  </sec>
  <sec disp-level="1">
    <title>Additional Information</title>
    <p><bold>How to cite this article</bold>: Guo, Y. <italic>et al.</italic> SeqMule: automated pipeline for analysis of human exome/genome sequencing data. <italic>Sci. Rep.</italic>
<bold>5</bold>, 14283; doi: 10.1038/srep14283 (2015).</p>
  </sec>
  <sec sec-type="supplementary-material" id="S1">
    <title>Supplementary Material</title>
    <supplementary-material id="d33e25" content-type="local-data">
      <caption>
        <title>Supplementary Information</title>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep14283-s1.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors thank Wang lab members and several anonymous beta testers for valuable comments and helpful feedback. This work was supported by National Institute of Health grant HG006465 to K.W.</p>
  </ack>
  <ref-list>
    <ref id="b1">
      <mixed-citation publication-type="journal"><name><surname>Rabbani</surname><given-names>B.</given-names></name>, <name><surname>Mahdieh</surname><given-names>N.</given-names></name>, <name><surname>Hosomichi</surname><given-names>K.</given-names></name>, <name><surname>Nakaoka</surname><given-names>H.</given-names></name> &amp; <name><surname>Inoue</surname><given-names>I.</given-names></name>
<article-title>Next-generation sequencing: impact of exome sequencing in characterizing Mendelian disorders</article-title>. <source>J Hum Genet</source>
<volume>57</volume>, <fpage>621</fpage>–<lpage>632</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22832387</pub-id></mixed-citation>
    </ref>
    <ref id="b2">
      <mixed-citation publication-type="journal"><name><surname>Bamshad</surname><given-names>M. J.</given-names></name><italic>et al.</italic><article-title>Exome sequencing as a tool for Mendelian disease gene discovery</article-title>. <source>Nat Rev Genet</source><volume>12</volume>, <fpage>745</fpage>–<lpage>755</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21946919</pub-id></mixed-citation>
    </ref>
    <ref id="b3">
      <mixed-citation publication-type="journal"><name><surname>Meyerson</surname><given-names>M.</given-names></name>, <name><surname>Gabriel</surname><given-names>S.</given-names></name> &amp; <name><surname>Getz</surname><given-names>G.</given-names></name>
<article-title>Advances in understanding cancer genomes through second-generation sequencing</article-title>. <source>Nat Rev Genet</source>
<volume>11</volume>, <fpage>685</fpage>–<lpage>696</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20847746</pub-id></mixed-citation>
    </ref>
    <ref id="b4">
      <mixed-citation publication-type="journal"><name><surname>Mardis</surname><given-names>E. R.</given-names></name><article-title>The impact of next-generation sequencing technology on genetics</article-title>. <source>Trends in genetics: TIG</source><volume>24</volume>, <fpage>133</fpage>–<lpage>141</lpage> (<year>2008</year>).<pub-id pub-id-type="pmid">18262675</pub-id></mixed-citation>
    </ref>
    <ref id="b5">
      <mixed-citation publication-type="journal"><name><surname>Morozova</surname><given-names>O.</given-names></name> &amp; <name><surname>Marra</surname><given-names>M. A.</given-names></name>
<article-title>Applications of next-generation sequencing technologies in functional genomics</article-title>. <source>Genomics</source>
<volume>92</volume>, <fpage>255</fpage>–<lpage>264</lpage> (<year>2008</year>).<pub-id pub-id-type="pmid">18703132</pub-id></mixed-citation>
    </ref>
    <ref id="b6">
      <mixed-citation publication-type="journal"><name><surname>Genomes Project</surname><given-names>C.</given-names></name><italic>et al.</italic><article-title>A map of human genome variation from population-scale sequencing</article-title>. <source>Nature</source><volume>467</volume>, <fpage>1061</fpage>–<lpage>1073</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20981092</pub-id></mixed-citation>
    </ref>
    <ref id="b7">
      <mixed-citation publication-type="journal"><name><surname>Lam</surname><given-names>H. Y.</given-names></name><italic>et al.</italic><article-title>Performance comparison of whole-genome sequencing platforms</article-title>. <source>Nat Biotechnol</source><volume>30</volume>, <fpage>78</fpage>–<lpage>82</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22178993</pub-id></mixed-citation>
    </ref>
    <ref id="b8">
      <mixed-citation publication-type="journal"><name><surname>O'Rawe</surname><given-names>J.</given-names></name><italic>et al.</italic><article-title>Low concordance of multiple variant-calling pipelines: practical implications for exome and genome sequencing</article-title>. <source>Genome Med</source><volume>5</volume>, <fpage>28</fpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23537139</pub-id></mixed-citation>
    </ref>
    <ref id="b9">
      <mixed-citation publication-type="journal"><name><surname>Ruffalo</surname><given-names>M.</given-names></name>, <name><surname>LaFramboise</surname><given-names>T.</given-names></name> &amp; <name><surname>Koyuturk</surname><given-names>M.</given-names></name>
<article-title>Comparative analysis of algorithms for next-generation sequencing read alignment</article-title>. <source>Bioinformatics</source>
<volume>27</volume>, <fpage>2790</fpage>–<lpage>2796</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21856737</pub-id></mixed-citation>
    </ref>
    <ref id="b10">
      <mixed-citation publication-type="journal"><name><surname>Hull</surname><given-names>D.</given-names></name><italic>et al.</italic><article-title>Taverna: a tool for building and running workflows of services</article-title>. <source>Nucleic Acids Res</source><volume>34</volume>, <fpage>W729</fpage>–<lpage>732</lpage> (<year>2006</year>).<pub-id pub-id-type="pmid">16845108</pub-id></mixed-citation>
    </ref>
    <ref id="b11">
      <mixed-citation publication-type="journal"><name><surname>Reich</surname><given-names>M.</given-names></name><italic>et al.</italic><article-title>GenePattern 2.0</article-title>. <source>Nat Genet</source><volume>38</volume>, <fpage>500</fpage>–<lpage>501</lpage> (<year>2006</year>).<pub-id pub-id-type="pmid">16642009</pub-id></mixed-citation>
    </ref>
    <ref id="b12">
      <mixed-citation publication-type="journal"><name><surname>Abouelhoda</surname><given-names>M.</given-names></name>, <name><surname>Issa</surname><given-names>S. A.</given-names></name> &amp; <name><surname>Ghanem</surname><given-names>M.</given-names></name>
<article-title>Tavaxy: integrating Taverna and Galaxy workflows with cloud computing support</article-title>. <source>BMC Bioinformatics</source>
<volume>13</volume>, <fpage>77</fpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22559942</pub-id></mixed-citation>
    </ref>
    <ref id="b13">
      <mixed-citation publication-type="journal"><name><surname>Goecks</surname><given-names>J.</given-names></name>, <name><surname>Nekrutenko</surname><given-names>A.</given-names></name>, <name><surname>Taylor</surname><given-names>J.</given-names></name><article-title>&amp; Galaxy, T. Galaxy: a comprehensive approach for supporting accessible, reproducible, and transparent computational research in the life sciences</article-title>. <source>Genome Biol</source><volume>11</volume>, <fpage>R86</fpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20738864</pub-id></mixed-citation>
    </ref>
    <ref id="b14">
      <mixed-citation publication-type="journal"><name><surname>Pabinger</surname><given-names>S.</given-names></name><italic>et al.</italic><article-title>A survey of tools for variant analysis of next-generation genome sequencing data</article-title>. <source>Brief Bioinform</source><volume>15</volume>, <fpage>256</fpage>–<lpage>278</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">23341494</pub-id></mixed-citation>
    </ref>
    <ref id="b15">
      <mixed-citation publication-type="journal"><name><surname>Gentleman</surname><given-names>R. C.</given-names></name><italic>et al.</italic><article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title>. <source>Genome Biol</source><volume>5</volume>, <fpage>R80</fpage> (<year>2004</year>).<pub-id pub-id-type="pmid">15461798</pub-id></mixed-citation>
    </ref>
    <ref id="b16">
      <mixed-citation publication-type="journal"><name><surname>Stajich</surname><given-names>J. E.</given-names></name><italic>et al.</italic><article-title>The Bioperl toolkit: Perl modules for the life sciences</article-title>. <source>Genome Res</source><volume>12</volume>, <fpage>1611</fpage>–<lpage>1618</lpage> (<year>2002</year>).<pub-id pub-id-type="pmid">12368254</pub-id></mixed-citation>
    </ref>
    <ref id="b17">
      <mixed-citation publication-type="journal"><name><surname>Chang</surname><given-names>X.</given-names></name> &amp; <name><surname>Wang</surname><given-names>K.</given-names></name>
<article-title>wANNOVAR: annotating genetic variants for personal genomes via the web</article-title>. <source>Journal of medical genetics</source>
<volume>49</volume>, <fpage>433</fpage>–<lpage>436</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22717648</pub-id></mixed-citation>
    </ref>
    <ref id="b18">
      <mixed-citation publication-type="journal"><name><surname>Krampis</surname><given-names>K.</given-names></name><italic>et al.</italic><article-title>Cloud BioLinux: pre-configured and on-demand bioinformatics computing for the genomics community</article-title>. <source>BMC Bioinformatics</source><volume>13</volume>, <fpage>42</fpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22429538</pub-id></mixed-citation>
    </ref>
    <ref id="b19">
      <mixed-citation publication-type="journal"><name><surname>Nocq</surname><given-names>J.</given-names></name>, <name><surname>Celton</surname><given-names>M.</given-names></name>, <name><surname>Gendron</surname><given-names>P.</given-names></name>, <name><surname>Lemieux</surname><given-names>S.</given-names></name> &amp; <name><surname>Wilhelm</surname><given-names>B. T.</given-names></name>
<article-title>Harnessing virtual machines to simplify next-generation DNA sequencing analysis</article-title>. <source>Bioinformatics</source>
<volume>29</volume>, <fpage>2075</fpage>–<lpage>2083</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23786767</pub-id></mixed-citation>
    </ref>
    <ref id="b20">
      <mixed-citation publication-type="journal"><name><surname>Angiuoli</surname><given-names>S. V.</given-names></name><italic>et al.</italic><article-title>CloVR: a virtual machine for automated and portable sequence analysis from the desktop using cloud computing</article-title>. <source>BMC Bioinformatics</source><volume>12</volume>, <fpage>356</fpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21878105</pub-id></mixed-citation>
    </ref>
    <ref id="b21">
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H.</given-names></name> &amp; <name><surname>Durbin</surname><given-names>R.</given-names></name>
<article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>
<volume>25</volume>, <fpage>1754</fpage>–<lpage>1760</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="b22">
      <mixed-citation publication-type="journal"><name><surname>Langmead</surname><given-names>B.</given-names></name>, <name><surname>Trapnell</surname><given-names>C.</given-names></name>, <name><surname>Pop</surname><given-names>M.</given-names></name> &amp; <name><surname>Salzberg</surname><given-names>S. L.</given-names></name>
<article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>. <source>Genome Biol</source>
<volume>10</volume>, <fpage>R25</fpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19261174</pub-id></mixed-citation>
    </ref>
    <ref id="b23">
      <mixed-citation publication-type="journal"><name><surname>Langmead</surname><given-names>B.</given-names></name> &amp; <name><surname>Salzberg</surname><given-names>S. L.</given-names></name>
<article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nat Methods</source>
<volume>9</volume>, <fpage>357</fpage>–<lpage>359</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22388286</pub-id></mixed-citation>
    </ref>
    <ref id="b24">
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>R.</given-names></name><italic>et al.</italic><article-title>SOAP2: an improved ultrafast tool for short read alignment</article-title>. <source>Bioinformatics</source><volume>25</volume>, <fpage>1966</fpage>–<lpage>1967</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19497933</pub-id></mixed-citation>
    </ref>
    <ref id="b25">
      <mixed-citation publication-type="journal"><name><surname>Zaharia</surname><given-names>M.</given-names></name><italic>et al.</italic><article-title>Faster and More Accurate Sequence Alignment with SNAP</article-title>. <source>ArXiv e-prints</source><volume>1111</volume>, <fpage>5572</fpage>, 2011arXiv1111.5572Z (<year>2011</year>).</mixed-citation>
    </ref>
    <ref id="b26">
      <mixed-citation publication-type="journal"><name><surname>McKenna</surname><given-names>A.</given-names></name><italic>et al.</italic><article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome Res</source><volume>20</volume>, <fpage>1297</fpage>–<lpage>1303</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="b27">
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H.</given-names></name><italic>et al.</italic><article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source><volume>25</volume>, <fpage>2078</fpage>–<lpage>2079</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="b28">
      <mixed-citation publication-type="journal"><name><surname>Koboldt</surname><given-names>D. C.</given-names></name><italic>et al.</italic><article-title>VarScan 2: somatic mutation and copy number alteration discovery in cancer by exome sequencing</article-title>. <source>Genome Res</source><volume>22</volume>, <fpage>568</fpage>–<lpage>576</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22300766</pub-id></mixed-citation>
    </ref>
    <ref id="b29">
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>R.</given-names></name><italic>et al.</italic><article-title>SNP detection for massively parallel whole-genome resequencing</article-title>. <source>Genome Res</source><volume>19</volume>, <fpage>1124</fpage>–<lpage>1132</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19420381</pub-id></mixed-citation>
    </ref>
    <ref id="b30">
      <mixed-citation publication-type="journal"><name><surname>Danecek</surname><given-names>P.</given-names></name><italic>et al.</italic><article-title>The variant call format and VCFtools</article-title>. <source>Bioinformatics</source><volume>27</volume>, <fpage>2156</fpage>–<lpage>2158</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="b31">
      <mixed-citation publication-type="journal"><name><surname>R. Pandya</surname><given-names>W. B.</given-names></name><italic>et al.</italic><article-title>SNAP: fast, accurate sequence alignment enabling biological applications</article-title>. <source>ASHG meeting 2014, San Diego</source> (<year>2014</year>).</mixed-citation>
    </ref>
    <ref id="b32">
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>K.</given-names></name>, <name><surname>Li</surname><given-names>M.</given-names></name> &amp; <name><surname>Hakonarson</surname><given-names>H.</given-names></name>
<article-title>ANNOVAR: functional annotation of genetic variants from high-throughput sequencing data</article-title>. <source>Nucleic Acids Res</source>
<volume>38</volume>, <fpage>e164</fpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20601685</pub-id></mixed-citation>
    </ref>
    <ref id="b33">
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>W.</given-names></name>, <name><surname>Wei</surname><given-names>Z.</given-names></name>, <name><surname>Lam</surname><given-names>T. W.</given-names></name> &amp; <name><surname>Wang</surname><given-names>J.</given-names></name>
<article-title>Next generation sequencing has lower sequence coverage and poorer SNP-detection capability in the regulatory regions</article-title>. <source>Scientific reports</source>
<volume>1</volume>, <fpage>55</fpage> (<year>2011</year>).<pub-id pub-id-type="pmid">22355574</pub-id></mixed-citation>
    </ref>
    <ref id="b34">
      <mixed-citation publication-type="journal"><name><surname>Purcell</surname><given-names>S.</given-names></name><italic>et al.</italic><article-title>PLINK: a tool set for whole-genome association and population-based linkage analyses</article-title>. <source>American journal of human genetics</source><volume>81</volume>, <fpage>559</fpage>–<lpage>575</lpage> (<year>2007</year>).<pub-id pub-id-type="pmid">17701901</pub-id></mixed-citation>
    </ref>
    <ref id="b35">
      <mixed-citation publication-type="journal"><name><surname>Utsunomiya</surname><given-names>Y. T.</given-names></name><italic>et al.</italic><article-title>mendelFix: a Perl script for checking Mendelian errors in high density SNP data of trio designs</article-title>. <source>arXiv:1306.2243</source> (<year>2013</year>).</mixed-citation>
    </ref>
    <ref id="b36">
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>H.</given-names></name><article-title>VennDiagram: Generate high-resolution Venn and Euler plots</article-title>. <source>CRAN</source> (<year>2011</year>).</mixed-citation>
    </ref>
    <ref id="b37">
      <mixed-citation publication-type="journal"><name><surname>Altshuler</surname><given-names>D. M.</given-names></name><italic>et al.</italic><article-title>An integrated map of genetic variation from 1,092 human genomes</article-title>. <source>Nature</source><volume>491</volume>, <fpage>56</fpage>–<lpage>65</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">23128226</pub-id></mixed-citation>
    </ref>
    <ref id="b38">
      <mixed-citation publication-type="journal"><name><surname>Lyon</surname><given-names>G. J.</given-names></name><italic>et al.</italic><article-title>Exome sequencing and unrelated findings in the context of complex disease research: ethical and clinical implications</article-title>. <source>Discovery medicine</source><volume>12</volume>, <fpage>41</fpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21794208</pub-id></mixed-citation>
    </ref>
    <ref id="b39">
      <mixed-citation publication-type="journal"><name><surname>Genomes Project</surname><given-names>C.</given-names></name><italic>et al.</italic><article-title>An integrated map of genetic variation from 1,092 human genomes</article-title>. <source>Nature</source><volume>491</volume>, <fpage>56</fpage>–<lpage>65</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">23128226</pub-id></mixed-citation>
    </ref>
    <ref id="b40">
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>B.</given-names></name><italic>et al.</italic><article-title>A likelihood-based framework for variant calling and de novo mutation detection in families</article-title>. <source>PLoS genetics</source><volume>8</volume>, <fpage>e1002944</fpage> (<year>2012</year>).<pub-id pub-id-type="pmid">23055937</pub-id></mixed-citation>
    </ref>
    <ref id="b41">
      <mixed-citation publication-type="journal"><name><surname>Ramu</surname><given-names>A.</given-names></name><italic>et al.</italic><article-title>DeNovoGear: de novo indel and point mutation discovery and phasing</article-title>. <source>Nat Methods</source><volume>10</volume>, <fpage>985</fpage>–<lpage>987</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23975140</pub-id></mixed-citation>
    </ref>
    <ref id="b42">
      <mixed-citation publication-type="journal"><name><surname>Peng</surname><given-names>G.</given-names></name><italic>et al.</italic><article-title>Rare variant detection using family-based sequencing analysis</article-title>. <source>Proc Natl Acad Sci USA</source><volume>110</volume>, <fpage>3985</fpage>–<lpage>3990</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23426633</pub-id></mixed-citation>
    </ref>
    <ref id="b43">
      <mixed-citation publication-type="journal"><name><surname>Nielsen</surname><given-names>R.</given-names></name>, <name><surname>Korneliussen</surname><given-names>T.</given-names></name>, <name><surname>Albrechtsen</surname><given-names>A.</given-names></name>, <name><surname>Li</surname><given-names>Y.</given-names></name> &amp; <name><surname>Wang</surname><given-names>J.</given-names></name>
<article-title>SNP calling, genotype calling, and sample allele frequency estimation from New-Generation Sequencing data</article-title>. <source>PLoS One</source>
<volume>7</volume>, <fpage>e37558</fpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22911679</pub-id></mixed-citation>
    </ref>
    <ref id="b44">
      <mixed-citation publication-type="journal"><name><surname>Afgan</surname><given-names>E.</given-names></name><italic>et al.</italic><article-title>Galaxy CloudMan: delivering cloud compute clusters</article-title>. <source>BMC Bioinformatics</source><volume>11 Suppl 12</volume>, <fpage>S4</fpage> (<year>2010</year>).<pub-id pub-id-type="pmid">21210983</pub-id></mixed-citation>
    </ref>
    <ref id="b45">
      <mixed-citation publication-type="journal"><name><surname>Lam</surname><given-names>H. Y.</given-names></name><italic>et al.</italic><article-title>Detecting and annotating genetic variations using the HugeSeq pipeline</article-title>. <source>Nat Biotechnol</source><volume>30</volume>, <fpage>226</fpage>–<lpage>229</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22398614</pub-id></mixed-citation>
    </ref>
    <ref id="b46">
      <mixed-citation publication-type="journal"><name><surname>Blanca</surname><given-names>J. M.</given-names></name>, <name><surname>Pascual</surname><given-names>L.</given-names></name>, <name><surname>Ziarsolo</surname><given-names>P.</given-names></name>, <name><surname>Nuez</surname><given-names>F.</given-names></name> &amp; <name><surname>Canizares</surname><given-names>J.</given-names></name>
<article-title>ngs_backbone: a pipeline for read cleaning, mapping and SNP calling using next generation sequence</article-title>. <source>BMC Genomics</source>
<volume>12</volume>, <fpage>285</fpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21635747</pub-id></mixed-citation>
    </ref>
    <ref id="b47">
      <mixed-citation publication-type="journal"><name><surname>Shi</surname><given-names>L.</given-names></name><italic>et al.</italic><article-title>Genotype-first inverted question mark approaches on a curious case of idiopathic progressive cognitive decline</article-title>. <source>BMC medical genomics</source><volume>7</volume>, <fpage>66</fpage> (<year>2014</year>).<pub-id pub-id-type="pmid">25466957</pub-id></mixed-citation>
    </ref>
    <ref id="b48">
      <mixed-citation publication-type="journal"><name><surname>Jia</surname><given-names>H.</given-names></name>, <name><surname>Guo</surname><given-names>Y.</given-names></name>, <name><surname>Zhao</surname><given-names>W.</given-names></name> &amp; <name><surname>Wang</surname><given-names>K.</given-names></name>
<article-title>Long-range PCR in next-generation sequencing: comparison of six enzymes and evaluation on the MiSeq sequencer</article-title>. <source>Scientific reports</source>
<volume>4</volume>, <fpage>5737</fpage> (<year>2014</year>).<pub-id pub-id-type="pmid">25034901</pub-id></mixed-citation>
    </ref>
    <ref id="b49">
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>X.</given-names></name><italic>et al.</italic><article-title>Exome sequencing on malignant meningiomas identified mutations in neurofibromatosis type 2 (NF2) and meningioma 1 (MN1) genes</article-title>. <source>Discov Med</source><volume>18</volume>, <fpage>301</fpage>–<lpage>311</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">25549701</pub-id></mixed-citation>
    </ref>
  </ref-list>
  <fn-group>
    <fn fn-type="conflict">
      <p>G.J.L serves on the medical advisory board of GenePeeks, Inc. G.J.L. serves on the scientific advisory board of Omicia, Inc. K.W. is board member and share holder of Tute Genomics, Inc. The study did not involve these companies and did not use products from these companies.</p>
    </fn>
    <fn>
      <p><bold>Author Contributions</bold> Y.G. wrote the software and did quality analysis of the results. X.D. tested the software, generated benchmarking results. Y.S. and G.J.L. advised on the study and provided testing data sets. K.W. conceived of and supervised the study.</p>
    </fn>
  </fn-group>
</back>
<floats-group>
  <fig id="f1">
    <label>Figure 1</label>
    <caption>
      <title>Scheme of SeqMule workflow and currently available tools in each step.</title>
      <p>Dashed line marks non-mandatory steps, solid line marks mandatory steps.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep14283-f1"/>
  </fig>
  <fig id="f2">
    <label>Figure 2</label>
    <caption>
      <title>Bin generation and assignment.</title>
      <p>Assume we want to run our analysis using 3 processes. We need to split the chromosomes (blue) into 3 sets of bins. Bin size will be dynamically determined according to the total size of all chromosomes or user-defined regions. There is a minimum and maximum bin size to minimize the effects of a read spanning two bins and uneven coverage. In practice, the size limits shown in the figure work well from a couple of genes up to the whole genome. Bins are generated by walking through all regions to be analyzed. Subsequently, bins are assigned to each process by rotations. In the end, each process is expected to deal with approximately same numbers of reads.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep14283-f2"/>
  </fig>
  <fig id="f3">
    <label>Figure 3</label>
    <caption>
      <title>Consistency evaluation using 3 sequencing data sets for NA12878.</title>
      <p>The 3 data sets were generated by 1000 Genomes project and AllSeq (HiSeq-D, HiSeq-J). We used the same alignment algorithms (BWA-MEM) as the primary focus is to compare variant callers. For each data set, 4 variant callers were used to call variants (<bold>A</bold>), then the results from 4 callers were merged in different ways to get consensus calls (<bold>B</bold>). For each variant calling method, we plotted a Venn Diagram comparing overlapping of variants among the 3 data sets. The percentages show the proportion of variants shared by 3 data sets.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep14283-f3"/>
  </fig>
  <fig id="f4">
    <label>Figure 4</label>
    <caption>
      <title>Consistency evaluation using rare variants from 3 sequencing data sets for NA12878.</title>
      <p>The 3 data sets were generated by 1000 Genomes project and AllSeq (HiSeq-D, HiSeq-J). We used the same alignment algorithms (BWA-MEM) as the primary focus is to compare variant callers. For each data set, 4 variant callers were used to call variants, variants with MAF &gt; 1% were dropped. The remaining variants from 4 callers were merged in different ways to get consensus calls. For each variant calling method, we plotted a Venn Diagram comparing overlapping of variants among the 3 data sets (<bold>A,B</bold>). The percentages show the proportion of variants shared by 3 data sets.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep14283-f4"/>
  </fig>
  <fig id="f5">
    <label>Figure 5</label>
    <caption>
      <title>Variant concordance for different aligners.</title>
      <p>An exome data set was used to do alignment and call variants. For each variant caller, we used 3 aligners to map the reads. Two panels are SNVs, and two panels are non-SNVs (mostly indels). Panel A shows <bold>SNV</bold>s from SAMtools, panel B for <bold>SNV</bold>s from FreeBayes, panel C for <bold>non-SNV</bold>s from SAMtools, panel D for <bold>non-SNV</bold>s from FreeBayes.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep14283-f5"/>
  </fig>
  <fig id="f6">
    <label>Figure 6</label>
    <caption>
      <title>Mendelian error rate comparison for variant calling methods (MAF &lt; 1%).</title>
      <p>2o4 denotes calls from 2-out-of-4 consensus call set, 3o4 for 3-out-of-4 and 4o4 for 4-out-of-4. Only loci present in all family members are considered. ADI (allele drop in) and ADO (allele drop out) are counted as Mendelian errors. A trend line is added for consensus results. Only variants with MAF &lt; 1% are shown here.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep14283-f6"/>
  </fig>
  <table-wrap position="float" id="t1">
    <label>Table 1</label>
    <caption>
      <title>Time consumption under different configurations.</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th align="left" valign="top" charoff="50">Quick Mode</th>
          <th align="center" valign="top" charoff="50">Aligner</th>
          <th align="center" valign="top" charoff="50">Variant caller</th>
          <th align="center" valign="top" charoff="50">CPU (number of cores)</th>
          <th align="center" valign="top" charoff="50">Max Memory Used (G)</th>
          <th align="center" valign="top" charoff="50">Alignment Time (hour)</th>
          <th align="center" valign="top" charoff="50">Variant Calling Time (hour)</th>
          <th align="center" valign="top" charoff="50">Total Time (hour)</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td align="left" valign="top" charoff="50">No</td>
          <td align="center" valign="top" charoff="50">BWA</td>
          <td align="center" valign="top" charoff="50">GATK-HC</td>
          <td align="center" valign="top" charoff="50">12</td>
          <td align="center" valign="top" charoff="50">19.8</td>
          <td align="center" valign="top" charoff="50">13.5</td>
          <td align="center" valign="top" charoff="50">22.6</td>
          <td align="center" valign="top" charoff="50">54.0</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Yes</td>
          <td align="center" valign="top" charoff="50">BWA</td>
          <td align="center" valign="top" charoff="50">GATK-HC</td>
          <td align="center" valign="top" charoff="50">12</td>
          <td align="center" valign="top" charoff="50">43.2</td>
          <td align="center" valign="top" charoff="50">13.2</td>
          <td align="center" valign="top" charoff="50">19.8</td>
          <td align="center" valign="top" charoff="50">51.1</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">No</td>
          <td align="center" valign="top" charoff="50">SNAP</td>
          <td align="center" valign="top" charoff="50">FreeBayes</td>
          <td align="center" valign="top" charoff="50">12</td>
          <td align="center" valign="top" charoff="50">31.3</td>
          <td align="center" valign="top" charoff="50">5.7</td>
          <td align="center" valign="top" charoff="50">16.0</td>
          <td align="center" valign="top" charoff="50">36.3</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">Yes</td>
          <td align="center" valign="top" charoff="50">SNAP</td>
          <td align="center" valign="top" charoff="50">FreeBayes</td>
          <td align="center" valign="top" charoff="50">12</td>
          <td align="center" valign="top" charoff="50">31.3</td>
          <td align="center" valign="top" charoff="50">5.3</td>
          <td align="center" valign="top" charoff="50">1.3</td>
          <td align="center" valign="top" charoff="50">20.5</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="t1-fn1">
        <p>A human whole genome data set (818 million 151 bp-long paired-end reads, 30X coverage) was aligned with BWA-MEM and SNAP. PCR duplicates were removed by Picardtools. Variants were called by GATK HaplotypeCaller and FreeBayes. Quick mode here denotes SeqMule’s built-in parallel framework. Built-in parallel capability is always turned on for underlying 3<sup>rd</sup> party algorithms (e.g. GATK’s -nt option).</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
</floats-group>
