<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7224214</article-id>
    <article-id pub-id-type="publisher-id">63043</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-020-63043-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BICORN: An R package for integrative inference of <italic>de novo</italic> cis-regulatory modules</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Xi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gu</surname>
          <given-names>Jinghua</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Neuwald</surname>
          <given-names>Andrew F.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hilakivi-Clarke</surname>
          <given-names>Leena</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9278-0854</contrib-id>
        <name>
          <surname>Clarke</surname>
          <given-names>Robert</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Xuan</surname>
          <given-names>Jianhua</given-names>
        </name>
        <address>
          <email>xuan@vt.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0694 4940</institution-id><institution-id institution-id-type="GRID">grid.438526.e</institution-id><institution>Bradley Department of Electrical and Computer Engineering, </institution><institution>Virginia Polytechnic Institute and State University, </institution></institution-wrap>900 North Glebe Road, Arlington, VA 22203 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 4685 2620</institution-id><institution-id institution-id-type="GRID">grid.486749.0</institution-id><institution>Baylor Research Institute, </institution></institution-wrap>3310 Live Oak St, Dallas, TX 75204 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2175 4264</institution-id><institution-id institution-id-type="GRID">grid.411024.2</institution-id><institution>Institute for Genome Sciences and Department Biochemistry &amp; Molecular Biology, </institution><institution>University of Maryland School of Medicine, </institution></institution-wrap>Baltimore, MD 21201 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2186 0438</institution-id><institution-id institution-id-type="GRID">grid.411667.3</institution-id><institution>Department of Oncology, </institution><institution>Lombardi Comprehensive Cancer Center, Georgetown University Medical Center, </institution></institution-wrap>3970 Reservoir Road, Washington, DC 20057 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>7960</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>9</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>1</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Genome-wide transcription factor (TF) binding signal analyses reveal co-localization of TF binding sites based on inferred cis-regulatory modules (CRMs). CRMs play a key role in understanding the cooperation of multiple TFs under specific conditions. However, the functions of CRMs and their effects on nearby gene transcription are highly dynamic and context-specific and therefore are challenging to characterize. BICORN (<underline>B</underline>ayesian <underline>I</underline>nference of <underline>CO</underline>operative <underline>R</underline>egulatory <underline>N</underline>etwork) builds a hierarchical Bayesian model and infers context-specific CRMs based on TF-gene binding events and gene expression data for a particular cell type. BICORN automatically searches for a list of candidate CRMs based on the input TF bindings at regulatory regions associated with genes of interest. Applying Gibbs sampling, BICORN iteratively estimates model parameters of CRMs, TF activities, and corresponding regulation on gene transcription, which it models as a sparse network of functional CRMs regulating target genes. The BICORN package is implemented in R (version 3.4 or later) and is publicly available on the CRAN server at <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/BICORN/index.html">https://cran.r-project.org/web/packages/BICORN/index.html</ext-link>.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Cancer genomics</kwd>
      <kwd>Gene regulatory networks</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000054</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | NIH | National Cancer Institute (NCI)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>164384</award-id>
        <award-id>149147</award-id>
        <award-id>149653</award-id>
        <principal-award-recipient>
          <name>
            <surname>Hilakivi-Clarke</surname>
            <given-names>Leena</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>Robert</given-names>
          </name>
          <name>
            <surname>Xuan</surname>
            <given-names>Jianhua</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>U.S. Department of Health &amp; Human Services | NIH | National Cancer Institute (NCI)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>U.S. Department of Health &amp; Human Services | NIH | National Cancer Institute (NCI)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par2">Transcription factor (TF)-DNA binding profiles are widely available since the rapid development of epigenetic biotechnologies<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup>. TFs regulate gene expression by binding at regulatory non-coding area (promoters or enhancers) and thereby recruiting RNA polymerase II and co-factors required for gene transcription<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. A cis-regulatory module (CRM) is defined as a stretch of DNA with binding sites of multiple TFs and has been frequently observed at active promoter or enhancer regions<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup>. Jointly modelling associations of multiple TFs at regulatory regions helps to uncover synergy among TFs and their regulatory effects on gene transcription<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>.</p>
    <p id="Par3">TF-associations (as CRMs) can be identified from genome-wide binding sites of individual TFs, their co-binding events, and their effects on gene transcription<sup><xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref></sup>. A major limitation of existing packages for inferring genome-wide <italic>de novo</italic> CRMs<sup><xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR11">11</xref></sup> is that they do not integrate with gene expression data and thus, cannot predict the regulatory effects of CRMs on genes. Conventional TF-gene regulatory network inference tools<sup><xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR14">14</xref></sup> fail in this regard either because they focus on individual TF-gene interactions rather than on multiple TFs associations. Among those tools focusing on the regulatory potential of multiple TFs, most only report strong regulators for each gene in order to avoid overfitting—which leads to incomplete regulatory network reconstruction.</p>
    <p id="Par4">To address these issues, here we describe BICORN (<underline>B</underline>ayesian <underline>I</underline>nference of <underline>CO</underline>operative <underline>R</underline>egulatory <underline>N</underline>etwork), a tool for functional CRM inference. Given TF-gene binding observations, BICORN first identifies a list of candidate CRMs, each with a unique combination of TFs. Next, for each CRM, target gene expression is modeled as a log-linear combination of TF activities and gene regulation strengths. Using Gibbs sampling, BICORN iteratively estimates TF activity, TF-gene regulatory strengths, and the posterior distribution of corresponding CRM models. Notably, for TFs in each CRM, their regulation strengths on a target gene are modeled jointly, so that sampling is based on the CRM’s overall regulatory effect on target gene transcription. For each CRM, a small number of TFs are jointly represented so that overfitting effects are largely alleviated and both strong and weak regulators (if any) on each gene are captured. (BICORN is named after a mythical beast composed of a combination of creatures, because it models CRMs composed of a combination of TFs.).</p>
    <p id="Par5">To support our hypothesis that TFs often regulate gene expression synergistically by forming CRMs rather than independently, we applied BICORN to multiple simulated and publicly available benchmark data sets. The accuracy and robustness of BICORN is indeed higher than that of conventional regulatory network inference tools. We further used BICORN to infer CRMs from diverse cell types and found that, for the same cell type (i.e. breast cancer MCF-7 cells), TFs function and associate differently at enhancers than at promoters and have associations that differ among different cell types. Therefore, BICORN-inferred CRMs are accurate and cell type-specific. We implemented BICORN in a R package and made it publicly available on the CRAN server at <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/BICORN/index.html">https://cran.r-project.org/web/packages/BICORN/index.html</ext-link>.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>BICORN input</title>
      <p id="Par6">BICORN requires two inputs: TF-gene binding events and gene expression data from the same context (Fig. <xref rid="Fig1" ref-type="fig">1A</xref>). Binary TF-gene binding input is used because it is the signal format most commonly used by different resources. For example, many databases (i.e., TRANSFACT) provided candidate target genes for a query TF; using ChIP-seq data, peaks of each TF can be aligned to enhancer or promoter regions and further associated with genes; for ATAC-seq data, TF motif enrichment scanning at accessible chromatin regions with gene annotation is a straightforward way to identify genes targeted by enriched TFs<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>.<fig id="Fig1"><label>Figure 1</label><caption><p>The workflow of BICORN. (<bold>A</bold>) For a particular cell type or tissue, given TF-gene binding events observed at promoter or enhancer regions and target gene expression data, (<bold>B</bold>) BICORN iteratively estimates TF activity (TFA), regulation strength (RS) and cis-regulatory modules (CRMs) using Gibbs sampling. (<bold>C</bold>) Based on the sampling statistics, a ranked list of CRMs (TF-associations) is obtained with target genes inferred for each. (<bold>D</bold>) Meanwhile, a TF-gene regulatory network is created so that TFs and their associations functioning under different situations (i.e., promoter vs. enhancer) can be compared.</p></caption><graphic xlink:href="41598_2020_63043_Fig1_HTML" id="d29e429"/></fig></p>
      <p id="Par7">To infer CRMs, BICORN identifies a list of candidate CRMs (in total <italic>K</italic>) for <italic>T</italic> given TFs. To account for prior binding knowledge, BICORN defines a candidate CRM matrix <bold><italic>B</italic></bold> with <italic>K</italic> rows and <italic>T</italic> columns. Each row <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k\in \{1,2,\mathrm{..}.,K\}$$\end{document}</tex-math><mml:math id="M2"><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq1.gif"/></alternatives></inline-formula> is a unique vector <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[{b}_{k,1},{b}_{k,2},\mathrm{..}.,{b}_{k,T}]$$\end{document}</tex-math><mml:math id="M4"><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq2.gif"/></alternatives></inline-formula> including binary binding states <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${b}_{k,t}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq3.gif"/></alternatives></inline-formula> (1 or 0). To account for ‘background’ genes not regulated by any CRMs, an all-zero vector <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[{b}_{0,1},{b}_{0,2},\mathrm{..}.,{b}_{0,T}]$$\end{document}</tex-math><mml:math id="M8"><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq4.gif"/></alternatives></inline-formula> is included in <bold><italic>B</italic></bold>. For gene <italic>n</italic>, BICORN defines a CRM index variable <italic>c</italic><sub><italic>n</italic></sub> (<inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{n}\in \{1,2,\mathrm{..}.,K\}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq5.gif"/></alternatives></inline-formula>) pointing to a row in <bold><italic>B</italic></bold>, denoting the CRM regulating expression of gene <italic>n</italic>.</p>
      <p id="Par8">For gene expression data, RNA-seq data (transcripts per million (TPM) values) are preferred<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> and microarray data can also be used with proper normalization. Given <italic>M</italic> expression profiles (samples) of <italic>N</italic> genes, we defined a gene expression matrix <bold>Y</bold>′ with each unit <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y{\text{'}}_{n,m}$$\end{document}</tex-math><mml:math id="M12"><mml:mi>y</mml:mi><mml:msub><mml:mrow><mml:mo>'</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq6.gif"/></alternatives></inline-formula> (<inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n\in \{1,2,\mathrm{..}.,N\}$$\end{document}</tex-math><mml:math id="M14"><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq7.gif"/></alternatives></inline-formula>, <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m\in \{1,2,\mathrm{..}.,M\}$$\end{document}</tex-math><mml:math id="M16"><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq8.gif"/></alternatives></inline-formula>) representing the expression value of gene <italic>n</italic> under sample <italic>m</italic>.</p>
    </sec>
    <sec id="Sec4">
      <title>BICORN algorithm</title>
      <sec id="Sec5">
        <title>Log-linear model</title>
        <p id="Par9">Gene expression are usually measured and studied with respect to a reference level. Thus, for gene <italic>n</italic>, we approximate its expression <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y{\text{'}}_{n,m}$$\end{document}</tex-math><mml:math id="M18"><mml:mi>y</mml:mi><mml:msub><mml:mrow><mml:mo>'</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq9.gif"/></alternatives></inline-formula> by modeling the relationship between protein activities of TFs regulating gene <italic>n</italic> and the variation of gene expression under sample <italic>m</italic> from its baseline expression <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r{\text{'}}_{n}$$\end{document}</tex-math><mml:math id="M20"><mml:mi>r</mml:mi><mml:msub><mml:mrow><mml:mo>'</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq10.gif"/></alternatives></inline-formula>, using a log-linear model<sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup> as follows:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{y{\text{'}}_{n,m}}{r{\text{'}}_{n}}=\prod _{t}{({x}_{t,m})}^{{a}_{{c}_{n},t}{b}_{{c}_{n},t}},$$\end{document}</tex-math><mml:math id="M22" display="block"><mml:mfrac><mml:mrow><mml:mi>y</mml:mi><mml:msub><mml:mrow><mml:mo>'</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:msub><mml:mrow><mml:mo>'</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41598_2020_63043_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par10">In time-course gene expression data, the baseline expression <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r{\text{'}}_{n}$$\end{document}</tex-math><mml:math id="M24"><mml:mi>r</mml:mi><mml:msub><mml:mrow><mml:mo>'</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq11.gif"/></alternatives></inline-formula> refers to the expression value under time ‘0’; in steady-state data, <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r{\text{'}}_{n}$$\end{document}</tex-math><mml:math id="M26"><mml:mi>r</mml:mi><mml:msub><mml:mrow><mml:mo>'</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq12.gif"/></alternatives></inline-formula> can be approximated using the mean expression across all samples and conditions. <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${a}_{{c}_{n},t}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq13.gif"/></alternatives></inline-formula> represents the regulation effect of the binding event <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${b}_{{c}_{n},t}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq14.gif"/></alternatives></inline-formula> of TF <italic>t</italic> in module <italic>c</italic><sub><italic>n</italic></sub>. The regulation is effective when TF <italic>t</italic> physically binds to promoter or enhancer regions associated with the gene <italic>n</italic>. <italic>x</italic><sub><italic>t,m</italic></sub> represents the proteomic response (or activity) of TF <italic>t</italic> in sample <italic>m</italic>. The following equation can be derived from Eq. (<xref rid="Equ1" ref-type="">1</xref>) after taking the logarithm:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log (y{\text{'}}_{n,m})=\sum _{t}{a}_{{c}_{n},t}{b}_{{c}_{n},t}\,\log (x{\text{'}}_{t,m})+\,\log (r{\text{'}}_{n}).$$\end{document}</tex-math><mml:math id="M32" display="block"><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:msub><mml:mrow><mml:mo>'</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mspace width=".25em"/><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:msub><mml:mrow><mml:mo>'</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mspace width=".25em"/><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:msub><mml:mrow><mml:mo>'</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41598_2020_63043_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par11">We define <inline-formula id="IEq15"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{n,m}=\,\log (y{\text{'}}_{n,m})$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mspace width=".25em"/><mml:mi>log</mml:mi><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:msub><mml:mrow><mml:mo>'</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq15.gif"/></alternatives></inline-formula>, <inline-formula id="IEq16"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{t,m}=\,\log (x{\text{'}}_{t,m})$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mspace width=".25em"/><mml:mi>log</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:msub><mml:mrow><mml:mo>'</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq16.gif"/></alternatives></inline-formula>, <inline-formula id="IEq17"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{n}=\,\log (r{\text{'}}_{n})$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mspace width=".25em"/><mml:mi>log</mml:mi><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:msub><mml:mrow><mml:mo>'</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq17.gif"/></alternatives></inline-formula> and add <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{n,m}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq18.gif"/></alternatives></inline-formula> to denote the noise in the gene expression data. Then, we derive the following log-linear model:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{n,m}=\sum _{t}{a}_{{c}_{n},t}{b}_{{c}_{n},t}{x}_{t,m}+{r}_{n}+{e}_{n,m}.$$\end{document}</tex-math><mml:math id="M42" display="block"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41598_2020_63043_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par12">The log linear model has been used previously to describe the relationship between promoter activity and transcription factor activities<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. In particular, the value of <inline-formula id="IEq19"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${a}_{{c}_{n},t}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq19.gif"/></alternatives></inline-formula> is determined by the Hill coefficients and the TF binding affinity to the promoter region<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. Model parameters of <inline-formula id="IEq20"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{t,m}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq20.gif"/></alternatives></inline-formula>, <inline-formula id="IEq21"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${a}_{{c}_{n},t}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq21.gif"/></alternatives></inline-formula> and <inline-formula id="IEq22"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${b}_{{c}_{n},t}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq22.gif"/></alternatives></inline-formula> are dependent with each other. By estimating all model parameters we can eventually identify module <italic>c</italic><sub><italic>n</italic></sub>.</p>
        <p id="Par13">When multiple TFs are jointly studied, unlike many existing tools that only report strong regulators for each gene<sup><xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR21">21</xref></sup>, which leads to an incomplete reconstruction of the true regulatory network, BICORN lowers the model overfitting effects as follows: it introduces an index variable <italic>c</italic><sub><italic>n</italic></sub> linking a candidate CRM (a row in matrix <bold>b</bold>) to gene <italic>n</italic>. Regulation strengths <inline-formula id="IEq23"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${a}_{{c}_{n},t}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq23.gif"/></alternatives></inline-formula> of all TFs in <italic>c</italic><sub><italic>n</italic></sub> are jointly estimated, including both strong and weak regulators (if any). Since the number of TFs in each <italic>c</italic><sub><italic>n</italic></sub> is relatively small (usually less than six), in every evaluation the overfitting effects are largely alleviated. After evaluating all candidate modules for gene <italic>n</italic> and repeating this process for every gene, in the end, a regulatory network with both strong and weak bindings is reconstructed. BICORN uses a hierarchical Bayesian framework to model dependencies between variables, which are robustly estimated using Gibbs sampling.</p>
      </sec>
      <sec id="Sec6">
        <title>A hierarchical Bayesian framework</title>
        <p id="Par14">Model variables included regulation strength matrix <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bf{A}}=[{a}_{{c}_{n},t}]$$\end{document}</tex-math><mml:math id="M54"><mml:mi mathvariant="bold">A</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq24.gif"/></alternatives></inline-formula>, TF activity matrix <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bf{X}}=[{x}_{t,m}]$$\end{document}</tex-math><mml:math id="M56"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq25.gif"/></alternatives></inline-formula>, module index vector <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bf{C}}=[{c}_{n}]$$\end{document}</tex-math><mml:math id="M58"><mml:mi mathvariant="bold">C</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq26.gif"/></alternatives></inline-formula>, residual baseline expression vector <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bf{R}}=[{r}_{n}]$$\end{document}</tex-math><mml:math id="M60"><mml:mi mathvariant="bold">R</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq27.gif"/></alternatives></inline-formula> and gene expression noise matrix <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bf{E}}=[{e}_{n,m}]$$\end{document}</tex-math><mml:math id="M62"><mml:mi mathvariant="bold">E</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq28.gif"/></alternatives></inline-formula>. Given the log value of gene expression in matrix <inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bf{Y}}=[{y}_{n,m}]$$\end{document}</tex-math><mml:math id="M64"><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq29.gif"/></alternatives></inline-formula> and prior TF-gene binding events in matrix <inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bf{B}}=[{b}_{{c}_{n},t}]$$\end{document}</tex-math><mml:math id="M66"><mml:mi mathvariant="bold">B</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq30.gif"/></alternatives></inline-formula>, we proposed the herachical Bayesian framework shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref> to model dependencies between variables.<fig id="Fig2"><label>Figure 2</label><caption><p>A hierarchical Bayesian framework for gene regulation modelling. CRM variables define the binding states of each gene. For each binding event, the regulation strength is either positive or negative to denoting gene activation or depression by the binding TF, respectively. Meanwhile, through TF-gene regulation, the TF activity is directly connected to target gene expression, along with residual baseline expression and noise.</p></caption><graphic xlink:href="41598_2020_63043_Fig2_HTML" id="d29e1788"/></fig></p>
        <p id="Par15">Based on this model, we define a posterior probability as:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}P({\bf{A}},{\bf{C}},{\bf{X}},{\bf{R}},{\sigma }^{2}|{\bf{Y}},{\bf{B}})\\ \propto P({\bf{Y}}|{\bf{B}},{\bf{A}},{\bf{C}},{\bf{X}},{\bf{R}},{\sigma }^{2})P({\bf{A}}|{\bf{C}})P({\bf{C}})P({\bf{X}})P({\bf{R}})P({\sigma }^{2})\\ \propto \prod _{n}\prod _{m}\prod _{t}P({y}_{n,m}|{a}_{n,t},{c}_{n},{x}_{t,m},{r}_{n},{\sigma }_{\varepsilon }^{2})P({a}_{n,t}|{b}_{{c}_{n},t})P({c}_{n})P({x}_{t,m})P({r}_{n})P({\sigma }_{\varepsilon }^{2})\end{array}.$$\end{document}</tex-math><mml:math id="M68" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">R</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">R</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">R</mml:mi><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>∝</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mi>n</mml:mi></mml:munder><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mi>m</mml:mi></mml:munder><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41598_2020_63043_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par16">To estimate these variables using Bayesian inference, we made proper prior distribution assumptions on each. The binary binding state <italic>b</italic> is defined by the CRM index variable <italic>c</italic>, which corresponds to a row of the CRM matrix <bold><italic>B</italic></bold>. We assume a uniform prior on <italic>c</italic> (<inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(c)=1/K$$\end{document}</tex-math><mml:math id="M70"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>K</mml:mi></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq31.gif"/></alternatives></inline-formula>). The regulation strength variable <italic>a</italic> can be either positive (a TF activates gene expression) or negative (a TF suppresses gene expression) and is conditioned on <italic>b</italic>: If <inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b=1$$\end{document}</tex-math><mml:math id="M72"><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq32.gif"/></alternatives></inline-formula>, we assume a zero-mean prior Gaussian distribution on <italic>a</italic> as <inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(a|b=1)=N(0,{\sigma }_{a,hyper}^{2})$$\end{document}</tex-math><mml:math id="M74"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>|</mml:mo><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq33.gif"/></alternatives></inline-formula> by assuming that in the whole regulatory network, regulation strengths <italic>a</italic> can be either positive or negative without informative prior; if <inline-formula id="IEq34"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b=0$$\end{document}</tex-math><mml:math id="M76"><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq34.gif"/></alternatives></inline-formula>, there is no functioning regulatory relationship between the pair TF and gene so we set <inline-formula id="IEq35"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a=0$$\end{document}</tex-math><mml:math id="M78"><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq35.gif"/></alternatives></inline-formula>.</p>
        <p id="Par17">As the mRNA expression of a TF can be either up-regulated or down-regulated with respect to the baseline expression, its proteomic response can also be positive or negative compared to the baseline activity. Therefore, we model TF activity as a Gaussian random process and each variable <italic>x</italic> follows a Gaussian distribution with prior <inline-formula id="IEq36"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(x)=N(0,{\sigma }_{x,hyper}^{2})$$\end{document}</tex-math><mml:math id="M80"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq36.gif"/></alternatives></inline-formula>.</p>
        <p id="Par18">Variable <italic>r</italic> represents the baseline expression and is invariant across samples. The baseline expression arocess genes vary a lot. To infer model parameters jointly for all genes, gene expression data is log-transformed and then normalized with mean expression of each gene to zero. Theoritically, the baseline expression of each gene is zero. However, in real data process, the normalzaition process may not be perfect so we use variable <italic>r</italic> to denote the baseline expression residual. The gene expression noise <italic>e</italic> varies across samples. We assumed zero-mean Gaussian priors on both <italic>r</italic> and <italic>e</italic> as <inline-formula id="IEq37"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(r)=N(0,{\sigma }_{r,hyper}^{2})$$\end{document}</tex-math><mml:math id="M82"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq37.gif"/></alternatives></inline-formula> and <inline-formula id="IEq38"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(e)=N(0,{\sigma }_{e}^{2})$$\end{document}</tex-math><mml:math id="M84"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq38.gif"/></alternatives></inline-formula>.</p>
        <p id="Par19">In this model, <inline-formula id="IEq39"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }_{x,hyper}^{2}$$\end{document}</tex-math><mml:math id="M86"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq39.gif"/></alternatives></inline-formula>, <inline-formula id="IEq40"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }_{a,hyper}^{2}$$\end{document}</tex-math><mml:math id="M88"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq40.gif"/></alternatives></inline-formula> and <inline-formula id="IEq41"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }_{r,hyper}^{2}$$\end{document}</tex-math><mml:math id="M90"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq41.gif"/></alternatives></inline-formula> are hyperparameters whereas the noise level <inline-formula id="IEq42"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }_{e}^{2}$$\end{document}</tex-math><mml:math id="M92"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq42.gif"/></alternatives></inline-formula> is a variable because the gene expression data quality varies case by case. To ensure the convergence of Gibbs Sampling, we assume the conjugate prior of Gaussian——the inverse Gamma distribution on <inline-formula id="IEq43"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }_{e}^{2}$$\end{document}</tex-math><mml:math id="M94"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq43.gif"/></alternatives></inline-formula>: <inline-formula id="IEq44"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P({\sigma }_{e}^{2})=inverseGamma(\alpha ,\beta )$$\end{document}</tex-math><mml:math id="M96"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>G</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq44.gif"/></alternatives></inline-formula>, with hyperparameters <inline-formula id="IEq45"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><mml:math id="M98"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq45.gif"/></alternatives></inline-formula> and <inline-formula id="IEq46"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta $$\end{document}</tex-math><mml:math id="M100"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq46.gif"/></alternatives></inline-formula>. Hyperparameter selection is discussed in <bold><italic>Supplementary Methods</italic></bold>.</p>
      </sec>
      <sec id="Sec7">
        <title>Gibbs Sampling</title>
        <p id="Par20">Using Gibbs sampling, BICORN iteratively learns the marginal distribution of each variable to approximate the joint posterior distribution. The uncertainty of the observed gene expression measure <inline-formula id="IEq47"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}_{n,m}$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq47.gif"/></alternatives></inline-formula> is due to noise, which, conditioned on the other variables, is estimated as: <inline-formula id="IEq48"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{n,m}={y}_{n,m}-\sum _{t}{a}_{{c}_{n},t}{b}_{{c}_{n},t}{x}_{t,m}-{r}_{n}$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq48.gif"/></alternatives></inline-formula>. As <inline-formula id="IEq49"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}_{n,m}$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq49.gif"/></alternatives></inline-formula> is a Gaussian distributed variable, the conditional probability <inline-formula id="IEq50"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P({y}_{n,m}|{a}_{n,t},{c}_{n},{x}_{t,m},{r}_{n},{\sigma }_{\varepsilon }^{2})$$\end{document}</tex-math><mml:math id="M108"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq50.gif"/></alternatives></inline-formula> in Eq. (<xref rid="Equ2" ref-type="">2</xref>) is a Gaussian distribution. Given that we assume Gaussian priors on TF activity <italic>x</italic>, regulation strength <italic>a</italic>, and baseline expression residual <italic>r</italic>, the marginal distribution of each variable is also Gaussian. Therefore, we sample these variables according to their posterior Gaussian distributions as follows:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{t,m}\sim N({\mu \text{'}}_{x},{\sigma \text{'}}_{x}^{2}),$$\end{document}</tex-math><mml:math id="M110" display="block"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41598_2020_63043_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${a}_{n,t}\sim N({\mu \text{'}}_{a},{\sigma \text{'}}_{a}^{2}),$$\end{document}</tex-math><mml:math id="M112" display="block"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41598_2020_63043_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{n}\sim N({\mu \text{'}}_{r},{\sigma \text{'}}_{r}^{2}),$$\end{document}</tex-math><mml:math id="M114" display="block"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41598_2020_63043_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where the posterior Gaussian distribution parameters <inline-formula id="IEq51"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mu \text{'}}_{x}$$\end{document}</tex-math><mml:math id="M116"><mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq51.gif"/></alternatives></inline-formula>, <inline-formula id="IEq52"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma \text{'}}_{x}^{2}$$\end{document}</tex-math><mml:math id="M118"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq52.gif"/></alternatives></inline-formula>, <inline-formula id="IEq53"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mu \text{'}}_{a}$$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq53.gif"/></alternatives></inline-formula>, <inline-formula id="IEq54"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma \text{'}}_{a}^{2}$$\end{document}</tex-math><mml:math id="M122"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq54.gif"/></alternatives></inline-formula>, <inline-formula id="IEq55"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mu \text{'}}_{r}$$\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq55.gif"/></alternatives></inline-formula> and <inline-formula id="IEq56"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma \text{'}}_{r}^{2}$$\end{document}</tex-math><mml:math id="M126"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq56.gif"/></alternatives></inline-formula> are updated after each round of sampling, as described in <bold><italic>Supplementary Methods</italic></bold>. The CRM variable <italic>c</italic><sub><italic>n</italic></sub> is sampled according to the posterior probability:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p({c}_{n}=k)=\frac{P({c}_{n}=k|{\bf{Y}},{\bf{B}},{\bf{A}},{\bf{X}},{\bf{R}},{\sigma }_{e}^{2})}{\sum _{j}P({c}_{n}=j|{\bf{Y}},{\bf{B}},{\bf{A}},{\bf{X}},{\bf{R}},{\sigma }_{e}^{2})}.$$\end{document}</tex-math><mml:math id="M128" display="block"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">R</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">R</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41598_2020_63043_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par21">The overall performance of sampled variables is controlled by the noise variance <inline-formula id="IEq57"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }_{\varepsilon }^{2}$$\end{document}</tex-math><mml:math id="M130"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq57.gif"/></alternatives></inline-formula>, which, after each round of sampling over the other variables, is updated by sampling according to the conditional probability:<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }_{e}^{2} \sim {\rm{inverse}}Gamma(\alpha \text{'},\beta \text{'}),$$\end{document}</tex-math><mml:math id="M132" display="block"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>~</mml:mo><mml:mi mathvariant="normal">inverse</mml:mi><mml:mi>G</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>'</mml:mo><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>'</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41598_2020_63043_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq58"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \text{'}$$\end{document}</tex-math><mml:math id="M134"><mml:mi>α</mml:mi><mml:mo>'</mml:mo></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq58.gif"/></alternatives></inline-formula> and <inline-formula id="IEq59"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta \text{'}$$\end{document}</tex-math><mml:math id="M136"><mml:mi>β</mml:mi><mml:mo>'</mml:mo></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq59.gif"/></alternatives></inline-formula> are the posterior inverse Gamma distribution parameters and updated after each round of sampling. The detailed calculation of each parameter is described in <bold><italic>Supplementary Methods</italic></bold>.</p>
        <p id="Par22">Using Gibbs sampling, BICORN iteratively estimated regulation strength, TF activity and CRMs (Fig. <xref rid="Fig1" ref-type="fig">1B</xref>). To initiate the sampling process, for each gene, based on its prior binding events and candidate module matrix, we randomly select a module whose binding events are all observed at the regulatory region of the current genes. We then randomly generate initial values of regulation strengths according to the prior Gaussian distribution. Similarly, for TF activities, we generate their initial Gaussian-distributed activities. The initial baseline expression residual can then be obtained using <inline-formula id="IEq60"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{n}=\sum _{m}({y}_{n,m}-\sum _{t}{a}_{{c}_{n},t}{b}_{{c}_{n},t}{x}_{t,m})/M$$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>m</mml:mi></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="41598_2020_63043_Article_IEq60.gif"/></alternatives></inline-formula> to ensure that the gene expression noise has a zero mean. We run Gibbs sampling to generate samples of each variable iteratively. As a carefully designed MCMC process, the sampling process should converge from different initial states to the final steady state. Therefore, we monitor the convergence of each variable based on the ratio of the within-sequence-variance and the between-sequence-variance for multiple sampling sequences, each starting from a different initial state<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. When the sampler begins to converge to the stationary distribution, this ratio would be around 1. We monitor the sampling convergence for TF activities and regulation strengths. Once both of these converge, we accumulate samples on CRMs for each gene.</p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>BICORN output</title>
      <p id="Par23">The gene sampling frequencies for individual CRMs represent the posterior probabilities of regulation. Using a threshold probability (i.e. 0.85) as a cutoff, genes for each CRM are identified and further CRMs are ranked by the number of target genes each regulates (Fig. <xref rid="Fig1" ref-type="fig">1C</xref>). Meanwhile, for each TF, its sampling frequency (summed over all CRMs containing this TF) represents the posterior probability of TF-gene regulation (Fig. <xref rid="Fig1" ref-type="fig">1D</xref>).</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="results">
    <title>Results</title>
    <sec id="Sec10">
      <title>BICORN accurately infers CRMs, genes and regulatory networks</title>
      <p id="Par24">We tested and compared the performance of BICORN and those of integrative Bayesian tools BNCA<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> and COGRIM<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> on simulated data. We simulated ten different TF-gene binding networks including 160 genes and 20 TFs, each with 80 true target genes. Each gene was regulated by a CRM with 2 ~ 6 TFs. Regulation strengths were generated as zero-mean and one-standard deviation Gaussian random variables with a high score (&gt;2 or &lt; −2) for strong regulators and a low but non-zero score for weak regulators. TF activities were simulated for 20 TFs using Gaussian random processes with zero-mean and one-standard deviation. Given the simulated network and variable values, a gene expression dataset was simulated using the log-linear model as in Eq. (<xref rid="Equ1" ref-type="">1</xref>). We added 30% false positive interactions to each simulated network and used the perturbed bindings as prior TF-gene binding events. We also added zero-mean Gaussian distributed noise to the simulated gene expression data with a variance of 0.5 (signal-to-noise ratio 3 dB).</p>
      <p id="Par25">We first calculated precision and recall of each method on CRM identification. As shown in Fig. <xref rid="Fig3" ref-type="fig">3A</xref>, achieving the same precision performance around 0.75, BICORN correctly identified CRMs for more genes, with a recall of 0.66, compared to the recall values of ~0.1 for both BNCA and COGRIMN. BICORN also identified more target genes. In many situations, given data of TF-gene regulation and gene expression, genes are major targets for identification. Here, a target gene was correctly identified when at least one of its upstream regulators was captured. We simulated more scenarios by adding different levels (10% ~ 40%) of false positive interactions to the prior binding networks. As shown in Fig. <xref rid="Fig3" ref-type="fig">3B</xref>, BICORN exhibited superior performance.<fig id="Fig3"><label>Figure 3</label><caption><p>Performances of BICORN and competing methods on simulated and benchmark datasets. (<bold>A</bold>) Precision-recall performances on CRM identification using simulated data. (<bold>B</bold>) AUC performances on target gene prediction using simulated data. (<bold>C</bold>) F-measure performances on TF-gene regulatory network identification using DREAM 4 in silico benchmark data. Central values of the box plot represent the median, the box extends from quantile 25 to the 75 percentiles, and whiskers extend to the maximum and minimum values no further than 1.5 times the interquartile range from the hinge.</p></caption><graphic xlink:href="41598_2020_63043_Fig3_HTML" id="d29e3576"/></fig></p>
      <p id="Par26">To further evaluate the performance of BICORN on regulatory network inference (recovering TF-gene binding events), we downloaded benchmark networks and training time course gene expression data from the Synapse platform (<ext-link ext-link-type="uri" xlink:href="https://www.synapse.org/">https://www.synapse.org/</ext-link>, Synapse ID: syn3049712), which were used for DREAM challenge 4<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. There were 5 different benchmark regulatory networks and 50 time-course gene expression datasets (10 for each network). The network was very sparse with a median of two TFs regulating each gene. To evaluate the robustness of BICORN on regulatory network inference, we perturbed prior binding observations by introducing 5% to 50% false negative interactions (a ‘true’ TF-gene interaction in the benchmark network but ‘missed’ by the prior binding matrix) or 5% to 100% false positive interactions. The F-measure (2*precision*recall/(precision+recall)) of BICORN is shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">S1</xref>. When the rate of false negative interactions is under 15% or the rate of false positive interactions is under 30%, BICORN can achieve an average F-measure higher than 0.9.</p>
      <p id="Par27">We further compared the performance of BICORN to that of existing methods. Besides the above mentioned Bayesian methods, we included additional competing methods including CRNET<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, LASSO<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>, NARROMI<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> and GENIE3<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. CRNET and LASSO are integrative methods using prior TF-gene bindings and gene expression. NARROMI and GENIE3 are inferring gene regulatory networks using gene expression data only. Specific for NARROMI and GENIE3, for a fair compare we checked their accuracy respectively using all the originally inferred bindings or inferred bindings with prior observations only, in which the prior knowledge was introduced to the model. We randomly perturbed benchmark networks by adding 15% false negative connections and 30% false positive connections and used the perturbed network as input. F-measure of each method under default setting was recorded. BICORN performed better than all selected competing methods and overperformed NARROMI and GENIE3 with prior TF-gene bindings provided (Fig. <xref rid="Fig3" ref-type="fig">3C</xref>).</p>
    </sec>
    <sec id="Sec11">
      <title>CRM at promoters and enhancers of breast cancer cells</title>
      <p id="Par28">The chromatin states of enhancers and promoters exhibit different histone markers<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>. Using BICORN, we further investigated these differences by studying CRMs at enhancers and promoters and comparing functional TFs at these regions. We applied BICORN to data acquired from breast cancer MCF-7 cells: 39 TFs ChIP-seq profiles from ENCODE (<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/">https://www.encodeproject.org/</ext-link>) and two 17b-E2 treated MCF-7 RNA-seq datasets from the GEO database (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/">https://www.ncbi.nlm.nih.gov/geo/</ext-link>, with accession numbers GSE62789 and GSE51403). The GSE62789 dataset included ten samples measured within 24 hours (hrs) of 10 nM 17b-E2 treatment. The GSE51403 dataset included seven samples measured under vehicle condition and another seven samples measured after 24 hrs treatment of 10 nM 17b-E2. We collected differentially expressed genes as reported in the original publications<sup><xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup> and identified 235 common E2 active genes for further exploration. To test the robustness of CRMs predicted by BICORN, we respectively applied BICORN to the above two relevant gene expression datasets and characterized genes showing significant differential expression in both datasets.</p>
      <sec id="Sec12">
        <title>Promoter analysis</title>
        <p id="Par29">We annotated peaks of each TF using GREAT<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> and selected peaks falling in promoter regions (+/1k bps around transcription start sites). Based on the binding events (annotated peaks) of 39 TFs on 235 active genes, BICORN identified 73 candidate CRMs. Further integrating the prior TF-gene binding events with each of the above mentioned target gene expression dataset, BICORN finally inferred 549 reliable CRM-gene interactions (sampling frequency&gt; 0.85) for the GSE62789 dataset and 545 interactions for the GSE51403 dataset, with an overlap of 466 (86%) CRM-gene interactions covering 32 TFs and 113 target genes. Learned distributions of model parameters are shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">S2</xref>, in which the posterior regulatory strengths, TF activities and residuals of baseline expression all follow Gaussian distributions. Focusing on those common interactions, CRMs were sorted based on the number of target genes regulated by each and the top 20 CRMs were listed in Fig. <xref rid="Fig4" ref-type="fig">4A</xref>. Moreover, all TFs were sorted using TF-gene interactions, as shown in Fig. <xref rid="Fig4" ref-type="fig">4B</xref>. We found that MBD3 frequently interacted with other TFs, for example POLR2A, at promoter regions. As a member of the nucleosome remodeling and deacetylation (NuRD) complex, MBD3 was demonstrated to be enriched at active promoters<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> and to influence the association of POLR2A at transcription start sites<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>.<fig id="Fig4"><label>Figure 4</label><caption><p>TFs functional at promoter or enhancer regions of E2 responsive target genes in breast cancer MCF-7 cells. (<bold>A</bold>) BICORN identified top 20 CRMs functioning at promoter regions; (<bold>B</bold>) strong (green), weak (light green) and little-active (grey) TFs at promoter regions; (<bold>C</bold>) BICORN identified top 20 CRMs functioning at enhancer regions; (<bold>D</bold>) strong (purple), weak (light purple) and little-active (grey) TFs at enhancer regions.</p></caption><graphic xlink:href="41598_2020_63043_Fig4_HTML" id="d29e3685"/></fig></p>
      </sec>
      <sec id="Sec13">
        <title>Enhancer analysis</title>
        <p id="Par30">To associate TF bindings at enhancer regions with target genes, we downloaded MCF-7-specific enhancer-like regions and ChIA-PET data from the ENCODE database. TF peaks were first aligned to enhancer regions and then looping to genes using ChIP-PET chromatin interactions. Distal binding events of the 39 TFs, 1857 enhancers and 235 target genes were collected, based on which BICORN identified 56 candidate CRMs. Integrating the distal TF binding events associated with genes and target gene expression together, BICORN finally identified 822 distal CRM-gene interactions using the GSE62789 dataset and 816 interactions using the GSE51403 dataset, with 630 (77%) common CRM-gene interactions covering 22 TFs and 99 target genes. Learned distributions of model parameters are shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">S2</xref>, in which the posterior regulatory strengths, TF activities and residuals of baseline expression all follow Gaussian distributions. The top 20 CRMs and sorted TFs were shown in Fig. <xref rid="Fig4" ref-type="fig">4C,D</xref>, respectively. Among these, E2F1 actively binds at enhancer regions and interacts with factors including EP300, a well-known enhancer factor<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. The loss of E2F1 did not change expression of known E2F target genes, suggesting that perhaps E2F1-specific regulatory regions are distinct from known E2F target promoters<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. Indeed, in our analysis, E2F1 is active enriched in enhancer regions and associates with several other TFs by forming multiple CRMs, but much less active at promoter regions.</p>
        <p id="Par31">Comparing functional TF bindings at promoter and enhancer regions we found that, in general, active TFs at promoter and enhancer regions differ in this breast cancer study (Fig. <xref rid="MOESM1" ref-type="media">S1</xref>). HSF1, cJUN, EGR1, GABPA, FOXM1, MBD3 and GATA3 had intensive bindings at gene promoters but almost none at enhancers. Another six TFs including E2F1, FOSL2, ELF1, HDAC2, CEBPB and FOXA1 were highly active at enhancers with few functional bindings at promoters. Only four TFs functioned at both regions but either individual enrichment or associations among each other were quite different between enhancers and promoters. Therefore, CRMs should be studied separately at promoters and enhancers to reveal a complete map of regulatory signals mediating gene transcription.</p>
      </sec>
    </sec>
    <sec id="Sec14">
      <title>Functional CRMs identification of diverse cell types</title>
      <p id="Par32">To demonstrate BICORN’s broad applicability, we applied it to six other cell types: K562, GM12878, HepG2, A549, SK-N-SH and HCT116. For each cell type, TF ChIP-seq profiles were downloaded from the ENCODE database and a matched gene expression data set was downloaded from the GEO database, as summarized in Table <xref rid="Tab1" ref-type="table">1</xref>. Detailed data processing process as well as the number of enhancers, genes and modules studied for each case can be found from <bold><italic>Supplementary Results</italic></bold>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Prior bindings and gene expression data used for CRM inference.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Cell line</th><th>Number of TFs (ENCODE database)</th><th>Gene expression data (GEO database)</th><th>Promoter</th><th>Enhancer</th></tr></thead><tbody><tr><td><italic>K562</italic></td><td>203</td><td><italic>GSE1036</italic></td><td>✓</td><td>✓</td></tr><tr><td><italic>GM12878</italic></td><td>122</td><td><italic>GSE51709</italic></td><td>✓</td><td>✓</td></tr><tr><td><italic>HepG2</italic></td><td>108</td><td><italic>GSE6869</italic></td><td>✓</td><td>✓</td></tr><tr><td><italic>A549</italic></td><td>52</td><td><italic>GSE69667</italic></td><td>✓</td><td/></tr><tr><td><italic>SK-N-SH</italic></td><td>28</td><td><italic>GSE9169</italic></td><td>✓</td><td/></tr><tr><td><italic>HCT116</italic></td><td>20</td><td><italic>GSE14103</italic></td><td>✓</td><td>✓</td></tr></tbody></table></table-wrap></p>
      <p id="Par33">TFs functionally activate/suppress the regulatory activity of the region that they bind to. For each cell type, we validated the cell type-specificity of BICORN inferred TF modules by checking their regression performance to the matched promoter or enhancer activities. Cell type-specific promoter or enhancer activities for regions studied by BICORN were downloaded from the FANTOM5 database<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. For each cell type, we built a logistic regression model using 70% active/inactive promoter or enhancer regions with BICORN inferred CRMs or with randomly permuted CRMs. Active/inactive promoter or enhancer region selection is described in <bold><italic>Supplementary Results</italic></bold>. AUROC (area under receiver operating characteristic curve) is calculated to evaluate the prediction performance of the built model on the 30% hold-out regions (Fig. <xref rid="Fig5" ref-type="fig">5A</xref> for promoter and Fig. <xref rid="Fig5" ref-type="fig">5B</xref> for enhancer). In all studied cases, the performance of BICORN inferred CRMs is significantly higher than that of the permuted CRMs (Wilcoxon rank sum test <italic>p</italic>-value &lt;1e-9). Numbers of active/inactive promoter and enhancers in each cell type and the significance p-value of each case can be found in Supplementary Table <xref rid="MOESM1" ref-type="media">S1</xref>.<fig id="Fig5"><label>Figure 5</label><caption><p>Prediction performance on cell type-specific promoter or enhancer activities using BICORN inferred CRMs. (<bold>A</bold>) promoter prediction for seven cell types; (<bold>B</bold>) enhancer prediction for five cell types. Central values of the box plot represent the median, the box extends from quantile 25 to the 75 percentiles, and whiskers extend to the maximum and minimum values no further than 1.5 times the interquartile range from the hinge.</p></caption><graphic xlink:href="41598_2020_63043_Fig5_HTML" id="d29e3892"/></fig></p>
      <p id="Par34">Further examination of CRMs predicted by BICORN revealed strong and consistent cell-type specificity to existing literatures. At promoters, CTCF-RAD21 was previously reported to be functional around transcription start sites of genes specific to K562 cells with evidence suggesting that RAD21 contributes to stable CTCF bindings<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. SOX13-SOX5 was identified from HepG2 promoter study. Both transcription factors are from SOX family and SOX13 complements SOX5 functionally<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. In A549 cells, the association between E2F6 and MAX was top ranked by BICORN. MAX is a member of the E2F6 complex, which usually binds to E2F-resposive promoters, and is involved in gene repression<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>. In SK-N-SH cells, one of the top-ranked CRMs included three transcription factors: CTCF, RAD21, and SMC3. CTCF and the cohesin complex, consisting of the core subunits SMC3 and RAD21, were found to colocalize extensively throughout mammalian genomes<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>. In HCT116 cells, the CRM of FOSL1-JUND was identified. To regulate gene transcription, FOSL1 requires a dimerization partner, which is often a member of the JUN family<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>.</p>
      <p id="Par35">At enhancers, NRF1-RFX1 was the top-ranked CRM in K562 cells with RFX1 exhibiting RNA polymerase II distal enhancer sequence-specific binding<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. In another blood cell type, GM12878, ELF1-ZEB1 was highly ranked with two B-cell specific transcription factors: MTA2-TBX21, which was predicted to be active at its enhancers, and with MTA2 occupancy on enhancers demonstrated in<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. At HepG2 enhancers, BICORN found a strong association between SUZ12 and ZNF143–two PRC2 epigenomic signatures, whose association with enhancers was previously reported<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. In HCT116 cells, BICORN identified POLR2A-YY1, which generally occupies active enhancers and promoters across cell types and plays structural roles in enhancer-promoter loops<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>.</p>
    </sec>
  </sec>
  <sec id="Sec15" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par36">Identifying high-order TF associations (as CRMs) and how these affect the gene transcription process is an open challenge. Conventional regulatory network analysis cannot tell how TFs associate with each other to regulate specific genes. This challenge is also hard to address experimentally as the simultaneous knockdown of more than one protein is not trivial. Our tool, BICORN, addresses a critical need: it enables to efficiently identify context-specific CRMs among hundreds of TFs. BICORN does this by integrating (proximal or distal) TF-gene binding events and target gene expression data and builds a hierarchical Bayesian framework to estimate values of all modelled variables. We have applied BICORN to both simulated and real data and have demonstrated its robustness and efficiency on module inference. BICORN is a general tool and can be readily applied to data generated from any cell type, tissue or organism. BICORN is freely available as open-source software.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2020_63043_MOESM1_ESM.docx">
            <caption>
              <p>Supplemental Material.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>is available for this paper at 10.1038/s41598-020-63043-2.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported by National Institutes of Health (NIH) grants CA149653 (to JX), CA164384 (to LHC) and CA149147 (RC), and by NIH-NIGMS grant R01GM125878 to AFN.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>J.X. and X.C. designed the framework of the proposed method. X.C. implemented the method and developed the software package with J.G. X.C. and J.X. performed simulation and real data analysis with the help from J.G. L.H.C. and R.C. provided their biological interpretations on the breast cancer results. X.C. and J.X. wrote the manuscript. A.F.N. reviewed the statistical formulations and edited the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par37">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Park</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>ChIP-seq: advantages and challenges of a maturing technology</article-title>
        <source>Nat Rev Genet</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>669</fpage>
        <lpage>680</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2641</pub-id>
        <?supplied-pmid 19736561?>
        <pub-id pub-id-type="pmid">19736561</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buenrostro</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>HY</given-names>
          </name>
          <name>
            <surname>Greenleaf</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>J. ATAC-seq: A Method for Assaying Chromatin Accessibility Genome-Wide</article-title>
        <source>Curr Protoc Mol Biol</source>
        <year>2015</year>
        <volume>109</volume>
        <issue>21 29</issue>
        <fpage>21</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="doi">10.1002/0471142727.mb2129s109</pub-id>
        <?supplied-pmid 25559105?>
        <pub-id pub-id-type="pmid">25559105</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Consortium</surname>
            <given-names>EP</given-names>
          </name>
        </person-group>
        <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <fpage>57</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11247</pub-id>
        <pub-id pub-id-type="pmid">22955616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Enhancer activation requires trans-recruitment of a mega transcription factor complex</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>159</volume>
        <fpage>358</fpage>
        <lpage>373</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2014.08.027</pub-id>
        <?supplied-pmid 25303530?>
        <pub-id pub-id-type="pmid">25303530</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heinz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Romanoski</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Benner</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Glass</surname>
            <given-names>CK</given-names>
          </name>
        </person-group>
        <article-title>The selection and function of cell type-specific enhancers</article-title>
        <source>Nat Rev Mol Cell Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>144</fpage>
        <lpage>154</lpage>
        <pub-id pub-id-type="doi">10.1038/nrm3949</pub-id>
        <?supplied-pmid 25650801?>
        <pub-id pub-id-type="pmid">25650801</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liao</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Network component analysis: Reconstruction of regulatory signals in biological systems</article-title>
        <source>P Natl Acad Sci USA</source>
        <year>2003</year>
        <volume>100</volume>
        <fpage>15522</fpage>
        <lpage>15527</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.2136632100</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WH</given-names>
          </name>
        </person-group>
        <article-title>CisModule: de novo discovery of cis-regulatory modules by hierarchical mixture modeling</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2004</year>
        <volume>101</volume>
        <fpage>12114</fpage>
        <lpage>12119</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0402858101</pub-id>
        <?supplied-pmid 15297614?>
        <pub-id pub-id-type="pmid">15297614</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Su</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Down</surname>
            <given-names>TA</given-names>
          </name>
        </person-group>
        <article-title>Assessing computational methods of cis-regulatory module prediction</article-title>
        <source>PLoS Comput Biol</source>
        <year>2010</year>
        <volume>6</volume>
        <fpage>e1001020</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1001020</pub-id>
        <?supplied-pmid 21152003?>
        <pub-id pub-id-type="pmid">21152003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Ding, J., Cai, X., Wang, Y., Hu, H. &amp; Li, X. ChIPModule: systematic discovery of transcription factors and their cofactors from ChIP-seq data. <italic>Pac Symp Biocomput</italic>, 320–331 (2013).</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sharan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ben-Hur</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Loots</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Ovcharenko</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>CREME: Cis-Regulatory Module Explorer for the human genome</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>W253</fpage>
        <lpage>256</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkh385</pub-id>
        <?supplied-pmid 15215390?>
        <pub-id pub-id-type="pmid">15215390</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rouault</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Mazouni</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Couturier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hakim</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Schweisguth</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide identification of cis-regulatory motifs and modules underlying gene coregulation using statistics and phylogeny</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2010</year>
        <volume>107</volume>
        <fpage>14615</fpage>
        <lpage>14620</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1002876107</pub-id>
        <?supplied-pmid 20671200?>
        <pub-id pub-id-type="pmid">20671200</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guan</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CMGRN: a web server for constructing multilevel gene regulatory networks using ChIP-seq and gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>1190</fpage>
        <lpage>1192</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt761</pub-id>
        <?supplied-pmid 24389658?>
        <pub-id pub-id-type="pmid">24389658</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>mAPC-GibbsOS: an integrated approach for robust identification of gene regulatory networks</article-title>
        <source>BMC Syst Biol</source>
        <year>2013</year>
        <volume>7</volume>
        <issue>Suppl 5</issue>
        <fpage>S4</fpage>
        <pub-id pub-id-type="doi">10.1186/1752-0509-7-S5-S4</pub-id>
        <?supplied-pmid 24564939?>
        <pub-id pub-id-type="pmid">24564939</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reconstruction of transcriptional regulatory networks by stability-based network component analysis</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinform</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1347</fpage>
        <lpage>1358</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2012.146</pub-id>
        <?supplied-pmid 24407294?>
        <pub-id pub-id-type="pmid">24407294</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davie</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Discovery of transcription factors and regulatory regions driving <italic>in vivo</italic> tumor development by ATAC-seq and FAIRE-seq open chromatin profiling</article-title>
        <source>PLoS Genet</source>
        <year>2015</year>
        <volume>11</volume>
        <fpage>e1004994</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1004994</pub-id>
        <?supplied-pmid 25679813?>
        <pub-id pub-id-type="pmid">25679813</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Lan, A. <italic>et al</italic>. ResponseNet: revealing signaling and regulatory networks linking genetic and transcriptomic screening data. <italic>Nucleic Acids Res</italic> 39, W424-429, doi:gkr359 [pii]10.1093/nar/gkr359 (2011).</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ronen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rosenberg</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Shraiman</surname>
            <given-names>BI</given-names>
          </name>
          <name>
            <surname>Alon</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Assigning numbers to the arrows: parameterizing a gene regulation network by using accurate expression kinetics</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2002</year>
        <volume>99</volume>
        <fpage>10555</fpage>
        <lpage>10560</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.152046799</pub-id>
        <?supplied-pmid 12145321?>
        <pub-id pub-id-type="pmid">12145321</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liao</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Network component analysis: reconstruction of regulatory signals in biological systems</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2003</year>
        <volume>100</volume>
        <fpage>15522</fpage>
        <lpage>15527</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.2136632100</pub-id>
        <?supplied-pmid 14673099?>
        <pub-id pub-id-type="pmid">14673099</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Yalamanchili</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Inferring gene regulatory networks by integrating ChIP-seq/chip and transcriptome data via LASSO-type regularization methods</article-title>
        <source>Methods</source>
        <year>2014</year>
        <volume>67</volume>
        <fpage>294</fpage>
        <lpage>303</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ymeth.2014.03.006</pub-id>
        <?supplied-pmid 24650566?>
        <pub-id pub-id-type="pmid">24650566</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CRNET: an efficient sampling approach to infer functional regulatory networks by integrating large-scale ChIP-seq and time-course RNA-seq data</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>1733</fpage>
        <lpage>1740</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx827</pub-id>
        <?supplied-pmid 29280996?>
        <pub-id pub-id-type="pmid">29280996</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Stoeckert</surname>
            <given-names>CJ</given-names>
            <suffix>Jr.</suffix>
          </name>
        </person-group>
        <article-title>Clustering of genes into regulons using integrated modeling-COGRIM</article-title>
        <source>Genome Biol</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>R4</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2007-8-1-r4</pub-id>
        <?supplied-pmid 17204163?>
        <pub-id pub-id-type="pmid">17204163</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gelman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Inference from Iterative Simulation Using Multiple Sequences</article-title>
        <source>Statistical Science</source>
        <year>1992</year>
        <volume>7</volume>
        <fpage>457</fpage>
        <lpage>472</lpage>
        <pub-id pub-id-type="doi">10.1214/ss/1177011136</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sabatti</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <article-title>Bayesian sparse hidden components analysis for transcription regulation networks</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>739</fpage>
        <lpage>746</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btk017</pub-id>
        <?supplied-pmid 16368767?>
        <pub-id pub-id-type="pmid">16368767</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marbach</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schaffter</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mattiussi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Floreano</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Generating realistic in silico gene networks for performance assessment of reverse engineering methods</article-title>
        <source>J Comput Biol</source>
        <year>2009</year>
        <volume>16</volume>
        <fpage>229</fpage>
        <lpage>239</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2008.09TT</pub-id>
        <?supplied-pmid 19183003?>
        <pub-id pub-id-type="pmid">19183003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NARROMI: a noise and redundancy reduction technique improves accuracy of gene regulatory network inference</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>106</fpage>
        <lpage>113</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts619</pub-id>
        <?supplied-pmid 23080116?>
        <pub-id pub-id-type="pmid">23080116</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Huynh-Thu, V. A., Irrthum, A., Wehenkel, L. &amp; Geurts, P. Inferring regulatory networks from expression data using tree-based methods. <italic>PLoS One</italic><bold>5</bold>, 10.1371/journal.pone.0012776 (2010).</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ernst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Chromatin-state discovery and genome annotation with ChromHMM</article-title>
        <source>Nat Protoc</source>
        <year>2017</year>
        <volume>12</volume>
        <fpage>2478</fpage>
        <lpage>2492</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2017.124</pub-id>
        <?supplied-pmid 29120462?>
        <pub-id pub-id-type="pmid">29120462</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Honkela</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide modeling of transcription kinetics reveals patterns of RNA production delays</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>13115</fpage>
        <lpage>13120</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1420404112</pub-id>
        <?supplied-pmid 26438844?>
        <pub-id pub-id-type="pmid">26438844</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>KP</given-names>
          </name>
        </person-group>
        <article-title>RNA-seq differential expression studies: more sequence or more replication?</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>301</fpage>
        <lpage>304</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt688</pub-id>
        <?supplied-pmid 24319002?>
        <pub-id pub-id-type="pmid">24319002</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McLean</surname>
            <given-names>CY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GREAT improves functional interpretation of cis-regulatory regions</article-title>
        <source>Nat Biotechnol</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>495</fpage>
        <lpage>501</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1630</pub-id>
        <?supplied-pmid 20436461?>
        <pub-id pub-id-type="pmid">20436461</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gunther</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differential roles for MBD2 and MBD3 at methylated CpG islands, active promoters and binding to exon sequences</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <fpage>3010</fpage>
        <lpage>3021</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt035</pub-id>
        <?supplied-pmid 23361464?>
        <pub-id pub-id-type="pmid">23361464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bornelov</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Nucleosome Remodeling and Deacetylation Complex Modulates Chromatin Structure at Sites of Active Transcription to Fine-Tune Gene Expression</article-title>
        <source>Mol Cell</source>
        <year>2018</year>
        <volume>71</volume>
        <fpage>56</fpage>
        <lpage>72 e54</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2018.06.003</pub-id>
        <?supplied-pmid 30008319?>
        <pub-id pub-id-type="pmid">30008319</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A dynamic H3K27ac signature identifies VEGFA-stimulated endothelial enhancers and requires EP300 activity</article-title>
        <source>Genome Res</source>
        <year>2013</year>
        <volume>23</volume>
        <fpage>917</fpage>
        <lpage>927</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.149674.112</pub-id>
        <?supplied-pmid 23547170?>
        <pub-id pub-id-type="pmid">23547170</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wells</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Graveel</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Bartley</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Madore</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Farnham</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>The identification of E2F1-specific target genes</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2002</year>
        <volume>99</volume>
        <fpage>3890</fpage>
        <lpage>3895</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.062047499</pub-id>
        <?supplied-pmid 11904439?>
        <pub-id pub-id-type="pmid">11904439</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lizio</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gateways to the FANTOM5 promoter level mammalian expression atlas</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>22</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0560-6</pub-id>
        <?supplied-pmid 25723102?>
        <pub-id pub-id-type="pmid">25723102</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hou</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dale</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dean</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Cell type specificity of chromatin organization mediated by CTCF and cohesin</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2010</year>
        <volume>107</volume>
        <fpage>3651</fpage>
        <lpage>3656</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0912087107</pub-id>
        <?supplied-pmid 20133600?>
        <pub-id pub-id-type="pmid">20133600</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baroti</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Schillinger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wegner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stolt</surname>
            <given-names>CC</given-names>
          </name>
        </person-group>
        <article-title>Sox13 functionally complements the related Sox5 and Sox6 as important developmental modulators in mouse spinal cord oligodendrocytes</article-title>
        <source>J Neurochem</source>
        <year>2016</year>
        <volume>136</volume>
        <fpage>316</fpage>
        <lpage>328</lpage>
        <pub-id pub-id-type="doi">10.1111/jnc.13414</pub-id>
        <?supplied-pmid 26525805?>
        <pub-id pub-id-type="pmid">26525805</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ogawa</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ishiguro</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gaubatz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Livingston</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Nakatani</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>A complex with chromatin modifiers that occupies E2F- and Myc-responsive genes in G0 cells</article-title>
        <source>Science</source>
        <year>2002</year>
        <volume>296</volume>
        <fpage>1132</fpage>
        <lpage>1136</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1069861</pub-id>
        <?supplied-pmid 12004135?>
        <pub-id pub-id-type="pmid">12004135</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wendt</surname>
            <given-names>KS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cohesin mediates transcriptional insulation by CCCTC-binding factor</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>451</volume>
        <fpage>796</fpage>
        <lpage>801</lpage>
        <pub-id pub-id-type="doi">10.1038/nature06634</pub-id>
        <?supplied-pmid 18235444?>
        <pub-id pub-id-type="pmid">18235444</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shaulian</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Karin</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>AP-1 as a regulator of cell life and death</article-title>
        <source>Nat Cell Biol</source>
        <year>2002</year>
        <volume>4</volume>
        <fpage>E131</fpage>
        <lpage>136</lpage>
        <pub-id pub-id-type="doi">10.1038/ncb0502-e131</pub-id>
        <?supplied-pmid 11988758?>
        <pub-id pub-id-type="pmid">11988758</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>TA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-throughput functional comparison of promoter and enhancer activities</article-title>
        <source>Genome Res</source>
        <year>2016</year>
        <volume>26</volume>
        <fpage>1023</fpage>
        <lpage>1033</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.204834.116</pub-id>
        <?supplied-pmid 27311442?>
        <pub-id pub-id-type="pmid">27311442</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>LZ</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>FX</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>Properties of sparse penalties on inferring gene regulatory networks from time-course gene expression data</article-title>
        <source>IET Syst Biol</source>
        <year>2015</year>
        <volume>9</volume>
        <fpage>16</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1049/iet-syb.2013.0060</pub-id>
        <?supplied-pmid 25569860?>
        <pub-id pub-id-type="pmid">25569860</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dozmorov</surname>
            <given-names>MG</given-names>
          </name>
        </person-group>
        <article-title>Polycomb repressive complex 2 epigenomic signature defines age-associated hypermethylation and gene expression changes</article-title>
        <source>Epigenetics</source>
        <year>2015</year>
        <volume>10</volume>
        <fpage>484</fpage>
        <lpage>495</lpage>
        <pub-id pub-id-type="doi">10.1080/15592294.2015.1040619</pub-id>
        <?supplied-pmid 25880792?>
        <pub-id pub-id-type="pmid">25880792</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weintraub</surname>
            <given-names>AS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>YY1 Is a Structural Regulator of Enhancer-Promoter Loops</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <fpage>1573</fpage>
        <lpage>1588 e1528</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.11.008</pub-id>
        <?supplied-pmid 29224777?>
        <pub-id pub-id-type="pmid">29224777</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
