<?properties open_access?>
<?subarticle pcbi.1008500.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7968741</article-id>
    <article-id pub-id-type="pmid">33667225</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008500</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-20-00626</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Bioengineering</subject>
          <subj-group>
            <subject>Genome Engineering</subject>
            <subj-group>
              <subject>Synthetic Genome Editing</subject>
              <subj-group>
                <subject>Crispr</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Bioengineering</subject>
          <subj-group>
            <subject>Genome Engineering</subject>
            <subj-group>
              <subject>Synthetic Genome Editing</subject>
              <subj-group>
                <subject>Crispr</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Synthetic Biology</subject>
          <subj-group>
            <subject>Synthetic Genomics</subject>
            <subj-group>
              <subject>Synthetic Genome Editing</subject>
              <subj-group>
                <subject>Crispr</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Synthetic Biology</subject>
          <subj-group>
            <subject>Synthetic Genomics</subject>
            <subj-group>
              <subject>Synthetic Genome Editing</subject>
              <subj-group>
                <subject>Crispr</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleotides</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Single Nucleotide Polymorphisms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Bacteria</subject>
            <subj-group>
              <subject>Actinobacteria</subject>
              <subj-group>
                <subject>Mycobacterium Tuberculosis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genetic Loci</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Biological Databases</subject>
            <subj-group>
              <subject>Genomic Databases</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genomic Databases</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Genomic Databases</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Library Science</subject>
          <subj-group>
            <subject>Catalogs</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CRISPRbuilder-TB: “<italic>CRISPR-builder for tuberculosis</italic>”. Exhaustive reconstruction of the CRISPR locus in <italic>mycobacterium tuberculosis</italic> complex using SRA</article-title>
      <alt-title alt-title-type="running-head">CRISPRbuilder-TB, a new SRA-based CRISPR reconstruction method for TB</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0195-4378</contrib-id>
        <name>
          <surname>Guyeux</surname>
          <given-names>Christophe</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4672-2140</contrib-id>
        <name>
          <surname>Sola</surname>
          <given-names>Christophe</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Noûs</surname>
          <given-names>Camille</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3749-7981</contrib-id>
        <name>
          <surname>Refrégier</surname>
          <given-names>Guislaine</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>FEMTO-ST Institute, UMR 6174 CNRS, DISC Computer Department, Univ. Bourgogne Franche-Comté (UBFC), Besançon, France</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>IAME, UMR1137 INSERM, Université Paris, Université Paris Nord</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>3 Université Paris-Saclay, Saint-Aubin, France</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>4 Ecologie Systematique Evolution, Batiment 360, Université Paris-Saclay, CNRS, AgroParisTech,Orsay 91400, France</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Pertea</surname>
          <given-names>Mihaela</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Johns Hopkins University, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>christophe.guyeux@univ-fcomte.fr</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <volume>17</volume>
    <issue>3</issue>
    <elocation-id>e1008500</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>4</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>11</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 Guyeux et al</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Guyeux et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1008500.pdf"/>
    <abstract>
      <p><italic>Mycobacterium tuberculosis</italic> complex (MTC) CRISPR locus diversity has long been studied solely investigating the presence/absence of a known set of spacers. Unveiling the genetic mechanisms of its evolution requires a more exhaustive reconstruction in a large amount of representative strains.</p>
      <p>In this article, we point out and resolve, with a new pipeline, the problem of CRISPR reconstruction based directly on short read sequences in <italic>M</italic>. <italic>tuberculosis</italic>. We first show that the process we set up, that we coin as “CRISPRbuilder-TB” (<ext-link ext-link-type="uri" xlink:href="https://github.com/cguyeux/CRISPRbuilder-TB">https://github.com/cguyeux/CRISPRbuilder-TB</ext-link>), allows an efficient reconstruction of simulated or real CRISPRs, even when including complex evolutionary steps like the insertions of mobile elements. Compared to more generalist tools, the whole process is much more precise and robust, and requires only minimal manual investigation. Second, we show that more than 1/3 of the currently complete genomes available for this complex in the public databases contain largely erroneous CRISPR loci. Third, we highlight how both the classical experimental <italic>in vitro</italic> approach and the basic <italic>in silico</italic> spoligotyping provided by existing analytic tools miss a whole diversity of this locus in MTC, by not capturing duplications, spacer and direct repeats variants, and IS<italic>6110</italic> insertion locations. This description is extended in a second article that describes MTC-CRISPR diversity and suggests general rules for its evolution. This work opens perspectives for an in-depth exploration of <italic>M</italic>. <italic>tuberculosis</italic> CRISPR loci diversity and of mechanisms involved in its evolution and its functionality, as well as its adaptation to other CRISPR locus-harboring bacterial species.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>In this article, we tackle the bioinformatical issue of the reconstruction of the <italic>Mycobacterium tuberculosis</italic> complex CRISPR locus using short read sequences without requiring genome assembly. We first show that many complete genomes, as found in public databases and often reconstructed by <italic>de novo</italic> assemblies, often contain errors on this locus as well as on other repeated sequences. We provide an in-depth description of our new method, designated as ‘CRISPRbuilder-TB’, and we show that our method provides much more exhaustive and reliable information (on DR variants, spacer diversity, global structure) than Crass and CRISPR_detector. The new and unsuspected genomic diversity we detected is described in a companion paper. Scripts are available to adapt the tool to other species.</p>
    </abstract>
    <funding-group>
      <funding-statement>The author(s) received no specific funding for this work.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="3"/>
      <table-count count="1"/>
      <page-count count="21"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2021-03-17</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are within the manuscript, its <xref ref-type="sec" rid="sec022">Supporting Information</xref> files, and the Git repository <ext-link ext-link-type="uri" xlink:href="https://github.com/cguyeux/CRISPRbuilder-TB">https://github.com/cguyeux/CRISPRbuilder-TB</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are within the manuscript, its <xref ref-type="sec" rid="sec022">Supporting Information</xref> files, and the Git repository <ext-link ext-link-type="uri" xlink:href="https://github.com/cguyeux/CRISPRbuilder-TB">https://github.com/cguyeux/CRISPRbuilder-TB</ext-link>.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic>PLOS Computational Biology</italic> Software paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>The CRISPR locus of <italic>Mycobacterium tuberculosis</italic> complex (MTC) the agent of tuberculosis (TB) was first described in 1993 under the “Direct Repeat” locus designation [<xref rid="pcbi.1008500.ref001" ref-type="bibr">1</xref>,<xref rid="pcbi.1008500.ref002" ref-type="bibr">2</xref>]. It is made of 36 nucleotides-repeats interspaced by unique spacers of a mean of 37nt (interval: 25-45nt). The repeats were soon themselves designated as <italic>Direct Repeats</italic> and abbreviated as such (DR), and the sequences of one unique spacer + one DR were called Direct-Variant Repeats (DVRs). The two first sequenced isolates (<italic>M</italic>. <italic>tuberculosis</italic> H37Rv and <italic>M</italic>. <italic>bovis</italic> BCG) gave access to 43 different spacer sequences. The detection of their presence/absence led to the development of the innovative “spoligotyping” method [<xref rid="pcbi.1008500.ref003" ref-type="bibr">3</xref>]. This method became very popular by its ease of implementation and digital format, and was indeed instrumental to decipher the global population structure of MTC [<xref rid="pcbi.1008500.ref004" ref-type="bibr">4</xref>]. More recently, Whole Genome Sequencing (WGS) studies indeed confirmed that for the 6 main human lineages (L1 to L6) and many sublineages, the spoligotyping signature allows an approximate taxonomical assignment [<xref rid="pcbi.1008500.ref005" ref-type="bibr">5</xref>]. Still some generic signatures remain either meaningless, imprecise or convergent, thus largely justifying the use of SNPs as preferred taxonomical markers either globally [<xref rid="pcbi.1008500.ref006" ref-type="bibr">6</xref>], or for L4 [<xref rid="pcbi.1008500.ref007" ref-type="bibr">7</xref>], L1 [<xref rid="pcbi.1008500.ref008" ref-type="bibr">8</xref>], or L2 [<xref rid="pcbi.1008500.ref009" ref-type="bibr">9</xref>].</p>
    <p>As in other species with functional CRISPRs, this locus is accompanied by a set of CRISPR associated (<italic>cas</italic>) genes. Their number and nature make MTC CRISPR type fall into Type III-A group inside CRISPR-Cas taxonomy [<xref rid="pcbi.1008500.ref010" ref-type="bibr">10</xref>]. CRISPR-Cas locus was recently shown to be active in H37Rv [<xref rid="pcbi.1008500.ref011" ref-type="bibr">11</xref>]. Yet, part or the entire region is deleted in several MTC sublineages [<xref rid="pcbi.1008500.ref012" ref-type="bibr">12</xref>]. Whether the deletion of some of the <italic>cas</italic> genes in the CRISPR-Cas locus may promote genomic instability in some epidemic strains of MTC is another important question [<xref rid="pcbi.1008500.ref013" ref-type="bibr">13</xref>].</p>
    <p>The genomic diversity of the CRISPR locus has been investigated in detail as early as 2000 in a study by J. van Emdben <italic>et al</italic>. showing that spacer duplication, spacer variation, and IS<italic>6110</italic> insertion sites could be found in the various phylogenetical lineages of MTC [<xref rid="pcbi.1008500.ref014" ref-type="bibr">14</xref>]. However, it concerned a very small sample (n = 34) and did not include any investigation on the <italic>cas</italic> genes [<xref rid="pcbi.1008500.ref015" ref-type="bibr">15</xref>,<xref rid="pcbi.1008500.ref016" ref-type="bibr">16</xref>]. Understanding evolutionary dynamics of this locus now requires the exploration of CRISPR-Cas region on an extended dataset.</p>
    <p>The classic <italic>in vitro</italic> approach to spoligotyping lists the presence or absence of a well-known list of spacers in a sample. This robust method has been largely applied <italic>in vitro</italic> [<xref rid="pcbi.1008500.ref003" ref-type="bibr">3</xref>]. This approach however did not allow the exploration of many characteristics such as if the order of the spacers is different in one strain or the other. Neither did it reveal if there had been a duplication of part of the locus. Finally, it did not provide information on the presence of insertions such as IS<italic>6110</italic>, nor on the existence of single nucleotide polymorphism (SNP) in its direct repeats or spacers. This masks potential functionally significant changes in the loci, and makes it impossible to carry out thorough and more <italic>in-depth</italic> evolutionary studies. New <italic>in silico</italic>-<italic>based</italic> approaches (SpolPred, SpoTyping) were developed to produce spoligotypes based on genome reads [<xref rid="pcbi.1008500.ref015" ref-type="bibr">15</xref>,<xref rid="pcbi.1008500.ref017" ref-type="bibr">17</xref>]. Even if these methods similarly reveal the presence/absence of the spacers, they have the same limitations as <italic>in vitro</italic> spoligotyping techniques.</p>
    <p>A more exhaustive way to explore WGS data is by traditional <italic>de novo</italic> assembly tools such as Velvet [<xref rid="pcbi.1008500.ref018" ref-type="bibr">18</xref>]. The reconstruction is however much more difficult for the CRISPR locus. Indeed, in this part of the genome, the same DR sequence is found between each pair of spacers. Since the size of a DR is not far from that of the k-mers usually used during assembly, there is a risk of wrong bifurcations when searching for an Eulerian path in the De Bruijn graph associated with this assembly.</p>
    <p>Methods were proposed to describe and/or reconstruct CRISPRs: Crispr Recognition Tool (CRT) upgraded in CRTmeta, CrisprFinder that is a CRT-based tool with user-friendly interface and that was upgraded in CrisprCasFinder, PILER-CR, Crass, CRISPRdetector, metaCRISPR) [<xref rid="pcbi.1008500.ref016" ref-type="bibr">16</xref>,<xref rid="pcbi.1008500.ref019" ref-type="bibr">19</xref>–<xref rid="pcbi.1008500.ref023" ref-type="bibr">23</xref>]. However, each of these methods suffers from specific or common limitations we needed to circumvent to exhaustively address the genomic dynamics of TB CRISPR. Indeed, CRT and CRISPRCasFinder operate until now solely on assembled genomes, Crispr Recognition Tool for metagenomes (CRTmeta) is very slow with reads archives, Crass requires relatively long reads (more than 100bp) and provides maps that may be difficult to interpret with frequent missing or erroneous edges [<xref rid="pcbi.1008500.ref021" ref-type="bibr">21</xref>], CRISPRdetector only indicates whether the sequences contain a CRISPR and the corresponding DR sequence, metaCRISPR only uses paired-end reads and can only resolve insertions in the size of the insert chosen during the sequencing procedure (see <bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s001">S1 Table</xref></bold> for links to each tool and a short description of their objectives and outputs). To the best of our knowledge, these tools are unable to detecting and/or resolving duplications and/or presence of Insertion Sequences.</p>
    <p>In this article, we present a new general procedure termed ‘CRISPRbuilder-TB’ to reconstruct <italic>Mycobacterium tuberculosis</italic> CRISPR-Cas loci from short reads under a semi-automatized process. CRISPRbuilder-TB is inspired by previous developments [<xref rid="pcbi.1008500.ref024" ref-type="bibr">24</xref>,<xref rid="pcbi.1008500.ref025" ref-type="bibr">25</xref>] and particularizes the De Bruijn approach to the specific case of reconstructing CRISPR loci based on SRA, with the condition that its standard DR sequence is known. Applied on TB SRA without any genome assembly step, CRISPRbuilder-TB proved reliable and robust with reads of more than 75bp. The remarkable elements that were found in this locus by MTC lineages is the subject of a separate publication [<xref rid="pcbi.1008500.ref001" ref-type="bibr">1</xref>]. We emphasize its usefulness by showing that close to 50% of MTC complete genomes available in public NCBI database exhibit unreliable CRISPRs, and by detailing the different kind of evolutionary events that can affect CRISPRs, at least in MTC genomes.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>Description of CRISPRbuilder-TB</title>
      <p>A known limitation to CRISPRs reconstructions is the difficulty to handle large sets of reads. As our aim is to reconstruct a CRISPR whose common DR is known, the first step of CRISPRbuilder-TB is to filter the SRA. We kept not only reads similar to DR sequences but also reads similar to other sequences that may be linked to the CRISPR (<bold><xref ref-type="fig" rid="pcbi.1008500.g001">Fig 1</xref></bold> step 1). We call this catalogue of sequences linked to CRISPR, the “catalogue of remarkable sequences”. This catalogue is thereafter also aimed to express the composition of a definite CRISPR in a self-explanatory way, referring to known DR and spacers. We thus aimed at making this catalogue as exhaustive as possible. To do so, we explored a large and representative set of SRA from MTC strains (Dataset #3, <bold><xref ref-type="fig" rid="pcbi.1008500.g002">Fig 2</xref></bold>, n = 434, L1 to L6, animal strains and <italic>M</italic>. <italic>canettii</italic>). This method did not lead to the identification of new spacers in MTC <italic>stricto sensu</italic> (excluding <italic>M</italic>. <italic>canettii</italic>). It identified rare variants among the 68 spacers from MTC <italic>stricto sensu</italic> (n = 20; max = 2 SNPs per spacer, <bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s002">S2 Table</xref></bold>) and several DR variants (n = 28; max SNPs per DR = 3, <bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s002">S2 Table</xref></bold>). These procedures recovered other remarkable sequences: IS<italic>6110</italic> borders, and borders of the locus, that appended the catalogue of remarkable sequences. We finally added partial sequences of all <italic>cas</italic> genes.</p>
      <fig id="pcbi.1008500.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008500.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Diagram showing the process of MTC CRISPR Locus reconstruction.</title>
          <p>All steps were performed using tailored python scripts embedded in CRISPRbuilder-TB. Step 1: WGS reads filtering by blasting the reads with the catalogue of remarkable sequences (threshold e-value = 1e-7). Step 2: transformation of reads into k-mers which length was adjusted to read length n (k-mer = 4/5n). Step 3: De Bruijn graph reconstruction implemented in python (see <bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s010">S2 Text</xref></bold>, part b). Step 4: Replacement of known sequences by their annotation as per the catalogue of sequences of interest. Rare unknown sequences are kept as such for manual inspection. Step 5: manual reconstruction of full CRISPRs using the available contigs (mostly concatenation according to IS<italic>6110</italic> recovered ends).</p>
        </caption>
        <graphic xlink:href="pcbi.1008500.g001"/>
      </fig>
      <fig id="pcbi.1008500.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008500.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Datasets used in this study.</title>
        </caption>
        <graphic xlink:href="pcbi.1008500.g002"/>
      </fig>
      <p>CRISPRbuilder-TB <italic>per se</italic> is a tool that builds contigs from reads using k-mer extension in a process that is similar to CRT [<xref rid="pcbi.1008500.ref016" ref-type="bibr">16</xref>] (<bold><xref ref-type="fig" rid="pcbi.1008500.g001">Fig 1</xref></bold> step 2) and orders them using a De Bruijn graph reconstruction (<bold><xref ref-type="fig" rid="pcbi.1008500.g001">Fig 1</xref></bold> step 3). The resulting number of contigs depends on the number of non-tandem duplications and the number of IS<italic>6110</italic> sequences in the locus, each of this event increasing the number of contigs by one. The specificity of CRISPRbuilder-TB is then to replace known subsequences into strings of words using the MTC CRISPR remarkable sequences catalog described above (<bold><xref ref-type="fig" rid="pcbi.1008500.g001">Fig 1</xref></bold> step 4). This replacement allows fast manual inspection of the contigs, highlithing potentially compatible contig ends and unknown sequences (new variants and/or IS<italic>6110</italic> insertions, <bold><xref ref-type="fig" rid="pcbi.1008500.g001">Fig 1</xref></bold> step 5). It allows to rebuild the global structure of the locus even if it includes large insertions, deletions or duplications.</p>
    </sec>
    <sec id="sec004">
      <title>Reconstruction of simulated CRISPR</title>
      <p>We simulated a first set of three MTC CRISPR profiles with random IS<italic>6110</italic> insertions, deletions, duplications, and rare single nucleotide mutations and the corresponding reads. The simulated CRISPRs carried spacers variants, IS<italic>6110</italic> insertions, DVR duplications (<bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s009">S1 Text</xref></bold> for exhaustive description of the three simulated CRISPRs and reconstruction by the different tools, <bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s012">S1 Fig</xref></bold> for simple visual display of the same reconstructions, and <bold><xref rid="pcbi.1008500.t001" ref-type="table">Table 1</xref></bold> for a summary of a set of interest).</p>
      <table-wrap id="pcbi.1008500.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008500.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Tool comparison for the reconstruction of three simulated MTC-like CRISPRs.</title>
        </caption>
        <alternatives>
          <graphic id="pcbi.1008500.t001g" xlink:href="pcbi.1008500.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1">Simulated evolved TB-CRISPR-1</th>
                <th align="center" rowspan="1" colspan="1">Simulated evolved TB-CRISPR-2</th>
                <th align="center" rowspan="1" colspan="1">Simulated evolved TB-CRISPR-3</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="4" rowspan="1">
                  <bold>
                    <italic>Characteristics of the simulated CRISPR sequence</italic>
                  </bold>
                </td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">Total spacer number</td>
                <td align="center" rowspan="1" colspan="1">70</td>
                <td align="center" rowspan="1" colspan="1">68</td>
                <td align="center" rowspan="1" colspan="1">70</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Total IS number</td>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="center" rowspan="1" colspan="1">3</td>
                <td align="center" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Spacer variants</td>
                <td align="center" rowspan="1" colspan="1">4 (sp11, sp33, sp51, sp65)</td>
                <td align="center" rowspan="1" colspan="1">2 (sp7, sp52)</td>
                <td align="center" rowspan="1" colspan="1">4 (sp13, sp26, sp30, sp60)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DR variants</td>
                <td align="center" rowspan="1" colspan="1">7 (DR2, DRb2, rDRa1, DRb1, DR6, DR4, DR5)</td>
                <td align="center" rowspan="1" colspan="1">7 (DRvar*, DRb2, rDRa1, DRb1, DR25, DR4, DR5)</td>
                <td align="center" rowspan="1" colspan="1">7 (DRvar*, DR2, rDRa1, DRb1, DRvar*, DR4, DR5)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Duplications</td>
                <td align="center" rowspan="1" colspan="1">DVR35, DVR48, DVR67</td>
                <td align="center" rowspan="1" colspan="1">DVR35</td>
                <td align="center" rowspan="1" colspan="1">DVR35, DVR37</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">IS Insertions</td>
                <td align="center" rowspan="1" colspan="1">standard at sp34, plus one after sp61</td>
                <td align="center" rowspan="1" colspan="1">standard at sp34, plus one after sp25, one after sp55</td>
                <td align="center" rowspan="1" colspan="1">standard at sp34</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Deletions</td>
                <td align="center" rowspan="1" colspan="1">DVR62</td>
                <td align="center" rowspan="1" colspan="1">DVR26</td>
                <td align="center" rowspan="1" colspan="1">none</td>
              </tr>
              <tr>
                <td align="left" colspan="4" rowspan="1">
                  <bold>
                    <italic>Characteristics of the reads derived from the simulated sequence</italic>
                  </bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Read length used</td>
                <td align="center" rowspan="1" colspan="1">75 bp</td>
                <td align="center" rowspan="1" colspan="1">125 bp</td>
                <td align="center" rowspan="1" colspan="1">300 bp</td>
              </tr>
              <tr>
                <td align="left" colspan="4" rowspan="1">
                  <bold>
                    <italic>Characteristics of the CRISPR loci reconstructed by different methods</italic>
                  </bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><bold>Output Crass</bold> (Skennerton et al, 2012)</td>
                <td align="center" rowspan="1" colspan="1">no CRISPR</td>
                <td align="center" rowspan="1" colspan="1">1 CRISPR with DR0, 3 contigs, 3 multifurcations in the reconstruction diagram, 65 spacers (lacking sp26, 55 and 56), flanking regions = sp55 and IS</td>
                <td align="center" rowspan="1" colspan="1">1 CRISPR with DR0, 2 contigs, <break/>5 multifurcations in the reconstruction diagram, 60 spacers lacking sp2, 21, 24, 25, 30, 46, 47, and 58), flanking regions = sp2, sp46, sp47, sp58, sp21, sp25, sp24, sp30.</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><bold>Output CRISPR_detector</bold> (Ben Bassat et al, 2015)</td>
                <td align="center" rowspan="1" colspan="1">Confirmation of 1 CRISPR. Correct sequence of DR0 but none of the DR variants identified. No information on spacers.</td>
                <td align="center" rowspan="1" colspan="1">no CRISPR found</td>
                <td align="center" rowspan="1" colspan="1">no CRISPR found</td>
              </tr>
              <tr>
                <td align="left" colspan="4" rowspan="1"><bold>Output CRISPRbuilder-TB</bold> (this study)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Automatized output</td>
                <td align="center" rowspan="1" colspan="1">70 spacers, 23 contigs, 4 sections of unknown sequences (later identified as spacer variants)</td>
                <td align="center" rowspan="1" colspan="1">68 spacers, 4 contigs, 3 sections of unknown sequences (later identified as 2 spacer variants, 1 DR variant)</td>
                <td align="center" rowspan="1" colspan="1">70 spacers, 2 contigs, 5 sections of unknown sequences (later identified as 3 spacer variants, 1 spacer+DR variant, 1 DR variant)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Output after manual inspection</td>
                <td align="center" rowspan="1" colspan="1"><bold>100% correctly decoded sequence</bold>: 1 contig, identification of spacer variants, deletion, duplications, IS insertion</td>
                <td align="center" rowspan="1" colspan="1"><bold>100% correctly decoded sequence</bold>: 1 contig, identification of spacer and DR variants, deletion, IS insertions</td>
                <td align="center" rowspan="1" colspan="1"><bold>100% correctly decoded sequence</bold>: 1 contig, identification of spacer and DR variants, duplications</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>We then tried to reconstruct the locus based on simulated reads. This was done with a first set of CRISPR simulated with relative high rate of duplications (<bold><xref rid="pcbi.1008500.t001" ref-type="table">Table 1</xref></bold>) and a second set with a lower duplication rate (<bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s009">S1 Text</xref></bold>, <bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s012">S1 Fig</xref></bold>). In the two sets, CRISPRbuilder-TB outperformed Crass in reconstituting CRISPR as it could do it with short reads, with exact identification of flanking regions, explicit replacement of sequences by annotation which enabled easy full reconstruction based on the first set of contigs, and with no ambiguity (absence of multifurcations) (<bold><xref rid="pcbi.1008500.t001" ref-type="table">Table 1</xref></bold>, <bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s009">S1 Text</xref></bold>, <bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s012">S1 Fig</xref></bold>). In contrast, Crass efficiency was impacted by DVR duplications (failure in reporting a spacer that is duplicated, sp26 in CRISPR-2 (<bold><xref rid="pcbi.1008500.t001" ref-type="table">Table 1</xref></bold>), and mistook spacers for flanking sequences while dealing with longer reads (CRISPR-3 or CRISPR-6, <bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s009">S1 Text</xref></bold>, <bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s012">S1 Fig</xref></bold>). Of note, CRISPR_detector failed in identifying the CRISPR for reads of 125 and 300 bp. When able to process the reads, as presented in <bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s001">S1 Table</xref></bold>, it gives out only very limited information: only consensus DR sequence. Altogether, CRISPRbuilder-TB achieved perfect reconstruction of all loci: independently of the read length and of depth, CRISPRbuilder-TB retrieved all the DVR from the simulated profiles in the correct order, and included no false DVR (precision = 1 and recall = 1, n = 80).</p>
      <p>We also tried to implement metaCRISPR tool. However, this tool did not provide any DR and spacers when applied on CRISPR-1 and could not perform the different steps of the pipeline for the two other ones.</p>
    </sec>
    <sec id="sec005">
      <title>Evaluation of CRISPR locus reconstruction based on WGS data of MTC reference strains with complete genome sequences</title>
      <p>We then used CRISPRbuilder-TB to reconstruct the CRISPR loci of the seven best MTC studied strains for which complete genome sequence is available, using corresponding sequencing runs. This selection of strains covers a large MTC diversity (four L4 strains, two <italic>M</italic>. <italic>bovis</italic> BCG variants, and one L2 strains; <bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s003">S3 Table</xref></bold>).</p>
      <p>CRISPR reconstructed by CRISPRbuilder-TB were identical to those of the complete genome sequences (<bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s003">S3 Table</xref>, lower part</bold>). In addition, it provided more extensive information than that provided by the Spolpred (<bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s003">S3 Table</xref>, upper part</bold>). Indeed, we detected the DR variants found between spacers 25 and 26 (truncated version), between spacers 30 and 31, between spacers 64 and 65, 66 and 67, and between spacers 67 and 68 as described previously [<xref rid="pcbi.1008500.ref014" ref-type="bibr">14</xref>]. We also identified the expected IS<italic>6110</italic> sequence in the DR between spacers 34 and 35. Last, we detected a duplication of spacer 35 and the adjacent DR (Direct Variant Repeat 35 or DVR35) as described by van Embden <italic>et al</italic>., but we always identified it at the 3’ end of DVR41, not DVR45 as described in text by these authors [<xref rid="pcbi.1008500.ref014" ref-type="bibr">14</xref>]. At the level of the spacer variants, a single discrepancy was identified around spacer 13 in H37Ra: in the complete genome, there is a variant of the spacer with 10 more nucleotides, corresponding to an unexpected tandem duplications of nucleotides. This spacer is surrounded by two distinct variants of DR, one with a size 46 and the other with a size 39 and these unlikely DR inflations again correspond to tandem nucleotide duplications. The very unusual patterns affecting these sequences make them doubtful.</p>
      <p>Altogether, the CRISPR-Cas loci reconstructed by our pipeline using WGS of these reference strains match perfectly with the public complete genome sequences. This validates our analytic pipeline to annotate and reconstruct CRISPR-Cas locus based on short-reads runs.</p>
    </sec>
    <sec id="sec006">
      <title>CRISPR region in other MTC complete genomes</title>
      <p>To explore the reliability of CRISPR regions of complete genomes available in Public databases, we extracted the CRISPR-locus from all the additional MTC complete genomes we identified at the time of the study (n = 187, sample #2, <bold><xref ref-type="fig" rid="pcbi.1008500.g002">Fig 2</xref></bold>). According to the SNPs that they carried, these genomes belonged to L1 (n = 6), L2 (n = 44), L3 (n = 2), L4 (n = 112), L6 (n = 2), L_bovis (n = 15), unknown(mic+can) (n = 6). None belonged to L5. At the IS<italic>6110</italic> level, all complete genomes had the common insertion downstream of spacer 34. Only another IS<italic>6110</italic> copy was identified, in front of spacer 46 of strains of sublineage L2.2.1.</p>
      <p>Most sequences seemed of high quality according to the presence of known CRISPR remarkable sequences and to the presence of compatible Coll <italic>et al</italic>. SNPs for classification [<xref rid="pcbi.1008500.ref006" ref-type="bibr">6</xref>], such as L4, L4.1, L4.1.2, L4.1.2.1 for tub_LN3589 (<bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s004">S4 Table</xref></bold>). However, 25 genomes (~14%, for instance EAI5_NITR206, CAS_NITR204, GG-77-11) accumulated multiple variations of spacers and DRs, at sizes varying greatly, making their quality dubious. For example, strain GG-77-11, lineage 4.3.2, had mutations in spacers 19, 20, 21, 25, 32, 34 and 42.</p>
      <p>We also noticed a low frequency of strange patterns. These patterns do not match previous knowledge: the 27 complete genomes belonging to L4.1 or L4.2 did not include spacer 35 after spacer 41; an additional set of eighty-six genomes exhibited repetitive sequences patterns that were likely contradictory with their classification according to SNPs (<bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s004">S4 Table</xref></bold>). This was particularly made clear when identifying the main lineage corresponding to their repetitive sequences using TBminer [<xref rid="pcbi.1008500.ref026" ref-type="bibr">26</xref>] (<bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s005">S5 Table</xref></bold>). In many instances, the H37Rv reference genome sequence seems to have been used as a default sequence, jeopardizing the quality of the assembly. This impedes their use to explore CRISPR diversity and infer evolutionary dynamics of this highly important locus.</p>
    </sec>
    <sec id="sec007">
      <title>CRISPR evolutionary events in MTC</title>
      <p>We reconstructed the CRISPR-Cas locus of 434 strains representing the diversity of the MTC lineages and showing interesting features (<bold><xref ref-type="fig" rid="pcbi.1008500.g002">Fig 2</xref></bold>, sample #3). As explained previously, these results and lessons is the subject of the companion article [<xref rid="pcbi.1008500.ref001" ref-type="bibr">1</xref>]. Yet we want here to highlight some of the patterns we observed that may be observed in the CRISPRs of other species.</p>
      <p>First, we can say that the global CRISPR profiles obtained are validated by their consistency with SNPs-derived lineages and sublineages. For example, the deletion of spacers 43 to 50 in the extensive nomenclature (a part that corresponds to spacers 33–36 in the 43-spacers spoligotype patterns) was found in L4 samples, etc., (<bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s006">S6 Table</xref>, <xref ref-type="supplementary-material" rid="pcbi.1008500.s007">S7 Table</xref></bold>).</p>
      <p>Second, we examined the main evolutionary events that occurred in our subsample.</p>
      <p>Regarding DR diversity, as expected the reference version of the DR, called DR0, is largely predominant. And if we except the DR located between spacers 25 and 26, almost all DR variants have the same size, <italic>i</italic>. <italic>e</italic>. 36 nt. Some DR variants observed in the 7 references strains were confirmed in all samples. Namely, the same DR variants were always found respectively between spacers 30 and 31 (DR2), between spacers 66 and 67 (DR4), between spacers 67 and 68 (DR5), and between sp64 and 65 (DR6, <bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s008">S8 Table</xref></bold>). In addition to these pervasive variants, we identified that some variants were specific to lineages or sublineages: all L1 samples, and only they, have a DR3 variant between spacers 50 and 51, and those of sublineage L1.1.1.1 have DR1 between spacers 14 and 15 (<bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s008">S8 Table</xref></bold>).</p>
      <p>Other punctual mutations occurred in spacers: the strains of Africanum L6 lineage carry a variant of spacer 4, the L7 ones (Ethiopian-Abyssinia Lineage) all have a variant of spacer 6. The ERR234156 corresponding to a strain from lineage 1.1.1, as well as other strains from this sublineage, has a spacer 38 variant (<bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s007">S7 Table</xref></bold>). Of note, the spacer variants had up to 2 SNPs compared to reference sequence.</p>
      <p>We also observed duplications in the reconstructing CRISPR: 1) a large duplication including DVR14 to 20 between spacers 20 and 21 in sublineages 1.1.1.7 and 1.1.1.8; 2) a tandem duplication of spacer 29 is found in sublineage 1.1.3, as well as spacers 5 and 21 in L3; 3) a large duplication of 25 DVR (starting with DVR7) between spacers 57 and 58. We also confirmed that there is duplication of spacer 35 in every strains between spacers 41 and 42, with the notable exception of sublineages 4.3 to 4.9 (<bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s007">S7 Table</xref></bold>).</p>
      <p>Finally, we observed IS<italic>6110</italic> additional to the well-known copy between spacers 34 and 35. They were found in the sense or antisense direction and were often at the border of deletions (<bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s007">S7 Table</xref></bold>).</p>
    </sec>
    <sec id="sec008">
      <title>Computational speed</title>
      <p>While performing these tests we explored the speed of the automatized part of our tool on a standard machine with six cores of 2.8 GHz and 32 Go of RAM. We measured computational time for 15 SRR representative of MTC diversity, of read lengths (from 75 bp to 249 bp) and average coverage (70,3 to 723,7). The maximal time was 1038 seconds per SRR (17 min). Time correlated poorly with both read lengths or coverage (R<sup>2</sup>&lt;0,05), but correlated reasonably with the number of reads (R<sup>2</sup> = 0,2665, p = 0.024, <bold><xref ref-type="fig" rid="pcbi.1008500.g003">Fig 3</xref></bold>). Another important determinant of computational time was the number of spacers in the final locus. One proxy for this number is the lineage to which the sample belongs to. As expected, L1 and L4 that have on average higher spacer number took higher computational time. Additional support to the impact of final CRISPR length onto computational time is the case of the L4 strain ERR751561: this strain harbors a rare large deletion letting it with only 25 DVR (<bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s007">S7 Table</xref></bold>) and it showed a low computational time of 99s (L4 outlier highlighted by an arrow in <bold><xref ref-type="fig" rid="pcbi.1008500.g003">Fig 3</xref></bold>).</p>
      <fig id="pcbi.1008500.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008500.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>CRISPRbuilder-TB swiftness on a representative sample set.</title>
          <p>Pink = L1 samples; Blue = L2 sample; Purple = L3 sample; Red = L4 samples; Brown = L5 sample; Green = L6 sample.</p>
        </caption>
        <graphic xlink:href="pcbi.1008500.g003"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec009">
    <title>Discussion</title>
    <p>We set up a fast semi-automatic pipeline called CRISPRbuilder-TB, available at <ext-link ext-link-type="uri" xlink:href="https://github.com/cguyeux/CRISPRbuilder-TB">https://github.com/cguyeux/CRISPRbuilder-TB</ext-link> to reconstruct CRISPR-Cas locus from MTC short reads sequencing runs. This tool is in the line of tools avoiding genome assembly to reduce computational time and potential biases such as PhyResSE, Snippy, etc. [<xref rid="pcbi.1008500.ref027" ref-type="bibr">27</xref>]. CRISPR loci are renown for the difficulty to reconstruct them. Existing tools have until now focused on their detection, an approximate reconstruction to enable comparisons in complex samples such as metagenomics data (<bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s001">S1 Table</xref></bold>). Little attention has been brought to the exact reconstruction of CRISPRs. This exact reconstruction is necessary to infer evolutionary events affecting the CRISPR loci.</p>
    <p>As CRISPR locus has been used for more than two decades in <italic>Mycobacterium tuberculosis</italic> complex as a first-line molecular epidemiology tool, we focused on this species. We reconstructed the CRISPR locus of more than 434 strains representative of all MTC diversity. With this first-hand sample, we showed here that MTC CRISPR underwent point mutations in both direct repeats and spacers, single DVR and multi-DVR duplications, IS insertions. We first discuss the robustness of CRISPRbuilder-TB, we then discuss its specificity in terms of adaptation to other species and adaptation to sequencing methods other than short-reads ones, and then comment on its advantage compared to other CRISPR identification tools.</p>
    <sec id="sec010">
      <title>Robustness of CRISPRbuilder-TB in reconstructing CRISPR loci</title>
      <p>A first evidence of the robustness of CRISPRbuilder-TB was its ability to reconstruct the 83 simulated MTC CRISPRs. These simulated CRISPRs included random evolutionary events among which point mutations in spacer or in direct repeats, DVR duplications, IS insertions. For all tested read length (75 to 300 bp) and all read depths (between x10 and x200), we obtained perfect loci reconstructions.</p>
      <p>A second evidence of this robustness was CRISPRbuilder-TB ability to reconstruct the CRISPR loci of complete reference genomes. For these samples, we had both SRR and complete genome sequences deriving from Sanger sequencing. The reconstructed CRISPR loci proved 100% concordant with the complete genomes, except for H37Ra. For this sample, CRISPRbuilder-TB likely corrected an error in the available sequence: the complete genome exhibits unlikely dinucleotide repetitions, repetitions that do not exist in its closely relative H37Rv.</p>
      <p>A third evidence of the robustness of our pipeline relies in the profiles derived from unknown SRR: for the 434 CRISPRs we reconstructed, we obtained CRISPR profiles in full agreement with the lineage/sublineage assignations and/or clustering derived from SNPs. These agreements concern standard DVR deletions, but also IS<italic>6110</italic> insertions, spacer or DR variations, or duplications. For instance, we observed the DVR43-50 deletions in all L4 samples, we observed an IS<italic>6110</italic> insertion downstream of spacer 41 in all 4.1.2.1 samples, a variant in sp4 in all L6 samples, a tandem duplication of DVR5 was observed in all L2 and L3 samples still harboring this region of the CRISPR (L2.1, most L3), etc. (see also <bold>S7 T</bold>). We could also confirm all specificities identified in the pioneer work of van Embden <italic>et al</italic>. using targeted Sanger sequencing such as DVR35 duplication for all samples outside L4 and most samples of L4, DR variants between sp30-31, sp 50–51, sp64-65, sp66-67 and 67–68 [<xref rid="pcbi.1008500.ref014" ref-type="bibr">14</xref>].</p>
      <p>What may limit the robustness of CRISPRbuilder-TB? The first limitation is of course reads quality. We therefore recommend to check that average quality is high by running standard tools such as PhyResSE [<xref rid="pcbi.1008500.ref027" ref-type="bibr">27</xref>]. Another important limitation can be the presence of mixture: several genomes mixed in the same SRR. Our tool allows ignoring very low signals due to low level contaminations, but it is not adapted to handle mixed samples. To make sure that the samples are not mixed it is recommended to run them with tools such as the one developed by Sobkowiak et al. [<xref rid="pcbi.1008500.ref028" ref-type="bibr">28</xref>].</p>
      <p>A third limitation to robustness of CRISPRbuilder-TB is read length, but with a minimal length that is relatively low and largely achievable using widely used methods: reads need to include at least 15bp of consecutive spacers in addition to the DR. This makes a minimum read length of 66bp. We did however not confirm robustness below 75bp.</p>
      <p>CRISPRbuilder-TB reconstructions result in a high level of additional information as compared to existing methods reconstruction MTC CRISPR diversity: both <italic>in vitro</italic> and <italic>in silico</italic> spoligotyping only deal with the presence or absence of specific spacers, with methods tolerating non-fully concordant sequences. As a result, all the information of spacer and DR variants, DVR duplications and IS<italic>6110</italic> insertions is lost when using the former methods, however not when using ours.</p>
    </sec>
    <sec id="sec011">
      <title>On the specificity of the proposed tool</title>
      <p>CRISPRbuilder-TB is, as its name makes it explicit, specific to the <italic>Mycobacterium tuberculosis</italic> complex. Could it be easily adapted to other species? Yes, CRISPRbuilder-TB could easily be adapted to other models and we indeed plan to propose versions adapted to other species. Independent developments using the current method are also encouraged. To apply CRISPRbuilder-TB to other species, an important step is the set-up of a catalogue of remarkable sequences as depicted in <bold><xref ref-type="fig" rid="pcbi.1008500.g001">Fig 1</xref></bold> and described in detail in Section 4d. A possible procedure to do so is: (1) to retrieve the DRs and a first set of spacers of the species using CRISPRCasFinder [<xref rid="pcbi.1008500.ref029" ref-type="bibr">29</xref>], (2) to retrieve the patterns flanking the CRISPR on one genome, and (3) to enlarge the catalogue each time a new spacer or DR is found. If insertion sequences are likely to insert in the locus, they can be directly included in the catalogue. Another possibility is to let the pipeline identify them, as any sequences bordering the spacer contigs will be listed in the output.</p>
      <p>What about the ability of CRISPRbuilder-TB to handle other raw data than short-reads sequences? If this method has been set up for current short read sequencing methods, it is fully compatible with longer reads deriving for instance from PacBio or MinION sequencing technologies. Of course, if the locus is smaller than the length of the reads, the algorithm will have little relevance: it will be reduced to the alignment of the reads matching the sequences of interest, the extraction of the consensus and the translation of the sequences into remarkable sequences tags. In that case, CRISPRCasFinder with its user-friendly interface may be more suitable [<xref rid="pcbi.1008500.ref029" ref-type="bibr">29</xref>]. However, it should be noted that in the MTC alone, we can have up to a hundred spacers, counting duplicates, and up to 3–4 IS in the CRISPR, thus up to 15000 nucleotides. Reads have to be really long to uncover complete loci.</p>
      <p>We also want to highlight here that, even if other tools might prove more suited to deal with long-reads technologies and if these technologies are probably the future of genomics, it would be regrettable to ignore the past. For MTC alone, there are more than 70,000 SRR available, most acquired using short-reads sequencing methods. It is likely that, within the next 5 to 10 years, the richness of these databases will continue to be exploited. CRISPRbuilder-TB may all the same be applied on other species/samples for which short reads data continue to accumulate.</p>
    </sec>
    <sec id="sec012">
      <title>Comparison with existing tools</title>
      <p>Most of the available tools to explore CRISPR loci such as PILER-CR, CRT, or more exhaustive and user-friendly tools that use these methods such as CRISPRCasFinder, analyze only assembled genomes [<xref rid="pcbi.1008500.ref016" ref-type="bibr">16</xref>,<xref rid="pcbi.1008500.ref020" ref-type="bibr">20</xref>,<xref rid="pcbi.1008500.ref029" ref-type="bibr">29</xref>]. Assembly of CRISPR is however very tricky as discussed below, so that this first step may not provide the true sequence of the studied organisms. Few tools use SRA data, and to the best of our knowledge, only Crass, CRTmeta, CrisprDetector and metaCRISPR are compatible with such data [<xref rid="pcbi.1008500.ref021" ref-type="bibr">21</xref>–<xref rid="pcbi.1008500.ref023" ref-type="bibr">23</xref>,<xref rid="pcbi.1008500.ref030" ref-type="bibr">30</xref>].</p>
      <p>Crass was the first tool that could reconstruct CRISPR loci from raw sequence data [<xref rid="pcbi.1008500.ref021" ref-type="bibr">21</xref>], was recently updated, and we easily implemented on several runs, at least when these runs had reads of sufficient lengths. However, when applied on simulated CRISPRs, we found that Crass could not detect DR and spacers in reads of 75bp. We also showed that when successfully applied, it was very sensitive to IS insertions, and to duplications, and never recovered the complete set of spacers. In contrast, CRISPR-builder TB could retrieve IS<italic>6110</italic> sequences insertion positions as shown on strains for which reliable complete genome sequences were available (for instance H37Ra, L4.9, <bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s003">S3 Table</xref>, <xref ref-type="supplementary-material" rid="pcbi.1008500.s010">S2 Text</xref></bold>). On other SRR, CRISPRbuilder-TB retrieved between 0 and 2 copies of IS<italic>6110</italic> in the CRISPR locus, in either orientation (<bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s007">S7 Table</xref></bold>, sheet “IS”, and see also companion article Refrégier et al [<xref rid="pcbi.1008500.ref001" ref-type="bibr">1</xref>]). The tendency of Crass tool to miss duplications and/or insertions and the neighbouring spacers was further confirmed when applying it to MTC SRR (for instance, on ERR025424, lineage 4.1.2.1, coverage = 555.97, reads length = 116, 8/38 spacers were detected, moreover with errors in their sequences; ERR751335 from L5, <bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s010">S2 Text</xref></bold>).</p>
      <p>Other tested softwares included CRISPRdetector and metaCRISPR. CrisprDetector is a generalist tool: it does not imply any a priori knowledge of DRs or spacers, but that gives out only the DR sequence [<xref rid="pcbi.1008500.ref022" ref-type="bibr">22</xref>] as shown in <bold><xref rid="pcbi.1008500.t001" ref-type="table">Table 1</xref></bold>. Other drawbacks include, it being based on an obsolete version of Python (version 2), its slowness and its high RAM demand (for instance, ERR025424, 21143954 reads, it took over 45 GB of RAM). Concerning metaCRISPR, we did not manage to make it run despite several trials.</p>
    </sec>
    <sec id="sec013">
      <title>On the use of CRISPRs from complete genomes in public databases</title>
      <p>The systematic study of the MTC CRISPR loci of the complete genomes highlights some errors in CRISPR public data that may be true for other species. We will now remind of the main pitfalls that we identified in this species and provide some advices on how to deal with other species.</p>
      <p>By exploring MTC complete genomes deposited in public databases, we first showed that reference samples had high quality CRISPR reconstructions, likely due to partial or full Sanger sequencing. Conversely, another relatively large proportion of the ~200 complete genomes (more than 1/3) showed a clearly problematic locus, not trustworthy at all. This does not mean that there is no benefit in sharing such data, which can be informative for the rest of the genome. However, the problem is that it is difficult to know <italic>a priori</italic> whether, for a given genome, the CRISPR locus is, or is not, trustworthy. And this kind of problem may be true for species outside MTC.</p>
      <p>The most likely reasons for this average low quality of CRISPR information is the difficulty to deal with this complexity when explored using short reads sequences. Obviously, a number of MTC studies have failed to do so. The difficulty of such a reconstruction, and the errors that result from it, have their source in several causes, some of which have already been introduced previously.</p>
      <p>First, the CRISPR locus is by nature a very difficult area to assemble <italic>de novo</italic> based on short reads, at least with the same parameters as those that are efficient for most of the other sequences. The main pitfall is repeated sequences either due to the nature of the locus, insertions or to duplications during its evolution. Indeed, De Bruijn approaches look for an Eulerian path in the graph whose vertices are the k-mers, and for which there is an edge between two vertices if, and only if a suffix of one is a prefix of the other. In MTC, CRISPR locus contains a high number of DRs, IS<italic>6110</italic> insertions, spacers that sometimes share similarities (the beginning of spacer 33 is the end of spacer 36, for example), multi-DVR duplications. All these events lead to possible bifurcations in the graph. In addition, the assembly is usually done by Velvet with its default maximum k-mer size of 49 [<xref rid="pcbi.1008500.ref018" ref-type="bibr">18</xref>]. In the best case scenario where this size has been set to its preconfigured maximum, knowing that a DR is size 36, this leaves only 13 bp of overlap to be shared between the two spacers, upstream and downstream, which multiplies the incorrect bifurcations in the graph. Increasing this limit value requires recompiling Velvet from its sources, which obviously is not a common place, and only a few or no people who submitted their assembled <italic>M</italic>. <italic>tuberculosis</italic> genomes as complete genomes have done.</p>
      <p>Second, if not relying solely on <italic>de novo</italic> assembly, genome assembly from SRR is often built by alignment to a reference genome. In our case, most assemblies used H37Rv, the first sequenced and well-studied L4.9 reference strain. In addition to having a CRISPR similar only with its closest relatives, this strain has specific features that increase its inability to help reconstructing other CRISPRs: it harbours several deletions, it has no duplication, and only one IS insertion, the ancestral IS<italic>6110</italic> copy upstream of spacer 35. When mapping reads to this reference, samples containing spacers not present in H37Rv (such as sp30-31 or sp43-50) are likely to be discarded or misplaced. This is likely why the majority of the spoligotypes derived from the complete genomes available on the NCBI appeared to be L4-9 like, while at the SNP level, the lineages found were more diverse.</p>
      <p>In conclusion, in this article, we have shown why CRISPR loci should not be assembled using standard tools and we have begun to reveal the unexpected diversity of MTC CRISPRs. This was made possible thanks to CRISPRbuilder-TB a new semi-automatic method that allows, for runs with a reasonable genome coverage and read size, to reconstruct CRISPR-Cas locus in a reliable, fast and robust way. It revealed duplications of various length, variants of spacers and DRs, and insertions of IS<italic>6110</italic> sequences, <italic>i</italic>.<italic>e</italic>. a full range of evolutionary events that may be found in other CRISPR loci, but no insertion of new spacers. In a companion article, we describe the high diversity of MTC CRISPR locus unveiled by our new method, we establish a list of notable elements by lineage, and infer MTC CRISPR various mechanisms of evolution, discussing for instance the likely non-functionality of spacer acquisition of this locus [<xref rid="pcbi.1008500.ref001" ref-type="bibr">1</xref>]. Among our objectives is the transformation of our tool into a professional quality software, so that the whole community can benefit from it. We also wish to study each lineage separately and in depth, on large sets of representative genomes, in order to reveal the fine evolutionary dynamics of the CRISPR-cas locus.</p>
    </sec>
  </sec>
  <sec sec-type="materials|methods" id="sec014">
    <title>Design and implementation</title>
    <sec id="sec015">
      <title>Sequence data</title>
      <p>A first set of data is constituted by seven reference clinical isolates, for which both complete genomes and short reads sequencing runs were available, downloaded from the NCBI website, and renown as reference strains (<bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s003">S3 Table</xref></bold> and <bold><xref ref-type="fig" rid="pcbi.1008500.g001">Fig 1</xref></bold>). This selection was made with the a priori that these complete genomes would be highly reliable. This concerns the following strains: CDC1551, Erdman, F11, H37Ra, W-148, and the <italic>M</italic>. <italic>bovis</italic> BCG str. Pasteur 1173P2 and Tokyo 172.</p>
      <p>A second set of data concerns all non-reference clinical isolates for which complete genomes were available at the time of the study (but for which no short reads sequences were available).</p>
      <p>The third set of data comes from a collection of sequence reads archives from NCBI and from European Nucleotide Archive (ENA), that has been retrieved from some state-of-the-art articles to represent the diversity of MTC lineages [<xref rid="pcbi.1008500.ref009" ref-type="bibr">9</xref>,<xref rid="pcbi.1008500.ref031" ref-type="bibr">31</xref>–<xref rid="pcbi.1008500.ref034" ref-type="bibr">34</xref>]. This collection was completed by SRA queries on the NCBI search engine, with taxid values of 33894 and 78331, corresponding respectively to <italic>M</italic>. <italic>tuberculosis variant africanum</italic> and <italic>M</italic>. <italic>canettii</italic> organisms. The names of SRA run accessions (SRR) were compiled, then the actual WGS sequencing data were automatically downloaded via the fastq-dump command of the sra-tools package. This led to a database of about 3,500 runs in the form of reads. This database is meant to be a good representative of MTC diversity, both at the lineage level and regarding geographical origins. A first selection on these runs was carried out, first of all concerning the sequencing technology, which should have been paired-end Illumina to avoid having to manage different formats in our scripts. We also recovered the size of the reads and the average coverage, and discarded all runs, either corresponding to weak covers (&lt;50x) or with too short reads (minimum size of reads: 75 bp). This collection, once cleaned, was automatically annotated using the “Annotation” script described below, in order to attribute to each run its lineage, its spoligotypes "<italic>old format</italic>" (43 spacers) and "<italic>new format</italic>" (68 spacers for MTC, 98 spacers including <italic>M</italic>. <italic>canettii</italic>), as well as its Spoligo-International-Type (SIT) as described in [<xref rid="pcbi.1008500.ref035" ref-type="bibr">35</xref>]. A subcollection of 434 SRA samples representative of the global genome diversity was further analyzed using CRISPRbuilder-TB (see “Runs’ additional selection” below).</p>
      <sec id="sec016">
        <title>Runs annotation</title>
        <p>As a first annotation of the short sequencing runs (WGS data), we assigned the lineage/sublineage, for each single nucleotide polymorphism (SNP) referenced in [<xref rid="pcbi.1008500.ref006" ref-type="bibr">6</xref>] for all lineages, in [<xref rid="pcbi.1008500.ref007" ref-type="bibr">7</xref>] for L4 sublineages, in [<xref rid="pcbi.1008500.ref009" ref-type="bibr">9</xref>] for L2 sublineages, and in [<xref rid="pcbi.1008500.ref008" ref-type="bibr">8</xref>] for L1 sublineages. The annotation was made automatic by a script written in Python language that extracts, from its position in the reference genome H37Rv, a neighbourhood of 41 nucleotides centered around each SNP. For each run and each lineage-defining SNP, this 41 nt sequence was then blasted on the read sequences (blastn, maximum e-value 1e-5, from a local blast database calculated for each genome). At each blast output, we then counted the number of matches that contain the 41 nt version of H37Rv, and the number of matches that contain this pattern whose central nucleotide has been replaced by the SNP tabulated in <bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s002">S2 Table</xref></bold> (SNP sheets). If the number of mutated units was significantly higher than that of reference H37Rv, the line associated with this SNP was then added to the genome considered.</p>
        <p>As a second annotation, we provided the <italic>in silico-derived</italic> old and new formats of spoligotypes based on the presence/absence of known spacers. It follows the same principles as Spolpred [<xref rid="pcbi.1008500.ref017" ref-type="bibr">17</xref>]. We blasted each spacer on each of the read sequences (blastn, e-value &lt; 1e-6), and we calculated the number of matches for each spacer (without looking at whether the sequences matched exactly, as spacers could have been mutated): if this number of matches exceeded 5% of the mean genome coverage, then we considered that the spacer could be added to the spoligotypes. At this level, the percentage has been preferred to a simple occurrence, because, for a certain number of runs, some spacers appeared in 2 or 3 reads when the number of occurrences of the other spacers exceeded, e.g., 70 –and this phenomenon tended to increase with coverage. These few spacers must obviously correspond either to a contamination, to a very minor strain in a likely double infection, or less likely to similarities that appeared by chance due to reading errors, the latter increasing with the number of reads. As for the threshold value for the percentage, it was set in this way after various tests, and by comparing the spoligotypes produced with those known for reference strains. The SIT could then be deduced from a correspondence table derived from SITVIT2 [<xref rid="pcbi.1008500.ref035" ref-type="bibr">35</xref>], however keeping in mind that experimentally- produced are not always 100% congruent to <italic>in Silico-</italic>produced spoligotypes.</p>
      </sec>
      <sec id="sec017">
        <title>Complete genomes annotation and analysis</title>
        <p>Scripts adapted from those set-up for SRR were written to extract information from complete genomes: 43-spacers spoligotype profiles, lineage/sublineage assignation according to SNPs. MIRU-Profiler was used to infer MIRU types from complete genomes [<xref rid="pcbi.1008500.ref036" ref-type="bibr">36</xref>]. Resulting patterns were entered in the on-line tool TBminer (<ext-link ext-link-type="uri" xlink:href="http://info-demo.lirmm.fr/tbminer/index.php">http://info-demo.lirmm.fr/tbminer/index.php</ext-link>) to identify most likely MTC lineage and sublineage assignation according to MIRU-VNTR, spoligo profile, or their combination [<xref rid="pcbi.1008500.ref026" ref-type="bibr">26</xref>].</p>
      </sec>
      <sec id="sec018">
        <title>Listing of CRISPR-Cas remarkable sequences</title>
        <p>
          <bold>Direct repeats and spacers</bold>
        </p>
        <p>As each spacer lies between two DR sequences, and each DR lies between two spacers, we planned to detect new spacers using known DRs, and new DR variants using known spacers to build an exhaustive “catalogue of remarkable sequences”. We started it with published sequences. DR0 is the name given for reference DR [<xref rid="pcbi.1008500.ref014" ref-type="bibr">14</xref>], reference spacers k are referred to as esp<sub>k</sub>
<bold>(<xref ref-type="supplementary-material" rid="pcbi.1008500.s002">S2 Table</xref>)</bold>.</p>
        <p>We then looked for spacer variants, using regular expressions in randomly picked up runs from the sample #3 database. More specifically we searched in all the reads for patterns made up of: the last 12 nucleotides of the DR0, followed by a variable sequence with a size between 10 to 70 nucleotides, followed by the first 12 nucleotides of the DR0 (findall method of the python re module, patterns: DR0[-12:]([ATCG]{10,70})[DR0:12] and its reverse complement). The subsequences thus produced were then compared to the reference spacers as soon as they exceeded a number of occurrences fixed according to the coverage: if a given subpattern frequently appears between these two sections of DR0, and if it is not part of the known spacers, then it is determined whether it is a new spacer or a variant of a known spacer, in the following manner. The known spacer most similar to the detected subpattern is looked for, using a Needleman-Wunsch editing distance (compatible with substitution, indels, and gap insertion operations). If this similarity is greater than 95%, the subpattern is considered to be a variant of the most similar spacer and is integrated as such in the catalogue with a label of the following type esp<sub>k</sub>(<italic>i</italic>) where <italic>i</italic> is the variant rank; otherwise, it is integrated in the catalogue as a new spacer as esp<sub>l</sub> where l = previous spacer number +1, see Algorithm #1 in <bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s011">S3 Text</xref></bold>.</p>
        <p>We then use this enhanced catalogue of spacer variants to find DR variants, in the same way as above. For each pair of spacers espk, espl, for k,l = 1…98, we look in the reads for subunits consisting of the last 12 nucleotides of espk, followed by 30 to 40 nucleotides, themselves followed by the first 12 nucleotides of espl. Again, reverse complement was considered, to double the number of matches, and the possibility of a “\n” for reads spread over more than one line was also included. The new DRs obtained were then used in a second phase of discovery of spacer variants, as before, taking into account that the sequences bordering spacers can be variants of the DR0.</p>
        <p>
          <bold>Other sequences of interest</bold>
        </p>
        <p>To this collection of subpatterns to be discovered in the CRISPR loci, we added:</p>
        <list list-type="order">
          <list-item>
            <p>the beginning and end sequences of IS<italic>6110</italic> and its reverse complement (40 bp each time).</p>
          </list-item>
          <list-item>
            <p>CRISPR approximate borders: sequences corresponding to Rv2816c (<italic>cas2</italic> gene of the cas locus) and Rv2813c, reputed to border the CRISPR locus [<xref rid="pcbi.1008500.ref010" ref-type="bibr">10</xref>].</p>
          </list-item>
          <list-item>
            <p>CRISPR exact-flanking sequences: the reads including the end of the <italic>cas2</italic> gene have been extracted from a small collection of genomes from the database presenting spacer 1 in its “new spoligotype” to retrieve likely ancestral closest border to CRISPR locus. The consensus sequence located downstream has been reconstructed, then the reads including the latter were recovered. These included a DR0 followed by the spacer “new” number 1. After verification (blast), this CRISPR-flanking pattern was indeed found in a large set of genomes in our collection, so it was added as such to the catalogue of patterns of interest. The same treatment was performed on genomes with spacer 68 to identify the end sequence between the latter spacer found in MTC stricto sensu (without <italic>M</italic>. <italic>canettii</italic>) and the Rv2813c gene. The corresponding pattern was also added to our catalogue (see <bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s002">S2 Table</xref>)</bold>.</p>
          </list-item>
        </list>
      </sec>
      <sec id="sec019">
        <title>Locus reconstruction</title>
        <p>
          <bold>Contiguage</bold>
        </p>
        <p>For each run, the sequences of interest mentioned above were first blasted on all the reads (blastn, evaluated 1e-7), in order to extract the small set of reads potentially covering the CRISPR locus. This small set of reads was then extended, where each read of size n was transformed into its n-k+1 k-mers, where k is equal to the integer part of 4n/5. The next step, is inspired by a classical contiguage by De Bruijn approach [<xref rid="pcbi.1008500.ref037" ref-type="bibr">37</xref>]. On the one hand, it was carried out to have a good coverage of CRISPR in terms of k-mers, and this even if the original coverage was not higher than 50x. On the other hand, in order not to definitively disqualify for the next steps a full read with a possible reading error, only its k-mers containing this error will be disqualified. Corresponding algorithm is available in <bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s011">S3 Text</xref></bold> (algorithm #2).</p>
        <p>A sequence is thus randomly extracted from this set of k-mers potentially covering the CRISPR, serving as a starting point for the first contig, to which an initial score of 1 is associated. The k-mers such that their first k-1 nucleotides correspond exactly to the last k-1 nucleotides of the current contig are then obtained from the set of k-mers. It is then regarded if the majority of the latter have the same last nucleotide (i.e., in position k). If this is the case, this nucleotide is added to the current contig, the k-mers that have matched are removed, their number is added to the score of the current contig, and the progress continues to be made in the reconstruction of the locus with the next nucleotide. If this is not the case, we start again with the other side of the current contig, looking for k-mers whose last k-1 nucleotides correspond exactly to the first k-1 nucleotides of the current contiguous. And the latter is no longer extended from his tail, but from his head.</p>
        <p>At a time when no consensus seems to be emerging for the new nucleotide to be added to the current contig, this latter is stored separately with its score, and the whole process is repeated from a new randomly extracted k-mer. As, at each iteration, at least one k-mer is removed from the original set, this process has an end, leading to a more or less long list of potential contigs, themselves more or less long.</p>
        <p>The contigs are then manually processed by decreasing score, in order to reconstitute the CRISPR structure. To this end, the catalogue of sequences of interest (variants of spacers and DRs, sequences bordering the IS<italic>6110</italic>, and the start and end patterns of the locus) is iterated, in order to replace each nucleotide sub-sequence by its name using the replace method of the str class (python). The result of this post-processing of the previously obtained contigs is a reasonably sized character string, including patterns of the form *spX(Y)* for the variant Y of the spacer X, *DRX* for variant number X of the DR, as well as the words *begin_IS<italic>6110</italic>*, *end_IS<italic>6110</italic>*, *begin_IS<italic>6110</italic>c*, *end_IS<italic>6110</italic>c*, *starting_pattern*,*ending_pattern*, *Rv2816c*, and *Rv2813c*. This translation makes it easier to understand the contigs obtained, and makes it easy to detect a break in the order in which the spacers appear. It also allows to detect new variants that had not been detected until now, and to add them after naming to the database of remarkable sequences. In the vast majority of the cases studied manually (but read exceptions in Duplication paragraph below), one to three contigs depending on the number of IS<italic>6110</italic> insertions in the locus (those with the highest scores) were sufficient to reconstruct the entire locus. The extreme elements of said contigs always were either the sequences bordering the locus or a beginning or end of IS<italic>6110</italic>(c).</p>
        <p>
          <bold>Duplications resolution</bold>
        </p>
        <p>If the reconstruction, mentioned above, of the CRISPR locus makes it possible to highlight the tandem duplications of spacers, in the case of read files of size &gt;75 (leading to k-mers &gt;56 bp, as in our selected WGS data), it nevertheless passes through possible duplications spread over several spacers. Let us suppose that we have a pattern of the form: spk*spk+1*…*spl*spk+1*…*spl*spm. Then, once the contig is rebuilt to the end of spacer number l (and its DR), what comes next in the reads concerns both spk+1 and spm: when these two sequences diverge, there is no longer a nucleotide consensus in the considered reads, and the expansion of the contig stops. In addition, the k-mers of the second repeated pattern were used in the expansion of this contig when it was at the first pattern, to a number of k-mers used and removed twice as large as expected, and to the impossibility of reading the repetition of the pattern.</p>
        <p>At this stage, we can conclude that if the expansion of a contig has not stopped on an IS or a sequence bordering a CRISPR locus, and if the score of said contig is higher than expected, then there is a suspicion of large-scale duplication. To resolve this situation, post-treatment was added to the locus reconstruction pipeline: for each pair of spacers (k,l), k,l = 1…98, we count the number of k-mers containing the last 12 spk nucleotides, followed by any of the DR variants, followed by the first 12 spl nucleotides. And couples whose number of matches is significant are displayed in lexicographic order. In this list, a pattern of the form spl*DRX*spm, l≥m, is proof of a duplication (in tandem when l = m): after l, we loop back to m&lt;l. Of note, the successions of spacers involved in this duplication have a number of k-mers of the order of twice the successions of spacers located outside this duplication. And this doubling of the number of matches is a form of cross-validation of the duplication.</p>
        <p>At this stage, we are therefore able to reconstruct the entire CRISPR locus from Illumina paired-end reads, provided that the coverage and size of the reads are reasonable, and this by being able to detect duplications, spacer and DR variants, and IS insertions. This process is 95% automated (<ext-link ext-link-type="uri" xlink:href="https://github.com/cguyeux/CRISPRbuilder-TB">https://github.com/cguyeux/CRISPRbuilder-TB</ext-link>), but it requires human intervention to finalize the assembly of the contigs (<bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s012">S1 Fig</xref></bold>). Once this locus has been reconstructed, the resulting spoligotypes (old and new) can be compared to spoligotypes based on presence/absence of spacer sequences.</p>
        <p>
          <bold>Runs’ additional selection</bold>
        </p>
        <p>A final point remains to be clarified at this stage, namely how the WGS runs used here for CRISPR reconstruction were selected from our database of ~3,500 items. Indeed, although much of the reconstruction has been automated, the remaining 5% takes a little time to be properly carried out. Not wanting to waste time rebuilding loci where nothing has happened, in terms of insertion and duplication, we have taken part of the pipeline detailed above to make a selection of the runs of interest. These correspond to samples carrying duplications as well as samples carrying IS<italic>6110</italic> insertions.</p>
        <p>For a given run, we focus on reads returning matches during a blast on sequences of interest (DR and spacers). This again is performed using k-mers derived from the reads as described above. Then, patterns of the shape of an end of spacer l, followed by a variant of DR, itself followed by a beginning of spacer m, where l≥m, are looked for, as they are signs of duplication. Similarly, patterns of the form end of spacer k, followed by 0 to 36 nucleotides, themselves followed by the beginning of IS<italic>6110</italic>, are looked for insertions in DRs. Finally, ends of DR variant, followed by a certain number of nucleotides, and then the beginning of IS<italic>6110</italic>, are searched for insertions in spacers (with all possible variations in terms of layout and reverse complement). Only runs with either of these conditions were further considered, as basis of knowledge for the numerical study detailed below.</p>
      </sec>
      <sec id="sec020">
        <title>MTC CRISPR simulation</title>
        <p>In order to explore the ability of our method to reconstruct new CRISPR locus, we simulated the evolution of a locus subjected to genomic recombinations and point mutations, retrieved the composition of several evolved CRISPR loci, simulated artificial reads for each of them, applied our reconstruction technique, and compared the reconstruction to the actual composition of the evolved CRISPR.</p>
        <p>The locus on which evolution was applied possessed all the spacers and the IS<italic>6110</italic> at his standard position (between spacers 34 and 35). Starting from this original locus, we programmed an iterative evolution. At each step, we programmed the following evolutionary events according to a probability draw: 1) tandem duplications of spacers; 2) new insertion of the IS<italic>6110</italic>; 3) possible IS<italic>6110</italic> recombination leading to the deletion of embraced sequences, once at least two ISs were in the locus. The probability that such events occur were set respectively at 10%, 5%, 5%. For evolutionary events 1 and 2, uniform laws controlled the spacer subjected to duplication or next to which the IS<italic>6110</italic> inserts, if any. In addition, 5 punctual mutations were included for each evolutionary step. The evolution was performed using ten iterations.</p>
        <p>Ten loci were simulated (each based on 10 independent iterations) and saved. Each evolved locus was then used to generate simulated sequencing reads, with a read size varying from 75 to 300 bp (75bp, 125bp, 200np, and 300 bp), and for an average coverage of 50x or 200x. No error linked to the simulated sequencing process was added.</p>
        <p>A second set of 3 loci were simulated with adjusted frequencies of evolutionary events. Corresponding reads were generated using a homemade python program using random extraction of sequences of a definite length <italic>l</italic> from a random position i until desired coverage is reached (items extraction from a list [i: i+<italic>l</italic>+1]). Targeted read sizes were of respectively 75, 125 and 300 bp, and the coverage was set at 10x.</p>
        <p>The evolved loci were characterized in terms of total number of spacers, repeated DVR, number of IS insertions, deletions (<bold><xref ref-type="supplementary-material" rid="pcbi.1008500.s012">S1 Fig</xref></bold>).</p>
        <p>From the reads, each simulated loci was reconstructed using CRISPRbuilder-TB method as well as other competing algorithms, and then compared to the corresponding evolved locus.</p>
      </sec>
      <sec id="sec021">
        <title>Swiftness evaluation</title>
        <p>To document the efficiency of CRISPRbuilder-TB, we made it run on a standard individual computer Intel Xeon E-2276M CPU @ 2.80GHz × 6, with 32 Go of RAM.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec022">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1008500.s001">
      <label>S1 Table</label>
      <caption>
        <title>List of other tools to explore CRISPR presence.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1008500.s001.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008500.s002">
      <label>S2 Table</label>
      <caption>
        <title>Table listing the DR, spacer variants and specifically searched patterns in our pipeline (page 1) where SNPs are highlighted in red, and Tables listing updated SITVIT listing and SNPs used to infer classification (page 2–6).</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1008500.s002.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008500.s003">
      <label>S3 Table</label>
      <caption>
        <title>CRISPR-Cas features of reference strains according to complete genome sequences and according to CRISPR-builder run on WGS-data.</title>
        <p>CRISPR features derived from complete genome sequences using Spolpred-like tool.</p>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1008500.s003.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008500.s004">
      <label>S4 Table</label>
      <caption>
        <title>Spoligotype and MIRU-VNTR patterns of non-reference complete genomes, derived classification and comparison with classification derived from their SNPs.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1008500.s004.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008500.s005">
      <label>S5 Table</label>
      <caption>
        <title>Spoligotype and MIRU-VNTR profiles of Public complete genomes with discrepancies between SNP-based and spoligo-derived classification according to TBminer webtool [<xref rid="pcbi.1008500.ref026" ref-type="bibr">26</xref>].</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1008500.s005.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008500.s006">
      <label>S6 Table</label>
      <caption>
        <title>CRISPR-Cas locus profile reconstructed from public WGS runs and representative of MTC diversity.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1008500.s006.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008500.s007">
      <label>S7 Table</label>
      <caption>
        <title>Extensive annotation of the selection of reconstructed CRISPRs using our pipeline (SRA, dataset #3, see <xref ref-type="fig" rid="pcbi.1008500.g002">Fig 2</xref>).</title>
        <p>Legend IS6110 sheet. Column A: lineage assignation according to Coll et al., column B: Lineage and Sublineage according to Palittapongarnpim et al. for L1, Shitikov et al. for L2, Stücki et al. for L4; column C: spoligotyping-based alias name, column D: SIT nomenclature, column E: selection set, column F: Accession number, column G: common Strain name, column H: location, column I: spoligotype (old), column J to end: the first line designates the name of the gene or the spacer ID; the second title line designates the spacer ID according to the classical spoligotyping nomenclature (also visible by yellow shade). Vertical bars stand for IS<italic>6110</italic> copies within DR, in green for copies in orientation 1 (antisense) and red for orientation 2 (sense). Color boxes are for insertions within a gene or a spacer, with the same color for the orientation than above. The number in the box indicates the position (nucleotide) where the insertion occurred in the coding sequence. Finally, a large colored tube with white squares depicts a very likely recombination event between two insertion sequences that led to the deletion of all sequences between them (thus, only one IS6110 remains). “esp” sheet: column E-AD: spacers with at least one variant in the sample set. The SRA are shown in lines in the same orders as others sheets. Crosses show samples with a variant in the corresponding spacers. When several variants were found, they are numbered. “DR” sheet: columns F to AE list the variant DRs and their bordering spacers. A black square indicates a variant, a white square corresponds to the wt version, a dot corresponds to a deletion. “Dupl” sheet: DVRs duplicating in some samples are shown in the order in which they occurred, black squares indicating actual presence of the DVR at this position, white square indicate the absence of the DVR. Red blocks identify the duplicated DVR blocks.</p>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1008500.s007.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008500.s008">
      <label>S8 Table</label>
      <caption>
        <title>DR and spacer variants for the representative set of MTC diversity.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pcbi.1008500.s008.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008500.s009">
      <label>S1 Text</label>
      <caption>
        <title>Simulated CRISPR-4,5,6 reconstructions by Crass, CRISPRdetector and CRISPR-builder after reads simulation of 75bp in length, 125bp in length, 300bp in length.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008500.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008500.s010">
      <label>S2 Text</label>
      <caption>
        <title>Comparative Crass and CRISPR-TB results obtained on two genomes ERR751335 (L5) and SRR6407486 (L4.9).</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008500.s010.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008500.s011">
      <label>S3 Text</label>
      <caption>
        <title>Algorithms used to reconstruct CRISPR locus (spacer discovery, and contiguage).</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008500.s011.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008500.s012">
      <label>S1 Fig</label>
      <caption>
        <title>Visual Display of Simulated CRISPR-4,5,6 (CRISPR before evolution, simulated CRISPR, simulated SRAs, CRASS output, CRISPR detector output, CRISPRbuilder-TB automated output, CRISPRbuilder-TB automated output after visual inspection).</title>
        <p>(PPTX)</p>
      </caption>
      <media xlink:href="pcbi.1008500.s012.pptx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>CG, CS and GR are grateful to Gilles Vergnaud and Christine Pourcel (Institut for Integrative Cell Biology, I2BC, UMR9198, CEA-CNRS-Université Paris-Saclay, Gif-sur-Yvette, France) for helpful discussions at various steps of this project.</p>
    <sec id="sec023">
      <title>Future directions</title>
      <p>Future developments include the confrontation between CRISPR structure and SNPs from M. tuberculosis complex. Other potential developments could concern CRISPR building of other pathogens such as Clostridium difficile.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1008500.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Refrégier</surname><given-names>G</given-names></name>, <name><surname>Sola</surname><given-names>C</given-names></name>, <name><surname>Guyeux</surname><given-names>C</given-names></name>. <article-title>Unexpected diversity of CRISPR unveils some evolutionary patterns of repeated sequences in Mycobacterium tuberculosis</article-title>. <source>BMC Genomics</source>. <year>2020</year><month>11</month><day>30</day>;<volume>21</volume>(<issue>1</issue>):<fpage>841</fpage>. <pub-id pub-id-type="doi">10.1186/s12864-020-07178-6</pub-id><?supplied-pmid 33256602?><pub-id pub-id-type="pmid">33256602</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Groenen</surname><given-names>PM</given-names></name>, <name><surname>Bunschoten</surname><given-names>AE</given-names></name>, <name><surname>van Soolingen</surname><given-names>D</given-names></name>, <name><surname>van Embden</surname><given-names>JD</given-names></name>. <article-title>Nature of DNA polymorphism in the direct repeat cluster of Mycobacterium tuberculosis; application for strain differentiation by a novel typing method</article-title>. <source>Mol Microbiol.</source><year>1993</year>;<volume>10</volume>(<issue>5</issue>):<fpage>1057</fpage>–<lpage>65</lpage>. <pub-id pub-id-type="doi">10.1111/j.1365-2958.1993.tb00976.x</pub-id> .<?supplied-pmid 7934856?><pub-id pub-id-type="pmid">7934856</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Kamerbeek</surname><given-names>J</given-names></name>, <name><surname>Schouls</surname><given-names>L</given-names></name>, <name><surname>Kolk</surname><given-names>A</given-names></name>, <name><surname>van Agterveld</surname><given-names>M</given-names></name>, <name><surname>van Soolingen</surname><given-names>D</given-names></name>, <name><surname>Kuijper</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Simultaneous detection and strain differentiation of Mycobacterium tuberculosis for diagnosis and epidemiology</article-title>. <source>J Clin Microbiol</source>. <year>1997</year>;<volume>35</volume>(<issue>4</issue>):<fpage>907</fpage>–<lpage>14</lpage>. <pub-id pub-id-type="doi">10.1128/JCM.35.4.907-914.1997</pub-id> .<?supplied-pmid 9157152?><pub-id pub-id-type="pmid">9157152</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Brudey</surname><given-names>K</given-names></name>, <name><surname>Driscoll</surname><given-names>J</given-names></name>, <name><surname>Rigouts</surname><given-names>L</given-names></name>, <name><surname>Prodinger</surname><given-names>WM</given-names></name>, <name><surname>Gori</surname><given-names>A</given-names></name>, <name><surname>Al-Hajoj</surname><given-names>SAM</given-names></name>, <etal>et al</etal>. <article-title>Mycobacterium tuberculosis complex genetic diversity: mining the fourth international spoligotyping database (SpolDB4) for classification, Population Genetics, and Epidemiology</article-title>. <source>BMC Microbiol</source>. <year>2006</year>;<volume>6</volume>(<issue>6</issue>):<fpage>23</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2180-6-23</pub-id> .<?supplied-pmid 16519816?><pub-id pub-id-type="pmid">16519816</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Kato-Maeda</surname><given-names>M</given-names></name>, <name><surname>Gagneux</surname><given-names>S</given-names></name>, <name><surname>Flores</surname><given-names>LL</given-names></name>, <name><surname>Kim</surname><given-names>EY</given-names></name>, <name><surname>Small</surname><given-names>PM</given-names></name>, <name><surname>Desmond</surname><given-names>EP</given-names></name>, <etal>et al</etal>. <article-title>Strain classification of Mycobacterium tuberculosis: congruence between large sequence polymorphisms and spoligotypes</article-title>. <source>Int J Tuberc Lung Dis</source>. <year>2011</year>;<volume>15</volume>(<issue>1</issue>):<fpage>131</fpage>–<lpage>3</lpage>. Epub 2011/02/01. .<?supplied-pmid 21276309?><pub-id pub-id-type="pmid">21276309</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Coll</surname><given-names>F</given-names></name>, <name><surname>McNerney</surname><given-names>R</given-names></name>, <name><surname>Guerra-Assuncao</surname><given-names>JA</given-names></name>, <name><surname>Glynn</surname><given-names>JR</given-names></name>, <name><surname>Perdigao</surname><given-names>J</given-names></name>, <name><surname>Viveiros</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>A robust SNP barcode for typing Mycobacterium tuberculosis complex strains</article-title>. <source>Nat Commun.</source><year>2014</year>;<volume>5</volume>:<fpage>4812</fpage>. <pub-id pub-id-type="doi">10.1038/ncomms5812</pub-id><?supplied-pmid 25176035?><pub-id pub-id-type="pmid">25176035</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Stucki</surname><given-names>D</given-names></name>, <name><surname>Brites</surname><given-names>D</given-names></name>, <name><surname>Jeljeli</surname><given-names>L</given-names></name>, <name><surname>Coscolla</surname><given-names>M</given-names></name>, <name><surname>Liu</surname><given-names>Q</given-names></name>, <name><surname>Trauner</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Mycobacterium tuberculosis lineage 4 comprises globally distributed and geographically restricted sublineages</article-title>. <source>Nat Genet.</source><year>2016</year>;<volume>48</volume>(<issue>12</issue>):<fpage>1535</fpage>–<lpage>43</lpage>. <pub-id pub-id-type="doi">10.1038/ng.3704</pub-id> .<?supplied-pmid 27798628?><pub-id pub-id-type="pmid">27798628</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Palittapongarnpim</surname><given-names>P</given-names></name>, <name><surname>Ajawatanawong</surname><given-names>P</given-names></name>, <name><surname>Viratyosin</surname><given-names>W</given-names></name>, <name><surname>Smittipat</surname><given-names>N</given-names></name>, <name><surname>Disratthakit</surname><given-names>A</given-names></name>, <name><surname>Mahasirimongkol</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Evidence for Host-Bacterial Co-evolution via Genome Sequence Analysis of 480 Thai Mycobacterium tuberculosis Lineage 1 Isolates</article-title>. <source>Sci Rep.</source><year>2018</year>;<volume>8</volume>(<issue>1</issue>):<fpage>11597</fpage>. Epub 2018/08/04. <pub-id pub-id-type="doi">10.1038/s41598-018-29986-3</pub-id><?supplied-pmid 30072734?><pub-id pub-id-type="pmid">30072734</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Shitikov</surname><given-names>E</given-names></name>, <name><surname>Kolchenko</surname><given-names>S</given-names></name>, <name><surname>Mokrousov</surname><given-names>I</given-names></name>, <name><surname>Bespyatykh</surname><given-names>J</given-names></name>, <name><surname>Ischenko</surname><given-names>D</given-names></name>, <name><surname>Ilina</surname><given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Evolutionary pathway analysis and unified classification of East Asian lineage of Mycobacterium tuberculosis</article-title>. <source>Sci Rep</source>. <year>2017</year>;<volume>7</volume>(<issue>1</issue>):<fpage>9227</fpage>. <pub-id pub-id-type="doi">10.1038/s41598-017-10018-5</pub-id><?supplied-pmid 28835627?><pub-id pub-id-type="pmid">28835627</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Makarova</surname><given-names>KS</given-names></name>, <name><surname>Wolf</surname><given-names>YI</given-names></name>, <name><surname>Koonin</surname><given-names>EV</given-names></name>. <article-title>Classification and Nomenclature of CRISPR-Cas Systems: Where from Here?</article-title><source>CRISPR J.</source><year>2018</year>;<volume>1</volume>(<issue>5</issue>):<fpage>325</fpage>–<lpage>36</lpage>. Epub 2019/04/26. <pub-id pub-id-type="doi">10.1089/crispr.2018.0033</pub-id><?supplied-pmid 31021272?><pub-id pub-id-type="pmid">31021272</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Wei</surname><given-names>W</given-names></name>, <name><surname>Zhang</surname><given-names>S</given-names></name>, <name><surname>Fleming</surname><given-names>J</given-names></name>, <name><surname>Chen</surname><given-names>Y</given-names></name>, <name><surname>Li</surname><given-names>Z</given-names></name>, <name><surname>Fan</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Mycobacterium tuberculosis type III-A CRISPR/Cas system crRNA and its maturation have atypical features</article-title>. <source>FASEB J.</source><year>2019</year>;<volume>33</volume>(<issue>1</issue>):<fpage>1496</fpage>–<lpage>509</lpage>. Epub 2018/07/07. <pub-id pub-id-type="doi">10.1096/fj.201800557RR</pub-id> .<?supplied-pmid 29979631?><pub-id pub-id-type="pmid">29979631</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Freidlin</surname><given-names>PJ</given-names></name>, <name><surname>Nissan</surname><given-names>I</given-names></name>, <name><surname>Luria</surname><given-names>A</given-names></name>, <name><surname>Goldblatt</surname><given-names>D</given-names></name>, <name><surname>Schaffer</surname><given-names>L</given-names></name>, <name><surname>Kaidar-Shwartz</surname><given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Structure and variation of CRISPR and CRISPR-flanking regions in deleted-direct repeat region Mycobacterium tuberculosis complex strains</article-title>. <source>BMC Genomics</source>. <year>2017</year>;<volume>18</volume>(<issue>1</issue>):<fpage>168</fpage>. <pub-id pub-id-type="doi">10.1186/s12864-017-3560-6</pub-id><?supplied-pmid 28201993?><pub-id pub-id-type="pmid">28201993</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Tsolaki</surname><given-names>AG</given-names></name>, <name><surname>Hirsh</surname><given-names>AE</given-names></name>, <name><surname>DeRiemer</surname><given-names>K</given-names></name>, <name><surname>Enciso</surname><given-names>JA</given-names></name>, <name><surname>Wong</surname><given-names>MZ</given-names></name>, <name><surname>Hannan</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Functional and evolutionary genomics of Mycobacterium tuberculosis: insights from genomic deletions in 100 strains</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2004</year>;<volume>101</volume>(<issue>14</issue>):<fpage>4865</fpage>–<lpage>70</lpage>. Epub 2004/03/17. <pub-id pub-id-type="doi">10.1073/pnas.0305634101</pub-id><?supplied-pmid 15024109?><pub-id pub-id-type="pmid">15024109</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>van Embden</surname><given-names>JDA</given-names></name>, <name><surname>van Gorkom</surname><given-names>T</given-names></name>, <name><surname>Kremer</surname><given-names>K</given-names></name>, <name><surname>Jansen</surname><given-names>R</given-names></name>, <name><surname>van der Zeijst</surname><given-names>BAM</given-names></name>, <name><surname>Schouls</surname><given-names>LM</given-names></name>. <article-title>Genetic variation and evolutionary origin of the Direct repeat locus of <italic>Mycobacterium tuberculosis</italic> complex bacteria</article-title>. <source>J Bacteriol.</source><year>2000</year>;<volume>182</volume>:<fpage>2393</fpage>–<lpage>401</lpage>. <pub-id pub-id-type="doi">10.1128/jb.182.9.2393-2401.2000</pub-id><?supplied-pmid 10762237?><pub-id pub-id-type="pmid">10762237</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Xia</surname><given-names>E</given-names></name>, <name><surname>Teo</surname><given-names>YY</given-names></name>, <name><surname>Ong</surname><given-names>RT</given-names></name>. <article-title>SpoTyping: fast and accurate in silico Mycobacterium spoligotyping from sequence reads</article-title>. <source>Genome Med</source>. <year>2016</year>;<volume>8</volume>(<issue>1</issue>):<fpage>19</fpage>. <pub-id pub-id-type="doi">10.1186/s13073-016-0270-7</pub-id><?supplied-pmid 26883915?><pub-id pub-id-type="pmid">26883915</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Bland</surname><given-names>C</given-names></name>, <name><surname>Ramsey</surname><given-names>TL</given-names></name>, <name><surname>Sabree</surname><given-names>F</given-names></name>, <name><surname>Lowe</surname><given-names>M</given-names></name>, <name><surname>Brown</surname><given-names>K</given-names></name>, <name><surname>Kyrpides</surname><given-names>NC</given-names></name>, <etal>et al</etal>. <article-title>CRISPR recognition tool (CRT): a tool for automatic detection of clustered regularly interspaced palindromic repeats</article-title>. <source>BMC Bioinformatics</source>. <year>2007</year>;<volume>8</volume>:<fpage>209</fpage>. Epub 2007/06/20. <pub-id pub-id-type="doi">10.1186/1471-2105-8-209</pub-id><?supplied-pmid 17577412?><pub-id pub-id-type="pmid">17577412</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Coll</surname><given-names>F</given-names></name>, <name><surname>Mallard</surname><given-names>K</given-names></name>, <name><surname>Preston</surname><given-names>MD</given-names></name>, <name><surname>Bentley</surname><given-names>S</given-names></name>, <name><surname>Parkhill</surname><given-names>J</given-names></name>, <name><surname>McNerney</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>SpolPred: rapid and accurate prediction of Mycobacterium tuberculosis spoligotypes from short genomic sequences</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>22</issue>):<fpage>2991</fpage>–<lpage>3</lpage>. Epub 2012/09/28. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts544</pub-id><?supplied-pmid 23014632?><pub-id pub-id-type="pmid">23014632</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Zerbino</surname><given-names>DR</given-names></name>, <name><surname>Birney</surname><given-names>E</given-names></name>. <article-title>Velvet: algorithms for de novo short read assembly using de Bruijn graphs</article-title>. <source>Genome Res</source>. <year>2008</year>;<volume>18</volume>(<issue>5</issue>):<fpage>821</fpage>–<lpage>9</lpage>. Epub 2008/03/20. <pub-id pub-id-type="doi">10.1101/gr.074492.107</pub-id><?supplied-pmid 18349386?><pub-id pub-id-type="pmid">18349386</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Grissa</surname><given-names>I</given-names></name>, <name><surname>Vergnaud</surname><given-names>G</given-names></name>, <name><surname>Pourcel</surname><given-names>C</given-names></name>. <article-title>CRISPRFinder: a web tool to identify clustered regularly interspaced short palindromic repeats</article-title>. <source>Nucleic Acids Res</source>. <year>2007</year>;<volume>35</volume>(Web Server issue):<fpage>W52</fpage>–<lpage>7</lpage>. Epub 2007/06/01. <pub-id pub-id-type="doi">10.1093/nar/gkm360</pub-id><?supplied-pmid 17537822?><pub-id pub-id-type="pmid">17537822</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>RC</given-names></name>. <article-title>PILER-CR: fast and accurate identification of CRISPR repeats</article-title>. <source>BMC Bioinformatics</source>. <year>2007</year>;<volume>8</volume>:<fpage>18</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-8-18</pub-id> .<?supplied-pmid 17239253?><pub-id pub-id-type="pmid">17239253</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Skennerton</surname><given-names>CT</given-names></name>, <name><surname>Imelfort</surname><given-names>M</given-names></name>, <name><surname>Tyson</surname><given-names>GW</given-names></name>. <article-title>Crass: identification and reconstruction of CRISPR from unassembled metagenomic data</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year>;<volume>41</volume>(<issue>10</issue>):<fpage>e105</fpage>. Epub 2013/03/21. <pub-id pub-id-type="doi">10.1093/nar/gkt183</pub-id><?supplied-pmid 23511966?><pub-id pub-id-type="pmid">23511966</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Ben-Bassat</surname><given-names>I</given-names></name>, <name><surname>Chor</surname><given-names>B</given-names></name>. <article-title>CRISPR Detection From Short Reads Using Partial Overlap Graphs</article-title>. <source>J Comput Biol.</source><year>2016</year>;<volume>23</volume>(<issue>6</issue>):<fpage>461</fpage>–<lpage>71</lpage>. Epub 2016/04/09. <pub-id pub-id-type="doi">10.1089/cmb.2015.0226</pub-id> .<?supplied-pmid 27058690?><pub-id pub-id-type="pmid">27058690</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Lei</surname><given-names>J</given-names></name>, <name><surname>Sun</surname><given-names>Y</given-names></name>. <article-title>Assemble CRISPRs from metagenomic sequencing data</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>17</issue>):<fpage>i520</fpage>–<lpage>i8</lpage>. Epub 2016/09/03. <pub-id pub-id-type="doi">10.1093/bioinformatics/btw456</pub-id> .<?supplied-pmid 27587670?><pub-id pub-id-type="pmid">27587670</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Guyeux</surname><given-names>C</given-names></name>, <name><surname>Al-Nuaimi</surname><given-names>B</given-names></name>, <name><surname>AlKindy</surname><given-names>B</given-names></name>, <name><surname>Couchot</surname><given-names>JF</given-names></name>, <name><surname>Salomon</surname><given-names>M</given-names></name>. <article-title>On the reconstruction of the ancestral bacterial genomes in genus Mycobacterium and Brucella</article-title>. <source>BMC Syst Biol</source>. <year>2018</year>;<volume>12</volume>(<issue>Suppl 5</issue>):<fpage>100</fpage>. Epub 2018/11/22. <pub-id pub-id-type="doi">10.1186/s12918-018-0618-2</pub-id><?supplied-pmid 30458842?><pub-id pub-id-type="pmid">30458842</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Guyeux</surname><given-names>C</given-names></name>, <name><surname>Charr</surname><given-names>JC</given-names></name>, <name><surname>Tran</surname><given-names>HTM</given-names></name>, <name><surname>Furtado</surname><given-names>A</given-names></name>, <name><surname>Henry</surname><given-names>RJ</given-names></name>, <name><surname>Crouzillat</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Evaluation of chloroplast genome annotation tools and application to analysis of the evolution of coffee species</article-title>. <source>PLoS One</source>. <year>2019</year>;<volume>14</volume>(<issue>6</issue>):<fpage>e0216347</fpage>. Epub 2019/06/13. <pub-id pub-id-type="doi">10.1371/journal.pone.0216347</pub-id><?supplied-pmid 31188829?><pub-id pub-id-type="pmid">31188829</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Aze</surname><given-names>J</given-names></name>, <name><surname>Sola</surname><given-names>C</given-names></name>, <name><surname>Zhang</surname><given-names>J</given-names></name>, <name><surname>Lafosse-Marin</surname><given-names>F</given-names></name>, <name><surname>Yasmin</surname><given-names>M</given-names></name>, <name><surname>Siddiqui</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Genomics and Machine Learning for Taxonomy Consensus: The Mycobacterium tuberculosis Complex Paradigm</article-title>. <source>PLoS One</source>. <year>2015</year>;<volume>10</volume>(<issue>7</issue>):<fpage>e0130912</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0130912</pub-id><?supplied-pmid 26154264?><pub-id pub-id-type="pmid">26154264</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Feuerriegel</surname><given-names>S</given-names></name>, <name><surname>Schleusener</surname><given-names>V</given-names></name>, <name><surname>Beckert</surname><given-names>P</given-names></name>, <name><surname>Kohl</surname><given-names>TA</given-names></name>, <name><surname>Miotto</surname><given-names>P</given-names></name>, <name><surname>Cirillo</surname><given-names>DM</given-names></name>, <etal>et al</etal>. <article-title>PhyResSE: a Web Tool Delineating Mycobacterium tuberculosis Antibiotic Resistance and Lineage from Whole-Genome Sequencing Data</article-title>. <source>J Clin Microbiol</source>. <year>2015</year>;<volume>53</volume>(<issue>6</issue>):<fpage>1908</fpage>–<lpage>14</lpage>. <pub-id pub-id-type="doi">10.1128/JCM.00025-15</pub-id><?supplied-pmid 25854485?><pub-id pub-id-type="pmid">25854485</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Sobkowiak</surname><given-names>B</given-names></name>, <name><surname>Glynn</surname><given-names>JR</given-names></name>, <name><surname>Houben</surname><given-names>R</given-names></name>, <name><surname>Mallard</surname><given-names>K</given-names></name>, <name><surname>Phelan</surname><given-names>JE</given-names></name>, <name><surname>Guerra-Assuncao</surname><given-names>JA</given-names></name>, <etal>et al</etal>. <article-title>Identifying mixed Mycobacterium tuberculosis infections from whole genome sequence data</article-title>. <source>BMC Genomics</source>. <year>2018</year>;<volume>19</volume>(<issue>1</issue>):<fpage>613</fpage>. Epub 2018/08/16. <pub-id pub-id-type="doi">10.1186/s12864-018-4988-z</pub-id><?supplied-pmid 30107785?><pub-id pub-id-type="pmid">30107785</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Couvin</surname><given-names>D</given-names></name>, <name><surname>Bernheim</surname><given-names>A</given-names></name>, <name><surname>Toffano-Nioche</surname><given-names>C</given-names></name>, <name><surname>Touchon</surname><given-names>M</given-names></name>, <name><surname>Michalik</surname><given-names>J</given-names></name>, <name><surname>Neron</surname><given-names>B</given-names></name>, <etal>et al</etal>. <article-title>CRISPRCasFinder, an update of CRISRFinder, includes a portable version, enhanced performance and integrates search for Cas proteins</article-title>. <source>Nucleic Acids Res.</source><year>2018</year>. Epub 2018/05/24. <pub-id pub-id-type="doi">10.1093/nar/gky425</pub-id> .<?supplied-pmid 29790974?><pub-id pub-id-type="pmid">29790974</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Rho</surname><given-names>M</given-names></name>, <name><surname>Wu</surname><given-names>YW</given-names></name>, <name><surname>Tang</surname><given-names>H</given-names></name>, <name><surname>Doak</surname><given-names>TG</given-names></name>, <name><surname>Ye</surname><given-names>Y</given-names></name>. <article-title>Diverse CRISPRs evolving in human microbiomes</article-title>. <source>PLoS Genet.</source><year>2012</year>;<volume>8</volume>(<issue>6</issue>):<fpage>e1002441</fpage>. Epub 2012/06/22. <pub-id pub-id-type="doi">10.1371/journal.pgen.1002441</pub-id><?supplied-pmid 22719260?><pub-id pub-id-type="pmid">22719260</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Coll</surname><given-names>F</given-names></name>, <name><surname>Preston</surname><given-names>M</given-names></name>, <name><surname>Guerra-Assuncao</surname><given-names>JA</given-names></name>, <name><surname>Hill-Cawthorn</surname><given-names>G</given-names></name>, <name><surname>Harris</surname><given-names>D</given-names></name>, <name><surname>Perdigao</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>PolyTB: A genomic variation map for Mycobacterium tuberculosis</article-title>. <source>Tuberculosis (Edinb)</source>. <year>2014</year>;<volume>94</volume>(<issue>3</issue>):<fpage>346</fpage>–<lpage>54(3)</lpage>:346–54. <pub-id pub-id-type="doi">10.1016/j.tube.2014.02.005</pub-id> .<?supplied-pmid 24637013?><pub-id pub-id-type="pmid">24637013</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Roychowdhury</surname><given-names>T</given-names></name>, <name><surname>Mandal</surname><given-names>S</given-names></name>, <name><surname>Bhattacharya</surname><given-names>A</given-names></name>. <article-title>Analysis of IS6110 insertion sites provide a glimpse into genome evolution of Mycobacterium tuberculosis</article-title>. <source>Sci Rep.</source><year>2015</year>;<volume>5</volume>:<fpage>12567</fpage>. <pub-id pub-id-type="doi">10.1038/srep12567</pub-id><?supplied-pmid 26215170?><pub-id pub-id-type="pmid">26215170</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Brynildsrud</surname><given-names>OB</given-names></name>, <name><surname>Pepperell</surname><given-names>CS</given-names></name>, <name><surname>Suffys</surname><given-names>P</given-names></name>, <name><surname>Grandjean</surname><given-names>L</given-names></name>, <name><surname>Monteserin</surname><given-names>J</given-names></name>, <name><surname>Debech</surname><given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Global expansion of Mycobacterium tuberculosis lineage 4 shaped by colonial migration and local adaptation</article-title>. <source>Sci Adv.</source><year>2018</year>;<volume>4</volume>(<issue>10</issue>):<fpage>eaat5869</fpage>. Epub 2018/10/23. <pub-id pub-id-type="doi">10.1126/sciadv.aat5869</pub-id><?supplied-pmid 30345355?><pub-id pub-id-type="pmid">30345355</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Blouin</surname><given-names>Y</given-names></name>, <name><surname>Cazajous</surname><given-names>G</given-names></name>, <name><surname>Dehan</surname><given-names>C</given-names></name>, <name><surname>Soler</surname><given-names>C</given-names></name>, <name><surname>Vong</surname><given-names>R</given-names></name>, <name><surname>Hassan</surname><given-names>MO</given-names></name>, <etal>et al</etal>. <article-title>Progenitor "Mycobacterium canettii" clone responsible for lymph node tuberculosis epidemic, Djibouti</article-title>. <source>Emerg Infect Dis</source>. <year>2014</year>;<volume>20</volume>(<issue>1</issue>):<fpage>21</fpage>–<lpage>8</lpage>. Epub 2014/02/13. <pub-id pub-id-type="doi">10.3201/eid2001.130652</pub-id><?supplied-pmid 24520560?><pub-id pub-id-type="pmid">24520560</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Couvin</surname><given-names>D</given-names></name>, <name><surname>David</surname><given-names>A</given-names></name>, <name><surname>Zozio</surname><given-names>T</given-names></name>, <name><surname>Rastogi</surname><given-names>N</given-names></name>. <article-title>Macro-geographical specificities of the prevailing tuberculosis epidemic as seen through SITVIT2, an updated version of the Mycobacterium tuberculosis genotyping database</article-title>. <source>Infect Genet Evol</source>. <year>2018</year>. Epub 2018/12/30. <pub-id pub-id-type="doi">10.1016/j.meegid.2018.12.030</pub-id> .<?supplied-pmid 30593925?><pub-id pub-id-type="pmid">30593925</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Rajwani</surname><given-names>R</given-names></name>, <name><surname>Shehzad</surname><given-names>S</given-names></name>, <name><surname>Siu</surname><given-names>GKH</given-names></name>. <article-title>MIRU-profiler: a rapid tool for determination of 24-loci MIRU-VNTR profiles from assembled genomes of Mycobacterium tuberculosis</article-title>. <source>PeerJ</source>. <year>2018</year>;<volume>6</volume>:<fpage>e5090</fpage>. Epub 2018/07/19. <pub-id pub-id-type="doi">10.7717/peerj.5090</pub-id><?supplied-pmid 30018852?><pub-id pub-id-type="pmid">30018852</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008500.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Afiahayati</surname></name>, <name><surname>Sato</surname><given-names>K</given-names></name>, <name><surname>Sakakibara</surname><given-names>Y</given-names></name>. <article-title>MetaVelvet-SL: an extension of the Velvet assembler to a de novo metagenomic assembler utilizing supervised learning</article-title>. <source>DNA Res</source>. <year>2015</year>;<volume>22</volume>(<issue>1</issue>):<fpage>69</fpage>–<lpage>77</lpage>. Epub 2014/11/29. <pub-id pub-id-type="doi">10.1093/dnares/dsu041</pub-id><?supplied-pmid 25431440?><pub-id pub-id-type="pmid">25431440</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pcbi.1008500.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008500.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pertea</surname>
          <given-names>Mihaela</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Mihaela Pertea</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Mihaela Pertea</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008500" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">26 Jul 2020</named-content>
    </p>
    <p>Dear Dr. Guyeux,</p>
    <p>Thank you very much for submitting your manuscript "CRISPRbuilder-TB: “CRISPR-Builder for tuberculosis”. Exhaustive reconstruction of the CRISPR locus in Mycobacterium tuberculosis complex using SRA" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Mihaela Pertea</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Mihaela Pertea</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The work presented by Guyeux and co-authors in this manuscript focuses on reconstructing the CRISPR locus of Mycobacterium tuberculosis complex strains from short reads sequences directly. The authors developed a bioinformatics pipeline to achieve this goal and presented their results compared to those obtained from other similar tools. A major strength of their work is that the performance of their pipeline (named CRISPRbuilder-TB) is evaluated by reconstructing CRISPR loci of simulated and complete MTBC genomes, where the structure of CRISPR loci are known. They show that 1/3 of assembled genomes contain mis-assemblies and erroneous CRISPR loci, and thus advocate for the use of their pipeline to reconstruct CRISPR loci from short reads directly. They also show how existing tools do not capture the full diversity at the CRISPR locus, including duplications, spacer and direct repeat variants, and locations of IS6110 insertions.</p>
    <p>Major comments:</p>
    <p>- The authors should include documentation on their project GitHub page (<ext-link ext-link-type="uri" xlink:href="https://github.com/cguyeux/pyMTC/">https://github.com/cguyeux/pyMTC/</ext-link>) explaining how the pipeline can be downloaded and run locally by providing examples, in addition to any software requirements.</p>
    <p>- The authors provide a comprehensive list of available CRISPR identification tools. However, they only compared their tool (CRISPRbuilder-TB) to two other independent tools (Table 1). It is not cleat to this reviewer why only Crass and CRISPRdetector were used as comparison tools, whereas other cited CRISPR predictor tools (CRT, CrisprFinder, PILER-CR, CRISPRCasFinder, CRTmeta or metaCRISPR) were not. As some of these tools only accept assembled genomes as input, simulated reads could be assembled first and then assemblies used to run the remaining CRISPR prediction tools.</p>
    <p>- Both in Table 1 and Table 2 is not obvious from the text provided that reconstructed CRISPR loci by CRISPRbuilder-TB are identical to simulated loci (Table 1) or reference genome loci (Table 2). A simple visual representation of simulated and reference vs. reconstructed CRISPR loci is needed to easily identify and compare regions of homology, order of CRISPR features (DR, spacers) and variants (SNPs, duplications, IS6110) between simulated and reference compared to reconstructed loci.</p>
    <p>- Although, the authors have published a separate study on the evolution of CRISPR locus on MTBC, they should discuss whether there is evolutionary evidence that the CRISPR locus is functional. According to <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2019.12.13.875765v1">https://www.biorxiv.org/content/10.1101/2019.12.13.875765v1</ext-link> , the CRISPR locus “of M. tuberculosis did not evolve by classical CRISPR adaptation (incorporation of new spacers) since the last most recent common ancestor of virulent lineages.” Would the authors interpret these results as a clear indication of a non-functional CRISPR locus?</p>
    <p>Minor comments:</p>
    <p>Abstract:</p>
    <p>In ‘compared to more generalist tools’, please indicate here what these tools are here in the abstract.</p>
    <p>Authors summary:</p>
    <p>Line 55: ‘using short read sequences’ not ‘Short Reads Archives’</p>
    <p>Line 56: ‘current assembled genomes’</p>
    <p>Line 60: list here what existing methods CRISPRbuilder-TB was compared to</p>
    <p>Introduction:</p>
    <p>Line 67: indicate in brackets and include citations of the first two Mtb sequenced isolates</p>
    <p>Line 73: given that spoligotyping is not taxonomically precise or fully ‘correct’, please replace ‘allows a correct taxonomical assignment’ with ‘allows an approximate taxonomical assignment’</p>
    <p>Line 89: in more than a hundred thousand samples. Also include citation at the end of this statement.</p>
    <p>Line 97: they have the same limitations as in vitro spoligotyping techniques.</p>
    <p>Line 99. Use WGS abbreviation instead of ‘whole genome sequencing’, here and elsewhere in the text.</p>
    <p>Line 99. By traditional de novo assembly tools</p>
    <p>Results:</p>
    <p>a. Description of CRISPRbuilder-TB</p>
    <p>Line 129. A known limitation</p>
    <p>Figure 2. In Dataset #1 Validation sample, do the authors used 7 complete (sequenced to completion) reference genomes? If so, they may want to change ‘Assembled genomes</p>
    <p>collection from NCBI’ to ‘Complete genomes collection from NCBI’</p>
    <p>In lines 130 to 132. A more explicit description on how CRISPR locus associated reads are extracted is needed here. From Figure 1 step 1, DR sequences are used to fish out CRISPR locus associated sequences from short sequence reads.</p>
    <p>Figure 1 illustrates very well CRISPRbuilder-TB pipeline but lacks a legend in the manuscript. Figure 1 would also benefit from including what bioinformatic tools were used at each step.</p>
    <p>Line 138. It would be helpful to report how many SNP differences (mismatches) the authors find among variants of the same spacer. This would inform the maximum number of mismatches in silico spoligotyping tools use to search for spacer occurrences in SRA data.</p>
    <p>Lines 148 – 149. What do the authors mean by ‘translate these contigs in strings of words’? Do they refer to annotating contigs with CRISPR locus features such as DR, spaces, etc. If so the authors may want to use the term ‘annotation’ and rename step4 in Figure 1 ‘Translation into explicit contigs’ to ‘CRISPR annotation of contigs’.</p>
    <p>Line 151. Related to the point above, the authors may want to use the term ‘Unannotated regions’ of contigs instead of ‘untranslated parts’.</p>
    <p>b. Reconstruction of simulated CRISPR</p>
    <p>Table 1. It is not cleat to this reviewer why only Crass and CRISPRdetector were used as comparison tools, whereas other cited CRISPR predictor tools (CRT, CrisprFinder, PILER-CR, CRISPRCasFinder, CRTmeta or metaCRISPR) were not. As some of these tools only accept assembled genomes, simulated reads could be assembled first and then assemblies used to run the remaining CRISPR prediction tools.</p>
    <p>Table 1. As pointed before, it is preferable to use the term ‘non-annotated contig sequences’ than ‘untranslated sequences’</p>
    <p>Line 163. Indicate how short (in bp) the shortest reads used by CRISPRbuilder were.</p>
    <p>Line 163. As pointed before, use ‘annotation’ instead of ‘translation’.</p>
    <p>Evaluation of CRISPR locus reconstruction based on WGS data of MTC reference strains</p>
    <p>Line 187. The authors should stress here that the seven reference strains had been sequenced to completion, that is, they had an ungapped and complete chromosome sequence resolved. This is somehow implied with the term ‘reference’ genome.</p>
    <p>Line 203. Do the authors mean CRISPRbuilder-TB reconstructed sequences were identical to those of the complete reference genome? Or those assembled de novo from short reads? Same point in Line 212 ‘assembled genome’.</p>
    <p>Line 207. Citation needed right after statement ‘as described previously’.</p>
    <p>219. Do the authors mean ‘public reference genomes’ by ‘public assemblies’ here? As pointed before, it is important to differentiate between complete reference genomes (ungapped, resolved and annotated) vs. de novo assemblies (made up of contigs).</p>
    <p>d. CRISPR region in other MTC assembled genomes.</p>
    <p>Line 230. In the statement ‘Most sequences seemed of high quality.’, what quality control metrics did the authors used to assess the quality of these 187 MTC public genomes? What sampling strategy was used to select these 187 MTC genomes? Are these complete genomes or assembled?</p>
    <p>e. CRISPR evolutionary events in MTC</p>
    <p>As pointed before, for line 138. It would be helpful to report how many SNP differences (mismatches) the authors find among variants of the same spacer. This would inform the maximum number of mismatches in silico spoligotyping tools use to search for spacer occurrences in SRA data.</p>
    <p>f. Computational speed</p>
    <p>Discussion.</p>
    <p>Line 323. Use ‘complete reference genomes’ instead of ‘reference samples’.</p>
    <p>Line 325. Use ‘concordant with complete genome’ instead of ‘concordant with assembled ones’</p>
    <p>4. Material and methods</p>
    <p>a. Sequence data</p>
    <p>Line 480 to 481, replace ‘both assembled genomes and short reads sequencing’ with ‘both complete genomes and short reads sequences”.</p>
    <p>Lines 486 and 487. What selection criteria did the authors followed to select these assembled genomes from public repositories?</p>
    <p>Line 489. Do the authors mean European Nucleotide Archive (ENA) by EMBL-SRA?</p>
    <p>e. Locus reconstruction</p>
    <p>Contiguage</p>
    <p>It is not clear to this reviewer why the authors did not make use of an established de novo assembler (such as Velvet or Spades) to assembly selected reads and, instead, came up with their own algorithm.</p>
    <p>f. MTC CRISPR simulation</p>
    <p>Lines 708 – 712. Can the authors specify what bioinformatics tool they used to simulate short reads?</p>
    <p>Reviewer #2: This is a well written paper that provides important novel insight in the CRISPR genetic diversity and organisation of the locus and will help refine the MTC global population structure. It presents a detailed and comprehensive rational, approach and data for the problem. In my opinion, this is an important and worth while tool that should complement the current apps used for refining MTC phylogeny.</p>
    <p>I have a few minor points for the authors to address.</p>
    <p>Line 39: put comma after pipeline</p>
    <p>Line 43: replace generalist with generalised</p>
    <p>Line 89: replace hundred with one hundred</p>
    <p>Line 90: replace to explore with exploration of</p>
    <p>Line 124-126: this does not make sense. Please re-write</p>
    <p>Line 159: replace Tool's with Tool</p>
    <p>Line 180: Why is the data not shown? Please explain and provide data in suppl figs.</p>
    <p>Line 286: replace Go with Gb</p>
    <p>Line 362: Could it be easily adapted to other species? Re-write...not appropriate</p>
    <p>Figures:</p>
    <p>Largely fine, but would recommend modifying/edit text and font styles to look clearer and optimum.</p>
    <p>Typos:</p>
    <p>The manuscript is generally well written, but a thorough read-through is needed as there are a number of typos, formatting and grammatical errors. Some of which I have highlighted above.</p>
    <p>Discussion:</p>
    <p>I would like to see a little more about how this software has resolved the frequency and nature of IS6110 insertions in the CRISPR locus. Also, how does the software cope with large scale deletions of the locus due to IS6110?</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: <bold>Yes: </bold>Francesc Coll</p>
    <p>Reviewer #2: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/" xlink:type="simple">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email xlink:type="simple">figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link ext-link-type="uri" xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, PLOS recommends that you deposit laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions, please see <underline><ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plospathogens/s/submission-guidelines" xlink:type="simple">http://journals.plos.org/compbiol/s/submission-guidelines#loc-materials-and-methods</ext-link></underline></p>
  </body>
</sub-article>
<sub-article id="pcbi.1008500.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008500.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008500" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">30 Sep 2020</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pcbi.1008500.s013">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Answer to reviewers Plos Comp_Sept2020.docx</named-content></p>
      </caption>
      <media xlink:href="pcbi.1008500.s013.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1008500.r003" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008500.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pertea</surname>
          <given-names>Mihaela</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Mihaela Pertea</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Mihaela Pertea</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008500" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">24 Oct 2020</named-content>
    </p>
    <p>Dear Dr. Guyeux,</p>
    <p>Thank you very much for submitting your manuscript "CRISPRbuilder-TB: “CRISPR-Builder for tuberculosis”. Exhaustive reconstruction of the CRISPR locus in Mycobacterium tuberculosis complex using SRA" for consideration at PLOS Computational Biology. As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. The reviewers appreciated the attention to an important topic. Based on the reviews, we are likely to accept this manuscript for publication, providing that you modify the manuscript according to the first reviewer's recommendations.</p>
    <p>Please prepare and submit your revised manuscript within 30 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. </p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to all review comments, and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Thank you again for your submission to our journal. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Mihaela Pertea</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Mihaela Pertea</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors have successfully addressed the following major comments:</p>
    <p>- Detailed documentation on how to download, install and run their tool on GitHub has been now provided.</p>
    <p>- They argued well why the used short reads as the tool’s input, and not assemblies, and thus the choice of CRISPR predictor tools they used to compare their tool’s predictions against.</p>
    <p>- Added some discussion on the functionality of CRISPR locus in MTC.</p>
    <p>However, the authors haven’t addressed the following point:</p>
    <p>The newly added Supplementary_File3.odt, Supplementary_File4.odt and Supplementary_File5.odt do not provided “A simple visual representation of simulated and reference vs. reconstructed CRISPR loci is needed to easily identify and compare regions of homology, order of CRISPR features (DR, spacers) and variants (SNPs, duplications, IS6110) between simulated and reference compared to reconstructed loci.”</p>
    <p>All minor comments were successfully addressed.</p>
    <p>Reviewer #2: None</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: <bold>Yes: </bold>Francesc Coll</p>
    <p>Reviewer #2: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/" xlink:type="simple">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email xlink:type="simple">figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link ext-link-type="uri" xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, PLOS recommends that you deposit laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see <underline><ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plospathogens/s/submission-guidelines" xlink:type="simple">http://journals.plos.org/ploscompbiol/s/submission-guidelines#loc-materials-and-methods</ext-link></underline></p>
  </body>
</sub-article>
<sub-article id="pcbi.1008500.r004" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008500.r004</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 1</article-title>
    </title-group>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008500" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">5 Nov 2020</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pcbi.1008500.s014">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Answer to reviewers Plos Comp_nov2020.docx</named-content></p>
      </caption>
      <media xlink:href="pcbi.1008500.s014.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1008500.r005" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008500.r005</article-id>
    <title-group>
      <article-title>Decision Letter 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pertea</surname>
          <given-names>Mihaela</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Mihaela Pertea</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Mihaela Pertea</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj005" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008500" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">8 Nov 2020</named-content>
    </p>
    <p>Dear Dr. Guyeux,</p>
    <p>We are pleased to inform you that your manuscript 'CRISPRbuilder-TB: “CRISPR-Builder for tuberculosis”. Exhaustive reconstruction of the CRISPR locus in Mycobacterium tuberculosis complex using SRA' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Mihaela Pertea</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Mihaela Pertea</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
  </body>
</sub-article>
<sub-article id="pcbi.1008500.r006" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008500.r006</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pertea</surname>
          <given-names>Mihaela</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2021 Mihaela Pertea</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Mihaela Pertea</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj006" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008500" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">18 Dec 2020</named-content>
    </p>
    <p>PCOMPBIOL-D-20-00626R2 </p>
    <p>CRISPRbuilder-TB: “CRISPR-Builder for tuberculosis”. Exhaustive reconstruction of the CRISPR locus in Mycobacterium tuberculosis complex using SRA</p>
    <p>Dear Dr Guyeux,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Livia Horvath</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link ext-link-type="uri" xlink:href="http://ploscompbiol.org">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
