<?properties open_access?>
<?properties manuscript?>
<?origin nihpa?>
<?iso-abbr Nat. Genet.?>
<?submitter-system nihms?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 1045?>
<?submitter-authority publisher?>
<?submitter-login nature-structure?>
<?submitter-name Nature Publishing Group (obsolete)?>
<?domain nihpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">9216904</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">2419</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat. Genet.</journal-id>
    <journal-title-group>
      <journal-title>Nature genetics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1061-4036</issn>
    <issn pub-type="epub">1546-1718</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3386377</article-id>
    <article-id pub-id-type="pmid">22706312</article-id>
    <article-id pub-id-type="doi">10.1038/ng.2310</article-id>
    <article-id pub-id-type="manuscript">nihpa375372</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Genome-wide Efficient Mixed Model Analysis for Association Studies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhou</surname>
          <given-names>Xiang</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stephens</surname>
          <given-names>Matthew</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label> Department of Human Genetics; University of Chicago, Chicago, IL 60637</aff>
    <aff id="A2"><label>2</label> Department of Statistics; University of Chicago, Chicago, IL 60637</aff>
    <author-notes>
      <corresp id="CR1">Correspondence should be addressed to: Xiang Zhou (<email>xz7@uchicago.edu</email>)</corresp>
      <corresp id="CR2">Matthew Stephens (<email>mstephens@uchicago.edu</email>)</corresp>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>21</day>
      <month>5</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>6</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>01</day>
      <month>1</month>
      <year>2013</year>
    </pub-date>
    <volume>44</volume>
    <issue>7</issue>
    <fpage>821</fpage>
    <lpage>824</lpage>
    <!--elocation-id from pubmed: 10.1038/ng.2310-->
    <permissions>
      <license>
        <license-p>Users may view, print, copy, download and text and data- mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use:
<uri xlink:type="simple" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</uri></license-p>
      </license>
    </permissions>
    <abstract>
      <p id="P1">Linear mixed models have attracted considerable recent attention as a powerful and effective tool for accounting for population stratification and relatedness in genetic association tests. However, existing methods for exact computation of standard test statistics are computationally impractical for even moderate-sized genome-wide association studies. To deal with this several approximate methods have been proposed. Here, we present an efficient exact method that makes these approximations unnecessary in many settings. This method is roughly <italic>n</italic> times faster than the widely-used exact method EMMA, where <italic>n</italic> is the sample size, making exact genome-wide association analysis computationally practical for large numbers of individuals.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="S1">
    <title>INTRODUCTION</title>
    <p id="P2">There is an increasing interest in using linear mixed models (LMMs, also known as mixed linear models, or MLMs) to test for association in genome-wide association studies (GWAS), because of their demonstrated effectiveness in accounting for relatedness among samples and in controlling for population stratification and other confounding factors<sup><xref rid="R1" ref-type="bibr">1</xref>–<xref rid="R7" ref-type="bibr">7</xref></sup>. However, these models present substantial computational challenges. For example, at the time this work was submitted for publication, the most efficient algorithm for computing (effectively) exact association test statistics (either the Wald test or the likelihood ratio test), implemented in the Efficient Mixed Model Association (EMMA) software<sup><xref rid="R3" ref-type="bibr">3</xref></sup>, had a per-SNP computational time that increases with the cube of the number of individuals (<italic>n</italic>). As a result, a medium size GWAS with a few thousand individuals and half a million SNPs would take years of CPU time to analyze<sup><xref rid="R1" ref-type="bibr">1</xref>,<xref rid="R7" ref-type="bibr">7</xref></sup>. (While this paper was in review, Lippert et al (2011)<sup><xref rid="R8" ref-type="bibr">8</xref></sup> also published an efficient algorithm for this model, implemented in software FaST-LMM; the relationship between this algorithm and ours is discussed later.)</p>
    <p id="P3">Several approximation methods have been proposed to make genome-wide analysis using linear mixed models possible. Probably the simplest and fastest of these approximations, GRAMMAR (Genome-wide Rapid Association using Mixed Model And Regression), implemented in the software GenABEL<sup><xref rid="R9" ref-type="bibr">9</xref></sup>, first estimates the residuals from the LMM under the null model, and then treats these residuals as phenotypes for further genome-wide analysis by a standard linear model<sup><xref rid="R10" ref-type="bibr">10</xref></sup>. This substantially reduces per-SNP computation time, making it linear in the number of individuals. More recently two more-sophisticated approximate approaches have been suggested. Zhang et al<sup><xref rid="R7" ref-type="bibr">7</xref></sup> use P3D (Population Parameters Previously Determined) which avoids repeatedly estimating variance components when performing each test by simply using the pre-estimated variance components from the null model; their method is implemented in the software TASSEL. Kang et al<sup><xref rid="R1" ref-type="bibr">1</xref></sup> also avoid repeatedly estimating variance components by a slightly different strategy, which keeps the heritability estimated from the null model fixed when testing individual SNPs. Their approach is implemented in the software EMMAX (EMMA eXpedited). (This approximation, and related ideas, was also considered by previous authors, including<sup><xref rid="R10" ref-type="bibr">10</xref>,<xref rid="R11" ref-type="bibr">11</xref></sup>.) Both these last two approximations have per-SNP computation time that increases quadratically with the number of individuals, which makes them practical, on a single desktop computer, for GWAS involving thousands of individuals.</p>
    <p id="P4">Although in some settings the approximate methods described above provide results almost identical to those of the exact method<sup><xref rid="R1" ref-type="bibr">1</xref>,<xref rid="R7" ref-type="bibr">7</xref></sup>, this is not guaranteed in general, and in practice it is hard to know how accurate the approximations will be without running an exact calculation. One possible consequence of inaccuracy in the approximation could be a reduction in power compared with exact methods. For these reasons, the ability to perform exact calculations remains of interest. Here, we present a new, more efficient, method for exact calculations that provides numerically identical results to EMMA (i.e. exact Wald or likelihood ratio test statistics) but is roughly <italic>n</italic> times faster (computation time per SNP, when using the usual genome-wide relatedness matrix, is quadratic in the number of individuals, with run time similar to EMMAX). This makes exact calculations feasible for large GWAS, obviating the need for approximate methods in most common settings.</p>
  </sec>
  <sec sec-type="results" id="S2">
    <title>RESULTS</title>
    <p id="P5">The method and its computational complexity is described and derived in detail in the <xref ref-type="supplementary-material" rid="SD2">Online Methods section</xref>. Briefly, the method requires complete or imputed genotype data<sup><xref rid="R12" ref-type="bibr">12</xref>,<xref rid="R13" ref-type="bibr">13</xref></sup> for all SNPs, and involves only one eigen-decomposition of the relatedness matrix at the beginning (computational complexity <italic>O(n<sup>3</sup>)</italic>). For each SNP tested, it effectively replaces the expensive additional eigen-decomposition step in EMMA with one matrix and vector multiplication (computational complexity <italic>O(n<sup>2</sup>)</italic>). After this, like EMMA, each iteration of the following optimization step requires cheap operations (complexity <italic>O(n)</italic>) to evaluate both first and second derivatives of the target functions. We refer to our method as Genome-wide Efficient Mixed Model Association (GEMMA) because it builds on EMMA and facilitates its genome-wide application.</p>
    <p id="P6">We illustrate our method and compare the analysis results with the exact method EMMA and the approximation methods EMMAX and GRAMMAR, using two examples, a mouse GWAS for high-density lipoprotein cholesterol (HDL-C) levels from the Hybrid Mouse Diversity Panel (HMDP)<sup><xref rid="R14" ref-type="bibr">14</xref></sup> and a human GWAS for Crohn's disease from the Wellcome Trust Case Control Consortium (WTCCC)<sup><xref rid="R15" ref-type="bibr">15</xref></sup>. The size of this second study makes it computationally impractical to analyze with EMMA<sup><xref rid="R3" ref-type="bibr">3</xref></sup>. <xref ref-type="table" rid="T1">Table 1</xref> summarizes the computational complexity for the four methods along with CPU time for the two data sets on a single desktop CPU. <xref ref-type="table" rid="T1">Table 1</xref> also includes results for the recently-published FaST-LMM<sup><xref rid="R8" ref-type="bibr">8</xref></sup>, which can produce identical <italic>p</italic> values to EMMA and GEMMA in the same time complexity as GEMMA; see below for further discussion. As expected GEMMA is comparable in speed with EMMAX, completing the larger (WTCCC) example in under 4 hours.</p>
    <p id="P7">To verify the correctness of our algorithm and implementation we first validate it by comparing <italic>p</italic> values calculated by GEMMA with those from EMMA on a subset of SNPs from both data sets. For all SNPs examined the <italic>p</italic> values from the two methods match exactly (Wald test results shown in <xref ref-type="fig" rid="F1">Figure 1a and 1b</xref>; Likelihood ratio test not shown).</p>
    <p id="P8">Since GEMMA provides exact computations in essentially the same time as EMMAX, the accuracy of the approximations in EMMAX and other methods may seem moot. However, in some settings, and specifically for mixed models with more than one random effect (variance component), the computational trick used by GEMMA does not apply, and approximations along the lines of EMMAX may remain necessary. For this reason the accuracy of different approximation methods remains of some potential interest, and so we present a comparison between the (Wald test) <italic>p</italic> values from GEMMA, EMMAX and GRAMMAR, genome-wide, on both the HMDP and WTCCC data sets above.</p>
    <p id="P9">The HMDP GWAS represents a situation where approximation methods such as EMMAX or GRAMMAR may yield inaccurate test statistics. In particular, because individuals in the data set are closely related, and the strongly associated SNPs contribute to a significant proportion of phenotypic variation in HDL-C<sup><xref rid="R13" ref-type="bibr">13</xref></sup>, using estimates of variance components or fitted residuals from the null model for testing may be expected to yield conservative <italic>p</italic> values, leading to a potential loss of power. Our empirical comparison (<xref ref-type="fig" rid="F1">Figure 1c</xref>) confirms this: in this case, approximation by EMMAX leads to systematic and appreciable underestimation of the most significant <italic>p</italic> values (almost two orders of magnitude), while approximation by GRAMMAR leads to dramatic underestimation of all <italic>p</italic> values. Indeed, in contrast to the exact <italic>p</italic> values, no <italic>p</italic> values generated by EMMAX are significant at the conventional 0.05 level after Bonferroni correction, and no <italic>p</italic> values generated by GRAMMAR are significant even before Bonferroni correction. The fact that the exact <italic>p</italic> values for the most significant results are substantially more significant than the approximate <italic>p</italic> values from EMMAX suggests that, in this type of setting, the exact <italic>p</italic> values may produce a more powerful test; simulation results confirm this (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 1</xref>).</p>
    <p id="P10">In contrast, the WTCCC example represents a very different situation where the approximations may be expected to yield accurate test statistics. This is because there is relatively little population stratification in these data (the individuals are all from the UK, and the relatedness matrix is approximately diagonal), and the effect sizes of the most strongly associated SNPs for Crohn's disease are small compared with the effect sizes in the HMDP data above<sup><xref rid="R14" ref-type="bibr">14</xref></sup>. Both conditions favor the approximation assumptions in EMMAX and GRAMMAR. Empirical comparisons (<xref ref-type="fig" rid="F1">Figure 1d</xref>) show that, for this particular data set, the <italic>p</italic> values from EMMAX differ negligibly from the exact values. However, the <italic>p</italic> values from GRAMMAR still depart notably from the exact values.</p>
    <p id="P11">Taken together, the above results confirm that approximation by EMMAX is appreciably more accurate than GRAMMAR, even in cases, such as the WTCCC data, where the sample structure is subtle. The comparisons also demonstrate that the accuracy of the EMMAX approximation can vary from case to case. Consequently, the potential gain in power from doing exact vs approximate tests will also vary among datasets. For the HMDP data, the potential gain in power from the exact calculations appears considerable, and this is confirmed by simulations (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 1</xref>). For the WTCCC Crohn's disease data the power gain is negligible, and as noted in ref<sup><xref rid="R1" ref-type="bibr">1</xref></sup> only a small gain in power is generally expected at SNPs with small effect size. Of course, one nice feature of being able to do the exact tests is that it obviates the need to consider which approximations work best under what circumstances, or to consider ways in which the approximations could be improved. We also note that the computational tricks employed here also apply to other settings, including the combined “variable selection plus random effects” model that has been widely studied for phenotype and breeding value prediction<sup><xref rid="R16" ref-type="bibr">16</xref></sup>, but which, without the trick used here, is computationally challenging to fit.</p>
  </sec>
  <sec sec-type="discussion" id="S3">
    <title>DISCUSSION</title>
    <p id="P12">In summary, we have presented an efficient method for computing exact values of standard test statistics in linear mixed models. This method is comparable in speed with approximation methods such as EMMAX while yielding exact test statistics. Using two examples we illustrate our method, and show that the approximation methods can yield inaccurate <italic>p</italic> values when the sample structure is strong and/or when the marker effect size is large. We also find that the approximation by EMMAX is more accurate than the approximation by GRAMMAR genome-wide (a comparison made possible only by the availability of an efficient exact method).</p>
    <p id="P13">While this work was in review, Lippert et al<sup><xref rid="R8" ref-type="bibr">8</xref></sup> also published an efficient method for computing likelihoods for LMMs that, like our method, requires only one singular value decomposition of the relatedness matrix. They use this method, in combination with Brent's optimization algorithm, to produce an algorithm for computing exact test statistics with effectively the same computational complexity as GEMMA: <italic>O(mn<sup>2</sup></italic>+<italic>cn<sup>2</sup></italic>+<italic>pn<sup>2</sup></italic>+<italic>ptc<sup>2</sup>n)</italic>, as in <xref ref-type="table" rid="T1">Table 1</xref>. (Lippert et al<sup><xref rid="R8" ref-type="bibr">8</xref></sup> also suggest a further innovation, using a low-rank relatedness matrix in place of the usual relatedness matrix computed from all SNPs genome-wide, that produces an algorithm that is linear in <italic>n</italic>, and so feasible for very large GWAS samples containing more than 100,000 individuals; however changing the relatedness matrix in this way changes the resulting <italic>p</italic> values appreciably, and in this sense this linear complexity algorithm is not directly comparable with either GEMMA or EMMA; see below for further discussion.) The main additional contribution of our work here beyond that in Lippert et al is that we provide, and make use of, efficient methods for evaluation of not only the likelihood, but also both its first and second derivatives. This allows us to make use of the Newton--Raphson optimization method, which has better theoretical convergence properties than Brent's algorithm (quadratic, vs super-linear), potentially reducing per-SNP computation time by reducing the number of iterations required for convergence, <italic>t</italic>. The practical effect of this is expected to depend on the sample size <italic>n</italic>. Examining the theoretical computational complexity, if <italic>p</italic> is large (and we assume the simplest case with no additional covariates, so <italic>c=1</italic>) then the per-SNP complexity of the algorithms is <italic>O(nw<sup>2</sup></italic> + <italic>tn)</italic>. Thus if <italic>n</italic> is large then the <italic>n<sup>2</sup></italic> term will dominate and the number of iterations will have only a small effect of computation time; if <italic>n</italic> is moderate then the number of iterations may play a more important role. Consistent with this, we found GEMMA to be 12 times faster than the Lippert et al algorithm, implemented in FaST-LMM, for the smaller HMDP dataset (33 minutes vs 6.8 hours), but only 2 times faster for the WTCCC data (3.3 hours vs 6.2 hours). It is possible that implementational issues, which are important but conceptually less fundamental, also contribute to this difference in speed. Besides this difference in speed, which might be considered a minor issue, by providing efficient methods to compute derivatives our work here lays the foundations for similar efficient analyses for LMMs with multivariate phenotypes<sup><xref rid="R17" ref-type="bibr">17</xref></sup>, where multidimensional optimization is required and evaluating the target functions alone is unlikely to suffice.</p>
    <p id="P14">Here we have focused on computations using the usual relatedness matrix, computed from all SNPs genome-wide, whose rank, <italic>r</italic>, is typically equal to the number of individuals <italic>n</italic>. However, as noted by Lippert et al<sup><xref rid="R8" ref-type="bibr">8</xref></sup>, if a lower-rank relatedness matrix is used then this reduces computing time (computational complexity of the singular value decomposition can scale with <italic>nr<sup>2</sup></italic>) and in some cases memory requirements (e.g. Lippert et al.<sup><xref rid="R8" ref-type="bibr">8</xref></sup> suggest using a relatedness matrix based on only a few thousand SNPs; this has the nice property that required singular value decompositions can be done without computing the <italic>n</italic> by <italic>n</italic> relatedness matrix itself). Using the usual full-rank relatedness matrix, our current implementation of GEMMA can handle approximately 23,000 individuals on a machine with 64 Gb memory (in double precision); using a lower-rank relatedness matrix, much larger problems could be tackled. However, we note that changing the relatedness matrix can produce much larger changes in <italic>p</italic> values than, for example, the differences between EMMAX and exact calculations (e.g. <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 2</xref>), and for both the HMDP and WTCCC data using a lower-rank relatedness matrix seems to compromise the ability of the LMM to control for sample structure (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 1</xref>). Thus choice of relatedness matrix could affect statistical efficiency (both power, and correct control of type I error due to stratification or relatedness) as well as computational efficiency. Interestingly, statistical and computational considerations may not necessarily conflict: for example,<sup><xref rid="R7" ref-type="bibr">7</xref></sup> suggest that use of compressed MLM, which yields a lower-rank relatedness matrix by clustering individuals, can both reduce computation and increase power compared with the full-rank matrix. The general question of which low-rank relatedness matrices produce the best combination of computational and statistical performance seems to be an interesting avenue for further study.</p>
    <sec id="S4">
      <title>URLs</title>
      <p id="P15">Our method is implemented in software GEMMA, freely available at <ext-link ext-link-type="uri" xlink:href="http://stephenslab.uchicago.edu/software.html.">http://stephenslab.uchicago.edu/software.html.</ext-link></p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="SM">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>1</label>
      <media xlink:href="NIHMS375372-supplement-1.pdf" mimetype="application" mime-subtype="pdf" orientation="portrait" xlink:type="simple" id="d37e465" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD2">
      <label>2</label>
      <media xlink:href="NIHMS375372-supplement-2.pdf" mimetype="application" mime-subtype="pdf" orientation="portrait" xlink:type="simple" id="d37e469" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S5">
    <title>ACKNOWLEDGMENT</title>
    <p>This research is supported in part by NIH grant HL092206 (PI Y Gilad) and NIH grant HG02585 to MS. We thank A. J. Lusis for making the mouse genotype and phenotype data available. This study also makes use of data generated by the Wellcome Trust Case-Control Consortium <sup><xref rid="R14" ref-type="bibr">14</xref></sup>. A full list of the investigators who contributed to the generation of the data is available from <ext-link ext-link-type="uri" xlink:href="http://www.wtccc.org.uk">http://www.wtccc.org.uk</ext-link> . Funding for the WTCCC project was provided by the Wellcome Trust under award 085475.</p>
  </ack>
  <fn-group>
    <fn id="FN1">
      <p id="P16"><bold>AUTHOR CONTRIBUTIONS</bold> X.Z. and M.S. designed the study, developed methods and wrote the manuscript. X.Z. implemented software and analyzed data.</p>
    </fn>
    <fn id="FN2">
      <p id="P17"><bold>COMPETING FINANCIAL INTERESTS</bold> The authors declare no competing financial interests.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="R1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>HM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Variance component model to account for sample structure in genome-wide association studies</article-title>
        <source>Nat Genet</source>
        <year>2010</year>
        <volume>42</volume>
        <fpage>348</fpage>
        <lpage>354</lpage>
        <pub-id pub-id-type="pmid">20208533</pub-id>
      </element-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Eskin</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Accurate discovery of expression quantitative trait loci under confounding from spurious and genuine regulatory hotspots</article-title>
        <source>Genetics</source>
        <year>2008</year>
        <volume>180</volume>
        <fpage>1909</fpage>
        <lpage>1925</lpage>
        <pub-id pub-id-type="pmid">18791227</pub-id>
      </element-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>HM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Efficient control of population structure in model organism association mapping</article-title>
        <source>Genetics</source>
        <year>2008</year>
        <volume>178</volume>
        <fpage>1709</fpage>
        <lpage>1723</lpage>
        <pub-id pub-id-type="pmid">18385116</pub-id>
      </element-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Listgarten</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kadie</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schadt</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Heckerman</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Correction for hidden confounders in the genetic analysis of gene expression</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2010</year>
        <volume>107</volume>
        <fpage>16465</fpage>
        <lpage>16470</lpage>
        <pub-id pub-id-type="pmid">20810919</pub-id>
      </element-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Zaitlen</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>New approaches to population stratification in genome-wide association studies</article-title>
        <source>Nat Rev Genet</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>459</fpage>
        <lpage>463</lpage>
        <pub-id pub-id-type="pmid">20548291</pub-id>
      </element-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A unified mixed-model method for association mapping that accounts for multiple levels of relatedness</article-title>
        <source>Nat Genet</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>203</fpage>
        <lpage>208</lpage>
        <pub-id pub-id-type="pmid">16380716</pub-id>
      </element-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mixed linear model approach adapted for genome-wide association studies</article-title>
        <source>Nat Genet</source>
        <year>2010</year>
        <volume>42</volume>
        <fpage>355</fpage>
        <lpage>360</lpage>
        <pub-id pub-id-type="pmid">20208535</pub-id>
      </element-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lippert</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>FaST linear mixed models for genome-wide association studies</article-title>
        <source>Nat Methods</source>
        <year>2011</year>
        <volume>8</volume>
        <fpage>833</fpage>
        <lpage>835</lpage>
        <pub-id pub-id-type="pmid">21892150</pub-id>
      </element-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aulchenko</surname>
            <given-names>YS</given-names>
          </name>
          <name>
            <surname>Ripke</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Isaacs</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>van Duijn</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>GenABEL: an R library for genome-wide association analysis</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>1294</fpage>
        <lpage>1296</lpage>
        <pub-id pub-id-type="pmid">17384015</pub-id>
      </element-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aulchenko</surname>
            <given-names>YS</given-names>
          </name>
          <name>
            <surname>de Koning</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Haley</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Genomewide rapid association using mixed model and regression: a fast and simple method for genomewide pedigree-based quantitative trait loci association analysis</article-title>
        <source>Genetics</source>
        <year>2007</year>
        <volume>177</volume>
        <fpage>577</fpage>
        <lpage>585</lpage>
        <pub-id pub-id-type="pmid">17660554</pub-id>
      </element-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abney</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ober</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>McPeek</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Quantitative-trait homozygosity and association mapping and empirical genomewide significance in large, complex pedigrees: fasting serum-insulin level in the Hutterites</article-title>
        <source>Am J Hum Genet</source>
        <year>2002</year>
        <volume>70</volume>
        <fpage>920</fpage>
        <lpage>934</lpage>
        <pub-id pub-id-type="pmid">11880950</pub-id>
      </element-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Practical issues in imputation-based association mapping</article-title>
        <source>PLoS Genet</source>
        <year>2008</year>
        <volume>4</volume>
        <fpage>e1000279</fpage>
        <pub-id pub-id-type="pmid">19057666</pub-id>
      </element-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Howie</surname>
            <given-names>BN</given-names>
          </name>
          <name>
            <surname>Donnelly</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Marchini</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A flexible and accurate genotype imputation method for the next generation of genome-wide association studies</article-title>
        <source>PLoS Genet</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>e1000529</fpage>
        <pub-id pub-id-type="pmid">19543373</pub-id>
      </element-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bennett</surname>
            <given-names>BJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A high-resolution association mapping panel for the dissection of complex traits in mice</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>281</fpage>
        <lpage>290</lpage>
        <pub-id pub-id-type="pmid">20054062</pub-id>
      </element-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>The Wellcome Trust Case Control Consortium</collab>
        </person-group>
        <article-title>Genome-wide association study of 14,000 cases of seven common diseases and 3,000 shared controls</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>447</volume>
        <fpage>661</fpage>
        <lpage>678</lpage>
        <pub-id pub-id-type="pmid">17554300</pub-id>
      </element-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>van der Werf</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Visscher</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>Predicting unobserved phenotypes for complex traits from whole-genome SNP data</article-title>
        <source>PLoS Genet</source>
        <year>2008</year>
        <volume>4</volume>
        <fpage>e1000231</fpage>
        <pub-id pub-id-type="pmid">18949033</pub-id>
      </element-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meyer</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Estimating variances and covariances for multivariate animal models by restricted maximum likelihood</article-title>
        <source>Genetics Selection Evolution</source>
        <year>1991</year>
        <volume>23</volume>
        <fpage>67</fpage>
        <lpage>83</lpage>
      </element-citation>
    </ref>
    <ref id="R18">
      <label>18</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Searle</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Casella</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>McCulloch</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <source>Variance components</source>
        <year>2006</year>
        <publisher-name>Wiley</publisher-name>
        <publisher-loc>New York</publisher-loc>
      </element-citation>
    </ref>
    <ref id="R19">
      <label>19</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Henderson</surname>
            <given-names>CR</given-names>
          </name>
        </person-group>
        <source>Applications of linear models in animal breeding</source>
        <year>1984</year>
        <publisher-name>University of Guelph</publisher-name>
        <publisher-loc>Guelph</publisher-loc>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p>Comparison of -log<sub>10 </sub><italic>p</italic> values obtained from GEMMA with those from EMMA (a, b), and EMMAX and GRAMMAR (c, d). In (a) and (b) the <italic>p</italic> values are shown for the top 10,000 markers and top 100 markers respectively. In (c) and (d) the <italic>p</italic> values are shown for all markers (1.9 million and 442k respectively).</p>
    </caption>
    <graphic xlink:href="nihms-375372-f0001"/>
  </fig>
  <table-wrap id="T1" position="float" orientation="portrait">
    <label>Table 1</label>
    <caption>
      <p>Performance of different methods for GWAS with the linear mixed model. All computing were performed on a single core of an Intel Xeon L5420 2.50 GHz CPU. The time for the EMMA method is projected from a selection of 10,000 and 100 genetic markers in the HMDP data set and WTCCC data set, respectively. Note that EMMA is implemented in R while others are implemented in C. A C implementation of EMMA could be a few times faster. <italic>p</italic> is the number of genetic markers, <italic>n</italic> is the number of individuals, <italic>m</italic> is the number of strains (equal to <italic>n</italic> for human studies), <italic>c</italic> is the number of covariates (fixed effects) in addition to the genotypes. <italic>t<sub>1</sub></italic> and <italic>t<sub>2</sub></italic> are the number of optimization iterations required, for Brent's method (super-linear rate of convergence) and the Newton--Raphson method (quadratic rate of convergence) respectively. Note that <italic>t<sub>2</sub></italic> is expected to be smaller than <italic>t<sub>1</sub>.</italic></p>
    </caption>
    <table frame="box" rules="all">
      <thead>
        <tr>
          <th rowspan="2" colspan="2" align="center" valign="middle">Methods</th>
          <th rowspan="2" align="left" valign="middle" colspan="1">Time Complexity<sup><xref ref-type="table-fn" rid="TFN1">a</xref></sup></th>
          <th colspan="2" align="center" valign="middle" rowspan="1">Computing Time</th>
        </tr>
        <tr>
          <th align="center" valign="middle" rowspan="1" colspan="1">HDL-C<sup><xref ref-type="table-fn" rid="TFN2">b</xref></sup></th>
          <th align="center" valign="middle" rowspan="1" colspan="1">Crohn's Disease<sup><xref ref-type="table-fn" rid="TFN3">c</xref></sup></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td rowspan="3" align="center" valign="middle" colspan="1">Exact Methods</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">GEMMA</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">
            <italic>O(mn<sup>2</sup>+cn<sup>2</sup>+pn<sup>2</sup>+pt<sub>2</sub>c<sup>2</sup>n)</italic>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">33 minutes</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">3.3 hours</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">EMMA</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">
            <italic>O(mn<sup>2</sup>+pmn<sup>2</sup>+pt<sub>2</sub>n)</italic>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">~ 9 days</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">~ 27 years</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">FaST-LMM<sup><xref ref-type="table-fn" rid="TFN4">d</xref></sup></td>
          <td align="left" valign="middle" rowspan="1" colspan="1">
            <italic>O(mn<sup>2</sup>+cn<sup>2</sup>+pn<sup>2</sup>+pt<sub>1</sub>c<sup>2</sup>n)</italic>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">6.8 hours</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">6.2 hours</td>
        </tr>
        <tr>
          <td rowspan="2" align="center" valign="middle" colspan="1">Approximate Methods</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">EMMAX</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">
            <italic>O(mn<sup>2</sup>+t<sub>2</sub>n+pn<sup>2</sup>)</italic>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">44 minutes</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">6.4 hours</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">GRAMMAR</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">
            <italic>O(mn<sup>2</sup>+t<sub>2</sub>n+pn)</italic>
          </td>
          <td align="center" valign="middle" rowspan="1" colspan="1">1.6 minutes</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">12 minutes</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="TFN1">
        <label>a</label>
        <p id="P18">Complexities are given assuming the usual genome-wide relatedness matrix, which has rank <italic>n</italic>. In the current implementation of various methods except EMMA, the first terms are actually <italic>n<sup>3</sup></italic>, but it would be straightforward to make them <italic>mn<sup>2</sup></italic> in principle.</p>
      </fn>
      <fn id="TFN2">
        <label>b</label>
        <p id="P19"><italic>m</italic>=99, <italic>n</italic>=681 and <italic>p</italic>=1,885,197 for HDL-C.</p>
      </fn>
      <fn id="TFN3">
        <label>c</label>
        <p id="P20"><italic>m</italic>=<italic>n</italic>=4686 and <italic>p</italic>=442,001 for Crohn's disease.</p>
      </fn>
      <fn id="TFN4">
        <label>d</label>
        <p id="P21">These results are for the algorithm in FaST-LMM that uses the standard full-rank relatedness matrix, which produces <italic>p</italic> values that are identical to GEMMA and EMMA. See main text for further discussion.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
</floats-group>
