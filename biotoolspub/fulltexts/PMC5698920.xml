<?properties open_access?>
<?subarticle report27253?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing3.dtd?>
<?SourceDTD.Version 3.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">F1000Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">F1000Res</journal-id>
    <journal-id journal-id-type="pmc">F1000Research</journal-id>
    <journal-title-group>
      <journal-title>F1000Research</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2046-1402</issn>
    <publisher>
      <publisher-name>F1000 Research Limited</publisher-name>
      <publisher-loc>London, UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5698920</article-id>
    <article-id pub-id-type="doi">10.12688/f1000research.12512.1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software Tool Article</subject>
      </subj-group>
      <subj-group>
        <subject>Articles</subject>
        <subj-group>
          <subject>Bioinformatics</subject>
        </subj-group>
        <subj-group>
          <subject>Marine &amp; Freshwater Ecology</subject>
        </subj-group>
        <subj-group>
          <subject>Spatial &amp; Landscape Ecology</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>lakemorpho</italic>: Calculating lake morphometry metrics in R</article-title>
      <fn-group content-type="pub-status">
        <fn>
          <p>[version 1; referees: 2 approved]</p>
        </fn>
      </fn-group>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hollister</surname>
          <given-names>Jeffrey</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project Administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – Original Draft Preparation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-9254-9740</contrib-id>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stachelek</surname>
          <given-names>Joseph</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – Original Draft Preparation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-5924-2464</contrib-id>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <aff id="a1"><label>1</label>US Environmental Protection Agency, Office of Research and Development, National Health and Environmental Effects Research Laboratory, Atlantic Ecology Division, Narragansett, RI, USA</aff>
      <aff id="a2"><label>2</label>Michigan State University, Department of Fisheries and Wildlife, Natural Resources Building, East Lansing, MI, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email xlink:href="mailto:hollister.jeff@epa.gov">hollister.jeff@epa.gov</email>
      </corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>6</volume>
    <elocation-id>1718</elocation-id>
    <history>
      <date date-type="accepted">
        <day>21</day>
        <month>11</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright: © 2017 Hollister J and Stachelek J</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:type="simple" xlink:href="f1000research-6-13548.pdf"/>
    <abstract>
      <p>Metrics describing the shape and size of lakes, known as lake morphometry metrics, are important for any limnological study. In cases where a lake has long been the subject of study these data are often already collected and are openly available. Many other lakes have these data collected, but access is challenging as it is often stored on individual computers (or worse, in filing cabinets) and is available only to the primary investigators. The vast majority of lakes fall into a third category in which the data are not available. This makes broad scale modelling of lake ecology a challenge as some of the key information about in-lake processes are unavailable. While this valuable
<italic>in situ</italic> information may be difficult to obtain, several national datasets exist that may be used to model and estimate lake morphometry. In particular, digital elevation models and hydrography have been shown to be predictive of several lake morphometry metrics. The R package
<italic>lakemorpho </italic>has been developed to utilize these data and estimate the following morphometry metrics: surface area, shoreline length, major axis length, minor axis length, major and minor axis length ratio, shoreline development, maximum depth, mean depth, volume, maximum lake length, mean lake width, maximum lake width, and fetch. In this software tool article we describe the motivation behind developing
<italic>lakemorpho</italic>, discuss the implementation in R, and describe the use of
<italic>lakemorpho</italic> with an example of a typical use case.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>limnology</kwd>
      <kwd>R</kwd>
      <kwd>lake morphometry</kwd>
      <kwd>lake depth</kwd>
      <kwd>lake volume</kwd>
    </kwd-group>
    <funding-group>
      <funding-statement>The author(s) declared that no grants were involved in supporting this work.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>The study and quantification of lake shape (i.e. lake morphology and morphometry) is one of the foundations of limnology, and for students of limnology, some of the first lessons are centered around a typical suite of metrics and how to calculate them
<sup><xref rid="ref-1" ref-type="bibr">1</xref></sup>. It is also widely accepted that the morphometry of lakes and ponds can impact available nutrients and thus overall productivity. For instance, the widely used Vollenweider input-output models that are used to estimate nutrient concentrations rely on hydraulic residence time and sometimes mean depth, both of which are derived from total lake volume
<sup><xref rid="ref-2" ref-type="bibr">2</xref>,
<xref rid="ref-3" ref-type="bibr">3</xref></sup>. Also, clear water versus turbid water states in lakes have been linked in part to lake morphometry, in particular mean depth
<sup><xref rid="ref-4" ref-type="bibr">4</xref>,
<xref rid="ref-5" ref-type="bibr">5</xref></sup>. In short, limnologists have long recognized the importance of lake morphology as one factor controlling a variety of ecological processes in lakes.</p>
    <p>Traditional methods for calculating lake morphometry metrics have relied upon the use of paper bathymetry maps, planimeters, or simple heuristics
<sup><xref rid="ref-6" ref-type="bibr">6</xref>–
<xref rid="ref-9" ref-type="bibr">9</xref></sup>. In addition, detailed bathymetry is a requirement for the calculation of most lake morphometry metrics, but is generally only available for a relatively small number of lakes. Although this is not a problem when the focus of a study is a single lake, a small number of lakes, or a group of well-studied lakes, reliance on complete bathymetry becomes a limitation when attempting to conduct regional or national-scale lake studies. For instance, Soranno
<italic>et al.</italic> found that for some water quality datasets lake depth, in spite of its importance, was not always available
<sup><xref rid="ref-10" ref-type="bibr">10</xref></sup>. In cases such as these, alternative approaches for estimating lake morphometry are required.</p>
    <p>Recent work has demonstrated the ability to estimate many of these metrics from ubiquitous spatial data
<sup><xref rid="ref-9" ref-type="bibr">9</xref>,
<xref rid="ref-11" ref-type="bibr">11</xref>–
<xref rid="ref-13" ref-type="bibr">13</xref></sup>. For instance, maximum depth and lake volume may be predicted using the lake polygon and surrounding topography
<sup><xref rid="ref-9" ref-type="bibr">9</xref>,
<xref rid="ref-11" ref-type="bibr">11</xref></sup> provided by the National Hydrography Dataset Plus and the National Elevation Dataset, respectively
<sup><xref rid="ref-14" ref-type="bibr">14</xref>,
<xref rid="ref-15" ref-type="bibr">15</xref></sup>. These methods were initially developed with proprietary tools, thus limiting their accessibility. In an effort to reach a broader audience, the tools were converted to R, expanded to include a more complete suite of lake morphometry metrics and compiled into an R Package.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Implementation in R</title>
      <p>Using R as a Geographic Information System is now possible, as several packages provide spatial data handling, geospatial analysis, and visualization. It is because of these packages that
<monospace>lakemorpho</monospace> was implemented as an R package
<sup><xref rid="ref-16" ref-type="bibr">16</xref></sup>. In particular,
<monospace>lakemorpho</monospace> relies on the following packages:
<monospace>maptools</monospace>,
<monospace>rgdal</monospace>,
<monospace>raster</monospace>,
<monospace>rgeos</monospace>,
<monospace>sp</monospace>, and
<monospace>geosphere</monospace>
<sup><xref rid="ref-17" ref-type="bibr">17</xref>–
<xref rid="ref-23" ref-type="bibr">23</xref></sup>. In addition to these packages, two external libraries, the Geospatial Data Abstraction Library (GDAL) and Geometry Engine, Open Source (GEOS), are needed. Their availability to R and installation varies by operating system
<sup><xref rid="ref-24" ref-type="bibr">24</xref>,
<xref rid="ref-25" ref-type="bibr">25</xref></sup>.</p>
    </sec>
    <sec>
      <title>Using lakemorpho</title>
      <p>The
<monospace>lakemorpho</monospace> package includes one function to create a
<monospace>lakeMorpho</monospace> object, several functions to calculate morphometry metrics, a default plotting function, two example datasets, and an example
<monospace>lakeMorpho</monospace> object.</p>
      <p>A typical workflow for using
<monospace>lakemorpho</monospace> to calculate lake metrics would include pulling spatial data into R (e.g. as shapefiles, tiff, etc.), creating a
<monospace>lakeMorpho</monospace> object and calculating the desired lake morphometry metrics. The following sections provide details on the type of input data required and demonstrate use of the available functions with the provided example data.</p>
      <p><bold><italic>The
<monospace>lakeMorpho</monospace> Class and
<monospace>lakeSurroundTopo</monospace> function.</italic></bold> Many of the lake morphometry metrics rely on the same information about the lake. For instance, the functions to estimate maximum depth, mean depth, and volume rely on statistical summaries of the surrounding topography as well as the maximum in-lake distance to shoreline
<sup><xref rid="ref-9" ref-type="bibr">9</xref>,
<xref rid="ref-11" ref-type="bibr">11</xref></sup>. To avoid recalculating these values, a
<monospace>lakeMorpho</monospace> object was created to link information on surrounding topography to the original datasets and facilitate default plotting of the outputs. All lake morphometry functions in the
<monospace>lakemorpho</monospace> package require an object of class
<monospace>lakeMorpho</monospace> as input. Some functions also return an updated
<monospace>lakeMorpho</monospace> object that includes calculated spatial objects as output. At a minimum, a
<monospace>lakeMorpho</monospace> object contains (see
<xref ref-type="fig" rid="f1">Figure 1</xref>):</p>
      <list list-type="bullet">
        <list-item>
          <p>"lake" - A
<monospace>SpatialPolygons</monospace> or
<monospace>SpatialPolygonsDataFrame</monospace> object of the original input lake data.</p>
        </list-item>
        <list-item>
          <p>"elev" - A
<monospace>RasterLayer</monospace> representing the elevation in a suitably large area around the lake.</p>
        </list-item>
        <list-item>
          <p>"surround" - A
<monospace>SpatialPolygons</monospace> or
<monospace>SpatialPolygonsDataFrame</monospace> object representing the land area defined as the surrounding topography.</p>
        </list-item>
        <list-item>
          <p>"lakeDistance" - A
<monospace>RasterLayer</monospace> object of the euclidean distance from the shoreline to center of each pixel. Maximum value is equal to the maximum in-lake distance.</p>
        </list-item>
        <list-item>
          <p>"lakeOnEdge" - A logical value indicating if the "surround" polygon falls on the edge of the "elev" raster (i.e. would contain missing (i.e. NA) elevation data).</p>
        </list-item>
      </list>
      <fig fig-type="figure" id="f1" orientation="portrait" position="anchor">
        <label>Figure 1. </label>
        <caption>
          <title>Diagram of
<monospace>lakemorpho</monospace> object.</title>
        </caption>
        <graphic xlink:href="f1000research-6-13548-g0000"/>
      </fig>
      <p>The
<monospace>lakeSurroundTopo</monospace> function is the primary mechanism for creating a
<monospace>lakeMorpho</monospace> object. There are two required inputs and one optional input for
<monospace>lakeSurroundTopo</monospace>. The first required input is a
<monospace>SpatialPolygons</monospace> or
<monospace>SpatialPolygonsDataFrame</monospace> of the lake
<sup><xref rid="ref-21" ref-type="bibr">21</xref></sup>. Only a single lake is accepted as input, although this lake may be composed of multiple polygons (i.e. a lake with islands). If metrics for multiple lakes are required they will need to be passed to the suite of
<monospace>lakemorpho</monospace> functions separately. The second required input is a
<monospace>RasterLayer</monospace> of the elevation surrounding the lake
<sup><xref rid="ref-22" ref-type="bibr">22</xref></sup>. The default raster size is taken from the resolution of the input elevation data but may be specified separately. The third input specifies the area representing the surrounding topography. By default, this is a buffer of the lake shoreline, with the buffer width equal to the maximum in-lake distance. An optional
<monospace>SpatialPolygons</monospace> object of any polygon intersecting the lake (e.g. catchments) can be used to define the surrounding topography instead of the default buffer. An object of class l
<monospace>akeMorpho</monospace> is returned from
<monospace>lakeSurroundTopo</monospace>.</p>
      <p>In addition to providing the required inputs, users should pay attention to both the extent of the input elevation dataset as well as the coordinate reference systems being used. First, the elevation data must be of a large enough extent so that the surrounding topography does not include land area outside that extent (i.e. would return NA values). As noted above, the
<monospace>lakeOnEdge</monospace> item indicates if the surrounding topography is on the edge of the user supplied elevation and thus would return some missing data. Second, all of the functions of
<monospace>lakemorpho</monospace> assume that projections have been handled prior to creating the
<monospace>lakemorpho</monospace> class or calculating the metrics. If the input data are not of the same projection,
<monospace>lakeSurroundTopo</monospace> will return an error. The data must be re-projected into the same coordinate reference system (CRS). The units of all metrics are determined by the CRS and care must be taken to make sure that the vertical units of the elevation are the same as horizontal units of the projection. For instance, elevation data may be available in meters yet the CRS is specified in feet. In cases such as these, a conversion of the vertical data should be done. Lastly, care must be taken in choosing an appropriate CRS for the area under consideration. This is because all CRS will distort area, distance, shape, or direction. Thus a projection that minimizies distortions of distance and area are preferrable. A useful reference for further exploring coordinate reference system is Iliffe and Lott's 2008 book on the topic
<sup><xref rid="ref-26" ref-type="bibr">26</xref></sup>.</p>
      <p>Usage of
<monospace>lakeSurroundTopo</monospace> and generation of a
<monospace>lakeMorpho</monospace> object from the example data included with
<monospace>lakemorpho</monospace> is done as follows:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#8F5902; font-style:italic">#Load data</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">data</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(lakes)</styled-content>
          <styled-content style="font-size:15px;color:#8F5902; font-style:italic">#Create lakeMorpho object, example_lakeMorpho, with required inputs</styled-content>
          <styled-content style="font-size:15px;color:#000000;">example_lakeMorpho &lt;-</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">lakeSurroundTopo</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(exampleLake, exampleElev)</styled-content>
        </preformat>
      </p>
      <p>The resulting object contains the minimum set of components that make up a
<monospace>lakeMorpho</monospace> object. We can verify that the components are of the expected class with the following command:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">lapply</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(example_lakeMorpho,class)

## $lake
## [1] "SpatialPolygonsDataFrame"
## attr(,"package")
## [1] "sp"
## 
## $elev
## [1] "RasterLayer"
## attr(,"package")
## [1] "raster"
## 
## $surround
## [1] "SpatialPolygons"
## attr(,"package")
## [1] "sp"
## 
## $lakeDistance
## [1] "RasterLayer"
## attr(,"package")
## [1] "raster"
## 
## $lakeOnEdge
## [1] "logical"
</styled-content>
        </preformat>
      </p>
      <p><bold><italic>Lake Morphometry Functions.</italic></bold> Each of the remaining functions expects a
<monospace>lakeMorpho</monospace> object as input and returns a numeric value. Some of the functions also have a side effect of adding a spatial object to the input
<monospace>lakeMorpho</monospace> object.</p>
      <p>
        <bold>calcLakeMetrics</bold>
      </p>
      <p>The
<monospace>calcLakeMetrics</monospace> function is a convenience function that will calculate all of the
<monospace>lakemorpho</monospace> metrics for a single
<monospace>lakeMorpho</monospace> object. It requires an input
<monospace>lakeMorpho</monospace> object, a
<monospace>bearing</monospace> for calculating
<monospace>lakeFetch</monospace>, and
<monospace>pointDens</monospace> for maximum lake length and width (defined below).</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">calcLakeMetrics</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(example_lakeMorpho,</styled-content>
          <styled-content style="font-size:15px;color:#0000CF;">0</styled-content>
          <styled-content style="font-size:15px;color:#000000;">,</styled-content>
          <styled-content style="font-size:15px;color:#0000CF;">250</styled-content>
          <styled-content style="font-size:15px;color:#000000;">)

## $surfaceArea
## [1] 16453180
## 
## $shorelineLength
## [1] 45991.38
## 
## $shorelineDevelopment
## [1] 3.198502
## 
## $maxDepth
## [1] 99.17621
## 
## $volume
## [1] 4802535
## 
## $meanDepth
## [1] 28.94864
## 
## $maxLength
## [1] 9479.313
## 
## $maxWidth
## [1] 3166.225
## 
## $meanWidth
## [1] 1735.693
## 
## $fetch
## [1] 6336.798
</styled-content>
        </preformat>
      </p>
      <p>
        <bold>lakeFetch</bold>
      </p>
      <p>Fetch is the maximum open water distance in a given direction and can be used an indicator of mixing as greater fetch implies greater potential for waves due to wind effects
<sup><xref rid="ref-27" ref-type="bibr">27</xref></sup>. The
<monospace>lakeFetch</monospace> function calculates fetch along an input bearing. The input bearing may be any value from 0 to 360 where 0 and 360 both represent north, and the fetch for opposite directions (e.g. east and west) are identical.</p>
      <p>To calculate the fetch of an input lake use:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#8F5902; font-style:italic">#Fetch for north</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">lakeFetch</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(example_lakeMorpho,</styled-content>
          <styled-content style="font-size:15px;color:#0000CF;">0</styled-content>
          <styled-content style="font-size:15px;color:#000000;">)</styled-content>
          <styled-content style="font-size:15px;color:#000000;">## [1] 6336.798</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">lakeFetch</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(example_lakeMorpho,</styled-content>
          <styled-content style="font-size:15px;color:#0000CF;">360</styled-content>
          <styled-content style="font-size:15px;color:#000000;">)</styled-content>
          <styled-content style="font-size:15px;color:#000000;">## [1] 6336.798</styled-content>
          <styled-content style="font-size:15px;color:#8F5902; font-style:italic">#Fetch for west</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">lakeFetch</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(example_lakeMorpho,</styled-content>
          <styled-content style="font-size:15px;color:#0000CF;">270</styled-content>
          <styled-content style="font-size:15px;color:#000000;">)</styled-content>
          <styled-content style="font-size:15px;color:#000000;">## [1] 3129.997</styled-content>
        </preformat>
      </p>
      <p>
        <bold>lakeMajorAxisLength</bold>
      </p>
      <p>The major axis of a lake is defined as the longest line intersecting the convex hull formed around its polygon while passing through its center. In contrast to
<monospace>lakeMaxLength</monospace>, its value represents the distance across a lake without regard to land-water configuration.</p>
      <p>To calculate the major axis length of an input lake use:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">lakeMajorAxisLength</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(example_lakeMorpho,</styled-content>
          <styled-content style="font-size:15px;color:#204A87;">addLine =</styled-content>
          <styled-content style="font-size:15px;color:#8F5902;">TRUE</styled-content>
          <styled-content style="font-size:15px;color:#000000;">)</styled-content>
          <styled-content style="font-size:15px;color:#000000;">## [1] 13159.64</styled-content>
        </preformat>
      </p>
      <p>
        <bold>lakeMaxDepth</bold>
      </p>
      <p>Maximum lake depth provides information that may be used, along with flow rates, to estimate the residence time of a lake. While there is no substitute for field verified measurements, maximum lake depth may be estimated from the surrounding topography. The
<monospace>lakeMaxDepth</monospace> function uses the methods outlined in Hollister
<italic>et al.</italic>
<sup><xref rid="ref-11" ref-type="bibr">11</xref></sup> to provide an estimate of the maximum lake depth. It requires only a
<monospace>lakeMorpho</monospace> object as input. Optionally, a correction factor based off of verified depth data may be specified if one is known.</p>
      <p>To calculate maximum depth use:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#8F5902; font-style:italic">#Maximum lake depth</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">lakeMaxDepth</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(example_lakeMorpho)

## [1] 99.17621</styled-content>
        </preformat>
      </p>
      <p>It is important to note that the accuracies of these maximum depth predictions do vary across regions and often a correction factor using field measured data is required. For example, Hollister
<italic>et al.</italic>
<sup><xref rid="ref-11" ref-type="bibr">11</xref></sup> demonstrate that for the New England and Mid-Atlantic regions of the United States East coast, the initial predictions were larger than the true values and needed to be reduced.</p>
      <p>
        <bold>lakeMaxLength</bold>
      </p>
      <p>Maximum lake length is the longest open water distance within a lake and, similar to fetch, is a metric that can be used to estimate mixing potential
<sup><xref rid="ref-1" ref-type="bibr">1</xref>,
<xref rid="ref-28" ref-type="bibr">28</xref></sup>. The current implementation of this calculation in
<monospace>lakemorpho</monospace> places points at equal distances along the shoreline of the lake and then finds the longest point-to-point distance that also does not intersect land (e.g. peninsulas or islands). The optional parameter
<monospace>addLine</monospace> has a default value of
<monospace>TRUE</monospace> and allows the
<monospace>SpatialLines</monospace> object to be stored on the input
<monospace>lakeMorpho</monospace> object (
<xref ref-type="fig" rid="f2">Figure 2</xref>).</p>
      <fig fig-type="figure" id="f2" orientation="portrait" position="anchor">
        <label>Figure 2. </label>
        <caption>
          <title>Diagram of the
<monospace>lakemorpho</monospace> object before and after calculating a lake metric.</title>
        </caption>
        <graphic xlink:href="f1000research-6-13548-g0001"/>
      </fig>
      <p>To calculate maximum lake length use:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#8F5902; font-style:italic">#Max length with a point density of 250</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">lakeMaxLength</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(example_lakeMorpho,</styled-content>
          <styled-content style="font-size:15px;color:#0000CF;">250</styled-content>
          <styled-content style="font-size:15px;color:#000000;">,</styled-content>
          <styled-content style="font-size:15px;color:#204A87;">addLine =</styled-content>
          <styled-content style="font-size:15px;color:#8F5902;">FALSE</styled-content>
          <styled-content style="font-size:15px;color:#000000;">)</styled-content>
          <styled-content style="font-size:15px;color:#000000;">## [1] 9025.769</styled-content>
        </preformat>
      </p>
      <p>The
<monospace>pointDens</monospace> parameter can have an impact on both the processing time and the resulting value and both of these can vary as a function of the complexity of the shape of the lake with less complex lakes providing more consistent lake length across a number of points. Given this caveat, care must be taken in choosing an appropriate number of points (and thus lines) to use to calculate maximum lake length. Several densities should be tested and the smallest number of points that produce a stable estimate should be used.</p>
      <p>
        <bold>lakeMaxWidth</bold>
      </p>
      <p>Maximum lake width is the maximum shore to shore distance that is perpendicular to the line representing maximum lake length and is another metric related to mixing
<sup><xref rid="ref-1" ref-type="bibr">1</xref>,
<xref rid="ref-28" ref-type="bibr">28</xref></sup>. The
<monospace>lakeMaxWidth</monospace> function requires a
<monospace>lakeMorpho</monospace> object and
<monospace>pointDens</monospace> value which is used to determine the number of points along the maximum lake length line. The issue with
<monospace>pointDens</monospace>, discussed above, also exists for the use of
<monospace>pointDens</monospace> with
<monospace>lakeMaxWidth</monospace> and care should be taken to determine an appropriate number of lines to test.</p>
      <p>Usage of lakeMaxWidth is:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#8F5902; font-style:italic">#Max width with a point density of 250</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">lakeMaxWidth</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(example_lakeMorpho,</styled-content>
          <styled-content style="font-size:15px;color:#0000CF;">250</styled-content>
          <styled-content style="font-size:15px;color:#000000;">)</styled-content>
          <styled-content style="font-size:15px;color:#000000;">## [1] 3177.625</styled-content>
        </preformat>
      </p>
      <p>
        <bold>lakeMeanDepth</bold>
      </p>
      <p>Mean depth of a lake is calculated as the volume of the lake divided by the area
<sup><xref rid="ref-1" ref-type="bibr">1</xref>,
<xref rid="ref-28" ref-type="bibr">28</xref></sup>. This function requires only a
<monospace>lakeMorpho</monospace> object and returns a numeric value of the mean depth. Usage of the function is:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">lakeMeanDepth</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(example_lakeMorpho)</styled-content>
          <styled-content style="font-size:15px;color:#000000;">## [1] 28.94864</styled-content>
        </preformat>
      </p>
      <p>There is an optional
<monospace>zmax</monospace> argument that allows a user to specify a maximum lake depth if one is available. If not supplied, the maximum depth will be estimated using
<monospace>lakeMaxDepth</monospace>. For instance, in the above example, the maximum depth without using a correction factor is estimated at 99 meters which results in a mean depth estimate of 28.95. The measured maximum depth, 32 meters, is much less than the estimate depth. To use this information you would simply add the measured valued in for the
<monospace>zmax</monospace> argument.</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">lakeMeanDepth</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(inputLM,</styled-content>
          <styled-content style="font-size:15px;color:#204A87;">zmax =</styled-content>
          <styled-content style="font-size:15px;color:#0000CF;">32</styled-content>
          <styled-content style="font-size:15px;color:#000000;">)</styled-content>
          <styled-content style="font-size:15px;color:#000000;">## [1] 9.340511</styled-content>
        </preformat>
      </p>
      <p>
        <bold>lakeMeanWidth</bold>
      </p>
      <p>The mean width of a lake is defined as lake area divided by maximum lake length
<sup><xref rid="ref-1" ref-type="bibr">1</xref>,
<xref rid="ref-28" ref-type="bibr">28</xref></sup>. Input for this function is a
<monospace>lakeMorpho</monospace> object that has the maximum lake length line added via 'lakeMaxLength`. This requirement is checked and returns an error if the maximum length line is missing.</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#8F5902; font-style:italic"># Add the maximum lake length line</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">lakeMaxLength</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(example_lakeMorpho,</styled-content>
          <styled-content style="font-size:15px;color:#204A87;">pointDens =</styled-content>
          <styled-content style="font-size:15px;color:#0000CF;">100</styled-content>
          <styled-content style="font-size:15px;color:#000000;">,</styled-content>
          <styled-content style="font-size:15px;color:#204A87;">addLine =</styled-content>
          <styled-content style="font-size:15px;color:#8F5902;">TRUE</styled-content>
          <styled-content style="font-size:15px;color:#000000;">)</styled-content>
          <styled-content style="font-size:15px;color:#000000;">## [1] 8194.247</styled-content>
          <styled-content style="font-size:15px;color:#8F5902; font-style:italic"># Calculate mean width</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">lakeMeanWidth</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(example_lakeMorpho)</styled-content>
          <styled-content style="font-size:15px;color:#000000;">## [1] 2007.894</styled-content>
        </preformat>
      </p>
      <p>
        <bold>lakeMinorAxisLength</bold>
      </p>
      <p>The minor axis of a lake is defined as the shortest line intersecting the convex hull formed around the lake polygon while passing through its center. In contrast to
<monospace>lakeMaxWidth</monospace>, its value represents the distance across a lake with regard to the the convex hull and without consideration of the land-water configuration.</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">lakeMinorAxisLength</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(example_lakeMorpho,</styled-content>
          <styled-content style="font-size:15px;color:#204A87;">addLine =</styled-content>
          <styled-content style="font-size:15px;color:#8F5902;">TRUE</styled-content>
          <styled-content style="font-size:15px;color:#000000;">)</styled-content>
          <styled-content style="font-size:15px;color:#000000;">## [1] 6926.263</styled-content>
        </preformat>
      </p>
      <p>
        <bold>lakeMinorMajorRatio</bold>
      </p>
      <p>The ratio of the lake major axis length to the minor axis length is also known as the aspect ratio. Circular lakes have aspect ratios approaching 1 while thin-elongated lakes have aspect ratios approaching 0. If major and minor axis length have not already been added to the
<monospace>lakeMorpho</monospace> object, these are calculated. The
<monospace>addLine</monospace> argument adds the lines for the lake's minor and major axes to the
<monospace>lakeMorpho</monospace> object.</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">lakeMinorMajorRatio</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(example_lakeMorpho,</styled-content>
          <styled-content style="font-size:15px;color:#204A87;">addLine =</styled-content>
          <styled-content style="font-size:15px;color:#8F5902;">TRUE</styled-content>
          <styled-content style="font-size:15px;color:#000000;">)</styled-content>
          <styled-content style="font-size:15px;color:#000000;">## [1] 0.5263261</styled-content>
        </preformat>
      </p>
      <p>
        <bold>lakeShorelineDevelopment</bold>
      </p>
      <p>The shoreline development metric provides a measure of the complexity of the shoreline. It is a ratio of the perimeter of the lake to the perimeter of a circle of the same area. Values will be 1 or greater with value of 1 indicating a circular lake. This metric is used as an indicator of potential habitat
<sup><xref rid="ref-1" ref-type="bibr">1</xref>,
<xref rid="ref-28" ref-type="bibr">28</xref></sup>. It only requires a
<monospace>lakeMorpho</monospace> object as input.</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">lakeShorelineDevelopment</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(example_lakeMorpho)</styled-content>
          <styled-content style="font-size:15px;color:#000000;">## [1] 3.198502</styled-content>
        </preformat>
      </p>
      <p>
        <bold>lakeShorelineLength and lakeSurfaceArea</bold>
      </p>
      <p>Shoreline length is simply the total perimeter of the lake polygon and, as with all other functions, requires a
<monospace>lakeMorpho</monospace> object as input. To calculate the shoreline length:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">lakeShorelineLength</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(example_lakeMorpho)</styled-content>
          <styled-content style="font-size:15px;color:#000000;">## [1] 45991.38</styled-content>
        </preformat>
      </p>
      <p>Similarly, surface area for a lake is the total area of the lake polygon. It is calculated via:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">lakeSurfaceArea</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(example_lakeMorpho)</styled-content>
          <styled-content style="font-size:15px;color:#000000;">## [1] 16453180</styled-content>
        </preformat>
      </p>
      <p>
        <bold>lakeVolume</bold>
      </p>
      <p>The
<monospace>lakeVolume</monospace> function uses maximum lake depth (see lakeMaxDepth) and methods outlined by Hollister
<italic>et al.</italic>
<sup><xref rid="ref-9" ref-type="bibr">9</xref></sup> to estimate lake volume. The method assumes that the maximum in-lake distance (D
<sub>max</sub>) from the shoreline is also the deepest part of the lake (Z
<sub>max</sub>). The
<monospace>lakeVolume</monospace> function creates a raster of the in-lake distance to shoreline and converts those distances, using
<monospace>Z
<sub>max</sub>:D
<sub>max</sub></monospace>, to depths and then summing the volume of each pixel to estimate total lake volume.</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold">lakeVolume</styled-content>
          <styled-content style="font-size:15px;color:#000000;">(example_lakeMorpho)</styled-content>
          <styled-content style="font-size:15px;color:#000000;">## [1] 476297184</styled-content>
        </preformat>
      </p>
      <p>Similar to
<monospace>lakeMeanDepth</monospace>, there is a
<monospace>zmax</monospace> argument to be used for a known maximum lake depth.</p>
    </sec>
  </sec>
  <sec>
    <title>Use case</title>
    <p>A common application of
<monospace>lakemorpho</monospace> is to calculate the full suite of lake metrics for multiple lakes. This use case demonstrates how to do that with a commonly encountered GIS data file, the shapefile. To do this we iterate through the lakes, calculate metrics for each lake and include the metrics on an output shapefile. The data for this use case is from Rhode Island (
<xref ref-type="fig" rid="f3">Figure 3</xref>). The data for the lakes were downloaded from the Rhode Island Geographic Information Systems (RIGIS)
<sup><xref rid="ref-29" ref-type="bibr">29</xref></sup> and the elevation data are from Amazon Web Services Terrain Tiles via the
<monospace>elevatr</monospace> package
<sup><xref rid="ref-30" ref-type="bibr">30</xref></sup>.</p>
    <fig fig-type="figure" id="f3" orientation="portrait" position="anchor">
      <label>Figure 3. </label>
      <caption>
        <title>Map of lakes used in the case study example of the
<monospace>lakemorpho</monospace> package.</title>
      </caption>
      <graphic xlink:href="f1000research-6-13548-g0002"/>
    </fig>
    <sec>
      <title>Read in data</title>
      <p>This use case relies on the
<monospace>sp</monospace> and
<monospace>rgdal</monospace> packages for the spatial data handling. These are dependencies for
<monospace>lakemorpho</monospace>, thus no additional installs are required. To read in the data we utilized
<monospace>rgdal::readOGR</monospace> and read in the
<monospace>ri_lakes.shp</monospace> from the current directory. This file is available for download from
<ext-link ext-link-type="uri" xlink:href="https://github.com/USEPA/lakemorpho_manuscript/blob/master/ri_lakes.zip">https://github.com/USEPA/lakemorpho_manuscript/blob/master/ri_lakes.zip</ext-link>.</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#8F5902; font-style:italic;"># Load packages</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold;">library</styled-content>
          <styled-content style="font-size:15px;">(</styled-content>
          <styled-content style="font-size:15px;color:#4E9A06;">"sp"</styled-content>
          <styled-content style="font-size:15px;">)</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold;">library</styled-content>
          <styled-content style="font-size:15px;">(</styled-content>
          <styled-content style="font-size:15px;color:#4E9A06;">"rgdal"</styled-content>
          <styled-content style="font-size:15px;">)</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold;">library</styled-content>
          <styled-content style="font-size:15px;">(</styled-content>
          <styled-content style="font-size:15px;color:#4E9A06;">"lakemorpho"</styled-content>
          <styled-content style="font-size:15px;">)</styled-content>
        </preformat>
      </p>
      <p>
        <preformat><styled-content style="font-size:15px;color:#8F5902; font-style:italic;"># Read the shapefile and plot</styled-content><styled-content style="font-size:15px;">ri_lakes &lt;-</styled-content><styled-content style="font-size:15px;color:#204A87; font-weight:bold;">readOGR</styled-content>(
                        <styled-content style="font-size:15px;color:#4E9A06;">"."</styled-content><styled-content style="font-size:15px;">,</styled-content><styled-content style="font-size:15px;color:#4E9A06;">"ri_lakes"</styled-content><styled-content style="font-size:15px;">)</styled-content><styled-content style="font-size:15px;">## OGR data source with driver: ESRI Shapefile 
## Source: ".", layer: "ri_lakes"
## with 5 features
## It has 2 fields</styled-content></preformat>
      </p>
    </sec>
    <sec>
      <title>Iterate through lakes and calculate metrics</title>
      <p>In R, there are many ways to iterate. For simplicity and clarity we use a
<monospace>for</monospace> loop to iterate through all lakes and calculate the full suite of lake metrics with
<monospace>calcLakeMetrics</monospace>. We will utilize the
<monospace>elevatr</monospace> package which provides access to elevation data from various sources
<sup><xref rid="ref-30" ref-type="bibr">30</xref></sup>. In this example we will use the Amazon Web Services terrain tiles. The vertical elevation data are in meters and the Rhode Island lake data are projected in Rhode Island State Plane Feet, thus we will convert the elevation data into feet.</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold;">library</styled-content>
          <styled-content style="font-size:15px;">(elevatr)</styled-content>
          <styled-content style="font-size:15px;">output &lt;-</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold;">data.frame</styled-content>
          <styled-content style="font-size:15px;">()</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold;">for</styled-content>
          <styled-content style="font-size:15px;">(i</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold;">in seq_along</styled-content>
          <styled-content style="font-size:15px;">(ri_lakes)){</styled-content>
          <styled-content style="font-size:15px;">  dem &lt;-</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold;">get_elev_raster</styled-content>
          <styled-content style="font-size:15px;">(ri_lakes[i,],</styled-content>
          <styled-content style="font-size:15px;color:#204A87;">z =</styled-content>
          <styled-content style="font-size:15px;color:#0000CF;">12</styled-content>
          <styled-content style="font-size:15px;">,</styled-content>
          <styled-content style="font-size:15px;color:#204A87;">expand =</styled-content>
          <styled-content style="font-size:15px;color:#0000CF;">1000</styled-content>
          <styled-content style="font-size:15px;">,</styled-content>
          <styled-content style="font-size:15px;color:#204A87;">src =</styled-content>
          <styled-content style="font-size:15px;color:#4E9A06;">"aws"</styled-content>
          <styled-content style="font-size:15px;">)</styled-content>
          <styled-content style="font-size:15px;color:#8F5902; font-weight:bold;">*</styled-content>
          <styled-content style="font-size:15px;color:#0000CF;">3.281</styled-content>
          <styled-content style="font-size:15px;">  lmorph &lt;-</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold;">lakeSurroundTopo</styled-content>
          <styled-content style="font-size:15px;">(</styled-content>
          <styled-content style="font-size:15px;color:#204A87;">inLake = </styled-content>
          <styled-content style="font-size:15px;">ri_lakes[i,],</styled-content>
          <styled-content style="font-size:15px;color:#204A87;">inElev =</styled-content>
          <styled-content style="font-size:15px;">dem)</styled-content>
          <styled-content style="font-size:15px;">  lmetric &lt;-</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold;">calcLakeMetrics</styled-content>
          <styled-content style="font-size:15px;">(lmorph,</styled-content>
          <styled-content style="font-size:15px;color:#204A87;">bearing =</styled-content>
          <styled-content style="font-size:15px;color:#0000CF;"> 270</styled-content>
          <styled-content style="font-size:15px;">,</styled-content>
          <styled-content style="font-size:15px;color:#204A87;">pointDens =</styled-content>
          <styled-content style="font-size:15px;color:#0000CF;">100</styled-content>
          <styled-content style="font-size:15px;">)</styled-content>
          <styled-content style="font-size:15px;">  output &lt;-</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold;">rbind</styled-content>
          <styled-content style="font-size:15px;">(output,</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold;">                  data.frame</styled-content>
          <styled-content style="font-size:15px;">(</styled-content>
          <styled-content style="font-size:15px;color:#204A87;">NAME =</styled-content>
          <styled-content style="font-size:15px;">ri_lakes[i,]</styled-content>
          <styled-content style="font-size:15px;color:#8F5902; font-weight:bold;">$</styled-content>
          <styled-content style="font-size:15px;">NAME,</styled-content>
          <styled-content style="font-size:15px;color:#204A87; font-weight:bold;">                             data.frame</styled-content>
          <styled-content style="font-size:15px;">(lmetric)))</styled-content>
          <styled-content style="font-size:15px;">}</styled-content>
        </preformat>
      </p>
      <p>We can now merge the morphometry metrics back to the lake polygons.</p>
      <p>
        <preformat><styled-content style="font-size:15px;">ri_lakes_m &lt;-</styled-content><styled-content style="font-size:15px;color:#204A87; font-weight:bold;">merge</styled-content><styled-content style="font-size:15px;">(ri_lakes,output,</styled-content><styled-content style="font-size:15px;color:#204A87;">by=</styled-content><styled-content style="font-size:15px;color:#4E9A06;">"NAME"</styled-content>)

                        <styled-content style="font-size:15px;color:#204A87; font-weight:bold;">dplyr::tbl_df</styled-content><styled-content style="font-size:15px;">(ri_lakes_m)</styled-content><styled-content style="font-size:15px;">## # A tibble: 5 x 12
##                NAME   Acres surfaceArea shorelineLength
## *            &lt;fctr&gt;   &lt;dbl&gt;       &lt;dbl&gt;           &lt;dbl&gt;
## 1       Indian Lake  268.55    11698076        18857.94
## 2       Yawgoo Pond  144.37     6288693        10562.24
## 3       Worden Pond 1098.64    47856596        34494.32
## 4       Larkin Pond   43.85     1910010         5989.30
## 5 Hundred Acre Pond   87.64     3817524        15278.75
## # ... with 8 more variables: shorelineDevelopment &lt;dbl&gt;, maxDepth &lt;dbl&gt;,
## #   volume &lt;dbl&gt;, meanDepth &lt;dbl&gt;, maxLength &lt;dbl&gt;, maxWidth &lt;dbl&gt;,
## #   meanWidth &lt;dbl&gt;, fetch &lt;dbl&gt;</styled-content></preformat>
      </p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>The
<monospace>lakemorpho</monospace> package provides functions to calculate common lake morphometry metrics in R. For those conducting lake analyses in R this allows for streamlined analysis workflows. Also,
<monospace>lakemorpho</monospace> provides a foundation for additional metrics. For instance, it might be possible to combine hydrological methods for estimating stream flow into and out of lakes with lake volume and add a function for calculating residence time.</p>
    <p>Beyond adding additional metrics, more fundamental rewriting of the package may also be useful. For instance,
<monospace>lakemorpho</monospace> currently is built on top of the current spatial data standard for R,
<monospace>sp</monospace>. This allows a clean interface with many existing tools; however, it is likely that
<monospace>sp</monospace> will be replaced in the next several years by the
<monospace>sf</monospace> package
<sup><xref rid="ref-21" ref-type="bibr">21</xref>,
<xref rid="ref-31" ref-type="bibr">31</xref></sup>. Future versions of
<monospace>lakemorpho</monospace> might benefit from using the
<monospace>sf</monospace> tool chain and the "tidy data" framework
<sup><xref rid="ref-32" ref-type="bibr">32</xref></sup>.</p>
    <p>In summary,
<monospace>lakemorpho</monospace> provides limnologists and aquatic ecologists with a consistent framework in R for calculating a suite of the most common lake morphometry metrics. This paper outlines the currently available functions and provides an example through a typical use case of calculating many metrics for several lakes.</p>
  </sec>
  <sec>
    <title>Software availability</title>
    <p>The
<monospace>lakemorpho</monospace> version 1.1.0 package is currently available directly from the Comprehensive R Archive Network (CRAN) and may simply be installed and loaded in R via:</p>
    <p>
      <preformat>
        <styled-content style="font-size:15px;color:#204A87; font-weight:bold">install.packages</styled-content>
        <styled-content style="font-size:15px;color:#000000;">(</styled-content>
        <styled-content style="font-size:15px;color:#4E9A06;">'lakemorpho'</styled-content>
        <styled-content style="font-size:15px;color:#000000;">)</styled-content>
        <styled-content style="font-size:15px;color:#204A87; font-weight:bold">library</styled-content>
        <styled-content style="font-size:15px;color:#000000;">(</styled-content>
        <styled-content style="font-size:15px;color:#4E9A06;">'lakemorpho'</styled-content>
        <styled-content style="font-size:15px;color:#000000;">)</styled-content>
      </preformat>
    </p>
    <p>To access the help pages (including a version of this manuscript) use:</p>
    <p>
      <preformat>
        <styled-content style="font-size:15px;color:#204A87; font-weight:bold">help</styled-content>
        <styled-content style="font-size:15px;color:#000000;">(</styled-content>
        <styled-content style="font-size:15px;color:#204A87;">package=</styled-content>
        <styled-content style="font-size:15px;color:#4E9A06;">'lakemorpho'</styled-content>
        <styled-content style="font-size:15px;color:#000000;">)</styled-content>
      </preformat>
    </p>
    <p>There are tentative plans to continue developing new functions for
<monospace>lakemorpho</monospace> and these new features will be available first through the development version on GitHub at
<ext-link ext-link-type="uri" xlink:href="http://github.com/usepa/lakemorpho">http://github.com/usepa/lakemorpho</ext-link>.</p>
    <p>To install and load the development version requires use of the
<monospace>devtools</monospace> package. This may be done with:</p>
    <p>
      <preformat>
        <styled-content style="font-size:15px;color:#204A87; font-weight:bold">install.packages</styled-content>
        <styled-content style="font-size:15px;color:#000000;">(</styled-content>
        <styled-content style="font-size:15px;color:#4E9A06;">'devtools'</styled-content>
        <styled-content style="font-size:15px;color:#000000;">)</styled-content>
        <styled-content style="font-size:15px;color:#204A87; font-weight:bold">library</styled-content>
        <styled-content style="font-size:15px;color:#000000;">(</styled-content>
        <styled-content style="font-size:15px;color:#4E9A06;">'devtools'</styled-content>
        <styled-content style="font-size:15px;color:#000000;">)</styled-content>
        <styled-content style="font-size:15px;color:#204A87; font-weight:bold">install_github</styled-content>
        <styled-content style="font-size:15px;color:#000000;">(</styled-content>
        <styled-content style="font-size:15px;color:#4E9A06;">'USEPA/lakemorpho'</styled-content>
        <styled-content style="font-size:15px;color:#000000;">)</styled-content>
        <styled-content style="font-size:15px;color:#204A87; font-weight:bold">library</styled-content>
        <styled-content style="font-size:15px;color:#000000;">(lakemorpho)</styled-content>
      </preformat>
    </p>
    <p>Archived source code as at the time of publication:</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5281/zenodo.863051">http://doi.org/10.5281/zenodo.863051</ext-link>
      <sup>
        <xref rid="ref-33" ref-type="bibr">33</xref>
      </sup>
    </p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Stephen Shivers (ORISE), Betty Kreakie (US EPA, Atlantic Ecology Division), Bryan Milstead (US EPA, Atlantic Ecology Division), Joe LiVolsi (US EPA, Atlantic Ecology Division), Tim Gleason (US EPA, Atlantic Ecology Division), and Wayne Munns (US EPA, Atlantic Ecology Division) for constructive reviews of this paper. Special thanks to TBD for reviews of the submitted manuscript. The views expressed in this article are those of the authors and do not necessarily represent the views or policies of the U.S. Environmental Protection Agency. Any mention of trade names, products, or services does not imply an endorsement by the U.S. Government or the U.S. Environmental Protection Agency. The EPA does not endorse any commercial products, services, or enterprises. This contribution is identified by the tracking number ORD-022603 of the Atlantic Ecology Division, Office of Research and Development, National Health and Environmental Effects Research Laboratory, US Environmental Protection Agency.</p>
  </ack>
  <ref-list>
    <ref id="ref-1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wetzel</surname><given-names>R</given-names></name></person-group>:
<article-title>Limnology, 3 e. lake and river ecosystems</article-title>. Academic Press, California.<year>2001</year>;<fpage>850 p</fpage><ext-link ext-link-type="uri" xlink:href="https://books.google.co.in/books?id=no2hk5uPUcMC&amp;printsec=frontcover">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vollenweider</surname><given-names>RA</given-names></name></person-group>:
<article-title>Input-output models.</article-title><source><italic>Schweizerische Zeitschrift für Hydrologie.</italic></source><year>1975</year>;<volume>37</volume>(<issue>1</issue>):<fpage>53</fpage>–<lpage>84</lpage>.
<pub-id pub-id-type="doi">10.1007/BF02505178</pub-id></mixed-citation>
    </ref>
    <ref id="ref-3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Milstead</surname><given-names>WB</given-names></name><name><surname>Hollister</surname><given-names>JW</given-names></name><name><surname>Moore</surname><given-names>RB</given-names></name><etal/></person-group>:
<article-title>Estimating summer nutrient concentrations in Northeastern lakes from SPARROW load predictions and modeled lake depth and volume.</article-title><source><italic>PLoS One.</italic></source><year>2013</year>;<volume>8</volume>(<issue>11</issue>):<fpage>e81457</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pone.0081457</pub-id><!--<pub-id pub-id-type="pmcid">3834318</pub-id>--><?supplied-pmid 24260579?><pub-id pub-id-type="pmid">24260579</pub-id></mixed-citation>
    </ref>
    <ref id="ref-4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Genkai-Kato</surname><given-names>M</given-names></name><name><surname>Carpenter</surname><given-names>SR</given-names></name></person-group>:
<article-title>Eutrophication due to phosphorus recycling in relation to lake morphometry, temperature, and macrophytes.</article-title><source><italic>Ecology.</italic></source><year>2005</year>;<volume>86</volume>(<issue>1</issue>):<fpage>210</fpage>–<lpage>219</lpage>.
<pub-id pub-id-type="doi">10.1890/03-0545</pub-id></mixed-citation>
    </ref>
    <ref id="ref-5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scheffer</surname><given-names>M</given-names></name><name><surname>van Nes</surname><given-names>EH</given-names></name></person-group>:
<article-title>Shallow lakes theory revisited: Various alternative regimes driven by climate, nutrients, depth and lake size.</article-title><source><italic>Hydrobiologia.</italic></source><year>2007</year>;<volume>584</volume>(<issue>1</issue>):<fpage>455</fpage>–<lpage>466</lpage>.
<pub-id pub-id-type="doi">10.1007/s10750-007-0616-7</pub-id></mixed-citation>
    </ref>
    <ref id="ref-6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kalff</surname><given-names>J</given-names></name></person-group>:
<article-title>Limnology: Inland water ecosystems</article-title>. Prentice Hall New Jersey.<year>2002</year>;<fpage>592 p</fpage><ext-link ext-link-type="uri" xlink:href="https://books.google.co.in/books/about/Limnology.html?id=DzgUAQAAIAAJ">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-7">
      <label>7</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Welch</surname><given-names>P</given-names></name></person-group>:
<article-title>Limnology</article-title>. McGraw-Hill, New York.<year>1935</year><ext-link ext-link-type="uri" xlink:href="https://ia802608.us.archive.org/27/items/limnology030682mbp/limnology030682mbp.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-8">
      <label>8</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wetzel</surname><given-names>RG</given-names></name><name><surname>Likens</surname><given-names>G</given-names></name></person-group>:
<article-title>Limnological analyses</article-title>. 3rd editon. Springer Verlag, New York.<year>2000</year><pub-id pub-id-type="doi">10.1007/978-1-4757-3250-4</pub-id></mixed-citation>
    </ref>
    <ref id="ref-9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hollister</surname><given-names>J</given-names></name><name><surname>Milstead</surname><given-names>WB</given-names></name></person-group>:
<article-title>Using GIS to estimate lake volume from limited data.</article-title><source><italic>Lake and Reservoir Management.</italic></source><year>2010</year>;<volume>26</volume>(<issue>3</issue>):<fpage>194</fpage>–<lpage>199</lpage>.
<pub-id pub-id-type="doi">10.1080/07438141.2010.504321</pub-id></mixed-citation>
    </ref>
    <ref id="ref-10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soranno</surname><given-names>PA</given-names></name><name><surname>Bissell</surname><given-names>EG</given-names></name><name><surname>Cheruvelil</surname><given-names>KS</given-names></name><etal/></person-group>:
<article-title>Building a multi-scaled geospatial temporal ecology database from disparate data sources: fostering open science and data reuse.</article-title><source><italic>Gigascience.</italic></source><year>2015</year>;<volume>4</volume>:<fpage>28</fpage>.
<pub-id pub-id-type="doi">10.1186/s13742-015-0067-4</pub-id><!--<pub-id pub-id-type="pmcid">4488039</pub-id>--><?supplied-pmid 26140212?><pub-id pub-id-type="pmid">26140212</pub-id></mixed-citation>
    </ref>
    <ref id="ref-11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hollister</surname><given-names>JW</given-names></name><name><surname>Milstead</surname><given-names>WB</given-names></name><name><surname>Urrutia</surname><given-names>MA</given-names></name></person-group>:
<article-title>Predicting maximum lake depth from surrounding topography.</article-title><source><italic>PLoS One.</italic></source><year>2011</year>;<volume>6</volume>(<issue>9</issue>):<fpage>e25764</fpage>, Accessed 28 Jun 2013.
<pub-id pub-id-type="doi">10.1371/journal.pone.0025764</pub-id><!--<pub-id pub-id-type="pmcid">3184154</pub-id>--><?supplied-pmid 21984945?><pub-id pub-id-type="pmid">21984945</pub-id></mixed-citation>
    </ref>
    <ref id="ref-12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Messager</surname><given-names>ML</given-names></name><name><surname>Lehner</surname><given-names>B</given-names></name><name><surname>Grill</surname><given-names>G</given-names></name><etal/></person-group>:
<article-title>Estimating the volume and age of water stored in global lakes using a geo-statistical approach.</article-title><source><italic>Nat Commun.</italic></source><year>2016</year>;<fpage>7</fpage>:<fpage>13603</fpage>.
<pub-id pub-id-type="doi">10.1038/ncomms13603</pub-id><!--<pub-id pub-id-type="pmcid">5171767</pub-id>--><?supplied-pmid 27976671?><pub-id pub-id-type="pmid">27976671</pub-id></mixed-citation>
    </ref>
    <ref id="ref-13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oliver</surname><given-names>SK</given-names></name><name><surname>Soranno</surname><given-names>PA</given-names></name><name><surname>Fergus</surname><given-names>CE</given-names></name><etal/></person-group>:
<article-title>Prediction of lake depth across a 17-state region in the united states.</article-title><source><italic>Inland Waters.</italic></source><year>2016</year>;<volume>6</volume>:<fpage>314</fpage>–<lpage>324</lpage>.
<ext-link ext-link-type="uri" xlink:href="https://par.nsf.gov/servlets/purl/10025551">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-14">
      <label>14</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>USEPA</surname><given-names>U</given-names></name></person-group>:
<article-title>National hydrography dataset plus–NHDPlus</article-title>.<year>2005</year><ext-link ext-link-type="uri" xlink:href="https://www.fws.gov/r5gomp/gom/nhd-gom/metadata.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-15">
      <label>15</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gesch</surname><given-names>D</given-names></name><name><surname>Evans</surname><given-names>G</given-names></name><name><surname>Mauck</surname><given-names>J</given-names></name><etal/></person-group>:
<article-title>The national map-elevation: US geological survey fact sheet 2009–3053</article-title>.<year>2009</year>;<fpage>4 p</fpage><ext-link ext-link-type="uri" xlink:href="https://pubs.usgs.gov/fs/2009/3053/pdf/fs2009_3053.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-16">
      <label>16</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hollister</surname><given-names>JW</given-names></name><name><surname>Stachelek</surname><given-names>J</given-names></name></person-group>:
<article-title>Lakemorpho: Lake morphometry in R</article-title>.<year>2016</year><ext-link ext-link-type="uri" xlink:href="http://CRAN.R-project.org/package=lakemorpho">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-17">
      <label>17</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bivand</surname><given-names>R</given-names></name><name><surname>Lewin-Koh</surname><given-names>N</given-names></name></person-group>:
<article-title>Maptools: Tools for reading and handling spatial objects</article-title>.<year>2014</year><ext-link ext-link-type="uri" xlink:href="http://CRAN.R-project.org/package=maptools">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-18">
      <label>18</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bivand</surname><given-names>R</given-names></name><name><surname>Keitt</surname><given-names>T</given-names></name><name><surname>Rowlingson</surname><given-names>B</given-names></name></person-group>:
<article-title>Rgdal: Bindings for the geospatial data abstraction library</article-title>.<year>2014</year><ext-link ext-link-type="uri" xlink:href="http://CRAN.R-project.org/package=rgdal">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-19">
      <label>19</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bivand</surname><given-names>R</given-names></name><name><surname>Rundel</surname><given-names>C</given-names></name></person-group>:
<article-title>Rgeos: Interface to geometry engine - open source (geos)</article-title>.<year>2014</year><ext-link ext-link-type="uri" xlink:href="http://CRAN.R-project.org/package=rgeos">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-20">
      <label>20</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bivand</surname><given-names>RS</given-names></name><name><surname>Pebesma</surname><given-names>EJ</given-names></name><name><surname>Gómez-Rubio</surname><given-names>V</given-names></name></person-group>:
<article-title>Applied spatial data analysis with R</article-title>. Springer.<year>2008</year><pub-id pub-id-type="doi">10.1007/978-0-387-78171-6</pub-id></mixed-citation>
    </ref>
    <ref id="ref-21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pebesma</surname><given-names>EJ</given-names></name><name><surname>Bivand</surname><given-names>RS</given-names></name></person-group>:
<article-title>Classes and methods for spatial data in R.</article-title><source><italic>R news.</italic></source><year>2005</year>;<volume>5</volume>:<fpage>9</fpage>–<lpage>13</lpage>.
<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/sp/vignettes/intro_sp.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-22">
      <label>22</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hijmans</surname><given-names>RJ</given-names></name></person-group>:
<article-title>Raster: Raster: Geographic data analysis and modeling</article-title>.<year>2014</year><ext-link ext-link-type="uri" xlink:href="http://CRAN.R-project.org/package=raster">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-23">
      <label>23</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hijmans</surname><given-names>RJ</given-names></name></person-group>:
<article-title>Geosphere: Spherical trigonometry</article-title>.<year>2014</year><ext-link ext-link-type="uri" xlink:href="http://CRAN.R-project.org/package=geosphere">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-24">
      <label>24</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Team</surname><given-names>GD</given-names></name></person-group>:
<article-title>GDAL - geospatial data abstraction library, version 1.9.2</article-title>. Open Source Geospatial Foundation.<year>2012</year><ext-link ext-link-type="uri" xlink:href="http://www.gdal.org">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-25">
      <label>25</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Foundation</surname><given-names>OSG</given-names></name></person-group>:
<article-title>GEOS - geometry engine - open source</article-title>. Open Source Geospatial Foundation.<year>2013</year><ext-link ext-link-type="uri" xlink:href="http://trac.osgeo.org/geos/">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-26">
      <label>26</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Iliffe</surname><given-names>J</given-names></name><name><surname>Lott</surname><given-names>R</given-names></name></person-group>:
<article-title>Datums and map projections for remote sensing, gis and surveying</article-title>. 2nd ed. Whittles Publishing.<year>2008</year><ext-link ext-link-type="uri" xlink:href="https://books.google.co.in/books/about/Datums_and_map_projections_for_remote_se.html?id=u_4RAQAAIAAJ&amp;redir_esc=y">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-27">
      <label>27</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Scheffer</surname><given-names>M</given-names></name></person-group>:
<article-title>Ecology of shallow lakes</article-title>. Springer Science &amp; Business Media.<year>2004</year>
<pub-id pub-id-type="doi">10.1007/978-1-4020-3154-0</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref-28">
      <label>28</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>LAKEWATCH</surname><given-names>F</given-names></name></person-group>:
<article-title>Department of fisheries and aquatic sciences, a beginner’s guide to water management-lake morphometry</article-title>.<year>2001</year><ext-link ext-link-type="uri" xlink:href="http://lakewatch.ifas.ufl.edu/pubs/circulars/104_MORPHOMET%E2%80%A6Y_2nd_ED_2004Red.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-29">
      <label>29</label>
      <mixed-citation publication-type="book"><collab>(RIGIS) RIGIS: </collab><article-title>Lakes and ponds (1: 5000); lakes5k10</article-title>.<year>2010</year><ext-link ext-link-type="uri" xlink:href="https://www.arcgis.com/home/item.html?id=e82442adfc4e47508530cb88afb11f08">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-30">
      <label>30</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hollister</surname><given-names>J</given-names></name><name><surname>Shah</surname><given-names>T</given-names></name></person-group>:
<article-title>Elevatr: Access elevation data from various apis</article-title>.<year>2017</year><ext-link ext-link-type="uri" xlink:href="http://github.com/usepa/elevatr">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-31">
      <label>31</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Pebesma</surname><given-names>E</given-names></name></person-group>:
<article-title>Sf: Simple features for R</article-title>.<year>2017</year><ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=sf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-32">
      <label>32</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wickham</surname><given-names>H</given-names></name></person-group>:
<article-title>Tidy data</article-title>.
<source><italic>J Stat Softw.</italic></source><year>2014</year>;<volume>59</volume>:<fpage>1</fpage>–<lpage>23</lpage>.
<ext-link ext-link-type="uri" xlink:href="https://www.jstatsoft.org/v059/i10">Reference Source</ext-link><pub-id pub-id-type="pmid">26917999</pub-id></mixed-citation>
    </ref>
    <ref id="ref-33">
      <label>33</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hollister</surname><given-names>JW</given-names></name><name><surname>Stachelek</surname><given-names>J</given-names></name><name><surname>Ortiz</surname><given-names>J</given-names></name></person-group>:
<article-title>jhollist/lakemorpho_manuscript: Submission version for F1000Research.</article-title><source><italic>Zenodo.</italic></source><year>2017</year><ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5281/zenodo.863051">Data Source</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="report27253" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.13548.r27253</article-id>
    <title-group>
      <article-title>Referee response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Winslow</surname>
          <given-names>Luke A.</given-names>
        </name>
        <xref ref-type="aff" rid="r27253a1">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-8602-5510</contrib-id>
      </contrib>
      <aff id="r27253a1"><label>1</label>Rensselaer Polytechnic Institute, Troy, NY, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>11</month>
      <year>2017</year>
    </pub-date>
    <related-article id="d35e2822" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.12512.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>In this manuscript, the Hollister and Stachelek outline the functionality and use of the lakemorpho R package. The package includes a number of tools that allow users to calculate morphological, including a some generally complex metrics that are not easy to recreate using existing functionality in available spatial packages. Packages such as these go a long way to preventing the constant re-inventing of the wheel by graduate students and other researchers in generating code to calculate these metrics. This package is a significant contribution to the field and this paper does a reasonable job of describing the package.</p>
    <p> I have a few minor suggestions that I think will improve the manuscript and applicability of the package.</p>
    <p> Some of these metrics are not immediately intuitive to most readers. It would be super useful to have a figure, maybe with a series of panels, that shows the reader what each of these metrics are on some example lakes where it matters. This would be great to have accompanying the section “Lake Morphology Functions”.</p>
    <p> There needs to be a description of what the option ‘pointDens’ means. Does it have units? Is it relative to the projection or independent of it? Further, while this may be difficult, would it be possible to show the sensitivity of output metrics to pointDens for complex lakes? It would be great to know if there was a reliable metric that could be used, perhaps a default informed by the total lake area or SDF? Such a default or heuristic would be really useful to the purported use here (calculations on a large number of less-studied lakes). Basically, if I use this on 1 million lakes at the continental scale, I really need an informed way to pick that pointDens value.</p>
    <p> Right now, this package has depth-related calculations for lakes which do not have observed bathymetry. It would be really useful if the package could be generalized to use observed bathymetry rasters in the calculation of max and mean depth. Such data are increasingly available (e.g.
<ext-link ext-link-type="uri" xlink:href="http://bathybase.org">http://bathybase.org</ext-link>).</p>
    <p> A lot of 1-D hydrodynamic models need an estimate of the hypsometric curve. It would be great if an additional function could be included that would use either an estimated bathymetry or a provided bathy raster (see earlier comment) and output the lake’s hypsometric curve. Very useful in hydrodynamic modeling.  </p>
    <p> Here are a few additional publications you might consider referencing. At the moment, references to existing lake morphological literature is a little thin. Especially check out other work of Håkanson as he’s a morphology master.</p>
    <p> Håkanson, L. (2005), The Importance of Lake Morphometry for the Structure and Function of Lakes
<sup><xref rid="rep-ref-27253-1" ref-type="bibr">1</xref></sup>
</p>
    <p> Dunalska, J. a. (2011), Impact of morphometric and catchment variables on summer organic carbon richness in deep temperate lakes
<sup><xref rid="rep-ref-27253-2" ref-type="bibr">2</xref></sup>
</p>
    <p> Read, E. K. et al. (2015), The importance of lake-specific characteristics for water quality across the continental United States
<sup><xref rid="rep-ref-27253-3" ref-type="bibr">3</xref></sup>
</p>
    <p> I look forward to using this useful tool!</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="rep-ref-27253-1">
        <label>1</label>
        <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Håkanson</surname><given-names>L</given-names></name></person-group>:
<article-title>The Importance of Lake Morphometry for the Structureand Function of Lakes</article-title>.
<source><italic>International Review of Hydrobiology</italic></source>.<year>2005</year>;<volume>90</volume>(<issue>4</issue>) :
<elocation-id>10.1002/iroh.200410775</elocation-id><fpage>433</fpage>-<lpage>461</lpage><pub-id pub-id-type="doi">10.1002/iroh.200410775</pub-id></mixed-citation>
      </ref>
      <ref id="rep-ref-27253-2">
        <label>2</label>
        <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunalska</surname><given-names>J</given-names></name></person-group>:
<article-title>Impact of morphometric and catchment variables on summer organic carbon richness in deep temperate lakes</article-title>.
<source><italic>Knowledge and Management of Aquatic Ecosystems</italic></source>.<year>2011</year>;
<elocation-id>10.1051/kmae/2011043</elocation-id><pub-id pub-id-type="doi">10.1051/kmae/2011043</pub-id></mixed-citation>
      </ref>
      <ref id="rep-ref-27253-3">
        <label>3</label>
        <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Read</surname><given-names>E</given-names></name><name><surname>Patil</surname><given-names>V</given-names></name><name><surname>Oliver</surname><given-names>S</given-names></name><name><surname>Hetherington</surname><given-names>A</given-names></name><name><surname>Brentrup</surname><given-names>J</given-names></name><name><surname>Zwart</surname><given-names>J</given-names></name><name><surname>Winters</surname><given-names>K</given-names></name><name><surname>Corman</surname><given-names>J</given-names></name><name><surname>Nodine</surname><given-names>E</given-names></name><name><surname>Woolway</surname><given-names>R</given-names></name><name><surname>Dugan</surname><given-names>H</given-names></name><name><surname>Jaimes</surname><given-names>A</given-names></name><name><surname>Santoso</surname><given-names>A</given-names></name><name><surname>Hong</surname><given-names>G</given-names></name><name><surname>Winslow</surname><given-names>L</given-names></name><name><surname>Hanson</surname><given-names>P</given-names></name><name><surname>Weathers</surname><given-names>K</given-names></name></person-group>:
<article-title>The importance of lake-specific characteristics for water quality across the continental United States</article-title>.
<source><italic>Ecological Applications</italic></source>.<year>2015</year>;<volume>25</volume>(<issue>4</issue>) :
<elocation-id>10.1890/14-0935.1</elocation-id><fpage>943</fpage>-<lpage>955</lpage><pub-id pub-id-type="doi">10.1890/14-0935.1</pub-id></mixed-citation>
      </ref>
    </ref-list>
  </back>
</sub-article>
<sub-article id="report26223" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.13548.r26223</article-id>
    <title-group>
      <article-title>Referee response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Oliver</surname>
          <given-names>Samantha K.</given-names>
        </name>
        <xref ref-type="aff" rid="r26223a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r26223a1"><label>1</label>Center for Limnology, University of Wisconsin-Madison, Madison, WI, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <related-article id="d35e3121" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.12512.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The
<italic>lakemorpho </italic>package fills a need in the limnological community (and beyond) for easily deriving lake morphometry metrics in a repeatable and documented way. The package is relatively simple to use and understand, and implements common, published methods for calculate lake morphometry metrics. Additionally, the authors implement a tool for predicting lake depth, which is a difficult lake parameter to obtain. I only a have minor suggestions for changes in the language and documentation for the package. Most of these changes are related to the order in which ideas are presented in the paper. While reading the paper, I had several questions that were later answered, but I think the authors can avoid the questions altogether by simply rearranging some of the text (see specific comments below). Additionally, I think it’s important for the authors to include an error estimate of the lake depth predictions – prediction error is notoriously high for lake depth, and I think it’s important for users to understand this. I recommend this paper for publication after the following changes are considered – and I look forward to using the package!</p>
    <p> Minor revisions:</p>
    <p> - Recommend removing “…and for students of limnology, some of the first lessons are centered around a typical suite of metrics and how to calculate them.” from the first sentence and instead lead with morphometry affecting water quality.</p>
    <p> - What is a “suitably large area around the lake”? 50m, 100m?</p>
    <p> - I think you can remove bulleted list from the first paragraph of the
<italic>lakeMorpho</italic> and
<italic> lakeSurroundTopo</italic> section. It only roughly introduces pieces of the
<italic>lakeMorpho</italic> object, and left me with more questions than answers (e.g., previous question RE: suitably large area around the lake which you answer later). You answered all of the questions immediately in the next paragraphs, which left me feeling like you could just leave out the list, or use it as a summary list at the end of the section.</p>
    <p> - “If metrics for multiple lakes are required they will need to be passed to the suite of lakemorpho functions separately.” This seems to be in direct contradiction with the purpose of the package – which is to derive morphometry metrics for a large number of lakes. It</p>
    <p> becomes clear later in the text that you address this with a use-case. I think you should state this up front – “Although each lake must be passed through lakemorpho functions separately, we provide a use case to show how a user can easily calculate these metrics for several lakes”.</p>
    <p> - This sentence is really confusing: “First, the elevation data must be of a large enough extent so that the surrounding topography does not include land area outside that extent (i.e. would return NA values)”. My interpretation is: “The extent of the elevation data must be equal to or greater than the extent of the area surrounding the lake that you are summarizing”. I think this is confusing because you are not using “surrounding topography” in a general sense but as a defined area that is part of the user input. Perhaps use a different naming convention? You’re describing the surrounding topography (through summarizing the elevation data) within a specified area. Perhaps elevation = your fabric and buffer area = your stencil? This is adopting language from the USGS geoknife package. It may not make sense to use fabric since you only have one type of raster input, but I think stencil is a nice word to use for your variable buffer/watershed area. I see you call this “surround” in the lakemorpho object, so that may be a good option as well.</p>
    <p> - Maybe give some error measurement from the max depth predictions in the Hollister paper? I think it’s important for users to understand there is substantial error in these models.</p>
    <p> - I think you should briefly describe the Hollister methods for calculating zmax in this paper. Also, the mean depth calculation is unclear from the text. How is volume calculated? By estimating depth at each pixel of the lake? Do you know anything about the error of these estimates? Ok – now I see that you give a good description of volume. Maybe move volume up earlier (before mean depth)?</p>
    <p> - In the lake shoreline development section: “This metric is used as an indicator of potential habitat” It is also used an indicator of potential terrestrial-aquatic linkages
<sup><xref rid="rep-ref-26223-1" ref-type="bibr">1</xref></sup>.</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="rep-ref-26223-1">
        <label>1</label>
        <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Winslow</surname><given-names>L</given-names></name><name><surname>Read</surname><given-names>J</given-names></name><name><surname>Hanson</surname><given-names>P</given-names></name><name><surname>Stanley</surname><given-names>E</given-names></name></person-group>:
<article-title>Lake shoreline in the contiguous United States: quantity, distribution and sensitivity to observation resolution</article-title>.
<source><italic>Freshwater Biology</italic></source>.<year>2014</year>;<volume>59</volume>(<issue>2</issue>) :
<elocation-id>10.1111/fwb.12258</elocation-id><fpage>213</fpage>-<lpage>223</lpage><pub-id pub-id-type="doi">10.1111/fwb.12258</pub-id></mixed-citation>
      </ref>
    </ref-list>
  </back>
</sub-article>
