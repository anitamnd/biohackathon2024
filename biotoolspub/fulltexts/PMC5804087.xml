<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5804087</article-id>
    <article-id pub-id-type="publisher-id">1388</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-018-1388-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Kourami: graph-guided assembly for novel human leukocyte antigen allele discovery</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Heewook</given-names>
        </name>
        <address>
          <email>heewookl@cs.cmu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Kingsford</surname>
          <given-names>Carl</given-names>
        </name>
        <address>
          <email>carlk@cs.cmu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2097 0344</institution-id><institution-id institution-id-type="GRID">grid.147455.6</institution-id><institution>Computational Biology Department, School of Computer Science, </institution><institution>Carnegie Mellon University, </institution></institution-wrap>Pittsburgh, PA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>2</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>7</day>
      <month>2</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>19</volume>
    <elocation-id>16</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>5</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>1</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p>Accurate typing of human leukocyte antigen (HLA) is important because HLA genes play important roles in immune responses and disease genesis. Previously available computational methods are database-matching approaches and their outputs are inherently limited by the completeness of already known types, making them unsuitable for discovery of novel alleles. We have developed a graph-guided assembly technique for classical HLA genes, which can construct allele sequences given high-coverage whole-genome sequencing data. Our method delivers highly accurate HLA typing, comparable to the current state-of-the-art methods. Using various data, we also demonstrate that our method can type novel alleles.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s13059-018-1388-2) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000936</institution-id>
            <institution>Gordon and Betty Moore Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>GBMF4554</award-id>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000143</institution-id>
            <institution>Division of Computing and Communication Foundations</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CCF-1256087</award-id>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000143</institution-id>
            <institution>Division of Computing and Communication Foundations</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CCF-1319998</award-id>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>National Human Genome Research Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01HG007104</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2018</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Human leukocyte antigen (HLA) genes are crucial in the regulation of the immune system as they encode for the major histocompatibility complex (MHC) consisting of cell surface proteins that control the adaptive immune response. HLA genes are also known to play important roles in transplant rejection as well as infectious and autoimmune diseases [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref>]. For these reasons, accurate HLA typing is important both in clinical and research settings. HLA typing is considered challenging because of the hyper-polymorphic nature of the HLA region in the human genome. Such high polymorphism in the HLA region is thought to be maintained by strong balancing selection promoting genetic diversity [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. Especially with personal genome sequencing becoming widely common, better computational methods are needed to provide rapid and inexpensive typing with high accuracy.</p>
    <p>Traditionally, HLA typing or categorization was done by laborious serology-based methods that screen for HLA antibodies in a donor/receiver pair. With the birth of DNA sequencing and the polymerase chain reaction (PCR), molecular typing assays, such as specific oligonucleotide probe hybridization, sequence-specific primer amplification, and sequence-based typing (SBT), have been developed [<xref ref-type="bibr" rid="CR7">7</xref>]. The SBT method can be used with either Sanger sequencing or next-generation sequencing (NGS) techniques. By using specific primers for target enrichment prior to sequencing, SBT delivers accurate and reliable typing of HLA alleles. However, all of the above molecular typing assays require a specially designed set of probes or primers.</p>
    <p>With the increasing availability of personal whole-genome sequencing (WGS) services, the availability of accurate computational HLA typing methods that do not require additional experiments can be valuable. Challenges in computational HLA typing are mainly driven by the high level of polymorphism found in the HLA region in the human genome. Over 30 genes are maintained in the IPD-IMGT/HLA database [<xref ref-type="bibr" rid="CR8">8</xref>] and six to eight classical HLA genes (HLA-A, -B, -C, -DQA, -DQB, and -DRB) are routinely used for HLA typing in clinical settings. More than 15,000 known alleles (just for these classical genes) have been reported in the database and the number of alleles is growing rapidly (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Also, the known alleles share high sequence similarities, where many alleles differ just by a base-pair substitution. Thus, it is challenging to pinpoint correctly an individual’s HLA types among the known alleles using WGS data [<xref ref-type="bibr" rid="CR9">9</xref>].
<fig id="Fig1"><label>Fig. 1</label><caption><p>The number of alleles in the IPD-IMGT/HLA database by year from 1999 to 2016. The database releases updates four times a year (January, April, July, and October) and the plot is based on the number of alleles from all the April releases reported on the statistics page of the IPD-IMGT/HLA website (<ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/ipd/imgt/hla/stats.html">http: //www.ebi.ac.uk/ipd/imgt/hla/stats.html</ext-link>). HLA human leukocyte antigen</p></caption><graphic xlink:href="13059_2018_1388_Fig1_HTML" id="MO1"/></fig></p>
    <p>Previously developed enrichment-free computational methods can use WGS, whole-exome sequencing (WES), or transcriptome sequencing (RNA-seq) without the use of HLA-enriched data, unlike SBT. However, many do not provide typing accuracy comparable to what SBT provides [<xref ref-type="bibr" rid="CR10">10</xref>], with the exception of a recently developed method, HLA*PRG [<xref ref-type="bibr" rid="CR11">11</xref>]. However, the high accuracy of HLA*PRG comes at the cost of speed.</p>
    <p>These computational methods either use one or both of two major techniques (alignment and assembly) to compare reads accurately when correcting HLA genes and inferring allele types. For computational HLA typing of NGS data, an alignment-based method was first developed for HLA typing using targeted sequencing of class I genes [<xref ref-type="bibr" rid="CR12">12</xref>]. This method incorporated the Bayesian genotyping information from a widely used toolkit GATK [<xref ref-type="bibr" rid="CR13">13</xref>] and additionally modeled the phasing by considering pairs of adjacent variant sites. Other computational typing methods that can work with enrichment-free data were developed later. Alignment-based methods, such as seq2HLA [<xref ref-type="bibr" rid="CR14">14</xref>], HLAforest [<xref ref-type="bibr" rid="CR15">15</xref>], and PHLAT [<xref ref-type="bibr" rid="CR16">16</xref>], first attempt to assign NGS reads correctly to HLA loci using various stringent quality filtering procedures to selectively discard erroneous reads with low alignment scores, then use probabilistic variant-calling approaches similar to that in [<xref ref-type="bibr" rid="CR12">12</xref>] to infer the closest matching allele in the database. Unlike most alignment-based methods, HLA-VBSeq [<xref ref-type="bibr" rid="CR17">17</xref>] uses variational Bayesian inference to assign reads correctly to alleles based on alignment, as done in solutions to the RNA-seq quantification problem [<xref ref-type="bibr" rid="CR18">18</xref>]. OptiType [<xref ref-type="bibr" rid="CR19">19</xref>] also uses alignment; however, it formulates the typing problem as an optimization problem via integer linear programming (ILP), where the objective is to find a solution set of alleles such that the number of mapped reads is maximized with constraints that each locus requires at least one allele (homozygous) and at most two alleles (heterozygous). The recently published xHLA [<xref ref-type="bibr" rid="CR20">20</xref>] also adopts OptiType’s ILP formulation but uses protein-level alignment of the typing exons as it focuses on four-digit resolution typing (protein-level). After solving the optimization problem restricted to just the typing exons, it uses iterative refinement steps to select alleles that further maximize the number of mapped reads when considering all exons. Assembly-based methods, such as HLAminer [<xref ref-type="bibr" rid="CR21">21</xref>] and HLAreporter [<xref ref-type="bibr" rid="CR22">22</xref>], first construct longer-than-read contigs using de novo assembly techniques and search for best matches among known alleles. Direct assembly of haplotypes by traditionally available de novo or reference-based assemblers is severely confounded by the high level of polymorphisms. Often, assembly-based methods combine the techniques used in alignment-based methods. For example, HLAreporter first uses read alignment to known alleles and identifies reads that are likely from HLA regions prior to its assembly step. Most recently, HLA*PRG [<xref ref-type="bibr" rid="CR11">11</xref>] improved the accuracy of alignment-based methods by representing the database alleles as graphs and using a more sensitive alignment on the graphs. It first aligns extracted reads likely from the HLA region to population reference graphs [<xref ref-type="bibr" rid="CR23">23</xref>] that encode all known alleles and it outputs the most likely alleles from the database.</p>
    <p>One common aspect of the enrichment-free computational HLA typing methods is that they are all primarily driven by the <italic>finding-the-nearest-match</italic> paradigm. Their goal is to find the best-matching alleles to HLA genes of a test individual in a preexisting database of known entries. Given the sequencing data of an individual, such a typing scheme outputs the best-matching alleles for each HLA gene. This typing strategy is limited by the completeness of the collection of known alleles, as it cannot detect novel alleles missing in the database of known types. We collectively refer to these approaches as <italic>database-matching</italic> methods. Novel alleles can possibly have protein-coding changes that may have a profound impact for organ transplantation and disease association. One might argue that there are already many known alleles and that the chance of finding novel alleles is low. However, the number of known alleles in the IPD-IMGT/HLA database is still increasing rapidly (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). There is continuing effort among immunogenetics communities to study rare and novel alleles. For example, the <italic>International HLA and Immunogenetics Workshop</italic> has been organizing projects to investigate and collect rare and novel alleles since the 15th workshop in 2002. Immunogenetics-related journals, such as the <italic>International Journal of Immunogenetics</italic> and <italic>HLA</italic> (formerly known as <italic>Tissue Antigens</italic>), have a dedicated section where new alleles are announced in every issue.</p>
    <p>For these reasons, it is important to be able to recover HLA sequences at 1-bp resolution to enable novel allele discovery as done in SBT. To achieve this goal, we present a graph-guided assembly technique called Kourami that constructs full sequences for the peptide-binding domain (exons 2 and 3 for class I and exon 2 for class II HLA genes, which are regions typed by the SBT methods) using a modified partial-order graph (POG) [<xref ref-type="bibr" rid="CR24">24</xref>] as a guide. The graph representation compactly captures variant regions among related sequences to take advantage of known alleles, and it also provides a framework in which to incorporate information from the sequencing reads to encode novel alleles.</p>
    <p>In fact, graphs have long been used to represent varying regions. For example, de Bruijn graphs [<xref ref-type="bibr" rid="CR25">25</xref>] and string graphs [<xref ref-type="bibr" rid="CR26">26</xref>] have been extensively used in fragment assembly. More recently, graph-based representations of populations of genomes, which are also related to POG, have been an active research area [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR27">27</xref>–<xref ref-type="bibr" rid="CR30">30</xref>]. Our method is the first that directly assembles both haplotypes of HLA genes rather than inferring the best-matching alleles in the database. For known alleles, we show that Kourami can correctly type with high accuracy (&gt;98%), equaling that of the state-of-the-art database-matching method, across various WGS data sets, such as simulated data, Illumina Platinum Genomes, and high coverage WGS from the 1000 Genomes Project. At the same time, Kourami takes only a fraction of the time compared to other available methods with a moderate use of memory.</p>
    <p>Kourami is the first HLA typer to be able to assemble novel alleles that do not appear in the database. It does this by treating the HLA typing problem as an instance of graph-guided assembly, where the known alleles are combined into a graph that is used to guide the assembly of new alleles. Kourami, therefore, also represents an early example of how a population of reference sequences can be used during genome assembly. We systematically show that Kourami is very accurate in constructing novel alleles by performing leave-one-out experiments where a known allele is artificially removed from the allele database. Kourami is able to reconstruct 98% of these alleles perfectly.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>HLA typing nomenclature</title>
      <p>The current HLA allele nomenclature [<xref ref-type="bibr" rid="CR31">31</xref>] uses a hierarchical numbering system with four major levels of hierarchies. From the highest to the lowest category, it annotates allele groups (two-digit resolution), protein sequence (four-digit resolution), exon sequence (six-digit resolution), and intron sequence (eight-digit resolution). For example, if two alleles encode an identical protein, they will have the same numbers for the first two levels of (four-digit) hierarchies. In practice, HLA typing is often carried out at either the protein or exon level. Furthermore, the current gold standard, SBT, types just the exons that are responsible for encoding the peptide-binding domain (exons 2 and 3 for class I genes and exon 2 for class II genes). Using only the subset of exons creates ambiguous alleles where two or more alleles share an identical sequence over these exons but differ in other regions. These ambiguous sequences are grouped as a six-digit G allele. Similarly, four-digit P grouping is used for the alleles that share the same amino acid sequence over these exons. Our method provides a fully assembled sequence covering these exons and also outputs a six-digit G resolution typing result by selecting known alleles that have the smallest edit distance to the assembled sequences. Like many other HLA tools, we focus on the routinely typed classical genes (HLA-A, -B, -C, -DQA1, -DQB1, and -DRB1).</p>
    </sec>
    <sec id="Sec4">
      <title>Overview of method</title>
      <p>Our method takes advantage of POGs to capture all known alleles and further modifies the graph to include variants found in the sequencing data so that the graph include the paths of true alleles. An overview of our method is illustrated in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, and the major steps are labeled from (a) to (e). More details are given in “<xref rid="Sec14" ref-type="sec">Methods</xref>”. We first create a comprehensive reference panel from a combined multiple sequence alignment (MSA) of both full-length and exon-only known alleles for each HLA locus (step a). Reads mapped to all known HLA loci in the human reference genome (GRCh38) are extracted (step b) and aligned to the comprehensive reference panel (step c). Gene-wise POGs are constructed using the combined MSAs. The alignments of the extracted reads are projected onto the graphs so that each read alignment is stored as a path in the graphs and the read depths on the edges naturally become edge weights (step d). When these read- or read-pair-backed paths connect two or more neighboring heterozygous sites of two alleles, they provide phasing information. During the alignment projection, the graphs are modified by adding nodes and edges to incorporate differences found by the alignment, such as substitutions and indels. Note that a sequence of an allele is encoded as a path through the entire graph. Finally, using the weighted graphs with alignment paths, we formulate the problem of constructing the best pair of HLA allele sequences as finding the pair of paths through the graph. When finding the pair, we consider consistent phasing information from the reads and coverage using base quality scores. Additionally, the pair of paths may be identical, to permit homozygous alleles.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Overview of our method. <bold>a</bold> A gene-wise MSA is obtained from the IMGT/HLA database. The reads aligning to HLA regions are extracted <bold>b</bold> from the input BAM and they are realigned <bold>c</bold> to the sequences in the MSA. <bold>d</bold> A POG is constructed from MSA and further modified via alignment projection. <bold>e</bold> Haplotype assembly of two alleles is obtained by finding two paths (drawn in red and blue; overlap in purple) through the graph. DB database, HLA human leukocyte antigen, MSA multiple sequence alignment, POG partial-order graph, WGS whole-genome sequencing</p></caption><graphic xlink:href="13059_2018_1388_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Simulation</title>
      <p>To check that our method performs well, we tested it on simulated data (see “<xref rid="Sec14" ref-type="sec">Methods</xref>” section). For each of the six HLA genes, two alleles from the set of full-length gene sequences in the IPD-IMGT/HLA database were randomly chosen. We repeated this for a total of 100 replicates, resulting in 200 randomly selected alleles across all replicates. For each replicate, we simulated 50 × coverage (25 × for each haplotype) of paired-end WGS data. We compared Kourami, PHLAT, and HLA*PRG on the simulated data. Our method was evaluated using all 1200 alleles (2 alleles × 6 genes × 100 replicates). However, not all alleles could be used for the evaluation of PHLAT and HLA*PRG, as both tools use their own digested format of the HLA database, which is built in, so that the content of the database cannot be updated by a user. The database versions used by PHLAT and HLA*PRG are older compared to the version (v3.24.0) used for Kourami. Given a set of WGS data of an individual with an allele that is not in the database built into PHLAT and HLA*PRG, both tools will fail to type the allele correctly as they are designed strictly to find the nearest match among the known alleles. For this reason, the evaluations of PHLAT and HLA*PRG are based only on the subset of simulated alleles (1011 for PHLAT and 990 for HLA*PRG) that are in the database versions they use. For PHLAT, four-digit P resolution was used and six-digit G resolution was used for HLA*PRG and Kourami for evaluation.</p>
      <p>Table <xref rid="Tab1" ref-type="table">1</xref> shows the number of correctly inferred alleles as well as the accuracy for each HLA gene tested. For our method, we report both the typing and assembly accuracy. We define the assembly accuracy as the percentage of assembled alleles with sequence identical to the true allele sequence (no mismatch or indel). Even when an assembled allele is not identical to its expected true sequence, the typing of the allele may be correct if the closest sequence (minimum edit distance) in the database is the true allele. PHLAT achieves 93.6% accuracy across all HLA genes tested (89.8% for class I and 96.6% for class II). HLA*PRG and our method perform equally well, achieving 99.8% typing accuracy across all genes (99.5% for class I and 100% for class II). Additionally, Kourami achieves 99.3% assembly accuracy.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>HLA typing performance on simulated data</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="3">Class I</th><th align="left" colspan="3">Class II</th></tr><tr><th align="left"/><th align="left">A</th><th align="left">B</th><th align="left">C</th><th align="left">DQA1</th><th align="left">DQB1</th><th align="left">DRB1</th></tr></thead><tbody><tr><td align="left">PHLAT (four-digit P)</td><td align="left">0.85 (147/172)</td><td align="left">0.91 (135/149)</td><td align="left">0.95 (122/129)</td><td align="left">0.93 (178/191)</td><td align="left">0.98 (169/173)</td><td align="left">0.99 (195/197)</td></tr><tr><td align="left">HLA*PRG (six-digit G)</td><td align="left">1.00 (174/174)</td><td align="left">0.99 (143/144)</td><td align="left">0.99 (115/116)</td><td align="left">1.00 (197/197)</td><td align="left">1.00 (159/159)</td><td align="left">1.00 (200/200)</td></tr><tr><td align="left">Kourami (type)</td><td align="left">1.00 (199/200)</td><td align="left">1.00 (200/200)</td><td align="left">0.99 (198/200)</td><td align="left">1.00 (200/200)</td><td align="left">1.00 (200/200)</td><td align="left">1.00 (200/200)</td></tr><tr><td align="left">Kourami (sequence)</td><td align="left">0.99 (198/200)</td><td align="left">1.00 (200/200)</td><td align="left">0.98 (195/200)</td><td align="left">1.00 (200/200)</td><td align="left">1.00 (199/200)</td><td align="left">1.00 (200/200)</td></tr></tbody></table><table-wrap-foot><p>Accuracy is shown as a fraction. The fraction of the number of correctly typed alleles and the total number of alleles tested are shown in parentheses</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec6">
      <title>Novel allele detection</title>
      <p>The major benefit of our method is that it can assemble novel alleles across the typing exons. Therefore, its typing ability is not limited by known alleles as is the case with other database-matching methods. Unlike these methods, Kourami uses the known alleles in the input database only to construct the HLA graph that serves as a template for the reference-based assembly and it does not discriminate between the paths that encode known alleles and novel alleles.</p>
      <p>To demonstrate its ability to assemble novel alleles, we evaluated Kourami across various data for which the ground truth is known. We tested with simulated data and real data with previously validated HLA types (NA12878–NA12891–NA12892 Platinum trio and 11 samples from the 1000 Genomes Project) with a modified database of known alleles so that Kourami is not aware of the true allele sequences. For each sample, we randomly selected one allele from each of the six HLA genes and removed the selected alleles from the reference MSAs (full-length and exon-only) provided by release 3.24.0 of the IPD/IMGT-HLA database. When removing an allele, we removed all entries in the G group to which the allele belongs. The entire list of alleles removed from each individual is shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S1, S2, and S3. We removed corresponding rows for the alleles from both the full-length MSA and exon-only MSA and obtained a new reference panel by combining the modified MSAs. The number of G group alleles removed is shown in Table <xref rid="Tab2" ref-type="table">2</xref>. The extracted paired-end reads were aligned to the newly obtained reference panel, and the BAM files obtained were used as inputs to Kourami. Note that this experiment cannot be done with PHLAT and HLA*PRG, as the database of known alleles is built into the tools.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Novel allele recovery</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Simulation</th><th align="left">Platinum trio</th><th align="left">1000 Genomes</th></tr></thead><tbody><tr><td align="left">Number of removed alleles</td><td align="left">596</td><td align="left">15</td><td align="left">60</td></tr><tr><td align="left">Number of recovered alleles</td><td align="left">586</td><td align="left">15</td><td align="left">59</td></tr><tr><td align="left">Percentage of recovered alleles</td><td align="left">98.3</td><td align="left">100</td><td align="left">98.3</td></tr></tbody></table></table-wrap></p>
      <p>Kourami correctly assembled 98.3%, 100%, and 98.3% of the removed alleles for the simulation data, the Platinum trio, and 11 samples from the 1000 Genomes Project, respectively (Table <xref rid="Tab2" ref-type="table">2</xref>). Among 1000 Genomes samples, the only incorrectly assembled allele (supposed to be B*38:01:01) had a 1-bp difference from the correct sequence. When the 59 correctly assembled allele sequences are aligned to the newly constructed reference panel, many alleles were aligned equally well to a large number of known alleles. For example, C*05:01:01 alleles aligned to 122 other alleles with just 1-bp substitution. Among them, a significant portion contained base differences that result in protein-coding changes in typing exons. This shows that the database-matching methods such as PHLAT and HLA*PRG cannot be relied upon to select a closely related allele sequence in the presence of novel alleles. The database-matching methods often provide quality metrics for inferred alleles. Whether such quality metrics are effective when novel alleles are involved is still an open question. Recently, this was explored by the authors of HLA*PRG, and it was shown that their metrics were not effective in distinguishing novel alleles [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    </sec>
    <sec id="Sec7">
      <title>Illumina Platinum Genomes</title>
      <sec id="Sec8">
        <title>Platinum trio with validated results</title>
        <p>Among the Illumina Platinum Genomes, we first ran Kourami, PHLAT, and HLA*PRG on the trio (NA12891, NA12878, and NA12892) with the previously validated four-digit HLA types for six HLA genes (HLA-A, -B, -C, -DQA1, -DQB1, and -DRB1) [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. Kourami and HLA*PRG perfectly called the correct types whereas PHLAT missed a call in the HLA-C gene in NA12891. In a previously published article [<xref ref-type="bibr" rid="CR11">11</xref>], PHLAT called all 12 alleles correctly and the difference may be because in our evaluation, all software was run on the set of reads that aligned to the extended MHC (xMHC)/HLA region of chromosome 6 and unmapped reads. Extracting a subset of reads by read mapping location and including unmapped reads are common for reducing the computational time, and a similar technique was used in [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
      </sec>
      <sec id="Sec9">
        <title>Trio consistency and inferred haplotypes</title>
        <p>The pedigree of Illumina Platinum Genomes includes many third-generation offspring and only the top right-hand trio in Fig. <xref rid="Fig3" ref-type="fig">3</xref> has previously validated HLA typing results. Since this trio includes the mother (NA12878) of all third-generation offspring, if HLA typing results are trio-consistent across all trios and all second-generation haplotypes are present in one of the children, we can theoretically infer the HLA haplotypes of the second-generation male (NA12877) as well as the half of HLA haplotypes in the first-generation individuals (NA12889 and NA12890).
<fig id="Fig3"><label>Fig. 3</label><caption><p>CEPH/Utah pedigree 1463. The family pedigree of Illumina Platinum Genomes is shown</p></caption><graphic xlink:href="13059_2018_1388_Fig3_HTML" id="MO3"/></fig></p>
        <p>We tested all three methods to determine whether predictions are trio-consistent across all trios (trio consistency is shown in Table <xref rid="Tab3" ref-type="table">3</xref>). Kourami and HLA*PRG agreed on all 204 alleles at six-digit G resolution and the predicted alleles were trio-consistent. The inferred haplotypes across HLA genes (intra-gene phased) are shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. PHLAT’s predictions were trio-consistent only for HLA-C and HLA-DQB1 when evaluated at four-digit P resolution, and additionally for HLA-A when evaluated at two-digit resolution. Although, we do not know the true HLA types for the rest of the 14 individuals, it is very likely that the predicted HLA types are correct given that all typing results are consistent. Low trio-consistency ratios for PHLAT in Table <xref rid="Tab3" ref-type="table">3</xref> are mainly due to mistyped alleles in HLA-A, HLA-B, and HLA-DRB1 for the NA12877 individual (which affects all 12 trios being evaluated). Trio-consistency measures the level of consistency rather than accuracy. PHLAT’s overall typing accuracy (four-digit) on all of the Platinum individuals (17 members) is 0.907, assuming the HLA types inferred by Kourami and HLA*PRG are true. Assuming the predicted HLA types for the pedigree are correct, no recombination seems to have occurred, leaving no disruption in ancestral haplotypes. In Fig. <xref rid="Fig4" ref-type="fig">4</xref>, we labeled the haplotypes that originated from the first-generation members as paternal grandfather 1 or 2 (PGF1 or PGF2), paternal grandmother 1 or 2 (PGM1 or PGM2), maternal grandfather 1 or 2 (MGF1 or, MGF2), and maternal grandmother 1 or 2 (MGM1 or MGM2). The haplotypes that are passed to second-generation individuals are numbered 1 to keep the numbering consistent in the third generation. Among 11 third-generation offspring, all four possible pairs of haplotypes were observed (two PGF+MGF, two PGF+MGM, four PGM+MGF, and three PGM+MGM).
<fig id="Fig4"><label>Fig. 4</label><caption><p>HLA haplotypes in the Illumina Platinum pedigree. Shown is the Illumina Platinum pedigree with the predicted HLA haplotype information. Four haplotypes (PGF1, PGM1, MGF1, and MGM1) of the second generation are intermixed in third-generation offspring. Only the haplotypes that are passed down to the second and third generations are colored. A haplotype drawn on the left is always inherited from the father. For the first generation, this information is missing and the haplotypes that are passed to the next generation are arbitrarily drawn on the left</p></caption><graphic xlink:href="13059_2018_1388_Fig4_HTML" id="MO4"/></fig>
<table-wrap id="Tab3"><label>Table 3</label><caption><p>Trio consistency over 12 trios in Platinum Genomes</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="3">Class I</th><th align="left" colspan="3">Class II</th></tr><tr><th align="left"/><th align="left">A</th><th align="left">B</th><th align="left">C</th><th align="left">DQA1</th><th align="left">DQB1</th><th align="left">DRB1</th></tr></thead><tbody><tr><td align="left">PHLAT (two-digit)</td><td align="left">1.00 (24/24)</td><td align="left">0.71 (17/24)</td><td align="left">1.00 (24/24)</td><td align="left">0.79 (19/24)</td><td align="left">1.00 (24/24)</td><td align="left">0.96 (23/24)</td></tr><tr><td align="left">PHLAT (four-digit P)</td><td align="left">0.67 (16/24)</td><td align="left">0.42 (10/24)</td><td align="left">1.00 (24/24)</td><td align="left">0.79 (19/24)</td><td align="left">1.00 (24/24)</td><td align="left">0.46 (11/24)</td></tr><tr><td align="left">HLA*PRG (six-digit G)</td><td align="left">1.00 (24/24)</td><td align="left">1.00 (24/24)</td><td align="left">1.00 (24/24)</td><td align="left">1.00 (24/24)</td><td align="left">1.00 (24/24)</td><td align="left">1.00 (24/24)</td></tr><tr><td align="left">
Kourami
</td><td align="left">1.00 (24/24)</td><td align="left">1.00 (24/24)</td><td align="left">1.00 (24/24)</td><td align="left">1.00 (24/24)</td><td align="left">1.00 (24/24)</td><td align="left">1.00 (24/24)</td></tr></tbody></table><table-wrap-foot><p>Trio consistency is shown as a fraction. The number of consistent alleles is shown as a fraction in parentheses</p></table-wrap-foot></table-wrap></p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Genomes</title>
      <p>We tested all three methods on this data set and the result is summarized in Table <xref rid="Tab4" ref-type="table">4</xref>. PHLAT called 93 out of 122 alleles correctly, resulting in 76% accuracy when evaluated at four-digit P resolution, and 89% when evaluated at two-digit resolution. The results for HLA*PRG were consistent with what has previously been reported [<xref ref-type="bibr" rid="CR11">11</xref>], resulting in one error (99.2% accuracy). Our method correctly called all of the alleles without any differences in bases. Note that the total number of alleles tested for DQA1 is 12 instead of 22 (2 alleles × 11 individuals) because the validation data for 1000 Genomes [<xref ref-type="bibr" rid="CR32">32</xref>] does not report DQA1 types. DQA1 type validation is only available for six individuals [<xref ref-type="bibr" rid="CR12">12</xref>].
<table-wrap id="Tab4"><label>Table 4</label><caption><p>HLA typing performance on 11 individuals from the 1000 Genomes Project</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="3">Class I</th><th align="left" colspan="3">Class II</th></tr><tr><th align="left"/><th align="left">A</th><th align="left">B</th><th align="left">C</th><th align="left">DQA1</th><th align="left">DQB1</th><th align="left">DRB1</th></tr></thead><tbody><tr><td align="left">PHLAT (two-digit)</td><td align="left">0.82 (18/22)</td><td align="left">0.82 (18/22)</td><td align="left">0.91 (20/22)</td><td align="left">0.83 (10/12)</td><td align="left">1.00 (22/22)</td><td align="left">0.95 (21/22)</td></tr><tr><td align="left">PHLAT (four-digit P)</td><td align="left">0.68 (15/22)</td><td align="left">0.55 (12/22)</td><td align="left">0.77 (17/22)</td><td align="left">0.83 (10/12)</td><td align="left">0.95 (21/22)</td><td align="left">0.82 (18/22)</td></tr><tr><td align="left">HLA*PRG (six-digit G)</td><td align="left">1.00 (22/22)</td><td align="left">1.00 (22/22)</td><td align="left">1.00 (22/22)</td><td align="left">1.00 (12/12)</td><td align="left">1.00 (22/22)</td><td align="left">0.95 (21/22)</td></tr><tr><td align="left">Kourami (six-digit G)</td><td align="left">1.00 (22/22)</td><td align="left">1.00 (22/22)</td><td align="left">1.00 (22/22)</td><td align="left">1.00 (12/12)</td><td align="left">1.00 (22/22)</td><td align="left">1.00 (22/22)</td></tr></tbody></table><table-wrap-foot><p>Accuracy is shown as a fraction. The fraction of the number of correctly typed alleles and the total number of alleles tested are shown in parentheses</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec11">
      <title>CPU and memory usage</title>
      <p>Kourami is able to assemble and type HLA alleles given WGS data in a fraction of the time compared to the state-of-art methods such as PHLAT and HLA*PRG with a moderate use of memory. We compared the CPU and memory usage using the WGS of NA12878 from Platinum Genomes data (2 × 101 bp, 55 ×). All tests were run on the input of the reads aligning to the xMHC region and unmapped reads. HLA*PRG was the slowest, taking 54.62 CPU hours, while PHLAT took 10.73 CPU hours and Kourami took only 0.09 CPU hours (611 × speedup compared to HLA*PRG). HLA*PRG required the most amount of memory, consuming peak memory of 78.9 Gbytes, while PHLAT and Kourami used 3.6 Gbytes and 4.3 Gbytes, respectively. HLA*PRG requires many more CPU hours and a larger amount of memory because of the expensive dynamic-programming-based alignment to the graph. Kourami relies on fast NGS aligners to align reads against known alleles first and projects the alignment obtained to the HLA graph to reduce the computational time significantly without sacrificing assembly or typing accuracy.</p>
    </sec>
  </sec>
  <sec id="Sec12" sec-type="discussion">
    <title>Discussion</title>
    <p>We have shown that our HLA assembly method can accurately reconstruct both haplotypes that span the typing exons of HLA genes using a graph representation of known alleles as a guide. The haplotype sequences produced can be used successfully for HLA typing given high coverage (&gt;30-fold) paired-end WGS data. WGS carried out for another analysis can be used to type an individual’s HLA types without requiring another experiment (SBT or other molecular assays).</p>
    <p>Notably, the ability to discover novel alleles from the highly accurate HLA assembly is achieved by using a flexible graph structure to represent all known alleles and allowing systematic modification to encode variants present in reads. This unique ability is instrumental in both research and clinical settings. Importantly, previously available computational methods using untargeted sequencing data cannot discover novel alleles because they are designed to find the best-matching allele among the known alleles.</p>
    <p>The ability to discover novel alleles is especially beneficial when studying an understudied group of individuals harboring many novel alleles, such as African populations, which are known to exhibit a higher level of genetic diversity [<xref ref-type="bibr" rid="CR33">33</xref>] compared to other ethnic populations. Disease pressure in a population causes a positive and balancing selection of HLA alleles, producing high diversity [<xref ref-type="bibr" rid="CR34">34</xref>].</p>
    <p>Especially with the continuously decreasing cost of obtaining a personal genome, personal WGS data will only become more widely available, and our method can deliver accurate HLA typing without additional experiments and cost. Also, Kourami is able to assemble and type at six-digit G resolution in a fraction of the time compared to other methods with a moderate amount of memory usage.</p>
    <p>One limitation of our method is that it primarily supports high-coverage WGS as it needs enough reads to cover both haplotypes for each typing locus, and may not work as well on other NGS assays, such as WES or RNA-seq data. Since WES is being used widely, as the cost for WES is lower compared to WGS, it is useful to be able to type HLA genes using WES. To assess Kourami’s ability to work with WES data, we tested Kourami on 29 HapMap individuals [<xref ref-type="bibr" rid="CR35">35</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4). It was able to assemble and type 284 alleles out of 345 alleles with previously confirmed types. Kourami did not output an assembled sequence or typing results for the other 61 alleles as some regions of these alleles were not covered by reads, causing the graph to be disconnected within the typing exons. Among the 284 alleles that were assembled, Kourami was able to assemble and type 269 alleles correctly, achieving 94.7% accuracy. Among the 15 erroneous calls, seven were called as homozygous alleles instead of heterozygous. Reference allele bias due to capture bias may be the direct cause for erroneous homozygous calls. It is a known bias in WES along with other biases, such as GC bias. Moreover, coverage fluctuations have been reported [<xref ref-type="bibr" rid="CR36">36</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]. Collectively, these can cause a decrease in effectiveness in detecting variants when using WES compared to WGS [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>].</p>
    <p>Additionally, Kourami requires high-coverage WGS data to ensure accurate HLA assembly or typing. We randomly sampled coverages of 20 ×, 25 ×, 30 ×, 35 ×, and 40 × for five replicates from each of the Platinum Genomes and the 1000 Genomes, and tested Kourami on these samples. Its accuracy is shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5. The accuracy was high at 35 × and 40 × coverages, being above 0.97 for both data sets. The accuracy stayed respectable down to 25 × coverage (0.94) for Platinum Genomes and down to 30 × for 1000 Genomes (0.94). At 20 × coverage, the accuracy for both data sets dropped below 0.90 (0.87 for Platinum and 0.83 for 1000 Genomes across the HLA genes). This should not be a surprise, as haplotype-resolved assemblies of human genomes used ≈100× coverage of NGS data [<xref ref-type="bibr" rid="CR39">39</xref>, <xref ref-type="bibr" rid="CR40">40</xref>]. The database-matching state-of-the-art HLA*PRG was shown to be more stable, even at 20 × coverage [<xref ref-type="bibr" rid="CR11">11</xref>], indicating that database-matching techniques are more sensitive when high-coverage sequencing data are not available. It is known that accurate assembly or genotyping using NGS data with short read lengths requires high sequencing coverage, especially for human genome resequencing [<xref ref-type="bibr" rid="CR41">41</xref>, <xref ref-type="bibr" rid="CR42">42</xref>]. Overall, the 1000 Genomes samples had lower accuracy compared to the Platinum Genomes samples, resulting in the largest difference in accuracy at the lowest coverage setting of 20 × (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5). Sample-specific accuracies across different coverage settings are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1 (Platinum Genomes) and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2 (1000 Genomes). The larger dips in accuracy for 30 × and below coverage settings observed in the 1000 Genomes samples are largely contributed by the HG01112, NA19625, and NA20502 samples. The longer Illumina reads (2 × 250 bp) used in 1000 Genomes samples are known to be more error prone, exhibiting increasingly higher error rates towards the 3<sup>′</sup> end of the reads [<xref ref-type="bibr" rid="CR43">43</xref>, <xref ref-type="bibr" rid="CR44">44</xref>] and this may be why the accuracy is more sensitive to the changes in coverage for the 1000 Genomes data set.</p>
    <p>One of the main reasons for the requirement of high-coverage WGS data by Kourami is because the lower the coverage, the higher the chance for an allele-specific path to have a region with a local drop in coverage, resulting in a prohibitively low number of reads covering the region. This can be difficult for assembly methods. To investigate the effect of a local drop in coverage on the accuracy of Kourami, we extracted the minimum depth across the entire allele path for each allele call and investigated the fraction of incorrect calls that occur at various minimum depths (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S3 for Platinum Genomes and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S4 for 1000 Genomes). As expected, a higher fraction of calls made at smaller minimum depth were incorrect. Minimum depths of 1 and 2 caused Kourami to make mistakes. With a coverage of 30 × or higher, the minimum depth rarely plunged to 1 or 2, allowing Kourami to assemble alleles accurately.</p>
    <p>In a typical HLA typing experiment, only a few classical HLA genes are typed, even though there are other classical HLA genes as well as non-classical HLA genes, which have also been shown to be disease-associated [<xref ref-type="bibr" rid="CR45">45</xref>, <xref ref-type="bibr" rid="CR46">46</xref>]. There may be clinical and research importance in typing other HLA genes in addition to the six classical genes that Kourami mainly assembles. Since Kourami’s framework is sufficiently general to run on the additional HLA loci, we tested Kourami on 11 additional HLA genes by looking at trio-consistency for the Platinum trio and the Yoruban trio from 1000 Genomes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6). For the Platinum trio, we found all of the typing results to be trio-consistent. However, there were four loci where the assembled sequences were not identical to the typed allele at the sequence level. For HLA-H, HLA-J, and HLA-L genes, the mismatches to the typed database alleles were consistent across the trio, indicating that there may be novel allele sequences for these loci. For HLA-F, the child (NA12878) had a 1-bp mismatch to the corresponding allele of her parents. For the Yoruban trio, we also found all of the typed alleles to be trio-consistent. Like the Platinum trio, HLA-J and HLA-L alleles across the trio had consistent sequences but there were mismatches to the closest alleles in the database. HLA-F had a discrepancy of a 1-bp mismatch between the child (NA19240) and the parental alleles.</p>
    <p>To validate Kourami further, we typed three additional individuals from the 1000 Genomes Project that were not benchmarked in [<xref ref-type="bibr" rid="CR11">11</xref>] and a Korean individual, AK1 [<xref ref-type="bibr" rid="CR40">40</xref>]. We tested Kourami, HLA*PRG, and PHLAT on these additional data. For these 1000 Genomes samples, we tested five validated loci (HLA-A, -B, -C, -DQB1, and -DRB1). For AK1, we tested six loci (by adding locus HLA-DQA1). Out of 42 alleles tested, PHLAT did not give a typing result for HLA-C on AK1 data and achieved an accuracy of 0.88 (35/40). All 42 calls were correct for both Kourami and HLA*PRG. One of the HLA-B alleles of the HG00268 individual that Kourami assembled had a single-nucleotide difference, although the typing was correct. For the AK1 genome, Kourami and HLA*PRG typed all six alleles correctly for the three additional validated loci (HLA-DRB3, -DPA1, and -DPB1).</p>
  </sec>
  <sec id="Sec13" sec-type="conclusion">
    <title>Conclusion</title>
    <p>The highly accurate results from Kourami signify the recent advances in handling genetic variation using graph structures to encode variations found in multiple reference genomes [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR27">27</xref>–<xref ref-type="bibr" rid="CR29">29</xref>]. Specifically, in Kourami, the minimal representation of a POG allows the consistent graph modification via alignment projection and this in turn enables the capture of novel alleles as paths through the graph. At the same time, this reduces computational time greatly without sacrificing accuracy. Such improvements are necessary when used in high-demand clinical settings, although it may take some time for WGS-based typing to be widely used. Our approach can also be extended as a general method of using graph structures to guide the reference-based assembly of high-diversity gene families.</p>
  </sec>
  <sec id="Sec14">
    <title>Methods</title>
    <sec id="Sec15">
      <title>Input alignment and extraction of HLA reads</title>
      <p>Kourami takes alignment of WGS to the human genome as an input in BAM format. For many experiments used here, we used pre-computed alignments downloaded from the European Bioinformatics Institute and Google Cloud Platform. If there were missing alignment files, we followed the 1000 Genomes procedures (see the GRCh38DH alignment “readme” file available from the 1000 Genome FTP server) to align reads using BWA-kit v0.7.15 [<xref ref-type="bibr" rid="CR47">47</xref>] and further processed the BAM files using other tools, such as BioBamBam [<xref ref-type="bibr" rid="CR48">48</xref>] and GATK [<xref ref-type="bibr" rid="CR13">13</xref>].</p>
      <p>From the alignments, we extracted paired-end reads aligned to all known HLA loci in chromosome 6, alternate sequences of xMHC regions, and HLA sequences (the complete set of coordinates used is in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7) included in the human reference genome (hs38DH packaged in BWA-kit v0.7.15). In the GRCh38 assembly, regions that exhibit sufficient variability are represented in the primary chromosomal sequence as well as the alternate sequence loci scaffolds.</p>
    </sec>
    <sec id="Sec16">
      <title>Known HLA alleles and construction of a comprehensive reference panel</title>
      <p>Immuno Polymorphism Database (IPD) periodically updates known HLA alleles in the IPD-IMGT/HLA database [<xref ref-type="bibr" rid="CR8">8</xref>]. IPD-IMGT/HLA Release 3.24.0 (April 2016) was used for all experiments here. A detailed breakdown of the numbers of alleles included in this release is shown in Table <xref rid="Tab5" ref-type="table">5</xref>. The other methods compared here use earlier versions of the database because the content of the database is built into their software, and there is no way to update or swap their databases at the user level. Using a later version of the database does not give advantages as long as the earlier version also contains the true alleles of the individual tested.
<table-wrap id="Tab5"><label>Table 5</label><caption><p>Number of known HLA alleles used</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="2">Genes</th><th align="left">Full-length</th><th align="left">Total</th></tr><tr><th align="left"/><th align="left"/><th align="left">(exonic + full-length)</th><th align="left"/></tr></thead><tbody><tr><td align="left">Class I</td><td align="left">A</td><td align="left">218</td><td align="left">3399</td></tr><tr><td align="left"/><td align="left">B</td><td align="left">337</td><td align="left">4242</td></tr><tr><td align="left"/><td align="left">C</td><td align="left">301</td><td align="left">2950</td></tr><tr><td align="left">Class II</td><td align="left">DQA1</td><td align="left">45</td><td align="left">69</td></tr><tr><td align="left"/><td align="left">DQB1</td><td align="left">27</td><td align="left">911</td></tr><tr><td align="left"/><td align="left">DRB1</td><td align="left">40</td><td align="left">1883</td></tr></tbody></table><table-wrap-foot><p>Release 3.24.0</p><p>Full-length denotes the total of number full-length alleles in the release and total number includes the full-length alleles and the alleles with only exon sequences reported</p></table-wrap-foot></table-wrap></p>
      <p>Many alleles in the database have only partial sequences, often just covering the few exons responsible for the peptide-binding domain of HLA genes (Table <xref rid="Tab5" ref-type="table">5</xref>). For this reason, the IPD provides a set of pre-computed MSAs of full-length alleles (<italic>M</italic><sub>gene</sub>) and the coding regions (<italic>M</italic><sub>coding</sub>) separately for each HLA gene. Like HLA*PRG [<xref ref-type="bibr" rid="CR11">11</xref>], for each HLA gene, we combine these two MSAs by aligning them at corresponding columns to obtain a comprehensive reference panel of known alleles. This can help in recruiting reads that span intron–exon junctions. The combined MSA (<italic>M</italic><sub>panel</sub>) has the same number of rows as <italic>M</italic><sub>coding</sub>. The number of columns in <italic>M</italic><sub>panel</sub> is equal to the sum of the number of columns in <italic>M</italic><sub>coding</sub> and the number of intronic columns in <italic>M</italic><sub>gene</sub>. For each row in <italic>M</italic><sub>coding</sub>, if the allele for the row has a corresponding row in <italic>M</italic><sub>gene</sub>, intronic columns are inserted into <italic>M</italic><sub>coding</sub>, otherwise, intronic columns of the reference allele in <italic>M</italic><sub>gene</sub> are inserted.</p>
      <p>Non-polymorphic HLA genes DQA2 and DQB2 are paralogous copies of DQA1 and DQB1. They are often regarded as being poorly polymorphic. In addition to the HLA genes that are included in the IPD-IMGT/HLA database, DQA2 and DQB2 were added to the reference panel as decoys to filter out reads that originated from them and aligned incorrectly to other class II genes. In our analysis, we noticed that reads from DQA2 or DQB2 can make the assembly of typing exons of class II genes difficult, as previously reported [<xref ref-type="bibr" rid="CR16">16</xref>].</p>
    </sec>
    <sec id="Sec17">
      <title>HLA graph construction</title>
      <p>To capture all information contained in <italic>M</italic><sub>panel</sub> in a minimal manner as well as to allow flexibility to enable novel sequence discovery, we use POGs, a compact graphical representation for MSA [<xref ref-type="bibr" rid="CR24">24</xref>]. From each <italic>M</italic><sub>panel</sub>, we can directly construct a gene-specific POG similar to those typically used in MSA [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR49">49</xref>]. An example of a MSA of three known sequences (<italic>M</italic><sub>panel</sub>) is shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>a. Each sequence is first drawn as a chain of vertices connected by directed edges (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b), where each vertex <italic>v</italic><sub><italic>i</italic></sub> represents a base symbol <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$b_{v_{i}}$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2018_1388_Article_IEq1.gif"/></alternatives></inline-formula> (<inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$b_{v_{i}} \in $\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∈</mml:mo></mml:math><inline-graphic xlink:href="13059_2018_1388_Article_IEq2.gif"/></alternatives></inline-formula> {A,C,G,T,N,-}) and is positioned at column <italic>i</italic> in the graph. For each column, vertices with an identical base symbol at a column are merged as a single vertex and duplicate edges are removed (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c,d). The gap symbol (-) is used to restrict edges to connect vertices only from consecutive columns in the input MSA. An edge between two vertices (<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$e_{v_{i}, v_{i+1}}$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2018_1388_Article_IEq3.gif"/></alternatives></inline-formula>) exists if <italic>M</italic><sub>panel</sub> has a row with consecutive bases <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$b_{v_{i}}$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2018_1388_Article_IEq4.gif"/></alternatives></inline-formula> and <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$b_{v_{i+1}}$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2018_1388_Article_IEq5.gif"/></alternatives></inline-formula> at columns <italic>i</italic> and <italic>i</italic>+1. Note that this graph contains at least the same number of paths as the number of rows in <italic>M</italic><sub>panel</sub> used to construct the graph. The graph often encodes a larger number of paths and this flexibility is the foundation that allows us to model this family of sequences and capture novel alleles. For example, a simple graph shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref><xref rid="Fig5" ref-type="fig">d</xref>encodes all sequences in the given MSA as well as AGGT-A, ACGTCA, and ACCTCA. Each path through the constructed graph encodes a possible allele.
<fig id="Fig5"><label>Fig. 5</label><caption><p>MSA to construction of a partial-order graph for HLA assembly. Given a pre-computed MSA (<bold>a</bold>), each sequence is constructed as a chain of vertices connected by directed edges. Corresponding positional vertices are aligned vertically (<bold>b</bold>). For each column, redundant vertices are grouped together, drawn within dotted boxes in (<bold>c</bold>). When they are merged, the corresponding partial-order graph (<bold>d</bold>) is obtained. HLA human leukocyte antigen, MSA multiple sequence alignment</p></caption><graphic xlink:href="13059_2018_1388_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec18">
      <title>Modification of the HLA graph via alignment projection</title>
      <p>Consider an example novel allele sequence, AGCTCA. It is easy to see that there is no path encoding such an allele in the HLA graph shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>d. In this example, simply adding an edge from the vertex G at column 2 to the vertex C at column 3 is the only modification needed for the graph to include the path that encodes the novel allele. If a novel allele exists in the data, there must be sequencing reads that contain the differences the novel allele has compared to known alleles. Assuming the sequence divergence is small enough for pairwise alignment of the read and a known allele to capture the differences, we can obtain the novel variants. For this reason, we further modify the HLA graph to include additional paths that encode for novel alleles in a test individual. We achieve this by modifying the previously constructed HLA graph by projecting the alignments of the reads likely coming from HLA region to known HLA genes.</p>
      <p>We first align the extracted reads to the set of reference panel sequences obtained from <italic>M</italic><sub>panel</sub> using BWA (v0.7.15-r1140) [<xref ref-type="bibr" rid="CR47">47</xref>]. The linear alignments obtained are then projected onto gene-specific POGs. For example, if a read is mapped to the HLA-A gene, then the alignment is projected onto the HLA graph of the gene. Given a read <italic>r</italic>, a subsequence <italic>h</italic> of a known allele <italic>H</italic>, and a pairwise alignment of <italic>r</italic> and <italic>h</italic>, by projection of the alignment to the HLA graph, our goals are: (1) to modify the graph to encode the exact sequence of <italic>r</italic> within the range of columns <italic>h</italic> encoded in the graph, (2) to increment the weight of each edge of the path by 1, and (3) to preserve preexisting paths at the same time. When <italic>r</italic> and <italic>h</italic> are identical, the graph must already contain a path that exactly encodes <italic>r</italic> because <italic>H</italic> is in the MSA used to construct the graph. When there are few differences identified by the pairwise alignment of <italic>r</italic> and <italic>h</italic>, such as mismatches, deletions, or insertions, there are two cases: (1) <italic>r</italic> is already encoded in the graph or (2) <italic>r</italic> is not, thereby the graph must be modified to encode <italic>r</italic>. For example, ACGTCA does not align perfectly to any of the sequences in Fig. <xref rid="Fig6" ref-type="fig">6</xref>a but it is encoded in the graph as a path. On the other hand, there is no path encoding ACCTGA.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Modification by alignment projection. The multiple sequence alignment and its corresponding POG from Fig. <xref rid="Fig5" ref-type="fig">5</xref> are shown (<bold>a</bold>). Three examples of graph modification operations (deletion or mismatch (<bold>b</bold>), insertion into a gap column (<bold>c</bold>), and insertion into a new column (<bold>d</bold>)) are shown with respect to the initial POG constructed. For each operation, an alignment of read <italic>r</italic> to one of the known alleles <italic>H</italic><sub><italic>i</italic></sub> is used to modify the graph. Each operation is applied to the POG and the resulting graph is shown. The nodes and edges that are newly added or changed during the operation are shown in red. The nodes that the read path maps are shown as bold circles. For an insertion into a new column, the newly assigned edge weights are explicitly drawn in using <italic>x</italic> and <italic>y</italic> variables. POG partial-ordered graph</p></caption><graphic xlink:href="13059_2018_1388_Fig6_HTML" id="MO6"/></fig></p>
      <p>Examples of graph modification by alignment projection are shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. Panel (a) shows a MSA with three known alleles and the corresponding POG. Modifications for mismatches and deletions are simple because they require only the addition of a vertex for the mismatched base or a gap (-) symbol. Figure <xref rid="Fig6" ref-type="fig">6</xref>b illustrates an example where <italic>r</italic> has a deletion of T at position 4. A gap vertex is added to the corresponding column and edges are added to connect the newly added vertex to the previous and next base in <italic>r</italic> to obtain a path encoding <italic>r</italic>. Normally, an insertion requires a shifting of columns in the MSA and graph because extra columns are required for the inserted bases to be encoded. However, some alignments with insertions do not require a column shift. An example of an alignment with insertion not requiring a column shifting is shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>c. The read is aligned to <italic>H</italic><sub>3</sub> with an insertion at position 5 instead of aligning to an allele <italic>H</italic><sub>1</sub> with a mismatch at the same position because the alignment score with one insertion is higher than the score with three mismatches (positions 2, 3, and 5 if aligned to <italic>H</italic><sub>1</sub>). Because <italic>H</italic><sub>1</sub> is in the MSA, the graph already has the column for handling an insertion at this particular column. In this case, we simply insert a vertex of G into the corresponding column and connect the edges to complete the path for <italic>r</italic>.</p>
      <p>Finally, an insertion requiring a shift of columns is depicted as an example in Fig. <xref rid="Fig6" ref-type="fig">6</xref>d. The read is aligned to allele <italic>H</italic><sub>1</sub> with an insertion of A at position 4. To insert a new column between the third and fourth columns (also denoted as the left and right columns), we first insert a new vertex with a - symbol and need to reroute all edges between the left and right columns through the newly inserted gap symbol and redistribute edge weights to preserve the preexisting paths. Adjusted weights are shown on the edges in the example. To describe this formally, let <italic>L</italic> and <italic>R</italic> be sets of vertices for the left and right columns respectively and <italic>E</italic> be the set of directed edges from <italic>v</italic><sub><italic>l</italic></sub>∈<italic>L</italic> to <italic>v</italic><sub><italic>r</italic></sub>∈<italic>R</italic> with the weight of each edge as <italic>w</italic>({<italic>v</italic><sub><italic>l</italic></sub>,<italic>v</italic><sub><italic>r</italic></sub>}). Additionally, let <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$E^{\text {out}}_{v_{l}}\subseteq E$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext>out</mml:mtext></mml:mrow></mml:msubsup><mml:mo>⊆</mml:mo><mml:mi>E</mml:mi></mml:math><inline-graphic xlink:href="13059_2018_1388_Article_IEq6.gif"/></alternatives></inline-formula> be the set of all outgoing edges of <italic>v</italic><sub><italic>l</italic></sub> and <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$E^{\text {in}}_{v_{r}}\subseteq E$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext>in</mml:mtext></mml:mrow></mml:msubsup><mml:mo>⊆</mml:mo><mml:mi>E</mml:mi></mml:math><inline-graphic xlink:href="13059_2018_1388_Article_IEq7.gif"/></alternatives></inline-formula> be the set of all incoming edges of <italic>v</italic><sub><italic>r</italic></sub>. Note that there are always one or more outgoing edges from <italic>v</italic><sub><italic>l</italic></sub> and one or more incoming edges to <italic>v</italic><sub><italic>r</italic></sub>. After disconnecting all {<italic>v</italic><sub><italic>l</italic></sub>,<italic>v</italic><sub><italic>r</italic></sub>}∈<italic>E</italic>, we make a new vertex <italic>v</italic><sub>gap</sub> with the - symbol and add an edge {<italic>v</italic><sub><italic>l</italic></sub>,<italic>v</italic><sub>gap</sub>} for each <italic>v</italic><sub><italic>l</italic></sub> and assign a weight of <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{e\in E^{\text {out}}_{v_{l}}}w(e)$\end{document}</tex-math><mml:math id="M16"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext>out</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2018_1388_Article_IEq8.gif"/></alternatives></inline-formula>. Similarly, we add an edge {<italic>v</italic><sub>gap</sub>,<italic>v</italic><sub><italic>r</italic></sub>} for each <italic>v</italic><sub><italic>r</italic></sub> with a weight of <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{e\in E^{\text {in}}_{v_{r}}}w(e)$\end{document}</tex-math><mml:math id="M18"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext>in</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2018_1388_Article_IEq9.gif"/></alternatives></inline-formula>. Once the column shift is done, we can actually process the insertion of the base exactly as we handled the insertion into a gap column.</p>
    </sec>
    <sec id="Sec19">
      <title>Finding paths through the HLA graph</title>
      <p>Given an HLA graph with weights, assembling HLA alleles can be formulated as the problem of finding two (diploid) paths (they can be identical) that explain the read mapping data (weights and phasing) best. When considering only the weights (number of reads), we can find two paths where the sum of their minimum weights is maximized. However, this formulation does not handle phasing information embedded by reads or read pairs. Therefore, it can possibly select erroneous paths that are not consistent with the phasing information. For this reason, we want our objective to take both weights as well as phasing information into account. Since read information is embedded in the HLA graph, we can check if two neighboring variant sites can be phased directly by a read or read pair. For example, given two heterozygous sites with A/T and G/C, a read or a read pair carrying A followed by G at these sites indicates the chromosomal phase of AG since the sequencing read is assumed to come from a contiguous segment in a chromosome. In our method, we first investigate variant regions individually to select locally phased paths with strong read support and construct a set of full-length paths through the HLA graph by connecting the locally phased paths that can be further phased by a read or read pair. Each of these full-length paths is considered as a candidate allele and the best pair among the candidates with maximum read and phasing support is selected as the output. To consider only nonzero-weight full-length paths, we remove all zero-weight edges and disconnected vertices prior to finding paths.</p>
      <sec id="Sec20">
        <title>HLA graph to bubble graph</title>
        <p>We first focus on the parts of the HLA graph where variations are captured, which are often referred to as bubbles in sequence assembly graphs [<xref ref-type="bibr" rid="CR50">50</xref>–<xref ref-type="bibr" rid="CR53">53</xref>]. In a HLA graph, we define a <italic>bubble</italic> as a region (three or more consecutive columns) where there is only one vertex each in the leftmost and rightmost columns and the rest of the columns must have two or more vertices. Let <italic>s</italic> and <italic>t</italic> be the vertices in the leftmost and the rightmost columns of the bubble, respectively. Any vertex in the bubble is reachable from <italic>s</italic> and one or more paths exists from any vertex in the bubble to <italic>t</italic>. Any two distinct paths that go through a bubble must go through <italic>s</italic> and <italic>t</italic>. Bubbles naturally capture the variation of sites between two alleles in the graph. The regions that are enclosed by the dotted line in Fig. <xref rid="Fig7" ref-type="fig">7</xref>a are examples of bubbles. On the other hand, a region that is completely shared by all paths through the HLA graph represents a conserved region. Without any loss of generality, the HLA graph can then be thought of as a chain of bubbles, where two neighboring bubbles are connected by a linear path of length 0 or longer (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). For simplicity, we can connect the bubbles without the linear paths as they do not play any role in determining the phase of a haplotype. We call this a bubble graph. Bubbles can easily be recognized in a HLA graph because of its structure.
<fig id="Fig7"><label>Fig. 7</label><caption><p>HLA graph to bubble graph. Show is an example of an HLA graph with three bubbles (in dotted boxes) (<bold>a</bold>) and its corresponding bubble graph (<bold>b</bold>). The best paths through the bubbles can be thought of as a pair of distinct colored paths (shown in red and blue). HLA human leukocyte antigen</p></caption><graphic xlink:href="13059_2018_1388_Fig7_HTML" id="MO7"/></fig></p>
      </sec>
      <sec id="Sec21">
        <title>Finding the best set of paths in a bubble</title>
        <p>Ideally, we want to find exactly two paths per bubble since the ploidy number is two for humans. The paths can be identical for homozygous alleles. However, bubbles may contain more than two paths because of sequencing errors or misalignment. Therefore, we first identify all paths that are phased by a read or read pair. For each bubble, we can use a modified breadth-first search technique to obtain all paths that go through the bubble. To avoid enumerating over all paths through a bubble, we prune any path without a read backing the sequence encoded by the path at each iteration of the breadth-first search. For a path in the bubble to be retained, it must be supported by at least one read phasing the entire path. We can simply compute the set of phased reads for a path by taking a series of intersections of read sets maintained by each edge in the path. Each phased path through a bubble is a called a <italic>bubble path</italic>.</p>
        <p>Given multiple bubble paths from a bubble, our goal is to select the best pair of paths. We iterate over all possible pairs of bubble paths to calculate the posterior probability of each pair given all reads aligned to the bubble to find the pair that gives the maximum probability. We write the posterior probability of a given genotype as 
<disp-formula id="Equa"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$P(G_{b}\mid D)=\frac{P(G_{b})P(D\mid G_{b})}{P(D)}, $$ \end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2018_1388_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> where <italic>G</italic><sub><italic>b</italic></sub> is a genotype and <italic>D</italic> is the alignments of all reads aligned over the bubble. The genotype is a pair of bubble paths <italic>G</italic><sub><italic>b</italic></sub>=(<italic>H</italic><sub><italic>b</italic>1</sub>,<italic>H</italic><sub><italic>b</italic>2</sub>). Each <italic>d</italic>∈<italic>D</italic> is an alignment string of a segment of a read and <italic>d</italic><sup><italic>i</italic></sup> is the <italic>i</italic>th symbol in segment <italic>d</italic>. Similarly, <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$H_{b1}^{i}$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2018_1388_Article_IEq10.gif"/></alternatives></inline-formula> is the <italic>i</italic>th symbol in <italic>H</italic><sub><italic>b</italic>1</sub>. <italic>P</italic>(<italic>D</italic>) is constant, and we assume that the prior probability <italic>P</italic>(<italic>G</italic><sub><italic>b</italic></sub>=(<italic>H</italic><sub><italic>b</italic>1</sub>,<italic>H</italic><sub><italic>b</italic>2</sub>)) is uniformly distributed over all genotypes. We can then compute the conditional probability <italic>P</italic>(<italic>D</italic>∣<italic>G</italic><sub><italic>b</italic></sub>) by adopting widely used formulations [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR54">54</xref>] with small variations to allow multiple positions and the base N case that can be present from sequence data. We iterate over each read and compute <italic>P</italic>(<italic>D</italic>∣<italic>G</italic><sub><italic>b</italic></sub>) as a product of the conditional probability of each read <italic>d</italic>.</p>
        <p>Since a read must come from one of the two chromosomes, and we assume that <italic>d</italic> is equally likely to come from either one of them, we can rewrite it as a sum of the average of two cases where <italic>d</italic> is from <italic>H</italic><sub><italic>b</italic>1</sub> and <italic>H</italic><sub><italic>b</italic>2</sub>: 
<disp-formula id="Equb"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$P(D\mid G_{b}) = \prod\limits_{d\in D}{\left[\frac{1}{2}P(d\mid H_{b1}) + \frac{1}{2}P(d\mid H_{b2})\right]}. $$ \end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>∈</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2018_1388_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>To compute the conditional probability of each <italic>d</italic> given a bubble path <italic>H</italic><sub><italic>b</italic></sub>, we iterate over each pair of corresponding positions <italic>d</italic><sup><italic>i</italic></sup> and <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$H_{b}^{i}$\end{document}</tex-math><mml:math id="M26"><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2018_1388_Article_IEq11.gif"/></alternatives></inline-formula> jointly, assuming each <italic>d</italic><sup><italic>i</italic></sup> is conditionally independent of each other given <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$H_{b}^{i}$\end{document}</tex-math><mml:math id="M28"><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2018_1388_Article_IEq12.gif"/></alternatives></inline-formula>. Therefore, the probability of each base <italic>d</italic><sup><italic>i</italic></sup> given a pair of corresponding genotype bases <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$H_{b1}^{i}$\end{document}</tex-math><mml:math id="M30"><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2018_1388_Article_IEq13.gif"/></alternatives></inline-formula> and <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$H_{b2}^{i}$\end{document}</tex-math><mml:math id="M32"><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2018_1388_Article_IEq14.gif"/></alternatives></inline-formula> is 
<disp-formula id="Equc"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\frac{1}{2}P \left(d^{i}\mid H_{b1}^{i} \right) + \frac{1}{2}P \left(d^{i}\mid H_{b2}^{i}\right). $$ \end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2018_1388_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>The probability of seeing a base given an allele is defined as 
<disp-formula id="Equd"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} P\left(d^{i}\mid H_{b}^{i}\right) &amp;= \left\{ \begin{array}{ll} 1-\epsilon, &amp; \text{if } d^{i}=H_{b}^{i} \text{~~~(match)} \\ \epsilon/3, &amp; \text{if } d^{i}\neq H_{b}^{i} \text{~~~(mismatch)} \end{array}\right. {,} \end{array} $$ \end{document}</tex-math><mml:math id="M36"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable class="array" columnalign="left"><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ε</mml:mi><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mtext>(match)</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>ε</mml:mi><mml:mo>/</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>≠</mml:mo><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mtext>(mismatch)</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1388_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <italic>ε</italic> of base symbol <italic>d</italic><sup><italic>i</italic></sup> is the error probability obtained from the phred score of the base. For <italic>d</italic><sup><italic>i</italic></sup>= N, we simply estimate the probability as 1/4. Instead of selecting <italic>H</italic><sub><italic>b</italic></sub> from all possible |<italic>d</italic>|-mers, we limit to only the bubble paths found in the bubble and iterate over all pairs to select a pair of bubble paths <inline-formula id="IEq15"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {P}_{b}$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2018_1388_Article_IEq15.gif"/></alternatives></inline-formula> that jointly gives the maximum probability: 
<disp-formula id="Eque"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\mathcal{P}_{b} = \text{argmax}_{G_{b}} \prod\limits_{d\in D}\prod_{i}^{|d|} \left[ \frac{P\left(d^{i}\mid H_{b1}^{i}\right)}{2} + \frac{P\left(d^{i}\mid H_{b2}^{i}\right)}{2} \right]. $$ \end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:munder><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>∈</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:munder><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>d</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:munderover><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2018_1388_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec22">
        <title>Phasing paths</title>
        <p>We now have an ordered list of bubbles, and a list of the best read-backed phased bubble paths for each bubble. The goal here is to find a set of candidate paths through all the bubbles by merging one bubble at a time iteratively from left to right, connecting bubble paths that are phased by a read or read pair. Two paths are said to be phase-consistent if there is a read or read pair spanning both paths. This can be checked easily by taking an intersection, since each bubble path maintains a set of phasing reads. Given a set of already merged bubble paths <inline-formula id="IEq16"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {P}_{m}$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2018_1388_Article_IEq16.gif"/></alternatives></inline-formula> from the first <italic>i</italic>−1 bubbles and a set of bubble paths <inline-formula id="IEq17"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {P}_{b_{i}}$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2018_1388_Article_IEq17.gif"/></alternatives></inline-formula> from the <italic>i</italic>th bubble, we look at all pairs of paths <inline-formula id="IEq18"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {P}_{m} \times \mathcal {P}_{b_{i}}$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2018_1388_Article_IEq18.gif"/></alternatives></inline-formula> and keep only pairs that are phase-consistent and connect each of such pairs as one path. We also update the phasing-read set for each merged path.</p>
      </sec>
      <sec id="Sec23">
        <title>Selecting the best pair of candidate alleles</title>
        <p>Once the assembly by bubble merging is finished, we have a set of merged bubble paths through all bubbles. By placing the linear chains that were ignored during bubble merging back to their original positions (between bubbles), we have a full-length candidate allele <italic>H</italic><sub><italic>i</italic></sub> for each merged bubble path. Let <italic>C</italic> be the set of all candidate alleles and <italic>B</italic> be a set of all bubbles. Our goal is to select a pair of alleles (<italic>H</italic><sub>1</sub>,<italic>H</italic><sub>2</sub>)∈<italic>C</italic>×<italic>C</italic> that has the most consistent phasing support over all bubbles. We first define a scoring metric that checks for the strength of phasing support jointly for a pair of alleles <italic>H</italic><sub>1</sub> and <italic>H</italic><sub>2</sub> between a pair of consecutive bubbles <italic>b</italic><sub><italic>i</italic></sub> and <italic>b</italic><sub><italic>i</italic>+1</sub>. It is defined as 
<disp-formula id="Equf"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ F_{i}(H_{1},H_{2}) =\left\{ \begin{array}{ll} f_{i}(H_{1})\times f_{i}(H_{2}), &amp;\text{if } H_{1} \neq H_{2} \\ \frac{f_{i}(H_{1})}{2}\times \frac{f_{i}(H_{2})}{2}, &amp; \text{if } H_{1} = H_{2} \end{array}\right. {,} $$ \end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable class="array" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2018_1388_Article_Equf.gif" position="anchor"/></alternatives></disp-formula> where <italic>f</italic><sub><italic>i</italic></sub>(<italic>H</italic>) is the inter-bubble phasing fraction. This fraction <italic>f</italic><sub><italic>i</italic></sub>(<italic>H</italic>) is the ratio of the number of phasing reads for allele <italic>H</italic> between <italic>b</italic><sub><italic>i</italic></sub> and <italic>b</italic><sub><italic>i</italic>+1</sub> and the number of total phasing reads. When considering two paths at the same time, there can be regions where the paths overlap (homozygous; shown as purple edges in Fig. <xref rid="Fig2" ref-type="fig">2</xref>e) and separate (heterozygous; shown as blue or red edges in Fig. <xref rid="Fig2" ref-type="fig">2</xref>e). For homozygous sections of the paths, that is <italic>H</italic><sub>1</sub>=<italic>H</italic><sub>2</sub>, <italic>f</italic><sub><italic>i</italic></sub>(<italic>H</italic>) is halved to keep the balance between calling homozygous and heterozygous alleles. We can calculate the product of <italic>F</italic><sub><italic>i</italic></sub> over all pairs of neighboring bubbles to check the consistency of phasing support for the pair. Finally, we select the pair of alleles <inline-formula id="IEq19"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {P}$\end{document}</tex-math><mml:math id="M50"><mml:mi mathvariant="script">P</mml:mi></mml:math><inline-graphic xlink:href="13059_2018_1388_Article_IEq19.gif"/></alternatives></inline-formula> that maximizes the product over all pairs of alleles: 
<disp-formula id="Equg"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\mathcal{P} =\text{argmax}_{\{H_{1},H_{2}\}\in C \times C} \left[\prod\limits_{i}^{|B|-1}{F_{i}(H_{1},H_{2})}\right]. $$ \end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mi mathvariant="script">P</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo>∈</mml:mo><mml:mi>C</mml:mi><mml:mo>×</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2018_1388_Article_Equg.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
    </sec>
    <sec id="Sec24">
      <title>Description of data used for evaluation</title>
      <sec id="Sec25">
        <title>Simulated data</title>
        <p>For each of the six HLA genes tested (HLA-A, -B, -C, -DQA1, -DQB1, and -DRB1), we randomly selected two full-length alleles from the IPD-IMGT/HLA database (v3.24.0) and repeated this for 100 replicates, resulting in a total of 200 alleles to simulate. The exact number of full-length alleles in the database is reported in Table <xref rid="Tab5" ref-type="table">5</xref>. For each replicate, we simulated 25 × coverage of paired-end WGS data for each allele, giving 50 × coverage for each locus. For the simulation of paired-end reads, we used an Illumina read simulator, pIRS [<xref ref-type="bibr" rid="CR55">55</xref>], which simulates using empirical base-calling and GC%-depth profiles trained from Illumina re-sequencing of known samples. We used 2 × 100 bp for the read length and 500 ± 50 bp for the mean and the standard deviation of the insert size.</p>
      </sec>
      <sec id="Sec26">
        <title>Illumina Platinum Genomes</title>
        <p>Illumina has sequenced 17 individuals (CEPH/Utah pedigree 1463) in a three-generation family using their high-coverage PCR-free paired-end WGS assay (2 × 101 bp). These genomes are often referred to as the Illumina Platinum Genomes [<xref ref-type="bibr" rid="CR56">56</xref>]. The family pedigree is shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. Many individuals in this family have been extensively investigated by the genomics community, especially the NA12891–NA12892–NA12878 trio as well as the NA12889–NA12890–NA12877 trio. The validated HLA types for the two trios were obtained from [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. The read alignments to the GRCh37 version of the human genome for all 17 individuals were downloaded from the Illumina Platinum Genomes page hosted on Google Cloud Platform (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S8) and they were realigned to the GRCh38 version of the human genome.</p>
      </sec>
      <sec id="Sec27">
        <title>Genomes</title>
        <p>The 1000 Genomes Project [<xref ref-type="bibr" rid="CR57">57</xref>] has produced various personal genomic data. Among these, there are 11 individuals used in [<xref ref-type="bibr" rid="CR11">11</xref>] whose high-coverage WGS data along with validated HLA typing results [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR32">32</xref>] are available. This data set covers a wide ethnic diversity (one Colombian from Medellín, three Utah residents with Northern and Western European ancestry in a trio, one Japanese from Tokyo, Japan, three Yoruban from Ibadan, Nigeria in a trio, one person of African ancestry from the southwestern United States, one person of Mexican ancestry from Los Angeles, and one Toscani from Italy) covering various different HLA types, making it an ideal data set to test on. The BAM files aligned to the GRCh38 version of the human genome were downloaded from the 1000 Genomes data portal (<ext-link ext-link-type="uri" xlink:href="http://www.internationalgenome.org/data-portal">http://www.internationalgenome.org/data-portal</ext-link>). For the Utah resident trio and the Yoruban trio, we downloaded fastq files and realigned to the GRCh38 version because GRCh38 BAM files were not available. There are three additional individuals with validated HLA typing results [<xref ref-type="bibr" rid="CR32">32</xref>] whose high-coverage WGS data are available. Pre-aligned BAM files of the additional individuals were downloaded.</p>
      </sec>
      <sec id="Sec28">
        <title>Whole-exome sequencing of 29 HapMap individuals</title>
        <p>Altogether, 29 HapMap [<xref ref-type="bibr" rid="CR35">35</xref>] samples (WES) that were used as a benchmarking data set for HLA*PRG [<xref ref-type="bibr" rid="CR11">11</xref>] were selected to test Kourami’s ability to assemble and type WES data. The 1000 Genomes data portal provides the BAM/CRAM files aligned to the GRCh38 version of the human genome for this set of WES data. The complete list of individual identifiers and the sources where the data were downloaded from are given in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S8.</p>
      </sec>
      <sec id="Sec29">
        <title>AK1 Korean genome</title>
        <p>De novo assembly of the Korean individual AK1 has been published [<xref ref-type="bibr" rid="CR40">40</xref>]. Both the validated HLA types (Supplementary Table 20 in [<xref ref-type="bibr" rid="CR40">40</xref>]) and high-coverage WGS data (2 × 150 bp) are publicly available. We downloaded fastq files and realigned to the GRCh38 version of the human genome. There is a link to the downloaded data in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S8.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec30">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2018_1388_MOESM1_ESM.xlsx">
            <label>Additional file 1</label>
            <caption>
              <p>Supplementary tables with descriptions. (XLSX 70 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2018_1388_MOESM2_ESM.pdf">
            <label>Additional file 2</label>
            <caption>
              <p>Supplementary figures with descriptions. (PDF 84 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p>The online version of this article (10.1186/s13059-018-1388-2) contains supplementary material, which is available to authorized users.</p>
    </fn>
  </fn-group>
  <ack>
    <p>We thank S. Kim of Illumina for helping us in the early stage of this research. We would also like to thank D. DeBlasio, C. Ma, G. Marçais, N. Sauerwald, M. Shao, B. Solomon, T. Wall, H. Wang, and H. Xin for valuable discussions and comments on the manuscript.</p>
    <sec id="d29e3792">
      <title>Funding</title>
      <p>This research was funded in part by the Gordon and Betty Moore Foundation’s Data-Driven Discovery Initiative through grant GBMF4554 to CK, by the U.S. National Science Foundation (CCF-1256087 and CCF-1319998) and by the U.S. National Institutes of Health (R01HG007104). This work was partially funded by The Shurl and Kay Curci Foundation.</p>
    </sec>
    <sec id="d29e3797">
      <title>Availability of data and materials</title>
      <p>The WGS data for Illumina Platinum Genomes (17 individuals from CEPH/Utah pedigree 1463) are available from the European Nucleotide Archive under accession PRJEB3381 [<xref ref-type="bibr" rid="CR58">58</xref>]. The WGS data for 14 individuals from the 1000 Genomes Project [<xref ref-type="bibr" rid="CR57">57</xref>] and the WES data of 29 HapMap samples [<xref ref-type="bibr" rid="CR35">35</xref>] are available through the data portal of the International Genome Sample Resource website [<xref ref-type="bibr" rid="CR59">59</xref>]. The WGS data for AK1 [<xref ref-type="bibr" rid="CR40">40</xref>] are available from the Short Read Archive of the National Center for Biotechnology Information under accession number SRP068953 [<xref ref-type="bibr" rid="CR60">60</xref>]. The complete list of direct links used to download the data is in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S8. Kourami (version 0.9.6 [<xref ref-type="bibr" rid="CR61">61</xref>]) is open source under the 3-Clause BSD license (OSI-compliant) and freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/Kingsford-Group/kourami">https://github.com/Kingsford-Group/kourami</ext-link>. It is implemented in Java and supported on Linux and Mac OS X.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>CK and HL designed the method and wrote the manuscript. HL wrote the software and carried out the experiments. Both authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="d29e3841">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="d29e3846">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="d29e3851">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sollid</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Pos</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wucherpfennig</surname>
            <given-names>KW</given-names>
          </name>
        </person-group>
        <article-title>Molecular mechanisms for contribution of MHC molecules to autoimmune diseases</article-title>
        <source>Curr Opin Immunol</source>
        <year>2014</year>
        <volume>31</volume>
        <fpage>24</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1016/j.coi.2014.08.005</pub-id>
        <?supplied-pmid 25216261?>
        <pub-id pub-id-type="pmid">25216261</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miyadera</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tokunaga</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Associations of human leukocyte antigens with autoimmune diseases: challenges in identifying the mechanism</article-title>
        <source>J Hum Genet</source>
        <year>2015</year>
        <volume>60</volume>
        <issue>11</issue>
        <fpage>697</fpage>
        <lpage>702</lpage>
        <pub-id pub-id-type="doi">10.1038/jhg.2015.100</pub-id>
        <?supplied-pmid 26290149?>
        <pub-id pub-id-type="pmid">26290149</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simmonds</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gough</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The HLA region and autoimmune disease: associations and mechanisms of action</article-title>
        <source>Curr Genom</source>
        <year>2007</year>
        <volume>8</volume>
        <issue>7</issue>
        <fpage>453</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.2174/138920207783591690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matzaraki</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Wijmenga</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zhernakova</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>The MHC locus and genetic susceptibility to autoimmune and infectious diseases</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>76</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1207-1</pub-id>
        <?supplied-pmid 28449694?>
        <pub-id pub-id-type="pmid">28449694</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hedrick</surname>
            <given-names>PW</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Evidence for balancing selection at HLA</article-title>
        <source>Genetics</source>
        <year>1983</year>
        <volume>104</volume>
        <issue>3</issue>
        <fpage>449</fpage>
        <lpage>56</lpage>
        <?supplied-pmid 6884768?>
        <pub-id pub-id-type="pmid">6884768</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Black</surname>
            <given-names>FL</given-names>
          </name>
          <name>
            <surname>Hedrick</surname>
            <given-names>PW</given-names>
          </name>
        </person-group>
        <article-title>Strong balancing selection at HLA loci: evidence from segregation in South Amerindian families</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1997</year>
        <volume>94</volume>
        <issue>23</issue>
        <fpage>12452</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.94.23.12452</pub-id>
        <?supplied-pmid 9356470?>
        <pub-id pub-id-type="pmid">9356470</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ferrer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fernández</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Nazabal</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Overview on HLA and DNA typing methods</article-title>
        <source>Biotecnología Aplicada</source>
        <year>2005</year>
        <volume>22</volume>
        <issue>2</issue>
        <fpage>91</fpage>
        <lpage>101</lpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Halliwell</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Hayhurst</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Flicek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Parham</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Marsh</surname>
            <given-names>SGE</given-names>
          </name>
        </person-group>
        <article-title>The IPD and IMGT/HLA database: allele variant databases</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>D423</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku1161</pub-id>
        <?supplied-pmid 25414341?>
        <pub-id pub-id-type="pmid">25414341</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Major</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Rigó</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hague</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bérces</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Juhos</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>HLA typing from 1000 Genomes whole genome and whole exome Illumina data</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>11</issue>
        <fpage>e78410</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0078410</pub-id>
        <?supplied-pmid 24223151?>
        <pub-id pub-id-type="pmid">24223151</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <mixed-citation publication-type="other">Bauer DC, Zadoorian A, Wilson LO, Thorne NP, et al.Evaluation of computational programs to predict HLA genotypes from genomic sequencing data. Brief Bioinform. 2016. 10.1093/bib/bbw097.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dilthey</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Gourraud</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Mentzer</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Cereb</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Iqbal</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>McVean</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>High-accuracy HLA type inference from whole-genome sequencing data using population reference graphs</article-title>
        <source>PLoS Comput Biol</source>
        <year>2016</year>
        <volume>12</volume>
        <issue>10</issue>
        <fpage>e1005151</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005151</pub-id>
        <?supplied-pmid 27792722?>
        <pub-id pub-id-type="pmid">27792722</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Erlich</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Carrington</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Next-generation sequencing for HLA typing of class I loci</article-title>
        <source>BMC Genomics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>42</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-12-42</pub-id>
        <?supplied-pmid 21244689?>
        <pub-id pub-id-type="pmid">21244689</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hanna</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sivachenko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cibulskis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kernytsky</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <issue>9</issue>
        <fpage>1297</fpage>
        <lpage>303</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id>
        <?supplied-pmid 20644199?>
        <pub-id pub-id-type="pmid">20644199</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boegel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Löwer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schäfer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bukur</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>De Graaf</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Boisguérin</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HLA typing from RNA-seq sequence reads</article-title>
        <source>Genome Med</source>
        <year>2012</year>
        <volume>4</volume>
        <issue>12</issue>
        <fpage>102</fpage>
        <pub-id pub-id-type="doi">10.1186/gm403</pub-id>
        <?supplied-pmid 23259685?>
        <pub-id pub-id-type="pmid">23259685</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Pourmand</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>HLA haplotyping from RNA-seq data using hierarchical read weighting</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>6</issue>
        <fpage>e67885</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0067885</pub-id>
        <?supplied-pmid 23840783?>
        <pub-id pub-id-type="pmid">23840783</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bai</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ni</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Fury</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Inference of high resolution HLA types using genome-wide RNA or DNA sequencing reads</article-title>
        <source>BMC Genomics</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>325</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-15-325</pub-id>
        <?supplied-pmid 24884790?>
        <pub-id pub-id-type="pmid">24884790</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nariai</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kojima</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Saito</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mimori</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kawai</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HLA-VBSeq: accurate HLA typing at full resolution from whole-genome sequencing data</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>Suppl 2</issue>
        <fpage>S7</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-16-S2-S7</pub-id>
        <?supplied-pmid 25708870?>
        <pub-id pub-id-type="pmid">25708870</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nariai</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hirose</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Kojima</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Nagasaki</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>TIGAR: transcript isoform abundance estimation method with gapped alignment of RNA-seq data by variational Bayesian inference</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>18</issue>
        <fpage>2292</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt381</pub-id>
        <?supplied-pmid 23821651?>
        <pub-id pub-id-type="pmid">23821651</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Szolek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schubert</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mohr</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sturm</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Feldhahn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kohlbacher</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>OptiType: precision HLA typing from next-generation sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>23</issue>
        <fpage>3310</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu548</pub-id>
        <?supplied-pmid 25143287?>
        <pub-id pub-id-type="pmid">25143287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yeo</surname>
            <given-names>ZX</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Piper</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kirkness</surname>
            <given-names>EF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast and accurate HLA typing from short-read next-generation sequence data with xHLA</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2017</year>
        <volume>114</volume>
        <issue>30</issue>
        <fpage>8059</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1707945114</pub-id>
        <?supplied-pmid 28674023?>
        <pub-id pub-id-type="pmid">28674023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Warren</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Choe</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Freeman</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Castellarin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Munro</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Derivation of HLA types from shotgun sequence datasets</article-title>
        <source>Genome Med</source>
        <year>2012</year>
        <volume>4</volume>
        <issue>12</issue>
        <fpage>95</fpage>
        <pub-id pub-id-type="doi">10.1186/gm396</pub-id>
        <?supplied-pmid 23228053?>
        <pub-id pub-id-type="pmid">23228053</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ying</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shotelersuk</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hirankarn</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HLAreporter: a tool for HLA typing from next generation sequencing data</article-title>
        <source>Genome Med</source>
        <year>2015</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>25</fpage>
        <pub-id pub-id-type="doi">10.1186/s13073-015-0145-3</pub-id>
        <?supplied-pmid 25908942?>
        <pub-id pub-id-type="pmid">25908942</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dilthey</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Iqbal</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>McVean</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Improved genome inference in the MHC using a population reference graph</article-title>
        <source>Nat Genet</source>
        <year>2015</year>
        <volume>47</volume>
        <issue>6</issue>
        <fpage>682</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3257</pub-id>
        <?supplied-pmid 25915597?>
        <pub-id pub-id-type="pmid">25915597</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Grasso</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sharlow</surname>
            <given-names>MF</given-names>
          </name>
        </person-group>
        <article-title>Multiple sequence alignment using partial order graphs</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <issue>3</issue>
        <fpage>452</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.3.452</pub-id>
        <?supplied-pmid 11934745?>
        <pub-id pub-id-type="pmid">11934745</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>An Eulerian path approach to DNA fragment assembly</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2001</year>
        <volume>98</volume>
        <issue>17</issue>
        <fpage>9748</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.171285098</pub-id>
        <?supplied-pmid 11504945?>
        <pub-id pub-id-type="pmid">11504945</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>The fragment assembly string graph</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>suppl_2</issue>
        <fpage>ii79</fpage>
        <lpage>85</lpage>
        <?supplied-pmid 16204131?>
        <pub-id pub-id-type="pmid">16204131</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <mixed-citation publication-type="other">Paten B, Novak A, Haussler D. Mapping to a reference genome structure. arXiv.2014;1404.5010v1.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hickey</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zerbino</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Raney</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Earl</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Armstrong</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Building a pan-genome reference for a population</article-title>
        <source>J Comput Biol</source>
        <year>2015</year>
        <volume>22</volume>
        <issue>5</issue>
        <fpage>387</fpage>
        <lpage>401</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2014.0146</pub-id>
        <?supplied-pmid 25565268?>
        <pub-id pub-id-type="pmid">25565268</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Church</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>VA</given-names>
          </name>
          <name>
            <surname>Steinberg</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>CS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Extending reference assembly models</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>13</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0587-3</pub-id>
        <?supplied-pmid 25651527?>
        <pub-id pub-id-type="pmid">25651527</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Novak</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Eizenga</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Garrison</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Genome graphs and the evolution of genome inference</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>5</issue>
        <fpage>665</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.214155.116</pub-id>
        <?supplied-pmid 28360232?>
        <pub-id pub-id-type="pmid">28360232</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marsh</surname>
            <given-names>SGE</given-names>
          </name>
          <name>
            <surname>Albert</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>Bodmer</surname>
            <given-names>WF</given-names>
          </name>
          <name>
            <surname>Bontrop</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Dupont</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Erlich</surname>
            <given-names>HA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nomenclature for factors of the HLA system, 2010</article-title>
        <source>Tissue Antigens</source>
        <year>2010</year>
        <volume>75</volume>
        <issue>4</issue>
        <fpage>291</fpage>
        <lpage>455</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1399-0039.2010.01466.x</pub-id>
        <?supplied-pmid 20356336?>
        <pub-id pub-id-type="pmid">20356336</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gourraud</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Khankhanian</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cereb</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>SY</given-names>
          </name>
          <name>
            <surname>Feolo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Maiers</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HLA diversity in the 1000 Genomes dataset</article-title>
        <source>PLoS ONE</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>7</issue>
        <fpage>e97282</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0097282</pub-id>
        <?supplied-pmid 24988075?>
        <pub-id pub-id-type="pmid">24988075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campbell</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Tishkoff</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>African genetic diversity: implications for human demographic history, modern human origins, and complex disease mapping</article-title>
        <source>Annu Rev Genomics Hum Genet</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>403</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev.genom.9.081307.164258</pub-id>
        <?supplied-pmid 18593304?>
        <pub-id pub-id-type="pmid">18593304</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prugnolle</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Manica</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Charpentier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Guégan</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Guernier</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Balloux</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Pathogen-driven selection and worldwide HLA class I diversity</article-title>
        <source>Curr Biol</source>
        <year>2005</year>
        <volume>15</volume>
        <issue>11</issue>
        <fpage>1022</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cub.2005.04.050</pub-id>
        <?supplied-pmid 15936272?>
        <pub-id pub-id-type="pmid">15936272</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>International HapMap Consortium</collab>
          <etal/>
        </person-group>
        <article-title>A haplotype map of the human genome</article-title>
        <source>Nature</source>
        <year>2005</year>
        <volume>437</volume>
        <issue>7063</issue>
        <fpage>1299</fpage>
        <pub-id pub-id-type="doi">10.1038/nature04226</pub-id>
        <pub-id pub-id-type="pmid">16255080</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Asan</collab>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tyler-Smith</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Xue</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive comparison of three commercial human whole-exome capture platforms</article-title>
        <source>Genome Biol</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>9</issue>
        <fpage>R95</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2011-12-9-r95</pub-id>
        <?supplied-pmid 21955857?>
        <pub-id pub-id-type="pmid">21955857</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meienberg</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bruggmann</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Oexle</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Matyas</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Clinical sequencing: is WGS the better WES?</article-title>
        <source>Hum Genet</source>
        <year>2016</year>
        <volume>135</volume>
        <issue>3</issue>
        <fpage>359</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="doi">10.1007/s00439-015-1631-9</pub-id>
        <?supplied-pmid 26742503?>
        <pub-id pub-id-type="pmid">26742503</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Belkadi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bolze</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Itan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Cobat</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vincent</surname>
            <given-names>QB</given-names>
          </name>
          <name>
            <surname>Antipenko</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Whole-genome sequencing is more powerful than whole-exome sequencing for detecting exome variants</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2015</year>
        <volume>112</volume>
        <issue>17</issue>
        <fpage>5473</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1418631112</pub-id>
        <?supplied-pmid 25827230?>
        <pub-id pub-id-type="pmid">25827230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tong</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo assembly of a haplotype-resolved human genome</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>6</issue>
        <fpage>617</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3200</pub-id>
        <?supplied-pmid 26006006?>
        <pub-id pub-id-type="pmid">26006006</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seo</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Rhie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sohn</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>CU</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo assembly and phasing of a Korean human genome</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>538</volume>
        <fpage>243</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/nature20098</pub-id>
        <?supplied-pmid 27706134?>
        <pub-id pub-id-type="pmid">27706134</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ajay</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Abaan</surname>
            <given-names>HO</given-names>
          </name>
          <name>
            <surname>Fajardo</surname>
            <given-names>KVF</given-names>
          </name>
          <name>
            <surname>Margulies</surname>
            <given-names>EH</given-names>
          </name>
        </person-group>
        <article-title>Accurate and comprehensive sequencing of personal genomes</article-title>
        <source>Genome Res</source>
        <year>2011</year>
        <volume>21</volume>
        <issue>9</issue>
        <fpage>1498</fpage>
        <lpage>505</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.123638.111</pub-id>
        <?supplied-pmid 21771779?>
        <pub-id pub-id-type="pmid">21771779</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ekblom</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>A field guide to whole-genome sequencing, assembly and annotation</article-title>
        <source>Evol Appl</source>
        <year>2014</year>
        <volume>7</volume>
        <issue>9</issue>
        <fpage>1026</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1111/eva.12178</pub-id>
        <?supplied-pmid 25553065?>
        <pub-id pub-id-type="pmid">25553065</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sameith</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Roscito</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Hiller</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Iterative error correction of long sequencing reads maximizes accuracy and improves contig assembly</article-title>
        <source>Brief Bioinform</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbw003</pub-id>
        <?supplied-pmid 26868358?>
        <pub-id pub-id-type="pmid">26868358</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schirmer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>DAmore</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ijaz</surname>
            <given-names>UZ</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Illumina error profiles: resolving fine-scale variation in metagenomic sequencing data</article-title>
        <source>BMC Bioinform</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>125</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-0976-y</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lefebvre</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Antoine</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Uzan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McMaster</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dausset</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Carosella</surname>
            <given-names>ED</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Specific activation of the non-classical class I histocompatibility HLA-G antigen and expression of the ILT2 inhibitory receptor in human breast cancer</article-title>
        <source>J Pathol</source>
        <year>2002</year>
        <volume>196</volume>
        <issue>3</issue>
        <fpage>266</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1002/path.1039</pub-id>
        <?supplied-pmid 11857488?>
        <pub-id pub-id-type="pmid">11857488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bukur</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jasinski</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Seliger</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>The role of classical and non-classical HLA class I antigens in human tumors</article-title>
        <source>Semin Cancer Biol</source>
        <year>2012</year>
        <volume>22</volume>
        <issue>4</issue>
        <fpage>350</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1016/j.semcancer.2012.03.003</pub-id>
        <?supplied-pmid 22465194?>
        <pub-id pub-id-type="pmid">22465194</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate short read alignment with Burrows–Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>14</issue>
        <fpage>1754</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
        <?supplied-pmid 19451168?>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tischler</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Leonard</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>biobambam: Tools for read pair collation based algorithms on BAM files</article-title>
        <source>Source Code Biol Med</source>
        <year>2014</year>
        <volume>9</volume>
        <fpage>13</fpage>
        <pub-id pub-id-type="doi">10.1186/1751-0473-9-13</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Löytynoja</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vilella</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Accurate extension of multiple sequence alignments using a phylogeny-aware graph algorithm</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>13</issue>
        <fpage>1684</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts198</pub-id>
        <?supplied-pmid 22531217?>
        <pub-id pub-id-type="pmid">22531217</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fasulo</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Halpern</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dew</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Mobarry</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Efficiently detecting polymorphisms during the fragment assembly process</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <issue>suppl 1</issue>
        <fpage>S294—302</fpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.suppl_1.S294</pub-id>
        <?supplied-pmid 12169559?>
        <pub-id pub-id-type="pmid">12169559</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iqbal</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Caccamo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Flicek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>McVean</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>De novo assembly and genotyping of variants using colored de Bruijn graphs</article-title>
        <source>Nat Genet</source>
        <year>2012</year>
        <volume>44</volume>
        <issue>2</issue>
        <fpage>226</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.1028</pub-id>
        <?supplied-pmid 22231483?>
        <pub-id pub-id-type="pmid">22231483</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sacomoto</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Kielbassa</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chikhi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Uricaru</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Antoniou</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sagot</surname>
            <given-names>MF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>KISSPLICE: de-novo calling alternative splicing events from RNA-seq data</article-title>
        <source>BMC Bioinform</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>Suppl 6</issue>
        <fpage>S5</fpage>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nijkamp</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Reinders</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>de Ridder</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Exploring variation-aware contig graphs for (comparative) metagenomics using MaryGold</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>22</issue>
        <fpage>2826</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt502</pub-id>
        <?supplied-pmid 24058058?>
        <pub-id pub-id-type="pmid">24058058</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>21</issue>
        <fpage>2987</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr509</pub-id>
        <?supplied-pmid 21903627?>
        <pub-id pub-id-type="pmid">21903627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>pIRS: Profile-based Illumina pair-end reads simulator</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>11</issue>
        <fpage>1533</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts187</pub-id>
        <?supplied-pmid 22508794?>
        <pub-id pub-id-type="pmid">22508794</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eberle</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Fritzilas</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Krusche</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Källberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Bekritsky</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A reference data set of 5.4 million phased human variants validated by genetic inheritance from sequencing a three-generation 17-member pedigree</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>1</issue>
        <fpage>157</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.210500.116</pub-id>
        <?supplied-pmid 27903644?>
        <pub-id pub-id-type="pmid">27903644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>The 1000 Genomes Project Consortium</collab>
        </person-group>
        <article-title>A global reference for human genetic variation</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>526</volume>
        <issue>7571</issue>
        <fpage>68</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1038/nature15393</pub-id>
        <pub-id pub-id-type="pmid">26432245</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58</label>
      <mixed-citation publication-type="other">Illumina Cambridge Ltd. Whole genome sequencing and variant calls for the Coriell CEPH/UTAH 1463 family. The European Nucleotide Archive. 2012. <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/ena/data/view/PRJEB3381">https://www.ebi.ac.uk/ena/data/view/PRJEB3381</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR59">
      <label>59</label>
      <mixed-citation publication-type="other">IGSR: The International Genome Sample Resource data portal. <ext-link ext-link-type="uri" xlink:href="http://www.internationalgenome.org/data-portal">http://www.internationalgenome.org/data-portal</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60</label>
      <mixed-citation publication-type="other">Seo JS, Rhie A, Kim J, Lee S, Sohn MH, Kim CU, et al. <italic>Homo sapiens</italic>, AK1 genome sequencing and de novo assembly of an Asian individual. NCBI Short Read Archive. 2016. <ext-link ext-link-type="uri" xlink:href="https://trace.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?study=SRP068953">https://trace.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?study=SRP068953</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR61">
      <label>61</label>
      <mixed-citation publication-type="other">Lee H. Kourami: graph-guided HLA assembler. 2017. 10.5281/zenodo.1122533.</mixed-citation>
    </ref>
  </ref-list>
</back>
