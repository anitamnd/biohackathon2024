<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Int J Epidemiol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Int J Epidemiol</journal-id>
    <journal-id journal-id-type="publisher-id">ije</journal-id>
    <journal-title-group>
      <journal-title>International Journal of Epidemiology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0300-5771</issn>
    <issn pub-type="epub">1464-3685</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5837456</article-id>
    <article-id pub-id-type="doi">10.1093/ije/dyx204</article-id>
    <article-id pub-id-type="publisher-id">dyx204</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software Application Profile</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Software Application Profile: PHESANT: a tool for performing automated phenome scans in UK Biobank</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Millard</surname>
          <given-names>Louise AC</given-names>
        </name>
        <xref ref-type="aff" rid="dyx204-AFF1">1</xref>
        <xref ref-type="aff" rid="dyx204-AFF2">2</xref>
        <xref ref-type="corresp" rid="dyx204-COR1"/>
        <!--<email>louise.millard@bristol.ac.uk</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Davies</surname>
          <given-names>Neil M</given-names>
        </name>
        <xref ref-type="aff" rid="dyx204-AFF1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gaunt</surname>
          <given-names>Tom R</given-names>
        </name>
        <xref ref-type="aff" rid="dyx204-AFF1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Davey Smith</surname>
          <given-names>George</given-names>
        </name>
        <xref ref-type="aff" rid="dyx204-AFF1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tilling</surname>
          <given-names>Kate</given-names>
        </name>
        <xref ref-type="aff" rid="dyx204-AFF1">1</xref>
      </contrib>
    </contrib-group>
    <aff id="dyx204-AFF1"><label>1</label>MRC Integrative Epidemiology Unit (IEU), School of Social and Community Medicine</aff>
    <aff id="dyx204-AFF2"><label>2</label>Intelligent Systems Laboratory, Department of Computer Science, University of Bristol, Bristol, UK</aff>
    <author-notes>
      <corresp id="dyx204-COR1">Corresponding author. MRC Integrative Epidemiology Unit (IEU), School of Social and Community Medicine, Oakfield House, Oakfield Grove, University of Bristol, Bristol BS8 2BN, UK. E-mail: <email>louise.millard@bristol.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>2</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-10-05">
      <day>05</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>47</volume>
    <issue>1</issue>
    <fpage>29</fpage>
    <lpage>35</lpage>
    <history>
      <date date-type="rev-recd">
        <day>22</day>
        <month>8</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>8</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press on behalf of the International Epidemiological Association.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="dyx204.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Epidemiological cohorts typically contain a diverse set of phenotypes such that automation of phenome scans is non-trivial, because they require highly heterogeneous models. For this reason, phenome scans have to date tended to use a smaller homogeneous set of phenotypes that can be analysed in a consistent fashion. We present PHESANT (PHEnome Scan ANalysis Tool), a software package for performing comprehensive phenome scans in UK Biobank.</p>
      </sec>
      <sec id="s2">
        <title>General features</title>
        <p>PHESANT tests the association of a specified trait with all continuous, integer and categorical variables in UK Biobank, or a specified subset. PHESANT uses a novel rule-based algorithm to determine how to appropriately test each trait, then performs the analyses and produces plots and summary tables.</p>
      </sec>
      <sec id="s3">
        <title>Implementation</title>
        <p>The PHESANT phenome scan is implemented in R. PHESANT includes a novel Javascript D3.js visualization and accompanying Java code that converts the phenome scan results to the required JavaScript Object Notation (JSON) format.</p>
      </sec>
      <sec id="s4">
        <title>Availability</title>
        <p>PHESANT is available on GitHub at [<ext-link ext-link-type="uri" xlink:href="https://github.com/MRCIEU/PHESANT">https://github.com/MRCIEU/PHESANT</ext-link>]. Git tag v0.5 corresponds to the version presented here.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">University of Bristol</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000883</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Medical Research Council</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000265</named-content>
        </funding-source>
        <award-id>MC_UU_12013/1</award-id>
        <award-id>MC_UU_12013/8</award-id>
        <award-id>MC_UU_12013/9</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Phenome scans test the association of a trait of interest with a comprehensive array of phenotypes (the ‘phenome’). Types of phenome scans include phenome-wide association studies (pheWAS),<xref rid="dyx204-B1" ref-type="bibr"><sup>1</sup></xref> Mendelian randomization-pheWAS (MR-pheWAS)<xref rid="dyx204-B2" ref-type="bibr"><sup>2</sup></xref> and environment-wide association studies (EnWAS).<xref rid="dyx204-B3" ref-type="bibr"><sup>3</sup></xref><sup>,</sup><xref rid="dyx204-B4" ref-type="bibr"><sup>4</sup></xref> PheWAS seek to investigate the association of a genetic variant with a set of phenotypic traits.<xref rid="dyx204-B1" ref-type="bibr"><sup>1</sup></xref><sup>,</sup><xref rid="dyx204-B5" ref-type="bibr"><sup>5</sup></xref> A recent extension to pheWAS, MR-pheWAS, uses Mendelian randomization (MR) in a pheWAS framework in order to search for the causal effects of a particular exposure.<xref rid="dyx204-B2" ref-type="bibr"><sup>2</sup></xref> EnWAS seek to test the associations of a trait of interest with a set of other phenotypes.<xref rid="dyx204-B3" ref-type="bibr"><sup>3</sup></xref></p>
    <p>Epidemiological cohorts usually contain a large number of diverse phenotypes, such that testing the association of these phenotypes with another trait in an automated way is non-trivial. For this reason, researchers wishing to perform a phenome scan will typically specify a homogeneous subset of traits, in order to automate the tests of association across these traits in a consistent way. For instance, pheWAS initially started using international classification of disease (ICD) codes from electronic health records, where each disease code could be treated as a binary variable and a consistent test performed.<xref rid="dyx204-B5" ref-type="bibr"><sup>5</sup></xref> However, restricting the set of phenotypes provides only a partial view of associations with a trait of interest, and reduces the potential to identify novel associations.</p>
    <p>In this paper we present PHESANT (PHEnome Scan ANalysis Tool), a parallelizable tool for phenome scans in UK Biobank, a prospective cohort of over 500 000 men and women in the UK aged between 37 and 73 years.<xref rid="dyx204-B6" ref-type="bibr"><sup>6</sup></xref> This cohort includes genetic data and a large and diverse range of data from blood, analyses of urine and saliva samples, clinical assessments, record linkage and health and lifestyle questionnaires. The diversity of traits available, coupled with the large sample size, provide an opportunity to identify novel associations with phenome scans. </p>
  </sec>
  <sec>
    <title>Implementation</title>
    <p>PHESANT is implemented in R and requires the following R packages: optparse, MASS, lmtest, nnet, forestplot and data.table (see GitHub repository for package versions). PHESANT takes one data file as input containing the set of phenotypes, the trait of interest [which may be a single nucleotide polymorphism (SNP), a genetic score or a phenotypic trait depending on whether a pheWAS, MR-pheWAS or EnWAS is being performed] and confounders (the trait of interest and confounders can alternatively be provided in separate files if this is preferred). PHESANT also makes use of two data files (included in PHESANT) that contain information about the variables in the UK Biobank cohort: (i) a data coding information file, and (ii) a variable information file. These files have been set up for the example we describe in the usage section, but can be changed as needed for each particular phenome scan. For more information on the PHESANT data and information files, see the documentation in the GitHub repository. In the rest of this section we describe the variable processing flow used in PHESANT.</p>
    <sec>
      <title>Automated processing flow to determine variable coding</title>
      <p>In order to test the association of the trait of interest with the diverse range of phenotypes in UK Biobank in an automated manner, we developed a rule-based system to determine the appropriate coding of each variable and hence test of association to use. These rules are shown in <xref ref-type="fig" rid="dyx204-F1">Figure 1</xref> and described in full in <xref ref-type="supplementary-material" rid="sup1">Supplementary section S1</xref> (available as <xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> at <italic>IJE</italic> online). The decision rules start with the variable field type as specified by UK Biobank at: [<ext-link ext-link-type="uri" xlink:href="http://biobank.ctsu.ox.ac.uk/showcase/list.cgi">http://biobank.ctsu.ox.ac.uk/showcase/list.cgi</ext-link>], either continuous, integer, categorical (single) or categorical (multiple), and categorize each variable as one of four data types: continuous, ordered categorical, unordered categorical and binary. The categorical (single) field type refers to categorical fields (including binary) where each participant can only have one value. For example, by questionnaire participants were asked ‘How would you describe your usual walking pace?’ with options including ‘slow’, ‘average’ and ‘brisk’ (field ID = 924; see <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure 1</xref>, available as <xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> at <italic>IJE</italic> online). In contrast, categorical (multiple) fields can have multiple values per participant. For example, by questionnaire participants were asked what types of bread they ate the previous day (field ID = 20091; see <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure 2</xref>, available as <xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> at <italic>IJE</italic> online) and could, for instance, select both white and wholemeal options. Where a field is measured at several time points we use the first occurrence only (see <xref ref-type="supplementary-material" rid="sup1">Supplementary section S2</xref> for details, available as <xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> at <italic>IJE</italic> online). Continuous and integer variables may have more than one measurement at this first measured time point (typically to improve the estimate of a measurement). For instance, spirometry was measured two or three times a few moments apart—see for example field 3062 [<ext-link ext-link-type="uri" xlink:href="http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=3062">http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=3062</ext-link>]). When this is the case we take the mean to create a single value per participant (see <xref ref-type="supplementary-material" rid="sup1">Supplementary section S2</xref> for details).</p>
      <fig id="dyx204-F1" orientation="portrait" position="float">
        <label>Figure 1</label>
        <caption>
          <p>Variable processing flow diagram showing logic from defined field type specified by UK Biobank to test of association. Triangular nodes at top of figure are field types defined by UK Biobank. Rectangular nodes show processing logic used to determine the data type assignment (oval), either continuous, ordered categorical, unordered categorical or binary, and hence finally, the type of test used: linear, ordinal logistic, multinomial logistic or logistic regression, respectively. Diamond nodes show points where variables may be removed.</p>
        </caption>
        <graphic xlink:href="dyx204f1"/>
      </fig>
      <p>Variables with the continuous field type are usually assigned to the continuous data type. In this case, the variable is transformed to a normal distribution using an inverse normal rank transformation. In a minority of cases, continuous fields are assigned to the ordered categorical data type (or binary if there are only two distinct values). For example, field 100022 [<ext-link ext-link-type="uri" xlink:href="http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=100022">http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=100022</ext-link>] contains the estimated alcohol intake based on responses to the ‘diet by 24-hour recall’ questionnaire. A large proportion of the participants have a zero value for this field, because they consume no alcohol. It is not possible to inverse normal rank transform this variable because, where a large number of participants have the same value, the rank assigned in this transformation is random among these, and this would add noise to the data. Instead, we transform this variable into three categories with roughly the same number of participants in each (placing split points between distinct values), and treat it as an ordered categorical variable (see algorithm in <xref ref-type="supplementary-material" rid="sup1">Supplementary section S3</xref>, available as <xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> at <italic>IJE</italic> online). Variables with the integer field type are usually treated exactly the same as the continuous variables. In a minority of cases, where there are 20 or fewer distinct values we treat this variable as ordered categorical (or binary if there are only two distinct values).</p>
      <p>Categorical (single) variables may be assigned to the binary, ordered categorical or unordered categorical data types. UK Biobank consistently assigns negative values to categories denoting missingness (such as ‘Preferred not to answer’ and ‘Do not know’), and so we recode negative values to ‘NA’. UK Biobank defines ‘data codes’ to which one or more fields are assigned, and these define the set of categorical values for these fields and their corresponding numerical values. The PHESANT data-coding information file specifies whether a data code of a categorical (single) field defines an ordered or unordered category structure, and we use this information to assign each non-binary categorical (single) field as either an ordered or an unordered categorical data type.</p>
      <p>Each categorical (multiple) variable is converted to a set of binary variables, each denoting whether a participant has a given value of this variable. For example, for the variable describing the bread eaten yesterday (field ID = 20091; <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure 2</xref>), with values ‘white’, ‘mixed’, ‘wholemeal’, ‘seeded’ and ‘other’, we generate five binary variables: <italic>white = {true, false}</italic>, <italic>wholemeal = {true, false}</italic> and so forth. Categorical (multiple) fields have an added complexity because when a person has no value in this field, this may be because: (i) the field values are incomplete—they do not contain all possible values (e.g. a participant who does not eat bread cannot choose any option above); or (ii) because the data are missing (e.g. because a participant did not answer this particular question). This affects who we assign as, for instance, <italic>white = false</italic>, either: (i) all people who selected a value other than ‘white’; (ii) all people who responded to this questionnaire and did not select ‘white’; or (iii) all people who did not select ‘white’ including those who did not respond to the questionnaire (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure 3</xref> for illustration, available as <xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> at <italic>IJE</italic> online). In this case the second option might be preferred, such that we are comparing those who ate white bread with those who responded to the questionnaire but did not eat white bread. This decision is variable-specific, and can be specified in the PHESANT variable information file (the variable information file we used for the example described in the Usage section is available in the GitHub repository). For more details see <xref ref-type="supplementary-material" rid="sup1">Supplementary material section S1</xref>, available as <xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> at <italic>IJE</italic> online.</p>
      <p>Some categorical multiple fields include negative numerical values for particular categories denoting missingness (such as ‘Do not know’). We exclude all participants with a missing value from the <italic>false</italic> value of the generated binary variable, because we cannot know if they do or do not pertain to the <italic>true</italic> value of this binary variable. For example, consider field 41228 [<ext-link ext-link-type="uri" xlink:href="http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=41228">http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=41228</ext-link>] describing the type of medical professional who conducted the delivery of a participant’s child, and a participant who has given birth twice and has values ‘midwife’ and ‘not known’ in this field. The generated binary variable for midwife includes this participant in the set of participants corresponding to <italic>midwife = true</italic> because we know that on at least one occasion a midwife conducted the delivery. However, we cannot be certain that a hospital doctor did not conduct a delivery for this participant because the ‘not known’ value could refer to a ‘hospital doctor’. Hence, the generated ‘hospital doctor’ binary variable would not include this participant in the set of participants corresponding to <italic>hospital_doctor = false</italic>, because this is not known. </p>
    </sec>
    <sec>
      <title>Tests of association with trait of interest</title>
      <p>The association of each phenotype, having been appropriately coded and assigned one of the four data types (continuous, ordered categorical, unordered categorical and binary), is tested with the trait of interest as follows. The phenotype and the trait of interest are the dependent and independent variables of the regression, respectively. All regressions are adjusted for age at recruitment and sex (and also genotype chip when the trait of interest is genetic, derived from the genotype measurement batch), or for all variables in the confounder file if one is specified. We test the association with the transformed variables of the continuous data type using linear regression (lm R function). Ordered categorical, unordered categorical and binary variables are tested using ordered logistic regression (polr R function), multinomial logistic regression (multinom R function) and binomial regression (glm R function with family parameter as binomial), respectively. We do not test phenotypes where the sample size is fewer than 500, which typically occurs for a minority of fields such as follow-up questions on a subsample (e.g. field 22148 [<ext-link ext-link-type="uri" xlink:href="http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=22148">http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=22148</ext-link>]). We do not test unordered categorical variables with more than 1000 categories (above the default maximum of the multinom function), which occurs once in our usage example, field 132 [<ext-link ext-link-type="uri" xlink:href="http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=132">http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=132</ext-link>]. </p>
    </sec>
    <sec>
      <title>Customizing a phenome scan with PHESANT</title>
      <p>PHESANT allows researchers to easily customize the phenome scan by changing settings in the data coding and variable information files. This includes:
<list list-type="bullet"><list-item><p>changing the numerical values underlying a variable (such as recoding a value to missing) or the ordering of values for ordered categorical variables;</p></list-item><list-item><p>assigning a default value to categorical (single) variables where this is not explicitly coded in the variable (see <xref ref-type="supplementary-material" rid="sup1">Supplementary section S1</xref>);</p></list-item><list-item><p>changing fields from the categorical (single) to the categorical (multiple) field type, as this may be more appropriate for a small number of fields;</p></list-item><list-item><p>specifying which variables should be excluded a priori from the phenome scan;</p></list-item><list-item><p>specifying which fields in the phenome dataset are essentially the same phenotype as the trait of interest [e.g. weight and body mass index (BMI)] such that, after the phenome scan is run, the results of association between these fields and the trait of interest are used for validation only, rather than being included in the results and adding to the multiple testing burden.</p></list-item></list></p>
      <p>Further customization of a phenome scan using PHESANT is possible in two ways.
<list list-type="roman-lower"><list-item><p>A user can manipulate the data before running PHESANT, for example aggregating continuous values using the median rather than the mean or aggregating a field across multiple time points.</p></list-item><list-item><p>A user can save the derived phenotypes from PHESANT and then perform their own customized analysis with these variables.</p></list-item></list></p>
    </sec>
    <sec>
      <title>Results output</title>
      <p>PHESANT ranks the results by <italic>P</italic>-value and outputs a results file, a QQ-plot, and forest plots for the continuous, ordered categorical and binary results that are below the Bonferroni corrected <italic>P</italic>-value threshold [a forest plot for the categorical unordered results is not generated because we have no overall estimate (and confidence interval) for these models, as we use a likelihood ratio test to generate a model <italic>P</italic>-value].</p>
      <sec>
        <title>PHESANT-viz: a web-based visualization for phenome scans</title>
        <p>Reviewing the results from phenome scans can be challenging due to the number and complexity of phenotypes. As part of PHESANT we have also developed PHESANT-viz, a D3 Javascript visualization that displays phenome scan results as an interactive graph, using the hierarchical field category structure defined by UK Biobank and available at [<ext-link ext-link-type="uri" xlink:href="http://biobank.ctsu.ox.ac.uk/showcase/label.cgi">http://biobank.ctsu.ox.ac.uk/showcase/label.cgi</ext-link>]. PHESANT includes a Java program to convert the phenome scan results to the JavaScript Object Notation (JSON) format required for PHESANT-viz. We provide the PHESANT-viz of our usage example below.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Usage</title>
    <p>To demonstrate PHESANT, we have performed a MR-pheWAS to search for the causal effects of BMI in UK Biobank (previously performed in a smaller cohort with continuous phenotypes only).<xref rid="dyx204-B2" ref-type="bibr"><sup>2</sup></xref> Such an analysis is predicated on the Mendelian randomization principle that genetic variants can be used as instrumental variables to estimate causal effects of the phenotype they proxy for on downstream outcomes.<xref rid="dyx204-B7" ref-type="bibr"><sup>7</sup></xref> In the current context this would be a screening exercise to identify associations for detailed follow-up. This analysis is preliminary and for example only, having been run on a non-random subsample of 114 963 participants (containing the UK BILEVE samples selected on smoking status; see <xref ref-type="supplementary-material" rid="sup1">Supplementary section S4</xref> for details, available as <xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> at <italic>IJE</italic> online) for which genetic data are currently available in UK Biobank (a final analysis will be subsequently published upon release of the full 500 000 sample with genetic data).</p>
    <p>We created an allele score from 96 genetic variants previously found to be associated with BMI, in a recent genome-wide association study (GWAS) meta-analysis.<xref rid="dyx204-B8" ref-type="bibr"><sup>8</sup></xref> The score was calculated as a sum of the number of BMI-increasing alleles, weighted by the effect size as reported in<xref rid="dyx204-B8" ref-type="bibr"><sup>8</sup></xref> (see <xref ref-type="supplementary-material" rid="sup1">Supplementary table 1</xref>, available as <xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> at <italic>IJE</italic> online). Hence, a higher genetic score corresponds to a tendency towards higher BMI (F-statistic = 1979). We used PHESANT to test the association of the BMI genetic score with the 290 integer, 1030 continuous, 658 categorical (single) and 99 categorical (multiple) fields available in UK Biobank at the current time (excluding 66 fields a priori, see <xref ref-type="supplementary-material" rid="sup1">Supplementary Table 2</xref>, available as <xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> at <italic>IJE</italic> online). <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure 4</xref> shows the number of variables reaching each stage of our variable processing flow (available as <xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> at <italic>IJE</italic> online).</p>
    <p><xref ref-type="fig" rid="dyx204-F2">Figure 2</xref> shows the QQ plot of our MR-pheWAS results (see full results ranking in <xref ref-type="supplementary-material" rid="sup1">Supplementary Data File</xref>, and forest plots in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure 5</xref>, available as <xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> at <italic>IJE</italic> online). Of the 10 624 tests performed (excluding 87 phenotypes tested but specified a priori as being aspects of the same essential phenotype as BMI), 87 were associated at a Bonferroni corrected <italic>P</italic>-value threshold of 4.71 × 10<sup>−6</sup> (0.05/10624). We detected several known effects of BMI, for example with hypertension<xref rid="dyx204-B9" ref-type="bibr"><sup>9</sup></xref> (fields 41204 value I10, and 4079), diabetes<xref rid="dyx204-B10" ref-type="bibr"><sup>10</sup></xref> (field 2443) and age at puberty in both sexes<xref rid="dyx204-B11" ref-type="bibr"><sup>11</sup></xref> (fields 2714, 2375 and 2385). For instance, a one standard deviation (SD) increase in BMI allele score was associated with a 1.08-fold [95% confidence interval (CI): 1.06, 1.11] higher odds of being diagnosed with hypertension in hospital (field 41204 value I10), and a 0.015 SD (95% CI: 0.010, 0.021) higher diastolic blood pressure (field 4079). We also detected a number of potentially causal associations that were previously unknown. For example, participants with a genetic propensity to higher BMI were less likely to perceive themselves as a nervous person (field 1970) or to call themselves tense or ‘highly strung’ (field 1990).</p>
    <fig id="dyx204-F2" orientation="portrait" position="float">
      <label>Figure 2</label>
      <caption>
        <p>QQ plot of preliminary MR-pheWAS analysis seeking to identify the causal effects of BMI. Dashed line: Bonferroni corrected threshold <italic>P</italic> = 4.71 × 10<sup>−6</sup> (<italic>P</italic> = 0.05 corrected for 10 624 tests). Dotted line: actual = expected.</p>
      </caption>
      <graphic xlink:href="dyx204f2"/>
    </fig>
    <p>The PHESANT-viz of these preliminary results can be found at [<ext-link ext-link-type="uri" xlink:href="http://datamining.org.uk/PHESANT/">http://datamining.org.uk/PHESANT/</ext-link>] or within the PHESANT package. When this analysis is performed using the full 500 000 sample, the power to detect associations will increase, and it is also likely that the number of tests will increase as fewer variables will be filtered out in the variable processing steps (due to a small sample size). This preliminary analysis took approximately 105 h (using a 1 core Intel E5–2670).</p>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>PHESANT enables researchers to perform a comprehensive phenome scan in UK Biobank, including a pheWAS, MR-pheWAS or EnWAS. Whereas GWAS have been highly successful at identifying novel associations, we are currently only just beginning to explore the phenome in a hypothesis-free manner.<xref rid="dyx204-B1" ref-type="bibr"><sup>1</sup></xref><sup>,</sup><xref rid="dyx204-B2" ref-type="bibr"><sup>2</sup></xref><sup>,</sup><xref rid="dyx204-B12" ref-type="bibr"><sup>12</sup></xref> In contrast to hypothesis-driven analyses, phenome scans allow exploration across hypotheses without strong priors, and should help to avoid publication bias as analyses are pre-specified and all results, not just the most ‘statistically significant’, are published together.</p>
    <p>When undertaking a phenome scan there are several important considerations. First, phenome scans are a screening exercise to identify potentially interesting associations that should then be analysed more rigorously—and as such the association estimates should be interpreted with caution. The strength of the strongest associations identified may be inflated due to the winner’s curse. Second, it is important to consider the number of tests performed when examining the strength of identified associations. In our usage example we used a conservative Bonferroni corrected threshold to identify potentially interesting associations, which, although reducing the type I error rate, is likely to increase the type II error rate. Third, interpretation of potentially hundreds of results is challenging because the correlated structure of phenotypes means that associations between the trait of interest and each phenotype are not independent. The strongest associations should not be viewed in isolation but alongside the results of related variables for which an association may not have been identified, and to do this we provide a novel visualization approach, PHESANT-viz.</p>
    <p>We note the following limitations and areas of future work. It is possible that in some cases our automated rule-based method may deal with variables inappropriately. For example, field 132 [<ext-link ext-link-type="uri" xlink:href="http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=132">http://biobank.ctsu.ox.ac.uk/showcase/field.cgi?id=132</ext-link>], which describes participant’s jobs, is treated as an unordered categorical variable but was removed from our phenome scan because it has more than 1000 categories. In this case, it may be preferable to use the hierarchical structure defined by UK Biobank to combine categories of related jobs. The aim of PHESANT is to provide a ‘broad-brush’ approach for phenome scans, such that users should follow up their phenome scan with a comprehensive analysis of the identified associations, using the most appropriate representation and regression model for each particular trait. For example, instead of using an inverse normal rank transformation for continuous fields (as performed by PHESANT), a multivariable linear regression model, or other model with appropriate error distribution for non-normal variables (such as zero-inflated models), can be used.</p>
    <p>PHESANT uses the first time point of a field where multiple time points are available. In future work we will investigate how to automate the analysis including data from multiple time points, and the potential gains that this would give.<xref rid="dyx204-B13" ref-type="bibr"><sup>13</sup></xref> Currently, when continuous variables are converted to the ordered categorical data type we arbitrarily chose to generate three categories, and in future work will investigate whether a larger number of categories are beneficial, and whether the optimal number of categories can be calculated from the distribution of the variable. PHESANT is specifically designed for use in UK Biobank, but a cohort-independent tool for phenome scans would be highly valuable. Hence, in the future we will aim to adapt PHESANT for use in a general setting. Finally, we intend to integrate PHESANT with MR-base<xref rid="dyx204-B14" ref-type="bibr"><sup>14</sup></xref> to enable automated construction of genetic instrumental variables to use in MR-pheWAS.</p>
    <p>The large number of participants combined with the extensive range of phenotypes available in UK Biobank provide a great opportunity to comprehensively search for novel (potentially causal) associations in a hypothesis-free manner. We are aware of only one very small phenome scan that has been performed in UK Biobank to date,<xref rid="dyx204-B15" ref-type="bibr"><sup>15</sup></xref> and a recent novel Bayesian approach of self-reported diagnoses and hospital episodes.<xref rid="dyx204-B16" ref-type="bibr"><sup>16</sup></xref> PHESANT allows users to initiate multiple ‘jobs’ where each scans a subset of phenotypes, such that phenome scans are easily parallelizable whether running on a single multi-core machine or a multi-node high performance computing cluster. To our knowledge, PHESANT is the first open-source package to automate phenome scans across diverse sets of phenotypes.</p>
  </sec>
  <sec>
    <title>Supplementary Data</title>
    <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>IJE</italic> online.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the University of Bristol and UK Medical Research Council [grant numbers MC_UU_12013/1, MC_UU_12013/8 and MC_UU_12013/9].</p>
    <p><bold>Conflict of interest:</bold> T.R.G. holds research funding from Sanofi and GlaxoSmithKline for unrelated research.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Material</label>
      <media xlink:href="dyx204_ije-2017-02-0225-file004.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>Supplementary Table</label>
      <media xlink:href="dyx204_ije-2017-02-0225-file005.xls">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="dyx204-B1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Denny</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Bastarache</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Roden</surname><given-names>DM</given-names></name></person-group><article-title>Phenome-wide association studies as a tool to advance precision medicine</article-title>. <source>Annu Rev Genomics Hum Genet</source><year>2016</year>;<volume>17</volume><bold>:</bold><fpage>353</fpage>–<lpage>73</lpage>.<pub-id pub-id-type="pmid">27147087</pub-id></mixed-citation>
    </ref>
    <ref id="dyx204-B2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Millard</surname><given-names>LAC</given-names></name>, <name name-style="western"><surname>Davies</surname><given-names>NM</given-names></name>, <name name-style="western"><surname>Timpson</surname><given-names>NJ</given-names></name>, <name name-style="western"><surname>Tilling</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Flach</surname><given-names>PA</given-names></name>, <name name-style="western"><surname>Davey Smith</surname><given-names>G</given-names></name></person-group><article-title>MR-PheWAS: hypothesis prioritization among potential causal effects of body mass index on many outcomes, using Mendelian randomization</article-title>. <source>Sci Rep</source><year>2015</year>;<volume>5</volume><bold>:</bold><fpage>16645</fpage>.<pub-id pub-id-type="pmid">26568383</pub-id></mixed-citation>
    </ref>
    <ref id="dyx204-B3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tzoulaki</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Patel</surname><given-names>CJ</given-names></name>, <name name-style="western"><surname>Okamura</surname><given-names>T</given-names></name></person-group>, <etal/><article-title>A nutrient-wide association study on blood pressure</article-title>. <source>Circulation</source><year>2012</year>;<volume>126</volume><bold>:</bold><fpage>2456</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">23093587</pub-id></mixed-citation>
    </ref>
    <ref id="dyx204-B4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Patel</surname><given-names>CJ</given-names></name>, <name name-style="western"><surname>Bhattacharya</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Butte</surname><given-names>AJ</given-names></name></person-group><article-title>An environment-wide association study (EWAS) on type 2 diabetes mellitus</article-title>. <source><italic toggle="yes">PLoS One</italic></source><year>2010</year>;<volume>5</volume><bold>:</bold><fpage>e10746</fpage>.<pub-id pub-id-type="pmid">20505766</pub-id></mixed-citation>
    </ref>
    <ref id="dyx204-B5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Denny</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Ritchie</surname><given-names>MD</given-names></name>, <name name-style="western"><surname>Basford</surname><given-names>MA</given-names></name></person-group>, <etal/><article-title>PheWAS: demonstrating the feasibility of a phenome-wide scan to discover gene–disease associations</article-title>. <source>Bioinformatics</source><year>2010</year>;<volume>26</volume><bold>:</bold><fpage>1205</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">20335276</pub-id></mixed-citation>
    </ref>
    <ref id="dyx204-B6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Allen</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Sudlow</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Downey</surname><given-names>P</given-names></name></person-group>, <etal/><article-title>UK Biobank: Current status and what it means for epidemiology</article-title>. <source>Health Policy Technol</source><year>2012</year>;<volume>1</volume><bold>:</bold><fpage>123</fpage>–<lpage>26</lpage>.</mixed-citation>
    </ref>
    <ref id="dyx204-B7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Davey Smith</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Ebrahim</surname><given-names>S</given-names></name></person-group><article-title>‘Mendelian randomization’: can genetic epidemiology contribute to understanding environmental determinants of disease?</article-title><source>Int J Epidemiol</source><year>2003</year>;<volume>32</volume><bold>:</bold><fpage>1</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">12689998</pub-id></mixed-citation>
    </ref>
    <ref id="dyx204-B8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Locke</surname><given-names>AE</given-names></name>, <name name-style="western"><surname>Kahali</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Berndt</surname><given-names>SI</given-names></name></person-group>, <etal/><article-title>Genetic studies of body mass index yield new insights for obesity biology</article-title>. <source>Nature</source><year>2015</year>;<volume>518</volume><bold>:</bold><fpage>197</fpage>–<lpage>206</lpage>.<pub-id pub-id-type="pmid">25673413</pub-id></mixed-citation>
    </ref>
    <ref id="dyx204-B9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Timpson</surname><given-names>NJ</given-names></name>, <name name-style="western"><surname>Harbord</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Davey Smith</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Zacho</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Tybjærg-Hansen</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Nordestgaard</surname><given-names>BG</given-names></name></person-group><article-title>Does greater adiposity increase blood pressure and hypertension risk? Mendelian randomization using the FTO/MC4R genotype</article-title>. <source>Hypertension</source><year>2009</year>;<volume>54</volume><bold>:</bold><fpage>84</fpage>–<lpage>90</lpage>.<pub-id pub-id-type="pmid">19470880</pub-id></mixed-citation>
    </ref>
    <ref id="dyx204-B10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Holmes</surname><given-names>MV</given-names></name>, <name name-style="western"><surname>Lange</surname><given-names>LA</given-names></name>, <name name-style="western"><surname>Palmer</surname><given-names>T</given-names></name></person-group>, <etal/><article-title>Causal effects of body mass index on cardiometabolic traits and events: a Mendelian randomization analysis</article-title>. <source>Am J Hum Genet</source><year>2014</year>;<volume>94</volume><bold>:</bold><fpage>198</fpage>–<lpage>208</lpage>.<pub-id pub-id-type="pmid">24462370</pub-id></mixed-citation>
    </ref>
    <ref id="dyx204-B11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mumby</surname><given-names>HS</given-names></name>, <name name-style="western"><surname>Elks</surname><given-names>CE</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>S</given-names></name></person-group>, <etal/><article-title>Mendelian randomisation study of childhood BMI and early menarche</article-title>. <source>J Obes</source><year>2011</year>;<volume>2011</volume><bold>:</bold><fpage>180729</fpage>.<pub-id pub-id-type="pmid">21773002</pub-id></mixed-citation>
    </ref>
    <ref id="dyx204-B12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>VanderWeele</surname><given-names>TJ</given-names></name></person-group><article-title>Outcome-wide epidemiology</article-title>. <source>Epidemiology</source><year>2017</year>;<volume>28</volume><bold>:</bold><fpage>399</fpage>–<lpage>402</lpage><pub-id pub-id-type="pmid">28166102</pub-id></mixed-citation>
    </ref>
    <ref id="dyx204-B13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cao</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Rajan</surname><given-names>SS</given-names></name>, <name name-style="western"><surname>Wei</surname><given-names>P</given-names></name></person-group><article-title>Mendelian randomization analysis of a time-varying exposure for binary disease outcomes using functional data analysis methods</article-title>. <source>Genet Epidemiol</source><year>2016</year>;<volume>40</volume><bold>:</bold><fpage>744</fpage>–<lpage>55</lpage>.<pub-id pub-id-type="pmid">27813215</pub-id></mixed-citation>
    </ref>
    <ref id="dyx204-B14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hemani</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Zheng</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Wade</surname><given-names>KH</given-names></name></person-group>, <etal/><article-title>MR-Base: a platform for systematic causal inference across the phenome using billions of genetic associations</article-title>. <source>bioRxiv</source><year>2016</year>; <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/078972">https://doi.org/10.1101/078972</ext-link></comment>.</mixed-citation>
    </ref>
    <ref id="dyx204-B15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Emdin</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Khera</surname><given-names>AV</given-names></name>, <name name-style="western"><surname>Natarajan</surname><given-names>P</given-names></name></person-group>, <etal/><article-title>Phenotypic characterization of genetically lowered human lipoprotein (a) levels</article-title>. <source>J Am Coll Cardiol</source><year>2016</year>;<volume>68</volume><bold>:</bold><fpage>2761</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">28007139</pub-id></mixed-citation>
    </ref>
    <ref id="dyx204-B16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cortes</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Dendrou</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Motyer</surname><given-names>A</given-names></name></person-group>, <etal/><article-title>Bayesian analysis of genetic association across tree-structured routine healthcare data in the UK Biobank</article-title>. <source>bioRxiv</source><year>2017</year>; <comment><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/105122">https://doi.org/10.1101/105122</ext-link></comment>.</mixed-citation>
    </ref>
  </ref-list>
</back>
