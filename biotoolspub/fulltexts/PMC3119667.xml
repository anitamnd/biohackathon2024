<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20031101//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3119667</article-id>
    <article-id pub-id-type="pmid">21712981</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-11-02649</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0020892</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Comparative Genomics</subject>
              <subject>Genome Analysis Tools</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Molecular Genetics</subject>
            <subj-group>
              <subject>Gene Duplication</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Evolutionary Modeling</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Evolutionary Biology</subject>
        </subj-group>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Molecular Genetics</subject>
            <subj-group>
              <subject>Gene Duplication</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genomics</subject>
          <subj-group>
            <subject>Genome Databases</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MultiMSOAR 2.0: An Accurate Tool to Identify Ortholog Groups among Multiple Genomes</article-title>
      <alt-title alt-title-type="running-head">Identify Ortholog Groups among Multiple Genomes</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Shi</surname>
          <given-names>Guanqun</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Peng</surname>
          <given-names>Meng-Chih</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jiang</surname>
          <given-names>Tao</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <addr-line>Department of Computer Science, University of California Riverside, Riverside, California, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Aerts</surname>
          <given-names>Stein</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">University of Leuven, Belgium</aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>gshi@cs.ucr.edu</email></corresp>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: GS MP TJ. Performed the experiments: GS. Analyzed the data: GS. Contributed reagents/materials/analysis tools: GS TJ. Wrote the paper: GS TJ.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>6</month>
      <year>2011</year>
    </pub-date>
    <volume>6</volume>
    <issue>6</issue>
    <elocation-id>e20892</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>2</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>5</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Shi et al.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>The identification of orthologous genes shared by multiple genomes plays an important role in evolutionary studies and gene functional analyses. Based on a recently developed accurate tool, called MSOAR 2.0, for ortholog assignment between a pair of closely related genomes based on genome rearrangement, we present a new system MultiMSOAR 2.0, to identify ortholog groups among multiple genomes in this paper. In the system, we construct gene families for all the genomes using sequence similarity search and clustering, run MSOAR 2.0 for all pairs of genomes to obtain the pairwise orthology relationship, and partition each gene family into a set of disjoint sets of orthologous genes (called <italic>super ortholog groups</italic> or <italic>SOGs</italic>) such that each SOG contains at most one gene from each genome. For each such SOG, we label the leaves of the species tree using 1 or 0 to indicate if the SOG contains a gene from the corresponding species or not. The resulting tree is called a <italic>tree of ortholog groups</italic> (or <italic>TOGs</italic>). We then label the internal nodes of each TOG based on the parsimony principle and some biological constraints. Ortholog groups are finally identified from each fully labeled TOG. In comparison with a popular tool MultiParanoid on simulated data, MultiMSOAR 2.0 shows significantly higher prediction accuracy. It also outperforms MultiParanoid, the Roundup multi-ortholog repository and the Ensembl ortholog database in real data experiments using gene symbols as a validation tool. In addition to ortholog group identification, MultiMSOAR 2.0 also provides information about gene births, duplications and losses in evolution, which may be of independent biological interest. Our experiments on simulated data demonstrate that MultiMSOAR 2.0 is able to infer these evolutionary events much more accurately than a well-known software tool Notung. The software MultiMSOAR 2.0 is available to the public for free.</p>
    </abstract>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>The ever-increasing number of completely sequenced genomes brings great opportunities as well as challenges to the study of comparative genomics. It makes the study of the evolutionary history of closely related species at the genome level possible. It also enhances our ability to perform gene functional analyses across different species. For these purposes as well as many other applications, the identification of orthologous genes across different species often serves as a starting point.</p>
    <sec id="s1a">
      <title>Definitions</title>
      <p>Orthologous genes (<italic>i.e., orthologs</italic>) are genes in different genomes that evolved from a common ancestral gene through speciation events <xref rid="pone.0020892-Fitch1" ref-type="bibr">[1]</xref>. They are more likely to preserve the original gene function. As a result, orthologs are often used as universal and unique landmarks within each genome as well as links across different genomes <xref rid="pone.0020892-Jiang1" ref-type="bibr">[2]</xref>.</p>
      <p>Orthology between two genomes is usually thought of as a many-to-many relationship due to post-speciation gene duplications <xref rid="pone.0020892-Vilella1" ref-type="bibr">[3]</xref>. However, if we know which genes are the direct descendants of the ancestral genes and which are duplicated after the speciation, then we can define a one-to-one orthology relationship between the two direct descendant genes of each ancestral gene (such a pair of genes are said to form an <italic>ortholog pair</italic>), while treating the duplicated genes as inparalogs <xref rid="pone.0020892-Remm1" ref-type="bibr">[4]</xref>, <xref rid="pone.0020892-Shi1" ref-type="bibr">[5]</xref>.</p>
      <p>When multiple genomes are being compared, the orthology relationship is more complicated because of the interleaving between speciation and gene duplication events. In this paper, we extend the above one-to-one orthology relationship between a pair of genomes to multiple genomes in a straightforward way and define an <italic>ortholog group</italic> for a given set of genomes as a maximal set of genes (from different genomes) that are the direct descendants of the same ancestral gene. Note that the genes in such an ortholog group are not separated by any gene duplication. Hence, this definition, although a bit stringent, is faithful to the original definition of orthology in Ref. <xref rid="pone.0020892-Fitch1" ref-type="bibr">[1]</xref>. For example, according to this definition, there are 4 ortholog groups in <xref ref-type="fig" rid="pone-0020892-g001">Figure 1(b)</xref>: (<inline-formula><inline-graphic xlink:href="pone.0020892.e001.jpg" mimetype="image"/></inline-formula>), (<inline-formula><inline-graphic xlink:href="pone.0020892.e002.jpg" mimetype="image"/></inline-formula>), (<inline-formula><inline-graphic xlink:href="pone.0020892.e003.jpg" mimetype="image"/></inline-formula>), (<inline-formula><inline-graphic xlink:href="pone.0020892.e004.jpg" mimetype="image"/></inline-formula>). We note in passing that other more general definitions of ortholog groups have been considered in the literature and used in popular orthology databases such as COG <xref rid="pone.0020892-Tatusov1" ref-type="bibr">[6]</xref> and EnsemblCompara <xref rid="pone.0020892-Vilella1" ref-type="bibr">[3]</xref>. In these definitions, orthology is considered as a many-to-many relationship and thus paralogs (<italic>i.e.</italic>, genes that are separated by duplications) are often allowed in an ortholog group. We prefer treating orthology as a one-to-one relationship because it makes the presentation of the paper simpler and validation of our results cleaner. Moreover, the one-to-one orthology relationship can be thought of as a refinement of the more general many-to-many relationship.</p>
      <fig id="pone-0020892-g001" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0020892.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>An example of genome evolution and TOGs.</title>
          <p>(a) The species tree for four species: <inline-formula><inline-graphic xlink:href="pone.0020892.e005.jpg" mimetype="image"/></inline-formula>. (b) An example of genome evolution for the four species in (a). (c) The TOG for genes <inline-formula><inline-graphic xlink:href="pone.0020892.e006.jpg" mimetype="image"/></inline-formula> in (b). (d) The TOG for genes <inline-formula><inline-graphic xlink:href="pone.0020892.e007.jpg" mimetype="image"/></inline-formula> in (b). (e) The TOG for gene <inline-formula><inline-graphic xlink:href="pone.0020892.e008.jpg" mimetype="image"/></inline-formula> in (b). Note that, in this paper, we will only be interested in ortholog groups containing at least two genes, and singleton ortholog groups will be ignored since they consist of only inparalogs from individual genomes. (f) The TOG for genes <inline-formula><inline-graphic xlink:href="pone.0020892.e009.jpg" mimetype="image"/></inline-formula> in (b). (g) An example of a TOG labeling. The labeling suggests two ortholog groups in the TOG, one consisting of two genes from the two leftmost species and the other two genes from the last three species.</p>
        </caption>
        <graphic xlink:href="pone.0020892.g001"/>
      </fig>
    </sec>
    <sec id="s1b">
      <title>Existing Ortholog Assignment Tools</title>
      <p>Most of the traditional ortholog identification methods are based on sequence similarity search, such as COG/KOG <xref rid="pone.0020892-Tatusov1" ref-type="bibr">[6]</xref>, OrthoMCL <xref rid="pone.0020892-Li1" ref-type="bibr">[7]</xref>, InParanoid/MultiParanoid <xref rid="pone.0020892-Remm1" ref-type="bibr">[4]</xref>, <xref rid="pone.0020892-Berglund1" ref-type="bibr">[8]</xref> and HomoloGene <xref rid="pone.0020892-Wheeler1" ref-type="bibr">[9]</xref>. Generally speaking, these methods first calculate some pairwise similarity scores and then use some clustering algorithms to identify ortholog pairs or groups. Take the InParanoid program for example. It assigns a gene pair with the bidirectional best hit (<italic>i.e., BBH</italic>) as a main ortholog pair and uses it as the “seed” to cluster similar genes from both genomes into an ortholog group. As its extension to multiple genomes, the MultiParanoid program basically clusters the pairwise orthology results of InParanoid to generate ortholog groups for multiple genomes. Though the BBH requirement for a main ortholog pair seems to be reasonable when comparing two genomes, it becomes too stringent when comparing multiple genomes. As a result, the MultiParanoid program may miss a lot of true ortholog groups when some of the ortholog pairs are not BBHs. OrthoMCL is an ortholog assignment program similar to InParanoid, but uses a different clustering algorithm (the Markov Clustering algorithm, or <italic>MCL</italic>) to find ortholog groups for multiple genomes. However, it cannot resolve the many-to-many orthology relationship among multiple genomes effectively. As a result, the ortholog groups found by OrthoMCL may include lots of “recent” inparalogs from each genome <xref rid="pone.0020892-Li1" ref-type="bibr">[7]</xref>.</p>
      <p>Another popular method to identify orthologs is based on phylogenetic trees, such as TreeFam <xref rid="pone.0020892-Li2" ref-type="bibr">[10]</xref>, PhyOP <xref rid="pone.0020892-Goodstadt1" ref-type="bibr">[11]</xref>, and EnsemblCompara GeneTrees <xref rid="pone.0020892-Vilella1" ref-type="bibr">[3]</xref>. A phylogeny can be used conveniently to represent the evolution of a gene family. However, tree-based methods generally present orthology as a many-to-many relationship. Most of them can never tell the “parent-daughter” relationships among duplicated genes <xref rid="pone.0020892-Han1" ref-type="bibr">[12]</xref>. As a result, most tree-based methods cannot differentiate orthologs that are direct descendants of an ancestral gene and those inparalogs that are products of recent duplications. Consequently, each ortholog group found by these methods tends to include lots of lineage-specific duplicated inparalogs.</p>
      <p>By taking other information into consideration, such as gene positions and genome rearrangement, some combinatorial approaches have been proposed in recent years. CCCPart is a synteny-based approach to find orthologs based on the assumption that isofunctional genes are well preserved both in common gene neighborhood as well as in sequence similarity between two or more species <xref rid="pone.0020892-Boyer1" ref-type="bibr">[13]</xref>, <xref rid="pone.0020892-Denilou1" ref-type="bibr">[14]</xref>. However, it is known that genome rearrangement is very common between closely related genomes <xref rid="pone.0020892-Hannenhalli1" ref-type="bibr">[15]</xref>–<xref rid="pone.0020892-Semon1" ref-type="bibr">[18]</xref>. In fact, there might be many microrearrangments even within the same synteny block <xref rid="pone.0020892-Pevzner1" ref-type="bibr">[17]</xref>. Based on genome rearrangement, a high-throughput ortholog assignment system called MSOAR <xref rid="pone.0020892-Fu1" ref-type="bibr">[19]</xref> has been developed. It is based on the assumption that orthologs should correspond to each other on the evolutionary path that minimizes the number of rearrangements and post-speciation duplications. By dealing with tandem gene duplications explicitly using a phylogenetic approach, an improved system MSOAR 2.0 was recently reported in Ref. <xref rid="pone.0020892-Shi1" ref-type="bibr">[5]</xref>, which has been shown to outperform the original system MSOAR in terms of prediction accuracy. However, MSOAR and MSOAR 2.0 can only assign orthologs between two genomes. As an extension to MSOAR, MultiMSOAR tries to assign orthologs among multiple genomes by using a simple clustering method based on the pairwise results of MSOAR <xref rid="pone.0020892-Fu2" ref-type="bibr">[20]</xref>. However, the MultiMSOAR program can actually handle only three genomes well. When more genomes are involved, MultiMSOAR may not find ortholog groups accurately because it does not take into account the phylogenetic relationship among the genomes. Furthermore, MultiMSOAR only considers those ortholog clusters that do not have gene losses in any species to be ortholog groups. This constraint might be acceptable for three closely related species, but it is too stringent when considering more species, since we expect to see many gene births and losses as well as duplications in the evolutionary history. As a consequence, we should allow gene losses within an ortholog group and ortholog groups to be composed of genes from a subset of the genomes.</p>
    </sec>
    <sec id="s1c">
      <title>Current Work</title>
      <p>In this paper, we develop a system called MultiMSOAR 2.0 to identify ortholog groups for multiple genomes. In addition to being an extension of MSOAR 2.0 to multiple genomes, MultiMSOAR 2.0 presents a new combinatorial approach for constructing ortholog groups. Compared with MultiMSOAR, MultiMSOAR 2.0 allows gene losses within an ortholog group and ortholog groups involving genes only from a subset of the genomes. It also attempts to minimize the number of gene births, losses and duplications within a gene family when assigning ortholog groups. Moreover, compared with many other ortholog assignment tools for multiple genomes, MultiMSOAR 2.0 can provide more information about genome evolution in terms of gene births, losses as well as duplications.</p>
      <p>An outline of MultiMSOAR 2.0 is shown in <xref ref-type="fig" rid="pone-0020892-g002">Figure 2</xref>. In short, MultiMSOAR 2.0 constructs gene families for all the genomes first by using sequence similarity search (<italic>i.e.</italic>, BLASTp) and the clustering algorithm MCL as done in Ref. <xref rid="pone.0020892-Shi1" ref-type="bibr">[5]</xref>. Then it applies MSOAR 2.0 to find ortholog pairs between all pairs of genomes. After that, it builds a weighted multipartite graph using the pairwise orthology information and sequence similarity between each pair of orthologs and attempts to find a maximum weight matching for each gene family. Then it partitions each family into a set of disjoint sets of orthologous genes (called <italic>super ortholog groups</italic> or <italic>SOGs</italic>) such that each SOG contains at most one gene from each genome. Each such SOG may potentially consist of several ortholog groups. In order to partition a SOG into ortholog groups, MultiMSOAR 2.0 labels the leaves of the species tree using 1 or 0 to indicate if the SOG contains a gene from the corresponding species or not. The resulting tree is called a <italic>tree of ortholog groups</italic> (or <italic>TOGs</italic>). MultiMSOAR 2.0 then employs one of the two algorithms devised in this paper (called the <italic>NodeCentric</italic> and <italic>TreeCentric</italic> algorithms) to label the internal nodes of each TOG based on the parsimony principle and some biological constraints. Ortholog groups can then be trivially identified from each fully labeled TOG. The details of each of the main steps in <xref ref-type="fig" rid="pone-0020892-g002">Figure 2</xref> are explained in the <xref ref-type="sec" rid="s2">Methods</xref> section. Note that each ortholog group found by MultiMSOAR 2.0 is contained in some TOG but a TOG may contain several ortholog groups. An example is shown in <xref ref-type="fig" rid="pone-0020892-g001">Figure 1(g)</xref>, where the TOG contains two ortholog groups and the second ortholog group contains a gene loss.</p>
      <fig id="pone-0020892-g002" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0020892.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>An outline of MultiMSOAR 2.0.</title>
        </caption>
        <graphic xlink:href="pone.0020892.g002"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="methods" id="s2">
    <title>Methods</title>
    <sec id="s2a">
      <title>Homology Search and Gene Family Construction</title>
      <p>Since we have multiple genomes, we define a gene family to consist of all homologous genes on all the genomes under study. As in Ref. <xref rid="pone.0020892-Shi1" ref-type="bibr">[5]</xref>, <xref rid="pone.0020892-Fu1" ref-type="bibr">[19]</xref>, only protein coding genes will be considered. For genes with alternative splicing variants, we use their longest transcripts. Similar methods have been used in previous studies <xref rid="pone.0020892-Shi1" ref-type="bibr">[5]</xref>, <xref rid="pone.0020892-Shoja1" ref-type="bibr">[21]</xref>. To cluster all the genes into gene families, we combine all protein sequences from all genomes together, and perform an all-vs-all BLASTp homology search <xref rid="pone.0020892-Altschul1" ref-type="bibr">[22]</xref>. Then we use the popular clustering program MCL <xref rid="pone.0020892-Enright1" ref-type="bibr">[23]</xref> to construct gene families. Similar methods have been used in many other papers <xref rid="pone.0020892-Li1" ref-type="bibr">[7]</xref>, <xref rid="pone.0020892-Li2" ref-type="bibr">[10]</xref>, <xref rid="pone.0020892-Shoja1" ref-type="bibr">[21]</xref>.</p>
    </sec>
    <sec id="s2b">
      <title>Pairwise Genome Comparison</title>
      <p>Since we try to identify ortholog groups among multiple genomes based on pairwise comparison, the prediction accuracy of ortholog pairs between two genomes is critical for the performance of our multiple genome system. MSOAR 2.0 has shown to be the most accurate prediction tool for assigning one-to-one ortholog pairs between two closely related genomes <xref rid="pone.0020892-Shi1" ref-type="bibr">[5]</xref>. So, it is preferable to use the output of MSOAR 2.0 as the input to our current system. For a comparison among <inline-formula><inline-graphic xlink:href="pone.0020892.e010.jpg" mimetype="image"/></inline-formula> genomes, we apply MSOAR 2.0 to all pairs of the <inline-formula><inline-graphic xlink:href="pone.0020892.e011.jpg" mimetype="image"/></inline-formula> genomes, and use the <inline-formula><inline-graphic xlink:href="pone.0020892.e012.jpg" mimetype="image"/></inline-formula> pairwise comparison results to define a multipartite for each gene family to be partitioned in MultiMSOAR 2.0.</p>
    </sec>
    <sec id="s2c">
      <title>Partition of Each Gene Family into TOGs</title>
      <p>In our definition of ortholog groups, each group may include at most one gene from each genome. However, a gene family may include many homologous genes from each genome (<italic>i.e.</italic>, paralogs), making it necessary to split the genes in a family into TOGs, such that each TOG contains at most one gene from every genome. This is done by employing a heuristic maximum weight <inline-formula><inline-graphic xlink:href="pone.0020892.e013.jpg" mimetype="image"/></inline-formula>-dimensional matching algorithm as follows. Similar methods have been used in Ref. <xref rid="pone.0020892-Fu2" ref-type="bibr">[20]</xref>, <xref rid="pone.0020892-Vashist1" ref-type="bibr">[24]</xref>.</p>
      <p>Suppose we have <inline-formula><inline-graphic xlink:href="pone.0020892.e014.jpg" mimetype="image"/></inline-formula> genomes, <inline-formula><inline-graphic xlink:href="pone.0020892.e015.jpg" mimetype="image"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0020892.e016.jpg" mimetype="image"/></inline-formula>. For a given gene family, the number of genes from each genome are denoted as <inline-formula><inline-graphic xlink:href="pone.0020892.e017.jpg" mimetype="image"/></inline-formula>. We can construct an <inline-formula><inline-graphic xlink:href="pone.0020892.e018.jpg" mimetype="image"/></inline-formula>-partite (or <inline-formula><inline-graphic xlink:href="pone.0020892.e019.jpg" mimetype="image"/></inline-formula>-stage) graph <inline-formula><inline-graphic xlink:href="pone.0020892.e020.jpg" mimetype="image"/></inline-formula> with <inline-formula><inline-graphic xlink:href="pone.0020892.e021.jpg" mimetype="image"/></inline-formula> (<inline-formula><inline-graphic xlink:href="pone.0020892.e022.jpg" mimetype="image"/></inline-formula>) vertices in the part corresponding to genome <inline-formula><inline-graphic xlink:href="pone.0020892.e023.jpg" mimetype="image"/></inline-formula> (called stage <inline-formula><inline-graphic xlink:href="pone.0020892.e024.jpg" mimetype="image"/></inline-formula>). We add edges to <inline-formula><inline-graphic xlink:href="pone.0020892.e025.jpg" mimetype="image"/></inline-formula> by using the pairwise orthology information produced by MSOAR 2.0. Specifically, we add an edge between two vertices in <inline-formula><inline-graphic xlink:href="pone.0020892.e026.jpg" mimetype="image"/></inline-formula> if and only if the corresponding two genes are from two different genomes and they are assigned as an ortholog pair by MSOAR 2.0. We assign a weight to such an edge, which is the BLASTp similarity score between the ortholog pair.</p>
      <p>Since we would like to obtain a perfect <inline-formula><inline-graphic xlink:href="pone.0020892.e027.jpg" mimetype="image"/></inline-formula>-dimensional matching with the maximum weight among the <inline-formula><inline-graphic xlink:href="pone.0020892.e028.jpg" mimetype="image"/></inline-formula> stages, we need to add some dummy vertices to some of the stages in <inline-formula><inline-graphic xlink:href="pone.0020892.e029.jpg" mimetype="image"/></inline-formula> to make them all have the same number of vertices. Let <inline-formula><inline-graphic xlink:href="pone.0020892.e030.jpg" mimetype="image"/></inline-formula> be the maximum number of paralogs on any genome in the gene family. Then we add <inline-formula><inline-graphic xlink:href="pone.0020892.e031.jpg" mimetype="image"/></inline-formula> (<inline-formula><inline-graphic xlink:href="pone.0020892.e032.jpg" mimetype="image"/></inline-formula>) dummy vertices to the <inline-formula><inline-graphic xlink:href="pone.0020892.e033.jpg" mimetype="image"/></inline-formula>-th stage. The maximum (<inline-formula><inline-graphic xlink:href="pone.0020892.e034.jpg" mimetype="image"/></inline-formula>-dimensional) matching problem for <inline-formula><inline-graphic xlink:href="pone.0020892.e035.jpg" mimetype="image"/></inline-formula>-partite graphs (where <inline-formula><inline-graphic xlink:href="pone.0020892.e036.jpg" mimetype="image"/></inline-formula>) is known to be NP-hard <xref rid="pone.0020892-Kann1" ref-type="bibr">[25]</xref>, and <inline-formula><inline-graphic xlink:href="pone.0020892.e037.jpg" mimetype="image"/></inline-formula> could be large for a real gene family when a large number of genomes are considered. So, we will use a heuristic optimization approach to find a good matching. Since the maximum weight matching for a bipartite graph can be computed by the Hungarian algorithm in cubic time <xref rid="pone.0020892-Kuhn1" ref-type="bibr">[26]</xref>, we first find a maximum weight bipartite matching for two stages in <inline-formula><inline-graphic xlink:href="pone.0020892.e038.jpg" mimetype="image"/></inline-formula>, combine them into one stage, and apply the Hungarian algorithm iteratively on the remaining stages in <inline-formula><inline-graphic xlink:href="pone.0020892.e039.jpg" mimetype="image"/></inline-formula> until only one stage is left. This results in a matching for the original <inline-formula><inline-graphic xlink:href="pone.0020892.e040.jpg" mimetype="image"/></inline-formula>-partite graph <inline-formula><inline-graphic xlink:href="pone.0020892.e041.jpg" mimetype="image"/></inline-formula>. This approach is very similar to the method used in MultiMSOAR <xref rid="pone.0020892-Fu2" ref-type="bibr">[20]</xref>, except that we use a post-order traversal on the species tree to decide the order that stages are combined. This way, a stage is always combined with another stage that is close to it on the species tree. Another difference is that we use the bit score as the weight of an edge in <inline-formula><inline-graphic xlink:href="pone.0020892.e042.jpg" mimetype="image"/></inline-formula>. If there is no edge between two vertices in different stages, we deem that there is an edge with weight <inline-formula><inline-graphic xlink:href="pone.0020892.e043.jpg" mimetype="image"/></inline-formula> between them.</p>
      <p>An example of the gene family partition is shown in <xref ref-type="fig" rid="pone-0020892-g001">Figure 1</xref>, where the figures in (c), (d), (e) represent 3 TOGs for the <inline-formula><inline-graphic xlink:href="pone.0020892.e044.jpg" mimetype="image"/></inline-formula> gene family while <xref ref-type="fig" rid="pone-0020892-g001">Figure 1(f)</xref> represents a single TOG for the <inline-formula><inline-graphic xlink:href="pone.0020892.e045.jpg" mimetype="image"/></inline-formula> gene family.</p>
    </sec>
    <sec id="s2d">
      <title>Labeling of TOGs</title>
      <p>In order to identify ortholog groups within a TOG, we need to label the internal nodes (which correspond to ancestral genomes) using binary representations as well. Here, <inline-formula><inline-graphic xlink:href="pone.0020892.e046.jpg" mimetype="image"/></inline-formula> means that the a gene is present in the corresponding ancestral genome while <inline-formula><inline-graphic xlink:href="pone.0020892.e047.jpg" mimetype="image"/></inline-formula> means absence. Two constraints will be assumed:</p>
      <list list-type="order">
        <list-item>
          <p><italic>Intratree constraint</italic>: If node <inline-formula><inline-graphic xlink:href="pone.0020892.e048.jpg" mimetype="image"/></inline-formula> is labeled with a 0 and <inline-formula><inline-graphic xlink:href="pone.0020892.e049.jpg" mimetype="image"/></inline-formula> has an ancestral node that is labeled with a 1, then every descendant node of <inline-formula><inline-graphic xlink:href="pone.0020892.e050.jpg" mimetype="image"/></inline-formula> must be labeled with a 0.</p>
        </list-item>
        <list-item>
          <p><italic>Intertree constraint</italic>: Suppose that <inline-formula><inline-graphic xlink:href="pone.0020892.e051.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0020892.e052.jpg" mimetype="image"/></inline-formula> are two nodes such that each of them is labeled with a 1 in at least one TOG. Then every node on the path connecting <inline-formula><inline-graphic xlink:href="pone.0020892.e053.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0020892.e054.jpg" mimetype="image"/></inline-formula> must be labeled with a 1 in at least one TOG.</p>
        </list-item>
      </list>
      <p>The intertree constraint makes sure that no gene is born twice in evolution, which is a commonly accepted hypothesis in molecular evolution since double gene birth events are extremely rare. The intratree constraint follows from the definition of orthology (that orthologs evolved through speciation only).</p>
      <p>Among all the labelings of the TOGs satisfying the above two constraints, we would like to find one that minimizes the number of gene births, duplications and losses in the evolution of the family. Since each edge of a TOG whose nodes are labeled with 01 or 10 represents a gene birth/duplication or a gene loss, we need to find a parsimonious way to label the internal nodes so that the number of 01 or 10 edges is minimized. For simplicity, let us call a 01 or 10 change on an edge a <italic>flip</italic>.</p>
      <p>We can now formulate the TOG labeling problem as a combinatorial optimization problem as follows:</p>
      <p>
        <bold>
          <italic>TOG Labeling:</italic>
        </bold>
        <italic> Given </italic>
        <inline-formula>
          <inline-graphic xlink:href="pone.0020892.e055.jpg" mimetype="image"/>
        </inline-formula>
        <italic> TOGs, find a binary labeling of all the internal nodes of the TOGs so that both intratree and intertree constraints are satisfied and the total number of flips is minimized.</italic>
      </p>
      <p>The problem can be solved by a trivial exhaustive search algorithm that considers all possible labelings of the TOGs. However, since a binary tree with <inline-formula><inline-graphic xlink:href="pone.0020892.e056.jpg" mimetype="image"/></inline-formula> leaves has <inline-formula><inline-graphic xlink:href="pone.0020892.e057.jpg" mimetype="image"/></inline-formula> internal nodes, this algorithm runs in time O(<inline-formula><inline-graphic xlink:href="pone.0020892.e058.jpg" mimetype="image"/></inline-formula>), which is impractical even if <inline-formula><inline-graphic xlink:href="pone.0020892.e059.jpg" mimetype="image"/></inline-formula>. We need to find more efficient solutions to this problem.</p>
      <p>Before we proceed with our algorithms, we first prove the following two lemmas, which will help accelerate the speed of our labeling algorithm.</p>
      <p>
        <bold>Lemma 1</bold>
        <italic>If two child nodes are labeled as </italic>
        <inline-formula>
          <inline-graphic xlink:href="pone.0020892.e060.jpg" mimetype="image"/>
        </inline-formula>
        <italic>, then in any optimal labeling, their parent node must be labeled as </italic>
        <inline-formula>
          <inline-graphic xlink:href="pone.0020892.e061.jpg" mimetype="image"/>
        </inline-formula>
        <italic>.</italic>
      </p>
      <p><italic>Proof</italic>. Suppose that in an optimal labeling <inline-formula><inline-graphic xlink:href="pone.0020892.e062.jpg" mimetype="image"/></inline-formula>, an internal node <inline-formula><inline-graphic xlink:href="pone.0020892.e063.jpg" mimetype="image"/></inline-formula> is labeled as 0 in some TOG but both of its children are labeled as 1. If we change the label of <inline-formula><inline-graphic xlink:href="pone.0020892.e064.jpg" mimetype="image"/></inline-formula> to 1, the two constraints will not be violated, and there will be two fewer flips on the two edges from <inline-formula><inline-graphic xlink:href="pone.0020892.e065.jpg" mimetype="image"/></inline-formula> to its two children. Even if this change might incur a new flip on the edge from <inline-formula><inline-graphic xlink:href="pone.0020892.e066.jpg" mimetype="image"/></inline-formula> to its parent node, the total number of flips will still be reduced. This is a contradiction to the assumption that <inline-formula><inline-graphic xlink:href="pone.0020892.e067.jpg" mimetype="image"/></inline-formula> is an optimal labeling, which completes our proof.</p>
      <p>
        <bold>Lemma 2</bold>
        <italic>If two child nodes are labeled as </italic>
        <inline-formula>
          <inline-graphic xlink:href="pone.0020892.e068.jpg" mimetype="image"/>
        </inline-formula>
        <italic>, then there is an optimal labeling, where their parent node is labeled as </italic>
        <inline-formula>
          <inline-graphic xlink:href="pone.0020892.e069.jpg" mimetype="image"/>
        </inline-formula>
        <italic>.</italic>
      </p>
      <p><italic>Proof</italic>. Suppose that an internal node <inline-formula><inline-graphic xlink:href="pone.0020892.e070.jpg" mimetype="image"/></inline-formula> of some TOG <inline-formula><inline-graphic xlink:href="pone.0020892.e071.jpg" mimetype="image"/></inline-formula> is labeled as 1 while both of its children are labeled as 0 in some optimal labeling. If we change the label of <inline-formula><inline-graphic xlink:href="pone.0020892.e072.jpg" mimetype="image"/></inline-formula> to 0, it is easy to see that the intratree constraint will not be violated. However, the intertree constraint might be violated if the node <inline-formula><inline-graphic xlink:href="pone.0020892.e073.jpg" mimetype="image"/></inline-formula> is also labeled as 0 in all other TOGs. Then, according to Lemma 1, the two child nodes of <inline-formula><inline-graphic xlink:href="pone.0020892.e074.jpg" mimetype="image"/></inline-formula> cannot be labeled as 1 at the same time in each of the other TOGs. If each of the two child nodes of <inline-formula><inline-graphic xlink:href="pone.0020892.e075.jpg" mimetype="image"/></inline-formula> is labeled as 0 in all other TOGs, then we are safe to change the label of <inline-formula><inline-graphic xlink:href="pone.0020892.e076.jpg" mimetype="image"/></inline-formula> from 1 to 0 in the TOG <inline-formula><inline-graphic xlink:href="pone.0020892.e077.jpg" mimetype="image"/></inline-formula> since the change will not violate the intertree constraint. Otherwise, there is at least one TOG <inline-formula><inline-graphic xlink:href="pone.0020892.e078.jpg" mimetype="image"/></inline-formula>, in which the two child nodes of <inline-formula><inline-graphic xlink:href="pone.0020892.e079.jpg" mimetype="image"/></inline-formula> are labeled as 0 and 1, respectively. In this case, we can change the label of <inline-formula><inline-graphic xlink:href="pone.0020892.e080.jpg" mimetype="image"/></inline-formula> in <inline-formula><inline-graphic xlink:href="pone.0020892.e081.jpg" mimetype="image"/></inline-formula> to 1. From the proof of Lemma 1, we know that changing the label of <inline-formula><inline-graphic xlink:href="pone.0020892.e082.jpg" mimetype="image"/></inline-formula> in <inline-formula><inline-graphic xlink:href="pone.0020892.e083.jpg" mimetype="image"/></inline-formula> will decrease the number of flips by at least 1, while changing the label of <inline-formula><inline-graphic xlink:href="pone.0020892.e084.jpg" mimetype="image"/></inline-formula> in <inline-formula><inline-graphic xlink:href="pone.0020892.e085.jpg" mimetype="image"/></inline-formula> may increase the number of flips by at most 1. If we change the labels of node <inline-formula><inline-graphic xlink:href="pone.0020892.e086.jpg" mimetype="image"/></inline-formula> is TOGs <inline-formula><inline-graphic xlink:href="pone.0020892.e087.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0020892.e088.jpg" mimetype="image"/></inline-formula> simultaneously, the total number of flips will not increase and thus the labeling is still optimal. Moreover, such a simultaneous change will keep the intertree constraint satisfied. This completes the proof of Lemma 2.</p>
      <p>The TOG labeling problem is trivial to compute without the intratree and intertree constraints. If we only consider the intratree constraint, the problem can still be solved by using dynamic programming in polynomial time. However, the intertree constraint makes the problem much harder. Here, we propose two different algorithms to solve the TOG labeling problem: the <italic>NodeCentric</italic> algorithm and the <italic>TreeCentric</italic> algorithm. The algorithms are sketched below.</p>
      <p>The basic idea behind the NodeCentric algorithm is to label all <inline-formula><inline-graphic xlink:href="pone.0020892.e089.jpg" mimetype="image"/></inline-formula> TOGs simultaneously by dynamic programming. In other words, it labels each internal node of the species tree with a binary vector of <inline-formula><inline-graphic xlink:href="pone.0020892.e090.jpg" mimetype="image"/></inline-formula> bits. In order to keep track of the validity of the two constraints, we will use label <inline-formula><inline-graphic xlink:href="pone.0020892.e091.jpg" mimetype="image"/></inline-formula> (when considering some TOG) to indicate that (i) the current node is labeled as 0 in the TOG and (ii) some descendant of the current node is labeled as 1 in the TOG. Thus, the label 0 now means that all descendant nodes are also labeled as 0. The algorithm proceeds in post-order. For each internal node <inline-formula><inline-graphic xlink:href="pone.0020892.e092.jpg" mimetype="image"/></inline-formula> in the species tree, it enumerates all possible label vectors at <inline-formula><inline-graphic xlink:href="pone.0020892.e093.jpg" mimetype="image"/></inline-formula> and for each vector, it computes the minimum number of flips in the subtree under node <inline-formula><inline-graphic xlink:href="pone.0020892.e094.jpg" mimetype="image"/></inline-formula> by considering all feasible label vectors of its two children without violating the two constraints. By Lemmas 1 and 2, we can quickly fix the label of <inline-formula><inline-graphic xlink:href="pone.0020892.e095.jpg" mimetype="image"/></inline-formula> in a TOG if the labels of its two children in the same TOG are both fixed as 0 or both fixed as 1.</p>
      <p>Since the left and right children can be considered separately, it seems that the above algorithm would run in <inline-formula><inline-graphic xlink:href="pone.0020892.e096.jpg" mimetype="image"/></inline-formula> time, which could be impractical if <inline-formula><inline-graphic xlink:href="pone.0020892.e097.jpg" mimetype="image"/></inline-formula> is large. However, with a careful analysis, we find that at most 3 (instead of 9) combinations of the parent-child labels are possible in a TOG. If the parent label is fixed as 0, then the child label must be fixed as 0 as well. Otherwise, the parent label could be <inline-formula><inline-graphic xlink:href="pone.0020892.e098.jpg" mimetype="image"/></inline-formula> or 1. If it is <inline-formula><inline-graphic xlink:href="pone.0020892.e099.jpg" mimetype="image"/></inline-formula>, then the child label could be either fixed as 0 or one of <inline-formula><inline-graphic xlink:href="pone.0020892.e100.jpg" mimetype="image"/></inline-formula> and 1. If the parent label is 1, then the child label must be fixed either as 0 or as 1 due to the intratree constraint. So, in any case, at most 3 combinations of the parent-child labels should be considered in a TOG and hence, a total number of <inline-formula><inline-graphic xlink:href="pone.0020892.e101.jpg" mimetype="image"/></inline-formula> values need to be computed. The intertree constraint may reduce the number of legal combinations even further. This implies an efficient implementation of the NodeCentric algorithm with time complexity <inline-formula><inline-graphic xlink:href="pone.0020892.e102.jpg" mimetype="image"/></inline-formula>.</p>
      <p>While the NodeCentric algorithm goes through each node sequentially, the TreeCentric algorithm goes through each TOG sequentially. For a subset of fully labeled TOGs on the same species tree, the <italic>union TOG</italic> is a fully labeled TOG obtained by taking the Boolean <italic>or</italic> operation on the labels of each given TOG at the same node of the species tree. Let us order the TOGs arbitrarily as <inline-formula><inline-graphic xlink:href="pone.0020892.e103.jpg" mimetype="image"/></inline-formula>. For each TOG <inline-formula><inline-graphic xlink:href="pone.0020892.e104.jpg" mimetype="image"/></inline-formula>, the TreeCentric algorithm enumerates all feasible binary labelings of the TOG <inline-formula><inline-graphic xlink:href="pone.0020892.e105.jpg" mimetype="image"/></inline-formula> by taking into account the intratree constraint. This can be done efficiently by dynamic programming. For each such labeling of <inline-formula><inline-graphic xlink:href="pone.0020892.e106.jpg" mimetype="image"/></inline-formula>, it enumerates all possible union TOGs <inline-formula><inline-graphic xlink:href="pone.0020892.e107.jpg" mimetype="image"/></inline-formula> covering <inline-formula><inline-graphic xlink:href="pone.0020892.e108.jpg" mimetype="image"/></inline-formula>, and then computes and records the minimum number of flips in the TOGs <inline-formula><inline-graphic xlink:href="pone.0020892.e109.jpg" mimetype="image"/></inline-formula> for each union TOG <inline-formula><inline-graphic xlink:href="pone.0020892.e110.jpg" mimetype="image"/></inline-formula>, by taking advantage of the previously recorded minimum number of flips in <inline-formula><inline-graphic xlink:href="pone.0020892.e111.jpg" mimetype="image"/></inline-formula> for each union TOG <inline-formula><inline-graphic xlink:href="pone.0020892.e112.jpg" mimetype="image"/></inline-formula>. Finally, the minimum number of flips in all TOGs <inline-formula><inline-graphic xlink:href="pone.0020892.e113.jpg" mimetype="image"/></inline-formula> is obtained by considering all possible union TOGs covering <inline-formula><inline-graphic xlink:href="pone.0020892.e114.jpg" mimetype="image"/></inline-formula> and taking into account the intertree constraint. Since the number of different union TOGs is <inline-formula><inline-graphic xlink:href="pone.0020892.e115.jpg" mimetype="image"/></inline-formula>, the above algorithm runs in <inline-formula><inline-graphic xlink:href="pone.0020892.e116.jpg" mimetype="image"/></inline-formula> time.</p>
      <p>More detailed pseudocodes of both algorithms are given in Algorithms 1 and 2. For the convenience of the reader, we list the notations used in the algorithms and their brief explanations explicitly below.</p>
      <list list-type="bullet">
        <list-item>
          <p><inline-formula><inline-graphic xlink:href="pone.0020892.e117.jpg" mimetype="image"/></inline-formula>: the species tree.</p>
        </list-item>
        <list-item>
          <p><inline-formula><inline-graphic xlink:href="pone.0020892.e118.jpg" mimetype="image"/></inline-formula>: the number of TOGs in a gene family.</p>
        </list-item>
        <list-item>
          <p><inline-formula><inline-graphic xlink:href="pone.0020892.e119.jpg" mimetype="image"/></inline-formula>: the TOGs in the gene family.</p>
        </list-item>
        <list-item>
          <p><inline-formula><inline-graphic xlink:href="pone.0020892.e120.jpg" mimetype="image"/></inline-formula>: the union TOG covering TOGs <inline-formula><inline-graphic xlink:href="pone.0020892.e121.jpg" mimetype="image"/></inline-formula>.</p>
        </list-item>
        <list-item>
          <p><inline-formula><inline-graphic xlink:href="pone.0020892.e122.jpg" mimetype="image"/></inline-formula>: the label of node <inline-formula><inline-graphic xlink:href="pone.0020892.e123.jpg" mimetype="image"/></inline-formula> in <inline-formula><inline-graphic xlink:href="pone.0020892.e124.jpg" mimetype="image"/></inline-formula>.</p>
        </list-item>
        <list-item>
          <p><inline-formula><inline-graphic xlink:href="pone.0020892.e125.jpg" mimetype="image"/></inline-formula>: the label vector of node <inline-formula><inline-graphic xlink:href="pone.0020892.e126.jpg" mimetype="image"/></inline-formula> in <inline-formula><inline-graphic xlink:href="pone.0020892.e127.jpg" mimetype="image"/></inline-formula> with <inline-formula><inline-graphic xlink:href="pone.0020892.e128.jpg" mimetype="image"/></inline-formula> bits, where the <inline-formula><inline-graphic xlink:href="pone.0020892.e129.jpg" mimetype="image"/></inline-formula>-th bit is <inline-formula><inline-graphic xlink:href="pone.0020892.e130.jpg" mimetype="image"/></inline-formula>.</p>
        </list-item>
        <list-item>
          <p><inline-formula><inline-graphic xlink:href="pone.0020892.e131.jpg" mimetype="image"/></inline-formula>: the labeling of TOG <inline-formula><inline-graphic xlink:href="pone.0020892.e132.jpg" mimetype="image"/></inline-formula>.</p>
        </list-item>
        <list-item>
          <p><inline-formula><inline-graphic xlink:href="pone.0020892.e133.jpg" mimetype="image"/></inline-formula>: the number of flips (<italic>i.e.</italic>, Hamming distance) between two labelings <inline-formula><inline-graphic xlink:href="pone.0020892.e134.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0020892.e135.jpg" mimetype="image"/></inline-formula>.</p>
        </list-item>
        <list-item>
          <p><inline-formula><inline-graphic xlink:href="pone.0020892.e136.jpg" mimetype="image"/></inline-formula>: the number of flips in <inline-formula><inline-graphic xlink:href="pone.0020892.e137.jpg" mimetype="image"/></inline-formula> when labeled as <inline-formula><inline-graphic xlink:href="pone.0020892.e138.jpg" mimetype="image"/></inline-formula>.</p>
        </list-item>
        <list-item>
          <p><inline-formula><inline-graphic xlink:href="pone.0020892.e139.jpg" mimetype="image"/></inline-formula>: the total number of flips in the subtree of <inline-formula><inline-graphic xlink:href="pone.0020892.e140.jpg" mimetype="image"/></inline-formula> rooted at <inline-formula><inline-graphic xlink:href="pone.0020892.e141.jpg" mimetype="image"/></inline-formula> with labeling <inline-formula><inline-graphic xlink:href="pone.0020892.e142.jpg" mimetype="image"/></inline-formula>.</p>
        </list-item>
        <list-item>
          <p><inline-formula><inline-graphic xlink:href="pone.0020892.e143.jpg" mimetype="image"/></inline-formula>: the total number of flips in the first <inline-formula><inline-graphic xlink:href="pone.0020892.e144.jpg" mimetype="image"/></inline-formula> TOGs when their labelings satisfy the intratree constraint and form the union TOG <inline-formula><inline-graphic xlink:href="pone.0020892.e145.jpg" mimetype="image"/></inline-formula>.</p>
        </list-item>
        <list-item>
          <p><inline-formula><inline-graphic xlink:href="pone.0020892.e146.jpg" mimetype="image"/></inline-formula>: the boolean <italic>or</italic> operation between labelings <inline-formula><inline-graphic xlink:href="pone.0020892.e147.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0020892.e148.jpg" mimetype="image"/></inline-formula>.</p>
        </list-item>
      </list>
      <p><bold>Algorithm 1</bold> NodeCentric (<inline-formula><inline-graphic xlink:href="pone.0020892.e149.jpg" mimetype="image"/></inline-formula>)</p>
      <p>1: Traverse <inline-formula><inline-graphic xlink:href="pone.0020892.e150.jpg" mimetype="image"/></inline-formula> in post-order</p>
      <p>2: <bold>for all</bold> node <inline-formula><inline-graphic xlink:href="pone.0020892.e151.jpg" mimetype="image"/></inline-formula> do</p>
      <p>3: <bold>if</bold>
<inline-formula><inline-graphic xlink:href="pone.0020892.e152.jpg" mimetype="image"/></inline-formula> is a leaf node <bold>then</bold>
</p>
      <p>4:  <inline-formula><inline-graphic xlink:href="pone.0020892.e153.jpg" mimetype="image"/></inline-formula>
</p>
      <p>5:  <inline-formula><inline-graphic xlink:href="pone.0020892.e154.jpg" mimetype="image"/></inline-formula>
</p>
      <p>6: <bold>else</bold>
</p>
      <p>7:  <bold>for all</bold> possible labeling <inline-formula><inline-graphic xlink:href="pone.0020892.e155.jpg" mimetype="image"/></inline-formula> at node <inline-formula><inline-graphic xlink:href="pone.0020892.e156.jpg" mimetype="image"/></inline-formula>
<bold>do</bold>
</p>
      <p>8:   <inline-formula><inline-graphic xlink:href="pone.0020892.e157.jpg" mimetype="image"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0020892.e158.jpg" mimetype="image"/></inline-formula> are the two child nodes of <inline-formula><inline-graphic xlink:href="pone.0020892.e159.jpg" mimetype="image"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0020892.e160.jpg" mimetype="image"/></inline-formula> are their labelings such that <inline-formula><inline-graphic xlink:href="pone.0020892.e161.jpg" mimetype="image"/></inline-formula> satisfy the two constraints</p>
      <p>9:  <bold>end for</bold>
</p>
      <p>10: <bold>end if</bold>
</p>
      <p>11: <bold>end for</bold>
</p>
      <p>12: Traverse <italic>T</italic> in pre-order and retrieve the labeling of each node that gave rise to the minimum cost by a standard backtracing</p>
      <p>Both algorithms NodeCentric and TreeCentric are exponential time algorithms. However, in practice, the number of genomes in comparison is expected to be small (usually <inline-formula><inline-graphic xlink:href="pone.0020892.e162.jpg" mimetype="image"/></inline-formula>). So we can use the TreeCentric algorithm to find an optimal TOG labeling efficiently. When the value of <inline-formula><inline-graphic xlink:href="pone.0020892.e163.jpg" mimetype="image"/></inline-formula> is smaller, it is faster to apply the NodeCentric algorithm. Note that, the two algorithms may find different labelings for the same input, both of which are optimal.</p>
      <p><bold>Algorithm 2</bold> TreeCentric <inline-formula><inline-graphic xlink:href="pone.0020892.e164.jpg" mimetype="image"/></inline-formula>
</p>
      <p>1: Initialize union TOG <inline-formula><inline-graphic xlink:href="pone.0020892.e165.jpg" mimetype="image"/></inline-formula> by labeling <inline-formula><inline-graphic xlink:href="pone.0020892.e166.jpg" mimetype="image"/></inline-formula> with 0's</p>
      <p>2: <inline-formula><inline-graphic xlink:href="pone.0020892.e167.jpg" mimetype="image"/></inline-formula>
</p>
      <p>3: <bold>for</bold>
<inline-formula><inline-graphic xlink:href="pone.0020892.e168.jpg" mimetype="image"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0020892.e169.jpg" mimetype="image"/></inline-formula> do</p>
      <p>4: <bold>for all</bold> union TOG <inline-formula><inline-graphic xlink:href="pone.0020892.e170.jpg" mimetype="image"/></inline-formula>
<bold>do</bold>
</p>
      <p>5:  <inline-formula><inline-graphic xlink:href="pone.0020892.e171.jpg" mimetype="image"/></inline-formula>
</p>
      <p>6: <bold>end for</bold>
</p>
      <p>7: <bold>for all</bold> labeling <inline-formula><inline-graphic xlink:href="pone.0020892.e172.jpg" mimetype="image"/></inline-formula>
<bold>do</bold>
</p>
      <p>8:  <bold>if</bold>
<inline-formula><inline-graphic xlink:href="pone.0020892.e173.jpg" mimetype="image"/></inline-formula> satisfies the intratree constraint then</p>
      <p>9:   <bold>for all</bold> union TOG <inline-formula><inline-graphic xlink:href="pone.0020892.e174.jpg" mimetype="image"/></inline-formula>
<bold>do</bold>
</p>
      <p>10:    <inline-formula><inline-graphic xlink:href="pone.0020892.e175.jpg" mimetype="image"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0020892.e176.jpg" mimetype="image"/></inline-formula>
</p>
      <p>11:   <bold>end for</bold>
</p>
      <p>12:  <bold>end if</bold>
</p>
      <p>13: <bold>end for</bold>
</p>
      <p>14: <bold>end for</bold>
</p>
      <p>15: Let <inline-formula><inline-graphic xlink:href="pone.0020892.e177.jpg" mimetype="image"/></inline-formula> denote a union TOG that minimizes <inline-formula><inline-graphic xlink:href="pone.0020892.e178.jpg" mimetype="image"/></inline-formula> and satisfies the intertree constraint Traverse the TOGs in reverse order ( <italic>i.e.</italic>, <inline-formula><inline-graphic xlink:href="pone.0020892.e179.jpg" mimetype="image"/></inline-formula>) and retrieve the optimal labeling for each TOG <inline-formula><inline-graphic xlink:href="pone.0020892.e180.jpg" mimetype="image"/></inline-formula> that gave rise to <inline-formula><inline-graphic xlink:href="pone.0020892.e181.jpg" mimetype="image"/></inline-formula> by a standard backtracing.</p>
    </sec>
    <sec id="s2e">
      <title>Ortholog Group Identification</title>
      <p>After labeling all TOGs, it is straightforward to identify ortholog groups. Starting from the root of each TOG, we can find the highest ancestral nodes labeled as 1. All genes at the descendent leaves of such an ancestral node form an ortholog group. An example is shown in <xref ref-type="fig" rid="pone-0020892-g001">Figure 1(g)</xref>. In addition, with the labeling of each TOG, we can easily identify evolutionary events including gene births and losses as well as duplications. For each edge in the TOG, if the parent-child labeling is 1-0, then there is a gene loss. If the labeling is 0-1, and the parent node is labeled as 0 in all other TOGs, then it represents a gene birth. Otherwise, it represents a gene duplication.</p>
    </sec>
  </sec>
  <sec id="s3">
    <title>Results</title>
    <p>In order to test the performance of our system MultiMSOAR 2.0, we first apply it to simulated data, and compare it with the popular ortholog assignment tool MultiParanoid <xref rid="pone.0020892-Alexeyenko1" ref-type="bibr">[27]</xref> for multiple genomes. For real data experiments, besides comparison with MultiParanoid, we also compare our results with Roundup <xref rid="pone.0020892-DeLuca1" ref-type="bibr">[28]</xref>, which is a well known multi-genome repository of orthology information and the Ensembl ortholog database.</p>
    <sec id="s3a">
      <title>Simulation Results</title>
      <p>Our simulation test is an extension of the one in Ref. <xref rid="pone.0020892-Shi1" ref-type="bibr">[5]</xref> for testing the performance of MSOAR 2.0. However, we now need to simulate more genome evolutionary events, including gene mutations, gene births, gene duplications, gene losses, genome rearrangements (including reversals, translocations, fusions and fissions) and speciations (graphical examples of these events are shown in Figure S2 in <xref ref-type="supplementary-material" rid="pone.0020892.s001">Materials S1</xref>). To make things easier, we only simulate the evolution of <inline-formula><inline-graphic xlink:href="pone.0020892.e182.jpg" mimetype="image"/></inline-formula> (<inline-formula><inline-graphic xlink:href="pone.0020892.e183.jpg" mimetype="image"/></inline-formula>) single-chromosomal genomes as done in Ref. <xref rid="pone.0020892-Shi1" ref-type="bibr">[5]</xref>. In order to generate <inline-formula><inline-graphic xlink:href="pone.0020892.e184.jpg" mimetype="image"/></inline-formula> contemporary genomes, we first generate a random species tree <inline-formula><inline-graphic xlink:href="pone.0020892.e185.jpg" mimetype="image"/></inline-formula> with <inline-formula><inline-graphic xlink:href="pone.0020892.e186.jpg" mimetype="image"/></inline-formula> leaf nodes. Each internal node in <inline-formula><inline-graphic xlink:href="pone.0020892.e187.jpg" mimetype="image"/></inline-formula> represents an ancestral genome while the leaf nodes represent the current genomes. Each edge in <inline-formula><inline-graphic xlink:href="pone.0020892.e188.jpg" mimetype="image"/></inline-formula> represents a speciation event. We then randomly generate a genome with 100 genes consisting of 3,000 nucleotides each at the root of <inline-formula><inline-graphic xlink:href="pone.0020892.e189.jpg" mimetype="image"/></inline-formula>. For each speciation event, we simulate <inline-formula><inline-graphic xlink:href="pone.0020892.e190.jpg" mimetype="image"/></inline-formula> evolutionary events, which include <inline-formula><inline-graphic xlink:href="pone.0020892.e191.jpg" mimetype="image"/></inline-formula> gene duplications, <inline-formula><inline-graphic xlink:href="pone.0020892.e192.jpg" mimetype="image"/></inline-formula> gene births, <inline-formula><inline-graphic xlink:href="pone.0020892.e193.jpg" mimetype="image"/></inline-formula> gene losses, and <inline-formula><inline-graphic xlink:href="pone.0020892.e194.jpg" mimetype="image"/></inline-formula> genome rearrangements. To generate the gene duplications, we randomly choose a gene, copy it and insert it into the genome next to the original copy or at a random position, depending on whether the duplication is tandem or random (here we assume 50% of all duplications are tandem, as done in Ref. <xref rid="pone.0020892-Shi1" ref-type="bibr">[5]</xref>). To simulate the birth of a new gene, we create a new gene and randomly insert it into the genome. To simulate the loss of a gene, we randomly choose a gene and delete it from the genome. For genome rearrangements, since there is only one chromosome, only reversals are considered. Reversals are simulated by randomly choosing two positions on the genome and reverse all the genes between them.</p>
      <p>To simulate gene (point) mutations, we use a popular sequence simulation tool <italic>evolver</italic> from the PAML package <xref rid="pone.0020892-Yang1" ref-type="bibr">[29]</xref>. By running <italic>evolver</italic> with default options on the codon sequence at the root of a branch, we can obtain the mutated codon sequence over a pre-specified branch length <inline-formula><inline-graphic xlink:href="pone.0020892.e195.jpg" mimetype="image"/></inline-formula>. Since branch length can be measured in terms of the expected number of substitutions per site, we may use <inline-formula><inline-graphic xlink:href="pone.0020892.e196.jpg" mimetype="image"/></inline-formula> to control the mutation rate of a gene. We assume that between every two (genome-level) evolutionary events, all the genes on the existing genomes evolve at the same rate. In other words, a molecular clock is assumed.</p>
      <p>In summary, our simulation data is controlled by a 6-parameter set: <inline-formula><inline-graphic xlink:href="pone.0020892.e197.jpg" mimetype="image"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0020892.e198.jpg" mimetype="image"/></inline-formula> is the number of species, <inline-formula><inline-graphic xlink:href="pone.0020892.e199.jpg" mimetype="image"/></inline-formula> the total number of evolutionary events after each speciation, <inline-formula><inline-graphic xlink:href="pone.0020892.e200.jpg" mimetype="image"/></inline-formula> the gene mutation rate, and <inline-formula><inline-graphic xlink:href="pone.0020892.e201.jpg" mimetype="image"/></inline-formula> the percentages of gene duplications, births and losses among the <inline-formula><inline-graphic xlink:href="pone.0020892.e202.jpg" mimetype="image"/></inline-formula> events, respectively.</p>
      <p>To study the effects of different parameters on the performance of MultiMSOAR 2.0, we set the default values for each parameter as <inline-formula><inline-graphic xlink:href="pone.0020892.e203.jpg" mimetype="image"/></inline-formula>, and we will vary one parameter at a time. To measure the prediction accuracy, we use two popular measurements: <italic>sensitivity</italic> and <italic>specificity</italic>. Here, sensitivity is defined as the number of the true ortholog groups (<italic>i.e.</italic>, true positives) identified by a program divided by the total number of known ortholog groups, and specificity is defined as the number of true ortholog groups identified divided by the number of ortholog groups output. We compare the ortholog groups found by MultiMSOAR 2.0 and MultiParanoid. In order for an identified ortholog group to be a true positive (<italic>i.e., TP</italic>), we require that all genes in the identified ortholog group match exactly with all the genes in a known ortholog group. For each parameter set, we generate 10 simulated data sets and run MultiMSOAR 2.0 and MultiParanoid on these data respectively. Finally we calculate the average prediction accuracies of the two programs on each parameter set. The prediction accuracies of the two programs are shown in <xref ref-type="fig" rid="pone-0020892-g003">Figure 3</xref>.</p>
      <fig id="pone-0020892-g003" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0020892.g003</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Comparison of MultiMSOAR 2.0 and MultiParanoid on simulated data.</title>
          <p>(a) Simulation results on the parameter set <inline-formula><inline-graphic xlink:href="pone.0020892.e204.jpg" mimetype="image"/></inline-formula> where the parameter <inline-formula><inline-graphic xlink:href="pone.0020892.e205.jpg" mimetype="image"/></inline-formula> is varied. (b) Simulation results on the parameter set <inline-formula><inline-graphic xlink:href="pone.0020892.e206.jpg" mimetype="image"/></inline-formula> where the parameter <inline-formula><inline-graphic xlink:href="pone.0020892.e207.jpg" mimetype="image"/></inline-formula> is varied. (c) Simulation results on the parameter set <inline-formula><inline-graphic xlink:href="pone.0020892.e208.jpg" mimetype="image"/></inline-formula> where the parameter <inline-formula><inline-graphic xlink:href="pone.0020892.e209.jpg" mimetype="image"/></inline-formula> is varied. (d) Simulation results on the parameter set <inline-formula><inline-graphic xlink:href="pone.0020892.e210.jpg" mimetype="image"/></inline-formula> where the parameter <inline-formula><inline-graphic xlink:href="pone.0020892.e211.jpg" mimetype="image"/></inline-formula> is varied.</p>
        </caption>
        <graphic xlink:href="pone.0020892.g003"/>
      </fig>
      <p><xref ref-type="fig" rid="pone-0020892-g003">Figures 3(a), (b), (d)</xref> show that with the increase of the number of species, the number of evolutionary events, and the number of gene duplications, the prediction accuracies of both programs decrease since it becomes harder for them to correctly identify ortholog groups. However, we notice that the decrease in accuracy for MultiMSOAR 2.0 is mild while the decrease is sharp for MultiParanoid, especially in <xref ref-type="fig" rid="pone-0020892-g003">Figure 3(d)</xref>. This could be because when more genes are duplicated, it becomes increasingly difficult for MultiParanoid to decide if a duplication happened in an ancient genome or in a more recent genome. Thus, it might confuse some ancient duplications with recent duplications and miss calling some true ortholog groups. On the other hand, MultiMSOAR 2.0 infers the time of each duplication explicitly when labeling TOGs, and is thus more resilient to the increase of gene duplication events. However, since the labeling algorithm used in MultiMSOAR 2.0 is based on the parsimony principle and the optimal labeling might not be unique, the actual labeling given by MultiMSOAR 2.0 may not necessarily reflect the true evolutionary history. As a result, when the number of gene duplications increases, the prediction accuracy of MultiMSOAR 2.0 also decreases, but much more slowly than in the case of MultiParanoid.</p>
      <p><xref ref-type="fig" rid="pone-0020892-g003">Figure 3(c)</xref> is interesting and deserves some explanation. With the increase of the branch length <inline-formula><inline-graphic xlink:href="pone.0020892.e212.jpg" mimetype="image"/></inline-formula> defined in <italic>evolver</italic> from 0.01 to 0.04, both the sensitivity and specificity of MultiMSOAR 2.0 increase a little bit. This is because when <inline-formula><inline-graphic xlink:href="pone.0020892.e213.jpg" mimetype="image"/></inline-formula> increases, it becomes slightly easier for MultiMSOAR 2.0 to differentiate duplicated genes from their original copies based on sequence similarity. However, when <inline-formula><inline-graphic xlink:href="pone.0020892.e214.jpg" mimetype="image"/></inline-formula> goes from 0.07 to 0.15, the prediction accuracies of both programs sharply decrease. This is because the sequence similarity between homologous genes originated from a common ancestral gene becomes weaker with the increase of <inline-formula><inline-graphic xlink:href="pone.0020892.e215.jpg" mimetype="image"/></inline-formula>. As a result, it becomes harder for MultiParanoid to identify ortholog groups solely based on sequence similarity, and for the MCL algorithm used in MultiMSOAR 2.0 to correctly cluster homologous genes into a gene family. Without correct gene families, we cannot expect MultiMSOAR 2.0 to find the ortholog groups correctly.</p>
      <p>Generally speaking, from the four figures above, we can see that the prediction accuracy of MultiMSOAR 2.0 is significantly higher than that of MultiParanoid. With more species, more evolutionary events and more gene duplications, the advantage of MultiMSOAR 2.0 over MultiParanoid becomes more apparent. Besides, in the simulation, MultiMSOAR 2.0 is always able to achieve more than 90% prediction accuracy (in terms of sensitivity and specificity) as long as the gene mutation rate is not too high. This is pretty remarkable considering the large number of species and evolutionary events involved. Moreover, MultiMSOAR 2.0 can provide more information about gene births, losses and duplications in addition to identifying ortholog groups. In the simulation experiments, we also tested the accuracy of MulitMSOAR 2.0 in inferring gene births, losses and duplications, and compared its performance with Notung, a well-known software tool for reconciling genes trees with species trees by taking into account gene duplication and loss events <xref rid="pone.0020892-Durand1" ref-type="bibr">[30]</xref>, <xref rid="pone.0020892-Vernot1" ref-type="bibr">[31]</xref>. Since Notung does not consider gene births, we only compare the sensitivity and specificity of MultiMSOAR 2.0 and Notung with respect to gene duplication and loss events. It turns out that the prediction accuracies of MultiMSOAR 2.0 on duplications and losses are generally much higher than those of Notung. Due to the page limit, the prediction accuracies concerning these events by MultiMSOAR 2.0 and Notung on simulated data are summarized in Tables S1, S2, S3, S4 in <xref ref-type="supplementary-material" rid="pone.0020892.s001">Materials S1</xref>. Note that Notung fails to detect most gene losses because it prunes the species tree when an entire gene family is missing in a genome.</p>
    </sec>
    <sec id="s3b">
      <title>Real Data Experiments</title>
      <p>Since MultiMSOAR 2.0 is a tool to identify ortholog groups for multiple genomes that are closely related on a genome scale, to test its performance on real data, we choose to use the mammalian genomes that have been completely sequenced. We downloaded seven mammalian genomes from the Ensembl genome browser (<ext-link ext-link-type="uri" xlink:href="http://www.ensembl.org/">http://www.ensembl.org/</ext-link>): human (<italic>Homo sapiens</italic>), chimpanzee (<italic>Pan troglodytes</italic>), macaque (<italic>Macaca mulatta</italic>), mouse (<italic>Mus musculus</italic>), rat (<italic>Rattus norvegicus</italic>), cow (<italic>Bos taurus</italic>) and opossum (<italic>Monodelphis domestica</italic>) (version 57, March 2010). The species tree for the seven mammalian genomes is downloaded from Ensembl as well.</p>
      <p>For the purpose of comparison, we choose to compare the results of MultiMSOAR 2.0 with those of the popular tool MultiParanoid, Roundup and the Ensembl ortholog database. For MultiParanoid, we deem all the genes in the same cluster output by the program as an ortholog group assigned by MultiParanoid. We run MultiMSOAR 2.0 and MultiParanoid on the real data sets respectively and compare their results. Roundup is a recently developed multi-genome repository of orthologs for over 250 genomes <xref rid="pone.0020892-DeLuca1" ref-type="bibr">[28]</xref>. We download the ortholog groups for the concerned genomes from its website (<ext-link ext-link-type="uri" xlink:href="http://roundup.hms.harvard.edu/">http://roundup.hms.harvard.edu/</ext-link>). Since Roundup uses genomes from different sources, we need to map the genes used in Roundup to the corresponding genes used in Ensembl. For the Ensembl ortholog database, we download the reconciled EnsemblCompara gene trees, and extract the orthology information for the genomes being compared. Each group of genes of the concerned genomes that descended from the lowest common ancestor of the concerned genomes defines an ortholog group.</p>
      <p>Some other tools and databases are also available for ortholog assignment among multiple genomes, such as the OrthoFocus program <xref rid="pone.0020892-Ivliev1" ref-type="bibr">[32]</xref> and the PhylomeDB ortholog database <xref rid="pone.0020892-HuertaCepas1" ref-type="bibr">[33]</xref>. However, OrthoFocus is a program to identify orthologs in family-focused studies and it is inapproriate for genome-scale comparisons. PhylomeDB is a major source for phylogeny-based orthology and paralogy prediction, covering about 5 million proteins in 717 fully-sequenced genomes. However, since it involves a large number of genomes in the comparison, we are unable to retrieve reconciled gene trees concerning only genes from genomes of interest to us. Instead, we are only provided with orthology relationship with respect to a “seed” genome. This means that we would need to use a single-linkage method to combine ortholog groups via “seed” genomes, which is clearly undesirable. Besides, PhylomeDB generally presents orthology as a many-to-many relationship. Without reconciled trees, it is hard for us to refine the relationship into a one-to-one relationship, which makes the comparison with our results very difficult. Moreover, PhylomeDB uses a data source different from Ensembl, and the conversion of gene names between the two databases could be quite non-trivial.</p>
      <sec id="s3b1">
        <title>Results on Human, Mouse and Rat</title>
        <p>Since human, mouse and rat are the best annotated genomes, we can use gene symbols to validate the ortholog groups assigned among the three genomes by different programs. The same validation method has been used in many other papers <xref rid="pone.0020892-Shi1" ref-type="bibr">[5]</xref>, <xref rid="pone.0020892-Fu1" ref-type="bibr">[19]</xref>, <xref rid="pone.0020892-Fu2" ref-type="bibr">[20]</xref>. Note that since some gene symbols were assigned using information from certain orthology databases, we should take the validation results based on gene symbols with a grain of salt. By using gene symbols, we can define true ortholog groups (TPs), false ortholog groups (FPs), and unknown ortholog groups as follows. If an ortholog group contains genes that have different gene symbols, then this group is counted as an FP. If at most one of the genes in the group have gene symbols, then this group is counted as an unknown. Otherwise, we treat the group as a TP. An ortholog group is defined as <italic>assignable</italic> if its genes appear in at least two genomes and have exactly the same gene symbol. We use the same measurements <italic>sensitivity</italic> and <italic>specificity</italic> as defined in the simulation to measure the prediction accuracies of the three programs. The performance of the programs is shown in <xref ref-type="table" rid="pone-0020892-t001">Table 1</xref>.</p>
        <table-wrap id="pone-0020892-t001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0020892.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>Performance of the four programs on human, mouse and rat.</title>
          </caption>
          <alternatives>
            <graphic id="pone-0020892-t001-1" xlink:href="pone.0020892.t001"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Program</td>
                  <td align="left" rowspan="1" colspan="1">Assignable TPs</td>
                  <td align="left" rowspan="1" colspan="1">TPs</td>
                  <td align="left" rowspan="1" colspan="1">FPs</td>
                  <td align="left" rowspan="1" colspan="1">Unknowns</td>
                  <td align="left" rowspan="1" colspan="1">Total</td>
                  <td align="left" rowspan="1" colspan="1">Sensitivity</td>
                  <td align="left" rowspan="1" colspan="1">Specificity</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MultiMSOAR 2.0</td>
                  <td align="left" rowspan="1" colspan="1">15,598</td>
                  <td align="left" rowspan="1" colspan="1">14,051</td>
                  <td align="left" rowspan="1" colspan="1">2,399</td>
                  <td align="left" rowspan="1" colspan="1">2,919</td>
                  <td align="left" rowspan="1" colspan="1">19,369</td>
                  <td align="left" rowspan="1" colspan="1">90.08%</td>
                  <td align="left" rowspan="1" colspan="1">85.42%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MultiParanoid</td>
                  <td align="left" rowspan="1" colspan="1">15,598</td>
                  <td align="left" rowspan="1" colspan="1">13,697</td>
                  <td align="left" rowspan="1" colspan="1">2,609</td>
                  <td align="left" rowspan="1" colspan="1">2,328</td>
                  <td align="left" rowspan="1" colspan="1">18,634</td>
                  <td align="left" rowspan="1" colspan="1">87.81%</td>
                  <td align="left" rowspan="1" colspan="1">84.00%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Ensembl</td>
                  <td align="left" rowspan="1" colspan="1">15,598</td>
                  <td align="left" rowspan="1" colspan="1">13,474</td>
                  <td align="left" rowspan="1" colspan="1">2,495</td>
                  <td align="left" rowspan="1" colspan="1">2,091</td>
                  <td align="left" rowspan="1" colspan="1">18,060</td>
                  <td align="left" rowspan="1" colspan="1">86.38%</td>
                  <td align="left" rowspan="1" colspan="1">84.38%</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Roundup</td>
                  <td align="left" rowspan="1" colspan="1">14,616</td>
                  <td align="left" rowspan="1" colspan="1">10,094</td>
                  <td align="left" rowspan="1" colspan="1">2,424</td>
                  <td align="left" rowspan="1" colspan="1">6,790</td>
                  <td align="left" rowspan="1" colspan="1">19,308</td>
                  <td align="left" rowspan="1" colspan="1">69.06%</td>
                  <td align="left" rowspan="1" colspan="1">80.66%</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p>The low sensitivity of Roundup in <xref ref-type="table" rid="pone-0020892-t001">Table 1</xref> may be caused by the mapping of gene IDs from Roundup to Ensembl since quite a few of the genes in Roundup were mapped to the unknowns in Ensembl. Nevertheless, we can see that MultiMSOAR 2.0 achieves the best sensitivity and specificity among all four programs. This is mainly because MultiParanoid only considers sequence similarity when assigning ortholog groups, while Ensembl ortholog groups tend to include lots of lineage-specific duplicated inparalogs. Though Roundup is based on the reciprocal smallest distance algorithm, which is different from the reciprocal BLAST hits used in MultiParanoid, it fails to consider other information as well. In contrast, MultiMSOAR 2.0 combines gene order with sequence similarity, as well as phylogenetic information, and thus is able to make more accurate predictions.</p>
      </sec>
      <sec id="s3b2">
        <title>Results on All Seven Mammalian Genomes</title>
        <p>When comparing the seven mammalian genomes including human, chimpanzee, macaque, mouse, rat, cow, and opossum, we cannot validate the ortholog groups predicted by the three programs using gene symbols since not all of the genomes have been annotated with gene symbols. So, we only consider the common and different ortholog groups constructed by MultiMSOAR 2.0, MultiParanoid, Roundup and the Ensembl ortholog database. The comparison results are shown in <xref ref-type="table" rid="pone-0020892-t002">Table 2</xref> (since we are not able to find a good mapping from the data used in Roundup repository to the data used in Ensembl concerning all seven genomes, the comparison results with Roundup are not included in the table).</p>
        <table-wrap id="pone-0020892-t002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0020892.t002</object-id>
          <label>Table 2</label>
          <caption>
            <title>Ortholog groups shared by MultiMSOAR 2.0, MultiParanoid and Ensembl on the seven mammalian genomes.</title>
          </caption>
          <alternatives>
            <graphic id="pone-0020892-t002-2" xlink:href="pone.0020892.t002"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Programs</td>
                  <td align="left" rowspan="1" colspan="1">7 genomes</td>
                  <td align="left" rowspan="1" colspan="1">6 genomes</td>
                  <td align="left" rowspan="1" colspan="1">5 genomes</td>
                  <td align="left" rowspan="1" colspan="1">4 genomes</td>
                  <td align="left" rowspan="1" colspan="1">3 genomes</td>
                  <td align="left" rowspan="1" colspan="1">2 genomes</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MultiMSOAR 2.0</td>
                  <td align="left" rowspan="1" colspan="1">12,034</td>
                  <td align="left" rowspan="1" colspan="1">3,772</td>
                  <td align="left" rowspan="1" colspan="1">1,337</td>
                  <td align="left" rowspan="1" colspan="1">584</td>
                  <td align="left" rowspan="1" colspan="1">875</td>
                  <td align="left" rowspan="1" colspan="1">3,195</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MultiParanoid</td>
                  <td align="left" rowspan="1" colspan="1">11,397</td>
                  <td align="left" rowspan="1" colspan="1">3,311</td>
                  <td align="left" rowspan="1" colspan="1">1,127</td>
                  <td align="left" rowspan="1" colspan="1">609</td>
                  <td align="left" rowspan="1" colspan="1">800</td>
                  <td align="left" rowspan="1" colspan="1">2,728</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Ensembl</td>
                  <td align="left" rowspan="1" colspan="1">13,566</td>
                  <td align="left" rowspan="1" colspan="1">2,002</td>
                  <td align="left" rowspan="1" colspan="1">493</td>
                  <td align="left" rowspan="1" colspan="1">270</td>
                  <td align="left" rowspan="1" colspan="1">363</td>
                  <td align="left" rowspan="1" colspan="1">991</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MultiMSOAR 2.0 and MultiParanoid</td>
                  <td align="left" rowspan="1" colspan="1">9,075</td>
                  <td align="left" rowspan="1" colspan="1">2,237</td>
                  <td align="left" rowspan="1" colspan="1">633</td>
                  <td align="left" rowspan="1" colspan="1">239</td>
                  <td align="left" rowspan="1" colspan="1">348</td>
                  <td align="left" rowspan="1" colspan="1">1,483</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MultiMSOAR 2.0 and Ensembl</td>
                  <td align="left" rowspan="1" colspan="1">8,722</td>
                  <td align="left" rowspan="1" colspan="1">1,003</td>
                  <td align="left" rowspan="1" colspan="1">225</td>
                  <td align="left" rowspan="1" colspan="1">104</td>
                  <td align="left" rowspan="1" colspan="1">131</td>
                  <td align="left" rowspan="1" colspan="1">524</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">MultiParanoid and Ensembl</td>
                  <td align="left" rowspan="1" colspan="1">8,438</td>
                  <td align="left" rowspan="1" colspan="1">983</td>
                  <td align="left" rowspan="1" colspan="1">237</td>
                  <td align="left" rowspan="1" colspan="1">117</td>
                  <td align="left" rowspan="1" colspan="1">143</td>
                  <td align="left" rowspan="1" colspan="1">587</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">All three programs</td>
                  <td align="left" rowspan="1" colspan="1">7,763</td>
                  <td align="left" rowspan="1" colspan="1">872</td>
                  <td align="left" rowspan="1" colspan="1">202</td>
                  <td align="left" rowspan="1" colspan="1">92</td>
                  <td align="left" rowspan="1" colspan="1">119</td>
                  <td align="left" rowspan="1" colspan="1">505</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p><xref ref-type="table" rid="pone-0020892-t002">Table 2</xref> shows the numbers of ortholog groups involving 2 to 7 genomes that were identified by MultiMSOAR 2.0, MultiParanoid and Ensembl. From <xref ref-type="table" rid="pone-0020892-t002">Table 2</xref>, we can see that the numbers of ortholog groups found by all three programs are similar to each other for each number of genomes involved. Most of the ortholog groups identified by each of the three programs all involve seven genomes. Among such large ortholog groups identified by each program, more than a half (7,763) are shared by all three programs, which provides an indirect support for the ortholog groups found by MultiMSOAR 2.0. The large number of ortholog groups involving all seven genomes found by the three programs also manifests the evolutionary closeness of the seven mammalian species. The number of ortholog groups involving 4 genomes found by the three programs is pretty small here, since there is no subtree in the species tree consisting of exactly four species. Hence, an ortholog group of size four would have to involve gene losses. Since there is only one subtree consisting of three species (<italic>i.e.</italic>, human, chimpanzee, and macaque), most of the 875 ortholog groups of size 3 found by MultiMSOAR 2.0 (679, or about 77.6%) consist of genes from the three species. Similarly, 1,772/3,195 (55.46%) and 1,083/3,195 (32.49%) of the ortholog groups of size two consist of genes from mouse-rat and human-chimpanzee respectively, both of which are the closest pairs in the species tree.</p>
      </sec>
    </sec>
    <sec id="s3c">
      <title>Conclusion</title>
      <p>In this paper, we have extended the pairwise ortholog assignment system MSOAR 2.0 to a multi-genome ortholog assignment system MultiMSOAR 2.0. By comparing with the well known multi-genome ortholog assignment tool MultiParanoid on simulated data, we demonstrated that MultiMSOAR 2.0 achieves a significantly higher prediction accuracy. Our real data experiments on closely related mammalian genomes also show the superior performance of MultiMSOAR 2.0 over MultiParanoid, the multi-genome ortholog repository Roundup and the Ensembl ortholog database. Moreover, not only can MultiMSOAR 2.0 identify ortholog groups accurately, it can also provide accurate information about gene births, losses and duplications, which may shed additional insight on genome evolution.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="s4">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0020892.s001">
      <label>Materials S1</label>
      <caption>
        <p>Additional Experimental Results on Simulated Data.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0020892.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We would like to thank Liqing Zhang for many constructive discussions, and the anonymous reviewer for many valuable suggestions.</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement">
      <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
    </fn>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding: </bold>This work was supported by National Science Foundation grant IIS-0711129. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. No additional external funding was received for this study.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="pone.0020892-Fitch1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fitch</surname>
            <given-names>WM</given-names>
          </name>
        </person-group>
        <year>1970</year>
        <article-title>Distinguishing homologous from analogous proteins.</article-title>
        <source>Syst Zool</source>
        <volume>19</volume>
        <fpage>99</fpage>
        <lpage>113</lpage>
        <pub-id pub-id-type="pmid">5449325</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Jiang1">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Michal</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Melville</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Baltzer</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>Multi-alignment of orthologous genome regions in five species provides new insights into the evolutionary make-up of mammalian genomes.</article-title>
        <source>Chromo- some Res</source>
        <volume>13</volume>
        <fpage>707</fpage>
        <lpage>715</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Vilella1">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vilella</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Severin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ureta-Vidal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Heng</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2009</year>
        <article-title>EnsemblCompara GeneTrees: Complete, duplication-aware phylogenetic trees in vertebrates.</article-title>
        <source>Genome Res</source>
        <volume>19</volume>
        <fpage>327</fpage>
        <lpage>335</lpage>
        <pub-id pub-id-type="pmid">19029536</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Remm1">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Remm</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Storm</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Sonnhammer</surname>
            <given-names>EL</given-names>
          </name>
        </person-group>
        <year>2001</year>
        <article-title>Automatic clustering of orthologs and in-paralogs from pairwise species comparisons.</article-title>
        <source>J Mol Biol</source>
        <volume>314</volume>
        <fpage>1041</fpage>
        <lpage>1052</lpage>
        <pub-id pub-id-type="pmid">11743721</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Shi1">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>MSOAR 2.0: Incorporating tandem duplications into ortholog assignment based on genome rearrangement.</article-title>
        <source>BMC Bioinformatics</source>
        <volume>11</volume>
        <fpage>10</fpage>
        <pub-id pub-id-type="pmid">20053291</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Tatusov1">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tatusov</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Natale</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Garkavtsev</surname>
            <given-names>IV</given-names>
          </name>
          <name>
            <surname>Tatusova</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Shankavaram</surname>
            <given-names>UT</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2001</year>
        <article-title>The COG database: new developments in phylogenetic classification of proteins from complete genomes.</article-title>
        <source>Nucleic Acids Res</source>
        <volume>29</volume>
        <fpage>22</fpage>
        <lpage>28</lpage>
        <pub-id pub-id-type="pmid">11125040</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Li1">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Stoeckert</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Roos</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>OrthoMCL: Identification of ortholog groups for eukaryotic genomes.</article-title>
        <source>Genome Res</source>
        <volume>13</volume>
        <fpage>2178</fpage>
        <lpage>2189</lpage>
        <pub-id pub-id-type="pmid">12952885</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Berglund1">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berglund</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Sjölund</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ostlund</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sonnhammer</surname>
            <given-names>EL</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>InParanoid 6: eukaryotic ortholog clusters with inparalogs.</article-title>
        <source>Nucleic Acids Res</source>
        <volume>36</volume>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Wheeler1">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wheeler</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Barrett</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Benson</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Bryant</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Canese</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2006</year>
        <article-title>Database resources of the national center for biotechnology information.</article-title>
        <source>Nucleic Acids Res</source>
        <volume>34</volume>
        <fpage>D173</fpage>
        <lpage>180</lpage>
        <pub-id pub-id-type="pmid">16381840</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Li2">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Coghlan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Coin</surname>
            <given-names>LJJ</given-names>
          </name>
          <name>
            <surname>Hériché</surname>
            <given-names>JK</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2006</year>
        <article-title>TreeFam: a curated database of phylogenetic trees of animal gene families.</article-title>
        <source>Nucleic Acids Res</source>
        <volume>34</volume>
        <fpage>D572</fpage>
        <lpage>580</lpage>
        <pub-id pub-id-type="pmid">16381935</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Goodstadt1">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goodstadt</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ponting</surname>
            <given-names>CP</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Phylogenetic reconstruction of orthology, paralogy, and conserved synteny for dog and human.</article-title>
        <source>PLoS Comput Biol</source>
        <volume>2</volume>
        <fpage>e133</fpage>
        <pub-id pub-id-type="pmid">17009864</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Han1">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Han</surname>
            <given-names>MV</given-names>
          </name>
          <name>
            <surname>Hahn</surname>
            <given-names>MW</given-names>
          </name>
        </person-group>
        <year>2009</year>
        <article-title>Identifying parent-daughter relationships among duplicated genes.</article-title>
        <source>Pac Symp Biocomput</source>
        <fpage>114</fpage>
        <lpage>125</lpage>
        <pub-id pub-id-type="pmid">19213133</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Boyer1">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boyer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Morgat</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Labarre</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pothier</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Viari</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>Syntons, metabolons and interactons: an exact graph-theoretical approach for exploring neighbourhood between genomic and functional data.</article-title>
        <source>Bioinformatics</source>
        <volume>21</volume>
        <fpage>4209</fpage>
        <lpage>4215</lpage>
        <pub-id pub-id-type="pmid">16216829</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Denilou1">
      <label>14</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Deniélou</surname>
            <given-names>YP</given-names>
          </name>
          <name>
            <surname>Boyer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sagot</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Viari</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Recovering isofunctional genes: a synteny-based approach.</article-title>
        <comment>Actes des Journée Ouvertes de Biologie, Informatique et Mathématiques</comment>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Hannenhalli1">
      <label>15</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hannenhalli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <year>1995</year>
        <source>Transforming men into mice (polynomial algorithm for genomic distance problem). FOCS '95</source>
        <publisher-loc>Washington, DC, USA</publisher-loc>
        <publisher-name>IEEE Computer Society</publisher-name>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Kent1">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Baertsch</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hinrichs</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>Evolution's cauldron: Duplication, deletion, and rearrangement in the mouse and human genomes.</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <volume>100</volume>
        <fpage>11484</fpage>
        <lpage>11489</lpage>
        <pub-id pub-id-type="pmid">14500911</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Pevzner1">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pevzner</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tesler</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>Genome rearrangements in mammalian evolution: Lessons from human and mouse genomes.</article-title>
        <source>Genome Res</source>
        <volume>13</volume>
        <fpage>37</fpage>
        <lpage>45</lpage>
        <pub-id pub-id-type="pmid">12529304</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Semon1">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Semon</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wolfe</surname>
            <given-names>KH</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Rearrangement rate following the whole-genome duplication in teleosts.</article-title>
        <source>Mol Biol Evol</source>
        <volume>24</volume>
        <fpage>860</fpage>
        <lpage>867</lpage>
        <pub-id pub-id-type="pmid">17218642</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Fu1">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Vacic</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Nan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Zhong</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2007</year>
        <article-title>MSOAR: A high-throughput ortholog assignment system based on genome rearrangement.</article-title>
        <source>J Comput Biol</source>
        <volume>14</volume>
        <fpage>1160</fpage>
        <lpage>1175</lpage>
        <pub-id pub-id-type="pmid">17990975</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Fu2">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Clustering of main orthologs for multiple genomes.</article-title>
        <source>J Bioinform Comput Biol</source>
        <volume>6</volume>
        <fpage>573</fpage>
        <lpage>584</lpage>
        <pub-id pub-id-type="pmid">18574863</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Shoja1">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shoja</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>A roadmap of tandemly arrayed genes in the genomes of human, mouse, and rat.</article-title>
        <source>Mol Biol Evol</source>
        <volume>23</volume>
        <fpage>2134</fpage>
        <lpage>2141</lpage>
        <pub-id pub-id-type="pmid">16901985</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Altschul1">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <year>1990</year>
        <article-title>Basic local alignment search tool.</article-title>
        <source>J Mol Biol</source>
        <volume>215</volume>
        <fpage>403</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Enright1">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Enright</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Van Dongen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ouzounis</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>An e±cient algorithm for large-scale detection of protein families.</article-title>
        <source>Nucleic Acids Res</source>
        <volume>30</volume>
        <fpage>1575</fpage>
        <lpage>1584</lpage>
        <pub-id pub-id-type="pmid">11917018</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Vashist1">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vashist</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kulikowski</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Muchnik</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Ortholog clustering on a multipartite graph.</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinformatics</source>
        <volume>4</volume>
        <fpage>17</fpage>
        <lpage>27</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Kann1">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kann</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <year>1991</year>
        <article-title>Maximum bounded 3-dimensional matching is max snp-complete.</article-title>
        <source>Inf Process Lett</source>
        <volume>37</volume>
        <fpage>27</fpage>
        <lpage>35</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Kuhn1">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuhn</surname>
            <given-names>HW</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>The hungarian method for the assignment problem.</article-title>
        <source>Nav Res Log</source>
        <volume>52</volume>
        <fpage>7</fpage>
        <lpage>21</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Alexeyenko1">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexeyenko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tamas</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sonnhammer</surname>
            <given-names>ELL</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Automatic clustering of orthologs and inparalogs shared by multiple proteomes.</article-title>
        <source>Bioinformatics</source>
        <volume>22</volume>
        <fpage>e9</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="pmid">16873526</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-DeLuca1">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeLuca</surname>
            <given-names>TF</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Pu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Monaghan</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Peshkin</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2006</year>
        <article-title>Roundup: a multi-genome repository of orthologs and evolutionary distances.</article-title>
        <source>Bioinformatics</source>
        <volume>22</volume>
        <fpage>2044</fpage>
        <lpage>2046</lpage>
        <pub-id pub-id-type="pmid">16777906</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Yang1">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>PAML 4: Phylogenetic analysis by maximum likelihood.</article-title>
        <source>Mol Biol Evol</source>
        <volume>24</volume>
        <fpage>1586</fpage>
        <lpage>1591</lpage>
        <pub-id pub-id-type="pmid">17483113</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Durand1">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durand</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Halldorsson</surname>
            <given-names>BV</given-names>
          </name>
          <name>
            <surname>Vernot</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>A hybrid micro-macroevolutionary approach to gene tree reconstruction.</article-title>
        <source>J Comput Biol</source>
        <volume>13</volume>
        <fpage>320</fpage>
        <lpage>335</lpage>
        <pub-id pub-id-type="pmid">16597243</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Vernot1">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vernot</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Stolzer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Reconciliation with non-binary species trees.</article-title>
        <source>J Comput Biol</source>
        <volume>15</volume>
        <fpage>981</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="pmid">18808330</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-Ivliev1">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ivliev</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Sergeeva</surname>
            <given-names>MG</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>OrthoFocus: program for identification of orthologs in multiple genomes in family-focused studies.</article-title>
        <source>J Bioinform Comput Biol</source>
        <volume>6</volume>
        <fpage>811</fpage>
        <lpage>824</lpage>
        <pub-id pub-id-type="pmid">18763744</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0020892-HuertaCepas1">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Capella-Gutierrez</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pryszcz</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Denisov</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kormes</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2011</year>
        <article-title>PhylomeDB v3.0: an expanding repository of genome-wide collections of trees, alignments and phylogeny-based orthology and paralogy predictions.</article-title>
        <source>Nucleic Acids Res</source>
        <volume>39</volume>
        <fpage>D556</fpage>
        <lpage>D560</lpage>
        <pub-id pub-id-type="pmid">21075798</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
