<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6825223</article-id>
    <article-id pub-id-type="publisher-id">12990</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-019-12990-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A multi-sample approach increases the accuracy of transcript assembly</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Song</surname>
          <given-names>Li</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sabunciyan</surname>
          <given-names>Sarven</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Guangyu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8124-2324</contrib-id>
        <name>
          <surname>Florea</surname>
          <given-names>Liliana</given-names>
        </name>
        <address>
          <email>florea@jhu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution>McKusick-Nathans Institute of Genetic Medicine, Johns Hopkins School of Medicine, </institution></institution-wrap>Baltimore, MD USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution>Department of Computer Science, </institution><institution>Johns Hopkins University, </institution></institution-wrap>Baltimore, MD USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution>Department of Pediatrics, </institution><institution>Johns Hopkins School of Medicine, </institution></institution-wrap>Baltimore, MD USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution>Department of Medicine, </institution><institution>Johns Hopkins School of Medicine, </institution></institution-wrap>Baltimore, MD USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2106 9910</institution-id><institution-id institution-id-type="GRID">grid.65499.37</institution-id><institution>Present Address: Department of Data Sciences, </institution><institution>Dana Farber Cancer Institute, </institution></institution-wrap>Boston, MA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>5000</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>2</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>10</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Transcript assembly from RNA-seq reads is a critical step in gene expression and subsequent functional analyses. Here we present PsiCLASS, an accurate and efficient transcript assembler based on an approach that simultaneously analyzes multiple RNA-seq samples. PsiCLASS combines mixture statistical models for exonic feature selection across multiple samples with splice graph based dynamic programming algorithms and a weighted voting scheme for transcript selection. PsiCLASS achieves significantly better sensitivity-precision tradeoff, and renders precision up to 2-3 fold higher than the StringTie system and Scallop plus TACO, the two best current approaches. PsiCLASS is efficient and scalable, assembling 667 GEUVADIS samples in 9 h, and has robust accuracy with large numbers of samples.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Transcript assembly is an important step in analysis of RNA-seq data whose accuracy influences downstream quantification, detection and characterization of alternative splice variants. Here, the authors develop PsiCLASS, a transcript assembler leveraging simultaneous analysis of multiple RNA-seq samples.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Genome informatics</kwd>
      <kwd>Software</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation (NSF)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1356078</award-id>
        <award-id>1339134</award-id>
        <principal-award-recipient>
          <name>
            <surname>Florea</surname>
            <given-names>Liliana</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100006955</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | NIH | Office of Extramural Research, National Institutes of Health (OER)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM124531</award-id>
        <principal-award-recipient>
          <name>
            <surname>Florea</surname>
            <given-names>Liliana</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100007123</institution-id>
            <institution>Stanley Medical Research Institute (SMRI)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>n/a</award-id>
        <principal-award-recipient>
          <name>
            <surname>Sabunciyan</surname>
            <given-names>Sarven</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">RNA sequencing (RNA-seq) has become the de facto standard in surveying the transcriptome of a cell, organism, or species, to determine the expressed genes and transcripts and their expression levels, and to enable differential and functional analyses<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup>. A crucial step in virtually all RNA-seq data analyses is assembling the reads into full-length transcripts. The accuracy of transcript reconstruction is critical for quantification, detection, and characterization of alternative splice variants, and the identification of differences in gene expression and splicing patterns between tissues, developmental stages, and physiological or disease states.</p>
    <p id="Par4">Virtually all transcriptomic studies involve multiple samples. The current paradigm is to assemble the reads in each sample, then merge the partial transcripts (transfrags) across all samples to create a unified set of meta-annotations<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, which is used as reference for downstream quantification and differential analyses. Most single-sample assemblers including Cufflinks, isoCEM, Scripture, Traph, CLASS, iReckon, CIDANE, FlipFlop, CLASS2, StringTie, Scallop, and TransComb<sup><xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR15">15</xref></sup> build a graph structure from read alignments on the genome, then traverse the graph to select an optimized set of transcripts, represented as paths. Recent second-generation transcript assembly methods including StringTie, CLASS2, and Scallop have taken great strides toward increasing the accuracy and efficiency of assembly at single-sample level, and meta-assemblers such as StringTie(ST)-merge and TACO<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> have led to more robust collections of meta-annotations. Despite these efforts precision remains low, with &lt;40% of the predicted transcripts in a single-sample and &lt;30% of transcripts in meta-annotations representing complete and accurate reconstructions<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR16">16</xref></sup>. Concomitantly, a handful of efforts have focused on designing methods that simultaneously assemble transcripts across multiple RNA-seq samples, notably CLIIQ, ISP, MiTie, and FlipFlop<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR19">19</xref></sup>. However, none of these programs has comparable performance or is equipped to handle more than a limited number of samples. (See <xref rid="MOESM1" ref-type="media">Supplementary Methods</xref> for a more in-depth review of related work.)</p>
    <p id="Par5">We present PsiCLASS, based on an approach that simultaneously analyzes multiple RNA-seq samples, which achieves significantly higher precision at sensitivity comparable to the best current approaches, and significantly higher overall accuracy in its default setting. PsiCLASS differs from traditional assemblers in two ways. First, it is a combined assembler, reporting a set of transcripts for each sample, and meta-assembler<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, producing a set of meta-annotations obtained by combining the individual samples’ outputs. Second, unlike traditional single-sample assemblers, it uses information from all samples to produce transcripts for individual samples and for the unified annotation set. PsiCLASS starts by selecting a set of high-confidence introns and subexons at each locus, using statistical models of introns and intronic read levels. In doing so, it first generates a set of features (subexons, introns) for each sample, and then corroborates information across all samples to select a high-confidence subset. Next, PsiCLASS builds a unified subexon splice graph that is used within a dynamic programming optimization procedure to select a representative set of transcripts in each sample (see “Methods” and Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref> for details). Lastly, PsiCLASS extracts a subset of meta-annotations from the aggregated transcript sets by voting. Salient features of PsiCLASS include: (i) an algorithm that assembles reads from multiple samples simultaneously, taking advantage of their redundancy and complementarity; (ii) significantly higher precision at meta-assembly level, up to 2–3 fold, over StringTie with ST-merge and Scallop with TACO, and high precision (&gt;50%) overall; (iii) 22–140% increase in precision at meta-assembly level over StringTie with ST-merge, and 35–89% over Scallop with TACO, when matched to their sensitivity levels; (iv) higher overall performance in combined sensitivity and precision at the individual sample level; (v) improved consistency among the individual samples’ annotations and meta-annotations, and robustness with different meta-assemblers; and (vi) high efficiency and scalability, taking only 9 h to assemble 667 GEUVADIS samples, and robust accuracy as the number of samples increases. Overall, PsiCLASS is highly efficient and overcomes limitations in the existing methods, showing significantly higher accuracy, in particular precision, on data sets with a handful to hundreds of samples, thus providing an efficient method for RNA-seq data analysis.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Performance evaluation on simulated data</title>
      <p id="Par6">We compared PsiCLASS with the best current approaches, namely StringTie and Scallop at the individual sample level, and the combinations of StringTie with ST-merge and Scallop with TACO, at the meta-assembly level. We also included FlipFlop, which was the only other competitive multi-assembler; because of excessive run times, however, FlipFlop was not feasible for our tests on real data sets. (Other combinations are shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>). We first applied the methods to 25 RNA-seq samples simulated with Polyester<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, where reads were aligned with two methods, Hisat2<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> and STAR<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. Performance was slightly better for all programs when reads were aligned with Hisat2 (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>), therefore we chose this alignment method for the rest of the analyses.</p>
      <p id="Par7">On the simulated data, PsiCLASS with default voting achieved 71.4% precision, which is 15.0% higher than the StringTie system, and 28.3% and 21.6% higher than Scallop and FlipFlop, respectively, combined with TACO, whereas sensitivity for all programs was roughly 50% (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). Even at the individual sample level, PsiCLASS had both the highest precision and the highest sensitivity: 73.8% precision on average, compared with 70.8% for StringTie, 62.9% for Scallop, and 50.7% for FlipFlop, and 53.4% sensitivity compared with 41.7% for StringTie, 46.2% for Scallop, and 36.1% for FlipFlop. Precision values for StringTie, Scallop, and FlipFlop, but to a lesser extent for PsiCLASS, dropped significantly after aggregation, hence PsiCLASS produces more consistent sets of transcripts between individual samples and the set of meta-annotations.<fig id="Fig1"><label>Fig. 1</label><caption><p>Performance evaluation of methods on simulated and real data: <bold>a</bold> 25 simulated RNA-seq sets, all genes; <bold>b</bold> 25 simulated sets, genes grouped by abundance; <bold>c</bold> 25 GEUVADIS samples (polyadenylated RNA); <bold>d</bold> 73 liver RNA-seq samples (rRNA-depleted total RNA); <bold>e</bold> 44 hippocampus samples from healthy and epileptic mice; and <bold>f</bold> subsets of 1, 2, 3, 5, 10, 20, 40, 80, 160, and 320, and the full set of 667 GEUVADIS samples. In <bold>a</bold>, <bold>b</bold>–<bold>e</bold>, sensitivity (recall) and precision values for PsiCLASS, StringTie, and Scallop at the level of individual samples are shown in boxed plots, and meta-annotations resulted from aggregation (with PsiCLASS voting, ST-merge, and TACO) are shown with colored shapes. Boxplots were generated with R using default options, namely, the box extends between the lower and upper quartiles, horizontal lines mark the median, and whiskers are at the 1.5 × interquantile point above the upper quartile and bellow the lower quartile. Lastly, additional symbols mark sensitivity and precision values for PsiCLASS when tuned to match or approach the sensitivity of its competitors, along the range of cutoff values 0–16, shown with dotted red lines. Source data are provided as a Source Data file</p></caption><graphic xlink:href="41467_2019_12990_Fig1_HTML" id="d29e401"/></fig></p>
      <p id="Par8">We further investigated the performance of methods based on the transcripts’ expression levels (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>). Simulated transcripts were divided into low (463 transcripts; Fragments Per Kilobase (FPK) &lt; 30), medium (658 transcripts; 30 ≤ FPK &lt; 500) and high (322 transcripts; FPK ≥ 500) according to the predefined expression levels. PsiCLASS with voting reconstructs the largest fraction of high-expressed transcripts, 82.4%, and all three programs recover ~60% of the medium-expressed ones. FlipFlop has by far the highest sensitivity in detecting low expression features, 41.0%, compared with 10–20% for the other programs. Note that, because a reconstructed transcript’s expression level may fall in another class than the predefined one, precision cannot be rigorously evaluated.</p>
      <p id="Par9">Similarly, to assess the programs’ performance based on the gene’s splicing complexity, we divided genes into three categories by the number of their alternatively spliced transcripts: low (1 transcript per gene; 680 genes, 680 transcripts), medium (2 transcripts per gene; 166 genes, 332 transcripts), and high (3 or more transcripts per gene; 106 genes, 431 transcripts). While, StringTie showed the best overall performance on the single-transcript genes, PsiCLASS had the highest sensitivity and precision on the medium and high complexity classes, in particular a 16.8–24.5% gain in sensitivity and 21.0–31.8% in precision on highly expressed transcripts (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>).</p>
    </sec>
    <sec id="Sec4">
      <title>Performance evaluation on real RNA-seq data collections</title>
      <p id="Par10">We next assessed the performance on two representative RNA-seq data sets, generated with two different library preparation protocols: 25 randomly selected sets from polyA-selected lymphoblastoid samples from the GEUVADIS population variation project, and 73 rRNA-depleted total RNA libraries from postmortem human liver samples with funding from the Stanley Medical Research Institute. At the meta-assembly level, PsiCLASS’s precision for the GEUVADIS set is 69.3% and 89.2% higher than StringTie’s and Scallop plus TACO’s, respectively, whereas sensitivity is higher or comparable, by 4.5% and −0.9%, respectively (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). Similarly, advantages of the multi-sample approach are seen for the liver total RNA data set, with more than twofold and threefold increases in precision, albeit at 18.6% and 35.3% lower sensitivity. Even when matched to the other programs’ sensitivity settings, PsiCLASS maintains 140% and 89% gains in precision over the StringTie system and Scallop plus TACO, respectively, albeit for this data set Scallop with TACO retains superior sensitivity over the entire parameter range (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>). In such cases, the default voting setting may not present the best tradeoff, and as PsiCLASS’s precision remains significantly higher than that of its counterparts the user may choose a different cutoff. Even at the individual sample level, PsiCLASS’s performance exceeds that of its competitors’, with higher or comparable per sample average measurements in both components (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>, <xref rid="Fig1" ref-type="fig">d</xref>, boxplots).</p>
    </sec>
    <sec id="Sec5">
      <title>Performance evaluation on heterogeneous data collections</title>
      <p id="Par11">Most RNA-seq analyses are aimed at determining gene expression or splicing differences between two biological conditions. To explore the robustness of PsiCLASS when combining two-condition samples, we applied it and the other methods to RNA-seq samples from hippocampi of normal mice (24 samples) and mice with induced epileptic seizures (20 samples) (ref.<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> and Source Data). The diagrams in Fig. <xref rid="Fig1" ref-type="fig">1e</xref> indicate that at the level of individual samples PsiCLASS has higher sensitivity than both StringTie and Scallop, by 26.2% and 8.4% on average, whereas precision exceeds Scallop’s by 42.3% and is comparable to StringTie’s at 66%. Moreover, after voting PsiCLASS’s precision at the level of meta-annotations is 45.7% and 55.0% higher than the other programs’, respectively, along with an increase in sensitivity (15.1% and 7.8%), therefore recommending it as the overall best performer. Thus, PsiCLASS can be effectively and more reliably used on the aggregate set of samples in a two-condition comparison.</p>
      <p id="Par12">We further explored the applicability of PsiCLASS to more divergent and heterogeneous collections of data. We applied PsiCLASS to single- and multi-tissue collections extracted from the GTEx<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> repository (ten RNA-seq samples for each of six tissues: cortex, frontal cortex, cerebellum, heart, liver, and lung). We then aggregated the results in each collection in three ways, using PsiCLASS voting, TACO, and TACO applied to the samples assembled separately by tissue. In all cases, PsiCLASS with its default voting algorithm had better performance, with both higher sensitivity, and higher precision (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>). Notably, our approach resulted in significantly more accurate transcript sets for all collections, with 11.2–16.8% increase in precision over TACO, and a significant 21.4–47.1% increase over TACO applied to the per tissue assembled collections. As the heterogeneity in the data increases, gains in sensitivity reach diminishing returns, while the increase in precision becomes more pronounced. These simple experiments show promise for extending PsiCLASS’s capabilities to more heterogeneous data sets.</p>
    </sec>
    <sec id="Sec6">
      <title>Deconvoluting the effects of algorithmic components</title>
      <p id="Par13">While the different components of the PsiCLASS algorithm are intercalibrated to work in harmony with each other, to guide future program development we attempted to deconvolute the effects on performance of the individual algorithmic components. In a first test, we comprehensively evaluated all combinations of individual sample (PsiCLASS, StringTie, and Scallop) and meta-assemblers (voting, ST-merge, and TACO) at multiple levels. Notably, voting significantly increased transcript level precision for all programs, albeit PsiCLASS maintained a clear advantage in all but one case (GEUVADIS-25), where Scallop’s performance was comparable (Supplementary Figs. <xref rid="MOESM1" ref-type="media">6</xref> and <xref rid="MOESM1" ref-type="media">7</xref>). Conversely, unlike the other two programs, PsiCLASS rendered comparable results when its sample-level transcript sets were merged with the voting, ST-merge and TACO aggregation methods, demonstrating the robustness of its reconstructions (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref>). As conventional measurements based on the number of fully reconstructed transcripts only partially describe the accuracy of a data set, we also assessed the accuracy at the feature (exon, intron) and gene level. Indeed, even when the best meta-assembly method (voting) is used for all programs, PsiCLASS captures significantly more gene and transcript content, with 10–40% more introns and 10–50% more internal exons than StringTie and Scallop, at comparable 95–98% precision (Supplementary Fig. <xref rid="MOESM1" ref-type="media">8</xref>). Further, PsiCLASS reported significantly more genes that had at least one fully reconstructed transcript, 7.0–24.7% more than StringTie and 2.9–31.3% more than Scallop. Lastly but notably, PsiCLASS also detected many more genes: 3.9–9.6% more than StringTie and up to a very significant 46.3% more than Scallop, with the largest of these gains observed for the liver data (Supplementary Figs. <xref rid="MOESM1" ref-type="media">9</xref> and <xref rid="MOESM1" ref-type="media">10</xref>). These improvements are the direct consequence of the completeness of PsiCLASS gene structure model as captured in the shared subexon graph, an algorithmic feature that particularly favors low expression genes.</p>
    </sec>
    <sec id="Sec7">
      <title>Performance evaluation with small numbers of samples</title>
      <p id="Par14">We next investigated the utility of the multi-sample approach for small data collections, including single samples. Table <xref rid="Tab1" ref-type="table">1</xref> shows the results for all methods on sets of 2, 3, 5, and 10 samples from our simulated set, averaged over five independent trials, and for single-sample sets, averaged over all possible 25 trials. The multi-sample approach shows benefits in all cases, most notably increased sensitivity (range 47–53% for PsiCLASS, compared with 42–48% for StringTie, and 43–48% for Scallop with TACO) at comparable or higher precision (range 67–70% for PsiCLASS, compared with 64–71% for StringTie and 57–62% for Scallop).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Performance of methods on experiments with small numbers of samples on simulated data</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Number of samples</th><th>Recall PsiCLASS</th><th>Recall StringTie</th><th>Recall Scallop</th><th>Precision PsiCLASS</th><th>Precision StringTie</th><th>Precision Scallop</th></tr></thead><tbody><tr><td>1</td><td>45.6</td><td>41.7</td><td>46.2</td><td>66.9</td><td>70.8</td><td>62.9</td></tr><tr><td>2</td><td>46.7</td><td>43.8</td><td>43.3</td><td>68.6</td><td>69.1</td><td>57.0</td></tr><tr><td>3</td><td>49.9</td><td>45.2</td><td>45.0</td><td>67.3</td><td>68.5</td><td>56.7</td></tr><tr><td>5</td><td>52.1</td><td>46.6</td><td>46.2</td><td>69.7</td><td>66.7</td><td>56.7</td></tr><tr><td>10</td><td>52.7</td><td>48.0</td><td>48.1</td><td>70.0</td><td>64.0</td><td>56.5</td></tr></tbody></table></table-wrap></p>
      <p id="Par15">PsiCLASS is designed to take advantage of cross-sample gene information in a multi-sample experiment. Nevertheless, we also evaluated it and the other programs on isolated single-samples from three previously reported real data sets (Table <xref rid="Tab2" ref-type="table">2</xref>). PolyA-selected RNA-seq paired-end reads from CD20+ (SRR534319, 25 million reads), CD14+ (SRR545695, 39 million reads), and IMR90 (SRR534291, 114 million reads) cell lines were previously used to demonstrate performance improvements in both the StringTie and Scallop publications. When PsiCLASS used solely information from that sample, performance across the three samples was similar between StringTie and PsiCLASS, whereas Scallop had significantly higher sensitivity albeit at slightly lower precision. However, since each data set was part of a multi-sample experiment (SRR534291-SRR534292, SRR545695-SRR545700, and SRR534319-SRR534324), we sought to assess the advantage of the cross-sample information. Even with the small (2–6) number of replicates, when all samples in an experiment were considered PsiCLASS’s performance for the three samples improved (up to 28.3% sensitivity increase over PsiCLASS single-sample, and up to 35.0% over StringTie), especially for the low coverage sample (SRR534319).<table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance of methods on experiments with small numbers of samples on real data</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Sample</th><th>Recall PsiCLASS<sup>a</sup></th><th>Recall PsiCLASS<sup>b</sup></th><th>Recall StringTie</th><th>Recall Scallop</th><th>Precision PsiCLASS<sup>a</sup></th><th>Precision PsiCLASS<sup>b</sup></th><th>Precision StringTie</th><th>Precision Scallop</th></tr></thead><tbody><tr><td>SRR534319</td><td>44.2</td><td>56.7</td><td>42.0</td><td>65.7</td><td>29.5</td><td>30.1</td><td>30.5</td><td>24.5</td></tr><tr><td>SRR545695</td><td>50.4</td><td>60.3</td><td>49.4</td><td>72.7</td><td>32.5</td><td>32.4</td><td>35.7</td><td>26.6</td></tr><tr><td>SRR534291</td><td>63.3</td><td>66.1</td><td>65.5</td><td>81.6</td><td>30.8</td><td>35.0</td><td>37.1</td><td>35.1</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Single samples in one-sample experiments</p><p><sup>b</sup>Individual samples in multi-sample experiments</p></table-wrap-foot></table-wrap></p>
      <p id="Par16">Overall, PsiCLASS showed competitive or higher performance on experiments with a small (2–10) number of samples, with benefits most evident for data sets of three or more samples. It also ranked comparable with StringTie and Scallop on single-sample data sets in our control experiments, and similarly to StringTie on the three samples for which the two reference programs were optimized. Therefore, our program can be effectively used for small RNA-seq collections and within the conventional assemble-and-merge approach.</p>
    </sec>
    <sec id="Sec8">
      <title>Performance evaluation on very large data collections</title>
      <p id="Par17">As the emerging landscape of RNA-seq foresees increasingly larger data sets from large patient cohorts and population variation studies, we aimed to assess the suitability of the multi-sample approach as the data set grows. We evaluated program performance on increasingly larger subsets of RNA-seq samples from the GEUVADIS population variation project, up to the full set of 667 samples (Fig. <xref rid="Fig1" ref-type="fig">1f</xref>). All methods show improvements in sensitivity as the number of samples increases, but while PsiCLASS and Scallop show further slight gains after 20–50 samples, the sensitivity of StringTie drops. Precision drops markedly for both Scallop and StringTie, to less than 35% for 50 samples and below 20% for the full set of samples. In sharp contrast, PsiCLASS’s sensitivity and precision remain almost constant with more than ten samples, demonstrating the robustness of this approach. Also, with sensitivity 9–40% higher than StringTie’s and precision (&gt;50%) twice as high as that of the other two systems when the data set exceeds 20–50 samples, PsiCLASS is unequivocally the best suited for handling large RNA-seq collections. Lastly, PsiCLASS took only 9 h with 24 threads to process the 667 samples at a peak memory of 14 GB RAM on an 3.0 GHz Intel “Ivy Bridge” Xeon server, amounting to &lt;1 min per sample. By comparison, StringTie took 34 h to process the samples sequentially, with 24 threads, at a peak memory of 524 MB, and Scallop, which is single-threaded, required 75 h with a peak memory of 5 GB.</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par18">Determining the set of expressed genes and transcripts in an RNA-seq experiment is critical for subsequent quantification and differential expression and splicing analyses. The conventional approach to process each sample separately and then merge the sets of transcripts to create a unified set of annotations has limitations, in particular low precision. We present PsiCLASS, a transcript assembler and meta-assembler that simultaneously analyzes all samples in an RNA-seq experiment. Algorithmic underpinnings of PsiCLASS include a global subexon graph, statistical methods for cross-sample feature selection, and dynamic programming optimization and voting algorithms for transcript selection at the level of individual samples and over the entire collection of data, which collectively lead to more complete, more accurate, and more consistent sets of annotations. In particular, our study suggests that voting-based approaches may have advantages over the current assembly-based aggregation methods in some cases, albeit their broader applicability needs to be further investigated.</p>
    <p id="Par19">PsiCLASS is designed to leverage the gene information across samples in a one or two condition experiments, to improve the accuracy of gene and transcript reconstruction for downstream differential gene expression and differential splicing studies, and may not be ideally suited to multi-condition experiments, such as annotation of genes and alternative splicing in large data sets such as GTEx<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> or TCGA<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. Nevertheless, our limited tests on collections of samples from 2 to 6 GTEx tissues reflect that PsiCLASS has better performance than TACO, and therefore show promise for exploring capabilities for handling more heterogeneous data sets in the future.</p>
    <p id="Par20">PsiCLASS had significantly higher precision at similar sensitivity when compared with current best methods, and showed consistently high precision (&gt;50%) when tested on data from a variety of experimental conditions. PsiCLASS is scalable, efficient, and robust with large numbers of RNA-seq samples, thus providing a highly effective paradigm for large-scale analyses of collections of hundreds and thousands of samples. PsiCLASS is available free of charge from <ext-link ext-link-type="uri" xlink:href="https://github.com/splicebox/PsiCLASS">https://github.com/splicebox/PsiCLASS</ext-link>.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Algorithm overview</title>
      <p id="Par21">PsiCLASS builds a global subexon graph of a gene and its splice variants from genome-aligned RNA-seq reads in all input samples. It then traverses the graph to select a subset of the encoded transcripts in each sample. Lastly, it combines the predicted transcript sets across all samples, using a voting procedure to select a final set of meta-annotations.</p>
      <p id="Par22"><italic>Building per sample subexon graphs</italic>. PsiCLASS builds a subexon graph for each sample, then combines graphs across all samples to create a global subexon graph. In each sample, PsiCLASS uses candidate introns extracted from spliced read alignments to divide the genome into regions and subexons. A region denotes a maximal contiguous portion of the genome covered by reads. A subexon is a portion of a region delimited by two consecutive splice junctions and/or the end(s) of the region. A subexon graph has subexons as vertices, and two subexons are connected by an edge if they are adjacent in the same region or connected by an intron. Candidate splice variants are encoded as maximal paths in the subexon graph.</p>
      <p id="Par23">To build the sample-level subexon graph, PsiCLASS clusters read alignments along the genome that are colocated and on the same strand. Introns are extracted from spliced alignments and used to divide the region into subexons. A major confounding factor in determining subexons from RNA-seq data is the presence of intronic unprocessed RNA (‘noise’). To differentiate between intronic noise and signal, such as retained introns or alternative 5′ and 3′ gene ends, PsiCLASS assigns each subexon a score that reflects the probability that it is noise. In contrast to current single-sample methods, which simply discard a subexon if it fails sample-wide cutoffs, PsiCLASS then combines sample-level scores across all samples to determine a final label for the subexon and its inclusion in the global subexon graph.</p>
      <p id="Par24">More specifically, PsiCLASS computes the probability that a subexon is due to intronic noise using two models: (i) the exon–intron coverage ratio, and (ii) the intronic read coverage. Let <italic>c</italic><sub><italic>i</italic></sub> be the average read coverage of (intronic) subexon <italic>i</italic>. In the coverage ratio model, PsiCLASS calculates a score that is equal to the coverage ratio of this subexon versus its flanking subexons: <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i = {\mathrm{min}}\left( {\frac{{c_i}}{{c_{i - 1}}},\frac{{c_i}}{{c_{i + 1}}}} \right)$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">min</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq1.gif"/></alternatives></inline-formula>. The score is fitted to a mixture of two Gamma distributions, one representing signal and one noise: <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left( {r_i} \right) = \pi \Gamma _{\theta _0,k_0}\left( {r_i} \right) + \left( {1 - \pi } \right)\Gamma _{\theta _1,k_1}\left( {r_i} \right)$$\end{document}</tex-math><mml:math id="M4"><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq2.gif"/></alternatives></inline-formula>, where <italic>π</italic>, (1 − <italic>π</italic>) are the prior probabilities that an intronic subexon is noise or signal, respectively, and <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _0,k_0,\theta _1,k_1$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq3.gif"/></alternatives></inline-formula> are the parameters for the Gamma distributions, calculated with an expectation maximization algorithm. With these parameters, PsiCLASS can infer the probability that subexon <italic>i</italic> is noise according to the Bayes formula: <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_R\left( {r_i} \right) = \frac{{\pi \Gamma _{\theta _0,k_0}\left( {r_i} \right)}}{{\pi {\mathrm{\Gamma }}_{\theta _0,k_0}\left( {r_i} \right) + \left( {1 {\,}-{\,} \pi } \right)\Gamma _{\theta _1,k_1}\left( {r_i} \right)}}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>π</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.25em"/><mml:mo>−</mml:mo><mml:mspace width="0.25em"/><mml:mi>π</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq4.gif"/></alternatives></inline-formula>.</p>
      <p id="Par25">The coverage ratio model above is insufficient when the overall gene coverage is low. Hence, the second model establishes a similar formula for coverage levels, <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_C\left( {c_i} \right)$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq5.gif"/></alternatives></inline-formula>, with <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta^\prime_0,k^\prime _0,\theta ^\prime _1,k^\prime _1$$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq6.gif"/></alternatives></inline-formula> the parameters inferred using coverage. The final per sample subexon score then is <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( i \right) = {\mathrm{max}}(P_R\left( {r_i} \right),\;P_C(c_i))$$\end{document}</tex-math><mml:math id="M14"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.16em"/><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq7.gif"/></alternatives></inline-formula>.</p>
      <p id="Par26"><italic>Building the global subexon graph</italic>. PsiCLASS removes likely artifactual introns and intronic noise subexons by evaluating evidence across all sample, and builds a global subexon graph by combining individual samples’ graphs that share at least one intron. <italic>Multi-sample intron selection</italic>: To select a highly accurate set of introns, PsiCLASS assesses each candidate intron’s read support across all samples. Assume the experiment contains <italic>M</italic> samples, and denote each intron by its coordinates in the genome, e.g., (<italic>a, b</italic>). Let <italic>S</italic> (<italic>a, b</italic>) denote the total number of read alignments supporting (<italic>a, b</italic>) over all samples. Then the total number of alignments supporting its splice sites: <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S\left( a \right) = \mathop {\sum }\nolimits_{(a,y)} S\left( {a,y} \right),\;S\left( b \right) = \mathop {\sum }\nolimits_{\left( {x,b} \right)} S(x,b)$$\end{document}</tex-math><mml:math id="M16"><mml:mi>S</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mi>S</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.16em"/><mml:mi>S</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq8.gif"/></alternatives></inline-formula>. PsiCLASS keeps intron (<italic>a, b</italic>) iff: (i) <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{S\left( {a,b} \right)}}{M} \ge 0.5$$\end{document}</tex-math><mml:math id="M18"><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfrac><mml:mo>≥</mml:mo><mml:mn>0.5</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq9.gif"/></alternatives></inline-formula>, indicating strong read support in one or a few samples, or consistent read support across multiple samples; and (ii) (<italic>a, b</italic>) appears in at least <italic>M</italic>0 samples, where <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M0 = \min \left( \lceil{\frac{M}{{50}}\rceil\left( \lfloor{\frac{{b - a + 1}}{{100,000}}\rfloor + 1} \right),\;M} \right)$$\end{document}</tex-math><mml:math id="M20"><mml:mi>M</mml:mi><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:mi>min</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mrow><mml:mo>⌈</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>⌉</mml:mo></mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mrow><mml:mo>⌊</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.16em"/><mml:mi>M</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq10.gif"/></alternatives></inline-formula>, if |<italic>b</italic> <italic>−</italic> <italic>a</italic>| ≥ 100,000 (long intron). Condition (ii) is intended to filter out long intron-type alignment artifacts due to gene families and repeats, or from sequencing errors, which can lead to merged genes and transcripts. <italic>Multi-sample subexon selection:</italic> To determine a global set of subexons, PsiCLASS combines the subexon sets of individual samples with some modifications. Where multiple 3′ or 5′-end (i.e., subexons not delimited by a splice site) candidate subexons occur with the same endpoint and potentially different lengths among the samples, PsiCLASS creates a unique subexon with the median length. Further, to determine intronic subexons, PsiCLASS calculates a final score by combining all sample scores with a Bayesian formula. More specifically, let <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar \pi$$\end{document}</tex-math><mml:math id="M22"><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq11.gif"/></alternatives></inline-formula> denote the prior probability of intronic noise in the global model, calculated as the average of the mixture coefficients of the samples. Then the subexon score: <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_n\left( {{\mathrm{noise}}|{\mathrm{data}}} \right) = \frac{{\bar \pi {P({\mathrm{data}}|{\mathrm{noise}}})}}{{\bar \pi P\left( {{\mathrm{data}}|{\mathrm{noise}}} \right) + \left( {1 - \bar \pi } \right)P\left( {{\mathrm{data|real}}} \right)}}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">noise</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="normal">data</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">data</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="normal">noise</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">data</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="normal">noise</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">data∣real</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq12.gif"/></alternatives></inline-formula> reflects the probability that the subexon is noise, where data is the observed information such as the coverage in each sample. We assume the samples are independent, hence <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{P}}\left( {{\mathrm{data}}|{\mathrm{noise}}} \right) = \mathop {\prod }\nolimits_{s = 1}^M G_0^{\left( s \right)}\left( i \right)$$\end{document}</tex-math><mml:math id="M26"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">data</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="normal">noise</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo> ∏</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq13.gif"/></alternatives></inline-formula>, where <italic>s</italic> = 1<italic>,…, M</italic> denotes the sample. Here, <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_0^{\left( s \right)}\left( i \right)$$\end{document}</tex-math><mml:math id="M28"><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq14.gif"/></alternatives></inline-formula> is <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma _{\theta _0^{\left( s \right)},\:k_0^{\left( s \right)}}(r_i^{(s)})$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="2.22144pt"/><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq15.gif"/></alternatives></inline-formula> if the ratio model is used for subexon <italic>i</italic> in sample <italic>s</italic>, and <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma _{\theta \prime _0^{\left( s \right)},\;k\prime _0^{\left( s \right)}}( {c_i^{(s)}} )$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.16em"/><mml:msubsup><mml:mrow><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq16.gif"/></alternatives></inline-formula> if the <italic>coverage model</italic> is employed. Similarly, <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( {{\mathrm{data}}|{\mathrm{real}}} \right) = \mathop {\prod }\nolimits_{s = 1}^M G_1^{\left( s \right)}\left( i \right)$$\end{document}</tex-math><mml:math id="M34"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">data</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="normal">real</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo> ∏</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq17.gif"/></alternatives></inline-formula>. In the end, the subexon is retained if it passes a predefined threshold.</p>
      <p id="Par27"><italic>Transcript selection</italic>. Candidate transcript models are represented as maximal paths in the global subexon graph, from a node with no incoming edges (source) to a node with no outgoing edges (sink). Since the graph generally encodes a much larger number of transcripts than is biologically possible, PsiCLASS identifies and selects a subset of transcripts that can explain all contiguity constraints from spliced reads and paired reads. PsiCLASS first predicts a set of transcripts for each sample, using a graph-based dynamic programming algorithm with the global subexon graph and the sample specific alignment data, then combines the individual samples’ transcript sets and selects a subset of meta-annotations by voting.</p>
      <p id="Par28">To predict a set of transcripts for each sample, PsiCLASS employs a SET_COVER framework and dynamic programming algorithms<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, adapted for subexon graphs. Namely, we define a constraint as a cluster of read alignments with the same subexon pattern. Like CLASS2, PsiCLASS uses constraints to decrease the memory usage while preserving the structural and contiguity information contained in the full set of reads. For a given graph <italic>G</italic>, let <italic>C</italic> = {<italic>c</italic><sub>1</sub><italic>, …, c</italic><sub><italic>m</italic></sub>} denote the set of constraints and <italic>T</italic> = {<italic>t</italic><sub>1</sub><italic>, …, t</italic><sub><italic>n</italic></sub>} the set of candidate transcripts, encoded in the graph. Given a constraint <italic>c</italic><sub><italic>i</italic></sub>, its abundance <italic>a</italic><sub><italic>i</italic></sub> = <italic>a</italic>(<italic>c</italic><sub><italic>i</italic></sub>) defined as the number of supporting reads (or read pairs) normalized by the number of possible start positions of the reads within the constraint’s subexons. To reduce the transcript selection problem to SET_COVER, we view each candidate transcript <italic>t</italic><sub><italic>j</italic></sub> as the set of constraints that are compatible with its exon-intron structure: <italic>C</italic>(<italic>t</italic><sub><italic>j</italic></sub>) = {<italic>c</italic><sub><italic>1</italic></sub><italic>, …,c</italic><sub><italic>nj</italic></sub>}, where <italic>c</italic><sub><italic>i</italic></sub><italic> ~ t</italic><sub><italic>j</italic></sub>. Constraint <italic>c</italic><sub><italic>i</italic></sub> is compatible with the transcript <italic>t</italic><sub><italic>j</italic></sub>’s exon-intron structure, denoted <italic>c</italic><sub><italic>i</italic></sub> ~ <italic>t</italic><sub><italic>j</italic></sub>, if its list of subexon intervals is contained in that of the transcript’s and all the exon–exon junctions correspond to introns in the transcript.</p>
      <p id="Par29">In the simplest formulation, the goal then is to select a minimal (parsimonious) subset of transcripts that satisfies all constraints. More realistically, to account for the different abundance of constraints, we define a transcript’s abundance as the minimum abundance among its set of constraints: <italic>A</italic><sub><italic>j</italic></sub> = <italic>min</italic> { <italic>a</italic><sub><italic>i</italic></sub><italic>| c</italic><sub><italic>i</italic></sub><italic> ~ t</italic><sub><italic>j</italic></sub> }. The goal then becomes to determine a subset of transcripts that most closely explain the constraints and their abundance levels. PsiCLASS uses a greedy approximation framework to address this problem, iteratively selecting the transcript that covers the largest number of constraints weighted by the constraints’ abundance, then adjusting the constraints’ abundance levels before the next iteration:</p>
      <p id="Par30">While ({nondepleted constraints} <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ne \, \emptyset$$\end{document}</tex-math><mml:math id="M36"><mml:mo>≠</mml:mo><mml:mspace width="0.25em"/><mml:mi>∅</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq18.gif"/></alternatives></inline-formula>):</p>
      <p id="Par31">Choose transcript <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \in T$$\end{document}</tex-math><mml:math id="M38"><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq19.gif"/></alternatives></inline-formula> that maximizes <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|C\left( t \right)|\left( {1 + \frac{{A_t}}{A}} \right)$$\end{document}</tex-math><mml:math id="M40"><mml:mo>∣</mml:mo><mml:mi>C</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>∣</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq20.gif"/></alternatives></inline-formula></p>
      <p id="Par32">Update the constraints’ abundance:</p>
      <p>
        <disp-formula id="Equa">
          <alternatives>
            <tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x = \mathop {{{\mathrm{min}}}}\limits_{c \in C(t)} \{ a\left( c \right)\}$$\end{document}</tex-math>
            <mml:math id="M42">
              <mml:mi>x</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:munder>
                <mml:mrow>
                  <mml:mi mathvariant="normal">min</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                  <mml:mo>∈</mml:mo>
                  <mml:mi>C</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:munder>
              <mml:mrow>
                <mml:mo>{</mml:mo>
                <mml:mrow>
                  <mml:mi>a</mml:mi>
                  <mml:mfenced close=")" open="(" separators="">
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                  </mml:mfenced>
                </mml:mrow>
                <mml:mo>}</mml:mo>
              </mml:mrow>
            </mml:math>
            <graphic xlink:href="41467_2019_12990_Article_Equa.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
        <disp-formula id="Equb">
          <alternatives>
            <tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{For}}\;{\mathrm{each}}\;c \in C\left( t \right)\!\! :$$\end{document}</tex-math>
            <mml:math id="M44">
              <mml:mi mathvariant="normal">For</mml:mi>
              <mml:mspace width="0.16em"/>
              <mml:mi mathvariant="normal">each</mml:mi>
              <mml:mspace width="0.16em"/>
              <mml:mi>c</mml:mi>
              <mml:mo>∈</mml:mo>
              <mml:mi>C</mml:mi>
              <mml:mfenced close=")" open="(" separators="">
                <mml:mrow>
                  <mml:mi>t</mml:mi>
                </mml:mrow>
              </mml:mfenced>
              <mml:mspace width="0.3em"/>
              <mml:mspace width="0.3em"/>
              <mml:mo>:</mml:mo>
            </mml:math>
            <graphic xlink:href="41467_2019_12990_Article_Equb.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
        <disp-formula id="Equc">
          <alternatives>
            <tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a\left( c \right) = a\left( c \right) - x$$\end{document}</tex-math>
            <mml:math id="M46">
              <mml:mi>a</mml:mi>
              <mml:mfenced close=")" open="(" separators="">
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:mi>a</mml:mi>
              <mml:mfenced close=")" open="(" separators="">
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>−</mml:mo>
              <mml:mi>x</mml:mi>
            </mml:math>
            <graphic xlink:href="41467_2019_12990_Article_Equc.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>if <inline-formula id="IEq21"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a\left( c \right) \le 0$$\end{document}</tex-math><mml:math id="M48"><mml:mi>a</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq21.gif"/></alternatives></inline-formula>, mark constraint <italic>c</italic> as depleted.</p>
      <p id="Par33">PsiCLASS implements the procedure above in two steps. First, it determines the candidate set of transcripts <italic>T</italic>, using either enumeration (for graphs with &lt;200,000 transcripts) or a variation of the splice-graph dynamic programming algorithm in Song et al.<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> that considers all reads single-end, for fast processing. Once the candidate transcript set <italic>T</italic> is determined, PsiCLASS applies the greedy SET_COVER approximation algorithm above.</p>
      <p id="Par34">For completeness, we include a brief description of the dynamic programming optimization procedure. The algorithm considers all subpaths <italic>L</italic>, and recursively calculates the maximum number of constraints <italic>f</italic>(<italic>L</italic>) for substranscripts starting with subpath <italic>L</italic>: <italic>f</italic>(<italic>L</italic>) = max<sub><italic>L</italic>’</sub> { <italic>f</italic>(<italic>L</italic>′) + <italic>c</italic>(<italic>L, L</italic>′), if <italic>L</italic>′ exists; <italic>c</italic>(<italic>L</italic>), if <italic>L</italic>′does not exist }, where: (i) <italic>L</italic>′ is a subpath immediately following <italic>L</italic> so that all constraints compatible with <italic>L</italic> end before or within <italic>L</italic>′; (ii) <italic>c</italic>(<italic>L, L</italic>′) is the number of constraints starting in and (partially) compatible with <italic>L</italic> and <italic>L</italic>′, and compatible with the concatenated subpath <italic>L</italic>, <italic>L</italic>′; and (iii) <italic>c</italic>(<italic>L</italic>) is the number of constraints covered by subtranscript <italic>L</italic>. To take into account the abundance levels in the optimization process, at each sweep of the graph the algorithm excludes subpaths that cover constraints with abundance below a fixed value <italic>x</italic>; hence, the dynamic programming algorithm will return the best transcript with abundance greater than <italic>x</italic> (<italic>x</italic>-abundance transcript). With this modification, at each graph sweep the selection process selects an <italic>x</italic>-abundance transcript, starting with <italic>x</italic><sub>0</sub> = 0 (thus guaranteeing that such a transcript exists), and each selected transcript’s abundance value used as lower bound for the selection process at the following step: 0 <italic>=</italic> <italic>x</italic><sub>0</sub> <italic>&lt;</italic> <italic>x</italic><sub>1</sub> <italic>&lt;</italic> <italic>x</italic><sub>2</sub> <italic>&lt;</italic> ⋯<italic>x</italic><sub><italic>m</italic></sub>, until no transcript can be found. The optimal transcript then is among those selected by the sweeps. More details, along with proof of correctness for the algorithm, can be found in Song et al.<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>.</p>
      <p id="Par35"><italic>Selecting a global set of transcripts</italic>. PsiCLASS selects a set of meta-annotations from the individual samples’ sets of transcripts by voting. Each transcript is assigned a score equal to the transcript’s average estimated abundance across the samples (i.e., every sample has one vote, weighted by the transcript’s abundance level; default cutoff: 1.0). As different cutoff parameters values might work best for data with specific characteristics, the user can readily adjust or recalibrate the voting parameters postassembly, starting from the already computed sets of transcripts for the individual samples.</p>
    </sec>
    <sec id="Sec12">
      <title>Sequence data</title>
      <p id="Par36">We generated 25 RNA-seq samples, with ~85 million 100 bp paired-end reads, using the software Polyester<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> with the default gene and transcript distribution models and randomly sampling 10% of the transcripts (at 13,912 genes) from the human GENCODE v.27<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> gene annotations. Reads were aligned to the reference genome hg38 separately with Hisat2 v.2.0.5<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> and STAR v.2.5.3a<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. Chromosome 2 alignments were extracted and used in the assembly and evaluations. Human liver samples were obtained from the Stanley Medical Research Institute (SMRI) and previously sequenced by Dr. Sabunciyan’s lab. All ethical standards set forth by the Johns Hopkins University and local laws were complied with. The liver tissue was collected postmortem by the SMRI after obtaining consent from the family of the deceased. A detailed description of the consent procedure and the collection was published<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>. The project was reviewed by the Johns Hopkins University Institutional Review Board (IRB) and was given exempt status since only postmortem tissue was involved in the research. For sequencing, total RNA was isolated using the Qiagen RNeasy kit and libraries were constructed using the Illumina TruSeq Stranded Total RNA kit for Human/Mouse/Rat following the manufacturers recommended protocol. The resulting stranded, rRNA depleted liver libraries were sequenced on an Illumina HiSeq 2000 instrument. 667 RNA-seq samples from human lymphoblastoid cell lines part of the GEUVADIS population variation project were publicly available from ArrayExpress (accession: E-GEUV-6), and mouse hippocampus RNA-seq data were those reported in ref. <sup><xref ref-type="bibr" rid="CR23">23</xref></sup> and available from GenBank (ProjectID: PRJEB18790). Lastly, RNA-seq samples from six human tissues (frontal cortex, cortex, cerebellum, heart, liver, and lung) used in the heterogeneity study were downloaded from the dbGAP GTEx<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> repository. The lists of samples for each evaluation are included in the Source Data file.</p>
    </sec>
    <sec id="Sec13">
      <title>Performance evaluation</title>
      <p id="Par37">Once the reads were mapped to the genome, we used StringTie v.1.3.3.b and Scallop v.0.10.2 to assemble them into transcripts, for each individual sample. Transcript sets for all samples in an experiment were then merged with StringTie(ST)-merge and TACO v.0.7.3. For PsiCLASS v.1.0.1, reads were assembled simultaneously across all samples. To evaluate the accuracy of transcript assembly, we employed standard sensitivity (Sn) and precision (Pr) measures and evaluation criteria to assess the accuracy of transcript reconstructions by comparison to a gold reference, namely the set of simulated transcripts and the human GENCODE v.27 and mouse RefSeq gene annotations. A predicted transcript is deemed a true positive (TP) iff its intron chain fully matches that of a gold reference transcript. If N is the number of predicted transcripts, M be the number of ground truth transcripts, then Sn = TP/M and Pr = TP/N <sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. Performance metrics at the transcript, exon, and intron levels were calculated with the tool <italic>grader</italic> included in the PsiCLASS package, and at the gene level with the tool Cuffcompare (v.2.2.1). For gene content analyses, only transcripts that were a full match, contained or splice variant transcript (codes ‘=’, ‘c’, and ‘j’) of a reference gene were considered.</p>
    </sec>
    <sec id="Sec14">
      <title>Reporting summary</title>
      <p id="Par38">Further information on research design is available in the <xref rid="MOESM3" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec15">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2019_12990_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2019_12990_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2019_12990_MOESM3_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2019_12990_MOESM4_ESM.xlsx">
            <caption>
              <p>Source Data</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Peer review information</bold><italic>Nature Communications</italic> thanks the anonymous reviewer(s) for their contribution to the peer review of this work. Peer reviewer reports are available.</p>
    </fn>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> is available for this paper at 10.1038/s41467-019-12990-0.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Development and evaluations were performed on the Maryland Advanced Research Computing Center (MARCC). Work was supported in part by NSF grants ABI-1356078 and IOS-1339134 to L.F., and by NIH grants R01GM129085 and R01GM124531 to L.F. and Kathleen Burns. S.S. was supported by a grant from the Stanley Medical Research Institute.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>L.F. and L.S. conceived the project, L.S. developed the method, S.S. provided sequence data, and L.S., L.F., G.Y., and S.S. contributed to the evaluation. All authors wrote and approved the paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>Raw sequence data for the GEUVADIS project can be obtained from ArrayExpress (Accession:E-GEUV-6), mouse hippocampus data from GenBank (ProjectID:PRJEB18790), and alignments of simulated data from Zenodo (10.5281/zenodo.1407759). The liver data has been deposited in GenBank under accession <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA575230">PRJNA575230</ext-link>. In addition, the full set of evaluation results represented in Fig. <xref rid="MOESM4" ref-type="media">1</xref>, Tables <xref rid="MOESM4" ref-type="media">1</xref> and <xref rid="MOESM4" ref-type="media">2</xref>, and Supplementary Figs. <xref rid="MOESM4" ref-type="media">2</xref>, <xref rid="MOESM4" ref-type="media">4</xref>–<xref rid="MOESM4" ref-type="media">9</xref> are provided as a Source Data file, and scripts for performing the evaluation and links to the assembled transcripts can be obtained from the project site in GitHub. All other relevant data are available upon request.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>PsiCLASS is available under a GNU GPL license from <ext-link ext-link-type="uri" xlink:href="https://github.com/splicebox/PsiCLASS">https://github.com/splicebox/PsiCLASS</ext-link>.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par39">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>
        <source>Nat. Rev. Genet</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2484</pub-id>
        <pub-id pub-id-type="pmid">19015660</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Shai</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Frey</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Blencowe</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Deep surveying of alternative splicing complexity in the human transcriptome by high-throughput sequencing</article-title>
        <source>Nat. Genet</source>
        <year>2008</year>
        <volume>40</volume>
        <fpage>1413</fpage>
        <lpage>1415</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.259</pub-id>
        <pub-id pub-id-type="pmid">18978789</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Niknafs</surname>
            <given-names>YS</given-names>
          </name>
          <name>
            <surname>Pandian</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Chinnaiyan</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>MK</given-names>
          </name>
        </person-group>
        <article-title>TACO produces robust multisample transcriptome assemblies from RNA-seq</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>68</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4078</pub-id>
        <pub-id pub-id-type="pmid">27869815</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2009</year>
        <volume>28</volume>
        <fpage>511</fpage>
        <lpage>515</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1621</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>IsoLasso: a LASSO regression approach to RNA-Seq based transcriptome assembly</article-title>
        <source>J. Comput. Biol.</source>
        <year>2011</year>
        <volume>18</volume>
        <fpage>1693</fpage>
        <lpage>1707</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2011.0171</pub-id>
        <pub-id pub-id-type="pmid">21951053</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guttman</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ab initio reconstruction of cell type-specific transcriptomes in mouse reveals the conserved multi-exonic structure of lincRNAs</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>503</fpage>
        <lpage>510</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1633</pub-id>
        <pub-id pub-id-type="pmid">20436462</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tomescu</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Kuosmanen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rizzi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Makinen</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>A novel min-cost flow method for estimating transcript expression with RNA-Seq</article-title>
        <source>BMC Bioinform.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>S15</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-S5-S15</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Florea</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>CLASS: constrained transcript assembly of RNA-seq reads</article-title>
        <source>BMC Bioinforma.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>S14</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-S5-S14</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mezlini</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>iReckon: simultaneous isoform discovery and abundance estimation from RNA-seq data</article-title>
        <source>Genome Res</source>
        <year>2013</year>
        <volume>23</volume>
        <fpage>519</fpage>
        <lpage>529</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.142232.112</pub-id>
        <pub-id pub-id-type="pmid">23204306</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Canzar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Andreotti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Weese</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Klau</surname>
            <given-names>GW</given-names>
          </name>
        </person-group>
        <article-title>CIDANE: comprehensive isoform discovery and abundance estimation</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>16</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0865-0</pub-id>
        <pub-id pub-id-type="pmid">26831908</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bernard</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Jacob</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mairal</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vert</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Efficient RNA isoform identification and quantification from RNA-Seq data with network flows</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2447</fpage>
        <lpage>2455</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu317</pub-id>
        <pub-id pub-id-type="pmid">24813214</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sabunciyan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Florea</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>CLASS2: accurate and efficient splice variant annotation from RNA-seq reads</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>e98</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw158</pub-id>
        <pub-id pub-id-type="pmid">26975657</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pertea</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>StringTie enables improved reconstruction of a transcriptome from RNA-seq reads</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>290</fpage>
        <lpage>295</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3122</pub-id>
        <pub-id pub-id-type="pmid">25690850</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>TransComb: genome-guided transcriptome assembly via combing junctions in splicing graphs</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>213</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-1074-1</pub-id>
        <pub-id pub-id-type="pmid">27760567</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shao</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kingsford</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Accurate assembly of transcripts through phase-preserving graph decomposition</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>1167</fpage>
        <lpage>1169</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4020</pub-id>
        <pub-id pub-id-type="pmid">29131147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steijger</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assessment of transcript reconstruction methods for RNA-seq</article-title>
        <source>Nat. Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1177</fpage>
        <lpage>1184</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2714</pub-id>
        <pub-id pub-id-type="pmid">24185837</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>Y-Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CLIIQ: Accurate comparative detection and quantification of expressed isoforms in a population</article-title>
        <source>Algorithms Bioinform. LNCS</source>
        <year>2012</year>
        <volume>7534</volume>
        <fpage>178</fpage>
        <lpage>189</lpage>
        <pub-id pub-id-type="doi">10.1007/978-3-642-33122-0_14</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tasnim</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Accurate inference of isoforms from multiple sample RNA-Seq data</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>S15</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-16-S2-S15</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Behr</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MITIE: Simultaneous RNA-Seq-based transcript identification and quantification in multiple samples</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2529</fpage>
        <lpage>2538</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt442</pub-id>
        <pub-id pub-id-type="pmid">23980025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frazee</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
        </person-group>
        <article-title>Polyester: simulating RNA-seq datasets with differential transcript expression</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>2778</fpage>
        <lpage>2784</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv272</pub-id>
        <pub-id pub-id-type="pmid">25926345</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>HISAT: a fast spliced aligner with low memory requirements</article-title>
        <source>Nat. Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>357</fpage>
        <lpage>360</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3317</pub-id>
        <pub-id pub-id-type="pmid">25751142</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>29</volume>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id>
        <pub-id pub-id-type="pmid">23104886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Srivastava</surname>
            <given-names>PK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide analysis of differential RNA editing in epilepsy</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>440</fpage>
        <lpage>450</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.210740.116</pub-id>
        <pub-id pub-id-type="pmid">28250018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Consortium</surname>
            <given-names>GT</given-names>
          </name>
        </person-group>
        <article-title>Human genomics. The genotype-tissue expression (GTEx) pilot analysis: multitissue gene regulation in humans</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>348</volume>
        <fpage>648</fpage>
        <lpage>660</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1262110</pub-id>
        <pub-id pub-id-type="pmid">25954001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tomczak</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Czerwinska</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wiznerowicz</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The Cancer Genome Atlas (TCGA): an immeasurable source of knowledge</article-title>
        <source>Contemp. Oncol.</source>
        <year>2015</year>
        <volume>19</volume>
        <fpage>A68</fpage>
        <lpage>A77</lpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harrow</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GENCODE: the reference human genome annotation for The ENCODE Project</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>1760</fpage>
        <lpage>1774</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.135350.111</pub-id>
        <pub-id pub-id-type="pmid">22955987</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Torrey</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Webster</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Knable</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Johnston</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Yolken</surname>
            <given-names>RH</given-names>
          </name>
        </person-group>
        <article-title>The Stanley Foundation brain collection and neuropathology consortium</article-title>
        <source>Schizophr. Res.</source>
        <year>2000</year>
        <volume>44</volume>
        <fpage>151</fpage>
        <lpage>155</lpage>
        <pub-id pub-id-type="doi">10.1016/S0920-9964(99)00192-9</pub-id>
        <pub-id pub-id-type="pmid">10913747</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6825223</article-id>
    <article-id pub-id-type="publisher-id">12990</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-019-12990-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A multi-sample approach increases the accuracy of transcript assembly</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Song</surname>
          <given-names>Li</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sabunciyan</surname>
          <given-names>Sarven</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Guangyu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8124-2324</contrib-id>
        <name>
          <surname>Florea</surname>
          <given-names>Liliana</given-names>
        </name>
        <address>
          <email>florea@jhu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution>McKusick-Nathans Institute of Genetic Medicine, Johns Hopkins School of Medicine, </institution></institution-wrap>Baltimore, MD USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution>Department of Computer Science, </institution><institution>Johns Hopkins University, </institution></institution-wrap>Baltimore, MD USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution>Department of Pediatrics, </institution><institution>Johns Hopkins School of Medicine, </institution></institution-wrap>Baltimore, MD USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution>Department of Medicine, </institution><institution>Johns Hopkins School of Medicine, </institution></institution-wrap>Baltimore, MD USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2106 9910</institution-id><institution-id institution-id-type="GRID">grid.65499.37</institution-id><institution>Present Address: Department of Data Sciences, </institution><institution>Dana Farber Cancer Institute, </institution></institution-wrap>Boston, MA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>5000</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>2</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>10</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Transcript assembly from RNA-seq reads is a critical step in gene expression and subsequent functional analyses. Here we present PsiCLASS, an accurate and efficient transcript assembler based on an approach that simultaneously analyzes multiple RNA-seq samples. PsiCLASS combines mixture statistical models for exonic feature selection across multiple samples with splice graph based dynamic programming algorithms and a weighted voting scheme for transcript selection. PsiCLASS achieves significantly better sensitivity-precision tradeoff, and renders precision up to 2-3 fold higher than the StringTie system and Scallop plus TACO, the two best current approaches. PsiCLASS is efficient and scalable, assembling 667 GEUVADIS samples in 9 h, and has robust accuracy with large numbers of samples.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Transcript assembly is an important step in analysis of RNA-seq data whose accuracy influences downstream quantification, detection and characterization of alternative splice variants. Here, the authors develop PsiCLASS, a transcript assembler leveraging simultaneous analysis of multiple RNA-seq samples.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Genome informatics</kwd>
      <kwd>Software</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation (NSF)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1356078</award-id>
        <award-id>1339134</award-id>
        <principal-award-recipient>
          <name>
            <surname>Florea</surname>
            <given-names>Liliana</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100006955</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | NIH | Office of Extramural Research, National Institutes of Health (OER)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM124531</award-id>
        <principal-award-recipient>
          <name>
            <surname>Florea</surname>
            <given-names>Liliana</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100007123</institution-id>
            <institution>Stanley Medical Research Institute (SMRI)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>n/a</award-id>
        <principal-award-recipient>
          <name>
            <surname>Sabunciyan</surname>
            <given-names>Sarven</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">RNA sequencing (RNA-seq) has become the de facto standard in surveying the transcriptome of a cell, organism, or species, to determine the expressed genes and transcripts and their expression levels, and to enable differential and functional analyses<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup>. A crucial step in virtually all RNA-seq data analyses is assembling the reads into full-length transcripts. The accuracy of transcript reconstruction is critical for quantification, detection, and characterization of alternative splice variants, and the identification of differences in gene expression and splicing patterns between tissues, developmental stages, and physiological or disease states.</p>
    <p id="Par4">Virtually all transcriptomic studies involve multiple samples. The current paradigm is to assemble the reads in each sample, then merge the partial transcripts (transfrags) across all samples to create a unified set of meta-annotations<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, which is used as reference for downstream quantification and differential analyses. Most single-sample assemblers including Cufflinks, isoCEM, Scripture, Traph, CLASS, iReckon, CIDANE, FlipFlop, CLASS2, StringTie, Scallop, and TransComb<sup><xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR15">15</xref></sup> build a graph structure from read alignments on the genome, then traverse the graph to select an optimized set of transcripts, represented as paths. Recent second-generation transcript assembly methods including StringTie, CLASS2, and Scallop have taken great strides toward increasing the accuracy and efficiency of assembly at single-sample level, and meta-assemblers such as StringTie(ST)-merge and TACO<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> have led to more robust collections of meta-annotations. Despite these efforts precision remains low, with &lt;40% of the predicted transcripts in a single-sample and &lt;30% of transcripts in meta-annotations representing complete and accurate reconstructions<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR16">16</xref></sup>. Concomitantly, a handful of efforts have focused on designing methods that simultaneously assemble transcripts across multiple RNA-seq samples, notably CLIIQ, ISP, MiTie, and FlipFlop<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR19">19</xref></sup>. However, none of these programs has comparable performance or is equipped to handle more than a limited number of samples. (See <xref rid="MOESM1" ref-type="media">Supplementary Methods</xref> for a more in-depth review of related work.)</p>
    <p id="Par5">We present PsiCLASS, based on an approach that simultaneously analyzes multiple RNA-seq samples, which achieves significantly higher precision at sensitivity comparable to the best current approaches, and significantly higher overall accuracy in its default setting. PsiCLASS differs from traditional assemblers in two ways. First, it is a combined assembler, reporting a set of transcripts for each sample, and meta-assembler<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, producing a set of meta-annotations obtained by combining the individual samples’ outputs. Second, unlike traditional single-sample assemblers, it uses information from all samples to produce transcripts for individual samples and for the unified annotation set. PsiCLASS starts by selecting a set of high-confidence introns and subexons at each locus, using statistical models of introns and intronic read levels. In doing so, it first generates a set of features (subexons, introns) for each sample, and then corroborates information across all samples to select a high-confidence subset. Next, PsiCLASS builds a unified subexon splice graph that is used within a dynamic programming optimization procedure to select a representative set of transcripts in each sample (see “Methods” and Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref> for details). Lastly, PsiCLASS extracts a subset of meta-annotations from the aggregated transcript sets by voting. Salient features of PsiCLASS include: (i) an algorithm that assembles reads from multiple samples simultaneously, taking advantage of their redundancy and complementarity; (ii) significantly higher precision at meta-assembly level, up to 2–3 fold, over StringTie with ST-merge and Scallop with TACO, and high precision (&gt;50%) overall; (iii) 22–140% increase in precision at meta-assembly level over StringTie with ST-merge, and 35–89% over Scallop with TACO, when matched to their sensitivity levels; (iv) higher overall performance in combined sensitivity and precision at the individual sample level; (v) improved consistency among the individual samples’ annotations and meta-annotations, and robustness with different meta-assemblers; and (vi) high efficiency and scalability, taking only 9 h to assemble 667 GEUVADIS samples, and robust accuracy as the number of samples increases. Overall, PsiCLASS is highly efficient and overcomes limitations in the existing methods, showing significantly higher accuracy, in particular precision, on data sets with a handful to hundreds of samples, thus providing an efficient method for RNA-seq data analysis.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Performance evaluation on simulated data</title>
      <p id="Par6">We compared PsiCLASS with the best current approaches, namely StringTie and Scallop at the individual sample level, and the combinations of StringTie with ST-merge and Scallop with TACO, at the meta-assembly level. We also included FlipFlop, which was the only other competitive multi-assembler; because of excessive run times, however, FlipFlop was not feasible for our tests on real data sets. (Other combinations are shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>). We first applied the methods to 25 RNA-seq samples simulated with Polyester<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, where reads were aligned with two methods, Hisat2<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> and STAR<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. Performance was slightly better for all programs when reads were aligned with Hisat2 (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>), therefore we chose this alignment method for the rest of the analyses.</p>
      <p id="Par7">On the simulated data, PsiCLASS with default voting achieved 71.4% precision, which is 15.0% higher than the StringTie system, and 28.3% and 21.6% higher than Scallop and FlipFlop, respectively, combined with TACO, whereas sensitivity for all programs was roughly 50% (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). Even at the individual sample level, PsiCLASS had both the highest precision and the highest sensitivity: 73.8% precision on average, compared with 70.8% for StringTie, 62.9% for Scallop, and 50.7% for FlipFlop, and 53.4% sensitivity compared with 41.7% for StringTie, 46.2% for Scallop, and 36.1% for FlipFlop. Precision values for StringTie, Scallop, and FlipFlop, but to a lesser extent for PsiCLASS, dropped significantly after aggregation, hence PsiCLASS produces more consistent sets of transcripts between individual samples and the set of meta-annotations.<fig id="Fig1"><label>Fig. 1</label><caption><p>Performance evaluation of methods on simulated and real data: <bold>a</bold> 25 simulated RNA-seq sets, all genes; <bold>b</bold> 25 simulated sets, genes grouped by abundance; <bold>c</bold> 25 GEUVADIS samples (polyadenylated RNA); <bold>d</bold> 73 liver RNA-seq samples (rRNA-depleted total RNA); <bold>e</bold> 44 hippocampus samples from healthy and epileptic mice; and <bold>f</bold> subsets of 1, 2, 3, 5, 10, 20, 40, 80, 160, and 320, and the full set of 667 GEUVADIS samples. In <bold>a</bold>, <bold>b</bold>–<bold>e</bold>, sensitivity (recall) and precision values for PsiCLASS, StringTie, and Scallop at the level of individual samples are shown in boxed plots, and meta-annotations resulted from aggregation (with PsiCLASS voting, ST-merge, and TACO) are shown with colored shapes. Boxplots were generated with R using default options, namely, the box extends between the lower and upper quartiles, horizontal lines mark the median, and whiskers are at the 1.5 × interquantile point above the upper quartile and bellow the lower quartile. Lastly, additional symbols mark sensitivity and precision values for PsiCLASS when tuned to match or approach the sensitivity of its competitors, along the range of cutoff values 0–16, shown with dotted red lines. Source data are provided as a Source Data file</p></caption><graphic xlink:href="41467_2019_12990_Fig1_HTML" id="d29e401"/></fig></p>
      <p id="Par8">We further investigated the performance of methods based on the transcripts’ expression levels (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>). Simulated transcripts were divided into low (463 transcripts; Fragments Per Kilobase (FPK) &lt; 30), medium (658 transcripts; 30 ≤ FPK &lt; 500) and high (322 transcripts; FPK ≥ 500) according to the predefined expression levels. PsiCLASS with voting reconstructs the largest fraction of high-expressed transcripts, 82.4%, and all three programs recover ~60% of the medium-expressed ones. FlipFlop has by far the highest sensitivity in detecting low expression features, 41.0%, compared with 10–20% for the other programs. Note that, because a reconstructed transcript’s expression level may fall in another class than the predefined one, precision cannot be rigorously evaluated.</p>
      <p id="Par9">Similarly, to assess the programs’ performance based on the gene’s splicing complexity, we divided genes into three categories by the number of their alternatively spliced transcripts: low (1 transcript per gene; 680 genes, 680 transcripts), medium (2 transcripts per gene; 166 genes, 332 transcripts), and high (3 or more transcripts per gene; 106 genes, 431 transcripts). While, StringTie showed the best overall performance on the single-transcript genes, PsiCLASS had the highest sensitivity and precision on the medium and high complexity classes, in particular a 16.8–24.5% gain in sensitivity and 21.0–31.8% in precision on highly expressed transcripts (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>).</p>
    </sec>
    <sec id="Sec4">
      <title>Performance evaluation on real RNA-seq data collections</title>
      <p id="Par10">We next assessed the performance on two representative RNA-seq data sets, generated with two different library preparation protocols: 25 randomly selected sets from polyA-selected lymphoblastoid samples from the GEUVADIS population variation project, and 73 rRNA-depleted total RNA libraries from postmortem human liver samples with funding from the Stanley Medical Research Institute. At the meta-assembly level, PsiCLASS’s precision for the GEUVADIS set is 69.3% and 89.2% higher than StringTie’s and Scallop plus TACO’s, respectively, whereas sensitivity is higher or comparable, by 4.5% and −0.9%, respectively (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). Similarly, advantages of the multi-sample approach are seen for the liver total RNA data set, with more than twofold and threefold increases in precision, albeit at 18.6% and 35.3% lower sensitivity. Even when matched to the other programs’ sensitivity settings, PsiCLASS maintains 140% and 89% gains in precision over the StringTie system and Scallop plus TACO, respectively, albeit for this data set Scallop with TACO retains superior sensitivity over the entire parameter range (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>). In such cases, the default voting setting may not present the best tradeoff, and as PsiCLASS’s precision remains significantly higher than that of its counterparts the user may choose a different cutoff. Even at the individual sample level, PsiCLASS’s performance exceeds that of its competitors’, with higher or comparable per sample average measurements in both components (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>, <xref rid="Fig1" ref-type="fig">d</xref>, boxplots).</p>
    </sec>
    <sec id="Sec5">
      <title>Performance evaluation on heterogeneous data collections</title>
      <p id="Par11">Most RNA-seq analyses are aimed at determining gene expression or splicing differences between two biological conditions. To explore the robustness of PsiCLASS when combining two-condition samples, we applied it and the other methods to RNA-seq samples from hippocampi of normal mice (24 samples) and mice with induced epileptic seizures (20 samples) (ref.<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> and Source Data). The diagrams in Fig. <xref rid="Fig1" ref-type="fig">1e</xref> indicate that at the level of individual samples PsiCLASS has higher sensitivity than both StringTie and Scallop, by 26.2% and 8.4% on average, whereas precision exceeds Scallop’s by 42.3% and is comparable to StringTie’s at 66%. Moreover, after voting PsiCLASS’s precision at the level of meta-annotations is 45.7% and 55.0% higher than the other programs’, respectively, along with an increase in sensitivity (15.1% and 7.8%), therefore recommending it as the overall best performer. Thus, PsiCLASS can be effectively and more reliably used on the aggregate set of samples in a two-condition comparison.</p>
      <p id="Par12">We further explored the applicability of PsiCLASS to more divergent and heterogeneous collections of data. We applied PsiCLASS to single- and multi-tissue collections extracted from the GTEx<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> repository (ten RNA-seq samples for each of six tissues: cortex, frontal cortex, cerebellum, heart, liver, and lung). We then aggregated the results in each collection in three ways, using PsiCLASS voting, TACO, and TACO applied to the samples assembled separately by tissue. In all cases, PsiCLASS with its default voting algorithm had better performance, with both higher sensitivity, and higher precision (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>). Notably, our approach resulted in significantly more accurate transcript sets for all collections, with 11.2–16.8% increase in precision over TACO, and a significant 21.4–47.1% increase over TACO applied to the per tissue assembled collections. As the heterogeneity in the data increases, gains in sensitivity reach diminishing returns, while the increase in precision becomes more pronounced. These simple experiments show promise for extending PsiCLASS’s capabilities to more heterogeneous data sets.</p>
    </sec>
    <sec id="Sec6">
      <title>Deconvoluting the effects of algorithmic components</title>
      <p id="Par13">While the different components of the PsiCLASS algorithm are intercalibrated to work in harmony with each other, to guide future program development we attempted to deconvolute the effects on performance of the individual algorithmic components. In a first test, we comprehensively evaluated all combinations of individual sample (PsiCLASS, StringTie, and Scallop) and meta-assemblers (voting, ST-merge, and TACO) at multiple levels. Notably, voting significantly increased transcript level precision for all programs, albeit PsiCLASS maintained a clear advantage in all but one case (GEUVADIS-25), where Scallop’s performance was comparable (Supplementary Figs. <xref rid="MOESM1" ref-type="media">6</xref> and <xref rid="MOESM1" ref-type="media">7</xref>). Conversely, unlike the other two programs, PsiCLASS rendered comparable results when its sample-level transcript sets were merged with the voting, ST-merge and TACO aggregation methods, demonstrating the robustness of its reconstructions (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref>). As conventional measurements based on the number of fully reconstructed transcripts only partially describe the accuracy of a data set, we also assessed the accuracy at the feature (exon, intron) and gene level. Indeed, even when the best meta-assembly method (voting) is used for all programs, PsiCLASS captures significantly more gene and transcript content, with 10–40% more introns and 10–50% more internal exons than StringTie and Scallop, at comparable 95–98% precision (Supplementary Fig. <xref rid="MOESM1" ref-type="media">8</xref>). Further, PsiCLASS reported significantly more genes that had at least one fully reconstructed transcript, 7.0–24.7% more than StringTie and 2.9–31.3% more than Scallop. Lastly but notably, PsiCLASS also detected many more genes: 3.9–9.6% more than StringTie and up to a very significant 46.3% more than Scallop, with the largest of these gains observed for the liver data (Supplementary Figs. <xref rid="MOESM1" ref-type="media">9</xref> and <xref rid="MOESM1" ref-type="media">10</xref>). These improvements are the direct consequence of the completeness of PsiCLASS gene structure model as captured in the shared subexon graph, an algorithmic feature that particularly favors low expression genes.</p>
    </sec>
    <sec id="Sec7">
      <title>Performance evaluation with small numbers of samples</title>
      <p id="Par14">We next investigated the utility of the multi-sample approach for small data collections, including single samples. Table <xref rid="Tab1" ref-type="table">1</xref> shows the results for all methods on sets of 2, 3, 5, and 10 samples from our simulated set, averaged over five independent trials, and for single-sample sets, averaged over all possible 25 trials. The multi-sample approach shows benefits in all cases, most notably increased sensitivity (range 47–53% for PsiCLASS, compared with 42–48% for StringTie, and 43–48% for Scallop with TACO) at comparable or higher precision (range 67–70% for PsiCLASS, compared with 64–71% for StringTie and 57–62% for Scallop).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Performance of methods on experiments with small numbers of samples on simulated data</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Number of samples</th><th>Recall PsiCLASS</th><th>Recall StringTie</th><th>Recall Scallop</th><th>Precision PsiCLASS</th><th>Precision StringTie</th><th>Precision Scallop</th></tr></thead><tbody><tr><td>1</td><td>45.6</td><td>41.7</td><td>46.2</td><td>66.9</td><td>70.8</td><td>62.9</td></tr><tr><td>2</td><td>46.7</td><td>43.8</td><td>43.3</td><td>68.6</td><td>69.1</td><td>57.0</td></tr><tr><td>3</td><td>49.9</td><td>45.2</td><td>45.0</td><td>67.3</td><td>68.5</td><td>56.7</td></tr><tr><td>5</td><td>52.1</td><td>46.6</td><td>46.2</td><td>69.7</td><td>66.7</td><td>56.7</td></tr><tr><td>10</td><td>52.7</td><td>48.0</td><td>48.1</td><td>70.0</td><td>64.0</td><td>56.5</td></tr></tbody></table></table-wrap></p>
      <p id="Par15">PsiCLASS is designed to take advantage of cross-sample gene information in a multi-sample experiment. Nevertheless, we also evaluated it and the other programs on isolated single-samples from three previously reported real data sets (Table <xref rid="Tab2" ref-type="table">2</xref>). PolyA-selected RNA-seq paired-end reads from CD20+ (SRR534319, 25 million reads), CD14+ (SRR545695, 39 million reads), and IMR90 (SRR534291, 114 million reads) cell lines were previously used to demonstrate performance improvements in both the StringTie and Scallop publications. When PsiCLASS used solely information from that sample, performance across the three samples was similar between StringTie and PsiCLASS, whereas Scallop had significantly higher sensitivity albeit at slightly lower precision. However, since each data set was part of a multi-sample experiment (SRR534291-SRR534292, SRR545695-SRR545700, and SRR534319-SRR534324), we sought to assess the advantage of the cross-sample information. Even with the small (2–6) number of replicates, when all samples in an experiment were considered PsiCLASS’s performance for the three samples improved (up to 28.3% sensitivity increase over PsiCLASS single-sample, and up to 35.0% over StringTie), especially for the low coverage sample (SRR534319).<table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance of methods on experiments with small numbers of samples on real data</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Sample</th><th>Recall PsiCLASS<sup>a</sup></th><th>Recall PsiCLASS<sup>b</sup></th><th>Recall StringTie</th><th>Recall Scallop</th><th>Precision PsiCLASS<sup>a</sup></th><th>Precision PsiCLASS<sup>b</sup></th><th>Precision StringTie</th><th>Precision Scallop</th></tr></thead><tbody><tr><td>SRR534319</td><td>44.2</td><td>56.7</td><td>42.0</td><td>65.7</td><td>29.5</td><td>30.1</td><td>30.5</td><td>24.5</td></tr><tr><td>SRR545695</td><td>50.4</td><td>60.3</td><td>49.4</td><td>72.7</td><td>32.5</td><td>32.4</td><td>35.7</td><td>26.6</td></tr><tr><td>SRR534291</td><td>63.3</td><td>66.1</td><td>65.5</td><td>81.6</td><td>30.8</td><td>35.0</td><td>37.1</td><td>35.1</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Single samples in one-sample experiments</p><p><sup>b</sup>Individual samples in multi-sample experiments</p></table-wrap-foot></table-wrap></p>
      <p id="Par16">Overall, PsiCLASS showed competitive or higher performance on experiments with a small (2–10) number of samples, with benefits most evident for data sets of three or more samples. It also ranked comparable with StringTie and Scallop on single-sample data sets in our control experiments, and similarly to StringTie on the three samples for which the two reference programs were optimized. Therefore, our program can be effectively used for small RNA-seq collections and within the conventional assemble-and-merge approach.</p>
    </sec>
    <sec id="Sec8">
      <title>Performance evaluation on very large data collections</title>
      <p id="Par17">As the emerging landscape of RNA-seq foresees increasingly larger data sets from large patient cohorts and population variation studies, we aimed to assess the suitability of the multi-sample approach as the data set grows. We evaluated program performance on increasingly larger subsets of RNA-seq samples from the GEUVADIS population variation project, up to the full set of 667 samples (Fig. <xref rid="Fig1" ref-type="fig">1f</xref>). All methods show improvements in sensitivity as the number of samples increases, but while PsiCLASS and Scallop show further slight gains after 20–50 samples, the sensitivity of StringTie drops. Precision drops markedly for both Scallop and StringTie, to less than 35% for 50 samples and below 20% for the full set of samples. In sharp contrast, PsiCLASS’s sensitivity and precision remain almost constant with more than ten samples, demonstrating the robustness of this approach. Also, with sensitivity 9–40% higher than StringTie’s and precision (&gt;50%) twice as high as that of the other two systems when the data set exceeds 20–50 samples, PsiCLASS is unequivocally the best suited for handling large RNA-seq collections. Lastly, PsiCLASS took only 9 h with 24 threads to process the 667 samples at a peak memory of 14 GB RAM on an 3.0 GHz Intel “Ivy Bridge” Xeon server, amounting to &lt;1 min per sample. By comparison, StringTie took 34 h to process the samples sequentially, with 24 threads, at a peak memory of 524 MB, and Scallop, which is single-threaded, required 75 h with a peak memory of 5 GB.</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par18">Determining the set of expressed genes and transcripts in an RNA-seq experiment is critical for subsequent quantification and differential expression and splicing analyses. The conventional approach to process each sample separately and then merge the sets of transcripts to create a unified set of annotations has limitations, in particular low precision. We present PsiCLASS, a transcript assembler and meta-assembler that simultaneously analyzes all samples in an RNA-seq experiment. Algorithmic underpinnings of PsiCLASS include a global subexon graph, statistical methods for cross-sample feature selection, and dynamic programming optimization and voting algorithms for transcript selection at the level of individual samples and over the entire collection of data, which collectively lead to more complete, more accurate, and more consistent sets of annotations. In particular, our study suggests that voting-based approaches may have advantages over the current assembly-based aggregation methods in some cases, albeit their broader applicability needs to be further investigated.</p>
    <p id="Par19">PsiCLASS is designed to leverage the gene information across samples in a one or two condition experiments, to improve the accuracy of gene and transcript reconstruction for downstream differential gene expression and differential splicing studies, and may not be ideally suited to multi-condition experiments, such as annotation of genes and alternative splicing in large data sets such as GTEx<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> or TCGA<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. Nevertheless, our limited tests on collections of samples from 2 to 6 GTEx tissues reflect that PsiCLASS has better performance than TACO, and therefore show promise for exploring capabilities for handling more heterogeneous data sets in the future.</p>
    <p id="Par20">PsiCLASS had significantly higher precision at similar sensitivity when compared with current best methods, and showed consistently high precision (&gt;50%) when tested on data from a variety of experimental conditions. PsiCLASS is scalable, efficient, and robust with large numbers of RNA-seq samples, thus providing a highly effective paradigm for large-scale analyses of collections of hundreds and thousands of samples. PsiCLASS is available free of charge from <ext-link ext-link-type="uri" xlink:href="https://github.com/splicebox/PsiCLASS">https://github.com/splicebox/PsiCLASS</ext-link>.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Algorithm overview</title>
      <p id="Par21">PsiCLASS builds a global subexon graph of a gene and its splice variants from genome-aligned RNA-seq reads in all input samples. It then traverses the graph to select a subset of the encoded transcripts in each sample. Lastly, it combines the predicted transcript sets across all samples, using a voting procedure to select a final set of meta-annotations.</p>
      <p id="Par22"><italic>Building per sample subexon graphs</italic>. PsiCLASS builds a subexon graph for each sample, then combines graphs across all samples to create a global subexon graph. In each sample, PsiCLASS uses candidate introns extracted from spliced read alignments to divide the genome into regions and subexons. A region denotes a maximal contiguous portion of the genome covered by reads. A subexon is a portion of a region delimited by two consecutive splice junctions and/or the end(s) of the region. A subexon graph has subexons as vertices, and two subexons are connected by an edge if they are adjacent in the same region or connected by an intron. Candidate splice variants are encoded as maximal paths in the subexon graph.</p>
      <p id="Par23">To build the sample-level subexon graph, PsiCLASS clusters read alignments along the genome that are colocated and on the same strand. Introns are extracted from spliced alignments and used to divide the region into subexons. A major confounding factor in determining subexons from RNA-seq data is the presence of intronic unprocessed RNA (‘noise’). To differentiate between intronic noise and signal, such as retained introns or alternative 5′ and 3′ gene ends, PsiCLASS assigns each subexon a score that reflects the probability that it is noise. In contrast to current single-sample methods, which simply discard a subexon if it fails sample-wide cutoffs, PsiCLASS then combines sample-level scores across all samples to determine a final label for the subexon and its inclusion in the global subexon graph.</p>
      <p id="Par24">More specifically, PsiCLASS computes the probability that a subexon is due to intronic noise using two models: (i) the exon–intron coverage ratio, and (ii) the intronic read coverage. Let <italic>c</italic><sub><italic>i</italic></sub> be the average read coverage of (intronic) subexon <italic>i</italic>. In the coverage ratio model, PsiCLASS calculates a score that is equal to the coverage ratio of this subexon versus its flanking subexons: <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i = {\mathrm{min}}\left( {\frac{{c_i}}{{c_{i - 1}}},\frac{{c_i}}{{c_{i + 1}}}} \right)$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">min</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq1.gif"/></alternatives></inline-formula>. The score is fitted to a mixture of two Gamma distributions, one representing signal and one noise: <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left( {r_i} \right) = \pi \Gamma _{\theta _0,k_0}\left( {r_i} \right) + \left( {1 - \pi } \right)\Gamma _{\theta _1,k_1}\left( {r_i} \right)$$\end{document}</tex-math><mml:math id="M4"><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq2.gif"/></alternatives></inline-formula>, where <italic>π</italic>, (1 − <italic>π</italic>) are the prior probabilities that an intronic subexon is noise or signal, respectively, and <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _0,k_0,\theta _1,k_1$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq3.gif"/></alternatives></inline-formula> are the parameters for the Gamma distributions, calculated with an expectation maximization algorithm. With these parameters, PsiCLASS can infer the probability that subexon <italic>i</italic> is noise according to the Bayes formula: <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_R\left( {r_i} \right) = \frac{{\pi \Gamma _{\theta _0,k_0}\left( {r_i} \right)}}{{\pi {\mathrm{\Gamma }}_{\theta _0,k_0}\left( {r_i} \right) + \left( {1 {\,}-{\,} \pi } \right)\Gamma _{\theta _1,k_1}\left( {r_i} \right)}}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>π</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.25em"/><mml:mo>−</mml:mo><mml:mspace width="0.25em"/><mml:mi>π</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq4.gif"/></alternatives></inline-formula>.</p>
      <p id="Par25">The coverage ratio model above is insufficient when the overall gene coverage is low. Hence, the second model establishes a similar formula for coverage levels, <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_C\left( {c_i} \right)$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq5.gif"/></alternatives></inline-formula>, with <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta^\prime_0,k^\prime _0,\theta ^\prime _1,k^\prime _1$$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq6.gif"/></alternatives></inline-formula> the parameters inferred using coverage. The final per sample subexon score then is <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( i \right) = {\mathrm{max}}(P_R\left( {r_i} \right),\;P_C(c_i))$$\end{document}</tex-math><mml:math id="M14"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.16em"/><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq7.gif"/></alternatives></inline-formula>.</p>
      <p id="Par26"><italic>Building the global subexon graph</italic>. PsiCLASS removes likely artifactual introns and intronic noise subexons by evaluating evidence across all sample, and builds a global subexon graph by combining individual samples’ graphs that share at least one intron. <italic>Multi-sample intron selection</italic>: To select a highly accurate set of introns, PsiCLASS assesses each candidate intron’s read support across all samples. Assume the experiment contains <italic>M</italic> samples, and denote each intron by its coordinates in the genome, e.g., (<italic>a, b</italic>). Let <italic>S</italic> (<italic>a, b</italic>) denote the total number of read alignments supporting (<italic>a, b</italic>) over all samples. Then the total number of alignments supporting its splice sites: <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S\left( a \right) = \mathop {\sum }\nolimits_{(a,y)} S\left( {a,y} \right),\;S\left( b \right) = \mathop {\sum }\nolimits_{\left( {x,b} \right)} S(x,b)$$\end{document}</tex-math><mml:math id="M16"><mml:mi>S</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mi>S</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.16em"/><mml:mi>S</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq8.gif"/></alternatives></inline-formula>. PsiCLASS keeps intron (<italic>a, b</italic>) iff: (i) <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{S\left( {a,b} \right)}}{M} \ge 0.5$$\end{document}</tex-math><mml:math id="M18"><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfrac><mml:mo>≥</mml:mo><mml:mn>0.5</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq9.gif"/></alternatives></inline-formula>, indicating strong read support in one or a few samples, or consistent read support across multiple samples; and (ii) (<italic>a, b</italic>) appears in at least <italic>M</italic>0 samples, where <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M0 = \min \left( \lceil{\frac{M}{{50}}\rceil\left( \lfloor{\frac{{b - a + 1}}{{100,000}}\rfloor + 1} \right),\;M} \right)$$\end{document}</tex-math><mml:math id="M20"><mml:mi>M</mml:mi><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:mi>min</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mrow><mml:mo>⌈</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>⌉</mml:mo></mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mrow><mml:mo>⌊</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.16em"/><mml:mi>M</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq10.gif"/></alternatives></inline-formula>, if |<italic>b</italic> <italic>−</italic> <italic>a</italic>| ≥ 100,000 (long intron). Condition (ii) is intended to filter out long intron-type alignment artifacts due to gene families and repeats, or from sequencing errors, which can lead to merged genes and transcripts. <italic>Multi-sample subexon selection:</italic> To determine a global set of subexons, PsiCLASS combines the subexon sets of individual samples with some modifications. Where multiple 3′ or 5′-end (i.e., subexons not delimited by a splice site) candidate subexons occur with the same endpoint and potentially different lengths among the samples, PsiCLASS creates a unique subexon with the median length. Further, to determine intronic subexons, PsiCLASS calculates a final score by combining all sample scores with a Bayesian formula. More specifically, let <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar \pi$$\end{document}</tex-math><mml:math id="M22"><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq11.gif"/></alternatives></inline-formula> denote the prior probability of intronic noise in the global model, calculated as the average of the mixture coefficients of the samples. Then the subexon score: <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_n\left( {{\mathrm{noise}}|{\mathrm{data}}} \right) = \frac{{\bar \pi {P({\mathrm{data}}|{\mathrm{noise}}})}}{{\bar \pi P\left( {{\mathrm{data}}|{\mathrm{noise}}} \right) + \left( {1 - \bar \pi } \right)P\left( {{\mathrm{data|real}}} \right)}}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">noise</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="normal">data</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">data</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="normal">noise</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">data</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="normal">noise</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">data∣real</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq12.gif"/></alternatives></inline-formula> reflects the probability that the subexon is noise, where data is the observed information such as the coverage in each sample. We assume the samples are independent, hence <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{P}}\left( {{\mathrm{data}}|{\mathrm{noise}}} \right) = \mathop {\prod }\nolimits_{s = 1}^M G_0^{\left( s \right)}\left( i \right)$$\end{document}</tex-math><mml:math id="M26"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">data</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="normal">noise</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo> ∏</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq13.gif"/></alternatives></inline-formula>, where <italic>s</italic> = 1<italic>,…, M</italic> denotes the sample. Here, <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_0^{\left( s \right)}\left( i \right)$$\end{document}</tex-math><mml:math id="M28"><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq14.gif"/></alternatives></inline-formula> is <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma _{\theta _0^{\left( s \right)},\:k_0^{\left( s \right)}}(r_i^{(s)})$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="2.22144pt"/><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq15.gif"/></alternatives></inline-formula> if the ratio model is used for subexon <italic>i</italic> in sample <italic>s</italic>, and <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma _{\theta \prime _0^{\left( s \right)},\;k\prime _0^{\left( s \right)}}( {c_i^{(s)}} )$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.16em"/><mml:msubsup><mml:mrow><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq16.gif"/></alternatives></inline-formula> if the <italic>coverage model</italic> is employed. Similarly, <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( {{\mathrm{data}}|{\mathrm{real}}} \right) = \mathop {\prod }\nolimits_{s = 1}^M G_1^{\left( s \right)}\left( i \right)$$\end{document}</tex-math><mml:math id="M34"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">data</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="normal">real</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo> ∏</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq17.gif"/></alternatives></inline-formula>. In the end, the subexon is retained if it passes a predefined threshold.</p>
      <p id="Par27"><italic>Transcript selection</italic>. Candidate transcript models are represented as maximal paths in the global subexon graph, from a node with no incoming edges (source) to a node with no outgoing edges (sink). Since the graph generally encodes a much larger number of transcripts than is biologically possible, PsiCLASS identifies and selects a subset of transcripts that can explain all contiguity constraints from spliced reads and paired reads. PsiCLASS first predicts a set of transcripts for each sample, using a graph-based dynamic programming algorithm with the global subexon graph and the sample specific alignment data, then combines the individual samples’ transcript sets and selects a subset of meta-annotations by voting.</p>
      <p id="Par28">To predict a set of transcripts for each sample, PsiCLASS employs a SET_COVER framework and dynamic programming algorithms<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, adapted for subexon graphs. Namely, we define a constraint as a cluster of read alignments with the same subexon pattern. Like CLASS2, PsiCLASS uses constraints to decrease the memory usage while preserving the structural and contiguity information contained in the full set of reads. For a given graph <italic>G</italic>, let <italic>C</italic> = {<italic>c</italic><sub>1</sub><italic>, …, c</italic><sub><italic>m</italic></sub>} denote the set of constraints and <italic>T</italic> = {<italic>t</italic><sub>1</sub><italic>, …, t</italic><sub><italic>n</italic></sub>} the set of candidate transcripts, encoded in the graph. Given a constraint <italic>c</italic><sub><italic>i</italic></sub>, its abundance <italic>a</italic><sub><italic>i</italic></sub> = <italic>a</italic>(<italic>c</italic><sub><italic>i</italic></sub>) defined as the number of supporting reads (or read pairs) normalized by the number of possible start positions of the reads within the constraint’s subexons. To reduce the transcript selection problem to SET_COVER, we view each candidate transcript <italic>t</italic><sub><italic>j</italic></sub> as the set of constraints that are compatible with its exon-intron structure: <italic>C</italic>(<italic>t</italic><sub><italic>j</italic></sub>) = {<italic>c</italic><sub><italic>1</italic></sub><italic>, …,c</italic><sub><italic>nj</italic></sub>}, where <italic>c</italic><sub><italic>i</italic></sub><italic> ~ t</italic><sub><italic>j</italic></sub>. Constraint <italic>c</italic><sub><italic>i</italic></sub> is compatible with the transcript <italic>t</italic><sub><italic>j</italic></sub>’s exon-intron structure, denoted <italic>c</italic><sub><italic>i</italic></sub> ~ <italic>t</italic><sub><italic>j</italic></sub>, if its list of subexon intervals is contained in that of the transcript’s and all the exon–exon junctions correspond to introns in the transcript.</p>
      <p id="Par29">In the simplest formulation, the goal then is to select a minimal (parsimonious) subset of transcripts that satisfies all constraints. More realistically, to account for the different abundance of constraints, we define a transcript’s abundance as the minimum abundance among its set of constraints: <italic>A</italic><sub><italic>j</italic></sub> = <italic>min</italic> { <italic>a</italic><sub><italic>i</italic></sub><italic>| c</italic><sub><italic>i</italic></sub><italic> ~ t</italic><sub><italic>j</italic></sub> }. The goal then becomes to determine a subset of transcripts that most closely explain the constraints and their abundance levels. PsiCLASS uses a greedy approximation framework to address this problem, iteratively selecting the transcript that covers the largest number of constraints weighted by the constraints’ abundance, then adjusting the constraints’ abundance levels before the next iteration:</p>
      <p id="Par30">While ({nondepleted constraints} <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ne \, \emptyset$$\end{document}</tex-math><mml:math id="M36"><mml:mo>≠</mml:mo><mml:mspace width="0.25em"/><mml:mi>∅</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq18.gif"/></alternatives></inline-formula>):</p>
      <p id="Par31">Choose transcript <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \in T$$\end{document}</tex-math><mml:math id="M38"><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq19.gif"/></alternatives></inline-formula> that maximizes <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|C\left( t \right)|\left( {1 + \frac{{A_t}}{A}} \right)$$\end{document}</tex-math><mml:math id="M40"><mml:mo>∣</mml:mo><mml:mi>C</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>∣</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq20.gif"/></alternatives></inline-formula></p>
      <p id="Par32">Update the constraints’ abundance:</p>
      <p>
        <disp-formula id="Equa">
          <alternatives>
            <tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x = \mathop {{{\mathrm{min}}}}\limits_{c \in C(t)} \{ a\left( c \right)\}$$\end{document}</tex-math>
            <mml:math id="M42">
              <mml:mi>x</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:munder>
                <mml:mrow>
                  <mml:mi mathvariant="normal">min</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                  <mml:mo>∈</mml:mo>
                  <mml:mi>C</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:munder>
              <mml:mrow>
                <mml:mo>{</mml:mo>
                <mml:mrow>
                  <mml:mi>a</mml:mi>
                  <mml:mfenced close=")" open="(" separators="">
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                  </mml:mfenced>
                </mml:mrow>
                <mml:mo>}</mml:mo>
              </mml:mrow>
            </mml:math>
            <graphic xlink:href="41467_2019_12990_Article_Equa.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
        <disp-formula id="Equb">
          <alternatives>
            <tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{For}}\;{\mathrm{each}}\;c \in C\left( t \right)\!\! :$$\end{document}</tex-math>
            <mml:math id="M44">
              <mml:mi mathvariant="normal">For</mml:mi>
              <mml:mspace width="0.16em"/>
              <mml:mi mathvariant="normal">each</mml:mi>
              <mml:mspace width="0.16em"/>
              <mml:mi>c</mml:mi>
              <mml:mo>∈</mml:mo>
              <mml:mi>C</mml:mi>
              <mml:mfenced close=")" open="(" separators="">
                <mml:mrow>
                  <mml:mi>t</mml:mi>
                </mml:mrow>
              </mml:mfenced>
              <mml:mspace width="0.3em"/>
              <mml:mspace width="0.3em"/>
              <mml:mo>:</mml:mo>
            </mml:math>
            <graphic xlink:href="41467_2019_12990_Article_Equb.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
        <disp-formula id="Equc">
          <alternatives>
            <tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a\left( c \right) = a\left( c \right) - x$$\end{document}</tex-math>
            <mml:math id="M46">
              <mml:mi>a</mml:mi>
              <mml:mfenced close=")" open="(" separators="">
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:mi>a</mml:mi>
              <mml:mfenced close=")" open="(" separators="">
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>−</mml:mo>
              <mml:mi>x</mml:mi>
            </mml:math>
            <graphic xlink:href="41467_2019_12990_Article_Equc.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>if <inline-formula id="IEq21"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a\left( c \right) \le 0$$\end{document}</tex-math><mml:math id="M48"><mml:mi>a</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq21.gif"/></alternatives></inline-formula>, mark constraint <italic>c</italic> as depleted.</p>
      <p id="Par33">PsiCLASS implements the procedure above in two steps. First, it determines the candidate set of transcripts <italic>T</italic>, using either enumeration (for graphs with &lt;200,000 transcripts) or a variation of the splice-graph dynamic programming algorithm in Song et al.<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> that considers all reads single-end, for fast processing. Once the candidate transcript set <italic>T</italic> is determined, PsiCLASS applies the greedy SET_COVER approximation algorithm above.</p>
      <p id="Par34">For completeness, we include a brief description of the dynamic programming optimization procedure. The algorithm considers all subpaths <italic>L</italic>, and recursively calculates the maximum number of constraints <italic>f</italic>(<italic>L</italic>) for substranscripts starting with subpath <italic>L</italic>: <italic>f</italic>(<italic>L</italic>) = max<sub><italic>L</italic>’</sub> { <italic>f</italic>(<italic>L</italic>′) + <italic>c</italic>(<italic>L, L</italic>′), if <italic>L</italic>′ exists; <italic>c</italic>(<italic>L</italic>), if <italic>L</italic>′does not exist }, where: (i) <italic>L</italic>′ is a subpath immediately following <italic>L</italic> so that all constraints compatible with <italic>L</italic> end before or within <italic>L</italic>′; (ii) <italic>c</italic>(<italic>L, L</italic>′) is the number of constraints starting in and (partially) compatible with <italic>L</italic> and <italic>L</italic>′, and compatible with the concatenated subpath <italic>L</italic>, <italic>L</italic>′; and (iii) <italic>c</italic>(<italic>L</italic>) is the number of constraints covered by subtranscript <italic>L</italic>. To take into account the abundance levels in the optimization process, at each sweep of the graph the algorithm excludes subpaths that cover constraints with abundance below a fixed value <italic>x</italic>; hence, the dynamic programming algorithm will return the best transcript with abundance greater than <italic>x</italic> (<italic>x</italic>-abundance transcript). With this modification, at each graph sweep the selection process selects an <italic>x</italic>-abundance transcript, starting with <italic>x</italic><sub>0</sub> = 0 (thus guaranteeing that such a transcript exists), and each selected transcript’s abundance value used as lower bound for the selection process at the following step: 0 <italic>=</italic> <italic>x</italic><sub>0</sub> <italic>&lt;</italic> <italic>x</italic><sub>1</sub> <italic>&lt;</italic> <italic>x</italic><sub>2</sub> <italic>&lt;</italic> ⋯<italic>x</italic><sub><italic>m</italic></sub>, until no transcript can be found. The optimal transcript then is among those selected by the sweeps. More details, along with proof of correctness for the algorithm, can be found in Song et al.<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>.</p>
      <p id="Par35"><italic>Selecting a global set of transcripts</italic>. PsiCLASS selects a set of meta-annotations from the individual samples’ sets of transcripts by voting. Each transcript is assigned a score equal to the transcript’s average estimated abundance across the samples (i.e., every sample has one vote, weighted by the transcript’s abundance level; default cutoff: 1.0). As different cutoff parameters values might work best for data with specific characteristics, the user can readily adjust or recalibrate the voting parameters postassembly, starting from the already computed sets of transcripts for the individual samples.</p>
    </sec>
    <sec id="Sec12">
      <title>Sequence data</title>
      <p id="Par36">We generated 25 RNA-seq samples, with ~85 million 100 bp paired-end reads, using the software Polyester<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> with the default gene and transcript distribution models and randomly sampling 10% of the transcripts (at 13,912 genes) from the human GENCODE v.27<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> gene annotations. Reads were aligned to the reference genome hg38 separately with Hisat2 v.2.0.5<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> and STAR v.2.5.3a<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. Chromosome 2 alignments were extracted and used in the assembly and evaluations. Human liver samples were obtained from the Stanley Medical Research Institute (SMRI) and previously sequenced by Dr. Sabunciyan’s lab. All ethical standards set forth by the Johns Hopkins University and local laws were complied with. The liver tissue was collected postmortem by the SMRI after obtaining consent from the family of the deceased. A detailed description of the consent procedure and the collection was published<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>. The project was reviewed by the Johns Hopkins University Institutional Review Board (IRB) and was given exempt status since only postmortem tissue was involved in the research. For sequencing, total RNA was isolated using the Qiagen RNeasy kit and libraries were constructed using the Illumina TruSeq Stranded Total RNA kit for Human/Mouse/Rat following the manufacturers recommended protocol. The resulting stranded, rRNA depleted liver libraries were sequenced on an Illumina HiSeq 2000 instrument. 667 RNA-seq samples from human lymphoblastoid cell lines part of the GEUVADIS population variation project were publicly available from ArrayExpress (accession: E-GEUV-6), and mouse hippocampus RNA-seq data were those reported in ref. <sup><xref ref-type="bibr" rid="CR23">23</xref></sup> and available from GenBank (ProjectID: PRJEB18790). Lastly, RNA-seq samples from six human tissues (frontal cortex, cortex, cerebellum, heart, liver, and lung) used in the heterogeneity study were downloaded from the dbGAP GTEx<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> repository. The lists of samples for each evaluation are included in the Source Data file.</p>
    </sec>
    <sec id="Sec13">
      <title>Performance evaluation</title>
      <p id="Par37">Once the reads were mapped to the genome, we used StringTie v.1.3.3.b and Scallop v.0.10.2 to assemble them into transcripts, for each individual sample. Transcript sets for all samples in an experiment were then merged with StringTie(ST)-merge and TACO v.0.7.3. For PsiCLASS v.1.0.1, reads were assembled simultaneously across all samples. To evaluate the accuracy of transcript assembly, we employed standard sensitivity (Sn) and precision (Pr) measures and evaluation criteria to assess the accuracy of transcript reconstructions by comparison to a gold reference, namely the set of simulated transcripts and the human GENCODE v.27 and mouse RefSeq gene annotations. A predicted transcript is deemed a true positive (TP) iff its intron chain fully matches that of a gold reference transcript. If N is the number of predicted transcripts, M be the number of ground truth transcripts, then Sn = TP/M and Pr = TP/N <sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. Performance metrics at the transcript, exon, and intron levels were calculated with the tool <italic>grader</italic> included in the PsiCLASS package, and at the gene level with the tool Cuffcompare (v.2.2.1). For gene content analyses, only transcripts that were a full match, contained or splice variant transcript (codes ‘=’, ‘c’, and ‘j’) of a reference gene were considered.</p>
    </sec>
    <sec id="Sec14">
      <title>Reporting summary</title>
      <p id="Par38">Further information on research design is available in the <xref rid="MOESM3" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec15">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2019_12990_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2019_12990_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2019_12990_MOESM3_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2019_12990_MOESM4_ESM.xlsx">
            <caption>
              <p>Source Data</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Peer review information</bold><italic>Nature Communications</italic> thanks the anonymous reviewer(s) for their contribution to the peer review of this work. Peer reviewer reports are available.</p>
    </fn>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> is available for this paper at 10.1038/s41467-019-12990-0.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Development and evaluations were performed on the Maryland Advanced Research Computing Center (MARCC). Work was supported in part by NSF grants ABI-1356078 and IOS-1339134 to L.F., and by NIH grants R01GM129085 and R01GM124531 to L.F. and Kathleen Burns. S.S. was supported by a grant from the Stanley Medical Research Institute.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>L.F. and L.S. conceived the project, L.S. developed the method, S.S. provided sequence data, and L.S., L.F., G.Y., and S.S. contributed to the evaluation. All authors wrote and approved the paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>Raw sequence data for the GEUVADIS project can be obtained from ArrayExpress (Accession:E-GEUV-6), mouse hippocampus data from GenBank (ProjectID:PRJEB18790), and alignments of simulated data from Zenodo (10.5281/zenodo.1407759). The liver data has been deposited in GenBank under accession <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA575230">PRJNA575230</ext-link>. In addition, the full set of evaluation results represented in Fig. <xref rid="MOESM4" ref-type="media">1</xref>, Tables <xref rid="MOESM4" ref-type="media">1</xref> and <xref rid="MOESM4" ref-type="media">2</xref>, and Supplementary Figs. <xref rid="MOESM4" ref-type="media">2</xref>, <xref rid="MOESM4" ref-type="media">4</xref>–<xref rid="MOESM4" ref-type="media">9</xref> are provided as a Source Data file, and scripts for performing the evaluation and links to the assembled transcripts can be obtained from the project site in GitHub. All other relevant data are available upon request.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>PsiCLASS is available under a GNU GPL license from <ext-link ext-link-type="uri" xlink:href="https://github.com/splicebox/PsiCLASS">https://github.com/splicebox/PsiCLASS</ext-link>.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par39">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>
        <source>Nat. Rev. Genet</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2484</pub-id>
        <pub-id pub-id-type="pmid">19015660</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Shai</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Frey</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Blencowe</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Deep surveying of alternative splicing complexity in the human transcriptome by high-throughput sequencing</article-title>
        <source>Nat. Genet</source>
        <year>2008</year>
        <volume>40</volume>
        <fpage>1413</fpage>
        <lpage>1415</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.259</pub-id>
        <pub-id pub-id-type="pmid">18978789</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Niknafs</surname>
            <given-names>YS</given-names>
          </name>
          <name>
            <surname>Pandian</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Chinnaiyan</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>MK</given-names>
          </name>
        </person-group>
        <article-title>TACO produces robust multisample transcriptome assemblies from RNA-seq</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>68</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4078</pub-id>
        <pub-id pub-id-type="pmid">27869815</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2009</year>
        <volume>28</volume>
        <fpage>511</fpage>
        <lpage>515</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1621</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>IsoLasso: a LASSO regression approach to RNA-Seq based transcriptome assembly</article-title>
        <source>J. Comput. Biol.</source>
        <year>2011</year>
        <volume>18</volume>
        <fpage>1693</fpage>
        <lpage>1707</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2011.0171</pub-id>
        <pub-id pub-id-type="pmid">21951053</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guttman</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ab initio reconstruction of cell type-specific transcriptomes in mouse reveals the conserved multi-exonic structure of lincRNAs</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>503</fpage>
        <lpage>510</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1633</pub-id>
        <pub-id pub-id-type="pmid">20436462</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tomescu</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Kuosmanen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rizzi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Makinen</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>A novel min-cost flow method for estimating transcript expression with RNA-Seq</article-title>
        <source>BMC Bioinform.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>S15</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-S5-S15</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Florea</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>CLASS: constrained transcript assembly of RNA-seq reads</article-title>
        <source>BMC Bioinforma.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>S14</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-S5-S14</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mezlini</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>iReckon: simultaneous isoform discovery and abundance estimation from RNA-seq data</article-title>
        <source>Genome Res</source>
        <year>2013</year>
        <volume>23</volume>
        <fpage>519</fpage>
        <lpage>529</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.142232.112</pub-id>
        <pub-id pub-id-type="pmid">23204306</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Canzar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Andreotti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Weese</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Klau</surname>
            <given-names>GW</given-names>
          </name>
        </person-group>
        <article-title>CIDANE: comprehensive isoform discovery and abundance estimation</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>16</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0865-0</pub-id>
        <pub-id pub-id-type="pmid">26831908</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bernard</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Jacob</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mairal</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vert</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Efficient RNA isoform identification and quantification from RNA-Seq data with network flows</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2447</fpage>
        <lpage>2455</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu317</pub-id>
        <pub-id pub-id-type="pmid">24813214</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sabunciyan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Florea</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>CLASS2: accurate and efficient splice variant annotation from RNA-seq reads</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>e98</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw158</pub-id>
        <pub-id pub-id-type="pmid">26975657</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pertea</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>StringTie enables improved reconstruction of a transcriptome from RNA-seq reads</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>290</fpage>
        <lpage>295</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3122</pub-id>
        <pub-id pub-id-type="pmid">25690850</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>TransComb: genome-guided transcriptome assembly via combing junctions in splicing graphs</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>213</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-1074-1</pub-id>
        <pub-id pub-id-type="pmid">27760567</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shao</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kingsford</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Accurate assembly of transcripts through phase-preserving graph decomposition</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>1167</fpage>
        <lpage>1169</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4020</pub-id>
        <pub-id pub-id-type="pmid">29131147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steijger</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assessment of transcript reconstruction methods for RNA-seq</article-title>
        <source>Nat. Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1177</fpage>
        <lpage>1184</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2714</pub-id>
        <pub-id pub-id-type="pmid">24185837</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>Y-Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CLIIQ: Accurate comparative detection and quantification of expressed isoforms in a population</article-title>
        <source>Algorithms Bioinform. LNCS</source>
        <year>2012</year>
        <volume>7534</volume>
        <fpage>178</fpage>
        <lpage>189</lpage>
        <pub-id pub-id-type="doi">10.1007/978-3-642-33122-0_14</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tasnim</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Accurate inference of isoforms from multiple sample RNA-Seq data</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>S15</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-16-S2-S15</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Behr</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MITIE: Simultaneous RNA-Seq-based transcript identification and quantification in multiple samples</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2529</fpage>
        <lpage>2538</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt442</pub-id>
        <pub-id pub-id-type="pmid">23980025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frazee</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
        </person-group>
        <article-title>Polyester: simulating RNA-seq datasets with differential transcript expression</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>2778</fpage>
        <lpage>2784</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv272</pub-id>
        <pub-id pub-id-type="pmid">25926345</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>HISAT: a fast spliced aligner with low memory requirements</article-title>
        <source>Nat. Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>357</fpage>
        <lpage>360</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3317</pub-id>
        <pub-id pub-id-type="pmid">25751142</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>29</volume>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id>
        <pub-id pub-id-type="pmid">23104886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Srivastava</surname>
            <given-names>PK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide analysis of differential RNA editing in epilepsy</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>440</fpage>
        <lpage>450</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.210740.116</pub-id>
        <pub-id pub-id-type="pmid">28250018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Consortium</surname>
            <given-names>GT</given-names>
          </name>
        </person-group>
        <article-title>Human genomics. The genotype-tissue expression (GTEx) pilot analysis: multitissue gene regulation in humans</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>348</volume>
        <fpage>648</fpage>
        <lpage>660</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1262110</pub-id>
        <pub-id pub-id-type="pmid">25954001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tomczak</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Czerwinska</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wiznerowicz</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The Cancer Genome Atlas (TCGA): an immeasurable source of knowledge</article-title>
        <source>Contemp. Oncol.</source>
        <year>2015</year>
        <volume>19</volume>
        <fpage>A68</fpage>
        <lpage>A77</lpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harrow</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GENCODE: the reference human genome annotation for The ENCODE Project</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>1760</fpage>
        <lpage>1774</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.135350.111</pub-id>
        <pub-id pub-id-type="pmid">22955987</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Torrey</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Webster</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Knable</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Johnston</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Yolken</surname>
            <given-names>RH</given-names>
          </name>
        </person-group>
        <article-title>The Stanley Foundation brain collection and neuropathology consortium</article-title>
        <source>Schizophr. Res.</source>
        <year>2000</year>
        <volume>44</volume>
        <fpage>151</fpage>
        <lpage>155</lpage>
        <pub-id pub-id-type="doi">10.1016/S0920-9964(99)00192-9</pub-id>
        <pub-id pub-id-type="pmid">10913747</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6825223</article-id>
    <article-id pub-id-type="publisher-id">12990</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-019-12990-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A multi-sample approach increases the accuracy of transcript assembly</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Song</surname>
          <given-names>Li</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sabunciyan</surname>
          <given-names>Sarven</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Guangyu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8124-2324</contrib-id>
        <name>
          <surname>Florea</surname>
          <given-names>Liliana</given-names>
        </name>
        <address>
          <email>florea@jhu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution>McKusick-Nathans Institute of Genetic Medicine, Johns Hopkins School of Medicine, </institution></institution-wrap>Baltimore, MD USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution>Department of Computer Science, </institution><institution>Johns Hopkins University, </institution></institution-wrap>Baltimore, MD USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution>Department of Pediatrics, </institution><institution>Johns Hopkins School of Medicine, </institution></institution-wrap>Baltimore, MD USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution>Department of Medicine, </institution><institution>Johns Hopkins School of Medicine, </institution></institution-wrap>Baltimore, MD USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2106 9910</institution-id><institution-id institution-id-type="GRID">grid.65499.37</institution-id><institution>Present Address: Department of Data Sciences, </institution><institution>Dana Farber Cancer Institute, </institution></institution-wrap>Boston, MA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>5000</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>2</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>10</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Transcript assembly from RNA-seq reads is a critical step in gene expression and subsequent functional analyses. Here we present PsiCLASS, an accurate and efficient transcript assembler based on an approach that simultaneously analyzes multiple RNA-seq samples. PsiCLASS combines mixture statistical models for exonic feature selection across multiple samples with splice graph based dynamic programming algorithms and a weighted voting scheme for transcript selection. PsiCLASS achieves significantly better sensitivity-precision tradeoff, and renders precision up to 2-3 fold higher than the StringTie system and Scallop plus TACO, the two best current approaches. PsiCLASS is efficient and scalable, assembling 667 GEUVADIS samples in 9 h, and has robust accuracy with large numbers of samples.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Transcript assembly is an important step in analysis of RNA-seq data whose accuracy influences downstream quantification, detection and characterization of alternative splice variants. Here, the authors develop PsiCLASS, a transcript assembler leveraging simultaneous analysis of multiple RNA-seq samples.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Genome informatics</kwd>
      <kwd>Software</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation (NSF)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1356078</award-id>
        <award-id>1339134</award-id>
        <principal-award-recipient>
          <name>
            <surname>Florea</surname>
            <given-names>Liliana</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100006955</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | NIH | Office of Extramural Research, National Institutes of Health (OER)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM124531</award-id>
        <principal-award-recipient>
          <name>
            <surname>Florea</surname>
            <given-names>Liliana</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100007123</institution-id>
            <institution>Stanley Medical Research Institute (SMRI)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>n/a</award-id>
        <principal-award-recipient>
          <name>
            <surname>Sabunciyan</surname>
            <given-names>Sarven</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">RNA sequencing (RNA-seq) has become the de facto standard in surveying the transcriptome of a cell, organism, or species, to determine the expressed genes and transcripts and their expression levels, and to enable differential and functional analyses<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup>. A crucial step in virtually all RNA-seq data analyses is assembling the reads into full-length transcripts. The accuracy of transcript reconstruction is critical for quantification, detection, and characterization of alternative splice variants, and the identification of differences in gene expression and splicing patterns between tissues, developmental stages, and physiological or disease states.</p>
    <p id="Par4">Virtually all transcriptomic studies involve multiple samples. The current paradigm is to assemble the reads in each sample, then merge the partial transcripts (transfrags) across all samples to create a unified set of meta-annotations<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, which is used as reference for downstream quantification and differential analyses. Most single-sample assemblers including Cufflinks, isoCEM, Scripture, Traph, CLASS, iReckon, CIDANE, FlipFlop, CLASS2, StringTie, Scallop, and TransComb<sup><xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR15">15</xref></sup> build a graph structure from read alignments on the genome, then traverse the graph to select an optimized set of transcripts, represented as paths. Recent second-generation transcript assembly methods including StringTie, CLASS2, and Scallop have taken great strides toward increasing the accuracy and efficiency of assembly at single-sample level, and meta-assemblers such as StringTie(ST)-merge and TACO<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> have led to more robust collections of meta-annotations. Despite these efforts precision remains low, with &lt;40% of the predicted transcripts in a single-sample and &lt;30% of transcripts in meta-annotations representing complete and accurate reconstructions<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR16">16</xref></sup>. Concomitantly, a handful of efforts have focused on designing methods that simultaneously assemble transcripts across multiple RNA-seq samples, notably CLIIQ, ISP, MiTie, and FlipFlop<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR19">19</xref></sup>. However, none of these programs has comparable performance or is equipped to handle more than a limited number of samples. (See <xref rid="MOESM1" ref-type="media">Supplementary Methods</xref> for a more in-depth review of related work.)</p>
    <p id="Par5">We present PsiCLASS, based on an approach that simultaneously analyzes multiple RNA-seq samples, which achieves significantly higher precision at sensitivity comparable to the best current approaches, and significantly higher overall accuracy in its default setting. PsiCLASS differs from traditional assemblers in two ways. First, it is a combined assembler, reporting a set of transcripts for each sample, and meta-assembler<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, producing a set of meta-annotations obtained by combining the individual samples’ outputs. Second, unlike traditional single-sample assemblers, it uses information from all samples to produce transcripts for individual samples and for the unified annotation set. PsiCLASS starts by selecting a set of high-confidence introns and subexons at each locus, using statistical models of introns and intronic read levels. In doing so, it first generates a set of features (subexons, introns) for each sample, and then corroborates information across all samples to select a high-confidence subset. Next, PsiCLASS builds a unified subexon splice graph that is used within a dynamic programming optimization procedure to select a representative set of transcripts in each sample (see “Methods” and Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref> for details). Lastly, PsiCLASS extracts a subset of meta-annotations from the aggregated transcript sets by voting. Salient features of PsiCLASS include: (i) an algorithm that assembles reads from multiple samples simultaneously, taking advantage of their redundancy and complementarity; (ii) significantly higher precision at meta-assembly level, up to 2–3 fold, over StringTie with ST-merge and Scallop with TACO, and high precision (&gt;50%) overall; (iii) 22–140% increase in precision at meta-assembly level over StringTie with ST-merge, and 35–89% over Scallop with TACO, when matched to their sensitivity levels; (iv) higher overall performance in combined sensitivity and precision at the individual sample level; (v) improved consistency among the individual samples’ annotations and meta-annotations, and robustness with different meta-assemblers; and (vi) high efficiency and scalability, taking only 9 h to assemble 667 GEUVADIS samples, and robust accuracy as the number of samples increases. Overall, PsiCLASS is highly efficient and overcomes limitations in the existing methods, showing significantly higher accuracy, in particular precision, on data sets with a handful to hundreds of samples, thus providing an efficient method for RNA-seq data analysis.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Performance evaluation on simulated data</title>
      <p id="Par6">We compared PsiCLASS with the best current approaches, namely StringTie and Scallop at the individual sample level, and the combinations of StringTie with ST-merge and Scallop with TACO, at the meta-assembly level. We also included FlipFlop, which was the only other competitive multi-assembler; because of excessive run times, however, FlipFlop was not feasible for our tests on real data sets. (Other combinations are shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>). We first applied the methods to 25 RNA-seq samples simulated with Polyester<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, where reads were aligned with two methods, Hisat2<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> and STAR<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. Performance was slightly better for all programs when reads were aligned with Hisat2 (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>), therefore we chose this alignment method for the rest of the analyses.</p>
      <p id="Par7">On the simulated data, PsiCLASS with default voting achieved 71.4% precision, which is 15.0% higher than the StringTie system, and 28.3% and 21.6% higher than Scallop and FlipFlop, respectively, combined with TACO, whereas sensitivity for all programs was roughly 50% (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). Even at the individual sample level, PsiCLASS had both the highest precision and the highest sensitivity: 73.8% precision on average, compared with 70.8% for StringTie, 62.9% for Scallop, and 50.7% for FlipFlop, and 53.4% sensitivity compared with 41.7% for StringTie, 46.2% for Scallop, and 36.1% for FlipFlop. Precision values for StringTie, Scallop, and FlipFlop, but to a lesser extent for PsiCLASS, dropped significantly after aggregation, hence PsiCLASS produces more consistent sets of transcripts between individual samples and the set of meta-annotations.<fig id="Fig1"><label>Fig. 1</label><caption><p>Performance evaluation of methods on simulated and real data: <bold>a</bold> 25 simulated RNA-seq sets, all genes; <bold>b</bold> 25 simulated sets, genes grouped by abundance; <bold>c</bold> 25 GEUVADIS samples (polyadenylated RNA); <bold>d</bold> 73 liver RNA-seq samples (rRNA-depleted total RNA); <bold>e</bold> 44 hippocampus samples from healthy and epileptic mice; and <bold>f</bold> subsets of 1, 2, 3, 5, 10, 20, 40, 80, 160, and 320, and the full set of 667 GEUVADIS samples. In <bold>a</bold>, <bold>b</bold>–<bold>e</bold>, sensitivity (recall) and precision values for PsiCLASS, StringTie, and Scallop at the level of individual samples are shown in boxed plots, and meta-annotations resulted from aggregation (with PsiCLASS voting, ST-merge, and TACO) are shown with colored shapes. Boxplots were generated with R using default options, namely, the box extends between the lower and upper quartiles, horizontal lines mark the median, and whiskers are at the 1.5 × interquantile point above the upper quartile and bellow the lower quartile. Lastly, additional symbols mark sensitivity and precision values for PsiCLASS when tuned to match or approach the sensitivity of its competitors, along the range of cutoff values 0–16, shown with dotted red lines. Source data are provided as a Source Data file</p></caption><graphic xlink:href="41467_2019_12990_Fig1_HTML" id="d29e401"/></fig></p>
      <p id="Par8">We further investigated the performance of methods based on the transcripts’ expression levels (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>). Simulated transcripts were divided into low (463 transcripts; Fragments Per Kilobase (FPK) &lt; 30), medium (658 transcripts; 30 ≤ FPK &lt; 500) and high (322 transcripts; FPK ≥ 500) according to the predefined expression levels. PsiCLASS with voting reconstructs the largest fraction of high-expressed transcripts, 82.4%, and all three programs recover ~60% of the medium-expressed ones. FlipFlop has by far the highest sensitivity in detecting low expression features, 41.0%, compared with 10–20% for the other programs. Note that, because a reconstructed transcript’s expression level may fall in another class than the predefined one, precision cannot be rigorously evaluated.</p>
      <p id="Par9">Similarly, to assess the programs’ performance based on the gene’s splicing complexity, we divided genes into three categories by the number of their alternatively spliced transcripts: low (1 transcript per gene; 680 genes, 680 transcripts), medium (2 transcripts per gene; 166 genes, 332 transcripts), and high (3 or more transcripts per gene; 106 genes, 431 transcripts). While, StringTie showed the best overall performance on the single-transcript genes, PsiCLASS had the highest sensitivity and precision on the medium and high complexity classes, in particular a 16.8–24.5% gain in sensitivity and 21.0–31.8% in precision on highly expressed transcripts (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>).</p>
    </sec>
    <sec id="Sec4">
      <title>Performance evaluation on real RNA-seq data collections</title>
      <p id="Par10">We next assessed the performance on two representative RNA-seq data sets, generated with two different library preparation protocols: 25 randomly selected sets from polyA-selected lymphoblastoid samples from the GEUVADIS population variation project, and 73 rRNA-depleted total RNA libraries from postmortem human liver samples with funding from the Stanley Medical Research Institute. At the meta-assembly level, PsiCLASS’s precision for the GEUVADIS set is 69.3% and 89.2% higher than StringTie’s and Scallop plus TACO’s, respectively, whereas sensitivity is higher or comparable, by 4.5% and −0.9%, respectively (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). Similarly, advantages of the multi-sample approach are seen for the liver total RNA data set, with more than twofold and threefold increases in precision, albeit at 18.6% and 35.3% lower sensitivity. Even when matched to the other programs’ sensitivity settings, PsiCLASS maintains 140% and 89% gains in precision over the StringTie system and Scallop plus TACO, respectively, albeit for this data set Scallop with TACO retains superior sensitivity over the entire parameter range (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>). In such cases, the default voting setting may not present the best tradeoff, and as PsiCLASS’s precision remains significantly higher than that of its counterparts the user may choose a different cutoff. Even at the individual sample level, PsiCLASS’s performance exceeds that of its competitors’, with higher or comparable per sample average measurements in both components (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>, <xref rid="Fig1" ref-type="fig">d</xref>, boxplots).</p>
    </sec>
    <sec id="Sec5">
      <title>Performance evaluation on heterogeneous data collections</title>
      <p id="Par11">Most RNA-seq analyses are aimed at determining gene expression or splicing differences between two biological conditions. To explore the robustness of PsiCLASS when combining two-condition samples, we applied it and the other methods to RNA-seq samples from hippocampi of normal mice (24 samples) and mice with induced epileptic seizures (20 samples) (ref.<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> and Source Data). The diagrams in Fig. <xref rid="Fig1" ref-type="fig">1e</xref> indicate that at the level of individual samples PsiCLASS has higher sensitivity than both StringTie and Scallop, by 26.2% and 8.4% on average, whereas precision exceeds Scallop’s by 42.3% and is comparable to StringTie’s at 66%. Moreover, after voting PsiCLASS’s precision at the level of meta-annotations is 45.7% and 55.0% higher than the other programs’, respectively, along with an increase in sensitivity (15.1% and 7.8%), therefore recommending it as the overall best performer. Thus, PsiCLASS can be effectively and more reliably used on the aggregate set of samples in a two-condition comparison.</p>
      <p id="Par12">We further explored the applicability of PsiCLASS to more divergent and heterogeneous collections of data. We applied PsiCLASS to single- and multi-tissue collections extracted from the GTEx<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> repository (ten RNA-seq samples for each of six tissues: cortex, frontal cortex, cerebellum, heart, liver, and lung). We then aggregated the results in each collection in three ways, using PsiCLASS voting, TACO, and TACO applied to the samples assembled separately by tissue. In all cases, PsiCLASS with its default voting algorithm had better performance, with both higher sensitivity, and higher precision (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>). Notably, our approach resulted in significantly more accurate transcript sets for all collections, with 11.2–16.8% increase in precision over TACO, and a significant 21.4–47.1% increase over TACO applied to the per tissue assembled collections. As the heterogeneity in the data increases, gains in sensitivity reach diminishing returns, while the increase in precision becomes more pronounced. These simple experiments show promise for extending PsiCLASS’s capabilities to more heterogeneous data sets.</p>
    </sec>
    <sec id="Sec6">
      <title>Deconvoluting the effects of algorithmic components</title>
      <p id="Par13">While the different components of the PsiCLASS algorithm are intercalibrated to work in harmony with each other, to guide future program development we attempted to deconvolute the effects on performance of the individual algorithmic components. In a first test, we comprehensively evaluated all combinations of individual sample (PsiCLASS, StringTie, and Scallop) and meta-assemblers (voting, ST-merge, and TACO) at multiple levels. Notably, voting significantly increased transcript level precision for all programs, albeit PsiCLASS maintained a clear advantage in all but one case (GEUVADIS-25), where Scallop’s performance was comparable (Supplementary Figs. <xref rid="MOESM1" ref-type="media">6</xref> and <xref rid="MOESM1" ref-type="media">7</xref>). Conversely, unlike the other two programs, PsiCLASS rendered comparable results when its sample-level transcript sets were merged with the voting, ST-merge and TACO aggregation methods, demonstrating the robustness of its reconstructions (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref>). As conventional measurements based on the number of fully reconstructed transcripts only partially describe the accuracy of a data set, we also assessed the accuracy at the feature (exon, intron) and gene level. Indeed, even when the best meta-assembly method (voting) is used for all programs, PsiCLASS captures significantly more gene and transcript content, with 10–40% more introns and 10–50% more internal exons than StringTie and Scallop, at comparable 95–98% precision (Supplementary Fig. <xref rid="MOESM1" ref-type="media">8</xref>). Further, PsiCLASS reported significantly more genes that had at least one fully reconstructed transcript, 7.0–24.7% more than StringTie and 2.9–31.3% more than Scallop. Lastly but notably, PsiCLASS also detected many more genes: 3.9–9.6% more than StringTie and up to a very significant 46.3% more than Scallop, with the largest of these gains observed for the liver data (Supplementary Figs. <xref rid="MOESM1" ref-type="media">9</xref> and <xref rid="MOESM1" ref-type="media">10</xref>). These improvements are the direct consequence of the completeness of PsiCLASS gene structure model as captured in the shared subexon graph, an algorithmic feature that particularly favors low expression genes.</p>
    </sec>
    <sec id="Sec7">
      <title>Performance evaluation with small numbers of samples</title>
      <p id="Par14">We next investigated the utility of the multi-sample approach for small data collections, including single samples. Table <xref rid="Tab1" ref-type="table">1</xref> shows the results for all methods on sets of 2, 3, 5, and 10 samples from our simulated set, averaged over five independent trials, and for single-sample sets, averaged over all possible 25 trials. The multi-sample approach shows benefits in all cases, most notably increased sensitivity (range 47–53% for PsiCLASS, compared with 42–48% for StringTie, and 43–48% for Scallop with TACO) at comparable or higher precision (range 67–70% for PsiCLASS, compared with 64–71% for StringTie and 57–62% for Scallop).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Performance of methods on experiments with small numbers of samples on simulated data</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Number of samples</th><th>Recall PsiCLASS</th><th>Recall StringTie</th><th>Recall Scallop</th><th>Precision PsiCLASS</th><th>Precision StringTie</th><th>Precision Scallop</th></tr></thead><tbody><tr><td>1</td><td>45.6</td><td>41.7</td><td>46.2</td><td>66.9</td><td>70.8</td><td>62.9</td></tr><tr><td>2</td><td>46.7</td><td>43.8</td><td>43.3</td><td>68.6</td><td>69.1</td><td>57.0</td></tr><tr><td>3</td><td>49.9</td><td>45.2</td><td>45.0</td><td>67.3</td><td>68.5</td><td>56.7</td></tr><tr><td>5</td><td>52.1</td><td>46.6</td><td>46.2</td><td>69.7</td><td>66.7</td><td>56.7</td></tr><tr><td>10</td><td>52.7</td><td>48.0</td><td>48.1</td><td>70.0</td><td>64.0</td><td>56.5</td></tr></tbody></table></table-wrap></p>
      <p id="Par15">PsiCLASS is designed to take advantage of cross-sample gene information in a multi-sample experiment. Nevertheless, we also evaluated it and the other programs on isolated single-samples from three previously reported real data sets (Table <xref rid="Tab2" ref-type="table">2</xref>). PolyA-selected RNA-seq paired-end reads from CD20+ (SRR534319, 25 million reads), CD14+ (SRR545695, 39 million reads), and IMR90 (SRR534291, 114 million reads) cell lines were previously used to demonstrate performance improvements in both the StringTie and Scallop publications. When PsiCLASS used solely information from that sample, performance across the three samples was similar between StringTie and PsiCLASS, whereas Scallop had significantly higher sensitivity albeit at slightly lower precision. However, since each data set was part of a multi-sample experiment (SRR534291-SRR534292, SRR545695-SRR545700, and SRR534319-SRR534324), we sought to assess the advantage of the cross-sample information. Even with the small (2–6) number of replicates, when all samples in an experiment were considered PsiCLASS’s performance for the three samples improved (up to 28.3% sensitivity increase over PsiCLASS single-sample, and up to 35.0% over StringTie), especially for the low coverage sample (SRR534319).<table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance of methods on experiments with small numbers of samples on real data</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Sample</th><th>Recall PsiCLASS<sup>a</sup></th><th>Recall PsiCLASS<sup>b</sup></th><th>Recall StringTie</th><th>Recall Scallop</th><th>Precision PsiCLASS<sup>a</sup></th><th>Precision PsiCLASS<sup>b</sup></th><th>Precision StringTie</th><th>Precision Scallop</th></tr></thead><tbody><tr><td>SRR534319</td><td>44.2</td><td>56.7</td><td>42.0</td><td>65.7</td><td>29.5</td><td>30.1</td><td>30.5</td><td>24.5</td></tr><tr><td>SRR545695</td><td>50.4</td><td>60.3</td><td>49.4</td><td>72.7</td><td>32.5</td><td>32.4</td><td>35.7</td><td>26.6</td></tr><tr><td>SRR534291</td><td>63.3</td><td>66.1</td><td>65.5</td><td>81.6</td><td>30.8</td><td>35.0</td><td>37.1</td><td>35.1</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Single samples in one-sample experiments</p><p><sup>b</sup>Individual samples in multi-sample experiments</p></table-wrap-foot></table-wrap></p>
      <p id="Par16">Overall, PsiCLASS showed competitive or higher performance on experiments with a small (2–10) number of samples, with benefits most evident for data sets of three or more samples. It also ranked comparable with StringTie and Scallop on single-sample data sets in our control experiments, and similarly to StringTie on the three samples for which the two reference programs were optimized. Therefore, our program can be effectively used for small RNA-seq collections and within the conventional assemble-and-merge approach.</p>
    </sec>
    <sec id="Sec8">
      <title>Performance evaluation on very large data collections</title>
      <p id="Par17">As the emerging landscape of RNA-seq foresees increasingly larger data sets from large patient cohorts and population variation studies, we aimed to assess the suitability of the multi-sample approach as the data set grows. We evaluated program performance on increasingly larger subsets of RNA-seq samples from the GEUVADIS population variation project, up to the full set of 667 samples (Fig. <xref rid="Fig1" ref-type="fig">1f</xref>). All methods show improvements in sensitivity as the number of samples increases, but while PsiCLASS and Scallop show further slight gains after 20–50 samples, the sensitivity of StringTie drops. Precision drops markedly for both Scallop and StringTie, to less than 35% for 50 samples and below 20% for the full set of samples. In sharp contrast, PsiCLASS’s sensitivity and precision remain almost constant with more than ten samples, demonstrating the robustness of this approach. Also, with sensitivity 9–40% higher than StringTie’s and precision (&gt;50%) twice as high as that of the other two systems when the data set exceeds 20–50 samples, PsiCLASS is unequivocally the best suited for handling large RNA-seq collections. Lastly, PsiCLASS took only 9 h with 24 threads to process the 667 samples at a peak memory of 14 GB RAM on an 3.0 GHz Intel “Ivy Bridge” Xeon server, amounting to &lt;1 min per sample. By comparison, StringTie took 34 h to process the samples sequentially, with 24 threads, at a peak memory of 524 MB, and Scallop, which is single-threaded, required 75 h with a peak memory of 5 GB.</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par18">Determining the set of expressed genes and transcripts in an RNA-seq experiment is critical for subsequent quantification and differential expression and splicing analyses. The conventional approach to process each sample separately and then merge the sets of transcripts to create a unified set of annotations has limitations, in particular low precision. We present PsiCLASS, a transcript assembler and meta-assembler that simultaneously analyzes all samples in an RNA-seq experiment. Algorithmic underpinnings of PsiCLASS include a global subexon graph, statistical methods for cross-sample feature selection, and dynamic programming optimization and voting algorithms for transcript selection at the level of individual samples and over the entire collection of data, which collectively lead to more complete, more accurate, and more consistent sets of annotations. In particular, our study suggests that voting-based approaches may have advantages over the current assembly-based aggregation methods in some cases, albeit their broader applicability needs to be further investigated.</p>
    <p id="Par19">PsiCLASS is designed to leverage the gene information across samples in a one or two condition experiments, to improve the accuracy of gene and transcript reconstruction for downstream differential gene expression and differential splicing studies, and may not be ideally suited to multi-condition experiments, such as annotation of genes and alternative splicing in large data sets such as GTEx<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> or TCGA<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. Nevertheless, our limited tests on collections of samples from 2 to 6 GTEx tissues reflect that PsiCLASS has better performance than TACO, and therefore show promise for exploring capabilities for handling more heterogeneous data sets in the future.</p>
    <p id="Par20">PsiCLASS had significantly higher precision at similar sensitivity when compared with current best methods, and showed consistently high precision (&gt;50%) when tested on data from a variety of experimental conditions. PsiCLASS is scalable, efficient, and robust with large numbers of RNA-seq samples, thus providing a highly effective paradigm for large-scale analyses of collections of hundreds and thousands of samples. PsiCLASS is available free of charge from <ext-link ext-link-type="uri" xlink:href="https://github.com/splicebox/PsiCLASS">https://github.com/splicebox/PsiCLASS</ext-link>.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Algorithm overview</title>
      <p id="Par21">PsiCLASS builds a global subexon graph of a gene and its splice variants from genome-aligned RNA-seq reads in all input samples. It then traverses the graph to select a subset of the encoded transcripts in each sample. Lastly, it combines the predicted transcript sets across all samples, using a voting procedure to select a final set of meta-annotations.</p>
      <p id="Par22"><italic>Building per sample subexon graphs</italic>. PsiCLASS builds a subexon graph for each sample, then combines graphs across all samples to create a global subexon graph. In each sample, PsiCLASS uses candidate introns extracted from spliced read alignments to divide the genome into regions and subexons. A region denotes a maximal contiguous portion of the genome covered by reads. A subexon is a portion of a region delimited by two consecutive splice junctions and/or the end(s) of the region. A subexon graph has subexons as vertices, and two subexons are connected by an edge if they are adjacent in the same region or connected by an intron. Candidate splice variants are encoded as maximal paths in the subexon graph.</p>
      <p id="Par23">To build the sample-level subexon graph, PsiCLASS clusters read alignments along the genome that are colocated and on the same strand. Introns are extracted from spliced alignments and used to divide the region into subexons. A major confounding factor in determining subexons from RNA-seq data is the presence of intronic unprocessed RNA (‘noise’). To differentiate between intronic noise and signal, such as retained introns or alternative 5′ and 3′ gene ends, PsiCLASS assigns each subexon a score that reflects the probability that it is noise. In contrast to current single-sample methods, which simply discard a subexon if it fails sample-wide cutoffs, PsiCLASS then combines sample-level scores across all samples to determine a final label for the subexon and its inclusion in the global subexon graph.</p>
      <p id="Par24">More specifically, PsiCLASS computes the probability that a subexon is due to intronic noise using two models: (i) the exon–intron coverage ratio, and (ii) the intronic read coverage. Let <italic>c</italic><sub><italic>i</italic></sub> be the average read coverage of (intronic) subexon <italic>i</italic>. In the coverage ratio model, PsiCLASS calculates a score that is equal to the coverage ratio of this subexon versus its flanking subexons: <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_i = {\mathrm{min}}\left( {\frac{{c_i}}{{c_{i - 1}}},\frac{{c_i}}{{c_{i + 1}}}} \right)$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">min</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq1.gif"/></alternatives></inline-formula>. The score is fitted to a mixture of two Gamma distributions, one representing signal and one noise: <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left( {r_i} \right) = \pi \Gamma _{\theta _0,k_0}\left( {r_i} \right) + \left( {1 - \pi } \right)\Gamma _{\theta _1,k_1}\left( {r_i} \right)$$\end{document}</tex-math><mml:math id="M4"><mml:mi>p</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq2.gif"/></alternatives></inline-formula>, where <italic>π</italic>, (1 − <italic>π</italic>) are the prior probabilities that an intronic subexon is noise or signal, respectively, and <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _0,k_0,\theta _1,k_1$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq3.gif"/></alternatives></inline-formula> are the parameters for the Gamma distributions, calculated with an expectation maximization algorithm. With these parameters, PsiCLASS can infer the probability that subexon <italic>i</italic> is noise according to the Bayes formula: <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_R\left( {r_i} \right) = \frac{{\pi \Gamma _{\theta _0,k_0}\left( {r_i} \right)}}{{\pi {\mathrm{\Gamma }}_{\theta _0,k_0}\left( {r_i} \right) + \left( {1 {\,}-{\,} \pi } \right)\Gamma _{\theta _1,k_1}\left( {r_i} \right)}}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>π</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.25em"/><mml:mo>−</mml:mo><mml:mspace width="0.25em"/><mml:mi>π</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq4.gif"/></alternatives></inline-formula>.</p>
      <p id="Par25">The coverage ratio model above is insufficient when the overall gene coverage is low. Hence, the second model establishes a similar formula for coverage levels, <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_C\left( {c_i} \right)$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq5.gif"/></alternatives></inline-formula>, with <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta^\prime_0,k^\prime _0,\theta ^\prime _1,k^\prime _1$$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq6.gif"/></alternatives></inline-formula> the parameters inferred using coverage. The final per sample subexon score then is <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( i \right) = {\mathrm{max}}(P_R\left( {r_i} \right),\;P_C(c_i))$$\end{document}</tex-math><mml:math id="M14"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.16em"/><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq7.gif"/></alternatives></inline-formula>.</p>
      <p id="Par26"><italic>Building the global subexon graph</italic>. PsiCLASS removes likely artifactual introns and intronic noise subexons by evaluating evidence across all sample, and builds a global subexon graph by combining individual samples’ graphs that share at least one intron. <italic>Multi-sample intron selection</italic>: To select a highly accurate set of introns, PsiCLASS assesses each candidate intron’s read support across all samples. Assume the experiment contains <italic>M</italic> samples, and denote each intron by its coordinates in the genome, e.g., (<italic>a, b</italic>). Let <italic>S</italic> (<italic>a, b</italic>) denote the total number of read alignments supporting (<italic>a, b</italic>) over all samples. Then the total number of alignments supporting its splice sites: <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S\left( a \right) = \mathop {\sum }\nolimits_{(a,y)} S\left( {a,y} \right),\;S\left( b \right) = \mathop {\sum }\nolimits_{\left( {x,b} \right)} S(x,b)$$\end{document}</tex-math><mml:math id="M16"><mml:mi>S</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mi>S</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.16em"/><mml:mi>S</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq8.gif"/></alternatives></inline-formula>. PsiCLASS keeps intron (<italic>a, b</italic>) iff: (i) <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{S\left( {a,b} \right)}}{M} \ge 0.5$$\end{document}</tex-math><mml:math id="M18"><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfrac><mml:mo>≥</mml:mo><mml:mn>0.5</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq9.gif"/></alternatives></inline-formula>, indicating strong read support in one or a few samples, or consistent read support across multiple samples; and (ii) (<italic>a, b</italic>) appears in at least <italic>M</italic>0 samples, where <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M0 = \min \left( \lceil{\frac{M}{{50}}\rceil\left( \lfloor{\frac{{b - a + 1}}{{100,000}}\rfloor + 1} \right),\;M} \right)$$\end{document}</tex-math><mml:math id="M20"><mml:mi>M</mml:mi><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:mi>min</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mrow><mml:mo>⌈</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>⌉</mml:mo></mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mrow><mml:mo>⌊</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.16em"/><mml:mi>M</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq10.gif"/></alternatives></inline-formula>, if |<italic>b</italic> <italic>−</italic> <italic>a</italic>| ≥ 100,000 (long intron). Condition (ii) is intended to filter out long intron-type alignment artifacts due to gene families and repeats, or from sequencing errors, which can lead to merged genes and transcripts. <italic>Multi-sample subexon selection:</italic> To determine a global set of subexons, PsiCLASS combines the subexon sets of individual samples with some modifications. Where multiple 3′ or 5′-end (i.e., subexons not delimited by a splice site) candidate subexons occur with the same endpoint and potentially different lengths among the samples, PsiCLASS creates a unique subexon with the median length. Further, to determine intronic subexons, PsiCLASS calculates a final score by combining all sample scores with a Bayesian formula. More specifically, let <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar \pi$$\end{document}</tex-math><mml:math id="M22"><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq11.gif"/></alternatives></inline-formula> denote the prior probability of intronic noise in the global model, calculated as the average of the mixture coefficients of the samples. Then the subexon score: <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_n\left( {{\mathrm{noise}}|{\mathrm{data}}} \right) = \frac{{\bar \pi {P({\mathrm{data}}|{\mathrm{noise}}})}}{{\bar \pi P\left( {{\mathrm{data}}|{\mathrm{noise}}} \right) + \left( {1 - \bar \pi } \right)P\left( {{\mathrm{data|real}}} \right)}}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">noise</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="normal">data</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">data</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="normal">noise</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">data</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="normal">noise</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">data∣real</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq12.gif"/></alternatives></inline-formula> reflects the probability that the subexon is noise, where data is the observed information such as the coverage in each sample. We assume the samples are independent, hence <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{P}}\left( {{\mathrm{data}}|{\mathrm{noise}}} \right) = \mathop {\prod }\nolimits_{s = 1}^M G_0^{\left( s \right)}\left( i \right)$$\end{document}</tex-math><mml:math id="M26"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">data</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="normal">noise</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo> ∏</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq13.gif"/></alternatives></inline-formula>, where <italic>s</italic> = 1<italic>,…, M</italic> denotes the sample. Here, <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_0^{\left( s \right)}\left( i \right)$$\end{document}</tex-math><mml:math id="M28"><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq14.gif"/></alternatives></inline-formula> is <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma _{\theta _0^{\left( s \right)},\:k_0^{\left( s \right)}}(r_i^{(s)})$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="2.22144pt"/><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq15.gif"/></alternatives></inline-formula> if the ratio model is used for subexon <italic>i</italic> in sample <italic>s</italic>, and <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma _{\theta \prime _0^{\left( s \right)},\;k\prime _0^{\left( s \right)}}( {c_i^{(s)}} )$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.16em"/><mml:msubsup><mml:mrow><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq16.gif"/></alternatives></inline-formula> if the <italic>coverage model</italic> is employed. Similarly, <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\left( {{\mathrm{data}}|{\mathrm{real}}} \right) = \mathop {\prod }\nolimits_{s = 1}^M G_1^{\left( s \right)}\left( i \right)$$\end{document}</tex-math><mml:math id="M34"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">data</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="normal">real</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo> ∏</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq17.gif"/></alternatives></inline-formula>. In the end, the subexon is retained if it passes a predefined threshold.</p>
      <p id="Par27"><italic>Transcript selection</italic>. Candidate transcript models are represented as maximal paths in the global subexon graph, from a node with no incoming edges (source) to a node with no outgoing edges (sink). Since the graph generally encodes a much larger number of transcripts than is biologically possible, PsiCLASS identifies and selects a subset of transcripts that can explain all contiguity constraints from spliced reads and paired reads. PsiCLASS first predicts a set of transcripts for each sample, using a graph-based dynamic programming algorithm with the global subexon graph and the sample specific alignment data, then combines the individual samples’ transcript sets and selects a subset of meta-annotations by voting.</p>
      <p id="Par28">To predict a set of transcripts for each sample, PsiCLASS employs a SET_COVER framework and dynamic programming algorithms<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, adapted for subexon graphs. Namely, we define a constraint as a cluster of read alignments with the same subexon pattern. Like CLASS2, PsiCLASS uses constraints to decrease the memory usage while preserving the structural and contiguity information contained in the full set of reads. For a given graph <italic>G</italic>, let <italic>C</italic> = {<italic>c</italic><sub>1</sub><italic>, …, c</italic><sub><italic>m</italic></sub>} denote the set of constraints and <italic>T</italic> = {<italic>t</italic><sub>1</sub><italic>, …, t</italic><sub><italic>n</italic></sub>} the set of candidate transcripts, encoded in the graph. Given a constraint <italic>c</italic><sub><italic>i</italic></sub>, its abundance <italic>a</italic><sub><italic>i</italic></sub> = <italic>a</italic>(<italic>c</italic><sub><italic>i</italic></sub>) defined as the number of supporting reads (or read pairs) normalized by the number of possible start positions of the reads within the constraint’s subexons. To reduce the transcript selection problem to SET_COVER, we view each candidate transcript <italic>t</italic><sub><italic>j</italic></sub> as the set of constraints that are compatible with its exon-intron structure: <italic>C</italic>(<italic>t</italic><sub><italic>j</italic></sub>) = {<italic>c</italic><sub><italic>1</italic></sub><italic>, …,c</italic><sub><italic>nj</italic></sub>}, where <italic>c</italic><sub><italic>i</italic></sub><italic> ~ t</italic><sub><italic>j</italic></sub>. Constraint <italic>c</italic><sub><italic>i</italic></sub> is compatible with the transcript <italic>t</italic><sub><italic>j</italic></sub>’s exon-intron structure, denoted <italic>c</italic><sub><italic>i</italic></sub> ~ <italic>t</italic><sub><italic>j</italic></sub>, if its list of subexon intervals is contained in that of the transcript’s and all the exon–exon junctions correspond to introns in the transcript.</p>
      <p id="Par29">In the simplest formulation, the goal then is to select a minimal (parsimonious) subset of transcripts that satisfies all constraints. More realistically, to account for the different abundance of constraints, we define a transcript’s abundance as the minimum abundance among its set of constraints: <italic>A</italic><sub><italic>j</italic></sub> = <italic>min</italic> { <italic>a</italic><sub><italic>i</italic></sub><italic>| c</italic><sub><italic>i</italic></sub><italic> ~ t</italic><sub><italic>j</italic></sub> }. The goal then becomes to determine a subset of transcripts that most closely explain the constraints and their abundance levels. PsiCLASS uses a greedy approximation framework to address this problem, iteratively selecting the transcript that covers the largest number of constraints weighted by the constraints’ abundance, then adjusting the constraints’ abundance levels before the next iteration:</p>
      <p id="Par30">While ({nondepleted constraints} <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ne \, \emptyset$$\end{document}</tex-math><mml:math id="M36"><mml:mo>≠</mml:mo><mml:mspace width="0.25em"/><mml:mi>∅</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq18.gif"/></alternatives></inline-formula>):</p>
      <p id="Par31">Choose transcript <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \in T$$\end{document}</tex-math><mml:math id="M38"><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq19.gif"/></alternatives></inline-formula> that maximizes <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|C\left( t \right)|\left( {1 + \frac{{A_t}}{A}} \right)$$\end{document}</tex-math><mml:math id="M40"><mml:mo>∣</mml:mo><mml:mi>C</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>∣</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq20.gif"/></alternatives></inline-formula></p>
      <p id="Par32">Update the constraints’ abundance:</p>
      <p>
        <disp-formula id="Equa">
          <alternatives>
            <tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x = \mathop {{{\mathrm{min}}}}\limits_{c \in C(t)} \{ a\left( c \right)\}$$\end{document}</tex-math>
            <mml:math id="M42">
              <mml:mi>x</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:munder>
                <mml:mrow>
                  <mml:mi mathvariant="normal">min</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                  <mml:mo>∈</mml:mo>
                  <mml:mi>C</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:munder>
              <mml:mrow>
                <mml:mo>{</mml:mo>
                <mml:mrow>
                  <mml:mi>a</mml:mi>
                  <mml:mfenced close=")" open="(" separators="">
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                  </mml:mfenced>
                </mml:mrow>
                <mml:mo>}</mml:mo>
              </mml:mrow>
            </mml:math>
            <graphic xlink:href="41467_2019_12990_Article_Equa.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
        <disp-formula id="Equb">
          <alternatives>
            <tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{For}}\;{\mathrm{each}}\;c \in C\left( t \right)\!\! :$$\end{document}</tex-math>
            <mml:math id="M44">
              <mml:mi mathvariant="normal">For</mml:mi>
              <mml:mspace width="0.16em"/>
              <mml:mi mathvariant="normal">each</mml:mi>
              <mml:mspace width="0.16em"/>
              <mml:mi>c</mml:mi>
              <mml:mo>∈</mml:mo>
              <mml:mi>C</mml:mi>
              <mml:mfenced close=")" open="(" separators="">
                <mml:mrow>
                  <mml:mi>t</mml:mi>
                </mml:mrow>
              </mml:mfenced>
              <mml:mspace width="0.3em"/>
              <mml:mspace width="0.3em"/>
              <mml:mo>:</mml:mo>
            </mml:math>
            <graphic xlink:href="41467_2019_12990_Article_Equb.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
        <disp-formula id="Equc">
          <alternatives>
            <tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a\left( c \right) = a\left( c \right) - x$$\end{document}</tex-math>
            <mml:math id="M46">
              <mml:mi>a</mml:mi>
              <mml:mfenced close=")" open="(" separators="">
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:mi>a</mml:mi>
              <mml:mfenced close=")" open="(" separators="">
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>−</mml:mo>
              <mml:mi>x</mml:mi>
            </mml:math>
            <graphic xlink:href="41467_2019_12990_Article_Equc.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>if <inline-formula id="IEq21"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a\left( c \right) \le 0$$\end{document}</tex-math><mml:math id="M48"><mml:mi>a</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_12990_Article_IEq21.gif"/></alternatives></inline-formula>, mark constraint <italic>c</italic> as depleted.</p>
      <p id="Par33">PsiCLASS implements the procedure above in two steps. First, it determines the candidate set of transcripts <italic>T</italic>, using either enumeration (for graphs with &lt;200,000 transcripts) or a variation of the splice-graph dynamic programming algorithm in Song et al.<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> that considers all reads single-end, for fast processing. Once the candidate transcript set <italic>T</italic> is determined, PsiCLASS applies the greedy SET_COVER approximation algorithm above.</p>
      <p id="Par34">For completeness, we include a brief description of the dynamic programming optimization procedure. The algorithm considers all subpaths <italic>L</italic>, and recursively calculates the maximum number of constraints <italic>f</italic>(<italic>L</italic>) for substranscripts starting with subpath <italic>L</italic>: <italic>f</italic>(<italic>L</italic>) = max<sub><italic>L</italic>’</sub> { <italic>f</italic>(<italic>L</italic>′) + <italic>c</italic>(<italic>L, L</italic>′), if <italic>L</italic>′ exists; <italic>c</italic>(<italic>L</italic>), if <italic>L</italic>′does not exist }, where: (i) <italic>L</italic>′ is a subpath immediately following <italic>L</italic> so that all constraints compatible with <italic>L</italic> end before or within <italic>L</italic>′; (ii) <italic>c</italic>(<italic>L, L</italic>′) is the number of constraints starting in and (partially) compatible with <italic>L</italic> and <italic>L</italic>′, and compatible with the concatenated subpath <italic>L</italic>, <italic>L</italic>′; and (iii) <italic>c</italic>(<italic>L</italic>) is the number of constraints covered by subtranscript <italic>L</italic>. To take into account the abundance levels in the optimization process, at each sweep of the graph the algorithm excludes subpaths that cover constraints with abundance below a fixed value <italic>x</italic>; hence, the dynamic programming algorithm will return the best transcript with abundance greater than <italic>x</italic> (<italic>x</italic>-abundance transcript). With this modification, at each graph sweep the selection process selects an <italic>x</italic>-abundance transcript, starting with <italic>x</italic><sub>0</sub> = 0 (thus guaranteeing that such a transcript exists), and each selected transcript’s abundance value used as lower bound for the selection process at the following step: 0 <italic>=</italic> <italic>x</italic><sub>0</sub> <italic>&lt;</italic> <italic>x</italic><sub>1</sub> <italic>&lt;</italic> <italic>x</italic><sub>2</sub> <italic>&lt;</italic> ⋯<italic>x</italic><sub><italic>m</italic></sub>, until no transcript can be found. The optimal transcript then is among those selected by the sweeps. More details, along with proof of correctness for the algorithm, can be found in Song et al.<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>.</p>
      <p id="Par35"><italic>Selecting a global set of transcripts</italic>. PsiCLASS selects a set of meta-annotations from the individual samples’ sets of transcripts by voting. Each transcript is assigned a score equal to the transcript’s average estimated abundance across the samples (i.e., every sample has one vote, weighted by the transcript’s abundance level; default cutoff: 1.0). As different cutoff parameters values might work best for data with specific characteristics, the user can readily adjust or recalibrate the voting parameters postassembly, starting from the already computed sets of transcripts for the individual samples.</p>
    </sec>
    <sec id="Sec12">
      <title>Sequence data</title>
      <p id="Par36">We generated 25 RNA-seq samples, with ~85 million 100 bp paired-end reads, using the software Polyester<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> with the default gene and transcript distribution models and randomly sampling 10% of the transcripts (at 13,912 genes) from the human GENCODE v.27<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> gene annotations. Reads were aligned to the reference genome hg38 separately with Hisat2 v.2.0.5<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> and STAR v.2.5.3a<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. Chromosome 2 alignments were extracted and used in the assembly and evaluations. Human liver samples were obtained from the Stanley Medical Research Institute (SMRI) and previously sequenced by Dr. Sabunciyan’s lab. All ethical standards set forth by the Johns Hopkins University and local laws were complied with. The liver tissue was collected postmortem by the SMRI after obtaining consent from the family of the deceased. A detailed description of the consent procedure and the collection was published<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>. The project was reviewed by the Johns Hopkins University Institutional Review Board (IRB) and was given exempt status since only postmortem tissue was involved in the research. For sequencing, total RNA was isolated using the Qiagen RNeasy kit and libraries were constructed using the Illumina TruSeq Stranded Total RNA kit for Human/Mouse/Rat following the manufacturers recommended protocol. The resulting stranded, rRNA depleted liver libraries were sequenced on an Illumina HiSeq 2000 instrument. 667 RNA-seq samples from human lymphoblastoid cell lines part of the GEUVADIS population variation project were publicly available from ArrayExpress (accession: E-GEUV-6), and mouse hippocampus RNA-seq data were those reported in ref. <sup><xref ref-type="bibr" rid="CR23">23</xref></sup> and available from GenBank (ProjectID: PRJEB18790). Lastly, RNA-seq samples from six human tissues (frontal cortex, cortex, cerebellum, heart, liver, and lung) used in the heterogeneity study were downloaded from the dbGAP GTEx<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> repository. The lists of samples for each evaluation are included in the Source Data file.</p>
    </sec>
    <sec id="Sec13">
      <title>Performance evaluation</title>
      <p id="Par37">Once the reads were mapped to the genome, we used StringTie v.1.3.3.b and Scallop v.0.10.2 to assemble them into transcripts, for each individual sample. Transcript sets for all samples in an experiment were then merged with StringTie(ST)-merge and TACO v.0.7.3. For PsiCLASS v.1.0.1, reads were assembled simultaneously across all samples. To evaluate the accuracy of transcript assembly, we employed standard sensitivity (Sn) and precision (Pr) measures and evaluation criteria to assess the accuracy of transcript reconstructions by comparison to a gold reference, namely the set of simulated transcripts and the human GENCODE v.27 and mouse RefSeq gene annotations. A predicted transcript is deemed a true positive (TP) iff its intron chain fully matches that of a gold reference transcript. If N is the number of predicted transcripts, M be the number of ground truth transcripts, then Sn = TP/M and Pr = TP/N <sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. Performance metrics at the transcript, exon, and intron levels were calculated with the tool <italic>grader</italic> included in the PsiCLASS package, and at the gene level with the tool Cuffcompare (v.2.2.1). For gene content analyses, only transcripts that were a full match, contained or splice variant transcript (codes ‘=’, ‘c’, and ‘j’) of a reference gene were considered.</p>
    </sec>
    <sec id="Sec14">
      <title>Reporting summary</title>
      <p id="Par38">Further information on research design is available in the <xref rid="MOESM3" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec15">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2019_12990_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2019_12990_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2019_12990_MOESM3_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2019_12990_MOESM4_ESM.xlsx">
            <caption>
              <p>Source Data</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Peer review information</bold><italic>Nature Communications</italic> thanks the anonymous reviewer(s) for their contribution to the peer review of this work. Peer reviewer reports are available.</p>
    </fn>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> is available for this paper at 10.1038/s41467-019-12990-0.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Development and evaluations were performed on the Maryland Advanced Research Computing Center (MARCC). Work was supported in part by NSF grants ABI-1356078 and IOS-1339134 to L.F., and by NIH grants R01GM129085 and R01GM124531 to L.F. and Kathleen Burns. S.S. was supported by a grant from the Stanley Medical Research Institute.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>L.F. and L.S. conceived the project, L.S. developed the method, S.S. provided sequence data, and L.S., L.F., G.Y., and S.S. contributed to the evaluation. All authors wrote and approved the paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>Raw sequence data for the GEUVADIS project can be obtained from ArrayExpress (Accession:E-GEUV-6), mouse hippocampus data from GenBank (ProjectID:PRJEB18790), and alignments of simulated data from Zenodo (10.5281/zenodo.1407759). The liver data has been deposited in GenBank under accession <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA575230">PRJNA575230</ext-link>. In addition, the full set of evaluation results represented in Fig. <xref rid="MOESM4" ref-type="media">1</xref>, Tables <xref rid="MOESM4" ref-type="media">1</xref> and <xref rid="MOESM4" ref-type="media">2</xref>, and Supplementary Figs. <xref rid="MOESM4" ref-type="media">2</xref>, <xref rid="MOESM4" ref-type="media">4</xref>–<xref rid="MOESM4" ref-type="media">9</xref> are provided as a Source Data file, and scripts for performing the evaluation and links to the assembled transcripts can be obtained from the project site in GitHub. All other relevant data are available upon request.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>PsiCLASS is available under a GNU GPL license from <ext-link ext-link-type="uri" xlink:href="https://github.com/splicebox/PsiCLASS">https://github.com/splicebox/PsiCLASS</ext-link>.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par39">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>
        <source>Nat. Rev. Genet</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2484</pub-id>
        <pub-id pub-id-type="pmid">19015660</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Shai</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Frey</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Blencowe</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Deep surveying of alternative splicing complexity in the human transcriptome by high-throughput sequencing</article-title>
        <source>Nat. Genet</source>
        <year>2008</year>
        <volume>40</volume>
        <fpage>1413</fpage>
        <lpage>1415</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.259</pub-id>
        <pub-id pub-id-type="pmid">18978789</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Niknafs</surname>
            <given-names>YS</given-names>
          </name>
          <name>
            <surname>Pandian</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Chinnaiyan</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>MK</given-names>
          </name>
        </person-group>
        <article-title>TACO produces robust multisample transcriptome assemblies from RNA-seq</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>68</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4078</pub-id>
        <pub-id pub-id-type="pmid">27869815</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2009</year>
        <volume>28</volume>
        <fpage>511</fpage>
        <lpage>515</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1621</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>IsoLasso: a LASSO regression approach to RNA-Seq based transcriptome assembly</article-title>
        <source>J. Comput. Biol.</source>
        <year>2011</year>
        <volume>18</volume>
        <fpage>1693</fpage>
        <lpage>1707</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2011.0171</pub-id>
        <pub-id pub-id-type="pmid">21951053</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guttman</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ab initio reconstruction of cell type-specific transcriptomes in mouse reveals the conserved multi-exonic structure of lincRNAs</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>503</fpage>
        <lpage>510</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1633</pub-id>
        <pub-id pub-id-type="pmid">20436462</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tomescu</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Kuosmanen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rizzi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Makinen</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>A novel min-cost flow method for estimating transcript expression with RNA-Seq</article-title>
        <source>BMC Bioinform.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>S15</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-S5-S15</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Florea</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>CLASS: constrained transcript assembly of RNA-seq reads</article-title>
        <source>BMC Bioinforma.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>S14</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-S5-S14</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mezlini</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>iReckon: simultaneous isoform discovery and abundance estimation from RNA-seq data</article-title>
        <source>Genome Res</source>
        <year>2013</year>
        <volume>23</volume>
        <fpage>519</fpage>
        <lpage>529</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.142232.112</pub-id>
        <pub-id pub-id-type="pmid">23204306</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Canzar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Andreotti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Weese</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Klau</surname>
            <given-names>GW</given-names>
          </name>
        </person-group>
        <article-title>CIDANE: comprehensive isoform discovery and abundance estimation</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>16</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0865-0</pub-id>
        <pub-id pub-id-type="pmid">26831908</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bernard</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Jacob</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mairal</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vert</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Efficient RNA isoform identification and quantification from RNA-Seq data with network flows</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2447</fpage>
        <lpage>2455</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu317</pub-id>
        <pub-id pub-id-type="pmid">24813214</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sabunciyan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Florea</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>CLASS2: accurate and efficient splice variant annotation from RNA-seq reads</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>e98</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw158</pub-id>
        <pub-id pub-id-type="pmid">26975657</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pertea</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>StringTie enables improved reconstruction of a transcriptome from RNA-seq reads</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>290</fpage>
        <lpage>295</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3122</pub-id>
        <pub-id pub-id-type="pmid">25690850</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>TransComb: genome-guided transcriptome assembly via combing junctions in splicing graphs</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>213</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-1074-1</pub-id>
        <pub-id pub-id-type="pmid">27760567</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shao</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kingsford</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Accurate assembly of transcripts through phase-preserving graph decomposition</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>1167</fpage>
        <lpage>1169</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4020</pub-id>
        <pub-id pub-id-type="pmid">29131147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steijger</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assessment of transcript reconstruction methods for RNA-seq</article-title>
        <source>Nat. Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1177</fpage>
        <lpage>1184</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2714</pub-id>
        <pub-id pub-id-type="pmid">24185837</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>Y-Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CLIIQ: Accurate comparative detection and quantification of expressed isoforms in a population</article-title>
        <source>Algorithms Bioinform. LNCS</source>
        <year>2012</year>
        <volume>7534</volume>
        <fpage>178</fpage>
        <lpage>189</lpage>
        <pub-id pub-id-type="doi">10.1007/978-3-642-33122-0_14</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tasnim</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Accurate inference of isoforms from multiple sample RNA-Seq data</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>S15</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-16-S2-S15</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Behr</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MITIE: Simultaneous RNA-Seq-based transcript identification and quantification in multiple samples</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2529</fpage>
        <lpage>2538</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt442</pub-id>
        <pub-id pub-id-type="pmid">23980025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frazee</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
        </person-group>
        <article-title>Polyester: simulating RNA-seq datasets with differential transcript expression</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>2778</fpage>
        <lpage>2784</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv272</pub-id>
        <pub-id pub-id-type="pmid">25926345</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>HISAT: a fast spliced aligner with low memory requirements</article-title>
        <source>Nat. Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>357</fpage>
        <lpage>360</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3317</pub-id>
        <pub-id pub-id-type="pmid">25751142</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>29</volume>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id>
        <pub-id pub-id-type="pmid">23104886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Srivastava</surname>
            <given-names>PK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide analysis of differential RNA editing in epilepsy</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>440</fpage>
        <lpage>450</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.210740.116</pub-id>
        <pub-id pub-id-type="pmid">28250018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Consortium</surname>
            <given-names>GT</given-names>
          </name>
        </person-group>
        <article-title>Human genomics. The genotype-tissue expression (GTEx) pilot analysis: multitissue gene regulation in humans</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>348</volume>
        <fpage>648</fpage>
        <lpage>660</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1262110</pub-id>
        <pub-id pub-id-type="pmid">25954001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tomczak</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Czerwinska</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wiznerowicz</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The Cancer Genome Atlas (TCGA): an immeasurable source of knowledge</article-title>
        <source>Contemp. Oncol.</source>
        <year>2015</year>
        <volume>19</volume>
        <fpage>A68</fpage>
        <lpage>A77</lpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harrow</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GENCODE: the reference human genome annotation for The ENCODE Project</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>1760</fpage>
        <lpage>1774</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.135350.111</pub-id>
        <pub-id pub-id-type="pmid">22955987</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Torrey</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Webster</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Knable</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Johnston</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Yolken</surname>
            <given-names>RH</given-names>
          </name>
        </person-group>
        <article-title>The Stanley Foundation brain collection and neuropathology consortium</article-title>
        <source>Schizophr. Res.</source>
        <year>2000</year>
        <volume>44</volume>
        <fpage>151</fpage>
        <lpage>155</lpage>
        <pub-id pub-id-type="doi">10.1016/S0920-9964(99)00192-9</pub-id>
        <pub-id pub-id-type="pmid">10913747</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
