<?properties open_access?>
<?properties manuscript?>
<?origin nihpa?>
<?iso-abbr Nat. Biotechnol.?>
<?submitter-system nihms?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 1045?>
<?submitter-authority publisher?>
<?submitter-login nature-structure?>
<?submitter-name Nature Publishing Group (obsolete)?>
<?domain nihpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">9604648</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">20305</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Biotechnol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat. Biotechnol.</journal-id>
    <journal-title-group>
      <journal-title>Nature biotechnology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1087-0156</issn>
    <issn pub-type="epub">1546-1696</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3571712</article-id>
    <article-id pub-id-type="pmid">21572440</article-id>
    <article-id pub-id-type="doi">10.1038/nbt.1883</article-id>
    <article-id pub-id-type="manuscript">nihpa292662</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Trinity: reconstructing a full-length transcriptome without a genome from RNA-Seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Grabherr</surname>
          <given-names>Manfred G.</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref rid="FN2" ref-type="author-notes">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Haas</surname>
          <given-names>Brian J.</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref rid="FN2" ref-type="author-notes">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yassour</surname>
          <given-names>Moran</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref ref-type="aff" rid="A3">3</xref>
        <xref rid="FN2" ref-type="author-notes">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Levin</surname>
          <given-names>Joshua Z.</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thompson</surname>
          <given-names>Dawn A.</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Amit</surname>
          <given-names>Ido</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Adiconis</surname>
          <given-names>Xian</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fan</surname>
          <given-names>Lin</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Raychowdhury</surname>
          <given-names>Raktima</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zeng</surname>
          <given-names>Qiandong</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Zehua</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mauceli</surname>
          <given-names>Evan</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hacohen</surname>
          <given-names>Nir</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gnirke</surname>
          <given-names>Andreas</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rhind</surname>
          <given-names>Nicholas</given-names>
        </name>
        <xref ref-type="aff" rid="A4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>di Palma</surname>
          <given-names>Federica</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Birren</surname>
          <given-names>Bruce W.</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nusbaum</surname>
          <given-names>Chad</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lindblad-Toh</surname>
          <given-names>Kerstin</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Friedman</surname>
          <given-names>Nir</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref ref-type="aff" rid="A6">6</xref>
        <xref rid="FN3" ref-type="author-notes">‡</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Regev</surname>
          <given-names>Aviv</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A3">3</xref>
        <xref ref-type="aff" rid="A7">7</xref>
        <xref rid="FN3" ref-type="author-notes">‡</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label> Broad Institute of MIT and Harvard, 7 Cambridge Center, Cambridge MA, 02142, USA</aff>
    <aff id="A2"><label>2</label> School of Computer Science, Hebrew University, Jerusalem, 91904, Israel</aff>
    <aff id="A3"><label>3</label> Department of Biology, Massachusetts Institute of Technology, Cambridge MA, USA</aff>
    <aff id="A4"><label>4</label> Department of Biochemistry and Molecular Pharmacology, University of Massachusetts Medical School, Worcester MA 01605, USA</aff>
    <aff id="A5"><label>5</label> Science for Life Laboratory, Department of Medical Biochemistry and Microbiology, Uppsala University</aff>
    <aff id="A6"><label>6</label> Alexander Silberman Institute of Life Sciences, Hebrew University, Jerusalem, 91904, Israel</aff>
    <aff id="A7"><label>7</label> Howard Hughes Medical Institute, Department of Biology, Massachusetts Institute of Technology, Cambridge MA, 02140</aff>
    <author-notes>
      <corresp id="FN1">Correspondence and requests for materials should be addressed to <email>nir@cs.huji.ac.il</email> (NF), <email>aregev@broad.mit.edu</email> (AR)</corresp>
      <fn id="FN2" fn-type="equal">
        <label>*</label>
        <p>These authors contributed equally to this work and appear in alphabetical order</p>
      </fn>
      <fn id="FN3" fn-type="equal">
        <label>‡</label>
        <p>These authors contributed equally to this work</p>
      </fn>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>29</day>
      <month>4</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>5</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>2</month>
      <year>2013</year>
    </pub-date>
    <volume>29</volume>
    <issue>7</issue>
    <fpage>644</fpage>
    <lpage>652</lpage>
    <!--elocation-id from pubmed: 10.1038/nbt.1883-->
    <permissions>
      <license>
        <license-p>Users may view, print, copy, download and text and data- mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use: <ext-link ext-link-type="uri" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</ext-link></license-p>
      </license>
    </permissions>
    <abstract>
      <p id="P1">Massively-parallel cDNA sequencing has opened the way to deep and efficient probing of transcriptomes. Current approaches for transcript reconstruction from such data often rely on aligning reads to a reference genome, and are thus unsuitable for samples with a partial or missing reference genome. Here, we present the <italic>Trinity</italic> methodology for <italic>de novo</italic> full-length transcriptome reconstruction, and evaluate it on samples from fission yeast, mouse, and whitefly – an insect whose genome has not yet been sequenced. Trinity fully reconstructs a large fraction of the transcripts present in the data, also reporting alternative splice isoforms and transcripts from recently duplicated genes. In all cases, Trinity performs better than other available <italic>de novo</italic> transcriptome assembly programs, and its sensitivity is comparable to methods relying on genome alignments. Our approach provides a unified and general solution for transcriptome reconstruction in any sample, especially in the complete absence of a reference genome.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="S1">
    <title>Introduction</title>
    <p id="P2">Recent advances in massively-parallel cDNA sequencing (RNA-Seq) provide a cost-effective way to obtain large amounts of transcriptome data from many organisms and tissue types<sup><xref rid="R1" ref-type="bibr">1</xref>, <xref rid="R2" ref-type="bibr">2</xref></sup>. In principle, such data can allow us to identify all expressed transcripts<sup><xref rid="R3" ref-type="bibr">3</xref></sup>, as complete and contiguous mRNA sequence from the transcription start site to the transcription end, for multiple alternatively spliced isoforms.</p>
    <p id="P3">However, reconstruction of all full-length transcripts from short reads with considerable sequencing error rates poses substantial computational challenges<sup><xref rid="R4" ref-type="bibr">4</xref></sup>: (<bold>1</bold>) some transcripts have low coverage, whereas others are highly expressed; (<bold>2</bold>) read coverage may be uneven across the transcript’s length, due to sequencing biases; (<bold>3</bold>) reads with sequencing errors derived from a highly expressed transcript may be more abundant than correct reads from a lowly expressed transcript; (<bold>4</bold>) transcripts encoded by adjacent loci can overlap and thus can be erroneously fused to form a chimeric transcript; (<bold>5</bold>) data structures need to accommodate multiple transcripts per locus, due to alternative splicing; and (<bold>6</bold>) sequences that are repeated in different genes introduce ambiguity. A successful method should address each challenge, be applicable to both complex mammalian genomes and gene-dense microbial genomes, and be able to reconstruct transcripts of variable sizes, expression levels and protein-coding capacity.</p>
    <p id="P4">There are two alternative computational strategies for transcriptome reconstruction<sup><xref rid="R4" ref-type="bibr">4</xref></sup>. (<bold>1</bold>) ‘Mapping first’ approaches<sup><xref rid="R5" ref-type="bibr">5</xref></sup>, such as Scripture<sup><xref rid="R3" ref-type="bibr">3</xref></sup> or Cufflinks<sup><xref rid="R2" ref-type="bibr">2</xref></sup>, first align all the reads to a reference (unannotated) genome and then merge sequences with overlapping alignment, spanning splice junctions with reads and paired-ends. (<bold>2</bold>) ‘Assembly first’ (<italic>de novo</italic>) methods, such as ABySS<sup><xref rid="R1" ref-type="bibr">1</xref></sup>, SOAPdenovo<sup><xref rid="R6" ref-type="bibr">6</xref></sup> or Oases (E. Birney, personal communication), use the reads to assemble transcripts directly, which can subsequently be mapped to a reference genome, if available. ‘Mapping-first’ approaches promise, in principle, maximum sensitivity, but depend on correct read-to-reference alignment, a task that is complicated by splicing, sequencing errors, and the lack or incompleteness of many reference genomes. Conversely, ‘assembly first’ approaches do not require any read-reference alignments, important when the genomic sequence is not available, is gapped, highly fragmented, or substantially altered, as in cancer cells.</p>
    <p id="P5">Successful ‘mapping first’ methods were developed in the past year<sup><xref rid="R4" ref-type="bibr">4</xref></sup>, but substantially less progress was made to date in developing effective ‘assembly first’ approaches. As the number of reads grows, it is increasingly difficult to determine which reads should be joined into contiguous sequence <italic>contigs</italic>. An elegant computational solution is provided by the de Bruijn graph<sup><xref rid="R7" ref-type="bibr">7</xref>, <xref rid="R8" ref-type="bibr">8</xref></sup>, the basis for several whole-genome assembly programs<sup><xref rid="R9" ref-type="bibr">9</xref>–<xref rid="R11" ref-type="bibr">11</xref></sup>. In this graph, a <italic>node</italic> is defined by a sequence of a fixed length of <italic>k</italic> nucleotides (“<italic>k</italic>-mer”, with <italic>k</italic> considerably shorter than the read length), and nodes are connected by <italic>edges</italic>, if they perfectly overlap by <italic>k</italic>-1 nucleotides, and the sequence data supports this connection. This compact representation allows for enumerating all possible solutions by which linear sequences can be reconstructed given overlaps of <italic>k</italic>-1. For transcriptome assembly, each path in the graph represents a possible transcript. A scoring scheme applied to the graph structure can rely on the original read sequences and mate-pair information to discard nonsensical solutions (transcripts) and compute all plausible ones.</p>
    <p id="P6">Three critical tasks remain open to date when applying the scheme of de Bruijn graphs to <italic>de novo</italic> assembly of RNA-Seq data: (<bold>1</bold>) efficiently constructing this graph from large amounts (billions of base pairs) of raw data; (<bold>2</bold>) defining a suitable scoring and enumeration algorithm to recover all plausible splice forms and paralogous transcripts; and (<bold>3</bold>) providing robustness to the noise stemming from sequencing errors and other artifacts in the data. In particular, sequencing errors would introduce a large number of false nodes, resulting in a massive graph with millions of possible (albeit mostly implausible) paths.</p>
    <p id="P7">Here, we present <italic>Trinity</italic>, a novel method for the efficient and robust <italic>de novo</italic> reconstruction of transcriptomes, consisting of three software modules: <italic>Inchworm, Chrysalis,</italic> and <italic>Butterfly</italic>, applied sequentially to process large volumes of RNA-Seq reads. We evaluated Trinity on data from two well-annotated species – one microorganism (fission yeast) and one mammal (mouse) – as well as an insect (the whitefly <italic>Bemisia tabaci</italic>), whose genome has not yet been sequenced. In each case, Trinity recovers most of the reference (annotated) expressed transcripts as full-length sequences, and resolves alternative isoforms and duplicated genes, performing better than other available transcriptome <italic>de novo</italic> assembly tools, and comparably to methods relying on genome alignments.</p>
  </sec>
  <sec sec-type="results" id="S2">
    <title>RESULTS</title>
    <sec id="S3" sec-type="methods">
      <title>Trinity: a method for <italic>de novo</italic> transcriptome assembly</title>
      <p id="P8">Trinity is a modular method and software package, combining three components (<xref rid="F1" ref-type="fig">Fig. 1</xref>): <italic>Inchworm</italic>, <italic>Chrysalis</italic> and <italic>Butterfly</italic>. In contrast to <italic>de novo</italic> assembly of a <italic>genome</italic>, where few large connected sequence graphs can represent connectivities among reads across entire chromosomes, in assembling transcriptome data we expect to encounter numerous individual disconnected graphs, each representing the transcriptional complexity at non-overlapping loci. Accordingly, Trinity partitions the sequence data into these many individual graphs, and then processes each graph independently to extract full-length isoforms and tease apart transcripts derived from paralogous genes.</p>
      <p id="P9">In the first step, Inchworm assembles reads into the unique sequences of transcripts. Inchworm (<xref rid="F1" ref-type="fig">Fig. 1a</xref>) uses a greedy k-mer based approach for fast and efficient transcript assembly, recovering only a single (best) representative for a set of alternative variants that share k-mers (due to alternative splicing, gene duplication, or allelic variation). Next, Chrysalis (<xref rid="F1" ref-type="fig">Fig. 1b</xref>) clusters related contigs that correspond to portions of alternatively-spliced transcripts or otherwise unique portions of paralogous genes. Chrysalis then constructs a de Bruijn graph for each cluster of related contigs, each reflecting the complexity of overlaps between variants. Finally, Butterfly (<xref rid="F1" ref-type="fig">Fig. 1c</xref>) analyzes the paths taken by reads and read pairings in the context of the corresponding de Bruijn graph and reports all plausible transcript sequences, resolving alternatively spliced isoforms and transcripts derived from paralogous genes. Below, we describe each of Trinity’s modules.</p>
    </sec>
    <sec id="S4">
      <title>Inchworm assembles contigs greedily and efficiently</title>
      <p id="P10">Inchworm efficiently reconstructs linear transcript contigs in six steps (<bold>Methods,</bold>
<xref rid="F1" ref-type="fig">Fig. 1a</xref>). Inchworm (<bold>1</bold>) constructs a k-mer dictionary from all sequence reads (in practice, k=25); (<bold>2</bold>) removes likely error-containing k-mers from the k-mer dictionary; (<bold>3</bold>) selects the most frequent k-mer in the dictionary to seed a contig assembly, excluding both low-complexity and singleton k-mers; (<bold>4</bold>) extends the seed in each direction by finding the highest occurring k-mer with a k-1 overlap with the current contig terminus and concatenating its terminal base to the growing contig sequence (once a k-mer has been used for extension, it is removed from the dictionary); (<bold>5</bold>) extends the sequence in either direction until it cannot be extended further, then reporting the linear contig; (<bold>6</bold>) repeats steps 3–5 starting with the next most highly abundant k-mer, until the entire k-mer dictionary has been exhausted.</p>
      <p id="P11">Inchworm does not capture the full complexity of the transcriptome; for example, only one alternatively spliced variant can be reported at full length per locus, with partial sequences reported for unique regions of any alternatively spliced transcripts. However, its contigs do maintain the information required by subsequent Trinity components to reconstruct and search the entire graph containing <bold>all</bold> possible sequences. Indeed, these contigs provide a complete representation of the sequence-overlap-based de Bruijn graph, with each k-mer being unique in the set, and the k-1 sub-sequences implicitly defining the edges in the graph. This approach is much more efficient than computing a full graph from all reads at once, and it quickly provides a meaningful intermediate output of the strong-supported contigs.</p>
    </sec>
    <sec id="S5">
      <title>Chrysalis builds de Bruijn transcript graphs</title>
      <p id="P12">Chrysalis clusters minimally-overlapping Inchworm contigs into sets of connected components, and constructs complete de Bruijn graphs for each component (<xref rid="F1" ref-type="fig">Fig. 1b</xref>, <bold>Methods</bold>). Each component defines a collection of inchworm contigs that are likely to be derived from alternative splice forms or closely-related paralogs. Chrysalis works in three phases (<bold>Methods</bold>). (<bold>1</bold>) It recursively groups inchworm contigs into connected components. Contigs are grouped if there is a perfect overlap of k-1 bases between them and if there is a minimal number of reads that span the junction across both contigs with a (k-1)/2 bases match on each side of the (k-1)-mer junction. (<bold>2</bold>) It builds a de Bruijn graph for each component using a word size of <italic>k</italic>-1 to represent nodes, and <italic>k</italic> to define the edges connecting the nodes. It weights each edge of the de Bruijn graph with the number of (k-1)-mers in the original read set that support it. (<bold>3</bold>) It assigns each read to the component with which it shares the largest number of k-mers, and determines the regions within each read that contribute k-mers to the component.</p>
    </sec>
    <sec id="S6">
      <title>Butterfly resolves alternatively spliced and paralogous transcripts</title>
      <p id="P13">Butterfly reconstructs plausible full-length, linear transcripts by reconciling the individual de Bruijn graphs generated by Chrysalis with the original reads and paired-ends. It reconstructs distinct transcripts for splice isoforms and paralogous genes, and resolves ambiguities stemming from errors or from sequences of length greater than <italic>k</italic> bases that are shared between transcripts.</p>
      <p id="P14">Butterfly consists of two parts (<xref rid="F1" ref-type="fig">Fig. 1c</xref>, <bold>Methods</bold>). During <italic>graph simplification</italic>, Butterfly iterates between (<bold>1</bold>) merging consecutive nodes in linear paths in the de Bruijn graph to form nodes that represent longer sequences; and (<bold>2</bold>) pruning edges that represent minor deviations (supported by comparatively few reads), which likely correspond to sequencing errors. Diploid polymorphisms are expected to be more frequent than sequencing errors and will likely be maintained. In <italic>plausible path scoring</italic>, Butterfly identifies those paths that are supported by actual reads and read pairs, using a dynamic programming procedure that traverses potential paths in the graph while maintaining the reads (and pairs) that support them (<bold>Methods</bold>). Since reads and sequence fragments (paired reads) are typically much longer than <italic>k</italic>, they can resolve ambiguities and reduce the combinatorial number of paths to a much smaller number of actual <italic>transcripts</italic>, enumerated as linear sequences.</p>
    </sec>
    <sec id="S7">
      <title>RNA-Seq of <italic>Schizosaccharomyces pombe</italic></title>
      <p id="P15">We first generated RNA-Seq data from the fission yeast <italic>Schizosaccharomyces pombe</italic>. The <italic>S. pombe</italic> transcriptome<sup><xref rid="R12" ref-type="bibr">12</xref></sup> has relatively substantial splicing for a eukaryotic microorganism, with short introns (mean intron length = 80.6 bp) and dense transcripts (mean intergenic region = 938 bp based on coding genes only). To maximize transcript coverage, we pooled ~154 million pairs of strand-specific<sup><xref rid="R13" ref-type="bibr">13</xref>, <xref rid="R14" ref-type="bibr">14</xref></sup> 76 base Illumina read sequences from four biological conditions: mid-log growth, growth as all glucose has been consumed, late stationary phase, and heat shock (<bold>Methods,</bold>
<sup><xref rid="R15" ref-type="bibr">15</xref></sup>).</p>
    </sec>
    <sec id="S8">
      <title>Sensitivity limit for full-length reconstruction</title>
      <p id="P16">We next estimated the upper limit for which annotated transcripts can possibly be perfectly reconstructed given a particular dataset of sequences. Any <italic>k</italic>-mer-based assembly approach is limited to those sequences that are represented by the exact <italic>k</italic>-mer composition of the RNA-Seq read set. To determine this empirical upper sensitivity limit (“Oracle Set”), we built a <italic>k</italic>-mer dictionary from all the reads and identified all known reference protein-coding sequences (CDS) that are “reconstructable to full length (FL) given the read set”, as those sequences that can be populated by adjacent and overlapping k-mers across their entire length. Since this Oracle set also contains transcript sequences that are covered by <italic>k-mers</italic>, but not entire <italic>reads</italic>, some transcripts will appear reconstructable but are not. Conversely, the Oracle set reflects only annotated <italic>known</italic> genes and <italic>known</italic> isoforms, which are likely an underestimate, especially in mammals<sup><xref rid="R16" ref-type="bibr">16</xref></sup>. Nevertheless, the Oracle set provides a useful sensitivity benchmark.</p>
      <p id="P17">In the <italic>S. pombe</italic> data set, nearly all (91%, 4600/5064) reference CDS sequences exist in the Oracle Set (25-mer dictionary, 154M paired-reads), since almost all encoded transcripts (98%) are expressed in the measured conditions (&gt;= 0.5 Fragments Per transcript Kilobase per Million fragments mapped (FPKM)), consistent with previous studies in yeasts<sup><xref rid="R5" ref-type="bibr">5</xref>, <xref rid="R17" ref-type="bibr">17</xref>, <xref rid="R18" ref-type="bibr">18</xref></sup>. When reducing the coverage by random sub-sampling, the size of the Oracle Set is saturated at 50M paired reads (4494/5064, <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 1</xref> online), which we chose as our subsequent benchmarking set.</p>
    </sec>
    <sec id="S9">
      <title>Trinity recovered most <italic>S. pombe</italic> transcripts</title>
      <p id="P18">From the 50M pairs of reads, Trinity fully reconstructed 86% of annotated transcripts (4338/5064, <xref rid="SD1" ref-type="supplementary-material">Supplementary Table 1</xref> online) at full length, including 94% of the stringently-defined oracle transcripts (4218/4494). Of the 276 oracle transcripts not fully reconstructed, 90 (33%) are reconstructed over at least 90% of their length, and 177 (64%) are reconstructed over at least 50% of their length.</p>
      <p id="P19">Overall, Trinity generated 27,841 linear contigs longer than 100 bases, grouped into 23,232 components (<xref rid="SD1" ref-type="supplementary-material">Supplementary Note</xref> online). Only 2,454 of the 27,841 Trinity contigs did not align to the genome using GMAP<sup><xref rid="R19" ref-type="bibr">19</xref></sup>. Of those, 30% match a Uniref90<sup><xref rid="R20" ref-type="bibr">20</xref></sup> protein (BLASTX E&lt;=1e-10), almost invariably (90%) a <italic>Schizosaccharomyces</italic> protein, and likely reflect assemblies with error-rich reads.</p>
      <p id="P20">Trinity reconstructs full-length transcripts across a broad range of expression levels and sequencing depths (<xref rid="F2" ref-type="fig">Fig. 2a</xref>). For example, it accurately captured the full-length transcript of 71% of genes from the second quintile (5–10%), and 81–95% full-length coverage of annotated transcripts in the remaining quintiles. Considering both full-length and partial reconstructions, Trinity reconstructed a large fraction of the bases in each transcript (<xref rid="F2" ref-type="fig">Fig. 2b</xref>).</p>
      <p id="P21">In many cases, Trinity accurately resolved the sequences of closely-related paralogous transcripts. Out of 77 gene families containing 185 paralogs<sup><xref rid="R21" ref-type="bibr">21</xref></sup>, Trinity recovered at full length all members of 33 families (68 genes), at least one member from an additional 33 families (46 genes found, 45 genes missing), and missed all 26 genes in the remaining 11 families, often involving lowly expressed genes. Some of the most highly expressed transcripts in <italic>S. pombe</italic> are derived from paralogous genes with very similar sequences (<italic>e.g.</italic>, those encoding ribosomal proteins<sup><xref rid="R21" ref-type="bibr">21</xref></sup>), yet were resolved by Trinity.</p>
    </sec>
    <sec id="S10">
      <title>Extended UTRs and long anti-sense in <italic>S. pombe</italic></title>
      <p id="P22">Compared to the existing annotation, Trinity extended the 5′UTR of 312 transcripts (median extension = 80bp; average = 176bp), and the 3′UTR of 543 transcripts (median = 72bp; average = 172bp) (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 2a,b</xref> online). It also found 3,726 previously unannotated 5′ UTRs (median length 183bp, average length = 288bp), and 3,416 3′ UTRs (median length = 272bp, average length = 397bp).</p>
      <p id="P23">Trinity identified 2319 transcripts at 1235 intergenic loci as novel transcribed sequences (<xref rid="F3" ref-type="fig">Fig. 3a</xref>, <bold>Methods</bold>) and 612 long antisense transcripts that covered more than 75% of the length of the corresponding sense transcript (<xref rid="F3" ref-type="fig">Fig. 3b</xref>), and were not likely to be derived from extended transcription of a neighboring gene. 113 of the intergenic transcripts and 612 long antisense transcripts were multiexonic. Although both were more lowly expressed on average than annotated protein-coding genes (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 3</xref> online), 49 long antisense transcripts (at 35 loci) were at least 5-fold more highly expressed than the corresponding sense coding transcript (<italic>e.g.</italic>, an antisense transcript to the meiotic gene Mug27/Slk1 (SPCC417.06c) was &gt;100-fold more highly expressed, <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 4</xref> online). This supports a role for antisense transcriptional regulation in meiosis for <italic>S. pombe</italic><sup><xref rid="R15" ref-type="bibr">15</xref>, <xref rid="R22" ref-type="bibr">22</xref>–<xref rid="R24" ref-type="bibr">24</xref></sup>, and is consistent with previous findings in <italic>S. cerevisiae</italic><sup><xref rid="R25" ref-type="bibr">25</xref></sup>.</p>
    </sec>
    <sec id="S11">
      <title>Trinity recovered most expressed annotated mouse transcripts</title>
      <p id="P24">Compared to yeasts, mammalian transcriptomes exhibit substantially more complex patterns of alternative splicing<sup><xref rid="R26" ref-type="bibr">26</xref></sup>. To test Trinity’s ability to identify different isoforms, we sequenced ~52.6 million 76b read pairs from C567BL/6 mouse primary immune dendritic cells (DCs). Unlike in <italic>S. pombe</italic>, only 54% of known mouse genes (10,724) were identified as expressed (&gt;= 0.5 FPKM), and of those, the Oracle set determined 8,358 to be full-length reconstructable (727 loci have two or more isoforms variable in the CDS, totaling 9,258 transcripts).</p>
      <p id="P25">Trinity reported 48,497 contigs longer than 350bp, capturing 8,185 transcripts to full-length (<xref rid="SD1" ref-type="supplementary-material">Supplementary Table 2, Supplementary Note</xref> online), corresponding to 7,749 loci (including 7947 (86%) transcripts at 7573 (91%) loci in the mouse Oracle set). The percentage of transcripts recovered to full-length and the fraction of length captured were high across a broad range of expression levels (<xref rid="F2" ref-type="fig">Fig. 2c,d</xref>).</p>
      <p id="P26">Trinity resolved splice isoforms and gene paralogs in a manner consistent with the mouse Oracle set. Trinity found 872 full length, alternatively spliced, isoforms from 385 loci (53% of the loci with alternatively spliced variants in the Oracle set), and matched the full-length transcripts for 463 (61.6%) of 752 paralogous transcripts in the Oracle set (&gt; 70% identity between paralogs, Methods, <xref rid="F4" ref-type="fig">Fig. 4</xref>).</p>
      <p id="P27">Trinity extended the annotated 5′UTR for 5,265 transcripts (5,036 loci, median length = 43, average = 91, <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 2c</xref> online), and included one or more additional 5′UTR exons in 305 cases (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 5</xref> online). It extended the 3′UTR in 2918 transcripts (2819 loci, median length = 20, average = 248, <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 2d</xref> online), adding 3′UTR exons in 62 cases (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 2b</xref> online). UTR length differences were often due to alternative splicing events restricted to the UTR.</p>
    </sec>
    <sec id="S12">
      <title>High sequence fidelity of reconstructed transcripts</title>
      <p id="P28">We measured the assembled transcript base error rate by aligning the full-length transcripts to the corresponding reference genome (using BLAT), and capturing mismatches, insertions, and deletions from the highest scoring alignment (<xref rid="SD1" ref-type="supplementary-material">Supplementary Table 3</xref> online). In fission yeast, rates of mismatches, insertions, and deletions are each less than 1 in 10,000. In mouse, rates were approximately twice as high, reflecting the lesser transcript fold-coverage. Since the raw read error rate is ~1%, Trinity thus resolved ~99% of sequencing errors.</p>
    </sec>
    <sec id="S13" sec-type="methods">
      <title>Comparing Trinity’s performance to other methods</title>
      <p id="P29">We compared Trinity’s performance to that of other assemblers by several measures. First, we examined the number of reference transcripts reconstructed to full-length by each method (‘sensitivity’). In <italic>S. pombe</italic>, Trinity out-performed the <italic>de novo</italic> sequence assemblers, ABySS<sup><xref rid="R1" ref-type="bibr">1</xref></sup>, Trans-ABySS<sup><xref rid="R27" ref-type="bibr">27</xref></sup> and SOAPdenovo<sup><xref rid="R6" ref-type="bibr">6</xref></sup>, as well as the ‘mapping first’ programs Scripture<sup><xref rid="R3" ref-type="bibr">3</xref></sup> and Cufflinks<sup><xref rid="R2" ref-type="bibr">2</xref></sup> (<xref rid="F5" ref-type="fig">Fig. 5a</xref>). Trinity performed well across a range of 10M to the full 150M input sequence reads, while the alternative methods tended to peak at ~50M pairs or smaller inputs (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 6a</xref> online). In mouse (RefSeq annotation set, <xref rid="F5" ref-type="fig">Fig. 5b</xref>), Trinity (8185 transcripts, 7749 genes) outperformed the other <italic>de novo</italic> assembly methods ABySS (5561, 5500), Trans-ABySS (7025, 6598) and SOAPdenovo (761, 760), with the mapping-first programs Cufflinks (9010, 8536) and Scripture (9086, 8293) exhibiting better sensitivity. Furthermore, Trinity and Cufflinks appear best-tuned in their sensitivity across the broadest range of expression levels (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 7</xref> online). Unlike Trinity, several of the <italic>de novo</italic> methods did not perform well in fully reconstructing transcripts within the <bold>highest</bold> expression quintiles (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 7</xref> online).</p>
      <p id="P30">Second, we assessed the accuracy of splice pattern detection by examining individual introns and the combinations of introns (‘splicing patterns’) defined by mapping <bold>all</bold> the reconstructed transcripts (annotated or not) back to the reference genome (<xref rid="F5" ref-type="fig">Fig. 5c–f</xref>, <bold>Methods</bold>). We compared the number of annotated reference introns (or splicing patterns) captured by each method, and the number of previously unannotated introns (or extended splicing patterns). Unannotated introns or splice patterns captured by more than one method are less likely to be false positives. In <italic>S. pombe</italic>, Trinity identified the largest number of reference introns (4,543) (<xref rid="F5" ref-type="fig">Fig. 5c</xref>) and 1,582 unannotated introns, most of which are in putative, unannotated UTRs. 1,174 of these (74%) are also identified by at least one other method and thus are more likely genuine. Trinity also identifies the largest number of annotated splicing patterns in <italic>S. pombe</italic> (<xref rid="F5" ref-type="fig">Fig. 5e</xref>). The large numbers of falsely-fused <italic>S. pombe</italic> transcripts reported by the alternative methods contributes to their lack of sensitivity.</p>
      <p id="P31">In mouse, most methods had comparably high sensitivity for detecting individual annotated introns (<xref rid="F5" ref-type="fig">Fig. 5d</xref>), but varied in detecting complete splicing patterns (<xref rid="F5" ref-type="fig">Fig. 5f</xref>). Scripture identifies the most annotated splicing patterns (7,274), closely followed by Trinity (7,127). However, Scripture reports over 110,000 unique splicing patterns, ~10-fold more than Trinity and all other methods (each less than 10,000 unique patterns), suggesting many false positives in Scripture, and excellent precision in Trinity. Overall, relatively few of the non-annotated splicing patterns predicted by each method are supported by at least one other method (18–25%, except Scripture (2%) and ABySS (66%)).</p>
      <p id="P32">Finally, we examined the number of distinct contigs that mapped to each reference genomic locus, as well as the coverage (tiers) of reconstructed transcripts per locus. This accounts for multiple reported transcripts that represent the same region of a locus, for example due to alternative splicing, captured allelic variation, or enumerating transcripts with otherwise undetected sequencing errors. In <italic>S. pombe</italic>, Trinity reports 7,057 transcripts that map to 4,874 genes with an average coverage of 1.37 tiers per gene, similar to the alternative methods except Scripture (4.37 tiers per gene) and trans-ABySS (5.08 tiers per gene). Similarly, in mouse, Trinity performs comparably well to all other methods (31,706 contigs map to 11,334 genes, 2.05 tiers per gene on average), except trans-ABySS (111,000 contigs, 10,685 genes, 5.93 tiers). The large numbers of trans-ABySS transcripts covering similar regions of loci is <bold>not</bold> reflected in the number of distinct splicing patterns, indicating that multiple similar transcript sequences are being generated at individual loci, rather than many different splice isoforms. ABySS alone, although lacking the higher sensitivity of trans-ABySS, reports a smaller number of contigs (~1 transcript tiers per locus).</p>
    </sec>
    <sec id="S14">
      <title><italic>De novo</italic> assembly of the whitefly transcriptome</title>
      <p id="P33">In the absence of a sequenced genome, <italic>de novo</italic> assembly of RNA-Seq is the only viable option to study the transcriptomes of most organisms to date. For example, although the highly diverse class <italic>Insecta</italic> contains several key model organisms, it is not densely covered by high quality draft genome sequences. In addition, insect transcriptomes exhibit complex alternative splicing patterns<sup><xref rid="R28" ref-type="bibr">28</xref></sup>. The whitefly <italic>B. tabaci</italic> is one such example, for which the genome was not sequenced, and where RNA-Seq samples are genetically polymorphic, since they are derived from a mixture of individuals from an outbred population<sup><xref rid="R28" ref-type="bibr">28</xref></sup>.</p>
      <p id="P34">We applied Trinity to a published RNA-Seq dataset from whitefly, consisting of ~21.9 million pairs of 76 base Illumina reads, sequenced using conventional non-strand-specific methods<sup><xref rid="R29" ref-type="bibr">29</xref></sup>. Trinity produced 196,000 transcripts, 14,522 longer than 1,000 base pairs, capturing allelic variants (<italic>e.g.</italic>, <xref rid="F6" ref-type="fig">Fig. 6a</xref>). Of those, 4,323 had top blastx matches (E &lt;= 1<sup>−10</sup>) to 2,880 unique Uniref90<sup><xref rid="R20" ref-type="bibr">20</xref></sup> protein sequences, along at least 80% of the corresponding homologous protein sequence. This number of approximately full-length Trinity-assembled transcripts is substantially higher than achieved by other <italic>de novo</italic> assemblers (<xref rid="F6" ref-type="fig">Fig. 6c</xref>).</p>
      <p id="P35">To assess the extent to which alternative splice forms are captured by the Trinity assembly, we self-aligned all contigs within individual graph components, requiring at least one alternative internal exon of minimum length 21 bp and a multiple of 3. By this definition, 325 components contain at least two different isoforms. One such example (<xref rid="F6" ref-type="fig">Fig. 6b</xref>), is a highly conserved ortholog to an ELAV-like protein in the ant <italic>Harpegnathos saltator</italic>, which is present as two different isoforms involving inclusion of two different alternatively-spliced exons.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="S15">
    <title>DISCUSSION</title>
    <p id="P36">We presented Trinity, a method for <italic>de novo</italic> reconstruction of the majority of full-length transcripts in a sample from RNA-Seq reads directly, across a broad range of expression levels. Trinity resolved ~99% of the initial sequencing errors, determined splice isoforms, distinguished transcripts from recently duplicated, and identified allelic variants.</p>
    <p id="P37">Trinity’s transcripts substantially enhance our annotation of the mouse and fission yeast transcriptomes. In yeast, we identified a large number of UTR extensions, antisense transcripts, and novel intergenic transcripts. In mouse, we identified many novel transcripts and novel exons for reference transcripts. Trinity reconstructed many full-length transcripts from the whitefly transcriptome in the presence of substantial polymorphisms, as well as alternatively spliced variants.</p>
    <p id="P38">Paired-reads are important to increase the distance at which Trinity can resolve ambiguities. For example, a component representing two paralogous genes (<italic>e.g.</italic>, <xref rid="F4" ref-type="fig">Fig. 4</xref>) or alternative isoforms can have an enormous number of possible paths, but often only very few of them represent real transcripts. Read pairs, representing longer fragments allow us to resolve differences (<italic>e.g.</italic>, two pairs of SNPs, or two different exons) that occur at that distance or below. At longer distances, there is no physical unit to support alternative paths, although similarity in expression levels could be used in the future, as well as longer reads and fragments from improved high-throughput sequencing technologies.</p>
    <p id="P39">Evaluating the performance of transcript assemblers introduces several challenges, mostly since many transcripts, especially alternative isoforms, are not thoroughly defined as part of genome annotations. To address these challenges we used several complementary benchmarks. Our Oracle Set allowed us to assess sensitivity, by defining a ‘gold standard’ of expressed annotated transcripts present at full length. To assess our ability to reconstruct other reference transcripts, we considered the number of reference loci to which reconstructed transcripts map, and the coverage (tiers) of reconstructed transcripts per locus. Finally, we assessed precision by considering <bold>all</bold> the reconstructed transcripts and the number of ‘correct’ intron boundaries and splice patterns. Each measure represents a useful benchmark, and showed that Trinity performs better than other <italic>de novo</italic> methods and comparably well to mapping-first methods depending on the organism.</p>
    <p id="P40">Trinity is important for both genome annotation and the study of non-model organisms. For example, all but two vertebrate genomes are only available as unfinished “drafts”, containing sequence gaps, scaffolds that cannot be anchored to chromosomes, and assembly errors<sup><xref rid="R30" ref-type="bibr">30</xref></sup>, each negatively impacting genome annotation and read mapping. We expect that new genomes, assembled from next-generation high-throughput sequencing data, will be even more fragmented. Thus, high-quality <italic>de novo</italic> transcriptome reconstruction, as implemented in Trinity, featuring low base error rates and the ability to capture multiple isoforms, will prove crucial to maintain acceptable levels of accuracy when characterizing genes. Finally, genomic sequences are available for only a tiny fraction of the enormous variety of organisms. Trinity provides an effective starting point to examine the transcriptomes of such species.</p>
    <p id="P41">Trinity and its open source code are publicly available at <ext-link ext-link-type="uri" xlink:href="http://TrinityRNASeq.sourceforge.net">http://TrinityRNASeq.sourceforge.net</ext-link></p>
  </sec>
  <sec sec-type="materials|methods" id="S16">
    <title>Materials and Methods</title>
    <sec id="S17">
      <title>Inchworm</title>
      <p id="P42">Inchworm decomposes each sequence read into overlapping k-mers (default k = 25). Each k-mer is stored in a hash table as a key/value pair, where the key is the k-mer sequence and the value is the abundance of that k-mer in the input data set. The k-mer key is stored as a 64-bit unsigned integer with 2-bit nucleotide encoding. Likely sequencing error-containing k-mers are identified by examining k-mers that have identical k-1 prefixes, differing only at their terminal nucleotide, and removing those k-mers that are less than 5% abundant as compared to the most highly abundant k-mer of the group. After processing the entire read set into a set of k-mers and pruning the likely error k-mers, the most frequently occurring k-mer is identified as a seed k-mer for reconstruction of draft transcript contigs. The information content of the seed k-mer is computed as Shannon’s Entropy<sup><xref rid="R31" ref-type="bibr">31</xref></sup>, and only k-mers having entropy <italic>H</italic> &gt;= 1.5, occurring at least twice in the complete set of input reads, and not palindromic, are allowed as seed k-mers. The seed k-mer is extended at both ends in a coverage-guided manner, first from 5′ to 3′, followed by extension from 3′ to 5′. Seed selection by Inchworm was largely inspired by similar methods implemented in the RepeatScout algorithm<sup><xref rid="R32" ref-type="bibr">32</xref></sup>. Extension from the seed is performed greedily based on the frequencies of candidate overlapping k-mers, with the single most abundant k-mer with (k-1) overlap chosen to provide a single base extension. In the case of tied extensions, paths are recursively explored to identify the extension yielding the cumulatively maximal coverage. Extension continues until no k-mer exists in the data set to provide an extension. The sequence yielded from the bidirectional seed k-mer extension is reported as a draft transcript contig, and the set of overlapping k-mers comprising the contig are removed from the hash table. The entire cycle of seed selection and bidirectional k-mer extension continues until all k-mers in the hash table have been exhausted.</p>
      <p id="P43">In strand-specific mode (default), k-mers are derived from only the sense strand of the RNA-Seq read. Double-stranded mode, used with non-strand-specific RNA-Seq data involves several modifications: both the sense and the reverse-complemented read sequence are parsed into overlapping k-mers; during Inchworm contig extension, a k-mer chosen to extend a given path has the reverse-complemented k-mer sequence disabled for further k-mer extensions; and when an Inchworm contig is reported at the end of one iteration of contig assembly, both the sense and reverse-complemented k-mers are removed from the k-mer dictionary.</p>
      <p id="P44">Only Inchworm contigs with an average k-mer coverage of 2 and length at least 48 (2*(k-1), k=25), the minimal contig length required to capture variation anchored by (k-1) at each terminus, are used by Chrysalis, as described below.</p>
    </sec>
    <sec id="S18">
      <title>Chrysalis</title>
      <p id="P45">To convert the linear contigs into a proper de Bruijn graph, Chrysalis first builds a k-1-mer lookup table and recursively pools contigs that share sequences (excluding low-complexity sequence, as above in Inchworm) into components, given that there are reads that span across a potential junction (the “welds”) and extend perfect matches by (k-1)/2 bases on each side. The number of welds must exceed 0.04 times the average k-1-mer coverage of each contig, as computed by inchworm. In addition, the k-1-mer coverage of one contig cannot exceed the coverage of the other by a factor of 100. Next, Chrysalis processes each component individually and computes a de Bruijn graph from the linear inchworm contigs. The reads are then mapped to components by selecting the component that shares the most k-1-mers with the read, with a single k-1 mer being sufficient for assignment. Chrysalis also counts all k-mers and stores them as “edge weight” to indicate their support in the read set. Components with fewer than 276 nodes are discarded by default.</p>
    </sec>
    <sec id="S19">
      <title>Butterfly</title>
      <p id="P46">The input to butterfly is a de Bruijn graph component as built by Chrysalis. <bold>First</bold>, Butterfly trims edges in the de Bruijn graph. It uses two criteria. (<bold>1</bold>) We reasoned that if there is a node with several outgoing edges, such that one of them has a much smaller read support than the total outgoing reads (less than 5%), then it probably represents a sequencing error or a very lowly expressed variant (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 8a</xref> online). (<bold>2</bold>) If the <bold>outgoing</bold> edge has less than 2% support from the total <bold>incoming</bold> reads, then it is more likely a spurious transcript extension (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 8b</xref> online). Outgoing or incoming edges that fail according to one of these criteria are removed (both these numbers are parameters to the program, and can be changed for specific requirements).</p>
      <p id="P47"><bold>Second</bold>, Butterfly transforms the modified graph into a weighted sequence graph, where each node is a sequence, rather than an individual k-mer providing a single base path extension as in the de Bruijn graph. In this step, Butterfly generates a compact graph – the set of paths in the compacted graph is identical to that of the original de Bruijn graph. As a result, linear paths will be compacted into a single node, and polymorphisms will be minimized. The weight on each edge of the modified graph corresponds to the number of reads supporting the edge in the original de Bruijn graph. For each compound node, we compute the average coverage, which corresponds to the weights of the original edges that made up the sequence divided by the length of the node.</p>
      <p id="P48">We then repeat the trimming step, except that when examining compound nodes of length &gt; 1, we also use the node coverage as a measure of opposite flow in the second criterion. These two steps (trimming and graph compaction) are reiterated until convergence. The resulting graph represents possible transcripts as paths through the graph.</p>
      <p id="P49"><bold>Finally</bold>, Butterfly uses read sequences, read-pairings and Chrysalis’ read mappings to the graph to select the paths that are best supported by read sequences. The goal is to look for paths with physical evidence for contiguity, by either reads or read pairings. To do so, we first represent all the reads that contributed to the de Bruijn graph by the list of the nodes that they traverse. We then use a dynamic programming algorithm for finding supported path prefixes. The procedure is initialized with source nodes in the graphs (one without incoming edges), and at each step one path prefix is extended by an additional node.</p>
      <p id="P50">When extending a path prefix that ends at node <italic>n,</italic> we consider all outgoing edges from <italic>n</italic>, and evaluate the support for the extension. By construction, each edge in the graph is supported by reads. We however, further require that the last L nucleotides of the path be supported by reads. We define a path as <italic>L</italic>-supported at coverage <italic>c</italic> if at each extension of this path, we have at least c reads supporting the <italic>L</italic> nucleotide suffix of this path (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 8c</xref> online). A read supports a path fragment either if it contains that fragment as a subsequence, or in the case of paired-reads, if the fragment lies on all paths from nodes that correspond to the first sequence mate to the second sequence mate. In addition, to avoid combinatorial explosion due to small variations (most likely caused by sequence errors), once we extend a path prefix, we examine other paths ending at the same node, and merge the new path with previous path prefix ending at the same node if they are more than 95% identical.</p>
      <p id="P51">In the results here we used <italic>L</italic> = 250 and <italic>c</italic> = 2. The requirement for 250-supported paths emerges from the expected insert size of our library, since we do not expect to have support for a longer suffix if our read pairs (derived from a single fragment) do not span that far. We note that the resolution of ambiguities, which includes alternative splicing and allelic variation, is limited to the insert size of the read pairs, or the read lengths for unpaired data. Although this program can be in theory exponential in size, in practice, its cost is defined by the number of supported paths.</p>
    </sec>
    <sec id="S20">
      <title>Yeast and mouse cells growth conditions</title>
      <p id="P52">We used the <italic>S. pombe</italic> strain SPY73 975h+ and dendritic cells isolated from C57BL/6J mice. Details of cell isolation and growth conditions are in the <xref rid="SD1" ref-type="supplementary-material">Supplementary Methods</xref> online.</p>
    </sec>
    <sec id="S21">
      <title>RNA isolation for yeast samples</title>
      <p id="P53">Total yeast RNA was isolated using Qiagen RNeasy kit following manufacturers’ protocol for mechanical lysis using 0.5 mm zirconia/silica beads (Biospec). PolyA+ RNA was isolated from total RNA using Poly(A) purist kit (Ambion) or Dynabeads mRNA purification kit (Invitrogen). Total RNA and polyA+ RNA were treated with Turbo DNA-<italic>free</italic> (Ambion) as described. The integrity of the RNA was confirmed using the Agilent 2100 Bioanalyzer and quantified using RNA Quant-It assay for the Qubit® Fluorometer (Invitrogen).</p>
    </sec>
    <sec id="S22">
      <title>RNA preparation for mouse RNA</title>
      <p id="P54">Dendritic cells where lysed using QIAzol reagent and total RNA was extracted the miRNeasy kit’s procedure (Qiagen), sample quality was controlled on a 2100 Bioanalyzer (Agilent).</p>
    </sec>
    <sec id="S23">
      <title>RNA-Seq library preparation</title>
      <p id="P55">For the mouse dendritic cell sample, we created a dUTP second strand library starting from 200 ng of Turbo DNase treated and poly(A)<sup>+</sup> RNA using a previously described method<sup><xref rid="R14" ref-type="bibr">14</xref></sup> except that we fragmented RNA in 1x fragmentation buffer (Affymetrix) at 80°C for 4 min, purified and concentrated it to 6 <italic>μ</italic>l after ethanol precipitation. For the <italic>S. pombe</italic> samples, we prepared dUTP second strand libraries similarly, with the following additional modifications. We added an index (8 base barcode) to each library to enable pooling of these libraries (S. Fisher <italic>et al</italic>. manuscript in preparation). In addition, the adaptor ligation step was done with 1.2 <italic>μ</italic>l of index adaptor mix and 4000 cohesive end units of T4 DNA Ligase (New England Biolabs) overnight at 16°C in a final volume of 20 <italic>μ</italic>l. Finally, we generated libraries with an insert size ranging from 225 to 425 bp.</p>
    </sec>
    <sec id="S24">
      <title>RNA-Seq library sequencing</title>
      <p id="P56">We sequenced all the cDNA libraries with an Illumina Genome Analyzer IIx. We pooled the four <italic>S. pombe</italic> libraries together with four other indexed libraries and sequenced them using eight lanes of 76 nucleotide paired reads. We sequenced the mouse library using two lanes of 76 nucleotide paired reads.</p>
    </sec>
    <sec id="S25">
      <title>Defining empirical limits of full-length transcript reconstruction</title>
      <p id="P57">Inchworm was used to construct a k-mer dictionary based on the input reads as described above. Reference CDS sequences were examined by searching for each overlapping k-mer sequence in the dictionary. Reference CDS sequences lacking at least one k-mer in the Inchworm Kmer graph were classified as inaccessible for full-length reconstruction via the k-mer graph method. Those reference sequences fully represented within the k-mer dictionary were included in the oracle set.</p>
    </sec>
    <sec id="S26">
      <title>Finding paralogous genes in mouse</title>
      <p id="P58">To determine paralogous transcripts, we aligned all isoforms of all genes present in the Oracle set against each other, using the alignment program <italic>Satsuma</italic><sup><xref rid="R33" ref-type="bibr">33</xref></sup> We required alignments to be longer than half of the shorter of both sequences and at sequence identity of 70% and up. If at least one pair of transcripts from two genes met the criteria, we called both genes paralogous.</p>
    </sec>
    <sec id="S27">
      <title>Short read spliced alignments and transcript reconstructions using Cufflinks and Scripture</title>
      <p id="P59">The <italic>S. pombe</italic> genome was obtained from the Sanger Institute (<ext-link ext-link-type="uri" xlink:href="http://www.sanger.ac.uk/Projects/S_pombe/download.shtml">http://www.sanger.ac.uk/Projects/S_pombe/download.shtml</ext-link>). The mouse genome version 9 was obtained from the UCSC mouse genome browser gateway (<ext-link ext-link-type="uri" xlink:href="http://genome.ucsc.edu/cgi-bin/hgGateway?db=mm9">http://genome.ucsc.edu/cgi-bin/hgGateway?db=mm9</ext-link>). Left and right fragment reads were separately aligned to the genomes using TopHat (version 1.1.4)<sup><xref rid="R34" ref-type="bibr">34</xref></sup> with mouse RNA-Seq reads, and BLAT with <italic>S. pombe</italic> RNA-Seq reads; the BLAT short read alignment pipeline is provided at <ext-link ext-link-type="uri" xlink:href="http://inchworm.sourceforge.net/blat_short_read_alignment.html">http://inchworm.sourceforge.net/blat_short_read_alignment.html</ext-link>. We found BLAT to provide more accurate short read alignment with <italic>S. pombe</italic>, with TopHat lacking sensitive detection of the very short introns in <italic>S. pombe</italic>. In addition, both Scripture and Cufflinks demonstrated better performance using the BLAT alignments for <italic>S. pombe</italic> as compared to the TopHat alignments (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 9a</xref> online). Conversely, performance of Scripture and Cufflinks using TopHat alignments in mouse exceeded that using BLAT alignments (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 9b</xref> online). Hence, for evaluation purposes, we leveraged BLAT short read spliced alignments in <italic>S. pombe</italic> and TopHat alignments in mouse.</p>
      <p id="P60">BLAT alignments of short reads to the <italic>S. pombe</italic> genome were performed using the pipeline described above with the following settings: maximum intron length set to 500 bases, maximum distance between read pairs of 500, and only the single best alignment was reported per read. TopHat alignments to the mouse genome were performed using the following parameters: minimum intron length of 50 bases, maximum intron of 100kb, and mate inner distance set to 300 bases. Transcribed strand information was assigned to the individual reads based on knowledge of the fragment type (left or right) and the aligned strand of the genome. Both Cufflinks (version 0.9.3)<sup><xref rid="R2" ref-type="bibr">2</xref></sup> and Scripture<sup><xref rid="R3" ref-type="bibr">3</xref></sup> (version VPaperR3, obtained from Scripture author Manuel Garber) were executed on these alignments.</p>
    </sec>
    <sec id="S28">
      <title>Evaluation of published <italic>de novo</italic> methods</title>
      <p id="P61">Illumina reads were <italic>de novo</italic> assembled using ABySS<sup><xref rid="R1" ref-type="bibr">1</xref></sup> (version 1.2.1), SOAPdenovo<sup><xref rid="R6" ref-type="bibr">6</xref></sup> (version 1.04) or Trans-ABySS<sup><xref rid="R27" ref-type="bibr">27</xref></sup>. Command-line parameters used with ABySS were “abyss-pe k=25 E=0 n=10 in= ‘left.fa right.fa’ ”, employing a K-mer length of 25. Likewise, a 25-mer length was employed with SOAPdenovo along with other default parameters. Trans-ABySS<sup><xref rid="R27" ref-type="bibr">27</xref></sup> was run on Mouse and <italic>S. pombe</italic> using a set of k-mers including 26, 31, 36, 41, and 46 followed by merging the results by running the 1<sup>st</sup> stage of the trans-ABySS analysis pipeline. In the case of Whitefly, all k-mers from 26 through 46 were used so as to maximize sensitivity given the smaller input number of reads.</p>
    </sec>
    <sec id="S29">
      <title>Comparisons to reference transcripts</title>
      <p id="P62">Current gene annotations for <italic>S. pombe</italic> were downloaded as file ‘pombe_290110.gff’ from GeneDB (<ext-link ext-link-type="uri" xlink:href="http://old.genedb.org/genedb/pombe/">http://old.genedb.org/genedb/pombe/</ext-link>). RefSeq transcript gene annotations were downloaded for mouse at the UCSC mouse genome browser gateway (<ext-link ext-link-type="uri" xlink:href="http://genome.ucsc.edu/cgi-bin/hgGateway?db=mm9">http://genome.ucsc.edu/cgi-bin/hgGateway?db=mm9</ext-link>) in BED format. Protein coding nucleotide sequences were extracted from the genome sequences based on the gene annotations using custom PERL scripts. The mouse reference coding sequences were further distilled to remove entirely identical sequences corresponding to isoforms encoding identical proteins and paralogous sequences: the original 19,947 genes encoding 23,881 transcripts were reduced to 19,857 genes encoding 22,717 on-identical coding transcripts.</p>
      <p id="P63">Reconstructed transcript sequences (via <italic>de novo</italic> assembly, Scripture, or Cufflinks) were mapped to the reference coding sequences using BLAT<sup><xref rid="R35" ref-type="bibr">35</xref></sup>. Full-length reference annotation mappings were defined as having at least 95% sequence identity covering the entire reference coding sequence and containing at most 5% insertions or deletions (cumulative gap content). In evaluating methods that leverage the strand-specific data (Trinity and Cufflinks), proper sense-strand mapping of sequences was required. Transcripts reconstructed by the alternative methods (Scripture, ABySS, and SOAPdenovo) were allowed to map to either strand. Fusion transcripts were identified as individual reconstructed transcripts that mapped as full-length to multiple reference coding sequences and lacked overlap among the matching regions within the reconstructed transcript. One-to-one mappings were required between reconstructed transcripts and reference transcripts, including alternatively spliced isoforms, with the exception of fusion transcripts.</p>
    </sec>
    <sec id="S30">
      <title>Analysis of alignment-inferred introns and splicing patterns from reconstructed transcripts</title>
      <p id="P64">Reconstructed transcripts were mapped to genome sequences using GMAP, reporting only the single top scoring alignment per sequence. Individual introns and complete splicing patterns were extracted from each of the alignments and compared to reference annotations using custom PERL scripts. Unique introns (missing from the reference annotations) were required to contain consensus dinucleotide splice sites (GT or GC donors and AG acceptors).</p>
    </sec>
    <sec id="S31">
      <title>Locus coverage (tiering) by reconstructed transcripts</title>
      <p id="P65">The BLAT alignments between reference coding sequences (loci) and reconstructed transcripts described above were organized into locus-level coverage tiers as follows. Given a set of different reconstructed transcripts that have a best match to a reference sequence, the first match is selected and applied to that reference contig at the first coverage tier. The remaining matches are then examined for placement in the first tier. If a subsequent reference-matching region in common between two matches exceeds 30% of the shorter match length, then this subsequent match is propagated to the next highest tier lacking such restrictive match overlap. Tier placement continues until all matches are placed. The maximal tier level defines the locus-level coverage for that reference sequence and can be at most equal to the number of reconstructed transcripts mapped to that locus. Strand-specific transcript reconstructions were tiered in a strand-specific manner (as in the case of Trinity and Cufflinks). In the case of a highly fragmented transcriptome assembly, it is possible for many reconstructed transcripts to populate the first tier yielding a coverage of 1. In the case of alternatively spliced isoforms or redundant transcript generation at a given locus, the coverage value will exceed 1.</p>
    </sec>
    <sec id="S32">
      <title>Running Trinity on data sets varying read depth</title>
      <p id="P66">We randomly sub-sampled pairs in the mouse data set to generate such subsets. Inchworm and Chrysalis were run on a server with 256GB of RAM, Butterfly on a server (LSF) farm in parallel. Wall-clock runtimes are: ~17 hours (10M pairs set), ~36 hours (30M pairs set), and ~60 hours (full 50 M pairs set). All experiments were performed with Trinity using parameters: minimum contig length of 100 bases and average fragment length of 300 bases.</p>
    </sec>
    <sec id="S33">
      <title>Computing gene expression values from aligned RNA-Seq reads</title>
      <p id="P67">The aligned reads (by TopHat in the case of mouse leveraging the full 52.6M read pairs, and by BLAT in the case of <italic>S. pombe</italic> leveraging the 50M read pairs) were used for computing gene (and other feature) expression values. The number of fragments mapped to segments (exons) of a genome-mapped feature were tallied based on overlap of the segment’s coordinates by either read from a sequenced fragment, counting fragments as opposed to counting individual reads. Expression was computed as the normalized value of <italic>Fragments per Kilobase of feature sequence Per Million fragments mapped</italic> or FPKM<sup><xref rid="R2" ref-type="bibr">2</xref></sup>. Calculations were performed using custom PERL scripts. Genes were defined as ‘expressed’ if observed to have expression values of at least 0.5 FPKM, and these genes were divided into expression quintiles at 5% intervals for purposes of analysis.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="S34">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>1</label>
      <media xlink:href="NIHMS292662-supplement-1.doc" mimetype="application" mime-subtype="msword" orientation="portrait" xlink:type="simple" id="d37e1372" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD2">
      <label>2</label>
      <media xlink:href="NIHMS292662-supplement-2.pdf" mimetype="application" mime-subtype="pdf" orientation="portrait" xlink:type="simple" id="d37e1376" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S35">
    <p>We thank Leslie Gaffney for help with figure preparation, Jim Bochicchio for project management, the Broad Sequencing Platform for all sequencing work, Alexie Papanicolaou and Michael Ott for Inchworm software testing and code enhancements, and Filipe Ribeiro for helpful discussions regarding error-pruning. The work was supported in part by a grant from the National Human Genome Research Institute (NIH 1 U54 HG03067, Lander), HHMI, an NIH PIONEER award, a BWF CASI (AR), the US-Israel Binational Science Foundation (NF and AR), and funds from the National Institute of Allergy and Infectious Diseases under Contract No. HHSN27220090018C. MY was supported by a Clore Fellowship. KLT is an EYRYI award recipient. AR is a researcher of the Merkin Foundation for Stem Cell Research at the Broad Institute.</p>
  </ack>
  <fn-group>
    <fn id="FN4" fn-type="con">
      <p><bold>Author Contributions.</bold> MGG, MY, BJH, KLT, NF and AR conceived and designed the study. BJH, MGG and MY developed the Inchworm, Chrysalis, and Butterfly components, respectively. NR, FDP, BB, CN, KLT contributed to the study’s conception and execution. JZL, DAT, XA, LF, RR, IA, NH, AR and AG designed and performed all experiments. QZ, ZC and EM contributed computational analyses. MGG, BJH and MY designed, implemented, and evaluated all methods. AR, NF, MGG, BJH and MY wrote the manuscript, with input from all authors.</p>
    </fn>
    <fn id="FN5" fn-type="conflict">
      <p>The authors declare no competing financial interest.</p>
    </fn>
    <fn id="FN6">
      <p><bold>Data Availability</bold>. Data is available in the gene expression omnibus or SRA (Fission yeast data is SRP005611 <sup><xref rid="R15" ref-type="bibr">15</xref></sup>, mouse is GSEXXX).</p>
    </fn>
  </fn-group>
  <ref-list>
    <ref id="R1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Birol</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo transcriptome assembly with ABySS</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>2872</fpage>
        <lpage>2877</lpage>
        <year>2009</year>
        <pub-id pub-id-type="pmid">19528083</pub-id>
      </element-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>
        <source>Nat Biotechnol</source>
        <volume>28</volume>
        <fpage>511</fpage>
        <lpage>515</lpage>
        <year>2010</year>
        <pub-id pub-id-type="pmid">20436464</pub-id>
      </element-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guttman</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ab initio reconstruction of cell type-specific transcriptomes in mouse reveals the conserved multi-exonic structure of lincRNAs</article-title>
        <source>Nat Biotechnol</source>
        <volume>28</volume>
        <fpage>503</fpage>
        <lpage>510</lpage>
        <year>2010</year>
        <pub-id pub-id-type="pmid">20436462</pub-id>
      </element-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haas</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Zody</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Advancing RNA-Seq analysis</article-title>
        <source>Nat Biotechnol</source>
        <volume>28</volume>
        <fpage>421</fpage>
        <lpage>423</lpage>
        <year>2010</year>
        <pub-id pub-id-type="pmid">20458303</pub-id>
      </element-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yassour</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ab initio construction of a eukaryotic transcriptome by massively parallel mRNA sequencing</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <volume>106</volume>
        <fpage>3264</fpage>
        <lpage>3269</lpage>
        <year>2009</year>
        <pub-id pub-id-type="pmid">19208812</pub-id>
      </element-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SOAP2: an improved ultrafast tool for short read alignment</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>1966</fpage>
        <lpage>1967</lpage>
        <year>2009</year>
        <pub-id pub-id-type="pmid">19497933</pub-id>
      </element-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Bruijn</surname>
            <given-names>NG</given-names>
          </name>
        </person-group>
        <article-title>A Combinatorical Problem</article-title>
        <source>Koninklijke Nederlandse Akademie v Wetenschappen</source>
        <volume>46</volume>
        <fpage>758</fpage>
        <lpage>764</lpage>
        <year>1946</year>
      </element-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Good</surname>
            <given-names>IJ</given-names>
          </name>
        </person-group>
        <article-title>Normal recurring decimals</article-title>
        <source>Journal of the London Mathematical Society</source>
        <volume>21</volume>
        <fpage>167</fpage>
        <lpage>169</lpage>
        <year>1946</year>
      </element-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>An Eulerian path approach to DNA fragment assembly</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <volume>98</volume>
        <fpage>9748</fpage>
        <lpage>9753</lpage>
        <year>2001</year>
        <pub-id pub-id-type="pmid">11504945</pub-id>
      </element-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zerbino</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Velvet: algorithms for de novo short read assembly using de Bruijn graphs</article-title>
        <source>Genome Res</source>
        <volume>18</volume>
        <fpage>821</fpage>
        <lpage>829</lpage>
        <year>2008</year>
        <pub-id pub-id-type="pmid">18349386</pub-id>
      </element-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ALLPATHS: de novo assembly of whole-genome shotgun microreads</article-title>
        <source>Genome Res</source>
        <volume>18</volume>
        <fpage>810</fpage>
        <lpage>820</lpage>
        <year>2008</year>
        <pub-id pub-id-type="pmid">18340039</pub-id>
      </element-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hertz-Fowler</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GeneDB: a resource for prokaryotic and eukaryotic organisms</article-title>
        <source>Nucleic Acids Res</source>
        <volume>32</volume>
        <fpage>D339</fpage>
        <lpage>343</lpage>
        <year>2004</year>
        <pub-id pub-id-type="pmid">14681429</pub-id>
      </element-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levin</surname>
            <given-names>JZ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive comparative analysis of strand-specific RNA sequencing methods</article-title>
        <source>Nat Methods</source>
        <volume>7</volume>
        <fpage>709</fpage>
        <lpage>715</lpage>
        <year>2010</year>
        <pub-id pub-id-type="pmid">20711195</pub-id>
      </element-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parkhomchuk</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptome analysis by strand-specific sequencing of complementary DNA</article-title>
        <source>Nucleic Acids Res</source>
        <volume>37</volume>
        <fpage>e123</fpage>
        <year>2009</year>
        <pub-id pub-id-type="pmid">19620212</pub-id>
      </element-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rhind</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparative Functional Genomics of the Fission Yeasts</article-title>
        <source>Science</source>
        <year>2011</year>
      </element-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>ET</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Alternative isoform regulation in human tissue transcriptomes</article-title>
        <source>Nature</source>
        <volume>456</volume>
        <fpage>470</fpage>
        <lpage>476</lpage>
        <year>2008</year>
        <pub-id pub-id-type="pmid">18978772</pub-id>
      </element-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilhelm</surname>
            <given-names>BT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dynamic repertoire of a eukaryotic transcriptome surveyed at single-nucleotide resolution</article-title>
        <source>Nature</source>
        <volume>453</volume>
        <fpage>1239</fpage>
        <lpage>1243</lpage>
        <year>2008</year>
        <pub-id pub-id-type="pmid">18488015</pub-id>
      </element-citation>
    </ref>
    <ref id="R18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bidirectional promoters generate pervasive transcription in yeast</article-title>
        <source>Nature</source>
        <volume>457</volume>
        <fpage>1033</fpage>
        <lpage>1037</lpage>
        <year>2009</year>
        <pub-id pub-id-type="pmid">19169243</pub-id>
      </element-citation>
    </ref>
    <ref id="R19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Watanabe</surname>
            <given-names>CK</given-names>
          </name>
        </person-group>
        <article-title>GMAP: a genomic mapping and alignment program for mRNA and EST sequences</article-title>
        <source>Bioinformatics</source>
        <volume>21</volume>
        <fpage>1859</fpage>
        <lpage>1875</lpage>
        <year>2005</year>
        <pub-id pub-id-type="pmid">15728110</pub-id>
      </element-citation>
    </ref>
    <ref id="R20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>CH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Universal Protein Resource (UniProt): an expanding universe of protein information</article-title>
        <source>Nucleic Acids Res</source>
        <volume>34</volume>
        <fpage>D187</fpage>
        <lpage>191</lpage>
        <year>2006</year>
        <pub-id pub-id-type="pmid">16381842</pub-id>
      </element-citation>
    </ref>
    <ref id="R21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wapinski</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Pfeffer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Natural history and evolutionary principles of gene duplication in fungi</article-title>
        <source>Nature</source>
        <volume>449</volume>
        <fpage>54</fpage>
        <lpage>61</lpage>
        <year>2007</year>
        <pub-id pub-id-type="pmid">17805289</pub-id>
      </element-citation>
    </ref>
    <ref id="R22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Molnar</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Characterization of rec7, an early meiotic recombination gene in Schizosaccharomyces pombe</article-title>
        <source>Genetics</source>
        <volume>157</volume>
        <fpage>519</fpage>
        <lpage>532</lpage>
        <year>2001</year>
        <pub-id pub-id-type="pmid">11156975</pub-id>
      </element-citation>
    </ref>
    <ref id="R23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nakamura</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kishida</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shimoda</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>The Schizosaccharomyces pombe spo6+ gene encoding a nuclear protein with sequence similarity to budding yeast Dbf4 is required for meiotic second division and sporulation</article-title>
        <source>Genes Cells</source>
        <volume>5</volume>
        <fpage>463</fpage>
        <lpage>479</lpage>
        <year>2000</year>
        <pub-id pub-id-type="pmid">10886372</pub-id>
      </element-citation>
    </ref>
    <ref id="R24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Watanabe</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive isolation of meiosis-specific genes identifies novel proteins and unusual non-coding transcripts in Schizosaccharomyces pombe</article-title>
        <source>Nucleic Acids Res</source>
        <volume>29</volume>
        <fpage>2327</fpage>
        <lpage>2337</lpage>
        <year>2001</year>
        <pub-id pub-id-type="pmid">11376151</pub-id>
      </element-citation>
    </ref>
    <ref id="R25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yassour</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Strand-specific RNA sequencing reveals extensive regulated long antisense transcripts that are conserved across yeast species</article-title>
        <source>Genome Biol</source>
        <volume>11</volume>
        <fpage>R87</fpage>
        <year>2010</year>
        <pub-id pub-id-type="pmid">20796282</pub-id>
      </element-citation>
    </ref>
    <ref id="R26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matlin</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>CWJ</given-names>
          </name>
        </person-group>
        <article-title>Understanding alternative splicing: towards a cellular code</article-title>
        <source>Nat Rev Mol Cell Biol</source>
        <volume>6</volume>
        <fpage>386</fpage>
        <lpage>398</lpage>
        <year>2005</year>
        <pub-id pub-id-type="pmid">15956978</pub-id>
      </element-citation>
    </ref>
    <ref id="R27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robertson</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo assembly and analysis of RNA-seq data</article-title>
        <source>Nat Methods</source>
        <volume>7</volume>
        <fpage>909</fpage>
        <lpage>912</lpage>
        <year>2010</year>
        <pub-id pub-id-type="pmid">20935650</pub-id>
      </element-citation>
    </ref>
    <ref id="R28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Graveley</surname>
            <given-names>BR</given-names>
          </name>
        </person-group>
        <article-title>Alternative splicing: increasing diversity in the proteomic world</article-title>
        <source>Trends Genet</source>
        <volume>17</volume>
        <fpage>100</fpage>
        <lpage>107</lpage>
        <year>2001</year>
        <pub-id pub-id-type="pmid">11173120</pub-id>
      </element-citation>
    </ref>
    <ref id="R29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>XW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo characterization of a whitefly transcriptome and analysis of its gene expression during development</article-title>
        <source>BMC Genomics</source>
        <volume>11</volume>
        <fpage>400</fpage>
        <year>2010</year>
        <pub-id pub-id-type="pmid">20573269</pub-id>
      </element-citation>
    </ref>
    <ref id="R30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Yorke</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Beware of mis-assembled genomes</article-title>
        <source>Bioinformatics</source>
        <volume>21</volume>
        <fpage>4320</fpage>
        <lpage>4321</lpage>
        <year>2005</year>
        <pub-id pub-id-type="pmid">16332717</pub-id>
      </element-citation>
    </ref>
    <ref id="R31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shannon</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>Prediction and entropy of printed English</article-title>
        <source>The Bell System Technical Journal</source>
        <volume>30</volume>
        <fpage>50</fpage>
        <lpage>64</lpage>
        <year>1951</year>
      </element-citation>
    </ref>
    <ref id="R32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>De novo identification of repeat families in large genomes</article-title>
        <source>Bioinformatics</source>
        <volume>21 </volume>
        <issue>Suppl 1</issue>
        <fpage>i351</fpage>
        <lpage>358</lpage>
        <year>2005</year>
        <pub-id pub-id-type="pmid">15961478</pub-id>
      </element-citation>
    </ref>
    <ref id="R33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grabherr</surname>
            <given-names>MG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide synteny through highly sensitive sequence alignment: Satsuma</article-title>
        <source>Bioinformatics</source>
        <volume>26</volume>
        <fpage>1145</fpage>
        <lpage>1151</lpage>
        <year>2010</year>
        <pub-id pub-id-type="pmid">20208069</pub-id>
      </element-citation>
    </ref>
    <ref id="R34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>TopHat: discovering splice junctions with RNA-Seq</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <fpage>1105</fpage>
        <lpage>1111</lpage>
        <year>2009</year>
        <pub-id pub-id-type="pmid">19289445</pub-id>
      </element-citation>
    </ref>
    <ref id="R35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>BLAT--the BLAST-like alignment tool</article-title>
        <source>Genome research</source>
        <volume>12</volume>
        <fpage>656</fpage>
        <lpage>664</lpage>
        <year>2002</year>
        <pub-id pub-id-type="pmid">11932250</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <title>Overview of Trinity</title>
      <p>(<bold>a</bold>) Inchworm assembles the read data set (short black line, top) by greedily searching for paths in a k-mer graph (middle), resulting in a collection of linear contigs (color lines, bottom), with each k-mer present only once in the contigs. (<bold>b</bold>) Chrysalis pools contigs if they share at least one k-1-mer and reads span the join, and builds individual de Bruijn graphs from each pool (colored lines). (<bold>c</bold>) Butterfly takes each de Bruijn graph from Chrysalis (top), and trims spurious edges and compacts linear paths (middle). It then reconciles the graph with reads (dashed colored arrows, bottom) and pairs (not shown), and outputs one linear sequence for each splice form and/or paralogous transcript reflected in the graph (bottom, colored sequences).</p>
    </caption>
    <graphic xlink:href="nihms292662f1"/>
  </fig>
  <fig id="F2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <title>Trinity correctly reconstructs the majority of full-length transcripts in fission yeast and mouse</title>
      <p>(<bold>a,c</bold>) Shown is the fraction of Oracle genes fully reconstructed in different expression quintiles (5% increments) in fission yeast (50M pairs assembly) (a) and the fraction of Oracle genes with at least one transcript fully reconstructed in different expression quintiles in mouse (53M pairs assembly) (c). Each bar represents a 5% quintile of read coverage for genes expressed. Bar height is the fraction of annotated genes in that quintile and among the Oracle set (grey) or the subset of the Oracle set that are fully reconstructed by Trinity (blue). For example, ~36% of the <italic>S. pombe</italic> transcripts at the bottom 5% of expression levels are fully reconstructed by Trinity; ~45% of the transcripts in this quintile are in the Oracle set. (<bold>b, d</bold>) Shown are the median values for coverage by length of reference transcripts by the longest corresponding Trinity-assembled transcript, according to expression quintiles in yeast (b) and mouse (d), depending on the number of read pairs that went into each assembly.</p>
    </caption>
    <graphic xlink:href="nihms292662f2"/>
  </fig>
  <fig id="F3" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <title>Trinity improves the yeast annotation</title>
      <p>Shown are examples of Trinity assemblies (red) along with the corresponding annotated transcripts (blue) and underlying reads (grey) all aligned to the <italic>S. pombe</italic> genome (read alignment shown for graphical clarity; no alignments were used to generate the assemblies). (<bold>a</bold>) Trinity identifies a new multi-exonic transcript (left) and extends the 5′ and 3′ UTRs of the Coq9 gene (right). (<bold>b</bold>) Trinity extends the UTRs of two convergently transcribed and overlapping genes.</p>
    </caption>
    <graphic xlink:href="nihms292662f3"/>
  </fig>
  <fig id="F4" orientation="portrait" position="float">
    <label>Figure 4</label>
    <caption>
      <title>Trinity resolves closely paralogous genes</title>
      <p>(<bold>a</bold>) Shown is the compacted component graph for two paralogous mouse genes, Ddx19a and Ddx19b (93% identity), highlighting the two paths (red and blue) chosen by Trinity out of the 64 possible paths in this portion alone. (<bold>b</bold>) Shown are the alignments between the transcripts represented by the red and blue paths in (<bold>a</bold>) and the paralogous genes Ddx19a and Ddx19b relative to the mouse reference genome (genome alignment shown for graphical clarity only; no alignments were used to generate the assemblies).</p>
    </caption>
    <graphic xlink:href="nihms292662f4"/>
  </fig>
  <fig id="F5" orientation="portrait" position="float">
    <label>Figure 5</label>
    <caption>
      <title>Comparison of Trinity to other mapping-first and assembly-first methods</title>
      <p>(<bold>a,b</bold>) Evaluation based on number of full-length annotated transcripts reconstructed by each method in in <italic>S. pombe</italic> (50M read pair assemblies) <bold>(a)</bold> and mouse (53M read pair assemblies) <bold>(b)</bold>. Shown is the number of genes reconstructed in full length (blue) or as fusions of two full-length genes (green, yeast only) and the number of full length reconstructed transcript isoforms (red, mouse only) in each of four ‘assembly first’ (<italic>de novo</italic>) and two ‘mapping first’ approaches. (<bold>c,d)</bold> Evaluation based on the number of introns defined by the transcripts from each method for <italic>S. pombe</italic> (<bold>c</bold>) and mouse (<bold>d</bold>). Shown is the number of distinct introns consistent with the reference annotation (y axis) versus the number of uniquely predicted introns (x axis), based on mapping to the genome of the transcripts reconstructed by each of Trinity (red), Trans-ABySS (yellow), ABySS (blue), SOAPdenovo (green), Scripture (purple) and Cufflinks (grey). (<bold>e,f</bold>) Evaluation based on the number of splicing patterns (complete sets of introns in multi-intronic transcripts) defined by the transcripts from each method for <italic>S. pombe</italic> (<bold>e</bold>) and mouse (<bold>f</bold>). Shown are the numbers of distinct splicing patterns (y axis) consistent with the reference annotation versus the number of unique splicing patterns (x axis), for each method (methods are colored as above).</p>
    </caption>
    <graphic xlink:href="nihms292662f5"/>
  </fig>
  <fig id="F6" orientation="portrait" position="float">
    <label>Figure 6</label>
    <caption>
      <title>Trinity reconstructs polymorphic transcripts in whitefly</title>
      <p>(<bold>a</bold>) Allelic variation evident from mapping RNA-Seq reads to a Trinity-reconstructed full-length whitefly transcript. Top: Shown is a single transcript (top, red bar), orthologous to the <italic>D. melanogaster</italic> Lamin gene, determined by grouping of allelic variant transcripts generated by Trinity. SNPs: yellow bars, Middle: Cummulative read coverage along the transcripts; colored bars: SNPs; bar height: relative proportions of SNP variants. Blue: C, red: T, orange: G, green: A. Bottom: Individual read coverage. (<bold>b</bold>) Example of two alternatively spliced transcripts resolved even in the absence of a reference genome. Top: Shown are two isoforms of an ELAV-like gene (top) reconstructed by Trinity (grey boxes, alternative exons). Exon structure is determined for visualization by the <italic>D. melanogaster</italic> ortholog. Bottom: shown is the protein sequence alignment of the two whitefly isoforms to orthologous proteins from other insects, confirming the splice variants (grey boxes). (<bold>c</bold>) Comparison of performance in <italic>de novo</italic> assembly of the whitefly transcriptome. For each of the methods, shown is the number of unique top-matching (blastx) uniref90<sup><xref rid="R20" ref-type="bibr">20</xref></sup> protein sequences aligned across the corresponding minimum percent protein length value at &gt;= 80% (blue), &gt;= 90% (green), &gt;= 95% (orange) and 100% (red).</p>
    </caption>
    <graphic xlink:href="nihms292662f6"/>
  </fig>
</floats-group>
