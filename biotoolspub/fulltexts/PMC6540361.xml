<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6540361</article-id>
    <article-id pub-id-type="publisher-id">2787</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-2787-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>flowDiv: a new pipeline for analyzing flow cytometric diversity</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5492-6990</contrib-id>
        <name>
          <surname>Wanderley</surname>
          <given-names>Bruno M. S.</given-names>
        </name>
        <address>
          <email>brunobiomed.ufrn@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>A. Araújo</surname>
          <given-names>Daniel S.</given-names>
        </name>
        <address>
          <email>daniel@imd.ufrn.br</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Quiroga</surname>
          <given-names>María V.</given-names>
        </name>
        <address>
          <email>mavictoriaq.vq@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Amado</surname>
          <given-names>André M.</given-names>
        </name>
        <address>
          <email>andre.amado@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Neto</surname>
          <given-names>Adrião D. D.</given-names>
        </name>
        <address>
          <email>adriao@dca.ufrn.br</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sarmento</surname>
          <given-names>Hugo</given-names>
        </name>
        <address>
          <email>hugo.sarmento@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Metz</surname>
          <given-names>Sebastián D.</given-names>
        </name>
        <address>
          <email>metz.seba91@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Unrein</surname>
          <given-names>Fernando</given-names>
        </name>
        <address>
          <email>funrein@intech.gov.ar</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9687 399X</institution-id><institution-id institution-id-type="GRID">grid.411233.6</institution-id><institution>Instituto Metrópole Digital, Universidade Federal do Rio Grande do Norte, </institution></institution-wrap>Natal, Brazil </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9687 399X</institution-id><institution-id institution-id-type="GRID">grid.411233.6</institution-id><institution>Departamento de Oceanografia e Limnologia, Universidade Federal do Rio Grande do Norte, </institution></institution-wrap>Natal, Brazil </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2105 0048</institution-id><institution-id institution-id-type="GRID">grid.108365.9</institution-id><institution>Instituto Tecnológico de Chascomús (INTECH), Universidad Nacional de San Martín (UNSAM) - Consejo Nacional de Investigaciones Científicas y Técnicas (CONICET), </institution></institution-wrap>Buenos Aires, Argentina </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2170 9332</institution-id><institution-id institution-id-type="GRID">grid.411198.4</institution-id><institution>Departamento de Biologia, Universidade Federal de Juiz de Fora, </institution></institution-wrap>Juiz de Fora, Brazil </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2163 588X</institution-id><institution-id institution-id-type="GRID">grid.411247.5</institution-id><institution>Departamento de Hidrobiologia, Universidade Federal de São Carlos, </institution></institution-wrap>São Carlos, Brazil </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>274</elocation-id>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>5</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>2</day>
        <month>4</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Flow cytometry (FCM) is one of the most commonly used technologies for analysis of numerous biological systems at the cellular level, from cancer cells to microbial communities. Its high potential and wide applicability led to the development of various analytical protocols, which are often not interchangeable between fields of expertise. Environmental science in particular faces difficulty in adapting to non-specific protocols, mainly because of the highly heterogeneous nature of environmental samples. This variety, although it is intrinsic to environmental studies, makes it difficult to adjust analytical protocols to maintain both mathematical formalism and comprehensible biological interpretations, principally for questions that rely on the evaluation of differences between cytograms, an approach also termed cytometric diversity. Despite the availability of promising bioinformatic tools conceived for or adapted to cytometric diversity, most of them still cannot deal with common technical issues such as the integration of differently acquired datasets, the optimal number of bins, and the effective correlation of bins to previously known cytometric populations.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>To address these and other questions, we have developed flowDiv, an R language pipeline for analysis of environmental flow cytometry data. Here, we present the rationale for flowDiv and apply the method to a real dataset from 31 freshwater lakes in Patagonia, Argentina, to reveal significant aspects of their cytometric diversities.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>flowDiv provides a rather intuitive way of proceeding with FCM analysis, as it combines formal mathematical solutions and biological rationales in an intuitive framework specifically designed to explore cytometric diversity.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-019-2787-4) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Flow cytometry</kwd>
      <kwd>Cytometric diversity</kwd>
      <kwd>R language</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001807</institution-id>
            <institution>Fundação de Amparo à Pesquisa do Estado de São Paulo</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2014/14139-3</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001807</institution-id>
            <institution>Fundação de Amparo à Pesquisa do Estado de São Paulo</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2016/50494-8</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Flow cytometry (FCM) is a highly versatile technology that has been widely applied in various fields, from industrial processes to medical and environmental research [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. One of the greatest appeals of FCM stems from its rapid and reliable assessment of detailed information on single or multiple cells from any given cell population. This versatility has led to its rapid adoption in different areas of expertise, resulting in a wide range of applications and the development of various specialized protocols for data analysis, which are usually not interchangeable.</p>
    <p>Environmental sciences in particular face difficulty in adapting non-specific protocols to their context, mainly because of the highly heterogeneous nature of environmental samples [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. However, this heterogeneity is central to environmental studies, as it reveals much about the properties of any given community, for instance microbial communities [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. Precisely for this reason, the environmental FCM community has been directing efforts to developing methods focused on the depiction of this heterogeneity through cytograms, a concept presently explored under the closely related names of “cytometric pattern” [<xref ref-type="bibr" rid="CR6">6</xref>], “cytometric fingerprint” [<xref ref-type="bibr" rid="CR6">6</xref>] and “cytometric diversity” [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p>Studies of cytometric resemblance have made great efforts with respect to their implementation [<xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR12">12</xref>] and their critical assessment [<xref ref-type="bibr" rid="CR6">6</xref>], but the most suitable methods to manipulate environmental data are still under debate. In one sense, reasonable choices would favor methods that appropriately balance mathematical formalism and comprehensible biological interpretations, in a very similar manner to those that are extensively applied in the field of ecology [<xref ref-type="bibr" rid="CR13">13</xref>].</p>
    <p>Notably, most available tools in some sense do incorporate ecological rationales into their methods, but the possibility of explicitly applying them to describe cytometric resemblances remains underexploited. Indeed, since this approach was pioneered more than 20 years ago by Li (1997) under the term “cytometric diversity” [<xref ref-type="bibr" rid="CR7">7</xref>], only a few studies have delved into this line [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR16">16</xref>].</p>
    <p>Briefly, Li’s seminal approach consists of binning cytograms and converting them to contingency tables of events, counting them by applying 16 ×16 Cartesian grids to each two-dimensional cytogram. Each contingency table summarizes a pool of non-taxonomic units, the bins, which are then used to derive some measures of biodiversity. Notwithstanding its astounding implications, some important aspects of the method were left incomplete in the original method, namely: <italic>i</italic>) the issue of low dimensionality; <italic>ii</italic>) the optimal number of bins; <italic>iii</italic>) the integration of differently acquired datasets; <italic>iv</italic>) pairwise resemblances; and <italic>v</italic>) bin’s explicit roles on cytometric diversity.</p>
    <p>The issue of low dimensionality refers to the difficulty of dealing with more than two channels at a time. Although this suffices in many situations [<xref ref-type="bibr" rid="CR14">14</xref>], selection of only two channels impedes deeper scrutiny of the information, since it does not allow efficient control of the additional features of the data at hand, notably for multicolor assays.</p>
    <p>The optimal number of bins relates to a formal rather than empirical definition of the appropriate number of bins prior to the data analysis. While the most parsimonious solution at this point is to narrow the bin width to limits in which the largest amount of information data is preserved while still allowing less-intensive computation, this issue still lacks a closed-form solution.</p>
    <p>Integration of differently acquired datasets encompasses the idea that a proper comparison between cytograms requires them to be set to common perspectives in order to correctly match the bins of interest. This is a highly restrictive constraint that requires all files to be acquired strictly within the same protocol guidelines. To some extent, however, such a constraint could theoretically be relaxed if some sort of perspective guides, such as internal standards (e.g., latex beads), could be used for a perspective control of cytograms, as is usually done in traditional FCM analysis. This solution, although promising, has not yet been explored.</p>
    <p>Last are the issues regarding two closely linked aspects, easily deducible from but not covered in the first implementation of the method: pairwise resemblances and the bins’ explicit roles in cytometric diversity.</p>
    <p>Pairwise resemblances derive from the fact that because individual cytograms can be depicted by their individual properties, clearly it should be possible to infer their pairwise (dis)similarities as well. The diversity indices (<italic>α</italic> indices) described in the original work concern only the particular features of a system. Hence, if the <italic>α</italic> diversities of two or more cytograms can be inferred, their resemblances, a concept referred to in ecology as <italic>β</italic> diversity, can also be assessed.</p>
    <p>Measuring the cytometric <italic>β</italic> diversity, on the other hand, intuitively raises questions regarding the bins’ contributions to the differences detected, notably how the bin properties, such as position and number of counts, could lead to differences between cytograms, and in what way these properties effectively correlate with previously known cytometric populations. This is fundamental information, without which diversity measures provide only limited information [<xref ref-type="bibr" rid="CR17">17</xref>].</p>
    <p>In this article, we suggest solutions for these fundamental questions by discussing the implementation of flowDiv, a pipeline for analyzing environmental flow cytometry data, devised as an extended full implementation of Li’s ideas. To illustrate the potential of flowDiv, we applied it to reveal important aspects of the cytometric diversity from 31 lakes in Argentine Patagonia.</p>
  </sec>
  <sec id="Sec2">
    <title>Design and implementation</title>
    <p>flowDiv is implemented in the R language and is structured in 19 stages of processing and 11 stages of oriented decision (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Here we describe the rationale behind each stage in detail.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic view of the flowDiv workflow</p></caption><graphic xlink:href="12859_2019_2787_Fig1_HTML" id="MO1"/></fig></p>
    <sec id="Sec3">
      <title>Data read</title>
      <p>The first step of the pipeline consists of reading and parsing preprocessed (i.e. compensated, normalized or transformed) [<xref ref-type="bibr" rid="CR18">18</xref>] FCS data. Input may be structured either as FlowJo<sup>®</sup> workspaces or, equivalently, as GatingSet R objects.</p>
      <p>This process is a wrapper for some flowWorkspace [<xref ref-type="bibr" rid="CR19">19</xref>] and flowCore [<xref ref-type="bibr" rid="CR20">20</xref>] subroutines. It is intended to reduce the complexity of the overall analysis by reducing the number of required software programs to two at most. This allows a manageable and more reproducible execution of the assay.</p>
    </sec>
    <sec id="Sec4">
      <title>Gate selection</title>
      <p>Once imported, the next action consists of the extraction of user-defined regions of interest, the gates.</p>
      <p>Gates are regions defined by their channels and respective borders (limits) that must be provided to the algorithm. While borders are internally and automatically parsed, information about which channels to use must be defined empirically by the analyst.</p>
      <p>This is one of the key steps of the algorithm, as it expands the data analysis to higher dimensions, allowing more than two channels to be set per analysis.</p>
    </sec>
    <sec id="Sec5">
      <title>Range definitions</title>
      <p>For any selected channel, a histogram is generated with equal numbers of bins. First, the channel ranges and bin width must be outlined.</p>
      <p>The ranges within which channels will be binned can be defined either by the relative maximum and minimum values of the pooled set of channels (dynamic ranges), or by setting absolute limits for each channel separately (fixed ranges).</p>
      <p>Fixed ranges define static limits for the histograms, producing a global model for comparative analyses between different runs of the algorithm. Dynamic ranges, on the other hand, mean that only the limits spanned by the data are considered in the binning process, maximizing the information gain in the analysis.</p>
    </sec>
    <sec id="Sec6">
      <title>Normalization</title>
      <p>To fit specific scenarios where the data include any control standards (e.g., beads) but are acquired under different protocol guidelines – namely for scenarios where the operator accounts for changes in the data while controlling for the variance – we provide an approach to set the data to a common perspective through a translational transformation of the data (termed, in our pipeline, normalization).</p>
      <p>Formally, in each vector <italic>v</italic>=(<italic>a</italic><sub>1</sub>,<italic>a</italic><sub>2</sub>,...,<italic>a</italic><sub><italic>n</italic></sub>), representing the channels features of a particular cytogram, we apply a transformation <italic>T</italic>, such as: 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ T(v) = \left(a_{1}+\triangle b_{1}, a_{2}+\triangle b_{2},\ldots,a_{n}+\triangle b_{n}\right)   $$ \end{document}</tex-math><mml:math id="M2"><mml:mi>T</mml:mi><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>△</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>△</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>△</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2019_2787_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Where <italic>b</italic>=(△<italic>b</italic><sub>1</sub>,△<italic>b</italic><sub>2</sub>,…,△<italic>b</italic><sub><italic>n</italic></sub>) represents the displacement coordinates for each point. Here, <italic>b</italic> is the vector of the difference computed between the mean bead values of each channel and a grand mean, calculated from the pooled mean bead values for each channel of all cytograms in the set, such as: 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \triangle b_{ij} = \frac{\sum_{1}^{j} \overline{w}_{ij}}{n}-\overline{w}_{ij}  $$ \end{document}</tex-math><mml:math id="M4"><mml:mo>△</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><graphic xlink:href="12859_2019_2787_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Where <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {w}_{ij}$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_2787_Article_IEq1.gif"/></alternatives></inline-formula> is the representation of the arithmetic mean of bead values from channel <italic>i</italic> of cytogram <italic>j</italic>, and <italic>n</italic> corresponds to the absolute number of samples (cytograms).</p>
      <p>Following translation, flowDiv runs a variance stabilization of the data based on the approach implemented by Azada et al. (2015) in the flowVS package [<xref ref-type="bibr" rid="CR21">21</xref>].Briefly, these steps proceed to an inverse hyperbolic sine (asinh) transformation of data with the form: 
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ T(v_{i}) = asinh (v_{i}/c_{i})   $$ \end{document}</tex-math><mml:math id="M8"><mml:mi>T</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mtext mathvariant="italic">asinh</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><graphic xlink:href="12859_2019_2787_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Where <italic>c</italic><sub><italic>i</italic></sub> equals a normalization factor, calculated for each channel <italic>i</italic> individually [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    </sec>
    <sec id="Sec7">
      <title>Binning</title>
      <p>After the ranges are defined and the data centralized, the algorithm proceeds to data binning: here, the analyst will be asked how many bins should be used in the histogram construction.</p>
      <p>In view of the innate high variability of natural environments, it is not reasonable to define a basic number of bins that represent any kind of data. Binning should be changeable, according to the nature of the data at hand. To deal with this, we have implemented a subroutine for inferring the optimum number of bins, which is based on the Freedman-Diaconis rule [<xref ref-type="bibr" rid="CR22">22</xref>]: 
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ bins_{ij} = \left\lceil {\frac{max(x_{ij}) - min(x_{ij})}{2 \cdot IQR(x_{ij}) \cdot n_{j}^{\frac{-1}{3}}} } \right\rceil  $$ \end{document}</tex-math><mml:math id="M10"><mml:mtext mathvariant="italic">bin</mml:mtext><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="⌉" open="⌈" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">max</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mtext mathvariant="italic">min</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:mtext mathvariant="italic">IQR</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2019_2787_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Where <italic>b</italic><italic>i</italic><italic>n</italic><italic>s</italic><sub><italic>ij</italic></sub> represents the ceiling number of bins for channel <italic>i</italic> of sample <italic>j</italic>; <italic>n</italic> is the number of observations for the sample <italic>j</italic>; <italic>IQR</italic> stands for interquartile range and <italic>x</italic><sub><italic>ij</italic></sub> is the channel vector <italic>i</italic> of sample <italic>j</italic>.</p>
      <p>The optimum number of bins, <italic>b</italic><italic>i</italic><italic>n</italic><italic>s</italic><sub><italic>b</italic></sub>, is calculated simply from the arithmetic mean of all suggested bins pooled, as follows: 
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ bins_{b} = \frac{\sum_{1}^{i} \sum_{1}^{j} bins_{ij}}{max(i)\cdot max(j)}   $$ \end{document}</tex-math><mml:math id="M12"><mml:mtext mathvariant="italic">bin</mml:mtext><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munderover><mml:mtext mathvariant="italic">bin</mml:mtext><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">max</mml:mtext><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:mtext mathvariant="italic">max</mml:mtext><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2019_2787_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec8">
      <title>Contingency tables</title>
      <p>The binning process results in the creation of common, mutually exclusive, exhaustive and ordered classes (bins), which are then cross-tabulated and used to construct an <italic>n</italic>-dimensional contingency table <italic>S</italic> in the form: 
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ S = \{ x_{i_{k}} \mid i = 1,2,\ldots, m \quad \text{and} \quad k=1,2,\ldots,n \}  $$ \end{document}</tex-math><mml:math id="M14"><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mspace width="1em"/><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo></mml:math><graphic xlink:href="12859_2019_2787_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Where <inline-formula id="IEq2"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{i_{k}}$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_2787_Article_IEq2.gif"/></alternatives></inline-formula> corresponds to the number of counts for bin <italic>i</italic> of channel <italic>k</italic>.</p>
    </sec>
    <sec id="Sec9">
      <title>Vectorization</title>
      <p>Each <italic>n</italic>-dimensional contingency table is further linearly transformed to column vectors, in a process known as vectorization, creating a one-to-one correspondence between elements of the multidimensional space and elements of its transformed form, as follows: 
<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ V_{j}=vec(S_{j}) = \{ x_{1_{1}},\ldots,x_{1_{2}},\ldots,x_{i_{k}} \}  $$ \end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext mathvariant="italic">vec</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math><graphic xlink:href="12859_2019_2787_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The rationale behind this step is to make the data more manageable for subsequent manipulation, by reducing the data dimensionality while keeping the information unchanged.</p>
    </sec>
    <sec id="Sec10">
      <title>Volume correction</title>
      <p>In some circumstances, environmental samples are previously diluted before running a flow cytometer experiment: such dilutions may occur as a direct consequence of stain, fixative or beads addition, or as a requirement to keep event counting within a protocol-specified range [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
      <p>All of these situations must be appropriately considered in the final calculations, in order to correctly determine the real frequency of any targeted event. In our pipeline, we deal with dilution bias by applying a user-defined correction factor to each individual sample, such as: 
<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ F = W \cdot D_{cf}  $$ \end{document}</tex-math><mml:math id="M20"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">cf</mml:mtext></mml:mrow></mml:msub></mml:math><graphic xlink:href="12859_2019_2787_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Where <italic>W</italic> is an <italic>n</italic>x<italic>j</italic> matrix composed of all column vectors <italic>V</italic><sub><italic>j</italic></sub>, and <italic>D</italic><sub><italic>cf</italic></sub> is a diagonal matrix in which element <italic>d</italic><sub><italic>ij</italic></sub> corresponds to the ratio between the minimum true volume passed (i.e., the real volume analyzed, considered after correcting for dilutions of any nature) of all samples pooled and the true volume passed for sample <italic>j</italic>. The minimum value is chosen to downweight any background noise generated in relatively long runs.</p>
    </sec>
    <sec id="Sec11">
      <title>Diversity analysis</title>
      <p>After vectorization, each cytogram is further used to derive three measures of biological diversity: <italic>α</italic>-diversity, species evenness, and <italic>β</italic>-diversity.</p>
      <p>To make these steps as feasible and adjustable as possible, we take advantage of another important suite of tools available in the vegan package [<xref ref-type="bibr" rid="CR23">23</xref>] to provide a wide range of <italic>α</italic> and <italic>β</italic> indices for calculation. By incorporating vegan::diversity() and vegan::betadiver() functions in its workflow, flowDiv allows analysts to manage, in addition to one evenness index (Pielou’s index), three different indices of <italic>α</italic> diversity (Shannon-Weaver, Simpson and inverse Simpson) and 24 indices of <italic>β</italic> diversity, as reviewed by Koleff et al. (2003)[<xref ref-type="bibr" rid="CR24">24</xref>].</p>
      <sec id="Sec12">
        <title>Nestedness and turnover</title>
        <p>Some of the available <italic>β</italic> indices have particularly useful properties for FCM data analysis, as is the case for Bray-Curtis [<xref ref-type="bibr" rid="CR25">25</xref>] semimetrics. Besides being an appropriate index for raw count data, it can also be partitioned into two very informative complementary components, nestedness and turnover.</p>
        <p>In an abstract sense, nestedness and turnover correspond, respectively, to AND and XOR relationships between two sets of bins (e.g., Baselga, 2009 [<xref ref-type="bibr" rid="CR26">26</xref>]). In the present context, these two components serve as convenient proxies to detail how the differences in cytograms might be partitioned between bin superposition (nestedness) or bin differential counting (turnover).</p>
        <p>Because of their clear utility, both indices are also incorporated in our pipeline, as a wrapper of the betapart:bray.part() function, and are automatically called when the Bray-Curtis dissimilarity is chosen.</p>
      </sec>
    </sec>
    <sec id="Sec13">
      <title>Transformations</title>
      <p>To accommodate other ecologically meaningful distance measures (see [<xref ref-type="bibr" rid="CR27">27</xref>] and [<xref ref-type="bibr" rid="CR23">23</xref>] for details), we have also incorporated another optional step, transformation. Internally, this process is simply a wrapper for the decostand{vegan} function.</p>
    </sec>
    <sec id="Sec14">
      <title>Ordination analysis, clusterization and mapping</title>
      <p>Once <italic>β</italic>-diversity indices are acquired, the next step consists of an ordination and biplot of the results (cytograms and bins) to help in further investigations of the contributions of bins to the observed differences. Since Non-Metric Multidimensional Scaling (nMDS) has the convenient property of accommodating any (dis)similarity measure handled by flowDiv [<xref ref-type="bibr" rid="CR28">28</xref>], we applied this technique in our pipeline.</p>
      <p>For the purpose of keeping track of broader regions of the contingency tables while allowing further inspection of plots using traditional visual approaches, flowDiv proceeds to the clusterization of the bin ordination scores to generate a single masking image, which is further applied onto each cytogram individually. This step provides a novel and straightforward way of visually interpreting the bin ordination directly in cytograms.</p>
      <p>For clusterization, we use the <italic>K</italic>-means clustering method. Briefly, the goal of <italic>K</italic>-means clustering is to partition <italic>n</italic> observations into <italic>k</italic> mutually exclusive clusters. More formally, <italic>K</italic>-means aims to minimize a squared error function <italic>J</italic>, such as: 
<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \underset{c}{\arg\min} \ J =\underset{c}{\arg\min} \ \sum_{i=1}^{k} \sum_{j=1}^{n} \lVert x_{ji} - \mu_{i} \rVert_{2}^{2}   $$ \end{document}</tex-math><mml:math id="M22"><mml:munder><mml:mrow><mml:mo>arg</mml:mo><mml:mo>min</mml:mo></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munder><mml:mspace width="1em"/><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>arg</mml:mo><mml:mo>min</mml:mo></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munder><mml:mspace width="1em"/><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo>∥</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ji</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><graphic xlink:href="12859_2019_2787_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Where ∥<italic>x</italic><sub><italic>ij</italic></sub>−<italic>μ</italic><sub><italic>i</italic></sub>∥<sub>2</sub> is the Euclidean distance between a data point <italic>x</italic><sub><italic>j</italic></sub>, belonging to cluster <italic>i</italic>, and the cluster center <italic>μ</italic><sub><italic>i</italic></sub>. In the flowDiv context, the set of observations <italic>x</italic>=(<italic>x</italic><sub>1</sub>,<italic>x</italic><sub>2</sub>,...,<italic>x</italic><sub><italic>n</italic></sub>) represents the set of 2-dimensional real vectors, defined by each of the <italic>n</italic> bin ordination scores obtained in the previous step.</p>
      <sec id="Sec15">
        <title>Choice of <italic>K</italic></title>
        <p>Determining the ideal number of clusters, <italic>K</italic>, is not a trivial task unless analysts can make some reasonable practical assumptions about the optimum number of clusters. For other situations, a data-driven process should be used, and considering these explicitly, we adopted the Calinski-Harabasz [<xref ref-type="bibr" rid="CR29">29</xref>] criterion to guide our definition of the best number of clusters. The Calinski-Harabasz criterion, <italic>C</italic>, is defined as: 
<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ C = \frac{n-K}{K-1} \cdot \frac{BG_{SS}}{WG_{SS}}   $$ \end{document}</tex-math><mml:math id="M24"><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">SS</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">SS</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2019_2787_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>In the formula, <italic>n</italic> is the number of bins, <italic>K</italic> is the number of clusters, <italic>W</italic><italic>G</italic><sub><italic>SS</italic></sub> is the sum of squares within the clusters, and <italic>B</italic><italic>G</italic><sub><italic>SS</italic></sub> is the sum of squares between the clusters.</p>
        <p>flowDiv tests <italic>K</italic> iteratively within a pragmatically defined range, from one to ten clusters, and the lowest <italic>C</italic> is set as a suggestion of the appropriate number of clusters.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Example of use</title>
    <sec id="Sec17">
      <title>Introduction</title>
      <p>To evaluate flowDiv, we analyzed bacterioplankton data from 31 lakes in Patagonia, Argentina, collected in the provinces of Chubut, Santa Cruz and Tierra del Fuego. These aquatic systems seem to be an appropriate benchmark for our pipeline, as they have a clear geospatial gradient as well as a multitude of different ecological characteristics that have already been shown to be reflected in their bacterial community structure [<xref ref-type="bibr" rid="CR30">30</xref>–<xref ref-type="bibr" rid="CR32">32</xref>].</p>
      <p>To assess the flowDiv consistency, we also briefly contrasted it with five other available cytometric fingerprint computation tools: Dalmatian Plot [<xref ref-type="bibr" rid="CR11">11</xref>], Cytometric Histogram Image Comparison (CHIC) [<xref ref-type="bibr" rid="CR10">10</xref>], Cytometric Barcoding (CyBar) [<xref ref-type="bibr" rid="CR12">12</xref>], FlowFP [<xref ref-type="bibr" rid="CR9">9</xref>] and PhenoFlow [<xref ref-type="bibr" rid="CR16">16</xref>].</p>
    </sec>
    <sec id="Sec18">
      <title>Material and methods</title>
      <sec id="Sec19">
        <title>Datasets</title>
        <p>This case study focused on three different datasets for each aquatic system: (1) 12 morphometric, physical, and chemical environmental variables; (2) flow cytometry FCS files, manually gated for bacterioplankton populations; and (3) bacterial polymerase chain reaction denaturing gradient gel electrophoresis (PCR-DGGE) bands’ relative intensities. Detailed information about the study sites, protocols, sampling design and environmental parameters was provided by Schiaffino et al. [<xref ref-type="bibr" rid="CR30">30</xref>–<xref ref-type="bibr" rid="CR32">32</xref>].</p>
      </sec>
      <sec id="Sec20">
        <title>Environmental parameters</title>
        <p>Samples were collected from the euphotic zone, during spring in the years 2007 (Chubut and Santa Cruz) and 2008 (Tierra del Fuego) along a latitudinal gradient from 45<sup>∘</sup>55’S to 54<sup>∘</sup>36’S. The following parameters were recorded: latitude, longitude, area, temperature, pH, electrical conductivity, dissolved oxygen (DO), dissolved nitrogen (DN), diffuse attenuation coefficient (<italic>K</italic><sub><italic>d</italic></sub>), chlorophyll a (Chla), phosphate, and dissolved organic carbon (DOC).</p>
      </sec>
      <sec id="Sec21">
        <title>Flow cytometry data</title>
        <p>Flow cytometry data were acquired with a FACSCalibur (Becton Dickinson) flow cytometer equipped with a standard 15 mW blue argon-ion (488 nm emission) laser and a red laser diode (635 nm), using 1 <italic>μ</italic> fluorescent beads as i nternal controls and SYTO 13 as the nucleic-acid stain. Bacterioplankton populations were manually gated by their cytometric signature in detection channels for 90<sup>∘</sup> light scatter (bacterial cell size and structural complexity), green fluorescence (nucleic acid content), and red fluorescence (fluorescence spillover from the dye SYTO 13), following guidelines by Gasol et al. 2015 [<xref ref-type="bibr" rid="CR2">2</xref>]. The gating strategy was performed with FlowJo <sup>®</sup> v.10 software.</p>
      </sec>
      <sec id="Sec22">
        <title>flowDiv settings</title>
        <p>The cytogram ranges were dynamically defined and were binned through channels SSC-H (90<sup>∘</sup> light scatter), FL1-H (green fluorescence), and FL3-H (red fluorescence) for 75 bins per channel. Shannon diversity, richness, Pielou’s evenness, and Bray-Curtis semimetrics, as well as the components nestedness and turnover were evaluated. Bin ordination scores were clustered into five groups as suggested by the Calinski-Harabasz criterion.</p>
      </sec>
      <sec id="Sec23">
        <title>Statistics</title>
        <p>All statistics were performed with R version 3.3.2 (2016), using the following additional packages: vegan [<xref ref-type="bibr" rid="CR23">23</xref>], RVAideMemoire [<xref ref-type="bibr" rid="CR33">33</xref>], gvlma [<xref ref-type="bibr" rid="CR34">34</xref>], corrplot [<xref ref-type="bibr" rid="CR35">35</xref>], gplots [<xref ref-type="bibr" rid="CR36">36</xref>] and ggplot2 [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
        <p>Principal components analysis (PCA), non-metric multidimensional scaling (NMDS), and regression of environmental vectors onto ordination plots were based on the stats::prcomp(), vegan::metaMDS() and vegan::envfit() functions.</p>
        <p>Tests on ordination score centroids were conducted with permutational multivariate analysis of variance (PERMANOVA) while controlling for spatial variation. PERMANOVA and tests for multivariate homoscedasticity were done with vegan::adonis() and vegan::betadisper() respectively.</p>
        <p>Linear models were conducted after checking for model assumptions by gvlma::gvlma(). Additionally, to correct for unbalanced factors in the models, we merged mesotrophic (n = 13) and eutrophic (n = 4) groups (cf. Schiaffino et al. (2013)[<xref ref-type="bibr" rid="CR31">31</xref>]) into a single class, termed “meso-eutrophic”.</p>
        <p>Distance matrices for pairwise comparisons and Mantel’s test were run with vegan::vegdist() and vegan::mantel(). All tests were performed assuming an <italic>α</italic> level equal to 0.05.</p>
        <p>Details of the coding for statistical analysis, including the datasets generated and analyzed, can be found online at <ext-link ext-link-type="uri" xlink:href="https://github.com/bmsw/Supplementary-Code/blob/master/Statistical_Analysis.R.">https://github.com/bmsw/Supplementary-Code/blob/master/Statistical_Analysis.R.</ext-link></p>
      </sec>
    </sec>
    <sec id="Sec24">
      <title>Results and discussion</title>
      <sec id="Sec25">
        <title>Alpha diversity and evenness</title>
        <p>Principal components analysis (PCA) of cytometric indices revealed a smoothed separation pattern among the samples (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a), suggesting that differences among waterbody trophic states could be associated with cytometric diversity, richness in particular. To test this hypothesis, we performed a Wilcoxon rank sum test under the null hypothesis that average cytometric richness is not dependent on the trophic status of a waterbody. The null hypothesis, however, was not supported (<italic>P</italic>&lt;0.05).
<fig id="Fig2"><label>Fig. 2</label><caption><p>PCA correlation biplot <bold>a</bold>, boxplots <bold>b</bold>, <bold>c</bold> and <bold>d</bold> and density plot <bold>e</bold> computed from 31 Patagonian lakes using cytometric richness, Pielou’s evenness, and the Shannon index. Shaded areas in the PCA biplot represent 95% confidence ellipses</p></caption><graphic xlink:href="12859_2019_2787_Fig2_HTML" id="MO2"/></fig></p>
        <p>Spearman’s rank correlation, in turn, showed that eight of 13 environmental variables showed significant relationships to the cytometric indices (Fig. <xref rid="Fig3" ref-type="fig">3</xref>).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Correlation matrix based on Spearman’s rank correlation coefficient <bold>a</bold> of cytometric indices and environmental variables. Black crosses indicate non-significant correlations. Linear regression models of the Shannon-Weaver index and <italic>L</italic><italic>o</italic><italic>g</italic><sub>10</sub> cytometric richness <bold>b</bold>, pH <bold>c</bold>, <italic>L</italic><italic>o</italic><italic>g</italic><sub>10</sub>DOC <bold>d</bold> and <italic>L</italic><italic>o</italic><italic>g</italic><sub>10</sub><italic>K</italic><sub><italic>d</italic></sub><bold>e</bold>. Point sizes reflect <italic>L</italic><italic>o</italic><italic>g</italic><sub>10</sub> cytometric richness values</p></caption><graphic xlink:href="12859_2019_2787_Fig3_HTML" id="MO3"/></fig></p>
        <p>We note that pH, Kd and DOC are variables directly associated with the trophic status. It has been demonstrated that at low DOC concentrations, only some bacterial specialists are able to actively incorporate the various types of organic matter effectively [<xref ref-type="bibr" rid="CR38">38</xref>], and as a consequence, the bacterial diversity would be low. Accordingly, the positive relationship observed between <italic>α</italic> diversity and DOC is in line with the idea that higher concentrations of DOC, which are associated with a more-diverse DOC composition, would result in higher diversity of the bacteria that use these varieties of compounds.</p>
      </sec>
      <sec id="Sec26">
        <title>Beta diversity</title>
        <p>Ordination of Bray-Curtis distances indicated apparent differences in group means (Fig <xref rid="Fig4" ref-type="fig">4</xref>a), which were later confirmed by the PERMANOVA test (P &lt;0.05). The ordination scores, in turn, showed significant linear correlations with nine environmental variables: DOC, chlorophyll a, pH, Kd, latitude, longitude, area, altitude, and temperature (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a).
<fig id="Fig4"><label>Fig. 4</label><caption><p><bold>a</bold> NMDS of 31 Patagonian lakes computed in Bray-Curtis distance (Stress = 0.10) jointly plotted with fitted significant variables: dissolved organic carbon (DOC), chlorophyll a (Chla), pH, Kd, latitude (Lat), longitude (Lon), area, altitude, and temperature (Temp.); <bold>b</bold> Pie chart of partitioned Bray-Curtis distance (nestedness and turnover). Shaded areas in the NMDS plot represent 95% confidence ellipses</p></caption><graphic xlink:href="12859_2019_2787_Fig4_HTML" id="MO4"/></fig></p>
        <p>Furthermore, distance partitioning revealed that nestedness accounted for the major differences among the systems (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b).</p>
      </sec>
      <sec id="Sec27">
        <title>Ordination analysis, clusterization and mapping</title>
        <p>The biplot of the samples and bins, based on channels FL1-H and SSC-H, showed a broadly common area shared by most of the cytograms (blue and green clusters, Fig. <xref rid="Fig5" ref-type="fig">5</xref>a), as could be anticipated from the nestedness patterns from previous sections (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). Samples were differently associated with specific clusters of bins, which subsequent visual inspection revealed to correspond, partially or totally, to known cytometric subpopulations (Figs. <xref rid="Fig5" ref-type="fig">5</xref>c-f and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6)).
<fig id="Fig5"><label>Fig. 5</label><caption><p>NMDS biplot <bold>a</bold> and mask of bins onto channels FL1-H and SSC-H <bold>b</bold>. Cytogram numbers 6 (<bold>c</bold>; Pond 7, S1) and 13 (<bold>d</bold>; Pond 13, S1) are overlaid by <bold>b</bold> to reveal how the known gated populations relate to ordination clusters (<bold>e</bold> and <bold>f</bold>). Dotted red arrows indicate the logical pathway through the figures</p></caption><graphic xlink:href="12859_2019_2787_Fig5_HTML" id="MO5"/></fig></p>
      </sec>
      <sec id="Sec28">
        <title>Pairwise comparisons</title>
        <p>flowDiv and FlowFP were the only pipelines that significantly and positively correlated with DGGE information (Mantel statistic r = 0.20 and 0.19, respectively) Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S7. Those techniques were also highly correlated (Mantel statistic r = 0.65), probably due to their common principles (i.e., binning-based techniques) (Table <xref rid="Tab1" ref-type="table">1</xref>).
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Mantel statistics based on Bray-Curtis distance matrix calculated for pairwise comparisons of pipelines</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">DGGE</th><th align="left">CHIC</th><th align="left">Dalmation plot</th><th align="left">CyBar</th><th align="left">flowFP</th><th align="left">PhenoFlow</th><th align="left">flowDiv</th></tr></thead><tbody><tr><td align="left">DGGE</td><td align="left">-</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">CHIC</td><td align="left">0.05</td><td align="left">-</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">Dalmation plot</td><td align="left">-0.05</td><td align="left">0.06</td><td align="left">-</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">CyBar</td><td align="left">-0.07</td><td align="left">-0.07</td><td align="left">-0.11</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">flowFP</td><td align="left">0.18<sup>∗</sup></td><td align="left">0.13</td><td align="left">-0.34</td><td align="left">0.42<sup>∗</sup></td><td align="left">-</td><td align="left"/><td align="left"/></tr><tr><td align="left">PhenoFlow</td><td align="left">0.10</td><td align="left">0.08</td><td align="left">-0.35</td><td align="left">0.15</td><td align="left">0.37<sup>∗</sup></td><td align="left">-</td><td align="left"/></tr><tr><td align="left">flowDIV</td><td align="left">0.20<sup>∗</sup></td><td align="left">0.12</td><td align="left">-0.20</td><td align="left">0.12</td><td align="left">0.65<sup>∗</sup></td><td align="left">0.22<sup>∗</sup></td><td align="left">-</td></tr></tbody></table><table-wrap-foot><p>Asterisks (∗) represent significant results at <italic>α</italic>=0.05</p></table-wrap-foot></table-wrap></p>
        <p>Notably, these results are in line with previously published reports that described the correlation between molecular traits and cytometric diversity [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR39">39</xref>].</p>
        <p>Although flowDiv did not correlate significantly with the remaining techniques, the discrepancies could be interpreted merely as a matter of tuning, caused by differences in their default working principles [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR16">16</xref>].</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec29" sec-type="conclusion">
    <title>Conclusions</title>
    <p>The need to both reduce the analytical subjectivity and emphasize more practical aspects of environmental flow cytometry studies causes a paradigm shift so as to harmonize objectivity with applicability. flowDiv provides a fast, low-cost, straightforward, and rather intuitive way of proceeding with this kind of analysis, as it combines formal mathematical solutions and biological rationales in an intuitive framework specifically designed to explore cytometric diversity. In addition to solving some important technical issues, such as the perspective correction of differently acquired datasets, flowDiv provides an intelligible foundation for the use of multidimensional contingency tables in environmental FCM analyses. On the one hand, multidimensional contingency tables resolve quite efficiently for multicolor assays, since they maintain an epistemological relationship to the fairly well-known ecological tables. This property permits a more straightforward biological interpretation of diversity indices derived from FCM data. On the other hand, their summaries by biplots, along with a further clusterization and mapping of bins back to cytograms, constitute an elegant strategy to understand the global and local behaviors of FCM populations in the cytometric fingerprint.</p>
    <p>flowDiv is a flexible and robust analytical method for considering FCM data analysis. We hope that it will be a useful tool for environmental and non-environmental cytometrists, since there are clearly many possible avenues for expanding its applications, from environmental monitoring to data-quality assessment of FCM experiments. As an open-source initiative we hope that flowDiv will be considered, studied and improved by cytometrists from all fields of expertise in which it may be useful, both environmental and others.</p>
  </sec>
  <sec id="Sec30">
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> flowDiv<bold>Project home page:</bold><ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/flowDiv/">https://cran.r-project.org/web/packages/flowDiv/</ext-link><bold>Operating system(s):</bold> Platform independent<bold>Programming language:</bold> R<bold>Other requirements:</bold> R 2.16.0 or higher<bold>License:</bold> GPL-3<bold>Any restrictions to use by non-academics:</bold> no restrictions</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec31">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_2787_MOESM1_ESM.png">
            <label>Additional file 1</label>
            <caption>
              <p>Cytograms and masks of bins overlaid onto channels FL1-H and SSC-H for all 31 Patagonian lakes used in this study. (PNG 11400 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2019_2787_MOESM2_ESM.png">
            <label>Additional file 2</label>
            <caption>
              <p>Heatmaps based on distance matrices (Bray-Curtis distance) for the Patagonian lakes used in this study. Data are from: (a) DGGE, (b) CHIC, (c) flowCyBar, (d) Dalmation Plot, (e) FlowFP, (f) PhenoFlow, and (g) flowDiv pipelines. Dendrograms were based on Ward’s hierarchical agglomerative clustering method. (PNG 1810 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>ANOVA</term>
        <def>
          <p>Analysis of Variance</p>
        </def>
      </def-item>
      <def-item>
        <term>CHIC</term>
        <def>
          <p>Cytometric Histogram Image Comparison</p>
        </def>
      </def-item>
      <def-item>
        <term>Chla</term>
        <def>
          <p>Chlorophyll a</p>
        </def>
      </def-item>
      <def-item>
        <term>CyBar</term>
        <def>
          <p>Cytometric barcoding</p>
        </def>
      </def-item>
      <def-item>
        <term>DGGE</term>
        <def>
          <p>Denaturing Gradient Gel Electrophoresis</p>
        </def>
      </def-item>
      <def-item>
        <term>DOC</term>
        <def>
          <p>Dissolved Organic Carbon</p>
        </def>
      </def-item>
      <def-item>
        <term>DN</term>
        <def>
          <p>Dissolved Nitrogen</p>
        </def>
      </def-item>
      <def-item>
        <term>DO</term>
        <def>
          <p>Dissolved Oxygen</p>
        </def>
      </def-item>
      <def-item>
        <term>FCM</term>
        <def>
          <p>Flow Cytometry</p>
        </def>
      </def-item>
      <def-item>
        <term>
          <italic>K</italic>
          <sub>
            <italic>d</italic>
          </sub>
        </term>
        <def>
          <p>Diffuse Attenuation Coefficient</p>
        </def>
      </def-item>
      <def-item>
        <term>Lat</term>
        <def>
          <p>Latitude</p>
        </def>
      </def-item>
      <def-item>
        <term>Lon</term>
        <def>
          <p>Longitude</p>
        </def>
      </def-item>
      <def-item>
        <term>nMDS</term>
        <def>
          <p>Non-Metric Multidimensional Scaling</p>
        </def>
      </def-item>
      <def-item>
        <term>PCA</term>
        <def>
          <p>Principal Component Analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>PCR-DGGE</term>
        <def>
          <p>Polymerase Chain Reaction-Denaturing Gradient Gel Electrophoresis</p>
        </def>
      </def-item>
      <def-item>
        <term>PERMANOVA</term>
        <def>
          <p>Permutational Multivariate Analysis of Variance</p>
        </def>
      </def-item>
      <def-item>
        <term>SSC</term>
        <def>
          <p>90<sup>∘</sup> Side Scatter</p>
        </def>
      </def-item>
      <def-item>
        <term>Temp</term>
        <def>
          <p>Temperature</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Romina Schiaffino and Irina Izaguirre for sharing data on Patagonian lakes, Francisco Paulo Freire Neto and Ng Haig They for technical assistance and the Argentinean Council of Science and Technology (CONICET) for granting to Fernando Unrein the fellowship for young researchers.</p>
    <sec id="d29e2356">
      <title>Funding</title>
      <p>This study was supported by the São Paulo Research Foundation (FAPESP), processes 2014/14139-3 and 2016/50494-8. The funding body had no role in the design of the study and collection, analysis, interpretation of data and in writing the manuscript.</p>
    </sec>
    <sec id="d29e2361" sec-type="data-availability">
      <title>Availability of data and materials</title>
      <p>The coding for statistical analysis, including the datasets generated and analyzed, can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/bmsw/Supplementary-Code/blob/master/Statistical_Analysis.R.">https://github.com/bmsw/Supplementary-Code/blob/master/Statistical_Analysis.R.</ext-link></p>
    </sec>
    <sec id="d29e2370">
      <title>Consent to publish</title>
      <p>All authors consent to the publication of this manuscript.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>BMSW designed the method, wrote the software, conducted some experiments, and wrote the manuscript. FU conceived the study. MVQ and SDM provided important comments on algorithm design and writing. DSAA, ADDN, AMA and HS provided important comments on writing. All the authors have read and approved the final manuscript.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>No permissions were required to take the water samples for the described study, which complied with all relevant regulations.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <notes>
    <title>Publisher’s Note</title>
    <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Comas-Riu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rius</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Flow cytometry applications in the food industry</article-title>
        <source>J Ind Microbiol Biotechnol</source>
        <year>2009</year>
        <volume>36</volume>
        <issue>8</issue>
        <fpage>999</fpage>
        <lpage>1011</lpage>
        <pub-id pub-id-type="doi">10.1007/s10295-009-0608-x</pub-id>
        <pub-id pub-id-type="pmid">19557445</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gasol</surname>
            <given-names>Josep M.</given-names>
          </name>
          <name>
            <surname>Morán</surname>
            <given-names>Xosé Anxelu G.</given-names>
          </name>
        </person-group>
        <article-title>Flow Cytometric Determination of Microbial Abundances and Its Use to Obtain Indices of Community Structure and Relative Activity</article-title>
        <source>Springer Protocols Handbooks</source>
        <year>2015</year>
        <publisher-loc>Berlin, Heidelberg</publisher-loc>
        <publisher-name>Springer Berlin Heidelberg</publisher-name>
        <fpage>159</fpage>
        <lpage>187</lpage>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Alizada</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kiraz</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Baran</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Nalbant</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Flow cytometry: basic principles and applications</article-title>
        <source>Crit Rev Biotechnol</source>
        <year>2017</year>
        <volume>37</volume>
        <issue>2</issue>
        <fpage>163</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.3109/07388551.2015.1128876</pub-id>
        <pub-id pub-id-type="pmid">26767547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vives-Rego</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lebaron</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Nebe-von Caron</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Current and future applications of flow cytometry in aquatic microbiology</article-title>
        <source>FEMS Microbiol Rev</source>
        <year>2000</year>
        <volume>24</volume>
        <issue>4</issue>
        <fpage>429</fpage>
        <lpage>48</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1574-6976.2000.tb00549.x</pub-id>
        <pub-id pub-id-type="pmid">10978545</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hammes</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>De Roy</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Verstraete</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Boon</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Past, present and future applications of flow cytometry in aquatic microbiology</article-title>
        <source>Trends Biotechnol</source>
        <year>2010</year>
        <volume>28</volume>
        <issue>8</issue>
        <fpage>416</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tibtech.2010.04.006</pub-id>
        <pub-id pub-id-type="pmid">20541271</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koch</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Harnisch</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Schröder</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Cytometric fingerprints: Evaluation of new tools for analyzing microbial community dynamics</article-title>
        <source>Front Microbiol</source>
        <year>2014</year>
        <volume>5</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2014.00273</pub-id>
        <pub-id pub-id-type="pmid">24478763</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Cytometric diversity in marine ultraphytoplankton</article-title>
        <source>Limnol Oceanogr</source>
        <year>1997</year>
        <volume>42</volume>
        <issue>5</issue>
        <fpage>874</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.4319/lo.1997.42.5.0874</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quiroga</surname>
            <given-names>M. V</given-names>
          </name>
          <name>
            <surname>Mataloni</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wanderley</surname>
            <given-names>B. M</given-names>
          </name>
          <name>
            <surname>Amado</surname>
            <given-names>A. M</given-names>
          </name>
          <name>
            <surname>Unrein</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Bacterioplankton morphotypes structure and cytometric fingerprint rely on environmental conditions in a sub-Antarctic peatland</article-title>
        <source>Hydrobiologia</source>
        <year>2017</year>
        <volume>787</volume>
        <issue>1</issue>
        <fpage>255</fpage>
        <lpage>68</lpage>
        <pub-id pub-id-type="doi">10.1007/s10750-016-2969-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <mixed-citation publication-type="other">Holyst H, Rogers W. flowFP: Fingerprinting for Flow Cytometry. 2009. R package version 1.30.0.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koch</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fetzer</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Harms</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Chic—an automated approach for the detection of dynamic variations in complex microbial communities</article-title>
        <source>Cytom A</source>
        <year>2013</year>
        <volume>83A</volume>
        <issue>6</issue>
        <fpage>561</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.22286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bombach</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hübschmann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fetzer</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Kleinsteuber</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Geyer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Harms</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Resolution of natural microbial community dynamics by community fingerprinting, flow cytometry, and trend interpretation analysis</article-title>
        <source>High Resolution Microbial Single Cell Analytics</source>
        <year>2010</year>
        <publisher-loc>Berlin, Heidelberg</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <mixed-citation publication-type="other">Schumann J, Koch C, Günther S, Fetzer I, Müller S. flowCyBar: Analyze Flow Cytometric Data Using Gate Information. 2015. R package version 1.10.0. <ext-link ext-link-type="uri" xlink:href="http://www.ufz.de/index.php?de=16773">http://www.ufz.de/index.php?de=16773</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Legendre</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Legendre</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Legendre</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Legendre</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Numerical Ecology</article-title>
        <source>Developments in Environmental Modelling</source>
        <year>2012</year>
        <publisher-loc>Amsterdam</publisher-loc>
        <publisher-name>Elsevier</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W. K. W</given-names>
          </name>
        </person-group>
        <article-title>Macroecological patterns of phytoplankton in the northwestern North Atlantic Ocean</article-title>
        <source>Nature</source>
        <year>2002</year>
        <volume>419</volume>
        <issue>6903</issue>
        <fpage>154</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/nature00994</pub-id>
        <pub-id pub-id-type="pmid">12226662</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <mixed-citation publication-type="other">Ribalet F. cytoDiv: Cytometric Diversity Indices. 2012. R package version 0.5-3. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=cytoDiv">https://CRAN.R-project.org/package=cytoDiv</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Props</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Monsieurs</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mysara</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clement</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Boon</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hodgson</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Measuring the biodiversity of microbial communities by flow cytometry</article-title>
        <source>Methods Ecol Evol</source>
        <year>2016</year>
        <volume>7</volume>
        <issue>11</issue>
        <fpage>1376</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1111/2041-210X.12607</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>ter Braak</surname>
            <given-names>C. J</given-names>
          </name>
        </person-group>
        <article-title>Principal components biplots and alpha and beta diversity</article-title>
        <source>Ecology</source>
        <year>1983</year>
        <volume>64</volume>
        <issue>3</issue>
        <fpage>454</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="doi">10.2307/1939964</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Neill</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Aghaeepour</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Špidlen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Brinkman</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Flow Cytometry Bioinformatics</article-title>
        <source>PLoS Comput Biol</source>
        <year>2013</year>
        <volume>9</volume>
        <issue>12</issue>
        <fpage>e1003365</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003365</pub-id>
        <pub-id pub-id-type="pmid">24363631</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <mixed-citation publication-type="other">Finak G, Jiang M. flowWorkspace: Infrastructure for Representing and Interacting with the Gated Cytometry. 2011. R package version 3.18.10.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <mixed-citation publication-type="other">Ellis B, Haaland P, Hahne F, Le Meur N, Gopalakrishnan N, Spidlen J, Jiang M. flowCore: Basic Structures for Flow Cytometry Data. 2016. R package version 1.38.2.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <mixed-citation publication-type="other">Azad A. flowVS: Variance Stabilization in Flow Cytometry (and Microarrays). 2015. R package version 1.10.0.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <mixed-citation publication-type="other">Freedman D, Diaconis P. On the histogram as a density estimator: L2 theory. Zeitschrift für Wahrscheinlichkeitstheorie und Verwandte Gebiete. 1981; 57(4):453–76.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <mixed-citation publication-type="other">Oksanen J, Blanchet F. G, Friendly M, Kindt R, Legendre P, McGlinn D, Minchin P. R, O’Hara R. B, Simpson G. L, Solymos P, Stevens M. H. H, Szoecs E, Wagner H. Vegan: Community Ecology Package. 2017. R package version 2.4-3. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=vegan">https://CRAN.R-project.org/package=vegan</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koleff</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gaston</surname>
            <given-names>K. J</given-names>
          </name>
          <name>
            <surname>Lennon</surname>
            <given-names>J. J</given-names>
          </name>
        </person-group>
        <article-title>Measuring beta diversity for presence–absence data</article-title>
        <source>J Anim Ecol</source>
        <year>2003</year>
        <volume>72</volume>
        <fpage>367</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1046/j.1365-2656.2003.00710.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bray</surname>
            <given-names>J. R</given-names>
          </name>
          <name>
            <surname>Curtis</surname>
            <given-names>J. T</given-names>
          </name>
        </person-group>
        <article-title>An Ordination of the Upland Forest Communities of Southern Wisconsin</article-title>
        <source>Ecol Monogr</source>
        <year>1957</year>
        <volume>27</volume>
        <issue>4</issue>
        <fpage>325</fpage>
        <lpage>49</lpage>
        <pub-id pub-id-type="doi">10.2307/1942268</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baselga</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Partitioning the turnover and nestedness components of beta diversity</article-title>
        <source>Glob Ecol Biogeogr</source>
        <year>2010</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>134</fpage>
        <lpage>43</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1466-8238.2009.00490.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Legendre</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gallagher</surname>
            <given-names>E. D</given-names>
          </name>
        </person-group>
        <article-title>Ecologically meaningful transformations for ordination of species data</article-title>
        <source>Oecologia</source>
        <year>2001</year>
        <volume>129</volume>
        <issue>2</issue>
        <fpage>271</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1007/s004420100716</pub-id>
        <pub-id pub-id-type="pmid">28547606</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buttigieg</surname>
            <given-names>P. L</given-names>
          </name>
          <name>
            <surname>Ramette</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A guide to statistical analysis in microbial ecology: a community-focused, living review of multivariate data analyses</article-title>
        <source>FEMS Microbiology Ecology</source>
        <year>2014</year>
        <volume>90</volume>
        <issue>3</issue>
        <fpage>543</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1111/1574-6941.12437</pub-id>
        <pub-id pub-id-type="pmid">25314312</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caliński</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Harabasz</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A dendrite method for cluster analysis</article-title>
        <source>Commun Stat-Theory Methods</source>
        <year>1974</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1080/03610927408827101</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Romina Schiaffino</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Unrein</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gasol</surname>
            <given-names>J. M</given-names>
          </name>
          <name>
            <surname>Massana</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Balague</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Izaguirre</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Bacterial community structure in a latitudinal gradient of lakes: the roles of spatial versus environmental factors</article-title>
        <source>Freshw Biol</source>
        <year>2011</year>
        <volume>56</volume>
        <issue>10</issue>
        <fpage>1973</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1365-2427.2011.02628.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schiaffino</surname>
            <given-names>M. R</given-names>
          </name>
          <name>
            <surname>Gasol</surname>
            <given-names>J. M</given-names>
          </name>
          <name>
            <surname>Izaguirre</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Unrein</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Picoplankton abundance and cytometric group diversity along a trophic and latitudinal lake gradient</article-title>
        <source>Aquat Microb Ecol</source>
        <year>2013</year>
        <volume>68</volume>
        <issue>3</issue>
        <fpage>231</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.3354/ame01612</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schiaffino</surname>
            <given-names>M. R</given-names>
          </name>
          <name>
            <surname>Sánchez</surname>
            <given-names>M. L</given-names>
          </name>
          <name>
            <surname>Gerea</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Unrein</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Balagué</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Gasol</surname>
            <given-names>J. M</given-names>
          </name>
          <name>
            <surname>Izaguirre</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Distribution patterns of the abundance of major bacterial and archaeal groups in Patagonian lakes</article-title>
        <source>J Plankton Res</source>
        <year>2015</year>
        <volume>38</volume>
        <issue>1</issue>
        <fpage>64</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1093/plankt/fbv105</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <mixed-citation publication-type="other">Hervé M. RVAideMemoire: Diverse Basic Statistical and Graphical Functions. 2017. R package version 0.9-65. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=RVAideMemoire">https://CRAN.R-project.org/package=RVAideMemoire</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <mixed-citation publication-type="other">Pena E. A, Slate E. H. Gvlma: Global Validation of Linear Models Assumptions. 2014. R package version 1.0.0.2. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=gvlma">https://CRAN.R-project.org/package=gvlma</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <mixed-citation publication-type="other">Wei T, Simko V. Corrplot: Visualization of a Correlation Matrix. 2016. R package version 0.77. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=corrplot">https://CRAN.R-project.org/package=corrplot</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <mixed-citation publication-type="other">Warnes G. R, Bolker B, Bonebakker L, Gentleman R, Liaw W. H. A, Lumley T, Maechler M, Magnusson A, Moeller S, Schwartz M, Venables B. Gplots: Various R Programming Tools for Plotting Data. 2016. R package version 3.0.1. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=gplots">https://CRAN.R-project.org/package=gplots</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>Ggplot2: Elegant Graphics for Data Analysis</source>
        <year>2009</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sarmento</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Morana</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gasol</surname>
            <given-names>J. M</given-names>
          </name>
        </person-group>
        <article-title>Bacterioplankton niche partitioning in the use of phytoplankton-derived dissolved organic carbon: quantity is more important than quality</article-title>
        <source>ISME J</source>
        <year>2016</year>
        <volume>10</volume>
        <issue>11</issue>
        <fpage>2582</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="doi">10.1038/ismej.2016.66</pub-id>
        <pub-id pub-id-type="pmid">27128994</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>García</surname>
            <given-names>F. C</given-names>
          </name>
          <name>
            <surname>Alonso-Sáez</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Morán</surname>
            <given-names>X. A. G</given-names>
          </name>
          <name>
            <surname>López-Urrutia</surname>
            <given-names>Á</given-names>
          </name>
        </person-group>
        <article-title>Seasonality in molecular and cytometric diversity of marine bacterioplankton: the re-shuffling of bacterial taxa by vertical mixing</article-title>
        <source>Environ Microbiol</source>
        <year>2015</year>
        <volume>17</volume>
        <issue>10</issue>
        <fpage>4133</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1111/1462-2920.12984</pub-id>
        <pub-id pub-id-type="pmid">26189717</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
