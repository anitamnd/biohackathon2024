<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <?epub November-24-2011?>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3245066</article-id>
    <article-id pub-id-type="pmid">22121218</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkr1080</article-id>
    <article-id pub-id-type="publisher-id">gkr1080</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>The MAPPER<sub>2</sub> Database: a multi-genome catalog of putative transcription factor binding sites</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Riva</surname>
          <given-names>Alberto</given-names>
        </name>
        <xref ref-type="aff" rid="gkr1080-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="gkr1080-AFF2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="gkr1080-COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="gkr1080-AFF1"><sup>1</sup>Department of Molecular Genetics and Microbiology</aff>
    <aff id="gkr1080-AFF2"><sup>2</sup>University of Florida Genetics Institute, University of Florida, Gainesville, FL 32610, USA</aff>
    <author-notes>
      <corresp id="gkr1080-COR1">*To whom correspondence should be addressed. Tel: <phone>+ 1 352 273 6582</phone>; Fax: <fax>+1 352 273 8284</fax>; Email: <email>ariva@ufl.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>1</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>11</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>11</month>
      <year>2011</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>40</volume>
    <issue>Database issue</issue>
    <issue-title>Database issue</issue-title>
    <fpage>D155</fpage>
    <lpage>D161</lpage>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>9</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>10</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2011. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">http://creativecommons.org/licenses/by-nc/3.0</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>The <sc>mapper</sc><sub>2</sub> Database (<ext-link ext-link-type="uri" xlink:href="http://genome.ufl.edu/mapperdb">http://genome.ufl.edu/mapperdb</ext-link>) is a component of <sc>mapper</sc><sub>2</sub>, a web-based system for the analysis of transcription factor binding sites in multiple genomes. The database contains predicted binding sites identified in the promoters of all human, mouse and <italic>Drosophila</italic> genes using 1017 probabilistic models representing over 600 different transcription factors. In this article we outline the current contents of the database and we describe its web-based user interface in detail. We then discuss ongoing work to extend the database contents to experimental data and to add analysis capabilities. Finally, we provide information about recent improvements to the hardware and software platform that <sc>mapper</sc><sub>2</sub> is based on.</p>
    </abstract>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>INTRODUCTION</title>
    <p><sc>mapper</sc><sub>2</sub> is a web-based platform for the analysis of transcription factor binding sites (<sc>tfbs</sc>s) in multiple genomes. Its development was motivated by the need to provide a complete and comprehensive platform for the computational analysis of <sc>tfbs</sc>s, an essential task for the investigation of genetic regulatory networks at the genome-wide scale (<xref rid="gkr1080-B1" ref-type="bibr">1</xref>–<xref rid="gkr1080-B3" ref-type="bibr">3</xref>). <sc>mapper</sc><sub>2</sub> is composed of four interconnected modules: the ‘Database’, the ‘Search Engine’, ‘r<sc>snp</sc>s’, and the ‘Wizard’.</p>
    <p>In this article we describe the improvements and extensions to the database that have been performed since its original publication (<xref rid="gkr1080-B4" ref-type="bibr">4</xref>). After an overview of the architecture of the <sc>mapper</sc> platform, we focus on the <sc>mapper</sc><sub>2</sub> Database, describing work performed on the database itself, work performed on the web-based user interface to increase its usability and effectiveness, and other miscellaneous features including hardware and software improvements.</p>
  </sec>
  <sec>
    <title>SYSTEM ARCHITECTURE</title>
    <sec>
      <title>Model libraries</title>
      <p><sc>mapper</sc><sub>2</sub> is a modular, web-based system for the computational analysis of <sc>tfbs</sc>s. At its core is a library of &gt;1000 models, each associated with a specific transcription factor (<sc>tf</sc>). A model is a computational representation of the known binding sites for a <sc>tf</sc>, that can be used to detect the presence of putative binding sites in an arbitrary <sc>dna</sc> sequence. In most cases, the sites recognized by a <sc>tf</sc> are degenerate, and cannot be represented by a simple consensus sequence (<xref rid="gkr1080-B5" ref-type="bibr">5</xref>). Therefore, modeling <sc>tfbs</sc>s in general requires a probabilistic representation of the distribution of nucleotides in the site. The most common of these representations is the position weight matrix (<sc>pwm</sc>), whose contents describe the observed frequencies of the four nucleotides at each position in the alignment of all known binding sites (<xref rid="gkr1080-B6" ref-type="bibr">6</xref>).</p>
      <p>In <sc>mapper</sc><sub>2</sub>, <sc>tfbs</sc> models are represented by ‘hidden Markov models’, and are generated using the <sc>hmmer</sc> package (version 2) (<xref rid="gkr1080-B7" ref-type="bibr">7</xref>). <sc>hmmer</sc> provides commands to ‘train’ and ‘optimize’ models (called HMMs in the following), and to scan a <sc>dna</sc> sequence using one or more models in order to detect sites that match the nucleotide pattern described by them (henceforth called ‘hits’). Each hit receives a numerical score representing the likelihood that the <sc>dna</sc> sequence at the position where the hit was found matches the nucleotide distribution encoded by the model. Using HMMs to represent binding sites offers advantages in terms of specificity and sensitivity over PWMs, and provide more flexibility in modeling sites with complex structures (such as sites composed of two fragments separated by a spacer) (<xref rid="gkr1080-B8" ref-type="bibr">8</xref>).</p>
      <p><sc>mapper</sc><sub>2</sub> includes three large libraries of <sc>tfbs</sc> models. The first one (<sc>transfac</sc> models) was built using the same optimal alignments used to build the PWMs in the <sc>transfac</sc> database (<xref rid="gkr1080-B9" ref-type="bibr">9</xref>). The second one (<sc>mapper</sc><sub>2</sub> models) is specific to <sc>mapper</sc><sub>2</sub>, and was built using <sc>tfbs</sc> sequences from <sc>transfac</sc> that were not used in the <sc>transfac</sc> models. The third library was generated using <sc>tfbs</sc> data from the <sc>jaspar</sc> database (<xref rid="gkr1080-B10" ref-type="bibr">10</xref>). <xref ref-type="table" rid="gkr1080-T1">Table 1</xref> summarizes the number of models in each library and the TFs they represent. It should be noted that there may be multiple models for the same <sc>tf</sc>, in case the source databases contain different sets of binding sites for it. <sc>mapper</sc><sub>2</sub> provides a table listing all models in its libraries (with links to pages providing details about each one), that can be sorted either by model accession or by factor name.
<table-wrap id="gkr1080-T1" position="float"><label>Table 1.</label><caption><p>Number of <sc>hmm</sc> models and factors represented in each of the three default model libraries</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">Library</th><th rowspan="1" colspan="1">Models</th><th rowspan="1" colspan="1">Factors</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">TRANSFAC</td><td rowspan="1" colspan="1">399</td><td rowspan="1" colspan="1">326</td></tr><tr><td rowspan="1" colspan="1">MAPPER</td><td rowspan="1" colspan="1">529</td><td rowspan="1" colspan="1">434</td></tr><tr><td rowspan="1" colspan="1">JASPAR</td><td rowspan="1" colspan="1">89</td><td rowspan="1" colspan="1">89</td></tr><tr><td rowspan="1" colspan="1">Total</td><td rowspan="1" colspan="1">1017</td><td rowspan="1" colspan="1">678</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec>
      <title>Modules</title>
      <p>The <sc>mapper</sc><sub>2</sub> database includes all putative binding sites detected in the upstream regions of all known human, mouse and <italic>Drosophila</italic> transcripts using all the models in the <sc>mapper</sc><sub>2</sub> libraries. For each transcript, the region analyzed extends from 10 000 bp upstream of the transcription start site to 50 bp downstream of the translation start site (ATG), in order to include the proximal promoter, possible upstream regulatory elements and initial untranslated exons. Multiple transcripts produced by the same gene are analyzed independently.</p>
      <p>Information stored in the database for each hit includes its exact genomic position, the model that generated it, the gene in whose promoter it was found, the hit alignment (showing the model's representative sequence and the matched <sc>dna</sc> sequence) and the predictive score assigned to it by <sc>hmmer</sc>. <xref ref-type="table" rid="gkr1080-T2">Table 2</xref> summarizes the contents of the <sc>mapper</sc><sub>2</sub> database, showing the number of sequences analyzed and the total number of hits in each genome.
<table-wrap id="gkr1080-T2" position="float"><label>Table 2.</label><caption><p>Summary of the contents of the <sc>mapper</sc><sub>2</sub> database, by organism</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Human</th><th rowspan="1" colspan="1">Mouse</th><th rowspan="1" colspan="1"><italic>Drosophila</italic></th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Models</td><td rowspan="1" colspan="1">832</td><td rowspan="1" colspan="1">829</td><td rowspan="1" colspan="1">819</td></tr><tr><td rowspan="1" colspan="1">Genes</td><td rowspan="1" colspan="1">21 510</td><td rowspan="1" colspan="1">21 736</td><td rowspan="1" colspan="1">14 003</td></tr><tr><td rowspan="1" colspan="1">Promoters</td><td rowspan="1" colspan="1">34 022</td><td rowspan="1" colspan="1">27 443</td><td rowspan="1" colspan="1">22 369</td></tr><tr><td rowspan="1" colspan="1">Total bases (Mb)</td><td rowspan="1" colspan="1">628</td><td rowspan="1" colspan="1">578.6</td><td rowspan="1" colspan="1">266</td></tr><tr><td rowspan="1" colspan="1">Total hits</td><td rowspan="1" colspan="1">33 122 746</td><td rowspan="1" colspan="1">24 313 246</td><td rowspan="1" colspan="1">19 248 318</td></tr><tr><td rowspan="1" colspan="1">Hits/promoter</td><td rowspan="1" colspan="1">973.5</td><td rowspan="1" colspan="1">886.0</td><td rowspan="1" colspan="1">860.5</td></tr><tr><td rowspan="1" colspan="1">Hits/model</td><td rowspan="1" colspan="1">1.17</td><td rowspan="1" colspan="1">1.06</td><td rowspan="1" colspan="1">1.05</td></tr><tr><td rowspan="1" colspan="1">Hits spacing</td><td rowspan="1" colspan="1">18.95</td><td rowspan="1" colspan="1">23.80</td><td rowspan="1" colspan="1">(13.82)</td></tr></tbody></table><table-wrap-foot><fn><p>‘Models’ indicates the number of models that produced at least one hit in a genome. ‘Hits/model’ represents the average number of hits in a promoter for each model. ‘Hits spacing’ is the average number of nucleotides between hits (see text for an explanation of the <italic>Drosophila</italic> value).</p></fn></table-wrap-foot></table-wrap></p>
      <p>The <sc>mapper</sc><sub>2</sub> search engine can be used to scan an arbitrary <sc>dna</sc> sequence in real time. While the database includes hits found only in the upstream regions of known genes, the search engine interface allows the user to specify the exact region of each known gene to be scanned, or to upload one or more sequences in FASTA format. Although slower than querying the database, running a search engine analysis provides higher flexibility in selecting the sequences to be analyzed, and is not limited to the three default genomes.</p>
      <p>The r<sc>snp</sc>s module is used to identify single-nucleotide polymorphisms (SNPs) with potential regulatory effects. This is accomplished by detecting <sc>tfbs</sc>s containing SNPs, and measuring the change in score due to the allelic change. Score changes above a set threshold indicate that the <sc>snp</sc> has the potential to disrupt the binding site, reducing its binding affinity for the factor or deleting it altogether.</p>
      <p>The <sc>mapper</sc><sub>2</sub> wizard is a tool allowing the user to create new <sc>hmm</sc> models, by uploading a multiple-sequence alignment of binding sites. The wizard generates the <sc>hmm</sc>, optimizes it and stores it in the user's private library. The private model can then be used in the search engine or in r<sc>snp</sc>s in addition to the ones from the default libraries.</p>
      <p><sc>mapper</sc><sub>2</sub> modules are tightly interconnected: they are all based on the same model libraries and genomic annotation database, and they present a consistent user interface for ease of use. The user can therefore freely switch between them, executing multiple analysis session in parallel. Sessions are run in the background, and the system provides a page through which the user can display all running sessions, with a progress indicator showing the percentage of the analysis completed, and all completed ones (allowing to download previously generated results).</p>
    </sec>
  </sec>
  <sec>
    <title>DATABASE</title>
    <sec>
      <title>Genomes and annotations</title>
      <p><sc>mapper</sc><sub>2</sub> now uses the most recent versions of the human, mouse and <italic>Drosophila</italic> genomes and annotations. In particular, it uses assembly GRCh37/hg19 of the human genome, NCBI37/mm9 of the mouse genome and BGDP Release 5/dm3 of the <italic>Drosophila</italic> genome. Genomic annotations (e.g. gene names and identifiers) are kept up to date by an automated procedure, and the whole database is automatically re-created when new releases of the genomes or of the source binding site databases become available.</p>
    </sec>
    <sec>
      <title>Binding site data</title>
      <p>The current version of the <sc>mapper</sc><sub>2</sub> database was built using binding site data from <sc>transfac</sc> version 11.2 and the most recent version of <sc>jaspar</sc> (October 2009). <xref ref-type="table" rid="gkr1080-T1">Table 1</xref> reports the number of models and represented factors in each of the three default libraries.</p>
      <p>After generating the models, we collected the <sc>dna</sc> sequences for the upstream regions of all known genes in the three genomes known to <sc>mapper</sc><sub>2</sub>, and we scanned them with all models. The resulting hits were stored in a relational database, that serves as the main data source for <sc>mapper</sc><sub>2</sub>. <xref ref-type="table" rid="gkr1080-T2">Table 2</xref> reports the number of promoters scanned and hits detected in the three genomes. The increase in the number of hits compared to the previous version of the database is mainly due to the higher number of known transcripts now available for the three organisms.</p>
      <p>Note that the value of the density of hits in <italic>Drosophila</italic> is misleading, due to the small size of this genome. Since the region analyzed for each gene is at least 10 000 bp long, the total amount of sequence scanned is larger than the size of the entire genome. Moreover, in many cases the scanned region for a gene will overlap other close genes; it is therefore advisable to select a small region upstream of the transcript start when working with <italic>Drosophila</italic>.</p>
      <p>According to <xref ref-type="table" rid="gkr1080-T2">Table 2</xref>, every model is represented at least once in each promoter, which is not biologically realistic. This is actually an artifact of the <sc>hmmer</sc> algorithm, that always produces at least one hit per sequence scanned (albeit with a very low score). A more meaningful analysis can be performed by selecting only those sites with a score at or above a specific threshold, in order to reduce the number of false positives. The threshold can be selected on the basis of the distribution of scores in the database for each model, for example choosing a desired percentile level. The <sc>mapper</sc><sub>2</sub> interface provides for filtering hits at various percentiles levels ranging from 50<sup>th</sup> to 99<sup>th</sup>; in our experience, percentile levels of 90 or above should be used in a real-world analysis.</p>
      <p>An alternative way of defining a high-quality threshold consists in scanning a random sequence (having the same average base composition of typical gene promoters), generating the distribution of scores for the resulting hits and selecting an extreme value from it (for example, the 99<sup>th</sup> percentile). This translates into a 1% chance that a hit with a score above this value occurred by chance, and is therefore a false positive.</p>
      <p><xref ref-type="table" rid="gkr1080-T3">Table 3</xref> reports the results of the randomization procedure just described. For each organism, we generated a 5 Mbp random sequence with a nucleotide distribution derived from a large number of gene promoters, and we scanned it with each model, computing the 99<sup>th</sup> percentile of the resulting distribution of scores. This value was used as the high-quality threshold for the hits contained in the database for that model. The table displays the total number of high-quality hits in each organism, and the associated statistics.
<table-wrap id="gkr1080-T3" position="float"><label>Table 3.</label><caption><p>Summary of hits with scores above a threshold corresponding to a false discovery rate of 1%, obtained by scanning a 5 Mb randomized promoter sequence</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Human</th><th rowspan="1" colspan="1">Mouse</th><th rowspan="1" colspan="1"><italic>Drosophila</italic></th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">High quality hits</td><td rowspan="1" colspan="1">12 354 505</td><td rowspan="1" colspan="1">8 849 004</td><td rowspan="1" colspan="1">6 828 654</td></tr><tr><td rowspan="1" colspan="1">Hits/promoter</td><td rowspan="1" colspan="1">363.1</td><td rowspan="1" colspan="1">322.5</td><td rowspan="1" colspan="1">305.2</td></tr><tr><td rowspan="1" colspan="1">Hits/model</td><td rowspan="1" colspan="1">0.44</td><td rowspan="1" colspan="1">0.49</td><td rowspan="1" colspan="1">0.37</td></tr><tr><td rowspan="1" colspan="1">Hits distance</td><td rowspan="1" colspan="1">50.8</td><td rowspan="1" colspan="1">65.39</td><td rowspan="1" colspan="1">(39.0)</td></tr></tbody></table><table-wrap-foot><fn><p>The number of models and of promoters analyzed is the same as in <xref ref-type="table" rid="gkr1080-T2">Table 2</xref>.</p></fn></table-wrap-foot></table-wrap></p>
    </sec>
  </sec>
  <sec>
    <title>USER INTERFACE</title>
    <p>The <sc>mapper</sc><sub>2</sub> user interface has been extensively redesigned and improved in order to increase its usability and effectiveness. The main design principles behind it are ‘simplicity’ (all input fields are documented, with examples) and ‘consistency’ (all modules use a similar interface and display results using the same output layout).</p>
    <p>A menu bar at the top of each page provides access to all <sc>mapper</sc><sub>2</sub> functions and utilities. Commands are divided into five sections: ‘MAPPER’ (containing general commands such as Register, to create a private account, and News); ‘Models’ (with links to the list of all <sc>mapper</sc><sub>2</sub> models and to the <sc>mapper</sc><sub>2</sub> wizard); ‘Tools’ (containing links to the three main <sc>mapper</sc><sub>2</sub> modules); ‘Private’ (only available when logged in, containing links to the user's <sc>mapper</sc><sub>2</sub> sessions and private models); ‘Support’ (providing the Help and Feedback commands, and a link to a page listing publications about <sc>mapper</sc><sub>2</sub>).</p>
    <sec>
      <title>Inputs</title>
      <p>A <sc>mapper</sc><sub>2</sub> database session is initiated by clicking on the Database link in the main menu. This leads to a form used to input all necessary parameters, that is divided into three sections: ‘Gene(s)’, ‘Organisms’ and ‘Models’.</p>
      <p>The Gene(s) section provides controls to specify which gene or genes the user is interested in. There are four options, selected using a radio button. To start, the user may enter one or more gene identifiers in a text field; <sc>mapper</sc><sub>2</sub> automatically recognizes a large number of standard gene identifiers including official gene symbols, gene IDs, m<sc>rna</sc> accession numbers, <sc>ensembl</sc> identifiers. In case the user specifies a gene that has multiple isoforms, all of them will be analyzed at the same time. Alternatively, the user may upload a list of identifiers from a file. The behavior of the system in this case is the same, but this option is more practical when dealing with a large number of genes. The third option allows the user to select a pathway from a menu, to automatically analyze all the genes it contains. This option is useful when looking for TFs that may act as common regulators for several genes in the same pathway. Pathway definitions are taken from the KEGG database (<xref rid="gkr1080-B11" ref-type="bibr">11</xref>).</p>
      <p>When using one of these three options, the user can also select the size of the upstream region of each gene to be analyzed, as a number of base pairs upstream of the transcript start or the ATG. It should be noted that all hits in the region up to 10 000 bp upstream of the transcript start are precomputed and stored in the database; these controls simply determine the number of hits that will be returned to the user.</p>
      <p>Finally, the fourth option is to perform a ‘models-only’ search: in this case, the user does not specify any gene but selects one or more models in the Models section (see below), and the system will return the top-scoring hits for those models in the entire genome.</p>
      <p>The Organisms section serves two purposes. The first one is to indicate the genome the user is interested in, for these cases in which this cannot be determined from the inputs. For example, m<sc>rna</sc> accession numbers are organism-specific, while gene names are not (there may be genes in different organisms with the same name). Therefore, when using gene names or when performing a models-only search, it becomes necessary to indicate the genome of interest. The second part of this section allows the user to perform searches based on homology by selecting additional organisms. If one or more of the genes being analyzed has a homolog in the selected organisms, the homologs will be automatically added to the session.</p>
      <p>The Models section is used to specify which models to retrieve hits for. The user can select one or more of the three standard libraries, or enter a list of individual model identifiers. This last option is facilitated by a pop-up window listing all available models. The list can be sorted either by model accession number or by factor name; clicking on an accession number adds the corresponding model to the list.</p>
      <p>When the input parameters have been set, the user should proceed by clicking the button at the bottom of the form. The system will then display a summary page recapitulating the inputs, and the user has the choice to go back to the input page (in case anything needs to be modified) or to start the analysis. While the analysis is running, the system displays a progress indicator and a link that can be used to retrieve the results when ready. Since <sc>mapper</sc><sub>2</sub> sessions run in the background, the user is free to go on using the system to start other sessions, or to leave the site. When the session is complete, the user will receive a notification by email; alternatively, the status of the session can be checked in the ‘My Hitsets’ page at any time.</p>
    </sec>
    <sec sec-type="results">
      <title>Results</title>
      <p>The page displaying analysis results has undergone a total redesign, aimed at making it more useful and effective. The page is divided into two sections: a panel at the top providing information or controls, and a table listing all hits. The contents of the panel are divided into five different subpages, that can be selected using the tabs at the top: ‘Summary’, ‘Inputs’, ‘Filters’, ‘Display’, and ‘Export’.</p>
      <p>The ‘Summary’ page contains general information about the session being displayed, starting with its identifier, a brief description, its status (that will normally be ‘Done’) and the total run time. The next line (‘Displayed run’) contains a menu allowing the user to select the run to be displayed, in case the session contains multiple runs (e.g. when analyzing all genes in a pathway). The ‘Displayed sites’ item shows the number of hits displayed in the table, out of the total number of hits produced.</p>
      <p>The ‘Inputs’ page provides information about the parameters of the run being displayed, including details about the gene (symbol, name, m<sc>rna</sc> accession, organism), the region of the promoter that was scanned and the model libraries used in the analysis.</p>
      <p>The ‘Filters’ page provides commands to change the set of displayed hits. Hits can be selected based on their score, either by entering a threshold value (so that only hits with a score above the threshold are displayed) or by selecting a percentile level from a menu. Since different models have different score distributions, this option allows the user to select high-quality hits independently of the actual numerical values of their scores. This page also allows selecting hits based on the name of the factor they apply to, and highlighting hits in evolutionarily conserved regions.</p>
      <p>The ‘Display’ page contains options to control how hits are displayed in the main table. Currently, they consist of a menu to select how hit coordinates are displayed (absolute on chromosome, relative to transcript start, relative to ATG), and one to select how hits are sorted (by position, score, E-value, factor name or factor accession).</p>
      <p>The ‘Export’ page provides controls to export the hits in a variety of different ways. To start, the user may choose the export format among the following:<list list-type="simple" id="l1"><list-item><p>‘text’ — a delimited file with one row for each hit;</p></list-item><list-item><p>‘alignments’ — similar to text, but including the hit alignment;</p></list-item><list-item><p>‘BED’ — suitable for upload to the UCSC Genome Browser (<xref rid="gkr1080-B12" ref-type="bibr">12</xref>) as a <italic>custom track</italic>;</p></list-item><list-item><p>‘GFF’ — the General Feature Format defined by the Wellcome Trust Sanger Institute.</p></list-item><list-item><p>‘image’ — a graphical representation of the analyzed region showing the position and factor name for all hits.</p></list-item></list></p>
      <p>The user can then select the delimiter to use when generating files in ‘text’ or ‘alignments’ format (tab or comma), and the name of the file (by default, a randomly generated session identifier). Two further controls are available in the ‘Options’ section. When the ‘compress’ checkbox is active, the generated file will be compressed with <monospace>gzip</monospace> for faster downloads. When ‘all results’ is checked, <sc>mapper</sc><sub>2</sub> will produce a file containing hits for all runs in the current session, instead of those of the currently displayed run only. Finally, the user can choose how to receive the exported hits: by downloading a file (using the ‘Export’ button), or by email (using the ‘Email’ button). The page also provides a link to automatically upload the results to the UCSC genome browser and to display them as a custom track.</p>
      <p>The hits table displays all hits that are visible according to the settings in the ‘Display’ section. If the number of hits is over 100, the table is initially hidden, and can be displayed by clicking a button. When the table is visible, it contains 12 columns, showing:
<list list-type="bullet"><list-item><p>gene symbol, entrez identifier and transcript accession number;</p></list-item><list-item><p>accession number of the model that produced the hit and factor name;</p></list-item><list-item><p>strand, chromosome, start and end position of the hit;</p></list-item><list-item><p>hit score and E-value.</p></list-item></list></p>
      <p>Clicking the mouse button over a row opens a box containing more information about the hit in that row. Additional fields displayed in this case include the <sc>ensembl</sc> gene identifier, the hit alignment, the hit position according to all three reference systems (absolute on chromosome, relative to transcript start, relative to ATG) and a flag indicating whether the hit lies in an evolutionarily conserved region. Moreover, several fields in this box are hyperlinks to pages with further information. For example, the Gene ID is linked to the <sc>ncbi</sc> Gene page for that gene; the model accession number is a link to the <sc>mapper</sc><sub>2</sub> page describing that model, and the absolute hit position is a link to the UCSC Genome Browser. <xref ref-type="fig" rid="gkr1080-F1">Figure 1</xref> shows a typical results page for a single-gene database run.
<fig id="gkr1080-F1" position="float"><label>Figure 1.</label><caption><p>The <sc>mapper</sc><sub>2</sub> page displaying results of a single-gene database query. The gray box shows detailed information for the hit in the line directly above it.</p></caption><graphic xlink:href="gkr1080f1"/></fig></p>
    </sec>
  </sec>
  <sec>
    <title>MISCELLANEOUS</title>
    <sec>
      <title>Interoperability</title>
      <p><sc>mapper</sc><sub>2</sub> provides a way for external programs to perform database queries without going through the web-based interface. Requests are submitted in the form of a special <sc>url</sc> that encodes the search parameters (gene identifiers, model accession numbers, score threshold, etc.), and the results are returned as a tab-delimited file in <italic>Alignments</italic> format (see the description of the <italic>Export</italic> command). This mechanism is similar to the one adopted by the <sc>ncbi</sc> Entrez website to implement its EUtils interface (<xref rid="gkr1080-B13" ref-type="bibr">13</xref>). Although it does not provide all the functionality of a true ‘Web-Services’ interface, it is extremely easy to implement and use; <sc>mapper</sc><sub>2</sub> searches can therefore easily be incorporated in automated annotation and analysis pipelines. A description of the available search options and of the way in which the request should be formatted can be obtained by accessing the <sc>db</sc>-<sc>rpc</sc> interface at the <sc>url</sc>
<ext-link ext-link-type="uri" xlink:href="http://genome.ufl.edu/mapper/db-rpc">http://genome.ufl.edu/mapper/db-rpc</ext-link>.</p>
    </sec>
    <sec>
      <title>Hardware and software platforms</title>
      <p>The <sc>mapper</sc><sub>2</sub> database has been moved to a more powerful server at the University of Florida (16-core GNU/Linux machine, 48 GB RAM), and is now directly accessible at the <sc>url</sc>
<ext-link ext-link-type="uri" xlink:href="http://genome.ufl.edu/mapperdb/">http://genome.ufl.edu/mapperdb/</ext-link>. Its previous <sc>url</sc> (<ext-link ext-link-type="uri" xlink:href="http://mapper.chip.org/">http://mapper.chip.org/</ext-link>) is still accessible, but will automatically redirect to the new location.</p>
      <p><sc>mapper</sc><sub>2</sub> is written in Common Lisp, a high-performance object-oriented language ideally suited for complex applications (<xref rid="gkr1080-B14" ref-type="bibr">14</xref>). In addition to upgrading to the 64bit version of the language, we have adopted a package providing ‘persistence’ for internal application objects. This means that <sc>mapper</sc><sub>2</sub> sessions, including input data and result sets, are permanently stored on the server (until the user who generated them decides to delete them) in an automated and secure way. Considering that a result set may contain thousands of hits, this solution is more efficient and reliable than storing them in a separate, external database system, while still providing protection against loss of data due to server crashes.</p>
    </sec>
    <sec>
      <title>Future work</title>
      <p>Future plans for the development of the <sc>mapper</sc><sub>2</sub> database include adding more genomes, and updating the primary binding site data to a more recent version of <sc>transfac</sc>. We are also going to investigate the inclusion of ChIP-Seq data in the database, in order to show which predicted <sc>tfbs</sc>s are in agreement with experimental data.</p>
      <p>In addition, we are performing an analysis on the spatial distribution of binding sites and on the co-occurrence of pairs of binding sites. In the first case, we are interested in determining whether a <sc>tf</sc> preferentially binds at a specific distance upstream of the transcription start site, or if instead its binding sites are uniformly distributed over the promoter. In the second case, we consider each possible pair of models and we determine the distribution of the distances between their hits; if the distribution exhibits one or more peaks, this indicates that the two factors preferentially bind at specific distances from each other. We will perform these analyses on all models in the database, and make the results accessible through the system's interface. These data will help in the interpretation of search results and in the formulation of biological hypotheses based on the spatial arrangement of <sc>tfbs</sc>s. <xref ref-type="fig" rid="gkr1080-F2">Figure 2</xref> shows the distance distribution plot for an example pair of binding sites.
<fig id="gkr1080-F2" position="float"><label>Figure 2.</label><caption><p>Example distance distribution plot for a pair of models. The graph represents the histogram of distances between binding sites for models M00158 (HNF-4) and M00724 (HNF-3α) in mouse. In the vast majority of cases, these binding sites are separated by 100bp, while other distances occur at very low and almost constant frequencies.</p></caption><graphic xlink:href="gkr1080f2"/></fig></p>
    </sec>
  </sec>
  <sec>
    <title>AVAILABILITY</title>
    <p><sc>mapper</sc><sub>2</sub> is freely available to any user. Users are encouraged to create individual accounts, but the system can be used in ‘guest’ mode without any loss of functionality. Accounts provide users with the ability to store generated result sets and private models in a secure area of the website. The contents of the database are available for download as tab-delimited files by request.</p>
  </sec>
  <sec sec-type="conclusions">
    <title>CONCLUSIONS</title>
    <p>The new version of <sc>mapper</sc><sub>2</sub> described in this article represents a significant improvement over the initial one described in Ref. (<xref rid="gkr1080-B4" ref-type="bibr">4</xref>). The contents of the database are constantly being updated as new genome releases and new binding site data become available. The user interface has been completely redesigned for usability and consistency with the rest of the <sc>mapper</sc><sub>2</sub> platform, with which the Database module is now totally integrated. An <sc>http</sc>-based interface allows other programs to query the <sc>mapper</sc><sub>2</sub> database, that can therefore become a component in a distributed annotation and analysis pipeline.</p>
    <p>Future work will be aimed at incorporating experimental data information, such as ChIP-Seq data, to assist in the validation and interpretation of the computational prediction provided by the system. We are also developing methods to analyze the spatial distribution of binding sites in promoters, and the relative distances of pairs of binding sites in order to study interactions between synergistic transcription factors.</p>
  </sec>
  <sec>
    <title>FUNDING</title>
    <p>Funding for open access charge: <funding-source>UF Genetics Institute</funding-source>.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>The author wishes to thank Voichita D. Marinescu and Isaac S. Kohane for their collaboration on previous versions of <sc>mapper</sc>; Eric F. Tsung, Brandon M. Walts, Ettore Rizzo and Eric Hernandez for their contributions to the development of the current version; and the anonymous reviewers for their useful suggestions.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="gkr1080-B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolouri</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Davidson</surname>
            <given-names>EH</given-names>
          </name>
        </person-group>
        <article-title>Modeling transcriptional regulatory networks</article-title>
        <source>Bioessays</source>
        <year>2002</year>
        <volume>24</volume>
        <fpage>1118</fpage>
        <lpage>1129</lpage>
        <pub-id pub-id-type="pmid">12447977</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1080-B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davidson</surname>
            <given-names>EH</given-names>
          </name>
          <name>
            <surname>Rast</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Oliveri</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ransick</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Calestani</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yuh</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Minokawa</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Amore</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hinman</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Arenas-Mena</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A genomic regulatory network for development</article-title>
        <source>Science</source>
        <year>2002</year>
        <volume>295</volume>
        <fpage>1669</fpage>
        <lpage>1678</lpage>
        <pub-id pub-id-type="pmid">11872831</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1080-B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Siggia</surname>
            <given-names>ED</given-names>
          </name>
        </person-group>
        <article-title>Computational methods for transcriptional regulation</article-title>
        <source>Curr. Opin. Genet. Dev.</source>
        <year>2005</year>
        <volume>15</volume>
        <fpage>214</fpage>
        <lpage>221</lpage>
        <pub-id pub-id-type="pmid">15797205</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1080-B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marinescu</surname>
            <given-names>VD</given-names>
          </name>
          <name>
            <surname>Kohane</surname>
            <given-names>IS</given-names>
          </name>
          <name>
            <surname>Riva</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>The MAPPER database: a multi-genome catalog of putative transcription factor binding sites</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>D91</fpage>
        <lpage>D97</lpage>
        <pub-id pub-id-type="pmid">15608292</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1080-B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Badis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Philippakis</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Talukder</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gehrke</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Jaeger</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Metzler</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Vedenko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Diversity and complexity in DNA recognition by transcription factors</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>324</volume>
        <fpage>1720</fpage>
        <lpage>1723</lpage>
        <pub-id pub-id-type="pmid">19443739</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1080-B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kel</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Gssling</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Reuter</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Cheremushkin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kel-Margoulis</surname>
            <given-names>OV</given-names>
          </name>
          <name>
            <surname>Wingender</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>MATCH: a tool for searching transcription factor binding sites in DNA sequences</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>3576</fpage>
        <lpage>3579</lpage>
        <pub-id pub-id-type="pmid">12824369</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1080-B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>A probabilistic model of local alignment that simplifies statistical significance estimation</article-title>
        <source>PLoS Comput Biol</source>
        <year>2008</year>
        <volume>4</volume>
        <fpage>e1000069</fpage>
        <pub-id pub-id-type="pmid">18516236</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1080-B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marinescu</surname>
            <given-names>VD</given-names>
          </name>
          <name>
            <surname>Kohane</surname>
            <given-names>IS</given-names>
          </name>
          <name>
            <surname>Riva</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>MAPPER: a search engine for the computational identification of putative transcription factor binding sites in multiple genomes</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>79</fpage>
        <pub-id pub-id-type="pmid">15799782</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1080-B9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wingender</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Fricke</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Geffers</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hehl</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Liebich</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Krull</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Matys</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Michael</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ohnhuser</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The TRANSFAC system on gene expression regulation</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>281</fpage>
        <lpage>283</lpage>
        <pub-id pub-id-type="pmid">11125113</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1080-B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sandelin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Portales-Casamar</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Thongjuea</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kwon</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Arenillas</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>XB</given-names>
          </name>
          <name>
            <surname>Valen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Yusuf</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lenhard</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wasserman</surname>
            <given-names>WW</given-names>
          </name>
        </person-group>
        <article-title>JASPAR 2010: the greatly expanded open-access database of transcription factor binding profiles</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>D105</fpage>
        <lpage>D110</lpage>
        <pub-id pub-id-type="pmid">19906716</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1080-B11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kanehisa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Goto</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Furumichi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tanabe</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hirakawa</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>KEGG for representation and analysis of molecular networks involving diseases and drugs</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>D355</fpage>
        <lpage>D360</lpage>
        <pub-id pub-id-type="pmid">19880382</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1080-B12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dreszer</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Rhead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Clawson</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Barber</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Karolchik</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kuhn</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Hinrichs</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Zweig</surname>
            <given-names>AS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The UCSC genome browser database: update 2010</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>D613</fpage>
        <lpage>D619</lpage>
        <pub-id pub-id-type="pmid">19906737</pub-id>
      </element-citation>
    </ref>
    <ref id="gkr1080-B13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sayers</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <source>E-utilities quick start.</source>
        <year>2008</year>
        <comment>
          <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/books/NBK25500/">http://www.ncbi.nlm.nih.gov/books/NBK25500/ (17 November 2011, date last accessed)</ext-link>
        </comment>
      </element-citation>
    </ref>
    <ref id="gkr1080-B14">
      <label>14</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Seibel</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <source>Practical Common Lisp</source>
        <year>2005</year>
        <publisher-loc>NY, USA</publisher-loc>
        <publisher-name>Apress</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
