<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">G3 (Bethesda)</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genetics</journal-id>
    <journal-id journal-id-type="publisher-id">g3journal</journal-id>
    <journal-title-group>
      <journal-title>G3: Genes|Genomes|Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2160-1836</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9526038</article-id>
    <article-id pub-id-type="pmid">35976111</article-id>
    <article-id pub-id-type="doi">10.1093/g3journal/jkac206</article-id>
    <article-id pub-id-type="publisher-id">jkac206</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Investigation</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01180</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI00010</subject>
        <subject>AcademicSubjects/SCI00960</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>impMKT: the imputed McDonald and Kreitman test, a straightforward correction that significantly increases the evidence of positive selection of the McDonald and Kreitman test at the gene level</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1812-0399</contrib-id>
        <name>
          <surname>Murga-Moreno</surname>
          <given-names>Jesús</given-names>
        </name>
        <aff><institution>Institute of Biotechnology and Biomedicine, Universitat Autònoma de Barcelona</institution>, Barcelona 08193, <country country="ES">Spain</country></aff>
        <aff><institution>Department of Genetics and Microbiology, Universitat Autònoma de Barcelona</institution>, Barcelona 08193, <country country="ES">Spain</country></aff>
        <xref rid="jkac206-cor1" ref-type="corresp"/>
        <!--jesus.murga@uab.cat-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9779-9661</contrib-id>
        <name>
          <surname>Coronado-Zamora</surname>
          <given-names>Marta</given-names>
        </name>
        <aff><institution>Institute of Biotechnology and Biomedicine, Universitat Autònoma de Barcelona</institution>, Barcelona 08193, <country country="ES">Spain</country></aff>
        <aff><institution>Department of Genetics and Microbiology, Universitat Autònoma de Barcelona</institution>, Barcelona 08193, <country country="ES">Spain</country></aff>
        <xref rid="jkac206-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8191-0062</contrib-id>
        <name>
          <surname>Casillas</surname>
          <given-names>Sònia</given-names>
        </name>
        <aff><institution>Institute of Biotechnology and Biomedicine, Universitat Autònoma de Barcelona</institution>, Barcelona 08193, <country country="ES">Spain</country></aff>
        <aff><institution>Department of Genetics and Microbiology, Universitat Autònoma de Barcelona</institution>, Barcelona 08193, <country country="ES">Spain</country></aff>
        <xref rid="jkac206-cor1" ref-type="corresp"/>
        <!--sonia.casillas@uab.cat-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0374-1475</contrib-id>
        <name>
          <surname>Barbadilla</surname>
          <given-names>Antonio</given-names>
        </name>
        <aff><institution>Institute of Biotechnology and Biomedicine, Universitat Autònoma de Barcelona</institution>, Barcelona 08193, <country country="ES">Spain</country></aff>
        <aff><institution>Department of Genetics and Microbiology, Universitat Autònoma de Barcelona</institution>, Barcelona 08193, <country country="ES">Spain</country></aff>
        <xref rid="jkac206-cor1" ref-type="corresp"/>
        <!--antonio.barbadilla@uab.es-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Comeron</surname>
          <given-names>J</given-names>
        </name>
        <role>Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="jkac206-FM1">
        <p>Present address for Marta Coronado-Zamora: Institute of Evolutionary Biology, CSIC-Universitat Pompeu Fabra, Barcelona 08003, Spain</p>
      </fn>
      <corresp id="jkac206-cor1">Corresponding author: Institute of Biotechnology and Biomedicine, Universitat Autònoma de Barcelona, Bellaterra, Barcelona 08193, Spain. Email: <email>jesus.murga@uab.cat</email> (JM-M); Corresponding author: Institute of Biotechnology and Biomedicine, Universitat Autònoma de Barcelona, Bellaterra, Barcelona 08193, Spain. Email: <email>sonia.casillas@uab.cat</email> (SC); Corresponding author: Institute of Biotechnology and Biomedicine, Universitat Autònoma de Barcelona, Bellaterra, Barcelona 08193, Spain. Email: <email>antonio.barbadilla@uab.es</email> (AB)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-08-17">
      <day>17</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <volume>12</volume>
    <issue>10</issue>
    <elocation-id>jkac206</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>3</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>07</day>
        <month>9</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press on behalf of Genetics Society of America.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="jkac206.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>The McDonald and Kreitman test is one of the most powerful and widely used methods to detect and quantify recurrent natural selection in DNA sequence data. One of its main limitations is the underestimation of positive selection due to the presence of slightly deleterious variants segregating at low frequencies. Although several approaches have been developed to overcome this limitation, most of them work on gene pooled analyses. Here, we present the imputed McDonald and Kreitman test (impMKT), a new straightforward approach for the detection of positive selection and other selection components of the distribution of fitness effects at the gene level. We compare imputed McDonald and Kreitman test with other widely used McDonald and Kreitman test approaches considering both simulated and empirical data. By applying imputed McDonald and Kreitman test to humans and <italic toggle="yes">Drosophila</italic> data at the gene level, we substantially increase the statistical evidence of positive selection with respect to previous approaches (e.g. by 50% and 157% compared with the McDonald and Kreitman test in <italic toggle="yes">Drosophila</italic> and humans, respectively). Finally, we review the minimum number of genes required to obtain a reliable estimation of the proportion of adaptive substitution (<italic toggle="yes">α</italic>) in gene pooled analyses by using the imputed McDonald and Kreitman test compared with other McDonald and Kreitman test implementations. Because of its simplicity and increased power to detect recurrent positive selection on genes, we propose the imputed McDonald and Kreitman test as the first straightforward approach for testing specific evolutionary hypotheses at the gene level. The software implementation and population genomics data are available at the web-server <underline>imkt.uab.cat</underline>.</p>
    </abstract>
    <kwd-group>
      <kwd>natural selection</kwd>
      <kwd>McDonald and Kreitman test</kwd>
      <kwd>nucleotide variation</kwd>
      <kwd>positive selection</kwd>
      <kwd>protein-coding genes</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Ministerio de Economía y Empresa and Ministerio de Ciencia e Innovación y Agencia Estatal de Investigación</institution>
          </institution-wrap>
        </funding-source>
        <award-id>PID2021-127107NB-I00</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="14"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Natural selection leaves characteristic footprints at the patterns of genetic variation. Since the advent of next-generation sequencing, numerous statistical methods have been proposed to analyze genomic data (<xref rid="jkac206-B11" ref-type="bibr">Casillas and Barbadilla 2017</xref>), allowing the detection and quantification of molecular adaptation at different temporal scales. The McDonald and Kreitman test (MKT) (<xref rid="jkac206-B36" ref-type="bibr">McDonald and Kreitman 1991</xref>) is one of the most powerful and robust methods to detect the action of recurrent natural selection at the DNA level. Unlike the <italic toggle="yes">ω</italic> ratio (<xref rid="jkac206-B32" ref-type="bibr">Kimura 1977</xref>), which compares the number of synonymous (<italic toggle="yes">D<sub>S</sub></italic>) and nonsynonymous (<italic toggle="yes">D<sub>N</sub></italic>) divergent sites, the MKT combines both divergence (<italic toggle="yes">D<sub>S</sub></italic>, <italic toggle="yes">D<sub>N</sub></italic>) and polymorphism (<italic toggle="yes">P<sub>S</sub></italic>, <italic toggle="yes">P<sub>N</sub></italic>) data. Polymorphic data allows taking into account purifying selection on divergent nonsynonymous sites, significantly increasing the power of detecting recurrent positive selection.</p>
    <p>The null model of the original MKT approach is the neutral theory (<xref rid="jkac206-B31" ref-type="bibr">Kimura 1968</xref>, <xref rid="jkac206-B32" ref-type="bibr">1977</xref>; <xref rid="jkac206-B41" ref-type="bibr">Ohta 1973</xref>). It assumes that positively selected (adaptive) mutations are rare, and thus not easily observable when polymorphic sequences are sampled at a given time <italic toggle="yes">t</italic>, thus contributing almost exclusively to divergence (and not to polymorphism). Therefore, an excess of the divergence ratio relative to the polymorphism ratio is the signal of positive selection acting on nonsynonymous sites (<inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> &gt; <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>). Temporally, the MKT covers the evolutionary period spanning from the present to the time back to divergence between the target and the outgroup species, and it allows the estimation of the fraction of adaptive nonsynonymous substitutions (<italic toggle="yes">α</italic>) (<xref rid="jkac206-B14" ref-type="bibr">Charlesworth 1994</xref>; <xref rid="jkac206-B46" ref-type="bibr">Smith and Eyre-Walker 2002</xref>). Nonetheless, the MKT, as originally formulated, has multiple drawbacks that could bias the estimation of <italic toggle="yes">α</italic>. First, the MKT assumes strict neutrality on segregating (polymorphic) sites. However, several studies in multiple species have shown an excess of low-frequency variants (<xref rid="jkac206-B46" ref-type="bibr">Smith and Eyre-Walker 2002</xref>; <xref rid="jkac206-B37" ref-type="bibr">Messer and Petrov 2013</xref>; <xref rid="jkac206-B23" ref-type="bibr">Galtier 2016</xref>). These variants are attributed to slightly deleterious mutations (SDM), which will not usually reach fixation, contributing more to polymorphism than divergence. SDM reduce the MKT statistical power and underestimate <italic toggle="yes">α</italic> (<xref rid="jkac206-B19" ref-type="bibr">Eyre-Walker and Keightley 2009</xref>). Second, MKT assumes that the neutral mutation rate is constant over time and so is the selective constraint. However, the nearly neutral mutation rate depends on the effective population size (<italic toggle="yes">N<sub>e</sub></italic>) (<xref rid="jkac206-B3" ref-type="bibr">Balloux and Lehmann 2012</xref>; <xref rid="jkac206-B34" ref-type="bibr">Lanfear <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="jkac206-B44" ref-type="bibr">Rousselle <italic toggle="yes">et al.</italic> 2018</xref>; <xref rid="jkac206-B24" ref-type="bibr">Galtier and Rousselle 2020</xref>) and, therefore, changes in population size can affect the MKT considerably. SDM get fixed at higher rates in populations with past smaller sizes, contributing to divergence and leading to an overestimation of <italic toggle="yes">α</italic> (<xref rid="jkac206-B19" ref-type="bibr">Eyre-Walker and Keightley 2009</xref>). Besides, recent evidence shows that weakly advantageous mutations can also be segregating within populations (<xref rid="jkac206-B23" ref-type="bibr">Galtier 2016</xref>; <xref rid="jkac206-B49" ref-type="bibr">Tataru <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="jkac206-B51" ref-type="bibr">Uricchio <italic toggle="yes">et al.</italic> 2019</xref>). The presence of this positively selected polymorphism, like SDM, can mask the effect of adaptive selection, since it counteracts the excess of the divergence ratio relative to the polymorphism tested by the MKT.</p>
    <p>Over the last decades, several modifications in the original MKT have been proposed to account for the potential biases in the estimation of <italic toggle="yes">α</italic> (<xref rid="jkac206-B50" ref-type="bibr">Templeton 1996</xref>; <xref rid="jkac206-B21" ref-type="bibr">Fay <italic toggle="yes">et al.</italic> 2001</xref>; <xref rid="jkac206-B19" ref-type="bibr">Eyre-Walker and Keightley 2009</xref>; <xref rid="jkac206-B35" ref-type="bibr">Mackay <italic toggle="yes">et al.</italic> 2012</xref>; <xref rid="jkac206-B37" ref-type="bibr">Messer and Petrov 2013</xref>; <xref rid="jkac206-B23" ref-type="bibr">Galtier 2016</xref>). Most of these extensions deal with the presence of SDM. Although other forces affect the site frequency spectrum (SFS) of segregating variants, such as recombination, demography, ancestral population sizes, or weak positive selection, several studies have pointed out the relevance of SDM (<xref rid="jkac206-B20" ref-type="bibr">Eyre-Walker <italic toggle="yes">et al.</italic> 2006</xref>; <xref rid="jkac206-B19" ref-type="bibr">Eyre-Walker and Keightley 2009</xref>). SDM distort the nonsynonymous SFS and have been repeatedly shown to be a main factor biasing <italic toggle="yes">α</italic> downwards (<xref rid="jkac206-B15" ref-type="bibr">Charlesworth and Eyre-Walker 2008</xref>; <xref rid="jkac206-B19" ref-type="bibr">Eyre-Walker and Keightley 2009</xref>; <xref rid="jkac206-B21" ref-type="bibr">Fay <italic toggle="yes">et al.</italic> 2001</xref>; <xref rid="jkac206-B23" ref-type="bibr">Galtier 2016</xref>).</p>
    <p>New model-based approaches for the estimation of <italic toggle="yes">α</italic> have benefited from the increasing number of genomics data sets available, which allow dealing, implicitly or explicitly, with the underlying distribution of fitness effects (DFE) of new mutations, including the presence of SDM or controlling for correlated genomic features (<xref rid="jkac206-B19" ref-type="bibr">Eyre-Walker and Keightley 2009</xref>; <xref rid="jkac206-B37" ref-type="bibr">Messer and Petrov 2013</xref>; <xref rid="jkac206-B23" ref-type="bibr">Galtier 2016</xref>; <xref rid="jkac206-B49" ref-type="bibr">Tataru <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="jkac206-B51" ref-type="bibr">Uricchio <italic toggle="yes">et al.</italic> 2019</xref>; <xref rid="jkac206-B29" ref-type="bibr">Huang 2021</xref>). However, these advanced methodologies need extensive data sets to fit complex parametric evolutionary models by applying maximum likelihood (ML) inference, exponential fitting or generalized linear models and they work properly for genome-wide analyses or on large pools of genes. In contrast, these methodologies are rarely applicable over specific genes to test particular evolutionary hypotheses, as the original MKT does (<xref rid="jkac206-B36" ref-type="bibr">McDonald and Kreitman 1991</xref>).</p>
    <p>While more and more genome-wide analyses of evolution of protein coding genes have been carried out through these MKT extensions, the simple G-test or the independence chi-square test of the original MKT (<xref rid="jkac206-B36" ref-type="bibr">McDonald and Kreitman 1991</xref>) is currently almost deprecated. Most MKT heuristic alternatives exclude all variants below a frequency threshold for the minor frequency allele (MAF) (<xref rid="jkac206-B50" ref-type="bibr">Templeton 1996</xref>; <xref rid="jkac206-B1" ref-type="bibr">Akashi 1999</xref>; <xref rid="jkac206-B21" ref-type="bibr">Fay <italic toggle="yes">et al.</italic> 2001</xref>). Since the MAF distribution resembles an exponential one, dropping these data inevitably leads to the loss of most of the polymorphic information, consequently performing very poorly on gene-by-gene testing.</p>
    <p>Here, we present the imputed MKT (impMKT), a modification of the Fay, Waycoff, and Wu MKT approach (fwwMKT) (<xref rid="jkac206-B21" ref-type="bibr">Fay <italic toggle="yes">et al.</italic> 2001</xref>) to improve gene-by-gene analyses. We propose a methodology that imputes the proportion of SDM at the SFS rather than removing all variants below a frequency threshold. The impMKT maximizes the information to test the excess of divergence ratio relative to polymorphism at the gene level. We compare our imputation method to previous and recent MKT approaches, using simulated data to test its accuracy and efficiency. Moreover, we test the impMKT on the human African lineage samples of the 1000 Genome Project (1000GP) (<xref rid="jkac206-B2" ref-type="bibr">Auton <italic toggle="yes">et al.</italic> 2015</xref>) and the Zambian population of the <italic toggle="yes">Drosophila</italic> Genome Nexus (DGN) (<xref rid="jkac206-B33" ref-type="bibr">Lack <italic toggle="yes">et al.</italic> 2016</xref>). impMKT considerably increases the number of statistically significant genes under positive selection in Drosophila and humans, respectively, compared to other MKT approaches. Despite the limitations of heuristic MKT and MKT-derived methods, the impMKT has the advantages of simplicity, intuitiveness, ease of use, and increased statistical power to test recurrent positive selection on genes; thus, it can be used as a first straightforward approach for testing specific evolutionary hypotheses at the gene level.</p>
  </sec>
  <sec>
    <title>Materials and methods</title>
    <sec>
      <title>Simulated data</title>
      <p>We used SLiM 3 (<xref rid="jkac206-B27" ref-type="bibr">Haller and Messer 2019</xref>) to test the accuracy and performance of the impMKT compared to other MKT approaches on simulated data. We tested 15 different genetic scenarios following the procedure proposed by <xref rid="jkac206-B10" ref-type="bibr">Campos and Charlesworth (2019)</xref> and <xref rid="jkac206-B6" ref-type="bibr">Booker (2020)</xref>.</p>
      <p>We simulated the evolution of a population of 10,000 diploid individuals for 220,000 generations while setting a uniform population-scaled mutation and recombination rates of <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msub><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msub><mml:mo>μ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>. To improve performance, we rescaled by a factor of 10 and substitutions were recorded <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mn>14</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> generations after burn-in following <xref rid="jkac206-B6" ref-type="bibr">Booker (2020)</xref>. Each simulation contained 7 genes spaced by 8,100 bp neutral intergenic regions. For each gene, we simulated 5 exons of 300 bp separated by 100 bp neutrally evolving introns. We assumed a proportion of 0.25 and 0.75 for synonymous and nonsynonymous alleles, respectively. Deleterious alleles were modeled following a Gamma distribution, whereas beneficial alleles were modeled following a point-mass distribution. We assumed that the Gamma distribution of deleterious alleles followed a shape parameter (<italic toggle="yes">β</italic>) of 0.3, and population-scaled selection coefficients of <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>−</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mn>2000</mml:mn></mml:mrow></mml:math></inline-formula>. For beneficial alleles, we assumed a population-scaled selection coefficients <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mn>250</mml:mn></mml:mrow></mml:math></inline-formula>. We solved the analytical estimations described in <xref rid="jkac206-B51" ref-type="bibr">Uricchio <italic toggle="yes">et al.</italic> (2019)</xref> using the corresponding software (<ext-link xlink:href="https://github.com/uricchio/mktest" ext-link-type="uri">https://github.com/uricchio/mktest</ext-link>) to input the fixation probabilities of strong and weakly beneficial alleles. We considered a total adaptation rate of <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math></inline-formula> while setting as 50% the proportion of adaptation due to weakly beneficial alleles (<inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>W</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>α</mml:mo><mml:mo>·</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>). We used the estimated fixation probabilities to define the relative proportion of strong beneficial, weak beneficial, and deleterious alleles as <italic toggle="yes">p<sub>s</sub></italic>, <italic toggle="yes">p<sub>w</sub></italic>, and <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mn>0.75</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, respectively, in our model.</p>
      <p>We performed 2,000 replicas, totalizing 14,000 simulated genes (2,000 replicas × 7 genes), sampling 20 individuals. Besides, 7 parameters were modified to test for multiple scenarios (see <xref rid="jkac206-T1" ref-type="table">Table 1</xref>). Each scenario independently replaces a genetic feature to identify limitations and advantages of the method regarding the underlying DFE, the global adaptation rate, or the number of polymorphic sites.</p>
      <table-wrap position="float" id="jkac206-T1">
        <label>Table 1.</label>
        <caption>
          <p>SLiM simulated parameters.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Simulations</th>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">N<sub>e</sub></italic>
              </th>
              <th rowspan="1" colspan="1">Samples</th>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE10">
                  <mml:math id="IM10" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                        <mml:mi>e</mml:mi>
                      </mml:msub>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                        <mml:mo>−</mml:mo>
                      </mml:msub>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </th>
              <th rowspan="1" colspan="1">
                <inline-formula id="IE11">
                  <mml:math id="IM11" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                        <mml:mi>e</mml:mi>
                      </mml:msub>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                      </mml:msub>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </th>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">β</italic>
              </th>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">p<sub>a</sub></italic>
              </th>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">ρ</italic>
              </th>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">θ</italic>
              </th>
              <th rowspan="1" colspan="1">Genes</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Baseline</td>
              <td rowspan="1" colspan="1">10,000</td>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">−2,000</td>
              <td rowspan="1" colspan="1">250</td>
              <td rowspan="1" colspan="1">0.3</td>
              <td rowspan="1" colspan="1">0.00021</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">14,000</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE12">
                  <mml:math id="IM12" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                        <mml:mi>e</mml:mi>
                      </mml:msub>
                      <mml:mi>s</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mo>=</mml:mo>
                      <mml:mn>500</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">10,000</td>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">−2,000</td>
              <td rowspan="1" colspan="1">500</td>
              <td rowspan="1" colspan="1">0.3</td>
              <td rowspan="1" colspan="1">0.00012</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">14,000</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE13">
                  <mml:math id="IM13" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                        <mml:mi>e</mml:mi>
                      </mml:msub>
                      <mml:mi>s</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mo>=</mml:mo>
                      <mml:mn>100</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">10,000</td>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">−2,000</td>
              <td rowspan="1" colspan="1">100</td>
              <td rowspan="1" colspan="1">0.3</td>
              <td rowspan="1" colspan="1">0.00048</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">14,000</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE14">
                  <mml:math id="IM14" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                        <mml:mi>e</mml:mi>
                      </mml:msub>
                      <mml:mi>s</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1000</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">10,000</td>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">−1,000</td>
              <td rowspan="1" colspan="1">250</td>
              <td rowspan="1" colspan="1">0.3</td>
              <td rowspan="1" colspan="1">0.00021</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">14,000</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE15">
                  <mml:math id="IM15" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                        <mml:mi>e</mml:mi>
                      </mml:msub>
                      <mml:mi>s</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mo>=</mml:mo>
                      <mml:mn>500</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">10,000</td>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">−500</td>
              <td rowspan="1" colspan="1">250</td>
              <td rowspan="1" colspan="1">0.3</td>
              <td rowspan="1" colspan="1">0.00021</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">14,000</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE16">
                  <mml:math id="IM16" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mo>β</mml:mo>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0.1</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">10,000</td>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">−2,000</td>
              <td rowspan="1" colspan="1">250</td>
              <td rowspan="1" colspan="1">0.1</td>
              <td rowspan="1" colspan="1">0.00115</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">14,000</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE17">
                  <mml:math id="IM17" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mo>β</mml:mo>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0.2</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">10,000</td>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">−2,000</td>
              <td rowspan="1" colspan="1">250</td>
              <td rowspan="1" colspan="1">0.2</td>
              <td rowspan="1" colspan="1">0.00048</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">14,000</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">28,000 genes</td>
              <td rowspan="1" colspan="1">10,000</td>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">−2,000</td>
              <td rowspan="1" colspan="1">250</td>
              <td rowspan="1" colspan="1">0.3</td>
              <td rowspan="1" colspan="1">0.00021</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">28,000</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2,000 genes</td>
              <td rowspan="1" colspan="1">1,000</td>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">−2,000</td>
              <td rowspan="1" colspan="1">250</td>
              <td rowspan="1" colspan="1">0.3</td>
              <td rowspan="1" colspan="1">0.00021</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">2,000</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE18">
                  <mml:math id="IM18" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mo>ρ</mml:mo>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0.01</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">10,000</td>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">−2,000</td>
              <td rowspan="1" colspan="1">250</td>
              <td rowspan="1" colspan="1">0.3</td>
              <td rowspan="1" colspan="1">0.00021</td>
              <td rowspan="1" colspan="1">0.01</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">14,000</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE19">
                  <mml:math id="IM19" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mo>ρ</mml:mo>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0.0001</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">10,000</td>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">−2,000</td>
              <td rowspan="1" colspan="1">250</td>
              <td rowspan="1" colspan="1">0.3</td>
              <td rowspan="1" colspan="1">0.00021</td>
              <td rowspan="1" colspan="1">0.0001</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">14,000</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE20">
                  <mml:math id="IM20" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mo>θ</mml:mo>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0.01</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">10,000</td>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">−2,000</td>
              <td rowspan="1" colspan="1">250</td>
              <td rowspan="1" colspan="1">0.3</td>
              <td rowspan="1" colspan="1">0.00021</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">0.01</td>
              <td rowspan="1" colspan="1">14,000</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE21">
                  <mml:math id="IM21" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mo>θ</mml:mo>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0.0001</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">10,000</td>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">−2,000</td>
              <td rowspan="1" colspan="1">250</td>
              <td rowspan="1" colspan="1">0.3</td>
              <td rowspan="1" colspan="1">0.00021</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">0.0001</td>
              <td rowspan="1" colspan="1">14,000</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE22">
                  <mml:math id="IM22" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mo>α</mml:mo>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0.1</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">10,000</td>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">−2,000</td>
              <td rowspan="1" colspan="1">250</td>
              <td rowspan="1" colspan="1">0.3</td>
              <td rowspan="1" colspan="1">0.000036</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">14,000</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE23">
                  <mml:math id="IM23" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mo>α</mml:mo>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0.1</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">10,000</td>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">−2,000</td>
              <td rowspan="1" colspan="1">250</td>
              <td rowspan="1" colspan="1">0.3</td>
              <td rowspan="1" colspan="1">0.00075</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">0.001</td>
              <td rowspan="1" colspan="1">14,000</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic toggle="yes">N<sub>e</sub></italic>: effective population size; <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msub><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula>: population-scaled selection coefficient; <italic toggle="yes">β</italic>: shape parameter of the Gamma distribution; <italic toggle="yes">p<sub>a</sub></italic>: relative proportion of advantageous mutations; <italic toggle="yes">ρ</italic>: population-scaled recombination rate; <italic toggle="yes">θ</italic>: population-scaled mutation rate; and <italic toggle="yes">α</italic>: proportion of adaptive mutation.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title><italic toggle="yes">Drosophila</italic><italic toggle="yes">melanogaster</italic> and human data</title>
      <p>We followed the pipeline described at <xref rid="jkac206-B39" ref-type="bibr">Murga-Moreno <italic toggle="yes">et al.</italic> (2019)</xref> to retrieve polymorphic and divergence genome data from <italic toggle="yes">D. melanogaster</italic> and the human lineage.</p>
      <p>In brief, for <italic toggle="yes">D. melanogaster</italic> we retrieved polymorphic and divergence data from the DGN data, using the genome sequence of <italic toggle="yes">Drosophila simulans</italic> as outgroup (release 2) (<xref rid="jkac206-B33" ref-type="bibr">Lack <italic toggle="yes">et al.</italic> 2016</xref>). Specifically, we subset data from 13,753 protein-coding genes from the Zambian population (197 individuals). We binned the output SFS considering a sample of 20 individuals. The ancestral state of each segregating site was inferred from the sequence comparison with the outgroup species <italic toggle="yes">D. simulans</italic>. The <italic toggle="yes">D. melanogaster</italic> genome reference sequence and annotations correspond to the 5.57 FlyBase release. Gene-associated recombination rate estimates at 100-kb nonoverlapping windows were retrieved from <xref rid="jkac206-B16" ref-type="bibr">Comeron <italic toggle="yes">et al.</italic> (2012)</xref>.</p>
      <p>For the human lineage, we retrieved polymorphic data and ancestral states for all African populations of the 1000GP Phase III (<xref rid="jkac206-B2" ref-type="bibr">Auton <italic toggle="yes">et al.</italic> 2015</xref>). We used chimpanzee (<italic toggle="yes">Pan troglodytes</italic>) as the outgroup species to compute human divergence metrics. We downloaded hg19-panTro4 alignment from PopHuman (<xref rid="jkac206-B12" ref-type="bibr">Casillas <italic toggle="yes">et al.</italic> 2018</xref>). Annotations retrieved from GENCODE (release 27) (<xref rid="jkac206-B17" ref-type="bibr">Derrien <italic toggle="yes">et al.</italic> 2012</xref>) were used to assess the functional class of each genomic position. Recombination rate values associated with each protein-coding gene were obtained from <xref rid="jkac206-B4" ref-type="bibr">Bhérer <italic toggle="yes">et al.</italic> (2017)</xref> and correspond to the sex-average estimates. We retrieved polymorphic and divergence data from 20,643 protein-coding genes. We binned the output SFS considering a sample of 20 individuals.</p>
    </sec>
    <sec>
      <title>MKT approaches</title>
      <p>To test the performance and accuracy of the impMKT, we compared it against 4 already published heuristic MKT methods:
</p>
      <list list-type="roman-lower">
        <list-item>
          <p>the original MKT (<xref rid="jkac206-B36" ref-type="bibr">McDonald and Kreitman 1991</xref>);</p>
        </list-item>
        <list-item>
          <p>the Fay, Wickoff and Wu correction (fwwMKT) (<xref rid="jkac206-B21" ref-type="bibr">Fay <italic toggle="yes">et al.</italic> 2001</xref>) (see next section);</p>
        </list-item>
        <list-item>
          <p>the extended MKT (eMKT) (<xref rid="jkac206-B35" ref-type="bibr">Mackay <italic toggle="yes">et al.</italic> 2012</xref>) where <italic toggle="yes">P<sub>N</sub></italic>, the count of segregating sites in the nonsynonymous class is decomposed in neutral and weakly deleterious variants. Deleterious variants are assumed be only below a frequency threshold and the remaining neutral fraction is estimated from the synonymous class (<italic toggle="yes">P<sub>S</sub></italic>). For a 15% threshold, the estimators are as follows:
<disp-formula id="E1"><mml:math id="M1" display="block" overflow="scroll"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mtext>neutral</mml:mtext><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>neutral</mml:mtext><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext>neutral</mml:mtext><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>neutral</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>neutral</mml:mtext><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>≥</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
          <p>The estimated <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>neutral</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> values can be used to perform both MKT and <italic toggle="yes">α</italic> estimations.</p>
        </list-item>
        <list-item>
          <p>the asymptotic MKT (aMKT) (<xref rid="jkac206-B37" ref-type="bibr">Messer and Petrov 2013</xref>), which defines <italic toggle="yes">α</italic> as a function that depends on the SFS of alleles. Hence, <italic toggle="yes">α</italic> is estimated in different frequency intervals. Given the frequency spectrum distribution in the frequency interval <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, the estimate of <italic toggle="yes">α<sub>x</sub></italic> results in an exponential function of the form <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The best fit of the exponential at <italic toggle="yes">x</italic> = 1 eliminates the effect of SDM. We followed <xref rid="jkac206-B26" ref-type="bibr">Haller and Messer (2017)</xref> to choose the cutoffs for the aMKT estimations.</p>
        </list-item>
      </list>
      <p>In addition, we included the Grapes software (<xref rid="jkac206-B23" ref-type="bibr">Galtier 2016</xref>), an ML method fitting the DFE. We ran Grapes using the Gamma-zero DFE distribution and estimated <italic toggle="yes">α</italic> for 100 bootstrap datasets. In addition, when incorporating weak adaptation in the simulations, a gamma-exponential was run. We measured <italic toggle="yes">α</italic> confidence interval (CI) through the boundaries for <italic toggle="yes">α</italic> estimation in Grapes using <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>_</mml:mo><mml:mi mathvariant="italic">down</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>_</mml:mo><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> parameters independently for each bootstrapped dataset (<xref rid="jkac206-B23" ref-type="bibr">Galtier 2016</xref>).</p>
      <p>aMKT and Grapes (as well other DFE-related methods) are commonly used to estimate <italic toggle="yes">α</italic> using a large pool of genes or genome-wide data (<xref rid="jkac206-B37" ref-type="bibr">Messer and Petrov 2013</xref>; <xref rid="jkac206-B43" ref-type="bibr">Rousselle <italic toggle="yes">et al.</italic> 2019</xref>). Both methodologies have been previously shown to perform the most accurate estimations in the presence of SDM and demography events (<xref rid="jkac206-B19" ref-type="bibr">Eyre-Walker and Keightley 2009</xref>; <xref rid="jkac206-B37" ref-type="bibr">Messer and Petrov 2013</xref>). Since impMKT is specially designed to perform gene-by-gene analyses, we tried to determine in which cases the amount of data was large enough to perform estimations using aMKT and Grapes compared to impMKT.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>impMKT</title>
      <p>Our main goal is to devise a derived MKT approach that enhances the power to detect selection at the gene level. To do this, we modified the approach proposed by <xref rid="jkac206-B21" ref-type="bibr">Fay <italic toggle="yes">et al.</italic> (2001)</xref> (fwwMKT), which removes all nonsynonymous (<italic toggle="yes">P<sub>N</sub></italic>) and synonymous (<italic toggle="yes">P<sub>S</sub></italic>) polymorphic sites below a derived allele frequency cutoff <italic toggle="yes">j</italic>, assuming that SDM segregate at low frequencies. Removing variants below a cutoff, typically 5% or 15% (<xref rid="jkac206-B21" ref-type="bibr">Fay <italic toggle="yes">et al.</italic> 2001</xref>; <xref rid="jkac206-B35" ref-type="bibr">Mackay <italic toggle="yes">et al.</italic> 2012</xref>), implies losing a considerable amount of data. Consider the example of <xref rid="jkac206-B40" ref-type="bibr">Nielsen and Slatkin (2013)</xref> for the standard neutral coalescence model: a 15% cutoff implies up to 44% of excluded variants of the expected SFS for a sample of <italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>10 haploid individuals. We observed the same trend considering the <italic toggle="yes">D. melanogaster</italic> and human data, for which considering a virtual gene containing the mean polymorphic level a 15% cutoff implies up to 80% of excluded variants of the expected SFS for <italic toggle="yes">D. melanogaster</italic> and up to 90% in humans. This amount of data exclusion may make the computation of the MKT impracticable, especially in species with low levels of polymorphism.</p>
      <p>Here, we propose a new MKT approach that modifies the fwwMKT to impute the actual number of SDM (<italic toggle="yes">P<sub>wd</sub></italic>) segregating within <italic toggle="yes">P<sub>N</sub></italic>. The resulting approach, impMKT, just removes the imputed number of SDM instead of all polymorphism segregating below a given threshold as fwwMKT does, thus retaining a larger fraction of the data and increasing the power to detect positive selection.</p>
      <p>Consider the SFS and fixed differences of a hypothetical gene as illustrated by <xref rid="jkac206-B25" ref-type="bibr">Hahn (2018)</xref> (<xref rid="jkac206-F1" ref-type="fig">Fig. 1</xref>). <xref rid="jkac206-T2" ref-type="table">Table 2</xref> shows the 2 × 2 contingency tables to perform the original MKT, fwwMKT and impMKT. <xref rid="jkac206-B15" ref-type="bibr">Charlesworth and Eyre-Walker (2008)</xref> investigated how the removal of low-frequency polymorphism affects the estimation of different MKT approaches depending on the continuous function defining the DFE for different nonarbitrary cutoffs. To develop the impMKT, we followed <xref rid="jkac206-B15" ref-type="bibr">Charlesworth and Eyre-Walker (2008)</xref> results, which show that any derived allele frequency cutoff <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> is a near-optimal solution to the problem of SDM segregating at the SFS (<xref rid="jkac206-B15" ref-type="bibr">Charlesworth and Eyre-Walker 2008</xref>).</p>
      <fig position="float" id="jkac206-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Hypothetical SFS and fixed differences from <xref rid="jkac206-B25" ref-type="bibr">Hahn (2018)</xref>.</p>
        </caption>
        <graphic xlink:href="jkac206f1" position="float"/>
      </fig>
      <table-wrap position="float" id="jkac206-T2">
        <label>Table 2.</label>
        <caption>
          <p>Contingency tables.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">Polymorphism</th>
              <th rowspan="1" colspan="1">Divergence</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="3" rowspan="1">(A) Definition of the MKT 2 × 2 contingency table</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Nonsynonymous</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE31">
                  <mml:math id="IM31" display="inline" overflow="scroll">
                    <mml:msub>
                      <mml:mi>P</mml:mi>
                      <mml:mtext>Neutral</mml:mtext>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:msub>
                      <mml:mi>P</mml:mi>
                      <mml:mi>N</mml:mi>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:msub>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mi>w</mml:mi>
                        <mml:mi>d</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">P<sub>S</sub></italic>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Synonymous</td>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">D<sub>N</sub></italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">D<sub>S</sub></italic>
              </td>
            </tr>
            <tr>
              <td colspan="3" rowspan="1">(B) Example of MKT 2 × 2 contingency table. Including all polymorphic sites</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Nonsynonymous</td>
              <td rowspan="1" colspan="1">11</td>
              <td rowspan="1" colspan="1">15</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Synonymous</td>
              <td rowspan="1" colspan="1">17</td>
              <td rowspan="1" colspan="1">8</td>
            </tr>
            <tr>
              <td colspan="3" rowspan="1"> 2 × 2 Fisher exact test; <italic toggle="yes">P</italic>-value = 0.093</td>
            </tr>
            <tr>
              <td colspan="3" rowspan="1">(C) Example of fwwMKT 2 × 2 contingency table. Removing all polymorphic sites with a derived allele frequency below 15%</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Nonsynonymous</td>
              <td rowspan="1" colspan="1">11 − 7 = 4</td>
              <td rowspan="1" colspan="1">15</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Synonymous</td>
              <td rowspan="1" colspan="1">17 − 6 = 11</td>
              <td rowspan="1" colspan="1">8</td>
            </tr>
            <tr>
              <td colspan="3" rowspan="1"> 2 × 2 Fisher exact test; <italic toggle="yes">P</italic>-value = 0.045</td>
            </tr>
            <tr>
              <td colspan="3" rowspan="1">(D) Example of impMKT 2 × 2 contingency table. Removing the expected SDM with a derived allele frequency below 15% [see <xref rid="E3" ref-type="disp-formula">Equation (2)]</xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Nonsynonymous</td>
              <td rowspan="1" colspan="1">11 − 5 = 6</td>
              <td rowspan="1" colspan="1">15</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Synonymous</td>
              <td rowspan="1" colspan="1">17</td>
              <td rowspan="1" colspan="1">8</td>
            </tr>
            <tr>
              <td colspan="3" rowspan="1"> 2 × 2 Fisher exact test; <italic toggle="yes">P</italic>-value = 0.017</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Consequently, considering that SDM are the main force biasing <italic toggle="yes">α</italic> downward and assuming that SDM do not segregate at frequencies above 15% (<inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), we impute the actual proportion of SDM (<italic toggle="yes">P<sub>wd</sub></italic>) segregating below the frequency cutoff by considering that the expected neutral polymorphism nonsynonymous/synonymous ratio is <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. This ratio can be used to infer the number of SDM in our data set (<italic toggle="yes">P<sub>wd</sub></italic>). If <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> bellow <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>, then <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> exceeds the expected polymorphic ratio because <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> includes <italic toggle="yes">P<sub>wd</sub></italic>. That is, <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>neut</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>neut</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> refers to the number of nonsynonymous segregating sites that are effectively neutral. Accordingly, we can estimate (impute) <italic toggle="yes">P<sub>wd</sub></italic> from expression
<disp-formula id="E2"><label>(1)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
rearranging we have
<disp-formula id="E3"><label>(2)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
      <p>Considering our example in <xref rid="jkac206-T2" ref-type="table">Table 2</xref>, <italic toggle="yes">P<sub>wd</sub></italic> is
<disp-formula id="E4"><label>(3)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>7</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mo>·</mml:mo><mml:mn>6</mml:mn></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:mfrac><mml:mo>≈</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></disp-formula></p>
      <p>And, thus, 5 is the number of sites removed from the nonsynonymous polymorphism counts (see <xref rid="jkac206-T2" ref-type="table">Table 2D</xref>).</p>
      <p>As can be seen in <xref rid="jkac206-T2" ref-type="table">Table 2C</xref>, the approach proposed by <xref rid="jkac206-B21" ref-type="bibr">Fay <italic toggle="yes">et al.</italic> (2001)</xref> shows that removing all low-frequency polymorphisms below a given threshold <italic toggle="yes">j</italic> significantly increases the power of detection of positive selection by conducting a 2 × 2 test. Thus, testing for the ratio of replacement on fwwMKT 2 × 2 contingency table through a Fisher exact test decreases the <italic toggle="yes">P</italic>-value significance from 0.093 to 0.045 in our example. Nonetheless, it implies a reduction of 46% of the analyzed data, reducing <italic toggle="yes">P<sub>N</sub></italic> from 11 to 4 and <italic toggle="yes">P<sub>S</sub></italic> from 17 to 11, respectively. In comparison, by simply removing the expected number of SDM (<italic toggle="yes">P<sub>wd</sub></italic>), we reduced the data loss to only 15%, while decreasing the <italic toggle="yes">P</italic>-value from 0.093 to 0.017 (see <xref rid="jkac206-T2" ref-type="table">Table 2D</xref>).</p>
      <p>Therefore, the impMKT allows maximizing gene-by-gene analyses where information is limited to a small number of polymorphic sites. Note that in cases where data is highly constrained, SDM would not rise in frequency, or their presence would be negligible, and the impMKT will be penalized since the imputation removes data from the 2 × 2 contingency table. In such cases, impMKT should be avoided, and the method developed by <xref rid="jkac206-B18" ref-type="bibr">Eilertson <italic toggle="yes">et al.</italic> (2012)</xref> shows better performance than the original MKT for several genetic scenarios.</p>
      <p>In addition, we can correct <italic toggle="yes">α</italic>, the proportion of adaptive substitutions, by removing the expected proportion of SDM (<italic toggle="yes">P<sub>wd</sub></italic>) with the expression
<disp-formula id="E5"><label>(4)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mtext>imputed</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <sec>
        <title>Other selection regimes</title>
        <p>The SDM imputation can be used to estimate other selective components shaping the DFE. Let consider the model proposed by <xref rid="jkac206-B19" ref-type="bibr">Eyre-Walker and Keightley (2009)</xref> and nearly neutral theory (<xref rid="jkac206-B41" ref-type="bibr">Ohta 1973</xref>), where selected segregating alleles are drawn from a continuous Gamma distribution and categorized as strongly deleterious, slightly deleterious and effectively neutral mutations. Analogous to <xref rid="jkac206-B35" ref-type="bibr">Mackay <italic toggle="yes">et al.</italic> (2012)</xref>, we define the statistics <italic toggle="yes">d</italic>, <italic toggle="yes">d<sub>w</sub></italic>, and <italic toggle="yes">d</italic><sub>0</sub>, which measure the different types of purifying selection, both at genome-wide and gene levels. These measures are like heuristic estimates of the DFE parameters at the gene level.</p>
        <p>Let <italic toggle="yes">d</italic> be the proportion of strongly deleterious mutations. We estimated <italic toggle="yes">d</italic> following <xref rid="jkac206-B35" ref-type="bibr">Mackay <italic toggle="yes">et al.</italic> (2012)</xref> as the missing fraction of segregating nonsynonymous sites
<disp-formula id="E6"><label>(5)</label><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
where <italic toggle="yes">m<sub>S</sub></italic> and <italic toggle="yes">m<sub>N</sub></italic> are the total number of synonymous and nonsynonymous sites, respectively.</p>
        <p>Let <italic toggle="yes">d<sub>w</sub></italic> be the fraction of SDM at nonsynonymous sites
<disp-formula id="E7"><label>(6)</label><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
        <p>Lastly, the fraction of effectively neutral mutations <italic toggle="yes">d</italic><sub>0</sub> can be estimated as the remaining fraction
<disp-formula id="E8"><label>(7)</label><mml:math id="M8" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula></p>
      </sec>
    </sec>
    <sec>
      <title>Properties of the impMKT <italic toggle="yes">α</italic> estimator</title>
      <p>We tested the accuracy and performance of the impMKT compared to other MKT approaches at estimating the fraction of substitutions fixed by positive selection (<italic toggle="yes">α</italic>) under different scenarios that were simulated using SLiM 3 (<xref rid="jkac206-B27" ref-type="bibr">Haller and Messer 2019</xref>). The different scenarios considered the combined effects of different genetic features: the level of polymorphism in terms of segregating sites (<italic toggle="yes">θ</italic>), the number of simulated genes, the proportion of adaptive mutations (<italic toggle="yes">p<sub>a</sub></italic>), the proportion of SDM (<italic toggle="yes">β</italic>), the recombination rate (<italic toggle="yes">ρ</italic>), and the selection strength (<inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msub><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula>) (<xref rid="jkac206-T1" ref-type="table">Table 1</xref>). In addition to <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>, we explored derived allele frequency cutoffs larger than 15% (<inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>25</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>35</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>). We also tested 5% (<inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>) frequency cutoff as in <xref rid="jkac206-B35" ref-type="bibr">Mackay <italic toggle="yes">et al.</italic> (2012)</xref>.</p>
      <p>In all simulations, the original MKT underestimates considerably the <italic toggle="yes">α</italic> values (<xref rid="jkac206-F2" ref-type="fig">Figs. 2</xref> and <xref rid="jkac206-F3" ref-type="fig">3</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref>) due to the presence of SDM segregating at low frequencies, excluding simulations where the contribution of SDM is negligible. Overall, the aMKT and Grapes performed better under the presence of SDM and achieved the best results when considering both unbiasedness and efficiency of the estimator (minimum variance) (<xref rid="jkac206-F2" ref-type="fig">Fig. 2</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref>, and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table 2</xref>). While heuristic MKT approaches tend to underestimate <italic toggle="yes">α</italic>, Grapes tends to slightly overestimate <italic toggle="yes">α</italic> in most of the scenarios, while aMKT tends to provide slight underestimations (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables 1 and 2</xref>).</p>
      <fig position="float" id="jkac206-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>α MKT estimations by the different MKT approaches under different SLiM simulated scenarios, specifically different simulated fractions of adaptive mutations. Equivalent results under other SLiM simulated scenarios are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref>.</p>
        </caption>
        <graphic xlink:href="jkac206f2" position="float"/>
      </fig>
      <fig position="float" id="jkac206-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Error biases associated with the <italic toggle="yes">α</italic> estimations for all of the scenarios and MKT approaches.</p>
        </caption>
        <graphic xlink:href="jkac206f3" position="float"/>
      </fig>
      <p>As previously shown in <xref rid="jkac206-B15" ref-type="bibr">Charlesworth and Eyre-Walker (2008)</xref>, <italic toggle="yes">α</italic> estimates converge to the actual value depending mainly on the shape of the DFE (<italic toggle="yes">β</italic>) and the amount of adaptive evolution (<italic toggle="yes">α</italic>). We considered 3 different values of <italic toggle="yes">β</italic> [0.3 (baseline), 0.2, and 0.1] to test such effect. We observed the same trend for all MKT-derived approaches: the underestimation for the different MKTs is smaller the more leptokurtic DFE is, which in turn implies less SDM. The same effect was found when increasing the rate of adaptive evolution (from <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mn>0.7</mml:mn></mml:mrow></mml:math></inline-formula>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables 1 and 2</xref> and <xref rid="jkac206-F3" ref-type="fig">Fig. 3</xref>).</p>
      <p>For all the simulated scenarios, the fwwMKT and the impMKT behave similarly to the MKT, mainly depending on the frequency cutoff. As expected, lower cutoffs (i.e. 5%) resulted in minor accuracy improvements in the estimation of <italic toggle="yes">α</italic> compared to the original MKT approach, except when SDM contributed little to the SFS (smaller <italic toggle="yes">β</italic> and larger <italic toggle="yes">α</italic> values). Conversely, larger cutoffs (i.e. 15%, 25%, or 35%) resulted in better estimates of <italic toggle="yes">α</italic>. Specifically, a 35% cutoff is large enough to deal with SDM and to perform estimations similar to the aMKT and Grapes in all simulations. Both the impMKT and the fwwMKT performed very similarly due to the large amount of data considered from the simulations. Contrarily, the eMKT was not able to deal with the presence of SDM and higher frequency cutoffs did not improve the estimations of <italic toggle="yes">α</italic> (<xref rid="jkac206-F2" ref-type="fig">Fig. 2</xref>, <xref rid="jkac206-F2" ref-type="fig">Supplementary Figs. 1–3</xref>, and <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables 1 and 2</xref>; see Discussion).</p>
      <p>In scenarios simulating low levels of polymorphism in terms of segregating sites (i.e. reduced number of simulated genes, or reduced mutation rate <italic toggle="yes">θ</italic>), the accuracy and efficiency of the aMKT and Grapes diminishes (<xref rid="jkac206-F3" ref-type="fig">Fig. 3</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 4</xref>, and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table 3</xref>). Under these circumstances, the aMKT could be applied to approximately 70% of the cases only, and provided worse estimations of <italic toggle="yes">α</italic> than the impMKT. We observe the same trend when measuring the standard deviation of the estimators (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 4</xref>). impMKT provided better results in comparison to aMKT while showing similar accuracy to Grapes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table 1</xref> and <xref rid="jkac206-F3" ref-type="fig">Fig. 3</xref>). Similarly, the CIs estimated by Grapes increased by 1 order of magnitude, from range [0.01,0.06] (considering the other scenarios) to 0.16 (for the scenario with 2,000 simulated genes) and 0.19 (for the scenario with <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:mo>θ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.0001</mml:mn></mml:mrow></mml:math></inline-formula>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref>, <xref rid="sup1" ref-type="supplementary-material">3</xref> and <xref rid="sup1" ref-type="supplementary-material">4</xref> and <xref rid="jkac206-F3" ref-type="fig">Fig. 3</xref>).</p>
    </sec>
    <sec>
      <title>Estimation of <italic toggle="yes">α</italic> on the presence of recent positive selection</title>
      <p>Several studies have showed the contribution of slightly beneficial mutations (SBM) to the SFS at medium/high frequencies over the last years, representing a source of distortion in all MKT approaches. These alleles can segregate in the frequency spectrum and eventually fix in the population depending on the selective strength. Multiple methods have been proposed to overcome this limitation (<xref rid="jkac206-B23" ref-type="bibr">Galtier 2016</xref>; <xref rid="jkac206-B49" ref-type="bibr">Tataru <italic toggle="yes">et al.</italic> 2017</xref>). Nonetheless, many natural patterns remain unanswered, and they can be attributed to the effect of linked selection, since methods that incorporate weak selection assume that sites evolve independently. <xref rid="jkac206-B51" ref-type="bibr">Uricchio <italic toggle="yes">et al.</italic> (2019)</xref> proposed a new MKT approach that incorporates background selection (BGS), estimates the fraction of weak adaptive selection, and discerns the role of linkage in <italic toggle="yes">α</italic> estimations.</p>
      <p>We tested such effect following <xref rid="jkac206-B51" ref-type="bibr">Uricchio <italic toggle="yes">et al.</italic> (2019)</xref> simulations to evaluate SBM as well as BGS. We simulated the exact global adaptation rate as it is done in the baseline simulation. As a result, 50% of the <italic toggle="yes">α</italic> signal corresponded to the contribution of weakly advantageous alleles following a point-mass distribution with selection coefficient <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msub><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>. We chose this selection coefficient after exploring the impact of the population-scaled selection coefficients using the analytical estimations proposed by <xref rid="jkac206-B51" ref-type="bibr">Uricchio <italic toggle="yes">et al.</italic> (2019)</xref>. <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 6</xref> shows that the impact of population-scaled selection coefficients above <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msub><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> on the SFS is almost negligible.</p>
      <p>In addition to the contribution of SBM to the fixation process, one expects a higher concentration of SBM at high frequencies, since the Hill–Robertson effect prevents them from reaching fixation due to linkage to other SBM or SDM when BGS is acting. Under these assumptions, we modified the impMKT approach to account for such an excess of nonneutral alleles at high frequencies. Similarly to before, we imputed the expected number of SDM at high frequency using the expected <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> for low- and high-frequency cutoffs. The expected neutral nonsynonymous/synonymous polymorphism ratio is given by the cutoff <italic toggle="yes">l</italic> and <italic toggle="yes">h</italic>: <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. In this special case, SDM are not removed from the contingency table, but added to the nonsynonymous divergence count. In addition, we executed Grapes using the Gamma-exponential model and considered adaptive mutations using a threshold of <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msub><mml:mi>s</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
      <p>In addition to a possible excess at high frequencies, SBM may also segregate all across the spectrum, depending not only on the Hill–Roberston effect but also on the selective strength, the linkage disequilibrium patterns and the fixation times (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 6</xref>). Assuming that SBM can segregate at any frequency, the impMKT cannot deal with weak adaptation, even imputing nearly fixed variants. Therefore our heuristic approach, extending aMKT results from <xref rid="jkac206-B51" ref-type="bibr">Uricchio <italic toggle="yes">et al.</italic> (2019)</xref>, can also be affected by the presence of SBM and BGS. Also Grapes, especially when BGS is acting (<xref rid="jkac206-F4" ref-type="fig">Fig. 4</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table 5</xref>). All in all, the effect of linkage and the contribution of weak selection at the gene level remain unexplored. Thus, new approaches are needed to pinpoint genes under weak positive selection.</p>
      <fig position="float" id="jkac206-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>α estimations at simulations accounting for weak adaptation. Any of the proposed methods can correct linkage and weak adaptation at the estimations. Although the method proposed by <xref rid="jkac206-B51" ref-type="bibr">Uricchio <italic toggle="yes">et al.</italic> (2019)</xref> can overcome linkage and weak adaptation, <italic toggle="yes">α</italic> estimations at the gene level remain unexplored and new approaches are required.</p>
        </caption>
        <graphic xlink:href="jkac206f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>Testing for the evidence of positive selection in single genes</title>
      <p>We estimated <italic toggle="yes">α</italic> at the gene level on <italic toggle="yes">D. melanogaster</italic> (Zambia, ZI; 197 individuals) and human (Africa, AFR; 661 individuals) population data. <xref rid="jkac206-T3" ref-type="table">Table 3</xref> shows the mean values and the number of analyses performed considering different MKT approaches. We removed from the analysis those genes with zero divergence or zero polymorphism, either for synonymous or nonsynonymous sites.</p>
      <table-wrap position="float" id="jkac206-T3">
        <label>Table 3.</label>
        <caption>
          <p>Gene-by-gene analysis.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="(" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="(" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="(" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="(" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="2" colspan="1">Population</th>
              <th rowspan="2" align="center" colspan="1">Set</th>
              <th colspan="2" align="center" rowspan="1">MKT<hr/></th>
              <th colspan="2" align="center" rowspan="1">eMKT 0.25<hr/></th>
              <th colspan="2" align="center" rowspan="1">fwwMKT 0.25<hr/></th>
              <th colspan="2" align="center" rowspan="1">impMKT 0.25<hr/></th>
            </tr>
            <tr>
              <th align="center" rowspan="1" colspan="1">
                <italic toggle="yes">N</italic>
              </th>
              <th align="center" rowspan="1" colspan="1">
                <italic toggle="yes">α</italic>
              </th>
              <th align="center" rowspan="1" colspan="1">
                <italic toggle="yes">N</italic>
              </th>
              <th align="center" rowspan="1" colspan="1">
                <italic toggle="yes">α</italic>
              </th>
              <th align="center" rowspan="1" colspan="1">
                <italic toggle="yes">N</italic>
              </th>
              <th align="center" rowspan="1" colspan="1">
                <italic toggle="yes">α</italic>
              </th>
              <th align="center" rowspan="1" colspan="1">
                <italic toggle="yes">N</italic>
              </th>
              <th align="center" rowspan="1" colspan="1">
                <italic toggle="yes">α</italic>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">ZI</td>
              <td rowspan="1" colspan="1">Analyzable</td>
              <td rowspan="1" colspan="1">12,024</td>
              <td rowspan="1" colspan="1">−0.721 ± (2.825)</td>
              <td rowspan="1" colspan="1">10,340</td>
              <td rowspan="1" colspan="1">−0.343 ± (1.582)</td>
              <td rowspan="1" colspan="1">7,574</td>
              <td rowspan="1" colspan="1">−0.031 ± (1.665)</td>
              <td rowspan="1" colspan="1">7,574</td>
              <td rowspan="1" colspan="1">−0.031 ± (1.665)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">ZI</td>
              <td rowspan="1" colspan="1">Negative</td>
              <td rowspan="1" colspan="1">1,131</td>
              <td rowspan="1" colspan="1">−4.907 ± (7.044)</td>
              <td rowspan="1" colspan="1">700</td>
              <td rowspan="1" colspan="1">−3.798 ± (3.287)</td>
              <td rowspan="1" colspan="1">38</td>
              <td rowspan="1" colspan="1">−10.558 ± (10.472)</td>
              <td rowspan="1" colspan="1">339</td>
              <td rowspan="1" colspan="1">−4.698 ± (4.888)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">ZI</td>
              <td rowspan="1" colspan="1">Positive</td>
              <td rowspan="1" colspan="1">1,493</td>
              <td rowspan="1" colspan="1">0.762 ± (0.135)</td>
              <td rowspan="1" colspan="1">1,571</td>
              <td rowspan="1" colspan="1">0.765 ± (0.134)</td>
              <td rowspan="1" colspan="1">929</td>
              <td rowspan="1" colspan="1">0.844 ± (0.095)</td>
              <td rowspan="1" colspan="1">2,242</td>
              <td rowspan="1" colspan="1">0.775 ± (0.121)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">AFR</td>
              <td rowspan="1" colspan="1">Analyzable</td>
              <td rowspan="1" colspan="1">12,786</td>
              <td rowspan="1" colspan="1">−1.699 ± (3.206)</td>
              <td rowspan="1" colspan="1">6,119</td>
              <td rowspan="1" colspan="1">−1.077 ± (2.256)</td>
              <td rowspan="1" colspan="1">3,145</td>
              <td rowspan="1" colspan="1">−0.686 ± (2.225)</td>
              <td rowspan="1" colspan="1">3,145</td>
              <td rowspan="1" colspan="1">−0.686 ± (2.225)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">AFR</td>
              <td rowspan="1" colspan="1">Negative</td>
              <td rowspan="1" colspan="1">1,023</td>
              <td rowspan="1" colspan="1">−7.433 ± (6.344)</td>
              <td rowspan="1" colspan="1">499</td>
              <td rowspan="1" colspan="1">−5.259 ± (4.402)</td>
              <td rowspan="1" colspan="1">11</td>
              <td rowspan="1" colspan="1">−12.695 ± (5.783)</td>
              <td rowspan="1" colspan="1">236</td>
              <td rowspan="1" colspan="1">−5.471 ± (4.713)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">AFR</td>
              <td rowspan="1" colspan="1">Positive</td>
              <td rowspan="1" colspan="1">76</td>
              <td rowspan="1" colspan="1">0.813 ± (0.117)</td>
              <td rowspan="1" colspan="1">66</td>
              <td rowspan="1" colspan="1">0.794 ± (0.138)</td>
              <td rowspan="1" colspan="1">18</td>
              <td rowspan="1" colspan="1">0.893 ± (0.093)</td>
              <td rowspan="1" colspan="1">203</td>
              <td rowspan="1" colspan="1">0.759 ± (0.121)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn2">
            <p>Total number of analyzable, positively and negatively selected genes by MKT approach.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Due to the amount of raw data, the original MKT was the approach that allowed us to estimate <italic toggle="yes">α</italic> on the largest number of protein-coding genes: 12,024 (87%) genes in the <italic toggle="yes">D. melanogaster</italic> Zambian population. The statistical significance for both positively and negatively selected genes was determined using the Fisher’s exact test; 1,495 and 1,331 were detected under positive and negative selection, respectively. The number of analyzable genes decreased 14% when applying the eMKT correction, from 12,024 to 10,340, but slightly increasing the number of genes under positive selection, from 1,493 to 1,571. We found a decreased of 37% when applying the fwwMKT correction, from 12,024 to 7,574 genes, as well as in the number of genes under positive selection, from 1,495 to 929. More importantly, for both approaches we found a drop in the number of genes under negative selection, from 1,131 to 700 and 38 genes for eMKT and fwwMKT respectively.</p>
      <p>The impMKT was able to analyze the exact same number of genes as the fwwMKT approach (7,588 genes), since impMKT needs data to compute the <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> ratio above the threshold, as the fwwMKT. However, the number of positively selected genes increased from 1,495 in the original MKT approach or 929 in the fwwMKT to 2,244 (<xref rid="jkac206-F5" ref-type="fig">Fig. 5a</xref>). Therefore, the impMKT increased the detection of positive selection by 50% in the <italic toggle="yes">D. melanogaster</italic> Zambian population compared to the original MKT (1,495 vs. 2,244 genes), by 141% compared to the fwwMKT (929 vs. 2,244) and by 42% regarding eMKT (from 1,571 to 2,242). In addition, the impMKT detected 792% more genes under negative selection than the fwwMKT correction (from 38 in the fwwMKT to 339 genes in the impMKT). We noted a significant drop in the number of genes under negative selection regarding the MKT and eMKT. Nonetheless, since neither MKT nor eMKT is able to deal properly with SDM, as shown in simulations, such trend was not unexpected.</p>
      <fig position="float" id="jkac206-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>a) Estimated number of genes under positive selection in the <italic toggle="yes">D. melanogaster</italic> Zambian population detected by each MKT approach. b) Estimated number of genes under positive selection in the human lineage African populations detected by each MKT approach.</p>
        </caption>
        <graphic xlink:href="jkac206f5" position="float"/>
      </fig>
      <p>We found similar patterns for the human dataset regarding the MKT and fwwMKT. MKT was the methodology that estimated <italic toggle="yes">α</italic> on the largest number of genes (13,078, 68%), as expected, while fwwMKT and impMKT only analyzed 3,145 genes. Nonetheless, the increase in the number of genes under positive selection detected by the impMKT is especially significant, rising by 159% (from 79 positively selected genes in the MKT to 203 in the impMKT) (<xref rid="jkac206-F5" ref-type="fig">Fig. 5b</xref>), and the fwwMKT only detected 18 genes under positive selection. Interestingly, contrary to <italic toggle="yes">D. melanogaster</italic> data, eMKT detected less genes than MKT under positive selection. Considering eMKT results from simulations regarding SDM and the associated protein-coding DFE in humans (<xref rid="jkac206-B6" ref-type="bibr">Booker 2020</xref>), we determined that eMKT very sensitive to the underlying DFE.</p>
      <p>Overall, in populations with low levels of polymorphism, the impMKT allowed detecting genes under positive selection more efficiently than the other methodologies because it does not remove all the data below a threshold, as the fwwMKT does. By just removing the imputed fraction of SDM, the impMKT can maintain a reasonably good statistical power and, contrary to the fwwMKT, is able to analyze data from datasets with low levels of polymorphism, such as human data. We do not tested aMKT nor Grapes since both methods are not performant or are inaccurate on single-gene sequence data and preferably used in large pools of genes or genome-wide levels.</p>
    </sec>
    <sec>
      <title>Testing for the evidence of positive selection in gene pooling data</title>
      <p>Next, we explored the performance of the impMKT, compared to the aMKT, Grapes and the original MKT approach, on pooled gene data. By adding up polymorphism and divergence data from multiple genes, this type of analysis increases the number of polymorphic sites to estimate the SFS, which provides the statistical power necessary to implement both the aMKT and ML approaches. We created gene pools to obtain a reliable measure of the average <italic toggle="yes">α</italic>. Specifically, we first selected 3,500 random protein-coding genes from both the <italic toggle="yes">Drosophila</italic> and the human datasets. Then, we resampled the genes 1,000 times with replacement to create pools of 1, 2, 5, 10, 25, 50, 75, 100, 250, 750, and 1,000 genes on which we computed the SFS and estimated <italic toggle="yes">α</italic> (<xref rid="jkac206-T4" ref-type="table">Table 4</xref>).</p>
      <table-wrap position="float" id="jkac206-T4">
        <label>Table 4.</label>
        <caption>
          <p><italic toggle="yes">α</italic> estimates by pooled genes.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Bin population</th>
              <th rowspan="1" colspan="1">Test</th>
              <th rowspan="1" colspan="1">1</th>
              <th rowspan="1" colspan="1">2</th>
              <th rowspan="1" colspan="1">5</th>
              <th rowspan="1" colspan="1">10</th>
              <th rowspan="1" colspan="1">25</th>
              <th rowspan="1" colspan="1">50</th>
              <th rowspan="1" colspan="1">75</th>
              <th rowspan="1" colspan="1">100</th>
              <th rowspan="1" colspan="1">250</th>
              <th rowspan="1" colspan="1">500</th>
              <th rowspan="1" colspan="1">750</th>
              <th rowspan="1" colspan="1">1,000</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">ZI</td>
              <td rowspan="1" colspan="1">impMKT</td>
              <td rowspan="1" colspan="1">−0.015 (−2.332 to 0.915)</td>
              <td rowspan="1" colspan="1">0.245 (−1.335 to 0.915)</td>
              <td rowspan="1" colspan="1">0.528 (−0.133 to 0.898)</td>
              <td rowspan="1" colspan="1">0.596 (0.176 to 0.874)</td>
              <td rowspan="1" colspan="1">0.641 (0.403 to 0.828)</td>
              <td rowspan="1" colspan="1">0.662 (0.486 to 0.799)</td>
              <td rowspan="1" colspan="1">0.67 (0.53 to 0.783)</td>
              <td rowspan="1" colspan="1">0.674 (0.557 to 0.774)</td>
              <td rowspan="1" colspan="1">0.682 (0.611 to 0.75)</td>
              <td rowspan="1" colspan="1">0.684 (0.633 to 0.729)</td>
              <td rowspan="1" colspan="1">0.686 (0.647 to 0.722)</td>
              <td rowspan="1" colspan="1">0.686 (0.652 to 0.717)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">ZI</td>
              <td rowspan="1" colspan="1">aMKT</td>
              <td rowspan="1" colspan="1">0.888 (0.888 to 0.888)</td>
              <td rowspan="1" colspan="1">0.876 (0.865 to 0.894)</td>
              <td rowspan="1" colspan="1">0.849 (0.817 to 0.877)</td>
              <td rowspan="1" colspan="1">0.661 (0.25 to 0.864)</td>
              <td rowspan="1" colspan="1">0.56 (0.17 to 0.821)</td>
              <td rowspan="1" colspan="1">0.6 (0.352 to 0.775)</td>
              <td rowspan="1" colspan="1">0.628 (0.448 to 0.767)</td>
              <td rowspan="1" colspan="1">0.634 (0.482 to 0.762)</td>
              <td rowspan="1" colspan="1">0.645 (0.544 to 0.729)</td>
              <td rowspan="1" colspan="1">0.65 (0.583 to 0.709)</td>
              <td rowspan="1" colspan="1">0.654 (0.595 to 0.703)</td>
              <td rowspan="1" colspan="1">0.656 (0.607 to 0.696)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">ZI</td>
              <td rowspan="1" colspan="1">Grapes</td>
              <td rowspan="1" colspan="1">−0.569 (−5.926 to 1.0)</td>
              <td rowspan="1" colspan="1">0.4 (−0.843 to 0.992)</td>
              <td rowspan="1" colspan="1">0.658 (0.177 to 0.927)</td>
              <td rowspan="1" colspan="1">0.704 (0.394 to 0.916)</td>
              <td rowspan="1" colspan="1">0.738 (0.551 to 0.876)</td>
              <td rowspan="1" colspan="1">0.752 (0.623 to 0.86)</td>
              <td rowspan="1" colspan="1">0.758 (0.655 to 0.848)</td>
              <td rowspan="1" colspan="1">0.762 (0.672 to 0.839)</td>
              <td rowspan="1" colspan="1">0.768 (0.714 to 0.82)</td>
              <td rowspan="1" colspan="1">0.769 (0.73 to 0.804)</td>
              <td rowspan="1" colspan="1">0.771 (0.74 to 0.799)</td>
              <td rowspan="1" colspan="1">0.771 (0.745 to 0.795)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">AFR</td>
              <td rowspan="1" colspan="1">impMKT</td>
              <td rowspan="1" colspan="1">−0.767 (−5.928 to 0.86)</td>
              <td rowspan="1" colspan="1">−0.746 (−4.25 to 0.78)</td>
              <td rowspan="1" colspan="1">−0.423 (−3.471 to 0.76)</td>
              <td rowspan="1" colspan="1">−0.191 (−2.008 to 0.74)</td>
              <td rowspan="1" colspan="1">0.023 (−0.862 to 0.6)</td>
              <td rowspan="1" colspan="1">0.077 (−0.43 to 0.491)</td>
              <td rowspan="1" colspan="1">0.081 (−0.361 to 0.429)</td>
              <td rowspan="1" colspan="1">0.093 (−0.269 to 0.39)</td>
              <td rowspan="1" colspan="1">0.098 (−0.142 to 0.306)</td>
              <td rowspan="1" colspan="1">0.101 (−0.049 to 0.236)</td>
              <td rowspan="1" colspan="1">0.101 (−0.015 to 0.213)</td>
              <td rowspan="1" colspan="1">0.099 (−0.002 to 0.199)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">AFR</td>
              <td rowspan="1" colspan="1">aMKT</td>
              <td rowspan="1" colspan="1">Nan (nan–nan)</td>
              <td rowspan="1" colspan="1">Nan (nan–nan)</td>
              <td rowspan="1" colspan="1">Nan (nan–nan)</td>
              <td rowspan="1" colspan="1">Nan (nan–nan)</td>
              <td rowspan="1" colspan="1">0.487 (0.2 to 0.665)</td>
              <td rowspan="1" colspan="1">0.25 (−0.245 to 0.744)</td>
              <td rowspan="1" colspan="1">0.086 (−0.555 to 0.573)</td>
              <td rowspan="1" colspan="1">0.082 (−0.586 to 0.536)</td>
              <td rowspan="1" colspan="1">0.2 (−0.097 to 0.456)</td>
              <td rowspan="1" colspan="1">0.189 (0.031 to 0.362)</td>
              <td rowspan="1" colspan="1">0.176 (0.051 to 0.327)</td>
              <td rowspan="1" colspan="1">0.166 (0.057 to 0.286)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">AFR</td>
              <td rowspan="1" colspan="1">Grapes</td>
              <td rowspan="1" colspan="1">−1.66 (−8.995 to 1.0)</td>
              <td rowspan="1" colspan="1">−0.922 (−6.572 to 1.0)</td>
              <td rowspan="1" colspan="1">0.119 (−1.155 to 0.954)</td>
              <td rowspan="1" colspan="1">0.19 (−0.605 to 0.76)</td>
              <td rowspan="1" colspan="1">0.221 (−0.273 to 0.615)</td>
              <td rowspan="1" colspan="1">0.237 (−0.121 to 0.537)</td>
              <td rowspan="1" colspan="1">0.245 (−0.059 to 0.502)</td>
              <td rowspan="1" colspan="1">0.245 (−0.005 to 0.463)</td>
              <td rowspan="1" colspan="1">0.257 (0.101 to 0.396)</td>
              <td rowspan="1" colspan="1">0.26 (0.152 to 0.353)</td>
              <td rowspan="1" colspan="1">0.264 (0.175 to 0.342)</td>
              <td rowspan="1" colspan="1">0.265 (0.194 to 0.335)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn3">
            <p>Each bin number corresponds to the number of pooled genes. Mean estimates and 95 percentiles estimates are shown by MKT approach and bin.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <sec>
        <title><italic toggle="yes">D. melanogaster</italic> ZI population</title>
        <p>Resampling analysis results in the <italic toggle="yes">D. melanogaster</italic> ZI population showed that estimated <italic toggle="yes">α</italic> converges to an average value as more and more genes are pooled (<xref rid="jkac206-F6" ref-type="fig">Fig. 6a</xref>). First, in the case of impMKT, pools of 5 genes or more already allowed estimating <italic toggle="yes">α</italic> in ∼90% of the cases, which corresponds to a mean number of polymorphic sites of <italic toggle="yes">P<sub>N</sub></italic> = 137 and <italic toggle="yes">P<sub>S</sub></italic> = 183. A 100% of analyzable cases was achieved in pools of 10 or more genes (<xref rid="jkac206-F6" ref-type="fig">Fig. 6b</xref>). Second, aMKT required larger pools to analyze the data; pools of 50 genes or more allowed estimating <italic toggle="yes">α</italic> in ∼90% of the cases, which corresponds to a mean number of polymorphic sites of <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>250</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>549</mml:mn></mml:mrow></mml:math></inline-formula>. At least 500 genes were required to estimate <italic toggle="yes">α</italic> in all of the replicates (<xref rid="jkac206-F6" ref-type="fig">Fig. 6c</xref>).</p>
        <fig position="float" id="jkac206-F6">
          <label>Fig. 6.</label>
          <caption>
            <p>Gene pooled analysis. A total of 3,500 random protein-coding genes were sampled from the ZI dataset. We pooled the genes to obtain SFS of 1, 2, 5, 10, 25, 50, 75, 100, 250, 750, and 1,000 genes by resampling them 1,000 times with replacement. a) <italic toggle="yes">α</italic> estimates with MKT correction. b) Proportion of analysis performed by impMKT. c) Proportion of analysis performed by aMKT. d) Proportion of analysis performed by aMKT. e) Proportion of analysis performed by Grapes.</p>
          </caption>
          <graphic xlink:href="jkac206f6" position="float"/>
        </fig>
        <p>Third, MKT and Grapes could analyze the vast majority of replicates (except for a few replicates in bins with only 1 or 2 pooled genes). Nonetheless, we noted 1.9-fold (from 1.2 to 2.3) and 8-fold increase (from 1.2 to 9.7) in <italic toggle="yes">α</italic> variance regarding MKT and Grapes compared to impMKT respectively at the first pool, showing the lack of power on small dataset. As the number of genes grow, the mean converging value of <italic toggle="yes">α</italic> was very similar for the impMKT, the aMKT and MKT, and higher for Grapes (<xref rid="jkac206-F6" ref-type="fig">Fig. 6a</xref>), an expected result considering previous results with simulated data (see previous section). In addition, impMKT showed similar (or higher) <italic toggle="yes">α</italic> values than aMKT and was applicable to the smallest gene pools.</p>
      </sec>
      <sec>
        <title>Human protein-coding genes</title>
        <p>Due to the low polymorphism levels in human protein-coding genes compared to <italic toggle="yes">D. melanogaster</italic>, the minimum number of genes pooled to estimate accurate measures of <italic toggle="yes">α</italic> was larger, especially for aMKT (<xref rid="jkac206-F7" ref-type="fig">Fig. 7</xref>). Specifically, aMKT required pools of 500 genes or more to estimate <italic toggle="yes">α</italic> in ∼90% of the of the replicas, which corresponds to a mean number of polymorphic sites of <italic toggle="yes">P<sub>N</sub></italic> = 5,658 and <italic toggle="yes">P<sub>S</sub></italic> = 3,922. More than 1,000 were required to estimate <italic toggle="yes">α</italic> in all of the replicates (<xref rid="jkac206-F7" ref-type="fig">Fig. 7c</xref>). In the case of Grapes, we found that most of the analyses can be performed; however, they showed a x1.7 increment (from 3.4 to 5.8) increase in the <italic toggle="yes">α</italic> variance regarding impMKT estimations. impMKT could estimate most replicates with 10 or more genes pooled, which corresponds to a mean number of polymorphic sites of <italic toggle="yes">P<sub>N</sub></italic> = 126 and <italic toggle="yes">P<sub>S</sub></italic> = 89. All the replicates with 25 or more genes pooled (<xref rid="jkac206-F7" ref-type="fig">Fig. 7b</xref>) showed similar or higher <italic toggle="yes">α</italic> values than aMKT.</p>
        <fig position="float" id="jkac206-F7">
          <label>Fig. 7.</label>
          <caption>
            <p>Gene pooled analysis. A total of 3,500 random protein-coding genes were sampled from the human dataset. We pooled the genes to obtain SFS of 1, 2, 5, 10, 25, 50, 75, 100, 250, 750, and 1,000 genes by resampling them 1,000 times with replacement. a) <italic toggle="yes">α</italic> estimates with MKT correction. b) Proportion of analysis performed by impMKT. c) Proportion of analysis performed by aMKT. d) Proportion of analysis performed by aMKT. e) Proportion of analysis performed by Grapes.</p>
          </caption>
          <graphic xlink:href="jkac206f7" position="float"/>
        </fig>
      </sec>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <sec>
      <title>Effect of SDM on <italic toggle="yes">α</italic> estimation</title>
      <p>SDM segregating at low frequencies impact the power of MKT and the estimation of <italic toggle="yes">α</italic> (<xref rid="jkac206-B50" ref-type="bibr">Templeton 1996</xref>; <xref rid="jkac206-B1" ref-type="bibr">Akashi 1999</xref>; <xref rid="jkac206-B21" ref-type="bibr">Fay <italic toggle="yes">et al.</italic> 2001</xref>, <xref rid="jkac206-B22" ref-type="bibr">2002</xref>; <xref rid="jkac206-B9" ref-type="bibr">Bustamante <italic toggle="yes">et al.</italic> 2002</xref>, <xref rid="jkac206-B8" ref-type="bibr">2005</xref>; <xref rid="jkac206-B5" ref-type="bibr">Bierne and Eyre-Walker 2004</xref>; <xref rid="jkac206-B37" ref-type="bibr">Messer and Petrov 2013</xref>; <xref rid="jkac206-B23" ref-type="bibr">Galtier 2016</xref>; <xref rid="jkac206-B43" ref-type="bibr">Rousselle <italic toggle="yes">et al.</italic> 2019</xref>). As <xref rid="jkac206-B5" ref-type="bibr">Bierne and Eyre-Walker (2004)</xref> pointed out, unless the methodology considers the presence of SDM, estimations using <italic toggle="yes">D. melanogaster</italic> data are likely underestimating <italic toggle="yes">α</italic>. We verify such statements by thoroughly exploring the MKT-derived approaches using both <italic toggle="yes">in silico</italic> and empirical data, assessing the benefits and drawbacks of each methodology, considering the nature of the data and the study design. Simulations with SLiM 3 have been carried out to benchmark the performance of the 4 MKT methodologies and the impMKT under different evolutionary scenarios. Predefined <italic toggle="yes">α</italic> values were used to assess the closest estimation. aMKT and Grapes are the best methods with respect to unbiasedness and efficiency of estimated values of <italic toggle="yes">α</italic>. However, their performance decreases in scenarios with a small number of polymorphic variants (shorter genomic regions or lower mutation rate) or could not even be applied due to low variant counts. Our results are consistent with previous explorations of MKT-derived approaches (<xref rid="jkac206-B15" ref-type="bibr">Charlesworth and Eyre-Walker 2008</xref>; <xref rid="jkac206-B37" ref-type="bibr">Messer and Petrov 2013</xref>). Hence, we found similar results exploring aMKT and Grapes in Drosophila and human genome sequence data and showed similar accuracy in simulations. Overall, both approaches allow efficient removal of SDM in all frequencies and not only below a threshold as in fwwMKT or impMKT methods.</p>
      <p>Strikingly, both procedures lack power when applied to individual genes or small pooled datasets. Despite the high polymorphic and divergence levels in <italic toggle="yes">D. melanogaster</italic>, it is not enough for the aMKT to fit the exponential curve and calculate <italic toggle="yes">α</italic> for single genes, and the number of analyzable genes is dramatically reduced (see <xref rid="jkac206-T3" ref-type="table">Table 3</xref>). We showed that pooled sets of genes allow overcoming data limitations to estimate an overall <italic toggle="yes">α</italic> value (<xref rid="jkac206-B7" ref-type="bibr">Boyko <italic toggle="yes">et al.</italic> 2008</xref>; <xref rid="jkac206-B19" ref-type="bibr">Eyre-Walker and Keightley 2009</xref>). Thus we explored the minimum number of pooled genes to perform aMKT regarding <italic toggle="yes">D. melanogaster</italic> and human populations. For aMKT we found that a minimum of 500 genes is required to perform 1,000 replicas when bootstrapping a set of 3,500 random genes (<xref rid="jkac206-F6" ref-type="fig">Fig. 6</xref>). Such a number increased to more than 1,000 when using the human dataset (<xref rid="jkac206-F7" ref-type="fig">Fig. 7</xref>). We found that Grapes can perform the estimation most of the time (only a few negligible analyses were not performed, see <xref rid="jkac206-F6" ref-type="fig">Figs. 6</xref> and <xref rid="jkac206-F7" ref-type="fig">7</xref>), considering gene-by-gene analysis or pooled analysis. Nonetheless, we found extremely high variance in <italic toggle="yes">α</italic> estimates and we noted that the associated CI to <italic toggle="yes">α</italic> estimation for each bootstrapped datasets is only acceptable once the analysis accounts for a minimum number of 50 in Drosophila and humans (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 8</xref>). The same trend is observed in those simulated scenarios producing less polymorphism regarding the percentage of aMKT analysis and Grapes CIs (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs. 1 and 3</xref>). Given the high levels of polymorphism in <italic toggle="yes">D. melanogaster</italic> compared to humans, the similar results for both populations can be considered as general ones.</p>
      <p>Such findings show the limitation of aMKT and Grapes (and other ML methods) (<xref rid="jkac206-B19" ref-type="bibr">Eyre-Walker and Keightley 2009</xref>; <xref rid="jkac206-B42" ref-type="bibr">Racimo and Schraiber 2014</xref>; <xref rid="jkac206-B49" ref-type="bibr">Tataru <italic toggle="yes">et al.</italic> 2017</xref>) when performing MKT at the gene-by-gene level or using small pooled datasets. Among non-ML approaches, fwwMKT and impMKT produced quite similar results. However, only when using higher frequency cutoffs than the commonly used 15% they showed results close to those by aMKT and Grapes (see <xref rid="jkac206-T2" ref-type="table">Table 2</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table 2</xref>). Such cutoffs can be astringent considering empirical data, especially in the case of fwwMKT. Instead of removing all polymorphism at low frequencies at both synonymous and nonsynonymous sites, as fwwMKT does, the new impMKT separates <italic toggle="yes">P<sub>N</sub></italic> into the number of effectively neutral variants and the number of SDM, and only removes the latter. In this way, impMKT allows increasing the frequency cutoff without compromising the amount of data that much. As a result, impMKT is the most powerful method to detect selection at the gene-by-gene level, substantially increasing the number of statistically significant genes under positive selection compared to other methodologies (see <xref rid="jkac206-F5" ref-type="fig">Fig. 5</xref> and <xref rid="jkac206-T3" ref-type="table">Table 3</xref>). In the case of pooled analyses, impMKT reduced dramatically the minimum number of genes required to perform the analysis in both Drosophila and human datasets (5 and 10, respectively).</p>
      <p>Even though strongly deleterious (<italic toggle="yes">d</italic>), slightly deleterious (<italic toggle="yes">d<sub>w</sub></italic>) and effectively neutral (<italic toggle="yes">d</italic><sub>0</sub>) mutations are commonly defined given DFE ranges <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msub><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>10</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msub><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msub><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, respectively, we observed mutations segregating in the range <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msub><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula>. Hence, if <italic toggle="yes">d</italic> is the proportion of mutations not segregating because of strong purifying selection, as stated above, we estimated <italic toggle="yes">d<sub>w</sub></italic> including any segregating mutation below the threshold <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msub><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. <xref rid="sup1" ref-type="supplementary-material">Supplementary Table 4</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 5</xref> show impMKT unbiased estimations of <italic toggle="yes">d</italic>, <italic toggle="yes">d<sub>w</sub></italic> and <italic toggle="yes">d</italic><sub>0</sub> using 5% and 35% cutoffs. Similarly to <italic toggle="yes">α</italic> estimation, the estimator requires larger cutoff than 5–15% (<xref rid="jkac206-B15" ref-type="bibr">Charlesworth and Eyre-Walker 2008</xref>; <xref rid="jkac206-B35" ref-type="bibr">Mackay <italic toggle="yes">et al.</italic> 2012</xref>) to properly impute SDM and estimate <italic toggle="yes">d<sub>w</sub></italic> and <italic toggle="yes">d</italic><sub>0</sub> accurately. Hence, the new impMKT provides easier and faster estimations of <italic toggle="yes">d</italic>, <italic toggle="yes">d<sub>w</sub></italic>, and <italic toggle="yes">d</italic><sub>0</sub> than ML approaches, representing the actual mutation proportions subject to different selection regimes and quantitative measures of the DFE along the genome or at the gene level.</p>
    </sec>
    <sec>
      <title>The effect of pooling data</title>
      <p>We showed that most MKT approaches could provide an accurate estimate of the average <italic toggle="yes">α</italic> if data from a large number of genes are collected (<xref rid="jkac206-B25" ref-type="bibr">Hahn 2018</xref>). Therefore, the process of pooling genes to create single evolutionary entities is a proper strategy to overcome the problem of lacking enough polymorphism data to conduct an MKT. In the majority of the performed analyses, this process does not seem to affect the results. However, some caveats must be taken into account when interpreting results obtained by this procedure.</p>
      <p>First, pooled genes do not necessarily share the same recombination context, GC content, or gene density rate, which also affect the adaptive potential of genes. Although pooling genes by 1 or more features at a time have been widely used to disentangle the potential drivers of adaptation (<xref rid="jkac206-B13" ref-type="bibr">Castellano <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="jkac206-B38" ref-type="bibr">Moutinho <italic toggle="yes">et al.</italic> 2019</xref>; <xref rid="jkac206-B51" ref-type="bibr">Uricchio <italic toggle="yes">et al.</italic> 2019</xref>; <xref rid="jkac206-B43" ref-type="bibr">Rousselle <italic toggle="yes">et al.</italic> 2019</xref>; <xref rid="jkac206-B47" ref-type="bibr">Soni <italic toggle="yes">et al.</italic> 2021</xref>), such approaches can report a spurious association between adaptation signals and other features if they are strongly correlated (<xref rid="jkac206-B29" ref-type="bibr">Huang 2021</xref>). <xref rid="jkac206-B29" ref-type="bibr">Huang (2021)</xref> developed the so-called MK regression to overcome biases of pooling analyses applied to 1 genomic feature at a time, by jointly evaluating the effects of correlated genomic features on <italic toggle="yes">α</italic> estimation. Nonetheless, MK regression is designed to measure the adaptation rate at the genomic level, and consequently not the preferred approach to pinpoint individual genes neither (<xref rid="jkac206-B29" ref-type="bibr">Huang 2021</xref>). Interestingly, we have noticed that MK regression followed the strategy proposed by <xref rid="jkac206-B21" ref-type="bibr">Fay <italic toggle="yes">et al.</italic> (2001)</xref> to deal with SDM. We propose to apply our impMKT approach instead, to preserve data and extending the implementation at the gene-by-gene level.</p>
      <p>Second, by pooling hundreds of genes, it is more difficult to detect a signal of positive selection if it is due to a few genes of the pool. In other words, all the evolutionary forces acting differently on different genes contribute to the dilution of potential biological signals.</p>
      <p>Third, although this data pooling increases the power of detecting selection, it could lead to the Simpson’s paradox (<xref rid="jkac206-B45" ref-type="bibr">Simpson 1951</xref>) if a significant trend in the 2 × 2 contingency tables disappears or reverses when the data is combined into a single table (<xref rid="jkac206-B48" ref-type="bibr">Stoletzki and Eyre-Walker 2011</xref>; <xref rid="jkac206-B25" ref-type="bibr">Hahn 2018</xref>). Regarding MKT data, this can happen when large differences in the number of nonsynonymous fixations (<italic toggle="yes">D<sub>N</sub></italic>) between genes lead to incorrect inferences about selection operating in different regions (<xref rid="jkac206-B48" ref-type="bibr">Stoletzki and Eyre-Walker 2011</xref>).</p>
    </sec>
    <sec>
      <title>Folded SFS vs. unfolded SFS</title>
      <p>Because the unfolded SFS (uSFS) provides more evolutionary information, all the analyses shown here take advantage of it. Nonetheless, uSFS needs that ancestral alleles are precisely estimated. The inference of ancestral states requires genetic data for at least 1 outgroup species and the application of ML methods. Because we used a parsimony approach with a single outgroup to estimate the uSFS, there may be polarization errors affecting our empirical analyses. The misattribution of ancestral alleles can also affect <italic toggle="yes">α</italic> and the MKT estimations (<xref rid="jkac206-B28" ref-type="bibr">Hernandez <italic toggle="yes">et al.</italic> 2007</xref>). On the one hand, an excess of high-frequency alleles can be attributed to hitchhiking of linked selected alleles or weak adaptation, which can affect ML methods that infer the DFE by over-estimating the role of positive selection. On the other hand, an excess of high-frequency alleles will specially affect the asymptotic fit in the aMKT, resulting in an under-estimation of <italic toggle="yes">α</italic>. To date, the method proposed by <xref rid="jkac206-B30" ref-type="bibr">Keightley and Jackson (2018)</xref> is the most sophisticated approximation to estimate the uSFS while minimizing mispolarization errors. The method uses the genetic data of 2 or more outgroup species, considers their phylogenetic tree topology, and considers multiple nucleotide substitution models.</p>
      <p>Nonetheless, because having genetic data of outgroup species is not always possible, we explored how the impMKT performs on folded SFS (fSFS) data instead of uSFS. The fSFS analyses causes a slight, affordable, decrease in the mean estimates of <italic toggle="yes">α</italic> (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 9</xref>), which is more pronounced as the frequency cutoff increases. It should be noticed that by applying the frequency cutoff on the fSFS, both the low-frequency and high-frequency derived alleles are removed from the analyses, which reduces the data for the estimation of <italic toggle="yes">α</italic> (and thus the statistical power). The same trend occurs when using the fSFS in gene-by-gene analyses for both <italic toggle="yes">Drosophila</italic> and humans, decreasing the number of positively selected genes by 25% and 44%, respectively (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table 6</xref>).</p>
      <p>Nevertheless, using the fSFS and focusing only on the central part of the frequency spectrum can be especially interesting in 2 cases. First, it is a better choice when mispolarization errors are abundant, a situation which would add an additional bias to SDM. The cutoff will potentially eliminate fictitious derived alleles (due to mispolarization) at a high frequency that would deviate the ratio <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>15</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> used in the imputation. Second, the cutoff will eliminate the accumulation of SDM at high frequencies due to interference between positively selected and slightly deleterious alleles.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>jkac206_Supplementary_Data</label>
      <media xlink:href="jkac206_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec sec-type="data-availability">
    <title>Data Availability</title>
    <p>Human and <italic toggle="yes">D. melanogaster</italic> processed data and the new impMKT software implementation are available at <underline>imkt.uab.cat</underline> (<xref rid="jkac206-B39" ref-type="bibr">Murga-Moreno <italic toggle="yes">et al.</italic> 2019</xref>). The supporting figures as well as notebooks and code used to perform the analyses can be found at <ext-link xlink:href="https://github.com/jmurga/mkt_comparison" ext-link-type="uri">https://github.com/jmurga/mkt_comparison</ext-link>.</p>
    <p><ext-link xlink:href="https://oup.silverchair-cdn.com/oup/backfile/Content_public/Journal/g3journal/PAP/10.1093_g3journal_jkac206/1/jkac206_supplementary_data.pdf?Expires=1664967694&amp;Signature=CG95KvRwykfA7ST2aFmPcSBMaYRm~4V8~uY19ebraBjAbgs3SRiKQqx92tXN0lBBKYvqTGHMWBHd5hRGSWG~n9m3kbLB-eNesOhBoSn08NDl966Gz05ILqMaPN4-25e1aajKRTSxPTXSkc3Svuw8HiVpb2Qv4a9ml0oFQnRoDMQENm4kgI03kMfmGN58h5FBtoTF07fvpn0OxISnl5LjNdqLFzHLI8NqWwlNFEWa1olioMkM2EVbAllzchybpb-HL8XqCsnnFHFHpIotHpE1XDhFGMjPW9GTi~le2fjLoMdrMG34R5Fr0H4poReLIjf0tUxwXMpXF2NUiQlf9ahsVA__&amp;Key-Pair-Id=APKAIE5G5CRDK6RD3PGA" ext-link-type="uri">Supplemental material</ext-link> is available at <italic toggle="yes">G3</italic> online.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by Ministerio de Economía y Empresa and Ministerio de Ciencia e Innovación y Agencia Estatal de Investigación (Spain) (grants MINECO CGL2017-89160-P and PID2021-127107NB-I00 to AB); AGAUR (Generalitat de Catalunya) (2017SGR-1379 to Alfredo Ruiz); and Departament de Genètica i Microbiologia (UAB) (PIF to J.M-M).</p>
  </sec>
  <sec>
    <title>Conflicts of interest</title>
    <p>None declared.</p>
  </sec>
  <ref-list id="ref1">
    <title>Literature cited</title>
    <ref id="jkac206-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Akashi</surname><given-names>H.</given-names></string-name></person-group><article-title>Inferring the fitness effects of DNA mutations from polymorphism and divergence data: statistical power to detect directional selection under stationarity and free recombination</article-title>. <source>Genetics</source>. <year>1999</year>;<volume>151</volume>(<issue>1</issue>):<fpage>221</fpage>–<lpage>238</lpage>.<pub-id pub-id-type="pmid">9872962</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Auton</surname><given-names>A</given-names></string-name>, <string-name><surname>Brooks</surname><given-names>LD</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>RM</given-names></string-name>, <string-name><surname>Garrison</surname><given-names>EP</given-names></string-name>, <string-name><surname>Kang</surname><given-names>HM</given-names></string-name>, <string-name><surname>Korbel</surname><given-names>JO</given-names></string-name>, <string-name><surname>Marchini</surname><given-names>JL</given-names></string-name>, <string-name><surname>McCarthy</surname><given-names>S</given-names></string-name>, <string-name><surname>McVean</surname><given-names>GA</given-names></string-name>, <string-name><surname>Abecasis</surname><given-names>GR</given-names></string-name></person-group>; <collab>1000 Genomes Project Consortium</collab><article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>. <year>2015</year>;<volume>526</volume>(<issue>7571</issue>):<fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Balloux</surname><given-names>F</given-names></string-name>, <string-name><surname>Lehmann</surname><given-names>L.</given-names></string-name></person-group><article-title>Substitution rates at neutral genes depend on population size under fluctuating demography and overlapping generations</article-title>. <source>Evolution</source>. <year>2012</year>;<volume>66</volume>(<issue>2</issue>):<fpage>605</fpage>–<lpage>611</lpage>.<pub-id pub-id-type="pmid">22276552</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bhérer</surname><given-names>C</given-names></string-name>, <string-name><surname>Campbell</surname><given-names>CL</given-names></string-name>, <string-name><surname>Auton</surname><given-names>A.</given-names></string-name></person-group><article-title>Refined genetic maps reveal sexual dimorphism in human meiotic recombination at multiple scales</article-title>. <source>Nat Commun</source>. <year>2017</year>;<volume>8</volume>:<fpage>14994</fpage>.<pub-id pub-id-type="pmid">28440270</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bierne</surname><given-names>N</given-names></string-name>, <string-name><surname>Eyre-Walker</surname><given-names>A.</given-names></string-name></person-group><article-title>The genomic rate of adaptive amino acid substitution in <italic toggle="yes">Drosophila</italic></article-title>. <source>Mol Biol Evol</source>. <year>2004</year>;<volume>21</volume>(<issue>7</issue>):<fpage>1350</fpage>–<lpage>1360</lpage>.<pub-id pub-id-type="pmid">15044594</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Booker</surname><given-names>TR.</given-names></string-name></person-group><article-title>Inferring parameters of the distribution of fitness effects of new mutations when beneficial mutations are strongly advantageous and rare</article-title>. <source>G3 (Bethesda)</source>. <year>2020</year>;<volume>10</volume>(<issue>7</issue>):<fpage>2317</fpage>–<lpage>2326</lpage>.<pub-id pub-id-type="pmid">32371451</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boyko</surname><given-names>AR</given-names></string-name>, <string-name><surname>Williamson</surname><given-names>SH</given-names></string-name>, <string-name><surname>Indap</surname><given-names>AR</given-names></string-name>, <string-name><surname>Degenhardt</surname><given-names>JD</given-names></string-name>, <string-name><surname>Hernandez</surname><given-names>RD</given-names></string-name>, <string-name><surname>Lohmueller</surname><given-names>KE</given-names></string-name>, <string-name><surname>Adams</surname><given-names>MD</given-names></string-name>, <string-name><surname>Schmidt</surname><given-names>S</given-names></string-name>, <string-name><surname>Sninsky</surname><given-names>JJ</given-names></string-name>, <string-name><surname>Sunyaev</surname><given-names>SR</given-names></string-name></person-group>, et al <article-title>Assessing the evolutionary impact of amino acid mutations in the human genome</article-title>. <source>PLoS Genet</source>. <year>2008</year>;<volume>4</volume>(<issue>5</issue>):<fpage>e1000083</fpage>.<pub-id pub-id-type="pmid">18516229</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bustamante</surname><given-names>CD</given-names></string-name>, <string-name><surname>Fledel-Alon</surname><given-names>A</given-names></string-name>, <string-name><surname>Williamson</surname><given-names>S</given-names></string-name>, <string-name><surname>Nielsen</surname><given-names>R</given-names></string-name>, <string-name><surname>Hubisz</surname><given-names>MT</given-names></string-name>, <string-name><surname>Glanowski</surname><given-names>S</given-names></string-name>, <string-name><surname>Tanenbaum</surname><given-names>DM</given-names></string-name>, <string-name><surname>White</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Sninsky</surname><given-names>JJ</given-names></string-name>, <string-name><surname>Hernandez</surname><given-names>RD</given-names></string-name></person-group>, <etal>et al</etal><article-title>Natural selection on protein-coding genes in the human genome</article-title>. <source>Nature</source>. <year>2005</year>;<volume>437</volume>(<issue>7062</issue>):<fpage>1153</fpage>–<lpage>1157</lpage>.<pub-id pub-id-type="pmid">16237444</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bustamante</surname><given-names>CD</given-names></string-name>, <string-name><surname>Nielsen</surname><given-names>R</given-names></string-name>, <string-name><surname>Hartl</surname><given-names>DL.</given-names></string-name></person-group><article-title>A maximum likelihood method for analyzing pseudogene evolution: implications for silent site evolution in humans and rodents</article-title>. <source>Mol Biol Evol</source>. <year>2002</year>;<volume>19</volume>(<issue>1</issue>):<fpage>110</fpage>–<lpage>117</lpage>.<pub-id pub-id-type="pmid">11752196</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Campos</surname><given-names>JL</given-names></string-name>, <string-name><surname>Charlesworth</surname><given-names>B.</given-names></string-name></person-group><article-title>The effects on neutral variability of recurrent selective sweeps and background selection</article-title>. <source>Genetics</source>. <year>2019</year>;<volume>212</volume>(<issue>1</issue>):<fpage>287</fpage>–<lpage>303</lpage>.<pub-id pub-id-type="pmid">30923166</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Casillas</surname><given-names>S</given-names></string-name>, <string-name><surname>Barbadilla</surname><given-names>A.</given-names></string-name></person-group><article-title>Molecular population genetics</article-title>. <source>Genetics</source>. <year>2017</year>;<volume>205</volume>(<issue>3</issue>):<fpage>1003</fpage>–<lpage>1035</lpage>.<pub-id pub-id-type="pmid">28270526</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Casillas</surname><given-names>S</given-names></string-name>, <string-name><surname>Mulet</surname><given-names>R</given-names></string-name>, <string-name><surname>Villegas-Mirón</surname><given-names>P</given-names></string-name>, <string-name><surname>Hervas</surname><given-names>S</given-names></string-name>, <string-name><surname>Sanz</surname><given-names>E</given-names></string-name>, <string-name><surname>Velasco</surname><given-names>D</given-names></string-name>, <string-name><surname>Bertranpetit</surname><given-names>J</given-names></string-name>, <string-name><surname>Laayouni</surname><given-names>H</given-names></string-name>, <string-name><surname>Barbadilla</surname><given-names>A.</given-names></string-name></person-group><article-title>PopHuman: the human population genomics browser</article-title>. <source>Nucleic Acids Res</source>. <year>2018</year>;<volume>46</volume>(<issue>D1</issue>):<fpage>D1003</fpage>–<lpage>D1010</lpage>.<pub-id pub-id-type="pmid">29059408</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Castellano</surname><given-names>D</given-names></string-name>, <string-name><surname>Coronado-Zamora</surname><given-names>M</given-names></string-name>, <string-name><surname>Campos</surname><given-names>JL</given-names></string-name>, <string-name><surname>Barbadilla</surname><given-names>A</given-names></string-name>, <string-name><surname>Eyre-Walker</surname><given-names>A.</given-names></string-name></person-group><article-title>Adaptive evolution is substantially impeded by Hill–Robertson interference in <italic toggle="yes">Drosophila</italic></article-title>. <source>Mol Biol Evol</source>. <year>2016</year>;<volume>33</volume>(<issue>2</issue>):<fpage>442</fpage>–<lpage>455</lpage>.<pub-id pub-id-type="pmid">26494843</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Charlesworth</surname><given-names>B.</given-names></string-name></person-group><article-title>The effect of background selection against deleterious mutations on weakly selected, linked variants</article-title>. <source>Genet Res</source>. <year>1994</year>;<volume>63</volume>(<issue>3</issue>):<fpage>213</fpage>–<lpage>227</lpage>.<pub-id pub-id-type="pmid">8082838</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Charlesworth</surname><given-names>J</given-names></string-name>, <string-name><surname>Eyre-Walker</surname><given-names>A.</given-names></string-name></person-group><article-title>The McDonald–Kreitman test and slightly deleterious mutations</article-title>. <source>Mol Biol Evol</source>. <year>2008</year>;<volume>25</volume>(<issue>6</issue>):<fpage>1007</fpage>–<lpage>1015</lpage>.<pub-id pub-id-type="pmid">18195052</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Comeron</surname><given-names>JM</given-names></string-name>, <string-name><surname>Ratnappan</surname><given-names>R</given-names></string-name>, <string-name><surname>Bailin</surname><given-names>S.</given-names></string-name></person-group><article-title>The many landscapes of recombination in <italic toggle="yes">Drosophila melanogaster</italic></article-title>. <source>PLoS Genet</source>. <year>2012</year>;<volume>8</volume>(<issue>10</issue>):<fpage>e1002905</fpage>.<pub-id pub-id-type="pmid">23071443</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Derrien</surname><given-names>T</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>R</given-names></string-name>, <string-name><surname>Bussotti</surname><given-names>G</given-names></string-name>, <string-name><surname>Tanzer</surname><given-names>A</given-names></string-name>, <string-name><surname>Djebali</surname><given-names>S</given-names></string-name>, <string-name><surname>Tilgner</surname><given-names>H</given-names></string-name>, <string-name><surname>Guernec</surname><given-names>G</given-names></string-name>, <string-name><surname>Martin</surname><given-names>D</given-names></string-name>, <string-name><surname>Merkel</surname><given-names>A</given-names></string-name>, <string-name><surname>Knowles</surname><given-names>DG</given-names></string-name></person-group>, <etal>et al</etal><article-title>The GENCODE v7 catalog of human long noncoding RNAs: analysis of their gene structure, evolution, and expression</article-title>. <source>Genome Res</source>. <year>2012</year>;<volume>22</volume>(<issue>9</issue>):<fpage>1775</fpage>–<lpage>1789</lpage>.<pub-id pub-id-type="pmid">22955988</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eilertson</surname><given-names>KE</given-names></string-name>, <string-name><surname>Booth</surname><given-names>JG</given-names></string-name>, <string-name><surname>Bustamante</surname><given-names>CD.</given-names></string-name></person-group><article-title>SnIPRE: selection inference using a poisson random effects model</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>(<issue>12</issue>):<fpage>e1002806</fpage>. Publisher: public Library of Science.<pub-id pub-id-type="pmid">23236270</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eyre-Walker</surname><given-names>A</given-names></string-name>, <string-name><surname>Keightley</surname><given-names>PD.</given-names></string-name></person-group><article-title>Estimating the rate of adaptive molecular evolution in the presence of slightly deleterious mutations and population size change</article-title>. <source>Mol Biol Evol</source>. <year>2009</year>;<volume>26</volume>(<issue>9</issue>):<fpage>2097</fpage>–<lpage>2108</lpage>.<pub-id pub-id-type="pmid">19535738</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eyre-Walker</surname><given-names>A</given-names></string-name>, <string-name><surname>Woolfit</surname><given-names>M</given-names></string-name>, <string-name><surname>Phelps</surname><given-names>T.</given-names></string-name></person-group><article-title>The distribution of fitness effects of new deleterious amino acid mutations in humans</article-title>. <source>Genetics</source>. <year>2006</year>;<volume>173</volume>(<issue>2</issue>):<fpage>891</fpage>–<lpage>900</lpage>.<pub-id pub-id-type="pmid">16547091</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fay</surname><given-names>JC</given-names></string-name>, <string-name><surname>Wyckoff</surname><given-names>GJ</given-names></string-name>, <string-name><surname>Wu</surname><given-names>CI.</given-names></string-name></person-group><article-title>Positive and negative selection on the human genome</article-title>. <source>Genetics</source>. <year>2001</year>;<volume>158</volume>(<issue>3</issue>):<fpage>1227</fpage>–<lpage>1234</lpage>.<pub-id pub-id-type="pmid">11454770</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fay</surname><given-names>JC</given-names></string-name>, <string-name><surname>Wyckoff</surname><given-names>GJ</given-names></string-name>, <string-name><surname>Wu</surname><given-names>CI.</given-names></string-name></person-group><article-title>Testing the neutral theory of molecular evolution with genomic data from <italic toggle="yes">Drosophila</italic></article-title>. <source>Nature</source>. <year>2002</year>;<volume>415</volume>(<issue>6875</issue>):<fpage>1024</fpage>–<lpage>1026</lpage>.<pub-id pub-id-type="pmid">11875569</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Galtier</surname><given-names>N.</given-names></string-name></person-group><article-title>Adaptive protein evolution in animals and the effective population size hypothesis</article-title>. <source>PLoS Genet</source>. <year>2016</year>;<volume>12</volume>(<issue>1</issue>):<fpage>e1005774</fpage>.<pub-id pub-id-type="pmid">26752180</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B24">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Galtier</surname><given-names>N</given-names></string-name>, <string-name><surname>Rousselle</surname><given-names>M.</given-names></string-name></person-group> How Much Does Ne Vary among Species? bioRxiv 861849, <year>2020</year>.</mixed-citation>
    </ref>
    <ref id="jkac206-B25">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Hahn</surname><given-names>M.</given-names></string-name></person-group><source>Molecular Population Genetics</source>. <publisher-loc>Oxford (NY</publisher-loc>): <publisher-name>Oxford University Press</publisher-name>; <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="jkac206-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haller</surname><given-names>BC</given-names></string-name>, <string-name><surname>Messer</surname><given-names>PW.</given-names></string-name></person-group><article-title>asymptoticMK: a web-based tool for the asymptotic McDonald–Kreitman test</article-title>. <source>G3 (Bethesda)</source>. <year>2017</year>;<volume>7</volume>(<issue>5</issue>):<fpage>1569</fpage>–<lpage>1575</lpage>.<pub-id pub-id-type="pmid">28341700</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haller</surname><given-names>BC</given-names></string-name>, <string-name><surname>Messer</surname><given-names>PW.</given-names></string-name></person-group><article-title>SLiM 3: forward genetic simulations beyond the Wright–Fisher model</article-title>. <source>Mol Biol Evol</source>. <year>2019</year>;<volume>36</volume>(<issue>3</issue>):<fpage>632</fpage>–<lpage>637</lpage>.<pub-id pub-id-type="pmid">30517680</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hernandez</surname><given-names>RD</given-names></string-name>, <string-name><surname>Williamson</surname><given-names>SH</given-names></string-name>, <string-name><surname>Bustamante</surname><given-names>CD.</given-names></string-name></person-group><article-title>Context dependence, ancestral misidentification, and spurious signatures of natural selection</article-title>. <source>Mol Biol Evol</source>. <year>2007</year>;<volume>24</volume>(<issue>8</issue>):<fpage>1792</fpage>–<lpage>1800</lpage>.<pub-id pub-id-type="pmid">17545186</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>YF.</given-names></string-name></person-group><article-title>Dissecting genomic determinants of positive selection with an evolution-guided regression model</article-title>. <source>Mol Biol Evol</source>. <year>2021</year>;39(1):msab291.</mixed-citation>
    </ref>
    <ref id="jkac206-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keightley</surname><given-names>PD</given-names></string-name>, <string-name><surname>Jackson</surname><given-names>BC.</given-names></string-name></person-group><article-title>Inferring the probability of the derived vs. the ancestral allelic state at a polymorphic site</article-title>. <source>Genetics</source>. <year>2018</year>;<volume>209</volume>(<issue>3</issue>):<fpage>897</fpage>–<lpage>906</lpage>.<pub-id pub-id-type="pmid">29769282</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kimura</surname><given-names>M.</given-names></string-name></person-group><article-title>Evolutionary rate at the molecular level</article-title>. <source>Nature</source>. <year>1968</year>;<volume>217</volume>(<issue>5129</issue>):<fpage>624</fpage>–<lpage>626</lpage>.<pub-id pub-id-type="pmid">5637732</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kimura</surname><given-names>M.</given-names></string-name></person-group><article-title>Preponderance of synonymous changes as evidence for the neutral theory of molecular evolution</article-title>. <source>Nature</source>. <year>1977</year>;<volume>267</volume>(<issue>5608</issue>):<fpage>275</fpage>–<lpage>276</lpage>.<pub-id pub-id-type="pmid">865622</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lack</surname><given-names>JB</given-names></string-name>, <string-name><surname>Lange</surname><given-names>JD</given-names></string-name>, <string-name><surname>Tang</surname><given-names>AD</given-names></string-name>, <string-name><surname>Corbett-Detig</surname><given-names>RB</given-names></string-name>, <string-name><surname>Pool</surname><given-names>JE.</given-names></string-name></person-group><article-title>A thousand fly genomes: an expanded drosophila genome nexus</article-title>. <source>Mol Biol Evol</source>. <year>2016</year>;<volume>33</volume>(<issue>12</issue>):<fpage>3308</fpage>–<lpage>3313</lpage>.<pub-id pub-id-type="pmid">27687565</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lanfear</surname><given-names>R</given-names></string-name>, <string-name><surname>Kokko</surname><given-names>H</given-names></string-name>, <string-name><surname>Eyre-Walker</surname><given-names>A.</given-names></string-name></person-group><article-title>Population size and the rate of evolution</article-title>. <source>Trends Ecol Evol</source>. <year>2014</year>;<volume>29</volume>(<issue>1</issue>):<fpage>33</fpage>–<lpage>41</lpage>.<pub-id pub-id-type="pmid">24148292</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mackay</surname><given-names>TFC</given-names></string-name>, <string-name><surname>Richards</surname><given-names>S</given-names></string-name>, <string-name><surname>Stone</surname><given-names>EA</given-names></string-name>, <string-name><surname>Barbadilla</surname><given-names>A</given-names></string-name>, <string-name><surname>Ayroles</surname><given-names>JF</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>D</given-names></string-name>, <string-name><surname>Casillas</surname><given-names>S</given-names></string-name>, <string-name><surname>Han</surname><given-names>Y</given-names></string-name>, <string-name><surname>Magwire</surname><given-names>MM</given-names></string-name>, <string-name><surname>Cridland</surname><given-names>JM</given-names></string-name></person-group>, <etal>et al</etal><article-title>The <italic toggle="yes">Drosophila melanogaster</italic> genetic reference panel</article-title>. <source>Nature</source>. <year>2012</year>;<volume>482</volume>(<issue>7384</issue>):<fpage>173</fpage>–<lpage>178</lpage>.<pub-id pub-id-type="pmid">22318601</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McDonald</surname><given-names>JH</given-names></string-name>, <string-name><surname>Kreitman</surname><given-names>M.</given-names></string-name></person-group><article-title>Adaptive protein evolution at the Adh locus in <italic toggle="yes">Drosophila</italic></article-title>. <source>Nature</source>. <year>1991</year>;<volume>351</volume>(<issue>6328</issue>):<fpage>652</fpage>–<lpage>654</lpage>.<pub-id pub-id-type="pmid">1904993</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Messer</surname><given-names>PW</given-names></string-name>, <string-name><surname>Petrov</surname><given-names>DA.</given-names></string-name></person-group><article-title>Frequent adaptation and the McDonald–Kreitman test</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2013</year>;<volume>110</volume>(<issue>21</issue>):<fpage>8615</fpage>–<lpage>8620</lpage>.<pub-id pub-id-type="pmid">23650353</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moutinho</surname><given-names>AF</given-names></string-name>, <string-name><surname>Trancoso</surname><given-names>FF</given-names></string-name>, <string-name><surname>Dutheil</surname><given-names>JY.</given-names></string-name></person-group><article-title>The impact of protein architecture on adaptive evolution</article-title>. <source>Mol Biol Evol</source>. <year>2019</year>;<volume>36</volume>(<issue>9</issue>):<fpage>2013</fpage>–<lpage>2028</lpage>.<pub-id pub-id-type="pmid">31147689</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Murga-Moreno</surname><given-names>J</given-names></string-name>, <string-name><surname>Coronado-Zamora</surname><given-names>M</given-names></string-name>, <string-name><surname>Hervas</surname><given-names>S</given-names></string-name>, <string-name><surname>Casillas</surname><given-names>S</given-names></string-name>, <string-name><surname>Barbadilla</surname><given-names>A.</given-names></string-name></person-group><article-title>iMKT: the integrative McDonald and Kreitman test</article-title>. <source>Nucleic Acids Res</source>. <year>2019</year>;<volume>47</volume>(<issue>W1</issue>):<fpage>W283</fpage>–<lpage>W288</lpage>.<pub-id pub-id-type="pmid">31081014</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B40">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Nielsen</surname><given-names>R</given-names></string-name>, <string-name><surname>Slatkin</surname><given-names>M.</given-names></string-name></person-group><source>An Introduction to Population Genetics: Theory and Applications</source>. Sunderland: Sinauer Associates<publisher-name>Oxford University Press</publisher-name>; <year>2013</year>.</mixed-citation>
    </ref>
    <ref id="jkac206-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ohta</surname><given-names>T.</given-names></string-name></person-group><article-title>Slightly deleterious mutant substitutions in evolution</article-title>. <source>Nature</source>. <year>1973</year>;<volume>246</volume>(<issue>5428</issue>):<fpage>96</fpage>–<lpage>98</lpage>.<pub-id pub-id-type="pmid">4585855</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Racimo</surname><given-names>F</given-names></string-name>, <string-name><surname>Schraiber</surname><given-names>JG.</given-names></string-name></person-group><article-title>Approximation to the distribution of fitness effects across functional categories in human segregating polymorphisms</article-title>. <source>PLoS Genet</source>. <year>2014</year>;<volume>10</volume>(<issue>11</issue>):<fpage>e1004697</fpage>.<pub-id pub-id-type="pmid">25375159</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rousselle</surname><given-names>M</given-names></string-name>, <string-name><surname>Laverré</surname><given-names>A</given-names></string-name>, <string-name><surname>Figuet</surname><given-names>E</given-names></string-name>, <string-name><surname>Nabholz</surname><given-names>B</given-names></string-name>, <string-name><surname>Galtier</surname><given-names>N.</given-names></string-name></person-group><article-title>Influence of recombination and GC-biased gene conversion on the adaptive and nonadaptive substitution rate in mammals versus birds</article-title>. <source>Mol Biol Evol</source>. <year>2019</year>;<volume>36</volume>(<issue>3</issue>):<fpage>458</fpage>–<lpage>471</lpage>.<pub-id pub-id-type="pmid">30590692</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rousselle</surname><given-names>M</given-names></string-name>, <string-name><surname>Mollion</surname><given-names>M</given-names></string-name>, <string-name><surname>Nabholz</surname><given-names>B</given-names></string-name>, <string-name><surname>Bataillon</surname><given-names>T</given-names></string-name>, <string-name><surname>Galtier</surname><given-names>N.</given-names></string-name></person-group><article-title>Overestimation of the adaptive substitution rate in fluctuating populations</article-title>. <source>Biol Lett</source>. <year>2018</year>;<volume>14</volume>(<issue>5</issue>):<fpage>20180055</fpage>.<pub-id pub-id-type="pmid">29743267</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Simpson</surname><given-names>EH.</given-names></string-name></person-group><article-title>The interpretation of interaction in contingency tables</article-title>. <source>J R Stat Soc Ser B Methodol</source>. <year>1951</year>;<volume>13</volume>(<issue>2</issue>):<fpage>238</fpage>–<lpage>241</lpage>.</mixed-citation>
    </ref>
    <ref id="jkac206-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smith</surname><given-names>NGC</given-names></string-name>, <string-name><surname>Eyre-Walker</surname><given-names>A.</given-names></string-name></person-group><article-title>Adaptive protein evolution in <italic toggle="yes">Drosophila</italic></article-title>. <source>Nature</source>. <year>2002</year>;<volume>415</volume>(<issue>6875</issue>):<fpage>1022</fpage>–<lpage>1024</lpage>.<pub-id pub-id-type="pmid">11875568</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B47">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Soni</surname><given-names>V</given-names></string-name>, <string-name><surname>Moutinho</surname><given-names>AF</given-names></string-name>, <string-name><surname>Eyre-Walker</surname><given-names>A.</given-names></string-name></person-group> Site level factors that affect the rate of adaptive evolution in humans and chimpanzees; the effect of contracting population size. New Results Type: Cold Spring Harbor Laboratory Distributor; <year>2021</year>. Technical Report.</mixed-citation>
    </ref>
    <ref id="jkac206-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stoletzki</surname><given-names>N</given-names></string-name>, <string-name><surname>Eyre-Walker</surname><given-names>A.</given-names></string-name></person-group><article-title>The positive correlation between dN/dS and dS in mammals is due to runs of adjacent substitutions</article-title>. <source>Mol Biol Evol</source>. <year>2011</year>;<volume>28</volume>(<issue>4</issue>):<fpage>1371</fpage>–<lpage>1380</lpage>.<pub-id pub-id-type="pmid">21115654</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tataru</surname><given-names>P</given-names></string-name>, <string-name><surname>Mollion</surname><given-names>M</given-names></string-name>, <string-name><surname>Glémin</surname><given-names>S</given-names></string-name>, <string-name><surname>Bataillon</surname><given-names>T.</given-names></string-name></person-group><article-title>Inference of distribution of fitness effects and proportion of adaptive substitutions from polymorphism data</article-title>. <source>Genetics</source>. <year>2017</year>;<volume>207</volume>(<issue>3</issue>):<fpage>1103</fpage>–<lpage>1119</lpage>.<pub-id pub-id-type="pmid">28951530</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Templeton</surname><given-names>AR.</given-names></string-name></person-group><article-title>Contingency tests of neutrality using intra/interspecific gene trees: the rejection of neutrality for the evolution of the mitochondrial cytochrome oxidase II gene in the hominoid primates</article-title>. <source>Genetics</source>. <year>1996</year>;<volume>144</volume>(<issue>3</issue>):<fpage>1263</fpage>–<lpage>1270</lpage>.<pub-id pub-id-type="pmid">8913766</pub-id></mixed-citation>
    </ref>
    <ref id="jkac206-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Uricchio</surname><given-names>LH</given-names></string-name>, <string-name><surname>Petrov</surname><given-names>DA</given-names></string-name>, <string-name><surname>Enard</surname><given-names>D.</given-names></string-name></person-group><article-title>Exploiting selection at linked sites to infer the rate and strength of adaptation</article-title>. <source>Nat Ecol Evol</source>. <year>2019</year>;<volume>3</volume>(<issue>6</issue>):<fpage>977</fpage>–<lpage>984</lpage>.<pub-id pub-id-type="pmid">31061475</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
