<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName nlm2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Immunol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Immunol</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Immunol.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Immunology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1664-3224</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10166880</article-id>
    <article-id pub-id-type="doi">10.3389/fimmu.2023.1027346</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Immunology</subject>
        <subj-group>
          <subject>Original Research</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Manual cell selection in single cell transcriptomics using scSELpy supports the analysis of immune cell subsets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Dedden</surname>
          <given-names>Mark</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1988542"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wiendl</surname>
          <given-names>Maximilian</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1079827"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Müller</surname>
          <given-names>Tanja M.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1080173"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Neurath</surname>
          <given-names>Markus F.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/49358"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zundler</surname>
          <given-names>Sebastian</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="fn001" ref-type="author-notes">
          <sup>*</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/416777"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Department of Medicine 1, University Hospital Erlangen and Friedrich-Alexander-Universität Erlangen-Nürnberg</institution>, <addr-line>Erlangen</addr-line>, <country>Germany</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Deutsches Zentrum Immuntherapie (DZI), University Hospital Erlangen</institution>, <addr-line>Erlangen</addr-line>, <country>Germany</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Edda Russo, University of Florence, Italy</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Joseph CF Ng, University College London, United Kingdom; Carolina Moraes Cabe, Institut Pasteur, France</p>
      </fn>
      <corresp id="fn001">*Correspondence: Sebastian Zundler, <email xlink:href="mailto:sebastian.zundler@uk-erlangen.de">sebastian.zundler@uk-erlangen.de</email>
</corresp>
      <fn fn-type="other" id="fn002">
        <p>This article was submitted to Inflammation, a section of the journal Frontiers in Immunology</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>1027346</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>07</day>
        <month>4</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2023 Dedden, Wiendl, Müller, Neurath and Zundler</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Dedden, Wiendl, Müller, Neurath and Zundler</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Introduction</title>
        <p>Single cell RNA sequencing plays an increasing and indispensable role in immunological research such as in the field of inflammatory bowel diseases (IBD). Professional pipelines are complex, but tools for the manual selection and further downstream analysis of single cell populations are missing so far.</p>
      </sec>
      <sec>
        <title>Methods</title>
        <p>We developed a tool called scSELpy, which can easily be integrated into Scanpy-based pipelines, allowing the manual selection of cells on single cell transcriptomic datasets by drawing polygons on various data representations. The tool further supports the downstream analysis of the selected cells and the plotting of results.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Taking advantage of two previously published single cell RNA sequencing datasets we show that this tool is useful for the positive and negative selection of T cell subsets implicated in IBD beyond standard clustering. We further demonstrate the feasibility for subphenotyping T cell subsets and use scSELpy to corroborate earlier conclusions drawn from the dataset. Moreover, we also show its usefulness in the context of T cell receptor sequencing.</p>
      </sec>
      <sec>
        <title>Discussion</title>
        <p>Collectively, scSELpy is a promising additive tool fulfilling a so far unmet need in the field of single cell transcriptomic analysis that might support future immunological research.</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>single cell RNA sequencing</kwd>
      <kwd>transcriptomics</kwd>
      <kwd>chronic inflammation</kwd>
      <kwd>inflammatory bowel disease</kwd>
      <kwd>gut homing</kwd>
    </kwd-group>
    <funding-group>
      <funding-statement>This work was supported by the German Research Foundation (DFG, ZU377/4-1), the Else Kröner-Fresenius-Stiftung (2021_EKCS.23) and a DAAD scholarship to MD.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="3"/>
      <equation-count count="2"/>
      <ref-count count="42"/>
      <page-count count="13"/>
      <word-count count="5634"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>Introduction</title>
    <p>Progress in life sciences has led to deep insights into physiological and pathological processes in recent years. However, in turn, this also resulted in more and more sophisticated problems to be further addressed. In particular, this concerns the inconceivable complexity of immunological processes that research has discovered and now tries to understand in even greater detail.</p>
    <p>One example are immune-mediated inflammatory disorders (IMIDs) (<xref rid="B1" ref-type="bibr">1</xref>) such as the inflammatory bowel diseases (IBD) ulcerative colitis (UC) and Crohn’s disease (CD) characterized by relapsing-remitting chronic inflammation of the gastrointestinal tract (<xref rid="B2" ref-type="bibr">2</xref>, <xref rid="B3" ref-type="bibr">3</xref>). While an important role of the immune system in the pathogenesis of IBD had early been demonstrated (<xref rid="B4" ref-type="bibr">4</xref>), further ground-breaking insights in fields such as genetics (<xref rid="B5" ref-type="bibr">5</xref>) have shaped the current picture of multifactorial diseases driven by antigen translocation from a dysbiotic luminal microenvironment over a leaky epithelial barrier into the lamina propria of a genetically susceptible individual (<xref rid="B6" ref-type="bibr">6</xref>). Here, dysregulated immune responses are evoked and cause inflammation resulting in tissue destruction and a vicious cycle of further host-environment miscommunication (<xref rid="B7" ref-type="bibr">7</xref>). This also triggers the recruitment of immune cells such as T lymphocytes from the peripheral blood to the intestinal tissue, a process called gut homing that is specifically regulated in the gut and involves molecules such as the chemokine receptor CX3CR1 or the integrin α4β7 (<xref rid="B8" ref-type="bibr">8</xref>). This also contributes to the expansion of diverse pro-inflammatory effector and effector memory T cell subsets in the inflamed gut including T helper 1 (TH1) and T helper 17 (TH17) cells (<xref rid="B9" ref-type="bibr">9</xref>), while regulatory T cells cannot sufficiently suppress these disease-driving cells (<xref rid="B10" ref-type="bibr">10</xref>).</p>
    <p>Technological advances and also the introduction of novel therapeutic approaches (<xref rid="B11" ref-type="bibr">11</xref>–<xref rid="B13" ref-type="bibr">13</xref>) into the clinics have led to unprecedented insights into the regulation of aberrant immune responses in chronic inflammation in general and IBD in particular. In this context, the single cell RNA-sequencing (scRNA-seq) technology has become a popular and indispensable technique for interrogating the transcriptome on single cell level and for resolving the heterogeneity of various subsets of adaptive and innate immune cells involved in inflammatory networks in chronic inflammation (<xref rid="B14" ref-type="bibr">14</xref>). Consistently, while the first single cell being sequenced was reported in 2009 (<xref rid="B15" ref-type="bibr">15</xref>), more than 4000 Pubmed-indexed articles published in 2021 mention single-cell sequencing.</p>
    <p>To aid in the interpretation of these big data, many tools have been written over the past years to support scRNA-seq analyses (<xref rid="B16" ref-type="bibr">16</xref>). Two programs are the backbone for most of these analyses: the Python library Scanpy (<xref rid="B17" ref-type="bibr">17</xref>) and the R package Seurat (<xref rid="B18" ref-type="bibr">18</xref>). To detect communities of cells with similar features, unsupervised clustering according to the Leiden or Louvain algorithms can easily be integrated into Scanpy- or Seurat-based pipelines. However, these approaches may sometimes be limited or time-consuming, when the goal is to analyze a specific subset of cells that does not directly match to the clusters identified.</p>
    <p>We hypothesized that in these situations, manual selection of cells on any two-dimensional representation of single cell sequencing data might be a helpful additive tool for exploring the dataset. Although there are already some interactive single cell analysis tools, which are very user-friendly and allow to manually select cells by polygons without the need for much bioinformatics knowledge (<xref rid="B19" ref-type="bibr">19</xref>, <xref rid="B20" ref-type="bibr">20</xref>), these applications are limited, when it comes to integrating other tools, changing analysis parameters or performing sophisticated downstream analyses. On the other hand, despite a huge variety of solutions for these advanced issues in Scanpy, there is currently no easy way to integrate manual cell selection by polygons in Scanpy-based pipelines. Collectively, there is an unmet need for a tool facilitating not only manual cell selection on single cell data, but also supporting downstream characterization and analyses of the selected population, e.g. in terms of (differential) gene expression, in Scanpy.</p>
    <p>Thus, we aimed to close this gap and to simplify the analysis of immune cell subsets in scRNA-seq analyses in the context of chronic inflammation. To offer Scanpy users the ability to annotate their cells of interest by means of manual selection, we developed scSELpy (single cell SELection python). In addition to selecting cells of interest by drawing polygons around them, it supports further downstream analysis and the generation of publication-ready plots. Our data show that our tool is useful to analyze immune cell heterogeneity in IBD in scRNA-seq beyond conventional clustering and might therefore become an important application for future single cell transcriptomic analyses.</p>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials and methods</title>
    <sec id="s2_1">
      <title>scSELpy</title>
      <p>scSELpy was developed as a Scanpy extension and solely uses libraries required by Scanpy such as matlibplot (<xref rid="B21" ref-type="bibr">21</xref>) and numpy (<xref rid="B22" ref-type="bibr">22</xref>) (<xref rid="T1" ref-type="table"><bold>Table 1</bold></xref>). It allows the scSELpy user to select cells by drawing polygons on top of scatter plots or on either of the following dimension-reduced representations: UMAP (<xref rid="B23" ref-type="bibr">23</xref>), TSNE (<xref rid="B24" ref-type="bibr">24</xref>), PCA or other Scanpy-supported embeddings, limited to 2 dimensions. The selected cells will be annotated according to the names given to the drawn polygons that they are located within, separated by comma. Subsequently, this cell annotation will be stored as observations in the Anndata object (<xref rid="B25" ref-type="bibr">25</xref>). The coordinates of the polygon itself will be stored as unstructured data. Polygons are denominated as integers by default, converted to string. A scSELpy function allows the user to easily convert the default names saved in the annotations to custom names.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Version list.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th valign="top" align="left" rowspan="1" colspan="1">Name</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Language</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Version</th>
              <th valign="top" align="center" rowspan="1" colspan="1">scSELpy import</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">scselpy</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.0.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">–</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">scanpy</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.7.2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">numpy</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.21.1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">matplotlib</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.11.6</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">pandas</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.2.4</td>
              <td valign="top" align="center" rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">scipy</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.6.2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">jupyter</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">6.4.12</td>
              <td valign="top" align="center" rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">rpy2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3.4.5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">scirpy</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.11.2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">magic-impute</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3.0.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">sklearn</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.0.2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">scran</td>
              <td valign="top" align="center" rowspan="1" colspan="1">R</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.14.6</td>
              <td valign="top" align="center" rowspan="1" colspan="1">No</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>The invocation function of scSELpy mimics Scanpy’s plotting function to make it easy for the user to switch between using Scanpy and scSELpy. The scSELpy tool accepts all Scanpy parameters, except for the “Layer” parameter and offers additional parameters for fine tuning and re-plotting of polygons.</p>
      <p>Upon invocation of scSELpy, it will determine if the user is running Python in a shell or in a notebook environment. For scSELpy to work on a notebook, it switches to an interactive matplotlib plotting backend. After the cell selection has been conducted, it will switch back to the default matplotlib plotting backend. On a Python shell such as ipython, a backend switch will not be conducted.</p>
      <p>Afterwards, scSELpy will call Scanpy to create a plot of the specified embedding. While the plot is open, matplotlib’s function “ginput” is called, which will catch the coordinates of all mouseclicks on the plot. When the user is finished selecting the coordinates of a single polygon, the coordinates are sent to the plot function of matplotlib.pyplot, in order to draw the polygon on the Scanpy generated plot. After all polygons are drawn, scSELpy will switch back to a static backend if necessary. Subsequently it will call Scanpy and Matplotlib again to generate a final image for output.</p>
      <p>For each polygon the contains_points function of Matplotlib is called, in order to determine which cells are located within which polygon. This function tests if a given cell coordinate of the passed embedding is located within the given polygon. The output are x boolean lists, where x is the amount of drawn polygons. These boolean lists are converted by scSELpy to a single list that contains, which cell is located in which polygon. The list is assigned to an observation in the anndata object, which is updated in place.</p>
      <p>Additionally, scSELpy has a three functions for calculating the i) percentage of cells in each cluster or region, ii) percentage of cells expressing a given gene in each cluster or region, iii) transcripts per million (TPM) of a given gene in each cluster or region (<xref rid="T2" ref-type="table"><bold>Table 2</bold></xref>). These functions can be used on any observation of the Anndata object and is therefore not exclusive to scSELpy generated regions.</p>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Supported read-outs for manual cell selections with scSELpy – example from <xref rid="f2" ref-type="fig"><bold>Figure 2B</bold></xref>.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th valign="top" align="left" rowspan="1" colspan="1"/>
              <th valign="top" align="center" rowspan="1" colspan="1">Percentage of cells</th>
              <th valign="top" colspan="2" align="center" rowspan="1">Percentage of cells expressing</th>
              <th valign="top" colspan="2" align="center" rowspan="1">TPM of</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <italic>CCR7</italic>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <italic>SELL</italic>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <italic>CCR7</italic>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <italic>SELL</italic>
              </td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Selection</td>
              <td valign="top" align="center" rowspan="1" colspan="1">62.57</td>
              <td valign="top" align="center" rowspan="1" colspan="1">61.21</td>
              <td valign="top" align="center" rowspan="1" colspan="1">57.77</td>
              <td valign="top" align="center" rowspan="1" colspan="1">267.51</td>
              <td valign="top" align="center" rowspan="1" colspan="1">284.72</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Other cells</td>
              <td valign="top" align="center" rowspan="1" colspan="1">37.43</td>
              <td valign="top" align="center" rowspan="1" colspan="1">19.38</td>
              <td valign="top" align="center" rowspan="1" colspan="1">25.19</td>
              <td valign="top" align="center" rowspan="1" colspan="1">61.81</td>
              <td valign="top" align="center" rowspan="1" colspan="1">107.08</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="s2_2">
      <title>Data analysis</title>
      <p>We analyzed two scRNA-seq datasets in this manuscript, which have been previously published under GSE162624 (<xref rid="B26" ref-type="bibr">26</xref>) and GSM6346300. The data were preprocessed and normalized in the same way as in the original study of GSE162624. The entire analysis was conducted on Jupyter notebook v6.4.12. Cells were selected and annotated using scSELpy. All plots were generated using Matplotlib, Scanpy and scSELpy. All data imputations were conducted by MAGIC (<xref rid="B27" ref-type="bibr">27</xref>). T cell receptor analyses were performed with Scirpy (<xref rid="B28" ref-type="bibr">28</xref>).</p>
    </sec>
    <sec id="s2_3">
      <title>Gene enrichment calculation</title>
      <p>Assuming that one Unique Molecular Identifier (UMI) represents one detected mRNA transcript, the transcripts per million (TPM) for a given gene were calculated by dividing all UMIs of this gene in a specific population by all UMIs in the same population, multiplied by one million.</p>
      <disp-formula>
        <mml:math id="M1" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi>T</mml:mi>
            <mml:mi>P</mml:mi>
            <mml:mi>M</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mtext>UMI count for given gene</mml:mtext>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext>Total UMI count</mml:mtext>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
            <mml:mo>*</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mn>10</mml:mn>
              </mml:mrow>
              <mml:mn>6</mml:mn>
            </mml:msup>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>The enrichment for a given gene was calculated by dividing the TPM of a gene within a specific population by the TPM withing all cells outside that population.</p>
      <disp-formula>
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi>E</mml:mi>
            <mml:mi>n</mml:mi>
            <mml:mi>r</mml:mi>
            <mml:mi>i</mml:mi>
            <mml:mi>c</mml:mi>
            <mml:mi>h</mml:mi>
            <mml:mi>m</mml:mi>
            <mml:mi>e</mml:mi>
            <mml:mi>n</mml:mi>
            <mml:mi>t</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mfrac>
              <mml:mrow>
                <mml:mtext>TPM of all cells in specific population</mml:mtext>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext>TPM of all other cells outside of the population</mml:mtext>
              </mml:mrow>
            </mml:mfrac>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </sec>
    <sec id="s2_4">
      <title>Gaussian mixture model</title>
      <p>Cells were divided into groups using a gaussian mixture model with k-means as initializer based on the normalized mRNA-derived UMI count of two marker genes. This was done in Python with sklearn, using the GaussianMixture function from sklearn.mixture and the Kmeans function from sklearn.cluster.</p>
    </sec>
    <sec id="s2_5">
      <title>Availabilty of scSELpy</title>
      <p>scSELpy is available for download at <ext-link xlink:href="https://github.com/MarkDedden/scSELpy" ext-link-type="uri">https://github.com/MarkDedden/scSELpy</ext-link> together with installation instructions, the data analysis pipeline and a link to the documentation, which includes a tutorial.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="s3">
    <title>Results</title>
    <sec id="s3_1">
      <title>Single cell selection in Python</title>
      <p>To overcome the problem that standard scRNA-seq analysis pipelines, for example based on Scanpy, do not include tools to support manual cell selection from scatter or dimension reduction plots for further downstream analysis, we developed scSELpy as detailed in the Methods section.</p>
    </sec>
    <sec id="s3_2">
      <title>Positive selection with scSELpy</title>
      <p>To explore and to demonstrate the functionality of scSELpy, we reanalyzed data (GSE162624) from a previous study (<xref rid="B26" ref-type="bibr">26</xref>), where CD3<sup>+</sup>CD4<sup>+</sup>CD45RO<sup>+</sup>α4<sup>+</sup>β7<sup>+</sup> gut-homing memory T cells from the peripheral human blood were purified by fluorescence-activated cell sorting (FACS) and submitted to single cell transcriptomics.</p>
      <p>Based on a UMAP expression plot for <italic>CX3CR1</italic> generated by Scanpy, we selected a region high in cells expressing <italic>CX3CR1</italic> (<xref rid="f1" ref-type="fig"><bold>Figures 1A–D</bold></xref>). Indeed, a more than 90-fold increase in <italic>CX3CR1</italic> TPM were detected in the selected cells compared to the non-selected cells (<xref rid="f1" ref-type="fig"><bold>Figure 1E</bold></xref>, <xref rid="T3" ref-type="table"><bold>Table 3</bold></xref>). Importantly, the region high in <italic>CX3CR1</italic> selected by the polygon gate was different from the clusters generated by the Leiden community detection algorithm with a resolution of 0.5 (<xref rid="f1" ref-type="fig"><bold>Figure 1F</bold></xref>) and the enrichment of <italic>CX3CR1</italic> transcripts in the manual selection compared with non-selected cells was higher than when comparing Leiden clusters with high vs. low <italic>CX3CR1</italic> expression (<xref rid="f1" ref-type="fig"><bold>Figure 1G</bold></xref>), where the enrichment was only below 40-fold increase in <italic>CX3CR1</italic> TPM. To investigate if further unsupervised subclustering would lead to an enrichment comparable to manual selection, we subclustered cluster 6 (<xref rid="f1" ref-type="fig"><bold>Figure 1H</bold></xref>) and calculated the enrichment for each subcluster. Even when combining the three subclusters (6,0, 6,2, 6,4) with the highest enrichment, we obtained only a 50.74-fold increase in <italic>CX3CR1</italic> TPM. Collectively, these data suggested that in specific scenarios, polygon gates drawn with scSELpy result in more specific positive selection of cell populations enriched for a certain gene than conventional clustering.</p>
      <fig position="float" id="f1">
        <label>Figure 1</label>
        <caption>
          <p>Positive selection of cell subsets on a Scanpy-generated UMAP plot with the scSELpy tool. <bold>(A)</bold> UMAP expression plot of <italic>CX3CR1</italic>. Regions with high <italic>CX3CR1</italic> expression were manually selected using scSELpy. <bold>(B–D)</bold> The cells located in the selected region can be highlighted <bold>(B)</bold>, removed <bold>(C)</bold>, or isolated <bold>(D)</bold> in downstream analysis. <bold>(E)</bold> Barplot with <italic>CX3CR1</italic> transcripts per million transcripts (TPM) for the selected cells versus all other cells. <bold>(F)</bold> Leiden clustering of the dataset with a resolution of 0.5. <bold>(G)</bold> Barplot with <italic>CX3CR1</italic> TPM for cluster 6 and all the other clusters together.<bold>(H)</bold> Subclustering of the leiden cluster 6 from <bold>(E)</bold>.</p>
        </caption>
        <graphic xlink:href="fimmu-14-1027346-g001" position="float"/>
      </fig>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>Enrichment of <italic>CX3CR1</italic>.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th valign="top" align="left" rowspan="1" colspan="1">Cluster</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Enrichment [fold]</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">6</td>
              <td valign="top" align="center" rowspan="1" colspan="1">38.3</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">6,0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">45.3</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">6,1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.2</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">6,2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">13.7</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">6,3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">4.3</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">6,4</td>
              <td valign="top" align="center" rowspan="1" colspan="1">16.6</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">6,0 + 6,2 + 6,4</td>
              <td valign="top" align="center" rowspan="1" colspan="1">50.7</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">scSELpy selection</td>
              <td valign="top" align="center" rowspan="1" colspan="1">91.1</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="s3_3">
      <title>Negative selection with scSELpy</title>
      <p>In a next step, we aimed to show that our application is also useful for the negative selection of cells of interest. Specifically, we sought to analyze T cell subsets relevant in the inflamed mucosa in IBD. Thus, since the dataset comprised peripheral blood memory T cells expressing the gut-homing marker α4β7, we aimed to identify T cells homing to the lamina propria by excluding central memory T (TCM) cells, which home to the gut-associated lymphoid tissue (<xref rid="B29" ref-type="bibr">29</xref>). To this end, we used polygon gates to mark regions high in expression of the TCM markers <italic>CCR7</italic> and <italic>SELL</italic> (CD62L) on UMAP plots (<xref rid="f2" ref-type="fig"><bold>Figure 2A</bold></xref>). The overlay of regions, where both genes were expressed in high levels was removed to obtain the cells equipped for access to the inflamed lamina propria (<xref rid="f2" ref-type="fig"><bold>Figure 2B</bold></xref>
<italic>)</italic> as evident by a low prevalence of cells expressing CCR7 and/or SELL and low expression of these genes in the retained region <italic>(</italic>
<xref rid="T2" ref-type="table"><bold>Table 2</bold></xref>). The remaining cells were further re-analyzed from raw data, creating a new UMAP plot (<xref rid="f2" ref-type="fig"><bold>Figure 2C</bold></xref>).</p>
      <fig position="float" id="f2">
        <label>Figure 2</label>
        <caption>
          <p>Selection and removal of central memory T cells from the dataset using scSELpy to obtain effector memory T cells. <bold>(A)</bold> Selection of regions enriched for cells expressing <italic>CCR7</italic> and <italic>SELL</italic> (CD62L, L-Selectin) on UMAP plots. <bold>(B)</bold> Identification and removal of the cells located in both the <italic>CCR7</italic> and <italic>SELL</italic> polygon as selected in A (green). <bold>(C)</bold> Re-analysis of the remaining cells from raw data. Normalization and UMAP dimension reduction is performed anew. <bold>(D)</bold> Scatter plot of all cells from the dataset with normalized <italic>CCR7</italic> and <italic>SELL</italic> expression on the x-axis and y-axis, respectively. On this scatter plot, scSELpy was employed to categorize cells with or without expression of <italic>CCR7</italic> and/or <italic>SELL</italic>. <bold>(E)</bold> UMAP density plots highlighting the cells belonging to the categories created in <bold>(D)</bold>. The parameter “vmin” to control the lower limit in the color scale was set to 0.05.</p>
        </caption>
        <graphic xlink:href="fimmu-14-1027346-g002" position="float"/>
      </fig>
      <p>To confirm that the selected region was also enriched for cells co-expressing <italic>CCR7</italic> and <italic>SELL</italic>, we employed scSELpy on scatter plots to “gate” for cells highly expressing <italic>CCR7</italic> and <italic>SELL</italic> (<italic>CCR7</italic>
<sup>+</sup>
<italic>SELL</italic>
<sup>+</sup>), highly expressing <italic>CCR7</italic> or <italic>SELL</italic> (<italic>CCR7</italic>
<sup>+</sup>
<italic>SELL</italic>
<sup>-</sup>, <italic>CCR7</italic>
<sup>-</sup>
<italic>SELL</italic>
<sup>+</sup>) and expressing <italic>CCR7</italic> and <italic>SELL</italic> at low levels or not at all (<italic>CCR7</italic>
<sup>-</sup>
<italic>SELL</italic>
<sup>-</sup>; <xref rid="f2" ref-type="fig"><bold>Figure 2D</bold></xref>). Subsequently, we depicted the presence of the cells from these four categories in density plots (<xref rid="f2" ref-type="fig"><bold>Figure 2E</bold></xref>). Here, the vast majority of <italic>CCR7</italic>
<sup>+</sup>
<italic>SELL</italic>
<sup>+</sup> cells were located in the removed region, while most of the <italic>CCR7</italic>
<sup>-</sup>
<italic>SELL</italic>
<sup>-</sup> cells plotted to the region that was kept, indicating that our tool had helped to correctly eliminate TCM cells.</p>
      <p>As scRNA-seq suffers from drop-out events, where mRNA-transcripts that are present in a cell might not be detected, we employed data imputation using MAGIC (<xref rid="B27" ref-type="bibr">27</xref>) to verify that the selections made with scSELpy are not excluding cells falsely negative for <italic>CCR7</italic> and/or <italic>SELL</italic>. We overlayed the polygons of <xref rid="f2" ref-type="fig"><bold>Figure 2A</bold></xref> on the imputed data (<xref rid="SF1" ref-type="supplementary-material"><bold>Figure S1A</bold></xref>) and further depicted the imputed data in a scatter plot and density plots (<xref rid="SF1" ref-type="supplementary-material"><bold>Figures S1B, C</bold></xref>). Indeed, the enrichment of <italic>CCR7</italic>
<sup>+</sup>
<italic>SELL</italic>
<sup>+</sup> in the overlap of the polygons was maintained, supporting the notion that manual selections predominantly include false negative cells (which is intended), but do not exclude them to a relevant degree.</p>
    </sec>
    <sec id="s3_4">
      <title>scSELpy allows for subphenotyping of T cells</title>
      <p>To confirm that the cells remaining after negative selection (<xref rid="f2" ref-type="fig"><bold>Figure 2C</bold></xref>) included tissue-homing TEM cells relevant in IBD and to characterize them, we explored the expression of <italic>TBX21</italic> and <italic>RORC</italic> as key transcription factors for TH1 and TH17 cells, respectively (<xref rid="B30" ref-type="bibr">30</xref>, <xref rid="B31" ref-type="bibr">31</xref>). <italic>TBX21</italic> and <italic>RORC</italic> were expressed in overlapping regions that were manually selected by polygons (<xref rid="f3" ref-type="fig"><bold>Figure 3A</bold></xref>) resulting in the four populations of <italic>TBX21<sup>-</sup>RORC</italic>
<sup>-</sup>, <italic>TBX21<sup>+</sup>RORC<sup>-</sup>
</italic>, <italic>TBX21<sup>-</sup>RORC<sup>+</sup>
</italic> and <italic>TBX21<sup>+</sup>RORC<sup>+</sup>
</italic> cells (<xref rid="f3" ref-type="fig"><bold>Figure 3B</bold></xref>). Interestingly, this matched well to Leiden clustering at a resolution of 0.5 (<xref rid="f3" ref-type="fig"><bold>Figure 3C</bold></xref>). Again, data imputation with MAGIC retrospectively supported the chosen manual selection (<xref rid="SF1" ref-type="supplementary-material"><bold>Figure S1D</bold></xref>).</p>
      <fig position="float" id="f3">
        <label>Figure 3</label>
        <caption>
          <p>Identification and analysis of effector memory T cell subsets with scSELpy. <bold>(A)</bold> Selection of regions enriched in cells expressing the T cell transcription factors <italic>TBX21</italic> or <italic>RORC</italic> among effector memory T cells in the cells obtained in <xref rid="f2" ref-type="fig"><bold>Figure 2C</bold></xref>. <bold>(B)</bold> UMAP plot with cells annotated by scSELpy based on the selections made in <bold>(A). (C)</bold> Clustering of the cells based on the leiden algorithm with a resolution of 0.5. <bold>(D)</bold> Barplot showing the <italic>TBX21</italic> and <italic>RORC</italic> transcripts per million transcripts (TPM) for the populations identified in <bold>(B)</bold>. <bold>(E)</bold>
<italic>CXCR3</italic>, <italic>CCR6</italic> and <italic>CCR4</italic> TPM in the indicated regions.</p>
        </caption>
        <graphic xlink:href="fimmu-14-1027346-g003" position="float"/>
      </fig>
      <p>To validate enriched expression of <italic>TBX21</italic> and <italic>RORC</italic> in the selected populations, we calculated the TPM of the two genes. Indeed, mRNA expression of both transcription factors was substantially increased in the selected cell clusters (<xref rid="f3" ref-type="fig"><bold>Figure 3D</bold></xref>). This was consistent with the notion that <italic>TBX21<sup>+</sup>RORC<sup>-</sup>
</italic>, <italic>TBX21<sup>-</sup>RORC<sup>+</sup>
</italic> and <italic>TBX21<sup>+</sup>RORC<sup>+</sup>
</italic> cells corresponded to TH1, TH17 and TH1/17 cells (a subset that has been described in the gut of patients with CD (<xref rid="B32" ref-type="bibr">32</xref>)), respectively. Thus, we further aimed to corroborate successful T helper cell subset identification by our tool and analyzed chemokine receptor expression in these three datasets. As expected based on previous reports (<xref rid="B33" ref-type="bibr">33</xref>), <italic>TBX21<sup>+</sup>RORC<sup>-</sup>
</italic> cells were CXCR3<sup>high</sup>, but <italic>CCR4<sup>low</sup>
</italic> and <italic>CCR6<sup>low</sup>
</italic>, <italic>TBX21<sup>-</sup>RORC<sup>+</sup>
</italic> cells <italic>CCR6<sup>high</sup>
</italic> and <italic>CCR4<sup>high</sup>
</italic>, but <italic>CXCR3</italic>
<sup>low</sup> and <italic>TBX21<sup>+</sup>RORC<sup>+</sup>
</italic> cells were <italic>CXCR3<sup>high</sup>
</italic> and <italic>CCR6<sup>high</sup>
</italic>, but <italic>CCR4<sup>low</sup>
</italic> (<xref rid="f3" ref-type="fig"><bold>Figure 3E</bold></xref>).</p>
      <p>Moreover, to further compare the capability of scSELpy to select cells enriched for a certain gene with another technique that is independent of spatially represented clusters or regions, we applied a Gaussian mixture model clustering with K-means as initializer for <italic>TBX21</italic> and <italic>RORC</italic> on the cells obtained in <xref rid="f2" ref-type="fig"><bold>Figure 2C</bold></xref>. However, in this case, the algorithm was not able to identify a specific regions enriched for <italic>TBX21</italic> and/or <italic>RORC</italic> (<xref rid="SF2" ref-type="supplementary-material"><bold>Figure S2A</bold></xref>), strongly contradicting the impression supported by Leiden clustering and scSELpy selection that T helper cell populations cluster in defined regions. Thus, this scenario identified another situation, where scSELpy was better suited than established alternative solutions.</p>
      <p>Collectively, these data showed that our tool had indeed identified TEM cells and was also able to further sub-cluster well-defined T helper cell subsets, which are relevant in IBD.</p>
    </sec>
    <sec id="s3_5">
      <title>scSELpy analysis confirms the phenotype of vedolizumab-resistant regulatory T cells</title>
      <p>In a next step, we wanted to find out, what kind of cells were represented in the <italic>TBX21<sup>-</sup>RORC<sup>-</sup>
</italic> cluster. Since, regulatory T (Treg) cells are another important gut-homing T cell population and play an important role in the resolution of intestinal inflammation (<xref rid="B8" ref-type="bibr">8</xref>, <xref rid="B10" ref-type="bibr">10</xref>), we explored the expression of the key Treg transcription factor <italic>FOXP3</italic>. Not very surprising, we detected markedly enriched <italic>FOXP3</italic> expression and manually selected the subset for downstream analysis (<xref rid="f4" ref-type="fig"><bold>Figure 4A</bold></xref>). In further support of the Treg nature of these cells, several other Treg-associated molecules were expressed to significantly higher levels than in the other T cell subsets (<xref rid="f4" ref-type="fig"><bold>Figure 4B</bold></xref>).</p>
      <fig position="float" id="f4">
        <label>Figure 4</label>
        <caption>
          <p>Selection and analysis of regulatory T cells with scSELpy. <bold>(A)</bold> Selection of the region enriched for <italic>FOXP3</italic> expression, using the UMAP representation presented in <xref rid="f2" ref-type="fig"><bold>Figure 2C</bold></xref>. The selections for <italic>RORC</italic> and <italic>TBX21</italic> from <xref rid="f3" ref-type="fig"><bold>Figure 3A</bold></xref> are marked with dotted lines. <bold>(B)</bold> Violin plots of the expression of eight genes associated with Tregs in the four regions determined based on <italic>TBX21</italic> and <italic>RORC</italic> expression. <bold>(C)</bold> Depiction of cells binding vedolizumab or not as determined by FACS sorting prior to sequencing on the population selected in <bold>(A)</bold>. <bold>(D)</bold> Expression of <italic>ITGB1</italic> and <italic>PI16</italic> in the cell population selected in <bold>(A)</bold>. <bold>(E)</bold> Stacked violin plot of <italic>PI16</italic> and <italic>ITGB1</italic> expression for Vedolizumab-binding cells and cells that do not bind Vedolizumab.</p>
        </caption>
        <graphic xlink:href="fimmu-14-1027346-g004" position="float"/>
      </fig>
      <p>Since the dataset consisted of sorted cells binding or not binding the anti-α4β7 integrin antibody vedolizumab, which is used for clinical therapy of IBD (<xref rid="B34" ref-type="bibr">34</xref>, <xref rid="B35" ref-type="bibr">35</xref>), and we had previously shown in that dataset that a subset of Tregs is enriched for vedolizumab-resistant cells (<xref rid="B26" ref-type="bibr">26</xref>), we now explored whether scSELpy-based analysis comes to the same conclusion. Thus, we depicted vedolizumab binding cells and vedolizumab non-binding cells in our Treg population. Consistent with our previous analysis, a majority of Tregs did not bind vedolizumab (<xref rid="f4" ref-type="fig"><bold>Figure 4C</bold></xref>). Moreover, <italic>ITGB1</italic> and <italic>PI16</italic>, two genes that had been found to mark those vedolizumab-resistant Tregs were clearly enriched in the Treg fraction that did not bind vedolizumab (<xref rid="f4" ref-type="fig"><bold>Figure 4D, E</bold></xref>). Taken together, these data showed that scSELpy is able to reproduce earlier findings and is, thus, a valid tool for advanced analyses of single cell transcriptomics in general and in the context of IBD in particular.</p>
    </sec>
    <sec id="s3_6">
      <title>scSELpy helps analyzing protein expression and TCR sequencing data</title>
      <p>To demonstrate that scSELpy is able to analyze protein expression identified by antibody-oligo capture, we analyzed the dataset GSM6346300 with scSELpy (<xref rid="B36" ref-type="bibr">36</xref>). In that dataset, PBMCs from four patients were isolated from the blood and sequenced on a 10x Chromium controller. This included V(D)J single-cell T cell receptor (TCR) sequencing and Feature Barcoding to capture the protein expression of CD4, CD8 and CD45RA. We loaded the TCR data using Scirpy, merged it with the scRNA-seq dataset and removed all cells that had no TCR detected using the “has_ir” observation created by Scirpy. We proceeded under the assumption that the remaining subset consists of only T cells. We used Leiden clustering with a resolution of 0.5 to assign clusters on a two dimensional UMAP plot (<xref rid="f5" ref-type="fig"><bold>Figure 5A</bold></xref>).</p>
      <fig position="float" id="f5">
        <label>Figure 5</label>
        <caption>
          <p>Applying scSELpy on T cell receptor (TCR) sequencing and antibody capture data. The single cell RNA sequencing data of PBMCs in blood from patients treated with Immune checkpoint inhibitors was retrieved from GSM6346300. Only cells, for which a TCR is detected are used in these plots. <bold>(A)</bold> UMAP plot of the cells; clusters are defined by leiden with a resolution of 0.5. <bold>(B)</bold> Scatter plot with the detected CD4 and CD8 antibody UMIs on the x-axis and y-axis, respectively. Gates set with scSELpy split the data up into CD4<sup>+</sup>CD8<sup>+</sup> double positive cells, single positive CD4<sup>+</sup>CD8<sup>-</sup> cells, single positive CD4<sup>-</sup>CD8<sup>+</sup> cells and CD4<sup>-</sup>CD8<sup>-</sup> double negative cells. The <italic>CD3D</italic> mRNA derived UMI count is highlighted in red. <bold>(C)</bold> Visualization of the four groups defined in <bold>(A)</bold> on the UMAP plot. A group of cells is selected with scSELpy. <bold>(D)</bold> UMAP representation of T cells selected in <bold>(C)</bold> (magenta) together with all other T cells also expressing one of the TCRs present in the selection (blue). Cells colored in grey do not have a clonotype that matches a T cell in the selected region. <bold>(E)</bold> TCR repertoire of CD4<sup>+</sup>CD8<sup>-</sup> cells plotted against TCR repertoire of CD4<sup>+</sup>CD8<sup>+</sup> cells for each clone ID using Scirpy. Clone IDs that are present in both cell populations were selected using scSELpy. <bold>(F)</bold> Mapping of the cells selected in <bold>(E)</bold> on the scatter plot of CD4 and CD8 antibody UMIs with the gates kept as in <bold>(B)</bold>. <bold>(G)</bold> UMAP representation of the T cells selected in <bold>(E)</bold>.</p>
        </caption>
        <graphic xlink:href="fimmu-14-1027346-g005" position="float"/>
      </fig>
      <p>Using scSELpy, we drew a gate for CD8<sup>+</sup> cells and a gate for CD4<sup>+</sup> cells on a scatter plot of raw CD8 and CD4 antibody interaction-derived UMI counts with a logaritmic axis (<xref rid="f5" ref-type="fig"><bold>Figure 5B</bold></xref>). We highlighted the <italic>CD3D</italic> (<xref rid="f5" ref-type="fig"><bold>Figure 5B</bold></xref>), <italic>CD8A</italic>, <italic>CD8B</italic> and <italic>CD4</italic> mRNA-dervied UMI count (<xref rid="SF2" ref-type="supplementary-material"><bold>Figure S2B</bold></xref>) to show that the mRNA expression of <italic>CD8</italic> and <italic>CD4</italic> is enriched in their respective gates. The CD4<sup>+</sup>CD8<sup>-</sup>, CD4<sup>-</sup>CD8<sup>+</sup>, CD4<sup>+</sup>CD8<sup>+</sup> and CD4<sup>-</sup>CD8<sup>-</sup> populations were now mapped back to the initial UMAP plot (<xref rid="f5" ref-type="fig"><bold>Figure 5C</bold></xref>, <xref rid="SF2" ref-type="supplementary-material"><bold>Figure S2C</bold></xref>). Interestingly, in this case, these populations were well aligned with those identified by the gaussian mixture model clustering with K-means as initializer (<xref rid="SF2" ref-type="supplementary-material"><bold>Figure S2D</bold></xref>). To demonstrate that this is a feasible starting point for further downstream analyses and that scSELpy can also assist in understanding TCR sequencing data, we manually selected a region of cluster 5 enriched for CD8<sup>+</sup> T cells with scSELpy (<xref rid="f5" ref-type="fig"><bold>Figure 5C</bold></xref>). Building on the Scanpy-based library for T cell receptor-sequencing data analysis, Scirpy, we now plotted all other cells sharing a clonotype with any of the cells in this area and found that these cells mainly map to the clusters 1, 3, 4 and 8 (<xref rid="f5" ref-type="fig"><bold>Figure 5D</bold></xref>).</p>
      <p>To further demonstrate the potential to use scSELpy for analyzing combined TCR and scRNA sequencing data, we used Scirpy’s repertoire_overlap function to plot the T cell repertoire overlap between the CD4<sup>+</sup>CD8<sup>-</sup> gate and the CD4<sup>+</sup>CD8<sup>+</sup> cells. Using scSELpy on this plot, we selected clonotypes that are present in cells of both gates (<xref rid="f5" ref-type="fig"><bold>Figure 5E</bold></xref>) and plotted them in the CD8 versus CD4 scatterplot (<xref rid="f5" ref-type="fig"><bold>Figure 5F</bold></xref>), keeping the gates as set in <xref rid="f5" ref-type="fig"><bold>Figure 5B</bold></xref>, and in the UMAP plot (<xref rid="f5" ref-type="fig"><bold>Figure 5G</bold></xref>) as potential starting points for further selection and analysis procedures.</p>
      <p>Collectively, these approaches demonstrated that scSELpy can be used as a convenient and flexible tool helping in the exploration and analysis of multi-dimensional single cell sequencing data.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s4">
    <title>Discussion</title>
    <p>Single cell RNA sequencing has revolutionized immunological research and has helped to substantially increase the resolution of immune cell phenotyping (<xref rid="B14" ref-type="bibr">14</xref>). However, this comes at the cost of complex <italic>in silico</italic> analyses to be performed.</p>
    <p>Here, we introduce a new tool called scSELpy designed to enable the manual selection of cells analyzed by single cell transcriptomics in scatter plots or dimension reduction representations to allow further downstream analysis. As such, it is inspired by the “gating” used in multicolor flow cytometry as the most widely used technique to interrogate protein expression on single cell level (<xref rid="B37" ref-type="bibr">37</xref>). In flow cytometry, such gating serves to select certain cell populations in a hierarchical manner and to determine the abundance and phenotype of cell subsets in this way (<xref rid="B38" ref-type="bibr">38</xref>).</p>
    <p>Manual cell selection in scatter plots visualizing the expression of two different genes per cell as offered by scSELpy comes most closely to this function. However, the high number of parameters analyzed by single cell RNA sequencing also imposes the necessity to include dimension reduction techniques to appropriately visualize and analyze relationships between the single cells (<xref rid="B23" ref-type="bibr">23</xref>, <xref rid="B24" ref-type="bibr">24</xref>). Consistently, scSELpy also offers manual cell selection on dimension-reduced UMAP or t-SNE plots. Yet, it needs to be considered that in this case “gating” will not result in the binary selection of cells with and without expression of one or more genes (or high or low expression), but only in the selection of a population enriched in cells expressing those genes. This population will also include closely related cells, in which expression of the gene has not been detected, which might be due to absent expression or expression below the detection threshold of single cell RNA sequencing (<xref rid="B39" ref-type="bibr">39</xref>). Our findings with imputed data further support this notion, since the polygons drawn before data imputation captured the majority of false-negative cells and missed only few of them. Taken together, these aspects emphasize that, while similar in handling, “gating” on scRNA-seq data, is clearly different from flow cytometry gating.</p>
    <p>Importantly, scSELpy also supports the analysis of single cell data including TCR sequencing or sequencing of surface proteins detected by antibody-oligo reaction. Thus, in the specific case of protein expression analysis, scSELpy can actually be used for binary gating of surface expression markers very similar to flow cytometry. With regard to TCR analyses, we show that scSELpy can identify and plot clonotypes in various representations and might thus help to explore their role and function. Again, this is not an exclusive feature of scSELpy, since for instance clonotype overlap in different cell types can also be identified using Scirpy’s clonotype_imbalance function. Thus, it is important to understand scSELpy as a complementary tool that can be used together with other important approaches to reach a deeper understanding of the data.</p>
    <p>Several publicly available applications such as the Loup Browser offered by 10x Genomics, CELLxGENE, the UCSC Cell Browser (<xref rid="B19" ref-type="bibr">19</xref>, <xref rid="B20" ref-type="bibr">20</xref>) or Shiny-based applications for scRNA-seq such as SCHNAPPs (<xref rid="B40" ref-type="bibr">40</xref>) are graphical user interface platforms for single cell analysis, of which the first three mentioned offer similar tools for manual cell selection. However, while those applications are easy to handle also for researchers without training in bioinformatics, a limitation of them is that further downstream analyses are not supported. Thus, scSELpy has been designed for use on the Scanpy platform, one of the standard applications used for the analysis of single cell RNA-seq data (<xref rid="B17" ref-type="bibr">17</xref>) and integrates a workflow to enable easy downstream phenotyping of selected cells such as further sub-clustering, re-plotting or differential expression analysis.</p>
    <p>A standard technique to identify specific cell populations on single cell transcriptomic data is clustering according to the Leiden or Louvain algorithm (<xref rid="B41" ref-type="bibr">41</xref>). Depending on the resolution used, these algorithms dissect the overall cell population into several clusters, which can subsequently be extracted and further analyzed. It is important to mention that scSELpy is not at all meant to replace such clustering-based identification and selection of cell populations, but as an additional tool that might be helpful in certain situations.</p>
    <p>One key difference to scSELpy is that Leiden or Louvain clustering are unsupervised and thus unbiased. In consequence, one might mention that scSELpy unnecessarily introduces bias into single cell RNA sequencing analysis by allowing to select cells based on one or more deliberately chosen genes. While this has to been accepted as a potential limitation and to be kept in mind during analysis, it is also important to note that conventional clustering might not always perfectly capture biological processes that are not dominating the phenotype of cell subsets or are shared between subsets. For example, this might be processes of cell migration such as gut homing. Consistently, our data show that manual cell selection by scSELpy helps to increase the enrichment of specific gene expression in the selected populations. This might be of particular value in a time, where the re-analysis of previously published datasets from a novel perspective is becoming more and more important (<xref rid="B42" ref-type="bibr">42</xref>).</p>
    <p>It is essential to underscore that in many situations (e.g. as documented in <xref rid="f3" ref-type="fig"><bold>Figure 3C</bold></xref> or <xref rid="SF2" ref-type="supplementary-material"><bold>Figure S2D</bold></xref>) there exist conventional alternatives such as Leiden or Louvain clustering or k means clustering that lead to similar results as manual cell selection with scSELpy. Thus, in these situations, the benefits (fast, easy) and the limitations (subjectivity) associated with the use of scSELpy must be carefully weighed. However, as we show (<xref rid="f1" ref-type="fig"><bold>Figure 1E-H</bold></xref>, <xref rid="SF2" ref-type="supplementary-material"><bold>Figure S2A</bold></xref>), there are also scenarios, where scSELpy results in superior selection of enriched populations. Similarly, one can also consider situations, where the use of scSELpy is limited by very rare expression of a gene or equal distribution over the dimensionality-reduced space and alternative ways of cell selection will be more helpful. In consequence, we think that scSELpy is a valuable part of the toolbox in state-of-the-art single cell analysis that should especially be used in situations, where conventional community detection or cell type identification are not possible, sub-optimal or very time-consuming or where the role of a gene regardless of the association to a specific (sub-)community is explored.</p>
    <p>We demonstrate the feasibility of our approach in a dataset characterizing gut-homing memory T cells from the peripheral blood, a cell population that is of particular interest for the pathogenesis of IBD and has become a therapeutic target by blocking its gut homing through the anti-α4β7 integrin antibody vedolizumab (<xref rid="B7" ref-type="bibr">7</xref>). In addition to proving the suitability of scSELpy for appropriate positive and negative selection strategies, we also show that our tool is helpful in supporting the analysis of cell populations such as TH1, TH17 or TH1/17 cells, all of which have been demonstrated to crucially implicated in IBD (<xref rid="B30" ref-type="bibr">30</xref>–<xref rid="B32" ref-type="bibr">32</xref>). Thus, scSELpy might help to obtain further insights into immune cell regulation in IBD and other chronic inflammatory diseases in the future. Moreover, in regulatory T cells our tool was able reproduce the earlier finding that α4β7-expressing regulatory T cells are enriched in cells “resistant” to vedolizumab and that β1 integrin and PI16 are highly expressed in those cells (<xref rid="B26" ref-type="bibr">26</xref>). It might therefore also be employed for future translational studies in the field of IBD aiming at dissecting the mechanisms of state-of-the art treatment options at higher resolution.</p>
    <p>Taken together, to the best of our knowledge, scSELpy is the first tool that can offer Scanpy-based manual cell selection. Based on the data presented, we project that, when used intentionally, it might broadly support and facilitate single cell transcriptomic analyses for many researchers in the field of immunology in general and in IBD in special.</p>
  </sec>
  <sec sec-type="data-availability" id="s5">
    <title>Data availability statement</title>
    <p>The datasets presented in this study can be found in online repositories. The names of the repository/repositories and accession number(s) can be found in the article/<xref rid="s10" ref-type="sec"><bold>Supplementary Material</bold></xref>.</p>
  </sec>
  <sec sec-type="author-contributions" id="s6">
    <title>Author contributions</title>
    <p>MD developed scSELpy and performed the analyses. MD and SZ designed the analyses and interpreted the data together with MW, TM and MN. MD and SZ drafted the manuscript; All authors contributed to the article and approved the submitted version.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>The research of TM, MN and SZ was supported by the Interdisciplinary Center for Clinical Research (IZKF) and the ELAN program of the Universität Erlangen-Nürnberg, the Fritz-Bender-Stiftung, the Ernst Jung-Stiftung, the Else Kröner-Fresenius-Stiftung, the Thyssen-Stiftung, the German Crohn’s and Colitis Foundation (DCCV), the DFG topic program on Microbiota, the Emerging Field Initiative, the DFG Collaborative Research Centers 643, 796, 1181 and TRR241, the Rainin Foundation and the Litwin IBD Pioneers program of the Crohn’s and Colitis Foundation of America (CCFA). We acknowledge financial support by the German Research Foundation (ZU377/4-1) and Friedrich-Alexander-Universität Erlangen-Nürnberg within the funding programme “Open Access Publication Funding”.</p>
  </ack>
  <sec sec-type="COI-statement" id="s8">
    <title>Conflict of interest</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
  <sec sec-type="disclaimer" id="s9">
    <title>Publisher’s note</title>
    <p>All claims expressed in this article are solely those of the authors and do not necessarily represent those of their affiliated organizations, or those of the publisher, the editors and the reviewers. Any product that may be evaluated in this article, or claim that may be made by its manufacturer, is not guaranteed or endorsed by the publisher.</p>
  </sec>
  <sec sec-type="supplementary-material" id="s10">
    <title>Supplementary material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link xlink:href="https://www.frontiersin.org/articles/10.3389/fimmu.2023.1027346/full#supplementary-material" ext-link-type="uri">https://www.frontiersin.org/articles/10.3389/fimmu.2023.1027346/full#supplementary-material</ext-link>
</p>
    <supplementary-material id="SF1" position="float" content-type="local-data">
      <label>Supplementary Figure 1</label>
      <caption>
        <p>Visualization of how the previously set selections in Figures 2, 3 and look with imputed data. <bold>(A)</bold> The same UMAP plot and selection as in Figure 2D, where now the imputed data is visualized. <bold>(B)</bold> Same scatter plot as in Figure 2D, where now the imputed data is used. <bold>(C)</bold> UMAP density plots highlighting the cells belonging to the categories created in <bold>(B)</bold>. The parameter “vmin” to control the lower limit in the color scale was set to 0.05. <bold>(D)</bold> The same UMAP plot and selection as in Figure 3A visualizing the imputed data. The parameter “vmax” to control the upper limit in the color scale was set to 0.12.</p>
      </caption>
      <media xlink:href="Image_1.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SF2" position="float" content-type="local-data">
      <label>Supplementary Figure 2</label>
      <caption>
        <p><bold>(A)</bold> Guassian mixture model of <italic>RORC</italic> and <italic>TBX21</italic> mRNA-derived UMI count with the data from Figure 3, plotted on the same UMAP plot. <bold>(B)</bold> The same plot as Figure 5A, with the modification that the <italic>CD8A</italic> (left), <italic>CD8</italic>B (middle) and <italic>CD4</italic> (right) mRNA derived UMI count is highlighted as indicated. <bold>(C)</bold> UMAP plot with CD8 (right) and CD4 (left) antibody UMI counts highlighted in red. <bold>(D)</bold> Guassian mixture model of <italic>CD4</italic> and <italic>CD8A</italic> mRNA-derived UMI count with the data from Figure 5B, plotted on the same UMAP plot.</p>
      </caption>
      <media xlink:href="Image_2.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schett</surname><given-names>G</given-names></name><name><surname>McInnes</surname><given-names>IB</given-names></name><name><surname>Neurath</surname><given-names>MF</given-names></name></person-group>. <article-title>Reframing immune-mediated inflammatory diseases through signature cytokine hubs</article-title>. <source>N Engl J Med</source> (<year>2021</year>) <volume>385</volume>:<page-range>628–39</page-range>. doi: <pub-id pub-id-type="doi">10.1056/NEJMra1909094</pub-id>
</mixed-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roda</surname><given-names>G</given-names></name><name><surname>Chien Ng</surname><given-names>S</given-names></name><name><surname>Kotze</surname><given-names>PG</given-names></name><name><surname>Argollo</surname><given-names>M</given-names></name><name><surname>Panaccione</surname><given-names>R</given-names></name><name><surname>Spinelli</surname><given-names>A</given-names></name><etal/></person-group>. <article-title>Crohn’s disease</article-title>. <source>Nat Rev Dis Primer</source> (<year>2020</year>) <volume>6</volume>:<fpage>22</fpage>. doi: <pub-id pub-id-type="doi">10.1038/s41572-020-0156-2</pub-id>
</mixed-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Danese</surname><given-names>S</given-names></name><name><surname>Fiocchi</surname><given-names>C</given-names></name></person-group>. <article-title>Ulcerative colitis</article-title>. <source>N Engl J Med</source> (<year>2011</year>) <volume>365</volume>:<page-range>1713–25</page-range>. doi: <pub-id pub-id-type="doi">10.1056/NEJMra1102942</pub-id>
</mixed-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fuss</surname><given-names>IJ</given-names></name><name><surname>Neurath</surname><given-names>M</given-names></name><name><surname>Boirivant</surname><given-names>M</given-names></name><name><surname>Klein</surname><given-names>JS</given-names></name><name><surname>de la Motte</surname><given-names>C</given-names></name><name><surname>Strong</surname><given-names>SA</given-names></name><etal/></person-group>. <article-title>Disparate CD4+ lamina propria (LP) lymphokine secretion profiles in inflammatory bowel disease. crohn’s disease LP cells manifest increased secretion of IFN-gamma, whereas ulcerative colitis LP cells manifest increased secretion of IL-5</article-title>. <source>J Immunol Baltim Md 1950</source> (<year>1996</year>) <volume>157</volume>:<page-range>1261–70</page-range>.</mixed-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jostins</surname><given-names>L</given-names></name><name><surname>Ripke</surname><given-names>S</given-names></name><name><surname>Weersma</surname><given-names>RK</given-names></name><name><surname>Duerr</surname><given-names>RH</given-names></name><name><surname>McGovern</surname><given-names>DP</given-names></name><name><surname>Hui</surname><given-names>KY</given-names></name><etal/></person-group>. <article-title>Host-microbe interactions have shaped the genetic architecture of inflammatory bowel disease</article-title>. <source>Nature</source> (<year>2012</year>) <volume>491</volume>:<page-range>119–24</page-range>. doi: <pub-id pub-id-type="doi">10.1038/nature11582</pub-id>
</mixed-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>JT</given-names></name></person-group>. <article-title>Pathophysiology of inflammatory bowel diseases</article-title>. <source>N Engl J Med</source> (<year>2020</year>) <volume>383</volume>:<page-range>2652–64</page-range>. doi: <pub-id pub-id-type="doi">10.1056/NEJMra2002697</pub-id>
</mixed-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neurath</surname><given-names>MF</given-names></name></person-group>. <article-title>Targeting immune cell circuits and trafficking in inflammatory bowel disease</article-title>. <source>Nat Immunol</source> (<year>2019</year>) <volume>20</volume>:<page-range>970–9</page-range>. doi: <pub-id pub-id-type="doi">10.1038/s41590-019-0415-0</pub-id>
</mixed-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zundler</surname><given-names>S</given-names></name><name><surname>Becker</surname><given-names>E</given-names></name><name><surname>Schulze</surname><given-names>LL</given-names></name><name><surname>Neurath</surname><given-names>MF</given-names></name></person-group>. <article-title>Immune cell trafficking and retention in inflammatory bowel disease: mechanistic insights and therapeutic advances</article-title>. <source>Gut</source> (<year>2019</year>) <volume>68</volume>:<page-range>1688–700</page-range>. doi: <pub-id pub-id-type="doi">10.1136/gutjnl-2018-317977</pub-id>
</mixed-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neurath</surname><given-names>MF</given-names></name></person-group>. <article-title>Cytokines in inflammatory bowel disease</article-title>. <source>Nat Rev Immunol</source> (<year>2014</year>) <volume>14</volume>:<page-range>329–42</page-range>. doi: <pub-id pub-id-type="doi">10.1038/nri3661</pub-id>
</mixed-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maul</surname><given-names>J</given-names></name><name><surname>Loddenkemper</surname><given-names>C</given-names></name><name><surname>Mundt</surname><given-names>P</given-names></name><name><surname>Berg</surname><given-names>E</given-names></name><name><surname>Giese</surname><given-names>T</given-names></name><name><surname>Stallmach</surname><given-names>A</given-names></name><etal/></person-group>. <article-title>Peripheral and intestinal regulatory CD4+ CD25(high) T cells in inflammatory bowel disease</article-title>. <source>Gastroenterology</source> (<year>2005</year>) <volume>128</volume>:<page-range>1868–78</page-range>. doi: <pub-id pub-id-type="doi">10.1053/j.gastro.2005.03.043</pub-id>
</mixed-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feagan</surname><given-names>BG</given-names></name><name><surname>Sandborn</surname><given-names>WJ</given-names></name><name><surname>Gasink</surname><given-names>C</given-names></name><name><surname>Jacobstein</surname><given-names>D</given-names></name><name><surname>Lang</surname><given-names>Y</given-names></name><name><surname>Friedman</surname><given-names>JR</given-names></name><etal/></person-group>. <article-title>Ustekinumab as induction and maintenance therapy for crohn’s disease</article-title>. <source>N Engl J Med</source> (<year>2016</year>) <volume>375</volume>:<page-range>1946–60</page-range>. doi: <pub-id pub-id-type="doi">10.1056/NEJMoa1602773</pub-id>
</mixed-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sandborn</surname><given-names>WJ</given-names></name><name><surname>Feagan</surname><given-names>BG</given-names></name><name><surname>D’Haens</surname><given-names>G</given-names></name><name><surname>Wolf</surname><given-names>DC</given-names></name><name><surname>Jovanovic</surname><given-names>I</given-names></name><name><surname>Hanauer</surname><given-names>SB</given-names></name><etal/></person-group>. <article-title>Ozanimod as induction and maintenance therapy for ulcerative colitis</article-title>. <source>N Engl J Med</source> (<year>2021</year>) <volume>385</volume>:<page-range>1280–91</page-range>. doi: <pub-id pub-id-type="doi">10.1056/NEJMoa2033617</pub-id>
</mixed-citation>
    </ref>
    <ref id="B13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feagan</surname><given-names>BG</given-names></name><name><surname>Danese</surname><given-names>S</given-names></name><name><surname>Loftus</surname><given-names>EV</given-names></name><name><surname>Vermeire</surname><given-names>S</given-names></name><name><surname>Schreiber</surname><given-names>S</given-names></name><name><surname>Ritter</surname><given-names>T</given-names></name><etal/></person-group>. <article-title>Filgotinib as induction and maintenance therapy for ulcerative colitis (SELECTION): a phase 2b/3 double-blind, randomised, placebo-controlled trial</article-title>. <source>Lancet</source> (<year>2021</year>) <volume>397</volume>:<page-range>2372–84</page-range>. doi: <pub-id pub-id-type="doi">10.1016/S0140-6736(21)00666-8</pub-id>
</mixed-citation>
    </ref>
    <ref id="B14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>X</given-names></name><name><surname>Zhou</surname><given-names>X</given-names></name></person-group>. <article-title>Impact of single-cell RNA sequencing on understanding immune regulation</article-title>. <source>J Cell Mol Med</source> (<year>2022</year>) <volume>26</volume>:<page-range>4645–57</page-range>. doi: <pub-id pub-id-type="doi">10.1111/jcmm.17493</pub-id>
</mixed-citation>
    </ref>
    <ref id="B15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>F</given-names></name><name><surname>Barbacioru</surname><given-names>C</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Nordman</surname><given-names>E</given-names></name><name><surname>Lee</surname><given-names>C</given-names></name><name><surname>Xu</surname><given-names>N</given-names></name><etal/></person-group>. <article-title>mRNA-seq whole-transcriptome analysis of a single cell</article-title>. <source>Nat Methods</source> (<year>2009</year>) <volume>6</volume>:<page-range>377–82</page-range>. doi: <pub-id pub-id-type="doi">10.1038/nmeth.1315</pub-id>
</mixed-citation>
    </ref>
    <ref id="B16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andrews</surname><given-names>TS</given-names></name><name><surname>Kiselev</surname><given-names>VY</given-names></name><name><surname>McCarthy</surname><given-names>D</given-names></name><name><surname>Hemberg</surname><given-names>M</given-names></name></person-group>. <article-title>Tutorial: guidelines for the computational analysis of single-cell RNA sequencing data</article-title>. <source>Nat Protoc</source> (<year>2021</year>) <volume>16</volume>:<fpage>1</fpage>–<lpage>9</lpage>. doi: <pub-id pub-id-type="doi">10.1038/s41596-020-00409-w</pub-id>
<pub-id pub-id-type="pmid">33288955</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>FA</given-names></name><name><surname>Angerer</surname><given-names>P</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group>. <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source> (<year>2018</year>) <volume>19</volume>:<fpage>15</fpage>. doi: <pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id>
<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hao</surname><given-names>Y</given-names></name><name><surname>Hao</surname><given-names>S</given-names></name><name><surname>Andersen-Nissen</surname><given-names>E</given-names></name><name><surname>Mauck</surname><given-names>WM</given-names></name><name><surname>Zheng</surname><given-names>S</given-names></name><name><surname>Butler</surname><given-names>A</given-names></name><etal/></person-group>. <article-title>Integrated analysis of multimodal single-cell data</article-title>. <source>Cell</source> (<year>2021</year>) <volume>184</volume>:<fpage>3573</fpage>–<lpage>3587.e29</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.cell.2021.04.048</pub-id>
<pub-id pub-id-type="pmid">34062119</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Speir</surname><given-names>ML</given-names></name><name><surname>Bhaduri</surname><given-names>A</given-names></name><name><surname>Markov</surname><given-names>NS</given-names></name><name><surname>Moreno</surname><given-names>P</given-names></name><name><surname>Nowakowski</surname><given-names>TJ</given-names></name><name><surname>Papatheodorou</surname><given-names>I</given-names></name><etal/></person-group>. <article-title>UCSC cell browser: visualize your single-cell data</article-title>. <source>Bioinforma Oxf Engl</source> (<year>2021</year>) <volume>37</volume>:<page-range>4578–80</page-range>. doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/btab503</pub-id>
</mixed-citation>
    </ref>
    <ref id="B20">
      <label>20</label>
      <mixed-citation publication-type="webpage"><person-group person-group-type="author"><collab>Cellxgene Data Portal</collab></person-group>. <source>Cellxgene data portal</source>. Available at: <uri xlink:href="https://cellxgene.cziscience.com/">https://cellxgene.cziscience.com/</uri> (Accessed <date-in-citation content-type="access-date">8, 2022</date-in-citation>).</mixed-citation>
    </ref>
    <ref id="B21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hunter</surname><given-names>JD</given-names></name></person-group>. <article-title>Matplotlib: a 2D graphics environment</article-title>. <source>Comput Sci Eng</source> (<year>2007</year>) <volume>9</volume>:<page-range>90–5</page-range>. doi: <pub-id pub-id-type="doi">10.1109/MCSE.2007.55</pub-id>
</mixed-citation>
    </ref>
    <ref id="B22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>CR</given-names></name><name><surname>Millman</surname><given-names>KJ</given-names></name><name><surname>van der Walt</surname><given-names>SJ</given-names></name><name><surname>Gommers</surname><given-names>R</given-names></name><name><surname>Virtanen</surname><given-names>P</given-names></name><name><surname>Cournapeau</surname><given-names>D</given-names></name><etal/></person-group>. <article-title>Array programming with NumPy</article-title>. <source>Nature</source> (<year>2020</year>) <volume>585</volume>:<page-range>357–62</page-range>. doi: <pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id>
</mixed-citation>
    </ref>
    <ref id="B23">
      <label>23</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McInnes</surname><given-names>L</given-names></name><name><surname>Healy</surname><given-names>J</given-names></name><name><surname>Saul</surname><given-names>N</given-names></name><name><surname>Großberger</surname><given-names>L</given-names></name></person-group>. <article-title>UMAP: uniform manifold approximation and projection</article-title>. <source>J Open Source Softw</source> (<year>2018</year>) <volume>3</volume>:<elocation-id>861</elocation-id>. doi: <pub-id pub-id-type="doi">10.21105/joss.00861</pub-id>
</mixed-citation>
    </ref>
    <ref id="B24">
      <label>24</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maaten van der</surname><given-names>L</given-names></name></person-group>. <article-title>Accelerating t-SNE using tree-based algorithms</article-title>. <source>J Mach Learn Res</source> (<year>2014</year>) <volume>15</volume>:<page-range>3221–45</page-range>.</mixed-citation>
    </ref>
    <ref id="B25">
      <label>25</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Virshup</surname><given-names>I</given-names></name><name><surname>Rybakov</surname><given-names>S</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name><name><surname>Angerer</surname><given-names>P</given-names></name><name><surname>Wolf</surname><given-names>FA</given-names></name></person-group>. <article-title>Anndata: annotated data</article-title>. <source>BioRxiv</source> (<year>2021</year>) <volume>2021</volume>:<fpage>12.16.473007</fpage>. doi: <pub-id pub-id-type="doi">10.1101/2021.12.16.473007</pub-id>
</mixed-citation>
    </ref>
    <ref id="B26">
      <label>26</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Becker</surname><given-names>E</given-names></name><name><surname>Dedden</surname><given-names>M</given-names></name><name><surname>Gall</surname><given-names>C</given-names></name><name><surname>Wiendl</surname><given-names>M</given-names></name><name><surname>Ekici</surname><given-names>AB</given-names></name><name><surname>Schulz-Kuhnt</surname><given-names>A</given-names></name><etal/></person-group>. <article-title>Residual homing of α4β7-expressing β1+PI16+ regulatory T cells with potent suppressive activity correlates with exposure-efficacy of vedolizumab</article-title>. <source>Gut</source> (<year>2022</year>) <volume>71</volume>:<page-range>1551–66</page-range>. doi: <pub-id pub-id-type="doi">10.1136/gutjnl-2021-324868</pub-id>
</mixed-citation>
    </ref>
    <ref id="B27">
      <label>27</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Dijk</surname><given-names>D</given-names></name><name><surname>Sharma</surname><given-names>R</given-names></name><name><surname>Nainys</surname><given-names>J</given-names></name><name><surname>Yim</surname><given-names>K</given-names></name><name><surname>Kathail</surname><given-names>P</given-names></name><name><surname>Carr</surname><given-names>AJ</given-names></name><etal/></person-group>. <article-title>Recovering gene interactions from single-cell data using data diffusion</article-title>. <source>Cell</source> (<year>2018</year>) <volume>174</volume>:<fpage>716</fpage>–<lpage>729.e27</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.cell.2018.05.061</pub-id>
<pub-id pub-id-type="pmid">29961576</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <label>28</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sturm</surname><given-names>G</given-names></name><name><surname>Szabo</surname><given-names>T</given-names></name><name><surname>Fotakis</surname><given-names>G</given-names></name><name><surname>Haider</surname><given-names>M</given-names></name><name><surname>Rieder</surname><given-names>D</given-names></name><name><surname>Trajanoski</surname><given-names>Z</given-names></name><etal/></person-group>. <article-title>Scirpy: a scanpy extension for analyzing single-cell T-cell receptor-sequencing data</article-title>. <source>Bioinformatics</source> (<year>2020</year>) <volume>36</volume>:<page-range>4817–8</page-range>. doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa611</pub-id>
</mixed-citation>
    </ref>
    <ref id="B29">
      <label>29</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Park</surname><given-names>CO</given-names></name><name><surname>Kupper</surname><given-names>TS</given-names></name></person-group>. <article-title>The emerging role of resident memory T cells in protective immunity and inflammatory disease</article-title>. <source>Nat Med</source> (<year>2015</year>) <volume>21</volume>:<page-range>688–97</page-range>. doi: <pub-id pub-id-type="doi">10.1038/nm.3883</pub-id>
</mixed-citation>
    </ref>
    <ref id="B30">
      <label>30</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neurath</surname><given-names>MF</given-names></name><name><surname>Weigmann</surname><given-names>B</given-names></name><name><surname>Finotto</surname><given-names>S</given-names></name><name><surname>Glickman</surname><given-names>J</given-names></name><name><surname>Nieuwenhuis</surname><given-names>E</given-names></name><name><surname>Iijima</surname><given-names>H</given-names></name><etal/></person-group>. <article-title>The transcription factor T-bet regulates mucosal T cell activation in experimental colitis and crohn’s disease</article-title>. <source>J Exp Med</source> (<year>2002</year>) <volume>195</volume>:<page-range>1129–43</page-range>. doi: <pub-id pub-id-type="doi">10.1084/jem.20011956</pub-id>
</mixed-citation>
    </ref>
    <ref id="B31">
      <label>31</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leppkes</surname><given-names>M</given-names></name><name><surname>Becker</surname><given-names>C</given-names></name><name><surname>Ivanov</surname><given-names>II</given-names></name><name><surname>Hirth</surname><given-names>S</given-names></name><name><surname>Wirtz</surname><given-names>S</given-names></name><name><surname>Neufert</surname><given-names>C</given-names></name><etal/></person-group>. <article-title>RORgamma-expressing Th17 cells induce murine chronic intestinal inflammation <italic>via</italic> redundant effects of IL-17A and IL-17F</article-title>. <source>Gastroenterology</source> (<year>2009</year>) <volume>136</volume>:<page-range>257–67</page-range>. doi: <pub-id pub-id-type="doi">10.1053/j.gastro.2008.10.018</pub-id>
</mixed-citation>
    </ref>
    <ref id="B32">
      <label>32</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Annunziato</surname><given-names>F</given-names></name><name><surname>Cosmi</surname><given-names>L</given-names></name><name><surname>Santarlasci</surname><given-names>V</given-names></name><name><surname>Maggi</surname><given-names>L</given-names></name><name><surname>Liotta</surname><given-names>F</given-names></name><name><surname>Mazzinghi</surname><given-names>B</given-names></name><etal/></person-group>. <article-title>Phenotypic and functional features of human Th17 cells</article-title>. <source>J Exp Med</source> (<year>2007</year>) <volume>204</volume>:<page-range>1849–61</page-range>. doi: <pub-id pub-id-type="doi">10.1084/jem.20070663</pub-id>
</mixed-citation>
    </ref>
    <ref id="B33">
      <label>33</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gosselin</surname><given-names>A</given-names></name><name><surname>Monteiro</surname><given-names>P</given-names></name><name><surname>Chomont</surname><given-names>N</given-names></name><name><surname>Diaz-Griffero</surname><given-names>F</given-names></name><name><surname>Said</surname><given-names>EA</given-names></name><name><surname>Fonseca</surname><given-names>S</given-names></name><etal/></person-group>. <article-title>Peripheral blood CCR4+CCR6+ and CXCR3+CCR6+ CD4+ T cells are highly permissive to HIV-1 infection</article-title>. <source>J Immunol</source> (<year>2010</year>) <volume>184</volume>:<page-range>1604–16</page-range>. doi: <pub-id pub-id-type="doi">10.4049/jimmunol.0903058</pub-id>
</mixed-citation>
    </ref>
    <ref id="B34">
      <label>34</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sandborn</surname><given-names>WJ</given-names></name><name><surname>Feagan</surname><given-names>BG</given-names></name><name><surname>Rutgeerts</surname><given-names>P</given-names></name><name><surname>Hanauer</surname><given-names>S</given-names></name><name><surname>Colombel</surname><given-names>J-F</given-names></name><name><surname>Sands</surname><given-names>BE</given-names></name><etal/></person-group>. <article-title>Vedolizumab as induction and maintenance therapy for crohn’s disease</article-title>. <source>N Engl J Med</source> (<year>2013</year>) <volume>369</volume>:<page-range>711–21</page-range>. doi: <pub-id pub-id-type="doi">10.1056/NEJMoa1215739</pub-id>
</mixed-citation>
    </ref>
    <ref id="B35">
      <label>35</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feagan</surname><given-names>BG</given-names></name><name><surname>Rutgeerts</surname><given-names>P</given-names></name><name><surname>Sands</surname><given-names>BE</given-names></name><name><surname>Hanauer</surname><given-names>S</given-names></name><name><surname>Colombel</surname><given-names>J-F</given-names></name><name><surname>Sandborn</surname><given-names>WJ</given-names></name><etal/></person-group>. <article-title>Vedolizumab as induction and maintenance therapy for ulcerative colitis</article-title>. <source>N Engl J Med</source> (<year>2013</year>) <volume>369</volume>:<fpage>699</fpage>–<lpage>710</lpage>. doi: <pub-id pub-id-type="doi">10.1056/NEJMoa1215734</pub-id>
<pub-id pub-id-type="pmid">23964932</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <label>36</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>H</given-names></name><name><surname>Galdos</surname><given-names>FX</given-names></name><name><surname>Lee</surname><given-names>D</given-names></name><name><surname>Waliany</surname><given-names>S</given-names></name><name><surname>Huang</surname><given-names>YV</given-names></name><name><surname>Ryan</surname><given-names>J</given-names></name><etal/></person-group>. <article-title>Identification of pathogenic immune cell subsets associated with checkpoint inhibitor-induced myocarditis</article-title>. <source>Circulation</source> (<year>2022</year>) <volume>146</volume>:<page-range>316–35</page-range>. doi: <pub-id pub-id-type="doi">10.1161/CIRCULATIONAHA.121.056730</pub-id>
</mixed-citation>
    </ref>
    <ref id="B37">
      <label>37</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKinnon</surname><given-names>KM</given-names></name></person-group>. <article-title>Flow cytometry: an overview</article-title>. <source>Curr Protoc Immunol</source> (<year>2018</year>) <volume>120</volume>:<fpage>5.1.1</fpage>–<lpage>5.1.11</lpage>. doi: <pub-id pub-id-type="doi">10.1002/cpim.40</pub-id>
</mixed-citation>
    </ref>
    <ref id="B38">
      <label>38</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adan</surname><given-names>A</given-names></name><name><surname>Alizada</surname><given-names>G</given-names></name><name><surname>Kiraz</surname><given-names>Y</given-names></name><name><surname>Baran</surname><given-names>Y</given-names></name><name><surname>Nalbant</surname><given-names>A</given-names></name></person-group>. <article-title>Flow cytometry: basic principles and applications</article-title>. <source>Crit Rev Biotechnol</source> (<year>2017</year>) <volume>37</volume>:<page-range>163–76</page-range>. doi: <pub-id pub-id-type="doi">10.3109/07388551.2015.1128876</pub-id>
</mixed-citation>
    </ref>
    <ref id="B39">
      <label>39</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>MJ</given-names></name><name><surname>Ntranos</surname><given-names>V</given-names></name><name><surname>Tse</surname><given-names>D</given-names></name></person-group>. <article-title>Determining sequencing depth in a single-cell RNA-seq experiment</article-title>. <source>Nat Commun</source> (<year>2020</year>) <volume>11</volume>:<fpage>774</fpage>. doi: <pub-id pub-id-type="doi">10.1038/s41467-020-14482-y</pub-id>
<pub-id pub-id-type="pmid">32034137</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <label>40</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jagla</surname><given-names>B</given-names></name><name><surname>Libri</surname><given-names>V</given-names></name><name><surname>Chica</surname><given-names>C</given-names></name><name><surname>Rouilly</surname><given-names>V</given-names></name><name><surname>Mella</surname><given-names>S</given-names></name><name><surname>Puceat</surname><given-names>M</given-names></name><etal/></person-group>. <article-title>SCHNAPPs - single cell sHiNy APPlication(s)</article-title>. <source>J Immunol Methods</source> (<year>2021</year>) <volume>499</volume>:<elocation-id>113176</elocation-id>. doi: <pub-id pub-id-type="doi">10.1016/j.jim.2021.113176</pub-id>
<pub-id pub-id-type="pmid">34742775</pub-id></mixed-citation>
    </ref>
    <ref id="B41">
      <label>41</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Traag</surname><given-names>VA</given-names></name><name><surname>Waltman</surname><given-names>L</given-names></name><name><surname>van Eck</surname><given-names>NJ</given-names></name></person-group>. <article-title>From louvain to Leiden: guaranteeing well-connected communities</article-title>. <source>Sci Rep</source> (<year>2019</year>) <volume>9</volume>:<fpage>5233</fpage>. doi: <pub-id pub-id-type="doi">10.1038/s41598-019-41695-z</pub-id>
<pub-id pub-id-type="pmid">30914743</pub-id></mixed-citation>
    </ref>
    <ref id="B42">
      <label>42</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skinnider</surname><given-names>MA</given-names></name><name><surname>Squair</surname><given-names>JW</given-names></name><name><surname>Courtine</surname><given-names>G</given-names></name></person-group>. <article-title>Enabling reproducible re-analysis of single-cell data</article-title>. <source>Genome Biol</source> (<year>2021</year>) <volume>22</volume>:<fpage>215</fpage>. doi: <pub-id pub-id-type="doi">10.1186/s13059-021-02422-y</pub-id>
<pub-id pub-id-type="pmid">34311752</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName nlm2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Immunol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Immunol</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Immunol.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Immunology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1664-3224</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10166880</article-id>
    <article-id pub-id-type="doi">10.3389/fimmu.2023.1027346</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Immunology</subject>
        <subj-group>
          <subject>Original Research</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Manual cell selection in single cell transcriptomics using scSELpy supports the analysis of immune cell subsets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Dedden</surname>
          <given-names>Mark</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1988542"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wiendl</surname>
          <given-names>Maximilian</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1079827"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Müller</surname>
          <given-names>Tanja M.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1080173"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Neurath</surname>
          <given-names>Markus F.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/49358"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zundler</surname>
          <given-names>Sebastian</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="fn001" ref-type="author-notes">
          <sup>*</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/416777"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Department of Medicine 1, University Hospital Erlangen and Friedrich-Alexander-Universität Erlangen-Nürnberg</institution>, <addr-line>Erlangen</addr-line>, <country>Germany</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Deutsches Zentrum Immuntherapie (DZI), University Hospital Erlangen</institution>, <addr-line>Erlangen</addr-line>, <country>Germany</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Edda Russo, University of Florence, Italy</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Joseph CF Ng, University College London, United Kingdom; Carolina Moraes Cabe, Institut Pasteur, France</p>
      </fn>
      <corresp id="fn001">*Correspondence: Sebastian Zundler, <email xlink:href="mailto:sebastian.zundler@uk-erlangen.de">sebastian.zundler@uk-erlangen.de</email>
</corresp>
      <fn fn-type="other" id="fn002">
        <p>This article was submitted to Inflammation, a section of the journal Frontiers in Immunology</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>1027346</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>07</day>
        <month>4</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2023 Dedden, Wiendl, Müller, Neurath and Zundler</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Dedden, Wiendl, Müller, Neurath and Zundler</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Introduction</title>
        <p>Single cell RNA sequencing plays an increasing and indispensable role in immunological research such as in the field of inflammatory bowel diseases (IBD). Professional pipelines are complex, but tools for the manual selection and further downstream analysis of single cell populations are missing so far.</p>
      </sec>
      <sec>
        <title>Methods</title>
        <p>We developed a tool called scSELpy, which can easily be integrated into Scanpy-based pipelines, allowing the manual selection of cells on single cell transcriptomic datasets by drawing polygons on various data representations. The tool further supports the downstream analysis of the selected cells and the plotting of results.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Taking advantage of two previously published single cell RNA sequencing datasets we show that this tool is useful for the positive and negative selection of T cell subsets implicated in IBD beyond standard clustering. We further demonstrate the feasibility for subphenotyping T cell subsets and use scSELpy to corroborate earlier conclusions drawn from the dataset. Moreover, we also show its usefulness in the context of T cell receptor sequencing.</p>
      </sec>
      <sec>
        <title>Discussion</title>
        <p>Collectively, scSELpy is a promising additive tool fulfilling a so far unmet need in the field of single cell transcriptomic analysis that might support future immunological research.</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>single cell RNA sequencing</kwd>
      <kwd>transcriptomics</kwd>
      <kwd>chronic inflammation</kwd>
      <kwd>inflammatory bowel disease</kwd>
      <kwd>gut homing</kwd>
    </kwd-group>
    <funding-group>
      <funding-statement>This work was supported by the German Research Foundation (DFG, ZU377/4-1), the Else Kröner-Fresenius-Stiftung (2021_EKCS.23) and a DAAD scholarship to MD.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="3"/>
      <equation-count count="2"/>
      <ref-count count="42"/>
      <page-count count="13"/>
      <word-count count="5634"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>Introduction</title>
    <p>Progress in life sciences has led to deep insights into physiological and pathological processes in recent years. However, in turn, this also resulted in more and more sophisticated problems to be further addressed. In particular, this concerns the inconceivable complexity of immunological processes that research has discovered and now tries to understand in even greater detail.</p>
    <p>One example are immune-mediated inflammatory disorders (IMIDs) (<xref rid="B1" ref-type="bibr">1</xref>) such as the inflammatory bowel diseases (IBD) ulcerative colitis (UC) and Crohn’s disease (CD) characterized by relapsing-remitting chronic inflammation of the gastrointestinal tract (<xref rid="B2" ref-type="bibr">2</xref>, <xref rid="B3" ref-type="bibr">3</xref>). While an important role of the immune system in the pathogenesis of IBD had early been demonstrated (<xref rid="B4" ref-type="bibr">4</xref>), further ground-breaking insights in fields such as genetics (<xref rid="B5" ref-type="bibr">5</xref>) have shaped the current picture of multifactorial diseases driven by antigen translocation from a dysbiotic luminal microenvironment over a leaky epithelial barrier into the lamina propria of a genetically susceptible individual (<xref rid="B6" ref-type="bibr">6</xref>). Here, dysregulated immune responses are evoked and cause inflammation resulting in tissue destruction and a vicious cycle of further host-environment miscommunication (<xref rid="B7" ref-type="bibr">7</xref>). This also triggers the recruitment of immune cells such as T lymphocytes from the peripheral blood to the intestinal tissue, a process called gut homing that is specifically regulated in the gut and involves molecules such as the chemokine receptor CX3CR1 or the integrin α4β7 (<xref rid="B8" ref-type="bibr">8</xref>). This also contributes to the expansion of diverse pro-inflammatory effector and effector memory T cell subsets in the inflamed gut including T helper 1 (TH1) and T helper 17 (TH17) cells (<xref rid="B9" ref-type="bibr">9</xref>), while regulatory T cells cannot sufficiently suppress these disease-driving cells (<xref rid="B10" ref-type="bibr">10</xref>).</p>
    <p>Technological advances and also the introduction of novel therapeutic approaches (<xref rid="B11" ref-type="bibr">11</xref>–<xref rid="B13" ref-type="bibr">13</xref>) into the clinics have led to unprecedented insights into the regulation of aberrant immune responses in chronic inflammation in general and IBD in particular. In this context, the single cell RNA-sequencing (scRNA-seq) technology has become a popular and indispensable technique for interrogating the transcriptome on single cell level and for resolving the heterogeneity of various subsets of adaptive and innate immune cells involved in inflammatory networks in chronic inflammation (<xref rid="B14" ref-type="bibr">14</xref>). Consistently, while the first single cell being sequenced was reported in 2009 (<xref rid="B15" ref-type="bibr">15</xref>), more than 4000 Pubmed-indexed articles published in 2021 mention single-cell sequencing.</p>
    <p>To aid in the interpretation of these big data, many tools have been written over the past years to support scRNA-seq analyses (<xref rid="B16" ref-type="bibr">16</xref>). Two programs are the backbone for most of these analyses: the Python library Scanpy (<xref rid="B17" ref-type="bibr">17</xref>) and the R package Seurat (<xref rid="B18" ref-type="bibr">18</xref>). To detect communities of cells with similar features, unsupervised clustering according to the Leiden or Louvain algorithms can easily be integrated into Scanpy- or Seurat-based pipelines. However, these approaches may sometimes be limited or time-consuming, when the goal is to analyze a specific subset of cells that does not directly match to the clusters identified.</p>
    <p>We hypothesized that in these situations, manual selection of cells on any two-dimensional representation of single cell sequencing data might be a helpful additive tool for exploring the dataset. Although there are already some interactive single cell analysis tools, which are very user-friendly and allow to manually select cells by polygons without the need for much bioinformatics knowledge (<xref rid="B19" ref-type="bibr">19</xref>, <xref rid="B20" ref-type="bibr">20</xref>), these applications are limited, when it comes to integrating other tools, changing analysis parameters or performing sophisticated downstream analyses. On the other hand, despite a huge variety of solutions for these advanced issues in Scanpy, there is currently no easy way to integrate manual cell selection by polygons in Scanpy-based pipelines. Collectively, there is an unmet need for a tool facilitating not only manual cell selection on single cell data, but also supporting downstream characterization and analyses of the selected population, e.g. in terms of (differential) gene expression, in Scanpy.</p>
    <p>Thus, we aimed to close this gap and to simplify the analysis of immune cell subsets in scRNA-seq analyses in the context of chronic inflammation. To offer Scanpy users the ability to annotate their cells of interest by means of manual selection, we developed scSELpy (single cell SELection python). In addition to selecting cells of interest by drawing polygons around them, it supports further downstream analysis and the generation of publication-ready plots. Our data show that our tool is useful to analyze immune cell heterogeneity in IBD in scRNA-seq beyond conventional clustering and might therefore become an important application for future single cell transcriptomic analyses.</p>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials and methods</title>
    <sec id="s2_1">
      <title>scSELpy</title>
      <p>scSELpy was developed as a Scanpy extension and solely uses libraries required by Scanpy such as matlibplot (<xref rid="B21" ref-type="bibr">21</xref>) and numpy (<xref rid="B22" ref-type="bibr">22</xref>) (<xref rid="T1" ref-type="table"><bold>Table 1</bold></xref>). It allows the scSELpy user to select cells by drawing polygons on top of scatter plots or on either of the following dimension-reduced representations: UMAP (<xref rid="B23" ref-type="bibr">23</xref>), TSNE (<xref rid="B24" ref-type="bibr">24</xref>), PCA or other Scanpy-supported embeddings, limited to 2 dimensions. The selected cells will be annotated according to the names given to the drawn polygons that they are located within, separated by comma. Subsequently, this cell annotation will be stored as observations in the Anndata object (<xref rid="B25" ref-type="bibr">25</xref>). The coordinates of the polygon itself will be stored as unstructured data. Polygons are denominated as integers by default, converted to string. A scSELpy function allows the user to easily convert the default names saved in the annotations to custom names.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Version list.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th valign="top" align="left" rowspan="1" colspan="1">Name</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Language</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Version</th>
              <th valign="top" align="center" rowspan="1" colspan="1">scSELpy import</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">scselpy</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.0.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">–</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">scanpy</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.7.2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">numpy</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.21.1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">matplotlib</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.11.6</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">pandas</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.2.4</td>
              <td valign="top" align="center" rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">scipy</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.6.2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">jupyter</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">6.4.12</td>
              <td valign="top" align="center" rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">rpy2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3.4.5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">scirpy</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.11.2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">magic-impute</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3.0.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">sklearn</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Python</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.0.2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">scran</td>
              <td valign="top" align="center" rowspan="1" colspan="1">R</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.14.6</td>
              <td valign="top" align="center" rowspan="1" colspan="1">No</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>The invocation function of scSELpy mimics Scanpy’s plotting function to make it easy for the user to switch between using Scanpy and scSELpy. The scSELpy tool accepts all Scanpy parameters, except for the “Layer” parameter and offers additional parameters for fine tuning and re-plotting of polygons.</p>
      <p>Upon invocation of scSELpy, it will determine if the user is running Python in a shell or in a notebook environment. For scSELpy to work on a notebook, it switches to an interactive matplotlib plotting backend. After the cell selection has been conducted, it will switch back to the default matplotlib plotting backend. On a Python shell such as ipython, a backend switch will not be conducted.</p>
      <p>Afterwards, scSELpy will call Scanpy to create a plot of the specified embedding. While the plot is open, matplotlib’s function “ginput” is called, which will catch the coordinates of all mouseclicks on the plot. When the user is finished selecting the coordinates of a single polygon, the coordinates are sent to the plot function of matplotlib.pyplot, in order to draw the polygon on the Scanpy generated plot. After all polygons are drawn, scSELpy will switch back to a static backend if necessary. Subsequently it will call Scanpy and Matplotlib again to generate a final image for output.</p>
      <p>For each polygon the contains_points function of Matplotlib is called, in order to determine which cells are located within which polygon. This function tests if a given cell coordinate of the passed embedding is located within the given polygon. The output are x boolean lists, where x is the amount of drawn polygons. These boolean lists are converted by scSELpy to a single list that contains, which cell is located in which polygon. The list is assigned to an observation in the anndata object, which is updated in place.</p>
      <p>Additionally, scSELpy has a three functions for calculating the i) percentage of cells in each cluster or region, ii) percentage of cells expressing a given gene in each cluster or region, iii) transcripts per million (TPM) of a given gene in each cluster or region (<xref rid="T2" ref-type="table"><bold>Table 2</bold></xref>). These functions can be used on any observation of the Anndata object and is therefore not exclusive to scSELpy generated regions.</p>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Supported read-outs for manual cell selections with scSELpy – example from <xref rid="f2" ref-type="fig"><bold>Figure 2B</bold></xref>.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th valign="top" align="left" rowspan="1" colspan="1"/>
              <th valign="top" align="center" rowspan="1" colspan="1">Percentage of cells</th>
              <th valign="top" colspan="2" align="center" rowspan="1">Percentage of cells expressing</th>
              <th valign="top" colspan="2" align="center" rowspan="1">TPM of</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <italic>CCR7</italic>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <italic>SELL</italic>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <italic>CCR7</italic>
              </td>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <italic>SELL</italic>
              </td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Selection</td>
              <td valign="top" align="center" rowspan="1" colspan="1">62.57</td>
              <td valign="top" align="center" rowspan="1" colspan="1">61.21</td>
              <td valign="top" align="center" rowspan="1" colspan="1">57.77</td>
              <td valign="top" align="center" rowspan="1" colspan="1">267.51</td>
              <td valign="top" align="center" rowspan="1" colspan="1">284.72</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">Other cells</td>
              <td valign="top" align="center" rowspan="1" colspan="1">37.43</td>
              <td valign="top" align="center" rowspan="1" colspan="1">19.38</td>
              <td valign="top" align="center" rowspan="1" colspan="1">25.19</td>
              <td valign="top" align="center" rowspan="1" colspan="1">61.81</td>
              <td valign="top" align="center" rowspan="1" colspan="1">107.08</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="s2_2">
      <title>Data analysis</title>
      <p>We analyzed two scRNA-seq datasets in this manuscript, which have been previously published under GSE162624 (<xref rid="B26" ref-type="bibr">26</xref>) and GSM6346300. The data were preprocessed and normalized in the same way as in the original study of GSE162624. The entire analysis was conducted on Jupyter notebook v6.4.12. Cells were selected and annotated using scSELpy. All plots were generated using Matplotlib, Scanpy and scSELpy. All data imputations were conducted by MAGIC (<xref rid="B27" ref-type="bibr">27</xref>). T cell receptor analyses were performed with Scirpy (<xref rid="B28" ref-type="bibr">28</xref>).</p>
    </sec>
    <sec id="s2_3">
      <title>Gene enrichment calculation</title>
      <p>Assuming that one Unique Molecular Identifier (UMI) represents one detected mRNA transcript, the transcripts per million (TPM) for a given gene were calculated by dividing all UMIs of this gene in a specific population by all UMIs in the same population, multiplied by one million.</p>
      <disp-formula>
        <mml:math id="M1" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi>T</mml:mi>
            <mml:mi>P</mml:mi>
            <mml:mi>M</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mtext>UMI count for given gene</mml:mtext>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext>Total UMI count</mml:mtext>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
            <mml:mo>*</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mn>10</mml:mn>
              </mml:mrow>
              <mml:mn>6</mml:mn>
            </mml:msup>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>The enrichment for a given gene was calculated by dividing the TPM of a gene within a specific population by the TPM withing all cells outside that population.</p>
      <disp-formula>
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi>E</mml:mi>
            <mml:mi>n</mml:mi>
            <mml:mi>r</mml:mi>
            <mml:mi>i</mml:mi>
            <mml:mi>c</mml:mi>
            <mml:mi>h</mml:mi>
            <mml:mi>m</mml:mi>
            <mml:mi>e</mml:mi>
            <mml:mi>n</mml:mi>
            <mml:mi>t</mml:mi>
            <mml:mo>=</mml:mo>
            <mml:mfrac>
              <mml:mrow>
                <mml:mtext>TPM of all cells in specific population</mml:mtext>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext>TPM of all other cells outside of the population</mml:mtext>
              </mml:mrow>
            </mml:mfrac>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </sec>
    <sec id="s2_4">
      <title>Gaussian mixture model</title>
      <p>Cells were divided into groups using a gaussian mixture model with k-means as initializer based on the normalized mRNA-derived UMI count of two marker genes. This was done in Python with sklearn, using the GaussianMixture function from sklearn.mixture and the Kmeans function from sklearn.cluster.</p>
    </sec>
    <sec id="s2_5">
      <title>Availabilty of scSELpy</title>
      <p>scSELpy is available for download at <ext-link xlink:href="https://github.com/MarkDedden/scSELpy" ext-link-type="uri">https://github.com/MarkDedden/scSELpy</ext-link> together with installation instructions, the data analysis pipeline and a link to the documentation, which includes a tutorial.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="s3">
    <title>Results</title>
    <sec id="s3_1">
      <title>Single cell selection in Python</title>
      <p>To overcome the problem that standard scRNA-seq analysis pipelines, for example based on Scanpy, do not include tools to support manual cell selection from scatter or dimension reduction plots for further downstream analysis, we developed scSELpy as detailed in the Methods section.</p>
    </sec>
    <sec id="s3_2">
      <title>Positive selection with scSELpy</title>
      <p>To explore and to demonstrate the functionality of scSELpy, we reanalyzed data (GSE162624) from a previous study (<xref rid="B26" ref-type="bibr">26</xref>), where CD3<sup>+</sup>CD4<sup>+</sup>CD45RO<sup>+</sup>α4<sup>+</sup>β7<sup>+</sup> gut-homing memory T cells from the peripheral human blood were purified by fluorescence-activated cell sorting (FACS) and submitted to single cell transcriptomics.</p>
      <p>Based on a UMAP expression plot for <italic>CX3CR1</italic> generated by Scanpy, we selected a region high in cells expressing <italic>CX3CR1</italic> (<xref rid="f1" ref-type="fig"><bold>Figures 1A–D</bold></xref>). Indeed, a more than 90-fold increase in <italic>CX3CR1</italic> TPM were detected in the selected cells compared to the non-selected cells (<xref rid="f1" ref-type="fig"><bold>Figure 1E</bold></xref>, <xref rid="T3" ref-type="table"><bold>Table 3</bold></xref>). Importantly, the region high in <italic>CX3CR1</italic> selected by the polygon gate was different from the clusters generated by the Leiden community detection algorithm with a resolution of 0.5 (<xref rid="f1" ref-type="fig"><bold>Figure 1F</bold></xref>) and the enrichment of <italic>CX3CR1</italic> transcripts in the manual selection compared with non-selected cells was higher than when comparing Leiden clusters with high vs. low <italic>CX3CR1</italic> expression (<xref rid="f1" ref-type="fig"><bold>Figure 1G</bold></xref>), where the enrichment was only below 40-fold increase in <italic>CX3CR1</italic> TPM. To investigate if further unsupervised subclustering would lead to an enrichment comparable to manual selection, we subclustered cluster 6 (<xref rid="f1" ref-type="fig"><bold>Figure 1H</bold></xref>) and calculated the enrichment for each subcluster. Even when combining the three subclusters (6,0, 6,2, 6,4) with the highest enrichment, we obtained only a 50.74-fold increase in <italic>CX3CR1</italic> TPM. Collectively, these data suggested that in specific scenarios, polygon gates drawn with scSELpy result in more specific positive selection of cell populations enriched for a certain gene than conventional clustering.</p>
      <fig position="float" id="f1">
        <label>Figure 1</label>
        <caption>
          <p>Positive selection of cell subsets on a Scanpy-generated UMAP plot with the scSELpy tool. <bold>(A)</bold> UMAP expression plot of <italic>CX3CR1</italic>. Regions with high <italic>CX3CR1</italic> expression were manually selected using scSELpy. <bold>(B–D)</bold> The cells located in the selected region can be highlighted <bold>(B)</bold>, removed <bold>(C)</bold>, or isolated <bold>(D)</bold> in downstream analysis. <bold>(E)</bold> Barplot with <italic>CX3CR1</italic> transcripts per million transcripts (TPM) for the selected cells versus all other cells. <bold>(F)</bold> Leiden clustering of the dataset with a resolution of 0.5. <bold>(G)</bold> Barplot with <italic>CX3CR1</italic> TPM for cluster 6 and all the other clusters together.<bold>(H)</bold> Subclustering of the leiden cluster 6 from <bold>(E)</bold>.</p>
        </caption>
        <graphic xlink:href="fimmu-14-1027346-g001" position="float"/>
      </fig>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>Enrichment of <italic>CX3CR1</italic>.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th valign="top" align="left" rowspan="1" colspan="1">Cluster</th>
              <th valign="top" align="center" rowspan="1" colspan="1">Enrichment [fold]</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">6</td>
              <td valign="top" align="center" rowspan="1" colspan="1">38.3</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">6,0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">45.3</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">6,1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.2</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">6,2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">13.7</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">6,3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">4.3</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">6,4</td>
              <td valign="top" align="center" rowspan="1" colspan="1">16.6</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">6,0 + 6,2 + 6,4</td>
              <td valign="top" align="center" rowspan="1" colspan="1">50.7</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">scSELpy selection</td>
              <td valign="top" align="center" rowspan="1" colspan="1">91.1</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="s3_3">
      <title>Negative selection with scSELpy</title>
      <p>In a next step, we aimed to show that our application is also useful for the negative selection of cells of interest. Specifically, we sought to analyze T cell subsets relevant in the inflamed mucosa in IBD. Thus, since the dataset comprised peripheral blood memory T cells expressing the gut-homing marker α4β7, we aimed to identify T cells homing to the lamina propria by excluding central memory T (TCM) cells, which home to the gut-associated lymphoid tissue (<xref rid="B29" ref-type="bibr">29</xref>). To this end, we used polygon gates to mark regions high in expression of the TCM markers <italic>CCR7</italic> and <italic>SELL</italic> (CD62L) on UMAP plots (<xref rid="f2" ref-type="fig"><bold>Figure 2A</bold></xref>). The overlay of regions, where both genes were expressed in high levels was removed to obtain the cells equipped for access to the inflamed lamina propria (<xref rid="f2" ref-type="fig"><bold>Figure 2B</bold></xref>
<italic>)</italic> as evident by a low prevalence of cells expressing CCR7 and/or SELL and low expression of these genes in the retained region <italic>(</italic>
<xref rid="T2" ref-type="table"><bold>Table 2</bold></xref>). The remaining cells were further re-analyzed from raw data, creating a new UMAP plot (<xref rid="f2" ref-type="fig"><bold>Figure 2C</bold></xref>).</p>
      <fig position="float" id="f2">
        <label>Figure 2</label>
        <caption>
          <p>Selection and removal of central memory T cells from the dataset using scSELpy to obtain effector memory T cells. <bold>(A)</bold> Selection of regions enriched for cells expressing <italic>CCR7</italic> and <italic>SELL</italic> (CD62L, L-Selectin) on UMAP plots. <bold>(B)</bold> Identification and removal of the cells located in both the <italic>CCR7</italic> and <italic>SELL</italic> polygon as selected in A (green). <bold>(C)</bold> Re-analysis of the remaining cells from raw data. Normalization and UMAP dimension reduction is performed anew. <bold>(D)</bold> Scatter plot of all cells from the dataset with normalized <italic>CCR7</italic> and <italic>SELL</italic> expression on the x-axis and y-axis, respectively. On this scatter plot, scSELpy was employed to categorize cells with or without expression of <italic>CCR7</italic> and/or <italic>SELL</italic>. <bold>(E)</bold> UMAP density plots highlighting the cells belonging to the categories created in <bold>(D)</bold>. The parameter “vmin” to control the lower limit in the color scale was set to 0.05.</p>
        </caption>
        <graphic xlink:href="fimmu-14-1027346-g002" position="float"/>
      </fig>
      <p>To confirm that the selected region was also enriched for cells co-expressing <italic>CCR7</italic> and <italic>SELL</italic>, we employed scSELpy on scatter plots to “gate” for cells highly expressing <italic>CCR7</italic> and <italic>SELL</italic> (<italic>CCR7</italic>
<sup>+</sup>
<italic>SELL</italic>
<sup>+</sup>), highly expressing <italic>CCR7</italic> or <italic>SELL</italic> (<italic>CCR7</italic>
<sup>+</sup>
<italic>SELL</italic>
<sup>-</sup>, <italic>CCR7</italic>
<sup>-</sup>
<italic>SELL</italic>
<sup>+</sup>) and expressing <italic>CCR7</italic> and <italic>SELL</italic> at low levels or not at all (<italic>CCR7</italic>
<sup>-</sup>
<italic>SELL</italic>
<sup>-</sup>; <xref rid="f2" ref-type="fig"><bold>Figure 2D</bold></xref>). Subsequently, we depicted the presence of the cells from these four categories in density plots (<xref rid="f2" ref-type="fig"><bold>Figure 2E</bold></xref>). Here, the vast majority of <italic>CCR7</italic>
<sup>+</sup>
<italic>SELL</italic>
<sup>+</sup> cells were located in the removed region, while most of the <italic>CCR7</italic>
<sup>-</sup>
<italic>SELL</italic>
<sup>-</sup> cells plotted to the region that was kept, indicating that our tool had helped to correctly eliminate TCM cells.</p>
      <p>As scRNA-seq suffers from drop-out events, where mRNA-transcripts that are present in a cell might not be detected, we employed data imputation using MAGIC (<xref rid="B27" ref-type="bibr">27</xref>) to verify that the selections made with scSELpy are not excluding cells falsely negative for <italic>CCR7</italic> and/or <italic>SELL</italic>. We overlayed the polygons of <xref rid="f2" ref-type="fig"><bold>Figure 2A</bold></xref> on the imputed data (<xref rid="SF1" ref-type="supplementary-material"><bold>Figure S1A</bold></xref>) and further depicted the imputed data in a scatter plot and density plots (<xref rid="SF1" ref-type="supplementary-material"><bold>Figures S1B, C</bold></xref>). Indeed, the enrichment of <italic>CCR7</italic>
<sup>+</sup>
<italic>SELL</italic>
<sup>+</sup> in the overlap of the polygons was maintained, supporting the notion that manual selections predominantly include false negative cells (which is intended), but do not exclude them to a relevant degree.</p>
    </sec>
    <sec id="s3_4">
      <title>scSELpy allows for subphenotyping of T cells</title>
      <p>To confirm that the cells remaining after negative selection (<xref rid="f2" ref-type="fig"><bold>Figure 2C</bold></xref>) included tissue-homing TEM cells relevant in IBD and to characterize them, we explored the expression of <italic>TBX21</italic> and <italic>RORC</italic> as key transcription factors for TH1 and TH17 cells, respectively (<xref rid="B30" ref-type="bibr">30</xref>, <xref rid="B31" ref-type="bibr">31</xref>). <italic>TBX21</italic> and <italic>RORC</italic> were expressed in overlapping regions that were manually selected by polygons (<xref rid="f3" ref-type="fig"><bold>Figure 3A</bold></xref>) resulting in the four populations of <italic>TBX21<sup>-</sup>RORC</italic>
<sup>-</sup>, <italic>TBX21<sup>+</sup>RORC<sup>-</sup>
</italic>, <italic>TBX21<sup>-</sup>RORC<sup>+</sup>
</italic> and <italic>TBX21<sup>+</sup>RORC<sup>+</sup>
</italic> cells (<xref rid="f3" ref-type="fig"><bold>Figure 3B</bold></xref>). Interestingly, this matched well to Leiden clustering at a resolution of 0.5 (<xref rid="f3" ref-type="fig"><bold>Figure 3C</bold></xref>). Again, data imputation with MAGIC retrospectively supported the chosen manual selection (<xref rid="SF1" ref-type="supplementary-material"><bold>Figure S1D</bold></xref>).</p>
      <fig position="float" id="f3">
        <label>Figure 3</label>
        <caption>
          <p>Identification and analysis of effector memory T cell subsets with scSELpy. <bold>(A)</bold> Selection of regions enriched in cells expressing the T cell transcription factors <italic>TBX21</italic> or <italic>RORC</italic> among effector memory T cells in the cells obtained in <xref rid="f2" ref-type="fig"><bold>Figure 2C</bold></xref>. <bold>(B)</bold> UMAP plot with cells annotated by scSELpy based on the selections made in <bold>(A). (C)</bold> Clustering of the cells based on the leiden algorithm with a resolution of 0.5. <bold>(D)</bold> Barplot showing the <italic>TBX21</italic> and <italic>RORC</italic> transcripts per million transcripts (TPM) for the populations identified in <bold>(B)</bold>. <bold>(E)</bold>
<italic>CXCR3</italic>, <italic>CCR6</italic> and <italic>CCR4</italic> TPM in the indicated regions.</p>
        </caption>
        <graphic xlink:href="fimmu-14-1027346-g003" position="float"/>
      </fig>
      <p>To validate enriched expression of <italic>TBX21</italic> and <italic>RORC</italic> in the selected populations, we calculated the TPM of the two genes. Indeed, mRNA expression of both transcription factors was substantially increased in the selected cell clusters (<xref rid="f3" ref-type="fig"><bold>Figure 3D</bold></xref>). This was consistent with the notion that <italic>TBX21<sup>+</sup>RORC<sup>-</sup>
</italic>, <italic>TBX21<sup>-</sup>RORC<sup>+</sup>
</italic> and <italic>TBX21<sup>+</sup>RORC<sup>+</sup>
</italic> cells corresponded to TH1, TH17 and TH1/17 cells (a subset that has been described in the gut of patients with CD (<xref rid="B32" ref-type="bibr">32</xref>)), respectively. Thus, we further aimed to corroborate successful T helper cell subset identification by our tool and analyzed chemokine receptor expression in these three datasets. As expected based on previous reports (<xref rid="B33" ref-type="bibr">33</xref>), <italic>TBX21<sup>+</sup>RORC<sup>-</sup>
</italic> cells were CXCR3<sup>high</sup>, but <italic>CCR4<sup>low</sup>
</italic> and <italic>CCR6<sup>low</sup>
</italic>, <italic>TBX21<sup>-</sup>RORC<sup>+</sup>
</italic> cells <italic>CCR6<sup>high</sup>
</italic> and <italic>CCR4<sup>high</sup>
</italic>, but <italic>CXCR3</italic>
<sup>low</sup> and <italic>TBX21<sup>+</sup>RORC<sup>+</sup>
</italic> cells were <italic>CXCR3<sup>high</sup>
</italic> and <italic>CCR6<sup>high</sup>
</italic>, but <italic>CCR4<sup>low</sup>
</italic> (<xref rid="f3" ref-type="fig"><bold>Figure 3E</bold></xref>).</p>
      <p>Moreover, to further compare the capability of scSELpy to select cells enriched for a certain gene with another technique that is independent of spatially represented clusters or regions, we applied a Gaussian mixture model clustering with K-means as initializer for <italic>TBX21</italic> and <italic>RORC</italic> on the cells obtained in <xref rid="f2" ref-type="fig"><bold>Figure 2C</bold></xref>. However, in this case, the algorithm was not able to identify a specific regions enriched for <italic>TBX21</italic> and/or <italic>RORC</italic> (<xref rid="SF2" ref-type="supplementary-material"><bold>Figure S2A</bold></xref>), strongly contradicting the impression supported by Leiden clustering and scSELpy selection that T helper cell populations cluster in defined regions. Thus, this scenario identified another situation, where scSELpy was better suited than established alternative solutions.</p>
      <p>Collectively, these data showed that our tool had indeed identified TEM cells and was also able to further sub-cluster well-defined T helper cell subsets, which are relevant in IBD.</p>
    </sec>
    <sec id="s3_5">
      <title>scSELpy analysis confirms the phenotype of vedolizumab-resistant regulatory T cells</title>
      <p>In a next step, we wanted to find out, what kind of cells were represented in the <italic>TBX21<sup>-</sup>RORC<sup>-</sup>
</italic> cluster. Since, regulatory T (Treg) cells are another important gut-homing T cell population and play an important role in the resolution of intestinal inflammation (<xref rid="B8" ref-type="bibr">8</xref>, <xref rid="B10" ref-type="bibr">10</xref>), we explored the expression of the key Treg transcription factor <italic>FOXP3</italic>. Not very surprising, we detected markedly enriched <italic>FOXP3</italic> expression and manually selected the subset for downstream analysis (<xref rid="f4" ref-type="fig"><bold>Figure 4A</bold></xref>). In further support of the Treg nature of these cells, several other Treg-associated molecules were expressed to significantly higher levels than in the other T cell subsets (<xref rid="f4" ref-type="fig"><bold>Figure 4B</bold></xref>).</p>
      <fig position="float" id="f4">
        <label>Figure 4</label>
        <caption>
          <p>Selection and analysis of regulatory T cells with scSELpy. <bold>(A)</bold> Selection of the region enriched for <italic>FOXP3</italic> expression, using the UMAP representation presented in <xref rid="f2" ref-type="fig"><bold>Figure 2C</bold></xref>. The selections for <italic>RORC</italic> and <italic>TBX21</italic> from <xref rid="f3" ref-type="fig"><bold>Figure 3A</bold></xref> are marked with dotted lines. <bold>(B)</bold> Violin plots of the expression of eight genes associated with Tregs in the four regions determined based on <italic>TBX21</italic> and <italic>RORC</italic> expression. <bold>(C)</bold> Depiction of cells binding vedolizumab or not as determined by FACS sorting prior to sequencing on the population selected in <bold>(A)</bold>. <bold>(D)</bold> Expression of <italic>ITGB1</italic> and <italic>PI16</italic> in the cell population selected in <bold>(A)</bold>. <bold>(E)</bold> Stacked violin plot of <italic>PI16</italic> and <italic>ITGB1</italic> expression for Vedolizumab-binding cells and cells that do not bind Vedolizumab.</p>
        </caption>
        <graphic xlink:href="fimmu-14-1027346-g004" position="float"/>
      </fig>
      <p>Since the dataset consisted of sorted cells binding or not binding the anti-α4β7 integrin antibody vedolizumab, which is used for clinical therapy of IBD (<xref rid="B34" ref-type="bibr">34</xref>, <xref rid="B35" ref-type="bibr">35</xref>), and we had previously shown in that dataset that a subset of Tregs is enriched for vedolizumab-resistant cells (<xref rid="B26" ref-type="bibr">26</xref>), we now explored whether scSELpy-based analysis comes to the same conclusion. Thus, we depicted vedolizumab binding cells and vedolizumab non-binding cells in our Treg population. Consistent with our previous analysis, a majority of Tregs did not bind vedolizumab (<xref rid="f4" ref-type="fig"><bold>Figure 4C</bold></xref>). Moreover, <italic>ITGB1</italic> and <italic>PI16</italic>, two genes that had been found to mark those vedolizumab-resistant Tregs were clearly enriched in the Treg fraction that did not bind vedolizumab (<xref rid="f4" ref-type="fig"><bold>Figure 4D, E</bold></xref>). Taken together, these data showed that scSELpy is able to reproduce earlier findings and is, thus, a valid tool for advanced analyses of single cell transcriptomics in general and in the context of IBD in particular.</p>
    </sec>
    <sec id="s3_6">
      <title>scSELpy helps analyzing protein expression and TCR sequencing data</title>
      <p>To demonstrate that scSELpy is able to analyze protein expression identified by antibody-oligo capture, we analyzed the dataset GSM6346300 with scSELpy (<xref rid="B36" ref-type="bibr">36</xref>). In that dataset, PBMCs from four patients were isolated from the blood and sequenced on a 10x Chromium controller. This included V(D)J single-cell T cell receptor (TCR) sequencing and Feature Barcoding to capture the protein expression of CD4, CD8 and CD45RA. We loaded the TCR data using Scirpy, merged it with the scRNA-seq dataset and removed all cells that had no TCR detected using the “has_ir” observation created by Scirpy. We proceeded under the assumption that the remaining subset consists of only T cells. We used Leiden clustering with a resolution of 0.5 to assign clusters on a two dimensional UMAP plot (<xref rid="f5" ref-type="fig"><bold>Figure 5A</bold></xref>).</p>
      <fig position="float" id="f5">
        <label>Figure 5</label>
        <caption>
          <p>Applying scSELpy on T cell receptor (TCR) sequencing and antibody capture data. The single cell RNA sequencing data of PBMCs in blood from patients treated with Immune checkpoint inhibitors was retrieved from GSM6346300. Only cells, for which a TCR is detected are used in these plots. <bold>(A)</bold> UMAP plot of the cells; clusters are defined by leiden with a resolution of 0.5. <bold>(B)</bold> Scatter plot with the detected CD4 and CD8 antibody UMIs on the x-axis and y-axis, respectively. Gates set with scSELpy split the data up into CD4<sup>+</sup>CD8<sup>+</sup> double positive cells, single positive CD4<sup>+</sup>CD8<sup>-</sup> cells, single positive CD4<sup>-</sup>CD8<sup>+</sup> cells and CD4<sup>-</sup>CD8<sup>-</sup> double negative cells. The <italic>CD3D</italic> mRNA derived UMI count is highlighted in red. <bold>(C)</bold> Visualization of the four groups defined in <bold>(A)</bold> on the UMAP plot. A group of cells is selected with scSELpy. <bold>(D)</bold> UMAP representation of T cells selected in <bold>(C)</bold> (magenta) together with all other T cells also expressing one of the TCRs present in the selection (blue). Cells colored in grey do not have a clonotype that matches a T cell in the selected region. <bold>(E)</bold> TCR repertoire of CD4<sup>+</sup>CD8<sup>-</sup> cells plotted against TCR repertoire of CD4<sup>+</sup>CD8<sup>+</sup> cells for each clone ID using Scirpy. Clone IDs that are present in both cell populations were selected using scSELpy. <bold>(F)</bold> Mapping of the cells selected in <bold>(E)</bold> on the scatter plot of CD4 and CD8 antibody UMIs with the gates kept as in <bold>(B)</bold>. <bold>(G)</bold> UMAP representation of the T cells selected in <bold>(E)</bold>.</p>
        </caption>
        <graphic xlink:href="fimmu-14-1027346-g005" position="float"/>
      </fig>
      <p>Using scSELpy, we drew a gate for CD8<sup>+</sup> cells and a gate for CD4<sup>+</sup> cells on a scatter plot of raw CD8 and CD4 antibody interaction-derived UMI counts with a logaritmic axis (<xref rid="f5" ref-type="fig"><bold>Figure 5B</bold></xref>). We highlighted the <italic>CD3D</italic> (<xref rid="f5" ref-type="fig"><bold>Figure 5B</bold></xref>), <italic>CD8A</italic>, <italic>CD8B</italic> and <italic>CD4</italic> mRNA-dervied UMI count (<xref rid="SF2" ref-type="supplementary-material"><bold>Figure S2B</bold></xref>) to show that the mRNA expression of <italic>CD8</italic> and <italic>CD4</italic> is enriched in their respective gates. The CD4<sup>+</sup>CD8<sup>-</sup>, CD4<sup>-</sup>CD8<sup>+</sup>, CD4<sup>+</sup>CD8<sup>+</sup> and CD4<sup>-</sup>CD8<sup>-</sup> populations were now mapped back to the initial UMAP plot (<xref rid="f5" ref-type="fig"><bold>Figure 5C</bold></xref>, <xref rid="SF2" ref-type="supplementary-material"><bold>Figure S2C</bold></xref>). Interestingly, in this case, these populations were well aligned with those identified by the gaussian mixture model clustering with K-means as initializer (<xref rid="SF2" ref-type="supplementary-material"><bold>Figure S2D</bold></xref>). To demonstrate that this is a feasible starting point for further downstream analyses and that scSELpy can also assist in understanding TCR sequencing data, we manually selected a region of cluster 5 enriched for CD8<sup>+</sup> T cells with scSELpy (<xref rid="f5" ref-type="fig"><bold>Figure 5C</bold></xref>). Building on the Scanpy-based library for T cell receptor-sequencing data analysis, Scirpy, we now plotted all other cells sharing a clonotype with any of the cells in this area and found that these cells mainly map to the clusters 1, 3, 4 and 8 (<xref rid="f5" ref-type="fig"><bold>Figure 5D</bold></xref>).</p>
      <p>To further demonstrate the potential to use scSELpy for analyzing combined TCR and scRNA sequencing data, we used Scirpy’s repertoire_overlap function to plot the T cell repertoire overlap between the CD4<sup>+</sup>CD8<sup>-</sup> gate and the CD4<sup>+</sup>CD8<sup>+</sup> cells. Using scSELpy on this plot, we selected clonotypes that are present in cells of both gates (<xref rid="f5" ref-type="fig"><bold>Figure 5E</bold></xref>) and plotted them in the CD8 versus CD4 scatterplot (<xref rid="f5" ref-type="fig"><bold>Figure 5F</bold></xref>), keeping the gates as set in <xref rid="f5" ref-type="fig"><bold>Figure 5B</bold></xref>, and in the UMAP plot (<xref rid="f5" ref-type="fig"><bold>Figure 5G</bold></xref>) as potential starting points for further selection and analysis procedures.</p>
      <p>Collectively, these approaches demonstrated that scSELpy can be used as a convenient and flexible tool helping in the exploration and analysis of multi-dimensional single cell sequencing data.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s4">
    <title>Discussion</title>
    <p>Single cell RNA sequencing has revolutionized immunological research and has helped to substantially increase the resolution of immune cell phenotyping (<xref rid="B14" ref-type="bibr">14</xref>). However, this comes at the cost of complex <italic>in silico</italic> analyses to be performed.</p>
    <p>Here, we introduce a new tool called scSELpy designed to enable the manual selection of cells analyzed by single cell transcriptomics in scatter plots or dimension reduction representations to allow further downstream analysis. As such, it is inspired by the “gating” used in multicolor flow cytometry as the most widely used technique to interrogate protein expression on single cell level (<xref rid="B37" ref-type="bibr">37</xref>). In flow cytometry, such gating serves to select certain cell populations in a hierarchical manner and to determine the abundance and phenotype of cell subsets in this way (<xref rid="B38" ref-type="bibr">38</xref>).</p>
    <p>Manual cell selection in scatter plots visualizing the expression of two different genes per cell as offered by scSELpy comes most closely to this function. However, the high number of parameters analyzed by single cell RNA sequencing also imposes the necessity to include dimension reduction techniques to appropriately visualize and analyze relationships between the single cells (<xref rid="B23" ref-type="bibr">23</xref>, <xref rid="B24" ref-type="bibr">24</xref>). Consistently, scSELpy also offers manual cell selection on dimension-reduced UMAP or t-SNE plots. Yet, it needs to be considered that in this case “gating” will not result in the binary selection of cells with and without expression of one or more genes (or high or low expression), but only in the selection of a population enriched in cells expressing those genes. This population will also include closely related cells, in which expression of the gene has not been detected, which might be due to absent expression or expression below the detection threshold of single cell RNA sequencing (<xref rid="B39" ref-type="bibr">39</xref>). Our findings with imputed data further support this notion, since the polygons drawn before data imputation captured the majority of false-negative cells and missed only few of them. Taken together, these aspects emphasize that, while similar in handling, “gating” on scRNA-seq data, is clearly different from flow cytometry gating.</p>
    <p>Importantly, scSELpy also supports the analysis of single cell data including TCR sequencing or sequencing of surface proteins detected by antibody-oligo reaction. Thus, in the specific case of protein expression analysis, scSELpy can actually be used for binary gating of surface expression markers very similar to flow cytometry. With regard to TCR analyses, we show that scSELpy can identify and plot clonotypes in various representations and might thus help to explore their role and function. Again, this is not an exclusive feature of scSELpy, since for instance clonotype overlap in different cell types can also be identified using Scirpy’s clonotype_imbalance function. Thus, it is important to understand scSELpy as a complementary tool that can be used together with other important approaches to reach a deeper understanding of the data.</p>
    <p>Several publicly available applications such as the Loup Browser offered by 10x Genomics, CELLxGENE, the UCSC Cell Browser (<xref rid="B19" ref-type="bibr">19</xref>, <xref rid="B20" ref-type="bibr">20</xref>) or Shiny-based applications for scRNA-seq such as SCHNAPPs (<xref rid="B40" ref-type="bibr">40</xref>) are graphical user interface platforms for single cell analysis, of which the first three mentioned offer similar tools for manual cell selection. However, while those applications are easy to handle also for researchers without training in bioinformatics, a limitation of them is that further downstream analyses are not supported. Thus, scSELpy has been designed for use on the Scanpy platform, one of the standard applications used for the analysis of single cell RNA-seq data (<xref rid="B17" ref-type="bibr">17</xref>) and integrates a workflow to enable easy downstream phenotyping of selected cells such as further sub-clustering, re-plotting or differential expression analysis.</p>
    <p>A standard technique to identify specific cell populations on single cell transcriptomic data is clustering according to the Leiden or Louvain algorithm (<xref rid="B41" ref-type="bibr">41</xref>). Depending on the resolution used, these algorithms dissect the overall cell population into several clusters, which can subsequently be extracted and further analyzed. It is important to mention that scSELpy is not at all meant to replace such clustering-based identification and selection of cell populations, but as an additional tool that might be helpful in certain situations.</p>
    <p>One key difference to scSELpy is that Leiden or Louvain clustering are unsupervised and thus unbiased. In consequence, one might mention that scSELpy unnecessarily introduces bias into single cell RNA sequencing analysis by allowing to select cells based on one or more deliberately chosen genes. While this has to been accepted as a potential limitation and to be kept in mind during analysis, it is also important to note that conventional clustering might not always perfectly capture biological processes that are not dominating the phenotype of cell subsets or are shared between subsets. For example, this might be processes of cell migration such as gut homing. Consistently, our data show that manual cell selection by scSELpy helps to increase the enrichment of specific gene expression in the selected populations. This might be of particular value in a time, where the re-analysis of previously published datasets from a novel perspective is becoming more and more important (<xref rid="B42" ref-type="bibr">42</xref>).</p>
    <p>It is essential to underscore that in many situations (e.g. as documented in <xref rid="f3" ref-type="fig"><bold>Figure 3C</bold></xref> or <xref rid="SF2" ref-type="supplementary-material"><bold>Figure S2D</bold></xref>) there exist conventional alternatives such as Leiden or Louvain clustering or k means clustering that lead to similar results as manual cell selection with scSELpy. Thus, in these situations, the benefits (fast, easy) and the limitations (subjectivity) associated with the use of scSELpy must be carefully weighed. However, as we show (<xref rid="f1" ref-type="fig"><bold>Figure 1E-H</bold></xref>, <xref rid="SF2" ref-type="supplementary-material"><bold>Figure S2A</bold></xref>), there are also scenarios, where scSELpy results in superior selection of enriched populations. Similarly, one can also consider situations, where the use of scSELpy is limited by very rare expression of a gene or equal distribution over the dimensionality-reduced space and alternative ways of cell selection will be more helpful. In consequence, we think that scSELpy is a valuable part of the toolbox in state-of-the-art single cell analysis that should especially be used in situations, where conventional community detection or cell type identification are not possible, sub-optimal or very time-consuming or where the role of a gene regardless of the association to a specific (sub-)community is explored.</p>
    <p>We demonstrate the feasibility of our approach in a dataset characterizing gut-homing memory T cells from the peripheral blood, a cell population that is of particular interest for the pathogenesis of IBD and has become a therapeutic target by blocking its gut homing through the anti-α4β7 integrin antibody vedolizumab (<xref rid="B7" ref-type="bibr">7</xref>). In addition to proving the suitability of scSELpy for appropriate positive and negative selection strategies, we also show that our tool is helpful in supporting the analysis of cell populations such as TH1, TH17 or TH1/17 cells, all of which have been demonstrated to crucially implicated in IBD (<xref rid="B30" ref-type="bibr">30</xref>–<xref rid="B32" ref-type="bibr">32</xref>). Thus, scSELpy might help to obtain further insights into immune cell regulation in IBD and other chronic inflammatory diseases in the future. Moreover, in regulatory T cells our tool was able reproduce the earlier finding that α4β7-expressing regulatory T cells are enriched in cells “resistant” to vedolizumab and that β1 integrin and PI16 are highly expressed in those cells (<xref rid="B26" ref-type="bibr">26</xref>). It might therefore also be employed for future translational studies in the field of IBD aiming at dissecting the mechanisms of state-of-the art treatment options at higher resolution.</p>
    <p>Taken together, to the best of our knowledge, scSELpy is the first tool that can offer Scanpy-based manual cell selection. Based on the data presented, we project that, when used intentionally, it might broadly support and facilitate single cell transcriptomic analyses for many researchers in the field of immunology in general and in IBD in special.</p>
  </sec>
  <sec sec-type="data-availability" id="s5">
    <title>Data availability statement</title>
    <p>The datasets presented in this study can be found in online repositories. The names of the repository/repositories and accession number(s) can be found in the article/<xref rid="s10" ref-type="sec"><bold>Supplementary Material</bold></xref>.</p>
  </sec>
  <sec sec-type="author-contributions" id="s6">
    <title>Author contributions</title>
    <p>MD developed scSELpy and performed the analyses. MD and SZ designed the analyses and interpreted the data together with MW, TM and MN. MD and SZ drafted the manuscript; All authors contributed to the article and approved the submitted version.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>The research of TM, MN and SZ was supported by the Interdisciplinary Center for Clinical Research (IZKF) and the ELAN program of the Universität Erlangen-Nürnberg, the Fritz-Bender-Stiftung, the Ernst Jung-Stiftung, the Else Kröner-Fresenius-Stiftung, the Thyssen-Stiftung, the German Crohn’s and Colitis Foundation (DCCV), the DFG topic program on Microbiota, the Emerging Field Initiative, the DFG Collaborative Research Centers 643, 796, 1181 and TRR241, the Rainin Foundation and the Litwin IBD Pioneers program of the Crohn’s and Colitis Foundation of America (CCFA). We acknowledge financial support by the German Research Foundation (ZU377/4-1) and Friedrich-Alexander-Universität Erlangen-Nürnberg within the funding programme “Open Access Publication Funding”.</p>
  </ack>
  <sec sec-type="COI-statement" id="s8">
    <title>Conflict of interest</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
  <sec sec-type="disclaimer" id="s9">
    <title>Publisher’s note</title>
    <p>All claims expressed in this article are solely those of the authors and do not necessarily represent those of their affiliated organizations, or those of the publisher, the editors and the reviewers. Any product that may be evaluated in this article, or claim that may be made by its manufacturer, is not guaranteed or endorsed by the publisher.</p>
  </sec>
  <sec sec-type="supplementary-material" id="s10">
    <title>Supplementary material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link xlink:href="https://www.frontiersin.org/articles/10.3389/fimmu.2023.1027346/full#supplementary-material" ext-link-type="uri">https://www.frontiersin.org/articles/10.3389/fimmu.2023.1027346/full#supplementary-material</ext-link>
</p>
    <supplementary-material id="SF1" position="float" content-type="local-data">
      <label>Supplementary Figure 1</label>
      <caption>
        <p>Visualization of how the previously set selections in Figures 2, 3 and look with imputed data. <bold>(A)</bold> The same UMAP plot and selection as in Figure 2D, where now the imputed data is visualized. <bold>(B)</bold> Same scatter plot as in Figure 2D, where now the imputed data is used. <bold>(C)</bold> UMAP density plots highlighting the cells belonging to the categories created in <bold>(B)</bold>. The parameter “vmin” to control the lower limit in the color scale was set to 0.05. <bold>(D)</bold> The same UMAP plot and selection as in Figure 3A visualizing the imputed data. The parameter “vmax” to control the upper limit in the color scale was set to 0.12.</p>
      </caption>
      <media xlink:href="Image_1.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="SF2" position="float" content-type="local-data">
      <label>Supplementary Figure 2</label>
      <caption>
        <p><bold>(A)</bold> Guassian mixture model of <italic>RORC</italic> and <italic>TBX21</italic> mRNA-derived UMI count with the data from Figure 3, plotted on the same UMAP plot. <bold>(B)</bold> The same plot as Figure 5A, with the modification that the <italic>CD8A</italic> (left), <italic>CD8</italic>B (middle) and <italic>CD4</italic> (right) mRNA derived UMI count is highlighted as indicated. <bold>(C)</bold> UMAP plot with CD8 (right) and CD4 (left) antibody UMI counts highlighted in red. <bold>(D)</bold> Guassian mixture model of <italic>CD4</italic> and <italic>CD8A</italic> mRNA-derived UMI count with the data from Figure 5B, plotted on the same UMAP plot.</p>
      </caption>
      <media xlink:href="Image_2.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schett</surname><given-names>G</given-names></name><name><surname>McInnes</surname><given-names>IB</given-names></name><name><surname>Neurath</surname><given-names>MF</given-names></name></person-group>. <article-title>Reframing immune-mediated inflammatory diseases through signature cytokine hubs</article-title>. <source>N Engl J Med</source> (<year>2021</year>) <volume>385</volume>:<page-range>628–39</page-range>. doi: <pub-id pub-id-type="doi">10.1056/NEJMra1909094</pub-id>
</mixed-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roda</surname><given-names>G</given-names></name><name><surname>Chien Ng</surname><given-names>S</given-names></name><name><surname>Kotze</surname><given-names>PG</given-names></name><name><surname>Argollo</surname><given-names>M</given-names></name><name><surname>Panaccione</surname><given-names>R</given-names></name><name><surname>Spinelli</surname><given-names>A</given-names></name><etal/></person-group>. <article-title>Crohn’s disease</article-title>. <source>Nat Rev Dis Primer</source> (<year>2020</year>) <volume>6</volume>:<fpage>22</fpage>. doi: <pub-id pub-id-type="doi">10.1038/s41572-020-0156-2</pub-id>
</mixed-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Danese</surname><given-names>S</given-names></name><name><surname>Fiocchi</surname><given-names>C</given-names></name></person-group>. <article-title>Ulcerative colitis</article-title>. <source>N Engl J Med</source> (<year>2011</year>) <volume>365</volume>:<page-range>1713–25</page-range>. doi: <pub-id pub-id-type="doi">10.1056/NEJMra1102942</pub-id>
</mixed-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fuss</surname><given-names>IJ</given-names></name><name><surname>Neurath</surname><given-names>M</given-names></name><name><surname>Boirivant</surname><given-names>M</given-names></name><name><surname>Klein</surname><given-names>JS</given-names></name><name><surname>de la Motte</surname><given-names>C</given-names></name><name><surname>Strong</surname><given-names>SA</given-names></name><etal/></person-group>. <article-title>Disparate CD4+ lamina propria (LP) lymphokine secretion profiles in inflammatory bowel disease. crohn’s disease LP cells manifest increased secretion of IFN-gamma, whereas ulcerative colitis LP cells manifest increased secretion of IL-5</article-title>. <source>J Immunol Baltim Md 1950</source> (<year>1996</year>) <volume>157</volume>:<page-range>1261–70</page-range>.</mixed-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jostins</surname><given-names>L</given-names></name><name><surname>Ripke</surname><given-names>S</given-names></name><name><surname>Weersma</surname><given-names>RK</given-names></name><name><surname>Duerr</surname><given-names>RH</given-names></name><name><surname>McGovern</surname><given-names>DP</given-names></name><name><surname>Hui</surname><given-names>KY</given-names></name><etal/></person-group>. <article-title>Host-microbe interactions have shaped the genetic architecture of inflammatory bowel disease</article-title>. <source>Nature</source> (<year>2012</year>) <volume>491</volume>:<page-range>119–24</page-range>. doi: <pub-id pub-id-type="doi">10.1038/nature11582</pub-id>
</mixed-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>JT</given-names></name></person-group>. <article-title>Pathophysiology of inflammatory bowel diseases</article-title>. <source>N Engl J Med</source> (<year>2020</year>) <volume>383</volume>:<page-range>2652–64</page-range>. doi: <pub-id pub-id-type="doi">10.1056/NEJMra2002697</pub-id>
</mixed-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neurath</surname><given-names>MF</given-names></name></person-group>. <article-title>Targeting immune cell circuits and trafficking in inflammatory bowel disease</article-title>. <source>Nat Immunol</source> (<year>2019</year>) <volume>20</volume>:<page-range>970–9</page-range>. doi: <pub-id pub-id-type="doi">10.1038/s41590-019-0415-0</pub-id>
</mixed-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zundler</surname><given-names>S</given-names></name><name><surname>Becker</surname><given-names>E</given-names></name><name><surname>Schulze</surname><given-names>LL</given-names></name><name><surname>Neurath</surname><given-names>MF</given-names></name></person-group>. <article-title>Immune cell trafficking and retention in inflammatory bowel disease: mechanistic insights and therapeutic advances</article-title>. <source>Gut</source> (<year>2019</year>) <volume>68</volume>:<page-range>1688–700</page-range>. doi: <pub-id pub-id-type="doi">10.1136/gutjnl-2018-317977</pub-id>
</mixed-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neurath</surname><given-names>MF</given-names></name></person-group>. <article-title>Cytokines in inflammatory bowel disease</article-title>. <source>Nat Rev Immunol</source> (<year>2014</year>) <volume>14</volume>:<page-range>329–42</page-range>. doi: <pub-id pub-id-type="doi">10.1038/nri3661</pub-id>
</mixed-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maul</surname><given-names>J</given-names></name><name><surname>Loddenkemper</surname><given-names>C</given-names></name><name><surname>Mundt</surname><given-names>P</given-names></name><name><surname>Berg</surname><given-names>E</given-names></name><name><surname>Giese</surname><given-names>T</given-names></name><name><surname>Stallmach</surname><given-names>A</given-names></name><etal/></person-group>. <article-title>Peripheral and intestinal regulatory CD4+ CD25(high) T cells in inflammatory bowel disease</article-title>. <source>Gastroenterology</source> (<year>2005</year>) <volume>128</volume>:<page-range>1868–78</page-range>. doi: <pub-id pub-id-type="doi">10.1053/j.gastro.2005.03.043</pub-id>
</mixed-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feagan</surname><given-names>BG</given-names></name><name><surname>Sandborn</surname><given-names>WJ</given-names></name><name><surname>Gasink</surname><given-names>C</given-names></name><name><surname>Jacobstein</surname><given-names>D</given-names></name><name><surname>Lang</surname><given-names>Y</given-names></name><name><surname>Friedman</surname><given-names>JR</given-names></name><etal/></person-group>. <article-title>Ustekinumab as induction and maintenance therapy for crohn’s disease</article-title>. <source>N Engl J Med</source> (<year>2016</year>) <volume>375</volume>:<page-range>1946–60</page-range>. doi: <pub-id pub-id-type="doi">10.1056/NEJMoa1602773</pub-id>
</mixed-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sandborn</surname><given-names>WJ</given-names></name><name><surname>Feagan</surname><given-names>BG</given-names></name><name><surname>D’Haens</surname><given-names>G</given-names></name><name><surname>Wolf</surname><given-names>DC</given-names></name><name><surname>Jovanovic</surname><given-names>I</given-names></name><name><surname>Hanauer</surname><given-names>SB</given-names></name><etal/></person-group>. <article-title>Ozanimod as induction and maintenance therapy for ulcerative colitis</article-title>. <source>N Engl J Med</source> (<year>2021</year>) <volume>385</volume>:<page-range>1280–91</page-range>. doi: <pub-id pub-id-type="doi">10.1056/NEJMoa2033617</pub-id>
</mixed-citation>
    </ref>
    <ref id="B13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feagan</surname><given-names>BG</given-names></name><name><surname>Danese</surname><given-names>S</given-names></name><name><surname>Loftus</surname><given-names>EV</given-names></name><name><surname>Vermeire</surname><given-names>S</given-names></name><name><surname>Schreiber</surname><given-names>S</given-names></name><name><surname>Ritter</surname><given-names>T</given-names></name><etal/></person-group>. <article-title>Filgotinib as induction and maintenance therapy for ulcerative colitis (SELECTION): a phase 2b/3 double-blind, randomised, placebo-controlled trial</article-title>. <source>Lancet</source> (<year>2021</year>) <volume>397</volume>:<page-range>2372–84</page-range>. doi: <pub-id pub-id-type="doi">10.1016/S0140-6736(21)00666-8</pub-id>
</mixed-citation>
    </ref>
    <ref id="B14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>X</given-names></name><name><surname>Zhou</surname><given-names>X</given-names></name></person-group>. <article-title>Impact of single-cell RNA sequencing on understanding immune regulation</article-title>. <source>J Cell Mol Med</source> (<year>2022</year>) <volume>26</volume>:<page-range>4645–57</page-range>. doi: <pub-id pub-id-type="doi">10.1111/jcmm.17493</pub-id>
</mixed-citation>
    </ref>
    <ref id="B15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>F</given-names></name><name><surname>Barbacioru</surname><given-names>C</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Nordman</surname><given-names>E</given-names></name><name><surname>Lee</surname><given-names>C</given-names></name><name><surname>Xu</surname><given-names>N</given-names></name><etal/></person-group>. <article-title>mRNA-seq whole-transcriptome analysis of a single cell</article-title>. <source>Nat Methods</source> (<year>2009</year>) <volume>6</volume>:<page-range>377–82</page-range>. doi: <pub-id pub-id-type="doi">10.1038/nmeth.1315</pub-id>
</mixed-citation>
    </ref>
    <ref id="B16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andrews</surname><given-names>TS</given-names></name><name><surname>Kiselev</surname><given-names>VY</given-names></name><name><surname>McCarthy</surname><given-names>D</given-names></name><name><surname>Hemberg</surname><given-names>M</given-names></name></person-group>. <article-title>Tutorial: guidelines for the computational analysis of single-cell RNA sequencing data</article-title>. <source>Nat Protoc</source> (<year>2021</year>) <volume>16</volume>:<fpage>1</fpage>–<lpage>9</lpage>. doi: <pub-id pub-id-type="doi">10.1038/s41596-020-00409-w</pub-id>
<pub-id pub-id-type="pmid">33288955</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>FA</given-names></name><name><surname>Angerer</surname><given-names>P</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group>. <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source> (<year>2018</year>) <volume>19</volume>:<fpage>15</fpage>. doi: <pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id>
<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hao</surname><given-names>Y</given-names></name><name><surname>Hao</surname><given-names>S</given-names></name><name><surname>Andersen-Nissen</surname><given-names>E</given-names></name><name><surname>Mauck</surname><given-names>WM</given-names></name><name><surname>Zheng</surname><given-names>S</given-names></name><name><surname>Butler</surname><given-names>A</given-names></name><etal/></person-group>. <article-title>Integrated analysis of multimodal single-cell data</article-title>. <source>Cell</source> (<year>2021</year>) <volume>184</volume>:<fpage>3573</fpage>–<lpage>3587.e29</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.cell.2021.04.048</pub-id>
<pub-id pub-id-type="pmid">34062119</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Speir</surname><given-names>ML</given-names></name><name><surname>Bhaduri</surname><given-names>A</given-names></name><name><surname>Markov</surname><given-names>NS</given-names></name><name><surname>Moreno</surname><given-names>P</given-names></name><name><surname>Nowakowski</surname><given-names>TJ</given-names></name><name><surname>Papatheodorou</surname><given-names>I</given-names></name><etal/></person-group>. <article-title>UCSC cell browser: visualize your single-cell data</article-title>. <source>Bioinforma Oxf Engl</source> (<year>2021</year>) <volume>37</volume>:<page-range>4578–80</page-range>. doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/btab503</pub-id>
</mixed-citation>
    </ref>
    <ref id="B20">
      <label>20</label>
      <mixed-citation publication-type="webpage"><person-group person-group-type="author"><collab>Cellxgene Data Portal</collab></person-group>. <source>Cellxgene data portal</source>. Available at: <uri xlink:href="https://cellxgene.cziscience.com/">https://cellxgene.cziscience.com/</uri> (Accessed <date-in-citation content-type="access-date">8, 2022</date-in-citation>).</mixed-citation>
    </ref>
    <ref id="B21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hunter</surname><given-names>JD</given-names></name></person-group>. <article-title>Matplotlib: a 2D graphics environment</article-title>. <source>Comput Sci Eng</source> (<year>2007</year>) <volume>9</volume>:<page-range>90–5</page-range>. doi: <pub-id pub-id-type="doi">10.1109/MCSE.2007.55</pub-id>
</mixed-citation>
    </ref>
    <ref id="B22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>CR</given-names></name><name><surname>Millman</surname><given-names>KJ</given-names></name><name><surname>van der Walt</surname><given-names>SJ</given-names></name><name><surname>Gommers</surname><given-names>R</given-names></name><name><surname>Virtanen</surname><given-names>P</given-names></name><name><surname>Cournapeau</surname><given-names>D</given-names></name><etal/></person-group>. <article-title>Array programming with NumPy</article-title>. <source>Nature</source> (<year>2020</year>) <volume>585</volume>:<page-range>357–62</page-range>. doi: <pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id>
</mixed-citation>
    </ref>
    <ref id="B23">
      <label>23</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McInnes</surname><given-names>L</given-names></name><name><surname>Healy</surname><given-names>J</given-names></name><name><surname>Saul</surname><given-names>N</given-names></name><name><surname>Großberger</surname><given-names>L</given-names></name></person-group>. <article-title>UMAP: uniform manifold approximation and projection</article-title>. <source>J Open Source Softw</source> (<year>2018</year>) <volume>3</volume>:<elocation-id>861</elocation-id>. doi: <pub-id pub-id-type="doi">10.21105/joss.00861</pub-id>
</mixed-citation>
    </ref>
    <ref id="B24">
      <label>24</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maaten van der</surname><given-names>L</given-names></name></person-group>. <article-title>Accelerating t-SNE using tree-based algorithms</article-title>. <source>J Mach Learn Res</source> (<year>2014</year>) <volume>15</volume>:<page-range>3221–45</page-range>.</mixed-citation>
    </ref>
    <ref id="B25">
      <label>25</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Virshup</surname><given-names>I</given-names></name><name><surname>Rybakov</surname><given-names>S</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name><name><surname>Angerer</surname><given-names>P</given-names></name><name><surname>Wolf</surname><given-names>FA</given-names></name></person-group>. <article-title>Anndata: annotated data</article-title>. <source>BioRxiv</source> (<year>2021</year>) <volume>2021</volume>:<fpage>12.16.473007</fpage>. doi: <pub-id pub-id-type="doi">10.1101/2021.12.16.473007</pub-id>
</mixed-citation>
    </ref>
    <ref id="B26">
      <label>26</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Becker</surname><given-names>E</given-names></name><name><surname>Dedden</surname><given-names>M</given-names></name><name><surname>Gall</surname><given-names>C</given-names></name><name><surname>Wiendl</surname><given-names>M</given-names></name><name><surname>Ekici</surname><given-names>AB</given-names></name><name><surname>Schulz-Kuhnt</surname><given-names>A</given-names></name><etal/></person-group>. <article-title>Residual homing of α4β7-expressing β1+PI16+ regulatory T cells with potent suppressive activity correlates with exposure-efficacy of vedolizumab</article-title>. <source>Gut</source> (<year>2022</year>) <volume>71</volume>:<page-range>1551–66</page-range>. doi: <pub-id pub-id-type="doi">10.1136/gutjnl-2021-324868</pub-id>
</mixed-citation>
    </ref>
    <ref id="B27">
      <label>27</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Dijk</surname><given-names>D</given-names></name><name><surname>Sharma</surname><given-names>R</given-names></name><name><surname>Nainys</surname><given-names>J</given-names></name><name><surname>Yim</surname><given-names>K</given-names></name><name><surname>Kathail</surname><given-names>P</given-names></name><name><surname>Carr</surname><given-names>AJ</given-names></name><etal/></person-group>. <article-title>Recovering gene interactions from single-cell data using data diffusion</article-title>. <source>Cell</source> (<year>2018</year>) <volume>174</volume>:<fpage>716</fpage>–<lpage>729.e27</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.cell.2018.05.061</pub-id>
<pub-id pub-id-type="pmid">29961576</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <label>28</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sturm</surname><given-names>G</given-names></name><name><surname>Szabo</surname><given-names>T</given-names></name><name><surname>Fotakis</surname><given-names>G</given-names></name><name><surname>Haider</surname><given-names>M</given-names></name><name><surname>Rieder</surname><given-names>D</given-names></name><name><surname>Trajanoski</surname><given-names>Z</given-names></name><etal/></person-group>. <article-title>Scirpy: a scanpy extension for analyzing single-cell T-cell receptor-sequencing data</article-title>. <source>Bioinformatics</source> (<year>2020</year>) <volume>36</volume>:<page-range>4817–8</page-range>. doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa611</pub-id>
</mixed-citation>
    </ref>
    <ref id="B29">
      <label>29</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Park</surname><given-names>CO</given-names></name><name><surname>Kupper</surname><given-names>TS</given-names></name></person-group>. <article-title>The emerging role of resident memory T cells in protective immunity and inflammatory disease</article-title>. <source>Nat Med</source> (<year>2015</year>) <volume>21</volume>:<page-range>688–97</page-range>. doi: <pub-id pub-id-type="doi">10.1038/nm.3883</pub-id>
</mixed-citation>
    </ref>
    <ref id="B30">
      <label>30</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neurath</surname><given-names>MF</given-names></name><name><surname>Weigmann</surname><given-names>B</given-names></name><name><surname>Finotto</surname><given-names>S</given-names></name><name><surname>Glickman</surname><given-names>J</given-names></name><name><surname>Nieuwenhuis</surname><given-names>E</given-names></name><name><surname>Iijima</surname><given-names>H</given-names></name><etal/></person-group>. <article-title>The transcription factor T-bet regulates mucosal T cell activation in experimental colitis and crohn’s disease</article-title>. <source>J Exp Med</source> (<year>2002</year>) <volume>195</volume>:<page-range>1129–43</page-range>. doi: <pub-id pub-id-type="doi">10.1084/jem.20011956</pub-id>
</mixed-citation>
    </ref>
    <ref id="B31">
      <label>31</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leppkes</surname><given-names>M</given-names></name><name><surname>Becker</surname><given-names>C</given-names></name><name><surname>Ivanov</surname><given-names>II</given-names></name><name><surname>Hirth</surname><given-names>S</given-names></name><name><surname>Wirtz</surname><given-names>S</given-names></name><name><surname>Neufert</surname><given-names>C</given-names></name><etal/></person-group>. <article-title>RORgamma-expressing Th17 cells induce murine chronic intestinal inflammation <italic>via</italic> redundant effects of IL-17A and IL-17F</article-title>. <source>Gastroenterology</source> (<year>2009</year>) <volume>136</volume>:<page-range>257–67</page-range>. doi: <pub-id pub-id-type="doi">10.1053/j.gastro.2008.10.018</pub-id>
</mixed-citation>
    </ref>
    <ref id="B32">
      <label>32</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Annunziato</surname><given-names>F</given-names></name><name><surname>Cosmi</surname><given-names>L</given-names></name><name><surname>Santarlasci</surname><given-names>V</given-names></name><name><surname>Maggi</surname><given-names>L</given-names></name><name><surname>Liotta</surname><given-names>F</given-names></name><name><surname>Mazzinghi</surname><given-names>B</given-names></name><etal/></person-group>. <article-title>Phenotypic and functional features of human Th17 cells</article-title>. <source>J Exp Med</source> (<year>2007</year>) <volume>204</volume>:<page-range>1849–61</page-range>. doi: <pub-id pub-id-type="doi">10.1084/jem.20070663</pub-id>
</mixed-citation>
    </ref>
    <ref id="B33">
      <label>33</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gosselin</surname><given-names>A</given-names></name><name><surname>Monteiro</surname><given-names>P</given-names></name><name><surname>Chomont</surname><given-names>N</given-names></name><name><surname>Diaz-Griffero</surname><given-names>F</given-names></name><name><surname>Said</surname><given-names>EA</given-names></name><name><surname>Fonseca</surname><given-names>S</given-names></name><etal/></person-group>. <article-title>Peripheral blood CCR4+CCR6+ and CXCR3+CCR6+ CD4+ T cells are highly permissive to HIV-1 infection</article-title>. <source>J Immunol</source> (<year>2010</year>) <volume>184</volume>:<page-range>1604–16</page-range>. doi: <pub-id pub-id-type="doi">10.4049/jimmunol.0903058</pub-id>
</mixed-citation>
    </ref>
    <ref id="B34">
      <label>34</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sandborn</surname><given-names>WJ</given-names></name><name><surname>Feagan</surname><given-names>BG</given-names></name><name><surname>Rutgeerts</surname><given-names>P</given-names></name><name><surname>Hanauer</surname><given-names>S</given-names></name><name><surname>Colombel</surname><given-names>J-F</given-names></name><name><surname>Sands</surname><given-names>BE</given-names></name><etal/></person-group>. <article-title>Vedolizumab as induction and maintenance therapy for crohn’s disease</article-title>. <source>N Engl J Med</source> (<year>2013</year>) <volume>369</volume>:<page-range>711–21</page-range>. doi: <pub-id pub-id-type="doi">10.1056/NEJMoa1215739</pub-id>
</mixed-citation>
    </ref>
    <ref id="B35">
      <label>35</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feagan</surname><given-names>BG</given-names></name><name><surname>Rutgeerts</surname><given-names>P</given-names></name><name><surname>Sands</surname><given-names>BE</given-names></name><name><surname>Hanauer</surname><given-names>S</given-names></name><name><surname>Colombel</surname><given-names>J-F</given-names></name><name><surname>Sandborn</surname><given-names>WJ</given-names></name><etal/></person-group>. <article-title>Vedolizumab as induction and maintenance therapy for ulcerative colitis</article-title>. <source>N Engl J Med</source> (<year>2013</year>) <volume>369</volume>:<fpage>699</fpage>–<lpage>710</lpage>. doi: <pub-id pub-id-type="doi">10.1056/NEJMoa1215734</pub-id>
<pub-id pub-id-type="pmid">23964932</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <label>36</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>H</given-names></name><name><surname>Galdos</surname><given-names>FX</given-names></name><name><surname>Lee</surname><given-names>D</given-names></name><name><surname>Waliany</surname><given-names>S</given-names></name><name><surname>Huang</surname><given-names>YV</given-names></name><name><surname>Ryan</surname><given-names>J</given-names></name><etal/></person-group>. <article-title>Identification of pathogenic immune cell subsets associated with checkpoint inhibitor-induced myocarditis</article-title>. <source>Circulation</source> (<year>2022</year>) <volume>146</volume>:<page-range>316–35</page-range>. doi: <pub-id pub-id-type="doi">10.1161/CIRCULATIONAHA.121.056730</pub-id>
</mixed-citation>
    </ref>
    <ref id="B37">
      <label>37</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKinnon</surname><given-names>KM</given-names></name></person-group>. <article-title>Flow cytometry: an overview</article-title>. <source>Curr Protoc Immunol</source> (<year>2018</year>) <volume>120</volume>:<fpage>5.1.1</fpage>–<lpage>5.1.11</lpage>. doi: <pub-id pub-id-type="doi">10.1002/cpim.40</pub-id>
</mixed-citation>
    </ref>
    <ref id="B38">
      <label>38</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adan</surname><given-names>A</given-names></name><name><surname>Alizada</surname><given-names>G</given-names></name><name><surname>Kiraz</surname><given-names>Y</given-names></name><name><surname>Baran</surname><given-names>Y</given-names></name><name><surname>Nalbant</surname><given-names>A</given-names></name></person-group>. <article-title>Flow cytometry: basic principles and applications</article-title>. <source>Crit Rev Biotechnol</source> (<year>2017</year>) <volume>37</volume>:<page-range>163–76</page-range>. doi: <pub-id pub-id-type="doi">10.3109/07388551.2015.1128876</pub-id>
</mixed-citation>
    </ref>
    <ref id="B39">
      <label>39</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>MJ</given-names></name><name><surname>Ntranos</surname><given-names>V</given-names></name><name><surname>Tse</surname><given-names>D</given-names></name></person-group>. <article-title>Determining sequencing depth in a single-cell RNA-seq experiment</article-title>. <source>Nat Commun</source> (<year>2020</year>) <volume>11</volume>:<fpage>774</fpage>. doi: <pub-id pub-id-type="doi">10.1038/s41467-020-14482-y</pub-id>
<pub-id pub-id-type="pmid">32034137</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <label>40</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jagla</surname><given-names>B</given-names></name><name><surname>Libri</surname><given-names>V</given-names></name><name><surname>Chica</surname><given-names>C</given-names></name><name><surname>Rouilly</surname><given-names>V</given-names></name><name><surname>Mella</surname><given-names>S</given-names></name><name><surname>Puceat</surname><given-names>M</given-names></name><etal/></person-group>. <article-title>SCHNAPPs - single cell sHiNy APPlication(s)</article-title>. <source>J Immunol Methods</source> (<year>2021</year>) <volume>499</volume>:<elocation-id>113176</elocation-id>. doi: <pub-id pub-id-type="doi">10.1016/j.jim.2021.113176</pub-id>
<pub-id pub-id-type="pmid">34742775</pub-id></mixed-citation>
    </ref>
    <ref id="B41">
      <label>41</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Traag</surname><given-names>VA</given-names></name><name><surname>Waltman</surname><given-names>L</given-names></name><name><surname>van Eck</surname><given-names>NJ</given-names></name></person-group>. <article-title>From louvain to Leiden: guaranteeing well-connected communities</article-title>. <source>Sci Rep</source> (<year>2019</year>) <volume>9</volume>:<fpage>5233</fpage>. doi: <pub-id pub-id-type="doi">10.1038/s41598-019-41695-z</pub-id>
<pub-id pub-id-type="pmid">30914743</pub-id></mixed-citation>
    </ref>
    <ref id="B42">
      <label>42</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skinnider</surname><given-names>MA</given-names></name><name><surname>Squair</surname><given-names>JW</given-names></name><name><surname>Courtine</surname><given-names>G</given-names></name></person-group>. <article-title>Enabling reproducible re-analysis of single-cell data</article-title>. <source>Genome Biol</source> (<year>2021</year>) <volume>22</volume>:<fpage>215</fpage>. doi: <pub-id pub-id-type="doi">10.1186/s13059-021-02422-y</pub-id>
<pub-id pub-id-type="pmid">34311752</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
