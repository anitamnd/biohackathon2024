<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10017117</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbad026</article-id>
    <article-id pub-id-type="publisher-id">vbad026</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Phylostems: a new graphical tool to investigate temporal signal of heterochronous sequences datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2866-6918</contrib-id>
        <name>
          <surname>Doizy</surname>
          <given-names>Anna</given-names>
        </name>
        <aff><institution>CIRAD, UMR PVBMT</institution>, <addr-line>La Réunion</addr-line>, St Pierre 97410, <country country="FR">France</country></aff>
        <aff><institution>DoAna—Statistiques Réunion</institution>, <addr-line>Reunion Island</addr-line>, Saint-Joseph F-97480, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Prin</surname>
          <given-names>Amaury</given-names>
        </name>
        <aff><institution>CIRAD, UMR PVBMT</institution>, <addr-line>La Réunion</addr-line>, St Pierre 97410, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cornu</surname>
          <given-names>Guillaume</given-names>
        </name>
        <aff><institution>CIRAD, Univ Montpellier, UR Forests and Societies</institution>, 34398 Montpellier Cedex 5, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chiroleu</surname>
          <given-names>Frederic</given-names>
        </name>
        <aff><institution>CIRAD, UMR PVBMT</institution>, <addr-line>La Réunion</addr-line>, St Pierre 97410, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7221-0010</contrib-id>
        <name>
          <surname>Rieux</surname>
          <given-names>Adrien</given-names>
        </name>
        <aff><institution>CIRAD, UMR PVBMT</institution>, <addr-line>La Réunion</addr-line>, St Pierre 97410, <country country="FR">France</country></aff>
        <xref rid="vbad026-cor1" ref-type="corresp"/>
        <!--adrien.rieux@cirad.fr-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ouangraoua</surname>
          <given-names>Aida</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbad026-cor1">To whom correspondence should be addressed. <email>adrien.rieux@cirad.fr</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-03-13">
      <day>13</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <volume>3</volume>
    <issue>1</issue>
    <elocation-id>vbad026</elocation-id>
    <history>
      <date date-type="received">
        <day>07</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>16</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>23</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>15</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbad026.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Molecular tip-dating of phylogenetic trees is a growing discipline that uses DNA sequences sampled at different points in time to co-estimate the timing of evolutionary events with rates of molecular evolution. Importantly, such inferences should only be performed on datasets displaying sufficient temporal signal, a feature important to test prior to any tip-dating inference. For this purpose, the most popular method considered to-date has been the ‘root-to-tip regression’ which consist in fitting a linear regression of the number of substitutions accumulated from the root to the tips of a phylogenetic tree as a function of sampling times. The main limitation of the regression method, in its current implementation, relies in the fact that the temporal signal can only be tested at the whole-tree scale (i.e. its root).</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>To overcome this limitation we introduce Phylostems, a new graphical user-friendly tool developed to investigate temporal signal within every clade of a phylogenetic tree. We provide a ‘how to’ guide by running Phylostems on an empirical dataset and supply guidance for results interpretation.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Phylostems is freely available at <ext-link xlink:href="https://pvbmt-apps.cirad.fr/apps/phylostems" ext-link-type="uri">https://pvbmt-apps.cirad.fr/apps/phylostems</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>l’Agence Nationale pour la Recherche</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Regional Development Fund</institution>
            <institution-id institution-id-type="DOI">10.13039/501100008530</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>‘Tip-dating’ of phylogenetic trees is a popular and powerful type of inference aiming to make use of sequence data isolated at different points in time (i.e. heterochronous datasets) to co-estimate the timing of evolutionary events with rates of molecular evolution (<xref rid="vbad026-B16" ref-type="bibr">Rieux and Balloux, 2016</xref>). As a prerequisite, tip-dating requires working on measurably evolving populations (MEPs) which consist in datasets displaying detectable amounts of <italic toggle="yes">de novo</italic> nucleotide changes among the DNA sequences sampled at different timepoints (<xref rid="vbad026-B4" ref-type="bibr">Drummond <italic toggle="yes">et al.</italic>, 2003b</xref>). Such phylogenetic inferences represent a powerful tool for biological hypothesis testing and have notably been critical for <italic toggle="yes">(i)</italic> dating key events in human evolutionary history, <italic toggle="yes">(ii)</italic> improving our understanding of various important pathogens emergence, spread and evolution, <italic toggle="yes">(iii)</italic> investigating the relative impacts of climatic and anthropogenic factors on the widespread extinctions of large mammals, <italic toggle="yes">(iv)</italic> providing meaningful information about pathogens host species jumps and <italic toggle="yes">(v)</italic> estimating unknown sequence’s ages in various organisms [see <xref rid="vbad026-B16" ref-type="bibr">Rieux and Balloux (2016)</xref> and references herein for review].</p>
    <p>Tip-dating inferences should only be performed when there is sufficient temporal signal within the analysed dataset (<xref rid="vbad026-B4" ref-type="bibr">Drummond <italic toggle="yes">et al.</italic>, 2003b</xref>; <xref rid="vbad026-B5" ref-type="bibr">Duchêne <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="vbad026-B10" ref-type="bibr">Murray <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="vbad026-B16" ref-type="bibr">Rieux and Balloux, 2016</xref>), a feature which might not be the case if <italic toggle="yes">(i)</italic> the sampling period is too short, <italic toggle="yes">(ii)</italic> evolutionary rates are too low or variable amongst lineages or <italic toggle="yes">(iii)</italic> some samples have incorrectly been dated (<xref rid="vbad026-B14" ref-type="bibr">Rambaut <italic toggle="yes">et al.</italic>, 2016</xref>). As such it is important for researchers to be able to test their dataset for the amount and consistency of temporal signal prior to any tip-dating inference. For this purpose, the most popular method considered to-date has been the ‘root-to-tip regression’ which consist in fitting a linear regression of the number of substitutions accumulated from the root to the tips of a phylogenetic tree as a function of sampling times (<xref rid="vbad026-B1" ref-type="bibr">Buonagurio <italic toggle="yes">et al.</italic>, 1986</xref>; <xref rid="vbad026-B3" ref-type="bibr">Drummond <italic toggle="yes">et al.</italic>, 2003a</xref>; <xref rid="vbad026-B8" ref-type="bibr">Korber <italic toggle="yes">et al.</italic>, 2000</xref>; <xref rid="vbad026-B17" ref-type="bibr">Shankarappa <italic toggle="yes">et al.</italic>, 1999</xref>). If sampling dates are sufficiently different, then more recently sampled sequences should have undergone substantially more evolutionary change than earlier sampled sequences, which would result in a positive correlation slope. This method has often been used as a diagnostic of data quality and of the reliability rate estimates, where the slope coefficient corresponds to the substitution rate under the assumption of a strict molecular clock, the <italic toggle="yes">X</italic>-intercept is an estimate of the date of the root of the tree and <italic toggle="yes">R</italic><sup>2</sup> indicates the degree to which sequence evolution has been clocklike. However, the root-to-tip regression method is not statistically suitable for proper hypothesis testing because the individual data points are not independently distributed, and are instead partially correlated due to their phylogenetic shared ancestry (<xref rid="vbad026-B3" ref-type="bibr">Drummond <italic toggle="yes">et al.</italic>, 2003a</xref>). To overcome this limitation, <xref rid="vbad026-B11" ref-type="bibr">Navascués <italic toggle="yes">et al.</italic> (2010)</xref> suggested a non-parametric approach using permutations to test whether the correlation is stronger than expected if the sampling dates were randomly assigned. More recently, other phylogenetic approaches such as the date-randomization test (<xref rid="vbad026-B5" ref-type="bibr">Duchêne <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="vbad026-B7" ref-type="bibr">Duffy and Holmes, 2009</xref>; <xref rid="vbad026-B10" ref-type="bibr">Murray <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="vbad026-B15" ref-type="bibr">Ramsden <italic toggle="yes">et al.</italic>, 2008</xref>) or model selection/comparison (<xref rid="vbad026-B6" ref-type="bibr">Duchene <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="vbad026-B10" ref-type="bibr">Murray <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="vbad026-B13" ref-type="bibr">Rambaut, 2000</xref>), although way more computationally intensive, have also been introduced and shown to be more robust tests for temporal signal detection and characterization.</p>
    <p>Despite its statistical pitfalls, the regression method remains a very helpful exploration tool to quickly assess the extent of temporal signal within a dataset. It only requires a rooted molecular phylogeny (whose branch lengths represent genetic distance) estimated from heterochronous (dated) sequences and runs instantaneously. Previously implemented in the popular and interactive graphical program TempEst (<xref rid="vbad026-B14" ref-type="bibr">Rambaut <italic toggle="yes">et al.</italic>, 2016</xref>), the main limitation of the regression method relies in the fact that the temporal signal can only be tested at the whole-dataset (tree) scale. However, although a significant positive correlation would indicate the presence of detectable amounts of <italic toggle="yes">de novo</italic> mutations within a tree timescale, a non-positive (or a statistically non-significant) correlation does not necessarily mean that no temporal signal exists at a reduced timescale, as illustrated in <xref rid="vbad026-F1" ref-type="fig">Figure 1A</xref>. To fill this methodological gap, we introduce Phylostems, a new graphical and user-friendly tool developed to investigate temporal signal at every clade of a phylogenetic tree. Phylostems allows detecting without a priori whether any subset of a tree would contain sufficient temporal signal for tip-based inference to be performed. We provide a ‘how to’ guide by running Phylostems on an empirical dataset and supply insights on interpreting the outputs.</p>
    <fig position="float" id="vbad026-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Phylostems rationale and workflow. (<bold>A</bold>) Let’s a tree (left panel) be constructed from a dataset of heterochronous sequences. When investigating temporal signal on the whole tree using the regular root-to-tip regression method (right panel), no significant signal is found as illustrated by the non-positive regression slope (black dotted line). Hence, tip-based inferences should not be performed at the whole tree timescale. However, as illustrated by the red and blue positive regression slopes calculated on two clade subsets (red and blue squares on the tree), positive temporal signal might exist at reduced timescales at which thorough tip-based inferences may be performed. The main objective of Phylostems is to provide the user with a graphical tool to detect without a priori such clades of interest. (<bold>B</bold>) Schematic representation of Phylostems workflow. Main boxes (‘Upload’, ‘Temporal signal’ and ‘Make new FASTA’) represent the internal structure of the application organized in three main panels. Major tasks performed in each panel are summarized along with sourced R packages</p>
      </caption>
      <graphic xlink:href="vbad026f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>2 Phylostems software</title>
    <sec>
      <title>2.1 General description</title>
      <p>Phylostems (Phylogenetic Scaling of Temporal Signal) is an open source, graphical Shiny-based R application (<xref rid="vbad026-B2" ref-type="bibr">Chang <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="vbad026-B12" ref-type="bibr">R Core Development Team, 2020</xref>) built for exploring temporal signal at various scales within a phylogenetic tree. Shiny is an R package that makes it easy to build interactive web applications from R (<ext-link xlink:href="https://shiny.rstudio.com/" ext-link-type="uri">https://shiny.rstudio.com/</ext-link>). Phylostems can be either used online at <ext-link xlink:href="https://pvbmt-apps.cirad.fr/apps/phylostems/" ext-link-type="uri">https://pvbmt-apps.cirad.fr/apps/phylostems/</ext-link> or executed locally by downloading its source code from <ext-link xlink:href="https://gitlab.com/cirad-apps/phylostems" ext-link-type="uri">https://gitlab.com/cirad-apps/phylostems</ext-link>. A schematic representation of Phylostems workflow is presented in <xref rid="vbad026-F1" ref-type="fig">Figure 1B</xref>. As input, Phylostems requires a rooted phylogenetic tree in computer-readable Nexus or Newick format with branch lengths scaled as genetic distances only, such as the ones computed using maximum-likelihood algorithms. In its current implementation, the online version of Phylostems allows uploading trees with 1500 sequences at maximum. Larger trees will need to be processed locally by sourcing the gitlab version. Importantly, sampling/isolation dates need to be known for each sequence and specified within tip labels. Before-Christ (B.C.) dates sometimes required to handle sequences generated from ancient DNA data can be specified using negative values (e.g. −400.5). Note that since missing dates are not allowed, sequences with unknown sampling years need to be pruned out from the tree prior to be uploaded in Phylostems.</p>
      <p>When a tree has correctly been loaded, a distribution of sampling dates is plotted within the ‘upload’ panel allowing for a visual check of sequences temporal width (<xref rid="vbad026-F2" ref-type="fig">Fig. 2C</xref>). Temporal signal is hence tested at every node of the input tree (including its root) meeting the following conditions required to perform a linear regression: <italic toggle="yes">(i)</italic> the node must be the parent of at least <italic toggle="yes">n</italic> = 3 tips, <italic toggle="yes">(ii)</italic> there should be at least <italic toggle="yes">n</italic> = 3 distinct combination of root-to-tip distances and sampling dates and <italic toggle="yes">(iii)</italic> there should be at least <italic toggle="yes">n</italic> = 2 different sampling dates. At each nodes meeting the above conditions, linear regression between sampling dates and root-to-tip distances is performed and the following parameters: (1) <italic toggle="yes">p</italic>-value, (2) slope, (3) adjusted <italic toggle="yes">R</italic><sup>2</sup> and (4) intercept with the <italic toggle="yes">x</italic>-axis values are recorded.</p>
      <fig position="float" id="vbad026-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Phylostems’s upload panel requesting the user to load a phylogenetic tree (<bold>A</bold>) and specify tip sampling dates from field-embedded values (<bold>B</bold>). Once loaded, a distribution of sampling dates is plotted allowing for a visual check of sequences temporal width (<bold>C</bold>)</p>
        </caption>
        <graphic xlink:href="vbad026f2" position="float"/>
      </fig>
      <p>Phylostems’s main results are provided within the ‘Temporal signal’ panel. First, an annotated phylogenetic tree is interactively plotted by sourcing both ggtree and plotly R packages (<xref rid="vbad026-B18" ref-type="bibr">Sievert, 2020</xref>; <xref rid="vbad026-B19" ref-type="bibr">Yu <italic toggle="yes">et al.</italic>, 2017</xref>). On this tree, nodes with temporal signal, that is, nodes at which root-to-tip linear regression yielded a statistically significant and positive slope, are highlighted with colours scaling to <italic toggle="yes">R</italic><sup>2</sup> value. The default threshold for the linear regression <italic toggle="yes">p</italic>-value has been fixed to 0.05 but the user can interactively modify it using a slider bar, which enables easy investigation of nodes with borderline significant trends. A table summarizing the nodes with temporal signal is also displayed along with respective number of descending sequences, <italic toggle="yes">p</italic>-value, slope and adjusted <italic toggle="yes">R</italic><sup>2</sup> values. Most importantly, Phylostems allows the user to visualize the root-to-tip regressions at any chosen node of interest. To do so, one simply needs to click on a node and the associated root-to-tip regression will be displayed. Both the tree and the root-to-tip regression plots are linked, so that data points (or tree tips) selected in one plot will automatically be highlighted on the other one. This enables easy investigation of outliers and sequences or clades of interest.</p>
      <p>Finally, when temporal signal is found at a specific node in the tree, Phylostems’s ‘Make new FASTA’ panel allows generating a new subset sequence FASTA file that only include the variant sites for the descending tips of this node, a dataset suitable for further tip-dating inferences.</p>
    </sec>
    <sec>
      <title>2.2 How to guide using an empirical dataset</title>
      <p>In the following, we use a previously published empirical dataset of 98 hantaviruses isolates sampled from bank voles in Belgium between 1984 and 2016 (<xref rid="vbad026-B9" ref-type="bibr">Laenen <italic toggle="yes">et al.</italic>, 2019</xref>) to illustrate how Phylostems allows exploring temporal signal within phylogenetic trees. We downloaded from the original publication a rooted-ML tree file built from non-recombining genomic sequences and loaded it in Phylostems. Visual inspection of the Hantaviruses tree demonstrated heterogeneous temporal signal among clades, here referring to three geographical sampling areas namely Ardennes, Campine and Sonian Forest (<xref rid="vbad026-F3" ref-type="fig">Fig. 3A</xref>). Phylostems revealed a lack of temporal signal both at the whole tree scale and for the Sonian Forest clade. Temporal signal was observed at the MRCA of the Campine and Ardennes clades as well as within the Ardennes clade, as represented by the highlighted nodes on the tree. A table listing all the nodes associated with temporal signal along with their associated statistics is given in <xref rid="vbad026-F3" ref-type="fig">Figure 3B</xref>. When plotting the root-to-tip regression at the MRCA of the Campine and Ardennes clades, Phylostems allows visually identifying outlier samples that are significantly deviating from the root-to-tip regression line (<xref rid="vbad026-F3" ref-type="fig">Fig. 3C</xref>). Here, those felt within the Campine clade, suggesting that phylogenetic tip-based inferences should probably not be performed on both the Campine and Ardennes clades simultaneously. Possible causes for such outliers are multiple and will be discussed in the following section.</p>
      <fig position="float" id="vbad026-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Phylostems results for the Hantaviruses dataset. (<bold>A</bold>) Annotated phylogenetic tree. Coloured circles indicate nodes at which temporal signal was found. (<bold>B</bold>) Summary table listing nodes with temporal signal and their associated statistical parameters. (<bold>C</bold>) Root-to-tip regression at node highlighted by the red arrow. Both the tree and the regression plots are linked, so that data points (or tree tips) selected in one plot will automatically be highlighted on the other one, as illustrated by the red-dotted frames</p>
        </caption>
        <graphic xlink:href="vbad026f3" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>3 Discussion and conclusion</title>
    <p>We introduce Phylostems, a new graphical and user-friendly tool developed to investigate temporal signal within phylogenetic trees using the root-to-tip regression method. Previous implementations of this method, such as in the popular and interactive graphical program TempEst (<xref rid="vbad026-B14" ref-type="bibr">Rambaut <italic toggle="yes">et al.</italic>, 2016</xref>), were designed to test temporal signal at the whole tree scale (i.e. at its root). Investigating temporal signal at smaller phylogenetic scales was previously doable, but this task required the user to <italic toggle="yes">(i)</italic> a priori decide at which clade (i.e. samples) performing the test and <italic toggle="yes">(ii)</italic> manually splitting or reconstructing the tree for every of such clades. The main improvement of Phylostems is to allow detecting, in a single step and without a priori, any clade at which temporal signal may exist within a phylogenetic tree.</p>
    <p>As illustrated by the empirical hantaviruses dataset analysed, temporal signal may sometimes be heterogeneous within a tree with substantial differences between clades. In such cases, we hope that Phylostems will help researchers detecting the most appropriate scales, if any, at which thorough tip-based inferences may be performed. However, because of the statistical pitfalls associated with the root-to-tip regression method (<xref rid="vbad026-B13" ref-type="bibr">Rambaut, 2000</xref>; <xref rid="vbad026-B14" ref-type="bibr">Rambaut <italic toggle="yes">et al.</italic>, 2016</xref>), Phylostems should rather be seen as a fast, visual and qualitative data exploration tool for temporal signal detection but should not be used to test hypotheses or undertake statistical model selection. Once temporal signal has been detected in Phylostems, we advise users to make use of other available methods such as non-parametric permutations (<xref rid="vbad026-B11" ref-type="bibr">Navascués <italic toggle="yes">et al.</italic>, 2010</xref>), date-randomization test (<xref rid="vbad026-B5" ref-type="bibr">Duchêne <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="vbad026-B7" ref-type="bibr">Duffy and Holmes, 2009</xref>; <xref rid="vbad026-B10" ref-type="bibr">Murray <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="vbad026-B15" ref-type="bibr">Ramsden <italic toggle="yes">et al.</italic>, 2008</xref>) or model selection/comparison (<xref rid="vbad026-B6" ref-type="bibr">Duchene <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="vbad026-B10" ref-type="bibr">Murray <italic toggle="yes">et al.</italic>, 2016</xref>) to validate the existence of MEPs in their datasets.</p>
    <p>Phylostems can also help identifying outliers or groups of samples that substantially differ from the root-to-tip regression line and may require careful handling to avoid bias during phylogenetic inferences. First, as illustrated by the analyse of the Hantaviruses dataset, different clades or populations in a tree may be characterized by positive but contrasted root-to-tip regression patterns that might arise from sampling bias or differences in life-history traits between clades (e.g. environmental factors, population density, evolutionary rates or epidemiological parameters). In such a case, it is suggested to perform independent phylogenetic inferences on each clade/population (<xref rid="vbad026-B9" ref-type="bibr">Laenen <italic toggle="yes">et al.</italic>, 2019</xref>). In other cases, outlier sequences whose sampling date is incongruent with their genetic divergence and phylogenetic position can be spotted from the regression plot (<xref rid="vbad026-B14" ref-type="bibr">Rambaut <italic toggle="yes">et al.</italic>, 2016</xref>). Such anomalies can reflect a problem with <italic toggle="yes">(i)</italic> the sequence itself (e.g. low quality, sequencing/assembly/alignment errors, recombination or hypermutation) or <italic toggle="yes">(ii)</italic> the sampling date(s) (e.g. mislabelling or biological contamination). Should the case of such outlier sequences arise, those samples should be excluded from subsequent phylogenetic inferences.</p>
    <p>Considering the impressive increase in availability and use of heterochronous datasets, we hope the functionality provided by Phylostems will help users to perform thorough tip-dating inferences. Phylostems is a dynamic application by nature. New functions will be added as new needs arise.</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We are grateful to S. Falala for his advices on building Shiny apps and CIRAD for providing hosting of the application server. We thank B. Vrancken for providing access to the empirical dataset analysed in this study. We also thank L. van Dorp, P. Campos, C.G. Crego, E. Conte, T.T. CAO, F. Balloux and D. Richard for interesting discussions and testing previous versions of the app on their own datasets.</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>This work was financially supported by the l’Agence Nationale pour la Recherche (JCJC MUSEOBACT contract ANR-17-CE35-0009-01), the European Regional Development Fund (ERDF contract GURDT I2016‐1731‐0006632), Région Réunion and the French Agropolis Foundation (Labex Agro—Montpellier, E-SPACE Project Number 1504-004).</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>Phylostems can be executed online at <ext-link xlink:href="https://pvbmt-apps.cirad.fr/apps/phylostems/" ext-link-type="uri">https://pvbmt-apps.cirad.fr/apps/phylostems/</ext-link> but source code can also be downloaded from <ext-link xlink:href="https://gitlab.com/cirad-apps/phylostems" ext-link-type="uri">https://gitlab.com/cirad-apps/phylostems</ext-link> for local implementation. The Hantaviruses empirical tree used in this article is accessible from the gitlab repository.</p>
  </sec>
  <sec>
    <title>Authors’ contributions</title>
    <p>A.R. initially conceptualized the method. A.P. generated the first version of the code. A.D. improved it and converted it into a Shiny application with advices from A.R., G.C. and F.C. G.C. managed the online implementation and maintenance of the app. A.D. and A.R. wrote the first draft and all authors contributed to the final version.</p>
    <p><italic toggle="yes">Conflict of Interest:</italic> none declared.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbad026-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buonagurio</surname><given-names>D.A.</given-names></string-name></person-group> et al (<year>1986</year>) <article-title>Evolution of human influenza a viruses over 50 years: Rapid, uniform rate of change in NS gene</article-title>. <source>Science</source>, <volume>232</volume>, <fpage>980</fpage>–<lpage>982</lpage>. <pub-id pub-id-type="doi">10.1126/science.2939560</pub-id><pub-id pub-id-type="pmid">2939560</pub-id></mixed-citation>
    </ref>
    <ref id="vbad026-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>W.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <italic toggle="yes">shiny: Web Application Framework for R</italic>. Comprehensive R Archive Network (CRAN). <ext-link xlink:href="https://cran.r-project.org/package=shiny" ext-link-type="uri">https://cran.r-project.org/package=shiny</ext-link></mixed-citation>
    </ref>
    <ref id="vbad026-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Drummond</surname><given-names>A.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2003a</year>) <article-title>Inference of viral evolutionary rates from molecular sequences</article-title>. <source>Adv. Parasitol.</source>, <volume>54</volume>, <fpage>331</fpage>–<lpage>358</lpage>.<pub-id pub-id-type="pmid">14711090</pub-id></mixed-citation>
    </ref>
    <ref id="vbad026-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Drummond</surname><given-names>A.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2003b</year>). <article-title>Measurably evolving populations</article-title>. <source>Trends Ecol. Evol.</source>, <volume>18</volume>, <fpage>481</fpage>–<lpage>488</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad026-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duchêne</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>The performance of the date-randomization test in phylogenetic analyses of time-structured virus data</article-title>. <source>Mol. Biol. Evol</source>., <volume>32</volume>, <fpage>1895</fpage>–<lpage>1906</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msv056</pub-id><pub-id pub-id-type="pmid">25771196</pub-id></mixed-citation>
    </ref>
    <ref id="vbad026-B6">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Duchene</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) Bayesian evaluation of temporal signal in measurably evolving populations. <italic toggle="yes">bioRxiv</italic>. <pub-id pub-id-type="doi">10.1101/810697</pub-id></mixed-citation>
    </ref>
    <ref id="vbad026-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duffy</surname><given-names>S.</given-names></string-name>, <string-name><surname>Holmes</surname><given-names>E.C.</given-names></string-name></person-group> (<year>2009</year>) <article-title>Validation of high rates of nucleotide substitution in geminiviruses: Phylogenetic evidence from east African cassava mosaic viruses</article-title>. <source>J. Gen. Virol</source>., <volume>90</volume>, <fpage>1539</fpage>–<lpage>1547</lpage>. <pub-id pub-id-type="doi">10.1099/vir.0.009266-0</pub-id><pub-id pub-id-type="pmid">19264617</pub-id></mixed-citation>
    </ref>
    <ref id="vbad026-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Korber</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2000</year>) <article-title>Timing the ancestor of the HIV-1 pandemic strains</article-title>. <source>Science</source>, <volume>288</volume>, <fpage>1789</fpage>–<lpage>1796</lpage>. <pub-id pub-id-type="doi">10.1126/science.288.5472.1789</pub-id><pub-id pub-id-type="pmid">10846155</pub-id></mixed-citation>
    </ref>
    <ref id="vbad026-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Laenen</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Identifying the patterns and drivers of Puumala hantavirus enzootic dynamics using reservoir sampling</article-title>. <source>Virus Evol</source>., <volume>5</volume>, <pub-id pub-id-type="doi">10.1093/ve/vez009</pub-id></mixed-citation>
    </ref>
    <ref id="vbad026-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Murray</surname><given-names>G.G.R.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>The effect of genetic structure on molecular dating and tests for temporal signal</article-title>. <source>Methods Ecol. Evol</source>., <volume>7</volume>, <fpage>80</fpage>–<lpage>89</lpage>. <pub-id pub-id-type="doi">10.1111/2041-210X.12466</pub-id><pub-id pub-id-type="pmid">27110344</pub-id></mixed-citation>
    </ref>
    <ref id="vbad026-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Navascués</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>Combining contemporary and ancient DNA in population genetic and phylogeographical studies</article-title>. <source>Mol. Ecol. Resour</source>., <volume>10</volume>, <fpage>760</fpage>–<lpage>772</lpage>. <pub-id pub-id-type="doi">10.1111/j.1755-0998.2010.02895.x</pub-id><pub-id pub-id-type="pmid">21565088</pub-id></mixed-citation>
    </ref>
    <ref id="vbad026-B12">
      <mixed-citation publication-type="other">R Core Development Team. (<year>2020</year>). <italic toggle="yes">R: A Language and Environment for Statistical Computing</italic>, version 3.2.1. R Foundation for Statistical Computing (document freely available on the internet at: <ext-link xlink:href="http://www.r-project.org" ext-link-type="uri">http://www.r-project.org</ext-link>). <pub-id pub-id-type="doi">10.1017/CBO9781107415324.004</pub-id></mixed-citation>
    </ref>
    <ref id="vbad026-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rambaut</surname><given-names>A.</given-names></string-name></person-group> (<year>2000</year>) <article-title>Estimating the rate of molecular evolution: Incorporating non-contemporaneous sequences into maximum likelihood phylogenies</article-title>. <source>Bioinformatics</source>, <volume>16</volume>, <fpage>395</fpage>–<lpage>399</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/16.4.395</pub-id><pub-id pub-id-type="pmid">10869038</pub-id></mixed-citation>
    </ref>
    <ref id="vbad026-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rambaut</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Exploring the temporal structure of heterochronous sequences using TempEst (formerly Path-O-Gen)</article-title>. <source>Virus Evol</source>., <volume>2</volume>, <fpage>vew007</fpage>. <pub-id pub-id-type="doi">10.1093/VE/VEW007</pub-id><pub-id pub-id-type="pmid">27774300</pub-id></mixed-citation>
    </ref>
    <ref id="vbad026-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ramsden</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal>; The VGDN Consortium. (<year>2008</year>) <article-title>High rates of molecular evolution in hantaviruses</article-title>. <source>Mol. Biol. Evol</source>., <volume>25</volume>, <fpage>1488</fpage>–<lpage>1492</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msn093</pub-id><pub-id pub-id-type="pmid">18417484</pub-id></mixed-citation>
    </ref>
    <ref id="vbad026-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rieux</surname><given-names>A.</given-names></string-name>, <string-name><surname>Balloux</surname><given-names>F.</given-names></string-name></person-group> (<year>2016</year>) <article-title>Inferences from tip-calibrated phylogenies: A review and a practical guide</article-title>. <source>Mol. Ecol.</source>, <volume>25</volume>, <fpage>1911</fpage>–<lpage>1924</lpage>.<pub-id pub-id-type="pmid">26880113</pub-id></mixed-citation>
    </ref>
    <ref id="vbad026-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shankarappa</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>1999</year>) <article-title>Consistent viral evolutionary changes associated with the progression of human immunodeficiency virus type 1 infection</article-title>. <source>J. Virol</source>., <volume>73</volume>, <fpage>10489</fpage>–<lpage>10502</lpage>. <pub-id pub-id-type="doi">10.1128/jvi.73.12.10489-10502.1999</pub-id><pub-id pub-id-type="pmid">10559367</pub-id></mixed-citation>
    </ref>
    <ref id="vbad026-B18">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Sievert</surname><given-names>C.</given-names></string-name></person-group> (<year>2020</year>) <part-title><italic toggle="yes">Interactive Web-Based Data Visualization with R</italic>, <italic toggle="yes">Plotly, and</italic> <italic toggle="yes">Shiny</italic></part-title>. <publisher-name>Chapman and Hall/CRC</publisher-name>.</mixed-citation>
    </ref>
    <ref id="vbad026-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname><given-names>G.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Ggtree: An r package for visualization and annotation of phylogenetic trees with their covariates and other associated data</article-title>. <source>Methods Ecol. Evol</source>., <volume>8</volume>, <fpage>28</fpage>–<lpage>36</lpage>. <pub-id pub-id-type="doi">10.1111/2041-210X.12628</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
