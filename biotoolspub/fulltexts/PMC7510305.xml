<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7510305</article-id>
    <article-id pub-id-type="publisher-id">3742</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03742-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MapGL: inferring evolutionary gain and loss of short genomic sequence features by phylogenetic maximum parsimony</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0915-4570</contrib-id>
        <name>
          <surname>Diehl</surname>
          <given-names>Adam G.</given-names>
        </name>
        <address>
          <email>adadiehl@umich.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Boyle</surname>
          <given-names>Alan P.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.214458.e</institution-id><institution-id institution-id-type="ISNI">0000000086837370</institution-id><institution>Department of Computational Medicine and Bioinformatics, </institution><institution>University of Michigan, </institution></institution-wrap>Ann Arbor, MI USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.214458.e</institution-id><institution-id institution-id-type="ISNI">0000000086837370</institution-id><institution>Department of Human Genetics, </institution><institution>University of Michigan, </institution></institution-wrap>Ann Arbor, MI USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>416</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>11</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>9</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Comparative genomics studies are growing in number partly because of their unique ability to provide insight into shared and divergent biology between species. Of particular interest is the use of phylogenetic methods to infer the evolutionary history of cis-regulatory sequence features, which contribute strongly to phenotypic divergence and are frequently gained and lost in eutherian genomes. Understanding the mechanisms by which cis-regulatory element turnover generate emergent phenotypes is crucial to our understanding of adaptive evolution. Ancestral reconstruction methods can place species-specific cis-regulatory features in their evolutionary context, thus increasing our understanding of the process of regulatory sequence turnover. However, applying these methods to gain and loss of cis-regulatory features historically required complex workflows, preventing widespread adoption by the broad scientific community.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">MapGL simplifies phylogenetic inference of the evolutionary history of short genomic sequence features by combining the necessary steps into a single piece of software with a simple set of inputs and outputs. We show that MapGL can reliably disambiguate the mechanisms underlying differential regulatory sequence content across a broad range of phylogenetic topologies and evolutionary distances. Thus, MapGL provides the necessary context to evaluate how genomic sequence gain and loss contribute to species-specific divergence.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">MapGL makes phylogenetic inference of species-specific sequence gain and loss easy for both expert and non-expert users, making it a powerful tool for gaining novel insights into genome evolution.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Phylogenetic analysis</kwd>
      <kwd>Genomics</kwd>
      <kwd>Genome evolution</kwd>
      <kwd>Regulatory evolution</kwd>
      <kwd>Genomic algorithms</kwd>
      <kwd>Ancestral reconstruction</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000879</institution-id>
            <institution>Alfred P. Sloan Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>FG-2015-65465</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DBI-1651614</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par7">Comparative genomics uses sequence-level differences between species to gain insights into how genomes function and evolve [<xref ref-type="bibr" rid="CR1">1</xref>]. According to Google Scholar, published comparative genomics studies have increased every year since 2009. These studies rely on the ability to detect and assign provenance to lineage-specific sequence variations at both the nucleotide level and at the level of larger-scale sequence insertions and deletions (indels). While species-specific indels are easily visible as gaps in pairwise alignments, gap presence alone tells us nothing about the underlying evolutionary processes by which it was created. Further analyses are necessary to differentiate between species-specific sequence insertions and loss of ancestral sequences. Understanding the mechanisms driving sequence divergence and their relationships to natural selection requires the ability to discern between these events. Ancestral reconstruction is a phylogenetic method by which observed states in outgroup species are used to infer the state in the most-recent common ancestor (MRCA) [<xref ref-type="bibr" rid="CR2">2</xref>]. This inferred ancestral state can then be used to predict the evolutionary events leading to an indel. These methods can place indels in their proper evolutionary context, allowing much greater precision in hypothesis generation regarding the causes, underlying mechanisms, and downstream effects of sequence turnover.</p>
    <p id="Par8">However, ancestral reconstruction is a complex process and, while tools exist to reconstruct ancestral protein and DNA sequences [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref>] and ancestral genomes [<xref ref-type="bibr" rid="CR6">6</xref>], no published tool exists to infer evolutionary gain and loss of short genomic sequence features. Doing so has historically relied on ad-hoc workflows involving multiple mapping steps to target and outgroup genomes and subsequent analysis with a combination of published genomics software and custom scripts (see [<xref ref-type="bibr" rid="CR7">7</xref>] for example). While general phylogenetic inference software, such as TNT [<xref ref-type="bibr" rid="CR8">8</xref>] and POY [<xref ref-type="bibr" rid="CR9">9</xref>], may be used to perform the ancestral reconstruction steps of these pipelines, given a fixed phylogenetic tree, their proper application requires a level of specialist knowledge that may be prohibitive for the casual user. Furthermore, the complexity of these pipelines is exacerbated by the need to use multiple outgroup species in order to ensure the reliability of inferences [<xref ref-type="bibr" rid="CR10">10</xref>], which comes at the cost of increased input and intermediate files, alignment and post-processing steps, disk and memory usage, and overall analysis time. These limitations represent a significant barrier to widespread application by the broad scientific community. MapGL addresses this problem by combining all mapping and phylogenetic inference steps into a single program with simple inputs and easily interpreted outputs.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par9">MapGL applies a simple phylogenetic inference approach based on Wagner parsimony [<xref ref-type="bibr" rid="CR11">11</xref>] to infer the evolutionary history of short genomic sequence features from a query genome relative to a target genome (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). This approach seeks to minimize the number of state-changes (i.e., sequence gains and losses) necessary to explain the pattern of sequence presence/absence in a multiple-alignment of contemporary sequences. Briefly, for each query feature, an initial mapping step to the target genome determines whether an orthologous sequence exists. If so, the sequence is labeled as an ortholog and written to output. Otherwise, the ancestral state is inferred by projecting observed data from the query, target, and outgroup species onto a precomputed, fixed phylogeny describing the evolutionary relationships between all present-day and ancestral species (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). Ancestral state inference proceeds using an adaptation of Fitch’s Algorithm [<xref ref-type="bibr" rid="CR12">12</xref>], whereby the most-likely ancestral state is chosen to minimize the total number of gain/loss events required to explain the pattern of sequence presence/absence in the observed data [<xref ref-type="bibr" rid="CR12">12</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). Query sequences are first mapped to each outgroup and state labels recorded at the corresponding leaf nodes: “1” if an orthologous sequence exists or “0” if not. Next, a post-order traversal is performed to infer states at all internal nodes, choosing the most-frequent state observed among child nodes, or storing the union set of observed symbols in case of ties. The inferred state at the root node, representing the MRCA, is then used to infer whether sequences were gained on the branch leading to the query species (i.e., were absent in the MRCA) or lost on the branch leading to the target species (i.e., were present in the MRCA) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a-b).
<fig id="Fig1"><label>Fig. 1</label><caption><p>The mapGL algorithm. <bold>a</bold> Schematic outline for the mapGL algorithm. After initialization, the algorithm loops over query features, performing an initial mapping step against the target species. If the feature maps to the target species, it is labelled as an ortholog and written to output. If not, it enters the ancestral reconstruction stage. The feature is then mapped to each outgroup species in the full phylogeny and the corresponding leaves are labelled to indicate presence or absence. Internal labels are inferred based on the patterns observed at the leaf nodes (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>). If the root state cannot be inferred unambiguously, root state disambiguation is performed as shown in panel D. Gain and loss events can then be inferred based on whether a feature is present at the root of the tree. The labelled feature is then written to output. This process is repeated until all query features are labelled. <bold>b</bold> Full phylogenetic tree describing evolutionary relationships between the query and target species (nodes 3 and 4) plus three outgroups (nodes 6–8). Query, target, and outgroup species occupy the leaf nodes of the tree. These are the only species for which we can directly observe sequence presence/absence. Internal nodes (0, 1, 2, and 5) represent ancestral species. <bold>c</bold> Since we cannot observe internal sequences directly, we must infer sequence presence/absence based on present-day observations from the leaf species. The core step of the ancestral reconstruction stage involves labelling all leaf nodes with their observed states and performing a post-order tree traversal to infer the states at internal nodes following the principle of maximum-parsimony (MP). The most-recent common ancestor (MRCA) occupies the root node (node 0), and the inferred state at this node is returned and used to predict whether query-specific sequences were gained in the query genome or lost from the target genome (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>a-b) for example). <bold>(D)</bold> In cases when the root state cannot be resolved, the root state is disambiguated following a simple decision tree. In the first step, the larger of the left and right subtrees is chosen. If the state at the base of this tree is unambiguous, the root state is set to the corresponding state. Otherwise, we check the state at the base of the opposite subtree. If this node is not a leaf node and is labeled with an unambiguous state, we set the root state to the corresponding state. If neither left nor right subtrees have an unambiguous root state, or if the only unambiguous descendant node is a leaf node, the root state is chosen based on the –priority parameter. If this is set to “gain,” the root state defaults to 0 (sequence absence). If it is set to “loss,” the root state defaults to 1 (sequence presence)</p></caption><graphic xlink:href="12859_2020_3742_Fig1_HTML" id="MO1"/></fig><fig id="Fig2"><label>Fig. 2</label><caption><p>Example gain and loss inferences based on ancestral state reconstruction. <bold>a</bold> Example sequence loss in the target species based on presence in the most-recent common ancestor (MRCA), at the root of the tree. <bold>b</bold> Example sequence gain in the query species. Sequence absence is the most parsimonious inferred ancestral state as it invokes two independent sequence gains rather than three independent losses necessary to explain the observed data. <bold>d</bold> The phylogeny in C may be resolved by choosing an unambiguous state from one of the two nodes directly above the root. In the case of the tree shown, this is equivalent to pruning the outermost outgroup and rerooting the tree. The inferred ancestral state, then, is presence of an orthologous sequence and sequence loss in the target species is called. <bold>e</bold> UCSC Genome Browser track for a region in the human genome (hg19 build) labelled by MapGL as a human-specific gain. The region contains a CTCF binding annotation residing in a primate-specific insertion of an L2a LINE transposable element. <bold>f</bold> UCSC Genome Browser track for a region in the human genome labelled by MapGL as a mouse-specific loss. This region also contains a CTCF binding site residing within an L2a LINE element, but one that was inserted prior to divergence of Atlantogenata and Boreoeutheria species</p></caption><graphic xlink:href="12859_2020_3742_Fig2_HTML" id="MO2"/></fig></p>
    <p id="Par10">In cases where the root state cannot be resolved, we set the root state equal to the unambiguous descendant state supported by the subtree with the most leaves. In the case of a single terminal outgroup species, where the right subtree has only one leaf, this is equivalent to pruning the most-terminal outgroup at the branch directly above the root (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d, Fig. <xref rid="Fig2" ref-type="fig">2</xref>c-d). When this fails, we choose the root state based on the value of the –priority (−p) parameter that prioritizes sequence gain or loss. Setting this to “gain” is equivalent to assigning a lower evolutionary cost to sequence insertions compared to deletions. The root state will then default to “0” in ambiguous cases and sequence presence in descendant nodes will be interpreted as sequence gain. Setting this to “loss” will have the opposite effect. This behavior can be disabled via the –no_prune (−n) option, in which case such sequences will be labeled as “ambiguous.” Optionally, an additional pre-order tree traversal can be performed to infer and report all branch(es) on which sequence gain/loss events occurred throughout the phylogeny.</p>
    <p id="Par11">MapGL takes as inputs a set of genomic query features in BED format, a set of liftover chains [<xref ref-type="bibr" rid="CR13">13</xref>] corresponding to the target and outgroup species, and a Newick tree describing the full phylogeny. The program is self-documenting and ships with a small example dataset. MapGL can be tuned through several command-line options. The most important of these are –threshold (−t) and –gap (−g). The -t &lt; FLOAT&gt; option specifies the amount of overlap required between query features and target chains, expressed as the fraction of query nucleotides overlapping a target chain, to call a match as a function of the query element length. The default value of 0.0 is equivalent to requiring a single-base overlap while a value of 1 would enforce only full-length alignments. The -g &lt; INT&gt; option specifies the tolerance for gaps and takes an integer specifying the maximum tolerable gap length, in nucleotides, as its argument. The default value of −1 indicates that gaps of any length are allowed. The default values maximize the algorithm’s ability to find orthologous sequences, making gain and loss predictions very conservative. However, these values may lead to erroneous ortholog predictions in cases where aligned features contain embedded indels, may be overly conservative when comparing closely related genomes, and may lead to underprediction of sequence gains/losses in poorly aligned regions. Specifying a non-zero mapping threshold and a gap tolerance near the average gap length in such regions may increase the sensitivity of MapGL to detect gain and loss events, albeit at the expense of reducing its sensitivity for orthologs. Nonetheless, as the prototypical use of this program is to identify whole sequence features that have undergone species-specific gain or loss, the default values are likely reasonable for most users.</p>
    <p id="Par12">MapGL is free and open-sourced under the MIT License. It is based on bnMapper [<xref ref-type="bibr" rid="CR14">14</xref>], which maps genomic sequences across species based on liftover chains [<xref ref-type="bibr" rid="CR13">13</xref>]. We retained the core mapping steps from bnMapper with one modification: while bnMapper drops alignments that are split across chains, we keep the longest alignment among all chains represented. This behavior can be controlled with the –drop_split (−d) option. We extended this framework by adding the ability to map against multiple liftover chains to incorporate target and outgroup species and added the ancestral reconstruction steps outlined above. Tree parsing and phylogenetic methods were adapted from the python-newick package (<ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/newick/">https://pypi.org/project/newick/</ext-link>). MapGL is compatible with MacOS and most Unix-like operating systems, and is available for installation through PyPI and Bioconda, with source code available from the GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/adadiehl/mapGL">https://github.com/adadiehl/mapGL</ext-link>).</p>
    <p id="Par13">We present three case studies spanning a wide variety of phylogenetic tree topologies and evolutionary distances to establish the performance of MapGL. We obtained CTCF binding locations in one of two query species: human and <italic>D. melanogaster</italic>. Human data were compared to mouse, a distant target species, in the mammalian analysis (Fig. S<xref rid="MOESM1" ref-type="media">1</xref>A), and chimpanzee, a closely related target species, in the primate analysis (Fig. S<xref rid="MOESM1" ref-type="media">1</xref>C). <italic>D. melanogaster</italic> data were compared to <italic>D. simulans</italic>, which are roughly three times more divergent than human and chimpanzee, in the invertebrate analysis (Fig. S<xref rid="MOESM1" ref-type="media">1</xref>E). Human CTCF data were originally analyzed as part of a study on the effects of transposable element (TE) activity on CTCF binding site content in mammalian genomes [<xref ref-type="bibr" rid="CR15">15</xref>]. In keeping with this, dog, horse, and elephant were chosen as outgroups to yield phylogenetic tree that encompasses two major groups of mammals: Atlantogenata and Boreoeutheria, spanning the primary activity periods for several TE types associated with CTCF binding (Fig. S<xref rid="MOESM1" ref-type="media">1</xref>A). Methods for all three analyses are described in detail within the Supplementary Methods.</p>
  </sec>
  <sec id="Sec3">
    <title>Results</title>
    <p id="Par14">Results of the mammalian analysis show that roughly 1/3 of human CTCF binding sites are not found in mouse, either as a result of human-specific gain or mouse-specific loss (Fig. S<xref rid="MOESM1" ref-type="media">1</xref>B). We show two representative examples in Fig. <xref rid="Fig2" ref-type="fig">2</xref>e-f, noting that that both show the expected patterns of sequence presence/absence for their respective labels. Importantly, these two predictions demonstrate how even sites with similar functional annotations can have very different evolutionary origins. Although both these regions contain human-specific CTCF binding sites derived from L2a retrotransposon insertions, these insertions occurred at very distant points in evolutionary history. The feature shown in in Fig. <xref rid="Fig2" ref-type="fig">2</xref>e originated from an L2a insertion that occurred after primate-rodent divergence while the region in Fig. <xref rid="Fig2" ref-type="fig">2</xref>f originated from an L2a insertion that occurred very early in placental mammal evolution, prior to the divergence of Atlantogenata and Boreoeutheria, and was subsequently lost from the mouse genome. Thus, MapGL can discern between elements with different evolutionary histories, leading to distinct interpretations regarding their roles in regulatory innovation.</p>
    <p id="Par15">Consistent with the relatively small evolutionary distance between human and chimpanzee, we observed a substantially lower rate of turnover in CTCF binding sequence content in the primate analysis relative to the mammalian analysis (Fig. S<xref rid="MOESM1" ref-type="media">1</xref>C). However, the expected patterns of sequence presence/absence were still evident in multiple sequence alignments for gain and loss predictions (Fig. S<xref rid="MOESM1" ref-type="media">2</xref>A-B). Likewise, the invertebrate analysis yielded similar results. Interestingly, the level of CTCF binding turnover observed in <italic>D. melanogaster</italic> compared to <italic>D. simulans</italic> (Fig. S<xref rid="MOESM1" ref-type="media">1</xref>F) was very close to the rate observed in comparison between human and chimpanzee (Fig. S<xref rid="MOESM1" ref-type="media">1</xref>D) despite being roughly threefold more divergent at the sequence level. This may result from strong selection to maintain a compact genome, leading to a low tolerance for genomic insertions [<xref ref-type="bibr" rid="CR16">16</xref>]. Nonetheless, representative gain and loss predictions from <italic>D. melanogaster</italic> exhibit the expected characteristics in multiple sequence alignments (Figs. S2C-D).</p>
  </sec>
  <sec id="Sec4">
    <title>Conclusions</title>
    <p id="Par16">Comparative genomics relies on the ability to infer the creative mechanisms and downstream effects of lineage-specific sequence divergence. However, even sequences with similar properties can have very different evolutionary histories. This ambiguity compromises our ability to determine how lineage-specific gain and loss of short sequence features relates to conserved and divergent functions. Placing species-specific sequence features in their proper evolutionary context enables a deeper understanding of functional divergence but requires application of phylogenetic methods that have not been previously integrated into a single piece of software. MapGL answers this need, opening these methods to a much broader user base.</p>
    <p id="Par17">While query and target species will have generally been chosen prior to the decision to apply MapGL, the choice of appropriate outgroups should also be considered carefully, as it is critical in optimizing the performance of MapGL. Thus, we offer some general guidelines for outgroup selection. First, we recommend using a minimum of two outgroups, while three or more is better. Because MapGL utilizes a known, fixed phylogeny to describe species relationships, errors in the tree topology may lead to erroneous gain/loss inferences. Therefore, we advise choosing species for which a reliable phylogeny is available. In order to ensure sufficient data to resolve between competing gain/loss scenarios, the amount of evolutionary distance captured within the outgroup subtree (i.e., the sum of the branch lengths connecting all leaves and internal nodes) should equal or exceed the distance between the query/target clade. Likewise, to avoid biasing gain/loss predictions toward either the query or target branch, the overall distance between the nearest outgroup and the root of the query/target clade should be at least as long as the shorter of the query or target branch. Finally, the mechanisms involved in creating indel sequences of interest should be considered as they may dictate the evolutionary distances necessary to accurately resolve competing gain/loss scenarios. For example, sequence turnover that occurs gradually, such as accumulation of small indels over many generations, may require relatively distant outgroups for reliable inference. By contrast, processes that occur within a relatively short evolutionary timespan, such as individual transposon dispersal events, may be resolvable using more closely related outgroups. It is also important to note that MapGL depends on the accuracy of chain files used to determine sequence presence/absence in target and outgroup species. Intuitively, alignment errors can create erroneous gaps in alignment chains, leading to erroneous gain/loss predictions. Since these errors are more prevalent in alignments between low-coverage/low-quality genome assemblies, these metrics should be considered in selecting outgroup species.</p>
    <p id="Par18">Similarly, inferences within difficult-to-align regions, including simple sequence repeats and repetitive elements, may be of lesser quality than those elsewhere. In some cases, difficult-to-align sequences may manifest themselves as regions with many apparent substitutions and indels. As discussed in the Implementation section, predictive accuracy within such regions may be improved through careful tuning of the –gap (−g) and –threshold (−t) options. We note several use cases where it may be beneficial to use non-default values for the -g and -t parameters, but this list is far from exhaustive: 1) comparisons between closely-related query and target species (e.g., human and chimp); 2) labelling query sequences that fall within difficult-to-align regions with high rates of alignment error; 3) classifying sequences created by indel processes prone to creating multiple, closely-spaced indels; 4) maximizing the specificity of ortholog predictions at the expense of decreasing predictive accuracy for gain/loss events.</p>
    <p id="Par19">MapGL was designed to resolve the evolutionary histories of indels between a pair of query and target species. Therefore, by design, its resolution in placing gain and loss events in evolutionary time is inherently limited. While the program does not prohibit intermediate species in the phylogeny, beyond providing additional data from which to predict the ancestral state, their inclusion will not improve the temporal resolution or quality of gain/loss predictions. However, we show that the current implementation of MapGL performs well in the specific tasks for which it was designed and should be sufficient for most anticipated use cases. We show that MapGL performs well over a wide range of evolutionary distances and tree topologies in both mammalian and invertebrate datasets, establishing MapGL as a simple and robust method to infer the evolutionary histories of short sequence features.</p>
    <sec id="Sec5">
      <title>Availability and requirements</title>
      <p id="Par20">Project name: MapGL</p>
      <p id="Par21">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/adadiehl/mapGL">https://github.com/adadiehl/mapGL</ext-link>. (Python package available through PyPi, and Bioconda)</p>
      <p id="Par22">Operating systems: MacOS, Linux</p>
      <p id="Par23">Programming language: Python</p>
      <p id="Par24">Other Requirements: None</p>
      <p id="Par25">License: MIT</p>
      <p id="Par26">Restrictions: None</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec6">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2020_3742_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: Table S1.</bold> Datasets. <bold>Figure S1.</bold> Phylogenetic trees and gain/loss statistics for CTCF binding sites in mammalian, primate, and invertebrate phylogenies. <bold>Figure S2.</bold> Representative gain and loss predictions from the primate and invertebrate analyses.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>Indel</term>
        <def>
          <p id="Par4">Insertion or deletion of genomic sequence</p>
        </def>
      </def-item>
      <def-item>
        <term>MRCA</term>
        <def>
          <p id="Par5">Most-Recent Common Ancestor</p>
        </def>
      </def-item>
      <def-item>
        <term>TE</term>
        <def>
          <p id="Par6">Transposable Element</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-020-03742-9.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank members of the Boyle lab for critical reading and suggestions on the manuscript.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>AD wrote the MapGL software and performed all testing and validation and authored the manuscript. AB secured funding, provided planning and guidance for the analyses, and provided editorial and critical suggestions during manuscript preparation. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This project was made possible through funding by the Alfred P. Sloan Foundation [FG-2015-65465] and National Science Foundation CAREER Award [DBI-1651614 to A.B.] The funding bodies had no role in the design of the study and collection, analysis, and interpretation of data, or in writing the manuscript. Publication costs are funded by DBI-1651614.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All primary datasets used in this analysis, listed in Table S<xref rid="MOESM1" ref-type="media">1</xref>, are freely and publicly available from their listed sources. All derived datasets and results generated in the current study can be reproduced using scripts available through the GitHub repository for this analysis: <ext-link ext-link-type="uri" xlink:href="https://github.com/adadiehl/MapGL_analysis">https://github.com/adadiehl/MapGL_analysis</ext-link>.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par27">Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par28">Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par29">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hardison</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Comparative genomics</article-title>
        <source>PLoS Biol</source>
        <year>2003</year>
        <volume>1</volume>
        <issue>2</issue>
        <fpage>e58</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.0000058</pub-id>
        <pub-id pub-id-type="pmid">14624258</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Joy</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>McCloskey</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Poon</surname>
            <given-names>AFY</given-names>
          </name>
        </person-group>
        <article-title>Ancestral reconstruction</article-title>
        <source>PLoS Comput Biol</source>
        <year>2016</year>
        <volume>12</volume>
        <issue>7</issue>
        <fpage>e1004763</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004763</pub-id>
        <pub-id pub-id-type="pmid">27404731</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nei</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A new method of inference of ancestral nucleotide and amino acid sequences</article-title>
        <source>Genetics</source>
        <year>1995</year>
        <volume>141</volume>
        <issue>4</issue>
        <fpage>1641</fpage>
        <lpage>1650</lpage>
        <?supplied-pmid 8601501?>
        <pub-id pub-id-type="pmid">8601501</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koshi</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Goldstein</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Probabilistic reconstruction of ancestral protein sequences</article-title>
        <source>J Mol Evol Springer-Verlag</source>
        <year>1996</year>
        <volume>42</volume>
        <issue>2</issue>
        <fpage>313</fpage>
        <lpage>320</lpage>
        <pub-id pub-id-type="doi">10.1007/BF02198858</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elias</surname>
            <given-names>DI</given-names>
          </name>
          <name>
            <surname>Tuller</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Reconstruction of ancestral genomic sequences using likelihood</article-title>
        <source>J Comput Biol</source>
        <year>2007</year>
        <volume>14</volume>
        <issue>2</issue>
        <fpage>216</fpage>
        <lpage>237</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2006.0101</pub-id>
        <pub-id pub-id-type="pmid">17456016</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Herrero</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fitzgerald</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Beal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Flicek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide nucleotide-level mammalian ancestor reconstruction</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <issue>11</issue>
        <fpage>1829</fpage>
        <lpage>1843</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.076521.108</pub-id>
        <pub-id pub-id-type="pmid">18849525</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Diehl</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Boyle</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>Conserved and species-specific transcription factor co-binding patterns drive divergent gene regulation in human and mouse</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <issue>4</issue>
        <fpage>1878</fpage>
        <lpage>1894</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky018</pub-id>
        <pub-id pub-id-type="pmid">29361190</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Giribet</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <source>TNT: tree analysis using new technology</source>
        <year>2005</year>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wheeler</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Optimization alignment: the end of multiple sequence alignment in phylogenetics?</article-title>
        <source>Cladistics</source>
        <year>1996</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1096-0031.1996.tb00189.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Steel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>More taxa are not necessarily better for the reconstruction of ancestral character states. Oakley T, editor</article-title>
        <source>Syst Biol</source>
        <year>2008</year>
        <volume>57</volume>
        <issue>4</issue>
        <fpage>647</fpage>
        <lpage>653</lpage>
        <pub-id pub-id-type="doi">10.1080/10635150802203898</pub-id>
        <pub-id pub-id-type="pmid">18709600</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kluge</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Farris</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <source>Systematic zoology</source>
        <year>1969</year>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fitch</surname>
            <given-names>WM</given-names>
          </name>
        </person-group>
        <article-title>Toward defining the course of evolution: minimum change for a specific tree topology</article-title>
        <source>Syst Biol</source>
        <year>1971</year>
        <volume>20</volume>
        <issue>4</issue>
        <fpage>406</fpage>
        <lpage>416</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/20.4.406</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haeussler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zweig</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Tyner</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Speir</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Rosenbloom</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Raney</surname>
            <given-names>BJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The UCSC genome browser database: 2019 update</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>D853</fpage>
        <lpage>D858</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1095</pub-id>
        <pub-id pub-id-type="pmid">30407534</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Denas</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Sandstrom</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Beal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Herrero</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hardison</surname>
            <given-names>RC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide comparative analysis reveals human-mouse regulatory landscape and evolution</article-title>
        <source>BMC Genomics BioMed Central</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>87</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-015-1245-6</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Diehl</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Ouyang</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Boyle</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>Transposable elements contribute to cell and species-specific chromatin looping and gene regulation in mammalian genomes</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1796</fpage>
        <lpage>1718</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-15520-5</pub-id>
        <pub-id pub-id-type="pmid">32286261</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Petrov</surname>
            <given-names>DA</given-names>
          </name>
        </person-group>
        <article-title>DNA loss and evolution of genome size in drosophila</article-title>
        <source>Genetica</source>
        <year>2002</year>
        <volume>115</volume>
        <issue>1</issue>
        <fpage>81</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1016076215168</pub-id>
        <pub-id pub-id-type="pmid">12188050</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
