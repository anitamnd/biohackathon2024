<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2881389</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btq204</article-id>
    <article-id pub-id-type="publisher-id">btq204</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb 2010 Conference Proceedings July 11 to July 13, 2010, Boston, Ma, Usa</subject>
        <subj-group>
          <subject>Original Papers</subject>
          <subj-group>
            <subject>Population Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Estimating genome-wide IBD sharing from SNP data via an efficient hidden Markov model of LD with application to gene mapping</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bercovici</surname>
          <given-names>Sivan</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Meek</surname>
          <given-names>Christopher</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wexler</surname>
          <given-names>Ydo</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Geiger</surname>
          <given-names>Dan</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup> Technion-Israel Institute of Technology, Computer Science Department Haifa, 32000 Israel and <sup>2</sup> Microsoft Research, Redmond, WA 98052, USA</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>6</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>6</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>6</month>
      <year>2010</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>26</volume>
    <issue>12</issue>
    <fpage>i175</fpage>
    <lpage>i182</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2010. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2010</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Association analysis is the method of choice for studying complex multifactorial diseases. The premise of this method is that affected persons contain some common genomic regions with similar SNP alleles and such areas will be found in this analysis. An important disadvantage of GWA studies is that it does not distinguish between genomic areas that are inherited from a common ancestor [identical by descent (IBD)] and areas that are identical merely by state [identical by state (IBS)]. Clearly, areas that can be marked with higher probability as IBD and have the same correlation with the disease status of identical areas that are more probably only IBS, are better candidates to be causative, and yet this distinction is not encoded in standard association analysis.</p>
      <p><bold>Results:</bold> We develop a factorial hidden Markov model-based algorithm for computing genome-wide IBD sharing. The algorithm accepts as input SNP data of measured individuals and estimates the probability of IBD at each locus for every pair of individuals. For two g-degree relatives, when <italic>g</italic>≥8, the computation yields a precision of IBD tagging of over 50% higher than previous methods for 95% recall. Our algorithm uses a first-order Markovian model for the linkage disequilibrium process and employs a reduction of the state space of the inheritance vector from being exponential in <italic>g</italic> to quadratic. The higher accuracy along with the reduced time complexity marks our method as a feasible means for IBD mapping in practical scenarios.</p>
      <p><bold>Availability:</bold> A software implementation, called IBDMAP, is freely available at <ext-link ext-link-type="uri" xlink:href="http://bioinfo.cs.technion.ac.il/IBDmap">http://bioinfo.cs.technion.ac.il/IBDmap</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>sberco@gmail.com</email>
      </p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>Association analysis is the method of choice for studying complex multifactorial diseases with low penetrance. The basic idea is to compute a correlation between each measured SNP and the affection status, and then further study areas that contain SNPs with high scores. The premise of this method is that affected persons contain some common genomic regions with similar SNP alleles and such areas will be found in this analysis. The large number of tests (≥500 000) requires correction for multiple testing (Benjamini and Yekutieli, <xref ref-type="bibr" rid="B3">2005</xref>; Han <italic>et al.</italic>, <xref ref-type="bibr" rid="B21">2009</xref>; Peer <italic>et al.</italic>, <xref ref-type="bibr" rid="B35">2008</xref>). To capture the fact that dense SNPS are not independent, one can use various blocks of linked SNPs and find correlation to the blocks rather than to individual SNPs (Cardon and Abecasis, <xref ref-type="bibr" rid="B6">2003</xref>; Greenspan and Geiger, <xref ref-type="bibr" rid="B16">2004</xref>; Halperin <italic>et al.</italic>, <xref ref-type="bibr" rid="B20">2005</xref>). The main advantage of association analysis is that it can potentially identify small suspect areas provided that sufficiently many individuals are sampled.</p>
    <p>An important disadvantage of this method is that it does not distinguish between genomic areas that are inherited from a common ancestor [identical by descent (IBD)] and areas that are identical merely by state [identical by state (IBS)]. Clearly, areas that can be marked with higher probability as IBD and have the same correlation with the disease status of identical areas that are more probably only IBS, are better candidates to be causative, and yet this distinction is not encoded in standard association analysis.</p>
    <p>The popular P<sc>link</sc> program for association analysis, among its many functions, provides a method that challenges this common practice (Purcell <italic>et al.</italic>, <xref ref-type="bibr" rid="B36">2007</xref>). P<sc>link</sc> accepts SNP data of affected and healthy individuals, then infers the IBD areas for each pair and consequently uses a score (Equation <xref ref-type="disp-formula" rid="M6">6</xref>) to evaluate the extent to which a SNP is suspected to predispose or cause a disease. The input of this formula relies on inferring the IBD status of the SNP for each pair of input individuals. The inference is done via an hidden Markov model (HMM) with a small hidden state space that encodes the IBD status at the current locus using three states. The power of this mapping method highly depends on the precision of the IBD inference.</p>
    <p>Our work herein replaces the part of inferring IBD with an improved method using a more accurate HMM model with a state space that grows quadratically with the number of generations <italic>g</italic> that distinguish two individuals. We develop a factorial HMM-based algorithm for computing genome-wide IBD sharing. The algorithm accepts as input SNP data of measured individuals and estimates the probability of IBD at each locus for every pair of individuals. To estimate performance, we measure precision, which is the number of correctly identified IBD positions divided by the total number of position inferred as IBD, and recall, which is the number of correctly identified IBD positions divided by the number of IBD positions. For two <italic>g</italic>-degree relatives, when <italic>g</italic>≥8, the computation yields a precision of IBD tagging of over 50% higher than previous methods for 95% recall.</p>
    <p>Our algorithm uses a reduction of the state space of the inheritance vector used in M<sc>erlin</sc> from being exponential in <italic>g</italic> to quadratic and combines it with a first-order Markovian model for the linkage disequilibrium (LD) process. In essence, we apply sophisticated techniques from linkage analysis to genetic studies without pedigree input. The application of our method to gene mapping shows a noticeable improvement.</p>
    <p>The rest of this article is organized as follows. <xref ref-type="sec" rid="SEC2">Section 2</xref> defines HMMs and explains the inferences done with them. <xref ref-type="sec" rid="SEC3">Section 3</xref> provides background information regarding genetic analysis. <xref ref-type="sec" rid="SEC4">Section 4</xref> develops a model for LD and an appropriate inference procedure for it. <xref ref-type="sec" rid="SEC5">Section 5</xref> explicates the results for IBD inference and for gene mapping. Finally, <xref ref-type="sec" rid="SEC6">Section 6</xref> discusses limitations of current IBD inference procedures and future directions.</p>
  </sec>
  <sec id="SEC2">
    <title>2 HMM AND FACTORIAL HMM</title>
    <p>Consider a HMM (Rabiner and Juang, <xref ref-type="bibr" rid="B37">1986</xref>) with hidden variables <italic>S</italic><sub><italic>i</italic></sub> and observed variables <italic>X</italic><sub><italic>i</italic></sub>, <italic>i</italic> = 1,…, <italic>L</italic>, as described in Geiger <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2008</xref>. The (<italic>hidden</italic>) <italic>state space</italic> is the set <italic>S</italic> of possible values for <italic>S</italic><sub><italic>i</italic></sub>. The state space is identical for every slot <italic>i</italic>. The likelihood of data (<italic>x</italic><sub>1</sub>,…, <italic>x</italic><sub><italic>L</italic></sub>) for <italic>L</italic> slots is specified via two main components. The single slot likelihood of data <italic>P</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>s</italic><sub><italic>i</italic></sub>) at slot <italic>i</italic> given a state <italic>s</italic><sub><italic>i</italic></sub> for <italic>S</italic><sub><italic>i</italic></sub> and the transition probabilities <italic>P</italic>(<italic>S</italic><sub><italic>i</italic></sub> = <italic>s</italic><sub><italic>i</italic></sub>|<italic>S</italic><sub><italic>i</italic>−1</sub> = <italic>s</italic><sub><italic>i</italic>−1</sub>) from a state at slot <italic>i</italic> − 1 to slot <italic>i</italic>.
<disp-formula id="M1"><label>(1)</label><graphic xlink:href="btq204m1"/></disp-formula></p>
    <p>The time complexity of computing this sum grows quadratically with the size of the state space |<italic>S</italic>| and linearly in the number of slots <italic>L</italic>. The time complexity is <italic>O</italic>(<italic>L</italic>|<italic>S</italic>|<sup>2</sup> + <italic>cL</italic>|<italic>S</italic>|) where <italic>c</italic> is an upper bound for computing the single slot likelihood <italic>P</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>s</italic><sub><italic>i</italic></sub>). We note that in many HMM applications, including IBD sharing and linkage analysis, the goal is to also compute the marginal probabilities <italic>P</italic>(<italic>S</italic><sub><italic>i</italic></sub>|<italic>x</italic><sub>1</sub>,…, <italic>x</italic><sub><italic>L</italic></sub>) for all <italic>i</italic> = 1,…, <italic>L</italic> rather than to compute just the likelihood of data. This task can be completed using the junction-tree algorithm with only twice the computational cost (Lauritzen and Spiegelhalter, <xref ref-type="bibr" rid="B29">1988</xref>).</p>
    <p><italic>Factorial HMMs</italic> (Ghahramani and Jordan, <xref ref-type="bibr" rid="B15">1997</xref>) are HMMs in which the hidden variable is a vector <italic>S</italic><sub><italic>i</italic></sub> = (<italic>S</italic><sub><italic>i</italic></sub><sup>1</sup>,…, <italic>S</italic><sub><italic>i</italic></sub><sup><italic>k</italic></sup>) with values drawn from some Cartesian product <italic>H</italic><sub>1</sub> × … × <italic>H</italic><sub><italic>k</italic></sub> and with a transition probability defined component by component for <italic>i</italic> = 2,…, <italic>L</italic> via
<disp-formula id="M2"><label>(2)</label><graphic xlink:href="btq204m2"/></disp-formula>
and for the first slot, <italic>P</italic>(<italic>S</italic><sub>1</sub> = (<italic>s</italic><sub>1</sub><sup>1</sup>,…, <italic>s</italic><sub>1</sub><sup><italic>k</italic></sup>)) = ∏<sub><italic>j</italic>=1</sub><sup><italic>k</italic></sup><italic>P</italic><sub><italic>j</italic></sub>(<italic>s</italic><sub>1</sub><sup><italic>j</italic></sup>). In our application, each <italic>S</italic><sub><italic>i</italic></sub><sup><italic>j</italic></sup> is called a selector, and the vector <italic>S</italic><sub><italic>i</italic></sub> determines the inheritance pattern in the pedigree. We model the recombination probabilities as <italic>P</italic>(<italic>S</italic><sub><italic>i</italic></sub><sup><italic>j</italic></sup>|<italic>S</italic><sub><italic>i</italic>−1</sub><sup><italic>j</italic></sup>≠<italic>S</italic><sub><italic>i</italic></sub><sup><italic>j</italic></sup>) = 1 − <italic>e</italic><sup>−<italic>l</italic></sup>, where <italic>l</italic> is the genetic distance, in Morgans, between location <italic>i</italic> and <italic>i</italic> − 1.</p>
    <p>Factorial HMMs offer computational benefits when computing the likelihood of data. Ghahramani and Jordan (<xref ref-type="bibr" rid="B15">1997</xref>) Section 3.2 show how specifying the probabilities <italic>P</italic>(<italic>S</italic><sub><italic>i</italic></sub>|<italic>S</italic><sub><italic>i</italic>−1</sub>) via a product as in Equation <xref ref-type="disp-formula" rid="M2">2</xref> reduces the time complexity to <italic>O</italic>(<italic>L</italic>|<italic>S</italic>|log|<italic>S</italic>|+<italic>cL</italic>|<italic>S</italic>|). Their algorithm is a special case of bucket elimination (Dechter, <xref ref-type="bibr" rid="B9">1998</xref>). We note that computing the <italic>L</italic> marginal probabilities <italic>P</italic>(<italic>S</italic><sub><italic>i</italic></sub>|<italic>x</italic><sub>1</sub>,…, <italic>x</italic><sub><italic>L</italic></sub>) in a factorial HMM can also be performed with only twice the amount of computations using the junction-tree algorithm (Lauritzen and Spiegelhalter, <xref ref-type="bibr" rid="B29">1988</xref>).</p>
    <p>In applications, where <italic>S</italic> is possibly very large such as for linkage analysis where it grows exponentially in, roughly, the number of persons in the pedigree, the dominating factor |<italic>S</italic>|log|<italic>S</italic>| can be further reduced substantially if the state space <italic>S</italic> can be partitioned into equivalence classes [<italic>s</italic>] for which the likelihood of data is constant. This effectively changes the sum over the state space at each slot to a sum over equivalence classes. The dominating complexity will now depend on the number of equivalence classes rather than on the number of states in <italic>S</italic> (Browning and Browning, <xref ref-type="bibr" rid="B5">2002</xref>; Geiger <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2008</xref>; Markianos <italic>et al.</italic>, <xref ref-type="bibr" rid="B30">2001</xref>).</p>
    <p>The likelihood is computed for one representative of each equivalence class via
<disp-formula id="M3"><label>(3)</label><graphic xlink:href="btq204m3"/></disp-formula>
where the prior for a class [<italic>s</italic>] is the sum over the priors of its constituent states, namely, <italic>P</italic>([<italic>s</italic>]) = ∑<sub><italic>s</italic>∈[<italic>s</italic>]</sub><italic>P</italic>(<italic>s</italic>). Note that [<italic>s</italic><sub><italic>i</italic></sub>] is used to denote the class containing <italic>s</italic><sub><italic>i</italic></sub>, as in <italic>s</italic><sub><italic>i</italic></sub>∈[<italic>s</italic><sub><italic>i</italic></sub>], and also a representative from the class containing state <italic>s</italic><sub><italic>i</italic></sub>, as in <italic>S</italic><sub><italic>i</italic></sub> = [<italic>s</italic><sub><italic>i</italic></sub>].</p>
    <p>The equivalence of Equations <xref ref-type="disp-formula" rid="M1">1</xref> and <xref ref-type="disp-formula" rid="M3">3</xref> stems from two general conditions:
<list list-type="simple"><list-item><p>C<sc>ondition</sc> I. The single slot likelihood given a hidden state <italic>s</italic> is equal for all states in the equivalence class [<italic>s</italic>], namely, <italic>P</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>s</italic>) = <italic>P</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>s</italic>′) for all <italic>s</italic> and <italic>s</italic>′ in the same equivalence class. Hence, we can safely define the single slot likelihood given an equivalence class via <italic>P</italic>(<italic>x</italic><sub><italic>i</italic></sub>|[<italic>s</italic>]) = <italic>P</italic>(<italic>x</italic>|<italic>s</italic>).</p></list-item><list-item><p>C<sc>ondition</sc> II. Denote by <italic>P</italic>([<italic>s</italic>]|<italic>s</italic>′) = ∑<sub><italic>s</italic>∈[<italic>s</italic>]</sub><italic>P</italic>(<italic>s</italic>|<italic>s</italic>′) the transition probability from state <italic>s</italic>′ to an equivalence class [<italic>s</italic>]. The condition is that this transition probability does not distinguish between two states in the same equivalence class, namely, <italic>P</italic>([<italic>s</italic>]|<italic>s</italic>′) = <italic>P</italic>([<italic>s</italic>] |<italic>s</italic>″) for all <italic>s</italic>′ and <italic>s</italic>″ in the same equivalence class. Hence, we can safely define the transition probabilities between equivalence classes via <italic>P</italic>([<italic>s</italic>] | [<italic>s</italic>′]) = <italic>P</italic>([<italic>s</italic>]|<italic>s</italic>′).</p></list-item></list>
</p>
    <p>These two natural conditions are sufficient to ensure that Equations <xref ref-type="disp-formula" rid="M1">1</xref> and <xref ref-type="disp-formula" rid="M3">3</xref> are equivalent (Geiger <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2008</xref>).</p>
  </sec>
  <sec id="SEC3">
    <title>3 GENETIC ANALYSIS</title>
    <p>Genetic linkage and association analysis seek to locate genomic regions that are likely to contain genes that increase the probability of inheritable traits such as hereditary diseases. In the case of linkage analysis, the input are pedigrees of families that segregate a disease, genetic marker information such as SNP data and affection status of some or all family members. The main idea is that genetic markers that are found in the same vicinity on the chromosome are more likely to stay together during meiosis. Thus, based on the topology of the pedigree and the marker readings, it is possible to compute how likely it is for a predisposing gene to be located on the chromosome near each of the markers (Elston and Stewart, <xref ref-type="bibr" rid="B10">1971</xref>; Lander and Green, <xref ref-type="bibr" rid="B26">1987</xref>; Lange, <xref ref-type="bibr" rid="B27">1997</xref>; Ott, <xref ref-type="bibr" rid="B32">1999</xref>). Genetic association analysis shares the same goal of linkage analysis but uses a very different approach. The input to the basic design of association analysis is genetic marker data of affected individuals and of matched healthy controls. The output is a correlation, or more generally some score, relating marker data at specific genomic locations with the trait under study (Carlson <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2004</xref>; Halperin and Stephan, <xref ref-type="bibr" rid="B19">2009</xref>; Peer <italic>et al.</italic>, <xref ref-type="bibr" rid="B34">2006</xref>; Wang <italic>et al.</italic>, <xref ref-type="bibr" rid="B42">2005</xref>).</p>
    <p>There are pros and cons to these methods and both are used in countless number of mapping projects ranging from single gene rare Mendelian diseases to common complex diseases that are caused by an array of genetic, behavioral, environmental and other factors. Genetic linkage analysis is very successful in underpinning Mendelian diseases with high penetrance; there are hundreds of successfully verified discoveries using linkage. For such studies, a sparse array of genetic markers is needed to reach a valid conclusion–around 6000 SNP genome-wide at an average distance of 0.5 M base pairs. With such distance, the alleles of the founders of the pedigree can be considered to be independent, that is in <italic>linkage equilibrium</italic>, and this assumption is used in the standard model of linkage analysis. The strength of linkage analysis is the identification of stretches of SNPs that are more often passed from affected persons to affected offspring than to non-affected offspring. Such stretches have high likelihood of odds (LOD) to contain a predisposing or causative gene.</p>
    <p>There are several scoring methods commonly used for linkage analysis. They differ in how the scoring function depends on the probability of the possible inheritance patterns in the pedigree. Examples of such functions are <italic>S</italic><sub>all</sub>, <italic>S</italic><sub>pairs</sub> and LOD scores (Kruglyak <italic>et al.</italic>, <xref ref-type="bibr" rid="B25">1996</xref>). As the number of such inheritance patterns grows exponentially in the number of markers and roughly in the number of persons in the pedigree, computationally sophisticated methods were proposed for this task. A common structure shared by most exact scoring methods is a HMM (Rabiner and Juang, <xref ref-type="bibr" rid="B37">1986</xref>) backbone, which is in fact a Factorial HMM with a state space defined by a set of variables <italic>S</italic><sub><italic>i</italic></sub> called selectors that determine the inheritance pattern in the pedigree (Abecasis <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2002</xref>; Gudbjartsson <italic>et al.</italic>, <xref ref-type="bibr" rid="B17">2005</xref>, <xref ref-type="bibr" rid="B18">2000</xref>; Ingolfsdottir and Gudbjartsson, <xref ref-type="bibr" rid="B22">2005</xref>; Kruglyak and Lander, <xref ref-type="bibr" rid="B23">1998</xref>; Kruglyak <italic>et al.</italic>, <xref ref-type="bibr" rid="B24">1995</xref>, <xref ref-type="bibr" rid="B25">1996</xref>; Lander and Green, <xref ref-type="bibr" rid="B26">1987</xref>; Markianos <italic>et al.</italic>, <xref ref-type="bibr" rid="B30">2001</xref>). Other techniques based, sometimes implicitly, on Bayesian networks (Lauritzen, <xref ref-type="bibr" rid="B28">1996</xref>; Pearl, <xref ref-type="bibr" rid="B33">1988</xref>) focus on larger pedigrees with fewer measurements (Cottingham <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">1993</xref>; Elston and Stewart, <xref ref-type="bibr" rid="B10">1971</xref>; Fishelson and Geiger, <xref ref-type="bibr" rid="B12">2002</xref>; O'Connell and Weeks, <xref ref-type="bibr" rid="B31">1995</xref>; Silberstein <italic>et al.</italic>, <xref ref-type="bibr" rid="B39">2006</xref>; Sobel and Lange, <xref ref-type="bibr" rid="B40">1996</xref>; Thompson, <xref ref-type="bibr" rid="B41">1994</xref>).</p>
    <p>The main computer programs that analyze pedigrees with SNP data are G<sc>enehunter</sc>, A<sc>llegro</sc> and M<sc>erlin</sc> (Abecasis <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2002</xref>; Gudbjartsson <italic>et al.</italic>, <xref ref-type="bibr" rid="B18">2000</xref>; Markianos <italic>et al.</italic>, <xref ref-type="bibr" rid="B30">2001</xref>). Due to the increasing number of markers on standard SNP panels, these programs basically use the same HMM model employing the forward–backward algorithm as developed by Lander and Green (<xref ref-type="bibr" rid="B26">1987</xref>) in their seminal work in this area. The differences lie in the details of how transition matrices are represented and multiplied, and how the emission probabilities are computed, both of which can dramatically affect the time complexity of the forward–backward algorithm.</p>
    <p>In several works (Kruglyak and Lander, <xref ref-type="bibr" rid="B23">1998</xref>; Kruglyak <italic>et al.</italic>, <xref ref-type="bibr" rid="B24">1995</xref>, <xref ref-type="bibr" rid="B25">1996</xref>) with increasingly better methods for multiplying a vector by the specialized form of the transmission matrix <italic>P</italic>(<italic>S</italic><sub><italic>i</italic></sub>|<italic>S</italic><sub><italic>i</italic>−1</sub>) used in this application, of size <italic>N</italic> × <italic>N</italic>, complexity of multiplication dropped to <italic>N</italic> log <italic>N</italic> and the effective size of <italic>N</italic> dropped to <italic>N</italic>′ by considering symmetries in the transition matrix. For certain pedigrees, this drop is exponential in the number of persons decreasing <italic>N</italic> from 2<sup>2<italic>n</italic></sup> to 2<sup>2<italic>n</italic>−<italic>f</italic></sup> and for some pedigrees to 2<sup>2<italic>n</italic>−<italic>f</italic>−<italic>c</italic></sup> where <italic>n</italic> is the number of non-founders in the pedigree, <italic>f</italic> is the number of founders and <italic>c</italic> is the number of first grandchildren whose grandparents are all founders in the pedigree (Markianos <italic>et al.</italic>, <xref ref-type="bibr" rid="B30">2001</xref>). Further exponential reductions of the state space for special pedigrees such as pedigrees that contain long chains are also available (Browning and Browning, <xref ref-type="bibr" rid="B5">2002</xref>; Geiger <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2008</xref>).</p>
    <p>Other works (Abecasis <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2002</xref>; Gudbjartsson <italic>et al.</italic>, <xref ref-type="bibr" rid="B17">2005</xref>, <xref ref-type="bibr" rid="B18">2000</xref>) improved the representation and computation of the emission probabilities, namely, the probability of data at slot <italic>i</italic> given the state at slot <italic>i</italic>. There are two factors that make this computation demanding. First, to compute the probability <italic>P</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>s</italic><sub><italic>i</italic></sub>) for a specific state <italic>s</italic><sub><italic>i</italic></sub> requires to sum over all possible assignments of alleles <italic>f</italic><sub><italic>i</italic></sub> to the founders in the pedigree, namely,
<disp-formula id="M4"><label>(4)</label><graphic xlink:href="btq204m4"/></disp-formula>
A naive approach will be exponential in the number of founders in the pedigree that are not genotyped, but Sobel and Lange (<xref ref-type="bibr" rid="B40">1996</xref>) managed to use the conditional independence fact that once a state <italic>s</italic><sub><italic>i</italic></sub> is given, only the alleles of a few founders determines <italic>P</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>s</italic><sub><italic>i</italic></sub>, <italic>f</italic><sub><italic>i</italic></sub>). Using what they termed descend trees, they compute <italic>P</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>s</italic><sub><italic>i</italic></sub>) in polynomial time for every single state <italic>s</italic><sub><italic>i</italic></sub>. Still, to compute this likelihood for every <italic>s</italic><sub><italic>i</italic></sub> requires repeating this operation 2<sup>|<italic>S</italic>|</sup> times, which often grows too large. The modern software packages M<sc>erlin</sc> and A<sc>llegro</sc> both decrease the magnitude of this problem by reusing computations from one state to another and the fact that after a partial vector of <italic>s</italic><sub><italic>i</italic></sub> is known, the remaining component of the state do not change the computation of <italic>P</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>s</italic><sub><italic>i</italic></sub>). These improvements still leave the worst case time complexity unchanged, but in practice considerably reduce the run time. We refer to the resulting factorial HMM that we just described (Equations <xref ref-type="disp-formula" rid="M1">1</xref> and <xref ref-type="disp-formula" rid="M2">2</xref>) as the <italic>standard model</italic>.</p>
    <p>The standard model has some clear deviations from reality. First, it assumes that the pedigree is known with certainty, which often is not the case. Second, it assumes that the hidden states are first-order Markovian, which means in genetics language, that a recombination event at slot <italic>i</italic> (encoded as <italic>s</italic><sup><italic>j</italic></sup><sub><italic>i</italic></sub> ≠ <italic>s</italic><sup><italic>j</italic></sup><sub><italic>i</italic>+1</sub>) is independent of a recombination event at the previous slot (encoded as <italic>s</italic><sup><italic>j</italic></sup><sub><italic>i</italic>−1</sub> ≠ <italic>s</italic><sup><italic>j</italic></sup><sub><italic>i</italic></sub>), which does not hold for close markers; the violation of this assumption is termed <italic>chiasma interference</italic>. A third assumption is that the two alleles for each founder are independent of each other; this assumption is called the Hardy–Weinberg equilibrium. A fourth and final assumption of the standard HMM model for linkage analysis is that the founder's alleles at slot <italic>i</italic> do not depend on the founder's alleles at slot <italic>i</italic> − 1, hence <italic>P</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>s</italic><sub><italic>i</italic></sub>) can be written as ∑<sub><italic>f</italic></sub> <italic>P</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>s</italic><sub><italic>i</italic></sub>, <italic>f</italic><sub><italic>i</italic></sub>)<italic>P</italic>(<italic>f</italic><sub><italic>i</italic></sub>) at each slot where <italic>P</italic>(<italic>f</italic><sub><italic>i</italic></sub>) is the prior probability of the founder alleles. This assumption, which does not hold for close markers, is called <italic>linkage equilibrium</italic>.</p>
    <p>The dependency between alleles of nearby markers is called <italic>LD</italic> (Purcell <italic>et al.</italic>, <xref ref-type="bibr" rid="B36">2007</xref>). Our main contribution in this article is to model LD within the HMM framework, improving accuracy of inference, and still perform the forward–backward algorithm sufficiently fast for some common pedigree structures. In the experimental section, we show the improvement of accuracy as a result of modeling LD.</p>
  </sec>
  <sec id="SEC4">
    <title>4 MODELING LD AND INFERRING IBD</title>
    <p>When markers become closer, and therefore dependent, a stretch of SNPs that was inferred to be inherited as a block by affected individuals and thus have high LOD score can actually be only IBS rather than IBD. In other words, the stretch of SNPs shared by some affected individuals has not been inherited from a single source by inheritance (IBD), but inherited from multiple sources which happen to be the same (IBS). For example, a stretch of n independent markers with allele A have a probability <italic>p</italic><sub><italic>A</italic>,1</sub>·<italic>p</italic><sub><italic>A</italic>,2</sub>·…·<italic>p</italic><sub><italic>A</italic>,<italic>n</italic></sub> while due to LD it is possible that only a handful of the 2<sup><italic>n</italic></sup> possible allele assignments is possible, say in the extreme case only <italic>AA</italic>…<italic>A</italic> and <italic>BB</italic>…<italic>B</italic> are possible. In such case a LOD score that does not take LD into account is inflated and increases type I error, weakening the power to differentiate true signals from false ones. Consequently, as denser maps of SNPs are used in genetic analysis, modeling the effects of LD becomes increasingly important.</p>
    <p>The availability of denser and denser SNP panels weakens the validity of the assumption of linkage equilibrium; almost every two nearby markers are dependent. M<sc>erlin</sc> is an efficient linkage program that allows the modeling of LD. Furthermore, M<sc>erlin</sc>'s developers provide a clear example that indicates the benefits of some type of models for LD for genetic analysis, showing how two loci are found related to a disease when ignoring LD, while only one locus remains suspect when LD is taken into account (Abecasis and Wigginton, <xref ref-type="bibr" rid="B1">2005</xref>). M<sc>erlin</sc>'s method consists of the following steps: cluster nearby SNPs, yielding a single marker with more than two alleles, specify the prior of each of the cluster's alleles using EM or some data set such as HapMap (Frazer <italic>et al.</italic>, <xref ref-type="bibr" rid="B13">2007</xref>), and finally, use the new markers as input to the standard (HMM) model. The assumptions underlying this solution are that there are no recombinations within the selected clusters and that there is no dependency between clusters. We now develop an alternative to this approach that does not make these assumptions.</p>
    <p>For the task of adding LD to the model, consider an HMM with hidden variables <italic>S</italic><sub><italic>i</italic></sub> and <italic>F</italic><sub><italic>i</italic></sub> and observed variables <italic>X</italic><sub><italic>i</italic></sub>, <italic>i</italic> = 1,…, <italic>L</italic>. The state space is now the set <italic>S</italic> × <italic>F</italic> of possible values for <italic>S</italic><sub><italic>i</italic></sub> × <italic>F</italic><sub><italic>i</italic></sub>, where <italic>F</italic><sub><italic>i</italic></sub> are founder alleles at slot <italic>i</italic>. The state space is identical for every slot <italic>i</italic>. The single slot likelihood of data <italic>P</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>s</italic><sub><italic>i</italic></sub>, <italic>f</italic><sub><italic>i</italic></sub>) at slot <italic>i</italic> is given for every state (<italic>s</italic><sub><italic>i</italic></sub>, <italic>f</italic><sub><italic>i</italic></sub>) and the transition probabilities from a state at slot <italic>i</italic> − 1 to slot <italic>i</italic> have the product form
<disp-formula><graphic xlink:href="btq204um1"/></disp-formula>
Further factorization of the transition matrix is given by
<disp-formula id="M5"><label>(5)</label><graphic xlink:href="btq204m5"/></disp-formula>
and for the first slot, <italic>P</italic>(<italic>f</italic><sub>1</sub> = (<italic>f</italic><sub>1</sub><sup>1</sup>,…, <italic>f</italic><sub>1</sub><sup><italic>k</italic></sup>)) = ∏<sub><italic>j</italic>=1</sub><sup><italic>k</italic></sup> <italic>P</italic><sub><italic>j</italic></sub>(<italic>f</italic><sub>1</sub><sup><italic>j</italic></sup>). A similar factorization is assumed also for <italic>P</italic>(<italic>s</italic><sub><italic>i</italic></sub>|<italic>s</italic><sub><italic>i</italic>−1</sub>) as given by Equation <xref ref-type="disp-formula" rid="M2">2</xref>. We refer to the factorial HMM represented by Equations <xref ref-type="disp-formula" rid="M2">2</xref> and <xref ref-type="disp-formula" rid="M5">5</xref> as the <italic>full model</italic>.</p>
    <p>We note that if every <italic>f</italic><sub><italic>i</italic></sub> is independent of <italic>f</italic><sub><italic>i</italic>−1</sub>, then the full model reduces to the standard model described in the previous section by setting <italic>P</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>s</italic><sub><italic>i</italic></sub>) = ∑<sub><italic>f</italic></sub> <italic>P</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>s</italic><sub><italic>i</italic></sub>, <italic>f</italic><sub><italic>i</italic></sub>) <italic>P</italic>(<italic>f</italic><sub><italic>i</italic></sub>). In our genetics application, <italic>f</italic><sub><italic>i</italic></sub> represents alleles of the founders at slot <italic>i</italic>, and <italic>f</italic><sub><italic>i</italic></sub> being independent of <italic>f</italic><sub><italic>i</italic>−1</sub> means that there is linkage equilibrium between the markers at slot <italic>i</italic> and <italic>i</italic> − 1. Hence, the full model generalizes the standard model by encoding LD via <italic>P</italic>(<italic>f</italic><sub><italic>i</italic></sub>|<italic>f</italic><sub><italic>i</italic>−1</sub>). These conditional probability tables, which we call <italic>LD terms</italic>, are estimated directly from data sets such as HapMap that provides sets of haplotypes.</p>
    <p>We have experimented with an implementation of the model and report the results in the experimental section. There is an increase of precision in all experiments with respect to current software for IBD sharing. However, the full model has a significantly higher computational complexity than the standard model that severely limits the applicability to specific pedigree topologies. The source of increased time complexity stems mainly from the increase of the hidden state space from <italic>S</italic> to <italic>H</italic> = <italic>S</italic> × <italic>F</italic>. The magnitude of this increment depends on the relative size of <italic>F</italic> versus <italic>S</italic> which depends strongly on the pedigree topology. For example, a pedigree that consists of two parents and <italic>c</italic> children has a state space size of the order <italic>S</italic> = <italic>O</italic>(2<sup><italic>c</italic></sup>) while <italic>F</italic> is a constant of size 16. Hence for a nuclear family with many children, the increase of the state space can be acceptable. On the other hand, for <italic>g</italic>-degree relatives pedigree the state space without LD is <italic>O</italic>(2<sup>2<italic>g</italic></sup>), while the state space with LD grows to <italic>O</italic>(2<sup>6<italic>g</italic></sup>) because each founder <italic>F</italic><sub><italic>i</italic></sub> and <italic>F</italic>′<sub><italic>i</italic></sub> adds two LD terms to the standard model, one for each founder allele. See <xref ref-type="fig" rid="F1">Figure 1</xref> for an illustration. Notably, the full model is still a factorial HMM and therefore, the forward–backward algorithm has a matrix multiplication complexity of <italic>O</italic>(|<italic>H</italic>|log|<italic>H</italic>|) rather than <italic>O</italic>(|<italic>H</italic>|<sup>2</sup>), which means that it can run for small pedigrees such as nuclear families or small three generation family pedigrees. Such families are often used in genetics studies. Consequently, since the full model exhibits some improvement in precision, it should be used whenever possible.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Two slots of the <italic>g</italic>-degree relatives pedigree, where each node represents an individual at a specific location. The last generation is genotyped (measured). The full model has in addition two LD terms between the founder <italic>F</italic><sub><italic>i</italic></sub> in one slot and <italic>F</italic><sub><italic>i</italic></sub> in the next slot, for every founder in the pedigree. For clarity, these links are not shown. The model drawn has one LD term for each of the common founder B's alleles, and one additional LD term for each of the founders <italic>F</italic><sub><italic>g</italic></sub> and <italic>F</italic><sup>′</sup><sub><italic>g</italic></sub>.</p></caption><graphic xlink:href="btq204f1"/></fig></p>
    <p>The time complexity of the full model increases significantly with larger pedigrees, because the factorial HMM is augmented with an LD term <italic>P</italic>(<italic>f</italic><sup><italic>j</italic></sup><sub><italic>i</italic></sub>|<italic>f</italic><sup><italic>j</italic></sup><sub><italic>i</italic>−1</sub>) for every allele for every founder in the pedigrees. However, since this addition burdens the computations, one can settle with modeling the LD only between a subset of founders. Major reduction of the running time can be achieved using this approximation. In this article we focus on the <italic>g</italic>-degree relatives model with two LD terms for the single common founder and a single LD term for each of the two direct parents of the typed individuals. We term this model the <italic>4-track</italic> model, reflecting the fact that four LD chains are retained from the full model. We further call the model containing only two LD terms for the single common founder the <italic>2-track</italic> model.</p>
    <p>The size of the hidden state space for the 4-track model is <italic>O</italic>(2<sup>2<italic>g</italic></sup>), which yields exponential time and space requirements. We now describe a reduction of the state space to <italic>O</italic>(<italic>g</italic><sup>2</sup>) such that the likelihood computed in the 4-track model is identical to the likelihood computed when the state space is reduced. The ideas that lead to this major reduction of time and space complexity are based on Geiger <italic>et al.</italic> (<xref ref-type="bibr" rid="B14">2008</xref>), where we analyzed the <italic>g</italic>-degree relatives models without modeling LD. The state space reductions are formed by clustering the selectors <italic>S</italic><sub><italic>i</italic></sub> and partitioning the states of each cluster so that Conditions I and II, stated in <xref ref-type="sec" rid="SEC2">Section 2</xref>, are satisfied.</p>
    <p>We first define a class of clusters that satisfies Condition II and then make a specific choice within this class that also satisfies Condition I. A selector <italic>S</italic> can have two complement states: <sc>on</sc> and <sc>off</sc>. For a cluster <italic>C</italic> with <italic>r</italic> such selectors, a state [<italic>j</italic>] of the reduced state space of <italic>C</italic> is the equivalence class that contains all vectors of size <italic>r</italic> that have <italic>j</italic> entries being <sc>on</sc> and <italic>r</italic> − <italic>j</italic> being <sc>off</sc>. So, we have <italic>c</italic>(<italic>j</italic>, <italic>r</italic>) = <italic>r</italic>!/<italic>j</italic>!(<italic>r</italic> − <italic>j</italic>)! vectors in state [<italic>j</italic>] for <italic>j</italic> = 0,…, <italic>r</italic>. This set of <italic>r</italic> + 1 equivalent classes is called the <italic>counting partition</italic>.</p>
    <p>For the counting partition, the transition probability <italic>P</italic>([<italic>i</italic>]|<italic>c</italic><sub><italic>j</italic></sub>) for switching from a state <italic>c</italic><sub><italic>j</italic></sub> of <italic>C</italic> with <italic>j</italic> positions <sc>on</sc> to any one state with <italic>i</italic> positions <sc>on</sc> is specified below. Let θ be the probability of switching from state <sc>on</sc> to state <sc>off</sc> and of switching from state <sc>off</sc> to state <sc>on</sc>. The other two transitions have probability 1 − θ. The probability of switching from a state <italic>c</italic><sub><italic>j</italic></sub>, where <italic>j</italic> selectors are <sc>on</sc> to the state [<italic>i</italic>] in which some arbitrary <italic>i</italic> selectors are <sc>on</sc>, is given by
<disp-formula><graphic xlink:href="btq204um2"/></disp-formula>
<disp-formula><graphic xlink:href="btq204um3"/></disp-formula>
where <italic>t</italic> is the number of selectors that are <sc>on</sc> both in [<italic>i</italic>] and in state <italic>c</italic><sub><italic>j</italic></sub>, ranging from <italic>max</italic>(0, <italic>i</italic>+<italic>j</italic> − <italic>r</italic>) to min(<italic>i</italic>, <italic>j</italic>). With these transition probabilities, the next theorem states that the reduced state space satisfies Condition II.</p>
    <statement>
      <title>T<sc>heorem</sc> 1.</title>
      <p><italic>Let S</italic> = (<italic>S</italic><sup>1</sup>,…, <italic>S</italic><sup><italic>k</italic></sup>) <italic>be a vector of selectors and let</italic> 𝒞 = {<italic>C</italic><sub>1</sub>,…, <italic>C</italic><sub><italic>m</italic></sub>} <italic>be a set of disjoint clusters with r</italic><sub>1</sub>,…, <italic>r</italic><sub><italic>m</italic></sub> <italic>selectors, respectively, in each cluster, where k</italic> = ∑<sub><italic>j</italic>=1</sub><sup><italic>m</italic></sup> <italic>r</italic><sub><italic>j</italic></sub>. <italic>Then a factorial HMM in which the hidden variable has values drawn from the Cartesian product</italic> [𝒞] = [<italic>C</italic><sub>1</sub>]× ··· ×[<italic>C</italic><sub><italic>m</italic></sub>] × <italic>F</italic>, <italic>where F is some fixed state space</italic>, [<italic>C</italic><sub><italic>l</italic></sub>] <italic>is the set of equivalence classes of cluster C</italic><sub><italic>l</italic></sub> <italic>generated by using the counting partition, satisfies Condition II</italic>.</p>
    </statement>
    <p>This theorem has been stated and proven in Geiger <italic>et al.</italic> (<xref ref-type="bibr" rid="B14">2008</xref>) for the case <italic>F</italic> = ∅, namely, when no LD terms are included. Since the model is a factorial HMM and <italic>F</italic> is part of the transition probability that does not change in the reductions, the proof given earlier for <italic>F</italic> = ∅ still holds verbatim, and Condition II holds for counting partitions also when some or all the LD links are added to the standard model. The theorem holds for models of arbitrary pedigrees.</p>
    <p>Satisfying also Condition I requires limiting the way we cluster selectors. For the g-degree relatives pedigree, the 4-track model includes a set of selectors along the chain of inheritance to one individual, and a chain of selectors of the same length to the other individual.</p>
    <statement>
      <title>T<sc>heorem</sc> 2.</title>
      <p><italic>Consider the 4-track model for g-degree relatives. Let S</italic><sub><italic>a</italic></sub> = (<italic>S</italic><sub><italic>a</italic></sub><sup>0</sup>,…, <italic>S</italic><sub><italic>a</italic></sub><sup><italic>g</italic></sup>) <italic>be a vector of selectors for the first chain and let S</italic><sub><italic>b</italic></sub> = (<italic>S</italic><sub><italic>b</italic></sub><sup>0</sup>,…, <italic>S</italic><sub><italic>b</italic></sub><sup><italic>g</italic></sup>) <italic>be a vector of selectors for the second chain in this model. Let S</italic><sub><italic>a</italic></sub><sup><italic>C</italic></sup> <italic>be a binary variable with a value</italic> <sc>on</sc> <italic>if S</italic><sub><italic>a</italic></sub><sup><italic>i</italic></sup> = <sc>on</sc> <italic>for i</italic> = 1,…, <italic>g</italic>, <italic>and a value</italic> <sc>off</sc> <italic>if S</italic><sub><italic>a</italic></sub><sup><italic>i</italic></sup> = <sc>off</sc> <italic>for at least some i</italic>, 1 ≤ <italic>i</italic> ≤ <italic>g</italic>. <italic>Let S</italic><sub><italic>b</italic></sub><sup><italic>C</italic></sup> <italic>defined similarly w.r.t. the second chain. Then the likelihood of SNP data at each slot is determined by S</italic><sub><italic>a</italic></sub><sup><italic>C</italic></sup>,<italic>S</italic><sub><italic>a</italic></sub><sup>0</sup>, <italic>S</italic><sub><italic>b</italic></sub><sup><italic>C</italic></sup>, <italic>S</italic><sub><italic>b</italic></sub><sup>0</sup>, <italic>the founder alleles f</italic><sup>1</sup>, <italic>f</italic><sup>2</sup>, <italic>f</italic><sup>3</sup>, <italic>f</italic><sup>4</sup> <italic>and the prior allele distribution</italic>.</p>
    </statement>
    <statement>
      <title>P<sc>roof</sc>.</title>
      <p>The proof analyzes all possible assignments to the selectors in the 4-track model and shows that all <italic>O</italic>(2<sup>2<italic>g</italic></sup>) assignments map into the 16 possibilities defined by the four binary variables <italic>S</italic><sub><italic>a</italic></sub><sup><italic>C</italic></sup>, <italic>S</italic><sub><italic>a</italic></sub><sup>0</sup>, <italic>S</italic><sub><italic>b</italic></sub><sup><italic>C</italic></sup> and <italic>S</italic><sub><italic>b</italic></sub><sup>0</sup>. The data consists of four alleles, two for each individual. Each individual receives one allele from the parent not on the chain to the common ancestor, namely <italic>f</italic><sup>3</sup> and <italic>f</italic><sup>4</sup>. In addition, each individual receives the second allele either from the common founder or from another founder off the chain of inheritance.</p>
      <p>A state (<italic>s</italic><sub><italic>i</italic></sub>, <italic>f</italic><sub><italic>i</italic></sub>) is <italic>consistent</italic> with the data <italic>x</italic><sub><italic>i</italic></sub> if the inheritance defined by state <italic>s</italic><sub><italic>i</italic></sub> connects each measured allele to a founder allele that equals to it, or to an allele of a founder who is off the chain of inheritance. Out of the four measured alleles, <italic>N</italic> = 0, 1, 2 are inherited from the set {<italic>f</italic><sup>1</sup>, <italic>f</italic><sup>2</sup>} — the common founder's alleles. Let <italic>p</italic><sub>1</sub>,…<italic>p</italic><sub>4</sub> be the marginal probabilities of the four measured allele. The probability of data is 0 if the state is not consistent with the data. Otherwise, the probability of the data is a function of these four marginals. Since consistency and the number of shared alleles <italic>N</italic> is determined by <italic>S</italic><sub><italic>a</italic></sub><sup><italic>C</italic></sup>, <italic>S</italic><sub><italic>a</italic></sub><sup>0</sup>, <italic>S</italic><sub><italic>b</italic></sub><sup><italic>C</italic></sup>, <italic>S</italic><sub><italic>b</italic></sub><sup>0</sup>, <italic>f</italic><sup>1</sup>,…, <italic>f</italic><sup>4</sup>, so is the probability of data. ▪</p>
    </statement>
    <p>The next theorem summarizes the main claim.</p>
    <statement>
      <title>T<sc>heorem</sc> 3.</title>
      <p><italic>The likelihood computed in the 4-track model with and without the state space reduction are identical. The time complexity is O</italic>(<italic>g</italic><sup>2</sup>log<italic>g</italic>).</p>
    </statement>
    <statement>
      <title>P<sc>roof</sc>.</title>
      <p>We have shown that the state space reductions for the 4-track model satisfy Conditions I and II. Consequently, the likelihood computed in the 4-track model is identical to the likelihood computed with the reduced state space. The time complexity of multiplication for factorial HMM is given by <italic>O</italic>(|<italic>H</italic>| log|<italic>H</italic>|) where <italic>H</italic> is the domain of the hidden state space. Here <italic>H</italic> = 2<sup>4</sup> × <italic>g</italic> × <italic>g</italic>, yielding the claimed complexity. ▪</p>
    </statement>
    <p>Similar results also hold for arbitrary pedigrees by adding any subset of LD links to the standard model. The statement and proof of the most general claim requires several definitions and a lengthy derivation that are beyond the scope of this article. However, the arguments follow closely the line of reasoning pursued in Geiger <italic>et al.</italic> (<xref ref-type="bibr" rid="B14">2008</xref>). Using that paper's terminology, the definition of a chain needs a slight adjustment. Each chain must now be split to two chains at each individual for which an LD term is added. That paper explains how the state space reductions are formed and, using the revised definition of a chain, the arguments for correctness change only slightly. We refer the reader to Geiger <italic>et al.</italic> (<xref ref-type="bibr" rid="B14">2008</xref>) for details.</p>
  </sec>
  <sec id="SEC5">
    <title>5 EXPERIMENTAL RESULTS</title>
    <p>We divide the experiments into two main components. First, we demonstrate the improvements in the IBD inference precision using simulated data. We compare our results to the standard programs M<sc>erlin</sc> and P<sc>link</sc>. Second, we apply the association mapping technique offered by P<sc>link</sc>, which uses inferred IBD status to score genome loci as suspect areas for predisposing genes. We show that the increased IBD inference accuracy gained using our method improves the performance in the task of gene mapping. The higher precision of our method when inferring IBD status is well illustrated in <xref ref-type="fig" rid="F2">Figure 2</xref>. Each point is the average of 100 runs. The data was simulated as follows. We used a pedigree representing a pair of <italic>g</italic>-degree relatives and their ancestors (as depicted in <xref ref-type="fig" rid="F1">Fig. 1</xref>). Haplotype data of the founders were randomly sampled from HapMap's CEPH (Utah residents with ancestry from northern and western Europe) set of phased individuals. We simulated the offspring along the chain of inheritance using the corresponding pedigree topology and recombination probabilities <italic>P</italic>(<italic>S</italic><sub><italic>i</italic></sub>|<italic>S</italic><sub><italic>i</italic>−1</sub>). Both P<sc>link</sc> and M <sc>erlin</sc> were applied using default parameters and the original marker set used in simulations. As both models assume that markers are independent, we further evaluated the performance of these two methods on a reduced marker set that accommodates this linkage equilibrium assumption. The markers were selected by applying P<sc>link</sc>'s VIF (Variance Inflation Factor) pruning, with the recommended setting.
<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>The 4-track model achieves a significantly higher precision in comparison to the other methods under most tested scenarios, increasing the performance gap for <italic>g</italic>≥8 with over 50% improvement. Results correspond to over 95% recall for the 4-track model, and a lower recall for P<sc>link</sc> and M<sc>erlin</sc>.</p></caption><graphic xlink:href="btq204f2"/></fig></p>
    <p>The precision values shown in <xref ref-type="fig" rid="F2">Figure 2</xref> are for recall of approximately 95%. The results indicate that the 4-track model is superior to previous methods in terms of precision, except for M<sc>erlin</sc> when <italic>g</italic> = 7, while maintaining a higher recall rate in all the examined cases. Namely, the recall of the 4-track model was above 95% in all reported results, whereas previous models had at most 95% recall and often lower. All methods deteriorate as a function of <italic>g</italic>, but the 4-track model deteriorates slower than others. As expected, pruning markers in linkage disequilibrium improves the performance of both P<sc>link</sc> and M<sc>erlin</sc> (denoted by <italic>Equilibrium</italic> in the graph).</p>
    <p>As an extreme example, we consider data simulated with <italic>g</italic> = 30. The ability to apply our program successfully to such data means that one can hope to identify common genomic areas of individuals that have a common ancestor ∼700 years ago, around the population bottleneck event caused by the black death that killed approximately half of Europe's population. When using the 2-track model, and assuming <italic>g</italic> = 10 during the inference, IBD<sc>map</sc> achieves a precision of 35% for a recall of 85% and a precision of 47% for a recall of 75%. This configuration was used to expedite the results.</p>
    <p>The second step of our experiments has been aimed at examining the extent of improvement in gene mapping techniques as a result of the increased precision in IBD inference. The program P<sc>link</sc>, among many other functions, accepts SNP data of affected individuals, then infers the IBD areas for each pair and consequently uses the following formula to score to what extent an SNP is suspected to predispose or cause a disease:
<disp-formula id="M6"><label>(6)</label><graphic xlink:href="btq204m6"/></disp-formula>
where <italic>N</italic><sup><italic>aa</italic></sup> and <italic>N</italic><sup>!<italic>aa</italic></sup> represent the number of pairs of affected and unaffected individuals, respectively, and <italic>M</italic><sub><italic>i</italic></sub><sup><italic>aa</italic></sup> and <italic>M</italic><sub><italic>i</italic></sub><sup>!<italic>aa</italic></sup> represent the number of pairs with IBD at marker <italic>i</italic> that are both affected or where at least one of the pair is unaffected, respectively (Purcell <italic>et al.</italic>, <xref ref-type="bibr" rid="B36">2007</xref>). The terms <inline-formula><inline-graphic xlink:href="btq204i1.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="btq204i2.jpg"/></inline-formula> are the averages of <italic>M</italic><sub><italic>i</italic></sub><sup><italic>aa</italic></sup> and <italic>M</italic><sub><italic>i</italic></sub><sup>!<italic>aa</italic></sup>. The input of this formula relies on the inferred IBD status of an SNP for each pair of input individuals. Our test replaces the IBD inference mechanism and plots the resulting score. We simulated data from <italic>g</italic>-degree relatives using a dominant disease model with complete penetrance, designating a specific founder's haplotype location as the disease origin. Founder haplotypes, including those of the common ancestor, were randomly selected from the HapMap CEPH data, using a separate set from the one used for learning the LD. <xref ref-type="fig" rid="F3">Figure 3</xref> details the performance of the different methods in the task of disease gene mapping. For <italic>g</italic> = 6, the results show that all three models correctly identify the disease locus, placed at 22 cm. However, for <italic>g</italic> = 8, the peak around the genuine locus is made much more evident when using the 4-track model than when using either P<sc>link</sc> or M<sc>erlin</sc>, maintaining this relative performance for <italic>g</italic> = 10. Repeating these experiments with different randomly chosen SNPs to be the location of the disease yielded similar results. We note that these experiments were done over a 50 cm region on Chromosome 1, using SNP density comparable to the 500 k genome-wide panels.
<fig id="F3" position="float"><label>Fig. 3.</label><caption><p>Finding a disease seeded at 22 cm (location indicated by the horizontal line) using IBD predictions. Pairs of individuals were simulated using <italic>g</italic> = 6,8,10, assuming a dominant disease with complete penetrance that originated from a common founder.</p></caption><graphic xlink:href="btq204f3"/></fig></p>
  </sec>
  <sec sec-type="discussion" id="SEC6">
    <title>6 DISCUSSION</title>
    <p>Measurements of LD in recent years become more accurate as data of haplotypes accumulate. Yet, even with current public data, the knowledge of LD already upgrades the performance of various methods for gene mapping such as linkage analysis, mapping by admixture linkage disequilibrium (MALD), and association studies (Abecasis and Wigginton, <xref ref-type="bibr" rid="B1">2005</xref>; Bercovici and Geiger, <xref ref-type="bibr" rid="B4">2009</xref>; Eskin, <xref ref-type="bibr" rid="B11">2008</xref>). In this article we incorporated a first-order Markov model of LD within models of family inheritance and showed how this improves the analysis of shared IBD areas. The proposed model becomes computationally efficient because we have devised a suitable partition of the state space, which satisfies Conditions I and II, and as a result reduces an exponential complexity to a quadratic one.</p>
    <p>The fundamental difficulty in estimating IBD status is that recombination events erase the trace of inheritance after a few dozens of generations leaving small IBD areas that compete against random areas that are equal only by state. The errors produced by P<sc>link</sc> are mostly due to interpreting an IBS area as being IBD, and our method that uses a novel first-order HMM for modeling LD reduces these mistakes. An important challenge remains to incorporate better models of LD within better models of family inheritance to obtain higher accuracy of IBD inference. The result of more accurate models that are still computationally feasible will be the ability to identify smaller regions of IBD whose origin is more distant than what can be inferred with current models. In addition, our model can be extended so as to take into account genotyping errors via appropriate adjustment of Equation <xref ref-type="disp-formula" rid="M4">4</xref>. Specifically, error in genotyping can be expressed through the conditional probability <italic>P</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>s</italic><sub><italic>i</italic></sub>, <italic>f</italic><sub><italic>i</italic></sub>).</p>
    <p>Our model assumes a pedigree structure of an equidistance single ancestor, based on the observation that the closest common ancestor contributes most to the IBD between two individuals. As such, the model efficiently approximates more complex pedigrees for which exact computation of IBD status is intractable. The performance of our method with respect to an arbitrary given pedigree can be evaluated via simulations. It further follows that a misestimation of the number of generations since the common ancestor affects our method's performance. For example, in the case of 5-degree relatives, a mis-specified <italic>g</italic> = 3, 4, 6, 7 during the inference will reduce the precision from 89% to 82%, for a recall of 92%. One possible approach for the estimation of the parameter <italic>g</italic> is by learning from the SNP data of the two individuals, using adjusted maximum likelihood (Schwarz, <xref ref-type="bibr" rid="B38">1978</xref>).</p>
    <p>The main contribution of this article is towards mapping techniques that do no not use pedigrees as input, such as association studies, IBD mapping and homozygosity mapping. We assume, as with P<sc>link</sc>, that pairs of affected persons have a higher likelihood for a common ancestor, and when such an ancestor is inferred, the IBD areas can be detected with high probability. We modeled the relationship between two input individuals using a <italic>g</italic>-degree relatives pedigree, namely, a single common ancestor with a separate path to each individual. The computational breakthrough that allowed this computation to take place for large enough <italic>g</italic> has been the clustering of selectors that represent meiosis events along the two inheritance paths, into two variables, each with <italic>g</italic> + 1 states, and this reduced the complexity of the state-of-the-art linkage program M<sc>erlin</sc> from exponential to quadratic. A software implementation, called IBD<sc>map</sc>, is freely available at <ext-link ext-link-type="uri" xlink:href="http://bioinfo.cs.technion.ac.il/IBDmap">http://bioinfo.cs.technion.ac.il/IBDmap</ext-link>. The higher accuracy along with the reduced time complexity marks our method as a feasible means for IBD mapping in practical scenarios.</p>
    <p><italic>Funding</italic>: Israel Science Foundation; Azrieli Fellowship, Azrieli Foundation (to S.B.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abecasis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wigginton</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Handling marker-marker linkage disequilibrium: pedigree analysis with clustered markers</article-title>
        <source>Am. J. Hum. Genet.</source>
        <year>2005</year>
        <volume>77</volume>
        <fpage>754</fpage>
        <lpage>767</lpage>
        <pub-id pub-id-type="pmid">16252236</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abecasis</surname>
            <given-names>GR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Merlin-rapid analysis of dense genetic maps using sparse gene flow trees</article-title>
        <source>Nat. Genet.</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>97</fpage>
        <lpage>101</lpage>
        <pub-id pub-id-type="pmid">11731797</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yekutieli</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Quantitative traits loci analysis using the false discovery rate</article-title>
        <source>Genetics</source>
        <year>2005</year>
        <volume>171</volume>
        <fpage>783</fpage>
        <lpage>789</lpage>
        <pub-id pub-id-type="pmid">15956674</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bercovici</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Geiger</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Inferring ancestries efficiently in admixed populations with linkage disequilibrium</article-title>
        <source>J. Comput. Biol.</source>
        <year>2009</year>
        <volume>16</volume>
        <fpage>1141</fpage>
        <lpage>1150</lpage>
        <pub-id pub-id-type="pmid">19645595</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Browning</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Browning</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>On reducing the statespace of hidden markov models for the identity by descent process</article-title>
        <source>Theor. Popul. Biol.</source>
        <year>2002</year>
        <volume>62</volume>
        <fpage>1</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">12056862</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cardon</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Using haplotype blocks to map human complex trait loci</article-title>
        <source>Trends Genet.</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>135</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="pmid">12615007</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carlson</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping complex disease loci in whole-genome association studies</article-title>
        <source>Nature</source>
        <year>2004</year>
        <volume>429</volume>
        <fpage>446</fpage>
        <lpage>452</lpage>
        <pub-id pub-id-type="pmid">15164069</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cottingham</surname>
            <given-names>RW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Faster sequential genetic linkage computations</article-title>
        <source>Am. J. Hum. Genet.</source>
        <year>1993</year>
        <volume>53</volume>
        <fpage>252</fpage>
        <lpage>263</lpage>
        <pub-id pub-id-type="pmid">8317490</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Dechter</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Bucket elimination: a unifying framework for probabilistic inference</article-title>
        <source>Proceedings of the NATO Advanced Study Institute on Learning in graphical models</source>
        <year>1998</year>
        <publisher-loc>Erice, Italy</publisher-loc>
        <publisher-name>Kluwer Academic Press</publisher-name>
        <fpage>75</fpage>
        <lpage>104</lpage>
      </element-citation>
    </ref>
    <ref id="B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elston</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A general model for the analysis of pedigree data</article-title>
        <source>Hum. Hered.</source>
        <year>1971</year>
        <volume>21</volume>
        <fpage>523</fpage>
        <lpage>542</lpage>
        <pub-id pub-id-type="pmid">5149961</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eskin</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Increasing power in association studies by using linkage disequilibrium structure and molecular function as prior information</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>653</fpage>
        <lpage>660</lpage>
        <pub-id pub-id-type="pmid">18353808</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fishelson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Geiger</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Exact genetic linkage computations for general pedigrees</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <issue>Suppl. 1</issue>
        <fpage>S189</fpage>
        <lpage>S198</lpage>
        <pub-id pub-id-type="pmid">12169547</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frazer</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A second generation human haplotype map of over 3.1 million snps</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>449</volume>
        <fpage>851</fpage>
        <lpage>861</lpage>
        <pub-id pub-id-type="pmid">17943122</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geiger</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Speeding up HMM algorithms for genetic linkage analysis via chain reductions of the state space</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>25</volume>
        <fpage>i196</fpage>
        <lpage>i203</lpage>
        <pub-id pub-id-type="pmid">19477987</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ghahramani</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Factorial hidden Markov models</article-title>
        <source>Mach. Learn.</source>
        <year>1997</year>
        <volume>29</volume>
        <fpage>245</fpage>
        <lpage>273</lpage>
      </element-citation>
    </ref>
    <ref id="B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Greenspan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Geiger</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>High density linkage disequilibrium mapping using models of haplotype block variation</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <issue>Suppl. 1</issue>
        <fpage>i137</fpage>
        <lpage>i144</lpage>
        <pub-id pub-id-type="pmid">15262792</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gudbjartsson</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Allegro version 2</article-title>
        <source>Nat. Genet.</source>
        <year>2005</year>
        <volume>37</volume>
        <fpage>1015</fpage>
        <lpage>1016</lpage>
        <pub-id pub-id-type="pmid">16195711</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gudbjartsson</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Allegro, a new computer program for multipoint linkage analysis</article-title>
        <source>Nat. Genet.</source>
        <year>2000</year>
        <volume>25</volume>
        <fpage>12</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="pmid">10802644</pub-id>
      </element-citation>
    </ref>
    <ref id="B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Halperin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Stephan</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Maximizing power in association studies</article-title>
        <source>Nat. Biotecmol.</source>
        <year>2009</year>
        <volume>27</volume>
        <fpage>255</fpage>
        <lpage>256</lpage>
      </element-citation>
    </ref>
    <ref id="B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Halperin</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tag SNP selection in genotype data for maximizing SNP prediction accuracy</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>Suppl. 1</issue>
        <fpage>i195</fpage>
        <lpage>i203</lpage>
        <pub-id pub-id-type="pmid">15961458</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Han</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rapid and accurate multiple testing correction and power estimation for millions of correlated markers</article-title>
        <source>PloS Genet.</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>e1000456</fpage>
        <pub-id pub-id-type="pmid">19381255</pub-id>
      </element-citation>
    </ref>
    <ref id="B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ingolfsdottir</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gudbjartsson</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Genetic linkage analysis, algorithms and their implementation</article-title>
        <source>Trans. Comput. Syst. Biol.</source>
        <year>2005</year>
        <volume>3737</volume>
        <fpage>123</fpage>
        <lpage>144</lpage>
      </element-citation>
    </ref>
    <ref id="B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kruglyak</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Faster multipoint linkage analysis using Fourier transform</article-title>
        <source>J. Comput. Biol.</source>
        <year>1998</year>
        <volume>5</volume>
        <fpage>1</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="pmid">9541867</pub-id>
      </element-citation>
    </ref>
    <ref id="B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kruglyak</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rapid multipoint linkage analysis of recessive traits in nuclear families including homozygosity mapping</article-title>
        <source>Am. J. Hum. Genet.</source>
        <year>1995</year>
        <volume>56</volume>
        <fpage>519</fpage>
        <lpage>527</lpage>
        <pub-id pub-id-type="pmid">7847388</pub-id>
      </element-citation>
    </ref>
    <ref id="B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kruglyak</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Parametric and nonparametric linkage analysis: a unified multipoint approach</article-title>
        <source>Am. J. Hum. Genet.</source>
        <year>1996</year>
        <volume>58</volume>
        <fpage>1347</fpage>
        <lpage>1363</lpage>
        <pub-id pub-id-type="pmid">8651312</pub-id>
      </element-citation>
    </ref>
    <ref id="B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lander</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Construction of multilocus genetic maps in humans</article-title>
        <source>Proc. Natl Acad. Sci.</source>
        <year>1987</year>
        <volume>84</volume>
        <fpage>2363</fpage>
        <lpage>2367</lpage>
        <pub-id pub-id-type="pmid">3470801</pub-id>
      </element-citation>
    </ref>
    <ref id="B27">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lange</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <source>Mathematical and Statistical Methods for Genetic Analysis.</source>
        <year>1997</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer-Verlag</publisher-name>
      </element-citation>
    </ref>
    <ref id="B28">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lauritzen</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <source>Graphical Models.</source>
        <year>1996</year>
        <publisher-loc>Oxford, UK</publisher-loc>
        <publisher-name>Oxford University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lauritzen</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Spiegelhalter</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Local computations with probabilities on graphical structures and their application to expert systems (with discussion)</article-title>
        <source>J. Roy. Stat. Soc. Series B stat. Methodol.</source>
        <year>1988</year>
        <volume>50</volume>
        <fpage>157</fpage>
        <lpage>224</lpage>
      </element-citation>
    </ref>
    <ref id="B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Markianos</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Efficient multipoint linkage analysis through reduction of inheritance space</article-title>
        <source>Am. J. Hum. Genet.</source>
        <year>2001</year>
        <volume>68</volume>
        <fpage>963</fpage>
        <lpage>977</lpage>
        <pub-id pub-id-type="pmid">11254453</pub-id>
      </element-citation>
    </ref>
    <ref id="B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O'Connell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Weeks</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The VITESSE algorithm for rapid exact multilocus linkage analysis via genotype set-recoding and fuzzy inheritance</article-title>
        <source>Nat. Genet.</source>
        <year>1995</year>
        <volume>11</volume>
        <fpage>402</fpage>
        <lpage>408</lpage>
        <pub-id pub-id-type="pmid">7493020</pub-id>
      </element-citation>
    </ref>
    <ref id="B32">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ott</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Analysis of Human Genetic Linkage.</source>
        <year>1999</year>
        <publisher-loc>Baltimore, Maryland</publisher-loc>
        <publisher-name>Johns Hopkins University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="B33">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Pearl</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Probabilistic Reasoning in Intelligent Systems.</source>
        <year>1988</year>
        <publisher-loc>San Francisco, CA</publisher-loc>
        <publisher-name>Morgan Kaufmann</publisher-name>
      </element-citation>
    </ref>
    <ref id="B34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peer</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluating and improving power in whole genome association studies using fixed marker sets</article-title>
        <source>Nat. Genet.</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>663</fpage>
        <lpage>667</lpage>
        <pub-id pub-id-type="pmid">16715096</pub-id>
      </element-citation>
    </ref>
    <ref id="B35">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peer</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Estimation of the multiple testing burden for genomewide association studies of nearly all common variants</article-title>
        <source>Genet. Epidemiol.</source>
        <year>2008</year>
        <volume>32</volume>
        <fpage>381</fpage>
        <lpage>385</lpage>
        <pub-id pub-id-type="pmid">18348202</pub-id>
      </element-citation>
    </ref>
    <ref id="B36">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Purcell</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Plink: a tool set for whole-genome association and population-based linkage analyses</article-title>
        <source>Am. J. Hum. Genet.</source>
        <year>2007</year>
        <volume>81</volume>
        <fpage>559</fpage>
        <lpage>575</lpage>
        <pub-id pub-id-type="pmid">17701901</pub-id>
      </element-citation>
    </ref>
    <ref id="B37">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rabiner</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Juang</surname>
            <given-names>BH</given-names>
          </name>
        </person-group>
        <article-title>An introduction to hidden Markov models</article-title>
        <source>IEEE Acoust. Speech sign. Process. Mag.</source>
        <year>1986</year>
        <fpage>4</fpage>
        <lpage>15</lpage>
      </element-citation>
    </ref>
    <ref id="B38">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwarz</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Estimating the dimension of a model</article-title>
        <source>Ann. Stat.</source>
        <year>1978</year>
        <volume>6</volume>
        <fpage>461</fpage>
        <lpage>464</lpage>
      </element-citation>
    </ref>
    <ref id="B39">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Silberstein</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Online system for faster multipoint linkage analysis via parallel execution on thousands of personal computers</article-title>
        <source>Am. J. Hum. Genet.</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>922</fpage>
        <lpage>935</lpage>
        <pub-id pub-id-type="pmid">16685644</pub-id>
      </element-citation>
    </ref>
    <ref id="B40">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sobel</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lange</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Descent graphs in pedigree analysis: applications to haplotyping, location scores, and marker sharing statistics</article-title>
        <source>Am. J. Hum. Genet.</source>
        <year>1996</year>
        <volume>58</volume>
        <fpage>1323</fpage>
        <lpage>1337</lpage>
        <pub-id pub-id-type="pmid">8651310</pub-id>
      </element-citation>
    </ref>
    <ref id="B41">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>EA</given-names>
          </name>
        </person-group>
        <article-title>Monte Carlo likelihood in genetic mapping</article-title>
        <source>Stat. Sci.</source>
        <year>1994</year>
        <volume>9</volume>
        <fpage>355</fpage>
        <lpage>366</lpage>
      </element-citation>
    </ref>
    <ref id="B42">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide association studies: theoretical and practical concerns</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>109</fpage>
        <lpage>118</lpage>
        <pub-id pub-id-type="pmid">15716907</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
