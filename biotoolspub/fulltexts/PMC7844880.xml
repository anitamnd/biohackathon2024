<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Gigascience</journal-id>
    <journal-id journal-id-type="iso-abbrev">Gigascience</journal-id>
    <journal-id journal-id-type="publisher-id">gigascience</journal-id>
    <journal-title-group>
      <journal-title>GigaScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2047-217X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7844880</article-id>
    <article-id pub-id-type="pmid">33511994</article-id>
    <article-id pub-id-type="doi">10.1093/gigascience/giab004</article-id>
    <article-id pub-id-type="publisher-id">giab004</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00960</subject>
        <subject>AcademicSubjects/SCI02254</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FASTQuick: rapid and comprehensive quality assessment of raw sequence reads</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6802-4514</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Fan</given-names>
        </name>
        <!--<email>fanzhang@umich.edu</email>-->
        <aff><institution>Department of Computational Medicine and Bioinformatics, University of Michigan Medical School</institution>, 100 Washington Ave, Ann Arbor, MI 48109, <country country="US">USA</country></aff>
        <xref ref-type="corresp" rid="cor1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kang</surname>
          <given-names>Hyun Min</given-names>
        </name>
        <aff><institution>Department of Biostatistics, University of Michigan School of Public Health</institution>, 1415 Washington Heights, Ann Arbor, MI 48109, <country country="US">USA</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><bold>Correspondence address</bold>. Fan Zhang, Department of Computational Medicine and Bioinformatics, University of Michigan Medical School, 100 Washington Ave, Ann Arbor, MI 48109-2218. E-mail: <email>fanzhang@umich.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub" iso-8601-date="2021-01-29">
      <day>29</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>10</volume>
    <issue>2</issue>
    <elocation-id>giab004</elocation-id>
    <history>
      <date date-type="received">
        <day>02</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>23</day>
        <month>11</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>1</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press GigaScience.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="giab004.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="abs1">
        <title>Background</title>
        <p>Rapid and thorough quality assessment of sequenced genomes on an ultra-high-throughput scale is crucial for successful large-scale genomic studies. Comprehensive quality assessment typically requires full genome alignment, which costs a substantial amount of computational resources and turnaround time. Existing tools are either computationally expensive owing to full alignment or lacking essential quality metrics by skipping read alignment.</p>
      </sec>
      <sec id="abs2">
        <title>Findings</title>
        <p>We developed a set of rapid and accurate methods to produce comprehensive quality metrics directly from a subset of raw sequence reads (from whole-genome or whole-exome sequencing) without full alignment. Our methods offer orders of magnitude faster turnaround time than existing full alignment–based methods while providing comprehensive and sophisticated quality metrics, including estimates of genetic ancestry and cross-sample contamination.</p>
      </sec>
      <sec id="abs3">
        <title>Conclusions</title>
        <p>By rapidly and comprehensively performing the quality assessment, our tool will help investigators detect potential issues in ultra-high-throughput sequence reads in real time within a low computational cost at the early stages of the analyses, ensuring high-quality downstream results and preventing unexpected loss in time, money, and invaluable specimens.</p>
      </sec>
    </abstract>
    <kwd-group kwd-group-type="keywords">
      <kwd>quality assessment</kwd>
      <kwd>genetic ancestry</kwd>
      <kwd>contamination</kwd>
      <kwd>sequencing data analysis</kwd>
    </kwd-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Findings</title>
    <sec id="sec1-1">
      <title>Introduction</title>
      <p>Efficient and thorough quality assessment from deeply sequenced genomes on an ultra-high-throughput scale is crucial for successful large-scale sequencing studies. Delay or failure in detecting contamination, sample swaps, quality degradation, or other unexpected problems in the sequencing or library preparation protocol can result in enormous loss of time, money, and invaluable specimens if, e.g., hundreds or thousands of samples are found to be contaminated weeks or months later. Currently, quality control (QC) tools for sequencing data analyses either have to wait hundreds of CPU hours for sequence alignment results to generate comprehensive QC metrics or completely skip the sequence alignment step and ignore alignment information to achieve faster turnaround. A desired strategy that can generate comprehensive QC metrics of sequence data at real-time speed will ensure the generation of high-quality sequence reads and successful outcomes in the downstream analyses.</p>
      <p>Existing quality assessment or QC tools mainly fall into 2 categories—pre-alignment and post-alignment methods—on the basis of whether they require full alignment of the genome prior to the quality assessment. Pre-alignment methods, such as FASTQC [<xref rid="bib1" ref-type="bibr">1</xref>], PIQA [<xref rid="bib2" ref-type="bibr">2</xref>], and HTQC [<xref rid="bib3" ref-type="bibr">3</xref>], produce read-level summary statistics that can be obtained from sequence reads, such as base compositions, <italic>k</italic>-mer distributions, base qualities, and GC bias levels. However, these pre-alignment methods do not estimate many key quality metrics required for comprehensive quality assessment. These missing metrics include mapping rate, depth distribution, the fraction of genome covered, sample contamination, or genetic ancestry information. Other post-alignment methods, such as QPLOT [<xref rid="bib4" ref-type="bibr">4</xref>], Picard [<xref rid="bib5" ref-type="bibr">5</xref>], GotCloud [<xref rid="bib6" ref-type="bibr">6</xref>], and verifyBamID [<xref rid="bib7" ref-type="bibr">7</xref>], provide a subset of these key quality metrics but require full alignment of sequence reads, which typically takes hundreds of CPU hours for deep (e.g., &gt;30×) sequence genome (Table <xref rid="tbl1" ref-type="table">1</xref>).</p>
      <table-wrap id="tbl1" orientation="portrait" position="float">
        <label>Table 1:</label>
        <caption>
          <p>Quality assessment metrics provided by different QC tools</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Metric</th>
              <th rowspan="1" colspan="1">FASTQC</th>
              <th rowspan="1" colspan="1">PIQA</th>
              <th rowspan="1" colspan="1">HTQC</th>
              <th rowspan="1" colspan="1">QPLOT</th>
              <th rowspan="1" colspan="1">Picard</th>
              <th rowspan="1" colspan="1">verifyBamID2</th>
              <th rowspan="1" colspan="1">FASTQuick</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Base quality per cycle</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GC bias</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PCR duplication rate</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Insert size distribution</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Contamination estimate</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Genetic ancestry</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">% Mapped reads</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓<xref ref-type="table-fn" rid="tnote-1611618852930"><sup>a</sup></xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Depth distribution</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Total No. of reads</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Read length distribution</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Full alignment not required</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tnote-1611618852930">
            <label>a</label>
            <p>Currently only recommended for whole-genome sequencing dataset.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>We describe FASTQuick, a rapid and accurate set of algorithms and software tools, to combine the merits of QC tools from both categories. By focusing on a variant-centric subset of a reference genome (reduced reference genome), our methods offer up to 30–100-fold faster turnaround time than existing post-alignment methods for deeply sequenced genome while providing a comprehensive set of quality metrics comparable with QPLOT and verifyBamID (full-alignment–based results from these 2 tools together constitute most of the important QC metrics from the GotCloud-based QC pipeline, which we compare against below) with the help of statistical adjustments to account for the reduced reference genome.</p>
    </sec>
    <sec id="sec1-2">
      <title>Computational efficiency</title>
      <p>The primary goal of FASTQuick is to achieve comprehensive QC with much less computational cost than full-alignment–based QC procedures. A large fraction of the computational gains come from the use of the reduced reference genome and filtering of unalignable reads through mismatch-tolerant spaced <italic>k</italic>-mer hashing (Fig. <xref ref-type="fig" rid="fig1">1A</xref>) [<xref rid="bib8" ref-type="bibr">8</xref>]. Compared to alignment to the full human reference genome, aligning a 3× HG00553 genome on the reduced reference genome reduced the run time by 34.9-fold (94,020 vs 2,697 seconds) using the same algorithm. Using a hash table built from mismatch-tolerant spaced <italic>k</italic>-mers, &gt;90% of unalignable reads can be filtered out with very little loss (<xref ref-type="supplementary-material" rid="sup7">Supplementary Table S1</xref>) of alignable reads, when ≥3 hits are required (default parameter) for a read to be considered as alignable, saving an additional 65% of computational time (Fig. <xref ref-type="fig" rid="fig1">1B</xref>). Putting them together, the alignment step of FASTQuick (with default parameters) was 100-fold faster (94,020 vs 939 seconds) than the full genome alignment. We observed that &gt;99% of unalignable reads could be filtered out with a more stringent threshold (≥7 hits) at the expense of 0.01% loss of alignable reads. However, the additional computational gain was only 14% (939 vs 811 seconds).</p>
      <fig id="fig1" orientation="portrait" position="float">
        <label>Figure 1:</label>
        <caption>
          <p>Illustration of FASTQuick. (A) Spaced <italic>k</italic>-mer hash filter design with the tolerance of mismatches for each 32-mer. (B) Effect of minimum spaced <italic>k</italic>-mer hits to be considered for BWA alignment on the overall run time, fraction of total reads filtered, and fraction of falsely filtered alignable reads. <italic>k</italic> = 3 was used in our experiment. (C) Procedure to build FASTQuick indices with a reduced reference genome for spaced <italic>k</italic>-mer hash and the BWA algorithm. (D) Procedure to process sequence reads and produce QC metrics using FASTQuick. (E) Comparison of visualizations of reported base qualities (in Phred scale) and empirical base qualities between QPLOT and FASTQuick for a 38× genome. (F) Comparison of visualization of GC bias (in normalized mean depth) between QPLOT and FASTQuick for a 38× genome. (G) Comparison of estimated insert size distributions between QPLOT and FASTQuick (after Kaplan-Meier adjustment) for a 38× genome. (H) Comparison of estimated contamination rates in <italic>in silico</italic> contaminated 1000 Genomes Project  samples between verifyBamID2 and QPLOT. The purple diagonal dotted line represents y = x.</p>
        </caption>
        <graphic xlink:href="giab004fig1"/>
      </fig>
      <p>We also evaluated the overall computational efficiency between FASTQuick and the GotCloud-based QC pipeline (typical sequence processing pipeline based on full genome alignment as in 1000 Genomes Project and TOPMed project) on the high-coverage genome (38×) and low-coverage (3×) genomes from the 1000 Genomes Project (Table <xref rid="tbl2" ref-type="table">2</xref>). The results demonstrate that FASTQuick produces a comparable set of QC metrics to GotCloud with a 30–100-fold faster turnaround time.</p>
      <table-wrap id="tbl2" orientation="portrait" position="float">
        <label>Table 2:</label>
        <caption>
          <p>Running time comparison</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="2" colspan="1"> No. of threads</th>
              <th colspan="2" align="center" rowspan="1">FASTQuick Time (h)</th>
              <th colspan="2" align="center" rowspan="1">GotCloud QC Time (with BWA) (h)</th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1">HG00553 (3×)</th>
              <th rowspan="1" colspan="1">NA12878 (38×)</th>
              <th rowspan="1" colspan="1">HG00553 (3×)</th>
              <th rowspan="1" colspan="1">NA12878 (38×)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">1.03</td>
              <td rowspan="1" colspan="1">5.48</td>
              <td rowspan="1" colspan="1">30.95</td>
              <td rowspan="1" colspan="1">369.56</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">0.53</td>
              <td rowspan="1" colspan="1">2.46</td>
              <td rowspan="1" colspan="1">21.53</td>
              <td rowspan="1" colspan="1">230.85</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">0.33</td>
              <td rowspan="1" colspan="1">1.76</td>
              <td rowspan="1" colspan="1">15.83</td>
              <td rowspan="1" colspan="1">154.91</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">8</td>
              <td rowspan="1" colspan="1">0.24</td>
              <td rowspan="1" colspan="1">1.75</td>
              <td rowspan="1" colspan="1">12.74</td>
              <td rowspan="1" colspan="1">131.85</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tb2fn1">
            <p>Running time is evaluated as wall-clock elapsed time on a machine with Intel® Xeon® CPU (X7560 at 2.27 GHz). Reference indexing time is independent of the input sequence dataset and not included. (It takes 3min20s to index human genome under default settings.)</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="sec1-3">
      <title>QC metrics produced by FASTQuick</title>
      <p>FASTQuick can automatically generate and visualize the QC metrics listed in <xref ref-type="supplementary-material" rid="sup7">Supplementary Table S2</xref>. Briefly, FASTQuick generates 3 types of generic QC summary statistics—per-base, per-read, and per-variant summary statistics. Per-base summary statistics inform mapping rate, depth distribution, GC bias, and base quality. Per-read summary statistics allow us to estimate PCR duplication rate and insert size distribution adjusted to account for pair-end alignment bias due to the reduced reference genome. Per-variant summary statistics allow us to estimate DNA contamination rate and genetic ancestry. These summary statistics are combined, jointly analyzed, and visualized into an interpretable and user-friendly quality report shown as in <xref ref-type="supplementary-material" rid="sup7">Supplementary Items S1 and S2</xref>.</p>
    </sec>
    <sec id="sec1-4">
      <title>Accuracy of QC metrics</title>
      <p>We compared the distribution of QC metrics generated from FASTQuick with those from GotCloud on multiple sequenced genomes. The QC metrics shared between FASTQuick and GotCloud are listed in <xref ref-type="supplementary-material" rid="sup7">Supplementary Table S2</xref>. The visualization QC metrics such as base quality recalibration (Fig. <xref ref-type="fig" rid="fig1">1E</xref>), normalized mean depth by GC content (Fig. <xref ref-type="fig" rid="fig1">1F</xref>), and depth distribution are very close between FASTQuick and GotCloud. For example, the 2-sample Kolmogorov-Smirnov (KS) test statistic, which quantifies the maximum differences between 2 empirical cumulative distributions of depth, was D = 0.040. Similarly, the Wasserstein-1D distance, which quantifies the average distance between 2 cumulative distributions of depth, was W = 0.0038. The Wasserstein distance is a widely used metric to evaluate the similarity between 2 distributions in generative adversarial networks [<xref rid="bib9" ref-type="bibr">9</xref>]. Even though such differences are statistically significant (mainly because of the large number of observations), it is arguably a small amount of difference that is typically observed between different QC tools on the same sequence data. We also evaluated the estimated PCR duplication rate by comparing with QPLOT's result using 10 randomly selected samples from the 1000 Genomes Project, which shows a difference almost within 1.5% (<xref ref-type="supplementary-material" rid="sup7">Supplementary Table S3</xref>). To further facilitate other potential analyses that require genotype availability, such as relatedness2, we also generated a VCF file that contains GT, PL, and GP fields. The genotype accuracy is ∼99% by comparing with the 1000 Genomes Project phase3 call set (<xref ref-type="supplementary-material" rid="sup7">Supplementary Table S4</xref>).</p>
      <p>One challenge in quality assessment based on the partial alignment of sequence reads to the reduced reference genome is the estimation of insert size distribution. To systematically correct for biased estimation of insert sizes, we statistically integrated the observed insert sizes across all contigs with inverse probability weighting based on the Kaplan-Meier curve [<xref rid="bib10" ref-type="bibr">10</xref>] (see Methods). Applying our correction produces an estimated insert size distribution much closer to that from the full alignment (Fig. <xref ref-type="fig" rid="fig1">1G</xref>). The KS-test statistic and the Wasserstein-1D distance were D = 0.60 and W = 0.0591, respectively, when using 500-bp contigs only, but they decreased to D = 0.18 and W = 0.0170 when using both 500- and 2,000-bp contigs when comparing the insert size distributions between FASTQuick and GotCloud. When adjusting the insert-size distribution using a Kaplan-Meier estimator, they substantially decreased to D = 0.017 and W = 0.0066, respectively.</p>
      <p>To evaluate the estimation accuracy of contamination rate and genetic ancestry, we prepared artificially contaminated 1000 Genomes Project samples <italic>in silico</italic> (see Methods). Then we compared the estimated contamination rate and genetic ancestry from FASTQuick with the estimation from the full-alignment QC pipeline-based result. Our results demonstrate that FASTQuick can estimate contamination rate (Fig. <xref ref-type="fig" rid="fig1">1H</xref>) and genetic ancestry (<xref ref-type="supplementary-material" rid="sup7">Supplementary Table S5</xref>) as accurately as the standard method VerifyBamID2 relying on the full-alignment result. For example, HG00553(PUR) and NA12878(CEU) are correctly mapped onto their corresponding genetic ancestry group (<xref ref-type="supplementary-material" rid="sup7">Supplementary Items S1 and S3</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="methods" id="sec2">
    <title>Methods</title>
    <sec id="sec2-1">
      <title>Overview of FASTQuick</title>
      <p>FASTQuick first constructs a reduced reference genome from a set of flanking sequences surrounding known single-nucleotide polymorphisms (SNPs) and builds a Burrows–Wheeler transform (BWT) index [<xref rid="bib11" ref-type="bibr">11</xref>] and mismatch-tolerant <italic>k</italic>-mer hash table (Fig. <xref ref-type="fig" rid="fig1">1C</xref>). Once the indices are built, FASTQuick rapidly filters out unalignable reads whose first 96 bp have &lt;3 hits (out of 18 potential hits, among which 6 hits per 32-mer) against the spaced <italic>k</italic>-mer hash indices, and aligns filtered sequence reads to the reduced reference genome using the BWT index (Fig. <xref ref-type="fig" rid="fig1">1D</xref>). The small fraction of filtered aligned reads will be stored in binary Sequence Alignment/Map format (BAM) [<xref rid="bib12" ref-type="bibr">12</xref>]. Next, all the summary statistics that are generated from the aligned reads are collected and jointly analyzed to form various QC metrics that are reported in a user-friendly report in HTML (<xref ref-type="supplementary-material" rid="sup7">Supplementary Item S1</xref>).</p>
    </sec>
    <sec id="sec2-2">
      <title>Construction of reduced reference genome using flanking sequences of SNPs</title>
      <p>FASTQuick constructs a reduced reference genome based on well-alignable flanking sequences around known common SNPs to enrich the reads that are informative for both genetic inference (e.g., contamination and ancestry) and other genomic quality metrics that require read alignment. Starting from an arbitrary set of known SNPs, FASTQuick randomly selects a designated number of SNPs from a known common (minor allele frequency &gt;5%) SNP set, such as HapMap3 [<xref rid="bib13" ref-type="bibr">13</xref>], while excluding SNPs near hard-to-align regions (e.g., 1000 Genomes Project strict mask region). FASTQuick then constructs a reduced reference genome using short flanking sequences of the majority of SNPs (e.g., 90%) and long flanking sequences of the remaining SNPs.</p>
    </sec>
    <sec id="sec2-3">
      <title>Filtering unalignable reads with mismatch-tolerant hash</title>
      <p>Because the reduced reference genome is a small subset of the whole genome sequence, we expect that only a small fraction of reads will be alignable. However, attempting to align all the reads is still computationally expensive. FASTQuick builds a hash-based index to rapidly filter out the reads that are unlikely to be aligned to the reduced reference genome. To make the hash robust against sequencing errors, FASTQuick builds 6 locally sensitive hash tables of 16-mers for each 32-mer (Fig. <xref ref-type="fig" rid="fig1">1A</xref>) so that 32-mers with ≤2 mismatches can still be guaranteed to match to ≥1 of the hash tables [<xref rid="bib8" ref-type="bibr">8</xref>].</p>
      <p>FASTQuick partitions each sequence read into multiple 32-mers and performs hash lookups for each possible 16-mer. For example, for a 100-bp read, eighteen 16-mers (6 per 32-mer) across three 32-mers will be matched to the hash table. For reads longer than 96-bp reads, only the first 96-bp reads are used. FASTQuick's decision whether to filter out a read is based on whether the number of matching 16-mers is less than a certain threshold <italic>k</italic>. For example, if <italic>k</italic> is 3, reads with &lt;7 mismatches are guaranteed to pass the filter, and many other reads with more mismatches will pass the filter. If <italic>k</italic> is 10, reads with &lt;3 mismatches are guaranteed to pass the filter. We chose <italic>k</italic> = 3 on the basis of empirical observations (see Findings). The remaining reads will then be aligned by the optimized BWA-like algorithms to the reduced reference genome.</p>
    </sec>
    <sec id="sec2-4">
      <title>Generating base-level, read-level, and variant-level QC metrics</title>
      <p>Using the reads aligned to the reduced reference genome, FASTQuick generates a full list of base-level, read-level, and variant-level QC metrics (<xref ref-type="supplementary-material" rid="sup7">Supplementary Table S2</xref>). Base-level metrics, such as base quality, and sequencing cycle, are recorded directly without using the alignment information. Because the reads spanning the end of flanking sequences may be poorly aligned, FASTQuick produces metrics only on the fully alignable portion of flanking sequences. Let the length of the flanking sequence be <italic>w</italic> and the read length be <italic>r</italic>; then only 2 × (<italic>w</italic>−<italic>r</italic>) +1 bases spanning the variant site will be considered when calculating base-level summary statistics. Read-level QC metrics, such as the fraction of mapped reads and insert size distribution, are estimated and reported on the basis of the read alignment result. Variant-level metrics are collected after the alignment result becomes available and are reported as pile-up bases, estimation of contamination level, and genetic ancestry.</p>
    </sec>
    <sec id="sec2-5">
      <title>Bias-corrected estimation of insert size distribution</title>
      <p>The insert size distribution is typically estimated from distances between the aligned pairs of reads from the fully aligned reads. When using a reduced reference, a large proportion of paired reads may not be fully mapped, and the read pairs that have shorter insert sizes are more likely to be mapped on both ends. As a result, estimating insert size distribution based only on the reads where both ends are mapped will result in biased estimates of insert sizes, as empirically demonstrated using the 38× genome (<xref ref-type="supplementary-material" rid="sup7">Supplementary Figs S1 and S2</xref>).</p>
      <p>We first attempted to resolve this challenge by extending 10% of the variant-centric contigs to be sufficiently long (2,000 bp) and by estimating insert size only from the reads mapped to longer contigs. This way, we prevent the reduced reference genome from becoming too large to achieve computational efficiency and reduce insert size estimation at the same time. But due to the limited number of long-flanking variants, bias and fluctuations still exist in the estimated insert size distribution (<xref ref-type="supplementary-material" rid="sup7">Supplementary Fig. S3</xref>).</p>
      <p>To infer insert size distribution more accurately, FASTQuick further corrects for the bias nonparametrically using the Kaplan-Meier estimator. Owing to the limited length of flanking sequences in the reduced reference, the observed distribution of insert sizes obtained from the reads that have both ends mapped will be biased towards smaller values. To recover the full distribution of insert sizes adjusting for the “censored” reads (i.e., reads with only 1 of the paired ends aligned) enriched for large insert sizes, we adopted the Kaplan-Meier estimator as an inverse-probability-of-censoring weighted average [<xref rid="bib10" ref-type="bibr">10</xref>] as described below.</p>
      <p>Specifically, we define a tuple (<inline-formula><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${t_o}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${t_l}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${t_r}$\end{document}</tex-math></inline-formula>) (<xref ref-type="supplementary-material" rid="sup7">Supplementary Fig. S1</xref>) for each mapped DNA segment (or read pair), where <inline-formula><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${t_o}$\end{document}</tex-math></inline-formula> is the observed insert size, <inline-formula><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${t_l}\ $\end{document}</tex-math></inline-formula>is the maximal insert size of read 1, and <inline-formula><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${t_r}$\end{document}</tex-math></inline-formula> is the maximal insert size of read 2. The maximal insert size is defined as the distance between the leftmost/rightmost base of read 1/read 2 and the rightmost/leftmost base of the flanking region sequence, respectively. This tuple is fully specified only when a read pair is properly aligned; otherwise, for a single-end mapped read pair (including partially mapped pairs) only 1 of the 2 maximal insert sizes (<inline-formula><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${t_l}\ $\end{document}</tex-math></inline-formula> or <inline-formula><tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${t_r}$\end{document}</tex-math></inline-formula>) is available and the unobserved value is set to missing; the rest of the read pairs, such as those that are mapped to different contigs, with low mapping quality, or in abnormal orientation, are discarded in the estimation of insert size distribution. Empirically, given <italic>N</italic> properly aligned read pairs (i.e., tuples without missing values), we can estimate insert size by counting the frequency of different observed insert sizes, <inline-formula><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${t_o}$\end{document}</tex-math></inline-formula>, and the cumulative distribution of insert size hence becomes:
<disp-formula><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}
F\ \left( t \right) = \frac{1}{N}\ \mathop \sum \nolimits_{i\ = \ 1}^N I\left[ {{t_{o,i}} \le t} \right].
\end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <p>However, as mentioned above, this direct estimation will be severely biased because reads mapped only on a single end are more likely to have larger insert sizes. To correct for this bias, we use an approach analogous to the estimation of survival function as <inline-formula><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$S\ ( t ) = \ 1 - F( t )$\end{document}</tex-math></inline-formula>. We can view the leftmost/rightmost base on each flanking region as the start time point, the exact insert size <inline-formula><tex-math id="M12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${t_o}$\end{document}</tex-math></inline-formula> as the time when it fails to observe the data point, and the maximal insert size, <inline-formula><tex-math id="M13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${t_l}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${t_r}$\end{document}</tex-math></inline-formula>, as the time when the data point is censored. Let the ordered observed time points <inline-formula><tex-math id="M15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${t_o}$\end{document}</tex-math></inline-formula> and censored time points <inline-formula><tex-math id="M16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${t_l}$\end{document}</tex-math></inline-formula> (or <inline-formula><tex-math id="M17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${t_r}$\end{document}</tex-math></inline-formula>) be <inline-formula><tex-math id="M18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\tau $\end{document}</tex-math></inline-formula>. Denote <inline-formula><tex-math id="M19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${o_t}$\end{document}</tex-math></inline-formula> as the number of observed failure cases, i.e., the number of read pairs that have observed insert size ≤<italic>t</italic>, and also denote <inline-formula><tex-math id="M20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${c_t}$\end{document}</tex-math></inline-formula> as the number of censored cases at time <italic>t</italic>, i.e., the number of single-end mapped read pairs have maximal insert size ≤<italic>t</italic>, and then let <inline-formula><tex-math id="M21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$I[ {{\tau _j} \ge t} ]$\end{document}</tex-math></inline-formula> be the indicator function if the <italic>j</italic>th time point is larger than a certain time <italic>t</italic> (<italic>j</italic>th insert size ≥<italic>t</italic>). Then the risk set is:
<disp-formula><tex-math id="M22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}
Y\ \left( t \right) = \mathop \sum \nolimits_{j = 1}^J \left( {{o_j} + {c_j}} \right)I\left[ {{\tau _j} \ge t} \right].\
\end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <p>Then the Kaplan-Meier estimator <inline-formula><tex-math id="M23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\widehat {{S_{\mathrm{km}}}}$\end{document}</tex-math></inline-formula> of <inline-formula><tex-math id="M24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$S( t )$\end{document}</tex-math></inline-formula>:
<disp-formula><tex-math id="M25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}
\widehat {{S_{\mathrm{km}}}}\ \left( t \right) = \mathop \prod \nolimits_{\left\{ {j|{\tau _j} \le t} \right\}} \left[ {1 - \frac{{{n_j}}}{{Y\left( {{\tau _j}} \right)}}} \right].\
\end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <p>Satten et al. [<xref rid="bib10" ref-type="bibr">10</xref>] proposed a simplified algorithm to iteratively estimate survival functions for failure times and survival functions for censoring times, by which we conveniently estimate <inline-formula><tex-math id="M26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$F( t )$\end{document}</tex-math></inline-formula>.</p>
    </sec>
    <sec id="sec2-6">
      <title>Estimation of contamination rates and genetic ancestry</title>
      <p>We also implemented likelihood-based methods to estimate the genetic ancestry and contamination rate in FASTQuick using sequencing data that are mapped onto a random subset of SNPs from the 1000 Genomes Project [<xref rid="bib14" ref-type="bibr">14</xref>]. The details of these methods have been fully described in VerifyBamID2 [<xref rid="bib15" ref-type="bibr">15</xref>]. In FASTQuick, to seamlessly integrate these methods into our ultra-fast QC procedure, we designed compatible variant-centric data structures and input/output interfaces that can directly deliver sequence information and estimated statistics from FASTQuick to modules that estimate contamination and genetic ancestry.</p>
    </sec>
    <sec id="sec2-7">
      <title>Support for target sequencing dataset</title>
      <p>FASTQuick also has provided options to incorporate target regions. We can conveniently use the exome region list for exome sequencing (and it potentially can be extended to an abundantly expressed gene list for RNA sequencing with additional effort to adjust for data type–specific artifacts and biases) as input information to only select markers within the list. We prepared the result generated by FASTQuick for exome-sequencing data of HG00553 from the 1000 Genomes Project as a demonstration (<xref ref-type="supplementary-material" rid="sup7">Supplementary Item S2</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="sec3">
    <title>Discussion</title>
    <p>We describe FASTQuick, which addresses computational challenges in QC of ultra-high-throughput sequence data, by focusing on sequence reads mappable to an informative subset of the reference genome. Our results demonstrate that FASTQuick achieves on average a 30–100-fold faster turnaround time than methods based on full sequence alignment while producing comprehensive and accurate QC metrics. Compared with previous quality assessment methods that do not align sequence reads at all, FASTQuick provides more comprehensive QC metrics such as depth distribution, insert size distribution, contamination, and genetic ancestry.</p>
    <p>FASTQuick leverages several methods, such as spaced <italic>k</italic>-mer hash table and Kaplan-Meier estimator, to enable rapid and accurate estimation of QC metrics. Interestingly, the computational time is much faster than the time required to convert and compress Illumina's BCL formatted files into FASTQ files. Therefore, FASTQuick can work as a UNIX pipe during the conversion procedures to increase efficiency in the sequencing pipeline.</p>
    <p>There are potential drawbacks of only using the reduced (subset of) reference genome, but FASTQuick applies heuristics to avoid such drawbacks. For example, reads that originate from multiple homologous regions on the genome may be misaligned to the same contig on the reduced genome, which may affect variant-level quality metrics. FASTQuick addresses this issue by strictly selecting regions that are unique and easy to align (callable regions), and we demonstrated the effectiveness by showing that contamination and genetic ancestry estimates are almost identical to the estimation from the full genome alignment result. Another issue could be the excessive single-end alignment. For example, it will skew the estimation of the insert size distribution toward a smaller value. We applied a Kaplan-Meier estimator to correct the estimation as described above. There are still limitations associated with the reduced reference genome. For example, a precise estimation of percentage of mapped reads is challenging, especially for targeted sequencing reads, owing to the lack of repetitive sequences. Analysis involving structural variation or comprehensive screening of genome-wide association study variants may not be feasible under FASTQuick’s settings.</p>
    <p>Currently, FASTQuick is only suitable for short sequence reads. To enable an analysis of long sequence reads, additional alignment algorithms such as Minimap2 [<xref rid="bib16" ref-type="bibr">16</xref>] could be incorporated. Extending FASTQuick to other types of sequence data, such as RNA sequencing, chromatin immunoprecipitation followed by sequencing, and assay for transposase-accessible chromatin using sequencing should also be possible if the technology-specific characteristics are properly considered and accounted for. In addition, FASTQuick can serve as a general down-sampling step prior to analysis like sample-swap detection or kinship estimation with the help of alignment results on common variants. More broadly, although we demonstrated FASTQuick’s capability by using human genome analysis as an example, the whole pipeline is easily adaptable to other organisms for which corresponding genomic databases are available.</p>
    <p>Unlike hardware-accelerated solutions that achieve fast speed by introducing specialized hardware, such as DRAGEN [<xref rid="bib17" ref-type="bibr">17</xref>] and Parabricks [<xref rid="bib18" ref-type="bibr">18</xref>], FASTQuick gains its speed from optimized algorithms that are specially designed for the reduced genome setting. Compared to omni-purpose proprietary tools like DRAGEN and Parabricks, FASTQuick is an open-source tool that does not require specific hardware such as GPU or field-programmable gate array devices and is specifically designed for quality assessment, which can be critical to attain rapid turnaround time in sequence analysis workflows and add great value to the existing sequence analysis ecosystem.</p>
  </sec>
  <sec id="sec4">
    <title>Availability and Requirements</title>
    <p>Project name: FASTQuick</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/Griffan/FASTQuick">https://github.com/Griffan/FASTQuick</ext-link></p>
    <p>Operating system(s): Linux, MacOS</p>
    <p>Programming language: C++, Shell, R</p>
    <p>Other requirements: CMAKE, libhts, ggplot2, knitr</p>
    <p>License: MIT</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_019269">RRID:SCR_019269</ext-link>
    </p>
  </sec>
  <sec sec-type="data-availability" id="sec5">
    <title>Data Availability</title>
    <p>Datasets are publicly available at the Trans-Omics Precision Medicine (TOPMed) project [<xref rid="bib19" ref-type="bibr">19</xref>] and the 1000 Genomes Project [<xref rid="bib14" ref-type="bibr">14</xref>, <xref rid="bib20" ref-type="bibr">20</xref>]. Snapshots of the code, reports, and other supporting data are available from the <italic>GigaScience</italic> GigaDB repository [<xref rid="bib21" ref-type="bibr">21</xref>].</p>
  </sec>
  <sec id="sec6">
    <title>Additional Files</title>
    <p><bold>Figure S1</bold>. Definition of insert size tuple. The blue portion represents a reference genome backbone. The orange portion represents the extracted flanking region. The yellow portion represents a variant. The gray bars represent a pair of reads aligning to this flanking region.</p>
    <p><bold>Figure S2</bold>. Marginal distribution of maximum insert size and observed insert size in the reduced genome under 250 bp (short) and 1,000 bp (long) flanking length configuration. (Top) Marginal distribution of maximum insert size. (Right) Marginal distribution of observed insert size (green), along with true insert size distribution (blue) and adjusted insert size distribution (red). (Bottom) Scatter plot of read pairs with maximum insert size and observed insert size being coordinates. Blue dots represent read pairs mapped to the long flanking region; purple dots represent read pairs mapped to the short flanking region. The band between the line “y = x” and line “y = x + 150” shows read pairs that are partially mapped. The line “y = 2x − 500” and line “y = 2x − 2,000” are the effective boundaries where read pairs have both ObservedInsertSize and MaxInsertSize for 250- and 1,000-bp flanking region, respectively.</p>
    <p><bold>Figure S3</bold>. Biased insert size distribution in reduced genome under 250 bp (short) or 1000 bp (long) flanking length configuration. Each color represents 1 scenario of insert size estimation without correction. “Observed.LongRegion” (green) is when insert size distribution is estimated only using reads mapped to the long flanking region; “Observed.ShortRegion” (blue) is when only using reads mapped to the short flanking region; “True” (purple) is insert size distribution estimated under full genome alignment; “Adjusted” (red) is insert size distribution estimated by FASTQuick.</p>
    <p><bold>Item S1</bold>. Detailed quality assessment final report of HG00553 whole-genome dataset</p>
    <p><bold>Item S2</bold>. Detailed quality assessment final report of HG00553 exome dataset</p>
    <p><bold>Item S3</bold>. Detailed quality assessment final report of NA12878 whole-genome dataset</p>
    <p><bold>Table S1</bold>. Impact of mismatch threshold on <italic>k</italic>-mer-hash–based read filtering</p>
    <p><bold>Table S2</bold>. Summary statistics and visualization items produced by FASTQuick</p>
    <p><bold>Table S3</bold>. Estimation of PCR duplication rate on randomly selected 1000 Genomes Project samples</p>
    <p><bold>Table S4</bold>. Genotype comparison summary of sample HG00553 between FASTQuick and 1000 Genomes Project</p>
    <p><bold>Table S5</bold>. Comparison of genetic ancestry estimation between FASTQuick and VerifyBamID2</p>
  </sec>
  <sec id="sec7">
    <title>Abbreviations</title>
    <p>bp: base pairs; BWA: Burrows-Wheeler Aligner; BWT: Burrows–Wheeler transform; CPU: central processing unit; GC: guanine-cytosine; GPU: graphics processing unit; KS: Kolmogorov-Smirnov; QC: quality control; SNP: single-nucleotide polymorphism.</p>
  </sec>
  <sec id="sec9">
    <title>Competing Interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec id="sec10">
    <title>Funding</title>
    <p>This work was supported by HL137182 (to H.M.K. and F.Z.), HL117626, and MH105653 (to H.M.K.).</p>
  </sec>
  <sec id="sec11">
    <title>Authors’ Contributions</title>
    <p>F.Z. contributed to the coding material and experiments. Both authors wrote the manuscript and approved the final version of the manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>giab004_GIGA-D-20-00165_Original_Submission</label>
      <media xlink:href="giab004_giga-d-20-00165_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>giab004_GIGA-D-20-00165_Revision_1</label>
      <media xlink:href="giab004_giga-d-20-00165_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup3">
      <label>giab004_Response_to_Reviewer_Comments_Original_Submission</label>
      <media xlink:href="giab004_response_to_reviewer_comments_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup4">
      <label>giab004_Reviewer_1_Report_Original_Submission</label>
      <caption>
        <p>Simon Andrews -- 6/30/2020 Reviewed</p>
      </caption>
      <media xlink:href="giab004_reviewer_1_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup5">
      <label>giab004_Reviewer_2_Report_Original_Submission</label>
      <caption>
        <p>Tobias Rausch -- 8/25/2020 Reviewed</p>
      </caption>
      <media xlink:href="giab004_reviewer_2_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup6">
      <label>giab004_Reviewer_2_Report_Revision_1</label>
      <caption>
        <p>Tobias Rausch -- 12/10/2020 Reviewed</p>
      </caption>
      <media xlink:href="giab004_reviewer_2_report_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup7">
      <label>giab004_Supplemental_Files</label>
      <media xlink:href="giab004_supplemental_files.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="bib1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andrews</surname>  <given-names>S</given-names></string-name></person-group>, <comment>Babraham Bioinformatics. FastQC: A quality control tool for high throughput sequence data</comment><year>2010</year><comment><ext-link ext-link-type="uri" xlink:href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">https://www.bioinformatics.babraham.ac.uk/projects/fastqc/</ext-link>. Accessed 21 February 2020</comment>.</mixed-citation>
    </ref>
    <ref id="bib2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Martínez-Alcántara</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Ballesteros</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Feng</surname>  <given-names>C</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>PIQA: pipeline for Illumina G1 genome analyzer data quality assessment</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>:<fpage>2438</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">19602525</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Liu</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Liu</surname>  <given-names>F</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>HTQC: a fast quality control toolkit for Illumina sequencing data</article-title>. <source>BMC Bioinformatics</source>. <year>2013</year>;<volume>14</volume>:<fpage>33</fpage>.<pub-id pub-id-type="pmid">23363224</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Zhan</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Wing</surname>  <given-names>MK</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>QPLOT: a quality assessment tool for next generation sequencing data</article-title>. <source>Biomed Res Int</source>. <year>2013</year>;<volume>2013</volume>:<fpage>865181</fpage>.<pub-id pub-id-type="pmid">24319692</pub-id></mixed-citation>
    </ref>
    <ref id="bib5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>Broad Institute</collab>.</person-group>  <comment>Picard: A set of command line tools (in Java) for manipulating high-throughput sequencing (HTS) data and formats such as SAM/BAM/CRAM and VCF</comment>
<year>2016</year>
<comment><ext-link ext-link-type="uri" xlink:href="http://broadinstitute.github.io/picard/">http://broadinstitute.github.io/picard/</ext-link>. Accessed 21 February 2020</comment>.</mixed-citation>
    </ref>
    <ref id="bib6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jun</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Wing</surname>  <given-names>MK</given-names></string-name>, <string-name><surname>Abecasis</surname>  <given-names>GR</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>An efficient and scalable analysis framework for variant extraction and refinement from population-scale DNA sequence data</article-title>. <source>Genome Res</source>. <year>2015</year>;<volume>25</volume>:<fpage>918</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">25883319</pub-id></mixed-citation>
    </ref>
    <ref id="bib7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jun</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Flickinger</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Hetrick</surname>  <given-names>KN</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Detecting and estimating contamination of human DNA samples in sequencing and array-based genotype data</article-title>. <source>Am J Hum Genet</source>. <year>2012</year>;<volume>91</volume>:<fpage>839</fpage>–<lpage>48</lpage>.<pub-id pub-id-type="pmid">23103226</pub-id></mixed-citation>
    </ref>
    <ref id="bib8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Ruan</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Durbin</surname>  <given-names>R</given-names></string-name></person-group><article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title>. <source>Genome Res</source>. <year>2008</year>;<volume>18</volume>:<fpage>1851</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">18714091</pub-id></mixed-citation>
    </ref>
    <ref id="bib9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arjovsky</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Chintala</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Bottou</surname>  <given-names>L</given-names></string-name></person-group><article-title>Wasserstein generative adversarial networks</article-title>. In: <source>34th International Conference on Machine Learning</source>. <year>2017</year>, doi:<pub-id pub-id-type="doi">10.5555/3305381.3305404</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Satten</surname>  <given-names>GA</given-names></string-name>, <string-name><surname>Datta</surname>  <given-names>S</given-names></string-name></person-group><article-title>The Kaplan-Meier estimator as an inverse-probability-of-censoring weighted average</article-title>. <source>Am Stat</source>. <year>2001</year>;<volume>55</volume>:<fpage>207</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">28845048</pub-id></mixed-citation>
    </ref>
    <ref id="bib11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Durbin</surname>  <given-names>R</given-names></string-name></person-group><article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>:<fpage>1754</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="bib12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Handsaker</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Wysoker</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>:<fpage>2078</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="bib13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>International HapMap 3 Consortium</collab>.</person-group>  <article-title>Integrating common and rare genetic variation in diverse human populations</article-title>. <source>Nature</source>. <year>2010</year>;<volume>467</volume>:<fpage>52</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">20811451</pub-id></mixed-citation>
    </ref>
    <ref id="bib14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>1000 Genomes</surname>  <given-names>Project Consortium</given-names></string-name>, <string-name><surname>Auton</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Brooks</surname>  <given-names>LD</given-names></string-name>, <string-name><surname>Durbin</surname>  <given-names>RM</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>. <year>2015</year>;<volume>526</volume>(<issue>7571</issue>):<fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="bib15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Flickinger</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Taliun</surname>  <given-names>SAG</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Ancestry-agnostic estimation of DNA sample contamination from sequence reads</article-title>. <source>Genome Res</source>. <year>2020</year>;<volume>30</volume>:<fpage>185</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">31980570</pub-id></mixed-citation>
    </ref>
    <ref id="bib16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name></person-group><article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>:<fpage>3094</fpage>–<lpage>100</lpage>.<pub-id pub-id-type="pmid">29750242</pub-id></mixed-citation>
    </ref>
    <ref id="bib17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><comment>DRAGEN-BIO-IT-platform. <ext-link ext-link-type="uri" xlink:href="https://www.illumina.com/products/by-type/informatics-products/dragen-bio-it-platform.html">https://www.illumina.com/products/by-type/informatics-products/dragen-bio-it-platform.html</ext-link>. Accessed 21 February 2020</comment>.</mixed-citation>
    </ref>
    <ref id="bib18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><comment>Parabricks Genomic Analysis Pipelines. <ext-link ext-link-type="uri" xlink:href="https://resources.nvidia.com/en-us-r-genomics/announcing-nvidia-parabricks">https://resources.nvidia.com/en-us-r-genomics/announcing-nvidia-parabricks</ext-link>. Accessed 21 February 2020</comment>.</mixed-citation>
    </ref>
    <ref id="bib19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><comment>NHLBI Trans-Omics for Precision Medicine. <ext-link ext-link-type="uri" xlink:href="https://www.nhlbiwgs.org/">https://www.nhlbiwgs.org/</ext-link>. Accessed 21 February 2020</comment>.</mixed-citation>
    </ref>
    <ref id="bib20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><comment>IGSR: The International Genome Sample Resource Data. <ext-link ext-link-type="uri" xlink:href="https://www.internationalgenome.org/data/">https://www.internationalgenome.org/data/</ext-link>. Accessed 21 February 2020</comment>.</mixed-citation>
    </ref>
    <ref id="bib21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Kang</surname>  <given-names>HM</given-names></string-name></person-group><article-title>Supporting data for “FASTQuick: Rapid and comprehensive quality assessment of raw sequence reads.”</article-title>. <source>GigaScience Database</source>. <year>2020</year><pub-id pub-id-type="doi">10.5524/100850</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
