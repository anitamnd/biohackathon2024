<?all-math-mml yes?>
<?use-mml?>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD with MathML3 v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1-mathml3.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName nihms2pmcx2.xsl?>
<?ConverterInfo.Version 1?>
<?properties manuscript?>
<?origin nihpa?>
<?iso-abbr Cell Rep?>
<?submitter-system nihms?>
<?submitter-canonical-name Elsevier?>
<?submitter-canonical-id ELSEVIERAM?>
<?submitter-userid 8068823?>
<?submitter-authority myNCBI?>
<?submitter-login elsevieram?>
<?submitter-name Elsevier Author Support?>
<?domain nihpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">101573691</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">39703</journal-id>
    <journal-id journal-id-type="nlm-ta">Cell Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Cell Rep</journal-id>
    <journal-title-group>
      <journal-title>Cell reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2211-1247</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8195153</article-id>
    <article-id pub-id-type="pmid">33852839</article-id>
    <article-id pub-id-type="doi">10.1016/j.celrep.2021.108975</article-id>
    <article-id pub-id-type="manuscript">nihpa1693698</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Merged Affinity Network Association Clustering: Joint multi-omic/clinical clustering to identify disease endotypes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tyler</surname>
          <given-names>Scott R.</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chun</surname>
          <given-names>Yoojin</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ribeiro</surname>
          <given-names>Victoria M.</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Grishina</surname>
          <given-names>Galina</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Grishin</surname>
          <given-names>Alexander</given-names>
        </name>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hoffman</surname>
          <given-names>Gabriel E.</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Do</surname>
          <given-names>Anh N.</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bunyavanich</surname>
          <given-names>Supinda</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref ref-type="aff" rid="A3">3</xref>
        <xref rid="CR1" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label>Department of Genetics and Genomic Sciences, Icahn School of Medicine at Mount Sinai, New York, NY 10029, USA</aff>
    <aff id="A2"><label>2</label>Division of Allergy and Immunology, Department of Pediatrics, Icahn School of Medicine at Mount Sinai, New York, NY 10029, USA</aff>
    <aff id="A3"><label>3</label>Lead contact</aff>
    <author-notes>
      <fn fn-type="con" id="FN1">
        <p id="P1">AUTHOR CONTRIBUTIONS</p>
        <p id="P2">S.R.T. devised the MANAclust pipeline, performed analyses, drafted the manuscript, and developed the web applications. S.B. supervised the research, worked on the manuscript, and procured funding. S.B. and V.M.R. recruited the ARIA cohort and collected samples. S.B., G.G., and A.G. worked on sample processing and sequencing. Y.C., A.N.D., G.E.H., and S.B. processed the data and performed quality control and initial analyses. All authors critically reviewed and edited the manuscript.</p>
      </fn>
      <corresp id="CR1"><label>*</label>Correspondence: <email>supinda@post.harvard.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>18</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <day>13</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <volume>35</volume>
    <issue>2</issue>
    <fpage>108975</fpage>
    <lpage>108975</lpage>
    <!--elocation-id from pubmed: 10.1016/j.celrep.2021.108975-->
    <permissions>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY-NC-ND license (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">http://creativecommons.org/licenses/by-nc-nd/4.0/</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract id="ABS1">
      <title>SUMMARY</title>
      <p id="P3">Although clinical and laboratory data have long been used to guide medical practice, this information is rarely integrated with multi-omic data to identify endotypes. We present Merged Affinity Network Association Clustering (MANAclust), a coding-free, automated pipeline enabling integration of categorical and numeric data spanning clinical and multi-omic profiles for unsupervised clustering to identify disease subsets. Using simulations and real-world data from The Cancer Genome Atlas, we demonstrate that MANAclust’s feature selection algorithms are accurate and outperform competitors. We also apply MANAclust to a clinically and multi-omically phenotyped asthma cohort. MANAclust identifies clinically and molecularly distinct clusters, including heterogeneous groups of “healthy controls” and viral and allergy-driven subsets of asthmatic subjects. We also find that subjects with similar clinical presentations have disparate molecular profiles, highlighting the need for additional testing to uncover asthma endotypes. This work facilitates data-driven personalized medicine through integration of clinical parameters with multi-omics. MANAclust is freely available at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/scottyler892/manaclust/src/master/">https://bitbucket.org/scottyler892/manaclust/src/master/</ext-link>.</p>
    </abstract>
    <abstract id="ABS2" abstract-type="graphical">
      <title>Graphical abstract</title>
      <p id="P4">
        <graphic xlink:href="nihms-1693698-f0001.jpg" position="anchor" orientation="portrait"/>
      </p>
    </abstract>
    <abstract id="ABS3" abstract-type="summary">
      <title>In brief</title>
      <p id="P5">Clinical data commonly used in medical practice are underutilized in multi-omic analyses to identify disease endotypes. Tyler et al. present a python package called Merged Affinity Network Association Clustering (MANAclust) that automatically processes and integrates categorical and numeric data types, facilitating the inclusion of clinical data in multi-omic endotyping efforts.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec id="S1">
    <title>INTRODUCTION</title>
    <p id="P6">Complex diseases have multiple molecular etiologies yet result in concordant pathology stemming from multi-dimensional interactions between genetics and the environment (<xref rid="R40" ref-type="bibr">Tyler and Bunyavanich, 2019</xref>). Quantifying a single “ome” in a particular tissue will likely yield insufficiently granular details about a complex disease. To address these shortcomings, integrative multi-omics approaches have been developed (<xref rid="R24" ref-type="bibr">Nguyen etal., 2017</xref>; <xref rid="R31" ref-type="bibr">Rappoport and Shamir, 2018</xref>; <xref rid="R42" ref-type="bibr">Wang et al., 2014</xref>; <xref rid="R46" ref-type="bibr">Witten and Tibshirani, 2009</xref>), yet few allow for the additional integration of clinical data (e.g., from medical records, laboratory assays), despite the fact that clinical attributes are most often used to distinguish disease subtypes.</p>
    <p id="P7">One complex disease with disparate underlying causes is asthma. Although airway obstruction and inflammation are shared characteristics of asthma, underlying mechanisms leading to such pathophysiology are non-uniform. A well-understood subtype of asthma is Type 2 asthma, in which genetic susceptibility and allergen exposure lead to skewing toward T-helper 2 (T<sub>H</sub>2) cytokine-related inflammation, which upregulates airway inflammation and airway hyperresponsiveness, causing asthma (<xref rid="R40" ref-type="bibr">Tyler and Bunyavanich, 2019</xref>). However, other mechanisms of asthma underlie other subtypes. Subtypes of disease with distinct pathophysiological mechanisms are called endotypes (<xref rid="R40" ref-type="bibr">Tyler and Bunyavanich, 2019</xref>).</p>
    <p id="P8">Multi-omics can simultaneously characterize several molecular domains that may provide orthogonal information on mechanisms of a given endotype (<xref rid="R40" ref-type="bibr">Tyler and Bunyavanich, 2019</xref>). However, integrating heterogeneous clinical data with multi-omics presents several challenges, including differences in statistical properties and distributions, and for some clinical attributes, non-numeric features. Unsupervised clustering of categorical data is largely under-researched (<xref rid="R37" ref-type="bibr">Sreenivasulu et al., 2017</xref>), yet categorical clinical variables such as comorbidities and medication use are frequently used to subgroup patients for clinical diagnostics and treatment.</p>
    <p id="P9">Selecting features of a dataset that add structure or patterning is an important step prior to unsupervised clustering. Inclusion of unimportant features adds noise, drowning out meaningful signal. Feature selection for numeric datasets is effective for reducing dimensionality and noise (<xref rid="R2" ref-type="bibr">Andrews and Hemberg, 2018</xref>), yet this approach has rarely been applied to categorical datasets for unsupervised clustering. Previous approaches to multi-omic unsupervised clustering often skip feature selection.</p>
    <p id="P10">Although several algorithms exist for clustering categorical datasets (<xref rid="R10" ref-type="bibr">He et al., 2002</xref>; <xref rid="R35" ref-type="bibr">Sharma and Gaud, 2015</xref>), few exist to perform clustering on mixed categorical/numeric datasets (<xref rid="R14" ref-type="bibr">Ji et al., 2013</xref>), which are common to medicine. Integration of clinical data with multi-omics remains an outstanding challenge. There is need for algorithms designed for integration of multi-omics with clinical-categorical or mixed datasets that natively and automatically accommodate missing data fields and missing data types at the subject level, given how common missing data are in human research. Automated multi-omic approaches that perform unsupervised feature selection for both categorical and numeric datasets prior to clustering would advance the field.</p>
    <p id="P11">Given the increasing volume of clinical data being generated and exponential availability of omics, we recognized a need to develop an approach that can integrate these rich sources of information via a user-friendly pipeline for identifying disease subtypes. We have created an open-source package called Merged Affinity Network Association Clustering (MANAclust) that: (1) takes numeric or non-numeric datasets as input, allowing for missing subject-level categorical data and missing data types; (2) performs information theory-based categorical feature selection and numeric feature selection; (3) calculates merged affinity network associations across subjects and datasets; (4) identifies final clusters (FCs) using multi-omics data, as well as consensus groups within each ome or dataset; (5) analyzes differences across groups; (6) determines which dataset’s groups are significantly concordant with those of other datasets; and (7) creates a collated web display of all results (<xref rid="F1" ref-type="fig">Figure 1</xref>). Using simulations and real-world data, we demonstrate that MANAclust’s feature selection algorithms are highly accurate, and that MANAclust outperforms competitors in numeric multi-omics and categorical clustering. We then used MANAclust to identify endotypes in an asthma cohort of subjects who have been clinically phenotyped and undergone multi-omic profiling of their airways (<xref rid="R7" ref-type="bibr">Do et al., 2021</xref>), with the majority characterized in all data dimensions, but with subjects variably missing some data types, as is frequently the case in real-world datasets. MANAclust identified 14 clinically and molecularly distinct clusters of subjects, including heterogeneous groups of “healthy controls,” and viral and allergy-related endotypes. In addition to several algorithmic innovations, these findings lay the groundwork for clinically and molecularly tailored personalized medicine for asthma.</p>
  </sec>
  <sec id="S2">
    <title>RESULTS</title>
    <sec id="S3">
      <title>MANAclust</title>
      <p id="P12">To achieve joint clinical/multi-omics unsupervised clustering, we first created an algorithm for unsupervised feature selection of categorical data. To our knowledge, no automated solution exists for unsupervised categorical feature selection. For our goal—utilizing any type of clinical data (categorical or numeric), along with multi-omics for identifying disease subsets—we began from the premise that if categorical clinical variables are randomly distributed relative to one another, they will have lower relative mutual information compared with if they were non-random relative to one another. MANAclust quantifies the true amount of mutual information across variable pairs, comparing it with shuffled null versions of the dataset (<xref rid="F2" ref-type="fig">Figures 2A</xref>–<xref rid="F2" ref-type="fig">2C</xref>). We then calculate the difference between the observed pairwise feature-feature information in the real dataset compared with the shuffled datasets, calculating the information difference (<xref rid="F2" ref-type="fig">Figures 2D</xref> and <xref rid="F2" ref-type="fig">2E</xref>). This enables selection of categorical variables that are non-independent and give structure to the dataset (<xref rid="F2" ref-type="fig">Figure 2F</xref>). Additionally, we implemented a feature selection metric for traditional numeric omes (<xref rid="SD1" ref-type="supplementary-material">Figure S1</xref>; see <xref rid="S12" ref-type="sec">STAR Methods</xref> for details).</p>
      <p id="P13">To test these approaches, we created synthetic datasets in which subjects belonged to known groups with both categorical and numeric datasets containing features that were either designed to distinguish these groups or were purely random. Our categorical feature selection algorithm captured all real features while filtering out all random features, even with 50% missing data and 50% random noise added (<xref rid="SD1" ref-type="supplementary-material">Figures S2A</xref>–<xref rid="SD1" ref-type="supplementary-material">S2E</xref>). To benchmark numeric feature selection, we created synthetic datasets with 200 real features that discriminated groups and 10,000 features that were random noise. Our numeric feature selection algorithm captured an average of 95.8% of real features (i.e., recall), while consistently removing all random features (<xref rid="SD1" ref-type="supplementary-material">Figures S2F</xref>–<xref rid="SD1" ref-type="supplementary-material">S2J</xref>). As a classification problem (group-defining versus random features), our categorical feature selection algorithm had high accuracy, precision, recall, specificity, and F1 scores (T = 54.2, P = 1.24e–12, paired t tests relative to baseline; <xref rid="SD1" ref-type="supplementary-material">Figures S2A</xref>–<xref rid="SD1" ref-type="supplementary-material">S2E</xref>). Similarly, our feature selection algorithm for numeric datasets demonstrated high performance (P values: accuracy, 8.06e–19; precision, 7.85e–20; recall, 8.06e–19; specificity, 8.06e–19; F1 score 1.92e–20; paired t tests relative to baseline; <xref rid="SD1" ref-type="supplementary-material">Figures S2F</xref>–<xref rid="SD1" ref-type="supplementary-material">S2J</xref>). This benchmarking demonstrates that MANAclust’s feature selection algorithms accurately select the meaningful features in both categorical and numeric datasets to increase the signal-to-noise ratio of the inputs.</p>
      <p id="P14">We hypothesized that these feature selection algorithms would allow for more discretely discernable clusters of subjects. With synthetic data to benchmark, using all features showed little distinguishable patterns in subject-to-subject distance (<xref rid="SD1" ref-type="supplementary-material">Figures S3A</xref>, <xref rid="SD1" ref-type="supplementary-material">S3C</xref>, and <xref rid="SD1" ref-type="supplementary-material">S3E</xref>). However, the feature selected datasets showed the expected number of groups that were clearly discernable from one another (<xref rid="SD1" ref-type="supplementary-material">Figures S3B</xref>, <xref rid="SD1" ref-type="supplementary-material">S3D</xref>, and <xref rid="SD1" ref-type="supplementary-material">S3F</xref>). This enabled significantly more accurate clustering compared with using the whole datasets as measured by mutual information and cluster purity (<xref rid="SD1" ref-type="supplementary-material">Figures S3G</xref> and <xref rid="SD1" ref-type="supplementary-material">S3H</xref>; T = 84.1 and 215; P = 2.4e–14 and 5.12e–18, respectively; n = 10; t tests paired by dataset).</p>
    </sec>
    <sec id="S4">
      <title>Comparison with other multi-omic clustering approaches using real-world and synthetic datasets</title>
      <p id="P15">We aimed to benchmark MANAclust against several others designed for numeric multi-omics. We used a previously published benchmarking approach applied to 10 different cancer types from The Cancer Genome Atlas (TCGA) (<xref rid="R31" ref-type="bibr">Rappoport and Shamir, 2018</xref>) where performance was assessed by examining differences across clusters in clinical variables and differences in survival rates across clusters. We compared MANAclust with two generic clustering methods: K-means clustering (elbow rule for K-determination) (<xref rid="R20" ref-type="bibr">Lloyd, 1982</xref>), spectral clustering (elbow rule for K-determination) (<xref rid="R36" ref-type="bibr">Shi and Malik, 2000</xref>), and several multi-omics-specialized clustering approaches, including perturbation clustering for data integration and disease subtyping (PINS) (<xref rid="R24" ref-type="bibr">Nguyen et al., 2017</xref>), PINSPlus (<xref rid="R25" ref-type="bibr">Nguyen et al., 2019</xref>), Similarity Network Fusion (SNF) (<xref rid="R42" ref-type="bibr">Wang et al., 2014</xref>), and sparse multiple canonical correlation analysis (MCCA) (<xref rid="R46" ref-type="bibr">Witten and Tibshirani, 2009</xref>) (<xref rid="F3" ref-type="fig">Figure 3</xref>). MANAclust showed the greatest significant differences between the identified clusters, both by difference in survival rate and the number of clinical variables that differed significantly across clusters when clusters were identified based on all multi-omics data (<xref rid="F3" ref-type="fig">Figure 3A</xref>; <xref rid="SD2" ref-type="supplementary-material">Table S1</xref>). When operating only on the single-best ome per dataset, MANAclust consistently identified either the greatest number of differences between groups clinically or by survival time (<xref rid="F3" ref-type="fig">Figure 3B</xref>). This demonstrates that even operating without missing or categorical data (which the other algorithms cannot accommodate), MANAclust still consistently performs better. Furthermore, the competing methods all require custom programming from the user, whereas MANAclust is an open-source, hyper-parameter-free method of mixed data-type multi-omics unsupervised clustering that accommodates missing data from a command-line interface and generates a web-display walk-through of results for users.</p>
      <p id="P16">Although these results demonstrate that MANAclust provides good results for numeric datasets, we next sought to benchmark MANAclust in the purely categorical realm. We compared MANAclust with KModes (<xref rid="R12" ref-type="bibr">Huang, 1998</xref>) clustering with elbow rule based on within-cluster Hamming distances. Although both MANAclust and KModes clustering with elbow rule worked well in identifying the correct number of clusters, MANAclust significantly outperformed KModes in cluster purity and relative mutual information (F = 445.3, P = 1.39e–22 and F = 53.78, P = 8.75e–9, respectively; one-way ANOVA; <xref rid="F3" ref-type="fig">Figure 3C</xref>). Taken together with the multi-omics benchmark, these results demonstrate that MANAclust works well in both the numeric and categorical domains.</p>
    </sec>
    <sec id="S5">
      <title>MANAclust discovers clinically and molecularly distinguishable asthma endotypes</title>
      <p id="P17">Having demonstrated the accuracy of MANAclust, we applied the pipeline to data for a complex human disease known to have multiple mechanistic causes: asthma (<xref rid="R40" ref-type="bibr">Tyler and Bunyavanich, 2019</xref>). Many individuals with asthma have Type 2 asthma, a subtype of asthma mediated by Type 2 T helper (Th2) cells or innate lymphoid cells (ILC2s) (<xref rid="R38" ref-type="bibr">Sugita et al., 2018</xref>; <xref rid="R47" ref-type="bibr">Woodruff et al., 2009</xref>). Some common clinical characteristics of the Type 2 asthma endotype include: allergies, elevated levels of lung and/or peripheral eosinophils, total serum IgE, and allergen-specific IgE (sIgE) antibodies (<xref rid="R3" ref-type="bibr">Bunyavanich and Schadt, 2015</xref>; <xref rid="R18" ref-type="bibr">Liu et al., 2015</xref>; <xref rid="R22" ref-type="bibr">Nagasaki et al., 2017</xref>; <xref rid="R40" ref-type="bibr">Tyler and Bunyavanich, 2019</xref>). However, other less understood subtypes of asthma also exist (<xref rid="R19" ref-type="bibr">Liu et al., 2017</xref>; <xref rid="R33" ref-type="bibr">Ricciardolo et al., 2017</xref>; <xref rid="R45" ref-type="bibr">Wisniewski et al., 2018</xref>). To investigate potential mechanisms of asthma pathology in different subtypes, we applied MANAclust to data generated from the Airway in Asthma (ARIA) cohort (<xref rid="R7" ref-type="bibr">Do et al., 2021</xref>) of 316 subjects with asthma and healthy controls who underwent clinical phenotyping and profiling of airway transcriptome, microbiome, and/or methylome.</p>
      <p id="P18">MANAclust identified 14 different clusters of asthma and health based on clinical and multi-omic data. Following identification of these 14 FCs, MANAclust also identified “consensus groups” for each input data type. Dataset-level consensus groups define which FCs are indistinguishable from one another within the given dataset. For example, two FCs could share a similar transcriptome but two distinct microbiomes; these FCs would have the same transcriptome consensus group but two different microbiome consensus groups, thus separating them into distinct FCs. Each of these FCs can be defined by the unique combination of consensus groups defined by MANAclust (<xref rid="F4" ref-type="fig">Figures 4A</xref>–<xref rid="F4" ref-type="fig">4F</xref>).</p>
      <p id="P19">To test the efficacy of our approach for finding clinically meaningful differences between FCs, we tested whether the identified clusters differed significantly by treatment (which was excluded from the clinical attributes used for clustering). Indeed, asthma diagnosis (P = 5.28e–12, χ<sup>2</sup> with Benjamini-Hochberg correction), antibiotic usage (P = 1.78e–174, χ<sup>2</sup> with Benjamini-Hochberg correction), and oral steroid use (P = 3.64e–127, χ<sup>2</sup> with Benjamini-Hochberg correction) were significantly different across FCs, despite being held out from clustering. Note that the causal direction of these differences is unknown; for example, the treatments may cause changes in the transcriptome or vice versa. Of the clinical variables that were used for clustering, ranking among the most significant were measures related to atopy, including total serum IgE (P = 1.61e–195, χ<sup>2</sup> with Benjamini-Hochberg correction) and allergen-specific sensitization (defined by sIgE ≥ 0.10 kU<sub>A</sub>/L) to cat and dog dander (P = 1.70e–16, 1.37e–17, χ<sup>2</sup> with Benjamini-Hochberg correction), mouse urine (P = 1.52e–22, χ<sup>2</sup> with Benjamini-Hochberg correction), <italic>Blatella germanica</italic> cockroach (P = 3.11e–8, χ<sup>2</sup> with Benjamini-Hochberg correction), and others (<xref rid="SD3" ref-type="supplementary-material">Tables S2A</xref> and <xref rid="SD3" ref-type="supplementary-material">S2B</xref>). Along with total serum IgE levels, each of these specific allergens has previously been implicated in asthma control (<xref rid="R15" ref-type="bibr">Kanchongkittiphon et al., 2015</xref>; <xref rid="R34" ref-type="bibr">Rotsides et al., 2010</xref>). As we will discuss later, however, some subjects who present with nearly identical symptoms may respond differently to various medications. It is therefore critical to determine which subjects may present the same clinically yet have disparate molecular underpinnings. It is also important to fully understand the heterogeneity among “healthy controls.”</p>
    </sec>
    <sec id="S6">
      <title>Control groups are highly diverse</title>
      <p id="P20">There was not a single “control” group of healthy individuals. Instead, we observed five different FCs that corresponded to low prevalence of asthma and high asthma control test (ACT) scores (FCs 3, 7, 8, 9, and 13) (<xref rid="F4" ref-type="fig">Figure 4F</xref>). This finding supports the long-held understanding that there is not one single way to be healthy. Considering such disparate, yet healthy subjects as a single control group, rather than recognizing them as a collection of different subgroups, may obscure differences that might otherwise be detected if their subgroup memberships were recognized.</p>
    </sec>
    <sec id="S7">
      <title>Understanding each molecular subtype</title>
      <p id="P21">Although our main goal is to examine how each molecular data type fits with others and with clinical attributes, it is important to first develop a biologic understanding of each consensus group within each data type. To better understand the differences across consensus groups in the transcriptome and methylome, we performed comparisons of consensus group-enriched genes, co-expression/-methylation network graphs, module analyses, and predicted autocrine-paracrine signaling within each consensus group using PyMINEr (<xref rid="R41" ref-type="bibr">Tyler et al., 2019</xref>). In the transcriptome, we observed pathway-level differences across consensus groups relating to ciliated cells and replication (transcriptome consensus group 0) and leukocyte activation (transcriptome consensus group 1) (<xref rid="F4" ref-type="fig">Figure 4A</xref>; <xref rid="SD3" ref-type="supplementary-material">Table S2C</xref>).</p>
      <p id="P22">Of interest was the significant concordance between the transcriptome consensus group corresponding to leukocyte activation (transcriptome consensus group 1) and the methylome consensus group characterized by enrichment of the cell adhesion with leukocyte/lymphocyte activation (methylome consensus group 1) (P ≈ 0; <xref rid="F4" ref-type="fig">Figures 4B</xref>, <xref rid="SD1" ref-type="supplementary-material">S4A</xref>, and <xref rid="SD1" ref-type="supplementary-material">S4B</xref>; <xref rid="SD3" ref-type="supplementary-material">Table S2D</xref>). Also pertinent to asthma, we observed enrichment of T cell activation signaling by pathway analysis in methylome consensus group 0.</p>
      <p id="P23">At the microbiome level, consensus groups differed primarily by the four most abundant genera (<xref rid="F4" ref-type="fig">Figure 4C</xref>). One microbiome consensus group (2; <xref rid="F4" ref-type="fig">Figure 4C</xref>) had exceptionally high levels of <italic>Moraxella</italic>, with marked reduction in <italic>Corynebacteria</italic> and other genera resulting in low alpha diversity (<xref rid="SD1" ref-type="supplementary-material">Figure S4D</xref>; one-way ANOVA: Chao1 F = 52.57, P = 9.88e–34; Shannon F = 44.0, P = 3.35e–29; microbiome consensus group 2 significance against all other groups P ≤ 0.01; Tukey’s Honestly Significant Difference (HSD) post hoc test).</p>
      <p id="P24">Consensus groups within the clinical dataset differed largely based on allergy-related parameters. Additionally, although disease diagnosis and treatments were not included for clustering, these variables segregated across clinical consensus groups (<xref rid="F4" ref-type="fig">Figure 4D</xref>). Type 2 asthma, the best described endotype of asthma, corresponded to clinical consensus groups 0 and 1, while the healthiest group with little asthma and very few allergies corresponded to consensus group 4. Interestingly, subjects in consensus group 5 harbored very few allergies but had the highest rates of asthma. Consensus group 5 had significantly more recent upper respiratory infections (URIs) compared with other groups (mode: URI within past month; χ<sup>2</sup> = 303.8; P = 2.69e–44, Benjamini-Hochberg corrected; <xref rid="SD3" ref-type="supplementary-material">Table S2E</xref>). This fits with prior reports of viral infection being a well-characterized trigger of asthma exacerbations (<xref rid="R1" ref-type="bibr">Altman et al., 2019</xref>).</p>
      <p id="P25">Simply characterizing each dataset’s consensus group provides limited insights into the multi-factorial nature of a disease, however; multi-omics enables us to observe how these single datasets weave together to form a holistic picture of an individual’s pathobiologic type.</p>
    </sec>
    <sec id="S8">
      <title>Consensus groups combine to define endotypes</title>
      <p id="P26">Each FC is derived from the combination of consensus groups from each of the input datasets (<xref rid="F4" ref-type="fig">Figures 4E</xref> and <xref rid="F4" ref-type="fig">4F</xref>). Prior attempts to derive endotypes of disease frequently used only a single data type (<xref rid="R11" ref-type="bibr">Howrylak et al., 2016</xref>; <xref rid="R16" ref-type="bibr">Kuo et al., 2017</xref>; <xref rid="R17" ref-type="bibr">Liang et al., 2015</xref>; <xref rid="R26" ref-type="bibr">Nicodemus-Johnson et al., 2016</xref>). A major outstanding question is whether groups identified by one data type are redundant or orthogonal to those identified by another data type. To address this question, MANAclust calculates (1) the most frequent chi-square statistics to determine if consensus groups across data types provide completely orthogonal or partly concordant groups (<xref rid="SD1" ref-type="supplementary-material">Figures S4A</xref>–<xref rid="SD1" ref-type="supplementary-material">S4C</xref>), and (2) the Bayesian empirical probability that subjects belong to each consensus group of other datasets given that they were members of a consensus group from a different data type (<xref rid="F4" ref-type="fig">Figure 4G</xref>). Although these Bayesian probabilities have been argued to be related to causality (<xref rid="R44" ref-type="bibr">Williamson, 2009</xref>), external intervention in the form of clinical trials would be needed to verify causal relationships (<xref rid="R28" ref-type="bibr">Pearl, 2009</xref>).</p>
      <p id="P27">We observed that some consensus groups did indeed carry redundant information across data types. However, other consensus groups carried orthogonal information that was not concordant with consensus groups of other input data types (<xref rid="F4" ref-type="fig">Figures 4G</xref> and <xref rid="SD1" ref-type="supplementary-material">S4A</xref>–<xref rid="SD1" ref-type="supplementary-material">S4C</xref>). For example, clinical consensus group 4, with the lowest prevalence of asthma and allergy markers, was significantly concordant with consensus groups from each other data type (<xref rid="F4" ref-type="fig">Figure 4G</xref>), including microbiome consensus group 0, with highest abundance of <italic>Corynebacterium</italic>, which was previously associated with health and protection from asthma (<xref rid="R50" ref-type="bibr">Zhou et al., 2019</xref>). This combination of consensus groups creates FC 8, with the lowest percentage of asthma and highest ACT score (<xref rid="F4" ref-type="fig">Figure 4F</xref>).</p>
      <p id="P28">Another consensus group that showed strong concordance across data types was the microbiome group with extremely low alpha diversity (<xref rid="SD1" ref-type="supplementary-material">Figure S4D</xref>) dominated by <italic>Moraxella</italic> (<xref rid="F4" ref-type="fig">Figure 4G</xref>). This group was strongly associated with the methylome profile enriched for lymphocyte and leukocyte adhesion and activation (methylome consensus 1). This methylome profile was further associated with a transcriptional profile related to the immune system and leukocyte activation (transcriptome consensus 1; <xref rid="F4" ref-type="fig">Figure 4A</xref>; <xref rid="SD3" ref-type="supplementary-material">Table S2D</xref>).</p>
    </sec>
    <sec id="S9">
      <title>Clinically indistinguishable subjects harbor disparate molecular drivers of asthma</title>
      <p id="P29">There were many cases in which consensus group membership segregated non-randomly across datasets, indicating non-orthogonality across these datasets, as represented by all edges in <xref rid="F4" ref-type="fig">Figure 4G</xref>. However, two clinical consensus groups shared no significant segregation across different datasets, clinical consensus groups 1 and 3. This indicates that two subjects may present with similar clinical parameters yet have highly divergent underlying molecular signatures. This scenario suggests potential reasons for trial-and-error aspects of some asthma treatment (<xref rid="R39" ref-type="bibr">Tesse et al., 2018</xref>).</p>
      <p id="P30">Lastly, although we have focused on selected FCs and consensus groups, several other FCs remain that were mixed between asthma and control groups. This may point toward well-controlled asthma that phenocopies controls, or that sampling additional tissue such as bronchial epithelium closer to the site of pathology may provide orthogonal measures that could refine these subgroups more clearly.</p>
    </sec>
    <sec id="S10">
      <title>Integration of clinical and numeric data improves endotype identification</title>
      <p id="P31">To assess the impact of the integration of clinical and numeric data in the ARIA cohort, we compared the significance of our full analysis with all data to performances using only the clinical data, all numeric data, or each numeric data type alone. We quantified the maximum significance by −log10(P value) of each clustering run’s held-out clinical variables based on either FCs or consensus groups with the noted inputs. Use of all data provided the greatest significance in held-out clinical variables (<xref rid="F4" ref-type="fig">Figure 4H</xref>). This was also true when normalizing for each hold-out variable’s lowest level of significance (<xref rid="F4" ref-type="fig">Figure 4I</xref>).</p>
    </sec>
  </sec>
  <sec id="S11">
    <title>DISCUSSION</title>
    <p id="P32">We have created an open-source tool called MANAclust that enables automated integration of clinical datasets and omics for unsupervised clustering. The categorical and numeric feature selection algorithms implemented in MANAclust are highly accurate, enabling successful stratification of clinically meaningful groups using real-world data from both TCGA and the ARIA cohort. We used MANAclust to uncover the heterogeneity of “healthy controls,” as well as several endotypes of asthma, including those driven by URIs, allergies, and a subset with <italic>Moraxella</italic>-dominated airway microbiomes. We also observed two sets of asthma subjects for whom underlying molecular characteristics were statistically independent from their clinical presentation. MANAclust paves the road to data-driven personalized medicine through the identification of subject clusters not only by multi-omics but also by incorporating clinical parameters that have long been used independently in diagnostics and care.</p>
  </sec>
  <sec id="S12">
    <title>STAR★METHODS</title>
    <sec id="S13">
      <title>RESOURCE AVAILABILITY</title>
      <sec id="S14">
        <title>Lead contact</title>
        <p id="P33">Further information and requests for resources should be directed to Dr. Supinda Bunyavanich (<email>supinda@post.harvard.edu</email>).</p>
      </sec>
      <sec id="S15">
        <title>Materials availability</title>
        <p id="P34">This study did not generate new unique reagents other than those reported in Data and Code Availability.</p>
      </sec>
      <sec sec-type="data-availability" id="S16">
        <title>Data and code availability</title>
        <p id="P35">TCGA benchmarking datasets are available at Synapse (<ext-link ext-link-type="uri" xlink:href="https://www.synapse.org">https://www.synapse.org</ext-link>; <ext-link ext-link-type="doi" xlink:href="10.7303/syn21301852">https://doi.org/10.7303/syn21301852</ext-link>). Subject-level data for ARIA participants have not been made publicly available because subjects did not consent to public release of their data. Data to generate figures and tables are available from the corresponding author with the appropriate permission from the study team and investigators upon reasonable request and institutional review board approval. All code used for this project is available at the public repository: <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/scottyler892/manaclust/src/master/">https://bitbucket.org/scottyler892/manaclust/src/master/</ext-link>.</p>
      </sec>
    </sec>
    <sec id="S17">
      <title>EXPERIMENTAL MODEL AND SUBJECT DETAILS</title>
      <sec id="S18">
        <title>Human Subjects</title>
        <p id="P36">All subjects from the AiRway in Asthma (ARIA) study (<xref rid="R7" ref-type="bibr">Do et al., 2021</xref>) provided written informed consent for study participation and the study was approved by the Mount Sinai Health System Internal Review Board (IRB). Subjects were recruited at the Icahn School of Medicine at Mount Sinai for phenotyping and nasal sampling. Subjects with severe asthma were diagnosed as having severe persistent asthma by a pulmonologist based on Severe Asthma Research Program criteria (<xref rid="R21" ref-type="bibr">Moore et al., 2007</xref>) Subjects with mild/moderate persistent asthma were diagnosed based on ≥ 2 symptoms per week, use of an inhaled bronchodilator ≥ twice weekly or use of daily medication for asthma, and increased airway responsiveness to methacholine (PC20 ≤ 12.5 mg/ml). Non-asthmatic controls had no personal or family history of asthma in first-degree relatives, normal spirometry, and no bronchodilator response). Phenotyping for all subjects included detailed questionnaires on asthma-related symptoms, medication use, and spirometry following American Thoracic Society guidelines (<xref rid="R23" ref-type="bibr">National Asthma Education and Prevention Program, 2007</xref>). The ARIA subjects studied comprised individuals age 4 to 60 years, including 158 females and 158 males.</p>
      </sec>
    </sec>
    <sec id="S19">
      <title>METHOD DETAILS</title>
      <sec id="S20">
        <title>Handling numeric datasets in MANAclust</title>
        <sec id="S21">
          <title>Numeric dataset input</title>
          <p id="P37">Numeric datasets are fed into MANAclust as tab delimited files in which the samples, or subject IDs are organized in columns and the features are organized in rows.</p>
        </sec>
        <sec id="S22">
          <title>Numeric feature selection</title>
          <p id="P38">Numeric features to be used for clustering are selected using an anti-correlation-based metric. The first step of this process is determining what qualifies as a ‘significant’ negative correlation. Because each dataset has unique data distribution characteristics with variable power, we use an empirically determined false positive rate generated by a null distribution. This null distribution of Spearman correlations is created through bootstrap shuffling of all values within a gene (or numeric attribute); this unpairs all X-Y relationships in the original dataset, creating an empirical null dataset (<xref rid="SD1" ref-type="supplementary-material">Figure S1A</xref>). The Spearman correlations are then measured across variables (<xref rid="SD1" ref-type="supplementary-material">Figure S1B</xref>). Next, the negative correlations are subset from this data, and this vector is concatenated to its own negative, creating a Gaussian. The cutoff for significance is then determined by taking the mean minus 4 standard deviations (<xref rid="SD1" ref-type="supplementary-material">Figure S1C</xref>). The empirical false positive rate is then measured; because these values were created from a bootstrap shuffled version of the dataset, all measures over the cutoff are false positives. Next the Spearman correlation matrix is calculated on the real, unshuffled dataset. Next, for each variable, the total number of observed negative correlations is calculated (O<sub>t</sub>) (<xref rid="SD1" ref-type="supplementary-material">Figure S1D</xref>). For each feature, the number of negative correlations is quantified, and the expected number of observations less than the negative Rho cutoff (E<sub>sig</sub>) is calculated from the empiric false positive rate (<xref rid="SD1" ref-type="supplementary-material">Figure S1E</xref>). A feature is considered significantly anti-correlated if it has more significant anti-correlations than expected by random chance (≥Mult * E<sub>sig</sub>; <xref rid="SD1" ref-type="supplementary-material">Figure S1F</xref>). The power in detecting these correlations is dependent on the number of samples; we therefore created a dynamic cutoff scaling with the log of the number of samples. This provides a cutoff for variable inclusion or exclusion for downstream clustering (<xref rid="SD1" ref-type="supplementary-material">Figures S1G</xref> and <xref rid="SD1" ref-type="supplementary-material">S1H</xref>).</p>
        </sec>
      </sec>
      <sec id="S23">
        <title>Handling categorical datasets in MANAclust</title>
        <sec id="S24">
          <title>Categorical dataset input</title>
          <p id="P39">Categorical datasets should be in fed into MANAclust in an m × n matrix where (m) subjects are in rows, while the (n) categorical dataset variables are in columns. The missing values of all variables must be a standard string that is fed into the argument ‘-missing_data’. In the case of our dataset, we used the ‘N/A’ string. Note that per-variable missing values only pertain to categorical datasets. It is presumed that individual variables will not be missing from numeric datasets; for example, a transcriptomic dataset would have measures for all genes rather than only for some, and missing values for other genes. In all cases however, MANAclust natively handles subject-level missing datasets regardless of numeric/categorical status. If a subject has missing data for all variables within a dataset, it is treated as if the subject is removed from the dataset entirely given that there are no measures.</p>
        </sec>
        <sec id="S25">
          <title>Numeric values contained within categorical datasets</title>
          <p id="P40">If MANAclust finds ≥ 10 numeric values contained within a categorical dataset, these are digitized linearly into bins. The number of bins scales with the number of observed values as follows:
<disp-formula id="FD1"><mml:math display="block" id="M1"><mml:mrow><mml:mtext mathvariant="italic">bins</mml:mtext><mml:mo>=</mml:mo><mml:mtext mathvariant="italic">max</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msqrt><mml:mtext>n</mml:mtext></mml:msqrt></mml:mrow><mml:mn>5</mml:mn></mml:mfrac></mml:mrow></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
Where n = the number of observations for the given variable. In this manner, numeric attributes contained within categorical data are turned into categorical class labels. This enables a mutual information style integration of numeric values alongside categorical values. This equation was used, because to provide meaningful information, at least two bins are necessary, and we sought to scale with <inline-formula><mml:math display="inline" id="M2"><mml:mrow><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>, in a manner similar to variance. Hoping to capture at least 5 samples in each <inline-formula><mml:math display="inline" id="M3"><mml:mrow><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula> scaled bin, we divided by 5, and applied the floor operator.</p>
        </sec>
        <sec id="S26">
          <title>Categorical label encoding</title>
          <p id="P41">Categorical variables are one-hot-encoded into binary matrices representing the category membership using the sklearn functions LabelEncoder and OneHotEncoder (<xref rid="R29" ref-type="bibr">Pedregosa et al., 2011</xref>). In the case that a subject is missing this feature, no entry is added to this matrix, leaving an empty (zero filled) matrix in its stead.</p>
        </sec>
        <sec id="S27">
          <title>Categorical feature selection</title>
          <p id="P42">For feature selection, the mutual information is calculated for both the real and bootstrap shuffled versions of the dataset (<xref rid="F2" ref-type="fig">Figure 2A</xref>). This creates the symmetric mutual information matrix comparing all features to each other for both the real dataset and the randomized bootstrap shuffled datasets (<xref rid="F2" ref-type="fig">Figures 2B</xref> and <xref rid="F2" ref-type="fig">2C</xref>).</p>
          <p id="P43">The mutual information matrix from the real dataset is then subtracted from the mutual information calculated from shuffled datasets, creating <bold>R</bold>, an n × n × i matrix, where n = the number of features in the categorical dataset, while i = the number of iterations used for bootstrap shuffling (<xref rid="F2" ref-type="fig">Figure 2C</xref>). The default for the number of iterations is 10. This matrix is filled with the measured mutual information of all feature-feature pairs in the randomly shuffled datasets. Next the difference between the mutual information in the real dataset and shuffled versions are calculated for each feature-feature pair, creating the information difference matrix <bold>IDM</bold> (n × n × i). Next, the minimum of <bold>IDM</bold> along the third axis (i) is taken to generate the minimum difference matrix <bold>MDM</bold> (n × n). For each feature-feature pair of this matrix, the entry in <bold>MDM</bold> represents the iteration of the randomized matrices, for which the difference between the real dataset and the randomized dataset was the least. In other words, given all of the random iterations – what was the worst-case scenario for this feature-feature pair compared to the randomized versions. The <bold>MDM</bold> matrix is then flattened, using the maximum function along one of the axes of this symmetric matrix, yielding a one-dimensional vector <italic>MMD</italic> (Maximum of Minimum Difference). In <italic>MMD</italic>, each feature’s best feature-feature pair from <bold>MDM</bold> is taken, meaning – for each feature, what was the pair in which there was the most information relative to the randomized datasets. Then, a cutoff is applied to include features that have enough information in their best feature-feature pair. The features that pass this metric are then included in the final feature selected dataset for categorical datasets.</p>
        </sec>
        <sec id="S28">
          <title>Affinity matrix calculation with categorical datasets</title>
          <p id="P44">First, the average log-loss/categorical cross entropy comparing all subjects to one another is calculated using the one-hot-encodings described above, including only the variables for which both subjects have non-missing values. The log-loss function is implemented in mana_clust.mana_cat.log_loss, but were computed using the scikit-learn sklearn.metrics.log_loss function (<xref rid="R29" ref-type="bibr">Pedregosa et al., 2011</xref>). Next, the negative squared Euclidean distance (affinity matrix) is calculated on this log-loss matrix. In the event that a subject-subject pair has no mutual measures for a categorical dataset, this subject-subject affinity is filled in by the median of all other affinities for this dataset. To prevent invariant measures in the affinity matrix, we perform a smoothing process in which the affinity matrix has Gaussian noise added with mean equivalent to the minimum of the zero masked affinity matrix.</p>
          <p id="P45">To account for variable distributions in affinity matrices, the affinity matrix is linear normalized to be between 0 and −100 where the sample pairs that are the most different from each other map to −100 and those that are most similar map to 0. Note that self-similarities are not considered in the normalization, thus only the most similar two samples are normalized to 0 rather than the self-comparison diagonal of the affinity matrix mapping to 0. This normalizes the scale of all affinity matrices, enabling their combination with equal weight given to each dataset.</p>
        </sec>
      </sec>
      <sec id="S29">
        <title>Combining all categorical and numeric affinity matrices in MANAclust</title>
        <p id="P46">Once all affinity matrices are calculated, they are concatenated along a third axis, followed by taking the missing-value-compatible mean. This process evaluates the average affinity across all omes. If two subjects do not have any overlap in the datasets that they have in common, this location in the final merged affinity matrix is filled in with the median of affinities for all subjects that do have at least one shared dataset.</p>
      </sec>
      <sec id="S30">
        <title>Clustering in MANAclust</title>
        <p id="P47">The combined affinity matrix between omes is first fed into the affinity propagation algorithm (<xref rid="R8" ref-type="bibr">Frey and Dueck, 2007</xref>). However, under some circumstances, the affinity propagation algorithm may fail to converge on appropriate exemplars (points central to a cluster, similar to medoids), resulting in singlet clusters. To account for this, we employ a secondary step following affinity propagation in which the affinities from all singlet clusters are subset, and re-clustered using Louvain modularity of a network built from these affinities as follows: A network is created from the subset affinity matrix. The weight of all edges with less affinity than the median of the full affinity matrix is set to zero. The remaining edges are built from inverse negative affinities from the affinity matrices described above; weighted Louvain modularity is then performed on the resultant network.</p>
      </sec>
      <sec id="S31">
        <title>Consensus group identification in MANAclust</title>
        <p id="P48">To define consensus groups, MANAclust takes the members of each of the final clusters and compares their calculated affinities for each dataset with the goal of determining whether two final clusters are derived from the same distribution of affinities within each input dataset. This is done by sub-setting each affinity matrix of an input dataset for each final cluster pair (we will use A and B for illustrative reasons). Next, the within dataset affinities for subject-subject pairs within FC A and within FC B are taken; these are concatenated into a single vector. Next, the affinities across these two FCs are taken (FC A to FC B affinities and reverse); these are then flattened into a single vector. These two vectors are compared to each other by t test. All pairwise comparisons of each FC to all other FCs are performed, creating a symmetric probability matrix that represents the probability that each FC-FC pair came from the same distribution. These P values are then Benjamini-Hochberg corrected for multiple comparisons. Lastly, these probabilities are modularized through Louvain community detection. The communities identified are the consensus groups for each dataset.</p>
      </sec>
      <sec id="S32">
        <title>Synthetic datasets for benchmarking MANAclust</title>
        <p id="P49">To test the efficacy of MANAclust, we created synthetic datasets that contained one categorical dataset (two groups), and two numeric datasets (three groups each). Each dataset’s individual clusters were created independently from one another in which each dataset provided orthogonal information; this yielded 2*3*3 = 18 FCs that were unique from each other. Categorical datasets harbored 15 of the 165 features of this dataset discriminated the two groups from each while all others were variables that subjects were randomly assigned a category. 50% of the entirety of these datasets was also assigned to a random category to introduce noise to the real variables. Lastly, 50% of this dataset was masked with missing values. Numeric datasets contained a total of 10,200 features, 200 of which were real features that discriminated groups while the remaining variables were random, drawing from a Gaussian distribution. Source code for dataset generation and comparisons is contained in the simulate_datasets.py and run_simulation_study.py files of the MANAclust distribution package.</p>
        <p id="P50">For benchmarking purely categorical data clustering, we compared MANAclust to the KModes (as implemented in the python ‘kmodes’ pip package) using the elbow rule based on sum of the within-group Hamming distances as implemented in SciPy’s scipy.spatial.distance.hamming function. In this implementation of the elbow rule, we used the greatest value from the second derivative of the sum of within-group distances versus group number curve. 50 real features, and 100 random features were simulated to create 5, 10, 15, and 20 groups from a total of 1000 simulated subjects, with 50% noise added to the data. Each scenario was simulated 5 times. Significance for differences in method purity and relative mutual information was determined by the stats.f_oneway function from the SciPy package.</p>
      </sec>
      <sec id="S33">
        <title>The Cancer Genome Atlas (TCGA) benchmarking of MANAclust</title>
        <p id="P51">Our code was adapted from a previously published pipeline with several minor differences (<xref rid="R31" ref-type="bibr">Rappoport and Shamir, 2018</xref>). There were several algorithms that were not included in our analysis either because they required a MATLAB license (MultiNMF), were not open source (LRAcluster and rMKL-LP), or took prohibitively long to run (iClusterBayes). We allowed each algorithm to perform clustering (and any embedded dimension reduction or feature selection within each method).</p>
      </sec>
      <sec id="S34">
        <title>Clinical Datasets</title>
        <sec id="S35">
          <title>Allergen sensitization</title>
          <p id="P52">Allergen sensitization as reported in <xref rid="F4" ref-type="fig">Figure 4D</xref> was calculated as the percent of allergens (that were tested) with specific sIgE levels (sIgE) ≥ 0.10 kU<sub>A</sub>/L. Specific sIgE levels were measured for the following allergens: <italic>Dermatophagoides pteronyssinus</italic>, <italic>Dermatophagoides farinae</italic>, cat dander, dog dander, mouse, <italic>Blatella germanica</italic> (cockroach), grass mix, mold yeast mix, tree pollen mix, weed pollen mix (<xref rid="R30" ref-type="bibr">Pham et al., 2019</xref>). For the 2 subjects who did not have all ten sIgE levels measured, the percent of the tested allergens that were above the 0.10 threshold are reported in <xref rid="F4" ref-type="fig">Figure 4D</xref>.</p>
        </sec>
        <sec id="S36">
          <title>Asthma percentage in consensus groups</title>
          <p id="P53">The % Asthma reported in <xref rid="F4" ref-type="fig">Figures 4D</xref> and <xref rid="F4" ref-type="fig">4F</xref> was the percentage of subjects from the respective cluster or consensus group who answered yes to “Has a doctor ever diagnosed you with asthma”?. This information was not used for clustering.</p>
        </sec>
      </sec>
      <sec id="S37">
        <title>Nasal RNaseq processing and consensus group analysis</title>
        <p id="P54">Nasal samples were collected using a cytology brush and placed in RNAlater (<xref rid="R7" ref-type="bibr">Do et al., 2021</xref>). RNA was isolated using the QIAGEN RNeasy mini kit. Libraries were prepared with the TruSeq RNA Sample Prep Kit v2. Samples were then sequenced on the Illumina HiSeq 2500 platform. Samples were aligned to the Ensembl human genome version 38 using the Salmon 0.13.1 aligner and sum collated to the gene level (<xref rid="R27" ref-type="bibr">Patro et al., 2017</xref>; <xref rid="R49" ref-type="bibr">Zerbino et al., 2018</xref>). For all analyses, log2(TPM+1) units were used.</p>
      </sec>
      <sec id="S38">
        <title>Methylation data processing and consensus group analysis</title>
        <p id="P55">Nasal samples were collected from subjects and DNA was isolated using the QIAGEN DNeasy Mini Kit. Methylation was quantified using the Illumina Infinium MethylationEPIC v1.0 array with processing of the methylation data using the ENmix package (version 1.18.1) in R version 3.5.1. Two samples were excluded due to with low quality CpG calls (&gt; 10% of loci with CpG detection P value &gt; 0.01). CpGs on sex chromosomes were also excluded for clustering. Low-quality CpGs, as defined by those with low confidence calls in &gt; 10% of samples, or CpGs with distinctly multi-modal distributions were removed. CpGs with known SNPs were also removed, as array hybridization could be affected by subject-specific mismatches at these loci. Samples were quantile normalized with ENmix (<xref rid="R48" ref-type="bibr">Xu et al., 2016</xref>). For clustering, percent methylated values were used, while for pathway analyses, percent unmethylated was used to provide a presumed correlate with gene expression. For analysis with MANAclust, overdispersed loci were used as defined by PyMINEr,(<xref rid="R41" ref-type="bibr">Tyler et al., 2019</xref>) using a Z-score of &gt; = 2 from the residual from the Lowess fit of mean to variance relationship.</p>
        <p id="P56">For analysis of consensus groups with PyMINEr, only the subset of loci with “promoter associated” annotations were used. This matrix was then converted to percent unmethylated by subtracting percent methylated from 1; this was done to provide a correlate with presumed gene expression where less promoter methylation thought to track with higher transcription. Lastly, this matrix was filtered for loci mapping to a gene symbol, then the average of each gene symbol was taken.</p>
      </sec>
      <sec id="S39">
        <title>Microbiome processing and consensus group analysis</title>
        <p id="P57">The V3V4 16S amplicons were amplified from nasal DNA samples using the Illumina “16S Metagenomic Sequencing Library Preparation” protocol (<xref rid="R13" ref-type="bibr">Illumina, 2013</xref>). Library prep was performed using the Nextera XT Index Kit v2. Illumina MiSeq platform with 2×250bp paired-end reads were used for sequencing. SEQTK 1.2 was used to trim primer regions and low quality bases from the ends of reads. Reads were demultiplexed using Qiime version 1.9.1 and OTUs were picked with similarity 97% using the Greengenes database version 13.8 reference (<xref rid="R4" ref-type="bibr">Caporaso et al., 2010</xref>). To account for differences in read-depth, samples were rarefied to 2048 counts total for each sample, thus normalizing for variance in total depth across samples (<xref rid="R5" ref-type="bibr">Chun et al., 2020</xref>; <xref rid="R43" ref-type="bibr">Weiss et al., 2017</xref>). This OTU matrix was then log2 transformed prior to analysis: log2(OTU+1).</p>
        <p id="P58">MicrobiomeAnalyst was used to analyze MANAclust’s defined consensus groups for differential abundance and alpha diversity measures as indicated in <xref rid="F4" ref-type="fig">Figure 4C</xref> (<xref rid="R6" ref-type="bibr">Dhariwal et al., 2017</xref>). Data shown in <xref rid="F4" ref-type="fig">Figure 4D</xref> represents genus level quantifications to show a high-level view of the microbiome, while the input dataset for clustering was OTU level quantifications (<xref rid="R6" ref-type="bibr">Dhariwal et al., 2017</xref>). Filtered Chao1 and Shannon alpha diversity quantifications (as seen in <xref rid="SD1" ref-type="supplementary-material">Figure S4D</xref>) were performed on filtered and normalized OTU quantifications. Filtering and normalization was performed as follows: Data were filtered for abundance for those OTUs that had a minimum total count of 4, or less than 10% total abundance in all samples using the ApplyAbundanceFilter function. The OTUs in the lowest 5% for variance based on the inner-quartile range were then removed using the ApplyVarianceFilter function. Lastly, the relative log expression normalization was performed PerformNormalization function in MicrobiomeAnalyst. The two most diverse, two middle, and least diverse consensus groups are annotated as such in <xref rid="F4" ref-type="fig">Figure 4C</xref>.</p>
      </sec>
      <sec id="S40">
        <title>PyMINEr analysis of methylome and transcriptome consensus groups</title>
        <p id="P59">For transcriptome and methylome analysis, we used PyMINEr’s -manual_sample_groups argument feeding in the consensus group IDs that were identified by MANAclust (<xref rid="R41" ref-type="bibr">Tyler et al., 2019</xref>).</p>
      </sec>
    </sec>
    <sec id="S41">
      <title>QUANTIFICATION AND STATISTICAL ANALYSIS</title>
      <sec id="S42">
        <title>Statistical differences between groups with categorical datasets</title>
        <p id="P60">MANAclust first determines global statistical differences using chi-square tests; for those that were significant after FDR correction, pairwise post-hocs are performed. Chi-square analyses are performed to assess for non-independent segregation of categorical variables across the final clusters or consensus groups. Global statistics were FDR corrected using the Benjamini-Hochberg correction. Chi-square analyses were then performed as post-hocs assessing each pair of groups for non-independent segregation across groups when the global statistic was significant (alpha = 0.001 for FDR q-values). Chi-square analyses are performed using the stats.chi2_contingency function in SciPy. To calculate adjusted residuals and convert these to cell-wise P values for the contingency table, we implemented a previously published approach that had not been previously implemented in python (<xref rid="R9" ref-type="bibr">García-pérez and Núñez-antón, 2003</xref>). The approach is implemented in MANAclust’s mana_annotate_results.cont_to_p_independent function. MANAclust does not automatically check if each contingency table meets the assumption of n = 5 for each cell, as is assumed by χ<sup>2</sup> test-of-independence analyses.</p>
      </sec>
      <sec id="S43">
        <title>Statistical differences between groups with numeric datasets</title>
        <p id="P61">Following final cluster and consensus group identification, global statistical differences for each variable in the input datasets are assessed by 1-way ANOVA comparing all groups to each other. P values are FDR adjusted using the Benjamini-Hochberg method. Pairwise differences between all groups for all variables is performed by first filtering only for significant differences by adjusted 1-way ANOVA q-values, for those features that are significantly different globally, t tests are performed pairwise between all final clusters and consensus groups. These are also Benjamini-Hochberg corrected. ANOVAs are performed using the function stats.f_oneway from the SciPy package. t tests are performed using the stats.ttest_ind function from SciPy. MANAclust does not automatically check for within-group normality, as is assumed by these tests.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="SM1">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>1</label>
      <media xlink:href="NIHMS1693698-supplement-1.pdf" orientation="portrait" id="d40e1036" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD2">
      <label>2</label>
      <media xlink:href="NIHMS1693698-supplement-2.xlsx" orientation="portrait" id="d40e1040" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD3">
      <label>3</label>
      <media xlink:href="NIHMS1693698-supplement-3.xlsx" orientation="portrait" id="d40e1044" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD4">
      <label>4</label>
      <media xlink:href="NIHMS1693698-supplement-4.pdf" orientation="portrait" id="d40e1048" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S44">
    <title>ACKNOWLEDGMENTS</title>
    <p id="P62">This study was funded by the National Institutes of Health R01AI118833, U19AI136053, R01AI147028, T32CA078207, and K99HG011270.</p>
  </ack>
  <fn-group>
    <fn id="FN2">
      <p id="P63">SUPPLEMENTAL INFORMATION</p>
      <p id="P64">Supplemental information can be found online at <ext-link ext-link-type="doi" xlink:href="10.1016/j.celrep.2021.108975">https://doi.org/10.1016/j.celrep.2021.108975</ext-link>.</p>
    </fn>
    <fn fn-type="COI-statement" id="FN3">
      <p id="P65">DECLARATION OF INTERESTS</p>
      <p id="P66">The authors declare no competing interests.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="R1">
      <mixed-citation publication-type="journal"><name><surname>Altman</surname><given-names>MC</given-names></name>, <name><surname>Gill</surname><given-names>MA</given-names></name>, <name><surname>Whalen</surname><given-names>E</given-names></name>, <name><surname>Babineau</surname><given-names>DC</given-names></name>, <name><surname>Shao</surname><given-names>B</given-names></name>, <name><surname>Liu</surname><given-names>AH</given-names></name>, <name><surname>Jepson</surname><given-names>B</given-names></name>, <name><surname>Gruchalla</surname><given-names>RS</given-names></name>, <name><surname>O’Connor</surname><given-names>GT</given-names></name>, <name><surname>Pongracic</surname><given-names>JA</given-names></name>, <etal/> (<year>2019</year>). <article-title>Transcriptome networks identify mechanisms of viral and nonviral asthma exacerbations in children</article-title>. <source>Nat. Immunol</source>
<volume>20</volume>, <fpage>637</fpage>–<lpage>651</lpage>.<pub-id pub-id-type="pmid">30962590</pub-id></mixed-citation>
    </ref>
    <ref id="R2">
      <mixed-citation publication-type="journal"><name><surname>Andrews</surname><given-names>TS</given-names></name>, and <name><surname>Hemberg</surname><given-names>M</given-names></name> (<year>2018</year>). <article-title>Identifying cell populations with scRNASeq</article-title>. <source>Mol. Aspects Med</source>
<volume>59</volume>, <fpage>114</fpage>–<lpage>122</lpage>.<pub-id pub-id-type="pmid">28712804</pub-id></mixed-citation>
    </ref>
    <ref id="R3">
      <mixed-citation publication-type="journal"><name><surname>Bunyavanich</surname><given-names>S</given-names></name>, and <name><surname>Schadt</surname><given-names>EE</given-names></name> (<year>2015</year>). <article-title>Systems biology of asthma and allergic diseases: a multiscale approach</article-title>. <source>J. Allergy Clin. Immunol</source>
<volume>135</volume>, <fpage>31</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">25468194</pub-id></mixed-citation>
    </ref>
    <ref id="R4">
      <mixed-citation publication-type="journal"><name><surname>Caporaso</surname><given-names>JG</given-names></name>, <name><surname>Kuczynski</surname><given-names>J</given-names></name>, <name><surname>Stombaugh</surname><given-names>J</given-names></name>, <name><surname>Bittinger</surname><given-names>K</given-names></name>, <name><surname>Bushman</surname><given-names>FD</given-names></name>, <name><surname>Costello</surname><given-names>EK</given-names></name>, <name><surname>Fierer</surname><given-names>N</given-names></name>, <name><surname>Peña</surname><given-names>AG</given-names></name>, <name><surname>Goodrich</surname><given-names>JK</given-names></name>, <name><surname>Gordon</surname><given-names>JI</given-names></name>, <etal/> (<year>2010</year>). <article-title>QIIME allows analysis of high-throughput community sequencing data</article-title>. <source>Nat. Methods</source>
<volume>7</volume>, <fpage>335</fpage>–<lpage>336</lpage>.<pub-id pub-id-type="pmid">20383131</pub-id></mixed-citation>
    </ref>
    <ref id="R5">
      <mixed-citation publication-type="journal"><name><surname>Chun</surname><given-names>Y</given-names></name>, <name><surname>Do</surname><given-names>A</given-names></name>, <name><surname>Grishina</surname><given-names>G</given-names></name>, <name><surname>Grishin</surname><given-names>A</given-names></name>, <name><surname>Fang</surname><given-names>G</given-names></name>, <name><surname>Rose</surname><given-names>S</given-names></name>, <name><surname>Spencer</surname><given-names>C</given-names></name>, <name><surname>Vicencio</surname><given-names>A</given-names></name>, <name><surname>Schadt</surname><given-names>E</given-names></name>, and <name><surname>Bunyavanich</surname><given-names>S</given-names></name> (<year>2020</year>). <article-title>Integrative study of the upper and lower airway microbiome and transcriptome in asthma</article-title>. <source>JCI Insight</source>
<volume>5</volume>, <fpage>e133707</fpage>.</mixed-citation>
    </ref>
    <ref id="R6">
      <mixed-citation publication-type="journal"><name><surname>Dhariwal</surname><given-names>A</given-names></name>, <name><surname>Chong</surname><given-names>J</given-names></name>, <name><surname>Habib</surname><given-names>S</given-names></name>, <name><surname>King</surname><given-names>IL</given-names></name>, <name><surname>Agellon</surname><given-names>LB</given-names></name>, and <name><surname>Xia</surname><given-names>J</given-names></name> (<year>2017</year>). <article-title>MicrobiomeAnalyst: a web-based tool for comprehensive statistical, visual and meta-analysis of microbiome data</article-title>. <source>Nucleic Acids Res</source>. <volume>45</volume> (<issue>W1</issue>), <fpage>W180</fpage>–<lpage>W188</lpage>.<pub-id pub-id-type="pmid">28449106</pub-id></mixed-citation>
    </ref>
    <ref id="R7">
      <mixed-citation publication-type="journal"><name><surname>Do</surname><given-names>AN</given-names></name>, <name><surname>Chun</surname><given-names>Y</given-names></name>, <name><surname>Grishina</surname><given-names>G</given-names></name>, <name><surname>Grishin</surname><given-names>A</given-names></name>, <name><surname>Rogers</surname><given-names>AJ</given-names></name>, <name><surname>Raby</surname><given-names>BA</given-names></name>, <name><surname>Weiss</surname><given-names>ST</given-names></name>, <name><surname>Vicencio</surname><given-names>A</given-names></name>, <name><surname>Schadt</surname><given-names>EE</given-names></name>, and <name><surname>Bunyavanich</surname><given-names>S</given-names></name> (<year>2021</year>). <article-title>Network study of nasal transcriptome profiles reveals master regulator genes of asthma</article-title>. <source>J. Allergy Clin. Immunol</source>
<volume>147</volume>, <fpage>879</fpage>–<lpage>893</lpage>.<pub-id pub-id-type="pmid">32828590</pub-id></mixed-citation>
    </ref>
    <ref id="R8">
      <mixed-citation publication-type="journal"><name><surname>Frey</surname><given-names>BJ</given-names></name>, and <name><surname>Dueck</surname><given-names>D</given-names></name> (<year>2007</year>). <article-title>Clustering by passing messages between data points</article-title>. <source>Science</source>
<volume>315</volume>, <fpage>972</fpage>–<lpage>976</lpage>.<pub-id pub-id-type="pmid">17218491</pub-id></mixed-citation>
    </ref>
    <ref id="R9">
      <mixed-citation publication-type="journal"><name><surname>García-pérez</surname><given-names>MA</given-names></name>, and <name><surname>Núñez-antón</surname><given-names>V</given-names></name> (<year>2003</year>). <article-title>Cellwise Residual Analysis in Two-Way Contingency Tables</article-title>. <source>Educ. Psychol. Meas</source>
<volume>63</volume>, <fpage>825</fpage>–<lpage>839</lpage>.</mixed-citation>
    </ref>
    <ref id="R10">
      <mixed-citation publication-type="journal"><name><surname>He</surname><given-names>Z</given-names></name>, <name><surname>Xu</surname><given-names>X</given-names></name>, and <name><surname>Deng</surname><given-names>S</given-names></name> (<year>2002</year>). <article-title>Squeezer: An efficient algorithm for clustering categorical data</article-title>. <source>J. Comput. Sci. Technol</source>
<volume>17</volume>, <fpage>611</fpage>–<lpage>624</lpage>.</mixed-citation>
    </ref>
    <ref id="R11">
      <mixed-citation publication-type="journal"><name><surname>Howrylak</surname><given-names>JA</given-names></name>, <name><surname>Moll</surname><given-names>M</given-names></name>, <name><surname>Weiss</surname><given-names>ST</given-names></name>, <name><surname>Raby</surname><given-names>BA</given-names></name>, <name><surname>Wu</surname><given-names>W</given-names></name>, and <name><surname>Xing</surname><given-names>EP</given-names></name> (<year>2016</year>). <article-title>Gene expression profiling of asthma phenotypes demonstrates molecular signatures of atopy and asthma control</article-title>. <source>J. Allergy Clin. Immunol</source>
<volume>137</volume>, <fpage>1390</fpage>–<lpage>1397.e6</lpage>.<pub-id pub-id-type="pmid">26792209</pub-id></mixed-citation>
    </ref>
    <ref id="R12">
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>Z</given-names></name> (<year>1998</year>). <article-title>Extensions to the k-means algorithm for clustering large data sets with categorical values</article-title>. <source>Data Min. Knowl. Discov</source>
<volume>2</volume>, <fpage>283</fpage>–<lpage>304</lpage>.</mixed-citation>
    </ref>
    <ref id="R13">
      <mixed-citation publication-type="web"><collab>Illumina</collab> (<year>2013</year>). <source>16S Metagenomic Sequencing Library Preparation</source>. <pub-id pub-id-type="doi">10.1016/emea.illumina.com/content/dam/illumina-support/documents/documentation/chemistry_documentation/16s/16s-metagenomic-library-prep-guide-15044223-b.pdf</pub-id><comment>.</comment></mixed-citation>
    </ref>
    <ref id="R14">
      <mixed-citation publication-type="journal"><name><surname>Ji</surname><given-names>J</given-names></name>, <name><surname>Bai</surname><given-names>T</given-names></name>, <name><surname>Zhou</surname><given-names>C</given-names></name>, <name><surname>Ma</surname><given-names>C</given-names></name>, and <name><surname>Wang</surname><given-names>Z</given-names></name> (<year>2013</year>). <article-title>An improved k-prototypes clustering algorithm for mixed numeric and categorical data</article-title>. <source>Neurocomputing</source>
<volume>120</volume>, <fpage>590</fpage>–<lpage>596</lpage>.</mixed-citation>
    </ref>
    <ref id="R15">
      <mixed-citation publication-type="journal"><name><surname>Kanchongkittiphon</surname><given-names>W</given-names></name>, <name><surname>Mendell</surname><given-names>MJ</given-names></name>, <name><surname>Gaffin</surname><given-names>JM</given-names></name>, <name><surname>Wang</surname><given-names>G</given-names></name>, and <name><surname>Phipatanakul</surname><given-names>W</given-names></name> (<year>2015</year>). <article-title>Indoor environmental exposures and exacerbation of asthma: an update to the 2000 review by the Institute of Medicine</article-title>. <source>Environ. Health Perspect</source>
<volume>123</volume>, <fpage>6</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">25303775</pub-id></mixed-citation>
    </ref>
    <ref id="R16">
      <mixed-citation publication-type="journal"><name><surname>Kuo</surname><given-names>CS</given-names></name>, <name><surname>Pavlidis</surname><given-names>S</given-names></name>, <name><surname>Loza</surname><given-names>M</given-names></name>, <name><surname>Baribaud</surname><given-names>F</given-names></name>, <name><surname>Rowe</surname><given-names>A</given-names></name>, <name><surname>Pandis</surname><given-names>I</given-names></name>, <name><surname>Sousa</surname><given-names>A</given-names></name>, <name><surname>Corfield</surname><given-names>J</given-names></name>, <name><surname>Djukanovic</surname><given-names>R</given-names></name>, <name><surname>Lutter</surname><given-names>R</given-names></name>, <etal/>; <collab>U-BIOPRED Study Group</collab> (<year>2017</year>). <article-title>T-helper cell Type 2 (Th2) and non-Th2 molecular phenotypes of asthma using sputum transcriptomics in U-BIOPRED</article-title>. <source>Eur. Respir. J</source>
<volume>49</volume>, <fpage>1602135</fpage>.<pub-id pub-id-type="pmid">28179442</pub-id></mixed-citation>
    </ref>
    <ref id="R17">
      <mixed-citation publication-type="journal"><name><surname>Liang</surname><given-names>L</given-names></name>, <name><surname>Willis-Owen</surname><given-names>SAG</given-names></name>, <name><surname>Laprise</surname><given-names>C</given-names></name>, <name><surname>Wong</surname><given-names>KCC</given-names></name>, <name><surname>Davies</surname><given-names>GA</given-names></name>, <name><surname>Hudson</surname><given-names>TJ</given-names></name>, <name><surname>Binia</surname><given-names>A</given-names></name>, <name><surname>Hopkin</surname><given-names>JM</given-names></name>, <name><surname>Yang</surname><given-names>IV</given-names></name>, <name><surname>Grundberg</surname><given-names>E</given-names></name>, <etal/> (<year>2015</year>). <article-title>An epigenome-wide association study of total serum immunoglobulin E concentration</article-title>. <source>Nature</source>
<volume>520</volume>, <fpage>670</fpage>–<lpage>674</lpage>.<pub-id pub-id-type="pmid">25707804</pub-id></mixed-citation>
    </ref>
    <ref id="R18">
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>T</given-names></name>, <name><surname>Wu</surname><given-names>J</given-names></name>, <name><surname>Zhao</surname><given-names>J</given-names></name>, <name><surname>Wang</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Liu</surname><given-names>L</given-names></name>, <name><surname>Cao</surname><given-names>L</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>, and <name><surname>Dong</surname><given-names>L</given-names></name> (<year>2015</year>). <article-title>Type 2 innate lymphoid cells: A novel biomarker of eosinophilic airway inflammation in patients with mild to moderate asthma</article-title>. <source>Respir. Med</source>
<volume>109</volume>, <fpage>1391</fpage>–<lpage>1396</lpage>.<pub-id pub-id-type="pmid">26459159</pub-id></mixed-citation>
    </ref>
    <ref id="R19">
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>W</given-names></name>, <name><surname>Liu</surname><given-names>S</given-names></name>, <name><surname>Verma</surname><given-names>M</given-names></name>, <name><surname>Zafar</surname><given-names>I</given-names></name>, <name><surname>Good</surname><given-names>JT</given-names></name>, <name><surname>Rollins</surname><given-names>D</given-names></name>, <name><surname>Groshong</surname><given-names>S</given-names></name>, <name><surname>Gorska</surname><given-names>MM</given-names></name>, <name><surname>Martin</surname><given-names>RJ</given-names></name>, and <name><surname>Alam</surname><given-names>R</given-names></name> (<year>2017</year>). <article-title>Mechanism of TH2/TH17-pre-dominant and neutrophilic TH2/TH17-low subtypes of asthma</article-title>. <source>J. Allergy Clin. Immunol</source>
<volume>139</volume>, <fpage>1548</fpage>–<lpage>1558.e4</lpage>.<pub-id pub-id-type="pmid">27702673</pub-id></mixed-citation>
    </ref>
    <ref id="R20">
      <mixed-citation publication-type="journal"><name><surname>Lloyd</surname><given-names>S</given-names></name> (<year>1982</year>). <article-title>Least squares quantization in PCM</article-title>. <source>IEEE Trans. Inf. Theory</source>
<volume>28</volume>, <fpage>129</fpage>–<lpage>137</lpage>.</mixed-citation>
    </ref>
    <ref id="R21">
      <mixed-citation publication-type="journal"><name><surname>Moore</surname><given-names>WC</given-names></name>, <name><surname>Bleecker</surname><given-names>ER</given-names></name>, <name><surname>Curran-Everett</surname><given-names>D</given-names></name>, <name><surname>Erzurum</surname><given-names>SC</given-names></name>, <name><surname>Ameredes</surname><given-names>BT</given-names></name>, <name><surname>Bacharier</surname><given-names>L</given-names></name>, <name><surname>Calhoun</surname><given-names>WJ</given-names></name>, <name><surname>Castro</surname><given-names>M</given-names></name>, <name><surname>Chung</surname><given-names>KF</given-names></name>, <name><surname>Clark</surname><given-names>MP</given-names></name>, <etal/>; <collab>National Heart, Lung, Blood Institute’s Severe Asthma Research Program</collab> (<year>2007</year>). <article-title>Characterization of the severe asthma phenotype by the National Heart, Lung, and Blood Institute’s Severe Asthma Research Program</article-title>. <source>J. Allergy Clin. Immunol</source>
<volume>119</volume>, <fpage>405</fpage>–<lpage>413</lpage>.<pub-id pub-id-type="pmid">17291857</pub-id></mixed-citation>
    </ref>
    <ref id="R22">
      <mixed-citation publication-type="journal"><name><surname>Nagasaki</surname><given-names>T</given-names></name>, <name><surname>Matsumoto</surname><given-names>H</given-names></name>, and <name><surname>Izuhara</surname><given-names>K</given-names></name>; <collab>KiHAC Respiratory Medicine Group</collab> (<year>2017</year>). <article-title>Utility of serum periostin in combination with exhaled nitric oxide in the management of asthma</article-title>. <source>Allergol. Int</source>
<volume>66</volume>, <fpage>404</fpage>–<lpage>410</lpage>.<pub-id pub-id-type="pmid">28256388</pub-id></mixed-citation>
    </ref>
    <ref id="R23">
      <mixed-citation publication-type="book"><collab>National Asthma Education and Prevention Program</collab> (<year>2007</year>). <chapter-title>Expert Panel Report 3: Guidelines for the Diagnosis and Management of Asthma</chapter-title>. <source>Clinical Practice Guidelines</source> (<publisher-name>National Heart, Lung, and Blood Institute</publisher-name>).</mixed-citation>
    </ref>
    <ref id="R24">
      <mixed-citation publication-type="journal"><name><surname>Nguyen</surname><given-names>T</given-names></name>, <name><surname>Tagett</surname><given-names>R</given-names></name>, <name><surname>Diaz</surname><given-names>D</given-names></name>, and <name><surname>Draghici</surname><given-names>S</given-names></name> (<year>2017</year>). <article-title>A novel approach for data integration and disease subtyping</article-title>. <source>Genome Res</source>. <volume>27</volume>, <fpage>2025</fpage>–<lpage>2039</lpage>.<pub-id pub-id-type="pmid">29066617</pub-id></mixed-citation>
    </ref>
    <ref id="R25">
      <mixed-citation publication-type="journal"><name><surname>Nguyen</surname><given-names>H</given-names></name>, <name><surname>Shrestha</surname><given-names>S</given-names></name>, <name><surname>Draghici</surname><given-names>S</given-names></name>, and <name><surname>Nguyen</surname><given-names>T</given-names></name> (<year>2019</year>). <article-title>PINSPlus: a tool for tumor subtype discovery in integrated genomic data</article-title>. <source>Bioinformatics</source>
<volume>35</volume>, <fpage>2843</fpage>–<lpage>2846</lpage>.<pub-id pub-id-type="pmid">30590381</pub-id></mixed-citation>
    </ref>
    <ref id="R26">
      <mixed-citation publication-type="journal"><name><surname>Nicodemus-Johnson</surname><given-names>J</given-names></name>, <name><surname>Myers</surname><given-names>RA</given-names></name>, <name><surname>Sakabe</surname><given-names>NJ</given-names></name>, <name><surname>Sobreira</surname><given-names>DR</given-names></name>, <name><surname>Hogarth</surname><given-names>DK</given-names></name>, <name><surname>Naureckas</surname><given-names>ET</given-names></name>, <name><surname>Sperling</surname><given-names>AI</given-names></name>, <name><surname>Solway</surname><given-names>J</given-names></name>, <name><surname>White</surname><given-names>SR</given-names></name>, <name><surname>Nobrega</surname><given-names>MA</given-names></name>, <etal/> (<year>2016</year>). <article-title>DNA methylation in lung cells is associated with asthma endotypes and genetic risk</article-title>. <source>JCI Insight</source>
<volume>1</volume>, <fpage>e90151</fpage>.<pub-id pub-id-type="pmid">27942592</pub-id></mixed-citation>
    </ref>
    <ref id="R27">
      <mixed-citation publication-type="journal"><name><surname>Patro</surname><given-names>R</given-names></name>, <name><surname>Duggal</surname><given-names>G</given-names></name>, <name><surname>Love</surname><given-names>MI</given-names></name>, <name><surname>Irizarry</surname><given-names>RA</given-names></name>, and <name><surname>Kingsford</surname><given-names>C</given-names></name> (<year>2017</year>). <article-title>Salmon provides fast and bias-aware quantification of transcript expression</article-title>. <source>Nat. Methods</source>
<volume>14</volume>, <fpage>417</fpage>–<lpage>419</lpage>.<pub-id pub-id-type="pmid">28263959</pub-id></mixed-citation>
    </ref>
    <ref id="R28">
      <mixed-citation publication-type="journal"><name><surname>Pearl</surname><given-names>J</given-names></name> (<year>2009</year>). <article-title>Causal inference in statistics: An overview</article-title>. <source>Stat. Surv</source>
<volume>3</volume>, <fpage>96</fpage>–<lpage>146</lpage>.</mixed-citation>
    </ref>
    <ref id="R29">
      <mixed-citation publication-type="journal"><name><surname>Pedregosa</surname><given-names>F</given-names></name>, <name><surname>Varoquaux</surname><given-names>G</given-names></name>, <name><surname>Gramfort</surname><given-names>A</given-names></name>, <name><surname>Michel</surname><given-names>V</given-names></name>, <name><surname>Thirion</surname><given-names>B</given-names></name>, <name><surname>Grisel</surname><given-names>O</given-names></name>, <name><surname>Blondel</surname><given-names>M</given-names></name>, <name><surname>Prettenhofer</surname><given-names>P</given-names></name>, <name><surname>Weiss</surname><given-names>R</given-names></name>, and <name><surname>Dubourg</surname><given-names>V</given-names></name> (<year>2011</year>). <article-title>Scikit-learn: Machine learning in Python</article-title>. <source>J. Mach. Learn. Res</source>
<volume>12</volume>, <fpage>2825</fpage>–<lpage>2830</lpage>.</mixed-citation>
    </ref>
    <ref id="R30">
      <mixed-citation publication-type="journal"><name><surname>Pham</surname><given-names>MN</given-names></name>, <name><surname>Andrade</surname><given-names>J</given-names></name>, <name><surname>Mishoe</surname><given-names>M</given-names></name>, <name><surname>Chun</surname><given-names>Y</given-names></name>, and <name><surname>Bunyavanich</surname><given-names>S</given-names></name> (<year>2019</year>). <article-title>Perceived Versus Actual Aeroallergen Sensitization in Urban Children</article-title>. <source>J. Allergy Clin. Immunol. Pract</source>
<volume>7</volume>, <fpage>1591</fpage>–<lpage>1598.e4</lpage>.<pub-id pub-id-type="pmid">30654198</pub-id></mixed-citation>
    </ref>
    <ref id="R31">
      <mixed-citation publication-type="journal"><name><surname>Rappoport</surname><given-names>N</given-names></name>, and <name><surname>Shamir</surname><given-names>R</given-names></name> (<year>2018</year>). <article-title>Multi-omic and multi-view clustering algorithms: review and cancer benchmark</article-title>. <source>Nucleic Acids Res</source>. <volume>46</volume>, <fpage>10546</fpage>–<lpage>10562</lpage>.<pub-id pub-id-type="pmid">30295871</pub-id></mixed-citation>
    </ref>
    <ref id="R32">
      <mixed-citation publication-type="journal"><name><surname>Reimand</surname><given-names>J</given-names></name>, <name><surname>Kull</surname><given-names>M</given-names></name>, <name><surname>Peterson</surname><given-names>H</given-names></name>, <name><surname>Hansen</surname><given-names>J</given-names></name>, and <name><surname>Vilo</surname><given-names>J</given-names></name> (<year>2007</year>). <article-title>g:Profiler—a web-based toolset for functional profiling of gene lists from large-scale experiments</article-title>. <source>Nucleic Acids Res</source>. <volume>35</volume>, <fpage>W193</fpage>–<lpage>W200</lpage>.<pub-id pub-id-type="pmid">17478515</pub-id></mixed-citation>
    </ref>
    <ref id="R33">
      <mixed-citation publication-type="journal"><name><surname>Ricciardolo</surname><given-names>FLM</given-names></name>, <name><surname>Sorbello</surname><given-names>V</given-names></name>, <name><surname>Folino</surname><given-names>A</given-names></name>, <name><surname>Gallo</surname><given-names>F</given-names></name>, <name><surname>Massaglia</surname><given-names>GM</given-names></name>, <name><surname>Favatà</surname><given-names>G</given-names></name>, <name><surname>Conticello</surname><given-names>S</given-names></name>, <name><surname>Vallese</surname><given-names>D</given-names></name>, <name><surname>Gani</surname><given-names>F</given-names></name>, <name><surname>Malerba</surname><given-names>M</given-names></name>, <etal/> (<year>2017</year>). <article-title>Identification of IL-17F/frequent exacerbator endotype in asthma</article-title>. <source>J. Allergy Clin. Immunol</source>
<volume>140</volume>, <fpage>395</fpage>–<lpage>406</lpage>.<pub-id pub-id-type="pmid">27931975</pub-id></mixed-citation>
    </ref>
    <ref id="R34">
      <mixed-citation publication-type="journal"><name><surname>Rotsides</surname><given-names>DZ</given-names></name>, <name><surname>Goldstein</surname><given-names>IF</given-names></name>, <name><surname>Canfield</surname><given-names>SM</given-names></name>, <name><surname>Perzanowski</surname><given-names>M</given-names></name>, <name><surname>Mellins</surname><given-names>RB</given-names></name>, <name><surname>Hoepner</surname><given-names>L</given-names></name>, <name><surname>Ashby-Thompson</surname><given-names>M</given-names></name>, and <name><surname>Jacobson</surname><given-names>JS</given-names></name> (<year>2010</year>). <article-title>Asthma, allergy, and IgE levels in NYC head start children</article-title>. <source>Respir. Med</source>
<volume>104</volume>, <fpage>345</fpage>–<lpage>355</lpage>.<pub-id pub-id-type="pmid">19913396</pub-id></mixed-citation>
    </ref>
    <ref id="R35">
      <mixed-citation publication-type="journal"><name><surname>Sharma</surname><given-names>N</given-names></name>, and <name><surname>Gaud</surname><given-names>N</given-names></name> (<year>2015</year>). <article-title>K-modes Clustering Algorithm for Categorical Data</article-title>. <source>Int. J. Comput. Appl</source>
<volume>127</volume>, <fpage>46</fpage>.</mixed-citation>
    </ref>
    <ref id="R36">
      <mixed-citation publication-type="journal"><name><surname>Shi</surname><given-names>J</given-names></name>, and <name><surname>Malik</surname><given-names>J</given-names></name> (<year>2000</year>). <article-title>Normalized cuts and image segmentation</article-title>. <source>IEEE Trans. Pattern Anal. Mach. Intell</source>
<volume>22</volume>, <fpage>888</fpage>–<lpage>905</lpage>.</mixed-citation>
    </ref>
    <ref id="R37">
      <mixed-citation publication-type="book"><name><surname>Sreenivasulu</surname><given-names>G</given-names></name>, <name><surname>Raju</surname><given-names>SV</given-names></name>, and <name><surname>Rao</surname><given-names>NS</given-names></name> (<year>2017</year>). <source>Review of Clustering Techniques</source> (<publisher-name>Springer Singapore</publisher-name>).</mixed-citation>
    </ref>
    <ref id="R38">
      <mixed-citation publication-type="journal"><name><surname>Sugita</surname><given-names>K</given-names></name>, <name><surname>Steer</surname><given-names>CA</given-names></name>, <name><surname>Martinez-Gonzalez</surname><given-names>I</given-names></name>, <name><surname>Altunbulakli</surname><given-names>C</given-names></name>, <name><surname>Morita</surname><given-names>H</given-names></name>, <name><surname>Castro-Giner</surname><given-names>F</given-names></name>, <name><surname>Kubo</surname><given-names>T</given-names></name>, <name><surname>Wawrzyniak</surname><given-names>P</given-names></name>, <name><surname>Rückert</surname><given-names>B</given-names></name>, <name><surname>Sudo</surname><given-names>K</given-names></name>, <etal/> (<year>2018</year>). <article-title>Type 2 innate lymphoid cells disrupt bronchial epithelial barrier integrity by targeting tight junctions through IL-13 in asthmatic patients</article-title>. <source>J. Allergy Clin. Immunol</source>
<volume>141</volume>, <fpage>300</fpage>–<lpage>310.e11</lpage>.<pub-id pub-id-type="pmid">28392332</pub-id></mixed-citation>
    </ref>
    <ref id="R39">
      <mixed-citation publication-type="journal"><name><surname>Tesse</surname><given-names>R</given-names></name>, <name><surname>Borrelli</surname><given-names>G</given-names></name>, <name><surname>Mongelli</surname><given-names>G</given-names></name>, <name><surname>Mastrorilli</surname><given-names>V</given-names></name>, and <name><surname>Cardinale</surname><given-names>F</given-names></name> (<year>2018</year>). <article-title>Treating Pediatric Asthma According Guidelines</article-title>. <source>Front Pediatr</source>. <volume>6</volume>, <fpage>234</fpage>.<pub-id pub-id-type="pmid">30191146</pub-id></mixed-citation>
    </ref>
    <ref id="R40">
      <mixed-citation publication-type="journal"><name><surname>Tyler</surname><given-names>SR</given-names></name>, and <name><surname>Bunyavanich</surname><given-names>S</given-names></name> (<year>2019</year>). <article-title>Leveraging -omics for asthma endotyping</article-title>. <source>J. Allergy Clin. Immunol</source>
<volume>144</volume>, <fpage>13</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">31277743</pub-id></mixed-citation>
    </ref>
    <ref id="R41">
      <mixed-citation publication-type="journal"><name><surname>Tyler</surname><given-names>SR</given-names></name>, <name><surname>Rotti</surname><given-names>PG</given-names></name>, <name><surname>Sun</surname><given-names>X</given-names></name>, <name><surname>Yi</surname><given-names>Y</given-names></name>, <name><surname>Xie</surname><given-names>W</given-names></name>, <name><surname>Winter</surname><given-names>MC</given-names></name>, <name><surname>Flamme-Wiese</surname><given-names>MJ</given-names></name>, <name><surname>Tucker</surname><given-names>BA</given-names></name>, <name><surname>Mullins</surname><given-names>RF</given-names></name>, <name><surname>Norris</surname><given-names>AW</given-names></name>, <etal/> (<year>2019</year>). <article-title>PyMINEr Finds Gene and Autocrine-Paracrine Networks from Human Islet scRNA-Seq</article-title>. <source>Cell Rep</source>. <volume>26</volume>, <fpage>1951</fpage>–<lpage>1964.e8</lpage>.<pub-id pub-id-type="pmid">30759402</pub-id></mixed-citation>
    </ref>
    <ref id="R42">
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>B</given-names></name>, <name><surname>Mezlini</surname><given-names>AM</given-names></name>, <name><surname>Demir</surname><given-names>F</given-names></name>, <name><surname>Fiume</surname><given-names>M</given-names></name>, <name><surname>Tu</surname><given-names>Z</given-names></name>, <name><surname>Brudno</surname><given-names>M</given-names></name>, <name><surname>Haibe-Kains</surname><given-names>B</given-names></name>, and <name><surname>Goldenberg</surname><given-names>A</given-names></name> (<year>2014</year>). <article-title>Similarity network fusion for aggregating data types on a genomic scale</article-title>. <source>Nat. Methods</source>
<volume>11</volume>, <fpage>333</fpage>–<lpage>337</lpage>.<pub-id pub-id-type="pmid">24464287</pub-id></mixed-citation>
    </ref>
    <ref id="R43">
      <mixed-citation publication-type="journal"><name><surname>Weiss</surname><given-names>S</given-names></name>, <name><surname>Xu</surname><given-names>ZZ</given-names></name>, <name><surname>Peddada</surname><given-names>S</given-names></name>, <name><surname>Amir</surname><given-names>A</given-names></name>, <name><surname>Bittinger</surname><given-names>K</given-names></name>, <name><surname>Gonzalez</surname><given-names>A</given-names></name>, <name><surname>Lozupone</surname><given-names>C</given-names></name>, <name><surname>Zaneveld</surname><given-names>JR</given-names></name>, <name><surname>Vázquez-Baeza</surname><given-names>Y</given-names></name>, <name><surname>Birmingham</surname><given-names>A</given-names></name>, <etal/> (<year>2017</year>). <article-title>Normalization and microbial differential abundance strategies depend upon data characteristics</article-title>. <source>Microbiome</source>
<volume>5</volume>, <fpage>27</fpage>.<pub-id pub-id-type="pmid">28253908</pub-id></mixed-citation>
    </ref>
    <ref id="R44">
      <mixed-citation publication-type="book"><name><surname>Williamson</surname><given-names>J</given-names></name> (<year>2009</year>). <chapter-title>Probabilistic theories of causality</chapter-title>. In <source>The Oxford Handbook of Causation</source>, <name><surname>Beebee</surname><given-names>H</given-names></name>, <name><surname>Hitchcock</surname><given-names>C</given-names></name>, and <name><surname>Menzies</surname><given-names>P</given-names></name>, eds. (<publisher-name>Oxford Handbooks Online</publisher-name>), pp. <fpage>185</fpage>–<lpage>212</lpage>.</mixed-citation>
    </ref>
    <ref id="R45">
      <mixed-citation publication-type="journal"><name><surname>Wisniewski</surname><given-names>JA</given-names></name>, <name><surname>Muehling</surname><given-names>LM</given-names></name>, <name><surname>Eccles</surname><given-names>JD</given-names></name>, <name><surname>Capaldo</surname><given-names>BJ</given-names></name>, <name><surname>Agrawal</surname><given-names>R</given-names></name>, <name><surname>Shirley</surname><given-names>D-A</given-names></name>, <name><surname>Patrie</surname><given-names>JT</given-names></name>, <name><surname>Workman</surname><given-names>LJ</given-names></name>, <name><surname>Schuyler</surname><given-names>AJ</given-names></name>, <name><surname>Lawrence</surname><given-names>MG</given-names></name>, <etal/> (<year>2018</year>). <article-title>TH1 signatures are present in the lower airways of children with severe asthma, regardless of allergic status</article-title>. <source>J. Allergy Clin. Immunol</source>
<volume>141</volume>, <fpage>2048</fpage>–<lpage>2060.e13</lpage>.<pub-id pub-id-type="pmid">28939412</pub-id></mixed-citation>
    </ref>
    <ref id="R46">
      <mixed-citation publication-type="journal"><name><surname>Witten</surname><given-names>DM</given-names></name>, and <name><surname>Tibshirani</surname><given-names>RJ</given-names></name> (<year>2009</year>). <article-title>Extensions of sparse canonical correlation analysis with applications to genomic data</article-title>. <source>Stat. Appl. Genet. Mol. Biol</source>
<volume>8</volume>, <comment>Article</comment>
<fpage>28</fpage>.</mixed-citation>
    </ref>
    <ref id="R47">
      <mixed-citation publication-type="journal"><name><surname>Woodruff</surname><given-names>PG</given-names></name>, <name><surname>Modrek</surname><given-names>B</given-names></name>, <name><surname>Choy</surname><given-names>DF</given-names></name>, <name><surname>Jia</surname><given-names>G</given-names></name>, <name><surname>Abbas</surname><given-names>AR</given-names></name>, <name><surname>Ellwanger</surname><given-names>A</given-names></name>, <name><surname>Koth</surname><given-names>LL</given-names></name>, <name><surname>Arron</surname><given-names>JR</given-names></name>, and <name><surname>Fahy</surname><given-names>JV</given-names></name> (<year>2009</year>). <article-title>T-helper Type 2-driven inflammation defines major subphenotypes of asthma</article-title>. <source>Am. J. Respir. Crit. Care Med</source>
<volume>180</volume>, <fpage>388</fpage>–<lpage>395</lpage>.<pub-id pub-id-type="pmid">19483109</pub-id></mixed-citation>
    </ref>
    <ref id="R48">
      <mixed-citation publication-type="journal"><name><surname>Xu</surname><given-names>Z</given-names></name>, <name><surname>Niu</surname><given-names>L</given-names></name>, <name><surname>Li</surname><given-names>L</given-names></name>, and <name><surname>Taylor</surname><given-names>JA</given-names></name> (<year>2016</year>). <article-title>ENmix: a novel background correction method for Illumina HumanMethylation450 BeadChip</article-title>. <source>Nucleic Acids Res</source>. <volume>44</volume>, <fpage>e20</fpage>.<pub-id pub-id-type="pmid">26384415</pub-id></mixed-citation>
    </ref>
    <ref id="R49">
      <mixed-citation publication-type="journal"><name><surname>Zerbino</surname><given-names>DR</given-names></name>, <name><surname>Achuthan</surname><given-names>P</given-names></name>, <name><surname>Akanni</surname><given-names>W</given-names></name>, <name><surname>Amode</surname><given-names>MR</given-names></name>, <name><surname>Barrell</surname><given-names>D</given-names></name>, <name><surname>Bhai</surname><given-names>J</given-names></name>, <name><surname>Billis</surname><given-names>K</given-names></name>, <name><surname>Cummins</surname><given-names>C</given-names></name>, <name><surname>Gall</surname><given-names>A</given-names></name>, <name><surname>Girón</surname><given-names>CG</given-names></name>, <etal/> (<year>2018</year>). <article-title>Ensembl 2018</article-title>. <source>Nucleic Acids Res</source>. <volume>46</volume> (<issue>D1</issue>), <fpage>D754</fpage>–<lpage>D761</lpage>.<pub-id pub-id-type="pmid">29155950</pub-id></mixed-citation>
    </ref>
    <ref id="R50">
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>Y</given-names></name>, <name><surname>Jackson</surname><given-names>D</given-names></name>, <name><surname>Bacharier</surname><given-names>LB</given-names></name>, <name><surname>Mauger</surname><given-names>D</given-names></name>, <name><surname>Boushey</surname><given-names>H</given-names></name>, <name><surname>Castro</surname><given-names>M</given-names></name>, <name><surname>Durack</surname><given-names>J</given-names></name>, <name><surname>Huang</surname><given-names>Y</given-names></name>, <name><surname>Lemanske</surname><given-names>RF</given-names><suffix>Jr.</suffix></name>, <name><surname>Storch</surname><given-names>GA</given-names></name>, <etal/> (<year>2019</year>). <article-title>The upper-airway microbiota and loss of asthma control among asthmatic children</article-title>. <source>Nat. Commun</source>
<volume>10</volume>, <fpage>5714</fpage>.<pub-id pub-id-type="pmid">31844063</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Figure 1.</label>
    <caption>
      <title>MANAclust pipeline</title>
      <p id="P68">(A) Clinical data hold key information for defining diseases, yet they are often ignored by traditional (multi-)omics studies. MANAclust enables feature selection and merged analyses of categorical and continuous clinical data along with traditional multi-omics to enable discovery of disease subtypes.</p>
      <p id="P69">(B) Categorical and numeric datasets are fed into the program, after which feature selection is performed (see <xref rid="S12" ref-type="sec">STAR Methods</xref> for details on algorithms). Normalized affinity matrices are calculated across all omes; these affinity matrices are then merged by taking their missing value compatible average. We combined the strengths of Louvain modularity and affinity propagation into a new clustering algorithm that is then used for final cluster (FC) assignment on the combined affinity matrix. FCs are then examined within each input dataset to determine whether the FCs differ within each given dataset to identify the consensus groups. Post-clustering analyses are also performed to identify the significant differences across each FC and consensus group for all datasets. Analyses are then collated and displayed in a webpage format.</p>
    </caption>
    <graphic xlink:href="nihms-1693698-f0002"/>
  </fig>
  <fig id="F2" orientation="portrait" position="float">
    <label>Figure 2.</label>
    <caption>
      <title>Categorical feature selection</title>
      <p id="P71">(A) The observed dataset, which will often consist of both structured, meaningful, real features and randomly distributed features, is shuffled for 10 iterations to generate a background null distribution for feature selection.</p>
      <p id="P72">(B) To select real features, each feature is compared with all other features, creating a contingency table of all observations for each feature pair.</p>
      <p id="P73">(C) The mutual information for each feature pair is then calculated. This process is performed both with the observed dataset and its iteratively shuffled versions to create an accurate background for comparison.</p>
      <p id="P74">(D) We then calculated a background-corrected stack of information difference matrices, having subtracted the null backgrounds from the observed cross-feature mutual information.</p>
      <p id="P75">(E) This difference matrix stack is then flattened to a single two-dimensional matrix of feature-pairwise mutual information difference by taking the minimum for each feature pair. This is essentially the worst-case scenario in which there was the least amount of difference between the original dataset and one of the shuffled datasets.</p>
      <p id="P76">(F) To select meaningful features, we calculated the row-wise maximum from the minimum difference matrix. This results in a one-dimensional vector corresponding to the maximum amount of relative information contained in all pairwise comparisons for each individual feature. A cutoff is then applied to select the high- and low-information features, retaining the high-information features for downstream log-loss and affinity matrix calculations.</p>
      <p id="P77">See <xref rid="SD1" ref-type="supplementary-material">Figure S1</xref> for a summary of the mathematical approach to feature selection on numeric datasets. See also <xref rid="SD1" ref-type="supplementary-material">Figure S2</xref> for a summary of the accuracy of these feature selection methods.</p>
    </caption>
    <graphic xlink:href="nihms-1693698-f0003"/>
  </fig>
  <fig id="F3" orientation="portrait" position="float">
    <label>Figure 3.</label>
    <caption>
      <title>Comparison of MANAclust with other multi-omic clustering algorithms on TCGA data and simulated categorical data</title>
      <p id="P79">We compared MANAclust’s ability to identify clinically distinct clusters with five other existing algorithms: two non-multi-omics-specialized algorithms, K-means or spectral clustering on concatenated datasets; and four specialized multi-omics algorithms, PINS (<xref rid="R24" ref-type="bibr">Nguyen et al., 2017</xref>), PINSPlus (<xref rid="R25" ref-type="bibr">Nguyen et al., 2019</xref>), Similarity Network Fusion (SNF) (<xref rid="R42" ref-type="bibr">Wang et al., 2014</xref>), and sparse multiple canonical correlation analysis (MCCA) (<xref rid="R46" ref-type="bibr">Witten and Tibshirani, 2009</xref>).</p>
      <p id="P80">(A) MANAclust finds the most significant differences in identified FCs in 10 different cancer types taken in aggregate. The clusters identified by each method were compared with each other for significant differences for survival rate and group segregation based on clinical attributes. Displayed are the sum of the −log10(P values) for each cancer type and the sum of the number of statistically significant differences in clinical attributes for each method. See <xref rid="SD2" ref-type="supplementary-material">Table S1</xref> for all tabulated results.</p>
      <p id="P81">(B) All algorithms were also benchmarked using single-omes rather than in a multi-omic manner. In the top row of plots, each ome type (gene expression, DNA methylation, miRNA expression) denotes the sum across all cancer types for the −log10(P values) for significance in survival differences across groups (x axis) and the sum of the total number of enriched clinical parameters (y axis) for all cancer types combined. Note that MCCA works only with multi-omics data and is therefore not included in the single-omics comparison.</p>
      <p id="P82">(C) To assess the ability of MANAclust to accurately incorporate categorical data, we performed a synthetic dataset benchmark comparing MANAclust’s categorical clustering (orange) with KModes clustering using elbow rule on within-group sum of Hamming distances. MANAclust was slightly more accurate than KModes elbow rule in selecting the appropriate number of clusters. However, MANAclust significantly outperformed KModes in clustering purity (F = 445, P = 1.38e–22, one-way ANOVA) and relative mutual information (F = 53.7, P = 8.75e–9, one-way ANOVA). Categorical simulations included 5, 10, 15, and 20 groups with 1,000 subjects per simulation; each scenario was simulated five times.</p>
      <p id="P83">See <xref rid="SD1" ref-type="supplementary-material">Figure S3</xref> for benchmarking of MANAclust’s feature selection algorithms.</p>
    </caption>
    <graphic xlink:href="nihms-1693698-f0004"/>
  </fig>
  <fig id="F4" orientation="portrait" position="float">
    <label>Figure 4.</label>
    <caption>
      <title>Clinical, methylation, transcriptome, and microbiome consensus groups</title>
      <p id="P85">(A–D) For each input dataset, the large-scale take-home message from the top enriched pathways or variables that characterized the given consensus groups is shown. Each consensus group has a unique color that maps consistently throughout the figure. A thick border is drawn around consensus groups that uniquely map to a single consensus group of all other datasets. In other words, if one can determine this given ome, one can universally determine the subject’s group membership across other omes.</p>
      <p id="P86">(A) Pathway analysis was performed for the transcriptome-level consensus groups using PyMINEr; selected pathways were prioritized using PyMINEr’s individual class importance metric (<xref rid="SD3" ref-type="supplementary-material">Table S2C</xref>) (<xref rid="R32" ref-type="bibr">Reimand et al., 2007</xref>; <xref rid="R41" ref-type="bibr">Tyler et al., 2019</xref>).</p>
      <p id="P87">(B) For methylome pathway analyses, methylation loci were filtered only for those with promoter annotations, using the given promoter as genes for analysis by PyMINEr (<xref rid="SD3" ref-type="supplementary-material">Table S2D</xref>) (<xref rid="R32" ref-type="bibr">Reimand et al., 2007</xref>; <xref rid="R41" ref-type="bibr">Tyler et al., 2019</xref>).</p>
      <p id="P88">(C) Relative abundance (by percentage) for the four most prevalent bacterial genera in each of the microbiome consensus groups. A note on the consensus group alpha diversity is also made beneath genus level quantifications; alpha diversity measures are shown directly in <xref rid="SD1" ref-type="supplementary-material">Figure S4D</xref>.</p>
      <p id="P89">(D) Each consensus group shows the percent abundance of asthma, proportion of allergen-specific IgE (a marker of sensitization to specific allergens), and serum total IgE, normalized to mean total IgE of the highest group. See <xref rid="S12" ref-type="sec">STAR Methods</xref> for details on quantification of the allergen-specific IgE calculation. Bars indicate means and errors are standard error.</p>
      <p id="P90">(E) A circular graph network showing each data type’s consensus groups and their connections to other consensus groups in different data types. All the subjects from within that consensus group of a given data type are examined and if at least one subject within the given consensus group maps to a consensus group from a different data type, those consensus groups are connected. The edges are weighted by the Bayesian probability of consensus group membership for the target given the source of the arrow. See <xref rid="SD1" ref-type="supplementary-material">Figure S4</xref> for more details.</p>
      <p id="P91">(F) The FCs are characterized by their membership in their given consensus groups for each data type. Colors within the table are consistent with those in (A)–(E). For each FC, the relative percentage with asthma is shown (gray bars) along with asthma control test (ACT) scores (blue bars), a measure of asthma severity. Bars indicate mean ± standard error.</p>
      <p id="P92">(G) The significant subset of (E); only edges that showed significant concordance between the two consensus groups are shown. Edge thickness corresponds to the probability of membership in the target consensus group, given that a subject is a member of the source consensus group of a different dataset. Consensus group nodes are colorized based on their data type only.</p>
      <p id="P93">(H) A boxplot showing the maximum level of significance (with FCs or consensus groups) using all data, clinical data only, all numeric data, or each numeric data type on its own. Using all data resulted in the greatest average significance of held-out variables.</p>
      <p id="P94">(I) This finding was consistent, including when subtracting each variable’s instance of least significance to normalize for the different baselines within a variable.</p>
    </caption>
    <graphic xlink:href="nihms-1693698-f0005"/>
  </fig>
  <table-wrap id="T1" position="float" orientation="portrait">
    <caption>
      <p id="P95">KEY RESOURCES TABLE</p>
    </caption>
    <table frame="hsides" rules="groups">
      <colgroup span="1">
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
        <col align="left" valign="middle" span="1"/>
      </colgroup>
      <thead>
        <tr>
          <th align="left" valign="middle" rowspan="1" colspan="1">REAGENT or RESOURCE</th>
          <th align="left" valign="middle" rowspan="1" colspan="1">SOURCE</th>
          <th align="left" valign="middle" rowspan="1" colspan="1">IDENTIFIER</th>
        </tr>
      </thead>
      <tbody>
        <tr style="border-bottom: solid 1px">
          <td align="left" valign="middle" rowspan="1" colspan="1">Biological samples</td>
          <td align="left" valign="middle" rowspan="1" colspan="1"/>
          <td align="left" valign="middle" rowspan="1" colspan="1"/>
        </tr>
        <tr style="border-bottom: solid 1px">
          <td align="left" valign="middle" rowspan="1" colspan="1">Human nasal brushings and fecal samples</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">Icahn School of Medicine at Mount Sinai</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">N/A</td>
        </tr>
        <tr style="border-bottom: solid 1px">
          <td align="left" valign="middle" rowspan="1" colspan="1">Chemicals, peptides, and recombinant proteins</td>
          <td align="left" valign="middle" rowspan="1" colspan="1"/>
          <td align="left" valign="middle" rowspan="1" colspan="1"/>
        </tr>
        <tr style="border-bottom: solid 1px">
          <td align="left" valign="middle" rowspan="1" colspan="1">RNAlater</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">ThermoFisher Scientific</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">AM7020</td>
        </tr>
        <tr style="border-bottom: solid 1px">
          <td align="left" valign="middle" rowspan="1" colspan="1">Critical commercial assays</td>
          <td align="left" valign="middle" rowspan="1" colspan="1"/>
          <td align="left" valign="middle" rowspan="1" colspan="1"/>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">TruSeq RNA Sample Prep Kit v2</td>
          <td align="left" valign="top" rowspan="1" colspan="1">Illumina</td>
          <td align="left" valign="top" rowspan="1" colspan="1">RS-122–2001<break/>RS-122–2002</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">RNeasy mini kit</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">QIAGEN</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">74106</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">DNeasy Mini Kit</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">QIAGEN</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">69506</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Infinium MethylationEPIC v1.0</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">Illumina</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">WG-317–1003</td>
        </tr>
        <tr style="border-bottom: solid 1px">
          <td align="left" valign="top" rowspan="1" colspan="1">TG Nextera® XT Index Kit v2 Set A/B</td>
          <td align="left" valign="top" rowspan="1" colspan="1">Illumina</td>
          <td align="left" valign="top" rowspan="1" colspan="1">TG-131–2001<break/>TG-131–2002</td>
        </tr>
        <tr style="border-bottom: solid 1px">
          <td align="left" valign="middle" rowspan="1" colspan="1">Deposited data</td>
          <td align="left" valign="middle" rowspan="1" colspan="1"/>
          <td align="left" valign="middle" rowspan="1" colspan="1"/>
        </tr>
        <tr style="border-bottom: solid 1px">
          <td align="left" valign="middle" rowspan="1" colspan="1">Benchmarking datasets</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">The Cancer Genome Atlas (TCGA)</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">syn21301852</td>
        </tr>
        <tr style="border-bottom: solid 1px">
          <td align="left" valign="middle" rowspan="1" colspan="1">Software and algorithms</td>
          <td align="left" valign="middle" rowspan="1" colspan="1"/>
          <td align="left" valign="middle" rowspan="1" colspan="1"/>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">PyMINEr</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">
            <ext-link ext-link-type="uri" xlink:href="https://www.sciencescott.com/pyminer">https://www.sciencescott.com/pyminer</ext-link>
          </td>
          <td align="left" valign="middle" rowspan="1" colspan="1">N/A</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">MANAclust</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">This work;</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">N/A</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1"/>
          <td align="left" valign="middle" rowspan="1" colspan="1">
            <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/scottyler892/manaclust/src/master/">https://bitbucket.org/scottyler892/manaclust/src/master/</ext-link>
          </td>
          <td align="left" valign="middle" rowspan="1" colspan="1"/>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">Qiime</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">
            <ext-link ext-link-type="uri" xlink:href="http://qiime.org/">http://qiime.org/</ext-link>
          </td>
          <td align="left" valign="middle" rowspan="1" colspan="1">N/A</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">MicrobiomeAnalyst</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">
            <ext-link ext-link-type="uri" xlink:href="https://www.microbiomeanalyst.ca/">https://www.microbiomeanalyst.ca/</ext-link>
          </td>
          <td align="left" valign="middle" rowspan="1" colspan="1">N/A</td>
        </tr>
        <tr>
          <td align="left" valign="middle" rowspan="1" colspan="1">ENmix</td>
          <td align="left" valign="middle" rowspan="1" colspan="1">
            <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/bioc/html/ENmix.html">https://bioconductor.org/packages/release/bioc/html/ENmix.html</ext-link>
          </td>
          <td align="left" valign="middle" rowspan="1" colspan="1">N/A</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <boxed-text id="BX1" position="float" orientation="portrait">
    <caption>
      <title>Highlights</title>
    </caption>
    <list list-type="bullet" id="L2">
      <list-item>
        <p id="P96">MANAclust enables integrated analysis of clinical and multi-omics data</p>
      </list-item>
      <list-item>
        <p id="P97">Inter-variable relative information provides accurate categorical feature selection</p>
      </list-item>
      <list-item>
        <p id="P98">MANAclust outperforms competing approaches for multi-omic analysis</p>
      </list-item>
      <list-item>
        <p id="P99">MANAclust identifies clinically and molecularly distinct asthma clusters</p>
      </list-item>
    </list>
  </boxed-text>
</floats-group>
