<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5088524</article-id>
    <article-id pub-id-type="publisher-id">3063</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-016-3063-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Computational workflow for the fine-grained analysis of metagenomic samples</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pérez-Wohlfeil</surname>
          <given-names>Esteban</given-names>
        </name>
        <address>
          <email>estebanpw@uma.es</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arjona-Medina</surname>
          <given-names>Jose A.</given-names>
        </name>
        <address>
          <email>arjona@uma.es</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Torreno</surname>
          <given-names>Oscar</given-names>
        </name>
        <address>
          <email>oscart@uma.es</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ulzurrun</surname>
          <given-names>Eugenia</given-names>
        </name>
        <address>
          <email>euv@uma.es</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Trelles</surname>
          <given-names>Oswaldo</given-names>
        </name>
        <address>
          <email>ots@ac.uma.es</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>Department of Computer Architecture, University of Málaga, Boulevard Louis Pasteur 35, Málaga, Spain </aff>
      <aff id="Aff2"><label>2</label>Advanced Computing Technologies Unit, RISC Software GmbH, Softwarepark 35, Hagenberg, Austria </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>10</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>10</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>17</volume>
    <issue>Suppl 8</issue>
    <issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for the publication charges can be found in the individual aticles. Articles have undergone the journal's standard peer review process for research articles. The Supplement Editors declare that they have no competing interests.</issue-sponsor>
    <elocation-id>802</elocation-id>
    <permissions>
      <copyright-statement>© The Author(s) 2016</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>The field of metagenomics, defined as the direct genetic analysis of uncultured samples of genomes contained within an environmental sample, is gaining increasing popularity. The aim of studies of metagenomics is to determine the species present in an environmental community and identify changes in the abundance of species under different conditions. Current metagenomic analysis software faces bottlenecks due to the high computational load required to analyze complex samples.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>A computational open-source workflow has been developed for the detailed analysis of metagenomes. This workflow provides new tools and datafile specifications that facilitate the identification of differences in abundance of reads assigned to taxa (mapping), enables the detection of reads of low-abundance bacteria (producing evidence of their presence), provides new concepts for filtering spurious matches, etc. Innovative visualization ideas for improved display of metagenomic diversity are also proposed to better understand how reads are mapped to taxa. Illustrative examples are provided based on the study of two collections of metagenomes from faecal microbial communities of adult female monozygotic and dizygotic twin pairs concordant for leanness or obesity and their mothers.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>The proposed workflow provides an open environment that offers the opportunity to perform the mapping process using different reference databases. Additionally, this workflow shows the specifications of the mapping process and datafile formats to facilitate the development of new plugins for further post-processing. This open and extensible platform has been designed with the aim of enabling in-depth analysis of metagenomic samples and better understanding of the underlying biological processes.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12864-016-3063-x) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Metagenome analysis</kwd>
      <kwd>Differential abundance</kwd>
      <kwd>Annotational mapping</kwd>
      <kwd>Mapping over specific regions</kwd>
      <kwd>Open platform</kwd>
    </kwd-group>
    <conference>
      <conf-name>6th SolBio International Conference 2016 (SoIBio-IC&amp;W-2016)</conf-name>
      <conf-acronym>SoIBio 2016</conf-acronym>
      <conf-loc>Riviera Maya, Mexico</conf-loc>
      <conf-date>22-26 April 2016</conf-date>
      <string-conf>
        <uri>http://www.soibio.org/en/icmexico2016</uri>
      </string-conf>
    </conference>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2016</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>The purpose of metagenomics is to identify the species present in an environment. Different types of studies can be performed based on metagenomics. Some examples include the analysis of changes in the presence of species in a given environmental sample and the use of phylogenetic analysis to follow up the spread or determine the origin of a species. A large number of tools are emerging in the form of stand-alone programs (e.g. MEGAN [<xref ref-type="bibr" rid="CR1">1</xref>]), interoperable Web services (e.g. MG-RAST [<xref ref-type="bibr" rid="CR2">2</xref>]) or tools accessible through the Internet (e.g. EBI Metagenomics [<xref ref-type="bibr" rid="CR3">3</xref>]).</p>
    <p>MEGAN performs taxonomic analyses of a metagenome by mapping reads to different taxa based on BLAST [<xref ref-type="bibr" rid="CR4">4</xref>] search results and the NCBI taxonomy. To perform this task, the program runs the lowest common ancestor (LCA) algorithm to classify input reads. Most metagenomic tools are constructed following a workflow scheme offering distinct stages of data processing. In this line, the open-source EBI Metagenomic workflow is split into two branches following the quality control step. The first branch performs taxonomic classification based on 16S rRNA, whereas the second branch performs functional analysis based on protein-coding sequences. Unannotated reads are kept out of the pipeline. However, these reads should be taken into account for whole metagenomic analysis in order to improve the accuracy of taxonomic classification and better understand the roles of species in environmental samples.</p>
    <p>The number of comparative metagenomic tools is the key point of the metagenomic RAST (MG-RAST) platform. MG-RAST builds clusters of proteins at a given percentage of identity level using QIIME [<xref ref-type="bibr" rid="CR5">5</xref>]. Once built, the longest sequence of each cluster is subject to similarity using sBLAT, an implementation of the BLAT [<xref ref-type="bibr" rid="CR6">6</xref>] algorithm. MG-RAST also uses the NCBI taxonomy for taxonomic classification. Functional profiles are available through comparison against data sources that provide hierarchical information. Abundance profiles are the main output for displaying information on datasets. The MG-RAST annotation pipeline does not generally provide a single annotation for each submitted fragment of DNA. Steps in the pipeline map a read to multiple annotations and vice versa. Data privacy is one of the concerns of the scientists using this tool. Firstly, they are reluctant to upload their unpublished and/or confidential data to a public website. Secondly, the priority of analysis requests to the website is subject to the level of confidentiality of input data (with lower priority and therefore longer waiting times for private data).</p>
    <p>Recently, a new DNA sequence analysis workflow called META-pipe [<xref ref-type="bibr" rid="CR7">7</xref>] has been developed to find novel commercially exploitable enzymes from marine microbial communities. META-pipe uses tools such as MetaGeneAnnotator (MGA) [<xref ref-type="bibr" rid="CR8">8</xref>] and Protein BLAST to identify sequences found in the UniProtKB database. MGA is a new version of MetaGene [<xref ref-type="bibr" rid="CR9">9</xref>] where a prophage gene model is offered in addition to bacterial and archaeal models. MGA uses di-codon frequencies estimated by the GC content of an input sequence to map genes using regression models. In addition, MGA offers an approach for the analysis of ribosomal binding sites (RBSs) to detect specific patterns of ribosomal sequences in species. However, due to their tendency to undergo highly degenerative changes, RBSs are particularly difficult to identify [<xref ref-type="bibr" rid="CR10">10</xref>]. In the line of pipelines used to facilitate the comparative analysis of high throughput sequencing, MOCAT [<xref ref-type="bibr" rid="CR11">11</xref>] is a modular tool for processing raw sequence reads produced by the Illumina technology [<xref ref-type="bibr" rid="CR12">12</xref>]. The main steps in MOCAT are 1) read trimming and filtering 2) read assembly, 3) gene prediction and 4) estimation of taxonomic abundance profiles.</p>
    <p>The fine-grained metagenomic analysis workflow developed by our group can operate over a user-defined collection of genomes -thus accelerating the computational process- and with the advantages of being able to map reads over unannotated regions of genomes. Our software provides different mapping methods and different mapping alternatives apart from the best read-genome matching. In addition, it provides information about the quality of mapping and about differences between mapping options. Unlike the methods currently available, which deduce that a species is not present in a sample when its abundance is low (in number of reads), the proposed method can detect low-abundance species by finding reads mapping to particular specific regions of genomes. In addition, the developed workflow is an open platform composed of an expandable set of separate modules that use well-defined format datafiles. This enables the easy on-demand incorporation of new processing tools. Along with low-abundance species support, other tools have been included to verify the correctness of taxonomic assignation and extrapolate DNA sequencing data to gene expression levels.</p>
  </sec>
  <sec id="Sec2">
    <title>System and methods</title>
    <sec id="Sec3">
      <title>System and requirements</title>
      <p>The designed workflow (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>) includes all the needed steps for data processing. The quality control step can be performed using SeqTrimNext [<xref ref-type="bibr" rid="CR13">13</xref>] for the case of 454-pyrosequencing [<xref ref-type="bibr" rid="CR14">14</xref>] reads, whereas Trimmomatic [<xref ref-type="bibr" rid="CR15">15</xref>] can be used for Illumina reads. These programs are available in our workflow implementation under our Galaxy [<xref ref-type="bibr" rid="CR16">16</xref>] instance. With regards to the sequence comparison algorithm, we suggest to use the GECKO [<xref ref-type="bibr" rid="CR17">17</xref>] package to accelerate the process. Since several metagenomic packages for 454-pyrosequencing reads are based on the matches provided by a BLAST run, the developed workflow offers a parser to translate BLAST’s output, and therefore the same strategy (parsing) can be used when other sequence comparison software is employed. In addition, the sequence comparison tool SHRiMP [<xref ref-type="bibr" rid="CR18">18</xref>] is included along with a parser that is also available and described in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>.
<fig id="Fig1"><label>Fig. 1</label><caption><p>The Workflow diagram. <italic>Top</italic>: Quality control layer and input files. <italic>Center</italic>: Comparison software layer. <italic>Bottom</italic>: Mapping kernel (GMAP), which provides open-source datafile definitions and enables many on-demand post-processing experiments (<italic>Right</italic>)</p></caption><graphic xlink:href="12864_2016_3063_Fig1_HTML" id="MO1"/></fig>
</p>
      <p>In the line to offer a broad scope of the presented software, the proposed workflow can handle sequences of different length obtained with different sequencing technologies (e.g. SOLiD [<xref ref-type="bibr" rid="CR19">19</xref>], Illumina, 454-Pyrosequencing). For instance, in the case of colour-space reads these can be compared using SHRiMP, which natively supports colour-space reads. The proposed method focuses in the comparison and mapping procedures, while the pre-processing steps can be carried out with common publicly available software.</p>
      <p>The workflow operates over a user-defined collection of genomes. This database might as well be a custom selection of genomes which hold particular interest, a pre-selection of the most common species for the type of metagenome analysis, or even a complete database such as GenBank [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
      <p>The workflow is specialized in matching (reads-species mapping) and post-processing procedures, which require the following input: (1) Sequence comparison files, (2) taxonomic description of the reference dataset, and (3) annotation files for the genomes (optional, only needed for post-processing).</p>
      <p>(1) Sequence comparison files: the workflow has been designed so that it is compatible with any sequence comparison software (i.e. BLAST family, FASTA family, proprietary software, etc). The default comparison software used in this workflows is GECKO, however, the user can employ other packages. To include other comparison software a format conversion program would be needed. A parsing conversion system for BLAST is already included in the workflow. The parsing module converts sequence comparison files to a format composed of headers (read-genome tuples) followed by rows, where each row represents a fragment for the tuple. Fragments belonging to a read-genome match are defined by a 12-tuple: 
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${} \begin{aligned} t_{n,k}^{12} =&amp; (k, score, identities, length, similarity, igaps, egaps,\\ &amp;strand, rStart, rEnd, gStart, gEnd) \end{aligned} $$ \end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">score</mml:mtext><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">identities</mml:mtext><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">length</mml:mtext><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">similarity</mml:mtext><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">igaps</mml:mtext><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">egaps</mml:mtext><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">strand</mml:mtext><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">rStart</mml:mtext><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">rEnd</mml:mtext><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">gStart</mml:mtext><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">gEnd</mml:mtext><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12864_2016_3063_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>Where <italic>k</italic> is the <italic>k</italic>−<italic>t</italic>
<italic>h</italic> fragment reported by the read <italic>n</italic>(see Additional file <xref rid="MOESM1" ref-type="media">1</xref> for further reading). The fields <italic>r</italic>
<italic>S</italic>
<italic>t</italic>
<italic>a</italic>
<italic>r</italic>
<italic>t</italic>,<italic>r</italic>
<italic>E</italic>
<italic>n</italic>
<italic>d</italic>,<italic>g</italic>
<italic>S</italic>
<italic>t</italic>
<italic>a</italic>
<italic>r</italic>
<italic>t</italic>,<italic>g</italic>
<italic>E</italic>
<italic>n</italic>
<italic>d</italic> represent the anchoring positions in the read <italic>r</italic> and genome <italic>g</italic>. Reversed fragments are found by comparing the read with the reverse complement of genome <italic>g</italic>. Notice that <italic>rEnd</italic> and <italic>gEnd</italic> are redundant for ungapped fragments, but necessary for gapped fragments. (2) A taxonomic description file allows the customization of hierarchical relationships between organisms in the reference database as assigning strain relationships between species or separating strains that belong to a common ancestor. Such file can be generated automatically using a module of the workflow and/or can be manually built to insert customized relationships between species. The format of the file generated is a text file including a 5-tuple per line, each tuple being a new genome: 
<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${} \begin{aligned} t_{n,m}^{5}=&amp; (n, m, genome\ accession\ number, genome\ name,\\ &amp;length) \end{aligned} $$ \end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">genome</mml:mtext><mml:mspace width="1em"/><mml:mtext mathvariant="italic">accession</mml:mtext><mml:mspace width="1em"/><mml:mtext mathvariant="italic">number</mml:mtext><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">genome</mml:mtext><mml:mspace width="1em"/><mml:mtext mathvariant="italic">name</mml:mtext><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">length</mml:mtext><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12864_2016_3063_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> Where <italic>n</italic> and <italic>m</italic> are the specie and subspecie id’s. These can be used to set up custom boundaries. For further details, please see “Taxonomy files” in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>).</p>
      <p>(3) Annotation files are used to carry out all coding region-related computations in the post-processing phase. Therefore, these files are optional and should be included if annotation post-processing modules are to be used. As in the case of comparison software, a parsing system is implemented; e.g. a parsing system for GenBank’s annotation files has been included in our workflow.</p>
    </sec>
    <sec id="Sec4">
      <title>Extension of ungapped HSPs</title>
      <p>Comparative analysis of metagenomes is an expensive computational process that involves comparing a large set of DNA fragments against an enormous database of candidate sequences (genes, proteins or genomes). It should be noticed that, by definition, bacteria in the metagenome are uncultured species and the sequences in the databases that already exist are not –most likely– the corresponding to the species in the metagenome. Even some large mutations (inversions, deletions, etc) can happen regularly. Therefore a more flexible matching is proposed, which differs from an assembly by mapping in which there are quite close representatives of the sequenced bacteria.</p>
      <p>Thereby we included the option of using a custom glocal [<xref ref-type="bibr" rid="CR21">21</xref>] alignment, which yields longer fragments and larger evolutionary gaps. This method generally improves mapping results, as global alignment methods are less accurate when identifying species.</p>
      <p>Once local alignments are calculated (using GECKO, BLAST or any other similar program), fragments are extended by joining those that are close enough according to a given maximum-gap parameter. This is done by calculating the Needleman-Wunsch matrix between the start and the end of the matching read within the genome region with a customized implementation.</p>
      <p>Furthermore, glocal alignment can be performed by combining the local alignments produced by alignment tools such as BLAST or GECKO with the provided custom glocal alignment. All parameters can be user-defined, thus providing data processing flexibility. Table <xref rid="Tab1" ref-type="table">1</xref> shows an example of candidate fragments that are extended to conform a glocal alignment.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Before-and-after extension example of a read with two candidate fragments to be joined</p></caption><table frame="hsides" rules="groups"><tbody><tr><td align="left" colspan="4">Before extension of local or ungapped alignments</td><td align="left" colspan="8"/></tr><tr><td align="left" colspan="4">029701.102903 — NC_004663.1 — Bacteroides thetaiotaomicron 897405</td><td align="left" colspan="8"/></tr><tr><td align="left">N</td><td align="left">SCORE</td><td align="left">IDEN</td><td align="left">LEN</td><td align="left">SIM</td><td align="left">IGAPS</td><td align="left">EGAPS</td><td align="left">STRA</td><td align="left">R1</td><td align="left">R2</td><td align="left">G1</td><td align="left">G2</td></tr><tr><td align="left">1</td><td align="left">-</td><td align="left">134</td><td align="left">145</td><td align="left">84</td><td align="left">0</td><td align="left">0</td><td align="left">Plus ∖Plus</td><td align="left">1</td><td align="left">133</td><td align="left">1631420</td><td align="left">1631563</td></tr><tr><td align="left">2</td><td align="left">-</td><td align="left">94</td><td align="left">104</td><td align="left">80</td><td align="left">0</td><td align="left">0</td><td align="left">Plus ∖Plus</td><td align="left">147</td><td align="left">249</td><td align="left">1631564</td><td align="left">1631666</td></tr><tr><td align="left" colspan="4">After extension (“glocal-like” alignment)</td><td align="left" colspan="8"/></tr><tr><td align="left" colspan="4">029701.102903 — NC_004663.1 — Bacteroides thetaiotaomicron 897405</td><td align="left" colspan="8"/></tr><tr><td align="left">1</td><td align="left">-</td><td align="left">224</td><td align="left">248</td><td align="left">90</td><td align="left">1</td><td align="left">2</td><td align="left">Plus ∖Plus</td><td align="left">2</td><td align="left">249</td><td align="left">1631420</td><td align="left">1631665</td></tr></tbody></table><table-wrap-foot><p>In the top, the table before extension. Fragments (1) and (2) are separated by a relatively small gap of 14 base pairs (The ending read coordinate R2 of (1) is 14 base pairs away from R1 in (2)). These fragments represent an example of candidate fragments. The after subtable (bottom) displays the resulting extended fragment and shows a longer alignment with still high similarity and a low number of gaps (one opening gap and two extension gaps). The score is calculated afterwards (See “New score and expected value calculation”).</p></table-wrap-foot></table-wrap>
</p>
    </sec>
    <sec id="Sec5">
      <title>New score and expected value calculation</title>
      <p>The extension of fragments requires the re-calculation of fragment scores to identify the best match out of a list of candidates during the mapping process. The properties of the extended fragment, namely length –of bases–, number of identities and inserted gaps stand for the raw score. The raw score has to be normalized in order to obtain the expected value of a reported fragment. This is performed using K and Lambda parameters using a similar approach to that of the BLAST family. K and Lambda parameter are calculated as described in [<xref ref-type="bibr" rid="CR22">22</xref>].</p>
      <p>To compute the raw score of the extended fragment produced by our custom glocal alignment we apply a traditional affine scoring model (with open and extension gap penalties), as shown in the following formula: 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} RS &amp;= I * M_{r}+ (L-(G_{i}+G_{e})-I)\\ &amp;\quad* M_{p} + G_{i} * P_{i} + G_{e} * P_{e} \end{aligned}  $$ \end{document}</tex-math><mml:math id="M6"><mml:mtable><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">RS</mml:mtext></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mo>∗</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1em"/><mml:mo>∗</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12864_2016_3063_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>Where <italic>RS</italic> stands for “Raw Score”, <italic>I</italic> for the total number of identities in the fragment, <italic>M</italic>
<sub><italic>r</italic></sub> for the match score, <italic>L</italic> for the total length of the fragment in base pairs, <italic>G</italic>
<sub><italic>i</italic></sub> for the total number of open gaps in the fragment, <italic>G</italic>
<sub><italic>e</italic></sub> for the total number of extension gaps in the fragment, <italic>M</italic>
<sub><italic>p</italic></sub> for the mismatch penalty, <italic>P</italic>
<sub><italic>i</italic></sub> for the penalty of an open gap and <italic>P</italic>
<sub><italic>e</italic></sub> for the penalty of an extension gap.</p>
    </sec>
    <sec id="Sec6">
      <title>Mapping</title>
      <p>The mapping module (GMAP) process offers a three-level mapping option that not only discovers highly abundant species that hide others in terms of abundance due to high similarity or uncertainty in the alignment, but to also obtain quality distance measurements between the best 3 candidates for every match. The top three candidates are selected based on identity and coverage thresholds and expected values. Moreover, users can perform different mappings by restraining subsets of reads using different thresholds.</p>
      <p>In a scenario with a highly abundant organism, further analysis can be performed by only considering certain genomes using certain options e.g. to observe differences and extract statistical indicators of close candidates.</p>
    </sec>
    <sec id="Sec7">
      <title>About the mapping decision</title>
      <p>Every read yields a list of reported fragments to which the following algorithm is applied. 
<list list-type="order"><list-item><p>Filtering step: A filtering step allows the researcher to consider only a subset of reported fragments, enabling a levelling up mapping method. If a fragment does not reach pre-filtering thresholds, it will be discarded. Such filtering allows a two phases pre-filtering: 
<list list-type="alpha-lower"><list-item><p>Coverage threshold phase: The length of the match divided by the length of the read.</p></list-item><list-item><p>Identity threshold phase: The number of identities in the match divided by the length of the match.</p></list-item></list>
</p></list-item><list-item><p>Repeat this step for 3-option mapping and, if fragments are still active: Select the fragment with the smallest expected value and if it is lower than the maximum allowed expected value. This fragment is included in the mapping file as first, second or third candidate depending on the number of options chosen and the genome is inactivated for the next option iteration.</p></list-item><list-item><p>If no more fragments are still active or none of them exceeds the thresholds, the read is decided with either no mapping option or up to 3 mapping options.</p></list-item></list>
</p>
      <p>See “Mapping decision and fragments” in the Additional file <xref rid="MOESM1" ref-type="media">1</xref> for more information.</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Results and discussion</title>
    <p>Rather than developing a monolithic application with graphical interfaces, we opted for a simple pipelining procedure in which new software modules can be used to exploit results. To facilitate user interaction, a complete web-based interface has been developed based on Galaxy workflow manager, which enables users to easily run their analyses in both a local instance or in dedicated servers. In addition, a User Guide [<xref ref-type="bibr" rid="CR23">23</xref>] is available. Regarding software modules, all specifications about input and result file formats are shown, facilitating the use of third-party software, such as common graphical libraries and spreadsheets.</p>
    <p>The results given by our workflow software are illustrated by an experiment where two collections of 6 metagenome samples each were extracted from faecal microbial communities of adult female monozygotic and dizygotic twin pairs concordant for leanness or obesity and their mothers [<xref ref-type="bibr" rid="CR24">24</xref>]. Raw data (i.e..sff files) were obtained by 454-pyrosequencing, and inherent artefacts or low-quality sequences were further filtered and removed using Replicates [<xref ref-type="bibr" rid="CR25">25</xref>] software and SeqTrimNext (See “Filtering and trimming parameters” in the Additional file <xref rid="MOESM1" ref-type="media">1</xref> for used parameters). The average size of the read collection ranged from 172 bp to 237 bp after quality control and sequence trimming. The total number of sequences was 2,724,867 for lean metagenomes and 2,972,697 for obese ones. For testing purposes, in this technically-oriented paper we opted to design a synthetic case-control study of two metagenomes by joining samples from lean and obese individuals.</p>
    <sec id="Sec9">
      <title>Reads-abundance and taxonomy classification of reads</title>
      <p>The analysis of the species present in metagenomic samples enables taxonomic classification based on abundance of mapped reads. Information about the species present in metagenomes and variations across a collection of species is yielded by GMAP in Comma Separated Value (csv) format files that can be edited using common spreadsheet software (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">a</xref>).
<fig id="Fig2"><label>Fig. 2</label><caption><p>Three-options mapping analysis. Some data from GMAP-based mapping analysis. <bold>a</bold> Abundance plot for the averaged Lean (<italic>blue</italic>) and Obese (<italic>orange</italic>) metagenomes of the most read-abundance genomes. The plot depicts total mapped reads per specie in the two averaged metagenomes. <bold>b</bold> Three-option abundance by organism. In blue, total first option abundance, (number of reads assigned). In red and green, the number of times an organism was the second and third best candidate for a read. Bacteria with red or green peaks reveal that another organism is probably hiding them (regarding abundance) and there is not a direct consensus. <bold>c</bold> Total reads assigned in log10 scale per species as best candidate (<italic>first option, blue</italic>) and from that total, the number of reads that had two very similar candidates (defined as a distance in terms of identity, length and coverage) from the second best candidate (<italic>in red</italic>). <bold>d</bold> An exhaustive-one-vs-all user-defined analysis where a bacterium is compared against all species in the database. The peak in the plot (near the middle) is the analyzed genome, Ruminococcus obeum ATCC 29,174. This particular scenario depicts a comparison of the target genome against all species by length and abundance. In blue, the percentage of reads that were mapped as second candidate when the best candidate was the target genome. In <italic>orange</italic>, the average length of such mapped reads</p></caption><graphic xlink:href="12864_2016_3063_Fig2_HTML" id="MO2"/></fig>
</p>
      <p>Abundance data are primarily used to determine the species that are present in a metagenomic sample and can be exploited in comparative studies on the over- or under-abundance of species in different samples. However, abundance data does not provide information on the quality and certainty of mapping. This lack of reliability can be partially compensated by using the n-mapping method.</p>
      <p><bold>Three-options mapping analysis</bold> Our software has the ability to perform the mapping of reads through a multiple-level strategy. After the best read-genome mapping value is used, the used fragment is inactivated and the genomes belonging to different strains of the same species are optionally inactivated, and the process is repeated. This way, we get the second, third and subsequent best read-genome mapping values. A long separation between the mapping options provides stronger evidence supporting the validation of the mapping procedure.</p>
      <p>When comparing 3-mapping options, the detection of peaks in second or third options means that a particular species is repeatedly the second or third candidate (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">b</xref>). These peaks suggest that strong similarities exist between a specific pair of species and careful examination is required since the accuracy of mapping is not certain. For instance, it would be interesting to study if the alphabetical order of the BLAST output for sequences with the same expected value is affecting the mapping. These observations can be supported by the analysis of mapping precision (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">c</xref>), which considers the closest reads given a distance parameter and shows the separation in mapping length, the number of identities, or any other chosen parameter between the assigned read and its second best candidate. Additionally, this separation shows the extent of differences between first and second candidates, and therefore is another indicator of the quality of mapping.</p>
      <p>In addition, the 3-mapping approach allows to assess the mapping certainty at both reads and species level; at read level by comparing fragments quality indicators of particular genomes against the rest (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">d</xref>), and at species level by comparing the abundance levels of the different options for the particular genomes. For example, for all reads mapped over a given genome, information about the identity and coverage level of the second and third mapping option would provide information about the quality or certainty of the first option.</p>
      <p>On the other hand, in a joint analysis of the Fig. <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">b</xref> and <xref rid="Fig2" ref-type="fig">c</xref>, no peaks in second or third options, along with a larger separation gap on mapping precision analysis suggest that the accuracy of mapping is high, which reduces the random assignment of reads to genomes and, therefore, the results obtained are more reliable.</p>
      <p>Figure <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">c</xref> displays the number of reads assigned to each species and, in relation to each assignation, the times the second option was almost as good as the first (namely, “shared” reads). The fact that the blue and red lines of two species are close to each other suggests that mapping is not accurate and careful examination is required.</p>
      <p><bold>Fine-grained tuning and closer examination</bold> In a scenario where a specific species has been the second option a higher number of times compared to the first option, as discussed in the previous Section, the mapping should be exhaustively analyzed and compared with other species. Such analysis would provide more certainty of the presence of a low-abundance genome by checking the properties of its matches, and would enable contrasting the variances in the matches between a high-abundance genome and its best second option. Moreover, it is possible to perform a one vs. one, one vs. some, or, some vs. some comparative analysis of the target species. This type of analysis can be performed based on any of the properties of the mapped reads, such as length, similarity, coverage, or any user-defined properties. This information is particularly useful when the first and second mapping options identify different species (in some cases, remotely-related species).</p>
      <p>Figure <xref rid="Fig2" ref-type="fig">2</xref>
<xref rid="Fig2" ref-type="fig">d</xref> illustrates how a number of reads map to very similar sequence regions shared by different species (due to high similarity at genome level –i.e. conserved genes). For example, the mentioned Figure displays the second mapping option of the reads that were mapped as first solution to the Ruminococcus obeum ATCC 29,174. The blue peak in the middle of the plot stands for almost 25 % of the reads assigned to Ruminococcus as first option and to Dorea longicatena DSM 13,814 as second option, which evidences strong similarities in several areas of the two sequences. Additionally, the orange peak at the right side suggests a longer alignment in the second option –Ruminococcus gnavus AGR2154–, thus requiring in-depth analysis of such reads.</p>
      <p><bold>Statistical significance of variations between samples</bold> The presented software can provide statistical data on a number of aspects or characteristics, such as the Z-score test to detect significant variations in the abundance of species in different experimental conditions; or to contrast the significance of the variation at a species level between samples calculating the <italic>p</italic>-values. An interesting example is case-control studies in which differences in reads abundance along genomes can be identified. Z-scores provide accurate information on the significance of such differences (see “Statistical Significance” in the Additional file <xref rid="MOESM1" ref-type="media">1</xref> for more information).</p>
    </sec>
    <sec id="Sec13">
      <title>Genome-specific experiments and quality assessment</title>
      <p><bold>Reads mapping to specific regions of genomes</bold> Besides the proximity measures provided by three-option mapping, there is another important aspect concerning the provision of evidence about the presence of species with low-abundance of reads in the metagenome. The main idea is to find regions in a particular organism that do not exist or do not share similarity at all with other organisms present in the collection of genomes. To accomplish this, <italic>N</italic>−1 comparisons between the reference genome and the <italic>N</italic> genomes contained in the collection are performed using GECKO. This process yields the detected regions and the assigned reads that have been mapped to these regions.</p>
      <p>The extracted reads mapped to these regions provide strong evidence on the presence of low-abundance species in the metagenomic sample, since the mapped read does not fit over other genomes (see “Reads mapping to specific regions of genomes” in Additional file <xref rid="MOESM1" ref-type="media">1</xref> for more information).</p>
      <p><bold>Differential abundance in annotated regions of genomes</bold> Another useful tool is the comparison plot of abundance of annotated regions (potential coding regions that could change abundance values in different samples). This assay is conducted on a particular genome by only considering the reads mapped to annotated regions of the genome and comparing abundance between different samples in the same way as RNA-seq transcriptome expression analysis is performed. Differences in the abundance of reads mapped to annotated regions –when sampling genomic DNA– might be related to environmental changes. This hypothesis is based on the experimental resemblance of the differential expression plot of annotated regions when two samples whose environmental conditions change are compared. Figure <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">a</xref> suggests that some annotated regions are being over- or under-represented, thus suggesting that abundance in annotated regions may be related to variations in the samples.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Genome-specific experiments. Some of the results oriented at a genome-specific-level. <bold>a</bold> DNA-seq differential expression plot. Each point represents an annotated region for a particular genome. In the x-axis and y-axis, the percentage of reads that are mapped to each annotated region divided by the total mapped reads. <bold>b</bold> Accumulated reads mapped onto each position of the genome smoothed using a window of size 10000. In the x-axis, the genome bases from 1 to a portion of its length. In the y-axis, absolute accumulated number of reads mapped. <bold>c</bold> This plot shows how proteins found by searching with annotated (<italic>Left</italic>) and non annotated (<italic>Right</italic>) reads accumulate along similarity and length. The annotated search depicts higher length and similarity matches, resembling Sanders curve (reference in the main text), whereas non-annotated search shows mostly non significant matches. <bold>d</bold> Annotation mapping. This plot shows reads mapped to a particular genome distributed by annotation properties. The three groups are plotted in different colours and shapes, namely <italic>a</italic> orange crosses for unannotated reads, <italic>b</italic> yellow crosses for semi-annotated reads and <italic>c</italic> purple points for fully-annotated reads. The background grey area represents the accumulation of reads for the whole mapped metagenome in logarithmic scale; thus, darker areas represent higher accumulation</p></caption><graphic xlink:href="12864_2016_3063_Fig3_HTML" id="MO3"/></fig>
</p>
      <p><bold>Genome profiling of mapped reads</bold> A genomic profile of mapped reads is the accumulated number of reads mapping to a given position within the genome. Accumulated histograms of abundance of reads provide information about the number of reads at region level, and therefore about variations in such accumulation (in case-control experiments). In principle, when working with genome sequencing, a more or less flat profile would be expected, as opposed to transcriptomics sequence data. The genomic profile helps detect highly active regions or different number of copies in such regions. This visualization tool (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">b</xref>) shows how reads are distributed in a particular species and whether the assigned reads are present along the whole genome or only in the most active areas. Another possibility offered by this tool is that it helps the user decide whether to perform or not a pre-assembly of the reads mapped to a specific genome to support the connections found between reads.</p>
      <p><bold>Extensive and further verification</bold> We propose that the distribution of fragments based on the comparison of reads versus genomes is now divided into two different distributions, as seen in Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">c</xref>. Additional verification was performed by representing the matching values for reads falling into annotated and unannotated regions. This is obtained by blasting the set of annotated and unannotated reads mapped to a given genome against a database of proteins –such as swissprot [<xref ref-type="bibr" rid="CR26">26</xref>]. As expected, different distributions are obtained, which evidences the suitability of using different thresholds. This affirmation is supported by the different levels of sequence conservation in annotated and unannotated regions.</p>
      <p><bold>Mapping over annotated regions of genomes</bold> Annotation mapping is another example of in-depth analysis of a specific genome and, in particular, of low abundance ones. Our workflow uses all the reads assigned to a genome and divides them into three groups: (1) No annotations, in the sense that the annotation files obtained did not contain any annotation at the position where the read was mapped; (2) Semi-annotations, when a part of the mapped read contains annotations, and (3) Full annotations, when the whole read contains an annotation.</p>
      <p>These three groups are plotted onto the whole mapped metagenome distribution (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">d</xref>). The background grey area represents the accumulation of reads for the whole mapped metagenome in logarithmic scale; darker areas represent higher accumulations. The identity-length distribution of reads for all fragments (with any filtering) is provided by GECKO and can be partially obtained from data evidencing significant alignments yielded by other programs (BLAST) (which can be tuned to also report random distribution). The rationale of this result comes from the experiments of Sanders et al. [<xref ref-type="bibr" rid="CR27">27</xref>] and Rost [<xref ref-type="bibr" rid="CR28">28</xref>] that significance is related to the tail of the distributions. Therefore, displaying mapping values on the grey area distribution provides first-glance information about the accuracy of mapping.</p>
    </sec>
    <sec id="Sec19">
      <title>Comparison with other metagenomic tools</title>
      <p>In order to prove that the results of the proposed workflow are consistent with those of other metagenomic analysis software suites (in terms of abundance in the taxonomic classification), the following test was performed using results from BLASTn based on metagenomic samples from faecal microbial communities. Both, our workflow (MG workflow) and MEGAN were executed using the same input from BLASTn and ran with default parameters (available in the Additional file <xref rid="MOESM1" ref-type="media">1</xref> under “Comparison with MEGAN”).</p>
      <p>On comparison of the lean metagenome based on MEGAN, the abundance plot (see Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">a</xref>) shows similar results to ours. Standard deviation from ratios (using abundance data provided by MEGAN and by our workflow) was 0.25, which is not significant enough to identify relevant variations (see Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">b</xref>, <xref rid="Fig4" ref-type="fig">c</xref>). However, whereas the analysis of a metagenome using MEGAN can last nearly an hour, our MG workflow took about six minutes to analyze the obese metagenome and five minutes for the lean one when the comparison had been done with BLAST. With GECKO, the duration of the process was further reduced, taking about only one minute for the lean sample and three minutes and a half for the obese metagenome. Runtime executions were measured using a regular Intel i5 machine with 4 GB of RAM.
<fig id="Fig4"><label>Fig. 4</label><caption><p>MEGAN and MG Workflow comparison. Comparative analysis for the lean metagenome shows similar mapping abundances. <bold>a</bold> Abundance plot by species in percentages. <bold>b</bold> Total reads assigned by each method and total number of reads in the metagenome. <bold>c</bold> Abundance chart by family (except Actinobacteria, shown as Phylum)</p></caption><graphic xlink:href="12864_2016_3063_Fig4_HTML" id="MO4"/></fig>
</p>
    </sec>
  </sec>
  <sec id="Sec20" sec-type="conclusion">
    <title>Conclusions</title>
    <p>Metagenomics is an effervescent field and there are still a number of questions that need to be addressed before a stable version of data analysis software becomes available. Currently, metagenomic analysis tools generally represent a closed environment and offer few configuration options and limited extension possibilities. Our aim was to develop a software framework to which other modules could be added. An additional motivation to develop this software was the need for software sensitive enough to detect the presence of low-abundance species. Finally, our intent was to provide data in standard and editable formats that facilitate further analysis with external software.</p>
    <p>The proposed workflow software offers several notable advantages over the software currently available in the market. Firstly, the use of GECKO enables this software to compute similarity searches in the samples against a collection of genomes in a reasonable time. We found that better results are obtained if a collection of genomes –rather than genes or proteins– is used. At least this was the case when not all genes/proteins from the genomes were registered in reference databases. Moreover, if genomic samples are used (not only transcriptomics), a significant amount of reads would map to unannotated regions, and therefore they would not match to databases composed of genes or proteins.</p>
    <p>Providing different mapping alternatives helps set up a sort of quality measures of the mapping process based on abundance differences across mapping alternatives. In addition, the study of the different alternatives could reveal hidden interactions or shared similarities between species that cooperate in some aspects.</p>
    <p>The proposed software is designed to provide evidence of the presence of low-abundance species by finding particular specific regions of genomes with mapped reads. These mapped reads provide strong evidence of the species present in samples. The methods developed for assessing and evaluating the quality of mapping also improve accuracy and reliability in terms of the identification of the species present in a sample.</p>
    <p>From our perspective, the most important contribution of this workflow software is that it offers the possibility of incorporating new software to extend the analysis workflow by showing datafile specifications enabling fine-grained metagenomic data analysis.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional file</title>
    <sec id="Sec21">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12864_2016_3063_MOESM1_ESM.pdf">
            <label>Additional file 1</label>
            <caption>
              <p>Supplementary material. (PDF 1269 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors of the manuscript want to thank for all the support provided by the Franciele Maboni Siqueira, Arnaldo Zaha, Ana-Tereza Ribeiro de Vasconcelos, Gonzalo Claros and María del Carmen Morcillo Aixela.</p>
    <sec id="d30e1420">
      <title>Declarations</title>
      <p>This article has been published as part of <italic>BMC Genomics</italic> Volume 17 Supplement 8: Selected articles from the Sixth International Conference of the Iberoamerican Society for Bioinformatics on Bioinformatics and Computational Biology for Innovative Genomics. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="https://bmcgenomics.biomedcentral.com/articles/supplements/volume-17-supplement-8">https://bmcgenomics.biomedcentral.com/articles/supplements/volume-17-supplement-8</ext-link>.</p>
    </sec>
    <sec id="d30e1433">
      <title>Funding</title>
      <p>This work has been partially supported by the ISCIII (projects: PT13.001.012 and RD12.013.006) and the EU Comission through the Mr.SBM project, code 324554. The publication fees of this work have been funded by the ISCIII through the project RD12.013.006.</p>
    </sec>
    <sec id="d30e1438">
      <title>Availability of data and materials</title>
      <p>The dataset(s) supporting the conclusions of this article is (are) available in the EBI Metagenomics repository <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/metagenomics/">https://www.ebi.ac.uk/metagenomics/</ext-link>. The software, additional files, user guides, training material and experiments can be found at <ext-link ext-link-type="uri" xlink:href="http://www.bitlab-es.com/geckointhesubsectionMETA-GECKO">http://www.bitlab-es.com/geckointhesubsectionMETA-GECKO</ext-link>.</p>
    </sec>
    <sec id="d30e1453">
      <title>Authors’ contributions</title>
      <p>EP-W and JA-M contributed in the software development. OT and OT supervised and coordinated the work and provided ideas for the development of new tools. EU contributed with the biological aspects of the paper. All of the authors contributed to the manuscript’s preparation. All the authors read and approved the final manuscript.</p>
    </sec>
    <sec id="d30e1458">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="d30e1463">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="d30e1468">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Microbial community analysis using MEGAN</article-title>
        <source>Methods Enzymol</source>
        <year>2012</year>
        <volume>531</volume>
        <fpage>465</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1016/B978-0-12-407863-5.00021-6</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meyer</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The metagenomics RAST server–a public resource for the automatic phylogenetic and functional analysis of metagenomes</article-title>
        <source>BMC Bioinforma</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>386</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-386</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hunter</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>EBI metagenomics—a new resource for the analysis and archiving of metagenomic data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <issue>D1</issue>
        <fpage>D600</fpage>
        <lpage>D6</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt961</pub-id>
        <?supplied-pmid 24165880?>
        <pub-id pub-id-type="pmid">24165880</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>
        <source>Nucleic Acids Res</source>
        <year>1997</year>
        <volume>25</volume>
        <issue>17</issue>
        <fpage>3389</fpage>
        <lpage>402</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/25.17.3389</pub-id>
        <?supplied-pmid 9254694?>
        <pub-id pub-id-type="pmid">9254694</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caporaso</surname>
            <given-names>GJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>QIIME allows analysis of high-throughput community sequencing data</article-title>
        <source>Nat Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>5</issue>
        <fpage>335</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.f.303</pub-id>
        <?supplied-pmid 20383131?>
        <pub-id pub-id-type="pmid">20383131</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>BLAT—the BLAST-like alignment tool</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <issue>4</issue>
        <fpage>656</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.229202.ArticlepublishedonlinebeforeMarch2002</pub-id>
        <?supplied-pmid 11932250?>
        <pub-id pub-id-type="pmid">11932250</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <mixed-citation publication-type="other">METApipe Metagenomics Analysis Pipeline. <ext-link ext-link-type="uri" xlink:href="http://bdps.cs.uit.no/papers/nesus-metapipe.pdf">http://bdps.cs.uit.no/papers/nesus-metapipe.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Noguchi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Taniguchi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Itoh</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>MetaGeneAnnotator: detecting species-specific patterns of ribosomal binding site for precise gene prediction in anonymous prokaryotic and phage genomes</article-title>
        <source>DNA Res</source>
        <year>2008</year>
        <volume>15</volume>
        <issue>6</issue>
        <fpage>387</fpage>
        <lpage>96</lpage>
        <pub-id pub-id-type="doi">10.1093/dnares/dsn027</pub-id>
        <?supplied-pmid 18940874?>
        <pub-id pub-id-type="pmid">18940874</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Noguchi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Takagi</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>MetaGene: prokaryotic gene finding from environmental genome shotgun sequences</article-title>
        <source>Nucleic Acids Res</source>
        <year>2006</year>
        <volume>34</volume>
        <issue>19</issue>
        <fpage>5623</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkl723</pub-id>
        <?supplied-pmid 17028096?>
        <pub-id pub-id-type="pmid">17028096</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oliveira</surname>
            <given-names>MFdS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ribosome binding site recognition using neural networks</article-title>
        <source>Genet Mol Biol</source>
        <year>2004</year>
        <volume>27</volume>
        <issue>4</issue>
        <fpage>644</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1590/S1415-47572004000400028</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kultima</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MOCAT: a metagenomics assembly and gene prediction toolkit</article-title>
        <source>PLoS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>10</issue>
        <fpage>e47656</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0047656</pub-id>
        <?supplied-pmid 23082188?>
        <pub-id pub-id-type="pmid">23082188</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <mixed-citation publication-type="other">Illumina Sequencing Methods. <ext-link ext-link-type="uri" xlink:href="http://www.illumina.com/techniques/sequencing.html">http://www.illumina.com/techniques/sequencing.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Falgueras</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SeqTrim: a high-throughput pipeline for pre-processing any type of sequence read</article-title>
        <source>BMC Bioinforma</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-38</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <mixed-citation publication-type="other">454 Life Sciences Technology. <ext-link ext-link-type="uri" xlink:href="http://my454.com/products/technology.asp">http://my454.com/products/technology.asp</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolger</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lohse</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Usadel</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Trimmomatic: a flexible trimmer for Illumina sequence data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2114</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu170</pub-id>
        <?supplied-pmid 24695404?>
        <pub-id pub-id-type="pmid">24695404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Afgan</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>van den Beek</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Blankenberg</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bouvier</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Čech</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chilton</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Clements</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Coraor</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Galaxy platform for accessible, reproducible and collaborative biomedical analyses: 2016 update</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>W3</fpage>
        <lpage>W10</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw343</pub-id>
        <?supplied-pmid 27137889?>
        <pub-id pub-id-type="pmid">27137889</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Torreno</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Trelles</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Breaking the computational barriers of pairwise genome comparison</article-title>
        <source>BMC Bioinforma</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-015-0679-9</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rumble</surname>
            <given-names>SM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SHRiMP: accurate mapping of short color-space reads</article-title>
        <source>PLoS Comput Biol</source>
        <year>2009</year>
        <volume>5</volume>
        <issue>5</issue>
        <fpage>e1000386</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000386</pub-id>
        <?supplied-pmid 19461883?>
        <pub-id pub-id-type="pmid">19461883</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <mixed-citation publication-type="other">SOLiD Next-Generation Sequencing. <ext-link ext-link-type="uri" xlink:href="http://www.thermofisher.com/es/es/home/life-science/sequencing/next-generation-sequencing/solid-next-generation-sequencing.html?cid=fl-WE111642">http://www.thermofisher.com/es/es/home/life-science/sequencing/next-generation-sequencing/solid-next-generation-sequencing.html?cid=fl-WE111642</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benson</surname>
            <given-names>DA</given-names>
          </name>
          <etal/>
        </person-group>
        <source>GenBank. Nucleic Acids Res</source>
        <year>2008</year>
        <volume>36</volume>
        <issue>suppl 1</issue>
        <fpage>D25</fpage>
        <lpage>D30</lpage>
        <?supplied-pmid 18073190?>
        <pub-id pub-id-type="pmid">18073190</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brudno</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Glocal alignment: finding rearrangements during alignment</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <issue>suppl 1</issue>
        <fpage>i54</fpage>
        <lpage>i62</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg1005</pub-id>
        <?supplied-pmid 12855437?>
        <pub-id pub-id-type="pmid">12855437</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karlin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
        </person-group>
        <article-title>Methods for assessing the statistical significance of molecular sequence features by using general scoring schemes</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>1990</year>
        <volume>87</volume>
        <issue>6</issue>
        <fpage>2264</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.87.6.2264</pub-id>
        <?supplied-pmid 2315319?>
        <pub-id pub-id-type="pmid">2315319</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <mixed-citation publication-type="other">Galaxy Guided Exercise at BitLab’s Research Site. <ext-link ext-link-type="uri" xlink:href="http://www.bitlab-es.com/gecko/documents/GalaxyGuidedExercise.pdf">www.bitlab-es.com/gecko/documents/GalaxyGuidedExercise.pdf</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A core gut microbiome in obese and lean twins</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>457</volume>
        <issue>7228</issue>
        <fpage>480</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1038/nature07540</pub-id>
        <?supplied-pmid 19043404?>
        <pub-id pub-id-type="pmid">19043404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gomez-Alvarez</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Teal</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>TM</given-names>
          </name>
        </person-group>
        <article-title>Systematic artifacts in metagenomes from complex microbial communities</article-title>
        <source>ISME J</source>
        <year>2009</year>
        <volume>3</volume>
        <issue>11</issue>
        <fpage>1314</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/ismej.2009.72</pub-id>
        <?supplied-pmid 19587772?>
        <pub-id pub-id-type="pmid">19587772</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boeckmann</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The SWISS-PROT protein knowledgebase and its supplement TrEMBL in 2003</article-title>
        <source>Nucleic Acids Res</source>
        <year>2003</year>
        <volume>31</volume>
        <issue>1</issue>
        <fpage>365</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkg095</pub-id>
        <?supplied-pmid 12520024?>
        <pub-id pub-id-type="pmid">12520024</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sander</surname>
            <given-names>Ch</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Database of homology derived protein structures and the structural meaning of sequence alignment</article-title>
        <source>Proteins</source>
        <year>1991</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>56</fpage>
        <lpage>68</lpage>
        <pub-id pub-id-type="doi">10.1002/prot.340090107</pub-id>
        <?supplied-pmid 2017436?>
        <pub-id pub-id-type="pmid">2017436</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rost</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Twilight zone of protein sequence alignments</article-title>
        <source>Protein Eng</source>
        <year>1999</year>
        <volume>12</volume>
        <fpage>85</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="doi">10.1093/protein/12.2.85</pub-id>
        <?supplied-pmid 10195279?>
        <pub-id pub-id-type="pmid">10195279</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
