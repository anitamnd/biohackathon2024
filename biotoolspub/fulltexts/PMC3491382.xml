<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1465-6906</issn>
    <issn pub-type="epub">1465-6914</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3491382</article-id>
    <article-id pub-id-type="publisher-id">gb-2012-13-7-r61</article-id>
    <article-id pub-id-type="pmid">22784381</article-id>
    <article-id pub-id-type="doi">10.1186/gb-2012-13-7-r61</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Bis-SNP: Combined DNA methylation and SNP calling for Bisulfite-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="A1">
        <name>
          <surname>Liu</surname>
          <given-names>Yaping</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>yapingli@usc.edu</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Siegmund</surname>
          <given-names>Kimberly D</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>kims@usc.edu</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Laird</surname>
          <given-names>Peter W</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>plaird@usc.edu</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A4">
        <name>
          <surname>Berman</surname>
          <given-names>Benjamin P</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>bberman@usc.edu</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>USC Epigenome Center, University of Southern California, 1450 Biggy Street, Los Angeles, CA 90089, USA</aff>
    <aff id="I2"><label>2</label>Genetics, Molecular and Cellular Biology Program, University of Southern California, 1975 Zonal Avenue KAM-B16, Los Angeles, CA 90089, USA</aff>
    <aff id="I3"><label>3</label>Department of Preventive Medicine, Keck School of Medicine, University of Southern California, 1441 Eastlake Avenue, Los Angeles, CA 90089, USA</aff>
    <pub-date pub-type="ppub">
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>7</month>
      <year>2012</year>
    </pub-date>
    <volume>13</volume>
    <issue>7</issue>
    <fpage>R61</fpage>
    <lpage>R61</lpage>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>5</month>
        <year>2012</year>
      </date>
      <date date-type="rev-recd">
        <day>3</day>
        <month>7</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>7</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2012 Liu et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <copyright-holder>Liu et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://genomebiology.com/2012/13/7/R61"/>
    <abstract>
      <p>Bisulfite treatment of DNA followed by high-throughput sequencing (Bisulfite-seq) is an important method for studying DNA methylation and epigenetic gene regulation, yet current software tools do not adequately address single nucleotide polymorphisms (SNPs). Identifying SNPs is important for accurate quantification of methylation levels and for identification of allele-specific epigenetic events such as imprinting. We have developed a model-based bisulfite SNP caller, Bis-SNP, that results in substantially better SNP calls than existing methods, thereby improving methylation estimates. At an average 30× genomic coverage, Bis-SNP correctly identified 96% of SNPs using the default high-stringency settings. The open-source package is available at <ext-link ext-link-type="uri" xlink:href="http://epigenome.usc.edu/publicationdata/bissnp2011">http://epigenome.usc.edu/publicationdata/bissnp2011</ext-link>.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Cytosine methylation of DNA plays an important role in mammalian gene regulation, chromatin structure and imprinting during normal development and the development of pathological conditions such as cancer. With the dramatic increase in throughput made possible by next-generation DNA sequencing technologies, sodium bisulfite conversion followed by massively parallel sequencing (Bisulfite-seq) has become an increasingly popular method for investigating epigenetic profiles in the human genome (reviewed in [<xref ref-type="bibr" rid="B1">1</xref>]). Several sequencing strategies have been applied that vary in terms of cost and the regions of the genome covered. Reduced Representation Bisulfite-Seq (RRBS [<xref ref-type="bibr" rid="B2">2</xref>]) uses restriction fragment size selection to select a portion of the genome enriched for CpG Islands and gene regulatory sequences. Bisulfite Padlock Probes (BSPP [<xref ref-type="bibr" rid="B3">3</xref>]) or solution-based hybridization capture (Agilent, Inc., Santa Clara, CA, USA) can be designed for customizable selection of hundreds of thousands of regions throughout the genome. Whole-Genome Bisulfite-Seq (WGBS [<xref ref-type="bibr" rid="B4">4</xref>]) is the most comprehensive technique, covering more than 90% of cytosines in the human genome. Bisulfite-seq is well-suited to the investigation of epigenetic changes from clinical tissue samples [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>], and can be applied to very small quantities of DNA [<xref ref-type="bibr" rid="B7">7</xref>] including formalin-fixed samples [<xref ref-type="bibr" rid="B8">8</xref>]. WGBS and RRBS data have been used to profile a number of cell lines and human tissues by large sequencing consortia including the ENCODE project [<xref ref-type="bibr" rid="B9">9</xref>], the NIH Epigenomics Roadmap, and The Cancer Genome Atlas (TCGA), and these datasets are publicly available for download.</p>
    <p>Bisulfite treatment of DNA converts unmethylated cytosines to uracils, which are replaced by thymines during amplification. This dramatic change to sequence composition necessitates specialized software for almost all sequence analysis tasks. Typically, the first step in processing high-throughput sequencing data is to map and align each read to the correct location in the reference genome (genome mapping), and a number of powerful tools have been developed to map bisulfite-converted reads (reviewed in [<xref ref-type="bibr" rid="B10">10</xref>]). The next step is to identify differences between the reference genome and the sample genome, including single-nucleotide polymorphisms (SNPs) and insertion/deletion events (indels). The identification of SNPs has been an active area of research and a number of powerful statistical tools have been developed for SNP calling of non-bisulfite sequencing data [<xref ref-type="bibr" rid="B11">11</xref>-<xref ref-type="bibr" rid="B13">13</xref>]. SNP calling of bisulfite sequencing data has significant complications. First, reads from the two genomic strands are not complementary, and this assumption of complementarity is made by all SNP calling algorithms. Second, true (evolutionary) C&gt;T SNPs in the sample cannot be distinguished from C&gt;T substitutions that are caused by bisulfite conversion, and can thus be misidentified as unmethylated Cs. Consequently, identification of such SNPs is important for accurate quantification of methylation levels, especially so given the fact that C&gt;T is the most common substitution in the human population (65% of all SNPs in dbSNP) and these usually occur in the CpG context [<xref ref-type="bibr" rid="B14">14</xref>].</p>
    <p>Accurate SNP calling at the positions immediately surrounding a cytosine is equally important. Those nucleotides lying one or two positions 3' of the cytosine are particularly critical, as they are subject to the specificity of particular methyltransferases. These methyltransferase-specific context positions can be organism or cell type specific. In mammals, CpG dinucleotides are often highly methylated in most cell types, while CpA dinucleotides have much lower methylation levels and are cell type restricted [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B15">15</xref>]. In plants, by contrast, CHG trinucleotides are often methylated [<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B17">17</xref>]. Other sequences within a slightly wider genomic neighborhood can also have strong <italic>cis </italic>effects on methylation, perhaps due to the presence of key regulatory motifs [<xref ref-type="bibr" rid="B18">18</xref>]. Heterozygous SNPs in proximity to cytosines can be used to reveal widespread allele-specific methylation patterns [<xref ref-type="bibr" rid="B19">19</xref>] and important regulatory changes such as loss of imprinting [<xref ref-type="bibr" rid="B20">20</xref>-<xref ref-type="bibr" rid="B22">22</xref>].</p>
    <p>Despite the great interest in Bisulfite-seq and the availability of a number of tools for genomic mapping, no adequate software exists for SNP calling [<xref ref-type="bibr" rid="B10">10</xref>]. In order to overcome the difficulty in identifying SNPs in bisulfite-treated sequences, some groups have relied on matched non-bisulfite sequencing data in the same sample [<xref ref-type="bibr" rid="B23">23</xref>-<xref ref-type="bibr" rid="B25">25</xref>]. Others have used non-bisulfite SNP microarrays [<xref ref-type="bibr" rid="B26">26</xref>,<xref ref-type="bibr" rid="B27">27</xref>], or used study designs relying on isogenic mouse strains with known parental genotypes [<xref ref-type="bibr" rid="B22">22</xref>,<xref ref-type="bibr" rid="B24">24</xref>].</p>
    <p>A key property of some bisulfite-related protocols is that G nucleotides on the strand opposing a C are not affected by conversion. This strand-specificity principle has been exploited in order to distinguish bisulfite conversion from C&gt;T SNPs [<xref ref-type="bibr" rid="B28">28</xref>]. The Illumina-based protocol currently being used in most Bisulfite-seq studies has this important property, and thus it has been classified as a <italic>directional </italic>bisulfite-seq protocol [<xref ref-type="bibr" rid="B10">10</xref>]. <italic>Non-directional </italic>protocols (those that also result in G&gt;A substitutions) have been used [<xref ref-type="bibr" rid="B17">17</xref>], but have not been widely adopted. Figure <xref ref-type="fig" rid="F1">1</xref> illustrates the directional protocol, where approximately half the reads at a given cytosine position (those mapping to the 'C-strand') can be used for methylation quantification but cannot distinguish C&gt;T SNPs. The other half (those mapping to the 'G-strand', boxed in Figure <xref ref-type="fig" rid="F1">1a</xref>) yield no methylation information but can be used to identify C&gt;T SNPs. When these C&gt;T SNPs are heterozygous, they can be used in the analysis of allele specific methylation (Additional File <xref ref-type="supplementary-material" rid="S1">1</xref>).</p>
    <fig id="F1" position="float">
      <label>Figure 1</label>
      <caption>
        <p><bold>Detecting single nucleotide polymorphisms from Bisulfite-seq data</bold>. Hypothetical bisulfite-sequencing data is shown, with reference genome at top, genome of the individual sequenced (unobserved) in the middle, and bisulfite sequencing reads bottom. (<bold>a</bold>) shows three reference cytosine positions, with the first being a match to the reference genome and the second two being <italic>homozygous </italic>single nucleotide polymorphisms. The first case shows a true C:G genotype, and all reads on the same strand as the C (the 'C-strand') are read as T, indicating an unmethylated state (shown as blue). Because the Illumina Bisulfite-seq protocol is 'directional', reads on the opposite strand (the 'G-strand') are read as the true genotype, G ('genotype' reads on the G-strand are boxed in this figure). The second case illustrates a true C&gt;T SNP, which can be distinguished by the A reads present on the G-strand. In this case, the reads on the C-strand are inferred to be from a true 'T' and should <italic>not </italic>be used for methylation calling (crossed out here). The third case shows a T&gt;C SNP, which again can be identified based on G-strand reads. (<bold>b</bold>) A cytosine position with 50% unmethylated (T) and 50% methylated (C) reads can be associated with a heterozygous SNP on the same sequencing reads. In this case, the unmethylated reads are those on the 'A' allele chromosome (here shown as maternal) and the methylated reads are on the 'T' allele chromosome.</p>
      </caption>
      <graphic xlink:href="gb-2012-13-7-r61-1"/>
    </fig>
    <p>The inherent directionality of Illumina Bisulfite-seq has thus far been used only in a limited and <italic>ad hoc </italic>way. The Salk Institute group filtered out cytosines which did not have one or more unconverted Cs on the C-strand, but this approach can result in lost information about completely unmethylated cytosines (which play a crucial role in gene regulation) [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B29">29</xref>]. Our own group filtered out reference Cs if opposing reads contained As, but the number of such A reads required was somewhat arbitrary [<xref ref-type="bibr" rid="B6">6</xref>]. A third group removed all C/T reads on the C-strand, and called SNPs by requiring a minimum number of reads containing two different alleles [<xref ref-type="bibr" rid="B30">30</xref>]. Importantly, none of these so-called 'k-allele' approaches took advantage of base calling quality scores, which have been shown to be extremely important for distinguishing true SNPs from sequencing errors [<xref ref-type="bibr" rid="B31">31</xref>]. Others used various methods that did not attempt to identify C/T or other SNPs occurring at cytosines [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B20">20</xref>,<xref ref-type="bibr" rid="B21">21</xref>]. Such methods may be useful for analyzing allele-specific patterns in a limited way, but do not address the need to improve methylation quantification by identifying SNPs.</p>
    <p>Here, we describe a probabilistic SNP caller, <monospace>Bis-SNP</monospace>, that is based on methods that have proven successful in non-bisulfite SNP calling [<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B13">13</xref>]. Bis-SNP uses Bayesian inference to evaluate a model of strand-specific base calls and base call quality scores, along with prior information on population SNP frequencies, experiment-specific bisulfite conversion efficiency, and site-specific DNA methylation estimates. It also takes advantage of base call quality score recalibration, an addition that has greatly improved SNP calling in the non-bisulfite context [<xref ref-type="bibr" rid="B12">12</xref>]. Bis-SNP is open-source and based on the GATK framework [<xref ref-type="bibr" rid="B32">32</xref>], which takes advantage of the parallel Map-Reduce computation strategy and provide practical execution times. Bis-SNP accepts either single-end or paired-end mapped Bisulfite-seq data in the form of BAM files, and outputs SNP and methylation information using standard file formats. We show that Bis-SNP is a practical tool that can both (1) improve DNA methylation calling accuracy by detecting SNPs at cytosines and adjacent positions, and (2) identify heterozygous SNPs that can be used to investigate mono-allelic DNA methylation and polymorphisms in cis-regulatory sequences.</p>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <sec>
      <title>Bis-SNP workflow</title>
      <p>The two primary steps in the Bis-SNP workflow are outlined in Figure <xref ref-type="fig" rid="F2">2a</xref> and include base quality re-calibration and local realignment followed by SNP calling. Bis-SNP accepts standard alignment files (<monospace>.bam</monospace> format), which can be generated by popular Bisulfite-seq mapping programs such as MAQ, Bismark, BSMAP, PASH, or Novoalign (reviewed in [<xref ref-type="bibr" rid="B10">10</xref>]). This allows the user to decide which mapping criteria are most important for their specific application. This also makes Bis-SNP compatible with specialized mappers such as RRBSMAP [<xref ref-type="bibr" rid="B33">33</xref>] and any other program that can output (<monospace>.bam</monospace>) files.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>Bis-SNP workflow</bold>. (<bold>a</bold>) Bis-SNP accepts <monospace>.bam</monospace> files, produced by a genome mapping tool (BSMAP, MAQ, Novoalign, Bismark, and so on). The local realignment and base quality recalibration steps result in a new BAM with the recalibrated base quality scores. Finally, Bis-SNP performs SNP calling and outputs both methylation levels and SNP calls. (<bold>b</bold>) The SNP calling step is performed on each genomic position independently. Differences between the reference genome and the sample genome can produce one of 10 possible allele pairs or genotype (<bold>G</bold>, only 4 shown here). Frequencies of all possible substitutions in the population are taken from the dbSNP database and represented as <italic>π</italic>(<bold>G</bold>). A probabilistic model that incorporates prior probabilities for methylation level and bisulfite conversion efficiency is used to calculate the probability of observing the actual bisulfite read data (<bold>D</bold>) assuming each of the 10 genotypes (<italic>Pr</italic>(<bold>G</bold>|<bold>D</bold>)) Finally, bayesian inference uses the population frequencies of each SNP to calculate the posterior likelihood <italic>Pr</italic>(<bold>D</bold>|<bold>G</bold>).</p>
        </caption>
        <graphic xlink:href="gb-2012-13-7-r61-2"/>
      </fig>
      <p>The Bis-SNP model relies on the accuracy of base quality scores, which are initially estimated by the instrument-specific base caller. However, these initial base scores do not accurately represent true error probabilities, which are highly dependent on local sequence context [<xref ref-type="bibr" rid="B12">12</xref>]. In the GATK workflow, empirical mismatch rates for each nucleotide at each sequencing cycle are calculated by comparing base calls to the reference genome, and these mismatch rates are used to recalibrate instrument-generated values [<xref ref-type="bibr" rid="B12">12</xref>]. We cannot use this default implementation with bisulfite-seq data, because true C&gt;T sequencing errors can not be identified when the underlying methylation state of each bisulfite-converted DNA fragment is unknown. Therefore, instead of treating Ts at reference cytosines as errors, we treat them as a 5th base <italic>X</italic>, and estimate these as a group separately from T&gt;T, A&gt;T, or G&gt;T. The effect is that we can effectively recalibrate base call quality scores for all except the <italic>X </italic>nucleotide, improving our ability to accurately identify SNPs. Importantly, we are able to improve SNP calling at cytosines by recalibrating 'G-strand' Gs that are complementary to the cytosine.</p>
      <p>The user can choose among several output files. For methylation levels, Bis-SNP can return a standard UCSC <monospace>.bed</monospace> or <monospace>.wig</monospace> file, and a separate output file is generated for each cytosine context specified by the user on the command line. Example cytosine contexts are CG, CH, or CHH (H is the IUPAC symbol for A,C, or T). The <monospace>.wig</monospace> output contains the methylation percentage for each methylated cytosine, while the <monospace>.bed</monospace> format also contains the number of C/T reads the percentage is based on, plus the strand of each cytosine relative to the reference genome. For SNPs, Bis-SNP can return a Variant Calling Format (<monospace>.vcf</monospace>) file, which contains all SNP calls and likelihood scores in addition to methylation percentages.</p>
    </sec>
    <sec>
      <title>Description of SNP calling algorithm</title>
      <p>The core of the SNP calling algorithm is based on the Bayesian inference model of GATK [<xref ref-type="bibr" rid="B12">12</xref>], and implemented using GATK's LocusWalker class. For each locus, Bis-SNP evaluates one of ten possible diploid genotypes (<bold>G</bold>), as shown in Figure <xref ref-type="fig" rid="F2">2B</xref> (a diploid genotype is made up of two parental alleles, referred to as <italic>A </italic>and <italic>B</italic>). The prior probability of each genotype, <italic>π</italic>(<bold>G</bold>), is determined using population data from dbSNP (including 1000 genomes data) similar to SOAPsnp [<xref ref-type="bibr" rid="B13">13</xref>] (See Materials and Methods). In this model, the likelihood of observing all base calls at a particular locus, assuming a particular diploid genotype <italic>AB</italic>, is expressed as <italic>Pr</italic>(<bold>D</bold>|<bold>G </bold>= <italic>AB</italic>) and is the product of observing the base call at each individual read <italic>j </italic>(Equation 2 of Materials and Methods). As described below, <italic>Pr</italic>(<italic>D<sub>j</sub></italic>|<bold>G </bold>= <italic>AB</italic>) is calculated according to the strand of read <italic>j </italic>and several bisulfite-specific parameters, <italic>β,α </italic>and <italic>γ </italic>(Figure <xref ref-type="fig" rid="F2">2b</xref>).</p>
      <p>In the GATK non-bisulfite SNP calling model, the probability of observing a base call different from the presumed genotype <bold>G </bold>is simply the base call quality score (defined as the probability of a base calling error). In the case of Bisulfite-seq, this is true for A:T genotypes but not C:G. For C:G genotypes, the probability of observing a T depends on the strand of the read, the methylation state, and the efficiency of bisulfite conversion. Reads on the G-strand opposite the cytosine are treated with the normal GATK model. Reads on the C-strand use an alternate model that considers C&gt;T substitutions as either potential errors or bisulfite conversions (see Materials and Methods). The probability of observing a bisulfite conversion event depends on both the underlying methylation state and bisulfite conversion errors. While none of these are observed directly, they are included in the model as variables <italic>β,α </italic>and <italic>γ </italic>as described in Equation 5 in the Methods section.</p>
      <p>After bisulfite treatment, an unmethylated C that fails to get converted to a T is referred to as an <italic>underconversion</italic>, while a methylated C that is converted to T is referred to as an <italic>overconversion</italic>. The underconversion rate, <italic>α</italic>, is often estimated using either a spike in control [<xref ref-type="bibr" rid="B4">4</xref>] or the unmethylated mitochondrial genome [<xref ref-type="bibr" rid="B6">6</xref>]. This rate can be set manually by the user and has a value of 0.25% by default. While bisulfite overconversion can not be reliably measured using current Bisulfite-seq data, we include an additional parameter, <italic>γ</italic>, which is set to 0% by default. In the future, this could be estimated by spiking in fully-methylated control DNA.</p>
      <p>The percentage of methylated reads at a given cytosine position can vary widely. Since C reads and T reads yield more information about the presence of a C&gt;T SNP than T reads, the locus-specific methylation rate can strongly influence SNP calling. In mammalian genomes, CpG methylation levels are multimodal, with various classes of functional elements having distinct methylation patterns. At least four different classes exist with mean methylation rates ranging from around 0% to over 80% [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B24">24</xref>]. Furthermore, methylation at particular di- or tri-nucleotide contexts is organism and even cell type specific. To better understand how methylation estimates could affect SNP calling performance, we implemented several different methods for estimating the methylation frequency parameter <italic>β</italic>, which we describe next.</p>
      <p>First, we used a <italic>naive </italic>estimate for <italic>β </italic>where the probability of a read being methylated or unmethylated at any particular cytosine position was 0.5. Second, we used <italic>context-specific </italic>estimates which were determined in a two-round procedure as follows. In the first round, <italic>naive </italic>estimates were used as described above, and the resulting SNP calls were used along with dbSNP to select a set of high-confidence non-SNP homozygous cytosines (probability&gt;99.99%). These homozygous cytosines were used to estimate average methylation levels for a set of cytosine sequence contexts that could be specified on the Bis-SNP command line (by default, set to <italic>β<sub>CG </sub></italic>and <italic>β<sub>CH</sub></italic>). In the third and final estimation method, <italic>β </italic>was estimated for each cytosine locus individually using the number of C and T reads (<inline-formula><mml:math id="M1" name="gb-2012-13-7-r61-i1" overflow="scroll"><mml:mfrac><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo class="MathClass-bin">+</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula>). The rationale for this <italic>locus-specific </italic>method was our concern that genome-wide estimates might be inappropriate CpGs, given the strongly bimodal nature of CpG methylation levels. Each of these three <italic>β </italic>estimation methods was run individually as described below. The default method for the public version of Bis-SNP is <italic>locus-specific </italic>estimation.</p>
    </sec>
    <sec>
      <title>Evaluation of SNP calls at known SNPs</title>
      <p>We evaluated Bis-SNP calling accuracy for each of the three different methylation estimation methods (<italic>naive</italic>, <italic>context-specific</italic>, and <italic>locus-specific</italic>). The latter two methods performed substantially better than <italic>naive </italic>estimation, so those are the only two discussed below. We evaluated accuracy using an actual whole-genome Bisulfite-seq dataset from a normal (male) human colon mucosa sample published previously by our lab [<xref ref-type="bibr" rid="B6">6</xref>] (sequence available via accession dbGap:phs000385). All reads were 75 bp long single-end, and generated using the Illumina Genome Analyzer IIx platform. The complete dataset had an average read depth of 32X. The Bisulfite-seq data were compared to Illumina Human1M-Duo BeadChip SNP array data from same sample.</p>
      <p>The primary goal of bisulfite sequencing is the accurate determination of cytosine methylation levels, so we first investigated the ability of Bis-SNP to correctly identify homozygous cytosines. As the 'ground truth', we used 435,120 positions identified as homozygous cytosines on the 1 M SNP array, and examined false negative and false positive calls made by Bis-SNP (Figure <xref ref-type="fig" rid="F3">3a-c</xref>). Calls at varying stringencies were generated by adjusting the Bis-SNP score cutoff, which is defined as the odds ratio between the first and second most likely genotype (see Methods). Evaluating the different Bis-SNP methylation estimates with and without base quality recalibration showed that the <italic>locus-specific β </italic>estimation plus recalibration produced the most accurate results. Using the complete sequence dataset and the default score cutoff (Figure <xref ref-type="fig" rid="F3">3c, r</xref>ed circle), Bis-SNP was able to detect 95.22% of the true cytosines (414,327 features) with a false positive rate of 0.37% (2,461 features). We simulated lighter sequencing coverage by randomly picking reads from the full dataset to estimate accuracy at 8× (Figure <xref ref-type="fig" rid="F3">3a</xref>) and 16× (Figure <xref ref-type="fig" rid="F3">3b</xref>) genomic coverage. The reader should note that these false positive rates are not indicative of the genome-wide false positive rates, since most false positives come from heterozygous SNPs which are frequent on the SNP array but very infrequent in the genome.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>Bis-SNP error frequencies in detecting SNPs on the Illumina 1 M SNP array</bold>. Receiver Operating Characteristics (ROC curves) are shown for Bis-SNP accuracy at detecting SNPs in Bisulfite-seq data derived from human colonic mucosa tissue. The 'true' genotypes were determined using an Illumina Duo 1 M Human SNP array, and Bis-SNP results were only evaluated at these million genomic positions. All datasets were from [<xref ref-type="bibr" rid="B6">6</xref>]. The three ROC curves at the top (a-c) show accuracy at positions corresponding to 435,120 homozygous cytosines on the 1 M SNP array. By randomly downsampling from the average 32× read depth of the Bisulfite-seq data, we are able to show results corresponding to 8× coverage (<bold>a</bold>), 16× coverage (<bold>b</bold>). Bis-SNP using three different conditions is compared to Bismark and the method used in 'Berman2012' [<xref ref-type="bibr" rid="B6">6</xref>], both of which restrict their results to reference cytosines. For 'Berman2012', we varied the number of reverse strand G reads required to plot a range of stringencies. The three plots at the bottom (<bold>d-f</bold>) show accuracy at the 303,656 positions that are heterozygous according to the 1 M SNP array. For comparison, we show results from the k-allele method (similar to the approach of [<xref ref-type="bibr" rid="B30">30</xref>]), Shoemaker2010 [<xref ref-type="bibr" rid="B20">20</xref>] and <monospace>bisReadMapper</monospace>[<xref ref-type="bibr" rid="B3">3</xref>].</p>
        </caption>
        <graphic xlink:href="gb-2012-13-7-r61-3"/>
      </fig>
      <p>For comparison, we determined the accuracy of homozygous cytosine calling using several published methods (Figure <xref ref-type="fig" rid="F3">3a-c</xref>). <monospace>Bismark</monospace>[<xref ref-type="bibr" rid="B34">34</xref>] returns methylation estimates for all cytosines in the reference genome. It is thus not surprising that <monospace>Bismark</monospace> performs poorly for features on the 1 M SNP array, which were selected for their polymorphism and differences from the reference genome. Several other published studies use the same strategy and estimate methylation at all reference cytosines [<xref ref-type="bibr" rid="B35">35</xref>,<xref ref-type="bibr" rid="B36">36</xref>]. In our own earlier work [<xref ref-type="bibr" rid="B6">6</xref>], we also restricted methylation calling to reference cytosines. Thus it is not surprising that when we applied this method ('Berman2012') to the 1 M SNP array dataset, it achieved almost the same false negative rate as <monospace>Bismark</monospace>. However, 'Berman2012' filtered out positions where less than 90% of reads were C or T on the C-strand and G on the G-strand, resulting in a substantially lower false positive rates than <monospace>Bismark</monospace>, but not as low as Bis-SNP.</p>
      <p>We next focused on the ability of Bis-SNP to determine heterozygous SNPs, which can be used both for improving methylation calling accuracy as well as allele-specific methylation analysis (see Figure <xref ref-type="fig" rid="F1">1b</xref>). Heterozygous SNPs are more difficult to identify than homozygous SNPs, due to the approximately 1/2 the read coverage for each allele. We excluded the haploid × chromosome, leaving 303,656 autosomal loci called as heterozygous by the 1 M SNP array. As before, the <italic>locus-specific β </italic>methylation estimation plus recalibration performed the best of all methods. Using the full dataset with the default Bis-SNP cutoff (Figure <xref ref-type="fig" rid="F3">3c</xref>, red circle), Bis-SNP was able to identify 93.18% of heterozygous SNPs (282,944 loci) with a false positive rate of 0.094% (755 loci). Of the 303,656 heterozygous loci examined, 242,347 (79.81%) were C/T heterozygotes. C&gt;T is the most common SNP in mammals, arising from evolutionary deamination of methylated cytosines. It is also the most difficult SNP to detect in bisulfite-treated DNA, because the C-strand reads are often uninformative (see Figure <xref ref-type="fig" rid="F1">1</xref>). As expected, Bis-SNP (and other methods) performed more poorly on C/T heterozygous SNPs than others, due to C&gt;T conversion ambiguity (Additional File <xref ref-type="supplementary-material" rid="S2">2</xref>).</p>
      <p>We compared Bis-SNP results to heterozygous SNPs called using two alternate 'k-allele' techniques that used read count cutoffs without incorporating base quality scores. We implemented a generalized form of the method used by [<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B30">30</xref>] to use a variable read count cutoff. This cutoff, <italic>k</italic>, was defined as the minimum percentage of reads with a secondary allele necessary to call a heterozygous SNP. As in [<xref ref-type="bibr" rid="B30">30</xref>], we counted C and T as a single allele at reference cytosines (on the C-strand only). In addition to k-allele, we also tried the Shoemaker method [<xref ref-type="bibr" rid="B20">20</xref>], which does not evaluate C/T SNPs at all and requires observations of the less frequent allele on at least 20% of reads on each strand. Finally, we tried the <monospace>bisReadMapper</monospace> algorithm [<xref ref-type="bibr" rid="B3">3</xref>], which calls SNPs independently on each strand using a non-bisulfite SNP caller, SAMTOOLS [<xref ref-type="bibr" rid="B11">11</xref>], and reports only those SNPs that agree between strands. Figures <xref ref-type="fig" rid="F3">3d-f</xref> show that each variation of Bis-SNP performs better than other methods.</p>
      <p>An important practical question is the minimum read depth required for accurate SNP identification. We addressed this problem by downsampling our 32× Bisulfite-seq genome to various coverage levels from 2× to 30× (Figure <xref ref-type="fig" rid="F4">4</xref>). For each coverage level, we determined the number of false positives and false negatives across a range of Bis-SNP stringency cutoffs using the 1 M SNP array data, as in Figure <xref ref-type="fig" rid="F3">3</xref>. At each coverage level, we then selected the least stringent cutoff that produced a False Discovery Rate (FDR) of less than 5%, and plotted the number of true positives (sensitivity). For both homozygous cytosines (Figure <xref ref-type="fig" rid="F4">4a</xref>) and heterozygous SNPs (Figure <xref ref-type="fig" rid="F4">4b</xref>), sensitivity increased dramatically up to about 10× coverage and then began to level off. Homozygous SNPs were almost fully detected (98% sensitivity) by 10× coverage, while heterozygous SNPs had a more gradual increase from 80% detected at 10× to 95% detected at 30×.</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>Sensitivity as a function of sequence coverage</bold>. Comparisons between Bis-SNP SNP calls and 1 M SNP array from Figure 3 ROC curves were extended to a range of coverage levels from 2×-30×. At each coverage level, we selected the least stringent threshold that yielded a False Discovery Rate (FDR) less than 0.05, and plotted the Sensitivity (1 - False Negative rate). As in Figure 3, separate plots show sensitivity at detecting homozygous cytosines (<bold>a</bold>) and heterozygous SNPs (<bold>b</bold>). For heterozygous SNPs, we include the overall detection rate (red line), as well as separate lines for C/T heterozygous SNPs (blue line) and non-C/T heterozygous SNPs (green line).</p>
        </caption>
        <graphic xlink:href="gb-2012-13-7-r61-4"/>
      </fig>
    </sec>
    <sec>
      <title>Accuracy of genome-wide methylation calling</title>
      <p>To verify the ability of Bis-SNP to correctly identify cytosines and improve methylation quantification genome-wide, we ran Bis-SNP across an entire chromosome for the OTB colon mucosa sample and four additional whole-genome bisulfite-seq samples (Table <xref ref-type="table" rid="T1">1</xref>). TCGA normal lung and normal breast were generated by the USC Epigenome Center and aligned using BSMAP, while the two mouse methylomes were generated by UCSD and aligned using Novoalign [<xref ref-type="bibr" rid="B22">22</xref>]. Runtimes for chromosome 1 were about 3 hours using a standard 12-core Intel server with 10 GB RAM (Intel, Santa Clara, CA, shown). The entire human genome takes about 30-40 hours on a single server (data not shown).</p>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p>Chromosome 1 Bis-SNP detection</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="center">Sample</th>
              <th align="center">Aligner</th>
              <th align="center">reference</th>
              <th align="center">cvg</th>
              <th align="center">Het SNPs</th>
              <th align="center">Hom SNPs</th>
              <th align="center">Callable bases</th>
              <th align="center">runtime</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center">OTB</td>
              <td align="center">MAQ</td>
              <td align="center">hg18</td>
              <td align="center">32×</td>
              <td align="center">119,103</td>
              <td align="center">67,725</td>
              <td align="center">211,042,010</td>
              <td align="center">2.8 h</td>
            </tr>
            <tr>
              <td colspan="8">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">TCGA-lung-normal</td>
              <td align="center">BSMAP</td>
              <td align="center">hg19</td>
              <td align="center">19×</td>
              <td align="center">118,412</td>
              <td align="center">58,309</td>
              <td align="center">222,763,786</td>
              <td align="center">3.1 h</td>
            </tr>
            <tr>
              <td colspan="8">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">TCGA-breast-normal</td>
              <td align="center">BSMAP</td>
              <td align="center">hg19</td>
              <td align="center">19×</td>
              <td align="center">113,009</td>
              <td align="center">57,281</td>
              <td align="center">221,014,965</td>
              <td align="center">2.7 h</td>
            </tr>
            <tr>
              <td colspan="8">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">Mouse-F1i</td>
              <td align="center">Novoalign</td>
              <td align="center">mm9</td>
              <td align="center">50×</td>
              <td align="center">663,528</td>
              <td align="center">65,364</td>
              <td align="center">178,718,615</td>
              <td align="center">3.1 h</td>
            </tr>
            <tr>
              <td colspan="8">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">Mouse-F1r</td>
              <td align="center">Novoalign</td>
              <td align="center">mm9</td>
              <td align="center">41×</td>
              <td align="center">682,979</td>
              <td align="center">67,068</td>
              <td align="center">178,847,508</td>
              <td align="center">3.1 h</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Notes: All benchmarking performed using a single Intel(R) Xeon (X5650,2.67 GHz) server with 12 CPU cores and 10 GB memory. SE refers to single-end sequencing and PE to paired-end.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>We used Bis-SNP to identify four classes of cytosines in the sample genome (Figure <xref ref-type="fig" rid="F5">5</xref> and Table <xref ref-type="table" rid="T2">2</xref> 'Sample Genotypes'), and separated these by their corresponding sequences in the reference genome (Figure <xref ref-type="fig" rid="F5">5</xref> and Table <xref ref-type="table" rid="T2">2</xref> 'Reference Genotypes'). As shown in Table <xref ref-type="table" rid="T2">2</xref> about 0.5-0.6% of reference CpGs were lost in the sample genome, and 0.5-0.6% of CpGs in the sample genome were lost in the reference. The two mouse samples had significantly higher SNP rates, presumably due to true strain differences between the crossed strains and the C57BL/6J strain sequenced for the mouse reference genome. In both F1 mice, about 2.5% of reference CpGs were lost in the sample genome, and about 1.1% of CpGs in the sample genome were lost in the reference.</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold>Accurate methylation calling at SNPs</bold>. Bis-SNP was run on five different datasets, single-end sequencing from Colon Mucosa Tissue [<xref ref-type="bibr" rid="B6">6</xref>] (<bold>a</bold>), two TCGA samples using paired-end sequencing from breast and lung tissues (normal, non-cancer), and two mouse samples using paired-end sequencing from [<xref ref-type="bibr" rid="B22">22</xref>] (see Table 1). In each case, Bis-SNP was used to identify cytosines in one of four sequence context in the sample genome. For each sample genotype, cytosines were further divided by their sequence context in the reference genome ('ref CpG', 'ref CpH', or 'refNotC'). All cytosines within a particular category in a particular sample were averaged to yield a mean methylation level. The number of cytosines in each category can be found in Table 2.</p>
        </caption>
        <graphic xlink:href="gb-2012-13-7-r61-5"/>
      </fig>
      <table-wrap id="T2" position="float">
        <label>Table 2:</label>
        <caption>
          <p>Chromosome 1 cytosine counts and methylation</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="center">Sample</th>
              <th align="center">Sample genotype</th>
              <th align="center" colspan="6">Reference Genotypes</th>
              <th align="center" colspan="3">% methylation</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td/>
              <td/>
              <td align="center" colspan="2">
                <bold>Reference CpG</bold>
              </td>
              <td align="center" colspan="2">
                <bold>Reference CpH</bold>
              </td>
              <td align="center" colspan="2">
                <bold>Reference DpN (D = A,T,G)</bold>
              </td>
              <td align="center">
                <bold>Ref CpG</bold>
              </td>
              <td align="center">
                <bold>Ref CpH</bold>
              </td>
              <td align="center">
                <bold>Ref DpN</bold>
              </td>
            </tr>
            <tr>
              <td colspan="11">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">OTB normal colon</td>
              <td align="center">CpG</td>
              <td align="center">3,758,803</td>
              <td align="center">99.39%</td>
              <td align="center">12,540</td>
              <td align="center">0.02%</td>
              <td align="center">11,838</td>
              <td align="center">0.01%</td>
              <td align="center">73%</td>
              <td align="center">80%</td>
              <td align="center">82%</td>
            </tr>
            <tr>
              <td/>
              <td colspan="10">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">CpH</td>
              <td align="center">7,773</td>
              <td align="center">0.21%</td>
              <td align="center">78,427,918</td>
              <td align="center">99.95%</td>
              <td align="center">18,804</td>
              <td align="center">0.01%</td>
              <td align="center">1%</td>
              <td align="center">1%</td>
              <td align="center">1%</td>
            </tr>
            <tr>
              <td/>
              <td colspan="10">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">DpN</td>
              <td align="center">5,658</td>
              <td align="center">0.15%</td>
              <td align="center">14,166</td>
              <td align="center">0.02%</td>
              <td align="center">128,570,817</td>
              <td align="center">99.97%</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
            </tr>
            <tr>
              <td/>
              <td colspan="10">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">CpG/CpH het</td>
              <td align="center">7,218</td>
              <td align="center">0.19%</td>
              <td align="center">8,998</td>
              <td align="center">0.01%</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
              <td align="center">39%</td>
              <td align="center">39%</td>
              <td align="center">NA</td>
            </tr>
            <tr>
              <td/>
              <td colspan="10">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">CpG/RpG het</td>
              <td align="center">2,512</td>
              <td align="center">0.07%</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
              <td align="center">1,826</td>
              <td align="center">0.00%</td>
              <td align="center">74%</td>
              <td align="center">NA</td>
              <td align="center">77%</td>
            </tr>
            <tr>
              <td colspan="11">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">TCGA Normal lung</td>
              <td align="center">CpG</td>
              <td align="center">4,153,196</td>
              <td align="center">99.52%</td>
              <td align="center">10,995</td>
              <td align="center">0.01%</td>
              <td align="center">10,511</td>
              <td align="center">0.01%</td>
              <td align="center">76%</td>
              <td align="center">84%</td>
              <td align="center">85%</td>
            </tr>
            <tr>
              <td/>
              <td colspan="10">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">CpH</td>
              <td align="center">5,460</td>
              <td align="center">0.13%</td>
              <td align="center">85,031,960</td>
              <td align="center">99.96%</td>
              <td align="center">16,420</td>
              <td align="center">0.01%</td>
              <td align="center">1%</td>
              <td align="center">1%</td>
              <td align="center">1%</td>
            </tr>
            <tr>
              <td/>
              <td colspan="10">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">DpN</td>
              <td align="center">5,310</td>
              <td align="center">0.13%</td>
              <td align="center">13,725</td>
              <td align="center">0.02%</td>
              <td align="center">133,490,905</td>
              <td align="center">99.98%</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
            </tr>
            <tr>
              <td/>
              <td colspan="10">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">CpG/CpH het</td>
              <td align="center">6,682</td>
              <td align="center">0.16%</td>
              <td align="center">8,529</td>
              <td align="center">0.01%</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
              <td align="center">37%</td>
              <td align="center">39%</td>
              <td align="center">NA</td>
            </tr>
            <tr>
              <td/>
              <td colspan="10">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">CpG/RpG het</td>
              <td align="center">2,476</td>
              <td align="center">0.06%</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
              <td align="center">1,993</td>
              <td align="center">0.00%</td>
              <td align="center">80%</td>
              <td align="center">NA</td>
              <td align="center">78%</td>
            </tr>
            <tr>
              <td colspan="11">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">TCGA normal breast</td>
              <td align="center">CpG</td>
              <td align="center">4,100,643</td>
              <td align="center">99.54%</td>
              <td align="center">10,893</td>
              <td align="center">0.01%</td>
              <td align="center">10,657</td>
              <td align="center">0.01%</td>
              <td align="center">75%</td>
              <td align="center">85%</td>
              <td align="center">86%</td>
            </tr>
            <tr>
              <td/>
              <td colspan="10">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">CpH</td>
              <td align="center">5,286</td>
              <td align="center">0.13%</td>
              <td align="center">80,654,084</td>
              <td align="center">99.96%</td>
              <td align="center">13,390</td>
              <td align="center">0.01%</td>
              <td align="center">1%</td>
              <td align="center">1%</td>
              <td align="center">1%</td>
            </tr>
            <tr>
              <td/>
              <td colspan="10">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">DpN</td>
              <td align="center">4,954</td>
              <td align="center">0.12%</td>
              <td align="center">13,310</td>
              <td align="center">0.02%</td>
              <td align="center">136,180,779</td>
              <td align="center">99.98%</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
            </tr>
            <tr>
              <td/>
              <td colspan="10">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">CpG/CpH het</td>
              <td align="center">6,289</td>
              <td align="center">0.15%</td>
              <td align="center">8,120</td>
              <td align="center">0.01%</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
              <td align="center">39%</td>
              <td align="center">40%</td>
              <td align="center">NA</td>
            </tr>
            <tr>
              <td/>
              <td colspan="10">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">CpG/RpG het</td>
              <td align="center">2,413</td>
              <td align="center">0.06%</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
              <td align="center">1,854</td>
              <td align="center">0.00%</td>
              <td align="center">78%</td>
              <td align="center">NA</td>
              <td align="center">79%</td>
            </tr>
            <tr>
              <td colspan="11">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">Xie 2012 Mouse F1i (chr1)</td>
              <td align="center">CpG</td>
              <td align="center">2,125,320</td>
              <td align="center">97.51%</td>
              <td align="center">10,990</td>
              <td align="center">0.02%</td>
              <td align="center">11,757</td>
              <td align="center">0.01%</td>
              <td align="center">76%</td>
              <td align="center">83%</td>
              <td align="center">84%</td>
            </tr>
            <tr>
              <td/>
              <td colspan="10">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">CpH</td>
              <td align="center">4,314</td>
              <td align="center">0.20%</td>
              <td align="center">57,706,841</td>
              <td align="center">99.87%</td>
              <td align="center">20,312</td>
              <td align="center">0.02%</td>
              <td align="center">3%</td>
              <td align="center">3%</td>
              <td align="center">3%</td>
            </tr>
            <tr>
              <td/>
              <td colspan="10">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">DpN</td>
              <td align="center">5,300</td>
              <td align="center">0.24%</td>
              <td align="center">20,905</td>
              <td align="center">0.04%</td>
              <td align="center">118,570,097</td>
              <td align="center">99.96%</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
            </tr>
            <tr>
              <td/>
              <td colspan="10">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">CpG/CpH het</td>
              <td align="center">28,896</td>
              <td align="center">1.33%</td>
              <td align="center">36,735</td>
              <td align="center">0.06%</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
              <td align="center">43%</td>
              <td align="center">42%</td>
              <td align="center">NA</td>
            </tr>
            <tr>
              <td/>
              <td colspan="10">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">CpG/RpG het</td>
              <td align="center">15,754</td>
              <td align="center">0.72%</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
              <td align="center">12,917</td>
              <td align="center">0.01%</td>
              <td align="center">78%</td>
              <td align="center">NA</td>
              <td align="center">82%</td>
            </tr>
            <tr>
              <td colspan="11">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">Xie 2012 Mouse F1r (chr1)</td>
              <td align="center">CpG</td>
              <td align="center">2,199,907</td>
              <td align="center">97.52%</td>
              <td align="center">11,268</td>
              <td align="center">0.02%</td>
              <td align="center">11,974</td>
              <td align="center">0.01%</td>
              <td align="center">75%</td>
              <td align="center">83%</td>
              <td align="center">84%</td>
            </tr>
            <tr>
              <td/>
              <td colspan="10">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">CpH</td>
              <td align="center">4,476</td>
              <td align="center">0.20%</td>
              <td align="center">58,685,115</td>
              <td align="center">99.87%</td>
              <td align="center">20,933</td>
              <td align="center">0.02%</td>
              <td align="center">3%</td>
              <td align="center">3%</td>
              <td align="center">4%</td>
            </tr>
            <tr>
              <td/>
              <td colspan="10">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">DpN</td>
              <td align="center">5,171</td>
              <td align="center">0.23%</td>
              <td align="center">20,765</td>
              <td align="center">0.04%</td>
              <td align="center">117,647,445</td>
              <td align="center">99.96%</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
            </tr>
            <tr>
              <td/>
              <td colspan="10">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">CpG/CpH het</td>
              <td align="center">29,983</td>
              <td align="center">1.33%</td>
              <td align="center">38,159</td>
              <td align="center">0.06%</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
              <td align="center">43%</td>
              <td align="center">42%</td>
              <td align="center">NA</td>
            </tr>
            <tr>
              <td/>
              <td colspan="10">
                <hr/>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">CpG/RpG het</td>
              <td align="center">16,371</td>
              <td align="center">0.73%</td>
              <td align="center">NA</td>
              <td align="center">NA</td>
              <td align="center">13,147</td>
              <td align="center">0.01%</td>
              <td align="center">78%</td>
              <td align="center">NA</td>
              <td align="center">82%</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Notes: 'het' signifies heterozygous. Two non-reference bases in a row automatically filtered out. CpH = C(A/C/T). DpN = (A/T/G)(A/C/T/G). RpG = (A/G)G. CpG/TpG heterozygous genotypes are filtered out because they can not be used for methylation calling.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>We next compared average methylation levels across each sample genotype (Figure <xref ref-type="fig" rid="F5">5</xref>). As expected, homozygous CpHs were consistently low, while homozygous CpGs were consistently high, regardless of the corresponding reference sequence. Both mouse frontal cortex brain samples showed elevated levels of CpH methylation as described in the original publication [<xref ref-type="bibr" rid="B22">22</xref>]. Interestingly, homozygous CpGs that represented SNPs (where the sample differed from the reference genome) had consistently higher methylation. This fits with what is known about mammalian genome evolution - evolutionary C&gt;T changes occur much more frequently at methylated than unmethylated CpGs because the C&gt;T deamination and deamination repair process is methylation-specific. We next looked at heterozygous CpGs (Figure <xref ref-type="fig" rid="F5">5</xref>, right). CpG/CpH positions had methylation about halfway between CpG homozygous and CpH homozygous positions. At CpG/ApG or CpG/GpG heterozygous positions, methylation can only be measured for the C allele, and the methylation state is about the same as homozygous CpGs. CpG/TpG heterozygous positions are not shown, because we can not accurately measure methylation at these positions. Together, these data show that Bis-SNP genotype calling produces accurate methylation quantification even when the sample genome differs from the reference genome.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>We have described a publicly-available software tool, <monospace>Bis-SNP</monospace>, which extracts methylation information and SNP information simultaneously from data generated using the Illumina Bisulfite-seq protocol. Command-line executables (Additional File <xref ref-type="supplementary-material" rid="S3">3</xref>) and open-source code (Additional File <xref ref-type="supplementary-material" rid="S4">4</xref>) are both freely available for download [<xref ref-type="bibr" rid="B37">37</xref>]. The directional nature of the Illumina protocol allows for analysis of DNA methylation and the identification of a SNP at the same position, by combining information from each strand separately. This is the dominant Bisulfite-sequencing protocol in use today by individual labs and genomics consortia such as ENCODE, the NIH Epigenomics Roadmap, and The Cancer Genome Atlas. By correctly identifying and filtering SNPs correctly, we can obtain more accurate methylation levels and heterozygous SNPs, including C/T SNPs, can be used to identify allele-specific methylation patterns. Bis-SNP is implemented using the efficient GATK framework, which allows for runtimes that are reasonable for modern whole-genome analysis. An entire 32× whole-genome dataset took about 30 hours to run on a typical 12-processor compute node with 10 GB of memory, or 3 hours when each chromosome was run in parallel on a separate compute node. This performance profile makes Bis-SNP accessible to most users.</p>
    <p>We included the capability to perform base quality re-calibration on bisulfite-seq data, which improves the overall SNP calling accuracy of Bis-SNP. Not only do more accurate base quality scores allow us better identification of SNPs as shown here, but could be used in the future to calculate more precise DNA methylation estimates. Biological DNA samples do not typically have a large number of cytosines that are always 100% methylated, so there is not a reliable way to identify true C&gt;T mismatches and recalibrate quality scores at these positions. Recalibration could be improved in the future by spiking a library of DNA that has not been treated with bisulfite into the same sequencing lane.</p>
    <p>The potential applications of Bisulfite-seq in basic biology and medicine are broad, and Bis-SNP can be used for the majority of Bisulfite-seq experimental designs including Whole-Genome Bisulfite-Seq (WGBS), Reduced Representation Bisulfite-Seq (RRBS), and customizable genome selection methods. While we have focused on human studies, Bis-SNP can output methylation levels split up according to user-defined cytosine contexts, which makes it applicable to analysis of <italic>Arabidopsis </italic>or any other organism. It also allows Bis-SNP to accommodate novel study designs, such as <italic>in vitro </italic>methylation by methyltransferases with arbitrary sequence specificities, or even the study 5-hydromethyl-cytosine (5-hmC) using a novel bisulfite-sequencing approach [<xref ref-type="bibr" rid="B38">38</xref>].</p>
    <p>An intriguing potential use of Bisulfite-seq and Bis-SNP is the study of genome-wide associations between SNPs and DNA methylation patterns (i.e. <italic>methQTLs</italic>, reviewed in [<xref ref-type="bibr" rid="B39">39</xref>]). While the experimental designs thus far have envisioned paired SNP and methylation assays, our encouraging results with Bis-SNP suggest that both could be captured in a single Bisulfite-sequencing experiment. Sequencing depths of 50× or greater for Whole-genome Bisulfite-seq are not unattainable from a cost perspective, and would likely provide sufficient SNP and methylation coverage for methQTL studies. Another potential application could be a Genome-Wide Association Study (GWAS) that uses Bisulfite-seq rather than traditional sequencing, to identify disease associations at the genetic and epigenetic levels simultaneously. This could be especially useful given the large number of GWAS hits that appear to affect regulatory regions rather than gene coding regions. Bis-SNP and other Bisulfite-seq analysis tools will be important in the development of these exciting new technologies.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials and methods</title>
    <sec>
      <title>Local realignment, base quality recalibration and other BAM file preprocessing</title>
      <p>Reads with mapping quality scores less than 30 and those mapped to multiple genomic regions were removed, as are PCR duplicates (optional). For paired-end reads, we remove read pairs that do not have the <monospace>ProperlyPaired</monospace> field set.</p>
      <p>We use GATK to perform local multiple sequence realignment and sequence recalibration mostly as described [<xref ref-type="bibr" rid="B12">12</xref>]. Since most of bisulfite sequencing mapping tools (e.g. Bismark, BSMAP, MAQ etc) do not provide correct CIGAR string in the BAM file for GATK's indel realignment, the CIGAR string is recalculated when necessary. We extend GATK's <monospace>RealignerTargetCreator</monospace> to count mismatch number but not count thymine as a mismatch when the reference genome position is cytosine. After we create a potential indel interval, we realign using a modified version of GATK's <monospace>IndelRealigner</monospace>. PCR duplicate reads are marked after indel realignment.</p>
      <p>For base quality recalibration, we modify the GATK algorithm to account for bisulfite conversion by extending the GATK <monospace>CountVariantWalker</monospace> and <monospace>TableRecalibrationWalker</monospace> classes. The algorithm first tabulates empirical mismatches to the reference at all loci not known to vary in the population (i.e., not in dbSNP build 135). These counts are categorized by their reported instrument-reported quality score (<italic>R</italic>) and position (cycle) within the read (<italic>C</italic>). In tabulating mismatches, we do not count thymine as a mismatch when the reference genome position is cytosine (on the second end of a paired-end read, we instead don't count adenine as a mismatch when the reference is guanine).</p>
      <p>By default, only positions with a recalibrated Base Calling Quality Score of greater than 5 are used for SNP calling. This quality cutoff can be set using a command line parameter (see User Manual in Additional File <xref ref-type="supplementary-material" rid="S3">3</xref>).</p>
    </sec>
    <sec>
      <title>BisSNP probabilistic model</title>
      <p>We begin with the bayesian likelihood model of GATK ([<xref ref-type="bibr" rid="B12">12</xref>]), and make a number of bisulfite-specific adaptations. Assuming the underlying genome is diploid, we let <bold>D </bold>= (<italic>D</italic><sub>1</sub>, <italic>D</italic><sub>2</sub>, ..., <italic>D<sub>r</sub></italic>) represent the base calls at a particular genomic position <italic>i </italic>that is covered by <italic>r </italic>sequencing reads. We then calculate the posterior probability by (1) as in GATK:</p>
      <p>
        <disp-formula id="bmcM1">
          <label>(1)</label>
          <mml:math id="M2" name="gb-2012-13-7-r61-i2" overflow="scroll">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mi>r</mml:mi>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mi>G</mml:mi>
                  <mml:mo class="MathClass-rel">|</mml:mo>
                  <mml:mi mathvariant="bold">D</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>π</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>G</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mi>r</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi mathvariant="bold">D</mml:mi>
                      <mml:mo class="MathClass-rel">|</mml:mo>
                      <mml:mi>G</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mi>r</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi mathvariant="bold">D</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Here, <italic>G </italic>is the underlying diploid genotype, <italic>AB</italic>, with <italic>A </italic>and <italic>B </italic>being the two parental alleles. <italic>π</italic>(<italic>G</italic>) is a genotype prior probability for observing the given genotype based on the genotype of the reference genome and population frequencies, the same as discussed in Table <xref ref-type="table" rid="T1">1</xref> of SOAPsnp paper [<xref ref-type="bibr" rid="B13">13</xref>]. <italic>Pr</italic>(<italic>D</italic>) is defined as the sum over all possible genotypes ∑<italic><sub>AB </sub>π</italic>(<italic>AB</italic>) <italic>Pr </italic>(<bold>D</bold>|<italic>AB</italic>), but is the same in each case and can generally be ignored since we are concerned with likelihood ratios. We assume that each of the two alleles are equally likely to be sequenced, and calculate the overall likelihood of <bold>D </bold>as the product of all individual reads (2),(3):</p>
      <p>
        <disp-formula id="bmcM2">
          <label>(2)</label>
          <mml:math id="M3" name="gb-2012-13-7-r61-i3" overflow="scroll">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mi>r</mml:mi>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mi mathvariant="bold">D</mml:mi>
                  <mml:mo class="MathClass-rel">|</mml:mo>
                  <mml:mi>G</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:munderover accentunder="false" accent="false">
                <mml:mrow>
                  <mml:mo mathsize="big"> ∏</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                  <mml:mo class="MathClass-rel">=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>r</mml:mi>
                </mml:mrow>
              </mml:munderover>
              <mml:mi>P</mml:mi>
              <mml:mi>r</mml:mi>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo class="MathClass-rel">|</mml:mo>
                  <mml:mi>G</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM3">
          <label>(3)</label>
          <mml:math id="M4" name="gb-2012-13-7-r61-i4" overflow="scroll">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mi>r</mml:mi>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo class="MathClass-rel">|</mml:mo>
                  <mml:mi>G</mml:mi>
                  <mml:mo class="MathClass-rel">=</mml:mo>
                  <mml:mi>A</mml:mi>
                  <mml:mi>B</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:mfrac>
              <mml:mi>P</mml:mi>
              <mml:mi>r</mml:mi>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo class="MathClass-rel">|</mml:mo>
                  <mml:mi>A</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-bin">+</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:mfrac>
              <mml:mi>P</mml:mi>
              <mml:mi>r</mml:mi>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo class="MathClass-rel">|</mml:mo>
                  <mml:mi>B</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>The following steps are shown for single-end sequences. For paired end sequences, the first end is treated as described, but the second end is reverse complemented before performing these calculations (because the Illumina second end is the complementary strand of the same template as the first end). This changes G&gt;A bisulfite substitutions, which occur on the second end, to the actual C&gt;T substitutions present on the bisulfite-converted template. The recalibrated base quality scores are on a phred scale which represents the probability <italic>ε </italic>that the position is an error, which is used in the following calculation.</p>
      <p>When the underlying allele is adenine (<monospace>a</monospace>), thymine (<monospace>t</monospace>), bisulfite conversion does not apply and the probability estimation is straightforward as shown for <monospace>t</monospace>:</p>
      <p>
        <disp-formula id="bmcM4">
          <label>(4)</label>
          <mml:math id="M5" name="gb-2012-13-7-r61-i5" overflow="scroll">
            <mml:mrow>
              <mml:mtext>Pr</mml:mtext>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo class="MathClass-rel">|</mml:mo>
                  <mml:mi>B</mml:mi>
                  <mml:mo class="MathClass-rel">=</mml:mo>
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">t</mml:mtext>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mfenced open="{">
                <mml:mrow>
                  <mml:mtable equalrows="false" columnlines="none none none none none none none none none none none none none none none none none none none" equalcolumns="false" class="array">
                    <mml:mtr>
                      <mml:mtd class="array" columnalign="left">
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>ε</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:mfrac>
                      </mml:mtd>
                      <mml:mtd class="array" columnalign="left">
                        <mml:mspace width="1em" class="quad"/>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">if</mml:mtext>
                        </mml:mstyle>
                        <mml:mspace width="0.3em" class="thinspace"/>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>D</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo class="MathClass-rel">≠</mml:mo>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">t</mml:mtext>
                        </mml:mstyle>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd class="array" columnalign="left">
                        <mml:mn>1</mml:mn>
                        <mml:mo class="MathClass-bin">-</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>ε</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                      <mml:mtd class="array" columnalign="left">
                        <mml:mspace width="1em" class="quad"/>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">if</mml:mtext>
                        </mml:mstyle>
                        <mml:mspace width="0.3em" class="thinspace"/>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>D</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo class="MathClass-rel">=</mml:mo>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">t</mml:mtext>
                        </mml:mstyle>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd class="array" columnalign="left"/>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:mfenced>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Here, <italic>ε<sub>j </sub></italic>is the probability of a sequencing or base calling error at position <italic>j</italic>, i.e. probability that the true allele <italic>B </italic>is a t, but base call <italic>D<sub>j </sub></italic>is observed as an <monospace>a</monospace>, <monospace>c</monospace>, or <monospace>g</monospace>. The likelihood function for <monospace>a</monospace> is equivalent to that of Equation (4). When the underlying allele is a <monospace>c</monospace> or a <monospace>g</monospace>, however, the probabilities are strand-specific since bisulfite conversion only affects one strand in the directional Bisulfite-seq protocol (Figure <xref ref-type="fig" rid="F1">1</xref>). The probability of seeing a <monospace>t</monospace> in the read depends on the probability that the position is methylated (<italic>β</italic>), as well as the bisulfite conversion efficiency (<italic>α </italic>and <italic>γ</italic>). Bisulfite treatment converts all unmethylated cytosines to thymine, but in practice it is not 100% efficient [<xref ref-type="bibr" rid="B4">4</xref>]. The parameter <italic>α </italic>is the estimated frequency of unmethylated cytosines which are not converted (typically taken from unmethylated spiked in DNA [<xref ref-type="bibr" rid="B4">4</xref>] or the mammalian mitochondrial sequences, which we have found to be almost completely unmethylated [<xref ref-type="bibr" rid="B6">6</xref>]. In this case, <italic>α </italic>= <italic>β<sub>chr</sub>M</italic>). By default, <italic>α </italic>is set to 0.0025 but can be specified by the user. We also include a <italic>γ </italic>parameter for <italic>over-conversion</italic>, i.e. the rate at which methylated cytosines are converted. Although this is not routinely measured in practice, it could be estimated by including an enzymatically methylated control DNA [<xref ref-type="bibr" rid="B40">40</xref>], or a sequencing library without bisulfite conversion. By default, <italic>γ </italic>is set to 0 but can be specified by the user. The full likelihood calculation for cytosines is as follows:</p>
      <p>
        <disp-formula id="bmcM5">
          <label>(5)</label>
          <mml:math id="M6" name="gb-2012-13-7-r61-i6" overflow="scroll">
            <mml:mrow>
              <mml:mtable class="gathered">
                <mml:mtr>
                  <mml:mtd>
                    <mml:mi>P</mml:mi>
                    <mml:mi>r</mml:mi>
                    <mml:mrow>
                      <mml:mo class="MathClass-open">(</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>D</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo class="MathClass-rel">|</mml:mo>
                        <mml:mi>B</mml:mi>
                        <mml:mo class="MathClass-rel">=</mml:mo>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">c</mml:mtext>
                        </mml:mstyle>
                      </mml:mrow>
                      <mml:mo class="MathClass-close">)</mml:mo>
                    </mml:mrow>
                    <mml:mo class="MathClass-rel">=</mml:mo>
                    <mml:mfenced open="{">
                      <mml:mrow>
                        <mml:mtable equalrows="false" columnlines="none none none none none none none none none none none none none none none none none none none" equalcolumns="false" class="array">
                          <mml:mtr>
                            <mml:mtd class="array" columnalign="center">
                              <mml:mrow>
                                <mml:mo class="MathClass-open">(</mml:mo>
                                <mml:mrow>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo class="MathClass-bin">-</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>ε</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mo class="MathClass-close">)</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo class="MathClass-open">[</mml:mo>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>β</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mrow>
                                    <mml:mo class="MathClass-open">(</mml:mo>
                                    <mml:mrow>
                                      <mml:mn>1</mml:mn>
                                      <mml:mo class="MathClass-bin">-</mml:mo>
                                      <mml:mi>γ</mml:mi>
                                    </mml:mrow>
                                    <mml:mo class="MathClass-close">)</mml:mo>
                                  </mml:mrow>
                                  <mml:mo class="MathClass-bin">+</mml:mo>
                                  <mml:mrow>
                                    <mml:mo class="MathClass-open">(</mml:mo>
                                    <mml:mrow>
                                      <mml:mn>1</mml:mn>
                                      <mml:mo class="MathClass-bin">-</mml:mo>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mi>β</mml:mi>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mi>j</mml:mi>
                                        </mml:mrow>
                                      </mml:msub>
                                    </mml:mrow>
                                    <mml:mo class="MathClass-close">)</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>α</mml:mi>
                                </mml:mrow>
                                <mml:mo class="MathClass-close">]</mml:mo>
                              </mml:mrow>
                            </mml:mtd>
                            <mml:mtd class="array" columnalign="center">
                              <mml:mspace width="1em" class="quad"/>
                              <mml:mstyle class="text">
                                <mml:mtext class="textsf" mathvariant="sans-serif">if</mml:mtext>
                              </mml:mstyle>
                              <mml:mspace width="0.3em" class="thinspace"/>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>D</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>j</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo class="MathClass-rel">=</mml:mo>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mstyle class="text">
                                    <mml:mtext class="textsf" mathvariant="sans-serif">c</mml:mtext>
                                  </mml:mstyle>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo class="MathClass-bin">+</mml:mo>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd class="array" columnalign="center">
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>ε</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>3</mml:mn>
                                </mml:mrow>
                              </mml:mfrac>
                              <mml:mo class="MathClass-bin">+</mml:mo>
                              <mml:mrow>
                                <mml:mo class="MathClass-open">(</mml:mo>
                                <mml:mrow>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo class="MathClass-bin">-</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>ε</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mo class="MathClass-close">)</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo class="MathClass-open">[</mml:mo>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>β</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mi>γ</mml:mi>
                                  <mml:mo class="MathClass-bin">+</mml:mo>
                                  <mml:mrow>
                                    <mml:mo class="MathClass-open">(</mml:mo>
                                    <mml:mrow>
                                      <mml:mn>1</mml:mn>
                                      <mml:mo class="MathClass-bin">-</mml:mo>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mi>β</mml:mi>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mi>j</mml:mi>
                                        </mml:mrow>
                                      </mml:msub>
                                    </mml:mrow>
                                    <mml:mo class="MathClass-close">)</mml:mo>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mo class="MathClass-open">(</mml:mo>
                                    <mml:mrow>
                                      <mml:mn>1</mml:mn>
                                      <mml:mo class="MathClass-bin">-</mml:mo>
                                      <mml:mi>α</mml:mi>
                                    </mml:mrow>
                                    <mml:mo class="MathClass-close">)</mml:mo>
                                  </mml:mrow>
                                </mml:mrow>
                                <mml:mo class="MathClass-close">]</mml:mo>
                              </mml:mrow>
                            </mml:mtd>
                            <mml:mtd class="array" columnalign="center">
                              <mml:mspace width="1em" class="quad"/>
                              <mml:mstyle class="text">
                                <mml:mtext class="textsf" mathvariant="sans-serif">if</mml:mtext>
                              </mml:mstyle>
                              <mml:mspace width="0.3em" class="thinspace"/>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>D</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>j</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo class="MathClass-rel">=</mml:mo>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mstyle class="text">
                                    <mml:mtext class="textsf" mathvariant="sans-serif">t</mml:mtext>
                                  </mml:mstyle>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo class="MathClass-bin">+</mml:mo>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd class="array" columnalign="center">
                              <mml:mn>1</mml:mn>
                              <mml:mo class="MathClass-bin">-</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>ε</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>j</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd class="array" columnalign="center">
                              <mml:mspace width="1em" class="quad"/>
                              <mml:mstyle class="text">
                                <mml:mtext class="textsf" mathvariant="sans-serif">if</mml:mtext>
                              </mml:mstyle>
                              <mml:mspace width="0.3em" class="thinspace"/>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>D</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>j</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo class="MathClass-rel">=</mml:mo>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mstyle class="text">
                                    <mml:mtext class="textsf" mathvariant="sans-serif">c</mml:mtext>
                                  </mml:mstyle>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo class="MathClass-bin">-</mml:mo>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd class="array" columnalign="center">
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>ε</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>3</mml:mn>
                                </mml:mrow>
                              </mml:mfrac>
                            </mml:mtd>
                            <mml:mtd class="array" columnalign="center">
                              <mml:mspace width="1em" class="quad"/>
                              <mml:mstyle class="text">
                                <mml:mtext class="textsf" mathvariant="sans-serif">otherwise</mml:mtext>
                              </mml:mstyle>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd class="array" columnalign="center"/>
                          </mml:mtr>
                        </mml:mtable>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>β</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mfenced open="(" close=")">
                      <mml:mrow>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">1</mml:mtext>
                        </mml:mstyle>
                        <mml:mo class="MathClass-bin">-</mml:mo>
                        <mml:mi>γ</mml:mi>
                      </mml:mrow>
                    </mml:mfenced>
                    <mml:mo class="MathClass-rel">=</mml:mo>
                    <mml:mstyle class="text">
                      <mml:mtext class="textsf" mathvariant="sans-serif">methylated and </mml:mtext>
                    </mml:mstyle>
                    <mml:mfenced open="(" close=")">
                      <mml:mrow>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">properly</mml:mtext>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mfenced>
                    <mml:mstyle class="text">
                      <mml:mtext class="textsf" mathvariant="sans-serif"> not converted</mml:mtext>
                    </mml:mstyle>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>β</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mi>γ</mml:mi>
                    <mml:mo class="MathClass-rel">=</mml:mo>
                    <mml:mstyle class="text">
                      <mml:mtext class="textsf" mathvariant="sans-serif">methylated and </mml:mtext>
                    </mml:mstyle>
                    <mml:mfenced open="(" close=")">
                      <mml:mrow>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">improperly</mml:mtext>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mfenced>
                    <mml:mstyle class="text">
                      <mml:mtext class="textsf" mathvariant="sans-serif"> converted</mml:mtext>
                    </mml:mstyle>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mo class="MathClass-open">(</mml:mo>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mo class="MathClass-bin">-</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>β</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo class="MathClass-close">)</mml:mo>
                    </mml:mrow>
                    <mml:mi>α</mml:mi>
                    <mml:mo class="MathClass-rel">=</mml:mo>
                    <mml:mstyle class="text">
                      <mml:mtext class="textsf" mathvariant="sans-serif">unmethylated and </mml:mtext>
                    </mml:mstyle>
                    <mml:mfenced open="(" close=")">
                      <mml:mrow>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">improperly</mml:mtext>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mfenced>
                    <mml:mstyle class="text">
                      <mml:mtext class="textsf" mathvariant="sans-serif"> not converted</mml:mtext>
                    </mml:mstyle>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mo class="MathClass-open">(</mml:mo>
                      <mml:mrow>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">1</mml:mtext>
                        </mml:mstyle>
                        <mml:mo class="MathClass-bin">-</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>β</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo class="MathClass-close">)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo class="MathClass-open">(</mml:mo>
                      <mml:mrow>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">1</mml:mtext>
                        </mml:mstyle>
                        <mml:mo class="MathClass-bin">-</mml:mo>
                        <mml:mi>α</mml:mi>
                      </mml:mrow>
                      <mml:mo class="MathClass-close">)</mml:mo>
                    </mml:mrow>
                    <mml:mo class="MathClass-rel">=</mml:mo>
                    <mml:mstyle class="text">
                      <mml:mtext class="textsf" mathvariant="sans-serif">unmethylated and </mml:mtext>
                    </mml:mstyle>
                    <mml:mfenced open="(" close=")">
                      <mml:mrow>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">properly</mml:mtext>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mfenced>
                    <mml:mstyle class="text">
                      <mml:mtext class="textsf" mathvariant="sans-serif"> converted</mml:mtext>
                    </mml:mstyle>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd/>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>The key to these calculations is that reads on the same strand as the inferred cytosine allele (denoted with +) are treated differently than reads from the opposite strand (denoted with -). As expected based on the example in Figure <xref ref-type="fig" rid="F1">1</xref>, a true allele of <italic>B </italic>= <monospace>c</monospace> results in a very high probability of seeing a <monospace>t</monospace><sup>+ </sup>(a '<monospace>t</monospace>' read on the C-strand), but a very low probability of seeing a <monospace>t</monospace><sup>- </sup>(an '<monospace>a</monospace>' read on the G-strand). The genotype <italic>G<sub>best </sub></italic>with the highest posterior probability <italic>Pr</italic>(<italic>G</italic>|<bold>D</bold>) is chosen, and the final output score is the odds ratio between the best (<italic>G<sub>best</sub></italic>) and the second best (<italic>G<sub>nextbest</sub></italic>), as in Equation (6). In practice, we optimize execution by evaluating only the subset of the 10 possible diploid genotypes that are possible given the sequences read.</p>
      <p>
        <disp-formula id="bmcM6">
          <label>(6)</label>
          <mml:math id="M7" name="gb-2012-13-7-r61-i7" overflow="scroll">
            <mml:mrow>
              <mml:mi>s</mml:mi>
              <mml:mi>c</mml:mi>
              <mml:mi>o</mml:mi>
              <mml:mi>r</mml:mi>
              <mml:mi>e</mml:mi>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mi>l</mml:mi>
              <mml:mi>o</mml:mi>
              <mml:mi>g</mml:mi>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mrow>
                        <mml:mo class="MathClass-open">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>G</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>b</mml:mi>
                              <mml:mi>e</mml:mi>
                              <mml:mi>s</mml:mi>
                              <mml:mi>t</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo class="MathClass-rel">|</mml:mo>
                          <mml:mi mathvariant="bold">D</mml:mi>
                        </mml:mrow>
                        <mml:mo class="MathClass-close">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mi>r</mml:mi>
                      <mml:mrow>
                        <mml:mo class="MathClass-open">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>G</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                              <mml:mi>e</mml:mi>
                              <mml:mi>x</mml:mi>
                              <mml:mi>t</mml:mi>
                              <mml:mi>b</mml:mi>
                              <mml:mi>e</mml:mi>
                              <mml:mi>s</mml:mi>
                              <mml:mi>t</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo class="MathClass-rel">|</mml:mo>
                          <mml:mi mathvariant="bold">D</mml:mi>
                        </mml:mrow>
                        <mml:mo class="MathClass-close">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Bisulfite efficiency, i.e. <italic>α </italic>and <italic>γ </italic>typically vary by less than 1%, so the critical parameter included in Equation 5 is the methylation rate <italic>β</italic>. Since this rate varies by genomic context, organism, and even cell type, we allow the user to specify the possible contexts as a set of <italic>n </italic>nucleotides sequences specified by their IUPAC degeneracy codes (for instance, <italic>CH </italic>represents <italic>CC</italic>, <italic>CT</italic>, or <italic>CA</italic>). In mammalian genomes where typically only the single base 3' of the cytosine is considered relevant, the user would specify CG and CH (the <monospace>Bis-SNP</monospace> default). For <italic>Arabidopsis</italic>, one might specify CG, CHH, and CHG. Any arbitrary number of 5' and 3' bases may be specified in order to accommodate the full range of Bisulfite-seq assays. For instance a CCGG pattern could be specified for MspI restriction sites inherent to the RRBS protocol ( [<xref ref-type="bibr" rid="B41">41</xref>]).</p>
      <p>One methylation output file (BED6+2 format) is created for each cytosine context specified by the user. For each cytosine determined to have the particular sequence context, the percent methylated (the number of C reads on the C-strand divided by the number of C or T reads on the C-strand) is output as the score field. To aid in statistical analysis, a second field contains the total number of C/T reads.</p>
    </sec>
    <sec>
      <title>Five-prime bisulfite non-conversion filter</title>
      <p>Non-conversion of unmethylated Cs is known to preferentially affect the 5' end of Illumina-generated reads, most likely driven by the re-annealing of sequences adjacent to the fully methylated sequence adapters during bisulfite conversion. We control for this using a 5' non-conversion filter as implemented in our earlier work [<xref ref-type="bibr" rid="B6">6</xref>]. For each read, we walk along the read from 5' to 3', and we remove any Cs on the C-strand until we reach the first reference C which is converted to a T. By applying this filter, early bisulfite conversion in early cycles is brought to levels very similar to those of late cycles, thus removing a potential source of methylation bias (data not shown). Notice that this filter should be turned off for RRBS data, which gleans most of its methylation data from the first cycle (see user manual).</p>
    </sec>
    <sec>
      <title>Pre-SNP calling quality filters</title>
      <p>Using the approach of GATK, we apply additional quality filters before SNP calling to avoid known sources of false positives. SNPs found in clusters (two or more within a ten-base-pair window) were filtered out. SNPs with coverage depth above 120, Strand Bias(SB) score more than -0.02, or Quality by Depth(QD) less than 1.0 are filtered out. All of these parameters are configurable (see User Manual). If BAM contains Mapping Quality scores, suspicious regions are filtered out when greater than 10% of aligned reads (minimum of 40 reads) have mapping quality of 0.</p>
      <p>Bisulfite sequencing can have higher strand biases since high bisulfite concentration can lead to DNA degradation when the depurination step causes random strand breaks [<xref ref-type="bibr" rid="B42">42</xref>,<xref ref-type="bibr" rid="B43">43</xref>]. We calculated strand bias score as in GATK, but bisulfite converted reads have an apparent strand bias which is higher than the actual strand bias, since the G-strand contributes more than the C-strand at cytosines. For this reason, we used a substantially less stringent strand bias cutoff (-0.02) than the GATK default.</p>
    </sec>
    <sec>
      <title>Downsampling coverage</title>
      <p>We downsampled the human colon mucosa Bisulfite-seq dataset into different mean coverages using GATK, which randomly picks <italic>z </italic>reads at each individual nucleotide locus. The following formula is used, where <italic>N </italic>is the mean coverage of total dataset before downsampling (32× in this case), <italic>n </italic>is the desired downsampling coverage, and <italic>m </italic>is the actual coverage at the particular locus.</p>
      <p>
        <disp-formula id="bmcM7">
          <label>(7)</label>
          <mml:math id="M8" name="gb-2012-13-7-r61-i8" overflow="scroll">
            <mml:mrow>
              <mml:mi>z</mml:mi>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mo class="MathClass-bin">*</mml:mo>
                  <mml:mi>n</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>N</mml:mi>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
    </sec>
    <sec>
      <title>External tools used for comparison</title>
      <sec>
        <title>K-allele method</title>
        <p>The K-allele method was used to identify heterozygous SNPs as a generalization of described methods [<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B30">30</xref>], both of which count the number of alternate alleles present and exclude C/T SNPs. For reference cytosine positions, we only use counts from the <italic>G-strand</italic>, while at other positions we combine the two strands to get read counts. After these filters, we use a <italic>K </italic>cutoff which can vary from 0-10 and apply the <italic>K</italic>-allele threshold as follows. For positions with <italic>n </italic>passing reads where <italic>n </italic>is less than 10, we require that each of the two alleles have at least <italic>K </italic>reads. For positions where <italic>n </italic>is greater than 10, we require at least <inline-formula><mml:math id="M9" name="gb-2012-13-7-r61-i9" overflow="scroll"><mml:mi>n</mml:mi><mml:mfrac><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula> reads. Fore reference, the Hudson Alpha group [<xref ref-type="bibr" rid="B21">21</xref>] used a set definition <italic>K </italic>of 7 reads and at least 10%, and excluded all C/T SNPs. The UCLA group [<xref ref-type="bibr" rid="B30">30</xref>] specified that the allele with the lower read count had to contain at least 40% of reads, and excluded C/T reads.</p>
      </sec>
      <sec>
        <title>bisReadMapper</title>
        <p>We downloaded <monospace>bisReadMapper</monospace> version 1 [<xref ref-type="bibr" rid="B3">3</xref>]. We first use <monospace>genomePrep.pl</monospace> to preprocess the reference genome and extract cytosine position in each chromosome. The built in read mapper could not handle our large BAM file, so we circumvented the mapping step and used the BAM files directly as input. This is not a standard part of the bisReadMapper package, and required us to divide our BAM alignment files to separate reads aligning to the forward strand of the reference genome from those aligning to the reverse strand. We used the following <monospace>bisReadMapper</monospace> parameters: <monospace>allC=1; length=75; snp=dbsnp135.rod; alignMode=S; qualBase=33; trim3=0; trim5=0; refDir=/path/to/GenomePreparationProcessedDir/</monospace></p>
      </sec>
      <sec>
        <title>Shoemaker</title>
        <p>The Shoemaker [<xref ref-type="bibr" rid="B20">20</xref>] method was implemented as described in their supplemental materials with clarifications from the author. The reads are handled differently based on the ratio of C to T nucleotides within the read and the ratio of G to A nucleotides (if C to T ratio was higher, it was considered a bisulfite-converted C-strand read, otherwise it was considered a complementary read from the 2nd end and it was reverse complemented). All reads are then demethylated <italic>in silico </italic>(Cs converted to Ts). Input reads are filtered by their criteria: (1) Base calls at the examined SNP site and three flanking positions on either side needed to have a minimum Base Quality score of 15. (2) If a certain base was present in more than 20% of reads on one strand, its reverse complement needed to be present on at least 20% of the reads on the opposing strand. Only positions passing these two criteria were analyzed. Base Quality scores were used to weight the nucleotide count contributions to the nucleotide frequency matrix. This matrix was normalized, multiplied by the read count to get final nucleotide number matrix in each location (normalized and weighted A,C,G,T number in each loci). The Fisher exact test was applied to each nucleotide in each of the alleles (e.g. nucleotide number of G vs. nucleotide number of not G, expected nucleotide number of G vs. expected nucleotide number of not G). Two p-values of each allele were multiplied together for each of ten possible genotypes and then normalized. The SNPs were selected out when (1) The best genotype was 10 times more than the next most likely genotype, (2) the SNP was in reported in dbSNP, and (3) had at least 10× read depth.</p>
      </sec>
      <sec>
        <title>Bismark</title>
        <p>We downloaded Bismark-0.50 [<xref ref-type="bibr" rid="B34">34</xref>]. We converted our input BAM file to SAM format and ran <monospace>genome_methylation_bismark2bedGraph.pl</monospace> to extract cytosines. Default settings were used.</p>
      </sec>
      <sec>
        <title>Berman2012</title>
        <p>We implemented a generalized version of the method described in our earlier work [<xref ref-type="bibr" rid="B6">6</xref>]. We only included reference cytosine positions that had at least 3 overlapping C or T reads. We required at least <italic>k</italic>% of reads on the C-strand to be C or T, and <italic>k</italic>% of the reads on the G-strand to be G. The default setting (used in [<xref ref-type="bibr" rid="B6">6</xref>] and shown as an orange rectangle in Figure <xref ref-type="fig" rid="F3">3</xref>) was <italic>k </italic>= 10%.</p>
      </sec>
    </sec>
    <sec>
      <title>Datasets used for whole-genome comparisons</title>
      <sec>
        <title>OTB-colon</title>
        <p>75 bp Single End Whole-Genome Bisulfite-Seq data from [<xref ref-type="bibr" rid="B6">6</xref>] was generated using Illumina GAIIx sequencing (available at dbGap:phs000385). Sample was normal adjacent colon mucosa from a male colon cancer patient.</p>
      </sec>
      <sec>
        <title>TCGA-lung and TCGA-breast</title>
        <p>100 bp Paired End Whole Genome Bisulfite-Seq (WGBS) data generated at USC by the TCGA (The Cancer Genome Atlas) USC-JHU Epigenome Characterization Center. Data is unpublished, but available for download via the UCSC Cancer Genomics Hub (CG-Hub [<xref ref-type="bibr" rid="B44">44</xref>]). The lung normal sample is adjacent tissue from case TCGA-60-2722 (data available in CG-Hub analysis ID 964a8130-d061-472f-9839-9c1f07b24205), and the breast normal sample is adjacent tissue from case TCGA-A7-A0CE (CG-Hub analysis ID 279507dd-4c62-4975-877d-5cfebd2e7c6f.</p>
      </sec>
      <sec>
        <title>Mouse-F1i and Mouse-F1r</title>
        <p>One hundred-base pair paired-end sequence datasets from two independent mouse samples were used[<xref ref-type="bibr" rid="B22">22</xref>]. We downloaded alignments from the original publication (GEO accessions GSM753569 and GSM753570), which were performed using Novoalign. High-confidence genotypes were available for both parental strains via the Mouse Genome Database. We inferred high-confidence genotypes for the progeny only when each parent was homozygous at the particular position.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Abbreviations</title>
    <p>CpG: dinucleotide sequencing consisting of a cytosine followed by guanine; CpH: cytosine followed by an H nucleotide (H is one of C, A, or T); SNP: Single-nucleotide polymorphisms; WGBS: Whole-Genome Bisulfite-Seq; RRBS: Reduced Representation Bisulfite Sequencing; BSPP: Bisulfite Padlock Probes; ENCODE: ENCyclopedia Of DNA Elements; TCGA: The Cancer Genome Atlas; GATK: Genome Analysis Toolkit; VCF: Variant Calling Format; FDR: False Discovery Rate; IUPAC: International Union of Pure and Applied Chemistry; GWAS: Genome-Wide Association Study; BAM: Binary version of the Sequence Alignment/Map (SAM) format; SB: Strand Bias; QD: Quality by Depth.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>YL, PWL, and BPB conceived and designed the study. YL and BPB conceived the statistical approach with input from KDS. YL implemented Bis-SNP and all other computational tools. BPB and YL wrote the manuscript, with input from KS and PWL. All authors have read and approved the manuscript for publication.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Detecting heterozygous C/T single nucleotide polymorphisms from Bisulfite-seq data</bold>. Hypothetical bisulfite-seq data with all labels as in Figure <xref ref-type="fig" rid="F1">1</xref>. This illustrates detection of a C/T heterozygous position (left), and that the G-strand alleles can be used to associate methylation state of an adjacent cytosine on the opposite strand with two parental alleles.</p>
      </caption>
      <media xlink:href="gb-2012-13-7-r61-S1.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>Bis-SNP error frequencies at C:T heterozygous SNPs</bold>. The data for heterozygous SNP calling in Figure <xref ref-type="fig" rid="F3">3c</xref> is broken up into C:T SNPs vs. other heterozygous SNPs.</p>
      </caption>
      <media xlink:href="gb-2012-13-7-r61-S2.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3</title>
        <p><bold>Bis-SNP executable, utility scripts, and User Manual</bold>. We suggest that the user download the most recent version of these files directly from [<xref ref-type="bibr" rid="B37">37</xref>].</p>
      </caption>
      <media xlink:href="gb-2012-13-7-r61-S3.GZ" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S4">
      <caption>
        <title>Additional file 4</title>
        <p><bold>Bis-SNP source code</bold>. We suggest that the user download the most recent version of these files directly from [<xref ref-type="bibr" rid="B37">37</xref>].</p>
      </caption>
      <media xlink:href="gb-2012-13-7-r61-S4.GZ" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>Support to YL, PWL, and BPB was provided by NIH grant number U24CA143882. We acknowledge our colleagues at the USC Epigenome Center for useful discussions and suggestions. High performance computing support was provided by the USC High Performance Computing Center [<xref ref-type="bibr" rid="B45">45</xref>]. We wish to thank Robert Shoemaker, Dinh Diep, Kun Zhang, and Felix Krueger for clarifications and assistance with their software tools.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Laird</surname>
          <given-names>PW</given-names>
        </name>
        <article-title>Principles and challenges of genomewide DNA methylation analysis</article-title>
        <source>Nat Rev Genet</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>191</fpage>
        <lpage>203</lpage>
        <pub-id pub-id-type="pmid">20125086</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Meissner</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Mikkelsen</surname>
          <given-names>TS</given-names>
        </name>
        <name>
          <surname>Gu</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Wernig</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Hanna</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Sivachenko</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Bernstein</surname>
          <given-names>BE</given-names>
        </name>
        <name>
          <surname>Nusbaum</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Jaffe</surname>
          <given-names>DB</given-names>
        </name>
        <name>
          <surname>Gnirke</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Jaenisch</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Lander</surname>
          <given-names>ES</given-names>
        </name>
        <article-title>Genome-scale DNA methylation maps of pluripotent and differentiated cells</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>454</volume>
        <fpage>766</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="pmid">18600261</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Diep</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Plongthongkum</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Gore</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Fung</surname>
          <given-names>HL</given-names>
        </name>
        <name>
          <surname>Shoemaker</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>K</given-names>
        </name>
        <article-title>Library-free methylation sequencing with bisulfite padlock probes</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>270</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1871</pub-id>
        <pub-id pub-id-type="pmid">22306810</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lister</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Pelizzola</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Dowen</surname>
          <given-names>RH</given-names>
        </name>
        <name>
          <surname>Hawkins</surname>
          <given-names>RD</given-names>
        </name>
        <name>
          <surname>Hon</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Tonti-Filippini</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Nery</surname>
          <given-names>JR</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Ye</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Ngo</surname>
          <given-names>QM</given-names>
        </name>
        <name>
          <surname>Edsall</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Antosiewicz-Bourget</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Stewart</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Ruotti</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Millar</surname>
          <given-names>AH</given-names>
        </name>
        <name>
          <surname>Thomson</surname>
          <given-names>JA</given-names>
        </name>
        <name>
          <surname>Ren</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Ecker</surname>
          <given-names>JR</given-names>
        </name>
        <article-title>Human DNA methylomes at base resolution show widespread epigenomic differences</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>462</volume>
        <fpage>315</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1038/nature08514</pub-id>
        <pub-id pub-id-type="pmid">19829295</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hansen</surname>
          <given-names>KD</given-names>
        </name>
        <name>
          <surname>Timp</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Bravo</surname>
          <given-names>HC</given-names>
        </name>
        <name>
          <surname>Sabunciyan</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Langmead</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>McDonald</surname>
          <given-names>OG</given-names>
        </name>
        <name>
          <surname>Wen</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Wu</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Diep</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Briem</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Irizarry</surname>
          <given-names>RA</given-names>
        </name>
        <name>
          <surname>Feinberg</surname>
          <given-names>AP</given-names>
        </name>
        <article-title>Increased methylation variation in epigenetic domains across cancer types</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>768</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.865</pub-id>
        <pub-id pub-id-type="pmid">21706001</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Berman</surname>
          <given-names>BP</given-names>
        </name>
        <name>
          <surname>Weisenberger</surname>
          <given-names>DJ</given-names>
        </name>
        <name>
          <surname>Aman</surname>
          <given-names>JF</given-names>
        </name>
        <name>
          <surname>Hinoue</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Ramjan</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Noushmehr</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Lange</surname>
          <given-names>CPE</given-names>
        </name>
        <name>
          <surname>van Dijk</surname>
          <given-names>CM</given-names>
        </name>
        <name>
          <surname>Tollenaar</surname>
          <given-names>RAEM</given-names>
        </name>
        <name>
          <surname>Van Den Berg</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Laird</surname>
          <given-names>PW</given-names>
        </name>
        <article-title>Regions of focal DNA hypermethylation and long-range hypomethylation in colorectal cancer coincide with nuclear lamina-associated domains</article-title>
        <source>Nat Genet</source>
        <year>2012</year>
        <volume>44</volume>
        <fpage>40</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="pmid">22120008</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="other">
        <name>
          <surname>Adey</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Shendure</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Ultra-low-input, tagmentation-based whole genome bisulfite sequencing</article-title>
        <source>Genome Res</source>
        <year>2012</year>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gu</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Bock</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Mikkelsen</surname>
          <given-names>TS</given-names>
        </name>
        <name>
          <surname>Jäger</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Smith</surname>
          <given-names>ZD</given-names>
        </name>
        <name>
          <surname>Tomazou</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Gnirke</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Lander</surname>
          <given-names>ES</given-names>
        </name>
        <name>
          <surname>Meissner</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Genome-scale DNA methylation mapping of clinical samples at single-nucleotide resolution</article-title>
        <source>Nat Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>133</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1414</pub-id>
        <pub-id pub-id-type="pmid">20062050</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <collab>ENCODE Project Consortium</collab>
        <article-title>The ENCODE (ENCyclopedia Of DNA Elements) Project</article-title>
        <source>Science</source>
        <year>2004</year>
        <volume>306</volume>
        <fpage>636</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="pmid">15499007</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Krueger</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Kreck</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Franke</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Andrews</surname>
          <given-names>SR</given-names>
        </name>
        <article-title>DNA methylome analysis using short bisulfite sequencing data</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>145</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1828</pub-id>
        <pub-id pub-id-type="pmid">22290186</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Handsaker</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Wysoker</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Fennell</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Ruan</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Homer</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Marth</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Abecasis</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <collab>1000 Genome Project Data Processing Subgroup</collab>
        <article-title>The Sequence Alignment/Map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>DePristo</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Banks</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Poplin</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Garimella</surname>
          <given-names>KV</given-names>
        </name>
        <name>
          <surname>Maguire</surname>
          <given-names>JR</given-names>
        </name>
        <name>
          <surname>Hartl</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Philippakis</surname>
          <given-names>AA</given-names>
        </name>
        <name>
          <surname>del Angel</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Rivas</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Hanna</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>McKenna</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Fennell</surname>
          <given-names>TJ</given-names>
        </name>
        <name>
          <surname>Kernytsky</surname>
          <given-names>AM</given-names>
        </name>
        <name>
          <surname>Sivachenko</surname>
          <given-names>AY</given-names>
        </name>
        <name>
          <surname>Cibulskis</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Gabriel</surname>
          <given-names>SB</given-names>
        </name>
        <name>
          <surname>Altshuler</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Daly</surname>
          <given-names>MJ</given-names>
        </name>
        <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>491</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.806</pub-id>
        <pub-id pub-id-type="pmid">21478889</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Fang</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Yang</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Kristiansen</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>J</given-names>
        </name>
        <article-title>SNP detection for massively parallel whole-genome resequencing</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>1124</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.088013.108</pub-id>
        <pub-id pub-id-type="pmid">19420381</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zhao</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Boerwinkle</surname>
          <given-names>E</given-names>
        </name>
        <article-title>Neighboring-nucleotide effects on single nucleotide polymorphisms: a study of 2.6 million polymorphisms across the human genome</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>1679</fpage>
        <lpage>86</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.287302</pub-id>
        <pub-id pub-id-type="pmid">12421754</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ramsahoye</surname>
          <given-names>BH</given-names>
        </name>
        <name>
          <surname>Biniszkiewicz</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Lyko</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Clark</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Bird</surname>
          <given-names>AP</given-names>
        </name>
        <name>
          <surname>Jaenisch</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Non-CpG methylation is prevalent in embryonic stem cells and may be mediated by DNA methyltransferase 3a</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2000</year>
        <volume>97</volume>
        <fpage>5237</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.97.10.5237</pub-id>
        <pub-id pub-id-type="pmid">10805783</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lister</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>O'Malley</surname>
          <given-names>RC</given-names>
        </name>
        <name>
          <surname>Tonti-Filippini</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Gregory</surname>
          <given-names>BD</given-names>
        </name>
        <name>
          <surname>Berry</surname>
          <given-names>CC</given-names>
        </name>
        <name>
          <surname>Millar</surname>
          <given-names>AH</given-names>
        </name>
        <name>
          <surname>Ecker</surname>
          <given-names>JR</given-names>
        </name>
        <article-title>Highly integrated single-base resolution maps of the epigenome in Arabidopsis</article-title>
        <source>Cell</source>
        <year>2008</year>
        <volume>133</volume>
        <fpage>523</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2008.03.029</pub-id>
        <pub-id pub-id-type="pmid">18423832</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Cokus</surname>
          <given-names>SJ</given-names>
        </name>
        <name>
          <surname>Feng</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Merriman</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Haudenschild</surname>
          <given-names>CD</given-names>
        </name>
        <name>
          <surname>Pradhan</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Nelson</surname>
          <given-names>SF</given-names>
        </name>
        <name>
          <surname>Pellegrini</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Jacobsen</surname>
          <given-names>SE</given-names>
        </name>
        <article-title>Shotgun bisulphite sequencing of the Arabidopsis genome reveals DNA methylation patterning</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>452</volume>
        <fpage>215</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/nature06745</pub-id>
        <pub-id pub-id-type="pmid">18278030</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lienert</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Wirbelauer</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Som</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Dean</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Mohn</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Schübeler</surname>
          <given-names>D</given-names>
        </name>
        <article-title>Identification of genetic elements that autonomously determine DNA methylation states</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>1091</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.946</pub-id>
        <pub-id pub-id-type="pmid">21964573</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Tycko</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Allele-specificDNA methylation: beyond imprinting</article-title>
        <source>Hum Mol Genet</source>
        <year>2010</year>
        <volume>19</volume>
        <fpage>R210</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/ddq376</pub-id>
        <pub-id pub-id-type="pmid">20855472</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Shoemaker</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Deng</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>K</given-names>
        </name>
        <article-title>Allele-specific methylation is prevalent and is contributed by CpG-SNPs in the human genome</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>883</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.104695.109</pub-id>
        <pub-id pub-id-type="pmid">20418490</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gertz</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Varley</surname>
          <given-names>KE</given-names>
        </name>
        <name>
          <surname>Reddy</surname>
          <given-names>TE</given-names>
        </name>
        <name>
          <surname>Bowling</surname>
          <given-names>KM</given-names>
        </name>
        <name>
          <surname>Pauli</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Parker</surname>
          <given-names>SL</given-names>
        </name>
        <name>
          <surname>Kucera</surname>
          <given-names>KS</given-names>
        </name>
        <name>
          <surname>Willard</surname>
          <given-names>HF</given-names>
        </name>
        <name>
          <surname>Myers</surname>
          <given-names>RM</given-names>
        </name>
        <article-title>Analysis of DNA methylation in a three-generation family reveals widespread genetic influence on epigenetic regulation</article-title>
        <source>PLoS Genet</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>e1002228</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1002228</pub-id>
        <pub-id pub-id-type="pmid">21852959</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Xie</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Barr</surname>
          <given-names>CL</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Yue</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>AY</given-names>
        </name>
        <name>
          <surname>Eubanks</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Dempster</surname>
          <given-names>EL</given-names>
        </name>
        <name>
          <surname>Ren</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Base-resolution analyses of sequence and parent-of-origin dependent DNA methylation in the mouse genome</article-title>
        <source>Cell</source>
        <year>2012</year>
        <volume>148</volume>
        <fpage>816</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2011.12.035</pub-id>
        <pub-id pub-id-type="pmid">22341451</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Zhu</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Tian</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Ye</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Zheng</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Yu</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Wu</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Sun</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Luo</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>He</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Jin</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Yu</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Zhou</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Sun</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Huang</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Zheng</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Cao</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Zhou</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Guo</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Hu</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Kristiansen</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Bolund</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Xu</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Yang</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Beck</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>X</given-names>
        </name>
        <article-title>The DNA methylome of human peripheral blood mononuclear cells</article-title>
        <source>PLoS Biol</source>
        <year>2010</year>
        <volume>8</volume>
        <fpage>e1000533</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.1000533</pub-id>
        <pub-id pub-id-type="pmid">21085693</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Stadler</surname>
          <given-names>MB</given-names>
        </name>
        <name>
          <surname>Murr</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Burger</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Ivanek</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Lienert</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Schäoler</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Wirbelauer</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Oakeley</surname>
          <given-names>EJ</given-names>
        </name>
        <name>
          <surname>Gaidatzis</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Tiwari</surname>
          <given-names>VK</given-names>
        </name>
        <name>
          <surname>Schäubeler</surname>
          <given-names>D</given-names>
        </name>
        <article-title>DNA-binding factors shape the mouse methylome at distal regulatory regions</article-title>
        <source>Nature</source>
        <year>2011</year>
        <volume>480</volume>
        <fpage>490</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="pmid">22170606</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hon</surname>
          <given-names>GC</given-names>
        </name>
        <name>
          <surname>Hawkins</surname>
          <given-names>RD</given-names>
        </name>
        <name>
          <surname>Caballero</surname>
          <given-names>OL</given-names>
        </name>
        <name>
          <surname>Lo</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Lister</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Pelizzola</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Valsesia</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Ye</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Kuan</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Edsall</surname>
          <given-names>LE</given-names>
        </name>
        <name>
          <surname>Camargo</surname>
          <given-names>AA</given-names>
        </name>
        <name>
          <surname>Stevenson</surname>
          <given-names>BJ</given-names>
        </name>
        <name>
          <surname>Ecker</surname>
          <given-names>JR</given-names>
        </name>
        <name>
          <surname>Bafna</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Strausberg</surname>
          <given-names>RL</given-names>
        </name>
        <name>
          <surname>Simpson</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Ren</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Global DNA hypomethylation coupled to repressive chromatin domain formation and gene silencing in breast cancer</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>246</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.125872.111</pub-id>
        <pub-id pub-id-type="pmid">22156296</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Harris</surname>
          <given-names>RA</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Coarfa</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Nagarajan</surname>
          <given-names>RP</given-names>
        </name>
        <name>
          <surname>Hong</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Downey</surname>
          <given-names>SL</given-names>
        </name>
        <name>
          <surname>Johnson</surname>
          <given-names>BE</given-names>
        </name>
        <name>
          <surname>Fouse</surname>
          <given-names>SD</given-names>
        </name>
        <name>
          <surname>Delaney</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Olshen</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Ballinger</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Zhou</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Forsberg</surname>
          <given-names>KJ</given-names>
        </name>
        <name>
          <surname>Gu</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Echipare</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>O'Geen</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Lister</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Pelizzola</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Xi</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Epstein</surname>
          <given-names>CB</given-names>
        </name>
        <name>
          <surname>Bernstein</surname>
          <given-names>BE</given-names>
        </name>
        <name>
          <surname>Hawkins</surname>
          <given-names>RD</given-names>
        </name>
        <name>
          <surname>Ren</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Chung</surname>
          <given-names>WY</given-names>
        </name>
        <name>
          <surname>Gu</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Bock</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Gnirke</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>MQ</given-names>
        </name>
        <name>
          <surname>Haussler</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Ecker</surname>
          <given-names>JR</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Farnham</surname>
          <given-names>PJ</given-names>
        </name>
        <name>
          <surname>Waterland</surname>
          <given-names>RA</given-names>
        </name>
        <name>
          <surname>Meissner</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Marra</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Hirst</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Milosavljevic</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Costello</surname>
          <given-names>JF</given-names>
        </name>
        <article-title>Comparison of sequencing-based methods to profile DNA methylation and identification of monoallelic epigenetic modifications</article-title>
        <source>Nat Biotechnol</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>1097</fpage>
        <lpage>105</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1682</pub-id>
        <pub-id pub-id-type="pmid">20852635</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schalkwyk</surname>
          <given-names>LC</given-names>
        </name>
        <name>
          <surname>Meaburn</surname>
          <given-names>EL</given-names>
        </name>
        <name>
          <surname>Smith</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Dempster</surname>
          <given-names>EL</given-names>
        </name>
        <name>
          <surname>Jeffries</surname>
          <given-names>AR</given-names>
        </name>
        <name>
          <surname>Davies</surname>
          <given-names>MN</given-names>
        </name>
        <name>
          <surname>Plomin</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Mill</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Allelic skewing of DNA methylation is widespread across the genome</article-title>
        <source>Am J Hum Genet</source>
        <year>2010</year>
        <volume>86</volume>
        <fpage>196</fpage>
        <lpage>212</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2010.01.014</pub-id>
        <pub-id pub-id-type="pmid">20159110</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Weisenberger</surname>
          <given-names>DJ</given-names>
        </name>
        <name>
          <surname>Campan</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Long</surname>
          <given-names>TI</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Woods</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Fiala</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Ehrlich</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Laird</surname>
          <given-names>PW</given-names>
        </name>
        <article-title>Analysis of repetitive element DNA methylation by MethyLight</article-title>
        <source>Nucleic Acids Res</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>6823</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gki987</pub-id>
        <pub-id pub-id-type="pmid">16326863</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lister</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Pelizzola</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Kida</surname>
          <given-names>YS</given-names>
        </name>
        <name>
          <surname>Hawkins</surname>
          <given-names>RD</given-names>
        </name>
        <name>
          <surname>Nery</surname>
          <given-names>JR</given-names>
        </name>
        <name>
          <surname>Hon</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Antosiewicz-Bourget</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>O'Malley</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Castanon</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Klugman</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Downes</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Yu</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Stewart</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Ren</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Thomson</surname>
          <given-names>JA</given-names>
        </name>
        <name>
          <surname>Evans</surname>
          <given-names>RM</given-names>
        </name>
        <name>
          <surname>Ecker</surname>
          <given-names>JR</given-names>
        </name>
        <article-title>Hotspots of aberrant epigenomic reprogramming in human induced pluripotent stem cells</article-title>
        <source>Nature</source>
        <year>2011</year>
        <volume>471</volume>
        <fpage>68</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1038/nature09798</pub-id>
        <pub-id pub-id-type="pmid">21289626</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Chen</surname>
          <given-names>PY</given-names>
        </name>
        <name>
          <surname>Feng</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Joo</surname>
          <given-names>JWJ</given-names>
        </name>
        <name>
          <surname>Jacobsen</surname>
          <given-names>SE</given-names>
        </name>
        <name>
          <surname>Pellegrini</surname>
          <given-names>M</given-names>
        </name>
        <article-title>A comparative analysis of DNA methylation across human embryonic stem cell lines</article-title>
        <source>Genome Biol</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>R62</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2011-12-7-r62</pub-id>
        <pub-id pub-id-type="pmid">21733148</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Ruan</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1851</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.078212.108</pub-id>
        <pub-id pub-id-type="pmid">18714091</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal">
        <name>
          <surname>McKenna</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Hanna</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Banks</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Sivachenko</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Cibulskis</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Kernytsky</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Garimella</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Altshuler</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Gabriel</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Daly</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>DePristo</surname>
          <given-names>MA</given-names>
        </name>
        <article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>1297</fpage>
        <lpage>303</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id>
        <pub-id pub-id-type="pmid">20644199</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Xi</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Bock</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Müller</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Sun</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Meissner</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>W</given-names>
        </name>
        <article-title>RRBSMAP: a fast, accurate and user-friendly alignment tool for reduced representation bisulfite sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>430</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr668</pub-id>
        <pub-id pub-id-type="pmid">22155871</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Krueger</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Andrews</surname>
          <given-names>SR</given-names>
        </name>
        <article-title>Bismark: a flexible aligner and methylation caller for Bisulfite-Seq applications</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>1571</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr167</pub-id>
        <pub-id pub-id-type="pmid">21493656</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Laurent</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Wong</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Huynh</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Tsirigos</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Ong</surname>
          <given-names>CT</given-names>
        </name>
        <name>
          <surname>Low</surname>
          <given-names>HM</given-names>
        </name>
        <name>
          <surname>Kin Sung</surname>
          <given-names>KW</given-names>
        </name>
        <name>
          <surname>Rigoutsos</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Loring</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Wei</surname>
          <given-names>CL</given-names>
        </name>
        <article-title>Dynamic changes in the human methylome during differentiation</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>320</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.101907.109</pub-id>
        <pub-id pub-id-type="pmid">20133333</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hodges</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Molaro</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Dos Santos</surname>
          <given-names>CO</given-names>
        </name>
        <name>
          <surname>Thekkat</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Song</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Uren</surname>
          <given-names>PJ</given-names>
        </name>
        <name>
          <surname>Park</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Butler</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Rafii</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>McCombie</surname>
          <given-names>WR</given-names>
        </name>
        <name>
          <surname>Smith</surname>
          <given-names>AD</given-names>
        </name>
        <name>
          <surname>Hannon</surname>
          <given-names>GJ</given-names>
        </name>
        <article-title>Directional DNA methylation changes and complex intermediate states accompany lineage specificity in the adult hematopoietic compartment</article-title>
        <source>Mol Cell</source>
        <year>2011</year>
        <volume>44</volume>
        <fpage>17</fpage>
        <lpage>28</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2011.08.026</pub-id>
        <pub-id pub-id-type="pmid">21924933</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="other">
        <collab>USC Epigenome Center</collab>
        <article-title>Bis-SNP website</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://epigenome.usc.edu/publicationdata/bissnp2011">http://epigenome.usc.edu/publicationdata/bissnp2011</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="other">
        <name>
          <surname>Booth</surname>
          <given-names>MJ</given-names>
        </name>
        <name>
          <surname>Branco</surname>
          <given-names>MR</given-names>
        </name>
        <name>
          <surname>Ficz</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Oxley</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Krueger</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Reik</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Balasubramanian</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Quantitative Sequencing of 5-Methylcytosine and 5-Hydroxymethylcytosine at Single-Base Resolution</article-title>
        <source>Science</source>
        <year>2012</year>
      </mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rakyan</surname>
          <given-names>VK</given-names>
        </name>
        <name>
          <surname>Down</surname>
          <given-names>TA</given-names>
        </name>
        <name>
          <surname>Balding</surname>
          <given-names>DJ</given-names>
        </name>
        <name>
          <surname>Beck</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Epigenome-wide association studies for common human diseases</article-title>
        <source>Nat Rev Genet</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>529</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3000</pub-id>
        <pub-id pub-id-type="pmid">21747404</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B40">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Renbaum</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Abrahamove</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Fainsod</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Wilson</surname>
          <given-names>GG</given-names>
        </name>
        <name>
          <surname>Rottem</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Razin</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Cloning, characterization, and expression in Escherichia coli of the gene coding for the CpG DNA methylase from Spiroplasma sp. strain MQ1(M.SssI)</article-title>
        <source>Nucleic Acids Res</source>
        <year>1990</year>
        <volume>18</volume>
        <fpage>1145</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/18.5.1145</pub-id>
        <pub-id pub-id-type="pmid">2181400</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B41">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Smith</surname>
          <given-names>ZD</given-names>
        </name>
        <name>
          <surname>Gu</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Bock</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Gnirke</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Meissner</surname>
          <given-names>A</given-names>
        </name>
        <article-title>High-throughput bisulfite sequencing in mammalian genomes</article-title>
        <source>Methods</source>
        <year>2009</year>
        <volume>48</volume>
        <fpage>226</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ymeth.2009.05.003</pub-id>
        <pub-id pub-id-type="pmid">19442738</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B42">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Raizis</surname>
          <given-names>AM</given-names>
        </name>
        <name>
          <surname>Schmitt</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Jost</surname>
          <given-names>JP</given-names>
        </name>
        <article-title>A bisulfite method of 5-methylcytosine mapping that minimizes template degradation</article-title>
        <source>Anal Biochem</source>
        <year>1995</year>
        <volume>226</volume>
        <fpage>161</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1006/abio.1995.1204</pub-id>
        <pub-id pub-id-type="pmid">7785768</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B43">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ehrich</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Zoll</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Sur</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>van den Boom</surname>
          <given-names>D</given-names>
        </name>
        <article-title>A new method for accurate assessment of DNA quality after bisulfite treatment</article-title>
        <source>Nucleic Acids Res</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>e29</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkl1134</pub-id>
        <pub-id pub-id-type="pmid">17259213</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B44">
      <mixed-citation publication-type="other">
        <collab>UC Santa Cruz</collab>
        <article-title>Cancer Genomics Hub (CG-Hub)</article-title>
        <ext-link ext-link-type="uri" xlink:href="https://cghub.ucsc.edu/">https://cghub.ucsc.edu/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B45">
      <mixed-citation publication-type="other">
        <collab>USC</collab>
        <article-title>High Performance Computing and Communications Center (HPCC)</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.usc.edu/hpcc/">http://www.usc.edu/hpcc/</ext-link>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
