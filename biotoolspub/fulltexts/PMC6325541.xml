<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.0 20120330//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">eNeuro</journal-id>
    <journal-id journal-id-type="iso-abbrev">eNeuro</journal-id>
    <journal-id journal-id-type="hwp">eneuro</journal-id>
    <journal-id journal-id-type="pmc">eneuro</journal-id>
    <journal-id journal-id-type="publisher-id">eNeuro</journal-id>
    <journal-title-group>
      <journal-title>eNeuro</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2373-2822</issn>
    <publisher>
      <publisher-name>Society for Neuroscience</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6325541</article-id>
    <article-id pub-id-type="doi">10.1523/ENEURO.0266-18.2018</article-id>
    <article-id pub-id-type="publisher-id">eN-MNT-0266-18</article-id>
    <article-categories>
      <subj-group subj-group-type="hwp-journal-coll">
        <subject>7</subject>
        <subject>7.2</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Methods/New Tools</subject>
        <subj-group>
          <subject>Novel Tools and Methods</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>3DMorph Automatic Analysis of Microglial Morphology in Three Dimensions from <italic>Ex Vivo</italic> and <italic>In Vivo</italic> Imaging</article-title>
      <alt-title alt-title-type="right-running-head">3DMorph Analysis of Microglial Morphology</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8479-5231</contrib-id>
        <name>
          <surname>York</surname>
          <given-names>Elisa M.</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>LeDue</surname>
          <given-names>Jeffrey M.</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5063-2338</contrib-id>
        <name>
          <surname>Bernier</surname>
          <given-names>Louis-Philippe</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4596-4623</contrib-id>
        <name>
          <surname>MacVicar</surname>
          <given-names>Brian A.</given-names>
        </name>
      </contrib>
      <aff id="aff1">Department of Psychiatry, Djavad Mowafaghian Centre for Brain Health, <institution>University of British Columbia</institution>, British Columbia V6T 1Z3, <country>Canada</country></aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="other">
        <p>The authors declare no competing financial interests.</p>
      </fn>
      <fn fn-type="con">
        <p>Author Contributions: E.M.Y. and J.M.L. designed research and performed research; L-P.B. analyzed data and contributed unpublished analytical tools; E.M.Y. wrote the paper; E.M.Y., J.M.L., L-P.B., and B.A.M. contributed to editing the paper and giving feedback during the code development process.</p>
      </fn>
      <fn fn-type="other">
        <p>This work was supported by a Canada Research Chair in Neuroscience to B.A.M., a Foundation Grant (148397) from Canadian Institutes of Health Research, and a Grant from Fondation Leducq to B.A.M. We thank Dr. Lasse Dissing-Olesen (Department of Neurology, F.M. Kirby Neurobiology Center, Boston Children's Hospital, Harvard Medical School, Boston, USA) and Dr. Jasmin K. Hefendehl (Department of Cellular Neurology, Hertie Institute for Clinical Brain Research, University of Tübingen, Tübingen, Germany) for the gracious use of the <italic>in vivo</italic> images for processing by 3DMorph, and for their valuable comments on this paper; Dr. Nick L. Weilinger (Department of Psychiatry, Djavad Mowafaghian Center for Brain Health, University of British Columbia, British Columbia, Canada) for patching and imaging neurons for processing by 3DMorph, and for providing constructive feedback on this paper; and the Canadian Institutes of Health Research and Fondation Leducq for their generous funding support.</p>
      </fn>
      <corresp id="cor1">Correspondence should be addressed to either Elisa M. York at Djavad Mowafaghian Centre for Brain Health, 2215 Wesbrook Mall, Vancouver, BC Canada, V6T 1Z3, E-mail: <email>elisa.york@alumni.ubc.ca</email> or <email>bmacvicar@brain.ubc.ca</email>.
</corresp>
    </author-notes>
    <pub-date pub-type="epreprint">
      <day>19</day>
      <month>11</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>12</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <season>Nov-Dec</season>
      <year>2018</year>
    </pub-date>
    <volume>5</volume>
    <issue>6</issue>
    <elocation-id>ENEURO.0266-18.2018</elocation-id>
    <history>
      <date date-type="received">
        <day>9</day>
        <month>7</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>10</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>10</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2018 York et al.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <copyright-holder>York et al.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>, which permits unrestricted use, distribution and reproduction in any medium provided that the original work is properly attributed.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="ENEURO.0266-18.2018.pdf"/>
    <self-uri xlink:role="icon" xlink:href="enu00618279100g1.jpg"/>
    <abstract abstract-type="graphical">
      <title>Visual Abstract</title>
      <p>
        <fig id="F8" fig-type="featured" orientation="portrait" position="float">
          <graphic xlink:href="enu006182791r001"/>
        </fig>
      </p>
    </abstract>
    <abstract>
      <p>Microglia are dynamic immune cells of the central nervous system, and their morphology is commonly used as a readout of cellular function. However, current morphological analysis techniques rely on either tracing of cells or two-dimensional projection analysis, which are time-consuming, subject to bias, and may ignore important three-dimensional (3D) information. Therefore, we have created 3DMorph, a MATLAB-based script that analyzes microglial morphology from 3D data. The program initially requires input of threshold levels, cell size expectations, and preferred methods of skeletonization. This makes 3DMorph easily scalable and adaptable to different imaging parameters or cell types. After these settings are defined, the program is completely automatic and can batch process files without user input. Output data includes cell volume, territorial volume, branch length, number of endpoints and branch points, and average distance between cells. We show that 3DMorph is accurate compared to manual tracing, with significantly decreased user input time. Importantly, 3DMorph is capable of processing <italic>in vivo</italic> microglial morphology, as well as other 3D branching cell types, from mouse cranial windows or acute hippocampal slices. Therefore, we present a novel, user-friendly, scalable, and semiautomatic method of analyzing cell morphology in 3 dimensions. This method should improve the accuracy of cell measurements, remove user bias between conditions, increase reproducibility between experimenters and labs, and reduce user input time. We provide this open source code on GitHub so that it is free and accessible to all investigators.</p>
    </abstract>
    <kwd-group>
      <kwd>3D</kwd>
      <kwd>automatic analysis</kwd>
      <kwd>imaging</kwd>
      <kwd>MATLAB</kwd>
      <kwd>microglia</kwd>
      <kwd>morphology</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source><named-content content-type="funder-id">http://doi.org/10.13039/501100000024</named-content>Gouvernement du Canada | Canadian Institutes of Health Research (CIHR)</funding-source>
        <award-id>148397</award-id>
      </award-group>
      <award-group>
        <funding-source>Foundation Leducq</funding-source>
      </award-group>
    </funding-group>
    <counts>
      <fig-count count="8"/>
      <table-count count="1"/>
      <equation-count count="0"/>
      <ref-count count="29"/>
      <page-count count="12"/>
      <word-count count="7146"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>cover-date</meta-name>
        <meta-value>November/December 2018</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>Significance Statement</title>
    <p>Microglial morphology is often considered to be an indicator of cellular activity, however current techniques to analyze morphology either lose valuable <italic>z</italic>-dimension information or are time intensive to perform. Therefore, we introduce 3DMorph, a MATLAB-based program that semi-automatically processes individual microglial morphology from overlapping 3D clusters, improving accuracy and processing time compared to current tools. 3DMorph is straightforward to use and adaptable to many imaging or experimental parameters. Once user settings are selected, 3DMorph can run in batch mode to automatically process multiple files. We validate 3DMorph against current techniques, and demonstrate the ability to detect differences in microglial morphologies from different <italic>ex vivo</italic> experimental conditions, as well as from <italic>in vivo</italic> data, and images of other branching cell types.</p>
  </sec>
  <sec sec-type="intro" id="s2">
    <title>Introduction</title>
    <p>Microglia, the immune cells of the central nervous system, have small cell bodies and ramified processes that survey the local environment for signs of infection, damage, or disruption of molecular homeostasis (<xref rid="B22" ref-type="bibr">Nimmerjahn et al. 2005</xref>). In response to sensing damage, microglia rapidly extend their processes to converge at the site of injury (<xref rid="B2" ref-type="bibr">Davalos et al., 2005</xref>; <xref rid="B22" ref-type="bibr">Nimmerjahn et al., 2005</xref>; <xref rid="B14" ref-type="bibr">Hines et al. 2009</xref>; <xref rid="B7" ref-type="bibr">Drew et al., 2010</xref>; <xref rid="B4" ref-type="bibr">Dissing-Olesen et al., 2014</xref>; <xref rid="B10" ref-type="bibr">Eyo et al., 2014</xref>, <xref rid="B9" ref-type="bibr">2015</xref>; <xref rid="B21" ref-type="bibr">Lou et al., 2016</xref>). On extensive damage of surrounding cells or stimulation by pathogen-associated triggers, microglia retract their processes to adopt an amoeboid morphology (<xref rid="B20" ref-type="bibr">Kreutzberg, 1996</xref>; <xref rid="B18" ref-type="bibr">Kloss et al. 2001</xref>; <xref rid="B6" ref-type="bibr">Doorn et al., 2014</xref>).</p>
    <p>As a result of these contextual morphologic changes, microglial shape and process ramification have been used as correlates of cellular function (<xref rid="B3" ref-type="bibr">Davis et al. 1994</xref>; <xref rid="B16" ref-type="bibr">Karperien et al. 2013</xref>), with several methods developed to quantify their morphology. Current approaches include manually tracing processes throughout <italic>z</italic>-stack images (<xref rid="B1" ref-type="bibr">Baron et al. 2014</xref>; <xref rid="B27" ref-type="bibr">Takayama et al. 2016</xref>), or performing morphologic analysis on a two-dimensional (2D) maximum projection (<xref rid="B19" ref-type="bibr">Kozlowski and Weimer, 2012</xref>; <xref rid="B16" ref-type="bibr">Karperien et al., 2013</xref>; <xref rid="B28" ref-type="bibr">Torres-Platas et al., 2014</xref>; <xref rid="B29" ref-type="bibr">Verdonk et al., 2016</xref>). The first method is time-intensive and subject to experimenter bias and variability. The second technique loses three-dimensional (3D) information, leading to underestimation of process lengths or erroneous connection of processes. Three dimensional reconstructions of microglia cells can be generated using software such as Imaris (<xref rid="B25" ref-type="bibr">Perego et al. 2013</xref>; <xref rid="B8" ref-type="bibr">Erny et al., 2015</xref>); however, this is time-intensive and expensive. There is a clear need for a method that performs unbiased and automatic analysis of the 3D microglial structure observed in <italic>ex vivo</italic> and <italic>in vivo</italic> systems.</p>
    <p>Here, we describe a method for semiautomatic analysis of microglial morphology in 3D using a custom MATLAB script, 3DMorph. The program uses graphical user interfaces to initially define image threshold, noise limits, and cell sizes. Once these settings are selected, a parameters file is saved that can be used to automatically batch process multiple files. From each image, an Excel file is saved with output data from the entire image (volume covered, average centroid distance), as well as from individual cells within the image (territorial volume, cell volume, cell ramification index, number of endpoints and branch points, and average, min, and max branch lengths).</p>
    <p>The utility of 3DMorph is validated by analyzing and quantifying typical examples of morphologic changes of groups of microglia under control conditions, after hyper-ramification triggered by ATP application, and after retraction of ramifications triggered by inhibiting neuronal AMPA receptors with CNQX and action potentials with TTX. 3DMorph is also shown to process <italic>in vivo</italic> microglial images, as well as other branching cell types such as neurons. Therefore, this analysis software will allow for the automatic and unbiased analysis of microglial morphologies in 3D under several experimental and pathologic conditions.</p>
  </sec>
  <sec sec-type="materials|methods" id="s3">
    <title>Materials and Methods</title>
    <sec id="s3A">
      <title>Animal protocols</title>
      <p>All housing and experimental procedures were conducted in accordance with University of British Columbia and Canadian Council on Animal Care regulations. CX3CR1<sup>EGFP/EGFP</sup> or CX3CR1<sup>+/EGFP</sup> mice on a C57Bl/6 background (<xref rid="B15" ref-type="bibr">Jung et al., 2000</xref>) were housed in a 12 h light/dark cycle with food and water <italic>ad libitum</italic>.</p>
    </sec>
    <sec id="s3B">
      <title>Acute hippocampal slice preparation</title>
      <p>Male mice (2 months of age) were anesthetized to surgical plane with isoflurane and decapitated according to protocols approved by the University of British Columbia committee on animal care. Brains were dissected and sliced horizontally with a vibratome (Leica VT1200S) at 300 μm thick in ice-cold <italic>N</italic>-methyl-<sc>d</sc>-glucamine (NMDG) slicing solution containing the following (in m<sc>m</sc>): 120 NMDG, 2.5 KCl, 25 NaHCO<sub>3</sub>, 1 CaCl<sub>2</sub>, 7 MgCl<sub>2</sub>, 1.2 NaH<sub>2</sub>PO<sub>4</sub>, 2 <sc>d</sc>-glucose, 2.4 sodium pyruvate, and 1.3 sodium <sc>l</sc>-ascorbate, which was constantly oxygenated with 95% O<sub>2</sub> and 5% CO<sub>2</sub>. Hippocampal slices were immediately transferred to artificial CSF (aCSF) continuously oxygenated with 95% O<sub>2</sub> and 5% CO<sub>2</sub>, and allowed to recover for 30 min at 32 ˚C. Artificial CSF contained the following (in m<sc>m</sc>): 126 NaCl, 2.5 KCl, 26 NaHCO<sub>3</sub>, 2 CaCl<sub>2</sub>, 2 MgCl<sub>2</sub>, 1.25 NaH<sub>2</sub>PO<sub>4</sub>, and 10 <sc>d</sc>-glucose, pH 7.3–7.4, osmolarity 300 mOsm.</p>
    </sec>
    <sec id="s3C">
      <title>Treatment conditions and SNAPSHOT</title>
      <p>Slices were incubated for 10 min at 32°C in either control aCSF, or aCSF containing 500 µ<sc>m</sc> ATP, or 50 µ<sc>m</sc> CNQX and 1 µ<sc>m</sc> TTX. Slices were then fixed using the SNAPSHOT method (<xref rid="B5" ref-type="bibr">Dissing-Olesen and MacVicar, 2015</xref>), which consists of a 2 min immersion in 4% PFA at 80°C, rinse in 0.1 <sc>m</sc> PBS, and storage in clearing solution (0.1 <sc>m</sc> PBS with 20% DMSO, and 2% Triton X) at 4°C for 1 week. GFP fluorescence is well-preserved by this method, and slices were ready for imaging immediately after clearing.</p>
    </sec>
    <sec id="s3D">
      <title>Acute hippocampal slice image acquisition</title>
      <p>Fixed hippocampal slices were imaged with a two-photon Coherent Chameleon Ultra II laser with a Zeiss LSM 7 MP microscope. Using a Zeiss 20×-W/1.0 NA objective, GFP was excited at 920 nm, and emission was detected by a photomultiplier tube (Zeiss LSM BiG) after passing through a 535 ± 25 nm filter. Images were taken in the stratum radiatum of CA1 hippocampus at a depth of 150 µm ± 25 µm. Stacks were imaged at 16 bit, with 1024 × 1024 pixels, 16-line averaging, a zoom of 2.8, and <italic>z</italic>-step distance of 1 µm. After acquisition, background signal was removed from all images using Fiji’s rolling ball (radius = 25 pixels) background subtraction.</p>
    </sec>
    <sec id="s3E">
      <title>Cranial window surgery</title>
      <p>Mice were anesthetized using a tricomponent anesthesia (fentanyl, 0.05 mg/kg; midazolam, 5 mg/kg; medetomidine, 0.50 mg/kg), placed on a heating pad, and secured to a stereotactic frame. After the skull was exposed by removing the skin and periosteum, a circle was gently drilled into the skull’s surface at 0.5 mm lateral of −0.5 mm bregma. Once this portion of skull was removed, the brain was kept moist using surgical gel sponges in PBS (GelitaSpon). A custom-made 14-mm-diameter titanium ring was secured around the cranial window with light-curing dental cement (Heraeus). This ring fits into a custom-made head fixation plate, which secures the skull in the <italic>x</italic>, <italic>y</italic>, and <italic>z</italic> planes during <italic>in vivo</italic> imaging (<xref rid="B12" ref-type="bibr">Hefendehl et al., 2014</xref>).</p>
    </sec>
    <sec id="s3F">
      <title><italic>In vivo</italic> image acquisition</title>
      <p>After cranial window preparation and titanium head ring fixation, anesthetized mice (fentanyl, 0.05 mg/kg; midazolam, 5 mg/kg; medetomidine, 0.50 mg/kg) were imaged on a custom-made two-photon microscope (<xref rid="B26" ref-type="bibr">Rosenegger et al., 2014</xref>) using a Coherent Chameleon Ultra II laser and a Zeiss 40×-W/1 NA objective. The head ring is secured to a fixation plate (<xref rid="B12" ref-type="bibr">Hefendehl et al., 2014</xref>), which is connected to a motorized <italic>x</italic>–<italic>y</italic> stage (Sutter Instruments). EGFP was imaged with 920 nm excitation and detected via non-descanned detectors after passing an ET525/50m-2P emission filter (Chroma Technology). Laser power did not exceed 45 mW throughout the experiment. <italic>Z</italic>-stack images (<italic>z</italic> = 40; 1 µm steps) were acquired at 512 × 512 pixels with no averaging, at a depth of 100–140 µm. Using a custom-designed perfusion system, aCSF was continuously perfused across the cortical surface at a rate of 3 ml/min. After acquisition, the signal of EGFP in these images was enhanced by increasing the contrast in Fiji, and motion artifacts were corrected with the Gaussian 3D filter.</p>
    </sec>
    <sec id="s3G">
      <title>Neuronal dye loading</title>
      <p>Layer 3 neurons from acute cortical slices (P24 rat) were whole-cell patch-clamped with borosilicate glass electrodes (3–4 MΩ). The intracellular recording solution consisted of the following (in m<sc>m</sc>): 113 K-gluconate, 2 MgCl<sub>2</sub>, 8 Na-gluconate, 3 KCl, 1 K<sub>2</sub>-EGTA, 4 K<sub>2</sub>-ATP, and 0.3 Na<sub>3</sub>-GTP at pH 7.25 with 10 HEPES. The solution also contained 50 µ<sc>m</sc> AlexaFluor 594 hydrazide (ThermoFisher) to visualize the morphology of the dendritic arbor. The example cell was dialyzed with dye for 30 min before the patch electrode was slowly withdrawn before imaging. Images were post-processed in Fiji to subtract background using rolling ball radius, and enhance connectivity while removing speckles using the Gaussian Blur 3D filter and smooth functions.</p>
    </sec>
    <sec id="s3H">
      <title>3DMorph workflow</title>
      <p>The overall workflow of 3DMorph is outlined in <xref ref-type="fig" rid="F1">Figure 1</xref>. Once images are acquired and processed as necessary, they should be moved to the Current Folder within MATLAB, or the data folder should be added to MATLAB’s search path. The user first selects “Interactive Mode” or “Automatic Mode”. Any time a new batch of images with different threshold settings or <italic>x</italic>-<italic>y</italic>-<italic>z</italic> scales are being processed, it is necessary to run the program in Interactive Mode. The user inputs the file of interest, its <italic>x</italic>, <italic>y</italic>, and <italic>z</italic> scale, the number of channels included in the image, and the channel of interest (<xref ref-type="fig" rid="F1">Fig. 1A</xref>). Either .tiff or .lsm files are accepted. The user then adjusts threshold and size cutoff values (as discussed in detail below; <xref ref-type="fig" rid="F1">Fig. 1<italic>B</italic>–<italic>D</italic></xref>). Finally, a folder is created to store figures, and an Excel file of results is saved (<xref ref-type="fig" rid="F1">Fig. 1<italic>E</italic></xref>). Output values include data obtained before small object removal (average centroid distance between cells, total territorial volume, uncovered volume, percentage covered volume), and from individual full cells (cell and territorial volumes, ramification index, number of endpoints and branch points, and average, minimum, and maximum branch lengths). If the user selects the option, a separate Excel file containing a list of all branch lengths can be generated for each cell. Once an Interactive Mode analysis is complete, a parameter file will be created to save relevant input values. This can then be used to batch process a group of files using the same values and settings.</p>
      <fig id="F1" fig-type="figure" orientation="portrait" position="float">
        <label>Figure 1</label>
        <caption>
          <p>3DMorph workflow. The user selects either Interactive or Automatic mode. Interactive mode must be used first to generate a parameters file. <bold><italic>A</italic></bold>, The user then selects the file to analyze, and specifies <italic>x</italic>, <italic>y</italic>, and <italic>z</italic> scale, number of channels, and the channel of interest. Both .tiff and .lsm files are supported. The original image (<bold><italic>B</italic></bold>) is loaded and 3D connected components (<bold><italic>C</italic></bold>) are automatically detected. <bold><italic>D</italic></bold>, Large cells can be selected for segmentation and small objects can be removed. <bold><italic>E</italic></bold>, After skeletonization and measurements of remaining cells, 3DMorph saves selected images and generates an Excel results file. Gray text indicates automatic steps.
</p>
        </caption>
        <graphic xlink:href="enu0061827910001"/>
      </fig>
    </sec>
    <sec id="s3I">
      <title>Threshold images</title>
      <p>Images saved as .lsm or .tiff files (<xref ref-type="fig" rid="F2">Fig. 2<italic>A</italic></xref>) are opened using the bfopen, or imread functions, respectively. A threshold value, based on Otsu method (<xref rid="B23" ref-type="bibr">Otsu, 1979</xref>) is then set. A new window will appear (<xref ref-type="fig" rid="F2">Fig. 2<italic>B</italic></xref>), showing the middle image of the <italic>z</italic>-stack, which can be used for a reference in deciding threshold values. A slider on the left sets the threshold level, and an automatically updated image shows the results of selected threshold values. The purpose of this step is to select a threshold level that accurately separates the small processes from background signal. Once an appropriate level is chosen, the “Try this…” button passes the threshold adjustment value to the noise filter. Again, a slider on the left can be adjusted to decide the minimum size of objects that should be considered noise. This filter functions in 3D, so if a process is removed here, it was likely separated from the cell in the thresholding step. Small cells and processes will be excluded in a later step (<xref ref-type="fig" rid="F2">Fig. 2<italic>E</italic></xref>), so it is not necessary to exclude them as noise here; they contribute to the calculation of total occupied brain volume. If selected, a threshold output image (<xref ref-type="fig" rid="F2">Fig. 2<italic>C</italic></xref>) can be generated, which is a projection of the thresholded <italic>z</italic>-stack, where the thicker portions of cells (such as somas) are displayed in yellow and thinner portions are in blue. This color coding is only used to visualize the approximate 3D shape of cells in a 2D image, and can be helpful to ensure the selected threshold value is correctly separating the cell from background signal.</p>
      <fig id="F2" fig-type="figure" orientation="portrait" position="float">
        <label>Figure 2</label>
        <caption>
          <p>Select threshold and identify cells. <bold><italic>A</italic></bold>, Grayscale maximum projection of original stack. Scale bar, 25 µm. <bold><italic>B</italic></bold>, Select threshold level, and noise filter value to remove small spots. <bold><italic>C</italic></bold>, “Output Threshold Image” is a 2D projection after threshold and noise filters are applied. To visualize 3D shapes of cells, hotter colors indicate thicker portions of cells. <bold><italic>D</italic></bold>, 3DMorph automatically identifies 3D connected components, and the user selects a maximum cell size. Objects larger than this value are considered to be erroneously connected cells (<italic>d</italic>′, <italic>d</italic>‴), and will be segmented into separate objects (<italic>d‴</italic>). <bold><italic>E</italic></bold>, Exclude remaining small cells, out-of-focus processes, or cells touching the <italic>x</italic>-<italic>y</italic> borders to isolate only full cells (<bold><italic>F</italic></bold>). <bold><italic>G</italic></bold>, At this point, the program records total occupied volume (calculated before excluding small cells, processes, etc.), the unoccupied volume, and the distance between cell centroids.</p>
        </caption>
        <graphic xlink:href="enu0061827910002"/>
      </fig>
    </sec>
    <sec id="s3J">
      <title>Identify and segment cells</title>
      <p>The resulting thresholded image is separated into objects based on their 3D connectivity. To segment erroneously connected cells, identify the largest cell that is not two cells connected (<xref ref-type="fig" rid="F2">Fig. 2<italic>D</italic></xref>). Any object above this threshold (<xref ref-type="fig" rid="F2">Fig. 2<italic>d</italic>′,<italic>d</italic>″</xref>) is automatically segmented by fitting a Gaussian mixture distribution (MATLAB function fitgmdist) to the data (<xref ref-type="fig" rid="F2">Fig. 2<italic>d</italic>‴</xref>).</p>
    </sec>
    <sec id="s3K">
      <title>Total territorial area of microglia</title>
      <p>As microglia are highly ramified cells, the volume of brain they survey is greater than the volume of the cell itself. To estimate total territorial volume of microglia, a polygon is created to surround the outside points of each cell, and its volume is measured. All small cells and processes from above or below the image are included here. The amount of unoccupied volume and percentage of volume covered is also determined.</p>
    </sec>
    <sec id="s3L">
      <title>Identify full cells</title>
      <p>To get accurate volume and branching data of individual microglia, it is important to eliminate cells that are partially excluded from the image. The user selects the smallest full cell (any smaller objects are removed from further processing), and indicates whether cells touching the <italic>x</italic>-<italic>y</italic> border should be removed (<xref ref-type="fig" rid="F2">Fig. 2<italic>E</italic></xref>). From the remaining cells (<xref ref-type="fig" rid="F2">Fig. 2<italic>F</italic></xref>), cell volumes and territorial volumes (<xref ref-type="fig" rid="F3">Fig. 3<italic>A</italic></xref>) are recorded. Cell volume is calculated by converting the number of voxels in each object to a real-world unit based on the specified scaling factors. Cell ramification index (or extent) is calculated by territorial volume divided by cell volume. This is a measure of how ramified or amoeboid the cells are. For instance, a small ramified cell and a bushy cell may have a similar cell volume, but the bushy cell will occupy more of its territorial space, therefore the ramification index measure will be smaller.</p>
      <fig id="F3" fig-type="figure" orientation="portrait" position="float">
        <label>Figure 3</label>
        <caption>
          <p>Analysis of individual full cells. <bold><italic>A</italic></bold>, Territorial volume of each cell is determined by placing a polygon around all of the extreme points of the cell. <bold><italic>B</italic></bold>, The user decides which skeletonization method to use and which images to save (including: original cell, skeleton, branch points, and end points). Each full cell (<bold><italic>C</italic></bold>) is then processed individually to generate a 3D skeleton, keeping either all branches (<bold><italic>D</italic></bold>), or only major branches (<bold><italic>E</italic></bold>). In skeleton figures, colors indicate order of connectivity (red = primary, yellow = secondary, green = tertiary, and blue = connected to endpoint). <bold><italic>F</italic></bold>, After processing all cells, the program outputs territorial volume, cell volume, ramification index (calculated as territorial volume/cell volume), number of endpoints and branch points, as well as average, maximum, and minimum branch length for each cell. A complete list of branch lengths for each cell can also be generated.</p>
        </caption>
        <graphic xlink:href="enu0061827910003"/>
      </fig>
    </sec>
    <sec id="s3M">
      <title>Distance between cell centroids</title>
      <p>Distribution of cells is addressed by measuring the average distance between centroids. Accurate centroids (unbiased by the “weight” of processes), are determined by eroding the cell to leave only the soma. These coordinates are converted to the unit of interest by multiplying the specified scales, and the distance between them is calculated. The average centroid distance is saved to the final results file.</p>
    </sec>
    <sec id="s3N">
      <title>3D skeletonization and branch tracing</title>
      <p>To calculate branch lengths, endpoints, and branch points, a 3D skeleton of each cell is first generated. In 3DMorph, two skeletonization methods are available (<xref ref-type="fig" rid="F3">Fig. 3<italic>B</italic></xref>). The first keeps all small processes (<xref ref-type="fig" rid="F3">Fig. 3<italic>D</italic></xref>). This is ideal for images taken at a high magnification or to investigate differences in small filipodia-like structures. However, this method is also much slower and computationally demanding. This method is accomplished using the Skeleton3D method, developed by <xref rid="B17" ref-type="bibr">Kerschnitzki et al. (2013)</xref>, and is available on File Exchange (<ext-link ext-link-type="uri" xlink:href="https://www.mathworks.com/matlabcentral/fileexchange/43400-skeleton3d">https://www.mathworks.com/matlabcentral/fileexchange/43400-skeleton3d</ext-link>). Small extensions remaining on the skeleton, which are not likely to be true processes, are removed using the Graph2Skel3D and Skel2Graph3D (<ext-link ext-link-type="uri" xlink:href="https://www.mathworks.com/matlabcentral/fileexchange/43527-skel2graph-3d">https://www.mathworks.com/matlabcentral/fileexchange/43527-skel2graph-3d</ext-link>).</p>
      <p>The second skeleton method looks only at large branches and ignores smaller structures (<xref ref-type="fig" rid="F3">Fig. 3<italic>E</italic></xref>). This method might be preferred in images with a lower magnification and with several cells per image. It processes the skeleton using the Accurate Fast Marching method (available from the authors: <ext-link ext-link-type="uri" xlink:href="https://www.mathworks.com/matlabcentral/fileexchange/24531-accurate-fast-marching">https://www.mathworks.com/matlabcentral/fileexchange/24531-accurate-fast-marching</ext-link>).</p>
      <p>Within each skeleton, endpoints are identified as pixels attached to only one other pixel. For each endpoint, a path between the endpoint and the centroid of the cell is traced to create a mask of each branch, from which the length is measured. This method may give a longer average branch length than other methods, as each end is traced to the soma, rather than to the nearest branch point. However, this method is more sensitive to differences in highly ramified versus bushy or amoeboid cells.</p>
      <p>By adding the masks of all branches, a color code is generated with primary branches in red as those that have been traced four or more times, secondary branches in yellow have been traced three times, tertiary in green have been traced twice, and quaternary in blue have been traced only once (most distal process, which terminate in an endpoint). From this process mask, the number of branch points are calculated by determining points of intersection between primary, secondary, tertiary, or quaternary branches.</p>
      <p>If requested, a new folder is generated in the Current Folder titled as “<italic>filename</italic>_figures” to save specified images and branch lengths. 3D representations of original cells (<xref ref-type="fig" rid="F3">Fig. 3<italic>C</italic></xref>), endpoints, branch points, and skeletons (<xref ref-type="fig" rid="F3">Fig. 3<italic>D</italic>,<italic>E</italic></xref>) can be saved. Images of initial thresholding, identified objects, segmented objects, and full cells will also be saved to this folder if the user chooses to have them generated.</p>
    </sec>
    <sec id="s3O">
      <title>Export data</title>
      <p>Finally, the data are written to an Excel file titled “Results<italic>filename</italic>” and saved to MATLAB’s Current Folder. For each image, the exported data includes: average centroid distances, total microglial territory volume, total unoccupied volume, and percentage of volume occupied. For each full cell: territory volume, cell volume, ramification index, number of endpoints and branch points, and average, minimum, and maximum branch lengths are saved.</p>
    </sec>
    <sec id="s3P">
      <title>Statistics</title>
      <p>All data were analyzed using a one-way ANOVA with a significance level of <italic>p</italic> &lt; 0.05.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="s4">
    <title>Results</title>
    <sec id="s4A">
      <title>Accuracy of 3DMorph results</title>
      <p>To validate our 3DMorph program, we generated a test image to process and compare with current analysis methods (<xref ref-type="fig" rid="F4">Fig. 4<italic>A</italic>,<italic>B</italic></xref>). The image size is 512 × 512 pixels with 100 slices (0.21 µm/pixel, and 1 µm/slice). We analyzed this image in 3DMorph (<xref ref-type="fig" rid="F4">Fig. 4<italic>C</italic>–<italic>E</italic></xref>), as well as with the 3D-tracing ImageJ plugin, Simple Neurite Tracer (<xref ref-type="fig" rid="F4">Fig. 4<italic>F</italic></xref>), and by freehand tracing of a maximum intensity <italic>z</italic>-projection image (<xref ref-type="fig" rid="F4">Fig. 4<italic>G</italic></xref>). Features of each method are summarized in <xref rid="T1" ref-type="table">Table 1</xref>.</p>
      <fig id="F4" fig-type="figure" orientation="portrait" position="float">
        <label>Figure 4</label>
        <caption>
          <p>Validation and comparison of 3DMorph with current analysis tools. <bold><italic>A</italic></bold>, 3D visualization of a manually-generated test image composed of four cells with overlapping processes. <bold><italic>B</italic></bold>, <italic>Z</italic>-projection of test image. Scale bar, 25 µm. <bold><italic>C</italic></bold>, Full cells as identified by 3DMorph. <bold><italic>D</italic></bold>, A single full cell from the test image (outlined by dashed box in <bold><italic>C</italic></bold>). <bold><italic>E</italic></bold>, 3D skeleton generated automatically by 3DMorph. <bold><italic>F</italic></bold>, 3D skeleton manually drawn using Simple Neurite Tracer (SNT). <bold><italic>G</italic></bold>, 2D skeleton manually drawn using freehand tracing of a <italic>z</italic>-projection of the test image. Based on analysis by 3DMorph, SNT, or z-projection tracing, there is no significant difference in the number of endpoints (<bold><italic>H</italic></bold>) or branch points (<bold><italic>I</italic></bold>) recorded. <bold><italic>J</italic></bold>, Cell volume measurements are accurate between 3DMorph and SNT, but unavailable from <italic>z</italic>-projection analysis. <bold><italic>K</italic></bold>, Maximum branch length is significantly longer by 3DMorph and SNT analysis than by <italic>z</italic>-projection tracing. <bold><italic>L</italic></bold>, Average branch lengths are significantly longer by 3DMorph than by SNT or <italic>z</italic>-projection. <bold><italic>M</italic></bold>, Comparison of user input time to measure data. Error bars indicate mean ± SEM. *<italic>p</italic> &lt; 0.05, **<italic>p</italic> &lt; 0.01, ***<italic>p</italic> &lt; 0.001 by one-way ANOVA.</p>
        </caption>
        <graphic xlink:href="enu0061827910004"/>
      </fig>
      <table-wrap id="T1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <p>3DMorph, Simple neurite tracer ImageJ plugin, and freehand tracing of maximum z-projection images</p>
        </caption>
        <table frame="hsides" rules="none">
          <colgroup span="1">
            <col align="left" valign="top" span="1"/>
            <col align="left" valign="top" span="1"/>
            <col align="left" valign="top" span="1"/>
            <col align="left" valign="top" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="left" rowspan="1" colspan="1">
                <bold>3DMorph</bold>
              </th>
              <th align="left" rowspan="1" colspan="1">
                <bold>Simple Neurite tracer</bold>
              </th>
              <th align="left" rowspan="1" colspan="1">
                <bold><italic>Z</italic>-projection trace</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td rowspan="1" colspan="1">
                <bold>Branch length</bold>
              </td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>Cell volume</bold>
              </td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✘</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>Territorial volume</bold>
              </td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">×</td>
              <td rowspan="1" colspan="1">✘</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>Total occupied Volume</bold>
              </td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">×</td>
              <td rowspan="1" colspan="1">✘</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>Ramification Index</bold>
              </td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">×</td>
              <td rowspan="1" colspan="1">✘</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>No. of endpoints</bold>
              </td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>No. of branch points</bold>
              </td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>3D analysis</bold>
              </td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">×</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>Automatic batch Processing</bold>
              </td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✘</td>
              <td rowspan="1" colspan="1">×</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>User input time</bold>
              </td>
              <td rowspan="1" colspan="1">Fastest (min)</td>
              <td rowspan="1" colspan="1">Slowest (min–h)</td>
              <td rowspan="1" colspan="1">Intermediate (10s of min)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="TF1">
            <p>Although both 3DMorph and simple neurite tracer process 3D information, only 3DMorph offers an automatic batch processing mode to greatly decrease user input time.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>When comparing these techniques, there was no significant difference in the number of endpoints or branch points identified (<xref ref-type="fig" rid="F4">Fig. 4<italic>H</italic>,<italic>I</italic></xref>). However, process overlap in <italic>z</italic>-projected images led to greater uncertainty in separating branches of individual cells. Cell volumes were similar between 3DMorph and Simple Neurite Tracer (<xref ref-type="fig" rid="F4">Fig. 4<italic>J</italic></xref>), but are unavailable from <italic>z</italic>-projected data.</p>
      <p>Maximum and average branch lengths were significantly greater when processed by 3DMorph compared to <italic>z</italic>-projected images (<xref ref-type="fig" rid="F4">Fig. 4<italic>K</italic>,<italic>L</italic></xref>), confirming the importance of maintaining 3D information. While Simple Neurite Tracer does analyze length in 3D, we found that these values are lower than our 3DMorph analysis. This is likely because 3DMorph measures the length of each endpoint to the soma centroid instead of the distance between an endpoint and its parent branch.</p>
    </sec>
    <sec id="s4B">
      <title>Processing time of 3DMorph</title>
      <p>In addition to providing similar or more accurate measurements, 3DMorph also took considerably less time for the same investigator to complete the analysis of the test image (1 min, 12 s) compared to Simple Neurite Tracer (59 min, 3 s) or <italic>z</italic>-projection tracing (23 min, 35 s; <xref ref-type="fig" rid="F4">Fig. 4<italic>M</italic></xref>). Although times were measured using Interactive Mode processing on one image, 3DMorph’s Automatic Mode processing would be even more advantageous.</p>
      <p>Finally, although both Simple Neurite Tracer and <italic>z</italic>-projections require subjective branch tracing, 3DMorph completes these steps automatically. Therefore, variability between researchers will be greatly decreased, while improving data reproducibility among researchers and between labs.</p>
    </sec>
    <sec id="s4C">
      <title>Microglial morphology changes in response to local cues</title>
      <p>We next used 3DMorph to compare conditions which cause or mimic an increase or decrease in neuronal activity. As previously published (<xref rid="B4" ref-type="bibr">Dissing-Olesen et al., 2014</xref>), application of ATP triggers microglial process outgrowth, whereas processes retract in the presence of CNQX and TTX (<xref rid="B11" ref-type="bibr">Fontainhas et al., 2011</xref>). Although the biological pathways leading to these changes are interesting, here we do not address the biological cause of the process extensions or retractions. Instead we use these pharmacological manipulations only as tools to alter microglial morphology.</p>
      <p>Acute hippocampal slices from CX3CR1<sup>EGFP/+</sup> mice were incubated with either control aCSF (<xref ref-type="fig" rid="F5">Fig. 5 <italic>A</italic>,<italic>B</italic></xref>), 500 µM ATP (<xref ref-type="fig" rid="F5">Fig. 5 <italic>C</italic>,<italic>D</italic></xref>), or 50 µM CNQX with 1 µM TTX (<xref ref-type="fig" rid="F5">Fig. 5 <italic>E</italic>,<italic>F</italic></xref>) at 32°C. Slices were fixed using the SNAPSHOT protocol (<xref rid="B5" ref-type="bibr">Dissing-Olesen and MacVicar, 2015</xref>) and imaged by two-photon microscopy. A 1024 × 1024 image with 50 <italic>z</italic>-slices was acquired (<italic>x</italic>-<italic>y</italic> scale: 0.17 µm/pixel; <italic>z</italic> scale: 1 µm/slice; image dimensions, 174.08 × 174.08 × 50 µm). The same parameter file was used to automatically process images from these three conditions, removing any risk of experimenter bias.</p>
      <fig id="F5" fig-type="figure" orientation="portrait" position="float">
        <label>Figure 5</label>
        <caption>
          <p>Microglia morphology changes in response to local cues. Microglia are incubated with control aCSF (<bold><italic>A</italic></bold>, <bold><italic>B</italic></bold>), 500 µM ATP (<bold><italic>C</italic></bold>, <bold><italic>D</italic></bold>), or 50 µM CNQX and 1 µM TTX (<bold><italic>E</italic></bold>, <bold><italic>F</italic></bold>) before fixing and imaging (imaging dimensions: 174.08 × 174.08 × 50 µm). Original 3D projections (<bold><italic>A</italic></bold>, <bold><italic>C</italic></bold>, <bold><italic>E</italic></bold>; scale bar, 25 µm), and remaining full cells (<bold><italic>B</italic></bold>, <bold><italic>D</italic></bold>, <bold><italic>F</italic></bold>), are shown. <bold><italic>G</italic></bold>, Quantification confirms that microglia cover more volume in ATP than in control conditions, while CNQX/TTX treatment decreases the total surveyed volume. When only full cells are considered, each microglial cell in CNQX/TTX conditions covers a smaller territorial volume (<bold><italic>H</italic></bold>) and has shorter average branch lengths (<bold><italic>I</italic></bold>) than control or ATP conditions, whereas ATP cells have significantly longer branch lengths than control. Error bars represent mean ± SEM. *<italic>p</italic> &lt; 0.05, **<italic>p</italic> &lt; 0.01, ***<italic>p</italic> &lt; 0.001, ****<italic>p</italic> &lt; 0.0001 by one-way ANOVA.</p>
        </caption>
        <graphic xlink:href="enu0061827910005"/>
      </fig>
      <p>3DMorph analysis revealed a significant increase in the percentage of brain volume surveyed by microglia in ATP conditions, whereas CNQX/TTX treatment decreased relative to control (<xref ref-type="fig" rid="F5">Fig. 5<italic>G</italic></xref>). When single cells were analyzed, the territorial volume of each cell treated with CNQX/TTX was significantly smaller than in control aCSF (<xref ref-type="fig" rid="F5">Fig. 5<italic>H</italic></xref>), whereas ATP induced a small increase. Finally, 3DMorph quantification confirmed that there is a significant increase in branch length of ATP-treated microglia, whereas CNQX/TTX-treated microglia have significantly shorter branches (<xref ref-type="fig" rid="F5">Fig. 5<italic>I</italic></xref>). These results demonstrate the ability of 3DMorph to automatically quantify morphologic changes of microglia <italic>in situ</italic> across different conditions in an automatic, unbiased, and reproducible manner.</p>
    </sec>
    <sec id="s4D">
      <title>Microglial morphology <italic>in vivo</italic>
</title>
      <p>Although <italic>in situ</italic> imaging has many advantages, there is a growing push in the scientific field to confirm results using <italic>in vivo</italic> experiments. As 3DMorph requires only one channel containing the microglia image, and does not rely on counterstaining, it is possible to process microglia images from <italic>in vivo</italic> data.</p>
      <p>We confirm this by processing microglia images of CX3CR1<sup>EGFP/EGFP</sup> mice acquired through a cranial window on an <italic>in vivo</italic> two-photon microscope (<xref ref-type="fig" rid="F6">Fig. 6<italic>A</italic></xref>). Image stacks were taken at 512 × 512 with 40 slices at an interval distance of 1 µm. 3DMorph analysis accurately thresholded (<xref ref-type="fig" rid="F6">Fig. 6<italic>B</italic></xref>), segmented (<xref ref-type="fig" rid="F6">Fig. 6<italic>C</italic></xref>), and skeletonized (<xref ref-type="fig" rid="F6">Fig. 6<italic>D</italic>–<italic>G</italic></xref>) these images, confirming that 3DMorph is appropriate for analyzing <italic>in vivo</italic> microglial morphology.</p>
      <fig id="F6" fig-type="figure" orientation="portrait" position="float">
        <label>Figure 6</label>
        <caption>
          <p>Morphology analysis of <italic>in vivo</italic> microglia images. <bold><italic>A</italic></bold>, Maximum projection of <italic>in vivo</italic> image stack. <bold><italic>B</italic></bold>, 3DMorph threshold image shown as a maximum projection. <bold><italic>C</italic></bold>, Separation of thresholded image into individual objects, color-coded based on size of object. <bold><italic>D</italic></bold>, Remaining full cells after removing small processes from out-of-frame cells. E, Isolated single cell from outlined region in <bold><italic>D</italic></bold>. <bold><italic>F</italic></bold>, Skeleton of major branches and (<bold><italic>G</italic></bold>) skeleton maintaining fine processes.</p>
        </caption>
        <graphic xlink:href="enu0061827910006"/>
      </fig>
    </sec>
    <sec id="s4E">
      <title>Morphology of neurons</title>
      <p>A benefit of 3DMorph’s Interactive Mode is that the software is adaptable to work with many types of input data. This makes it possible to process other types of branched cells in addition to microglia, such as neurons, astrocytes, or oligodendrocyte precursor cells. We validate 3DMorph’s performance in processing a patched and dye-loaded neuron (<xref ref-type="fig" rid="F7">Fig. 7<italic>A</italic></xref>). 3DMorph accurately identifies and maintains only the neuron (<xref ref-type="fig" rid="F7">Fig. 7<italic>B</italic></xref>), and skeletonizes the processes (<xref ref-type="fig" rid="F7">Fig. 7<italic>C</italic></xref>). Given the size difference between microglia and neurons, we therefore validate that 3DMorph correctly processes images of branched cells other than microglia.</p>
      <fig id="F7" fig-type="figure" orientation="portrait" position="float">
        <label>Figure 7</label>
        <caption>
          <p>Morphology analysis of dye-loaded neuron. <bold><italic>A</italic></bold>, Maximum projection of dye-loaded neuron. Scale bar, 50 µm. <bold><italic>B</italic></bold>, Remaining cell following 3DMorph thresholding. <bold><italic>C</italic></bold>, Skeletonized neuron keeping fine processes.</p>
        </caption>
        <graphic xlink:href="enu0061827910007"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s5">
    <title>Discussion</title>
    <p>Here, we present a novel method that allows for rapid and unbiased analysis of microglial morphologies in 3D. This is an open source script running in MATLAB, which is widely available through academic institutions, making 3DMorph free and easily accessible. We have written the program to make it user-friendly and compatible with many imaging settings. Furthermore, the program is well suited for analysis of other branched cells, such as astrocytes or oligodendrocyte precursor cells, in addition to microglia and neurons.</p>
    <p>This program is an advancement to the currently available methods, as it relies on minimal user input, making it fast, replicable between experimenters and labs, and not subject to bias. Once parameters have been chosen, Automatic Mode processes large amounts of data with minimal input time. Importantly, using 3DMorph maintains the 3D information of cells, providing more accurate volume and branch length measurements.</p>
    <p>We have validated 3DMorph against two other analysis techniques (Simple Neurite Tracer, and <italic>z</italic>-projection tracing), and detected alterations in microglial morphology, e.g., hyper-ramification triggered by ATP and hypo-ramification triggered by CNQX. Importantly, 3DMorph is compatible with images obtained <italic>in vivo</italic> and images of other branching cell types.</p>
    <p>Another automatic 3D microglial analysis program has recently been published (<xref rid="B13" ref-type="bibr">Heindl et al., 2018</xref>). Although this is a powerful program offering a range of output results, our 3DMorph program offers some key advantages. Most importantly, it does not require a DAPI input image, which removes the necessity for immunostaining and makes 3DMorph capable of handling <italic>in vivo</italic> data. Furthermore, 3DMorph can process .tiff files, which allows the processing of images acquired by multiple types of software. We have also shown here that 3DMorph can manage thick sections of tissue and reliably separate cells that may appear overlapped when <italic>z</italic>-projected. Finally, although a completely automated analysis is available in 3DMorph, we first implement a series of graphical user interfaces that show real-time updates of how chosen settings will process the data. This transparency allows the user to confirm that the program is correctly processing their data.</p>
    <p>Another promising analysis tool, ProMoIJ (<xref rid="B24" ref-type="bibr">Paris et al., 2018</xref>), has been recently published, which looks at microglial process motility. Although this method is excellent at analyzing tip extension and retraction, it does not analyze morphology differences of whole-cell images. Microglial morphology provides a clue to the cell’s biological function. Therefore, shape measurements (i.e., branch length and estimations of extent) are often used to differentiate healthy microglia from those associated with disease (<xref rid="B20" ref-type="bibr">Kreutzberg, 1996</xref>; <xref rid="B25" ref-type="bibr">Perego et al., 2013</xref>; <xref rid="B1" ref-type="bibr">Baron et al., 2014</xref>; <xref rid="B6" ref-type="bibr">Doorn et al., 2014</xref>; <xref rid="B28" ref-type="bibr">Torres-Platas et al., 2014</xref>). We encourage the field to use our 3DMorph program to perform their morphologic quantifications, and we gladly supply the original code (<ext-link ext-link-type="uri" xlink:href="https://github.com/ElisaYork/3DMorph">https://github.com/ElisaYork/3DMorph</ext-link>) so that it can be adapted and improved on by laboratories to best meet their needs.</p>
    <sec id="s5A">
      <title>Troubleshooting</title>
      <p>Although we have tried to make this program robust, user-friendly, and adaptable, it is possible issues may still occur. We have compiled this list of possible errors to assist with troubleshooting.</p>
    </sec>
    <sec id="s5B">
      <title>Errors when running the script</title>
      <p>1. Mex file error, or all output data for full cells is “0”:At the skeletonization step, if the script encounters an error, it will output zeros for this cell and move on to the next cell in the file. If all cells encountered an error, it is likely a mex compiling issue. Some skeletonization functions need to be compiled from C to MATLAB. In the original folder, go to: Functions&gt;FastMarching_version3b&gt;compile_c_files. You will need a compatible compiler to run this. If you do not have one, MATLAB will provide instructions on installing one.</p>
      <p>2. ThresholdGUI:If you would like to keep the threshold and noise levels set to 0, please increase them, then move them back to 0. Be sure to confirm your adjusted values by pressing the “Try This” and “Update” buttons.</p>
      <p>3. numObjMg = numel(FullMg):If you only have one cell in your image, you must choose to keep it during small cell removal by selecting the “Keep all cells” option. If this is not selected, your cell will be removed and pass on a blank image to the next processing step.</p>
      <p>4. “waitbar” error:The program automatically generates waitbars to update you on how long it will take to process each step. It may reach an error if you have closed the waitbar window before it is finished processing.</p>
      <p>5. GMModel: nuc must be a positive integer:During segmentation, the program erodes the connected cells to find nuclei and determine how many cells the object should be segmented into. If cells or nuclei are small (as in low magnifications), they may be eroded completely and a blank image will be passed on. In the first for loop of the Cell Segmentation portion of the script, decrease the value of se=strel(“diamond”,4); This will decrease the amount of erosion.</p>
    </sec>
    <sec id="s5C">
      <title>Unsatisfactory data processing</title>
      <p>
        <list list-type="order">
          <list-item>
            <p>3DMorph works best on images with high signal-to-noise ratio. During the image acquisition stage, try using a high magnification of the cells you would like to analyze and decrease the <italic>z</italic>-slice interval so that branches remain connected in this dimension. If available, deconvolution post-processing may be helpful. It may also help to remove background before processing. This can be done with Fiji’s rolling ball radius subtraction.</p>
          </list-item>
          <list-item>
            <p>If there is too much connectivity, the program will have trouble segmenting properly. Try increasing the threshold level so that fewer branches remain touching in the binary image.</p>
          </list-item>
          <list-item>
            <p>If you observe too much connectivity that cannot be fixed by increasing threshold levels, try using a spatial sampling of 0.166 µm/pixel, for example a 1024 × 1024 pixel image with a size of 170 × 170 µm. Your input images can be scaled in ImageJ prior to analysis to match this pixel density. See ImageJ, Image menu scale function.</p>
          </list-item>
          <list-item>
            <p>When batch processing images, it is beneficial to spend time finding parameters that work well for all files. Test a few example images in Interactive Mode to determine which settings are best. To save time, you can run the program until you have chosen a threshold, and large and small cell limit, then exit before it begins measuring skeletons. Once you have chosen suitable parameters, you will need to let the program run fully to generate a Parameters output file to use in your batch processing.</p>
          </list-item>
          <list-item>
            <p>For accurate total image coverage, keep a low noise level so that small processes are still included. Small cells and processes from out-of-frame cells can be removed at a later step.</p>
          </list-item>
        </list>
      </p>
      <supplementary-material content-type="local-data" id="suppl1">
        <object-id pub-id-type="doi">10.1523/ENEURO.0266-18.2018.ed1</object-id>
        <label>Supplementary 1</label>
        <p>Supplementary 3DMorph. Download <inline-supplementary-material id="ed1" mime-subtype="plain" mimetype="text" xlink:href="sup_enu-eN-MNT-0266-18-s01.txt" content-type="local-data">Supplementary 1, TXT file</inline-supplementary-material></p>
      </supplementary-material>
    </sec>
  </sec>
</body>
<back>
  <ref-list content-type="nameDate">
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><string-name><surname>Baron</surname><given-names>R</given-names></string-name>, <string-name><surname>Babcock</surname><given-names>AA</given-names></string-name>, <string-name><surname>Nemirovsky</surname><given-names>A</given-names></string-name>, <string-name><surname>Finsen</surname><given-names>B</given-names></string-name>, <string-name><surname>Monsonego</surname><given-names>A</given-names></string-name> (<year>2014</year>) <article-title>Accelerated microglial pathology is associated with Aβ plaques in mouse models of Alzheimer’s disease</article-title>. <source>Aging Cell</source>
<volume>13</volume>:<fpage>584</fpage>–<lpage>595</lpage>. <pub-id pub-id-type="doi">10.1111/acel.12210</pub-id><pub-id pub-id-type="pmid">24641683</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><string-name><surname>Davalos</surname><given-names>D</given-names></string-name>, <string-name><surname>Grutzendler</surname><given-names>J</given-names></string-name>, <string-name><surname>Yang</surname><given-names>G</given-names></string-name>, <string-name><surname>Kim</surname><given-names>JV</given-names></string-name>, <string-name><surname>Zuo</surname><given-names>Y</given-names></string-name>, <string-name><surname>Jung</surname><given-names>S</given-names></string-name>, <string-name><surname>Littman</surname><given-names>DR</given-names></string-name>, <string-name><surname>Dustin</surname><given-names>ML</given-names></string-name>, <string-name><surname>Gan</surname><given-names>WB</given-names></string-name> (<year>2005</year>) <article-title>ATP mediates rapid microglial response to local brain injury <italic>in vivo</italic>
</article-title>. <source>Nat Neurosci</source>
<volume>8</volume>:<fpage>752</fpage>–<lpage>758</lpage>. <pub-id pub-id-type="doi">10.1038/nn1472</pub-id><pub-id pub-id-type="pmid">15895084</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><string-name><surname>Davis</surname><given-names>EJ</given-names></string-name>, <string-name><surname>Foster</surname><given-names>TD</given-names></string-name>, <string-name><surname>Thomas</surname><given-names>WE</given-names></string-name> (<year>1994</year>) <article-title>Cellular forms and functions of brain microglia</article-title>. <source>Brain Res Bull</source>
<volume>34</volume>:<fpage>73</fpage>–<lpage>78</lpage>. <pub-id pub-id-type="doi">10.1016/0361-9230(94)90189-9</pub-id><pub-id pub-id-type="pmid">8193937</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><string-name><surname>Dissing-Olesen</surname><given-names>L</given-names></string-name>, <string-name><surname>LeDue</surname><given-names>JM</given-names></string-name>, <string-name><surname>Rungta</surname><given-names>RL</given-names></string-name>, <string-name><surname>Hefendehl</surname><given-names>JK</given-names></string-name>, <string-name><surname>Choi</surname><given-names>HB</given-names></string-name>, <string-name><surname>MacVicar</surname><given-names>BA</given-names></string-name> (<year>2014</year>) <article-title>Activation of neuronal NMDA receptors triggers transient ATP-mediated microglial process outgrowth</article-title>. <source>J Neurosci</source>
<volume>34</volume>:<fpage>10511</fpage>–<lpage>10527</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.0405-14.2014</pub-id><pub-id pub-id-type="pmid">25100586</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><string-name><surname>Dissing-Olesen</surname><given-names>L</given-names></string-name>, <string-name><surname>MacVicar</surname><given-names>BA</given-names></string-name> (<year>2015</year>) <article-title>Fixation and immunolabeling of brain slices: SNAPSHOT method</article-title>. <source>Curr Protoc Neuroscie</source>
<volume>71</volume>:<fpage>1.23.1</fpage>–<lpage>1.23.12</lpage>. <pub-id pub-id-type="doi">10.1002/0471142301.ns0123s71</pub-id>
<?supplied-pmid 25829354?><pub-id pub-id-type="pmid">25829354</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><string-name><surname>Doorn</surname><given-names>KJ</given-names></string-name>, <string-name><surname>Goudriaan</surname><given-names>A</given-names></string-name>, <string-name><surname>Blits-Huizinga</surname><given-names>C</given-names></string-name>, <string-name><surname>Bol</surname><given-names>JGJM</given-names></string-name>, <string-name><surname>Rozemuller</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Hoogland</surname><given-names>PV</given-names></string-name>, <string-name><surname>Lucassen</surname><given-names>PJ</given-names></string-name>, <string-name><surname>Drukarch</surname><given-names>B</given-names></string-name>, <string-name><surname>van de Berg</surname><given-names>WD</given-names></string-name>, <string-name><surname>Van Dam</surname><given-names>AM</given-names></string-name> (<year>2014</year>) <article-title>Increased amoeboid microglial density in the olfactory bulb of Parkinson’s and Alzheimer’s patients</article-title>. <source>Brain Pathol</source>
<volume>24</volume>:<fpage>152</fpage>–<lpage>165</lpage>. <pub-id pub-id-type="doi">10.1111/bpa.12088</pub-id><pub-id pub-id-type="pmid">24033473</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><string-name><surname>Drew</surname><given-names>PJ</given-names></string-name>, <string-name><surname>Shih</surname><given-names>AY</given-names></string-name>, <string-name><surname>Driscoll</surname><given-names>JD</given-names></string-name>, <string-name><surname>Knutsen</surname><given-names>PM</given-names></string-name>, <string-name><surname>Blinder</surname><given-names>P</given-names></string-name>, <string-name><surname>Davalos</surname><given-names>D</given-names></string-name>, <string-name><surname>Akassoglou</surname><given-names>K</given-names></string-name>, <string-name><surname>Tsai</surname><given-names>PS</given-names></string-name>, <string-name><surname>Kleinfeld</surname><given-names>D</given-names></string-name> (<year>2010</year>) <article-title>Chronic optical access through a polished and reinforced thinned skull</article-title>. <source>Nat Methods</source>
<volume>7</volume>:<fpage>981</fpage>–<lpage>984</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.1530</pub-id><pub-id pub-id-type="pmid">20966916</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><string-name><surname>Erny</surname><given-names>D</given-names></string-name>, <string-name><surname>Hrabě de Angelis</surname><given-names>AL</given-names></string-name>, <string-name><surname>Jaitin</surname><given-names>D</given-names></string-name>, <string-name><surname>Wieghofer</surname><given-names>P</given-names></string-name>, <string-name><surname>Staszewski</surname><given-names>O</given-names></string-name>, <string-name><surname>David</surname><given-names>E</given-names></string-name>, <string-name><surname>Keren-Shaul</surname><given-names>H</given-names></string-name>, <string-name><surname>Mahlakoiv</surname><given-names>T</given-names></string-name>, <string-name><surname>Jakobshagen</surname><given-names>K</given-names></string-name>, <string-name><surname>Buch</surname><given-names>T</given-names></string-name>, <string-name><surname>Schwierzeck</surname><given-names>V</given-names></string-name>, <string-name><surname>Utermöhlen</surname><given-names>O</given-names></string-name>, <string-name><surname>Chun</surname><given-names>E</given-names></string-name>, <string-name><surname>Garrett</surname><given-names>WS</given-names></string-name>, <string-name><surname>McCoy</surname><given-names>KD</given-names></string-name>, <string-name><surname>Diefenbach</surname><given-names>A</given-names></string-name>, <string-name><surname>Staeheli</surname><given-names>P</given-names></string-name>, <string-name><surname>Stecher</surname><given-names>B</given-names></string-name>, <string-name><surname>Amit</surname><given-names>I</given-names></string-name>, <string-name><surname>Prinz</surname><given-names>M</given-names></string-name> (<year>2015</year>) <article-title>Host microbiota constantly control maturation and function of microglia in the CNS</article-title>. <source>Nat Neurosci</source>
<volume>18</volume>:<fpage>965</fpage>–<lpage>977</lpage>. <pub-id pub-id-type="doi">10.1038/nn.4030</pub-id>
<?supplied-pmid 26030851?><pub-id pub-id-type="pmid">26030851</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><string-name><surname>Eyo</surname><given-names>UB</given-names></string-name>, <string-name><surname>Gu</surname><given-names>N</given-names></string-name>, <string-name><surname>De</surname><given-names>S</given-names></string-name>, <string-name><surname>Dong</surname><given-names>H</given-names></string-name>, <string-name><surname>Richardson</surname><given-names>JR</given-names></string-name>, <string-name><surname>Wu</surname><given-names>LJ</given-names></string-name> (<year>2015</year>) <article-title>Modulation of microglial process convergence toward neuronal dendrites by extracellular calcium</article-title>. <source>J Neurosci</source>
<volume>35</volume>:<fpage>2417</fpage>–<lpage>2422</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.3279-14.2015</pub-id><pub-id pub-id-type="pmid">25673836</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><string-name><surname>Eyo</surname><given-names>UB</given-names></string-name>, <string-name><surname>Peng</surname><given-names>J</given-names></string-name>, <string-name><surname>Swiatkowski</surname><given-names>P</given-names></string-name>, <string-name><surname>Mukherjee</surname><given-names>A</given-names></string-name>, <string-name><surname>Bispo</surname><given-names>A</given-names></string-name>, <string-name><surname>Wu</surname><given-names>LJ</given-names></string-name> (<year>2014</year>) <article-title>Neuronal hyperactivity recruits microglial processes via neuronal NMDA receptors and microglial P2Y12 receptors after status epilepticus</article-title>. <source>J Neurosci</source>
<volume>34</volume>:<fpage>10528</fpage>–<lpage>10540</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.0416-14.2014</pub-id><pub-id pub-id-type="pmid">25100587</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><string-name><surname>Fontainhas</surname><given-names>AM</given-names></string-name>, <string-name><surname>Wang</surname><given-names>M</given-names></string-name>, <string-name><surname>Liang</surname><given-names>KJ</given-names></string-name>, <string-name><surname>Chen</surname><given-names>S</given-names></string-name>, <string-name><surname>Mettu</surname><given-names>P</given-names></string-name>, <string-name><surname>Damani</surname><given-names>M</given-names></string-name>, <string-name><surname>Fariss</surname><given-names>RN</given-names></string-name>, <string-name><surname>Li</surname><given-names>W</given-names></string-name>, <string-name><surname>Wong</surname><given-names>WT</given-names></string-name> (<year>2011</year>) <article-title>Microglial morphology and dynamic behavior is regulated by ionotropic glutamatergic and GABAergic neurotransmission</article-title>. <source>PLoS One</source>
<volume>6</volume>:<fpage>e15973</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0015973</pub-id>
<?supplied-pmid 21283568?><pub-id pub-id-type="pmid">21283568</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><string-name><surname>Hefendehl</surname><given-names>JK</given-names></string-name>, <string-name><surname>Neher</surname><given-names>JJ</given-names></string-name>, <string-name><surname>Suhs</surname><given-names>RB</given-names></string-name>, <string-name><surname>Kohsaka</surname><given-names>S</given-names></string-name>, <string-name><surname>Skodras</surname><given-names>A</given-names></string-name>, <string-name><surname>Jucker</surname><given-names>M</given-names></string-name> (<year>2014</year>) <article-title>Homeostatic and injury-induced microglia behavior in the aging brain</article-title>. <source>Aging Cell</source>
<volume>13</volume>:<fpage>60</fpage>–<lpage>69</lpage>. <pub-id pub-id-type="doi">10.1111/acel.12149</pub-id><pub-id pub-id-type="pmid">23953759</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><string-name><surname>Heindl</surname><given-names>S</given-names></string-name>, <string-name><surname>Gesierich</surname><given-names>B</given-names></string-name>, <string-name><surname>Benakis</surname><given-names>C</given-names></string-name>, <string-name><surname>Llovera-Garcia</surname><given-names>G</given-names></string-name>, <string-name><surname>Duering</surname><given-names>M</given-names></string-name>, <string-name><surname>Liesz</surname><given-names>A</given-names></string-name> (<year>2018</year>) <article-title>Automated Morphological Analysis of Microglia After Stroke</article-title>. <source>Front Cell Neurosci</source>
<volume>12</volume>:<fpage>106</fpage>.<pub-id pub-id-type="pmid">29725290</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><string-name><surname>Hines</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Hines</surname><given-names>RM</given-names></string-name>, <string-name><surname>Mulligan</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Macvicar</surname><given-names>BA</given-names></string-name> (<year>2009</year>) <article-title>Microglia processes block the spread of damage in the brain and require functional chloride channels</article-title>. <source>Glia</source>
<volume>57</volume>:<fpage>1610</fpage>–<lpage>1618</lpage>. <pub-id pub-id-type="doi">10.1002/glia.20874</pub-id><pub-id pub-id-type="pmid">19382211</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><string-name><surname>Jung</surname><given-names>S</given-names></string-name>, <string-name><surname>Aliberti</surname><given-names>J</given-names></string-name>, <string-name><surname>Graemmel</surname><given-names>P</given-names></string-name>, <string-name><surname>Sunshine</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Kreutzberg</surname><given-names>GW</given-names></string-name>, <string-name><surname>Sher</surname><given-names>A</given-names></string-name>, <string-name><surname>Littman</surname><given-names>DR</given-names></string-name> (<year>2000</year>) <article-title>Analysis of fractalkine receptor CX(3)CR1 function by targeted deletion and green fluorescent protein reporter gene insertion</article-title>. <source>Mol Cell Biol</source>
<volume>20</volume>:<fpage>4106</fpage>–<lpage>4114</lpage>. <pub-id pub-id-type="doi">10.1128/MCB.20.11.4106-4114.2000</pub-id><pub-id pub-id-type="pmid">10805752</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><string-name><surname>Karperien</surname><given-names>A</given-names></string-name>, <string-name><surname>Ahammer</surname><given-names>H</given-names></string-name>, <string-name><surname>Jelinek</surname><given-names>HF</given-names></string-name> (<year>2013</year>) <article-title>Quantitating the subtleties of microglial morphology with fractal analysis</article-title>. <source>Front Cell Neurosci</source>
<volume>7</volume>:<fpage>1</fpage>–<lpage>18</lpage>.
<pub-id pub-id-type="pmid">23355802</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><string-name><surname>Kerschnitzki</surname><given-names>M</given-names></string-name>, <string-name><surname>Kollmannsberger</surname><given-names>P</given-names></string-name>, <string-name><surname>Burghammer</surname><given-names>M</given-names></string-name>, <string-name><surname>Duda</surname><given-names>GN</given-names></string-name>, <string-name><surname>Weinkamer</surname><given-names>R</given-names></string-name>, <string-name><surname>Wagermaier</surname><given-names>W</given-names></string-name>, <string-name><surname>Fratzl</surname><given-names>P</given-names></string-name> (<year>2013</year>) <article-title>Architecture of the osteocyte network correlates with bone material quality</article-title>. <source>J Bone Mineral Res</source>
<volume>28</volume>:<fpage>1837</fpage>–<lpage>1845</lpage>. <pub-id pub-id-type="doi">10.1002/jbmr.1927</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><string-name><surname>Kloss</surname><given-names>CUA</given-names></string-name>, <string-name><surname>Bohatschek</surname><given-names>M</given-names></string-name>, <string-name><surname>Kreutzberg</surname><given-names>GW</given-names></string-name>, <string-name><surname>Raivich</surname><given-names>G</given-names></string-name> (<year>2001</year>) <article-title>Effect of lipopolysaccharide on the morphology and integrin immunoreactivity of ramified microglia in the mouse brain and in cell culture</article-title>. <source>Exp Neurol</source>
<volume>168</volume>:<fpage>32</fpage>–<lpage>46</lpage>. <pub-id pub-id-type="doi">10.1006/exnr.2000.7575</pub-id><pub-id pub-id-type="pmid">11170719</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><string-name><surname>Kozlowski</surname><given-names>C</given-names></string-name>, <string-name><surname>Weimer</surname><given-names>RM</given-names></string-name> (<year>2012</year>) <article-title>An automated method to quantify microglia morphology and application to monitor activation state longitudinally <italic>in vivo</italic>
</article-title>. <source>PLoS One</source>
<volume>7</volume>:<fpage>e31814</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0031814</pub-id>
<?supplied-pmid 22457705?><pub-id pub-id-type="pmid">22457705</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><string-name><surname>Kreutzberg</surname><given-names>GW</given-names></string-name> (<year>1996</year>) <article-title>Microglia: a sensor for pathological events in the CNS</article-title>. <source>Trends Neurosci</source>
<volume>19</volume>:<fpage>312</fpage>–<lpage>318</lpage>. <pub-id pub-id-type="doi">10.1016/0166-2236(96)10049-7</pub-id><pub-id pub-id-type="pmid">8843599</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><string-name><surname>Lou</surname><given-names>N</given-names></string-name>, <string-name><surname>Takano</surname><given-names>T</given-names></string-name>, <string-name><surname>Pei</surname><given-names>Y</given-names></string-name>, <string-name><surname>Xavier</surname><given-names>AL</given-names></string-name>, <string-name><surname>Goldman</surname><given-names>SA</given-names></string-name>, <string-name><surname>Nedergaard</surname><given-names>M</given-names></string-name> (<year>2016</year>) <article-title>Purinergic receptor P2RY12-dependent microglial closure of the injured blood–brain barrier</article-title>. <source>Proc Natl Acad Sci U S A</source>
<volume>113</volume>:<fpage>1074</fpage>–<lpage>1079</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1520398113</pub-id><pub-id pub-id-type="pmid">26755608</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal"><string-name><surname>Nimmerjahn</surname><given-names>A</given-names></string-name>, <string-name><surname>Kirchhoff</surname><given-names>F</given-names></string-name>, <string-name><surname>Helmchen</surname><given-names>F</given-names></string-name> (<year>2005</year>) <article-title>Resting microglial cells are highly dynamic surveillants of brain parenchyma <italic>in vivo</italic>
</article-title>. <source>Science</source>
<volume>308</volume>:<fpage>1314</fpage>–<lpage>1319</lpage>. <pub-id pub-id-type="doi">10.1126/science.1110647</pub-id><pub-id pub-id-type="pmid">15831717</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal"><string-name><surname>Otsu</surname><given-names>N</given-names></string-name> (<year>1979</year>) <article-title>A threshold selection method from gray-level histograms</article-title>. <source>IEEE Trans Syst Man Cybernet</source>
<volume>9</volume>:<fpage>62</fpage>–<lpage>66</lpage>. <pub-id pub-id-type="doi">10.1109/TSMC.1979.4310076</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><string-name><surname>Paris</surname><given-names>I</given-names></string-name>, <string-name><surname>Savage</surname><given-names>JC</given-names></string-name>, <string-name><surname>Escobar</surname><given-names>L</given-names></string-name>, <string-name><surname>Abiega</surname><given-names>O</given-names></string-name>, <string-name><surname>Gagnon</surname><given-names>S</given-names></string-name>, <string-name><surname>Hui</surname><given-names>CW</given-names></string-name>, <string-name><surname>Tremblay</surname><given-names>MÈ</given-names></string-name>, <string-name><surname>Sierra</surname><given-names>A</given-names></string-name>, <string-name><surname>Valero</surname><given-names>J</given-names></string-name> (<year>2018</year>) <article-title>ProMoIJ: a new tool for automatic three-dimensional analysis of microglial processes motility</article-title>. <source>Glia</source>
<volume>66</volume>:<fpage>828</fpage>–<lpage>845</lpage>.
<pub-id pub-id-type="pmid">29288586</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal"><string-name><surname>Perego</surname><given-names>C</given-names></string-name>, <string-name><surname>Fumagalli</surname><given-names>S</given-names></string-name>, <string-name><surname>De Simoni</surname><given-names>MG</given-names></string-name> (<year>2013</year>) <article-title>Three-dimensional confocal analysis of microglia/macrophage markers of polarization in experimental brain injury</article-title>. <source>J Vis Exp</source>
<volume>79</volume>:<fpage>e50605</fpage>. <pub-id pub-id-type="doi">10.3791/50605</pub-id>
<?supplied-pmid 24056862?><pub-id pub-id-type="pmid">24056862</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal"><string-name><surname>Rosenegger</surname><given-names>DG</given-names></string-name>, <string-name><surname>Tran</surname><given-names>CHT</given-names></string-name>, <string-name><surname>LeDue</surname><given-names>J</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>N</given-names></string-name>, <string-name><surname>Gordon</surname><given-names>GR</given-names></string-name> (<year>2014</year>) <article-title>A high performance, cost-effective, open-source microscope for scanning two-photon microscopy that is modular and readily adaptable</article-title>. <source>PLoS One</source>
<volume>9</volume>:<fpage>e110475</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0110475</pub-id>
<?supplied-pmid 25333934?><pub-id pub-id-type="pmid">25333934</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal"><string-name><surname>Takayama</surname><given-names>F</given-names></string-name>, <string-name><surname>Hayashi</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wu</surname><given-names>Z</given-names></string-name>, <string-name><surname>Liu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Nakanishi</surname><given-names>H</given-names></string-name> (<year>2016</year>) <article-title>Diurnal dynamic behavior of microglia in response to infected bacteria through the UDP-P2Y 6 receptor system</article-title>. <source>Sci Rep</source>
<volume>6</volume>:<fpage>1</fpage>–<lpage>10</lpage>.
<pub-id pub-id-type="pmid">28442746</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal"><string-name><surname>Torres-Platas</surname><given-names>SG</given-names></string-name>, <string-name><surname>Comeau</surname><given-names>S</given-names></string-name>, <string-name><surname>Rachalski</surname><given-names>A</given-names></string-name>, <string-name><surname>Bo</surname><given-names>GD</given-names></string-name>, <string-name><surname>Cruceanu</surname><given-names>C</given-names></string-name>, <string-name><surname>Turecki</surname><given-names>G</given-names></string-name>, <string-name><surname>Giros</surname><given-names>B</given-names></string-name>, <string-name><surname>Mechawar</surname><given-names>N</given-names></string-name> (<year>2014</year>) <article-title>Morphometric characterization of microglial phenotypes in human cerebral cortex</article-title>. <source>J Neuroinflammation</source>
<volume>11</volume>:<fpage>12</fpage>
<pub-id pub-id-type="doi">10.1186/1742-2094-11-12</pub-id><pub-id pub-id-type="pmid">24447857</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal"><string-name><surname>Verdonk</surname><given-names>F</given-names></string-name>, <string-name><surname>Roux</surname><given-names>P</given-names></string-name>, <string-name><surname>Flamant</surname><given-names>P</given-names></string-name>, <string-name><surname>Fiette</surname><given-names>L</given-names></string-name>, <string-name><surname>Bozza</surname><given-names>FA</given-names></string-name>, <string-name><surname>Simard</surname><given-names>S</given-names></string-name>, <string-name><surname>Lemaire</surname><given-names>M</given-names></string-name>, <string-name><surname>Plaud</surname><given-names>B</given-names></string-name>, <string-name><surname>Shorte</surname><given-names>SL</given-names></string-name>, <string-name><surname>Sharshar</surname><given-names>T</given-names></string-name>, <string-name><surname>Chrétien</surname><given-names>F</given-names></string-name>, <string-name><surname>Danckaert</surname><given-names>A</given-names></string-name> (<year>2016</year>) <article-title>Phenotypic clustering: a novel method for microglial morphology analysis</article-title>. <source>J Neuroinflammation</source>
<volume>13</volume>:<fpage>153</fpage>. <pub-id pub-id-type="doi">10.1186/s12974-016-0614-7</pub-id>
<?supplied-pmid 27317566?><pub-id pub-id-type="pmid">27317566</pub-id></mixed-citation>
    </ref>
  </ref-list>
  <sec sec-type="synthesis-author-response" id="s6">
    <title>Synthesis</title>
    <boxed-text position="float" orientation="portrait">
      <p>Reviewing Editor: Maiken Nedergaard, University of Rochester Medical Center</p>
      <p>Decisions are customarily a result of the Reviewing Editor and the peer reviewers coming together and discussing their recommendations until a consensus is reached. When revisions are invited, a fact-based synthesis statement explaining their decision and outlining what is needed to prepare a revision will be listed below. The following reviewer(s) agreed to reveal their identity: Long-Jun Wu.</p>
    </boxed-text>
    <p>The authors provide a Matlabbased script that analyzes microglial morphology from 3D data called M3DMorph. The program requires certain input parameters defined after which it is possible to personalize its use. The advantage of is the analysis of cell morphology in 3 dimensions. The authors provide the open source code on GitHub and thereby accessible to all investigators.Reviewer #1 comments: This study described an analysis program named 3DMorph for automatic analysis of 3D morphology of microglial processes. The program is designed to analyze Z-stack microglial images from slice or living animals. It seems that the program has significant high-efficiency and low subjective bias compared with other analysis. Overall, the authors have invested considerable efforts to develop and validate the analysis program, which could be quite useful for studying microglial function in physiology and pathology. The major concern is that the study is a pure methodology paper with a quite narrow focus. 3D analysis of microglial morphology has also been pursued by several studies (Heindl et al, 2018; Paris et al., 2018), and thus the novelty of the study was compromised. I am surprised that the recent study on 3D analysis of microglia dynamics (Paris et al., 2018) was not discussed or even cited.</p>
  </sec>
</back>
