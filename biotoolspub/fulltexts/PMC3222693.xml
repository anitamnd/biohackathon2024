<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.0 20040830//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Microsc</journal-id>
    <journal-id journal-id-type="publisher-id">jmi</journal-id>
    <journal-title-group>
      <journal-title>Journal of Microscopy</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0022-2720</issn>
    <issn pub-type="epub">1365-2818</issn>
    <publisher>
      <publisher-name>Blackwell Publishing Ltd</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3222693</article-id>
    <article-id pub-id-type="doi">10.1111/j.1365-2818.2011.03486.x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Application of regularized Richardson–Lucy algorithm for deconvolution of confocal microscopy images</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Laasmaa</surname>
          <given-names>M</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vendelin</surname>
          <given-names>M</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Peterson</surname>
          <given-names>P</given-names>
        </name>
      </contrib>
      <aff>
        <institution>Laboratory of Systems Biology, Institute of Cybernetics, Tallinn University of Technology</institution>
        <addr-line>Tallinn, Estonia</addr-line>
      </aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">Correspondence to: Pearu Peterson, Laboratory of Systems Biology, Institute of Cybernetics, Tallinn University of Technology, Akadeemia Road 21, 12618 Tallinn, Estonia. Tel: +372 6204162; fax: +372 6204151; e-mail: <email>pearu@sysbio.ioc.ee</email></corresp>
      <fn>
        <p>Re-use of this article is permitted in accordance with the Terms and Conditions set out at <ext-link ext-link-type="uri" xlink:href="http://wileyonlinelibrary.com/onlineopen#OnlineOpen_Terms">http://wileyonlinelibrary.com/onlineopen#OnlineOpen_Terms</ext-link></p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>8</month>
      <year>2011</year>
    </pub-date>
    <volume>243</volume>
    <issue>Pt 2</issue>
    <fpage>124</fpage>
    <lpage>140</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>4</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>03</day>
        <month>1</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Journal of Microscopy © 2011 Royal Microscopical Society</copyright-statement>
      <copyright-year>2011</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.5/">
        <license-p>Re-use of this article is permitted in accordance with the Creative Commons Deed, Attribution 2.5, which does not permit commercial exploitation.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Although confocal microscopes have considerably smaller contribution of out-of-focus light than widefield microscopes, the confocal images can still be enhanced mathematically if the optical and data acquisition effects are accounted for. For that, several deconvolution algorithms have been proposed. As a practical solution, maximum-likelihood algorithms with regularization have been used. However, the choice of regularization parameters is often unknown although it has considerable effect on the result of deconvolution process. The aims of this work were: to find good estimates of deconvolution parameters; and to develop an open source software package that would allow testing different deconvolution algorithms and that would be easy to use in practice. Here, Richardson–Lucy algorithm has been implemented together with the total variation regularization in an open source software package IOCBio Microscope. The influence of total variation regularization on deconvolution process is determined by one parameter. We derived a formula to estimate this regularization parameter automatically from the images as the algorithm progresses. To assess the effectiveness of this algorithm, synthetic images were composed on the basis of confocal images of rat cardiomyocytes. From the analysis of deconvolved results, we have determined under which conditions our estimation of total variation regularization parameter gives good results. The estimated total variation regularization parameter can be monitored during deconvolution process and used as a stopping criterion. An inverse relation between the optimal regularization parameter and the peak signal-to-noise ratio of an image is shown. Finally, we demonstrate the use of the developed software by deconvolving images of rat cardiomyocytes with stained mitochondria and sarcolemma obtained by confocal and widefield microscopes.</p>
    </abstract>
    <kwd-group>
      <kwd>Deconvolution</kwd>
      <kwd>estimating regularization parameters</kwd>
      <kwd>fluorescence microscopy</kwd>
      <kwd>3D quantitative fluorescence microscopy imaging</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>Introduction</title>
    <p>In biosciences, fluorescence microscopy is an extremely useful and important method for studying living organisms. As one of the implementations of fluorescence microscopy, confocal fluorescence microscopy can be used to study live cells and analyse the response of the cells to external stimuli. Confocal microscopy has several advantages over traditional widefield microscopy. The main advantage is the ability to produce in-focus images of thick specimens via elimination or reduction of background information outside of the focal plane and ability to control the depth of field (within the accuracy of an Airy disk size) (<xref ref-type="bibr" rid="b16">Inoué, 2006</xref>). Despite the advantages over widefield microscopy, confocal images contain imperfections, for example, aberrations due to nonideal optical pathway, residual out-of-focus light, noise from detector electronics, etc. (<xref ref-type="bibr" rid="b38">Shaw, 2006</xref>).</p>
    <p>In this paper we focus on image enhancement of microscope images by deconvolution (<xref ref-type="bibr" rid="b6">Cannell <italic>et al.</italic>, 2006</xref>). Each microscope alters the appearance of specimens in a specific way. Image formation can be described by the mathematical operation of convolution, where the ‘true’ image is convolved with distortion effects from the microscope. Deconvolution is a method to reverse the aberrations caused by convolution, that is remove the distortions of the optical train, contributions from out-of-focus objects, and with regularization enabled, reduce the noise originated from detector electronics. Deconvolution takes into account microscope optics and the nature of noise. Therefore, it is a method that can efficiently enhance both widefield microscopy and confocal microscopy images. It can considerably improve image contrast and reduce noise in microscope images.</p>
    <p>Several deconvolution algorithms have been proposed for three-dimensional (3D) microscopy. For example, noniterative algorithms such as regularized inverse-filtering algorithm (<xref ref-type="bibr" rid="b33">Preza <italic>et al.</italic>, 1992</xref>), nearest-neighbour algorithm, Wiener filtering algorithm (<xref ref-type="bibr" rid="b39">Shaw &amp; Rawlins, 1991a</xref>), etc.; iterative algorithms such as Richardson–Lucy (RL) algorithm (<xref ref-type="bibr" rid="b36">Richardson, 1972</xref>; <xref ref-type="bibr" rid="b21">Lucy, 1974</xref>), Jansson-van Cittert algorithm (<xref ref-type="bibr" rid="b2">Agard, 1984</xref>; <xref ref-type="bibr" rid="b1">Abdelhak &amp; Sedki, 1992</xref>), Carrington algorithm (<xref ref-type="bibr" rid="b7">Carrington <italic>et al.</italic>, 1995</xref>), constrained Tikhonov-Miller algorithm (<xref ref-type="bibr" rid="b44">van Kempen <italic>et al.</italic>, 1997</xref>), Fourier-wavelet regularized algorithm (<xref ref-type="bibr" rid="b25">Neelamani <italic>et al.</italic>, 2004</xref>), expectation maximization algorithm (<xref ref-type="bibr" rid="b9">Conchello, 1998</xref>; <xref ref-type="bibr" rid="b32">Preza &amp; Conchello, 2004</xref>), etc; blind deconvolution algorithms (<xref ref-type="bibr" rid="b15">Holmes, 1992</xref>; <xref ref-type="bibr" rid="b3">Avinash, 1996</xref>; <xref ref-type="bibr" rid="b22">Markham &amp; Conchello, 1999</xref>). Usually, noniterative methods are fastest but these do not provide optimal image quality, especially in the presence of noise (<xref ref-type="bibr" rid="b6">Cannell <italic>et al.</italic>, 2006</xref>). The particular choice of deconvolution algorithm depends on users requirements (should the deconvolved image be pleasant to the viewers eye or be quantitatively as correct as possible), computational resources and limitations (<xref ref-type="bibr" rid="b6">Cannell <italic>et al.</italic>, 2006</xref>; <xref ref-type="bibr" rid="b41">Sun <italic>et al.</italic>, 2009</xref>).</p>
    <p>In this paper, we analyse the RL iterative algorithm that is derived for Poisson noise (<xref ref-type="bibr" rid="b36">Richardson, 1972</xref>; <xref ref-type="bibr" rid="b21">Lucy, 1974</xref>). The assumption of Poisson noise is adequate for confocal microscopes because these use photodetection devices such as avalanche photodiodes to count the number of photons that are emitted from specimens. Because of the quantum nature of light, the number of detected photons is a Poisson process whose variance is equal to the mean of counted photons.</p>
    <p>The RL algorithm is commonly used for telescope and microscope image enhancement (<xref ref-type="bibr" rid="b12">Dey <italic>et al.</italic>, 2006</xref>). An undesired property of the RL algorithm is that, in the presence of noise, the deconvolution process converges to a solution which is dominated by the noise (<xref ref-type="bibr" rid="b11">Dey <italic>et al.</italic>, 2004</xref>). An option to circumvent this, is to prefilter images (<xref ref-type="bibr" rid="b6">Cannell <italic>et al.</italic>, 2006</xref>). Another option is to introduce regularization terms such as Tikhonov–Miller (<xref ref-type="bibr" rid="b43">van Kempen &amp; van Vliet, 2000</xref>) or maximum entropy to the RL algorithm (<xref ref-type="bibr" rid="b23">de Monvel <italic>et al.</italic>, 2001</xref>, <xref ref-type="bibr" rid="b24">2003</xref>). Algorithms which are based on Tikhonov–Miller regularization, are often used for deconvolving 3D images. Such algorithms avoid noise amplification but operate poorly near the object edges. Alternatively, to increase the sharpness of object borders and obtain smooth homogeneous areas, total variation (TV) regularization is often applied in the RL algorithm (<xref ref-type="bibr" rid="b11">Dey <italic>et al.</italic>, 2004</xref>). However, regularization terms contain unknown parameters that must be carefully chosen to achieve optimal deconvolution results that would be as close as possible to the ‘true’ image. Some regularized algorithms provide means to determine how much regularization to use in each restoration step (<xref ref-type="bibr" rid="b41">Sun <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="b20">Liao <italic>et al.</italic>, 2009</xref>). In this paper, we introduce a method to estimate the regularization parameter for the regularized RL deconvolution algorithm.</p>
    <p>All iterative deconvolution algorithms have to deal with the problem of stopping the iteration process. Provided that the iteration converges, seemingly the most natural, in fact, also the most popular stopping criteria are based on measuring the stationary state of the iteration process. For example, this can be measured by computing the relative changes of subsequent estimates and specifying a stopping threshold (<xref ref-type="bibr" rid="b11">Dey <italic>et al.</italic>, 2004</xref>, <xref ref-type="bibr" rid="b12">2006</xref>; <xref ref-type="bibr" rid="b41">Sun <italic>et al.</italic>, 2009</xref>). Surprisingly, as we show in this work, such stopping criteria turn out to be suboptimal: the converged estimate may be less accurate (when comparing with the ‘true’ image) than some of the intermediate estimates. So, a better stopping criteria is needed for improving quantitative results of iterative deconvolution algorithms.</p>
    <p>For image restoration by deconvolution, both commercial and open source computer programs are available. Commercial image restoration software solutions give good results in image enhancement and are easy to use, but, as a drawback, they are expensive and do not support testing alternative deconvolution algorithms due to their closed source development policy. Several open source software libraries exists that implement various deconvolution algorithms (<xref ref-type="bibr" rid="b30">Peterson, 2010b</xref>). For example, Clarity Deconvolution Library (<xref ref-type="bibr" rid="b35">Quammen, 2007</xref>) (GPL license) is a C/C++ library that currently implements Wiener filtering (<xref ref-type="bibr" rid="b40">Shaw &amp; Rawlins, 1991b</xref>), Jansson-van Cittert iterative (<xref ref-type="bibr" rid="b2">Agard, 1984</xref>), maximum likelihood iterative (<xref ref-type="bibr" rid="b36">Richardson, 1972</xref>; <xref ref-type="bibr" rid="b21">Lucy, 1974</xref>) with symmetric point spread function (PSF) algorithms; COSMOS (<xref ref-type="bibr" rid="b42">Valdimarsson &amp; Preza, 2007</xref>) is a C++ library (GPL, the successor of XCOSM software) that currently implements depth variant expectation maximization (<xref ref-type="bibr" rid="b32">Preza &amp; Conchello, 2004</xref>), a linear least square (<xref ref-type="bibr" rid="b33">Preza <italic>et al.</italic>, 1992</xref>), a linear maximum <italic>a posteriori</italic> (<xref ref-type="bibr" rid="b34">Preza <italic>et al.</italic>, 1993</xref>), the Jansen-van Cittert (<xref ref-type="bibr" rid="b2">Agard, 1984</xref>) and the expectation maximization (<xref ref-type="bibr" rid="b9">Conchello, 1998</xref>) algorithms; Deconv is a C++ library (GPL) that currently implements maximum likelihood-Landweber, -conjugate gradient and -expectation maximization iterative deconvolution (<xref ref-type="bibr" rid="b41">Sun <italic>et al.</italic>, 2009</xref>) algorithms. For a scientist who prefers to focus on solving scientific problems, this variety of software and algorithms makes it difficult to decide which of the algorithms is most suitable for particular image data and available computational resources. Therefore, a software platform is needed that would support testing and comparing different deconvolution algorithms and their implementations in an unified manner for variety of microscopy image file formats. For this, we use Python programming language that is becoming an increasingly popular choice for scientific computing because of its many features that are attractive for scientists: Python has very clean and easy-to-learn syntax, it supports very high-level object-oriented programming paradigm, and is easy to extend. High-quality scientific computational packages in Python have emerged within the last 10 years (<xref ref-type="bibr" rid="b26">Oliphant, 2007</xref>; <xref ref-type="bibr" rid="b17">Jones <italic>et al.</italic>, 2001</xref>) and well-developed tools exist for interfacing existing C/C++ and Fortran libraries to Python (<xref ref-type="bibr" rid="b4">Beazley, 2003</xref>; <xref ref-type="bibr" rid="b28">Peterson, 2009</xref>).</p>
    <p>The aims of this work are: (1) to work out a practical method for using deconvolution algorithms, in particularly, to find good estimates to regularization parameters as well as to establish a robust criterion for stopping iteration process that would give closest result to the ‘true’ image rather than just detecting deconvolution process stationarity; (2) to develop an open source software package that would allow testing different deconvolution algorithms and at the same time would be easy to use in practice.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>Material and methods</title>
    <sec>
      <title>Description of the deconvolution process</title>
      <p>To deconvolve microscope images we use the RL algorithm (<xref ref-type="bibr" rid="b36">Richardson, 1972</xref>; <xref ref-type="bibr" rid="b21">Lucy, 1974</xref>). The algorithm is based on the following mathematical image formation model:
<disp-formula id="m1"><graphic xlink:href="jmi0243-0124-m1"/><label>(1)</label></disp-formula>where <italic>i</italic> represents the recorded image stack represented as 3D array, where each item value corresponds to the intensity of a measured voxel, <italic>o</italic> is the object, <italic>h</italic> is the PSF defined by the optical train of a specific microscope, ⊗ denotes convolution operation, <inline-formula><inline-graphic xlink:href="jmi0243-0124-mu1.jpg" mimetype="image"/></inline-formula> represents Poisson noise originating from counting photons. With maximum likelihood approach and TV regularization, the model provides the following equation (<xref ref-type="bibr" rid="b11">Dey <italic>et al.</italic>, 2004</xref>):
<disp-formula id="m2"><graphic xlink:href="jmi0243-0124-m2"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="jmi0243-0124-mu2.jpg" mimetype="image"/></inline-formula> is regularization parameter and differentiation operations are defined with respect to voxel coordinates <italic>v</italic>. From <xref ref-type="disp-formula" rid="m2">Eq. (2)</xref>, a multiplicative gradient-type RL algorithm for one iteration can be derived (<xref ref-type="bibr" rid="b11">Dey <italic>et al.</italic>, 2004</xref>):
<disp-formula id="m3"><graphic xlink:href="jmi0243-0124-m3"/><label>(3)</label></disp-formula>whereby in this paper we use <italic>o</italic><sup>(0)</sup>=<italic>i</italic>. In general, the initial estimate <italic>o</italic><sup>(0)</sup> can be denoised, for example, by convolving <italic>i</italic> with <italic>h</italic>, or applying Gaussian filter to <italic>i</italic>, etc. Note also that <xref ref-type="disp-formula" rid="m3">Eq. (3)</xref> may introduce negative values to deconvolution estimate. This happens when the denominator of <xref ref-type="disp-formula" rid="m3">Eq. (3)</xref> becomes negative for some voxel value. The negativity usually indicates unstable deconvolution process due to an inappropriate choice of λ value. In such cases, the iteration process should be stopped immediately.</p>
      <p>We denote the result of deconvolution with the above scheme as <italic>o</italic><sup>(<italic>S</italic>)</sup>=<italic>i</italic>⊗<sup>−1</sup><sub>λ,<italic>S</italic></sub><italic>h</italic>, where <italic>S</italic> denotes the number of iteration steps.</p>
    </sec>
    <sec>
      <title>Estimation of the TV regularization parameter value</title>
      <p>Let us define a functional<disp-formula id="m4"><graphic xlink:href="jmi0243-0124-m4"/><label>(4)</label></disp-formula>which ought to have zero value when <xref ref-type="disp-formula" rid="m2">Eq. (2)</xref> is fulfilled; <italic>v</italic>= (<italic>i</italic>, <italic>j</italic>, <italic>k</italic>) defines the location of a voxel in 3D image. At the <italic>s</italic>th deconvolution iteration, the regularization parameter λ can be chosen such that <italic>F</italic>(<italic>o</italic><sup>(<italic>s</italic>)</sup>; λ) is minimal. It is easy to show that the minimal value of the functional <xref ref-type="disp-formula" rid="m4">Eq. (4)</xref> is <italic>F</italic>(<italic>o</italic><sup>(<italic>s</italic>)</sup>; λ<sup>(<italic>s</italic>)</sup><sub>lsq</sub>) where<disp-formula id="m5"><graphic xlink:href="jmi0243-0124-m5"/><label>(5)</label></disp-formula>and formally <italic>C</italic>= 1. The coefficient <italic>C</italic> is chosen such that at the first iteration the λ value is close to the optimal λ value (see Results), that is, λ<sup>(0)</sup><sub>lsq</sub>≡ 50/<italic>SNR</italic> where <italic>SNR</italic> denotes peak signal-to-noise ratio (SNR) of the recorded image <italic>i</italic>[<xref ref-type="disp-formula" rid="m6">Eq. (6)</xref>].</p>
      <p>Note that λ<sub>lsq</sub> in <xref ref-type="disp-formula" rid="m5">Eq. (5)</xref> is closely related to Lagrange multiplier method used in (<xref ref-type="bibr" rid="b14">Gilboa <italic>et al.</italic>, 2003</xref>) when taking <inline-formula><inline-graphic xlink:href="jmi0243-0124-mu3.jpg" mimetype="image"/></inline-formula> as a constant that describes texture variations in the estimate <italic>o</italic><sup>(<italic>s</italic>)</sup>.</p>
    </sec>
    <sec>
      <title>Estimation of the peak SNR</title>
      <p>To quantify the noise level in recorded images, we use the peak SNR. The peak SNR is defined as the ratio of mean to standard deviation of the brightest part of the recorded images. Because all of our image data is recorded with a photon counting module then the peak SNR can be directly estimated from Poisson statistics: it is the square of mean photon count in the brightest part of an image. The mean photon count is estimated as a maximum value of an averaged image. The averaging of the image is carried out with 3 × 3 × 3 uniform kernel.</p>
      <p>In summary, the SNR of a recorded image <italic>i</italic> that values are counts of detected photons per voxel time, is<disp-formula id="m6"><graphic xlink:href="jmi0243-0124-m6"/><label>(6)</label></disp-formula></p>
    </sec>
    <sec>
      <title>Numerical methods</title>
      <p>The deconvolution algorithm is implemented in Python programming language (<xref ref-type="bibr" rid="b45">van Rossum, 1991</xref>) and released as open source software IOCBio Microscope (<xref ref-type="bibr" rid="b29">Peterson, 2010a</xref>). For array operations, the NumPy package is used. For correcting PSF to correct voxel size, the SciPy (<xref ref-type="bibr" rid="b17">Jones <italic>et al.</italic>, 2001</xref>) Ndimage package is used. Convolution operation is carried out via FFT using FFTW library (<xref ref-type="bibr" rid="b13">Frigo &amp; Johnson, 2005</xref>) and the numerical scheme for computing <inline-formula><inline-graphic xlink:href="jmi0243-0124-mu4.jpg" mimetype="image"/></inline-formula> is implemented in C programming language for better performance. The original scheme for computing <inline-formula><inline-graphic xlink:href="jmi0243-0124-mu5.jpg" mimetype="image"/></inline-formula> as given in (<xref ref-type="bibr" rid="b11">Dey <italic>et al.</italic>, 2004</xref>) has a typo and below follows the corrected scheme:
<disp-formula id="m7"><graphic xlink:href="jmi0243-0124-m7"/><label>(7)</label></disp-formula>where<disp-formula id="m8"><graphic xlink:href="jmi0243-0124-m8"/><label>(8)</label></disp-formula><disp-formula id="m9"><graphic xlink:href="jmi0243-0124-m9"/><label>(9)</label></disp-formula>and <italic>h<sub>x</sub></italic>, <italic>h<sub>y</sub></italic>, <italic>h</italic><sub><italic>z</italic></sub> are voxel dimensions. In boundary points, the following relations are used (<xref ref-type="bibr" rid="b11">Dey <italic>et al.</italic>, 2004</xref>):
<disp-formula id="m10"><graphic xlink:href="jmi0243-0124-m10"/><label>(10)</label></disp-formula></p>
    </sec>
    <sec>
      <title>Determination of the PSF</title>
      <p>The accuracy of any deconvolution algorithm depends on the quality of used PSF. The PSF can be computed from the optical properties of a microscope system or estimated from the measurements of microspheres. Also, a third option exists where the PSF is estimated from recorded images together with observed objects (blind deconvolution) but for this paper we assume that PSF is known before executing the deconvolution process.</p>
      <p>From the deconvolution quality point of view the estimation of PSF is preferred over the computed PSF because all optical aberrations of the given microscope system are taken into account. By contrast, in estimating PSF from microspheres measurements, the problem of suppressing noise must be tackled. In <xref ref-type="bibr" rid="b18">Lai <italic>et al.</italic> (2005)</xref>, a PSF denoising method is introduced that is based on singular value decomposition. The method has disadvantage that it produces small but visible artificial ripples to the denoised PSF.</p>
      <p>In this paper, the PSF is estimated from the microscope images of fluorescent microspheres using the following algorithm:</p>
      <list list-type="order">
        <list-item>
          <p>Determine the location of microspheres and extract their intensity profiles.</p>
        </list-item>
        <list-item>
          <p>Sum the intensity profiles, to form the PSF function <italic>h</italic>. The SNR ratio will increase with the increase of the number (<italic>M</italic>) of intensity profiles.</p>
        </list-item>
      </list>
      <p>It turns out that further denoising procedures on the summed PSF function is not required when <italic>M</italic> is sufficiently large: the SNR of a single PSF measurement increases approximately <inline-formula><inline-graphic xlink:href="jmi0243-0124-mu6.jpg" mimetype="image"/></inline-formula> times when summing up <italic>M</italic> different PSF measurements. In our PSF cases, typical values for <italic>M</italic> are within range 4–12.</p>
      <p>For this paper, two PSFs for a confocal microscope are estimated for laser lines 473 and 633 nm. For laser line 473 nm, we used microspheres (green) with excitation maximum at 505 nm and emission maximum at 540 nm. Emission was collected through a bandpass filter 550 ± 44 nm (FF01-550/88-25, Semrock). For laser line 633 nm, we used microspheres (deep red) with excitation maximum at 633 nm and emission maximum at 660 nm. Emission was collected through a bandpass filter 725 ± 75 nm (FF01-725/150-25, Semrock).</p>
      <p>In addition, a PSF for a widefield microscope was obtained by exciting microspheres (orange – excitation maximum at 540, emission maximum at 560 nm) with fluorescent light through a bandpass filter 543 ± 22 nm (Semrock, Rochester, NY, U.S.A.) and emission was collected through a bandpass filter 593 ± 40 nm (Semrock).</p>
      <p>PSFs that were used in this study are shown in <xref ref-type="fig" rid="fig01">Fig. 1</xref> in the upper row. The lower row in <xref ref-type="fig" rid="fig01">Fig. 1</xref> shows the corresponding optical transfer functions for all PSFs.</p>
      <fig id="fig01" position="float">
        <label>Fig. 1</label>
        <caption>
          <p>The PSFs of the confocal and the widefield microscope used in this study. The upper row shows three PSFs estimated from the measurements of microspheres; two confocal PSFs and a widefield PSF. The axis in the subplots show distance in μm; note the difference in scales used for confocal and widefield PSFs. Voxel sizes for PSF were as follows: green confocal 0.019 × 0.019 × 0.138 μm, deep red confocal 0.027 × 0.027 × 0.120 μm and orange widefield 0.132 × 0.132 × 0.276 μm, respectively. The lower row shows the corresponding optical transfer functions. Note that the PSF of widefield microscope is larger than the PSFs for confocal microscope.</p>
        </caption>
        <graphic xlink:href="jmi0243-0124-f1"/>
      </fig>
      <p>All types of microspheres have diameter 0.175 μm (PS-Speck, Molecular Probes, Invitrogen, Eugene, OR, U.S.A.).</p>
      <p>The slides of microspheres for measuring PSFs were prepared as follows. A 1000-fold dilution in water was made from the original suspension. A small drop of the dilution was placed on a cover glass of 0.17 mm in thickness and let it dry in air. When the sample was dry a small drop of immersion oil with refractive index 1.334 at 23° (Carl Zeiss Immersol™ W, Oberkochen, Germany) was added on the spot and fixed with a glass slide.</p>
      <p>Imaging of confocal images was carried out with custom confocal laser scanning microscope with a digital photon counter (avalanche photodiode, Perkin Elmer, SPCM-AQRH-13, Vaudreuil, Canada) and 60× water-immersion objective (Olympus, UPLSAPO 60XW/1.2, Hamburg, Germany). Imaging of widefield images was carried out with Nikon TiU microscope (Nikon, Amstelveen, the Netherlands), equipped with Andor EMCCD camera (iXon 885, Andor, Belfast, Ireland), 60× water-immersion objective (Nikon, Plan Apo VC 60×/1.2 WI, Amstelveen, the Netherlands). Optical sectioning was carried out by piezoelectric objective positioning system (Piezosystem Jena GmbH, MIPOS 250SG M25, Jena, Germany).</p>
    </sec>
    <sec>
      <title>Obtaining experimental data for examples</title>
      <p>Rat cardiomyocytes were isolated as in <xref ref-type="bibr" rid="b37">Sepp <italic>et al.</italic> (2010)</xref>. Live cells were imaged using the approach similar to <xref ref-type="bibr" rid="b5">Birkedal <italic>et al.</italic> (2006)</xref> and <xref ref-type="bibr" rid="b46">Vendelin &amp; Birkedal (2008)</xref>. In short, the cells were kept and imaged in solution consisting of (mM): KH<sub>2</sub>PO<sub>4</sub> 3, MgCl<sub>2</sub> 3, sucrose 110, K-lactobionate 60, taurine 20, HEPES 20, EGTA 0.5, DTT 0.5, malate 2, glutamate 5 and 5 mg mL<sup>−1</sup> BSA. pH was adjusted to 7.1 with KOH at 25°. Mitochondria were visualized by staining isolated cells with MitoTracker Green FM with the final concentration of 200 n<sc>m</sc>; for sarcolemma we used di-8-ANEPPS with the final concentration of 1 μM (both from Invitrogen). After incubation for 15 min at the room temperature, cells were washed and inserted to imaging chamber that consisted of a FlexiPERM silicone insert (Vivascience, Hanau, Germany) attached to a cover slip glass of 0.17 mm in thickness.</p>
      <p>For acquisition of images, the same microscope set-ups were used as described earlier for measuring PSF.</p>
    </sec>
    <sec>
      <title>Analysis of the deconvolution process</title>
      <p>To study the effects of deconvolution, we created two types of synthetic images with different textures from the microscope images of mitochondria and sarcolemma of rat cardiomyocytes. The image of mitochondria gives a typical example of blocky like textures. By contrast, the image of sarcolemma gives a typical example of honeycomb-like textures. The synthetic images were obtained from confocal microscope images as follows. A microscope image was convolved and deconvolved several times using the following algorithm:
<disp-formula id="m11"><graphic xlink:href="jmi0243-0124-m11"/><label>(11)</label></disp-formula>Note that the number of deconvolutions is larger by 1 compared to the number of convolutions in <xref ref-type="disp-formula" rid="m11">Eq. (11)</xref> to obtain small details in <italic>i</italic><sub>smooth</sub> that would be of similar size to the small details in the object image <italic>o</italic>[<xref ref-type="disp-formula" rid="m1">Eq. (1)</xref>]. Our smooth synthetic images were obtained using the following parameters: <italic>N</italic>= 4, <italic>S</italic>= 200, λ= 0.</p>
      <p>We prefer using such synthetic images over traditional artificial images, which represent various geometrical shapes, because synthetic images allow us to tune the deconvolution algorithm parameters for microscope images that biologists need to deconvolve. An example of a synthetic image with blocky-like texture is shown in the first row of the second column of <xref ref-type="fig" rid="fig02">Fig. 2</xref>.</p>
      <fig id="fig02" position="float">
        <label>Fig. 2</label>
        <caption>
          <p>The results of deconvolving synthetic 3D images with the voxel size 0.136 μm × 0.136 μm × 0.707 μm. The first row shows convolved and original images, respectively. The original synthetic image is obtained from the confocal image of mitochondria in cardiac cell and has typical blocky like texture. The first column shows degraded images with different signal-to-noise ratios (SNR); the second column represents degraded images that are deconvolved using estimated λ; and the last column shows degraded images that are deconvolved using an optimal value for λ. Test images with different SNR and the deconvolution results are shown in rows, starting from second, in decreasing order according to SNR. Deconvolution results correspond to minimal MSE value.</p>
        </caption>
        <graphic xlink:href="jmi0243-0124-f2"/>
      </fig>
      <p>Two sets of test images were generated by convolving the synthetic image with PSF and degrading with Poisson noise. Various SNRs (13 different SNR values in total) were obtained by scaling the values of the synthetic image before degrading. For example of degraded image, see the first column of <xref ref-type="fig" rid="fig02">Fig. 2</xref>. The sets of test images were deconvolved using different regularization parameter λ values (100 different λ values in total) and compared with the synthetic image.</p>
      <p>To quantify the quality of the deconvolution, we use mean squared error (MSE) between original object (e.g. synthetic image) and deconvolved images<disp-formula id="m12"><graphic xlink:href="jmi0243-0124-m12"/><label>(12)</label></disp-formula></p>
      <p>In addition, we follow deconvolution process by computing relative changes between two estimates<disp-formula id="m13"><graphic xlink:href="jmi0243-0124-m13"/><label>(13)</label></disp-formula>where <italic>d</italic> shows the distance between the two estimates in iteration steps. In this paper, we consider only τ<sub>1</sub> and τ<sub>2</sub>.</p>
    </sec>
  </sec>
  <sec>
    <title>Results</title>
    <p>The RL deconvolution algorithm with TV regularization has been shown to give good deconvolution results with a carefully chosen regularization parameter λ. Because finding good parameter value to the algorithm is difficult, our aim is to estimate this value from microscope images. To test the effectiveness of the deconvolution method, we deconvolved synthetic images that were degraded with various Poisson noise levels. Following this, deconvolution of images acquired on confocal and widefield microscopes are shown to demonstrate the effectiveness of the algorithm in practice.</p>
    <sec>
      <title>Deconvolving synthetic images</title>
      <p>The effectiveness of the deconvolution method can be assessed with the use of a synthetic image which is convolved and degraded with different Poisson noise levels. To ensure that this synthetic image represents similar textures as in cells, we used images of mitochondria and sarcolemma in rat cardiomyocyte where the noise was smoothed out by robustly convolving and deconvolving the image several times [<xref ref-type="disp-formula" rid="m11">Eq. (11)</xref>].</p>
      <p>For example, the synthetic image from mitochondria recording is presented in the first row of the second column of <xref ref-type="fig" rid="fig02">Fig. 2</xref>. The blocky-like texture in this synthetic image consists of different geometrical shapes and intensities: spherical shapes, lines, homogeneous and heterogeneous areas. Two test images with different SNRs are shown in the first column of <xref ref-type="fig" rid="fig02">Fig. 2</xref>. The second and third columns of <xref ref-type="fig" rid="fig02">Fig. 2</xref> show images deconvolved using our λ estimation procedure [<xref ref-type="disp-formula" rid="m5">Eq. (5)</xref>] and optimal regularization parameter λ<sub>opt</sub>, respectively. The procedure for determining λ<sub>opt</sub> is described later. Because for synthetic images the original image is known, the actual efficiency of the deconvolution algorithm can be assessed directly by using the MSE [<xref ref-type="disp-formula" rid="m12">Eq. (12)</xref>]. The MSE provides a mean to measure the difference between the deconvolved and original image. The larger MSE value corresponds to larger difference between images.</p>
      <p><xref ref-type="fig" rid="fig03">Fig. 3A</xref> shows the MSE between the original and estimated image for each iteration of the deconvolution process. The MSE was computed from the results which were obtained by deconvolving degraded original image with Poisson noise such that SNR = 22.7 using the λ estimation formula <xref ref-type="disp-formula" rid="m5">Eq. (5)</xref> and various fixed λ values. In the presence of noise, we see that the MSE is smaller when using the RL algorithm with TV regularization rather than the traditional RL algorithm (λ= 0). Looking at <xref ref-type="fig" rid="fig03">Fig. 3A</xref>, we see that when λ is small, the MSE between the original and deconvolved images decreases and reaches its minimum in a small number of iterations, after which the MSE starts to increase monotonically. When the regularization parameter value is larger (e.g. λ= 4.0), the deconvolution process stabilizes shortly after passing the MSE minimum. However, at larger λ values (λ= 7.0), the deconvolution process is not able to enhance image considerably which is clear from observation of MSE. Although deconvolving the test image with SNR = 22.7, the lowest MSE = 0.00528 was obtained at the 15th iteration step with regularization parameter λ= 2.5. When using our estimated λ, the deconvolution process reached its best result at the 25th iteration step with MSE = 0.000593. The results of 0th, 3rd, 8th, …, 103th, iterations are given in <xref ref-type="fig" rid="fig04">Fig. 4</xref>. Note that λ<sub>lsq</sub> achieves its maximum at third iteration and MSE achieves its minimum at 25th iteration. Our stopping criterion suggests stopping iteration at 8th step when MSE = 0.00635 for this particular case.</p>
      <fig id="fig03" position="float">
        <label>Fig. 3</label>
        <caption>
          <p>The analysis of deconvolution for degraded image of blocky-like texture with Poisson noise, SNR = 22.7. (A) The evolution of the mean squared error (MSE) during iteration. The deconvolution process converges to a solution that is slightly different from the original image: MSE stabilizes to a certain nonzero level. The nearest result to original image is achieved with λ= 2.5 at iteration step 15 when MSE is minimal. (B) The evolution of relative change between estimates. Here τ<sub>1</sub> denotes the change between iterations <italic>s</italic> and <italic>s</italic>+ 1. Note that the decrease of τ<sub>1</sub> is in correlation with the convergence of MSE whereas smaller τ<sub>1</sub> does not mean smaller MSE. (C) The evolution of the ratio between two relative changes. Symbol τ<sub>2</sub> denotes the relative change between iterations <italic>s</italic> and <italic>s</italic>+ 2. (D) Minimal MSE as a function of λ. The minimum point of the graph defines optimal λ value for that case. (E) The number of iteration steps required to achieve minimal MSE for different λ values. (F) The evolution of estimated λ during iteration. Note that estimated λ obtains its maximum at third iteration.</p>
        </caption>
        <graphic xlink:href="jmi0243-0124-f3"/>
      </fig>
      <fig id="fig04" position="float">
        <label>Fig. 4</label>
        <caption>
          <p>The results of deconvolving synthetic 3D images with SNR = 22.7. The numbers above images show the iteration step and MSE between original object and deconvolved image. On the iteration step <italic>s</italic>= 3, the λ<sub>lsq</sub> has maximal value and on the iteration step <italic>s</italic>= 25 the MSE has minimal value for this specific case. Note that there is no visible differences between results from the iteration step <italic>s</italic>= 25 and <italic>s</italic>≥ 3.</p>
        </caption>
        <graphic xlink:href="jmi0243-0124-f4"/>
      </fig>
      <p>The behaviour of the deconvolution process was tracked using the relative change between two successive estimates [<xref ref-type="disp-formula" rid="m13">Eq. (13)</xref>], which is shown in <xref ref-type="fig" rid="fig03">Fig. 3B</xref>. Frequently, the relative change between two successive estimates τ<sub>1</sub> is used as a stopping criterion (<xref ref-type="bibr" rid="b6">Cannell <italic>et al.</italic>, 2006</xref>; <xref ref-type="bibr" rid="b12">Dey <italic>et al.</italic>, 2006</xref>). According to that criterion, if τ<sub>1</sub> falls down to a given threshold the deconvolution process is stopped. However, there are at least two problems when using this criterion in practice, as indicated later.</p>
      <p>First notice that, ideally, the stopping criterion should finish the deconvolution process when the deconvolved image is closest to ‘true’ image. From the analysis of MSE and τ<sub>1</sub> evolutions, it is clear that this is not always true (<xref ref-type="fig" rid="fig03">Figs 3A and B</xref>). Namely, as it is shown in the figure, there is no τ<sub>1</sub> value that can be used as an universal threshold for all regularization parameter values. Although it is theoretically possible to choose a threshold value for each trace individually so that deconvolution will be stopped at minimum of MSE, finding such threshold value in practice is very difficult, if impossible.</p>
      <p>Secondly, from the comparison of deconvolution processes with different TV regularization parameter values reveals that the convergence of deconvolution is not always related to small τ<sub>1</sub> values. Namely, lower τ<sub>1</sub> value would indicate stabilization of the deconvolution process and we would expect the MSE to stabilize as well. Comparison of <xref ref-type="fig" rid="fig03">Figs 3A and B</xref> at λ= 1.0 shows that the relative change τ<sub>1</sub> is monotonically decreasing but MSE starts to increase after the sixth iteration. In contrast to that, at λ= 2.5, the relative change τ<sub>1</sub> has higher values than at λ= 1.0, but from the trace of the MSE (<xref ref-type="fig" rid="fig03">Fig. 3A</xref>), the deconvolution process seems to be converged because the MSE remains relatively constant at λ= 2.5. So, there exists no such threshold value for τ<sub>1</sub> that would be applicable for both cases.</p>
      <p>It turns out that the behaviour where τ<sub>1</sub> is relatively large and MSE is stationary, indicates oscillations between several successive iteration steps. To demonstrate that, let us define the ratio between two different relative changes τ<sub>2</sub>/τ<sub>1</sub>, where τ<sub>1</sub> denotes the relative change between <italic>s</italic> and <italic>s</italic>+ 1 and τ<sub>2</sub> denotes the change between <italic>s</italic> and <italic>s</italic>+ 2 iteration steps. Following the evolution of τ<sub>2</sub>/τ<sub>1</sub> in <xref ref-type="fig" rid="fig03">Fig. 3C</xref> at λ= 2.5, the ratio decreases and stabilizes to a level smaller than 1. By contrast, using λ= 0 (<xref ref-type="fig" rid="fig03">Fig. 3A</xref>), the ratio stabilizes at a level above 1 while the MSE increases during iteration. Thus, for the cases where the ratio falls under 1 and stabilizes, we can assume that the deconvolution process starts to oscillate between several successive iteration steps. However, for the case where τ<sub>2</sub>/τ<sub>1</sub> is larger than 1, we can assume that the changes in the images are progressive during deconvolution leading to changes in the MSE, as for λ= 0.</p>
    </sec>
    <sec>
      <title>Optimal TV regularization parameter value and stopping criterion</title>
      <p>As it is shown in <xref ref-type="fig" rid="fig03">Fig. 3A</xref>, the minimal MSE value is different for each λ value. <xref ref-type="fig" rid="fig03">Fig. 3D</xref> shows minimal MSE as a function of λ. Note that the minimal point defines the value of optimal λ for the particular case. So, the procedure for determining λ<sub>opt</sub> consists of finding the minimum point of the minimal MSE and λ graph.</p>
      <p>The optimal number of steps is defined as the number of steps needed to reach a minimal MSE value. In <xref ref-type="fig" rid="fig03">Fig. 3E</xref>, we see that the optimal number of steps varies between different λ values. For example, if λ is fixed and close to λ<sub>opt</sub> (2.5 for this particular case), the deconvolution process requires more steps to reach the minimal MSE.</p>
      <p>In practice, the original image is unknown and we cannot use MSE as a measure of the quality of deconvolved images. So, appropriate stopping criterion that does not depend on the original image is needed. For this we used the evolution of λ<sub>lsq</sub> during iteration (<xref ref-type="fig" rid="fig03">Fig. 3F</xref>). The general behaviour of λ<sub>lsq</sub> during the deconvolution process can be described as follows. In the beginning, λ<sub>lsq</sub> values are small, increase to the maximum after which the value stabilizes to a certain nonzero level. We notice that the points where MSE is minimal and where λ<sub>lsq</sub> obtains a maximum value are correlated (<xref ref-type="fig" rid="fig03">Fig. 3A and 3F</xref>). Thus, the evolution of λ<sub>lsq</sub> can be used as a stopping criterion.</p>
      <p>Similar analysis was performed on test images with different SNR values as well as for honeycomb-like texture cases. Overall, there were 13 different test cases with various SNRs. From our simulations it is clear that for different SNR the value of λ<sub>opt</sub> is not the same. In <xref ref-type="fig" rid="fig05">Fig. 5A</xref> where the MSE <sub>min</sub> is displayed as a function of λ, we see that the minimum points of graphs are shifting towards zero as the SNR increases. Therefore, the value of λ<sub>opt</sub> is decreasing with the increase of SNR. Note that when deconvolving images without noise (SNR =∞) and taking λ= 0, the original image is obtained (MSE → 0). By contrast, when deconvolving images with noise, the iteration process never converges to the original image. Furthermore, from the analysis of the values of λ<sub>opt</sub> and SNR in <xref ref-type="fig" rid="fig05">Fig. 5B</xref>, we notice an inverse relation between λ<sub>opt</sub> and SNR: <inline-formula><inline-graphic xlink:href="jmi0243-0124-mu7.jpg" mimetype="image"/></inline-formula>. As a robust estimate, we suggest using λ= 50/SNR.</p>
      <fig id="fig05" position="float">
        <label>Fig. 5</label>
        <caption>
          <p>The analysis of deconvolution at different SNR. (A) Minimal MSE as a function of λ for various SNR values. Note that the optimal λ (defined as the minimum point of MSE<sub>min</sub>) is smaller for higher SNR. The original image is achieved only when noise is not present and the TV term is disabled (λ= 0). (B) The relations between SNR and optimal λ for two different types of image textures. The confocal images of mitochondria and sarcolemma in cardiac cells are used to obtain synthetics image with blocky- and honeycomb-like textures, respectively. Note the approximate exponential relations λ<sub>opt</sub>∼ 1/SNR, see text for details. (C) The relation between SNR and minimal MSE for disabled TV, estimated λ and optimal λ values, respectively. Restored image contains blocky-like textures. (D) MSE as a function of SNR and stopping iteration step. (E) Same as C, restored image contains honeycomb-like texture. (F) Same as D, restored image contains honeycomb-like texture.</p>
        </caption>
        <graphic xlink:href="jmi0243-0124-f5"/>
      </fig>
      <p>For microscope images we use λ<sub>lsq</sub> because finding the optimal λ is a tedious and nontrivial process. By comparing the deconvolution results for synthetic images that use λ<sub>lsq</sub>, λ<sub>opt</sub> and λ= 0 at different noise levels, we assessed the performance of the λ estimating formula. <xref ref-type="fig" rid="fig05">Figs 5C and E</xref> summarize the deconvolution results in terms of minimal MSE for different noise levels and λ selections. From the graphs we conclude that using optimal regularization always gives better results (smaller MSE), and generally, using regularization is necessary in the presence of noise. In addition, there exist a range of SNR values (5–100) where using λ<sub>lsq</sub> gives the same order of magnitude for minimal MSE as using λ<sub>opt</sub>.</p>
      <p>As it was suggested earlier, evolution of λ<sub>lsq</sub> can be used as a stopping criterion. We suggest to stop the iteration process after five steps of obtaining λ<sub>lsq</sub> maximum value. According to our simulations, such stopping criteria leads to deconvolved image with the resulting MSE close to minimal MSE (<xref ref-type="fig" rid="fig05">Figs 5D and F</xref>). In addition, long and converging iterations (100 iterations after λ<sub>lsq</sub> maximum) cause MSE to diverse from the minimal MSE. This clearly shows that converging iteration does not guarantee more accurate results.</p>
    </sec>
    <sec>
      <title>Deconvolving microscope images</title>
      <p>As an example, we applied RL algorithm with TV regularization to experimentally recorded images. First, confocal images of mitochondria and sarcolemma in rat cardiomyocytes were deconvolved. Secondly, to test the performance of the algorithm, we deconvolved confocal image with the punctated stain and a widefield image.</p>
      <p>In <xref ref-type="fig" rid="fig06">Fig. 6A</xref>, where the cell was labelled with MitoTracker Green FM, cross-sections <italic>xy</italic> and <italic>yz</italic> are displayed from the middle of cell. At upper left corner, an enlarged view from the middle part of the <italic>xy</italic> cross-section is shown. From the comparison of the recorded and deconvolved image using λ<sub>lsq</sub>, we can clearly see significant improvement in the quality of the deconvolved image (compare <xref ref-type="fig" rid="fig06">Figs 6A and B</xref>). For example, the noise is reduced considerably on the whole image and mitochondria can be more easily distinguished from each other. Note the significant contrast enhancement on <italic>yz</italic> plane.</p>
      <fig id="fig06" position="float">
        <label>Fig. 6</label>
        <caption>
          <p>The image of mitochondria in rat cardiomyocyte before and after deconvolution algorithm was applied (voxel size 0.095 μm × 0.095 μm × 0.343 μm). The recorded confocal microscope image of rat cardiomyocyte mitochondria labelled with MitoTracker Green FM, note the blocky texture. (A) <italic>xy</italic> and <italic>yz</italic> cross-sections of the recorded image. At upper left corner, a zoomed region from the middle of <italic>xy</italic> cross-section is shown. (B) The seventh iteration of deconvolved recorded image A using estimated λ. Note the improvement in contrast. Noise is smoothed out and space between mitochondria has cleared.</p>
        </caption>
        <graphic xlink:href="jmi0243-0124-f6"/>
      </fig>
      <p>On the basis of our analysis, we estimated that the optimal λ value for deconvolving the image of the cell with stained mitochondria (<xref ref-type="fig" rid="fig06">Fig. 6A</xref>) is 2.5. This estimation was made assuming that the relationship between the SNR and λ<sub>opt</sub> (<xref ref-type="fig" rid="fig05">Fig. 5B</xref>) is valid for this recording as well. Comparing the result to one obtained using λ<sub>lsq</sub>, there are no visible differences (results not shown).</p>
      <p><xref ref-type="fig" rid="fig07">Fig. 7A</xref> shows a sarcolemma in rat cardiomyocyte labelled with di-8-ANEPPS. Lines seen in this image correspond to <italic>t</italic>-tubules. As in the previous example, two cross-sections and an enlarged view from the middle of the image are shown. From the comparison of recorded image and restored image (<xref ref-type="fig" rid="fig07">Figs 7A and B</xref>), we see an improvement in contrast and reduction of noise.</p>
      <fig id="fig07" position="float">
        <label>Fig. 7</label>
        <caption>
          <p>The image of sarcolemma in rat cardiomyocyte before and after deconvolution algorithm was applied (voxel size 0.063 μm × 0.063 μm × 0.387 μm). The recorded confocal microscope image of rat cardiomyocyte sarcolemma labelled with di-8-ANEPPS, note the honeycomb-like texture. (A) <italic>xy</italic> and <italic>yz</italic> cross-sections of recorded image. (B) The eighth iteration of deconvolved recorded image A with estimated λ. Note the improvement in contrast, noise is smoothed out, and <italic>t</italic>-tubules are more visible.</p>
        </caption>
        <graphic xlink:href="jmi0243-0124-f7"/>
      </fig>
      <p>To test the performance of the algorithm, we deconvolved a confocal image of a cluster of microspheres. Such cluster is similar to punctated stain which can occur in live cells when imaging distribution of ryanodine receptors, for example. As it is shown in <xref ref-type="fig" rid="fig08">Fig. 8</xref>, experimental images can be successfully deconvolved for such texture as well.</p>
      <fig id="fig08" position="float">
        <label>Fig. 8</label>
        <caption>
          <p>The image of microspheres cluster before and after deconvolution algorithm was applied (voxel size 0.054 μm × 0.054 μm × 0.188 μm). The recorded confocal microscope image of microspheres is also used for estimating PSFs, note punctated texture. (A) <italic>xy</italic> and <italic>yz</italic> cross-sections of the recorded image. At upper left corner, a zoomed region from the middle of <italic>xy</italic> cross-section is shown. (B) The eighth iteration of deconvolved recorded image A using estimated λ.</p>
        </caption>
        <graphic xlink:href="jmi0243-0124-f8"/>
      </fig>
      <p>Although the considered deconvolution algorithm is designed for confocal microscopy where Poisson noise is dominating, we have applied it to images of stained mitochondria of rat cardiomyocytes (<xref ref-type="fig" rid="fig09">Fig. 9A</xref>) acquired with a widefield fluorescence microscope. The deconvolution of such images reduces considerably out-of-focus light and reduces noise, as shown in <xref ref-type="fig" rid="fig09">Fig. 9B</xref>. However, further research is needed to improve the deconvolution result by taking into account other noise properties as well as gradients in the background field of widefield images.</p>
      <fig id="fig09" position="float">
        <label>Fig. 9</label>
        <caption>
          <p>The image of mitochondria in rat cardiomyocyte before and after deconvolution algorithm was applied (voxel size 0.132 μm × 0.132 μm × 0.398 μm). The recorded widefield fluorescence microscope image (A) of rat cardiomyocyte mitochondria labelled with MitoTracker Green FM, note the blocky texture and extensive out-of-focus light. The image is improved by deconvolution (B) leading to the reduction of out-of-focus light and reducing noise. Note that deconvolution was not able to fully remove out-of-focus light.</p>
        </caption>
        <graphic xlink:href="jmi0243-0124-f9"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>In this work, we derived a formula to estimate the TV regularization parameter for regularized RL deconvolution algorithm and developed an open source software platform IOCBio Microscope where other deconvolution algorithms can be introduced easily. In addition, we illustrated that over a certain range of SNR, the estimated λ gives as good results as with the optimal regularization parameter. As a result, we propose a practical method to deconvolve confocal microscope images that uses estimated regularization parameter depending on the input image.</p>
    <sec>
      <title>Deconvolving synthetic images</title>
      <p>We analysed the behaviour of the deconvolution algorithm on a synthetic image. Usually, synthetic images that are used in the analysis of deconvolution contain various geometrical shapes with different intensities. In this paper, we use synthetic images that are constructed from actual microscope images as described in the Materials and Methods section. Usage of such synthetic images gives us an opportunity to study the deconvolution algorithms under more realistic conditions.</p>
      <p>The RL algorithm with TV regularization requires the selection of an appropriate regularization parameter value for each image that is being deconvolved. In practice, the selection of this parameter value is based on an educated guess. However, the analysis of synthetic images (<xref ref-type="fig" rid="fig05">Fig. 5A</xref>) shows that the errors can be an order of magnitude smaller with appropriate λ value than with arbitrary λ values. In addition, <xref ref-type="fig" rid="fig05">Fig. 5B</xref> shows that the optimal λ depends on the SNR exponentially: λ<sub>opt</sub>≈ 50/SNR.</p>
      <p>Recently, methods for estimating the regularization parameter have been introduced to avoid the tedious work needed for finding the appropriate λ value. For this, <xref ref-type="bibr" rid="b14">Gilboa <italic>et al.</italic> (2003)</xref> use an adaptive variational scheme and <xref ref-type="bibr" rid="b20">Liao <italic>et al.</italic> (2009)</xref> make use of a generalized cross-validation technique. In this paper, we derived a formula <xref ref-type="disp-formula" rid="m5">Eq. (5)</xref> that is based on a least squares method and is related to findings of <xref ref-type="bibr" rid="b14">Gilboa <italic>et al.</italic> (2003)</xref>. The usage of our formula gives as good results as with optimal λ value for a certain range of SNRs (<xref ref-type="fig" rid="fig05">Figs 5C–F</xref>).</p>
    </sec>
    <sec>
      <title>Estimated regularization parameter as stopping criteria</title>
      <p>As a stopping criterion, several authors have used the relative change between two estimates (τ<sub>1</sub>) and the stopping point is determined when the relative change falls below a given threshold (<xref ref-type="bibr" rid="b44">van Kempen <italic>et al.</italic>, 1997</xref>; <xref ref-type="bibr" rid="b11">Dey <italic>et al.</italic>, 2004</xref>; <xref ref-type="bibr" rid="b27">Pankajakshan <italic>et al.</italic>, 2008</xref>). We could not use this approach for multiple reasons. First, we could not identify τ<sub>1</sub> threshold value that would fit deconvolution processes with different TV regularization parameter values. Secondly, the value of τ<sub>1</sub> was not always related to convergence of deconvolution process. Namely, we have shown (<xref ref-type="fig" rid="fig03">Figs 3A and B</xref>) that MSE can stabilize at relatively high values of τ<sub>1</sub> in some cases and the opposite can be true as well (evolving MSE at small values of τ<sub>1</sub>). The discrepancy between stable MSE and relatively large τ<sub>1</sub> was related to oscillations between several estimates obtained in successive deconvolution steps, as shown using τ<sub>2</sub>/τ<sub>1</sub> relationship in the Results. Thus, according to our analysis, the use of τ<sub>1</sub> for stopping deconvolution process would not lead to the best possible estimation of the ‘true’ image.</p>
      <p>Our approach uses the evolution of λ<sub>lsq</sub> that is computed from <xref ref-type="disp-formula" rid="m5">Eq. (5)</xref> as a stopping criterion – the deconvolution process is stopped after five iterations of λ<sub>lsq</sub> has obtained its maximum value. The analysis of MSE confirms that the minimum point of MSE is well correlated with the point where λ<sub>lsq</sub> obtains maximum value. By contrast, if the deconvolution process is prolonged, visually identifiable artefacts will be produced. This effect is well seen in <xref ref-type="fig" rid="fig05">Figs 5D and F</xref> where the results of long iterations (100 iterations after λ<sub>lsq</sub> maximum has been obtained) have noticeably larger MSE compared to the results that are stopped after λ<sub>lsq</sub> maximum point.</p>
    </sec>
    <sec>
      <title>Deconvolving confocal microscope images</title>
      <p>Although the quality of deconvolution result strongly depends on the quality of the input data, the deconvolution can improve the quality of image, even if the data is greatly corrupted by noise.</p>
      <p>However, to ensure a realistic result using iterative deconvolution algorithms, the process needs to be stopped before artefacts are created. For deconvolving microscope images, we used the RL algorithm with TV regularization using estimated λ. The optimal solution with noticeable improvements is achieved with a rather small number of iteration steps. However, prolonged iteration starts to produce artefacts. When using our λ estimation formula, the deconvolution process can be stopped at the right iteration step by monitoring the evolution of λ<sub>lsq</sub>. By contrast, when visually examining the estimates around λ<sub>lsq</sub> maximum, they look equally acceptable (<xref ref-type="fig" rid="fig04">Fig. 4</xref>). Furthermore, when using this criterion with experimental data, we noted that at higher SNRs in the initial data, the optimal number of iteration steps is larger than for smaller SNRs. This is in accordance to the results obtained from the analysis of deconvolution of synthetic images.</p>
      <p>The input for estimating the regularization parameter of the RL deconvolution algorithm is the peak SNR of a recorded image. With confocal microscopes that use photon counting detectors, the peak SNR can be directly estimated as a square of largest count value in image data. In practice, use of peak SNR can be problematic. First, staining artefacts leading to small cluster of bright pixels would determine the estimate of the ratio. Secondly, when non-photon counting confocal microscopes are used, the use of a square of largest count value in image data as an estimate of SNR is questionable. Indeed, confocal microscopes equipped with analogue light detectors record intensity in arbitrary units that depend on user settings of detector gain and offset. The both problems can be resolved if more general SNR estimate is used. For example, SNR estimate based on the variations of neighbouring voxels takes into account information from the whole image (<xref ref-type="bibr" rid="b23">de Monvel <italic>et al.</italic>, 2001</xref>). This would dampen the effect of small bright clusters in an image to SNR and, in addition, is applicable to images recorded using analogue detectors. How such estimate of SNR is related to the regularization parameter of the RL deconvolution algorithm is a subject of further studies.</p>
      <p>In addition to difficulties in estimating SNR, confocal microscopes equipped with analogue detectors can have noise properties that are different from Poisson noise. However, that can be altered by user in practice by selecting lower gain of the detector. As it has been shown earlier, with lower gain settings, Poisson noise is dominating in images (<xref ref-type="bibr" rid="b8">Cho &amp; Lockett, 2006</xref>). Furthermore, by averaging image during acquisition, user can improve general SNR (<xref ref-type="bibr" rid="b10">Conchello &amp; Lichtman, 2005</xref>) leading to a better deconvolution of the image.</p>
      <p>Another important element in deconvolution is the PSF which should be determined as accurately as possible to account for imperfections in the optical pathway. In this paper, we used PSFs obtained from the measurements of microspheres. Such PSFs account for imperfections such as asymmetry. Including asymmetry to computed PSF is not trivial because the source of the asymmetry is hard to determine. The accurate PSF is important because deconvolving with a incorrect PSF can result misleading conclusions (<xref ref-type="bibr" rid="b6">Cannell <italic>et al.</italic>, 2006</xref>). The quality of PSF plays a critical role in obtaining a high quality result, and to this end, we recommend using a measured PSF.</p>
    </sec>
    <sec>
      <title>IOCBio Microscope – a software for deconvolving microscope images</title>
      <p>In this work, our contribution includes the development of an open source software package IOCBio Microscope that collects all necessary elements for deconvolution using the RL algorithm with TV variation regularization (<xref ref-type="bibr" rid="b29">Peterson, 2010a</xref>). This includes, reading microscope images of various formats (TIFF, RAW and LSM files), estimating PSF from the measurements of microspheres, deconvolving images with different algorithm options, etc. The software is implemented in Python which has proven itself as an excellent prototype language for testing algorithms. The computationally expensive parts are implemented in C and FFTW library is used with multiple threads to reduce CPU time for deconvolution considerably. For example, deconvolving an image stack of size 32 × 512 × 512 with 100 iterations takes about 10 min on a standard desktop computer. We anticipate that this deconvolution software package becomes a platform for testing different deconvolution algorithms. Furthermore, the software has reasonable graphical user interface that makes it easy to use for enhancing microscope images. The software can be run in a computer cluster environment such as Sun Grid Engine to parallelize deconvolution tasks.</p>
      <p>In future, we plan to implement Poisson noise removal algorithm by <xref ref-type="bibr" rid="b19">Le <italic>et al.</italic> (2007)</xref> that can be applied to estimated PSF as well as to the first estimate of deconvolution process. Application of such a noise removal can improve the efficiency of deconvolution algorithms even further. In addition, we plan to add interfaces to existing C/C++ deconvolution libraries such as Clarity and Deconv so that these algorithms could be used from the Python based IOCBio Microscope package. The availability of semi-automatic wrapper generation tools like SWIG (<xref ref-type="bibr" rid="b4">Beazley, 2003</xref>) and F2PY (<xref ref-type="bibr" rid="b28">Peterson, 2009</xref>) as well as the standard Python ctypes module makes wrapping C, C++ or Fortran software libraries to Python-based platform particularly easy. See <xref ref-type="bibr" rid="b31">Peterson (2010c)</xref> for an example of wrapping the Deconv library to Python.</p>
      <p>Although this paper deals with confocal microscopy and deconvolving its images, the IOCBio Microscope software has extensions to apply deconvolution algorithms to the images of widefield microscopy as well. In particular, the algorithm for estimating PSF from the measurements of microspheres is adapted to deal with specific properties of widefield microscopy recordings such as relatively high level and nonuniform background field, different noise model, etc. The software can be used for testing deconvolution algorithms on recordings of widefield microscopy, similarly to what we have done in this paper for recordings of confocal microscopy. However, as seen in <xref ref-type="fig" rid="fig09">Fig. 9</xref>, more work is required to improve further the deconvolution results of widefield images by using the RL algorithm. It must take into account more appropriate image formation model for a widefield microscope that have other noise properties and more dominant background field gradients than in confocal microscope.</p>
    </sec>
  </sec>
  <sec>
    <title>Conclusions</title>
    <p>To conclude, we have developed an open source software package IOCBio Microscope that can be used for deconvolving images in practice. The developed software package can be also used as a platform for testing new deconvolution algorithms. We have derived a formula to estimate the TV regularization parameter for regularized RL deconvolution algorithm and shown that over a certain range of noise levels the estimated regularization parameter gives as good results as the optimal regularization parameter. Inverse relation between the optimal TV regularization parameter and image SNR is shown and taken into account in the regularization estimation. In addition, new stopping criterion for deconvolution process has been proposed.</p>
  </sec>
</body>
<back>
  <ack>
    <p>The authors thank Rikke Birkedal, Mervi Sepp who provided us with cardiomyocytes for collecting experimental data. the authors acknowledge David Schryer for his suggestion on improving the paper.</p>
    <p>The research was supported by Wellcome Trust Fellowship no. WT081755MA and the Estonian Science Foundation grant no. ETF8041 (Ph.D. stipend for M.L.).</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="b1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdelhak</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sedki</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Filtering capabilities and convergence of the van-Citter deconvolution technique</article-title>
        <source>IEEE Trans. Instrum. Meas.</source>
        <year>1992</year>
        <volume>41</volume>
        <fpage>246</fpage>
        <lpage>250</lpage>
      </element-citation>
    </ref>
    <ref id="b2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Agard</surname>
            <given-names>DA</given-names>
          </name>
        </person-group>
        <article-title>Optical sectioning microscopy: cellular architecture in three dimensions</article-title>
        <source>Annu. Rev. Biophys. Bio.</source>
        <year>1984</year>
        <volume>13</volume>
        <fpage>191</fpage>
        <lpage>219</lpage>
      </element-citation>
    </ref>
    <ref id="b3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Avinash</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Data-driven, simultaneous blur and image restoration in 3-D fluorescence microscopy</article-title>
        <source>J. Microsc.</source>
        <year>1996</year>
        <volume>183</volume>
        <fpage>145</fpage>
        <lpage>167</lpage>
      </element-citation>
    </ref>
    <ref id="b4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beazley</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>SWIG: an extensible compiler for creating scriptable scientific software</article-title>
        <source>Future Generat. Comput. Syst. (FGCS), Elsevier</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>599</fpage>
        <lpage>609</lpage>
      </element-citation>
    </ref>
    <ref id="b5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Birkedal</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Shiels</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Vendelin</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Three-dimensional mitochondrial arrangement in ventricular myocytes: from chaos to order</article-title>
        <source>Am. J. Physiol. Cell. Physiol.</source>
        <year>2006</year>
        <volume>291</volume>
        <fpage>C1148</fpage>
        <lpage>C1158</lpage>
        <pub-id pub-id-type="pmid">16822946</pub-id>
      </element-citation>
    </ref>
    <ref id="b6">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cannell</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>McMorland</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Soeller</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Pawley</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Image enhancement by deconvolution</article-title>
        <source>Handbook of Biological Confocal Microscopy</source>
        <year>2006</year>
        <edition>3 edn.</edition>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>488</fpage>
        <lpage>497</lpage>
      </element-citation>
    </ref>
    <ref id="b7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carrington</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Lynch</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Isenberg</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fogarty</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fay</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Superresolution three-dimensional images of fluorescence in cells with minimal light exposure</article-title>
        <source>Science</source>
        <year>1995</year>
        <volume>268</volume>
        <fpage>1483</fpage>
        <lpage>1487</lpage>
        <pub-id pub-id-type="pmid">7770772</pub-id>
      </element-citation>
    </ref>
    <ref id="b8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cho</surname>
            <given-names>EH</given-names>
          </name>
          <name>
            <surname>Lockett</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Calibration and standardization of the emission light path of confocal microscopes</article-title>
        <source>J. Microsc.</source>
        <year>2006</year>
        <volume>223</volume>
        <fpage>15</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="pmid">16872427</pub-id>
      </element-citation>
    </ref>
    <ref id="b9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Conchello</surname>
            <given-names>J-A</given-names>
          </name>
        </person-group>
        <article-title>Superresolution and convergence properties of the expectation-maximization algorithm for maximum-likelihood deconvolution of incoherent images</article-title>
        <source>J. Opt. Soc. Am. A</source>
        <year>1998</year>
        <volume>15</volume>
        <fpage>2609</fpage>
        <lpage>2619</lpage>
      </element-citation>
    </ref>
    <ref id="b10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Conchello</surname>
            <given-names>J-A</given-names>
          </name>
          <name>
            <surname>Lichtman</surname>
            <given-names>JW</given-names>
          </name>
        </person-group>
        <article-title>Optical sectioning microscopy</article-title>
        <source>Nat. Methods</source>
        <year>2005</year>
        <volume>2</volume>
        <fpage>920</fpage>
        <lpage>931</lpage>
        <pub-id pub-id-type="pmid">16299477</pub-id>
      </element-citation>
    </ref>
    <ref id="b11">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Dey</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Blanc-Feraud</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zimmer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kam</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Olivo-Marin</surname>
            <given-names>J-C</given-names>
          </name>
          <name>
            <surname>Zerubia</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>3D microscopy deconvolution using Richardson-Lucy algorithm with total variation regularization</article-title>
        <source>Technical Report 5272</source>
        <year>2004</year>
        <publisher-name>INRIA</publisher-name>
      </element-citation>
    </ref>
    <ref id="b12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dey</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Blanc-Feraud</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zimmer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kam</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Olivo-Marin</surname>
            <given-names>J-C</given-names>
          </name>
          <name>
            <surname>Zerubia</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Richardson-Lucy algorithm with total variation regularization for 3D confocal microscope deconvolution</article-title>
        <source>Microsc. Res. Techniq.</source>
        <year>2006</year>
        <volume>69</volume>
        <fpage>260</fpage>
        <lpage>266</lpage>
      </element-citation>
    </ref>
    <ref id="b13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frigo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>SG</given-names>
          </name>
        </person-group>
        <article-title>The design and implementation of FFTW3</article-title>
        <source>Proc. IEEE</source>
        <year>2005</year>
        <volume>93</volume>
        <fpage>216</fpage>
        <lpage>231</lpage>
      </element-citation>
    </ref>
    <ref id="b14">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gilboa</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zeevi</surname>
            <given-names>YY</given-names>
          </name>
          <name>
            <surname>Sochen</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Texture preserving variational denoising using an adaptive fidelity term</article-title>
        <source>Proceedings of the VLSM</source>
        <year>2003</year>
        <publisher-loc>Nice, France</publisher-loc>
        <fpage>137</fpage>
        <lpage>144</lpage>
      </element-citation>
    </ref>
    <ref id="b15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holmes</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Blind deconvolution of quantum-limited incoherent imagery: maximum-likelihood approach</article-title>
        <source>J. Opt. Soc. Am. A</source>
        <year>1992</year>
        <volume>9</volume>
        <fpage>1052</fpage>
        <lpage>1061</lpage>
        <pub-id pub-id-type="pmid">1634965</pub-id>
      </element-citation>
    </ref>
    <ref id="b16">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Inoué</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Pawley</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Foundations of confocal scanned imaging in light microscopy</article-title>
        <source>Handbook of Biological Confocal Microscopy</source>
        <year>2006</year>
        <edition>3 edn.</edition>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>1</fpage>
        <lpage>19</lpage>
      </element-citation>
    </ref>
    <ref id="b17">
      <element-citation publication-type="webpage">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Oliphant</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Peterson</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SciPy: Open source scientific tools for Python</article-title>
        <year>2001</year>
        <comment>
          <ext-link ext-link-type="uri" xlink:href="http://www.scipy.org/">http://www.scipy.org/</ext-link>
        </comment>
      </element-citation>
    </ref>
    <ref id="b18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lai</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ober</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Noise suppression of point spread functions and its influence on deconvolution of three-dimensional fluorescence microscopy image sets</article-title>
        <source>J. Microsc.</source>
        <year>2005</year>
        <volume>217</volume>
        <fpage>93</fpage>
        <lpage>108</lpage>
        <pub-id pub-id-type="pmid">15655067</pub-id>
      </element-citation>
    </ref>
    <ref id="b19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Le</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chartrand</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Asaki</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>A variational approach to reconstructing images corrupted by Poisson noise</article-title>
        <source>J. Math. Imaging Vis.</source>
        <year>2007</year>
        <volume>27</volume>
        <fpage>257</fpage>
        <lpage>263</lpage>
      </element-citation>
    </ref>
    <ref id="b20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Selection of regularization parameter in total variation image restoration</article-title>
        <source>J. Opt. Soc. Am. A</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>2311</fpage>
        <lpage>2320</lpage>
      </element-citation>
    </ref>
    <ref id="b21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lucy</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>An iterative technique for the rectification of observed distributions</article-title>
        <source>Astron. J.</source>
        <year>1974</year>
        <volume>79</volume>
        <fpage>745</fpage>
        <lpage>754</lpage>
      </element-citation>
    </ref>
    <ref id="b22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Markham</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Conchello</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Parametric blind deconvolution of microscopic images: a robust method for the simultaneous estimation of image and blur</article-title>
        <source>J. Opt. Soc. Am. A</source>
        <year>1999</year>
        <volume>16</volume>
        <fpage>2377</fpage>
        <lpage>2391</lpage>
      </element-citation>
    </ref>
    <ref id="b23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Monvel</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Calvez</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Ulfendahl</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Image restoration for confocal microscopy: improving the limits of deconvolution, with application to the visualization of the mammalian hearing organ</article-title>
        <source>Biophys. J.</source>
        <year>2001</year>
        <volume>80</volume>
        <fpage>2455</fpage>
        <lpage>2470</lpage>
        <pub-id pub-id-type="pmid">11325744</pub-id>
      </element-citation>
    </ref>
    <ref id="b24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Monvel</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Scarfone</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Calvez</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Ulfendahl</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Image-adaptive deconvolution for three-dimensional deep biological imaging</article-title>
        <source>Biophys. J.</source>
        <year>2003</year>
        <volume>85</volume>
        <fpage>3991</fpage>
        <lpage>4001</lpage>
        <pub-id pub-id-type="pmid">14645088</pub-id>
      </element-citation>
    </ref>
    <ref id="b25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Neelamani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Baraniuk</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>ForWaRD: Fourier-wavelet regularized deconvolution for ill-conditioned systems</article-title>
        <source>IEEE Trans. Signal Process.</source>
        <year>2004</year>
        <volume>52</volume>
        <fpage>418</fpage>
        <lpage>433</lpage>
      </element-citation>
    </ref>
    <ref id="b26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oliphant</surname>
            <given-names>TE</given-names>
          </name>
        </person-group>
        <article-title>Python for scientific computing</article-title>
        <source>Comput. Sci. Eng.</source>
        <year>2007</year>
        <volume>9</volume>
        <fpage>10</fpage>
        <lpage>20</lpage>
      </element-citation>
    </ref>
    <ref id="b27">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Pankajakshan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Blanc Féraud</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kam</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Olivo Marin</surname>
            <given-names>J-C</given-names>
          </name>
          <name>
            <surname>Zerubia</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Parametric blind deconvolution for confocal laser scanning microscopy (CLSM) – proof of concept</article-title>
        <source>Research Report RR-6493</source>
        <year>2008</year>
        <publisher-name>INRIA</publisher-name>
      </element-citation>
    </ref>
    <ref id="b28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peterson</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>F2PY: a tool for connecting Fortran and Python programs</article-title>
        <source>IJCSE</source>
        <year>2009</year>
        <volume>4</volume>
        <fpage>296</fpage>
        <lpage>305</lpage>
      </element-citation>
    </ref>
    <ref id="b29">
      <element-citation publication-type="webpage">
        <person-group person-group-type="author">
          <name>
            <surname>Peterson</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>IOCBio Microscope software</article-title>
        <year>2010a</year>
        <comment>
          <ext-link ext-link-type="uri" xlink:href="http://iocbio.googlecode.com/">http://iocbio.googlecode.com/</ext-link>
        </comment>
      </element-citation>
    </ref>
    <ref id="b30">
      <element-citation publication-type="webpage">
        <person-group person-group-type="author">
          <name>
            <surname>Peterson</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>List of open-source deconvolution software</article-title>
        <year>2010b</year>
        <comment>
          <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/iocbio/wiki/DeconvolutionSoftware">http://code.google.com/p/iocbio/wiki/DeconvolutionSoftware</ext-link>
        </comment>
      </element-citation>
    </ref>
    <ref id="b31">
      <element-citation publication-type="webpage">
        <person-group person-group-type="author">
          <name>
            <surname>Peterson</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>PyLibDeconv – a Python wrapper of the Deconv library</article-title>
        <year>2010c</year>
        <comment>
          <ext-link ext-link-type="uri" xlink:href="http://pylibdeconv.googlecode.com/">http://pylibdeconv.googlecode.com/</ext-link>
        </comment>
      </element-citation>
    </ref>
    <ref id="b32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Preza</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Conchello</surname>
            <given-names>J-A</given-names>
          </name>
        </person-group>
        <article-title>Depth-variant maximum-likelihood restoration for three-dimensional fluorescence microscopy</article-title>
        <source>J. Opt. Soc. Am. A</source>
        <year>2004</year>
        <volume>21</volume>
        <fpage>1593</fpage>
        <lpage>1601</lpage>
      </element-citation>
    </ref>
    <ref id="b33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Preza</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>McNally</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Regularized linear method for reconstruction of three-dimensional microscopic objects from optical sections</article-title>
        <source>J. Opt. Soc. Am. A</source>
        <year>1992</year>
        <volume>9</volume>
        <fpage>219</fpage>
        <lpage>228</lpage>
        <pub-id pub-id-type="pmid">1542061</pub-id>
      </element-citation>
    </ref>
    <ref id="b34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Preza</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Conchello</surname>
            <given-names>J-A</given-names>
          </name>
        </person-group>
        <article-title>Image reconstruction for 3D light microscopy with a regularized linear method incorporating a smoothness prior</article-title>
        <source>Proc. SPIE</source>
        <year>1993</year>
        <volume>1905</volume>
        <fpage>129</fpage>
        <lpage>139</lpage>
      </element-citation>
    </ref>
    <ref id="b35">
      <element-citation publication-type="webpage">
        <person-group person-group-type="author">
          <name>
            <surname>Quammen</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Clarity – a C++ open-source deconvolution software library</article-title>
        <year>2007</year>
        <comment>
          <ext-link ext-link-type="uri" xlink:href="http://cismm.cs.unc.edu/downloads/">http://cismm.cs.unc.edu/downloads/</ext-link>
        </comment>
      </element-citation>
    </ref>
    <ref id="b36">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richardson</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Bayesian-based iterative method of image restoration</article-title>
        <source>J. Opt. Soc. Am.</source>
        <year>1972</year>
        <volume>62</volume>
        <fpage>55</fpage>
        <lpage>59</lpage>
      </element-citation>
    </ref>
    <ref id="b37">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sepp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vendelin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vija</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Birkedal</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>ADP compartmentation analysis reveals coupling between pyruvate kinase and ATPases in heart muscle</article-title>
        <source>Biophys. J.</source>
        <year>2010</year>
        <volume>98</volume>
        <fpage>2785</fpage>
        <lpage>2793</lpage>
        <pub-id pub-id-type="pmid">20550890</pub-id>
      </element-citation>
    </ref>
    <ref id="b38">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Shaw</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Pawley</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Comparison of widefield/deconvolution and confocal microscopy for three-dimensional imaging</article-title>
        <source>Handbook of Biological Confocal Microscopy</source>
        <year>2006</year>
        <edition>3 edn.</edition>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>453</fpage>
        <lpage>467</lpage>
      </element-citation>
    </ref>
    <ref id="b39">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shaw</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Rawlins</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>The point-spread function of a confocal microscope: its measurement and use in deconvolution of 3-D data</article-title>
        <source>J. Microsc.</source>
        <year>1991a</year>
        <volume>163</volume>
        <fpage>151</fpage>
        <lpage>165</lpage>
      </element-citation>
    </ref>
    <ref id="b40">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shaw</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Rawlins</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Three-dimensional fluorescence microscopy</article-title>
        <source>Prog. Biophys. Mol. Biol.</source>
        <year>1991b</year>
        <volume>56</volume>
        <fpage>187</fpage>
        <lpage>213</lpage>
        <pub-id pub-id-type="pmid">1771232</pub-id>
      </element-citation>
    </ref>
    <ref id="b41">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kosmacek</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Ianzini</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mackey</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>An open-source deconvolution software package for 3-D quantitative fluorescence microscopy imaging</article-title>
        <source>J. Microsc.</source>
        <year>2009</year>
        <volume>236</volume>
        <fpage>180</fpage>
        <lpage>193</lpage>
        <pub-id pub-id-type="pmid">19941558</pub-id>
      </element-citation>
    </ref>
    <ref id="b42">
      <element-citation publication-type="webpage">
        <person-group person-group-type="author">
          <name>
            <surname>Valdimarsson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Preza</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Computational optical sectioning microscopy open source (COSMOS) software package</article-title>
        <year>2007</year>
        <comment>
          <ext-link ext-link-type="uri" xlink:href="http://cirl.memphis.edu/cosmos/">http://cirl.memphis.edu/cosmos/</ext-link>
        </comment>
      </element-citation>
    </ref>
    <ref id="b43">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Kempen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>van Vliet</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>The influence of the regularization parameter and the first estimate on the performance of Tikhonov regularized non-linear image restoration algorithms</article-title>
        <source>J. Microsc.</source>
        <year>2000</year>
        <volume>198</volume>
        <fpage>63</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="pmid">10781209</pub-id>
      </element-citation>
    </ref>
    <ref id="b44">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Kempen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>van Vliet</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Verveer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>van der Voort</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A quantitative comparison of image restoration methods for confocal microscopy</article-title>
        <source>J. Microsc.</source>
        <year>1997</year>
        <volume>185</volume>
        <fpage>354</fpage>
        <lpage>365</lpage>
      </element-citation>
    </ref>
    <ref id="b45">
      <element-citation publication-type="webpage">
        <person-group person-group-type="author">
          <name>
            <surname>van Rossum</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Python programming language</article-title>
        <year>1991</year>
        <comment>
          <ext-link ext-link-type="uri" xlink:href="http://www.python.org/">http://www.python.org/</ext-link>
        </comment>
      </element-citation>
    </ref>
    <ref id="b46">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vendelin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Birkedal</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Anisotropic diffusion of fluorescently labeled ATP in rat cardiomyocytes determined by raster image correlation spectroscopy</article-title>
        <source>Am. J. Physiol. Cell Physiol.</source>
        <year>2008</year>
        <volume>295</volume>
        <fpage>C1302</fpage>
        <lpage>C1315</lpage>
        <pub-id pub-id-type="pmid">18815224</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
