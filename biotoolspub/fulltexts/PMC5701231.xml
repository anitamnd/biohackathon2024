<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5701231</article-id>
    <article-id pub-id-type="pmid">29176663</article-id>
    <article-id pub-id-type="publisher-id">16520</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-017-16520-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>propr: An R-package for Identifying Proportionally Abundant Features Using Compositional Data Analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0286-6329</contrib-id>
        <name>
          <surname>Quinn</surname>
          <given-names>Thomas P.</given-names>
        </name>
        <address>
          <email>contacttomquinn@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1650-0064</contrib-id>
        <name>
          <surname>Richardson</surname>
          <given-names>Mark F.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lovell</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Crowley</surname>
          <given-names>Tamsyn M.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0526 7079</institution-id><institution-id institution-id-type="GRID">grid.1021.2</institution-id><institution>Deakin University, Bioinformatics Core Research Group, Geelong, </institution></institution-wrap>Victoria, Australia </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0526 7079</institution-id><institution-id institution-id-type="GRID">grid.1021.2</institution-id><institution>Deakin University, Centre for Molecular and Medical Research, Geelong, </institution></institution-wrap>Victoria, Australia </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0526 7079</institution-id><institution-id institution-id-type="GRID">grid.1021.2</institution-id><institution>Deakin University, Centre for Integrative Ecology, Geelong, </institution></institution-wrap>Victoria, Australia </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000000089150953</institution-id><institution-id institution-id-type="GRID">grid.1024.7</institution-id><institution>Queensland University of Technology, </institution></institution-wrap>Brisbane, Queensland Australia </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>11</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>11</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>7</volume>
    <elocation-id>16252</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>5</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>6</day>
        <month>11</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">In the life sciences, many assays measure only the relative abundances of components in each sample. Such data, called <italic>compositional</italic> data, require special treatment to avoid misleading conclusions. Awareness of the need for caution in analyzing compositional data is growing, including the understanding that correlation is not appropriate for relative data. Recently, researchers have proposed proportionality as a valid alternative to correlation for calculating pairwise association in relative data. Although the question of how to best measure proportionality remains open, we present here a computationally efficient R package that implements three measures of proportionality. In an effort to advance the understanding and application of proportionality analysis, we review the mathematics behind proportionality, demonstrate its application to genomic data, and discuss some ongoing challenges in the analysis of relative abundance data.</p>
    </abstract>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par2">Advances in the technology used to assay biological systems have led to a rapid increase in the amount of data generated. However, there has not yet emerged a clear consensus over the best method for analyzing these data. In fact, some of the most commonly used methods fundamentally ignore the underlying nature of the data studied. Count data, such as those produced by high-throughput sequencing, belong within the domain of relative data. Other examples of relative data include data generated by RNA-sequencing (RNA-Seq), chromatin immunoprecipitation sequencing (ChIP-Seq), Methyl-Capture sequencing, 16S amplicon-sequencing, and metabolomics. Methods that ignore the relative nature of these data yield erroneous results.</p>
    <p id="Par3">Compositional data have two key geometric properties. First, the total sum of all component values is an artifact of the sampling procedure<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Second, the distance between component values is only meaningful proportionally (e.g., the difference between 100 and 200 counts carries the same information as the difference between 1000 and 2000 counts)<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Biological count data (e.g., gene expression data from RNA-Seq), as relative data, also have these properties. Any number of factors, such as technical variability or differences in experiment-specific abundance, can impact the total number of counts (sometimes called the library size). Simply dividing count data by the library size does not address the systematic biases in RNA-Seq data. Although several normalization strategies exist, the choice of method can drastically change the number and identity of genes reported as differentially expressed<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. This sensitivity to normalization holds true for other modes of compositional data as well<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. Moreover, some methods, such as trimmed mean of M (TMM) normalization, give different results depending on how lowly expressed genes get removed from the data<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>.</p>
    <p id="Par4">By ignoring the relative nature of biological count data, investigators implicitly assume that absolute differences between counts have meaning<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. That is, they assume the data exist in real Euclidean space<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. This may explain why there has emerged a number of hyper-parameterized, assay-specific normalization methods used in the calculation of differential abundance that fail to generalize to data produced by other assays<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. Meanwhile, methods that accommodate compositional data, such as the ALDEx2 package for R, aim to offer a unified way to compute differential abundance regardless of the data source<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. However, the ALDEx2 package lacks a way to measure association in relative data.</p>
    <p id="Par5">Correlation has often been applied inappropriately to compositional data in the life sciences<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. As Pearson warned in 1896, correlation gives spurious results when applied to relative data: i.e., given three statistically independent variables, X, Y, and Z, the ratios X/Z and Y/Z will correlate with one another by virtue of their shared denominator<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. If we consider that Z may represent, for example, the library size, we see how two uncorrelated features, X and Y, may appear correlated even when they are not. Spurious correlation is not merely a statistical concern: when applied to real biological data, correlation can lead to wrong conclusions<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>. For example, one might incorrectly conclude that there exists a coordinated regulation among a module of transcriptionally independent genes.</p>
    <p id="Par6">As an alternative to correlation, proportionality is a measure of association that is valid for compositional data<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR8">8</xref></sup>. Borrowing from compositional data analysis (CoDA) principals, this approach uses a log-ratio transformation (*LR) of the original feature vectors in order to transpose the data from a simplex into real Euclidean space<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR9">9</xref></sup>. These transformed abundances then provide a substrate for calculating the <italic>log-ratio variance</italic> (VLR), defined as the variance of the ratio of two log transformed feature vectors (<italic>var</italic>*LR(<italic>X</italic>)/*LR(<italic>Y</italic>))<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. Interestingly, the VLR is the same for relative values and their absolute equivalent. However, the VLR lacks a scale that would otherwise make it possible to compare dependency across multiple feature pairs. In essence, what we call proportionality is a modification to the VLR that establishes scale.</p>
    <p id="Par7">The propr package, now available through the Comprehensive R Archive Network (CRAN), implements two measures of proportionality, <italic>ϕ</italic><sup><xref ref-type="bibr" rid="CR5">5</xref></sup> and <italic>ρ</italic><sub><italic>p</italic></sub><sup><xref ref-type="bibr" rid="CR8">8</xref></sup> (defined formally in the next section). Like the Pearson correlation coefficient, the metric <italic>ρ</italic><sub><italic>p</italic></sub> is naturally symmetric in its arguments. However, we can make <italic>ϕ</italic> naturally symmetric too by slightly altering its definition, as shown in the next section. Otherwise, <italic>ρ</italic><sub><italic>p</italic></sub> ranges from [−1, 1], reinforcing its analogy to correlation, while <italic>ϕ</italic> ranges from [0, ∞), reinforcing its analogy to dissimilarity. Yet, it is the conceptual and mathematical link between <italic>ϕ</italic> and <italic>ρ</italic><sub><italic>p</italic></sub> metrics that allows us to present the propr package as a single portal to proportionality analysis.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p id="Par8">Consider a matrix of <italic>D</italic> features (as columns) measured across <italic>N</italic> samples (as rows) exposed to a binary or continuous event. This event might involve case-control status, treatment status, treatment dose, or time. Proportionality, as analogous to, but distinct from, correlation, measures the association between two log-ratio transformed feature vectors. By default, this package uses the centered log-ratio transformation (clr); this transformation scales each subject vector by its geometric mean (indicated as <italic>g</italic>(<italic>x</italic>)). However, we also include an implementation of the additive log-ratio transformation (alr). These transformations get applied to each subject vector, <italic>x</italic>, according to the following definitions:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{clr}}(x)=[\mathrm{ln}\,\frac{{x}_{i}}{g(x)};\mathrm{...};\,\mathrm{ln}\,\frac{{x}_{D}}{g(x)}]$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mi mathvariant="normal">clr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mspace width=".10em"/><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>;</mml:mo><mml:mn>...</mml:mn><mml:mo>;</mml:mo><mml:mspace width=".25em"/><mml:mi>ln</mml:mi><mml:mspace width=".10em"/><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:math><graphic xlink:href="41598_2017_16520_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{alr}}(x)=[\mathrm{ln}\,\frac{{x}_{i}}{{x}_{D}};\mathrm{...;}\,\mathrm{ln}\,\frac{{x}_{D-1}}{{x}_{D}}]$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mi mathvariant="normal">alr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mspace width=".10em"/><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>;</mml:mo><mml:mn>...;</mml:mn><mml:mspace width=".25em"/><mml:mi>ln</mml:mi><mml:mspace width=".10em"/><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:math><graphic xlink:href="41598_2017_16520_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
    <p id="Par9">Applying a log-ratio transformation to each sample results in a new matrix, <italic>A</italic>, containing <italic>N</italic> rows (as samples) and <italic>D</italic> columns (as features). The propr package implements three measures of proportionality in the R language, as defined for <italic>A</italic>. Note that although we calculated each row of <italic>A</italic> using Eq. <xref rid="Equ1" ref-type="">1</xref> or Eq. <xref rid="Equ2" ref-type="">2</xref>, we use the columns of this matrix to calculate proportionality. Two principal functions, phit and perb, calculate the proportionality metrics <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varphi $$\end{document}</tex-math><mml:math id="M6"><mml:mi>φ</mml:mi></mml:math><inline-graphic xlink:href="41598_2017_16520_Article_IEq1.gif"/></alternatives></inline-formula> (Eq. <xref rid="Equ3" ref-type="">3</xref>)<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> and <italic>ρ</italic><sub><italic>p</italic></sub> (Eq. <xref rid="Equ4" ref-type="">4</xref>)<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, respectively. The functions phit and perb return a matrix of <italic>D</italic><sub>2</sub> elements relating each combination of log-ratio transformed feature vectors, <italic>A</italic><sub><italic>i</italic></sub> and <italic>A</italic><sub><italic>j</italic></sub> (<italic>i</italic>, <italic>j</italic> ∈ <italic>D</italic>), according to the following definitions:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varphi ({A}_{i},{A}_{j})=\frac{var({A}_{i}-{A}_{j})}{var({A}_{i})}$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mi>φ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41598_2017_16520_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rho }_{p}({A}_{i},{A}_{j})=1-\frac{var({A}_{i}-{A}_{j})}{var({A}_{i})+var({A}_{j})}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41598_2017_16520_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
    <p id="Par10">In addition, we provide the phis function to calculate <italic>ϕ</italic><sub><italic>s</italic></sub> (Eq. <xref rid="Equ5" ref-type="">5</xref>), a naturally symmetric variant of <italic>ϕ</italic>. Interestingly, <italic>ϕ</italic><sub><italic>s</italic></sub> relates to <italic>ρ</italic><sub><italic>p</italic></sub> by a monotonic function<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, meaning you can calculate one from the other. This measure of proportionality relates the variance of the log-ratio (VLR) to the variance of the log-product (VLP), according to the following definition:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varphi }_{s}({A}_{i},{A}_{j})=\frac{var({A}_{i}-{A}_{j})}{var({A}_{i}+{A}_{j})}$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41598_2017_16520_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
    <p id="Par11">We refer the reader to the supplemental appendix for a demonstration of how these measures of proportionality relate to the slope, <italic>β</italic>, and the Pearson correlation coefficient, <italic>r</italic>, of pairwise log-ratio transformed data (S1 Appendix). This appendix also illustrates how <italic>ϕ</italic>, <italic>ϕ</italic><sub><italic>s</italic></sub>, and <italic>ρ</italic><sub><italic>p</italic></sub> relate to one another.</p>
    <p id="Par12">In considering the two log-ratio transformations, alr uses a specified feature to transform the original subject vectors. When used in conjunction with an <italic>a priori</italic> known unchanged reference, alr effectively back-calculates the absolute counts from the relative components. By specifying, for example, a house-keeping gene or an experimentally fixed variable, the investigator can achieve a more accurate measure of dependence than through clr<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. The user can toggle alr transformation in lieu of the default clr transformation by supplying the name of the unchanged reference (or references) to the ivar argument of the phit, perb, or phis function. In either case, we wish to alert the reader that log-ratio transformation, by its definition, require non-zero elements in the data matrix. As such, any log-ratio analysis must first address zeros. Yet, how best to do this remains an open question and a topic of active research<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. For simplicity, propr automatically replaces all zero values with 1 prior to log-ratio transformation, corresponding to the multiplicative replacement strategy<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>.</p>
    <p id="Par13">The R language, despite its widespread popularity, suffers from poor performance when scaling to big data. Its “copy-on-modify” behavior, whereby each modification of an object creates a duplication of that object, along with slow for-loops, makes it an imperfect choice for computationally expensive tasks such as the one here. Therefore, in order to speed up the run time and reduce RAM overhead, we harness the Rcpp package to draft the computationally expensive portions of this tool in C++<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>.</p>
    <p id="Par14">This package also offers a number of wrapper functions to visualize proportionality when working with high-dimensional data. We provide extensive documentation for these plotting methods in the package vignette, “Understanding RNA-Seq Data through Proportionality Analysis”, hosted with the package on CRAN. Among these tools are those used to generate the figures included in the next section.</p>
  </sec>
  <sec id="Sec3" sec-type="results">
    <title>Results</title>
    <sec id="Sec4">
      <title>Application of proportionality</title>
      <p id="Par15">As a use case, we re-analyze the raw RNA-Seq counts from an already published study on cane toad (<italic>Rhinella marina</italic>) evolution and adaptation<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. Sugar cane farmers introduced cane toads to Australia in 1935 as a cane beetle pest control measure, but these toads quickly became invasive. This event now serves as a notable example of failed biological control. Initially introduced into northeastern Australia (Queensland, QLD), cane toads have since spread westwards across the continent to Western Australia (WA)<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. This dataset contains muscle tissue RNA transcript counts for 20 toads sampled from two regions (10 per region) in the wild. The two regions sampled, which we will treat as the experimental groups, include the long colonized site of introduction in QLD and the front of the range expansion in WA<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. In this analysis, we want to understand the differences in gene expression between the established and expanding populations. By demonstrating propr on public data, we provide a reproducible example of how proportionality analysis can converge on an established biological narrative. The reader can find these data bundled with the release of the package on CRAN.</p>
      <p id="Par16">We begin by constructing the proportionality matrix using all 57,580 transcript counts, yielding an <italic>N</italic><sup>2</sup> matrix 24.7 Gb in size. To minimize the number of lowly expressed transcripts included in the final result, we subset the matrix to include only those transcripts with at least 10 counts in at least 10 samples. By removing the features at this stage, we can exploit a computational trick to calculate proportionality and filter simultaneously, reducing the required RAM to only 5 Gb without altering the resultant matrix. Next, in the absence of a hypothesis testing framework, we arbitrarily select those “highly proportional” transcripts with <italic>ρ</italic><sub><italic>p</italic></sub> &gt; 0.95. We refer the reader to the supplementary vignette for a justification of this cutoff (S1 Appendix). When plotting the pairwise log-ratio transformed abundances for these “highly proportional” transcript pairs, a smear of straight diagonal lines confirms that the feature pairs indexed as proportional actually show proportional abundance (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).<fig id="Fig1"><label>Figure 1</label><caption><p>Smear plot. This figure shows the log-ratio abundance for each feature belonging to pairs index as highly proportional (<italic>ρ</italic><sub><italic>p</italic></sub> &gt; 0.95). A smear of straight diagonal lines confirms that the feature pairs indexed as proportional actually show proportional abundance. In other words, large deviations from <italic>y</italic> = <italic>x</italic> indicate small values of |<italic>ρ</italic><sub><italic>p</italic></sub>|. Figure produced using the smear function in propr.</p></caption><graphic xlink:href="41598_2017_16520_Fig1_HTML" id="d29e1079"/></fig></p>
      <p id="Par17">The procedure used to parse through the proportionality matrix now depends on the experimental question. Here, we wish to identify a highly proportional transcript module that happens to show differential abundance across the experimental groups. In this example, we take an unsupervised approach by hierarchically clustering the highly proportional feature pairs based on the matrix 1−<italic>|ρ</italic><sub><italic>p</italic></sub>|. We note here that one could instead cluster using <italic>ϕ</italic><sub><italic>s</italic></sub> directly. When clustering, we call two features co-clustered if they belong to the cluster after cutting the dendrogram. Then, we project the pairs across two axes of variance, the <italic>variance of the log-ratio</italic> (VLR) and <italic>variance of the log sums</italic> (VLS) such that <inline-formula id="IEq2"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{VLR}{VLS}=1-{\rho }_{p}$$\end{document}</tex-math><mml:math id="M14"><mml:mfrac><mml:mrow><mml:mi>V</mml:mi><mml:mi>L</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2017_16520_Article_IEq2.gif"/></alternatives></inline-formula>. In this formula, we see that as VLR approaches 0, <italic>ρ</italic><sub><italic>p</italic></sub> approaches 1. Meanwhile, the VLS, the sum of the individual variances of two features in that pair, adjusts the rate of this limit. Since we would expect a differentially expressed module to have a low VLR and a high VLS, we prioritize pairs in co-cluster 1 for subsequent analysis (Fig. <xref rid="Fig2" ref-type="fig">2</xref>).<fig id="Fig2"><label>Figure 2</label><caption><p>Prism plot. This figure shows the distribution of feature pairs according to the variance of the log-ratio (VLR) and the variance of the log sums (VLS) for all pairs in which at least one of the features participates in at least one highly proportional (<italic>ρ</italic><sub><italic>p</italic></sub> &gt; 0.95) pair. If both features in a pair belong to the same cluster, they receive a non-zero color code. Clusters created hierarchically based on the matrix <inline-formula id="IEq3"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1-|{\rho }_{p}|$$\end{document}</tex-math><mml:math id="M16"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:math><inline-graphic xlink:href="41598_2017_16520_Article_IEq3.gif"/></alternatives></inline-formula>. Figure produced using the prism function in propr.</p></caption><graphic xlink:href="41598_2017_16520_Fig2_HTML" id="d29e1186"/></fig></p>
      <p id="Par18">Co-clusters containing feature pairs with a low VLR and a high VLS have the potential to explain differences between the experimental groups. However, the high VLS may not necessarily have anything to do with the experimental condition. For example, this co-cluster might instead include highly proportional features that show wide individual feature variance due to batch effects. For the cane toad data, however, the experimental condition does indeed seem to drive the high individual feature variances in the module, as evidenced by the near perfect group separation when visualizing the first two components of a principal components analysis (PCA) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Note that this plot calculates PCA using the log-ratio transformed data, making it a statistically valid choice for compositional data<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. The separation between groups achieved here compares to that reported in the original publication, which used features selected by the edgeR package<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. In addition, gene set enrichment analysis of the gene ontology terms for co-cluster 1 (S1 Table) shows an enrichment for similar molecular functions as those enriched among the transcripts selected by edgeR (S2 Table), as well as those highlighted in the original publication<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. This is particularly impressive considering that we have no reason to expect most differentially expressed transcripts would appear in differentially expressed modules too.<fig id="Fig3"><label>Figure 3</label><caption><p>PCA plot. This figure shows all samples projected across the first two components of a principal components analysis (PCA), calculated using the log-ratio transformed data. This plot colors samples based on the experimental group. Figure produced using the pca function in propr.</p></caption><graphic xlink:href="41598_2017_16520_Fig3_HTML" id="d29e1215"/></fig></p>
      <p id="Par19">Although the exact gene ontology terms differ by method, our approach yields a constellation of macromolecular metabolic terms that suggests a common story: “metabolic enzymes are overwhelmingly upregulated at the invasion front”<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, interpreted this to mean that WA cane toads may experience more environmental stress than those from QLD<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. Yet, while agreeing here, proportionality analysis offers an additional benefit in that it provides a layer of information on pairwise associations, all without requiring any kind of normalization. Nevertheless, we believe there exists added value in integrating the results of propr and conventional differential expression analysis, best visualized as a network graph (Fig. <xref rid="Fig4" ref-type="fig">4</xref>).<fig id="Fig4"><label>Figure 4</label><caption><p>Network plot. This figure shows a 3D projection of all feature pairs indexed as highly proportional (<italic>ρ</italic><sub><italic>p</italic></sub> &gt; 0.95) within co-cluster 1. Red nodes indicate transcripts with increased expression according to edgeR. Blue nodes indicate transcripts with decreased expression according to edgeR. White nodes indicate transcripts included in co-cluster 1, but not selected by edgeR. Importantly, we see here several highly proportional up-regulated and down-regulated modules. Figure produced using the cytescape function in propr.</p></caption><graphic xlink:href="41598_2017_16520_Fig4_HTML" id="d29e1246"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Evaluation of proportionality</title>
      <p id="Par20">Above, we show how we can use proportionality to understand RNA-Seq data. Here, we move on to evaluate how well each of the three measures of proportionality performs as compared to the Pearson’s correlation coefficient of the absolute data (referred to as <italic>absolute correlation</italic>). For this, we need a dataset for which we know already the absolute abundances exactly. Since this is unknown in the cane toad data, we use two other datasets: (a) a simulated dataset with 1,000 random features (i.e., following a negative binomial distribution) and an additional non-random feature, and (b) a time series of yeast mRNA abundance after removal of a key nutrient<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. Knowing the absolute abundances, we can make a corresponding relative dataset by dividing the counts (as rows) by the per-sample sum (i.e., the library size). Since the library size changes non-randomly across samples, this operation constrains the data in a way that introduces spurious correlations.</p>
      <p id="Par21">For each dataset, we plot a scatter of 10,000 randomly sampled absolute correlations plotted against five other measures of dependence: (1) the correlation of relative data, (2) the correlation of clr-transformed data, (3) <italic>ρ</italic><sub><italic>p</italic></sub>, (4) <italic>ϕ</italic>, and (5) <italic>ϕ</italic><sub><italic>s</italic></sub>. Note that, since <italic>ϕ</italic> and <italic>ϕ</italic><sub><italic>s</italic></sub> range from [0. ∞), we have transformed these measures to make them comparable with correlation directly. For this, we use the function <inline-formula id="IEq4"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(x)=1-2\,{\rm{logistic}}(\mathrm{log}(x))$$\end{document}</tex-math><mml:math id="M18"><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mspace width=".25em"/><mml:mi mathvariant="normal">logistic</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:math><inline-graphic xlink:href="41598_2017_16520_Article_IEq4.gif"/></alternatives></inline-formula>, such that <inline-formula id="IEq5"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rho }_{p}=f({\varphi }_{s})$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math><inline-graphic xlink:href="41598_2017_16520_Article_IEq5.gif"/></alternatives></inline-formula>. Figure <xref rid="Fig5" ref-type="fig">5</xref>, built from the simulated data, shows the presence of many spurious correlations (Fig. <xref rid="Fig5" ref-type="fig">5</xref>: panel “Correlation (Absolute)” vs. “Correlation (Relative)”). Yet, these spurious correlations disappear when measuring proportionality (Fig. <xref rid="Fig5" ref-type="fig">5</xref>: panel “Correlation (Absolute)” vs. “Proportionality (perb)”). Notably, the spurious correlations from these data also disappear when measuring the correlation of clr-transformed data (Fig. <xref rid="Fig5" ref-type="fig">5</xref>: panel “Correlation (Absolute)” vs. “Correlation (clr-based)”).<fig id="Fig5"><label>Figure 5</label><caption><p>Evaluation of proportionality using simulated data. Using a simulated dataset with 1,000 random features and an additional non-random feature, this figure shows a scatter of 10,000 randomly sampled absolute correlations plotted against five other measures of dependence: (1) the correlation of relative data, (2) the correlation of clr-transformed data, (3) <italic>ρ</italic><sub><italic>p</italic></sub>, (4) <italic>ϕ</italic>, and (5) <italic>ϕ</italic><sub><italic>s</italic></sub>. To make the measures of <italic>ϕ</italic> and <italic>ϕ</italic><sub><italic>s</italic></sub> comparable, we transformed these from a range of [0, ∞) to [−1, 1]. From here, we can visually assess how well any two measures of dependence agree with one another.</p></caption><graphic xlink:href="41598_2017_16520_Fig5_HTML" id="d29e1402"/></fig></p>
      <p id="Par22">Likewise, Fig. <xref rid="Fig6" ref-type="fig">6</xref> uses the yeast data to extend an analysis provided in the supplemental materials of Lovell <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. As with the simulated data, we see here a number of spurious correlations (Fig. <xref rid="Fig6" ref-type="fig">6</xref>: panel “Correlation (Absolute)” vs. “Correlation (Relative)”). However, unlike with the simulated data, proportionality does not perfectly approximate the absolute correlation coefficients; still, proportionality does mitigate the presence and extent of the spurious events (as evidenced by the tapering of the scatter plot) (Fig. <xref rid="Fig6" ref-type="fig">6</xref>: panel “Correlation (Absolute)” vs. “Proportionality (perb)”). In other words, pairs that exhibit high proportionality (i.e., large <italic>ρ</italic><sub><italic>p</italic></sub> or, equivalently, small <italic>ϕ</italic> and <italic>ϕ</italic><sub><italic>s</italic></sub>) also exhibit high absolute correlation, making proportionality a precise predictor of absolute correlation. Interestingly, unlike with the simulated data, clr-based correlation appears to produce more spurious events (Fig. <xref rid="Fig6" ref-type="fig">6</xref>: panel “Correlation (Absolute)” vs. “Correlation (clr-based)”) than proportionality, suggesting that proportionality may have some inherent advantage when applied to compositional data.<fig id="Fig6"><label>Figure 6</label><caption><p>Evaluation of proportionality using yeast data. Using a time series of yeast mRNA abundance after removal of a key nutrient, this figure shows a scatter of 10,000 randomly sampled absolute correlations plotted against five other measures of dependence: (1) the correlation of relative data, (2) the correlation of clr-transformed data, (3) <italic>ρ</italic><sub><italic>p</italic></sub>, (4) <italic>ϕ</italic>, and (5) <italic>ϕ</italic><sub><italic>s</italic></sub>. To make the measures of <italic>ϕ</italic> and <italic>ϕ</italic><sub><italic>s</italic></sub> comparable, we transformed these from a range of [0, ∞) to [−1, 1]. From here, we can visually assess how well any two measures of dependence agree with one another.</p></caption><graphic xlink:href="41598_2017_16520_Fig6_HTML" id="d29e1473"/></fig></p>
      <p id="Par23">To quantify what we see visually, we compare each measure to the absolute correlation by tabulating the mean squared error (MSE), the number of spurious events, and the MSE of those spurious events (S3 Table). This confirms that, at least for the yeast data, proportionality results in fewer and less extreme spurious events. Note that, for both datasets, <italic>ρ</italic><sub><italic>p</italic></sub> and <italic>ϕ</italic><sub><italic>s</italic></sub> perform equally well because <italic>ϕ</italic><sub><italic>s</italic></sub> is a transformed variant of <italic>ϕ</italic><sub><italic>s</italic></sub><sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. Although <italic>ϕ</italic> produces even fewer spurious results than the other proportionality measures, this comes at the cost of greater total MSE. We refer the reader to the supplementary materials for a script that contains everything required to reproduce all analyses presented here.</p>
    </sec>
  </sec>
  <sec id="Sec6" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par24">The propr package for R, now available on CRAN, provides a fast implementation of three measures of proportionality, previously shown to rectify the issue of spurious correlation in the setting of compositional data<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR8">8</xref></sup>. These implementations offer a valid alternative to correlation that can accurately identify associated features in relative data<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. By using the Rcpp package to draft the computationally expensive code in C++, the propr package achieves greater performance than possible in the native R environment without altering the front-end user experience<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. In this way, proportionality analysis executes nearly as fast as base R correlation while retaining a simple programming interface. Yet, proportionality analysis is not without limitations.</p>
    <p id="Par25">First, unlike the <italic>log-ratio variance</italic> (VLR), the values of <italic>ϕ</italic> and <italic>ρ</italic><sub><italic>p</italic></sub> will change in the setting of missing feature data. Since biological assays rarely, if ever, capture all possible feature information, this property makes the centered log-ratio transformation (clr) a sub-optimal choice. The additive log-ratio transformation (alr), which allows the user to scale their data by a feature with an <italic>a priori</italic> known fixed abundance, such as a house-keeping gene or an experimentally fixed variable (e.g., a ThermoFisher ERCC synthetic RNA “spike-in”<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>), may provide a superior alternative. In contrast to clr, proportionality calculated with alr does not change with missing feature data because it effectively back-calculates the absolute feature abundance. Still, clr is probably sufficient when most features remain unchanged across samples, an assumption also built into the trimmed mean of M (TMM) normalization used in the analysis of RNA-Seq data<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR16">16</xref></sup>. Moreover, errors associated with clr transformation consist almost entirely of false negatives, rather than false positives, making it suitable for many scientific applications<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>.</p>
    <p id="Par26">Second, proportionality analysis, by nature of the log-ratio transformation, fails in the presence of zero values. As such, proportionality analysis inherits the zero replacement controversy prominent in the compositional data analysis literature. By default, propr replaces all zero values with 1. If analysts wish to explore other approaches to zero replacement–including conducting analyses of the sensitivity of results to zero imputation–they can so by manipulating the data prior to running routines in propr. We stress that, depending on the number of zero values in the data, replacement of zeros can have a major impact on the conclusions drawn from any log-ratio based analysis. Analysts should carefully examine their results to understand the extent to which they depend on the zero replacement strategy chosen.</p>
    <p id="Par27">Third, biological count data do not exist as true compositional data, but rather as a kind of “count-compositional” data, whereby small non-zero counts pose a unique challenge to analysis. This follows from how the log-ratio methods of compositional data analysis assume data to consist of <italic>D</italic> positive, real-valued components (i.e., a sample space of <inline-formula id="IEq6"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbb{R}}}_{+}^{D}$$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2017_16520_Article_IEq6.gif"/></alternatives></inline-formula>). Instead, count-compositional data consist of <italic>D</italic> non-negative, <italic>integer-valued</italic> components (i.e., a sample space of <inline-formula id="IEq7"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbb{Z}}}_{0+}^{D}$$\end{document}</tex-math><mml:math id="M24"><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">Z</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2017_16520_Article_IEq7.gif"/></alternatives></inline-formula>). The smaller the counts, the more noticeable the discretization of the count-compositional data becomes. Likewise, with smaller counts, the impact of sampling variation becomes more noticeable: additive variation affects the relative abundance of small counts more than large counts. Put succinctly, the difference between 1 count and 2 counts does not carry the exact same information as the difference between 1000 counts and 2000 counts. In practice, this means that a minor variation in small counts can have a major impact on the conclusions drawn from any log-ratio based analysis. Like with zero replacement, analysts should carefully examine their results to understand this sensitivity. We note that prior work has found substantial differences in how test statistics handle low-count genes in RNA-Seq<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. For the purposes of demonstrating propr, we avoid this issue partly by removing from analysis any component with a predominance of low counts.</p>
    <p id="Par28">Finally, proportionality analysis currently lacks a hypothesis testing framework. Its distribution of heteroscedastic variance makes it unsuited for the z-transformation used to calculate the variance of the correlation statistic. Although more work is needed to create a rigorous framework for applying statistical tests to proportionality analysis, we include a supplementary vignette that offers a practical guide to choosing a proportionality cutoff (S1 Appendix). Nevertheless, we believe the propr package comes a long way in improving the accessibility of proportionality analysis to researchers. We hope many biological investigations can benefit from this alternative to correlation.</p>
    <sec id="Sec7">
      <title>Data availability</title>
      <p id="Par29">All data generated or analyzed during this study are included in this published article (and its Supplementary Information files).</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Electronic supplementary material</title>
    <sec id="Sec8">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2017_16520_MOESM1_ESM.pdf">
            <caption>
              <p>S1 Appendix</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41598_2017_16520_MOESM2_ESM.pdf">
            <caption>
              <p>S1 Notes</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41598_2017_16520_MOESM3_ESM.csv">
            <caption>
              <p>S1 Data</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41598_2017_16520_MOESM4_ESM.csv">
            <caption>
              <p>S2 Data</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="41598_2017_16520_MOESM5_ESM.csv">
            <caption>
              <p>S3 Data</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="41598_2017_16520_MOESM6_ESM.csv">
            <caption>
              <p>S1 Table</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="41598_2017_16520_MOESM7_ESM.csv">
            <caption>
              <p>S2 Table</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="41598_2017_16520_MOESM8_ESM.csv">
            <caption>
              <p>S3 Table</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher's note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Electronic supplementary material</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1038/s41598-017-16520-0.</p>
  </sec>
  <notes notes-type="author-contribution">
    <title>Author Contributions</title>
    <p>T.P.Q. authored the software package, analyzed the results, and prepared the manuscript. M.F.R., D.L., and T.M.C. all contributed to drafting and reviewing the manuscript. D.L. contributed code to the software package. D.L. prepared the supplemental examination of proportionality. T.P.Q. prepared the supplemental vignette.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar1">
      <title>Competing Interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">van den Boogaart, K. G. &amp; Tolosana-Delgado, R. “compositions”: A unified R package to analyze compositional data. <italic>Computers &amp; Geosciences</italic><bold>34</bold>, 320–338, <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/S009830040700101X">http://www.sciencedirect.com/science/article/pii/S009830040700101X</ext-link> (2008).</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Lin, Y. <italic>et al</italic>. Comparison of normalization and differential expression analyses using RNA-Seq data from 726 individual Drosophila melanogaster. <italic>BMC Genomics</italic><bold>17</bold>, <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC4702322/">http://www.ncbi.nlm.nih.gov/pmc/articles/PMC4702322/</ext-link> (2016).</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Saccenti, E. Correlation Patterns in Experimental Data Are Affected by Normalization Procedures: Consequences for Data Analysis and Network Inference. <italic>Journal of Proteome Research</italic>, 10.1021/acs.jproteome.6b00704 (2016).</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fernandes</surname>
            <given-names>AD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unifying the analysis of high-throughput sequencing datasets: characterizing RNA-seq, 16s rRNA gene sequencing and selective growth experiments by compositional data analysis</article-title>
        <source>Microbiome</source>
        <year>2014</year>
        <volume>2</volume>
        <fpage>15</fpage>
        <pub-id pub-id-type="doi">10.1186/2049-2618-2-15</pub-id>
        <pub-id pub-id-type="pmid">24910773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Lovell, D., Pawlowsky-Glahn, V., Egozcue, J. J., Marguerat, S. &amp; Bähler, J. Proportionality: A Valid Alternative to Correlation for Relative Data. <italic>PLoS Computational Biology</italic><bold>11</bold>, <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC4361748/">http://www.ncbi.nlm.nih.gov/pmc/articles/PMC4361748/</ext-link> (2015).</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Pearson, K. Mathematical Contributions to the Theory of Evolution. III. Regression, Heredity, and Panmixia. <italic>Philosophical Transactions of the Royal Society of London. Series A, Containing Papers of a Mathematical or Physical Character</italic><bold>187</bold>, 253–318, <ext-link ext-link-type="uri" xlink:href="http://www.jstor.org/stable/90707">http://www.jstor.org/stable/90707</ext-link> (1896).</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Alm</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <article-title>Inferring correlation networks from genomic survey data</article-title>
        <source>PLoS computational biology</source>
        <year>2012</year>
        <volume>8</volume>
        <fpage>e1002687</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002687</pub-id>
        <pub-id pub-id-type="pmid">23028285</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Erb, I. &amp; Notredame, C. How should we measure proportionality on relative gene expression data? <italic>Theory in Biosciences</italic> = <italic>Theorie in Den Biowissenschaften</italic> (2016).</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Aitchison, J. <italic>The Statistical Analysis of Compositional Data</italic> (Chapman &amp; Hall, Ltd., London, UK, UK, 1986).</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Martin-Fernandez, J. A., Palarea-Albaladejo, J. &amp; Olea, R. A. Chapter 4. Dealing with Zeros. In <italic>Compositional Data Analysis: Theory and Applications</italic>, 43–58 (John Wiley &amp; Sons, Ltd., 2011).</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Eddelbuettel, D. &amp; François, R. Rcpp: Seamless R and C++ Integration. <italic>Journal of Statistical Software</italic><bold>40</bold>, 1–18, <ext-link ext-link-type="uri" xlink:href="http://www.jstatsoft.org/v40/i08/">http://www.jstatsoft.org/v40/i08/</ext-link> (2011).</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rollins</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Shine</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A genetic perspective on rapid evolution in cane toads (Rhinella marina)</article-title>
        <source>Molecular Ecology</source>
        <year>2015</year>
        <volume>24</volume>
        <fpage>2264</fpage>
        <lpage>2276</lpage>
        <pub-id pub-id-type="doi">10.1111/mec.13184</pub-id>
        <pub-id pub-id-type="pmid">25894012</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gloor</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Reid</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Compositional analysis: a valid approach to analyze microbiome high-throughput sequencing data</article-title>
        <source>Canadian Journal of Microbiology</source>
        <year>2016</year>
        <volume>62</volume>
        <fpage>692</fpage>
        <lpage>703</lpage>
        <pub-id pub-id-type="doi">10.1139/cjm-2015-0821</pub-id>
        <pub-id pub-id-type="pmid">27314511</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marguerat</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Quantitative analysis of fission yeast transcriptomes and proteomes in proliferating and quiescent cells</article-title>
        <source>Cell</source>
        <year>2012</year>
        <volume>151</volume>
        <fpage>671</fpage>
        <lpage>683</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2012.09.019</pub-id>
        <pub-id pub-id-type="pmid">23101633</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Jiang, L. <italic>et al</italic>. Synthetic spike-in standards for RNA-seq experiments. <italic>Genome Research</italic><bold>21</bold>, 1543–1551, <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/content/21/9/1543">http://genome.cshlp.org/content/21/9/1543</ext-link> (2011).</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title>
        <source>Genome Biology</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-3-r25.</pub-id>
        <?supplied-pmid 20196867?>
        <pub-id pub-id-type="pmid">20196867</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bullard</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Purdom</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-Seq experiments</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>94</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-94</pub-id>
        <?supplied-pmid 20167110?>
        <pub-id pub-id-type="pmid">20167110</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
