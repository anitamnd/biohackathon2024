<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2358895</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-9-156</article-id>
    <article-id pub-id-type="pmid">18366694</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-9-156</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Empirical Bayes models for multiple probe type microarrays at the probe level</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" corresp="yes" contrib-type="author">
        <name>
          <surname>Åstrand</surname>
          <given-names>Magnus</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>magnus.astrand@astrazeneca.com</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Mostad</surname>
          <given-names>Petter</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>mostad@chalmers.se</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Rudemo</surname>
          <given-names>Mats</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>rudemo@chalmers.se</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Mathematical Sciences, Chalmers University of Technology, and Mathematical Sciences, Göteborg University, S-41296, Göteborg, Sweden</aff>
    <pub-date pub-type="collection">
      <year>2008</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>3</month>
      <year>2008</year>
    </pub-date>
    <volume>9</volume>
    <fpage>156</fpage>
    <lpage>156</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/9/156"/>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>10</month>
        <year>2007</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>3</month>
        <year>2008</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2008 Åstrand et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2008</copyright-year>
      <copyright-holder>Åstrand et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               &#x000c5;strand
               Magnus
               
               magnus.astrand@astrazeneca.com
            </dc:author><dc:title>
            Empirical Bayes models for multiple probe type microarrays at the probe level
         </dc:title><dc:date>2008</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 9(1): 156-. (2008)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2008)9:1&#x0003c;156&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>When analyzing microarray data a primary objective is often to find differentially expressed genes. With empirical Bayes and penalized t-tests the sample variances are adjusted towards a global estimate, producing more stable results compared to ordinary t-tests. However, for Affymetrix type data a clear dependency between variability and intensity-level generally exists, even for logged intensities, most clearly for data at the probe level but also for probe-set summarizes such as the MAS5 expression index. As a consequence, adjustment towards a global estimate results in an intensity-level dependent false positive rate.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We propose two new methods for finding differentially expressed genes, Probe level Locally moderated Weighted median-t (PLW) and Locally Moderated Weighted-t (LMW). Both methods use an empirical Bayes model taking the dependency between variability and intensity-level into account. A global covariance matrix is also used allowing for differing variances between arrays as well as array-to-array correlations. PLW is specially designed for Affymetrix type arrays (or other multiple-probe arrays). Instead of making inference on probe-set summaries, comparisons are made separately for each perfect-match probe and are then summarized into one score for the probe-set.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The proposed methods are compared to 14 existing methods using five spike-in data sets. For RMA and GCRMA processed data, PLW has the most accurate ranking of regulated genes in four out of the five data sets, and LMW consistently performs better than all examined moderated t-tests when used on RMA, GCRMA, and MAS5 expression indexes.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Microarrays are widely used for measuring gene expression in biomedical research. For the purpose of finding differentially expressed genes there exist numerous methods. In early studies genes where often ranked with respect to fold-change. Genes showing fold-change above 2 (or 3) were regarded as potentially regulated and were selected for further investigation. The obvious drawback with such an approach, as pointed out by many authors, is that genes with high fold-change may also be highly variable and thus with low significance of the regulation. On the other hand, since the number of replicates in many studies is small, variance estimators computed solely within genes are not reliable in that very small values can occur just by chance. As a consequence the ordinary t-test suffers from low power and is not a better option for filtering out regulated genes.</p>
    <p>Many methods have been proposed to improve on the variance estimator in order to find more powerful statistical tests for differential expression. In empirical Bayes methods [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B8">8</xref>] and the penalized t-test suggested in [<xref ref-type="bibr" rid="B9">9</xref>], the gene-specific variance estimator is modified in order to produce more stable results. With proportions determined by the accuracy of the gene-specific variance estimators, a mixture of the gene-specific variance estimator and a global variance estimate is used in place of the gene-specific variance estimator in the denominator of the t-test. Similarly, in the Significance Analysis of Microarrays (SAM) method [<xref ref-type="bibr" rid="B10">10</xref>] and the method suggested in [<xref ref-type="bibr" rid="B11">11</xref>], a constant is added to the gene-specific sample standard deviation.</p>
    <p>Another approach is to pool variance estimators for genes having similar expression level, thus modeling the variance as a function of intensity-level. For example Eaves et al. [<xref ref-type="bibr" rid="B12">12</xref>] use a weighted average of the gene-specific variance estimator and a pooled estimate based on the 500 genes with most similar mean expression level, and Jain et al. [<xref ref-type="bibr" rid="B13">13</xref>] suggest the local-pooled-error method (LPE) where a variance function fitted to estimated variances and mean intensities is used. Comander et al. [<xref ref-type="bibr" rid="B14">14</xref>] pool genes with respect to minimum intensity rather than mean intensity, and Hu et al. [<xref ref-type="bibr" rid="B15">15</xref>] use a hierarchical model with a linear relationship between variance and intensity-level. Of these four methods, only the one suggested in [<xref ref-type="bibr" rid="B15">15</xref>] takes the accuracy of the gene-specific variance estimators into account when setting the weights for the gene-specific estimator and the pooled estimator, respectively. On the other hand Hu et al. [<xref ref-type="bibr" rid="B15">15</xref>] only deal with a linear relationship between variance and intensity-level. A variance to intensity-level dependency is also utilized in the moderated t-test suggested in [<xref ref-type="bibr" rid="B6">6</xref>]. The method proposed builds on the moderated t-test suggested in [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B3">3</xref>] with the addition of fitting a loess curve in the scatter plot of logged variance estimators against mean intensity when estimating the model parameters.</p>
    <p>The type of arrays considered in this paper is the Affymetrix GeneChip arrays. These arrays are one color arrays and each gene is represented by a set of probes, the probe-set, consisting of 10–16 probe-pairs. Each probe-pair consists of one perfect match (PM) probe and one mismatch (MM) probe. The probes are 25 bases long and the PM and MM probes have identical sequences of bases except for the middle probe which in the MM probe is set to the complementary base of that in the PM probe. The MM probes are thus designed to measure the background intensity for the corresponding PM probe. The standard way of dealing with the multiple-probes is to derive a probe set summary, an expression index, for each probe-set (gene) and array (sample), for example using the RMA method [<xref ref-type="bibr" rid="B16">16</xref>] or the Affymetrix MAS5 algorithm. The expression indexes are then used in downstream analysis by only considering the expression index itself, the precision of the expression index is ignored. However, in the fully Bayesian probe-level BGX model [<xref ref-type="bibr" rid="B17">17</xref>] information about the accuracy of the expression index is obtained as a complete distribution which is subsequently used when computing the posterior distribution of differential expression. Also, the probe-level measurement error from the probabilistic probe-level model multi-mgMOS [<xref ref-type="bibr" rid="B18">18</xref>] is used when computing the probability of positive log-ratio in the PPLR method [<xref ref-type="bibr" rid="B19">19</xref>].</p>
    <p>For Affymetrix type arrays a dependency between variability and intensity-level generally exists, even for log-transformed data. Figure <xref ref-type="fig" rid="F1">1</xref> shows scatter plots of sample variance versus sample mean calculated on logged PM intensities (background corrected and normalized using the default methods of RMA) and three different expression indexes: RMA, GCRMA and MAS5. Except for the RMA expression index a clear dependency between variability and intensity-level exists, with a unique signature for each type of pre-processing of the raw CEL-file data. The GCRMA expression index shows increasing variability with intensity-level while MAS5 shows the opposite relationship. As a consequence, methods assuming constant variance as well as methods adjusting the gene-specific variance (or standard deviation) estimators towards a global estimate suffer from intensity-level dependent false positive rates. Figure <xref ref-type="fig" rid="F2">2</xref> shows an example where the moderated t-test in the R-package LIMMA [<xref ref-type="bibr" rid="B3">3</xref>] was used on MAS5 expression indexes computed on a set of replicated arrays. The false positive rate obtained with LIMMA follows the same pattern as in the right lower panel in Figure <xref ref-type="fig" rid="F1">1</xref> where the same data set is used. Almost identical result was obtained using data set A in a similar simulation (data not shown).</p>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p><bold>Probe-, or probe-set, wise sample variances against sample means</bold>. Scatter plots of sample variance <italic>s</italic><sup>2 </sup>(logged with base 2) against mean intensity for logged PM intensities and three expression indexes. Left and right panels show data set A and B, respectively (see Section <italic>Data sets</italic>).</p>
      </caption>
      <graphic xlink:href="1471-2105-9-156-1"/>
    </fig>
    <fig position="float" id="F2">
      <label>Figure 2</label>
      <caption>
        <p><bold>False positive rate against mean intensity</bold>. False positive rate (<italic>α</italic>) calculated on re-sampled data and plotted against mean intensity. 100 data sets of size 6 were sampled from the complete data set B (see Section <italic>Data sets</italic>) of 18 replicated arrays and then analyzed using the Affymetrix MAS5 algorithm followed by a two group analysis of 3+3 arrays using the moderated t-test in the R-package LIMMA [3], on logged MAS5 indexes and indexes transformed using the variance stabilizing transformation in the R-package vsn [21], and the proposed method LMW using logged MAS5 indexes. false positive rate were obtained by averaging over the sampled data sets using loess-curves fitted to mean intensity and indicator of significance (1 if the probe-set is among the 5% probe-sets with highest absolute statistic, 0 otherwise). The mean intensities of each data set are shifted to the range [0,15].</p>
      </caption>
      <graphic xlink:href="1471-2105-9-156-2"/>
    </fig>
    <p>The aim of variance stabilizing transformations is to reduce or eliminate the problem of dependency between variability and intensity-level. A family of transformations, the generalized-log family (glog), was introduced in [<xref ref-type="bibr" rid="B20">20</xref>-<xref ref-type="bibr" rid="B22">22</xref>] and further used in [<xref ref-type="bibr" rid="B23">23</xref>,<xref ref-type="bibr" rid="B24">24</xref>]. A comparison of the glog family with the started logarithm transformation [<xref ref-type="bibr" rid="B25">25</xref>] and the log-linear hybrid transformation [<xref ref-type="bibr" rid="B26">26</xref>] is presented in [<xref ref-type="bibr" rid="B27">27</xref>]. It is concluded that the glog family is "probably the best choice when it is convenient to use it", but it is also noted that the direct interpretation of differences as logged ratios for microarray data when using the ordinary log-transformation, does not hold when using such variance stabilizing transformations.</p>
    <p>Generally, the glog family effectively stabilizes the variance when applied to raw Affymetrix probe-level data, for example using the parameter estimation procedure described in [<xref ref-type="bibr" rid="B21">21</xref>]. However, the transformations implicitly defines a background correction, and when applied to data already having been subject to another background correction (or further processed data), the glog transformations may not be able to capture the structure of the dependency between variability and intensity-level. This applies, for example, to probe-level data background corrected using the RMA default background method, and MAS5 expression indexes, see Figure <xref ref-type="fig" rid="F2">2</xref>. Thus, there is a need for more flexible solutions, and in short, Figures <xref ref-type="fig" rid="F1">1</xref> and <xref ref-type="fig" rid="F2">2</xref> may be seen as one motivation for the methods proposed in this paper.</p>
    <p>The hierarchical Bayesian model WAME proposed and developed in [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B8">8</xref>] is in the present paper extended to incorporate the variability to intensity-level dependency. The Probe level Locally moderated Weighted median-t method (PLW) applies the extended model to logged PM intensities resulting in moderated and weighted t-statistics for all PM probes. In the final step of PLW the median t-statistic of all PM probes building up each probe-set is computed, and this median is the value used for ranking the probe-sets with respect to differential expression.</p>
    <p>The Locally Moderated Weighted-t method (LMW) is a more general method intended for single probe type of arrays or summary measures of multiple probe type arrays, such as RMA and MAS5. LMW use the same model as PLW but since only one t-statistic is obtained for each probe-set no median is calculated. The proposed methods are compared with existing methods on five publicly available spike-in data sets.</p>
  </sec>
  <sec>
    <title>Results and Discussion</title>
    <sec>
      <title>Model and methodology</title>
      <p>Given a set of <italic>n </italic>arrays let <italic>y</italic><sub><italic>ip </italic></sub>be the background corrected and normalized log-intensity on array <italic>i </italic>for PM probe <italic>p </italic>and put <italic>y</italic><sub><italic>p </italic></sub>= (<italic>y</italic><sub>1<italic>p</italic></sub>,...,<italic>y</italic><sub><italic>np</italic></sub>)<sup><italic>T</italic></sup>. The PM probes are divided into <italic>G </italic>(disjoint) probe-sets <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-9-156-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi mathvariant="script">G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">G</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> and thus there are a total of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-9-156-i2" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="script">G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="script">G</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:semantics></mml:math></inline-formula> probes. For <italic>p </italic>= 1,...,<italic>P </italic>assume</p>
      <p>
        <disp-formula id="bmcM1">
          <label>(1)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-9-156-i3" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>p</mml:mi>
                        </mml:msub>
                        <mml:mo>|</mml:mo>
                        <mml:msub>
                          <mml:mi>c</mml:mi>
                          <mml:mi>p</mml:mi>
                        </mml:msub>
                        <mml:mo>~</mml:mo>
                        <mml:msub>
                          <mml:mtext>N</mml:mtext>
                          <mml:mi>n</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>μ</mml:mi>
                          <mml:mi>p</mml:mi>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mi>c</mml:mi>
                          <mml:mi>p</mml:mi>
                        </mml:msub>
                        <mml:mi>Σ</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>c</mml:mi>
                          <mml:mi>p</mml:mi>
                        </mml:msub>
                        <mml:mo>~</mml:mo>
                        <mml:msup>
                          <mml:mi>Γ</mml:mi>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mfrac>
                          <mml:mn>1</mml:mn>
                          <mml:mn>2</mml:mn>
                        </mml:mfrac>
                        <mml:mi>m</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mfrac>
                          <mml:mn>1</mml:mn>
                          <mml:mn>2</mml:mn>
                        </mml:mfrac>
                        <mml:mi>m</mml:mi>
                        <mml:mo>⋅</mml:mo>
                        <mml:mi>ν</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mover accent="true">
                            <mml:mi>μ</mml:mi>
                            <mml:mo>¯</mml:mo>
                          </mml:mover>
                          <mml:mi>p</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>μ</italic><sub><italic>p </italic></sub>is the log-intensity profile for probe <italic>p </italic>across the <italic>n </italic>arrays with mean log-intensity level <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-9-156-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, ∑ is an <italic>n × n </italic>covariance matrix, <italic>m </italic>is a real-valued parameter, and <italic>ν</italic>(·) is a smooth real-valued function. N<sub><italic>n </italic></sub>denotes an <italic>n</italic>-dimensional normal distribution, and Γ<sup>-1</sup>(<italic>a, b</italic>) denotes the inverse-gamma distribution with shape parameter <italic>a </italic>and scale parameter <italic>b</italic>. A cubic spline is used to parameterize the function <italic>ν</italic>(·). Given set of <italic>K </italic>interior spline-knots</p>
      <p>
        <disp-formula><italic>ν</italic>(<italic>x</italic>) = exp{<italic>H</italic>(<italic>x</italic>)<sup><italic>T</italic></sup><italic>β</italic>}</disp-formula>
      </p>
      <p>where <italic>β </italic>is a parameter vector of length 2<italic>K </italic>- 1 and <italic>H </italic>: ℝ → ℝ<sup>2<italic>K</italic>-1 </sup>is a set of B-spline basis functions, see chapter 5 of [<xref ref-type="bibr" rid="B28">28</xref>].</p>
      <p>As in the model suggested in [<xref ref-type="bibr" rid="B4">4</xref>] the model in Equ. 1 makes use of a global covariance matrix, thus allowing differing variances as well as correlations between arrays. To account for the dependency between variability and intensity-level the scale-parameter of the Γ<sup>-1</sup>-distribution depends on the mean log-intensity level <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-9-156-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> for the probe through the smooth function <italic>ν</italic>.</p>
      <p>We assume that the vector <italic>μ</italic><sub><italic>p </italic></sub>is determined by a full rank <italic>n × k </italic>design matrix <italic>D </italic>and a parameter vector <italic>γ</italic><sub><italic>p </italic></sub>of length <italic>k</italic>. The aim is to estimate and test hypothesis for <italic>δ</italic><sub><italic>p</italic></sub>, a linear combination of <italic>γ</italic><sub><italic>p </italic></sub>specified by a 1 × <italic>k </italic>matrix <italic>C</italic>. In summary,</p>
      <p>
        <disp-formula><italic>μ</italic><sub><italic>p </italic></sub>= <italic>Dγ</italic><sub><italic>p </italic></sub>and <italic>δ</italic><sub><italic>p </italic></sub>= <italic>Cγ</italic><sub><italic>p</italic></sub>.</disp-formula>
      </p>
      <p>For the special case of comparing two conditions, with <italic>n</italic><sub>1 </sub>and <italic>n</italic><sub>2 </sub>arrays from conditions 1 and 2, respectively, the design matrix <italic>D </italic>is an (<italic>n</italic><sub>1 </sub>+ <italic>n</italic><sub>2</sub>) × 2 matrix. For example, with <italic>n</italic><sub>1 </sub>= 3 and <italic>n</italic><sub>2 </sub>= 4 we can use</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-9-156-i5" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msup>
                  <mml:mi>D</mml:mi>
                  <mml:mi>T</mml:mi>
                </mml:msup>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>[</mml:mo>
                  <mml:mrow>
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mn>1</mml:mn>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mn>1</mml:mn>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mn>1</mml:mn>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mn>0</mml:mn>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mn>0</mml:mn>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mn>0</mml:mn>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mn>0</mml:mn>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mn>0</mml:mn>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mn>0</mml:mn>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mn>0</mml:mn>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mn>1</mml:mn>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mn>1</mml:mn>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mn>1</mml:mn>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mn>1</mml:mn>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                  <mml:mo>]</mml:mo>
                </mml:mrow>
                <mml:mtext> and </mml:mtext>
                <mml:msub>
                  <mml:mi>γ</mml:mi>
                  <mml:mi>p</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>[</mml:mo>
                  <mml:mrow>
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>γ</mml:mi>
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>γ</mml:mi>
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                  <mml:mo>]</mml:mo>
                </mml:mrow>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>and thus <italic>μ</italic><sub><italic>p </italic></sub>= (<italic>γ</italic><sub><italic>p</italic>1</sub>, <italic>γ</italic><sub><italic>p</italic>1</sub>, <italic>γ </italic><sub><italic>p</italic>1</sub>, <italic>γ</italic><sub><italic>p</italic>2</sub>, <italic>γ</italic><sub><italic>p</italic>2</sub>, <italic>γ</italic><sub><italic>p</italic>2</sub>, <italic>γ</italic><sub><italic>p</italic>2</sub>)<sup><italic>T</italic></sup>. With <italic>C </italic>= [-1 1] we have <italic>δ</italic><sub><italic>p </italic></sub>= <italic>γ</italic><sub><italic>p</italic>2 </sub>- <italic>γ</italic><sub><italic>p</italic>1</sub>, thus <italic>δ</italic><sub><italic>p </italic></sub>is the logged fold change between conditions 2 and 1.</p>
      <p>However, instead of estimating the parameters of the model in Equ. 1 we use a reduced model derived from Equ. 1 through a linear transformation of the vector <italic>y</italic><sub><italic>p</italic></sub>. Define the <italic>n × n </italic>and <italic>n </italic>× 1 matrices</p>
      <p>
        <disp-formula><italic>A</italic><sub>0 </sub>= <italic>I - D</italic>(<italic>D</italic><sup><italic>T </italic></sup><italic>D</italic>)<sup>-1 </sup><italic>D</italic><sup><italic>T </italic></sup>and <italic>B </italic>= <italic>D</italic>(<italic>D</italic><sup><italic>T </italic></sup><italic>D</italic>)<sup>-1</sup><italic>C</italic><sup><italic>T</italic></sup>.</disp-formula>
      </p>
      <p>Since <italic>A</italic><sub>0 </sub>is of rank <italic>n - k </italic>only we let <italic>A </italic>be an <italic>n </italic>× (<italic>n - k</italic>) matrix whose column space equals that of <italic>A</italic><sub>0</sub>.</p>
      <p>With <italic>q </italic>= <italic>n - k </italic>+ 1 form the <italic>n × q </italic>transformation matrix <italic>M </italic>and the vector <italic>z</italic><sub><italic>p </italic></sub>of length <italic>q</italic></p>
      <p>
        <disp-formula id="bmcM2"><label>(2)</label><italic>M </italic>= [<italic>A</italic>; <italic>B</italic>] and <italic>z</italic><sub><italic>p </italic></sub>= <italic>M</italic><sup><italic>T </italic></sup><italic>y</italic><sub><italic>p</italic></sub></disp-formula>
      </p>
      <p>giving the reduced model</p>
      <p>
        <disp-formula id="bmcM3">
          <label>(3)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-9-156-i6" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>z</mml:mi>
                          <mml:mi>p</mml:mi>
                        </mml:msub>
                        <mml:mo>|</mml:mo>
                        <mml:msub>
                          <mml:mi>c</mml:mi>
                          <mml:mi>p</mml:mi>
                        </mml:msub>
                        <mml:mo>~</mml:mo>
                        <mml:msub>
                          <mml:mtext>N</mml:mtext>
                          <mml:mi>q</mml:mi>
                        </mml:msub>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mn>0</mml:mn>
                                <mml:mo>,</mml:mo>
                                <mml:mn>...</mml:mn>
                                <mml:mo>,</mml:mo>
                                <mml:mn>0</mml:mn>
                                <mml:mo>,</mml:mo>
                                <mml:msub>
                                  <mml:mi>δ</mml:mi>
                                  <mml:mi>p</mml:mi>
                                </mml:msub>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:mo>,</mml:mo>
                            <mml:msub>
                              <mml:mi>c</mml:mi>
                              <mml:mi>p</mml:mi>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>Σ</mml:mi>
                              <mml:mi>z</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>c</mml:mi>
                          <mml:mi>p</mml:mi>
                        </mml:msub>
                        <mml:mo>~</mml:mo>
                        <mml:msup>
                          <mml:mi>Γ</mml:mi>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mfrac>
                          <mml:mn>1</mml:mn>
                          <mml:mn>2</mml:mn>
                        </mml:mfrac>
                        <mml:mi>m</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mfrac>
                          <mml:mn>1</mml:mn>
                          <mml:mn>2</mml:mn>
                        </mml:mfrac>
                        <mml:mi>m</mml:mi>
                        <mml:mo>⋅</mml:mo>
                        <mml:mi>ν</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mover accent="true">
                            <mml:mi>μ</mml:mi>
                            <mml:mo>¯</mml:mo>
                          </mml:mover>
                          <mml:mi>p</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where ∑<sub><italic>z </italic></sub>= <italic>M</italic><sup><italic>T</italic></sup>∑<italic>M</italic>.</p>
      <p>The reduced model is fitted using the EM algorithm [<xref ref-type="bibr" rid="B29">29</xref>] as described in Section <italic>Parameter estimation</italic>.</p>
      <p>The <italic>c</italic><sub><italic>p</italic></sub>'s are treated as missing data and we replace the unknown intensity-level for probe <italic>p</italic>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-9-156-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, with the observed mean intensity across arrays, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-9-156-i7" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>. Given estimators of the parameters ∑<sub><italic>z</italic></sub>, <italic>m</italic>, and <italic>β </italic>we proceed as if these parameters are known, and weighted moderated t-tests are computed for each probe <italic>p</italic>. The unbiased minimum variance estimator of <italic>δ</italic><sub><italic>p </italic></sub>is</p>
      <p>
        <disp-formula id="bmcM4">
          <label>(4)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-9-156-i8" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>δ</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                  <mml:mi>p</mml:mi>
                </mml:msub>
                <mml:msup>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msup>
                      <mml:mi>λ</mml:mi>
                      <mml:mi>T</mml:mi>
                    </mml:msup>
                    <mml:msubsup>
                      <mml:mi>Σ</mml:mi>
                      <mml:mi>z</mml:mi>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mi>λ</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:msup>
                  <mml:mi>λ</mml:mi>
                  <mml:mi>T</mml:mi>
                </mml:msup>
                <mml:msubsup>
                  <mml:mi>Σ</mml:mi>
                  <mml:mi>z</mml:mi>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:msubsup>
                <mml:msub>
                  <mml:mi>z</mml:mi>
                  <mml:mi>p</mml:mi>
                </mml:msub>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>λ </italic>is the vector (0,...,0, 1)<sup><italic>T </italic></sup>of length <italic>q</italic>. The weighted moderated <italic>t</italic>-statistic is defined as</p>
      <p>
        <disp-formula id="bmcM5">
          <label>(5)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1471-2105-9-156-i9" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>t</mml:mi>
                    <mml:mo>˜</mml:mo>
                  </mml:mover>
                  <mml:mi>p</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msqrt>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi>q</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi>m</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msup>
                              <mml:mi>γ</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:msubsup>
                              <mml:mi>Σ</mml:mi>
                              <mml:mi>z</mml:mi>
                              <mml:mrow>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msubsup>
                            <mml:mi>λ</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                </mml:msqrt>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mover accent="true">
                        <mml:mi>δ</mml:mi>
                        <mml:mo>^</mml:mo>
                      </mml:mover>
                      <mml:mi>p</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msqrt>
                      <mml:mrow>
                        <mml:mi>m</mml:mi>
                        <mml:mi>exp</mml:mi>
                        <mml:mo>⁡</mml:mo>
                        <mml:mo>{</mml:mo>
                        <mml:mi>H</mml:mi>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mover accent="true">
                                <mml:mi>y</mml:mi>
                                <mml:mo>¯</mml:mo>
                              </mml:mover>
                              <mml:mi>p</mml:mi>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                          <mml:mi>T</mml:mi>
                        </mml:msup>
                        <mml:mi>β</mml:mi>
                        <mml:mo>}</mml:mo>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mtext>RSS</mml:mtext>
                          </mml:mrow>
                          <mml:mi>p</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msqrt>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>and under H<sub>0</sub>: <italic>δ</italic><sub><italic>p </italic></sub>= 0 it can be shown that <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1471-2105-9-156-i10" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> is <italic>t</italic>-distributed with <italic>q </italic>+ <italic>m </italic>- 1 degrees of freedom. Here</p>
      <p>
        <disp-formula id="bmcM6">
          <label>(6)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1471-2105-9-156-i11" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mtext>RSS</mml:mtext>
                  </mml:mrow>
                  <mml:mi>p</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msubsup>
                  <mml:mi>z</mml:mi>
                  <mml:mi>p</mml:mi>
                  <mml:mi>T</mml:mi>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mi>Σ</mml:mi>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>−</mml:mo>
                    <mml:msup>
                      <mml:mi>Σ</mml:mi>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mi>λ</mml:mi>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mi>λ</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:msup>
                              <mml:mi>Σ</mml:mi>
                              <mml:mrow>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mi>λ</mml:mi>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:msup>
                      <mml:mi>λ</mml:mi>
                      <mml:mi>T</mml:mi>
                    </mml:msup>
                    <mml:msup>
                      <mml:mi>Σ</mml:mi>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:msub>
                  <mml:mi>z</mml:mi>
                  <mml:mi>p</mml:mi>
                </mml:msub>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>is the weighted residual sum of squares. See [<xref ref-type="bibr" rid="B5">5</xref>] for details. The PLW statistic for the probe-set <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1471-2105-9-156-i12" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">G</mml:mi></mml:semantics></mml:math></inline-formula> is then defined as</p>
      <p>
        <disp-formula id="bmcM7">
          <label>(7)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1471-2105-9-156-i13" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mtext>PLW</mml:mtext>
                  </mml:mrow>
                  <mml:mi mathvariant="script">G</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mtext>median</mml:mtext>
                <mml:mrow>
                  <mml:mo>{</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mover accent="true">
                        <mml:mi>t</mml:mi>
                        <mml:mo>˜</mml:mo>
                      </mml:mover>
                      <mml:mi>p</mml:mi>
                    </mml:msub>
                    <mml:mo>:</mml:mo>
                    <mml:mi>p</mml:mi>
                    <mml:mo>∈</mml:mo>
                    <mml:mi mathvariant="script">G</mml:mi>
                  </mml:mrow>
                  <mml:mo>}</mml:mo>
                </mml:mrow>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>The LMW and PLW methods are implemented in the R package plw [<xref ref-type="bibr" rid="B30">30</xref>] available at the authors' web page and at the Bioconductor projects web page [<xref ref-type="bibr" rid="B31">31</xref>] (at the time of writing only among devel-packages, bioconductor 2.2).</p>
    </sec>
    <sec>
      <title>Parameter estimation</title>
      <p>The <italic>q × q </italic>covariance matrix ∑<sub><italic>z </italic></sub>of the reduced model in Equ. 3 is divided according to</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="1471-2105-9-156-i14" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>Σ</mml:mi>
                  <mml:mi>z</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>[</mml:mo>
                  <mml:mrow>
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>Σ</mml:mi>
                              <mml:mi>A</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>Σ</mml:mi>
                              <mml:mrow>
                                <mml:mi>A</mml:mi>
                                <mml:mi>B</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mi>Σ</mml:mi>
                              <mml:mrow>
                                <mml:mi>A</mml:mi>
                                <mml:mi>B</mml:mi>
                              </mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mi>σ</mml:mi>
                              <mml:mi>B</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                  <mml:mo>]</mml:mo>
                </mml:mrow>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where ∑<sub><italic>A </italic></sub>is the covariance matrix for all but the last dimension of <italic>z</italic><sub><italic>p </italic></sub>and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="1471-2105-9-156-i15" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> is the variance of the last dimension (indexes <italic>A </italic>and <italic>B </italic>refer to the corresponding sub-matrices of the transformation matrix <italic>M </italic>in Equ. 2). The reduced model is fitted in two steps. First the parameters <italic>m</italic>, <italic>β </italic>and the sub-matrix ∑<sub><italic>A </italic></sub>are estimated by dropping the last dimension of the vectors <italic>z</italic><sub><italic>p</italic></sub>. Since the reduced model is not identifiable without a restriction on the function <italic>ν </italic>or the covariance matrices ∑<sub><italic>z </italic></sub>we use the restriction trace(∑<sub><italic>A</italic></sub>) = <italic>q </italic>- 1. Secondly, the parameters <italic>m </italic>and <italic>β </italic>are held fixed and ∑<sub><italic>z </italic></sub>is estimated using the complete <italic>z</italic><sub><italic>p </italic></sub>vectors. Temporarily the assumption of no regulated genes is used (<italic>δ</italic><sub><italic>p </italic></sub>= 0 for all probes) and ∑<sub><italic>z </italic></sub>is estimated under the restriction that the trace of the ∑<sub><italic>A </italic></sub>part should be equal to <italic>q </italic>- 1.</p>
      <p>In step 1, we let <italic>x</italic><sub><italic>p </italic></sub>denote the sub-vector of <italic>z</italic><sub><italic>p </italic></sub>obtained by dropping the last element. Under the reduced model <italic>x</italic><sub><italic>p </italic></sub>is distributed according to the model in Equ. 1 with ∑ = ∑<sub><italic>A</italic></sub>, <italic>μ</italic><sub><italic>p </italic></sub>= 0, <italic>n </italic>= <italic>q </italic>- 1, and using the EM-algorithm an iterative procedure for estimating <italic>m</italic>, <italic>β </italic>and ∑<sub><italic>A </italic></sub>is obtained. Given estimates of the previous iteration, <italic>m</italic><sub>0</sub>, <italic>β</italic><sub>0 </sub>and ∑<sub><italic>A</italic>0</sub>, updated estimates are found as follows. Let</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="1471-2105-9-156-i16" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>w</mml:mi>
                  <mml:mi>p</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>m</mml:mi>
                      <mml:mn>0</mml:mn>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:mi>q</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mi>x</mml:mi>
                      <mml:mi>p</mml:mi>
                      <mml:mi>T</mml:mi>
                    </mml:msubsup>
                    <mml:msubsup>
                      <mml:mi>Σ</mml:mi>
                      <mml:mrow>
                        <mml:mi>A</mml:mi>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:msub>
                      <mml:mi>x</mml:mi>
                      <mml:mi>p</mml:mi>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:msub>
                      <mml:mi>m</mml:mi>
                      <mml:mn>0</mml:mn>
                    </mml:msub>
                    <mml:mi>exp</mml:mi>
                    <mml:mo>⁡</mml:mo>
                    <mml:mo>{</mml:mo>
                    <mml:mi>H</mml:mi>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mover accent="true">
                            <mml:mi>y</mml:mi>
                            <mml:mo>¯</mml:mo>
                          </mml:mover>
                          <mml:mi>p</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mi>T</mml:mi>
                    </mml:msup>
                    <mml:msub>
                      <mml:mi>β</mml:mi>
                      <mml:mn>0</mml:mn>
                    </mml:msub>
                    <mml:mo>}</mml:mo>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>The updated estimate of ∑<sub><italic>A </italic></sub>is</p>
      <p>
        <disp-formula id="bmcM8">
          <label>(8)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="1471-2105-9-156-i17" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>Σ</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                  <mml:mi>A</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mn>1</mml:mn>
                  <mml:mi>P</mml:mi>
                </mml:mfrac>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>w</mml:mi>
                      <mml:mi>p</mml:mi>
                    </mml:msub>
                    <mml:msub>
                      <mml:mi>x</mml:mi>
                      <mml:mi>p</mml:mi>
                    </mml:msub>
                    <mml:msubsup>
                      <mml:mi>x</mml:mi>
                      <mml:mi>p</mml:mi>
                      <mml:mi>T</mml:mi>
                    </mml:msubsup>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>and the updated estimate of <italic>β </italic>is found by numerical maximization of the function</p>
      <p>
        <disp-formula id="bmcM9">
          <label>(9)</label>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="1471-2105-9-156-i18" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mi>h</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>β</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mn>1</mml:mn>
                  <mml:mi>P</mml:mi>
                </mml:mfrac>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>H</mml:mi>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mover accent="true">
                                <mml:mi>y</mml:mi>
                                <mml:mo>¯</mml:mo>
                              </mml:mover>
                              <mml:mi>p</mml:mi>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                          <mml:mi>T</mml:mi>
                        </mml:msup>
                        <mml:mi>β</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mi>w</mml:mi>
                          <mml:mi>p</mml:mi>
                        </mml:msub>
                        <mml:mi>exp</mml:mi>
                        <mml:mo>⁡</mml:mo>
                        <mml:mo>{</mml:mo>
                        <mml:mi>H</mml:mi>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mover accent="true">
                                <mml:mi>y</mml:mi>
                                <mml:mo>¯</mml:mo>
                              </mml:mover>
                              <mml:mi>p</mml:mi>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                          <mml:mi>T</mml:mi>
                        </mml:msup>
                        <mml:mi>β</mml:mi>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>With <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" name="1471-2105-9-156-i19" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> equal to the updated estimate of <italic>β </italic>let</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" name="1471-2105-9-156-i20" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mi>S</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mi>h</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mover accent="true">
                          <mml:mi>β</mml:mi>
                          <mml:mo>^</mml:mo>
                        </mml:mover>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>−</mml:mo>
                        <mml:mi>log</mml:mi>
                        <mml:mo>⁡</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>m</mml:mi>
                          <mml:mn>0</mml:mn>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:mi>q</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mi>ψ</mml:mi>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>m</mml:mi>
                                  <mml:mn>0</mml:mn>
                                </mml:msub>
                                <mml:mo>+</mml:mo>
                                <mml:mi>q</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mfrac>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mfrac>
                          <mml:mn>1</mml:mn>
                          <mml:mi>P</mml:mi>
                        </mml:mfrac>
                        <mml:mstyle displaystyle="true">
                          <mml:munderover>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mi>P</mml:mi>
                          </mml:munderover>
                          <mml:mrow>
                            <mml:mi>log</mml:mi>
                            <mml:mo>⁡</mml:mo>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mi>w</mml:mi>
                              <mml:mi>p</mml:mi>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" name="1471-2105-9-156-i21" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>ψ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:semantics></mml:math></inline-formula> is the digamma function. The updated estimate of <italic>m </italic>is then found using numerical maximization of the function</p>
      <p>
        <disp-formula id="bmcM10"><label>(10)</label><italic>f</italic>(<italic>m</italic>) = <italic>m </italic>(log(<italic>m</italic>) + <italic>S</italic>) -2 log (Γ(<italic>m</italic>/2)).</disp-formula>
      </p>
      <p>In step 2 a similar iterative procedure is used to estimate ∑<sub><italic>z</italic></sub>. With ∑<sub><italic>z</italic>0 </sub>denoting the estimate of ∑<sub><italic>z </italic></sub>from the previous iteration and with <italic>w</italic><sub><italic>p </italic></sub>re-defined as</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" name="1471-2105-9-156-i22" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>w</mml:mi>
                  <mml:mi>p</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mover accent="true">
                      <mml:mi>m</mml:mi>
                      <mml:mo>^</mml:mo>
                    </mml:mover>
                    <mml:mo>+</mml:mo>
                    <mml:mi>q</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mi>z</mml:mi>
                      <mml:mi>p</mml:mi>
                      <mml:mi>T</mml:mi>
                    </mml:msubsup>
                    <mml:msubsup>
                      <mml:mi>Σ</mml:mi>
                      <mml:mrow>
                        <mml:mi>z</mml:mi>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:msub>
                      <mml:mi>z</mml:mi>
                      <mml:mi>p</mml:mi>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:mover accent="true">
                      <mml:mi>m</mml:mi>
                      <mml:mo>^</mml:mo>
                    </mml:mover>
                    <mml:mi>exp</mml:mi>
                    <mml:mo>⁡</mml:mo>
                    <mml:mo>{</mml:mo>
                    <mml:mi>H</mml:mi>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mover accent="true">
                            <mml:mi>y</mml:mi>
                            <mml:mo>¯</mml:mo>
                          </mml:mover>
                          <mml:mi>p</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mi>T</mml:mi>
                    </mml:msup>
                    <mml:mover accent="true">
                      <mml:mi>β</mml:mi>
                      <mml:mo>^</mml:mo>
                    </mml:mover>
                    <mml:mo>}</mml:mo>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" name="1471-2105-9-156-i23" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" name="1471-2105-9-156-i19" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> are the estimates obtained in step 1, an updated estimate of ∑<sub><italic>z </italic></sub>is computed according to Equ. 8 with <italic>z</italic><sub><italic>p </italic></sub>replacing <italic>x</italic><sub><italic>p</italic></sub>. In order for the estimators of ∑<sub><italic>A </italic></sub>and ∑<sub><italic>z</italic></sub>, in step 1 and 2, respectively, to comply with the trace restriction the updated estimates are scaled at the end of each iteration. [For more details see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>]</p>
    </sec>
    <sec>
      <title>Data sets</title>
      <p>The two data sets used in Figures <xref ref-type="fig" rid="F1">1</xref> and <xref ref-type="fig" rid="F2">2</xref> are publicly available at the Gene Expression Omnibus repository [<xref ref-type="bibr" rid="B32">32</xref>] with series or sample reference number indicated below. Data set A consists of the 18 arrays from the severe group of the COPD data set [<xref ref-type="bibr" rid="B33">33</xref>] (series reference number GSE1650), where Affymetrix arrays of type HG U133A were used. In data set B the 18 arrays with normal tissue where selected from a lung tumor data set [<xref ref-type="bibr" rid="B34">34</xref>] (sample reference numbers GSM47958-GSM47976, excluding GSM47967). Here the HG-U95A arrays were used.</p>
      <p>Five spike-in data sets were used to evaluate the proposed methods. In the Affymetrix U95 and 133A Latin Square data sets [<xref ref-type="bibr" rid="B35">35</xref>] arrays of type HG-U95A and HG-U133A, respectively, were used. The Affymetrix U95 data set consists of data from 59 arrays divided into 19 groups of size 3, and one group of size 2.</p>
      <p>From the 20 groups there are 178 possible pair-wise group comparisons each with 16 [<xref ref-type="bibr" rid="B36">36</xref>] known differentially expressed genes among the 12626 genes present on the arrays. The Affymetrix 133A data set comprise data from 42 arrays with a total of 22300 probe-sets of which 42 were spiked in at known concentration. The 42 arrays are divided into 14 groups of size 3 and thus there are 91 possible pair-wise group comparisons. As done in the Affycomp II assessments [<xref ref-type="bibr" rid="B36">36</xref>] we exclude 271 probe-sets which are likely to cross-hybridize to spike-in probe-sets. The sequence of each spike-in clone was blasted against all HG-U133A target sequences (~600 bp regions from which probes are selected). A threshold of 100 bp identified 271 probe-sets which are available in the Affycomp R-package.</p>
      <p>From the Gene Logic Tonsil and AML data sets [<xref ref-type="bibr" rid="B37">37</xref>] all groups with 3 replicated arrays were used, giving a total of 12 and 10 groups, respectively. For these data there are 11 genes spiked in at known concentration, which can be studied in 66 and 45 pair-wise group comparisons, respectively. Both data sets were obtained using the Affymetrix HG-U95A arrays having 12626 genes.</p>
      <p>The Golden Spike data set [<xref ref-type="bibr" rid="B38">38</xref>] consists of 6 arrays of type Drosgenome1 divided into 2 groups of equal size. The samples used in this experiment consist of mRNA from 3866 genes, of which 1331 are differentially expressed between the groups. The Drosgenome1 array has a total of 14010 genes, thus 10144 of these should not be expressed, 2535 should be expressed but not regulated, and 1331 should be expressed and regulated.</p>
      <p>Since all 1331 genes are up-regulated in the spike-in group it is necessary to take special care in the normalization when analyzing this data set. Generally this means performing normalizations based on a subset of genes, either only the 2535 genes spiked in at identical concentration in both groups [<xref ref-type="bibr" rid="B39">39</xref>], or the 2535 genes together with the 10144 absent genes [<xref ref-type="bibr" rid="B38">38</xref>]. Thus, knowledge about which genes are regulated, which of course is not available for a real situation, is used in the normalization.</p>
      <p>For PPLR, BGX, and the analysis based on MAS5 expression indexes we used a loess-subset normalization of probe set summaries as done in [<xref ref-type="bibr" rid="B17">17</xref>,<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B38">38</xref>]. For the analysis based on RMA (and GCRMA) pre-processed data we used a loess-subset normalization of PM probe intensities similar to the one performed in [<xref ref-type="bibr" rid="B40">40</xref>]. PM probe intensities were corrected for background using the default background method of RMA (or GCRMA) and then loess-normalized using the same subset as used in [<xref ref-type="bibr" rid="B38">38</xref>], thus the 2535 genes spiked in at identical concentration in both groups together with the 10144 absent genes. At this point PLW, median-t, and combined-p were applied to logged PM intensities. Probe set summaries using median polish were then computed and all 10 methods using expression indexes as input were used to rank genes with respect to differential expression.</p>
    </sec>
    <sec>
      <title>Comparison with existing methods</title>
      <p>Using the spike-in data sets listed above the proposed methods, PLW and LMW were compared with 14 existing methods for ranking genes. The 14 methods include ranking with respect to: observed fold change (FC), ordinary t-test, the moderated t-test in the R-package LIMMA [<xref ref-type="bibr" rid="B3">3</xref>], the weighted moderated t-test in the R-package WAME.EM [<xref ref-type="bibr" rid="B8">8</xref>], Efron's penalized t-test [<xref ref-type="bibr" rid="B11">11</xref>] and the Shrink-t method [<xref ref-type="bibr" rid="B9">9</xref>] in the R-package st, the SAM method [<xref ref-type="bibr" rid="B10">10</xref>] in the R-package samr, the Local-pooled-error test [<xref ref-type="bibr" rid="B13">13</xref>] in the R-package LPE, the Intensity-Based Moderated T-statistic (IBMT) [<xref ref-type="bibr" rid="B6">6</xref>] using the R-code available at <ext-link ext-link-type="uri" xlink:href="http://eh3.uc.edu/r/ibmtR.R"/>, and the two probe-level methods median-t and combined-p suggested by Hess and Iyer [<xref ref-type="bibr" rid="B40">40</xref>].</p>
      <p>All methods using expression indexes as input (including PLW) were applied to RMA, GCRMA and MAS5 expression indexes obtained using the R-package affy, while PLW, median-t, and combined-p were applied to logged PM intensities, background corrected and normalized using the default methods of RMA and GCRMA. (The empirical Bayes approach of GCRMA was used to calculate background corrected intensities, thus the fast option was set to FALSE). With LMW 4–6 spline-knots (depending on the number of probe-sets) were used for the function <italic>ν</italic>, whereas 12 knots were used in PLW (the spline-knots are set using an internal function in the R-package plw). Note that RMA and GCRMA were applied only to the arrays involved in each group comparison, as opposed to running RMA and GCRMA using all arrays of each data set.</p>
      <p>We also compared with the PPLR method [<xref ref-type="bibr" rid="B19">19</xref>] applied to the expression index and probe-level measurement error of the multi-mgMOS model [<xref ref-type="bibr" rid="B18">18</xref>] available in the R-package puma, the logit-t procedure implemented in the R-package plw according to the description in [<xref ref-type="bibr" rid="B41">41</xref>], and the BGX method [<xref ref-type="bibr" rid="B17">17</xref>] as implemented in the R-package bgx. The R-code used for each of the 14 methods is available as supplementary material. [See Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>]</p>
      <p>Due to long computer run times the comparison with the BGX method is restricted to the Golden Spike data set, and a subset of genes from the Gene Logic AML data set (the run time for one single analysis of 6 arrays with all 12626 probe-sets is more than 24 hours). The subset of size 1011 of the Gene Logic AML data set consists of probe-sets number 6000–7002 (excluding 6030, 6367, and 6463) together with the 11 spiked probe-sets and the same subset was used in [<xref ref-type="bibr" rid="B17">17</xref>]. The probe-set numbering is as obtained when loading data into R using the R-package affy. Also, to avoid introducing yet another normalization of the Golden Spike data set, logit-T was not applied to this data set.</p>
      <p>For each spike-in data set and combination of method and expression index/pre-processing ROC-curves were calculated. Also, for the analysis using a complete set of probe-sets, the area (AUC) under the ROC curve up to 25, 50, 100 and 200 false positives was computed. In the comparison with BGX using only 1011 probe-sets, AUC was computed up to 2, 4, 8 and 16 false positives in order to cover the same false positive range as for the complete probe-set comparisons.</p>
      <p>For the analysis based on RMA pre-processing, ROC curves for a subset of the compared methods are found in Figure <xref ref-type="fig" rid="F3">3</xref>. AUC values up to 100 false positives from the complete probe-set analysis are found in Tables <xref ref-type="table" rid="T1">1</xref> and <xref ref-type="table" rid="T2">2</xref>. (ROC curves for all methods and AUC up to 25, 50, 200 false positives are available as supplementary material. [See Additional file <xref ref-type="supplementary-material" rid="S3">3</xref> and Additional file <xref ref-type="supplementary-material" rid="S4">4</xref>])</p>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p><bold>ROC curves</bold>. ROC curves for a subset of the methods compared when applied to RMA pre-processed data. The horizontal axis shows the number of false positives (FP) and the vertical axis the proportion of true positives found (TP).</p>
        </caption>
        <graphic xlink:href="1471-2105-9-156-3"/>
      </fig>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Area under ROC curves up to 100 false positives, RMA and GCRMA</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">Method</td>
              <td align="left">Pre-processing</td>
              <td align="center">Affymetrix U95</td>
              <td align="center">Affymetrix 133A</td>
              <td align="center">Golden Spike</td>
              <td align="center">Gene Logic Tonsil</td>
              <td align="center">Gene Logic AML</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">PLW</td>
              <td align="left">RMA</td>
              <td align="center">96(1)</td>
              <td align="center">93(6)</td>
              <td align="center">42(1)</td>
              <td align="center">87(1)</td>
              <td align="center">86(1)</td>
            </tr>
            <tr>
              <td align="left">LMW</td>
              <td align="left">RMA</td>
              <td align="center">96(2)</td>
              <td align="center">94(1)</td>
              <td align="center">36(5)</td>
              <td align="center">84(3)</td>
              <td align="center">80(5)</td>
            </tr>
            <tr>
              <td align="left">LPE</td>
              <td align="left">RMA</td>
              <td align="center">94(7)</td>
              <td align="center">93(11)</td>
              <td align="center">40(2)</td>
              <td align="center">84(2)</td>
              <td align="center">85(2)</td>
            </tr>
            <tr>
              <td align="left">combined-p</td>
              <td align="left">RMA</td>
              <td align="center">95(4)</td>
              <td align="center">92(12)</td>
              <td align="center">39(3)</td>
              <td align="center">83(4)</td>
              <td align="center">81(4)</td>
            </tr>
            <tr>
              <td align="left">WAME</td>
              <td align="left">RMA</td>
              <td align="center">95(5)</td>
              <td align="center">94(2)</td>
              <td align="center">33(7)</td>
              <td align="center">81(7)</td>
              <td align="center">78(8)</td>
            </tr>
            <tr>
              <td align="left">median-t</td>
              <td align="left">RMA</td>
              <td align="center">95(3)</td>
              <td align="center">93(10)</td>
              <td align="center">39(4)</td>
              <td align="center">82(6)</td>
              <td align="center">80(6)</td>
            </tr>
            <tr>
              <td align="left">IBMT</td>
              <td align="left">RMA</td>
              <td align="center">95(6)</td>
              <td align="center">94(3)</td>
              <td align="center">34(6)</td>
              <td align="center">78(9)</td>
              <td align="center">76(9)</td>
            </tr>
            <tr>
              <td align="left">Efron-t</td>
              <td align="left">RMA</td>
              <td align="center">94(8)</td>
              <td align="center">93(4)</td>
              <td align="center">32(8)</td>
              <td align="center">79(8)</td>
              <td align="center">79(7)</td>
            </tr>
            <tr>
              <td align="left">FC</td>
              <td align="left">RMA</td>
              <td align="center">92(12)</td>
              <td align="center">93(5)</td>
              <td align="center">29(12)</td>
              <td align="center">83(5)</td>
              <td align="center">85(3)</td>
            </tr>
            <tr>
              <td align="left">LIMMA</td>
              <td align="left">RMA</td>
              <td align="center">94(9)</td>
              <td align="center">93(7)</td>
              <td align="center">32(9)</td>
              <td align="center">76(10)</td>
              <td align="center">75(10)</td>
            </tr>
            <tr>
              <td align="left">SAM</td>
              <td align="left">RMA</td>
              <td align="center">94(10)</td>
              <td align="center">93(8)</td>
              <td align="center">32(11)</td>
              <td align="center">74(12)</td>
              <td align="center">74(11)</td>
            </tr>
            <tr>
              <td align="left">Shrink-t</td>
              <td align="left">RMA</td>
              <td align="center">94(11)</td>
              <td align="center">93(9)</td>
              <td align="center">32(10)</td>
              <td align="center">75(11)</td>
              <td align="center">73(12)</td>
            </tr>
            <tr>
              <td align="left">t-test</td>
              <td align="left">RMA</td>
              <td align="center">85(13)</td>
              <td align="center">86(13)</td>
              <td align="center">21(13)</td>
              <td align="center">57(13)</td>
              <td align="center">52(13)</td>
            </tr>
            <tr>
              <td colspan="7">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">PLW</td>
              <td align="left">GCRMA</td>
              <td align="center">97(1)</td>
              <td align="center">92(8)</td>
              <td align="center">54(1)</td>
              <td align="center">87(1)</td>
              <td align="center">87(1)</td>
            </tr>
            <tr>
              <td align="left">LMW</td>
              <td align="left">GCRMA</td>
              <td align="center">95(3)</td>
              <td align="center">93(1)</td>
              <td align="center">50(5)</td>
              <td align="center">84(3)</td>
              <td align="center">79(6)</td>
            </tr>
            <tr>
              <td align="left">median-t</td>
              <td align="left">GCRMA</td>
              <td align="center">96(2)</td>
              <td align="center">92(10)</td>
              <td align="center">50(2)</td>
              <td align="center">83(4)</td>
              <td align="center">81(5)</td>
            </tr>
            <tr>
              <td align="left">combined-p</td>
              <td align="left">GCRMA</td>
              <td align="center">95(5)</td>
              <td align="center">91(12)</td>
              <td align="center">50(4)</td>
              <td align="center">86(2)</td>
              <td align="center">81(4)</td>
            </tr>
            <tr>
              <td align="left">LPE</td>
              <td align="left">GCRMA</td>
              <td align="center">95(6)</td>
              <td align="center">91(11)</td>
              <td align="center">50(3)</td>
              <td align="center">82(6)</td>
              <td align="center">86(2)</td>
            </tr>
            <tr>
              <td align="left">IBMT</td>
              <td align="left">GCRMA</td>
              <td align="center">95(4)</td>
              <td align="center">93(2)</td>
              <td align="center">47(6)</td>
              <td align="center">81(9)</td>
              <td align="center">76(8)</td>
            </tr>
            <tr>
              <td align="left">Efron-t</td>
              <td align="left">GCRMA</td>
              <td align="center">94(7)</td>
              <td align="center">93(4)</td>
              <td align="center">37(8)</td>
              <td align="center">82(7)</td>
              <td align="center">79(7)</td>
            </tr>
            <tr>
              <td align="left">WAME</td>
              <td align="left">GCRMA</td>
              <td align="center">94(10)</td>
              <td align="center">93(3)</td>
              <td align="center">39(7)</td>
              <td align="center">83(5)</td>
              <td align="center">75(10)</td>
            </tr>
            <tr>
              <td align="left">FC</td>
              <td align="left">GCRMA</td>
              <td align="center">93(12)</td>
              <td align="center">93(7)</td>
              <td align="center">30(13)</td>
              <td align="center">81(8)</td>
              <td align="center">86(3)</td>
            </tr>
            <tr>
              <td align="left">LIMMA</td>
              <td align="left">GCRMA</td>
              <td align="center">94(9)</td>
              <td align="center">93(5)</td>
              <td align="center">37(9)</td>
              <td align="center">80(10)</td>
              <td align="center">73(11)</td>
            </tr>
            <tr>
              <td align="left">SAM</td>
              <td align="left">GCRMA</td>
              <td align="center">94(8)</td>
              <td align="center">93(6)</td>
              <td align="center">36(11)</td>
              <td align="center">79(11)</td>
              <td align="center">76(9)</td>
            </tr>
            <tr>
              <td align="left">Shrink-t</td>
              <td align="left">GCRMA</td>
              <td align="center">94(11)</td>
              <td align="center">92(9)</td>
              <td align="center">37(10)</td>
              <td align="center">78(12)</td>
              <td align="center">70(12)</td>
            </tr>
            <tr>
              <td align="left">t-test</td>
              <td align="left">GCRMA</td>
              <td align="center">86(13)</td>
              <td align="center">84(13)</td>
              <td align="center">30(12)</td>
              <td align="center">64(13)</td>
              <td align="center">53(13)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Area under ROC curves up to 100 false positives rounded to nearest integer value with an optimum of 100. Numbers within parenthesis are within data set ranks for the methods compared (separately for RMA and GCRMA). Methods are ordered with respect to mean rank across the five data sets. Results in the upper and lower part are based on RMA and GCRMA pre-processed data, respectively.</p>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Area under ROC curves up to 100 false positives, MAS5, PPLR, BGX, and Logit-T</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">Method</td>
              <td align="left">Pre-processing</td>
              <td align="center">Affymetrix U95</td>
              <td align="center">Affymetrix 133A</td>
              <td align="center">Golden Spike</td>
              <td align="center">Gene Logic Tonsil</td>
              <td align="center">Gene Logic AML</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">LMW</td>
              <td align="left">MAS5</td>
              <td align="center">89(1)</td>
              <td align="center">87(1)</td>
              <td align="center">60(1)</td>
              <td align="center">79(1)</td>
              <td align="center">70(2)</td>
            </tr>
            <tr>
              <td align="left">IBMT</td>
              <td align="left">MAS5</td>
              <td align="center">87(2)</td>
              <td align="center">87(2)</td>
              <td align="center">59(2)</td>
              <td align="center">77(3)</td>
              <td align="center">69(3)</td>
            </tr>
            <tr>
              <td align="left">LPE</td>
              <td align="left">MAS5</td>
              <td align="center">84(3)</td>
              <td align="center">84(3)</td>
              <td align="center">57(3)</td>
              <td align="center">78(2)</td>
              <td align="center">79(1)</td>
            </tr>
            <tr>
              <td align="left">WAME</td>
              <td align="left">MAS5</td>
              <td align="center">71(6)</td>
              <td align="center">81(5)</td>
              <td align="center">34(5)</td>
              <td align="center">69(4)</td>
              <td align="center">54(8)</td>
            </tr>
            <tr>
              <td align="left">SAM</td>
              <td align="left">MAS5</td>
              <td align="center">74(4)</td>
              <td align="center">81(4)</td>
              <td align="center">11(8)</td>
              <td align="center">67(5)</td>
              <td align="center">54(9)</td>
            </tr>
            <tr>
              <td align="left">LIMMA</td>
              <td align="left">MAS5</td>
              <td align="center">71(7)</td>
              <td align="center">81(6)</td>
              <td align="center">31(6)</td>
              <td align="center">67(6)</td>
              <td align="center">54(6)</td>
            </tr>
            <tr>
              <td align="left">Shrink-t</td>
              <td align="left">MAS5</td>
              <td align="center">71(8)</td>
              <td align="center">80(7)</td>
              <td align="center">23(7)</td>
              <td align="center">67(7)</td>
              <td align="center">54(7)</td>
            </tr>
            <tr>
              <td align="left">t-test</td>
              <td align="left">MAS5</td>
              <td align="center">73(5)</td>
              <td align="center">76(8)</td>
              <td align="center">39(4)</td>
              <td align="center">60(9)</td>
              <td align="center">47(10)</td>
            </tr>
            <tr>
              <td align="left">Efron-t</td>
              <td align="left">MAS5</td>
              <td align="center">65(9)</td>
              <td align="center">72(9)</td>
              <td align="center">3(9)</td>
              <td align="center">66(8)</td>
              <td align="center">57(4)</td>
            </tr>
            <tr>
              <td align="left">FC</td>
              <td align="left">MAS5</td>
              <td align="center">56(10)</td>
              <td align="center">61(10)</td>
              <td align="center">0(10)</td>
              <td align="center">58(10)</td>
              <td align="center">55(5)</td>
            </tr>
            <tr>
              <td colspan="7">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">BGX</td>
              <td/>
              <td align="center">-</td>
              <td align="center">-</td>
              <td align="center">58</td>
              <td align="center">-</td>
              <td align="center">
                <italic>75*</italic>
              </td>
            </tr>
            <tr>
              <td align="left">logit-T</td>
              <td/>
              <td align="center">94</td>
              <td align="center">92</td>
              <td align="center">-</td>
              <td align="center">80</td>
              <td align="center">79</td>
            </tr>
            <tr>
              <td align="left">PPLR</td>
              <td align="left">multi-mgMOS</td>
              <td align="center">88</td>
              <td align="center">90</td>
              <td align="center">57</td>
              <td align="center">71</td>
              <td align="center">69</td>
            </tr>
            <tr>
              <td colspan="7">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left"># of genes</td>
              <td/>
              <td align="center">12626</td>
              <td align="center">22029</td>
              <td align="center">14010</td>
              <td align="center">12626</td>
              <td align="center">12626</td>
            </tr>
            <tr>
              <td align="left"># of spikes</td>
              <td/>
              <td align="center">16</td>
              <td align="center">42</td>
              <td align="center">1331</td>
              <td align="center">11</td>
              <td align="center">11</td>
            </tr>
            <tr>
              <td align="left"># of groups</td>
              <td/>
              <td align="center">20</td>
              <td align="center">14</td>
              <td align="center">2</td>
              <td align="center">12</td>
              <td align="center">10</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Area under ROC curves up to 100 false positives rounded to nearest integer value with an optimum of 100. Numbers within parenthesis are within data set ranks for the methods compared, and methods are ordered with respect to mean rank across the five data sets (within MAS5 only). *Results in <italic>italic </italic>are from the subset of 1011 probe sets of the Gene Logic AML data set.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>Results for RMA pre-processing are found in the upper part of Table <xref ref-type="table" rid="T1">1</xref>. Three of the four methods taking the variability-to-intensity-level dependency into account (PLW, LMW and LPE) performed overall better than the other methods, with the proposed method PLW having the highest AUC on four of the five data sets. The fourth method taking the variability-to-intensity-level dependency into account (IBMT) performed comparably well on the Affymetrix and Golden Spike data sets but less so on the two Gene Logic data sets.</p>
      <p>Ranking genes with respect to FC performs quite well on the Affymetrix U133A and the two Gene Logic data sets but not on the other two data sets. Among the penalized and moderated t-test methods, WAME and Efron-t consistently perform better than the other ones. However, the difference between these methods for the two Affymetrix Latin Square and the Golden Spike data sets are small, compared to the difference in AUC obtained using the two Gene Logic data sets. Thus, the two Gene Logic data sets appear slightly different from the other three.</p>
      <p>The results obtained using GCRMA in the lower part of Table <xref ref-type="table" rid="T1">1</xref> are very similar to the results with RMA shown in the upper part. For the Golden Spike data set, replacing GCRMA with RMA improves the performance of all methods but the ordering of the methods is fairly unchanged. Overall, IBMT, Efron-t and median-t, performs slightly better when applied to GCRMA expression indexes whereas WAME and LPE performs slightly worse. The overall ordering of the top-two methods is unchanged.</p>
      <p>Since MAS5 expression indexes show a very clear dependency between variability and intensity level in Figure <xref ref-type="fig" rid="F1">1</xref>, and since the variability decreases with intensity it comes as no surprise that all three methods taking this dependency into account consistently performs better than all other methods as shown in the upper part of Table <xref ref-type="table" rid="T2">2</xref>. The LMW method has the most accurate ranking of genes in 4 out of the 5 data-sets, and performs better than the IBMT method on all 5 data-sets. Since the main difference between LMW and IBMT is that LMW performs a weighted analysis, and since WAME overall performs better than LIMMA, it appears as if weighted analysis should be used in preference to analysis using unweighted analysis.</p>
      <p>The lower part of Table <xref ref-type="table" rid="T2">2</xref> shows results for PPLR, BGX, and logit-t. For the Golden spike data set both PPLR and BGX perform comparably well, only LMW and IBMT applied on MAS5 expression indexes have higher ROC curve AUC. In the analysis of 1011 probe sets from the Gene Logic AML data set, PLW shows consistently higher true positive rate compared with BGX (Figure <xref ref-type="fig" rid="F3">3</xref>) and the AUC up to 8 false positives (scaled so that optimum is 100) is 84 and 75 for PLW and BGX, respectively. For the remaining data sets PPLR performed comparably well with other methods using MAS5 expression indexes, but less so when comparing with RMA and GCRMA pre-processed data.</p>
      <p>The second proposed method LMW differs from existing moderated and penalized t-test in that the global variance estimator (which gene-specific estimators are adjusted towards) varies with intensity-level.</p>
      <p>Actually this is the only difference between LMW and the WAME method. The LPE method also uses a global variance estimator that varies with intensity-level. But opposed to using a weighted mean of the global and gene-specific estimator, only the global estimator is used in the denominator of the LPE statistic. Thus for genes with similar intensity-level, LPE is basically identical to ranking using fold change. Hence, since LMW consistently performs better than WAME, and LPE has higher AUC than fold change in four of the five data test, modeling the global variance estimator as a function of intensity is worthwhile doing.</p>
      <p>Figure <xref ref-type="fig" rid="F2">2</xref> shows that the false positive rate obtained by adjusting towards a global estimate that varies with intensity-level results in a much more stable false positive rates compared to using a (truly) global estimate. It should be mentioned that as the number of arrays increases, the variability of the false positive rate across intensity-level decreases, when adjusting towards a truly global estimate as well as when adjusting towards an intensity-level dependent global estimate. Figure <xref ref-type="fig" rid="F2">2</xref> is based on 3+3 arrays, and the estimated false positive rate for LIMMA varies between 1.3% and 8.3%. When repeating the same analysis using 5+5 arrays the estimated false positive rate varied between 1.8% and 7%.</p>
      <p>With RMA (and GCRMA) pre-processed data, we do comparisons between 1) Compute probe set summaries from probe intensities and then do inference, and 2) Do inference for each PM probe and then summarize into one score. Thus, the summarization (here done using median-polish) is considered as a part of the first approach. PLW and median-t use the second approach, whereas LMW and the ordinary t-test are the corresponding methods using the first approach. From the results presented here the second approach appears a better option. This was also shown by Hess and Iyer in [<xref ref-type="bibr" rid="B40">40</xref>] where they propose the median-t and combined-p method.</p>
      <p>Approach 1 could also include a second normalization of probe set summaries. However, neither of the two approaches can be given information about which genes that are regulated without making the comparison biased. Thus, in the analysis of the Golden Spike data set, a second subset-loess normalization of probe set summaries as done in [<xref ref-type="bibr" rid="B38">38</xref>] can not be used when comparing approach 1 and 2. We therefore used a subset-loess normalization of PM probe intensities in a similar way as done in [<xref ref-type="bibr" rid="B40">40</xref>].</p>
      <p>We have also computed results for the Golden Spike data set using subset-loess normalized MAS5 expression indexes as done by Choe et al. in [<xref ref-type="bibr" rid="B38">38</xref>]. They show that, for a large set of different pre-processing methods, a second loess-subset normalization of probe-set summaries has a large effect (Figure 7a). They give no direct answer to whether a subset-based probe normalization to the same extent improves the performance of the corresponding normalization using all probes. Therefore, to present comparable results only, we have separated results from these two types of subset-normalizations using knowledge about which genes are regulated. Thus, for the Golden Spike data set, we mainly compare BGX and PPLR with the analysis based on MAS5 expression indexes, and the results from RMA and GCRMA pre-processed data is mainly compared separately.</p>
      <p>More complicated models often come with the prize of longer computer run times. Of the methods evaluated the BGX model and the PPLR method together with the multi-mgMOS model are the most computer intense ones. The computer run time for one single two group analysis of 3+3 HG-U95A arrays with data from 12626 genes is more than 24 hours with BGX and 1.5 hours for PPLR+multi-mgMOS (using the recommended EM method of PPLR) on a 2.2 GHz AMD Opteron machine. The corresponding time (including pre-processing of PM and MM data) is 2–3 minutes for PLW and 9 seconds for the moderated t-test in LIMMA.</p>
    </sec>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>We have presented two new methods for ranking genes with respect to differential expression: Probe level Locally moderated Weighted median-t (PLW) and Locally Moderated Weighted-t (LMW). Both methods perform very well compared to existing methods with PLW having the most accurate ranking of regulated genes in four out of five examined spike-in data sets with RMA and GCRMA processed data. With LMW we show that introducing an intensity-level dependent scale parameter for the prior distribution of the gene-specific variances improves the performance of the moderated t-test. Also, compared to the moderated t-statistic, LMW shows a much more stable false positive rate across intensity-levels when used on MAS5 expression indexes. In the PLW method inference is performed directly on logged PM intensities and the median of the resulting moderated t-statistics for each probe-set is used to find differentially expressed genes. Overall the PLW method performs better than all compared methods and thus probe-level inference appears to be preferable over the standard approach using gene expression indexes for inference.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>MÅ provided the initial idea, formulated the model, derived and programmed the estimation procedure, erformed the analysis of real and simulated data, and drafted the manuscript. All authors finalized and approved the final version of the manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p>Parameter estimation details. A detailed description of the parameter estimation procedure.</p>
      </caption>
      <media xlink:href="1471-2105-9-156-S1.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p>R-code and package information. The R-code used for each of the methods compared together with information about used R-packages (names and versions).</p>
      </caption>
      <media xlink:href="1471-2105-9-156-S2.txt" mimetype="text" mime-subtype="plain">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3</title>
        <p>ROC curves for all methods. Figures with ROC curves for all methods compared for each of the five data sets.</p>
      </caption>
      <media xlink:href="1471-2105-9-156-S3.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S4">
      <caption>
        <title>Additional file 4</title>
        <p>ROC curve AUC for all methods. Tables with ROC curve AUC up to 25, 50, 100, 200 false positives for all methods compared for each of the five data sets.</p>
      </caption>
      <media xlink:href="1471-2105-9-156-S4.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>The research was supported by the Swedish foundation for Strategic Research through GMMC and the Swedish Research Council through Stochastic Centre.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baldi</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>AD</given-names>
          </name>
        </person-group>
        <article-title>A Bayesian framework for the analysis of microarray expression data: regularized t -test and statistical inferences of gene changes</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <fpage>509</fpage>
        <lpage>519</lpage>
        <pub-id pub-id-type="pmid">11395427</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/17.6.509</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lönnstedt</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>Replicated microarray data</article-title>
        <source>Statistica Sinica</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>31</fpage>
        <lpage>46</lpage>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Linear models and empirical Bayes methods for assessing differential expression in microarray experiments</article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <year>2004</year>
        <volume>3</volume>
        <pub-id pub-id-type="pmid">16646809</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kristiansson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sjögren</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rudemo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nerman</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Weighted Analysis of Paired Microarray Experiments</article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <year>2005</year>
        <volume>4</volume>
        <pub-id pub-id-type="pmid">16646849</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kristiansson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sjögren</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rudemo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nerman</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Quality optimised analysis of general paired microarray experiments</article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <year>2006</year>
        <volume>5</volume>
        <fpage>article 10</fpage>
        <pub-id pub-id-type="pmid">16646864</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sartor</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Tomlinson</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Wesselkamper</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Sivaganesan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Leikauf</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Medvedovic</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Intensity-based hierarchical Bayes method improves testing for differentially expressed genes in microarray experiments</article-title>
        <source>BMC Genomics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>article 538</fpage>
        <pub-id pub-id-type="pmid">17177995</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sjögren</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kristiansson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Rudemo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nerman</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Weighted analysis of general microarray experiments</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>387</fpage>
        <pub-id pub-id-type="pmid">17937807</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-387</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Åstrand</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mostad</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rudemo</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Improved covariance matrix estimators for weighted analysis of microarray data</article-title>
        <source>J Comput Biol</source>
        <year>2007</year>
        <volume>14</volume>
        <fpage>95</fpage>
        <lpage>102</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2007.0078</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Opgen-Rhein</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Strimmer</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Accurate Ranking of Differentially Expressed Genes by a Distribution-Free Shrinkage Approach</article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <year>2007</year>
        <volume>6</volume>
        <fpage>article 9</fpage>
        <pub-id pub-id-type="pmid">17402924</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tusher</surname>
            <given-names>VG</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Significance analysis of microarrays applied to the ionizing radiation response</article-title>
        <source>PNAS</source>
        <year>2001</year>
        <volume>98</volume>
        <fpage>5116</fpage>
        <lpage>5121</lpage>
        <pub-id pub-id-type="pmid">11309499</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.091062498</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Tusher</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Empirical Bayes Analysis of a Microarray Experiment</article-title>
        <source>J Amer Statist Assoc</source>
        <year>2001</year>
        <volume>96</volume>
        <fpage>1151</fpage>
        <lpage>1160</lpage>
        <pub-id pub-id-type="doi">10.1198/016214501753382129</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eaves</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>Wicker</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Ghandour</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lyons</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Peterson</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Todd</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Glynne</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <article-title>Combining Mouse Congenic Strains and Microarray Gene Expression Analyses to Study a Complex Trait: The NOD Model of Type 1 Diabetes</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>232</fpage>
        <lpage>243</lpage>
        <pub-id pub-id-type="pmid">11827943</pub-id>
        <comment>10.1101/gr.214102. Article published online before print in January 2002</comment>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Thatte</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Braciale</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ley</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>O'Connell</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>Local-pooled-error test for identifying differentially expressed genes with a small number of replicated microarrays</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>1945</fpage>
        <lpage>1951</lpage>
        <pub-id pub-id-type="pmid">14555628</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg264</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Comander</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Natarajan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gimbrone</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Garcia-Cardena</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Improving the statistical detection of regulated genes from microarray data using intensity-based variance estimation</article-title>
        <source>BMC Genomics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>17</fpage>
        <pub-id pub-id-type="pmid">15113402</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2164-5-17</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>FA</given-names>
          </name>
        </person-group>
        <article-title>Assessing Differential Gene Expression with Small Sample Sizes in Oligonucleotide Arrays Using a Mean-Variance Model</article-title>
        <source>Biometrics</source>
        <year>2007</year>
        <volume>63</volume>
        <fpage>41</fpage>
        <lpage>49</lpage>
        <pub-id pub-id-type="pmid">17447928</pub-id>
        <pub-id pub-id-type="doi">10.1111/j.1541-0420.2006.00675.x</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Hobbs</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Collin</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Beazer-Barclay</surname>
            <given-names>YD</given-names>
          </name>
          <name>
            <surname>Antonellis</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Scherf</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>Exploration, normalization, and summaries of high density oligonucleotide array probe level data</article-title>
        <source>Biostatistics</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>249</fpage>
        <lpage>264</lpage>
        <pub-id pub-id-type="pmid">12925520</pub-id>
        <pub-id pub-id-type="doi">10.1093/biostatistics/4.2.249</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hein</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Causton</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Ambler</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>BGX: a fully Bayesian integrated approach to the analysis of Affymetrix GeneChip data</article-title>
        <source>Biostatistics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>349</fpage>
        <lpage>373</lpage>
        <pub-id pub-id-type="pmid">15831583</pub-id>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxi016</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Milo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Rattray</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A tractable probabilistic model for Affymetrix probe-level analysis across multiple chips</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>3637</fpage>
        <lpage>3644</lpage>
        <pub-id pub-id-type="pmid">16020470</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti583</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Milo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Rattray</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Probe-level measurement error improves accuracy in detecting differential gene expression</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>2107</fpage>
        <lpage>2113</lpage>
        <pub-id pub-id-type="pmid">16820429</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl361</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Munson</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>A 'consistency' test for determining the significance of gene expression changes on replicate samples and two convenient variance-stabilizing transformations</article-title>
        <source>Gene Logic Workshop of Low Level Analysis of Affymetrix GeneChip Data</source>
        <year>2001</year>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>von Heydebreck</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sultmann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Poustka</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Variance stabilization applied to microarray data calibration and to the quantification of differential expression</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>S96</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="pmid">12169536</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durbin</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Hardin</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Hawkins</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Rocke</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>A variance-stabilizing transformation for gene-expression microarray data</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>S105</fpage>
        <lpage>S110</lpage>
        <pub-id pub-id-type="pmid">12169537</pub-id>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durbin</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Rocke</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>Estimation of transformation parameters for microarray data</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>1360</fpage>
        <lpage>1367</lpage>
        <pub-id pub-id-type="pmid">12874047</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg178</pub-id>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geller</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Gregg</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Hagerman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rocke</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>Transformation and normalization of oligonucleotide microarray data</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>1817</fpage>
        <lpage>1823</lpage>
        <pub-id pub-id-type="pmid">14512353</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg245</pub-id>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Tukey</surname>
            <given-names>JW</given-names>
          </name>
        </person-group>
        <source>Exploratory Data Analysis</source>
        <year>1977</year>
        <publisher-name>Addison-Wesley</publisher-name>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Holder</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Raubertas</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Pikounis</surname>
            <given-names>VB</given-names>
          </name>
          <name>
            <surname>Svetnik</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Soper</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Statistical analysis of high density oligonucleotide arrars: a SAFER approach</article-title>
        <source>Gene Logic Workshop of Low Level Analysis of Affymetrix GeneChip Data</source>
        <year>2001</year>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rocke</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Approximate variance-stabilizing transformations for gene-expression microarray data</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>966</fpage>
        <lpage>972</lpage>
        <pub-id pub-id-type="pmid">12761059</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg107</pub-id>
      </citation>
    </ref>
    <ref id="B28">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>The Elements of Statistical Learning</source>
        <year>2001</year>
        <volume>1</volume>
        <edition>first</edition>
        <publisher-name>Springer</publisher-name>
      </citation>
    </ref>
    <ref id="B29">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dempster</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Maximum Likelihood from Incomplete Data via the EM Algorithm</article-title>
        <source>J Roy Statist Soc Ser B</source>
        <year>1977</year>
        <volume>39</volume>
        <fpage>1</fpage>
        <lpage>38</lpage>
      </citation>
    </ref>
    <ref id="B30">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Åstrand</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>plw: An R implementation of Probe level Locally moderated Weighted median-t (PLW) and Locally Moderated Weighted-t (LMW)</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.math.chalmers.se/~astrandm"/>
      </citation>
    </ref>
    <ref id="B31">
      <citation citation-type="other">
        <article-title>Bioconductor Project</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org"/>
      </citation>
    </ref>
    <ref id="B32">
      <citation citation-type="other">
        <article-title>Gene Expression Omnibus repository</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/geo/"/>
      </citation>
    </ref>
    <ref id="B33">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spira</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Beane</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pinto-Plata</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Kadar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Celli</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Brody</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Gene Expression Profiling of Human Lung Tissue from Smokers with Severe Emphysema</article-title>
        <source>Am J Respir Cell Mol Biol</source>
        <year>2004</year>
        <volume>31</volume>
        <fpage>601</fpage>
        <lpage>610</lpage>
        <pub-id pub-id-type="pmid">15374838</pub-id>
        <pub-id pub-id-type="doi">10.1165/rcmb.2004-0273OC</pub-id>
      </citation>
    </ref>
    <ref id="B34">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stearman</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Dwyer-Nield</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zerbe</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Blaine</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Bunn</surname>
            <given-names>PAJ</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Hirsch</surname>
            <given-names>FR</given-names>
          </name>
          <name>
            <surname>Merrick</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Franklin</surname>
            <given-names>WA</given-names>
          </name>
          <name>
            <surname>Baron</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Keith</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Nemenoff</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Malkinson</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Geraci</surname>
            <given-names>MW</given-names>
          </name>
        </person-group>
        <article-title>Analysis of Orthologous Gene Expression between Human Pulmonary Adenocarcinoma and a Carcinogen-Induced Murine Model</article-title>
        <source>Am J Pathol</source>
        <year>2005</year>
        <volume>167</volume>
        <fpage>1763</fpage>
        <lpage>1775</lpage>
        <pub-id pub-id-type="pmid">16314486</pub-id>
      </citation>
    </ref>
    <ref id="B35">
      <citation citation-type="other">
        <article-title>Affymetrix U95 and 133A Latin Square spike-in data sets</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.Affymetrix.com/support/datasets.affx"/>
      </citation>
    </ref>
    <ref id="B36">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cope</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Jaffee</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>A benchmark for Affymetrix GeneChip expression measures</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>323</fpage>
        <lpage>331</lpage>
        <pub-id pub-id-type="pmid">14960458</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg410</pub-id>
      </citation>
    </ref>
    <ref id="B37">
      <citation citation-type="other">
        <article-title>Gene Logic spike-in data sets</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.genelogic.com/newsroom/studies/"/>
      </citation>
    </ref>
    <ref id="B38">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Choe</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Boutros</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Michelson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Halfon</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Preferred analysis methods for Affymetrix GeneChips revealed by a wholly defined control dataset</article-title>
        <source>Genome Biology</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>R16</fpage>
        <pub-id pub-id-type="pmid">15693945</pub-id>
        <pub-id pub-id-type="doi">10.1186/gb-2005-6-2-r16</pub-id>
      </citation>
    </ref>
    <ref id="B39">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaile</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Miecznikowski</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Putative null distributions corresponding to tests of differential expression in the Golden Spike dataset are intensity dependent</article-title>
        <source>BMC Genomics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>105</fpage>
        <pub-id pub-id-type="pmid">17445265</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2164-8-105</pub-id>
      </citation>
    </ref>
    <ref id="B40">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hess</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Fisher's combined p-value for detecting differentially expressed genes using Affymetrix expression arrays</article-title>
        <source>BMC Genomics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>96</fpage>
        <pub-id pub-id-type="pmid">17419876</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2164-8-96</pub-id>
      </citation>
    </ref>
    <ref id="B41">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lemon</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Liyanarachchi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>You</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A high performance test of differential gene expression for oligonucleotide arrays</article-title>
        <source>Genome Biology</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>R67</fpage>
        <pub-id pub-id-type="pmid">14519202</pub-id>
        <pub-id pub-id-type="doi">10.1186/gb-2003-4-10-r67</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
