<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Plant Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Plant Methods</journal-id>
    <journal-title-group>
      <journal-title>Plant Methods</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1746-4811</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9730636</article-id>
    <article-id pub-id-type="publisher-id">961</article-id>
    <article-id pub-id-type="doi">10.1186/s13007-022-00961-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PhenoTrack3D: an automatic high-throughput phenotyping pipeline to track maize organs over time</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Daviet</surname>
          <given-names>Benoit</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Fernandez</surname>
          <given-names>Romain</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cabrera-Bosquet</surname>
          <given-names>Llorenç</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Pradal</surname>
          <given-names>Christophe</given-names>
        </name>
        <address>
          <email>christophe.pradal@cirad.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Fournier</surname>
          <given-names>Christian</given-names>
        </name>
        <address>
          <email>christian.fournier@inrae.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.121334.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 2097 0141</institution-id><institution>LEPSE, </institution><institution>Univ Montpellier, INRAE, Institut Agro, </institution></institution-wrap>Montpellier, France </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.8183.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 2153 9871</institution-id><institution>CIRAD, </institution><institution>UMR AGAP Institut, </institution></institution-wrap>34398 Montpellier, France </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.121334.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 2097 0141</institution-id><institution>CIRAD, INRAE, </institution><institution>UMR AGAP Institut, Univ Montpellier, Institut Agro, </institution></institution-wrap>34398 Montpellier, France </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.121334.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 2097 0141</institution-id><institution>Inria &amp; LIRMM, CNRS, </institution><institution>Univ Montpellier, </institution></institution-wrap>Montpellier, France </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>18</volume>
    <elocation-id>130</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>11</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">High-throughput phenotyping platforms allow the study of the form and function of a large number of genotypes subjected to different growing conditions (GxE). A number of image acquisition and processing pipelines have been developed to automate this process, for micro-plots in the field and for individual plants in controlled conditions. Capturing shoot development requires extracting from images both the evolution of the 3D plant architecture as a whole, and a temporal tracking of the growth of its organs.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We propose PhenoTrack3D, a new pipeline to extract a 3D + t reconstruction of maize. It allows the study of plant architecture and individual organ development over time during the entire growth cycle. The method tracks the development of each organ from a time-series of plants whose organs have already been segmented in 3D using existing methods, such as Phenomenal [Artzet et al. in BioRxiv 1:805739, 2019] which was chosen in this study. First, a novel stem detection method based on deep-learning is used to locate precisely the point of separation between ligulated and growing leaves. Second, a new and original multiple sequence alignment algorithm has been developed to perform the temporal tracking of ligulated leaves, which have a consistent geometry over time and an unambiguous topological position. Finally, growing leaves are back-tracked with a distance-based approach. This pipeline is validated on a challenging dataset of 60 maize hybrids imaged daily from emergence to maturity in the PhenoArch platform (ca. 250,000 images). Stem tip was precisely detected over time (RMSE &lt; 2.1 cm). 97.7% and 85.3% of ligulated and growing leaves respectively were assigned to the correct rank after tracking, on 30 plants × 43 dates. The pipeline allowed to extract various development and architecture traits at organ level, with good correlation to manual observations overall, on random subsets of 10–355 plants.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">We developed a novel phenotyping method based on sequence alignment and deep-learning. It allows to characterise the development of maize architecture at organ level, automatically and at a high-throughput. It has been validated on hundreds of plants during the entire development cycle, showing its applicability on GxE analyses of large maize datasets.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13007-022-00961-4.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>High-throughput phenotyping</kwd>
      <kwd>Computer vision</kwd>
      <kwd>Maize</kwd>
      <kwd>Tracking</kwd>
      <kwd>Sequence alignment</kwd>
      <kwd>Plant physiology</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>EPPN2020</institution>
        </funding-source>
        <award-id>731013</award-id>
        <principal-award-recipient>
          <name>
            <surname>Daviet</surname>
            <given-names>Benoit</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">Plant architecture relates to the 3D organisation and form of organs on the plant (i.e. number, shape, size and position) as well as their temporal and topological changes during plant development [<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>, <sup><xref ref-type="bibr" rid="CR2">2</xref></sup>]. Plant architecture and development are of major agronomic importance in cereals such as maize (<italic>Zea mays</italic> L.), determining resource capture and use, and thus plant performance [<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, <sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, <sup><xref ref-type="bibr" rid="CR5">5</xref></sup>]. Architectural and developmental traits such as leaf number, leaf angle and leaf size are influenced by both genetic variations and environmental conditions such as light and water availability [<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, <sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, <sup><xref ref-type="bibr" rid="CR8">8</xref></sup>], and display a large genotype x environment (GxE) interaction. Therefore, understanding the genetic control and the response to environmental cues of these traits at individual plant level is a major challenge in the context of climate change [<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, <sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, <sup><xref ref-type="bibr" rid="CR11">11</xref></sup>], and the engineering of agro-ecological practices based on complex plant mixtures.</p>
    <p id="Par5">High-throughput phenotyping (HTP) platforms enable the collection of plant images of a large number of genotypes growing under different environmental conditions on a regular basis [<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, <sup><xref ref-type="bibr" rid="CR13">13</xref></sup>]. Such image datasets can then be processed automatically [<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>] to capture the 3D morphology of plant shoots and extract phenotypic traits [<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>]. Among the existing methods, the Phenomenal pipeline [<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>] proved relevant to process large datasets of multiple species of agronomic interest, providing an end-to-end solution to extract a 3D plant reconstruction from a set of 2D images taken at regular viewpoints around the plant. In the case of maize, this pipeline allows the extraction of architectural traits such as stem height and leaf morphology (e.g. length, insertion height, azimuth). However, it is limited to the reconstruction of plants at each time point separately. When screening for genetic variability, the identification of leaves by a unique time-consistent number (the rank of emergence, or leaf rank) is essential to compare the shoot organs occupying similar developmental position (e.g. juvenile versus adult leaves [<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>]) between different plants, or to quantify the development using leaf stage. Moreover, the assignment of the same rank to successive segmentations of the same leaf over time is necessary to measure individual leaf growth and their responses to environmental conditions. Since the lowest maize leaves disappear over time due to senescence, it may be difficult to deduce the rank of leaves when observing the plant at a single date [<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>].</p>
    <p id="Par6">To overcome this limitation, time-series analysis could be used to group several occurrences of a same leaf in a temporal series of images, in order to get a 3D + t representation of the plant. While this task relates to multiple object tracking [<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>], this framework cannot be directly applied to leaf tracking, since plants undergo major topological and morphological changes over time, with new leaves appearing and growing due to organogenesis, and others collapsing then disappearing during senescence [<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>]. Instead, specific leaf tracking methods have been proposed for 2D images of rosette plants from a top view [<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, <sup><xref ref-type="bibr" rid="CR22">22</xref></sup>, <sup><xref ref-type="bibr" rid="CR23">23</xref></sup>, <sup><xref ref-type="bibr" rid="CR24">24</xref></sup>]. While a few studies have developed leaf tracking methods on 3D reconstructions (e.g. cotton [<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>], cucumber [<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>], tomato [<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>] and maize [<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>, <sup><xref ref-type="bibr" rid="CR27">27</xref></sup>], most of them have only been validated on limited datasets that may not reflect actual HTP conditions (thousands of plants, large genetic diversity and growing scenarios). Moreover, these datasets were often limited to young plants which are less challenging to analyse than in later growth stages (emergence of the reproductive organs, more occlusion due to leaf crossings, more frequent disappearance of leaves due to senescence). While these methods offer various solutions for associating leaves with similar geometry (e.g. length, azimuth), they rarely use topology (i.e. the spatial organisation of leaves on the plant [<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>]). Plant topology offers valuable information for leaf tracking since (i) it defines the identity of leaves, as leaves appear from bottom to top along the stem axis on plants such as maize, and (ii) it is redundant over time, thus helping to maintain leaves identity. Plant topology was used in [<xref ref-type="bibr" rid="CR28">28</xref>], but without considering leaf morphology. We therefore seek a new leaf tracking method exploiting both leaves morphology and topology, with the objective of handling complex HTP datasets, covering all stages of maize development.</p>
    <p id="Par7">Using first the topological order of leaf ranks along the maize stem, a reconstructed maize plant can be represented at any date by a spatial sequence of leaves, ordered from the bottom to the top of the stem. This sequence is obtained through a segmentation step and may therefore contain artefacts resulting from segmentation errors. For instance, the maize ear can be misidentified as a leaf, or some leaves can be unidentified due to occlusions, leading to extra or missing leaves in the sequence. Some leaves may also emerge or fall from the plant between two successive sequences. From this point of view, comparing two successive leaf sequences is analogous to comparing two homologous genetic sequences, which are similar except for a few extra or missing elements. Sequence alignment algorithms are commonly used to insert gaps in such genetic sequences in order to match their common elements [<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>]. This framework was redesigned here to match leaves with a similar morphology in successive topological sequences of maize leaves.</p>
    <p id="Par8">In this paper, we propose a novel robust method to address the current issues of maize HTP. First, organs are segmented on 3D reconstructed volumes at all time steps using a former described method [<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>], publicly available on GitHub (Phenomenal: <ext-link ext-link-type="uri" xlink:href="https://github.com/openalea/phenomenal">https://github.com/openalea/phenomenal</ext-link>) and Zenodo (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.1436633">https://doi.org/10.5281/zenodo.1436633</ext-link>). This method is complemented by a new stem detection algorithm based on deep-learning to locate more precisely the stem tip, which separates the mature part of the maize plant from the developing one. After that, leaves of the basal mature parts are aligned using a sequence alignment algorithm, and then tracked backwards to the upper developing parts of the plant. We apply this method on a challenging image dataset acquired at the PhenoArch platform consisting of a diverse panel of maize genotypes developing from plant emergence to late flowering stage, under various levels of water stress. The accuracy of tracking is globally assessed by comparing leaf rank predictions and key dynamical traits to manual annotations. Such organ-level phenotypic traits allow to fully describe the global plant development and architecture, as well as individual leaf growth dynamics.</p>
  </sec>
  <sec id="Sec2">
    <title>Materials and methods</title>
    <sec id="Sec3">
      <title>Plant material and dataset composition</title>
      <p id="Par9">The pipeline was tested on a dataset from an experiment conducted in 2017 involving a set of 60 commercial maize hybrids representative of breeding history in Europe during the last 60 years. This material covers a wide range of plant architecture, growth and development, leading to an appreciable variability of performances in the field [<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>]. The experiment was conducted in the PhenoArch phenotyping platform (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A) hosted at the M3P (Montpellier Plant Phenotyping Platforms) [<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>].<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of the 3D maize reconstruction and segmentation pipeline used prior tracking. <bold>A</bold> Maize plants grown in the PhenoArch high-throughput phenotyping platform. <bold>B</bold> Daily acquisition of 12 side-view RGB images. <bold>C</bold> Reconstruction of a 3D volume, using space-carving [<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>]. <bold>D</bold> 3D skeletonization of the reconstruction [<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>], and extension of the leaf tips. <bold>E</bold> Detection of the stem tip position (red box) using a deep-learning model. This position is used to segment the skeleton into stem (black), ligulated leaves (blue) and growing leaves (orange) organs. Ligulated leaves can be ordered topologically (numbers) by increasing insertion height, unlike growing leaves which all emerge from the same point</p></caption><graphic xlink:href="13007_2022_961_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par10">Briefly, plants were sown in 9L pots filled with a 30:70 (v/v) mixture of a clay and organic compost. Two levels of soil water content were imposed: (i) retention capacity (WW, soil water potential of −0.05 MPa) and (ii) water deficit (WD, soil water potential of −0.3 MPa). Each combination of genotype and water treatment was replicated 7 times, 4 with early harvesting (until 12 visible leaves stage, ~ 40 days after plant emergence) and 3 with late harvesting (until ~ 55 days after plant emergence, i.e. ~ 15 days after panicle emergence), resulting in a total of 840 plants. Greenhouse temperature was maintained at 25 ± 3 °C during the day and 20 °C during the night. Details of experimental growing conditions can be found at [<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>].</p>
      <p id="Par11">RGB images (2048 × 2448 pixels) were taken daily for each plant with twelve side views from 30° rotational difference (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B), using the imaging units of the PhenoArch platform. Each unit is composed of a cabin involving an RGB camera (Grasshopper3, Point Grey Research, Richmond, BC, Canada) equipped with 12.5–75 mm TV zoom lens (Pentax, Ricoh Imaging, France) and LED illumination (5050–6500 K colour temperature). Images were captured while the plant was rotating at constant rate (20 rpm) using a brushless motor (Rexroth, Germany).</p>
    </sec>
    <sec id="Sec4">
      <title>3D reconstruction and organ segmentation</title>
      <p id="Par12">Phenotrack3D requires as input a time-series of 3D reconstructed plants with stem and leaves individually segmented. Several existing methods allow to segment maize or sorghum plants [<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>, <sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, <sup><xref ref-type="bibr" rid="CR36">36</xref></sup>]. In our study, we apply Phenomenal [<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>] on single time-point data to reconstruct 3D volumes of the plants (Fig. <xref rid="Fig1" ref-type="fig">1</xref>C), extract 3D skeletons (Fig. <xref rid="Fig1" ref-type="fig">1</xref>D) and 3D segmentations of plant volumes into individual plant organs (stem, leaves) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>E). Briefly, Phenomenal estimates a 3D plant volume by applying a space carving algorithm [<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>] on a regular grid of voxels, so that the projection of the plant volume matches all plant silhouettes of the multi-view image stack. It then searches iteratively among voxels the longest shortest paths connecting plant base to the most distant voxel, removing at each iteration all voxels intercepted by a sweeping perpendicular plane along the path. The result is a set of paths, the 3D skeleton, with each path being associated to a set of voxels representing individual leaves. The only exception is for the first path found, that contains both the stem and a leaf. This path is therefore further segmented, by finding stem tip, computed as the highest minimum of the voxel interception curve (i.e. the number of voxels intercepted by the sweeping plane as a function of curvilinear abscissa).</p>
      <p id="Par13">Two post-processing steps have been designed to improve the quality of the segmentation. First, we extrapolate midribs up to the leaf tips to reconstruct part of the leaves that have been shortened during the 3D reconstruction. Second, due to severe imprecision of the location of stem tip detection at late developmental stages, Phenomenal was complemented with a new stem tip detection method based on deep-learning.</p>
      <p id="Par14">We post-processed the 3D skeleton output by projecting it on the corresponding 2D binary images, to extend the leaf tips which are often shortened during the reconstruction. To that end, 2D binary images extracted with Phenomenal were also skeletonized, and the segments of both skeletons were matched to find an extension path for each segment of the original 3D skeleton. This step is illustrated in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, and was repeated for each of the 12 camera angles. For a given 2D binary image, each 3D skeleton branch is projected then associated with the closest branch of the 2D skeleton of the binary image to identify the best extension path to the leaf tip (Fig. <xref rid="Fig2" ref-type="fig">2</xref>D; green lines). The corrected length of the 3D skeleton branch is finally computed as the median of all extension paths found for this branch over the 12 camera angles.<fig id="Fig2"><label>Fig. 2</label><caption><p>Extension of leaf tips on the 3D skeleton. <bold>A</bold> Binarization of the RGB image (inset) with Phenomenal [<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>], <bold>B</bold> Skeletonization of the binary image, and extraction of skeleton branches having an endpoint (blue lines), <bold>C</bold> 3D plant skeleton (inset) and reprojection of its branches in the 2D space (red lines). <bold>D</bold> 3D and 2D branches matching based on a distance threshold <italic>d</italic><sub><italic>sk</italic></sub> = 30px, and determination of extension paths (green lines)</p></caption><graphic xlink:href="13007_2022_961_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par15">To precisely locate the stem tip, which is of particular importance for Phenotrack3D, we trained an object detection model to detect collars on the 2D images, like in [<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>]. To that end, we used a YOLOv4 deep-learning model [<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>] (see Additional file <xref rid="MOESM1" ref-type="media">1</xref> for training details). The detected collars were used to define the stem height as the highest collar height among the 12 side-view images. The leaves with an insertion point below the stem tip were defined as ligulated leaves (Fig. <xref rid="Fig3" ref-type="fig">3</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><p>Deep-learning-based collar detection for organ segmentation. <bold>A</bold> Identification of the stem path (orange line) on the 3D skeleton, <bold>B</bold> reprojection of the stem path (orange line) on one of the corresponding RGB images and extraction of 416 × 416 sub-images along the stem path. Sub-images centers are evenly spaced along the stem path, with a maximum spacing of 400 pixels. <bold>C</bold> Collar detection on a sub-image (square: predicted bounding box, point: centre of the box, value: prediction score) <bold>D</bold> Projection of the highest detected collars point among all sub-images from all 12 side viewpoints on the 3D skeleton (grey cross). This point is then used to segment skeleton branches in stem, ligulated leaves, and growing leaves</p></caption><graphic xlink:href="13007_2022_961_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par16">From this point, the plant is represented by a time-series of 3D observations, from which stem height can be extracted at each date and smoothed over time. Finally, time points with abnormal stem shapes were removed. These points were detected by first constructing a median stem, obtained as the polyline joining the (x, y) median position of all stem polyline points in the time-series, grouped by discrete z coordinates. Then, all time points with a stem polyline whose directed Hausdorff distance from the median was greater than 10 cm were removed from the time-series. (Additional file <xref rid="MOESM3" ref-type="media">3</xref>).</p>
    </sec>
    <sec id="Sec5">
      <title>Time-lapse tracking of 3D organs</title>
      <p id="Par17">We track the ligulated leaves using a multiple sequence alignment algorithm. First, at each time point <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M2"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq1.gif"/></alternatives></inline-formula> we build a leaf sequence <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{t}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mi>P</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq2.gif"/></alternatives></inline-formula> composed of feature vectors representing key characteristics of the segmented ligulated leaves. From this representation, we define a cost function for comparing leaves pairwise, and derive a sequence alignment algorithm to establish the correspondences between two successive leaves sequences. We then propagate this procedure to determine ligulated leaf tracks along the whole time-course. Each organ track is then identified by a leaf rank, which corresponds both to its order of emergence and its location along the stem. Finally, we track backwards these leaves from the moment of their ligulation to the moment of their emergence at the top of the stem and get the whole 3D + t reconstruction.</p>
      <sec id="Sec6">
        <title>Pairwise sequence alignment</title>
        <p id="Par18">The detected ligulated leaves of a date <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M6"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq3.gif"/></alternatives></inline-formula> are ordered from the bottom to the top of the plant, i.e. by ascending leaf rank, in a leaf sequence <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{t}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq4.gif"/></alternatives></inline-formula>. The alignment of two sequences can be defined as a set of gap placements at the beginning, end, or between elements of these sequences, resulting in two new sequences of the same length with no gaps facing each other [<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>]. Pairwise sequence alignment algorithms are designed to identify the alignment that optimises an alignment score between two sequences, often defined as the sum of the scores associated with each pair of matched elements, plus gap penalties [<xref ref-type="bibr" rid="CR40">40</xref>].</p>
        <p id="Par19">Each ligulated leaf is described using a feature vector computed from geometrical features that are assumed to be constant over time: insertion height <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h$$\end{document}</tex-math><mml:math id="M10"><mml:mi>h</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq5.gif"/></alternatives></inline-formula>
<italic>(</italic>mm<italic>),</italic> length <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l$$\end{document}</tex-math><mml:math id="M12"><mml:mi>l</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq6.gif"/></alternatives></inline-formula>
<italic>(</italic>mm<italic>) a</italic>nd azimuth <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M14"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq7.gif"/></alternatives></inline-formula> (<inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M16"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq8.gif"/></alternatives></inline-formula> ∈ [−π, π]). These features are extracted from the segmented leaves [<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>] and concatenated into a feature vector <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v\in {R}^{4}$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq9.gif"/></alternatives></inline-formula> summarizing the leaf morphology:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v\, = \,\left[ {v^{i} } \right]_{1 \le i \le 4} \, = \,\left[ {\cos \,(\alpha ),\,\sin \,(\alpha ),\,w_{h} \cdot h,\,w_{l} \cdot l} \right]$$\end{document}</tex-math><mml:math id="M20" display="block"><mml:mrow><mml:mi>v</mml:mi><mml:mspace width="0.166667em"/><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mfenced close="]" open="["><mml:msup><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mfenced><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/><mml:mfenced close="]" open="["><mml:mrow><mml:mo>cos</mml:mo><mml:mspace width="0.166667em"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mo>sin</mml:mo><mml:mspace width="0.166667em"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>w</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>w</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13007_2022_961_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par20">Weights <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_{h}=0.03$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.03</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq10.gif"/></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_{l}=0.004$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.004</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq11.gif"/></alternatives></inline-formula> were fine-tuned to scale features and adjust their relative importance. Each pair of matched leaves is associated to a cost <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{vv}$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">vv</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq12.gif"/></alternatives></inline-formula> equal to the euclidean distance between the feature vectors <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{1}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq13.gif"/></alternatives></inline-formula> and <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{2}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq14.gif"/></alternatives></inline-formula> of those two leaves:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{vv} \left( {v_{1} ,v_{2} } \right) = \sqrt {\mathop \sum \limits_{1 \le i \le 4} \left( {v_{1}^{i} - v_{2}^{i} } \right)^{2} }$$\end{document}</tex-math><mml:math id="M32" display="block"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">vv</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:munder><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math><graphic xlink:href="13007_2022_961_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par21">A gap penalty parameter <inline-formula id="IEq15"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g$$\end{document}</tex-math><mml:math id="M34"><mml:mi>g</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq15.gif"/></alternatives></inline-formula> is used to penalise the addition of each of the <inline-formula id="IEq16"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M36"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq16.gif"/></alternatives></inline-formula> gaps placed in the alignment of sequences <inline-formula id="IEq17"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{t1}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq17.gif"/></alternatives></inline-formula> and <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{t2}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq18.gif"/></alternatives></inline-formula>. We define <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g$$\end{document}</tex-math><mml:math id="M42"><mml:mi>g</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq19.gif"/></alternatives></inline-formula> from <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{{c }_{adj}}=4.23$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mover><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">adj</mml:mi></mml:mrow></mml:msub><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>4.23</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq20.gif"/></alternatives></inline-formula>, the average value of <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{vv}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">vv</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq21.gif"/></alternatives></inline-formula><italic>(</italic><inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{i}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq22.gif"/></alternatives></inline-formula>, <inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{j}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq23.gif"/></alternatives></inline-formula><italic>)</italic> for all couples of topologically adjacent leaves <inline-formula id="IEq24"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M52"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq24.gif"/></alternatives></inline-formula> and <inline-formula id="IEq25"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M54"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq25.gif"/></alternatives></inline-formula> in the sequences <inline-formula id="IEq26"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{t}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq26.gif"/></alternatives></inline-formula> of our dataset, and <inline-formula id="IEq27"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_{gap}=3$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">gap</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq27.gif"/></alternatives></inline-formula> a weight:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g = w_{gap} .{ }\overline{{c_{adj} }}$$\end{document}</tex-math><mml:math id="M60" display="block"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">gap</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mrow/><mml:mover><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">adj</mml:mi></mml:mrow></mml:msub><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math><graphic xlink:href="13007_2022_961_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par22">Using a different parameter value for the terminal gaps has proven effective in aligning sequences of different lengths [<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>]. A weight <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_{tml}=0.2$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">tml</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq28.gif"/></alternatives></inline-formula> is therefore used to lower the penalty of each of the <inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{tml}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">tml</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq29.gif"/></alternatives></inline-formula> terminal gaps, since leaves are expected to appear and disappear successively over time. The optimal alignment between <inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{t1}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq30.gif"/></alternatives></inline-formula> and <inline-formula id="IEq31"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{t2}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq31.gif"/></alternatives></inline-formula> is then defined as the one that minimises the global alignment cost <inline-formula id="IEq32"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C$$\end{document}</tex-math><mml:math id="M70"><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq32.gif"/></alternatives></inline-formula>. We define <inline-formula id="IEq33"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I$$\end{document}</tex-math><mml:math id="M72"><mml:mi>I</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq33.gif"/></alternatives></inline-formula> as the set of indexes of sequences <inline-formula id="IEq34"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{t1}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq34.gif"/></alternatives></inline-formula> and <inline-formula id="IEq35"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{t2}$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq35.gif"/></alternatives></inline-formula> with a match (i.e. without gap). With <italic>v</italic><sub><italic>i</italic></sub> and <italic>vʹ</italic><sub><italic>I</italic></sub> the vectors associated respectively with the <inline-formula id="IEq36"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M78"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq36.gif"/></alternatives></inline-formula>-th elements of the sequences <inline-formula id="IEq37"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{t1}$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq37.gif"/></alternatives></inline-formula> and <inline-formula id="IEq38"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${P}_{t2}$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq38.gif"/></alternatives></inline-formula>:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C\left( {S_{t1} ,S_{t2} } \right) = (n - n_{tml}) .g + n_{tml} .w_{tml} .g + \mathop \sum \limits_{i \in I} c_{vv} \left( {v_{i} ,v^{\prime}_{i} } \right)$$\end{document}</tex-math><mml:math id="M84" display="block"><mml:mrow><mml:mi>C</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">tml</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mi>g</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">tml</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="italic">tml</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:mi>g</mml:mi><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">vv</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13007_2022_961_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par23">To find the optimal alignment between <inline-formula id="IEq39"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{t1}$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq39.gif"/></alternatives></inline-formula> and <inline-formula id="IEq40"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{t2}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq40.gif"/></alternatives></inline-formula>, the Needleman-Wunsch (NW) algorithm [<xref ref-type="bibr" rid="CR42">42</xref>] has been adapted to consider the terminal gap weight. This algorithm is based on dynamic programming and guarantees an optimal solution for pairwise alignment.</p>
      </sec>
      <sec id="Sec7">
        <title>Multiple sequence alignment</title>
        <p id="Par24">The initial ordering of each sequence gives a relative leaf rank to each leaf that may differ from their absolute rank, due to the fall of senescent leaves during plant development or due to segmentation errors (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B). The alignment of all the leaves sequences in the time-series is achieved using a progressive method [<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>] to perform the multiple alignment task. It consists in a succession of pairwise alignments of the sequences <inline-formula id="IEq41"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{t}$$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq41.gif"/></alternatives></inline-formula> using the NW algorithm, in ascending temporal order. A profile is defined as an alignment of several sequences treated as a unique sequence of columns [<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>]. Let <inline-formula id="IEq42"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Omega }_{1 -&gt; k}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq42.gif"/></alternatives></inline-formula> be the profile constituted of the alignment of the first <inline-formula id="IEq43"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M94"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq43.gif"/></alternatives></inline-formula> sequences in the time-series <inline-formula id="IEq44"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(S{)}_{k=1...T}$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq44.gif"/></alternatives></inline-formula>, each sequence containing <inline-formula id="IEq45"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M98"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq45.gif"/></alternatives></inline-formula> elements after the addition of possible gaps. At each time point <inline-formula id="IEq46"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t&gt;1$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi>t</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq46.gif"/></alternatives></inline-formula>, the sequence <inline-formula id="IEq47"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{t}$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq47.gif"/></alternatives></inline-formula> is aligned with the profile <inline-formula id="IEq48"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Omega }_{1 -&gt; t-1}$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq48.gif"/></alternatives></inline-formula>, resulting in a new profile <inline-formula id="IEq49"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Omega }_{1 -&gt; t}$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq49.gif"/></alternatives></inline-formula>. Aligning <inline-formula id="IEq50"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{t}$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq50.gif"/></alternatives></inline-formula> with <inline-formula id="IEq51"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Omega }_{1 -&gt; t-1}$$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq51.gif"/></alternatives></inline-formula> requires a sequence-profile cost function <inline-formula id="IEq52"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M112"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq52.gif"/></alternatives></inline-formula> that we adapt from <inline-formula id="IEq53"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{vv}$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">vv</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq53.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR44">44</xref>]. Let <inline-formula id="IEq54"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega$$\end{document}</tex-math><mml:math id="M116"><mml:mi>ω</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq54.gif"/></alternatives></inline-formula> be a column of <inline-formula id="IEq55"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Omega }_{1 -&gt; t-1}$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq55.gif"/></alternatives></inline-formula> of length <inline-formula id="IEq56"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t-1$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq56.gif"/></alternatives></inline-formula> containing <inline-formula id="IEq57"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t-1-k$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq57.gif"/></alternatives></inline-formula> gaps, and <inline-formula id="IEq58"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M124"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq58.gif"/></alternatives></inline-formula> leaves associated to the feature vectors {<inline-formula id="IEq59"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{1}, \dots ,{v}_{k}\}$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq59.gif"/></alternatives></inline-formula>. Let <italic>vʹ</italic> be the feature vector associated with a leaf observation present in the sequence to align <inline-formula id="IEq60"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{t}$$\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq60.gif"/></alternatives></inline-formula>. Then the cost <inline-formula id="IEq61"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M130"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq61.gif"/></alternatives></inline-formula> of the match between <inline-formula id="IEq62"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega$$\end{document}</tex-math><mml:math id="M132"><mml:mi>ω</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq62.gif"/></alternatives></inline-formula> and <italic>vʹ</italic> is defined as:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c\left( {{\upomega },v^{\prime}} \right) = \frac{1}{k}.\mathop \sum \limits_{1 \le i \le k} c_{vv} \left( {v_{i} ,v^{\prime}} \right)$$\end{document}</tex-math><mml:math id="M134" display="block"><mml:mrow><mml:mi>c</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="normal">ω</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mfrac><mml:mo>.</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">vv</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13007_2022_961_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula><fig id="Fig4"><label>Fig. 4</label><caption><p>Leaf tracking in a time-series of 3D maize plant segmentations. <bold>A</bold> Input data for the tracking algorithm, consisting of a time-series of 3D maize plant segmentations. Each segmentation includes ligulated leaves, which can be topologically ordered by increasing insertion height, and growing leaves. Ligulated and growing leaves are classified using stem height (red dotted line), which was smoothed over time. <bold>F</bold> Output data of the tracking algorithm, consisting of 3D + t reconstruction of the plant with time-coherent leaf ranks (numbers and colours), representing the order of appearance of the leaves. <bold>B, C, D, E</bold> illustrate the successive steps of the algorithm, which consists in assigning time-consistent ranks to segmented leaves. Each segmented leaf is represented by a rectangle, coloured according to its ground-truth rank (black = segmentation anomaly), and positioned according to its observation time and predicted rank. Only one third of the time steps are represented for visibility. <bold>B</bold> initialization of rank assignment by ordering the ligulated leaves topologically, <bold>C</bold> rank assignment after sequence alignment, <bold>D</bold> rank assignment after removing abnormal columns, <bold>E</bold> final rank assignment after adding growing leaves</p></caption><graphic xlink:href="13007_2022_961_Fig4_HTML" id="MO4"/></fig></p>
        <p id="Par25">Sequences are aligned progressively until obtaining the final profile <inline-formula id="IEq63"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Omega }_{1 -&gt; T}$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq63.gif"/></alternatives></inline-formula> that aligns all the sequences in <inline-formula id="IEq64"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(S{)}_{t=1..T}$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq64.gif"/></alternatives></inline-formula>, yielding a first estimation of the leaf ranks (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C).</p>
        <p id="Par26">Finally, each tracked leaf, except the first and last, is deleted if <inline-formula id="IEq65"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{k}&lt;({n}_{k-1}+{n}_{k+1})/4$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq65.gif"/></alternatives></inline-formula>, <inline-formula id="IEq66"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{k}$$\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq66.gif"/></alternatives></inline-formula> being the number of times that the <inline-formula id="IEq67"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${k}^{th}$$\end{document}</tex-math><mml:math id="M144"><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq67.gif"/></alternatives></inline-formula> leaf appears in the time-series, to cope with possible segmentation errors (Fig. <xref rid="Fig4" ref-type="fig">4</xref>D).</p>
      </sec>
      <sec id="Sec8">
        <title>Backwards tracking of growing leaves from ligulated ones</title>
        <p id="Par27">The final tracking step consists of predicting the rank of the detected growing leaves (Fig. <xref rid="Fig4" ref-type="fig">4</xref>E). Unlike ligulated leaves, growing leaves cannot be ordered a priori by their topology since they all emerge from the same point, and their geometry is not constant. However, it can be assumed that the shape, orientation and position of a leaf evolves smoothly over time during its growth phase, with only minor changes for an observation frequency of 24 h. Leaves can therefore be tracked backwards by associating leaf observations sharing a similar shape, from the ligulated stage to the leaf emergence. To that end, a metric <inline-formula id="IEq68"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M146"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq68.gif"/></alternatives></inline-formula> is used to quantify the dissimilarity of two growing leaves, based on the distance between their central line, given as a 3D polyline. Each 3D polyline is converted to a set of <inline-formula id="IEq69"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=20$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq69.gif"/></alternatives></inline-formula> points [<inline-formula id="IEq70"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${pl}_{1},\dots ,{pl}_{n}]$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">pl</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">pl</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq70.gif"/></alternatives></inline-formula> regularly spaced along the polyline. With <inline-formula id="IEq71"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d({p}_{1},{p}_{2})$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq71.gif"/></alternatives></inline-formula> the euclidean distance between two points, we define the distance between two polylines such as:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D\left( {pl, pl^{\prime}} \right) = \mathop \sum \limits_{1 \le i \le n} d\left( {pl_{i} , pl^{\prime}_{i} } \right)$$\end{document}</tex-math><mml:math id="M154" display="block"><mml:mrow><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:msup><mml:mi>l</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>p</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:msubsup><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13007_2022_961_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par28">The algorithm tracks backwards the growth trajectory of each leaf, starting from rank 1, and finishing by the last rank. For each processed leaf, the algorithm works iteratively, from the starting point (i.e. when the leaf is ligulated) to the ending point (i.e. at leaf emergence). At each tracking step the algorithm computes the metric <inline-formula id="IEq72"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M156"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq72.gif"/></alternatives></inline-formula> between the last associated polyline and every remaining non-ligulated leaves, and selects the minimum.</p>
      </sec>
      <sec id="Sec9">
        <title>Computation of phenotypic traits</title>
        <p id="Par29">Various phenotypic traits are extracted from the 3D + t plant reconstruction, to quantify (i) rank-based phenotypes, (ii) plant development, (iii) individual leaf development.</p>
        <p id="Par30"><bold>Rank-based phenotype</bold><inline-formula id="IEq73"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{pf}$$\end{document}</tex-math><mml:math id="M158"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">pf</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq73.gif"/></alternatives></inline-formula> describes the variation of a morphological variable <inline-formula id="IEq74"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x$$\end{document}</tex-math><mml:math id="M160"><mml:mi>x</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq74.gif"/></alternatives></inline-formula> of leaves (e.g. length, insertion height, azimuth, etc.) as a function of their position on the stem (rank). For each rank <inline-formula id="IEq75"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M162"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq75.gif"/></alternatives></inline-formula>, <inline-formula id="IEq76"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{pf}(r)$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">pf</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq76.gif"/></alternatives></inline-formula> represents the value of <inline-formula id="IEq77"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x$$\end{document}</tex-math><mml:math id="M166"><mml:mi>x</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq77.gif"/></alternatives></inline-formula> for the leaf <inline-formula id="IEq78"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M168"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq78.gif"/></alternatives></inline-formula> once it has reached ligulation. <inline-formula id="IEq79"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{pf}(r)$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">pf</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq79.gif"/></alternatives></inline-formula> is calculated as the median of the values of <inline-formula id="IEq80"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x$$\end{document}</tex-math><mml:math id="M172"><mml:mi>x</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq80.gif"/></alternatives></inline-formula> associated with the ligulated leaves along the time course. Leaf observations exceeding 20 day<sub>20 °C</sub> after ligulation are not considered. Here we consider the case of leaf length <inline-formula id="IEq81"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({l}_{pf}$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi mathvariant="italic">pf</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq81.gif"/></alternatives></inline-formula>) and leaf insertion height <inline-formula id="IEq82"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({h}_{pf}$$\end{document}</tex-math><mml:math id="M176"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi mathvariant="italic">pf</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq82.gif"/></alternatives></inline-formula>).</p>
        <p id="Par31"><bold>Plant development</bold> is quantified at any date through the following traits:</p>
        <p id="Par32">-Stem height <inline-formula id="IEq83"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${h}_{s}$$\end{document}</tex-math><mml:math id="M178"><mml:msub><mml:mi>h</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq83.gif"/></alternatives></inline-formula> corresponds to the height of the highest collar and is directly extracted from the plant reconstruction.</p>
        <p id="Par33">-Visible leaf stage <inline-formula id="IEq84"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{vis}$$\end{document}</tex-math><mml:math id="M180"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">vis</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq84.gif"/></alternatives></inline-formula> corresponds to the rank of the latest emerging leaf. Let <inline-formula id="IEq85"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{vis}(t)$$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">vis</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq85.gif"/></alternatives></inline-formula> be the maximum rank among observed leaves at date <inline-formula id="IEq86"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M184"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq86.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq87"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}_{med}(r)$$\end{document}</tex-math><mml:math id="M186"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">med</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq87.gif"/></alternatives></inline-formula> the median of time points <inline-formula id="IEq88"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M188"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq88.gif"/></alternatives></inline-formula> where <inline-formula id="IEq89"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{vis}(t) = r$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">vis</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq89.gif"/></alternatives></inline-formula>. We define the emergence timing <inline-formula id="IEq90"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}_{vis}$$\end{document}</tex-math><mml:math id="M192"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">vis</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq90.gif"/></alternatives></inline-formula> of the <inline-formula id="IEq91"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M194"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq91.gif"/></alternatives></inline-formula>-th leaf such as:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{vis} \left( r \right) = \frac{{t_{med} \left( {r - 1} \right) + t_{med} \left( r \right)}}{2} \left( {r \in N + } \right)$$\end{document}</tex-math><mml:math id="M196" display="block"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">vis</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">med</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">med</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13007_2022_961_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par34">We deduce <inline-formula id="IEq92"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{vis}$$\end{document}</tex-math><mml:math id="M198"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">vis</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq92.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq93"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{vis}\left(t\right)={t}_{vis}^{ -1}(t)$$\end{document}</tex-math><mml:math id="M200"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">vis</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">vis</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq93.gif"/></alternatives></inline-formula> for each emergence timing <inline-formula id="IEq94"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M202"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq94.gif"/></alternatives></inline-formula>. Finally, <inline-formula id="IEq95"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{vis}$$\end{document}</tex-math><mml:math id="M204"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">vis</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq95.gif"/></alternatives></inline-formula> is extended to any value of <inline-formula id="IEq96"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M206"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq96.gif"/></alternatives></inline-formula> by linear interpolation.</p>
        <p id="Par35">-Ligulated leaf stage <inline-formula id="IEq97"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{lig}$$\end{document}</tex-math><mml:math id="M208"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lig</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq97.gif"/></alternatives></inline-formula> corresponds to the rank of the last ligulated leaf. Using the same method as for <inline-formula id="IEq98"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{vis}$$\end{document}</tex-math><mml:math id="M210"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">vis</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq98.gif"/></alternatives></inline-formula>, it is deduced from ligulation timing <inline-formula id="IEq99"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}_{lig}$$\end{document}</tex-math><mml:math id="M212"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">lig</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq99.gif"/></alternatives></inline-formula> such as:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{ lig} \left( r \right) = h_{s}^{ - 1} \left( {h_{pf} \left( {r - 1} \right)} \right) \left( {r \in N + } \right)$$\end{document}</tex-math><mml:math id="M214" display="block"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">lig</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi mathvariant="italic">pf</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13007_2022_961_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par36">Here, a piecewise constant interpolation is used to restrict <inline-formula id="IEq100"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{lig}$$\end{document}</tex-math><mml:math id="M216"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">lig</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq100.gif"/></alternatives></inline-formula> to integer values.</p>
        <p id="Par37"><bold>Leaf growth</bold> is given by the successive length value of the observed <inline-formula id="IEq101"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M218"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="13007_2022_961_Article_IEq101.gif"/></alternatives></inline-formula>-th leaf until ligulation.</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Validation with manual measurements</title>
      <p id="Par38">Ground-truth data was manually collected on a randomly selected subset of plants with late harvesting. This validation data was then used to evaluate tracking performance, and the accuracy of the phenotypic traits obtained with the pipeline.</p>
      <p id="Par39">Leaf ranks were annotated on 30 plants at each time point using the images (10980 annotations). Segmented leaves corresponding to artefacts (e.g. the ear of maize) were not annotated.</p>
      <p id="Par40">A subset of 10 plants were randomly selected for manual measurements on images. Leaf lengths and leaf insertion heights were measured at the ligulation stage for all ranks (113 and 173 annotations respectively). Additional leaf lengths measurements were also performed for leaf ranks 6 and 9 during their whole growth phase (234 annotations). Stem height was annotated for all time points (369 annotations).</p>
      <p id="Par41">Ligulated and visible leaf stages were measured in the greenhouse on the 355 plants with late harvesting, with an average of 7 time points per plant (2289 and 1891 annotations respectively). Ligulated leaf stage is given by an integer, while visible leaf stage is given by a real number: for example, a value of 7.4 means that the last visible leaf is of rank 7, and has reached 40% of its growth.</p>
      <p id="Par42">The phenotypic traits were compared with ground-truth observation using the following metrics: bias, root-mean-square error (RMSE), mean absolute percentage error (MAPE) and coefficient of determination (R<sup>2</sup>).</p>
      <p id="Par43">The pipeline conception and the data analysis were performed with Python.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Results</title>
    <sec id="Sec12">
      <title>A robust and consistent alignment of segmented plants over time</title>
      <p id="Par44">The full pipeline was run on the whole late harvesting dataset, (355 plants). Each plant was observed on an average of 43 time points with an average frequency of 24 h, from plant emergence until 3 days after panicle deployment, making a total of 237,600 images analysed. Leaf tracking output is illustrated in video in Additional file <xref rid="MOESM2" ref-type="media">2</xref>. 1.7% of time points were automatically discarded due to abnormally shaped stems (Additional file <xref rid="MOESM3" ref-type="media">3</xref>). The global quality of the pipeline was assessed by leaf rank assignment accuracy, which is defined as the percentage of exact matches between the predicted rank of segmented leaves and manually annotated ground-truth ranks (observation). This metric was evaluated separately depending on whether leaves were identified as ligulated or growing, since their tracking relies on different algorithms (Table <xref rid="Tab1" ref-type="table">1</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Evaluation of the performance of the maize leaf tracking algorithm</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Type of segmented leaf</th><th align="left">Leaf rank assignment accuracy (%)</th><th align="left">MAE among wrong predictions</th><th align="left">n</th></tr></thead><tbody><tr><td align="left">Ligulated leaf</td><td char="." align="char">97.7</td><td char="." align="char">1.07</td><td char="." align="char">6540</td></tr><tr><td align="left">Growing leaf</td><td char="." align="char">85.3</td><td char="." align="char">1.80</td><td char="." align="char">4440</td></tr></tbody></table></table-wrap></p>
      <p id="Par45">Leaf rank assignment accuracy is evaluated on 30 different plants on a total of 10,980 leaves. Leaf rank assignment accuracy is the percentage of non-artefact segmented leaves whose predicted rank matches ground-truth rank. MAE is the mean absolute error, and this metric was only computed among wrong predictions. n is the number of leaves considered. These metrics are presented separately for ligulated and growing leaves.</p>
      <p id="Par46">For ligulated leaves, rank assignment accuracy showed a median value of 98.8% per plant, with a minimum of 90.8%, resulting in a high overall accuracy (97.7%, Table <xref rid="Tab1" ref-type="table">1</xref>). Most of the errors occurred for the lower and upper ranks (Fig. <xref rid="Fig5" ref-type="fig">5</xref>, blue line), but the resulting rank error did not exceed 1 most of the time (MAE = 1.07 among wrong predictions, Table <xref rid="Tab1" ref-type="table">1</xref>). Errors in ranks 1–3 could be partly removed and errors in ranks 4–5 almost completely removed by putting aside the leaves that grow older than 20 day<sub>20 °C</sub> (Fig. <xref rid="Fig5" ref-type="fig">5</xref>; blue dotted line). Such old leaves are harder to track, as their morphology tends to change excessively when senescing. The remaining errors in ranks 1–3 were probably due to segmentation issues. For instance, the leaf 1 is sometimes not segmented in the 3D reconstruction because of its small size (data not shown). About half of the errors in the upper ranks (10 and more) could be avoided by manually removing the dates where the maize ear was misidentified as a leaf during the segmentation process (Fig. <xref rid="Fig5" ref-type="fig">5</xref>; blue dotted line), demonstrating the importance of a correct identification of this organ. The remaining errors in the upper ranks might be due to the increasing complexity of maize architecture during its development (longer leaves, more occlusions due to leaf crossings), and because these late emerging leaves are observed fewer times, making their identification more difficult.<fig id="Fig5"><label>Fig. 5</label><caption><p>Accuracy of leaf rank assignment as a function of leaf rank. Leaf rank assignment accuracy is the percentage of non-artefact segmented leaves (n = 10940) whose predicted rank matches ground-truth rank (observation). This metric is computed for each ground-truth rank value separately, for ligulated leaves (wide blue line) and growing leaves (wide orange line). Point value and error bars correspond respectively to the mean and 95% bootstrap confidence interval among 30 plants. Blue dotted line: ligulated leaves results without considering (i) leaf observations exceeding 20 day<sub>20 °C</sub> after ligulation, and (ii) dates where maize ear was segmented as a leaf. Orange dotted line: growing leaves results after initialising their tracking with ground-truth ligulated leaf ranks</p></caption><graphic xlink:href="13007_2022_961_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par47">Rank assignment accuracy was lower for growing leaves (85.3%, Table <xref rid="Tab1" ref-type="table">1</xref>), but still high for the first bottom ranks (92.8% for ranks 1–10). This might be because a different algorithm is used compared to ligulated leaves, and because of the intrinsic difficulties associated with the detection of a developing organ: growing leaves cannot be topologically ordered a priori, and they may undergo rapid changes in shape and geometry over time. Also, growing leaves tracking used ligulated leaf ranks assignment as a starting point, which caused error propagation. Indeed, fewer errors were observed for lower leaves when manually initialising the growing leaf tracking with ground-truth ligulated leaf ranks (Fig. <xref rid="Fig5" ref-type="fig">5</xref>; orange dotted line). Overall, the errors caused by the growing leaf tracking are more frequent in the upper ranks, (Fig. <xref rid="Fig5" ref-type="fig">5</xref>; orange line) which might be due again to an increasing complexity of maize leaves structure over time. In particular, there are more leaves emerging at the same time in the maize whorl for late growth stages [<xref ref-type="bibr" rid="CR45">45</xref>], and these leaves have a more similar morphology, making them difficult to distinguish (see Fig. <xref rid="Fig4" ref-type="fig">4</xref>A).</p>
    </sec>
    <sec id="Sec13">
      <title>An automated quantification of plant development during the whole vegetative phase</title>
      <p id="Par48">This pipeline provides two ways to quantify plant development automatically: either (i) vertically, or (ii) through the number of emerged and ligulated leaves (leaf stage).</p>
      <p id="Par49">(i) Stem height was predicted with high accuracy (RMSE = 2.02 cm, R<sup>2</sup> = 0.999) for all growth stages. This provides a way to quantify plant vertical development regardless of how the leaves are deployed. This also provides a spatial delimitation of the mature and growing parts of the plant, which is more accurate than the morphological criteria used in [<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>] (R<sup>2</sup> = 0.68) and [<xref ref-type="bibr" rid="CR46">46</xref>] (R<sup>2</sup> = 0.92 for early growth stages), and remains robust in advanced stage once the maize ear emerges (Fig. <xref rid="Fig6" ref-type="fig">6</xref>A; no outliers for high observed values, i.e. advanced stages).<fig id="Fig6"><label>Fig. 6</label><caption><p>Evaluation of the phenotypic traits obtained with the pipeline. Pipeline predictions are compared with ground-truth observations for the following traits:<bold> A</bold> Stem height, <bold>B</bold> visible leaf stage, <bold>C</bold> ligulated leaf stage, <bold>D, E</bold> length of leaf 6 &amp; 9 during growing phase, <bold>G</bold> ligulated leaf length, <bold>H</bold> ligulated leaf insertion height, <bold>I</bold> leaf length variation as a function of leaf rank. For each trait, a linear regression is applied (x = observation, y = prediction). In <bold>A, B, C, G</bold>, the pipeline results are compared with Phenomenal [<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>] outputs (points, regression equation and metrics are displayed in grey). Leaf growth (<bold>G</bold>) and Leaf length variation as a function of leaf rank (<bold>I</bold>) outputs are illustrated for one representative plant. In <bold>I</bold>, larger points correspond to median predictions. n = number of points, RMSE = Root-Mean-Square Error, MAPE = Mean Absolute Percentage Error</p></caption><graphic xlink:href="13007_2022_961_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par50">(ii) The leaf stage predicted by the pipeline was correlated to the ground-truth observation (R<sup>2</sup> = 0.87). Predictions were twice as accurate as when simply counting the leaves present on the reconstructed plant (Fig. <xref rid="Fig6" ref-type="fig">6</xref>B: RMSE = 1.29 vs RMSE = 2.62 for Phenomenal). Our method therefore avoids the bias that may occur in other leaf counting methods [<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, <sup><xref ref-type="bibr" rid="CR46">46</xref></sup>, <sup><xref ref-type="bibr" rid="CR38">38</xref></sup>] that do not take into account the disappearance of bottom leaves due to senescence. However, this trait was still consistently underestimated (bias = −1.09, Fig. <xref rid="Fig6" ref-type="fig">6</xref>B). The remaining error might be because the last leaves that have just emerged were often missing in the 3D reconstruction. This bias increases over time, since more and more leaves are growing simultaneously in the whorl [<xref ref-type="bibr" rid="CR45">45</xref>]. A linear regression can be applied to remove the bias from the prediction (red dashed line in Fig. <xref rid="Fig6" ref-type="fig">6</xref>B), which reduces the RMSE from 1.29 to 0.44.</p>
      <p id="Par51">Leaf stage was also measured considering only the ligulated leaves, which resulted in a higher correlation (R<sup>2</sup> = 0.93) and a lower bias (bias = 0.32, Fig. <xref rid="Fig6" ref-type="fig">6</xref>C). It is the first time that collar appearance rate, which is of crucial importance in maize models of development [<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>, <sup><xref ref-type="bibr" rid="CR48">48</xref></sup>], can be measured with an automatic method at this degree of precision.</p>
    </sec>
    <sec id="Sec14">
      <title>An automated tracking of individual leaves development</title>
      <p id="Par52">The pipeline was used to automatically extract leaf growth dynamics for all leaf ranks. For evaluation, we focus on leaf length dynamics of leaves 6 and 9 before ligulation. For leaf 6, predictions were strongly correlated to ground-truth (R<sup>2</sup> = 0.96, Fig. <xref rid="Fig6" ref-type="fig">6</xref>D). For leaf 9, the predicted length was close to ground-truth most of the time, but there were more outliers compared to leaf 6, resulting in a lower correlation (R<sup>2</sup> = 0.67, Fig. <xref rid="Fig6" ref-type="fig">6</xref>E). Leaf dynamics seem to be less accurately captured for higher leaf ranks, which may be due to more frequent leaf rank assignment errors (Fig. <xref rid="Fig5" ref-type="fig">5</xref>, orange line), but also more generally because leaf lengths are less accurate for advanced stages due to frequent errors in the 3D organ segmentation (i.e. before tracking). Although the dynamics of leaf growth were only evaluated in terms of length here, the pipeline allows to capture the full evolution of leaf shape over time (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B), which can be described by other variables such as azimuth (Additional file <xref rid="MOESM4" ref-type="media">4</xref>A). Such leaf dynamics can also be extracted during the senescence phase when leaves collapse (Additional file <xref rid="MOESM5" ref-type="media">5</xref>).</p>
    </sec>
    <sec id="Sec15">
      <title>An automated reconstruction of plant architecture development</title>
      <p id="Par53">This pipeline was used to automatically extract the estimation of various morphological features on mature (i.e. ligulated but not senesced) leaves as a function of leaf rank. We considered leaf length and leaf insertion height for evaluation, and both were highly correlated with ground-truth observations (length: R<sup>2</sup> = 0.96, Fig. <xref rid="Fig6" ref-type="fig">6</xref>F. Insertion height: R<sup>2</sup> = 0.98, Fig. <xref rid="Fig6" ref-type="fig">6</xref>G). As for leaf dynamics, the method can be extended to any other variable describing leaves, such as leaf width, internode width or leaf azimuth (Additional file <xref rid="MOESM4" ref-type="media">4</xref>B).</p>
      <p id="Par54">Thanks to tracking, median values can be derived from the successive measurements of morphological features for the same leaf over time. This significantly helps to minimise the errors that would have occurred using independent time points (e.g. ranks 2–4 in F<xref rid="Fig6" ref-type="fig">i</xref>g. <xref rid="Fig6" ref-type="fig">6</xref>I). Outliers remaining after applying a median value were often observed for the last ranks (10 and more). This might be due to (i) more leaves overlapping in the upper part of the plant, therefore leading to less accurate 3D segmentations, (ii) the fact that the last leaves reach ligulation later and are therefore observed fewer times, which makes the calculation of a median less robust, (iii) a higher number of tracking errors for the last ranks.</p>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Discussion</title>
    <sec id="Sec17">
      <title>An adaptation of the sequence alignment framework to robust leaf tracking</title>
      <p id="Par55">Sequence alignment is proposed as an original solution to the leaf tracking problem, allowing to consider both (i) the topological information at a fixed date, by ordering the ligulated leaves in a sequence, and (ii) the redundancy of the geometric information over time, by describing each ligulated leaf as a vector of temporally invariant features. While sequence alignment has already been applied outside the bioinformatics field [<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>, <sup><xref ref-type="bibr" rid="CR50">50</xref></sup>, <sup><xref ref-type="bibr" rid="CR51">51</xref></sup>], this is the first time, to our knowledge, it is used to track plant and organ growth. This framework allows us to consider the main difficulties of leaf tracking (segmentation artefacts, leaves appearance/disappearance) via the analogy of insertions and deletions of elements in a sequence. In plant phenotyping, tracking is often done step by step, by successive pairwise comparisons of reconstructed plant models, which could lead to the propagation of errors from the first alignments computed to the end of the time-series<italic>.</italic> Sequence alignment methods allow the formulation of a global resolution algorithm for this optimization problem. In this study, we used an optimization method called progressive alignment [<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>], which progressively integrates the models of successive time steps by comparing them to a “profile”, representing all the previous matched models. This method has shown great efficiency on our dataset.</p>
      <p id="Par56">Sequence alignment algorithms are known to be highly dependent on the choice of their parameters, especially the gap penalty [<sup><xref ref-type="bibr" rid="CR52">52</xref></sup>], thus further parameters fine tuning should be considered to optimise the method on more challenging datasets in the future. While this method was tested on maize plants, it could be adapted to any other species for which (i) the order of leaf emergence can be derived topologically along a single stem axis, and (ii) a subset of leaves with a stable geometry can be identified at each time point (e.g. sunflowers or cotton). However, extending this method to branched plants, such as wheat or sorghum with tillers, remains an open problem.</p>
    </sec>
    <sec id="Sec18">
      <title>Temporal tracking enhances the robustness of 3D reconstruction</title>
      <p id="Par57">This work focused on the temporal processing of 3D segmented plant reconstructions. Each plant segmentation is performed at a given date independently of other dates, and can contain inaccurate leaf reconstructions, and segmentation artefacts. With our tracking method, potential error reconstructions can be compensated over time, by grouping several observations of a same leaf in the time-series. The sequence alignment framework also helps to overcome segmentation artefacts (e.g. missing leaves, ear misidentified as a leaf) by setting them apart. However, such segmentation errors were still often responsible for subsequent tracking errors in our dataset. This is particularly visible in the advanced stages of growth where the leaves emerge more frequently, are longer, and therefore intersect more, making the segmentation task more error-prone. It might therefore be better to spend time addressing these segmentation issues beforehand, rather than optimising the tracking parameters to address them later. For example, the maize ear could be detected beforehand in the segmented plant objects, using approaches similar to panicle [<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>] and collar [<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>] detection. The continuous improvement of 3D plant reconstruction and segmentation methods [<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>, <sup><xref ref-type="bibr" rid="CR53">53</xref></sup>, <sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, <sup><xref ref-type="bibr" rid="CR36">36</xref></sup>], that are all compatible with the solution reported here, is also very encouraging for a rapid evolution of the performance of the pipeline as a whole.</p>
    </sec>
    <sec id="Sec19">
      <title>A robust pipeline that can be used in high-throughput conditions</title>
      <p id="Par58">While other 3D + t phenotyping pipelines have already been proposed, they were mostly tested on a few number of plants and time points, for early growth stages (ca. 5–10 time points and 5–10 plants). Instead, the pipeline presented here was tested on a dataset of 355 plants of various genotypes grown under different environmental conditions. Each plant was observed through a time-series of ~ 43 time points covering all growth stages, making a total of 237,600 images analysed. Most traits were validated on a subset of only 30 plants due to time-consuming annotations, but leaf stages outputs were evaluated on the full dataset of 355 plants (see Fig. <xref rid="Fig6" ref-type="fig">6</xref>B-C). Other traits outputs are shown on Fig. <xref rid="Fig7" ref-type="fig">7</xref> for the entire dataset of late harvesting plants, and overall exhibit coherent patterns for all ranks and growth stages. All these results suggest that this pipeline can be used to phenotype large panels of maize plants.<fig id="Fig7"><label>Fig. 7</label><caption><p>Automatic extraction of architecture and development traits at organ level in high-throughput conditions. Extraction of <bold>A</bold> stem growth and <bold>B</bold> leaf length variation as a function of leaf rank using the pipeline, for 355 maize plants of 60 different genotypes, grown from plant emergence to flowering stage (237,600 images analysed), under well-watered (WW; 178 plants, blue) and water deficit (WD; 177 plants, red) conditions. <bold>A</bold>: one line per plant, each line is smoothed (see Step 5 of the pipeline). <bold>B</bold>: point = mean, error bar = standard deviation</p></caption><graphic xlink:href="13007_2022_961_Fig7_HTML" id="MO7"/></fig></p>
      <p id="Par59">In this study, Phenotrack3D was tested on dense (average frequency of 24 h), high quality 3D acquisition (isolated plants to avoid occlusions), which is typical of image phenotyping in controlled conditions. This type of data is the primary target for Phenotrack3D and only minor adaptations in data preparation are expected to allow re-using our method in such conditions. Some methods using Terrestrial LiDAR Point Cloud were also successful at segmenting organs in field conditions (maize grown at low densities) [<sup><xref ref-type="bibr" rid="CR54">54</xref></sup>, <sup><xref ref-type="bibr" rid="CR55">55</xref></sup>], hence producing data that could fit the requirement of Phenotrack3D, despite the lower quality of the segmentation of individual plants. The main issue would be the precise localisation of stem tip, since collars may not be visible in point clouds, or the availability of an alternative method to perform the separation between the mature and the growing part of the plant. In the case of an acquisition in agronomic conditions where the plant density is higher, other adaptations will probably be required since only portions of the mature part of the plant would be measured at a time (only 40 cm depth is visible with reasonable occlusion level), leading to incomplete, possibly non overlapping sequences that could make the sequence alignment fail.</p>
    </sec>
    <sec id="Sec20">
      <title>Quantification of maize architecture and development for plant modelling</title>
      <p id="Par60">Plant development is usually quantified indirectly and incompletely in phenotyping platforms, using for example the height of the highest plant pixel on images [<sup><xref ref-type="bibr" rid="CR56">56</xref></sup>] as a proxy of vertical development, or the total number of plant pixels [<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>]. On the contrary, our method directly measures detailed botanical features for all organs, together with their dynamics. For example, the stem height estimated with our pipeline fits the botanical definition of vertical plant growth. Other traits such as individual leaf elongation have already been measured semi-automatically in HTP platforms (e.g. transducer, [<sup><xref ref-type="bibr" rid="CR57">57</xref></sup>]), but such methods are limited to monitoring a small number of leaves of the plant, which can lead to serious limitation [<sup><xref ref-type="bibr" rid="CR58">58</xref></sup>]. Instead, our method can quantify the growth dynamics of all leaves simultaneously, therefore capturing the full growth dynamics of the plant. Finally, rank-based traits such as the variation of leaf length as a function of leaf rank, that is widely used to model plant development [<xref ref-type="bibr" rid="CR48">48</xref>], are difficult to measure in a non-destructive way, and it has never been done on hundreds of maize plants to our knowledge.</p>
      <p id="Par61">Such automatic phenotypic measurements are valuable input data to parameterize models such as Functional-Structural Plant Models (FSPM) [<xref ref-type="bibr" rid="CR47">47</xref>, <xref ref-type="bibr" rid="CR59">59</xref>], which fully capture the 3D plant architecture and development up to the organ level [<xref ref-type="bibr" rid="CR60">60</xref>]. While these models are often calibrated via indirect proxies due to lack of additional available data, our 3D + t plant reconstruction method could give a more direct access to an accurate plant model calibration. Moreover, the phenotypic traits obtained with our pipeline show differences between different genotypes and watering treatments (Fig. <xref rid="Fig7" ref-type="fig">7</xref>), illustrating that the pipeline is sufficiently accurate to compare GxE interactions. Using our pipeline on large plant panels in HTP conditions could therefore provide the input data necessary to parameterize both genetic and environmental effects on plant architecture and development in FSPM models.</p>
    </sec>
  </sec>
  <sec id="Sec21">
    <title>Conclusion</title>
    <p id="Par62">We propose Phenotrack3D, a pipeline that allows reconstructing, from time-inconsistent segmentations, the 3D architectural development of a maize plant at organ level, from emergence to flowering. We solve the challenging problem of leaf tracking by adapting and using a sequence alignment algorithm, which proved to be a robust and efficient strategy for this task. Tracking leaves over the entire growth cycle allows retrieving the true botanical rank of organs at all time steps, hence giving access to widely used rank-based phenotypes (e.g. leaf length variation as a function of leaf rank). Moreover, the different observations of the same organ at different time steps are grouped together, providing more accurate measurements by compensating eventual errors over time. Tracking also makes it possible to retrieve the dynamics of plant development, both at organ level (leaf growth) and plant level (plant height dynamics, leaf stage). This pipeline is fully automatic and works smoothly with available automatic reconstruction-segmentation pipelines, such as Phenomenal [<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>]. It could therefore be used to measure phenotypic traits on thousands of plants in HTP platforms, with sufficient accuracy to compare the development and architecture of various GxE interactions along the entire growth cycle.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec22">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13007_2022_961_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1. </bold>Details on the training of the deep-learning model for maize collar detection.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13007_2022_961_MOESM2_ESM.mp4">
            <caption>
              <p><bold>Additional file 2. </bold>Video (.mp4) displaying leaf tracking for 3 maize plants.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13007_2022_961_MOESM3_ESM.png">
            <caption>
              <p><bold>Additional file 3. </bold>Example of the anomaly detection step for one maize plant. <bold>A)</bold> two reconstructed plants removed during anomaly detection due to their abnormal stem shapes. <bold>B)</bold> Stem height smoothing over time, allowing to correct an outlier.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13007_2022_961_MOESM4_ESM.png">
            <caption>
              <p><bold>Additional file 4. </bold>Example of azimuth traits extracted with the pipeline for one maize plant. <bold>A)</bold> Azimuth dynamics of individual leaves, up to 40 day<sub>20°C</sub> after their first detection. <bold>B)</bold> Leaf azimuth profile.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13007_2022_961_MOESM5_ESM.png">
            <caption>
              <p><bold>Additional file 5. </bold>Visualisation of rank assignment following sequence alignment on a set of 3D ligulated leaf polylines. <bold>A)</bold> Visualisation of all ligulated leaves polylines in a time-series of 3D reconstructions of one plant. <bold>B)</bold> Assignment of leaf ranks on this set of polylines, using sequence alignment.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Benoit Daviet and Romain Fernandez are main authors</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We are grateful to all members at the M3P platforms for providing technical support, conducting the experiments and collecting data.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>LCB supervised the experiment and acquired the data. BD designed the pipeline and analysed the data. CF, CP, LCB and RF provided advice on the conception of the pipeline. BD and RF wrote the manuscript and CF, CP and LCB reviewed and edited it. All the authors have approved the manuscript and have made all required statements and declarations. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the EU project H2020 731013 (EPPN2020) and STARGATE H2020 952339 (<ext-link ext-link-type="uri" xlink:href="https://stargate-hub.eu/">https://stargate-hub.eu/</ext-link>). RF and CP have been supported by the MaCS4Plants CIRAD network, initiated from the AGAP Institute and AMAP joint research units.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The source code and examples are available on Github (<ext-link ext-link-type="uri" xlink:href="https://github.com/openalea/phenotrack3d">https://github.com/openalea/phenotrack3d</ext-link>) under an Open Source licence (Cecill-C).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par63">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par64">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par65">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barthélémy</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Caraglio</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Plant architecture: a dynamic, multilevel and comprehensive approach to plant form, structure and ontogeny</article-title>
        <source>Ann Bot</source>
        <year>2007</year>
        <volume>99</volume>
        <issue>3</issue>
        <fpage>375</fpage>
        <lpage>407</lpage>
        <pub-id pub-id-type="doi">10.1093/aob/mcl260</pub-id>
        <pub-id pub-id-type="pmid">17218346</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bucksch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Atta-Boateng</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Azihou</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Battogtokh</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Baumgartner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Binder</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Braybrook</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Coneva</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>DeWitt</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Fletcher</surname>
            <given-names>AG</given-names>
          </name>
        </person-group>
        <article-title>Morphological plant modeling: unleashing geometric and topological potential within the plant sciences</article-title>
        <source>Front Plant Sci</source>
        <year>2017</year>
        <volume>9</volume>
        <issue>8</issue>
        <fpage>900</fpage>
        <pub-id pub-id-type="doi">10.3389/fpls.2017.00900</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Long</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>XG</given-names>
          </name>
          <name>
            <surname>Naidu</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Ort</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Can improvement in photosynthesis increase crop yields?</article-title>
        <source>Plant Cell Environ</source>
        <year>2006</year>
        <volume>29</volume>
        <issue>3</issue>
        <fpage>315</fpage>
        <lpage>330</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1365-3040.2005.01493.x</pub-id>
        <pub-id pub-id-type="pmid">17080588</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stewart</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Costa</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dwyer</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Hamilton</surname>
            <given-names>RI</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>BL</given-names>
          </name>
        </person-group>
        <article-title>Canopy structure, light interception, and photosynthesis in maize</article-title>
        <source>Agron J</source>
        <year>2003</year>
        <volume>95</volume>
        <issue>6</issue>
        <fpage>1465</fpage>
        <lpage>1474</lpage>
        <pub-id pub-id-type="doi">10.2134/agronj2003.1465</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>XG</given-names>
          </name>
        </person-group>
        <article-title>Optimal crop canopy architecture to maximise canopy photosynthetic CO2 uptake under elevated CO2–a theoretical study using a mechanistic model of canopy photosynthesis</article-title>
        <source>Funct Plant Biol</source>
        <year>2013</year>
        <volume>40</volume>
        <issue>2</issue>
        <fpage>108</fpage>
        <lpage>124</lpage>
        <pub-id pub-id-type="doi">10.1071/FP12056</pub-id>
        <pub-id pub-id-type="pmid">32481092</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cabrera-Bosquet</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fournier</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Brichet</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Welcker</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Suard</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tardieu</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>High-throughput estimation of incident light, light interception and radiation-use efficiency of thousands of plants in a phenotyping platform</article-title>
        <source>New Phytol</source>
        <year>2016</year>
        <volume>212</volume>
        <issue>1</issue>
        <fpage>269</fpage>
        <lpage>281</lpage>
        <pub-id pub-id-type="doi">10.1111/nph.14027</pub-id>
        <pub-id pub-id-type="pmid">27258481</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lacube</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fournier</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Palaffre</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Millet</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Tardieu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Parent</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Distinct controls of leaf widening and elongation by light and evaporative demand in maize</article-title>
        <source>Plant Cell Environ</source>
        <year>2017</year>
        <volume>40</volume>
        <issue>9</issue>
        <fpage>2017</fpage>
        <lpage>2028</lpage>
        <pub-id pub-id-type="doi">10.1111/pce.13005</pub-id>
        <pub-id pub-id-type="pmid">28639691</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perez</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Fournier</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cabrera-Bosquet</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Artzet</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pradal</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Brichet</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Chapuis</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Welcker</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tardieu</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Changes in the vertical distribution of leaf area enhanced light interception efficiency in maize over generations of selection</article-title>
        <source>Plant Cell Environ</source>
        <year>2019</year>
        <volume>42</volume>
        <issue>7</issue>
        <fpage>2105</fpage>
        <lpage>2119</lpage>
        <pub-id pub-id-type="doi">10.1111/pce.13539</pub-id>
        <pub-id pub-id-type="pmid">30801738</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Murchie</surname>
            <given-names>EH</given-names>
          </name>
          <name>
            <surname>Pinto</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Horton</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Agriculture and the new challenges for photosynthesis research</article-title>
        <source>New Phytol</source>
        <year>2009</year>
        <volume>181</volume>
        <issue>3</issue>
        <fpage>532</fpage>
        <lpage>552</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1469-8137.2008.02705.x</pub-id>
        <pub-id pub-id-type="pmid">19140947</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reynolds</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Foulkes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Furbank</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Griffiths</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>King</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Murchie</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Parry</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Slafer</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Achieving yield gains in wheat</article-title>
        <source>Plant Cell Environ</source>
        <year>2012</year>
        <volume>35</volume>
        <issue>10</issue>
        <fpage>1799</fpage>
        <lpage>1823</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1365-3040.2012.02588.x</pub-id>
        <pub-id pub-id-type="pmid">22860982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>XG</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Ort</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Improving photosynthetic efficiency for greater yield</article-title>
        <source>Annu Rev Plant Biol</source>
        <year>2010</year>
        <volume>2</volume>
        <issue>61</issue>
        <fpage>235</fpage>
        <lpage>261</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-arplant-042809-112206</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roitsch</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cabrera-Bosquet</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fournier</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ghamkhar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Jiménez-Berni</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pinto</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ober</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <article-title>New sensors and data-driven approaches—a path to next generation phenomics</article-title>
        <source>Plant Sci</source>
        <year>2019</year>
        <volume>1</volume>
        <issue>282</issue>
        <fpage>2</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1016/j.plantsci.2019.01.011</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tardieu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Cabrera-Bosquet</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pridmore</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bennett</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Plant phenomics, from sensors to knowledge</article-title>
        <source>Curr Biol</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>15</issue>
        <fpage>R770</fpage>
        <lpage>R783</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cub.2017.05.055</pub-id>
        <pub-id pub-id-type="pmid">28787611</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Minervini</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scharr</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tsaftaris</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Image analysis: the new bottleneck in plant phenotyping [applications corner]</article-title>
        <source>IEEE Signal Process Mag</source>
        <year>2015</year>
        <volume>32</volume>
        <issue>4</issue>
        <fpage>126</fpage>
        <lpage>131</lpage>
        <pub-id pub-id-type="doi">10.1109/MSP.2015.2405111</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gibbs</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Pound</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>French</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Wells</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Murchie</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Pridmore</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Approaches to three-dimensional reconstruction of plant shoot topology and geometry</article-title>
        <source>Funct Plant Biol</source>
        <year>2016</year>
        <volume>44</volume>
        <issue>1</issue>
        <fpage>62</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1071/FP16167</pub-id>
        <pub-id pub-id-type="pmid">32480547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Artzet</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Chopard</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Brichet</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mielewczik</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cohen-Boulakia</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cabrera-Bosquet</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Tardieu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Fournier</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pradal</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Phenomenal: an automatic open source library for 3D shoot architecture reconstruction and analysis for image-based plant phenotyping</article-title>
        <source>BioRxiv</source>
        <year>2019</year>
        <volume>1</volume>
        <fpage>805739</fpage>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Poethig</surname>
            <given-names>RS</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Rougvie</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>O’Connor</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Vegetative phase change and shoot maturation in plants</article-title>
        <source>Current topics in developmental biology</source>
        <year>2013</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
        <fpage>125</fpage>
        <lpage>52</lpage>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ledent</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mouraux</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Determination of foliar stage and number of leaves in maize when lower leaves are missing</article-title>
        <source>Agronomie</source>
        <year>1990</year>
        <volume>10</volume>
        <issue>2</issue>
        <fpage>147</fpage>
        <lpage>56</lpage>
        <pub-id pub-id-type="doi">10.1051/agro:19900208</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Xing</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Milan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>TK</given-names>
          </name>
        </person-group>
        <article-title>Multiple object tracking: a literature review</article-title>
        <source>Artif Intell</source>
        <year>2021</year>
        <volume>1</volume>
        <issue>293</issue>
        <fpage>103448</fpage>
        <pub-id pub-id-type="doi">10.1016/j.artint.2020.103448</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Mitra</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Chamovitz</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cohen-Or</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Analyzing growing plants from 4D point cloud data</article-title>
        <source>ACM Trans Gr (TOG)</source>
        <year>2013</year>
        <volume>32</volume>
        <issue>6</issue>
        <fpage>1</fpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aksoy</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Abramov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wörgötter</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Scharr</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Fischbach</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dellen</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Modeling leaf growth of rosette plants using infrared stereo image sequences</article-title>
        <source>Comput Electron Agric</source>
        <year>2015</year>
        <volume>1</volume>
        <issue>110</issue>
        <fpage>78</fpage>
        <lpage>90</lpage>
        <pub-id pub-id-type="doi">10.1016/j.compag.2014.10.020</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dellen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Scharr</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Torras</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Growth signatures of rosette plants from time-lapse video</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinf</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>6</issue>
        <fpage>14708</fpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2015.2404810</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Viaud</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Loudet</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Cournède</surname>
            <given-names>PH</given-names>
          </name>
        </person-group>
        <article-title>Leaf segmentation and tracking in Arabidopsis thaliana combined to an organ-scale plant model for genotypic differentiation</article-title>
        <source>Front Plant Sci</source>
        <year>2017</year>
        <volume>11</volume>
        <issue>7</issue>
        <fpage>2057</fpage>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yin</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kramer</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>Joint multi-leaf segmentation, alignment, and tracking for fluorescence plant videos</article-title>
        <source>IEEE Trans Pattern Anal Mach Intell</source>
        <year>2017</year>
        <volume>40</volume>
        <issue>6</issue>
        <fpage>1411</fpage>
        <lpage>1423</lpage>
        <pub-id pub-id-type="doi">10.1109/TPAMI.2017.2728065</pub-id>
        <pub-id pub-id-type="pmid">28715326</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paproki</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sirault</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Berry</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Furbank</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fripp</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A novel mesh processing based technique for 3D plant analysis</article-title>
        <source>BMC Plant Biol</source>
        <year>2012</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2229-12-63</pub-id>
        <pub-id pub-id-type="pmid">22214433</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harmening</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Paffenholz</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>A fully automated three-stage procedure for spatio-temporal leaf segmentation with regard to the B-spline-based phenotyping of cucumber plants</article-title>
        <source>Remote Sens</source>
        <year>2020</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>74</fpage>
        <pub-id pub-id-type="doi">10.3390/rs13010074</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chebrolu</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Magistri</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Läbe</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Stachniss</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Registration of spatio-temporal point clouds of plants for phenotyping</article-title>
        <source>PLoS ONE</source>
        <year>2021</year>
        <volume>16</volume>
        <issue>2</issue>
        <fpage>e0247243</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0247243</pub-id>
        <pub-id pub-id-type="pmid">33630896</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bashyam</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Choudhury</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Samal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Awada</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Visual growth tracking for automated leaf stage monitoring based on image sequence analysis</article-title>
        <source>Remote Sens</source>
        <year>2021</year>
        <volume>13</volume>
        <issue>5</issue>
        <fpage>961</fpage>
        <pub-id pub-id-type="doi">10.3390/rs13050961</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Balduzzi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Binder</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Bucksch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hong</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Iyer-Pascuzzi</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Pradal</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sparks</surname>
            <given-names>EE</given-names>
          </name>
        </person-group>
        <article-title>Reshaping plant biology: qualitative and quantitative descriptors for plant morphology</article-title>
        <source>Front Plant Sci</source>
        <year>2017</year>
        <volume>3</volume>
        <issue>8</issue>
        <fpage>117</fpage>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miao</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ge</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Schnable</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Automation of leaf counting in maize and sorghum using deep learning</article-title>
        <source>Plant Phenome J</source>
        <year>2021</year>
        <volume>4</volume>
        <issue>1</issue>
        <fpage>e20022</fpage>
        <pub-id pub-id-type="doi">10.1002/ppj2.20022</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miao</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automatic stem-leaf segmentation of maize shoots using three-dimensional point cloud</article-title>
        <source>Computers Electron Agric</source>
        <year>2021</year>
        <volume>187</volume>
        <fpage>106310</fpage>
        <pub-id pub-id-type="doi">10.1016/j.compag.2021.106310</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Batzoglou</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The many faces of sequence alignment</article-title>
        <source>Brief Bioinform</source>
        <year>2005</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>6</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/6.1.6</pub-id>
        <pub-id pub-id-type="pmid">15826353</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Welcker</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Spencer</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Turc</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Granato</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Chapuis</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Madur</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Beauchene</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gouesnard</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Draye</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Palaffre</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lorgeou</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Physiological adaptive traits are a potential allele reservoir for maize genetic progress under challenging conditions</article-title>
        <source>Nat Commun</source>
        <year>2022</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-022-30872-w</pub-id>
        <pub-id pub-id-type="pmid">34983933</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brichet</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Fournier</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Turc</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Strauss</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Artzet</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pradal</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Welcker</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tardieu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Cabrera-Bosquet</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>A robot-assisted imaging pipeline for tracking the growths of maize ear and silks in a high-throughput phenotyping platform</article-title>
        <source>Plant Methods</source>
        <year>2017</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="doi">10.1186/s13007-017-0246-7</pub-id>
        <pub-id pub-id-type="pmid">28053646</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gaillard</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Miao</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schnable</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Benes</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Bartoli</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fusiello</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Sorghum segmentation by skeleton extraction</article-title>
        <source>Computer vision—ECCV 2020 workshops</source>
        <year>2020</year>
        <publisher-loc>Cham</publisher-loc>
        <publisher-name>Springer International Publishing</publisher-name>
        <fpage>296</fpage>
        <lpage>311</lpage>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gou</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MVS-Pheno: a portable and low-cost phenotyping platform for maize shoots using multiview stereo 3D reconstruction</article-title>
        <source>Plant Phenomics</source>
        <year>2020</year>
        <volume>12</volume>
        <issue>2020</issue>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.34133/2020/1848437</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kutulakos</surname>
            <given-names>KN</given-names>
          </name>
          <name>
            <surname>Seitz</surname>
            <given-names>SM</given-names>
          </name>
        </person-group>
        <article-title>A theory of shape by space carving</article-title>
        <source>Int J Comput Vision</source>
        <year>2000</year>
        <volume>38</volume>
        <issue>3</issue>
        <fpage>199</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1008191222954</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chai</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Maize-IAS: a maize image analysis software using deep learning for high-throughput plant phenotyping</article-title>
        <source>Plant Methods</source>
        <year>2021</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1186/s13007-021-00747-0</pub-id>
        <pub-id pub-id-type="pmid">33407638</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Bochkovskiy A, Wang CY, Liao HY. Yolov4: Optimal speed and accuracy of object detection. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2004.10934">arXiv:2004.10934</ext-link>. 2020.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Multiple sequence alignment</article-title>
        <source>Curr Opin Struct Biol</source>
        <year>2006</year>
        <volume>16</volume>
        <issue>3</issue>
        <fpage>368</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1016/j.sbi.2006.04.004</pub-id>
        <pub-id pub-id-type="pmid">16679011</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>MUSCLE: a multiple sequence alignment method with reduced time and space complexity</article-title>
        <source>BMC Bioinformatics</source>
        <year>2004</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-5-113</pub-id>
        <pub-id pub-id-type="pmid">14706121</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Needleman</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Wunsch</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>
        <source>J Mol Biol</source>
        <year>1970</year>
        <volume>48</volume>
        <issue>3</issue>
        <fpage>443</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="doi">10.1016/0022-2836(70)90057-4</pub-id>
        <pub-id pub-id-type="pmid">5420325</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice</article-title>
        <source>Nucleic Acids Res</source>
        <year>1994</year>
        <volume>22</volume>
        <issue>22</issue>
        <fpage>4673</fpage>
        <lpage>4680</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/22.22.4673</pub-id>
        <pub-id pub-id-type="pmid">7984417</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Sjölander</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A comparison of scoring functions for protein sequence profile alignment</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <issue>8</issue>
        <fpage>1301</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth090</pub-id>
        <pub-id pub-id-type="pmid">14962936</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruget</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bonhomme</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chartier</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Estimation simple de la surface foliaire de plantes de maïs en croissance</article-title>
        <source>Agronomie</source>
        <year>1996</year>
        <volume>16</volume>
        <issue>9</issue>
        <fpage>553</fpage>
        <lpage>562</lpage>
        <pub-id pub-id-type="doi">10.1051/agro:19960903</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Souza</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>High-throughput corn image segmentation and trait extraction using chlorophyll fluorescence images</article-title>
        <source>Plant Phenomics</source>
        <year>2021</year>
        <volume>2021</volume>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.34133/2021/9792582</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fournier</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Andrieu</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>A 3D architectural and process-based model of maize development</article-title>
        <source>Ann Botany</source>
        <year>1998</year>
        <volume>81</volume>
        <issue>2</issue>
        <fpage>233</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1006/anbo.1997.0549</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lacube</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Manceau</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Welcker</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Millet</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Gouesnard</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Palaffre</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Simulating the effect of flowering time on maize individual leaf area in contrasting environmental scenarios</article-title>
        <source>J Exp Bot</source>
        <year>2020</year>
        <volume>71</volume>
        <issue>18</issue>
        <fpage>5577</fpage>
        <lpage>5588</lpage>
        <pub-id pub-id-type="doi">10.1093/jxb/eraa278</pub-id>
        <pub-id pub-id-type="pmid">32526015</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abbott</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tsay</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Sequence analysis and optimal matching methods in sociology: review and prospect</article-title>
        <source>Sociol Methods Res</source>
        <year>2000</year>
        <volume>29</volume>
        <issue>1</issue>
        <fpage>3</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.1177/0049124100029001001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Dieny</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Thevenon</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>del Rincón</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Nebel</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <source>Bioinformatics Inspired Algorithm for Stereo correspondence. In VISAPP</source>
        <year>2011</year>
        <publisher-loc>Setúbal</publisher-loc>
        <publisher-name>Science and technology publications ida</publisher-name>
        <fpage>465</fpage>
        <lpage>473</lpage>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prinzie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Van den Poel</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Incorporating sequential information into traditional classification models by using an element/position-sensitive SAM</article-title>
        <source>Decis Support Syst</source>
        <year>2006</year>
        <volume>42</volume>
        <issue>2</issue>
        <fpage>508</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1016/j.dss.2005.02.004</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Recent progress in multiple sequence alignment: a survey</article-title>
        <source>Pharmacogenomics</source>
        <year>2002</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>131</fpage>
        <lpage>144</lpage>
        <pub-id pub-id-type="doi">10.1517/14622416.3.1.131</pub-id>
        <pub-id pub-id-type="pmid">11966409</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miao</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automatic organ-level point cloud segmentation of maize shoots by integrating high-throughput data acquisition and deep learning</article-title>
        <source>Comput Electron Agric</source>
        <year>2022</year>
        <volume>1</volume>
        <issue>193</issue>
        <fpage>106702</fpage>
        <pub-id pub-id-type="doi">10.1016/j.compag.2022.106702</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">Ao Z, Wu F, Hu S, Sun Y, Su Y, Guo Q, et al. Automatic segmentation of stem and leaf components and individual maize plants in field terrestrial LiDAR data using convolutional neural networks. The Crop Journal. 2021. <ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S2214514121002191">https://www.sciencedirect.com/science/article/pii/S2214514121002191</ext-link>. Accessed 25 Sep 2022</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhai</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Segmentation and stratification methods of field maize terrestrial LiDAR point cloud</article-title>
        <source>Agriculture</source>
        <year>2022</year>
        <volume>12</volume>
        <issue>9</issue>
        <fpage>1450</fpage>
        <pub-id pub-id-type="doi">10.3390/agriculture12091450</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Golzarian</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Frick</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Rajendran</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tester</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lun</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <article-title>Accurate inference of shoot biomass from high-throughput images of cereal plants</article-title>
        <source>Plant Methods</source>
        <year>2011</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>1</lpage>
        <pub-id pub-id-type="doi">10.1186/1746-4811-7-2</pub-id>
        <pub-id pub-id-type="pmid">21266074</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sadok</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Naudin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Boussuge</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Muller</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Welcker</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tardieu</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Leaf growth rate per unit thermal time follows QTL-dependent daily patterns in hundreds of maize lines under naturally fluctuating conditions</article-title>
        <source>Plant Cell Environ</source>
        <year>2007</year>
        <volume>30</volume>
        <issue>2</issue>
        <fpage>135</fpage>
        <lpage>146</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1365-3040.2006.01611.x</pub-id>
        <pub-id pub-id-type="pmid">17238905</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Granier</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tardieu</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Multi-scale phenotyping of leaf expansion in response to environmental changes: the whole is more than the sum of parts</article-title>
        <source>Plant Cell Environ</source>
        <year>2009</year>
        <volume>32</volume>
        <issue>9</issue>
        <fpage>1175</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1365-3040.2009.01955.x</pub-id>
        <pub-id pub-id-type="pmid">19210637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cieslak</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ferraro</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Soolanayakanahally</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Parkin</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>L-system models for image-based phenomics: case studies of maize and canola</article-title>
        <source>In silico Plants</source>
        <year>2022</year>
        <volume>4</volume>
        <issue>1</issue>
        <fpage>diab039</fpage>
        <pub-id pub-id-type="doi">10.1093/insilicoplants/diab039</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>3D phytomer-based geometric modelling method for plants—the case of maize</article-title>
        <source>AoB PLANTS</source>
        <year>2021</year>
        <volume>13</volume>
        <issue>5</issue>
        <fpage>plab055</fpage>
        <pub-id pub-id-type="doi">10.1093/aobpla/plab055</pub-id>
        <pub-id pub-id-type="pmid">34603653</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
