<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10597621</article-id>
    <article-id pub-id-type="pmid">37846051</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad626</article-id>
    <article-id pub-id-type="publisher-id">btad626</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic toggle="yes">Semla:</italic> a versatile toolkit for spatially resolved transcriptomics analysis and visualization</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Larsson</surname>
          <given-names>Ludvig</given-names>
        </name>
        <aff><institution>Department of Gene Technology, KTH Royal Institute of Technology, Science for Life Laboratory</institution>, <addr-line>Tomtebodavägen 23, 171 65 Solna</addr-line>, Stockholm, <country country="SE">Sweden</country></aff>
        <xref rid="btad626-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3755-718X</contrib-id>
        <name>
          <surname>Franzén</surname>
          <given-names>Lovisa</given-names>
        </name>
        <aff><institution>Department of Gene Technology, KTH Royal Institute of Technology, Science for Life Laboratory</institution>, <addr-line>Tomtebodavägen 23, 171 65 Solna</addr-line>, Stockholm, <country country="SE">Sweden</country></aff>
        <aff><institution>Respiratory &amp; Immunology, Neuroscience, Vaccines &amp; Immune Therapies Safety, Clinical Pharmacology &amp; Safety Sciences, BioPharmaceuticals R&amp;D, AstraZeneca</institution>, <addr-line>Pepparedsleden 1, 431 83 Mölndal</addr-line>, Gothenburg, <country country="SE">Sweden</country></aff>
        <xref rid="btad626-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ståhl</surname>
          <given-names>Patrik L</given-names>
        </name>
        <aff><institution>Department of Gene Technology, KTH Royal Institute of Technology, Science for Life Laboratory</institution>, <addr-line>Tomtebodavägen 23, 171 65 Solna</addr-line>, Stockholm, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4313-1601</contrib-id>
        <name>
          <surname>Lundeberg</surname>
          <given-names>Joakim</given-names>
        </name>
        <aff><institution>Department of Gene Technology, KTH Royal Institute of Technology, Science for Life Laboratory</institution>, <addr-line>Tomtebodavägen 23, 171 65 Solna</addr-line>, Stockholm, <country country="SE">Sweden</country></aff>
        <xref rid="btad626-cor1" ref-type="corresp"/>
        <!--joakim.lundeberg@scilifelab.se-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Nikolski</surname>
          <given-names>Macha</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad626-cor1">Corresponding author. Department of Gene Technology, KTH Royal Institute of Technology, Science for Life Laboratory, Tomtebodavägen 23, 171 65 Solna, Stockholm, Sweden. E-mail: <email>joakim.lundeberg@scilifelab.se</email></corresp>
      <fn id="btad626-FM1">
        <p>Ludvig Larsson and Lovisa Franzén done Equal contribution.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-10-16">
      <day>16</day>
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>10</issue>
    <elocation-id>btad626</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>20</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>10</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>24</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad626.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Spatially resolved transcriptomics technologies generate gene expression data with retained positional information from a tissue section, often accompanied by a corresponding histological image. Computational tools should make it effortless to incorporate spatial information into data analyses and present analysis results in their histological context. Here, we present <italic toggle="yes">semla</italic>, an R package for processing, analysis, and visualization of spatially resolved transcriptomics data generated by the Visium platform, that includes interactive web applications for data exploration and tissue annotation.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The R package <italic toggle="yes">semla</italic> is available on GitHub (<ext-link xlink:href="https://github.com/ludvigla/semla" ext-link-type="uri">https://github.com/ludvigla/semla</ext-link>), under the MIT License, and deposited on Zenodo (<ext-link xlink:href="https://doi.org/10.5281/zenodo.8321645" ext-link-type="uri">https://doi.org/10.5281/zenodo.8321645</ext-link>). Documentation and tutorials with detailed descriptions of usage can be found at <ext-link xlink:href="https://ludvigla.github.io/semla/" ext-link-type="uri">https://ludvigla.github.io/semla/</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swedish Foundation for Strategic Research</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001729</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/100010663</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Union’s Horizon 2020</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swedish Cancer Society</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002794</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swedish Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004359</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The rise of new transcriptomics technologies has enabled the exploration of genome-wide expression profiles in tissues. Spatially resolved transcriptomics (SRT) methods facilitate quantification of gene expression levels in tissue sections while preserving positional information. SRT thus allows researchers to analyze cellular and biological processes in the context of their tissue microenvironment. Several SRT technologies have emerged, offering different resolutions, sample sizes, sample throughput, transcriptome coverage, and sensitivity (<xref rid="btad626-B14" ref-type="bibr">Ståhl <italic toggle="yes">et al.</italic> 2016</xref>, <xref rid="btad626-B13" ref-type="bibr">Rodriques <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad626-B4" ref-type="bibr">Cho <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad626-B7" ref-type="bibr">Fu <italic toggle="yes">et al.</italic> 2022</xref>). In recent years, commercialization of SRT technologies has further improved their accessibility and ease of use, increasing the number of publicly available SRT datasets. With a constantly growing number of SRT datasets, there is an increasing need for accessible computational tools that facilitate efficient exploration, visualization, and analysis.</p>
    <p>Visium, an SRT technology from 10x Genomics which to date is the most widely used SRT method (<xref rid="btad626-B18" ref-type="bibr">Moses <italic toggle="yes">et al.</italic> 2022</xref>), enables genome-wide transcriptome profiling of tissue sections with an area up to 11×11 mm<sup>2</sup> (Visium Spatial Gene Expression, 10x Genomics). The spatial resolution is determined by the size of individual capture elements known as “spots,” each measuring 55 µm in diameter. A bright field image is taken of the tissue’s histological features, and by mapping gene expression levels onto the image, it adds morphological information that can be used to guide downstream analyses. Consequently, computational frameworks dealing with Visium data should facilitate seamless integration of the two data modalities. Several applications and libraries are available for analysis and exploration of Visium data (<xref rid="btad626-B15" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad626-B2" ref-type="bibr">Bergenstrahle <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad626-B5" ref-type="bibr">Dries <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad626-B9" ref-type="bibr">Palla <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btad626-B10" ref-type="bibr">Pardo <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btad626-B12" ref-type="bibr">Righelli <italic toggle="yes">et al.</italic> 2022</xref>), where the <italic toggle="yes">Seurat</italic> R package is one of the most popular. Seurat provides the infrastructure to handle single-cell transcriptomics and SRT data and includes a versatile toolbox of computational methods for analytical tasks. Owing to its popularity, several analysis methods have therefore been built to be compatible specifically with <italic toggle="yes">Seurat</italic> objects, broadening the scope of Seurat based analysis workflows. <italic toggle="yes">Seurat</italic> provides core functionalities for handling data from a variety of SRT platforms as of version 3.2 and their latest releases. However, the availability of effective interactive features and spatially aware analysis tools for Visium data are still limited. To bridge some of the current gaps, we provide a new R package that extends the <italic toggle="yes">Seurat</italic> toolbox for spatial analyses. Our package delivers extra Visium data processing tools for users with variable programming expertise, featuring well-documented and interactive components to simplify the analytical process.</p>
  </sec>
  <sec>
    <title>2 Implementation and description</title>
    <p>We have developed <italic toggle="yes">semla</italic>, a toolbox for data processing, exploration, analysis, and visualization of spatial gene expression patterns in tissues. <italic toggle="yes">Semla</italic> is written in the R programming language (≥v.4.1) and takes advantage of the <italic toggle="yes">tidyverse</italic> (<xref rid="btad626-B17" ref-type="bibr">Wickham <italic toggle="yes">et al.</italic> 2019</xref>) framework for data handling and the <italic toggle="yes">patchwork</italic> (<xref rid="btad626-B11" ref-type="bibr">Pedersen 2020</xref>) framework for customizable visualization to produce publication-ready figures. In addition, the package utilizes the basic data structure and features of <italic toggle="yes">Seurat</italic>, allowing users to employ well-known functions for data processing and visualization. The core of the analysis and visualization methods provided in <italic toggle="yes">semla</italic> is built upon an easily accessible S4 object intended for storing spatial and image data.</p>
    <p>As input, <italic toggle="yes">semla</italic> requires data generated with the Visium Gene Expression profiling platform, including expression matrices, histological images, and spot coordinate files produced with the 10x Genomics Space Ranger pipeline (<xref rid="btad626-F1" ref-type="fig">Fig. 1A</xref>). Although <italic toggle="yes">semla</italic> is a Visium-centric toolkit in its current state, the framework is designed to allow for future support to load any spatial dataset represented by a feature × spot matrix and spot coordinates. <italic toggle="yes">Semla</italic> simplifies the task of combining and processing data from various tissue sections taken from different Visium capture areas. Users have the option to initiate web-based applications that facilitate interactive investigation and annotation of the data. This is especially handy when working with consecutive tissue sections that vary in sample positioning and orientation. An assortment of functions is available in <italic toggle="yes">semla</italic> to perform quality control, data processing, advanced spatial visualizations, cell type deconvolution, digital unrolling, and spatially aware analyses. Further descriptions of a selection of functions can be found in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Information</xref> document and all documentation of the utilities available within <italic toggle="yes">semla</italic> is available at the package website (<ext-link xlink:href="https://ludvigla.github.io/semla/" ext-link-type="uri">https://ludvigla.github.io/semla/</ext-link>), along with detailed tutorials which describe how these tools can be applied to real examples.</p>
    <fig position="float" id="btad626-F1">
      <label>Figure 1.</label>
      <caption>
        <p>(A) The input for the <italic toggle="yes">semla</italic> R package consists of transcriptomics data and a matched histological image as generated by the Visium protocol and data processing pipeline. (B) A web application (“Feature Viewer”) can be opened through the R console and enables interactive exploration and annotation of the spatial expression data. Within <italic toggle="yes">semla</italic>, the user can apply various analyses to the data such as (C) cell type mapping using a matching single-cell RNA sequencing (scRNA-seq) dataset, (D) exploring gene expression along a radial distance from a defined region of interest, (E) detect spatially correlated genes across the entire sample, and (F) apply spatial statistics to describe spot label patterns.</p>
      </caption>
      <graphic xlink:href="btad626f1" position="float"/>
    </fig>
    <p>The package is available for installation through GitHub, <ext-link xlink:href="https://github.com/ludvigla/semla" ext-link-type="uri">https://github.com/ludvigla/semla</ext-link>.</p>
  </sec>
  <sec>
    <title>3 Highlighted features</title>
    <sec>
      <title>3.1 Interactive viewer</title>
      <p>R is a popular programming language for SRT data analysis and offers a rich ecosystem of libraries to process and analyze data; however, interactive features are limited. For specific SRT analytical tasks, it is desirable to explore the data interactively and annotate spatial data in conjunction with the histological tissue image. A few alternative applications are available for this purpose (e.g. the Loupe Browser and spatialLIBD), though they are limited in their ability to seamlessly be integrated in the full analytical workflow. To address these needs, we have built an integrated web-based application within <italic toggle="yes">semla</italic> that facilitates interactive mapping of expression profiles and tissue annotations visualized onto the histological image of the tissue section (<xref rid="btad626-F1" ref-type="fig">Fig. 1B</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3.1</xref>). The interactive viewer is written in javascript using the popular UI library React, incorporated in <italic toggle="yes">semla</italic> using the <italic toggle="yes">reactR</italic> R package (<xref rid="btad626-B16" ref-type="bibr">Inc <italic toggle="yes">et al.</italic> 2021</xref>). The application is initiated within the R session and thereafter opens a web browser where it runs effortlessly when moving and zooming across the tissue image, facilitated by image tiling which is powered by the javascript-based web viewer OpenSeadragon. All numerical variables residing within the <italic toggle="yes">Seurat</italic> object, including gene expression values or dimensionality reduction vectors, are accessible for mapping on the tissue sections. Moreover, the viewer includes a lasso tool, with which users can select data points based on tissue morphology or feature expression and label these selections for downstream analysis.</p>
    </sec>
    <sec>
      <title>3.2 Cell type mapping with NNLS</title>
      <p>In Visium, the measured transcription profile in each spot typically represents mixed signals from multiple cells. Computational methods have been developed to deconvolve mixed expression profiles to predict the cell type composition (<xref rid="btad626-B1" ref-type="bibr">Andersson <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad626-B6" ref-type="bibr">Elosua-Bayes <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad626-B3" ref-type="bibr">Cable <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btad626-B8" ref-type="bibr">Kleshchevnikov <italic toggle="yes">et al.</italic> 2022</xref>). Many of these methods require high performance computers and may take hours to run on moderately large datasets. <italic toggle="yes">Semla</italic> includes an approach for cell type deconvolution based on Non-Negative Least Squares (NNLS), which runs in a matter of seconds on Visium data with up to 100 000 spots (<xref rid="btad626-F1" ref-type="fig">Fig. 1C</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3.2</xref>). In short, the first step is to estimate cell type enrichment scores by comparing the ratios of averaged gene expression levels between a cell type of interest and the other cell types in the scRNA-seq data. These scores describe relative differences in expression levels between the cell types and are subsequently leveraged into the NNLS method to estimate the proportions of cell types in each Visium spot. The enrichment scores for each cell type are combined into a matrix <bold>A</bold>. Given the matrix <bold>A</bold> and a mixed expression profile <bold>y</bold> for a Visium spot, the NNLS method solves the following problem:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">arg</mml:mi><mml:mo> </mml:mo><mml:mi mathvariant="italic">min</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:mi>A</mml:mi><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">subject</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">to</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi>x</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:math></disp-formula>where the solution for <bold>x</bold> represents the fractional abundances of cell types in the mixed expression profile. As a final step, the values for <bold>x</bold> are converted into cell type proportions. To assess the performance of our deconvolution method, we benchmarked NNLS against four other methods: RCTD, <italic toggle="yes">stereoscope</italic>, <italic toggle="yes">cell2location</italic>, and Seurat label transfer. Based on our benchmark results, we could conclude that the cell type proportions estimated with NNLS, RCTD, <italic toggle="yes">stereoscope</italic> and <italic toggle="yes">cell2location</italic> correlated well with the expected proportions. RCTD and <italic toggle="yes">cell2location</italic> demonstrated the highest accuracy, whereas the NNLS method outperformed all other methods in terms of computational speed. The full performance comparison is available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3.3</xref> and on the <italic toggle="yes">semla</italic> package website.</p>
    </sec>
    <sec>
      <title>3.3 Spatially aware analyses</title>
      <p>To take full advantage of the spatial component in SRT data, computational tools can incorporate a distance or connectivity parameter to model the spatial relationships between spots. We have implemented a set of methods in <italic toggle="yes">semla</italic> to describe spatial relationships and identify new spatial patterns. A set of helper functions are also available for the user to explore and address their own spatially related hypotheses more easily. As an example, we can, in a few steps, split collections of spots into spatially disconnected regions, identify their immediate border zone, or study gene expression changes in an outwards trajectory from the border at different angles (<xref rid="btad626-F1" ref-type="fig">Fig. 1D</xref>).</p>
      <p>A fast implementation for identifying genes with spatial variability is available in <italic toggle="yes">semla</italic>, which builds on the method described by <xref rid="btad626-B2" ref-type="bibr">Bergenstrahle <italic toggle="yes">et al.</italic> (2020)</xref>, is available in <italic toggle="yes">semla</italic> (<xref rid="btad626-F1" ref-type="fig">Fig. 1E</xref>). In short, the method ranks genes based on the Pearson correlation between each gene’s expression vector across spots and the averaged expression vector across the spots’ immediate spatial neighbors. A high correlation score for a gene is associated with a tendency for regions close together in space to have similar values for that gene. In contrast, genes with low scores have more random expression levels in the tissue section, indicating little or no spatial structure. These scores may be used for feature selection to focus downstream analytical tasks on genes that exhibit spatial structure in the data.</p>
      <p>In more unorganized tissues, it may be desirable to statistically describe the spatial relationships of spots assigned with labels. <italic toggle="yes">Semla</italic> includes two approaches for computing spatial statistics of labeled spots: neighborhood enrichment and label assortativity (<xref rid="btad626-F1" ref-type="fig">Fig. 1F</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3.4</xref>). The neighborhood enrichment test describes how often spots of two different categories lie next to each other and vice versa, which is used to identify and quantify co-occurring structures, while the label assortativity test measures the connectivity between spots sharing the same label and can therefore be used to describe whether spots of a given category displays an aggregated or dispersed spatial pattern in the sample.</p>
    </sec>
    <sec>
      <title>3.4 Conclusion</title>
      <p>Here, we have presented <italic toggle="yes">semla</italic>, a versatile R package that delivers tools for Visium SRT data processing, analysis, and visualization. Created to accommodate biologists and bioinformaticians with variable programming skills, <italic toggle="yes">semla</italic> enables interactive examination of expression patterns within a histological context and provides sophisticated techniques for exploratory analysis.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad626_Supplementary_Data</label>
      <media xlink:href="btad626_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We would like to thank Javier Escudero Morlanes and Marcos Machado who tested <italic toggle="yes">semla</italic> and provided valuable input.</p>
  </ack>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>L.L., P.L.S., and J.L. are scientific consultants for 10x Genomics, holding IP rights to the Visium technology. L.F. is an employee at AstraZeneca AB.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Swedish Foundation for Strategic Research (SSF), the European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation programme [101021019]; the Swedish Cancer Society; and the Swedish Research Council.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad626-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andersson</surname><given-names>A</given-names></string-name>, <string-name><surname>Bergenstråhle</surname><given-names>J</given-names></string-name>, <string-name><surname>Asp</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell and spatial transcriptomics enables probabilistic inference of cell type topography</article-title>. <source>Commun Biol</source><year>2020</year>;<volume>3</volume>:<fpage>565</fpage>.<pub-id pub-id-type="pmid">33037292</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bergenstrahle</surname><given-names>J</given-names></string-name>, <string-name><surname>Larsson</surname><given-names>L</given-names></string-name>, <string-name><surname>Lundeberg</surname><given-names>J.</given-names></string-name></person-group><article-title>Seamless integration of image and molecular analysis for spatial transcriptomics workflows</article-title>. <source>BMC Genomics</source><year>2020</year>;<volume>21</volume>:<fpage>482</fpage>.<pub-id pub-id-type="pmid">32664861</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cable</surname><given-names>DM</given-names></string-name>, <string-name><surname>Murray</surname><given-names>E</given-names></string-name>, <string-name><surname>Zou</surname><given-names>LS</given-names></string-name></person-group><etal>et al</etal><article-title>Robust decomposition of cell type mixtures in spatial transcriptomics</article-title>. <source>Nat Biotechnol</source><year>2022</year>;<volume>40</volume>:<fpage>517</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">33603203</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cho</surname><given-names>C-S</given-names></string-name>, <string-name><surname>Xi</surname><given-names>J</given-names></string-name>, <string-name><surname>Si</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Microscopic examination of spatial transcriptome using Seq-scope</article-title>. <source>Cell</source><year>2021</year>;<volume>184</volume>:<fpage>3559</fpage>–<lpage>72.e3522</lpage>.<pub-id pub-id-type="pmid">34115981</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dries</surname><given-names>R</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Dong</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Giotto: a toolbox for integrative analysis and visualization of spatial expression data</article-title>. <source>Genome Biol</source><year>2021</year>;<volume>22</volume>:<fpage>78</fpage>.<pub-id pub-id-type="pmid">33685491</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elosua-Bayes</surname><given-names>M</given-names></string-name>, <string-name><surname>Nieto</surname><given-names>P</given-names></string-name>, <string-name><surname>Mereu</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>SPOTlight: seeded NMF regression to deconvolute spatial transcriptomics spots with single-cell transcriptomes</article-title>. <source>Nucleic Acids Res</source><year>2021</year>;<volume>49</volume>:<fpage>e50</fpage>.<pub-id pub-id-type="pmid">33544846</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fu</surname><given-names>X</given-names></string-name>, <string-name><surname>Sun</surname><given-names>L</given-names></string-name>, <string-name><surname>Dong</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Polony gels enable amplifiable DNA stamping and spatial transcriptomics of chronic pain</article-title>. <source>Cell</source><year>2022</year>;<volume>185</volume>:<fpage>4621</fpage>–<lpage>33.e4617</lpage>.<pub-id pub-id-type="pmid">36368323</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B16">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Inc F, Weststrate</surname><given-names>M</given-names></string-name>, <string-name><surname>Russell</surname><given-names>K</given-names></string-name>, <string-name><surname>Dipert</surname><given-names>A.</given-names></string-name></person-group><italic toggle="yes">reactR: React Helpers</italic>. <year>2021</year>. <ext-link xlink:href="https://github.com/react-R/reactR" ext-link-type="uri">https://github.com/react-R/reactR</ext-link>.</mixed-citation>
    </ref>
    <ref id="btad626-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kleshchevnikov</surname><given-names>V</given-names></string-name>, <string-name><surname>Shmatko</surname><given-names>A</given-names></string-name>, <string-name><surname>Dann</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>Cell2location maps fine-grained cell types in spatial transcriptomics</article-title>. <source>Nat Biotechnol</source><year>2022</year>;<volume>40</volume>:<fpage>661</fpage>–<lpage>71</lpage>.<pub-id pub-id-type="pmid">35027729</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moses</surname><given-names>L</given-names></string-name>, <string-name><surname>Pachter</surname><given-names>L</given-names></string-name></person-group>. <article-title>Museum of spatial transcriptomics</article-title>. <source>Nat Methods</source><year>2022</year>;<volume>19</volume>(<issue>5</issue>):<fpage>534</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">35273392</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Palla</surname><given-names>G</given-names></string-name>, <string-name><surname>Spitzer</surname><given-names>H</given-names></string-name>, <string-name><surname>Klein</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Squidpy: a scalable framework for spatial omics analysis</article-title>. <source>Nat Methods</source><year>2022</year>;<volume>19</volume>:<fpage>171</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">35102346</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pardo</surname><given-names>B</given-names></string-name>, <string-name><surname>Spangler</surname><given-names>A</given-names></string-name>, <string-name><surname>Weber</surname><given-names>LM</given-names></string-name></person-group><etal>et al</etal><article-title>spatialLIBD: an R/Bioconductor package to visualize spatially-resolved transcriptomics data</article-title>. <source>BMC Genomics</source><year>2022</year>;<volume>23</volume>:<fpage>434</fpage>.<pub-id pub-id-type="pmid">35689177</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedersen</surname><given-names>TL.</given-names></string-name></person-group><article-title>Patchwork: the composer of plots</article-title>. <source>R Package Version</source><year>2020</year>;<volume>1</volume>:<fpage>182</fpage>. <ext-link xlink:href="https://patchwork.data-imaginist.com," ext-link-type="uri">https://patchwork.data-imaginist.com,</ext-link><ext-link xlink:href="https://github.com/thomasp85/patchwork" ext-link-type="uri">https://github.com/thomasp85/patchwork</ext-link>.</mixed-citation>
    </ref>
    <ref id="btad626-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Righelli</surname><given-names>D</given-names></string-name>, <string-name><surname>Weber</surname><given-names>LM</given-names></string-name>, <string-name><surname>Crowell</surname><given-names>HL</given-names></string-name></person-group><etal>et al</etal><article-title>SpatialExperiment: infrastructure for spatially-resolved transcriptomics data in R using bioconductor</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>38</volume>:<fpage>3128</fpage>–<lpage>31</lpage>.<pub-id pub-id-type="pmid">35482478</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rodriques</surname><given-names>SG</given-names></string-name>, <string-name><surname>Stickels</surname><given-names>RR</given-names></string-name>, <string-name><surname>Goeva</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Slide-seq: a scalable technology for measuring genome-wide expression at high spatial resolution</article-title>. <source>Science</source><year>2019</year>;<volume>363</volume>:<fpage>1463</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">30923225</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ståhl</surname><given-names>PL</given-names></string-name>, <string-name><surname>Salmén</surname><given-names>F</given-names></string-name>, <string-name><surname>Vickovic</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</article-title>. <source>Science</source><year>2016</year>;<volume>353</volume>:<fpage>78</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">27365449</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stuart</surname><given-names>T</given-names></string-name>, <string-name><surname>Butler</surname><given-names>A</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Comprehensive integration of single-cell data</article-title>. <source>Cell</source><year>2019</year>;<volume>177</volume>:<fpage>1888</fpage>–<lpage>902.e1821</lpage>.<pub-id pub-id-type="pmid">31178118</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickham</surname><given-names>H</given-names></string-name>, <string-name><surname>Averick</surname><given-names>M</given-names></string-name>, <string-name><surname>Bryan</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Welcome to the Tidyverse</article-title>. <source>JOSS</source><year>2019</year>;<volume>4</volume>:<fpage>1686</fpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10597621</article-id>
    <article-id pub-id-type="pmid">37846051</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad626</article-id>
    <article-id pub-id-type="publisher-id">btad626</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic toggle="yes">Semla:</italic> a versatile toolkit for spatially resolved transcriptomics analysis and visualization</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Larsson</surname>
          <given-names>Ludvig</given-names>
        </name>
        <aff><institution>Department of Gene Technology, KTH Royal Institute of Technology, Science for Life Laboratory</institution>, <addr-line>Tomtebodavägen 23, 171 65 Solna</addr-line>, Stockholm, <country country="SE">Sweden</country></aff>
        <xref rid="btad626-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3755-718X</contrib-id>
        <name>
          <surname>Franzén</surname>
          <given-names>Lovisa</given-names>
        </name>
        <aff><institution>Department of Gene Technology, KTH Royal Institute of Technology, Science for Life Laboratory</institution>, <addr-line>Tomtebodavägen 23, 171 65 Solna</addr-line>, Stockholm, <country country="SE">Sweden</country></aff>
        <aff><institution>Respiratory &amp; Immunology, Neuroscience, Vaccines &amp; Immune Therapies Safety, Clinical Pharmacology &amp; Safety Sciences, BioPharmaceuticals R&amp;D, AstraZeneca</institution>, <addr-line>Pepparedsleden 1, 431 83 Mölndal</addr-line>, Gothenburg, <country country="SE">Sweden</country></aff>
        <xref rid="btad626-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ståhl</surname>
          <given-names>Patrik L</given-names>
        </name>
        <aff><institution>Department of Gene Technology, KTH Royal Institute of Technology, Science for Life Laboratory</institution>, <addr-line>Tomtebodavägen 23, 171 65 Solna</addr-line>, Stockholm, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4313-1601</contrib-id>
        <name>
          <surname>Lundeberg</surname>
          <given-names>Joakim</given-names>
        </name>
        <aff><institution>Department of Gene Technology, KTH Royal Institute of Technology, Science for Life Laboratory</institution>, <addr-line>Tomtebodavägen 23, 171 65 Solna</addr-line>, Stockholm, <country country="SE">Sweden</country></aff>
        <xref rid="btad626-cor1" ref-type="corresp"/>
        <!--joakim.lundeberg@scilifelab.se-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Nikolski</surname>
          <given-names>Macha</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad626-cor1">Corresponding author. Department of Gene Technology, KTH Royal Institute of Technology, Science for Life Laboratory, Tomtebodavägen 23, 171 65 Solna, Stockholm, Sweden. E-mail: <email>joakim.lundeberg@scilifelab.se</email></corresp>
      <fn id="btad626-FM1">
        <p>Ludvig Larsson and Lovisa Franzén done Equal contribution.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-10-16">
      <day>16</day>
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>10</issue>
    <elocation-id>btad626</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>20</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>10</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>24</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad626.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Spatially resolved transcriptomics technologies generate gene expression data with retained positional information from a tissue section, often accompanied by a corresponding histological image. Computational tools should make it effortless to incorporate spatial information into data analyses and present analysis results in their histological context. Here, we present <italic toggle="yes">semla</italic>, an R package for processing, analysis, and visualization of spatially resolved transcriptomics data generated by the Visium platform, that includes interactive web applications for data exploration and tissue annotation.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The R package <italic toggle="yes">semla</italic> is available on GitHub (<ext-link xlink:href="https://github.com/ludvigla/semla" ext-link-type="uri">https://github.com/ludvigla/semla</ext-link>), under the MIT License, and deposited on Zenodo (<ext-link xlink:href="https://doi.org/10.5281/zenodo.8321645" ext-link-type="uri">https://doi.org/10.5281/zenodo.8321645</ext-link>). Documentation and tutorials with detailed descriptions of usage can be found at <ext-link xlink:href="https://ludvigla.github.io/semla/" ext-link-type="uri">https://ludvigla.github.io/semla/</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swedish Foundation for Strategic Research</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001729</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/100010663</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Union’s Horizon 2020</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swedish Cancer Society</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002794</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swedish Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004359</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The rise of new transcriptomics technologies has enabled the exploration of genome-wide expression profiles in tissues. Spatially resolved transcriptomics (SRT) methods facilitate quantification of gene expression levels in tissue sections while preserving positional information. SRT thus allows researchers to analyze cellular and biological processes in the context of their tissue microenvironment. Several SRT technologies have emerged, offering different resolutions, sample sizes, sample throughput, transcriptome coverage, and sensitivity (<xref rid="btad626-B14" ref-type="bibr">Ståhl <italic toggle="yes">et al.</italic> 2016</xref>, <xref rid="btad626-B13" ref-type="bibr">Rodriques <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad626-B4" ref-type="bibr">Cho <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad626-B7" ref-type="bibr">Fu <italic toggle="yes">et al.</italic> 2022</xref>). In recent years, commercialization of SRT technologies has further improved their accessibility and ease of use, increasing the number of publicly available SRT datasets. With a constantly growing number of SRT datasets, there is an increasing need for accessible computational tools that facilitate efficient exploration, visualization, and analysis.</p>
    <p>Visium, an SRT technology from 10x Genomics which to date is the most widely used SRT method (<xref rid="btad626-B18" ref-type="bibr">Moses <italic toggle="yes">et al.</italic> 2022</xref>), enables genome-wide transcriptome profiling of tissue sections with an area up to 11×11 mm<sup>2</sup> (Visium Spatial Gene Expression, 10x Genomics). The spatial resolution is determined by the size of individual capture elements known as “spots,” each measuring 55 µm in diameter. A bright field image is taken of the tissue’s histological features, and by mapping gene expression levels onto the image, it adds morphological information that can be used to guide downstream analyses. Consequently, computational frameworks dealing with Visium data should facilitate seamless integration of the two data modalities. Several applications and libraries are available for analysis and exploration of Visium data (<xref rid="btad626-B15" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad626-B2" ref-type="bibr">Bergenstrahle <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad626-B5" ref-type="bibr">Dries <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad626-B9" ref-type="bibr">Palla <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btad626-B10" ref-type="bibr">Pardo <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btad626-B12" ref-type="bibr">Righelli <italic toggle="yes">et al.</italic> 2022</xref>), where the <italic toggle="yes">Seurat</italic> R package is one of the most popular. Seurat provides the infrastructure to handle single-cell transcriptomics and SRT data and includes a versatile toolbox of computational methods for analytical tasks. Owing to its popularity, several analysis methods have therefore been built to be compatible specifically with <italic toggle="yes">Seurat</italic> objects, broadening the scope of Seurat based analysis workflows. <italic toggle="yes">Seurat</italic> provides core functionalities for handling data from a variety of SRT platforms as of version 3.2 and their latest releases. However, the availability of effective interactive features and spatially aware analysis tools for Visium data are still limited. To bridge some of the current gaps, we provide a new R package that extends the <italic toggle="yes">Seurat</italic> toolbox for spatial analyses. Our package delivers extra Visium data processing tools for users with variable programming expertise, featuring well-documented and interactive components to simplify the analytical process.</p>
  </sec>
  <sec>
    <title>2 Implementation and description</title>
    <p>We have developed <italic toggle="yes">semla</italic>, a toolbox for data processing, exploration, analysis, and visualization of spatial gene expression patterns in tissues. <italic toggle="yes">Semla</italic> is written in the R programming language (≥v.4.1) and takes advantage of the <italic toggle="yes">tidyverse</italic> (<xref rid="btad626-B17" ref-type="bibr">Wickham <italic toggle="yes">et al.</italic> 2019</xref>) framework for data handling and the <italic toggle="yes">patchwork</italic> (<xref rid="btad626-B11" ref-type="bibr">Pedersen 2020</xref>) framework for customizable visualization to produce publication-ready figures. In addition, the package utilizes the basic data structure and features of <italic toggle="yes">Seurat</italic>, allowing users to employ well-known functions for data processing and visualization. The core of the analysis and visualization methods provided in <italic toggle="yes">semla</italic> is built upon an easily accessible S4 object intended for storing spatial and image data.</p>
    <p>As input, <italic toggle="yes">semla</italic> requires data generated with the Visium Gene Expression profiling platform, including expression matrices, histological images, and spot coordinate files produced with the 10x Genomics Space Ranger pipeline (<xref rid="btad626-F1" ref-type="fig">Fig. 1A</xref>). Although <italic toggle="yes">semla</italic> is a Visium-centric toolkit in its current state, the framework is designed to allow for future support to load any spatial dataset represented by a feature × spot matrix and spot coordinates. <italic toggle="yes">Semla</italic> simplifies the task of combining and processing data from various tissue sections taken from different Visium capture areas. Users have the option to initiate web-based applications that facilitate interactive investigation and annotation of the data. This is especially handy when working with consecutive tissue sections that vary in sample positioning and orientation. An assortment of functions is available in <italic toggle="yes">semla</italic> to perform quality control, data processing, advanced spatial visualizations, cell type deconvolution, digital unrolling, and spatially aware analyses. Further descriptions of a selection of functions can be found in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Information</xref> document and all documentation of the utilities available within <italic toggle="yes">semla</italic> is available at the package website (<ext-link xlink:href="https://ludvigla.github.io/semla/" ext-link-type="uri">https://ludvigla.github.io/semla/</ext-link>), along with detailed tutorials which describe how these tools can be applied to real examples.</p>
    <fig position="float" id="btad626-F1">
      <label>Figure 1.</label>
      <caption>
        <p>(A) The input for the <italic toggle="yes">semla</italic> R package consists of transcriptomics data and a matched histological image as generated by the Visium protocol and data processing pipeline. (B) A web application (“Feature Viewer”) can be opened through the R console and enables interactive exploration and annotation of the spatial expression data. Within <italic toggle="yes">semla</italic>, the user can apply various analyses to the data such as (C) cell type mapping using a matching single-cell RNA sequencing (scRNA-seq) dataset, (D) exploring gene expression along a radial distance from a defined region of interest, (E) detect spatially correlated genes across the entire sample, and (F) apply spatial statistics to describe spot label patterns.</p>
      </caption>
      <graphic xlink:href="btad626f1" position="float"/>
    </fig>
    <p>The package is available for installation through GitHub, <ext-link xlink:href="https://github.com/ludvigla/semla" ext-link-type="uri">https://github.com/ludvigla/semla</ext-link>.</p>
  </sec>
  <sec>
    <title>3 Highlighted features</title>
    <sec>
      <title>3.1 Interactive viewer</title>
      <p>R is a popular programming language for SRT data analysis and offers a rich ecosystem of libraries to process and analyze data; however, interactive features are limited. For specific SRT analytical tasks, it is desirable to explore the data interactively and annotate spatial data in conjunction with the histological tissue image. A few alternative applications are available for this purpose (e.g. the Loupe Browser and spatialLIBD), though they are limited in their ability to seamlessly be integrated in the full analytical workflow. To address these needs, we have built an integrated web-based application within <italic toggle="yes">semla</italic> that facilitates interactive mapping of expression profiles and tissue annotations visualized onto the histological image of the tissue section (<xref rid="btad626-F1" ref-type="fig">Fig. 1B</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3.1</xref>). The interactive viewer is written in javascript using the popular UI library React, incorporated in <italic toggle="yes">semla</italic> using the <italic toggle="yes">reactR</italic> R package (<xref rid="btad626-B16" ref-type="bibr">Inc <italic toggle="yes">et al.</italic> 2021</xref>). The application is initiated within the R session and thereafter opens a web browser where it runs effortlessly when moving and zooming across the tissue image, facilitated by image tiling which is powered by the javascript-based web viewer OpenSeadragon. All numerical variables residing within the <italic toggle="yes">Seurat</italic> object, including gene expression values or dimensionality reduction vectors, are accessible for mapping on the tissue sections. Moreover, the viewer includes a lasso tool, with which users can select data points based on tissue morphology or feature expression and label these selections for downstream analysis.</p>
    </sec>
    <sec>
      <title>3.2 Cell type mapping with NNLS</title>
      <p>In Visium, the measured transcription profile in each spot typically represents mixed signals from multiple cells. Computational methods have been developed to deconvolve mixed expression profiles to predict the cell type composition (<xref rid="btad626-B1" ref-type="bibr">Andersson <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad626-B6" ref-type="bibr">Elosua-Bayes <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad626-B3" ref-type="bibr">Cable <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btad626-B8" ref-type="bibr">Kleshchevnikov <italic toggle="yes">et al.</italic> 2022</xref>). Many of these methods require high performance computers and may take hours to run on moderately large datasets. <italic toggle="yes">Semla</italic> includes an approach for cell type deconvolution based on Non-Negative Least Squares (NNLS), which runs in a matter of seconds on Visium data with up to 100 000 spots (<xref rid="btad626-F1" ref-type="fig">Fig. 1C</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3.2</xref>). In short, the first step is to estimate cell type enrichment scores by comparing the ratios of averaged gene expression levels between a cell type of interest and the other cell types in the scRNA-seq data. These scores describe relative differences in expression levels between the cell types and are subsequently leveraged into the NNLS method to estimate the proportions of cell types in each Visium spot. The enrichment scores for each cell type are combined into a matrix <bold>A</bold>. Given the matrix <bold>A</bold> and a mixed expression profile <bold>y</bold> for a Visium spot, the NNLS method solves the following problem:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">arg</mml:mi><mml:mo> </mml:mo><mml:mi mathvariant="italic">min</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:mi>A</mml:mi><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">subject</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">to</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi>x</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:math></disp-formula>where the solution for <bold>x</bold> represents the fractional abundances of cell types in the mixed expression profile. As a final step, the values for <bold>x</bold> are converted into cell type proportions. To assess the performance of our deconvolution method, we benchmarked NNLS against four other methods: RCTD, <italic toggle="yes">stereoscope</italic>, <italic toggle="yes">cell2location</italic>, and Seurat label transfer. Based on our benchmark results, we could conclude that the cell type proportions estimated with NNLS, RCTD, <italic toggle="yes">stereoscope</italic> and <italic toggle="yes">cell2location</italic> correlated well with the expected proportions. RCTD and <italic toggle="yes">cell2location</italic> demonstrated the highest accuracy, whereas the NNLS method outperformed all other methods in terms of computational speed. The full performance comparison is available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3.3</xref> and on the <italic toggle="yes">semla</italic> package website.</p>
    </sec>
    <sec>
      <title>3.3 Spatially aware analyses</title>
      <p>To take full advantage of the spatial component in SRT data, computational tools can incorporate a distance or connectivity parameter to model the spatial relationships between spots. We have implemented a set of methods in <italic toggle="yes">semla</italic> to describe spatial relationships and identify new spatial patterns. A set of helper functions are also available for the user to explore and address their own spatially related hypotheses more easily. As an example, we can, in a few steps, split collections of spots into spatially disconnected regions, identify their immediate border zone, or study gene expression changes in an outwards trajectory from the border at different angles (<xref rid="btad626-F1" ref-type="fig">Fig. 1D</xref>).</p>
      <p>A fast implementation for identifying genes with spatial variability is available in <italic toggle="yes">semla</italic>, which builds on the method described by <xref rid="btad626-B2" ref-type="bibr">Bergenstrahle <italic toggle="yes">et al.</italic> (2020)</xref>, is available in <italic toggle="yes">semla</italic> (<xref rid="btad626-F1" ref-type="fig">Fig. 1E</xref>). In short, the method ranks genes based on the Pearson correlation between each gene’s expression vector across spots and the averaged expression vector across the spots’ immediate spatial neighbors. A high correlation score for a gene is associated with a tendency for regions close together in space to have similar values for that gene. In contrast, genes with low scores have more random expression levels in the tissue section, indicating little or no spatial structure. These scores may be used for feature selection to focus downstream analytical tasks on genes that exhibit spatial structure in the data.</p>
      <p>In more unorganized tissues, it may be desirable to statistically describe the spatial relationships of spots assigned with labels. <italic toggle="yes">Semla</italic> includes two approaches for computing spatial statistics of labeled spots: neighborhood enrichment and label assortativity (<xref rid="btad626-F1" ref-type="fig">Fig. 1F</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3.4</xref>). The neighborhood enrichment test describes how often spots of two different categories lie next to each other and vice versa, which is used to identify and quantify co-occurring structures, while the label assortativity test measures the connectivity between spots sharing the same label and can therefore be used to describe whether spots of a given category displays an aggregated or dispersed spatial pattern in the sample.</p>
    </sec>
    <sec>
      <title>3.4 Conclusion</title>
      <p>Here, we have presented <italic toggle="yes">semla</italic>, a versatile R package that delivers tools for Visium SRT data processing, analysis, and visualization. Created to accommodate biologists and bioinformaticians with variable programming skills, <italic toggle="yes">semla</italic> enables interactive examination of expression patterns within a histological context and provides sophisticated techniques for exploratory analysis.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad626_Supplementary_Data</label>
      <media xlink:href="btad626_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We would like to thank Javier Escudero Morlanes and Marcos Machado who tested <italic toggle="yes">semla</italic> and provided valuable input.</p>
  </ack>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>L.L., P.L.S., and J.L. are scientific consultants for 10x Genomics, holding IP rights to the Visium technology. L.F. is an employee at AstraZeneca AB.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Swedish Foundation for Strategic Research (SSF), the European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation programme [101021019]; the Swedish Cancer Society; and the Swedish Research Council.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad626-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andersson</surname><given-names>A</given-names></string-name>, <string-name><surname>Bergenstråhle</surname><given-names>J</given-names></string-name>, <string-name><surname>Asp</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell and spatial transcriptomics enables probabilistic inference of cell type topography</article-title>. <source>Commun Biol</source><year>2020</year>;<volume>3</volume>:<fpage>565</fpage>.<pub-id pub-id-type="pmid">33037292</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bergenstrahle</surname><given-names>J</given-names></string-name>, <string-name><surname>Larsson</surname><given-names>L</given-names></string-name>, <string-name><surname>Lundeberg</surname><given-names>J.</given-names></string-name></person-group><article-title>Seamless integration of image and molecular analysis for spatial transcriptomics workflows</article-title>. <source>BMC Genomics</source><year>2020</year>;<volume>21</volume>:<fpage>482</fpage>.<pub-id pub-id-type="pmid">32664861</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cable</surname><given-names>DM</given-names></string-name>, <string-name><surname>Murray</surname><given-names>E</given-names></string-name>, <string-name><surname>Zou</surname><given-names>LS</given-names></string-name></person-group><etal>et al</etal><article-title>Robust decomposition of cell type mixtures in spatial transcriptomics</article-title>. <source>Nat Biotechnol</source><year>2022</year>;<volume>40</volume>:<fpage>517</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">33603203</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cho</surname><given-names>C-S</given-names></string-name>, <string-name><surname>Xi</surname><given-names>J</given-names></string-name>, <string-name><surname>Si</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Microscopic examination of spatial transcriptome using Seq-scope</article-title>. <source>Cell</source><year>2021</year>;<volume>184</volume>:<fpage>3559</fpage>–<lpage>72.e3522</lpage>.<pub-id pub-id-type="pmid">34115981</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dries</surname><given-names>R</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Dong</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Giotto: a toolbox for integrative analysis and visualization of spatial expression data</article-title>. <source>Genome Biol</source><year>2021</year>;<volume>22</volume>:<fpage>78</fpage>.<pub-id pub-id-type="pmid">33685491</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elosua-Bayes</surname><given-names>M</given-names></string-name>, <string-name><surname>Nieto</surname><given-names>P</given-names></string-name>, <string-name><surname>Mereu</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>SPOTlight: seeded NMF regression to deconvolute spatial transcriptomics spots with single-cell transcriptomes</article-title>. <source>Nucleic Acids Res</source><year>2021</year>;<volume>49</volume>:<fpage>e50</fpage>.<pub-id pub-id-type="pmid">33544846</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fu</surname><given-names>X</given-names></string-name>, <string-name><surname>Sun</surname><given-names>L</given-names></string-name>, <string-name><surname>Dong</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Polony gels enable amplifiable DNA stamping and spatial transcriptomics of chronic pain</article-title>. <source>Cell</source><year>2022</year>;<volume>185</volume>:<fpage>4621</fpage>–<lpage>33.e4617</lpage>.<pub-id pub-id-type="pmid">36368323</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B16">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Inc F, Weststrate</surname><given-names>M</given-names></string-name>, <string-name><surname>Russell</surname><given-names>K</given-names></string-name>, <string-name><surname>Dipert</surname><given-names>A.</given-names></string-name></person-group><italic toggle="yes">reactR: React Helpers</italic>. <year>2021</year>. <ext-link xlink:href="https://github.com/react-R/reactR" ext-link-type="uri">https://github.com/react-R/reactR</ext-link>.</mixed-citation>
    </ref>
    <ref id="btad626-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kleshchevnikov</surname><given-names>V</given-names></string-name>, <string-name><surname>Shmatko</surname><given-names>A</given-names></string-name>, <string-name><surname>Dann</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>Cell2location maps fine-grained cell types in spatial transcriptomics</article-title>. <source>Nat Biotechnol</source><year>2022</year>;<volume>40</volume>:<fpage>661</fpage>–<lpage>71</lpage>.<pub-id pub-id-type="pmid">35027729</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moses</surname><given-names>L</given-names></string-name>, <string-name><surname>Pachter</surname><given-names>L</given-names></string-name></person-group>. <article-title>Museum of spatial transcriptomics</article-title>. <source>Nat Methods</source><year>2022</year>;<volume>19</volume>(<issue>5</issue>):<fpage>534</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">35273392</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Palla</surname><given-names>G</given-names></string-name>, <string-name><surname>Spitzer</surname><given-names>H</given-names></string-name>, <string-name><surname>Klein</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Squidpy: a scalable framework for spatial omics analysis</article-title>. <source>Nat Methods</source><year>2022</year>;<volume>19</volume>:<fpage>171</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">35102346</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pardo</surname><given-names>B</given-names></string-name>, <string-name><surname>Spangler</surname><given-names>A</given-names></string-name>, <string-name><surname>Weber</surname><given-names>LM</given-names></string-name></person-group><etal>et al</etal><article-title>spatialLIBD: an R/Bioconductor package to visualize spatially-resolved transcriptomics data</article-title>. <source>BMC Genomics</source><year>2022</year>;<volume>23</volume>:<fpage>434</fpage>.<pub-id pub-id-type="pmid">35689177</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedersen</surname><given-names>TL.</given-names></string-name></person-group><article-title>Patchwork: the composer of plots</article-title>. <source>R Package Version</source><year>2020</year>;<volume>1</volume>:<fpage>182</fpage>. <ext-link xlink:href="https://patchwork.data-imaginist.com," ext-link-type="uri">https://patchwork.data-imaginist.com,</ext-link><ext-link xlink:href="https://github.com/thomasp85/patchwork" ext-link-type="uri">https://github.com/thomasp85/patchwork</ext-link>.</mixed-citation>
    </ref>
    <ref id="btad626-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Righelli</surname><given-names>D</given-names></string-name>, <string-name><surname>Weber</surname><given-names>LM</given-names></string-name>, <string-name><surname>Crowell</surname><given-names>HL</given-names></string-name></person-group><etal>et al</etal><article-title>SpatialExperiment: infrastructure for spatially-resolved transcriptomics data in R using bioconductor</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>38</volume>:<fpage>3128</fpage>–<lpage>31</lpage>.<pub-id pub-id-type="pmid">35482478</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rodriques</surname><given-names>SG</given-names></string-name>, <string-name><surname>Stickels</surname><given-names>RR</given-names></string-name>, <string-name><surname>Goeva</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Slide-seq: a scalable technology for measuring genome-wide expression at high spatial resolution</article-title>. <source>Science</source><year>2019</year>;<volume>363</volume>:<fpage>1463</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">30923225</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ståhl</surname><given-names>PL</given-names></string-name>, <string-name><surname>Salmén</surname><given-names>F</given-names></string-name>, <string-name><surname>Vickovic</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</article-title>. <source>Science</source><year>2016</year>;<volume>353</volume>:<fpage>78</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">27365449</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stuart</surname><given-names>T</given-names></string-name>, <string-name><surname>Butler</surname><given-names>A</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Comprehensive integration of single-cell data</article-title>. <source>Cell</source><year>2019</year>;<volume>177</volume>:<fpage>1888</fpage>–<lpage>902.e1821</lpage>.<pub-id pub-id-type="pmid">31178118</pub-id></mixed-citation>
    </ref>
    <ref id="btad626-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickham</surname><given-names>H</given-names></string-name>, <string-name><surname>Averick</surname><given-names>M</given-names></string-name>, <string-name><surname>Bryan</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Welcome to the Tidyverse</article-title>. <source>JOSS</source><year>2019</year>;<volume>4</volume>:<fpage>1686</fpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
