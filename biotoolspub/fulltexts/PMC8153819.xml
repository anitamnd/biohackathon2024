<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">nargab</journal-id>
    <journal-title-group>
      <journal-title>NAR Genomics and Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2631-9268</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8153819</article-id>
    <article-id pub-id-type="pmid">34056597</article-id>
    <article-id pub-id-type="doi">10.1093/nargab/lqab047</article-id>
    <article-id pub-id-type="publisher-id">lqab047</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00030</subject>
        <subject>AcademicSubjects/SCI00980</subject>
        <subject>AcademicSubjects/SCI01060</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI01180</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Standard Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GeneMark-HM: improving gene prediction in DNA sequences of human microbiome</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lomsadze</surname>
          <given-names>Alexandre</given-names>
        </name>
        <aff><institution>Gene Probe, Inc.</institution>, 1106 Wrights Mill Ct, Atlanta, GA 30324, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bonny</surname>
          <given-names>Christophe</given-names>
        </name>
        <aff><institution>Enterome</institution>, 94/96 avenue Ledru-Rollin, 75011 Paris, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Strozzi</surname>
          <given-names>Francesco</given-names>
        </name>
        <aff><institution>Enterome</institution>, 94/96 avenue Ledru-Rollin, 75011 Paris, <country country="FR">France</country></aff>
        <xref rid="FN1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1401-4046</contrib-id>
        <name>
          <surname>Borodovsky</surname>
          <given-names>Mark</given-names>
        </name>
        <!--borodovsky@gatech.edu-->
        <aff><institution>Gene Probe, Inc.</institution>, 1106 Wrights Mill Ct, Atlanta, GA 30324, <country country="US">USA</country></aff>
        <aff><institution>Wallace H. Coulter Department of Biomedical Engineering</institution>, Atlanta, GA 30332, <country country="US">USA</country></aff>
        <aff><institution>School of Computational Science and Engineering, Georgia Tech</institution>, Atlanta, GA 30332, <country country="US">USA</country></aff>
        <xref rid="COR1" ref-type="corresp"/>
        <xref rid="FN1" ref-type="author-notes"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +1 404 667 8183; Email: <email>borodovsky@gatech.edu</email></corresp>
      <fn id="FN1">
        <p>The authors wish it to be known that, in their opinion, the last two authors should be regarded as Joint Senior Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-05-26">
      <day>26</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <volume>3</volume>
    <issue>2</issue>
    <elocation-id>lqab047</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>11</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>5</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press on behalf of NAR Genomics and Bioinformatics.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact <email>journals.permissions@oup.com</email></license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="lqab047.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Computational reconstruction of nearly complete genomes from metagenomic reads may identify thousands of new uncultured candidate bacterial species. We have shown that reconstructed prokaryotic genomes along with genomes of sequenced microbial isolates can be used to support more accurate gene prediction in novel <italic toggle="yes">metagenomic</italic> sequences. We have proposed an approach that used three types of gene prediction algorithms and found for all contigs in a metagenome nearly optimal models of protein-coding regions either in libraries of pre-computed models or constructed de novo. The model selection process and gene annotation were done by the new GeneMark-HM pipeline. We have created a database of the species level pan-genomes for the human microbiome. To create a library of models representing each pan-genome we used a self-training algorithm GeneMarkS-2. Genes initially predicted in each contig served as queries for a fast similarity search through the pan-genome database. The best matches led to selection of the model for gene prediction. Contigs not assigned to pan-genomes were analyzed by crude, but still accurate models designed for sequences with particular GC compositions. Tests of GeneMark-HM on simulated metagenomes demonstrated improvement in gene annotation of human metagenomic sequences in comparison with the current state-of-the-art gene prediction tools.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Gene Probe, Inc. Atlanta, USA</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>In recent years a number of sequenced microbial isolates has increased significantly; &gt;310 000 annotated prokaryotic genomes, with the total length ∼1 Tb nt, were listed in GenBank as of February 2021 (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.ncbi.nlm.nih.gov/genome/browse#!/prokaryotes" ext-link-type="uri">www.ncbi.nlm.nih.gov/genome/browse#!/prokaryotes</ext-link>). The number of metagenomes with assembled contigs in the WGS section of GenBank has already reached above 75 000, with the total length of nucleotide sequences exceeding ∼2.1 Tb nt (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.ncbi.nlm.nih.gov/Traces/wgs/?search=metagenome" ext-link-type="uri">www.ncbi.nlm.nih.gov/Traces/wgs/?search=metagenome</ext-link>). Recent improvements in sequencing technology and assembly methods have led to increase in the average length of metagenomic contigs (<xref rid="B1" ref-type="bibr">1</xref>). Still, a vast majority of them are not long enough to allow for estimation of parameters of the ‘contig-specific’ high order model with precision typical for the algorithms trained on complete or nearly complete prokaryotic genomes (<xref rid="B2" ref-type="bibr">2–5</xref>). Therefore, in gene finders working with short sequences with unknown genomic context special methods for finding effective model parameters have to compensate the lack of information. Several algorithms for gene prediction in metagenomic sequences have been developed: (<xref rid="B6" ref-type="bibr">6–10</xref>). Also, recently developed methods of reconstruction of nearly complete genomes from metagenomic datasets added to the picture thousands of genomes of uncultured candidate bacterial species.</p>
    <p>The goal of development of the GeneMark-HM pipeline (HM stands for human microbiome) was to improve accuracy of gene prediction in metagenomic contigs, those originated from a shotgun sequencing of human microbiome (<xref rid="B11" ref-type="bibr">11</xref>,<xref rid="B12" ref-type="bibr">12</xref>), up to a level achievable by gene finding algorithms trained on complete prokaryotic genomes.</p>
    <p>Importantly, genomes of sequenced isolates and reconstructed prokaryotic genomes could be used to support more accurate gene prediction in novel metagenomes. The main idea is as follows. Many metagenomic contigs may belong to organisms whose very close relatives have sequenced or nearly sequenced genomes. Still, many other contigs may belong to organisms distant from any known species. We argue that nearly optimal models of protein-coding regions could be determined for annotation of a vast majority of contigs in a metagenome. The solution of the annotation problem is implemented in GeneMark-HM, a pipeline for metagenomic contigs originated from human microbiome. The pipeline is using three gene prediction algorithms along with two reference databases (Figure <xref rid="F1" ref-type="fig">1</xref>).</p>
    <fig position="float" id="F1">
      <label>Figure 1.</label>
      <caption>
        <p>Principal flowchart of the GeneMark-HM pipeline.</p>
      </caption>
      <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="lqab047fig1" position="float"/>
    </fig>
    <p>The pipeline components are (i) the newest version of MetaGeneMark, an algorithm using GC content specific models of protein-coding regions (<xref rid="B6" ref-type="bibr">6</xref>,<xref rid="B5" ref-type="bibr">5</xref>,<xref rid="B10" ref-type="bibr">10</xref>). This tool was designed for analysis of anonymous sequence fragments of arbitrary length, even as short as 400nt; (ii) GeneMarkS-2 (<xref rid="B5" ref-type="bibr">5</xref>) a self-training algorithm for gene prediction in sufficiently long sequences, up to complete genomes; (iii) GeneMark.hmm-2, an efficient algorithm that requires a model defined externally or by self-training. GeneMark.hmm-2 is an indispensable part of GeneMarkS-2 and the newest version of MetaGeneMark; (iv) a database of pan-genomes of the human microbiome; (v) a database of pan-genome specific models of protein-coding regions; the models are pre-computed by running GeneMarkS-2 on a <italic toggle="yes">representative</italic> genome of each pan-genome. The GeneMark.hmm-2 algorithm was described in the GeneMarkS-2 publication (<xref rid="B5" ref-type="bibr">5</xref>).</p>
    <p>All contigs in a metagenome are effectively divided into three groups: (i) contigs that can be analyzed by GeneMark-hmm-2 with models from genomes of close relatives, (ii) contigs with no close relatives with sequenced genomes which are sufficiently long to run self-training GeneMarkS-2 and (iii) short anonymous contigs analyzed by MetaGeneMark with pre-computed GC specific models.</p>
    <p>The database of the species level pan-genomes was built in the gene space, a non-redundant representation of the entire set of genes of a set of strains of the same species (<xref rid="B13" ref-type="bibr">13</xref>). To create a database of <italic toggle="yes">representative</italic> models for the pan-genomes we used the self-training GeneMarkS-2 running on a representative genome of a clade. The genes initially predicted in each metagenomic contig were used for a fast similarity search against the database of genes of pan-genomes. The top hits, if the similarity existed, were used to identify a model for GeneMark.hmm-2 that would make more precise gene predictions. Otherwise, depending on a length of the contig, the GeneMarkS-2 or MetaGeneMark were the right tools to have genes predicted in the anonymous contig (Figure <xref rid="F1" ref-type="fig">1</xref>).</p>
    <p>Testing of GeneMark-HM on simulated metagenomes demonstrated improvement in accuracy of gene annotation in metagenomic sequences from human microbiome in comparison with the current state-of-the-art gene prediction tools.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>Sequence data</title>
      <p>Recently as many as 154 723 genomes of prokaryotic species were reconstructed from sequence reads of human metagenomes (<xref rid="B14" ref-type="bibr">14</xref>). These genomes, called rGenomes (or MAGs, metagenome assembled genomes), were clustered into 4930 species-level genome bins (SGBs). Almost 2000 SGBs in this collection contained a single rGenome (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref> shows a frequency histogram of the number of rGenomes per SGB). Notably, the rGenomes are fairly fragmented, e.g. contigs under 10,000 nt account for 27% of total volume of rGenomes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>). <italic toggle="yes">Representative</italic> rGenomes selected for each SGB in (<xref rid="B14" ref-type="bibr">14</xref>), normally the largest in length, varied in total length and GC content (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref>). For 23% of SGBs, it was observed that a sequenced genome of a prokaryotic species could be found within less than 5% ANI (average nucleotide identity) distance from one of the rGenomes in the SGB. Thus, such SGBs are called ‘known SGBs’, [kSGBs]. Remaining 77% or 3796 SGBs were deemed to be genome bins of strains of new species and were named ‘unknown SGBs’ [uSGBs] (<xref rid="B14" ref-type="bibr">14</xref>).</p>
      <p>Besides the use of SGB rGenomes, we retrieved from the NCBI database genomes of those bacterial and archaeal species that were reported to inhabit human guts (<xref rid="B15" ref-type="bibr">15–20</xref>,<xref rid="B12" ref-type="bibr">12</xref>,<xref rid="B21" ref-type="bibr">21</xref>,<xref rid="B22" ref-type="bibr">22</xref>). We grouped genomes of strains having the same Taxa ID into six archaeal and 695 bacterial genome clusters (tClusters). Annotation of the <italic toggle="yes">representative</italic> genomes of these 701 tClusters (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref>) was available in RefSeq (<xref rid="B23" ref-type="bibr">23</xref>). The tClusters and the SGBs could overlap. Merging of the tClusters and the SGBs produced 4930 updated SGBs along with 152 tClusters that did not overlap any of the SGBs (see Supplementary Materials). We argue that after such merging the genomes of strains of a single prokaryotic species would be contained in a single updated SGB or in a single tCluster.</p>
    </sec>
    <sec id="SEC2-2">
      <title>Construction of species level pan-genomes</title>
      <p>Each pan-genome was built in the gene space. A pan-genome represented gene sequences from all the genomes from a particular tCluster or SGB. The purpose of making pan-genomes was the reduction of a reference database of gene sequences. The procedure was implemented as follows. In each SGB (tCluster), all the genome sequences were processed by GeneMark.hmm-2 to predict genes. In this analysis one and the same model of protein-coding region, the SGB (tCluster) specific model was used (see below).</p>
      <p>The initial set of gene sequences for the pan-genome of an SGB (tCluster) was a whole complement of genes predicted in the SGB (tCluster) <italic toggle="yes">representative genome</italic> (Figure <xref rid="F2" ref-type="fig">2</xref>). Then the construction process continued by taking one gene set after another in order of diminishing length of the rGenomes (genomes) from a given SGB (tCluster). To decide which genes from a particular gene set should be added to the growing pan-genome, the sequences of genes were used as queries in the BLASTn search against the current set of the pan-genome genes. The search was run in the fast MegaBLAST mode (<xref rid="B24" ref-type="bibr">24</xref>). If a given query and its highest scoring target in a pan-genome had an average nucleotide identity (ANI) above 95% (<xref rid="B25" ref-type="bibr">25</xref>), along with &gt;90% coverage of the query in the pairwise alignment, then the query gene was deemed to be a close homologue of the target and was not added to the pan-genome. Otherwise, the query was added to the pan-genome as an entry increasing the pan-genome diversity. The process continued until all the genes in all the rGenomes (genomes) were screened. The pan-genome building procedure was repeated for all the SGBs and tClusters. To limit the size of a pan-genome for a given SGB (tCluster) without a noticeable loss of sensitivity in a downstream analysis, only gene sets from the 150 longest rGenomes (genomes) were used in the pan-genome construction. As it was expected, the number of genes in a pan-genome was significantly smaller than the total number of genes predicted in the original rGenomes (genomes) of the SGBs (tClusters).</p>
      <fig position="float" id="F2">
        <label>Figure 2.</label>
        <caption>
          <p>A species level pan-genome construction in gene space.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="lqab047fig2" position="float"/>
      </fig>
      <p>For gene prediction in human metagenomes, we created a 5082 species level reference pan-genomes.</p>
    </sec>
    <sec id="SEC2-3">
      <title>Models of protein-coding regions and regulatory signals</title>
      <p>A <italic toggle="yes">species specific</italic> model of a protein-coding region, formalized as an inhomogeneous Markov chain of an order k (<xref rid="B26" ref-type="bibr">26</xref>), is a key component of <italic toggle="yes">ab initio</italic> gene finding algorithms for prokaryotic and eukaryotic genomes (<xref rid="B27" ref-type="bibr">27</xref>,<xref rid="B5" ref-type="bibr">5</xref>,<xref rid="B28" ref-type="bibr">28</xref>). The transition probability values, the model parameters, are derived from the three phase positional frequencies of occurrences of nucleotide (<italic toggle="yes">k</italic> + 1)-mers in a manually curated, or automatically compiled, set of protein-coding regions. Particularly, these parameters are determined by self-training of GeneMarkS-2 on an anonymous prokaryotic genomic sequence (<xref rid="B5" ref-type="bibr">5</xref>). Notably, besides a model of protein-coding region, a full set of parameters of the generalized HMM (hidden Markov model) of a genomic sequence includes a model of non-coding sequence as well as a model of the gene start region with a ribosome binding site (RBS) or a promoter region located close to gene start in case of leaderless transcription (<xref rid="B5" ref-type="bibr">5</xref>).</p>
      <p><italic toggle="yes">Representative models</italic>. The GeneMarkS-2 model trained on a genome <italic toggle="yes">representing</italic> a particular SGB or tCluster we call a <italic toggle="yes">representative</italic> model. Given the evolutionary closeness of the strains comprising an SGB or tCluster we expect that the GeneMark.hmm-2 algorithm using a single <italic toggle="yes">representative</italic> model will be sufficiently accurate in predicting genes in metagenomic contigs of all the strains from this SGB or tCluster. In analysis of metagenomic contigs GeneMark.hmm-2 uses contig-specific <italic toggle="yes">representative</italic> models associated with a contig by a ‘matching algorithm’. For contigs ‘without match’ the algorithm uses either de novo derived GeneMarkS-2 model or, for too short contigs, a pre-computed GC-specific model. We tested the gene prediction accuracy of GeneMark-hmm-2 with the <italic toggle="yes">representative</italic> model in the following way (Figure <xref rid="F3" ref-type="fig">3</xref>). GeneMarkS-2 was self-trained on each rGenome from an SGB, thus making a set of the rGenome-specific <italic toggle="yes">native</italic> models. Then the sets of gene predictions made for a given rGenome by GeneMark.hmm-2 with the <italic toggle="yes">representative</italic> model and with the <italic toggle="yes">native</italic> model were compared.</p>
      <fig position="float" id="F3">
        <label>Figure 3.</label>
        <caption>
          <p>Assessment of accuracy of GeneMark.hmm-2 with the <italic toggle="yes">SGB representative</italic> models on rGenomes from the same SGBs. Gene predictions made by self-trained GeneMarkS-2 in a particular rGenome were considered as ‘annotation’. The gene co-ordinates predicted by GeneMark.hmm-2 with the SGB <italic toggle="yes">representative</italic> model were compared with the annotation.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="lqab047fig3" position="float"/>
      </fig>
      <p>The results of the accuracy test were quite satisfactory as it could be seen in the Results section. Therefore, GeneMark.hmm-2 with the SGB (tCluster) specific <italic toggle="yes">representative</italic> model was an accurate tool for gene prediction in metagenomic contigs assigned to the pan-genome corresponding to an SGB or tCluster. The SGB (tCluster) specific gene prediction models were created for each of the corresponding 5,082 pan-genomes.</p>
      <p>Notably, in a process of metagenome annotation some contigs may not be assigned to any pan-genome. Then, the gene prediction is done as follows (Figure <xref rid="F1" ref-type="fig">1</xref>). If the contig is relatively short (see more details below), the genes are predicted by MetaGeneMark with a pre-computed <italic toggle="yes">GC specific models</italic> (<xref rid="B10" ref-type="bibr">10</xref>). If the contig is long, the model parameters estimation and the simultaneous gene prediction is done by GeneMarkS-2 (<xref rid="B5" ref-type="bibr">5</xref>).</p>
    </sec>
    <sec id="SEC3-1">
      <title>Initial gene prediction in an anonymous contig</title>
      <p>For accurate gene prediction, GeneMark-HM had to recognize the type of genetic code of an anonymous contig. Most frequent genetic code was one with the three standard stop codons TAA, TAG, TGA (genetic code 11), while the second in frequency was the one with two stop codons, TAA and TAG, while TGA was reassigned to code for either Tryptophan (genetic code 4) or Glycine (genetic code 25) (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.ncbi.nlm.nih.gov/Taxonomy/Utils/wprintgc.cgi" ext-link-type="uri">www.ncbi.nlm.nih.gov/Taxonomy/Utils/wprintgc.cgi</ext-link>). Other types of genetic code, e.g. with TAG or TAA reassignments, have not yet been observed in prokaryotes (<xref rid="B29" ref-type="bibr">29</xref>). Parameters of the model of protein-coding region change depending on the role of TGA.</p>
      <p>GeneMark-HM determines the role of the TGA triplet by the following approach. The GC-specific models of MetaGeneMark are diversified not only by 1% increment in GC content of contigs but also by the role of TGA (genetic code 11 or 4/25). Therefore, at the first stage of analysis, MetaGeneMark is run twice on each contig, with models corresponding to one or another role of TGA. The log-odds scores of a contig computed in the two runs are used in a classifier trained on 10 000 nt long contigs with known genetic codes (Figure <xref rid="F4" ref-type="fig">4</xref>). Assessment of the classifier accuracy on sets of 10 000 nt long genomic fragments not overlapping with the training set demonstrated that the role of TGA (a stop codon or a sense codon) was correctly identified in 99.9% cases.</p>
      <fig position="float" id="F4">
        <label>Figure 4.</label>
        <caption>
          <p>Separation of the log-odds score vectors computed for 10 000 nt contigs.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="lqab047fig4" position="float"/>
      </fig>
      <p>Gene predictions made with a predicted role of TGA are retained as the initial gene predictions in the contig.</p>
    </sec>
    <sec id="SEC3-2">
      <title>Improvement of initial gene predictions</title>
      <p>Each initially predicted gene is used as a query in BLASTn working in the MegaBLAST mode (<xref rid="B24" ref-type="bibr">24</xref>) for similarity search against the gene database of pan-genomes. Among the hits with scores having <italic toggle="yes">E</italic>-value better than 10<sup>–5</sup> we select those in which at least 90 nt of the query sequence and the target in the BLASTn alignment has the ANI value above 95%. Such hits are used to assign the query gene to a pan-genome. If, for a given query, the ANI values of several BLASTn alignments exceed the 95% threshold, the target that has an alignment with the highest BLASTn score is selected. A query gene that has no high enough scores and, thus, is not assigned to a pan-genome is not used in the contig classification. A contig is assigned to a pan-genome to which the majority of the contig's genes have been assigned. Next, the <italic toggle="yes">representative</italic> model of the selected pan-genome is used by GeneMark.hmm-2 to update the initial predictions of protein-coding genes (Figure <xref rid="F1" ref-type="fig">1</xref>). For contigs not assigned to a pan-genome we proceed as follows. If the contig is relatively short, the number of genes initially predicted by MetaGeneMark is smaller than 150, then the set of genes initially predicted by MetaGeneMark is reported as the final annotation. Otherwise, the self-training GeneMarkS-2 runs on the contig to deliver the final gene predictions.</p>
      <p>The above-mentioned restrictions, the alignment length &gt;90 nt as well as the ANI &gt; 95%, were justified as follows. We selected at random four rGenomes from a set of rGenomes not used in a pan-genome construction (any SGB with more than 154 rGenomes would contain such rGenomes). Genes predicted in these rGenomes were used as queries in BLASTn search against all the pan-genomes. We observed that use of the top BLASTn hits without considering the length of alignment generated many false positives in the contig assignment to the pan-genome. Use of the combined restriction ‘&gt;90 nt alignment length AND &gt;95% ANI’ produced sufficiently high sensitivity with low number of false positives.</p>
    </sec>
    <sec id="SEC3-3">
      <title>Classification of long anonymous contigs as bacterial or archaeal</title>
      <p>The GeneMarkS-2 branch of analysis of anonymous long contigs (Figure <xref rid="F1" ref-type="fig">1</xref>) has an extra step ‘Classify into bacteria or archaea’, a step made prior to application of GeneMarkS-2. The accuracy of GeneMarkS-2 improves if information about the species domain is provided. To make the domain assignment for a contig, GeneMark-HM uses results of the BLASTn similarity search for genes initially predicted in the contig. If majority of the significant hits (with <italic toggle="yes">E</italic>-value &lt; 10<sup>–5</sup>), that also have &gt; 60% ANI with the targets and at least 90nt long alignments, have matches to genes of bacterial pan-genomes, the contig is classified as bacterial, otherwise, as archaeal. On contigs with no assignment to a domain, GeneMarkS-2 runs without a domain assignment (<xref rid="B5" ref-type="bibr">5</xref>).</p>
      <p>The other branch of analysis, for contigs associated with pan-genomes, runs GeneMark.hmm-2 that uses <italic toggle="yes">representative</italic> models for which the type of domain is known from the SGB or tCluster specification. The domain information was used in the derivation of the <italic toggle="yes">representative</italic> model by GeneMarkS-2. In the MetaGeneMark branch analyzing short contigs, the domain of each predicted gene is determined, albeit not precisely, by the model, bacterial or archaeal, delivering higher log-odds score (<xref rid="B5" ref-type="bibr">5</xref>).</p>
    </sec>
    <sec id="SEC3-4">
      <title>Tests on simulated metagenomes</title>
      <p>Some SGBs were classified as ‘known’ SGBs (<xref rid="B14" ref-type="bibr">14</xref>) if there was a species whose genome in the NCBI database had a high ANI (&gt;95%) with one of the rGenomes in the SGB. We used 625 NCBI genomes associated with ‘known’ SGBs to generate a set of contigs with lengths distribution like a contig length distribution observed in assembled rGenomes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>). To construct the test set of annotated genes we selected from the 625 genomes only those genes whose protein products had similarity to proteins in other organisms; such genes were supposed to be more reliably annotated by PGAP (<xref rid="B30" ref-type="bibr">30</xref>). The genes co-ordinates determined by PGAP were transferred to the individual contigs. Minimum gene length of both the complete and incomplete genes in the test set was 90 nt. The final test set had 1,640,483 genes, with 83% complete and 17% were incomplete.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC4">
    <title>RESULTS</title>
    <sec id="SEC4-1">
      <title>Evaluation of accuracy of GeneMark.hmm-2 with the representative models</title>
      <p>By the procedure described in Methods, we assessed the accuracy of gene prediction by running GeneMark.hmm-2 with the SGB <italic toggle="yes">representative</italic> models on rGenomes from 1849 SGBs, those having two and more rGenomes. After computing numbers of true positives, false negatives and false positives (Tp, Fn and Fp, respectively) for each rGenome based on comparison with the ‘native’ model-based annotation we found that most of the time the (Sn + Sp)/2 value (Sn = Tp/(Tp + Fn), Sp = Tp/(Tp + Fp)) was above 98% (Figure <xref rid="F5" ref-type="fig">5</xref>). The accuracy below 98% (the dots below the red line) was observed in rGenomes whose fragmentation into short contigs was significantly higher than average. Similar results were observed in the same type of experiments with the <italic toggle="yes">representative</italic> models of tClusters.</p>
      <fig position="float" id="F5">
        <label>Figure 5.</label>
        <caption>
          <p>Gene prediction accuracy of GeneMark.hmm-2 with the SGB representative models was assessed on 6599 rGenomes selected from 1849 SGBs with two and more rGenomes. Excluded from the test sets were incomplete genes shorter than 200 nt.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="lqab047fig5" position="float"/>
      </fig>
      <p>Among the <italic toggle="yes">representative</italic> models determined for 4930 SGBs we observed the following frequency distribution of types of the regulatory signals, canonical and non-canonical RBS and promoters situated upstream to gene starts (Table <xref rid="tbl1" ref-type="table">1</xref>).</p>
      <table-wrap position="float" id="tbl1">
        <label>Table 1.</label>
        <caption>
          <p>Types of regulatory signals observed in the representative models for 4930 SGBs. Estimation of the type and parameters of the signal model was done in the GeneMarkS-2 self-training (<xref rid="B5" ref-type="bibr">5</xref>)</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Description</th>
              <th rowspan="1" colspan="1">Number of models</th>
              <th rowspan="1" colspan="1">Genome group</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Canonical RBS</td>
              <td rowspan="1" colspan="1">3481</td>
              <td rowspan="1" colspan="1">A</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Non-canonical RBS</td>
              <td rowspan="1" colspan="1">641</td>
              <td rowspan="1" colspan="1">B</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Leaderless – Promoters and RBS – bacteria</td>
              <td rowspan="1" colspan="1">717</td>
              <td rowspan="1" colspan="1">C</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Leaderless – Promoters and RBS – archaea</td>
              <td rowspan="1" colspan="1">12</td>
              <td rowspan="1" colspan="1">D</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Unclassified start signal</td>
              <td rowspan="1" colspan="1">68</td>
              <td rowspan="1" colspan="1">X</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>All the three gene finding algorithms employed in GeneMark-HM had to make predictions of the genes with nucleotide composition deviated from a balk of the genes in each genome (atypical genes). This was done with the use of the GC content specific alternative models of protein-coding regions (<xref rid="B5" ref-type="bibr">5</xref>). We saw that in the <italic toggle="yes">representative</italic> rGenomes of 4930 SGBs the atypical genes could comprise up to 20% of all the genes in an rGenome (Figure <xref rid="F6" ref-type="fig">6</xref>); the mode of the distribution was at ∼6%.</p>
      <fig position="float" id="F6">
        <label>Figure 6.</label>
        <caption>
          <p>Distribution of the percentage of atypical genes in the <italic toggle="yes">representative</italic> rGenomes of 4930 SGBs.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="lqab047fig6" position="float"/>
      </fig>
    </sec>
    <sec id="SEC4-2">
      <title>Identification of a role of the TGA codon in a metagenomic contig</title>
      <p>A role of TGA codon (code 11 or code 4/25) was identified for all the 4930 <italic toggle="yes">representative</italic> rGenomes. Just 18 of them had TGA coding for an amino acid. The predictions were confirmed by the MegaBLAST alignments of the eighteen relatively short (less 1 Mb nt in length) <italic toggle="yes">representative</italic> rGenomes to prokaryotic genomes in GenBank (<xref rid="B31" ref-type="bibr">31</xref>) (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://blast.ncbi.nlm.nih.gov/Blast.cgi" ext-link-type="uri">https://blast.ncbi.nlm.nih.gov/Blast.cgi</ext-link>). All the 18 <italic toggle="yes">representative</italic> rGenomes (with predicted codes 4 or 25) had best hits to genomes known to have genetic codes 4 or 25. Coversely, all the genomes with genetic code 4/25 from GenBank were aligned by MegaBLAST against 4912 rGenomes (4930 – 18). The alignments did not indicate a presence of any additional genomes with genetic code 4/25. Thus, all 4912 rGenomes were identified as ones with TGA coding for the end of translation (code 11).</p>
      <p>In GeneMark-HM, a role of TGA in a contig was determined immediately upon the assignment of a contig to a pan-genome. If no such assignment to a pan-genome was made, the role of TGA was defined by the analysis of MetaGeneMark predictions as described in Methods. The accuracy of the TGA role prediction by MetaGeneMark was tested on contigs from the 18 <italic toggle="yes">representative</italic> rGenomes with genetic code 4/25 (a total of 1040 contigs) as well as on the contigs from the <italic toggle="yes">representative</italic> rGenomes with genetic code 11. A prediction was called false positive when a contig with TGA being a stop codon was identified as s contig with TGA coding for an amino acid. The same set of contigs was used to assess the accuracy of identification of the role of TGA by MetaProdigal (<xref rid="B7" ref-type="bibr">7</xref>).</p>
      <p>If a contig does not carry genes containing TGA (either as a stop or a sense codon) then the result of gene prediction will not change regardless of what role of TGA has a model of a protein-coding region used for gene prediction in the contig Therefore, in addition to counting contigs with correctly and incorrectly predicted genetic code we counted the numbers of genes predicted with errors due to the TGA misinterpretation (Table <xref rid="tbl2" ref-type="table">2</xref>). It was observed that MetaGeneMark made less errors (2170) in contigs with code 11 than MetaProdigal (25 729), (Table <xref rid="tbl2" ref-type="table">2</xref>, top panel) and made more correct predictions than MetaProdigal in contigs with code 4, where TGA codes for Trp (Table <xref rid="tbl2" ref-type="table">2</xref>, bottom panel).</p>
      <table-wrap position="float" id="tbl2">
        <label>Table 2.</label>
        <caption>
          <p>Accuracy of genetic code identification by MetaGeneMark and MetaProdigal</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th colspan="3" rowspan="1">
                <italic toggle="yes">932 969 contigs with TGA being a stop codon (code 11)</italic>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Algorithm</td>
              <td rowspan="1" colspan="1"># of contigs predicted to use code 4</td>
              <td rowspan="1" colspan="1"># of genes with TGA incorrectly interpreted</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MetaGeneMark</td>
              <td rowspan="1" colspan="1">
                <bold>1168</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>2170</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MetaProdigal</td>
              <td rowspan="1" colspan="1">26 305</td>
              <td rowspan="1" colspan="1">25 729</td>
            </tr>
            <tr>
              <td colspan="3" rowspan="1">
                <italic toggle="yes">1040 contigs with TGA coding for Trp (code 4)</italic>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Algorithm</td>
              <td rowspan="1" colspan="1"># of contigs predicted to use code 4</td>
              <td rowspan="1" colspan="1"># of genes with TGA correctly predicted as Trp</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MetaGeneMark</td>
              <td rowspan="1" colspan="1">
                <bold>942</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>11 292</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MetaProdigal</td>
              <td rowspan="1" colspan="1">820</td>
              <td rowspan="1" colspan="1">9627</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="SEC4-3">
      <title>Evaluation of the accuracy of gene prediction (as a whole)</title>
      <p>We used 625 complete genomic sequences (see Methods) to create simulated metagenomes. Annotation of 1 640 483 genes made by the NCBI PGAP (<xref rid="B30" ref-type="bibr">30</xref>) was transferred to the metagenomics contigs. We emphasize that only a subset of all genes, those annotated with support of protein homology, was used and not the genes <italic toggle="yes">ab initio</italic> predicted by GeneMarkS-2, being a part of PGAP. Along with GeneMark-HM we have tested FragGeneScan, MetaGeneAnnotator, MetaProdigal and MetaGeneMark (Table <xref rid="tbl3" ref-type="table">3</xref>). The results show that GeneMark-HM missed less genes in the test set than other gene finders; GeneMark-HM also made less errors in predictions of gene starts. Since the test set was a subset of the whole complement of genes in any given genome, accurate assessment of false positive rates was a difficult task. However, the results showed that GeneMark-HM predicted fewer overall number of genes than other gene finders, except MetaGeneAnnotator; a tool that had a higher threshold on minimal length of predicted genes. This observation suggests that the lower error rate in gene prediction (higher sensitivity) of GeneMark-HM was not a result of gene over-prediction.</p>
      <table-wrap position="float" id="tbl3">
        <label>Table 3.</label>
        <caption>
          <p>Assessment of gene finding accuracy of GeneMark-HM on simulated metagenomic sequences. The shortest contig length was 1500 nt. The protein-coding regions reported by MetaGeneAnnotator and FragGeneScan were longer than 120 nt; the three other tools reported predicted coding regions longer than 90 nt</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">1 640 483 genes in the test set</th>
              <th rowspan="1" colspan="1"># of missed genes</th>
              <th rowspan="1" colspan="1">% of missed genes</th>
              <th rowspan="1" colspan="1">total # of genes predicted</th>
              <th rowspan="1" colspan="1"># of wrong starts</th>
              <th rowspan="1" colspan="1">% of wrong starts</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">FragGeneScan</td>
              <td rowspan="1" colspan="1">71 242</td>
              <td rowspan="1" colspan="1">4.3</td>
              <td rowspan="1" colspan="1">1 861 953</td>
              <td rowspan="1" colspan="1">291 400</td>
              <td rowspan="1" colspan="1">17.8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MetaGeneAnnotator</td>
              <td rowspan="1" colspan="1">37 451</td>
              <td rowspan="1" colspan="1">2.3</td>
              <td rowspan="1" colspan="1">1 794 502</td>
              <td rowspan="1" colspan="1">284 555</td>
              <td rowspan="1" colspan="1">17.3</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MetaProdigal</td>
              <td rowspan="1" colspan="1">22 071</td>
              <td rowspan="1" colspan="1">1.3</td>
              <td rowspan="1" colspan="1">1 824 182</td>
              <td rowspan="1" colspan="1">194 188</td>
              <td rowspan="1" colspan="1">11.8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MetaGeneMark</td>
              <td rowspan="1" colspan="1">21 861</td>
              <td rowspan="1" colspan="1">1.3</td>
              <td rowspan="1" colspan="1">1 830 949</td>
              <td rowspan="1" colspan="1">330 985</td>
              <td rowspan="1" colspan="1">20.2</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">(a) GeneMark-HM with D4 (81% in pan-genome path, 19% in MetaGeneMark path)</td>
              <td rowspan="1" colspan="1">15 747</td>
              <td rowspan="1" colspan="1">1.0</td>
              <td rowspan="1" colspan="1">1 813 984</td>
              <td rowspan="1" colspan="1">204 159</td>
              <td rowspan="1" colspan="1">12.4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">(b) GeneMark-HM with D3 (84% in pan-genome path, 16% in MetaGeneMark path)</td>
              <td rowspan="1" colspan="1">15 409</td>
              <td rowspan="1" colspan="1">0.9</td>
              <td rowspan="1" colspan="1">1 813 830</td>
              <td rowspan="1" colspan="1">199 871</td>
              <td rowspan="1" colspan="1">12.2</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">(c) GeneMark-HM with D2 (88% in pan-genome path, 12% in MetaGeneMark path)</td>
              <td rowspan="1" colspan="1">15 122</td>
              <td rowspan="1" colspan="1">0.9</td>
              <td rowspan="1" colspan="1">1 815 335</td>
              <td rowspan="1" colspan="1">193 395</td>
              <td rowspan="1" colspan="1">11.8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">(d) GeneMark-HM with D1 (96% in pan-genome path, 4% in MetaGeneMark path)</td>
              <td rowspan="1" colspan="1">
                <bold>14 162</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.9</bold>
              </td>
              <td rowspan="1" colspan="1">1 817 669</td>
              <td rowspan="1" colspan="1">
                <bold>178 190</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>10.9</bold>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Notably, GeneMark-HM was the only one tool in this comparison that was using a pan-genome database of reference genes. The average accuracy of gene predictions made by GeneMark-HM in each metagenome would, therefore, depend on the proportion of sequences originated from species distant from the ones carried in the reference database. To assess effects of this variation, we used the following approach. While we used one and the same simulated metagenome made from sequences of 625 genomes, we changed the size of the reference database of genes, D, which largest instance was the set of genes in all 5082 pan-genomes (Table <xref rid="tbl3" ref-type="table">3</xref>).</p>
      <p>Four instances of database D were as follows: (a) D4—genes of randomly selected 40% of the 625 genomes were excluded from the set of genes of 5082 pan-genomes; (b) D3—genes of randomly selected 30% of the 625 genomes were excluded; (c) D2—genes of randomly selected 20% of the 625 genomes were excluded; (d) D1— all 5082 pan-genomes were used without exclusions. As a result, we saw the percentage of genes predicted via the pan-genome path increasing as the database was getting larger (from a to d); at the same time the percentage of genes predicted by MetaGeneMark was decreasing.</p>
      <p>In the set of 625 complete genomes, 410 were classified by GeneMarkS-2 (<xref rid="B5" ref-type="bibr">5</xref>) as genomes with the canonical Shine-Dalgarno RBS, 99 were classified as genomes with non-canonical RBS and 110 were classified as ones with frequent leaderless transcription. GeneMark-HM used the regulatory signal model in the gene start prediction. All over, GeneMark-HM had the lowest number of missed genes and incorrectly predicted gene starts in each class. We show the statistics of the gene start prediction errors for GeneMark-HM and for the runner-up, MetaProdigal (Table <xref rid="tbl4" ref-type="table">4</xref>). The difference in the number of errors in gene start prediction was the smallest for genomes with canonical RBS and the largest for genomes with frequent leaderless translation initiation.</p>
      <table-wrap position="float" id="tbl4">
        <label>Table 4.</label>
        <caption>
          <p>The gene start prediction errors in genomes of each group: (A) with canonical RBS, (B) with non-canonical RBS and (C) with frequent leaderless transcription</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th colspan="2" rowspan="1">GeneMarkS-2 groups</th>
              <th rowspan="1" colspan="1">A</th>
              <th rowspan="1" colspan="1">B</th>
              <th rowspan="1" colspan="1">C</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="2" rowspan="1">Number of genes in each class</td>
              <td rowspan="1" colspan="1">1 087 637</td>
              <td rowspan="1" colspan="1">284 694</td>
              <td rowspan="1" colspan="1">244 773</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Missed genes</td>
              <td rowspan="1" colspan="1">by MetaProdigal</td>
              <td rowspan="1" colspan="1">14 332</td>
              <td rowspan="1" colspan="1">3795</td>
              <td rowspan="1" colspan="1">3561</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">by GeneMark-HM</td>
              <td rowspan="1" colspan="1">
                <bold>8797</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>2760</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>2353</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Difference as % of all genes in the test set</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">0.51</td>
              <td rowspan="1" colspan="1">0.36</td>
              <td rowspan="1" colspan="1">0.49</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Wrong starts</td>
              <td rowspan="1" colspan="1">by MetaProdigal</td>
              <td rowspan="1" colspan="1">115 201</td>
              <td rowspan="1" colspan="1">35 127</td>
              <td rowspan="1" colspan="1">40 263</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">by GeneMark-HM</td>
              <td rowspan="1" colspan="1">
                <bold>106 993</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>31 370</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>36 374</bold>
              </td>
            </tr>
            <tr>
              <td colspan="2" rowspan="1">Difference as % of all genes in the test set</td>
              <td rowspan="1" colspan="1">0.75</td>
              <td rowspan="1" colspan="1">1.32</td>
              <td rowspan="1" colspan="1">1.59</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="SEC4-4">
      <title>Computational complexity of running GeneMark-HM</title>
      <p>Frequency distributions of sizes of the sets of orthologous genes in SGBs and tClusters did show a typical pattern illustrated here for SGB # 1472 (<xref rid="B14" ref-type="bibr">14</xref>), a large SGB with 150 rGenomes (Figure <xref rid="F7" ref-type="fig">7</xref>). A spike at the low numbers of orthologues corresponds to rather unique genes that appear in a single or in a few rGenomes (the highest peak relates to the truly unique genes). A spike at the large number of orthologues corresponds to universal genes present in each of 150 rGenomes. The middle part of the graph relates to disposable genes present in some rGenomes and absent in others.</p>
      <fig position="float" id="F7">
        <label>Figure 7.</label>
        <caption>
          <p>Distribution of frequency of sizes of the orthologous groups in SGB # 1472 (150 rGenomes out of total 200 rGenomes were used in the pan-genome construction).</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="lqab047fig7" position="float"/>
      </fig>
      <p>Most of the time, upon construction of pan-genomes in gene space, the initial gene set defined by a <italic toggle="yes">representative</italic> rGenome was expanded three- or four-fold towards the end of the process (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>). However, in some pan-genomes the increase could be more significant (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6</xref>). To keep the size of a pan-genome under control we had to restrict addition of the genes with low frequencies of orthologues. An effective way to impose this restriction was to admit at most <italic toggle="yes">N</italic> rGenomes to a pan-genome construction (here N = 150).</p>
      <p>Another option to control the size of a pan-genome was to change the length of the shortest gene. However, we observed that the size of a pan-genome practically did not change when the minimum gene length was selected anywhere between 90nt and 200 nt; therefore, the gene length threshold was set to 90 nt.</p>
      <p>We also observed that under the restriction of using for the pan-genome construction no more than 150 largest rGenomes per SGB, the whole set of the genes would grow three-fold in comparison with the number of genes in the SGB <italic toggle="yes">representative</italic> rGenome. At the same time, the size of the pan-genome gene sequence database grew &gt;4-fold (due to the asymmetry of the comparison rule between query and target (see Methods) we made more frequent selection of genes longer than queries). Speaking of computational efficiency, a running time of processing a single query increased just 2-fold between using a single <italic toggle="yes">representative</italic> rGenome and a full pan-genome. This effect was partly due to running the fast mode of BLASTn with the <italic toggle="yes">k</italic>-mer size of 28 nt chosen under assumption of high similarity of query and targets (<xref rid="B24" ref-type="bibr">24</xref>). This fast mode showed a sub-linear dependence of the run-time on a size of the sequence database. Use of pan-genomes has significantly—by factor 15—reduced the database volume in comparison with a number of all the genes in a non-redundant set of SGBs and tClusters (Table <xref rid="tbl5" ref-type="table">5</xref>).</p>
      <table-wrap position="float" id="tbl5">
        <label>Table 5.</label>
        <caption>
          <p>Statistics of the pan-genomes database construction</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Source</th>
              <th rowspan="1" colspan="1">Number of pan-genomes</th>
              <th rowspan="1" colspan="1">Number of genes in pan-genomes</th>
              <th rowspan="1" colspan="1">Volume of sequence</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">tClusters</td>
              <td rowspan="1" colspan="1">701</td>
              <td rowspan="1" colspan="1">5.7 million</td>
              <td rowspan="1" colspan="1">5.3 Gb</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SGBs</td>
              <td rowspan="1" colspan="1">4930</td>
              <td rowspan="1" colspan="1">20.4 million</td>
              <td rowspan="1" colspan="1">19.2 Gb</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SGBs + non-overlapping tClusters</td>
              <td rowspan="1" colspan="1">5082</td>
              <td rowspan="1" colspan="1">21.6 million</td>
              <td rowspan="1" colspan="1">20.4 Gb</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Construction of the pan-genomes significantly reduced (by factor 15) the memory footprint necessary for the GeneMark-HM operation (Table <xref rid="tbl5" ref-type="table">5</xref>). Although a few erroneously predicted genes could be included in the pan-genome database upon its construction, these ‘targets’ could rarely appear as hits upon similarity searches. Thus, such errors were not likely to influence accuracy of a contig assignment to a species level clade.</p>
      <p>Similarity searches with the query genes against the pan-genome database was the most time-consuming step in the GeneMark-HM operation. To reduce the run-time, given that we searched for a hit with &gt;95% ANI identity of target to a query, we used a fast MegaBLAST algorithm (<xref rid="B24" ref-type="bibr">24</xref>) with long <italic toggle="yes">k</italic>-mers (<italic toggle="yes">k</italic> = 28). Even in this case, the similarity search step took on average ∼80% of the GeneMark-HM run-time (using a single CPU).</p>
      <p>We should mention that, for comparison, we implemented an alternative variant of GeneMark-HM using pan-genomes in protein space and the Diamond algorithm for similarity searches (<xref rid="B32" ref-type="bibr">32</xref>). Strikingly, the run-time increased by the two orders of magnitude. A particular reason for the increase was having large number of high scoring alignments to proteins from more remotely related pan-genomes, as the protein translations of genes mask DNA differences in synonymous codon positions.</p>
    </sec>
    <sec id="SEC4-5">
      <title>Gene prediction in real metagenomes</title>
      <p>We tested GeneMark-HM on human metagenomes originated from microbiomes sampled from the skin (GCA_013297495), the gut (GCA_900415335 and GCA_003604395) and the oral cavity (GCA_003640265). We observed that most gene predictions in each metagenome, from 79.4% to 99.4%, was made by GeneMark.hmm with the <italic toggle="yes">representative</italic> models (the pan-genome path, Table <xref rid="tbl6" ref-type="table">6</xref> and Figure <xref rid="F1" ref-type="fig">1</xref>). A percentage of the predictions made through this path was especially high (&gt;99%) in the human gut metagenomes. A sizable number of relatively short contigs that were not assigned to pan genomes and require use of MetaGeneMark was observed in the oral and in the skin metagenomes, where a few unassigned to a pan-genome contigs were sufficiently long for <italic toggle="yes">de novo</italic> training of GeneMarkS-2 (Table <xref rid="tbl6" ref-type="table">6</xref>). Such long unassigned contigs were absent in the gut metagenomes.</p>
      <table-wrap position="float" id="tbl6">
        <label>Table 6.</label>
        <caption>
          <p>Genes predicted in the four human metagenomes with indication of numbers of genes predicted by the three alternative branches of GeneMark-HM (Figure <xref rid="F1" ref-type="fig">1</xref>). Contigs shorter than 1500 nt were not included in this analysis</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Assembly ID</th>
              <th rowspan="1" colspan="1">Site</th>
              <th rowspan="1" colspan="1">Size, Mb</th>
              <th rowspan="1" colspan="1"># of contigs</th>
              <th rowspan="1" colspan="1"># of genes predicted</th>
              <th rowspan="1" colspan="1">Pan-genome path</th>
              <th rowspan="1" colspan="1">MetaGeneMark path</th>
              <th rowspan="1" colspan="1">Gene MarkS-2 path</th>
              <th rowspan="1" colspan="1">% by pan-genome path</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">GCA_013297495</td>
              <td rowspan="1" colspan="1">skin</td>
              <td rowspan="1" colspan="1">44.5</td>
              <td rowspan="1" colspan="1">7569</td>
              <td rowspan="1" colspan="1">49 285</td>
              <td rowspan="1" colspan="1">39 154</td>
              <td rowspan="1" colspan="1">10 131</td>
              <td rowspan="1" colspan="1">375</td>
              <td rowspan="1" colspan="1">79.4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GCA_900415335</td>
              <td rowspan="1" colspan="1">gut</td>
              <td rowspan="1" colspan="1">49.7</td>
              <td rowspan="1" colspan="1">5364</td>
              <td rowspan="1" colspan="1">44 476</td>
              <td rowspan="1" colspan="1">44 211</td>
              <td rowspan="1" colspan="1">265</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">99.4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GCA_003604395</td>
              <td rowspan="1" colspan="1">gut</td>
              <td rowspan="1" colspan="1">85.9</td>
              <td rowspan="1" colspan="1">12 353</td>
              <td rowspan="1" colspan="1">88 015</td>
              <td rowspan="1" colspan="1">87 305</td>
              <td rowspan="1" colspan="1">710</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">99.2</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GCA_003640265</td>
              <td rowspan="1" colspan="1">oral</td>
              <td rowspan="1" colspan="1">296.0</td>
              <td rowspan="1" colspan="1">81 048</td>
              <td rowspan="1" colspan="1">318 534</td>
              <td rowspan="1" colspan="1">283 412</td>
              <td rowspan="1" colspan="1">35 122</td>
              <td rowspan="1" colspan="1">170</td>
              <td rowspan="1" colspan="1">89.0</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>In the tests on real metagenomes with total sequence length of 45 Mb we observed the following run-times (using a single CPU): MetaGeneMark – 10 s, MetaProdigal – 3.5 min, GeneMark-HM – 12 min. The time of GeneMark-HM included the time required for the BLASTn scanning the pan-genome database (∼80% of the time). This time could be significantly improved by parallel processing.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC5">
    <title>DISCUSSION</title>
    <p>In the Results section we demonstrated that the GeneMark-HM pipeline did improve the accuracy of gene prediction in metagenomic sequences. Particularly, we observed improvements in the whole gene prediction sensitivity as well as in accuracy of the gene starts prediction (Table <xref rid="tbl3" ref-type="table">3</xref>).</p>
    <p>The observed improvement was mainly due to <italic toggle="yes">selecting an accurate model</italic> for GeneMark.hmm-2 by means of assignment of a metagenomic contig to a pan-genome in the pan-genome database. The optimal model selection made GeneMark.hmm-2 capable to annotate genes in short contigs no less accurately than GeneMarkS-2 annotates complete genomes (Figure <xref rid="F1" ref-type="fig">1</xref>, Table <xref rid="tbl3" ref-type="table">3</xref>). The pan-genome database for the human microbiome was built from arguably the largest collection of genomes of sequenced isolates and prokaryotic genomes reconstructed <italic toggle="yes">in silico</italic> from metagenomics reads.</p>
    <p>Experiments with real metagenomes from human sites demonstrated, that up to 99.4% of all contigs could be assigned to pan-genomes made at a species level. If such an assignment was in place, a <italic toggle="yes">representative</italic> model of the pan-genome could be used in GeneMark.hmm-2 to predict genes in the contig. The highest rate of a contig to a pan-genome assignment, 99.4%, was observed for human gut metagenomes. The lower rate, down to 89.0% and 79.4% was observed for oral and skin metagenomes respectively (Table <xref rid="tbl6" ref-type="table">6</xref>). These results could be expected as the oral and skin microbiomes might be mixed with microbes from environment. The contigs not matched to pan-genomes were processed by either MetaGeneMark, the shorter ones, and by GeneMarkS-2, the longer ones (Figure <xref rid="F1" ref-type="fig">1</xref>). Interestingly, the MetaGeneMark performance was quite close to GeneMarkS-2 in terms of accurate prediction of the 3′ ends of genes, with 1.3% and 0.9% error, respectively (Table <xref rid="tbl3" ref-type="table">3</xref>).</p>
    <p>A significant improvement was observed in gene start prediction (Table <xref rid="tbl3" ref-type="table">3</xref>). Types of sequence signals controlling translation initiation in prokaryotic genomes vary significantly (<xref rid="B5" ref-type="bibr">5</xref>). A contig assignment to a pan-genome triggered an automatic selection of a suitable model of the sequences near translation start sites for the whole contig.</p>
    <p>For comparison, the gene start models in MetaProdigal are aware of canonical RBS (group A in Table <xref rid="tbl3" ref-type="table">3</xref>) and non-canonical RBS (group B in Table <xref rid="tbl3" ref-type="table">3</xref>), but not of frequently observed sequence patterns associated with the leaderless translation initiation (group C in Table <xref rid="tbl3" ref-type="table">3</xref>). In this group the decrease in the error rate of GeneMark-HM in comparison with the one of MetaProdigal was the largest (Table <xref rid="tbl4" ref-type="table">4</xref>).</p>
    <p>Incorrect identification of a role of the TGA codon would affect the accuracy of gene prediction in an anonymous contig. Determination of this role is, therefore, is made in GeneMark-HM. It was shown that GeneMark-HM identified the role of TGA in anonymous contigs with fewer errors than MetaProdigal (Table <xref rid="tbl2" ref-type="table">2</xref>). Particularly, GeneMark-HM made no errors in contigs with more than 100 genes.</p>
    <p>The GeneMark-HM accuracy does depend on the correct assignment of a metagenomic contig to a reference pan-genome. Overall improvement of the gene prediction accuracy confirms that this step was done efficiently. Moreover, the assignment to a pan-genome would also facilitate accurate functional annotation of the predicted genes and proteins by narrowing down the phylogenetic search space.</p>
  </sec>
  <sec sec-type="data-availability" id="SEC6">
    <title>DATA AVAILABILITY</title>
    <p>The GeneMark-HM pipeline software is freely available for academic and non-commercial users: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/GeneProbe/GeneMark-HM" ext-link-type="uri">https://github.com/GeneProbe/GeneMark-HM</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>lqab047_Supplemental_File</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="lqab047_supplemental_file.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>We would like to thank Prof. Nicola Segata for sharing the initial SGB data as well as for useful discussions on metagenomic data analysis.</p>
  </ack>
  <sec id="SEC7">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://academic.oup.com/nargab/article-lookup/doi/10.1093/nargab/lqab047#supplementary-data" ext-link-type="uri">Supplementary Data</ext-link> are available at NARGAB Online.</p>
  </sec>
  <sec id="SEC8">
    <title>FUNDING</title>
    <p>Enterome, Paris, France; Gene Probe, Inc. Atlanta, USA. Funding for open access charge: Gene Probe, Inc. Atlanta, USA.</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. The authors have no conflicts of interest to declare aside from the fact that several of the authors are employees of private companies, Gene Probe, Inc. and Enterome, as stated in the title page of the manuscript.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vollmers</surname><given-names>J.</given-names></string-name>, <string-name><surname>Wiegand</surname><given-names>S.</given-names></string-name>, <string-name><surname>Kaster</surname><given-names>A.K.</given-names></string-name></person-group><article-title>Comparing and evaluating metagenome assembly tools from a microbiologist's perspective - not only size matters!</article-title>. <source>PLoS One</source>. <year>2017</year>; <volume>12</volume>:<fpage>e0169662</fpage>.<pub-id pub-id-type="pmid">28099457</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Besemer</surname><given-names>J.</given-names></string-name>, <string-name><surname>Lomsadze</surname><given-names>A.</given-names></string-name>, <string-name><surname>Borodovsky</surname><given-names>M.</given-names></string-name></person-group><article-title>GeneMarkS: a self-training method for prediction of gene starts in microbial genomes. Implications for finding sequence motifs in regulatory regions</article-title>. <source>Nucleic Acids Res.</source><year>2001</year>; <volume>29</volume>:<fpage>2607</fpage>–<lpage>2618</lpage>.<pub-id pub-id-type="pmid">11410670</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Delcher</surname><given-names>A.L.</given-names></string-name>, <string-name><surname>Bratke</surname><given-names>K.A.</given-names></string-name>, <string-name><surname>Powers</surname><given-names>E.C.</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>S.L.</given-names></string-name></person-group><article-title>Identifying bacterial genes and endosymbiont DNA with Glimmer</article-title>. <source>Bioinformatics</source>. <year>2007</year>; <volume>23</volume>:<fpage>673</fpage>–<lpage>679</lpage>.<pub-id pub-id-type="pmid">17237039</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hyatt</surname><given-names>D.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>G.L.</given-names></string-name>, <string-name><surname>Locascio</surname><given-names>P.F.</given-names></string-name>, <string-name><surname>Land</surname><given-names>M.L.</given-names></string-name>, <string-name><surname>Larimer</surname><given-names>F.W.</given-names></string-name>, <string-name><surname>Hauser</surname><given-names>L.J.</given-names></string-name></person-group><article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification</article-title>. <source>BMC Bioinformatics</source>. <year>2010</year>; <volume>11</volume>:<fpage>119</fpage>.<pub-id pub-id-type="pmid">20211023</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lomsadze</surname><given-names>A.</given-names></string-name>, <string-name><surname>Gemayel</surname><given-names>K.</given-names></string-name>, <string-name><surname>Tang</surname><given-names>S.</given-names></string-name>, <string-name><surname>Borodovsky</surname><given-names>M.</given-names></string-name></person-group><article-title>Modeling leaderless transcription and atypical genes results in more accurate gene prediction in prokaryotes</article-title>. <source>Genome Res.</source><year>2018</year>; <volume>28</volume>:<fpage>1079</fpage>–<lpage>1089</lpage>.<pub-id pub-id-type="pmid">29773659</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Besemer</surname><given-names>J.</given-names></string-name>, <string-name><surname>Borodovsky</surname><given-names>M.</given-names></string-name></person-group><article-title>Heuristic approach to deriving models for gene finding</article-title>. <source>Nucleic Acids Res.</source><year>1999</year>; <volume>27</volume>:<fpage>3911</fpage>–<lpage>3920</lpage>.<pub-id pub-id-type="pmid">10481031</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hyatt</surname><given-names>D.</given-names></string-name>, <string-name><surname>LoCascio</surname><given-names>P.F.</given-names></string-name>, <string-name><surname>Hauser</surname><given-names>L.J.</given-names></string-name>, <string-name><surname>Uberbacher</surname><given-names>E.C.</given-names></string-name></person-group><article-title>Gene and translation initiation site prediction in metagenomic sequences</article-title>. <source>Bioinformatics</source>. <year>2012</year>; <volume>28</volume>:<fpage>2223</fpage>–<lpage>2230</lpage>.<pub-id pub-id-type="pmid">22796954</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Noguchi</surname><given-names>H.</given-names></string-name>, <string-name><surname>Taniguchi</surname><given-names>T.</given-names></string-name>, <string-name><surname>Itoh</surname><given-names>T.</given-names></string-name></person-group><article-title>MetaGeneAnnotator: detecting species-specific patterns of ribosomal binding site for precise gene prediction in anonymous prokaryotic and phage genomes</article-title>. <source>DNA Res.</source><year>2008</year>; <volume>15</volume>:<fpage>387</fpage>–<lpage>396</lpage>.<pub-id pub-id-type="pmid">18940874</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rho</surname><given-names>M.</given-names></string-name>, <string-name><surname>Tang</surname><given-names>H.</given-names></string-name>, <string-name><surname>Ye</surname><given-names>Y.</given-names></string-name></person-group><article-title>FragGeneScan: predicting genes in short and error-prone reads</article-title>. <source>Nucleic Acids Res.</source><year>2010</year>; <volume>38</volume>:<fpage>e191</fpage>.<pub-id pub-id-type="pmid">20805240</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhu</surname><given-names>W.</given-names></string-name>, <string-name><surname>Lomsadze</surname><given-names>A.</given-names></string-name>, <string-name><surname>Borodovsky</surname><given-names>M.</given-names></string-name></person-group><article-title>Ab initio gene identification in metagenomic sequences</article-title>. <source>Nucleic Acids Res.</source><year>2010</year>; <volume>38</volume>:<fpage>e132</fpage>.<pub-id pub-id-type="pmid">20403810</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Almeida</surname><given-names>A.</given-names></string-name>, <string-name><surname>Mitchell</surname><given-names>A.L.</given-names></string-name>, <string-name><surname>Boland</surname><given-names>M.</given-names></string-name>, <string-name><surname>Forster</surname><given-names>S.C.</given-names></string-name>, <string-name><surname>Gloor</surname><given-names>G.B.</given-names></string-name>, <string-name><surname>Tarkowska</surname><given-names>A.</given-names></string-name>, <string-name><surname>Lawley</surname><given-names>T.D.</given-names></string-name>, <string-name><surname>Finn</surname><given-names>R.D.</given-names></string-name></person-group><article-title>A new genomic blueprint of the human gut microbiota</article-title>. <source>Nature</source>. <year>2019</year>; <volume>568</volume>:<fpage>499</fpage>–<lpage>504</lpage>.<pub-id pub-id-type="pmid">30745586</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Qin</surname><given-names>J.</given-names></string-name>, <string-name><surname>Li</surname><given-names>R.</given-names></string-name>, <string-name><surname>Raes</surname><given-names>J.</given-names></string-name>, <string-name><surname>Arumugam</surname><given-names>M.</given-names></string-name>, <string-name><surname>Burgdorf</surname><given-names>K.S.</given-names></string-name>, <string-name><surname>Manichanh</surname><given-names>C.</given-names></string-name>, <string-name><surname>Nielsen</surname><given-names>T.</given-names></string-name>, <string-name><surname>Pons</surname><given-names>N.</given-names></string-name>, <string-name><surname>Levenez</surname><given-names>F.</given-names></string-name>, <string-name><surname>Yamada</surname><given-names>T.</given-names></string-name><etal>et al</etal>.</person-group><article-title>A human gut microbial gene catalogue established by metagenomic sequencing</article-title>. <source>Nature</source>. <year>2010</year>; <volume>464</volume>:<fpage>59</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">20203603</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vernikos</surname><given-names>G.</given-names></string-name>, <string-name><surname>Medini</surname><given-names>D.</given-names></string-name>, <string-name><surname>Riley</surname><given-names>D.R.</given-names></string-name>, <string-name><surname>Tettelin</surname><given-names>H.</given-names></string-name></person-group><article-title>Ten years of pan-genome analyses</article-title>. <source>Curr. Opin. Microbiol.</source><year>2015</year>; <volume>23</volume>:<fpage>148</fpage>–<lpage>154</lpage>.<pub-id pub-id-type="pmid">25483351</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pasolli</surname><given-names>E.</given-names></string-name>, <string-name><surname>Asnicar</surname><given-names>F.</given-names></string-name>, <string-name><surname>Manara</surname><given-names>S.</given-names></string-name>, <string-name><surname>Zolfo</surname><given-names>M.</given-names></string-name>, <string-name><surname>Karcher</surname><given-names>N.</given-names></string-name>, <string-name><surname>Armanini</surname><given-names>F.</given-names></string-name>, <string-name><surname>Beghini</surname><given-names>F.</given-names></string-name>, <string-name><surname>Manghi</surname><given-names>P.</given-names></string-name>, <string-name><surname>Tett</surname><given-names>A.</given-names></string-name>, <string-name><surname>Ghensi</surname><given-names>P.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Extensive unexplored human microbiome diversity revealed by over 150,000 genomes from metagenomes spanning age, geography, and lifestyle</article-title>. <source>Cell</source>. <year>2019</year>; <volume>176</volume>:<fpage>649</fpage>–<lpage>662</lpage>.<pub-id pub-id-type="pmid">30661755</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dubin</surname><given-names>K.</given-names></string-name>, <string-name><surname>Callahan</surname><given-names>M.K.</given-names></string-name>, <string-name><surname>Ren</surname><given-names>B.</given-names></string-name>, <string-name><surname>Khanin</surname><given-names>R.</given-names></string-name>, <string-name><surname>Viale</surname><given-names>A.</given-names></string-name>, <string-name><surname>Ling</surname><given-names>L.</given-names></string-name>, <string-name><surname>No</surname><given-names>D.</given-names></string-name>, <string-name><surname>Gobourne</surname><given-names>A.</given-names></string-name>, <string-name><surname>Littmann</surname><given-names>E.</given-names></string-name>, <string-name><surname>Huttenhower</surname><given-names>C.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Intestinal microbiome analyses identify melanoma patients at risk for checkpoint-blockade-induced colitis</article-title>. <source>Nat. Commun.</source><year>2016</year>; <volume>7</volume>:<fpage>10391</fpage>.<pub-id pub-id-type="pmid">26837003</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><collab>Human Microbiome Project Consortium</collab><article-title>Structure, function and diversity of the healthy human microbiome</article-title>. <source>Nature</source>. <year>2012</year>; <volume>486</volume>:<fpage>207</fpage>–<lpage>214</lpage>.<pub-id pub-id-type="pmid">22699609</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karlsson</surname><given-names>F.H.</given-names></string-name>, <string-name><surname>Tremaroli</surname><given-names>V.</given-names></string-name>, <string-name><surname>Nookaew</surname><given-names>I.</given-names></string-name>, <string-name><surname>Bergstrom</surname><given-names>G.</given-names></string-name>, <string-name><surname>Behre</surname><given-names>C.J.</given-names></string-name>, <string-name><surname>Fagerberg</surname><given-names>B.</given-names></string-name>, <string-name><surname>Nielsen</surname><given-names>J.</given-names></string-name>, <string-name><surname>Backhed</surname><given-names>F.</given-names></string-name></person-group><article-title>Gut metagenome in European women with normal, impaired and diabetic glucose control</article-title>. <source>Nature</source>. <year>2013</year>; <volume>498</volume>:<fpage>99</fpage>–<lpage>103</lpage>.<pub-id pub-id-type="pmid">23719380</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Le Chatelier</surname><given-names>E.</given-names></string-name>, <string-name><surname>Nielsen</surname><given-names>T.</given-names></string-name>, <string-name><surname>Qin</surname><given-names>J.</given-names></string-name>, <string-name><surname>Prifti</surname><given-names>E.</given-names></string-name>, <string-name><surname>Hildebrand</surname><given-names>F.</given-names></string-name>, <string-name><surname>Falony</surname><given-names>G.</given-names></string-name>, <string-name><surname>Almeida</surname><given-names>M.</given-names></string-name>, <string-name><surname>Arumugam</surname><given-names>M.</given-names></string-name>, <string-name><surname>Batto</surname><given-names>J.M.</given-names></string-name>, <string-name><surname>Kennedy</surname><given-names>S.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Richness of human gut microbiome correlates with metabolic markers</article-title>. <source>Nature</source>. <year>2013</year>; <volume>500</volume>:<fpage>541</fpage>–<lpage>546</lpage>.<pub-id pub-id-type="pmid">23985870</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nielsen</surname><given-names>H.B.</given-names></string-name>, <string-name><surname>Almeida</surname><given-names>M.</given-names></string-name>, <string-name><surname>Juncker</surname><given-names>A.S.</given-names></string-name>, <string-name><surname>Rasmussen</surname><given-names>S.</given-names></string-name>, <string-name><surname>Li</surname><given-names>J.</given-names></string-name>, <string-name><surname>Sunagawa</surname><given-names>S.</given-names></string-name>, <string-name><surname>Plichta</surname><given-names>D.R.</given-names></string-name>, <string-name><surname>Gautier</surname><given-names>L.</given-names></string-name>, <string-name><surname>Pedersen</surname><given-names>A.G.</given-names></string-name>, <string-name><surname>Le Chatelier</surname><given-names>E.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Identification and assembly of genomes and genetic elements in complex metagenomic samples without using reference genomes</article-title>. <source>Nat. Biotechnol.</source><year>2014</year>; <volume>32</volume>:<fpage>822</fpage>–<lpage>828</lpage>.<pub-id pub-id-type="pmid">24997787</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Obregon-Tito</surname><given-names>A.J.</given-names></string-name>, <string-name><surname>Tito</surname><given-names>R.Y.</given-names></string-name>, <string-name><surname>Metcalf</surname><given-names>J.</given-names></string-name>, <string-name><surname>Sankaranarayanan</surname><given-names>K.</given-names></string-name>, <string-name><surname>Clemente</surname><given-names>J.C.</given-names></string-name>, <string-name><surname>Ursell</surname><given-names>L.K.</given-names></string-name>, <string-name><surname>Zech Xu</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Van Treuren</surname><given-names>W.</given-names></string-name>, <string-name><surname>Knight</surname><given-names>R.</given-names></string-name>, <string-name><surname>Gaffney</surname><given-names>P.M.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Subsistence strategies in traditional societies distinguish gut microbiomes</article-title>. <source>Nat. Commun.</source><year>2015</year>; <volume>6</volume>:<fpage>6505</fpage>.<pub-id pub-id-type="pmid">25807110</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rampelli</surname><given-names>S.</given-names></string-name>, <string-name><surname>Schnorr</surname><given-names>S.L.</given-names></string-name>, <string-name><surname>Consolandi</surname><given-names>C.</given-names></string-name>, <string-name><surname>Turroni</surname><given-names>S.</given-names></string-name>, <string-name><surname>Severgnini</surname><given-names>M.</given-names></string-name>, <string-name><surname>Peano</surname><given-names>C.</given-names></string-name>, <string-name><surname>Brigidi</surname><given-names>P.</given-names></string-name>, <string-name><surname>Crittenden</surname><given-names>A.N.</given-names></string-name>, <string-name><surname>Henry</surname><given-names>A.G.</given-names></string-name>, <string-name><surname>Candela</surname><given-names>M.</given-names></string-name></person-group><article-title>Metagenome Sequencing of the Hadza Hunter-Gatherer Gut Microbiota</article-title>. <source>Curr. Biol.</source><year>2015</year>; <volume>25</volume>:<fpage>1682</fpage>–<lpage>1693</lpage>.<pub-id pub-id-type="pmid">25981789</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeller</surname><given-names>G.</given-names></string-name>, <string-name><surname>Tap</surname><given-names>J.</given-names></string-name>, <string-name><surname>Voigt</surname><given-names>A.Y.</given-names></string-name>, <string-name><surname>Sunagawa</surname><given-names>S.</given-names></string-name>, <string-name><surname>Kultima</surname><given-names>J.R.</given-names></string-name>, <string-name><surname>Costea</surname><given-names>P.I.</given-names></string-name>, <string-name><surname>Amiot</surname><given-names>A.</given-names></string-name>, <string-name><surname>Bohm</surname><given-names>J.</given-names></string-name>, <string-name><surname>Brunetti</surname><given-names>F.</given-names></string-name>, <string-name><surname>Habermann</surname><given-names>N.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Potential of fecal microbiota for early-stage detection of colorectal cancer</article-title>. <source>Mol. Syst. Biol.</source><year>2014</year>; <volume>10</volume>:<fpage>766</fpage>.<pub-id pub-id-type="pmid">25432777</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>O’Leary</surname><given-names>N.A.</given-names></string-name>, <string-name><surname>Wright</surname><given-names>M.W.</given-names></string-name>, <string-name><surname>Brister</surname><given-names>J.R.</given-names></string-name>, <string-name><surname>Ciufo</surname><given-names>S.</given-names></string-name>, <string-name><surname>Haddad</surname><given-names>D.</given-names></string-name>, <string-name><surname>McVeigh</surname><given-names>R.</given-names></string-name>, <string-name><surname>Rajput</surname><given-names>B.</given-names></string-name>, <string-name><surname>Robbertse</surname><given-names>B.</given-names></string-name>, <string-name><surname>Smith-White</surname><given-names>B.</given-names></string-name>, <string-name><surname>Ako-Adjei</surname><given-names>D.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Reference sequence (RefSeq) database at NCBI: current status, taxonomic expansion, and functional annotation</article-title>. <source>Nucleic Acids Res.</source><year>2016</year>; <volume>44</volume>:<fpage>D733</fpage>–<lpage>D745</lpage>.<pub-id pub-id-type="pmid">26553804</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Camacho</surname><given-names>C.</given-names></string-name>, <string-name><surname>Coulouris</surname><given-names>G.</given-names></string-name>, <string-name><surname>Avagyan</surname><given-names>V.</given-names></string-name>, <string-name><surname>Ma</surname><given-names>N.</given-names></string-name>, <string-name><surname>Papadopoulos</surname><given-names>J.</given-names></string-name>, <string-name><surname>Bealer</surname><given-names>K.</given-names></string-name>, <string-name><surname>Madden</surname><given-names>T.L.</given-names></string-name></person-group><article-title>BLAST+: architecture and applications</article-title>. <source>BMC Bioinformatics</source>. <year>2009</year>; <volume>10</volume>:<fpage>421</fpage>.<pub-id pub-id-type="pmid">20003500</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jain</surname><given-names>C.</given-names></string-name>, <string-name><surname>Rodriguez</surname><given-names>R.L.</given-names></string-name>, <string-name><surname>Phillippy</surname><given-names>A.M.</given-names></string-name>, <string-name><surname>Konstantinidis</surname><given-names>K.T.</given-names></string-name>, <string-name><surname>Aluru</surname><given-names>S.</given-names></string-name></person-group><article-title>High throughput ANI analysis of 90K prokaryotic genomes reveals clear species boundaries</article-title>. <source>Nat. Commun.</source><year>2018</year>; <volume>9</volume>:<fpage>5114</fpage>.<pub-id pub-id-type="pmid">30504855</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Borodovsky</surname><given-names>M.</given-names></string-name>, <string-name><surname>McIninch</surname><given-names>J.</given-names></string-name></person-group><article-title>GENMARK: parallel gene recognition for both DNA strands</article-title>. <source>Comput. Chem.</source><year>1993</year>; <volume>17</volume>:<fpage>123</fpage>–<lpage>133</lpage>.</mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burge</surname><given-names>C.</given-names></string-name>, <string-name><surname>Karlin</surname><given-names>S.</given-names></string-name></person-group><article-title>Prediction of complete gene structures in human genomic DNA</article-title>. <source>J. Mol. Biol.</source><year>1997</year>; <volume>268</volume>:<fpage>78</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">9149143</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stanke</surname><given-names>M.</given-names></string-name>, <string-name><surname>Waack</surname><given-names>S.</given-names></string-name></person-group><article-title>Gene prediction with a hidden Markov model and a new intron submodel</article-title>. <source>Bioinformatics</source>. <year>2003</year>; <volume>19</volume>(<issue>Suppl. 2</issue>):<fpage>ii215</fpage>–<lpage>ii225</lpage>.<pub-id pub-id-type="pmid">14534192</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ivanova</surname><given-names>N.N.</given-names></string-name>, <string-name><surname>Schwientek</surname><given-names>P.</given-names></string-name>, <string-name><surname>Tripp</surname><given-names>H.J.</given-names></string-name>, <string-name><surname>Rinke</surname><given-names>C.</given-names></string-name>, <string-name><surname>Pati</surname><given-names>A.</given-names></string-name>, <string-name><surname>Huntemann</surname><given-names>M.</given-names></string-name>, <string-name><surname>Visel</surname><given-names>A.</given-names></string-name>, <string-name><surname>Woyke</surname><given-names>T.</given-names></string-name>, <string-name><surname>Kyrpides</surname><given-names>N.C.</given-names></string-name>, <string-name><surname>Rubin</surname><given-names>E.M.</given-names></string-name></person-group><article-title>Stop codon reassignments in the wild</article-title>. <source>Science</source>. <year>2014</year>; <volume>344</volume>:<fpage>909</fpage>–<lpage>913</lpage>.<pub-id pub-id-type="pmid">24855270</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haft</surname><given-names>D.H.</given-names></string-name>, <string-name><surname>DiCuccio</surname><given-names>M.</given-names></string-name>, <string-name><surname>Badretdin</surname><given-names>A.</given-names></string-name>, <string-name><surname>Brover</surname><given-names>V.</given-names></string-name>, <string-name><surname>Chetvernin</surname><given-names>V.</given-names></string-name>, <string-name><surname>O’Neill</surname><given-names>K.</given-names></string-name>, <string-name><surname>Li</surname><given-names>W.</given-names></string-name>, <string-name><surname>Chitsaz</surname><given-names>F.</given-names></string-name>, <string-name><surname>Derbyshire</surname><given-names>M.K.</given-names></string-name>, <string-name><surname>Gonzales</surname><given-names>N.R.</given-names></string-name><etal>et al</etal>.</person-group><article-title>RefSeq: an update on prokaryotic genome annotation and curation</article-title>. <source>Nucleic Acids Res.</source><year>2018</year>; <volume>46</volume>:<fpage>D851</fpage>–<lpage>D860</lpage>.<pub-id pub-id-type="pmid">29112715</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morgulis</surname><given-names>A.</given-names></string-name>, <string-name><surname>Coulouris</surname><given-names>G.</given-names></string-name>, <string-name><surname>Raytselis</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Madden</surname><given-names>T.L.</given-names></string-name>, <string-name><surname>Agarwala</surname><given-names>R.</given-names></string-name>, <string-name><surname>Schaffer</surname><given-names>A.A.</given-names></string-name></person-group><article-title>Database indexing for production MegaBLAST searches</article-title>. <source>Bioinformatics</source>. <year>2008</year>; <volume>24</volume>:<fpage>1757</fpage>–<lpage>1764</lpage>.<pub-id pub-id-type="pmid">18567917</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buchfink</surname><given-names>B.</given-names></string-name>, <string-name><surname>Xie</surname><given-names>C.</given-names></string-name>, <string-name><surname>Huson</surname><given-names>D.H.</given-names></string-name></person-group><article-title>Fast and sensitive protein alignment using DIAMOND</article-title>. <source>Nat. Methods</source>. <year>2015</year>; <volume>12</volume>:<fpage>59</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">25402007</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
