<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10240112</article-id>
    <article-id pub-id-type="publisher-id">5364</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05364-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>LAPIS is a fast web API for massive open virus sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8763-2937</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Chaoran</given-names>
        </name>
        <address>
          <email>chaoran.chen@bsse.ethz.ch</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2177-7092</contrib-id>
        <name>
          <surname>Taepper</surname>
          <given-names>Alexander</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2693-084X</contrib-id>
        <name>
          <surname>Engelniederhammer</surname>
          <given-names>Fabian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8033-2811</contrib-id>
        <name>
          <surname>Kellerer</surname>
          <given-names>Jonas</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6138-6539</contrib-id>
        <name>
          <surname>Roemer</surname>
          <given-names>Cornelius</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6431-535X</contrib-id>
        <name>
          <surname>Stadler</surname>
          <given-names>Tanja</given-names>
        </name>
        <address>
          <email>tanja.stadler@bsse.ethz.ch</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5801.c</institution-id><institution-id institution-id-type="ISNI">0000 0001 2156 2780</institution-id><institution>Department of Biosystems Science and Engineering, </institution><institution>ETH Zürich, </institution></institution-wrap>Basel, Switzerland </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.419765.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 2223 3006</institution-id><institution>Swiss Institute of Bioinformatics, </institution></institution-wrap>Basel, Switzerland </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.6936.a</institution-id><institution-id institution-id-type="ISNI">0000000123222966</institution-id><institution>School of Computation, Information and Technology - Informatics, </institution><institution>TU Munich, </institution></institution-wrap>Munich, Germany </aff>
      <aff id="Aff4"><label>4</label>TNG Technology Consulting GmbH, Unterföhring, Germany </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.6612.3</institution-id><institution-id institution-id-type="ISNI">0000 0004 1937 0642</institution-id><institution>Biozentrum, University of Basel, </institution></institution-wrap>Basel, Switzerland </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>5</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>232</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Recent epidemic outbreaks such as the SARS-CoV-2 pandemic and the mpox outbreak in 2022 have demonstrated the value of genomic sequencing data for tracking the origin and spread of pathogens. Laboratories around the globe generated new sequences at unprecedented speed and volume and bioinformaticians developed new tools and dashboards to analyze this wealth of data. However, a major challenge that remains is the lack of simple and efficient approaches for accessing and processing sequencing data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">The Lightweight API for Sequences (LAPIS) facilitates rapid retrieval and analysis of genomic sequencing data through a REST API. It supports complex mutation- and metadata-based queries and can perform aggregation operations on massive datasets. LAPIS is optimized for typical questions relevant to genomic epidemiology. Using a newly-developed in-memory database engine, it has a high speed and throughput: between 25 January and 4 February 2023, the SARS-CoV-2 instance of LAPIS, which contains 14.5 million sequences, processed over 20 million requests with a mean response time of 411 ms and a median response time of 1 ms. LAPIS is the core engine behind our dashboards on genspectrum.org and we currently maintain public LAPIS instances for SARS-CoV-2 and mpox.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Powered by an optimized database engine and available through a web API, LAPIS enhances the accessibility of genomic sequencing data. It is designed to serve as a common backend for dashboards and analyses with the potential to be integrated into common database platforms such as GenBank.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001711</institution-id>
            <institution>Schweizerischer Nationalfonds zur Förderung der Wissenschaftlichen Forschung</institution>
          </institution-wrap>
        </funding-source>
        <award-id>31CA30_196267</award-id>
        <principal-award-recipient>
          <name>
            <surname>Stadler</surname>
            <given-names>Tanja</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Swiss Federal Institute of Technology Zurich</institution>
        </funding-source>
      </award-group>
      <open-access>
        <p>Open access funding provided by Swiss Federal Institute of Technology Zurich</p>
      </open-access>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par7">Pathogen genomic sequencing data are a key public health resource for responding to epidemic outbreaks. During the early stages of an outbreak, genomic sequencing data are essential for understanding the origin, evolution, and extent of spread of the pathogen [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. At later stages, sequencing data are the primary early indicator of evolutionary and epidemiological changes, as demonstrated repeatedly with SARS-CoV-2 variants [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. Rapid analysis of sequencing data is therefore a crucial component for evidence-based public health responses. Although a lot of infrastructure for generating and analyzing genomic sequencing data in real-time was established during the SARS-CoV-2 pandemic, major challenges remain [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>].</p>
    <p id="Par8">The unprecedented scale of SARS-CoV-2 sequence generation, coupled with enormous popular interest in these data, highlights a need for user-friendly tools for analyzing massive sequence data sets. One such category of tools is web dashboards. Once set up, these can be used by a wide audience without requiring programming and data science knowledge. Examples of popular dashboards that digest massive SARS-CoV-2 data sets include the CDC’s COVID Data Tracker [<xref ref-type="bibr" rid="CR6">6</xref>], CoVariants [<xref ref-type="bibr" rid="CR13">13</xref>], Outbreak.info [<xref ref-type="bibr" rid="CR12">12</xref>], and our own CoV-Spectrum dashboard [<xref ref-type="bibr" rid="CR8">8</xref>]. Another category of tools that facilitate quick, ad-hoc analyses are “notebooks” like Jupyter Notebooks and R Markdown scripts. Notebooks are useful to data scientists with programming knowledge to quickly perform their own statistical analyses and generate their own plots. Combined, dashboards and notebooks allow different users to access different visualizations and focus on different aspects of the data. In this way, everyone from experts like scientists and public health agencies to the general public can benefit from sequence data.</p>
    <p id="Par9">Many of these tools for sequence data analysis require common operations on sequence data like filtering, stratification, and aggregation. For instance, filtering for sequences with certain mutations and calculating the relative frequency of mutations are commonly performed operations for genome sequencing data. Although these operations are simple in principle, the gigantic size of modern genome sequence data sets makes them non-trivial. Over 14 million SARS-CoV-2 sequences are available, and up to hundreds of thousands of new sequences are added weekly. General-purpose database systems such as PostgreSQL are not optimized for genomic sequence analysis on this scale.</p>
    <p id="Par10">Our resource LAPIS (Lightweight API for Sequences) is designed to perform common data operations on millions of genomic sequences within milliseconds, facilitating interactive data exploration. Using a self-written in-memory database engine, it is optimized for filtering and aggregating large genomic sequencing data sets. Accessible through a web API (application programming interface), we believe that LAPIS can serve as a common backend for many dashboards and analyses (e.g., through notebooks). This would relieve scientists and dashboard builders from the costly but boring task of developing their own databases and implementing common basic operations. Instead, they would be free to focus on analysis and visualization tasks. Furthermore, LAPIS streamlines the direct download of cleaned and pre-processed data including aligned and unaligned sequences.</p>
    <p id="Par11">In contrast to data repositories like GenBank [<xref ref-type="bibr" rid="CR3">3</xref>], LAPIS is not a broad database but a targeted data service. While GenBank contains sequences from more than 400,000 species and aims to provide a general and stable data source, LAPIS supports features specific to an outbreak species like lineage/clade annotation and filtering by mutations from a reference genome. In this way, LAPIS aims to support answering current research and public health questions about emerging pathogen threats.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Functionalities</title>
      <p id="Par12">LAPIS implements many of the same functionalities as GenBank and additionally supports novel download, filter, and aggregation functionalities to support outbreak analysis (Table <xref rid="Tab1" ref-type="table">1</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Feature comparisons between GenBank and LAPIS</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Feature</th><th align="left">GenBank</th><th align="left">LAPIS</th></tr></thead><tbody><tr><td align="left">Download metadata</td><td align="left"><inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M2"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq1.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M4"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq2.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Download unaligned sequences</td><td align="left"><inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M6"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq3.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M8"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq4.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Download aligned sequences</td><td align="left"><inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M10"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq5.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M12"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq6.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Download protein amino acid sequences</td><td align="left"><inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M14"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq7.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M16"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq8.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Download mutations</td><td align="left"><inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M18"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq9.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M20"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq10.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Filter by basic metadata (country, date, etc.)</td><td align="left"><inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M22"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq11.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M24"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq12.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Filter by lineage/clade</td><td align="left"><inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M26"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq13.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M28"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq14.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Filter by mutations</td><td align="left"><inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M30"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq15.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M32"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq16.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Perform aggregation</td><td align="left"><inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M34"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq17.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M36"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq18.gif"/></alternatives></inline-formula></td></tr></tbody></table></table-wrap></p>
      <p id="Par13">The simplest way to use LAPIS is to encode a query in a URL prefixed with a particular LAPIS endpoint. Each LAPIS endpoint supports a different type of query and returns a different type of data (e.g., aggregated data, sequence data, mutations, etc.). Figure <xref rid="Fig1" ref-type="fig">1</xref> illustrates a URL query structure. In the following sections, we explain the different parts of a query in more detail.<fig id="Fig1"><label>Fig. 1</label><caption><p>Components of a query link</p></caption><graphic xlink:href="12859_2023_5364_Fig1_HTML" id="MO1"/></fig></p>
      <sec id="Sec4">
        <title>Aggregation and stratification</title>
        <p id="Par14">LAPIS implements two types of endpoints: endpoints that provide aggregated data and endpoints that provide per-sample data. We describe the first type in this section and the second type in the next.</p>
        <p id="Par15">The aggregated endpoint counts the number of samples that fulfill user-defined filters in a query. If the fields parameter is not set, it returns the total number of samples. By setting fields, we can stratify the data. E.g., /aggregated?fields=pangoLineage,country will return the number of samples per Pango lineage and country. The fields parameter accepts all metadata and lineage-defining fields but not mutations or insertions.</p>
        <p id="Par16">To calculate the distribution of mutations and insertions, LAPIS offers the endpoints nuc-mutations, aa-mutations, nuc-insertions, and aa-insertions. They return the number of occurrences of mutations in a set of samples and their proportions. When calculating the proportions, the unknown or ambiguous bases are excluded. For example, if there are 10 sequences, 3 sequences have a mutation from A to G at position 5, 3 sequences have the reference base A, and 4 sequences have an N (i.e., unknown) at position 5, the proportion of the mutation A5G is <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{3}{6} = 0.5$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mn>6</mml:mn></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq19.gif"/></alternatives></inline-formula> (and not <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{3}{10} = 0.3$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mn>10</mml:mn></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq20.gif"/></alternatives></inline-formula>).</p>
      </sec>
      <sec id="Sec5">
        <title>Data download</title>
        <p id="Par17">LAPIS can also be used to obtain non-aggregated data. The details endpoint returns the metadata and supports an optional fields parameter that can be used to limit the desired metadata fields. The nuc-sequence and nuc-sequence-aligned endpoints return the original and aligned nucleotide sequences, respectively. Finally, the aa-sequence-aligned/gene endpoint (e.g., aa-sequence-aligned/S for the SARS-CoV-2 Spike protein) returns the aligned amino acid sequences.</p>
      </sec>
      <sec id="Sec6">
        <title>Filters and advanced variant queries</title>
        <p id="Par18">By default (i.e., without specifying additional parameters), a query is evaluated on the whole set of sequences. To query a subset of sequences, a wide range of filters is available. It includes filtering by metadata, lineage names, and mutations. As shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, filters can be set by adding request parameters to the end of the URL. If multiple filters are set, the samples that fulfill all of them will be selected.</p>
        <p id="Par19">For ordinal data like dates, there are two available filters: one with a From-suffix for the lower bound and one with a To-suffix for the upper bound. E.g., dateFrom=2023-01-01 &amp;dateTo=2023-01-31 will filter for samples from January 2023.</p>
        <p id="Par20">LAPIS additionally supports two different ways to specify a variant. The simple approach is similar to the metadata filters and can be used to filter samples that fulfill all of a list of conditions. Possible parameters for the SARS-CoV-2 instance include pangoLineage, aaMutations, nucMutations, aaInsertions, etc. For the mutations/insertions, it is possible to use a comma-separated list. An example of a simple variant filter would be pangoLineage=XBB.1* &amp;aaMutations=S:E484R,S:K417T. The * behind XBB.1 means all sub-lineages of the Pango lineage XBB.1 will also be included in the query. Insertion queries may contain wildcards, for instance, ins:1000:AAT?. This filters for all sequences with an insertion that starts with AAT between positions 1000 and 1001.</p>
        <p id="Par21">The second approach is using advanced variant queries. Advanced variant queries support more than the conjunction of a list of conditions – they also allow Boolean logic and threshold queries. One example is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. Examples of real-world, user-defined advanced variant queries can be found in the CoV-Spectrum Collections<xref ref-type="fn" rid="Fn1">1</xref> where users can define and monitor sets of variants specified by advanced variant queries. In particular, the threshold queries have proven highly valuable. For example, they have been recently used to group sequences that share the same number of mutations in the receptor binding domain (RBD) [<xref ref-type="bibr" rid="CR5">5</xref>].<fig id="Fig2"><label>Fig. 2</label><caption><p>Components of an advanced variant query</p></caption><graphic xlink:href="12859_2023_5364_Fig2_HTML" id="MO2"/></fig></p>
      </sec>
      <sec id="Sec7">
        <title>“Maybe” queries</title>
        <p id="Par22">Advanced variant queries further support “maybe” queries. These queries find sequences that <italic>might</italic> have a certain mutation instead of definitely having a certain mutation. By default, when filtering for a mutation, LAPIS returns sequences for which the mutation is confirmed. E.g., the query A5G selects sequences with a G at position 5. This is a conservative way of filtering. In practice, we don’t know the values at every position of every sequence: for some sequences, we might have a N (=unknown/everything is possible) or another ambiguity code that includes G such as K (=G or T) at position 5. For those samples, it is possible that, in reality, they do have the mutation A5G. This implies that the aggregated endpoint usually<xref ref-type="fn" rid="Fn2">2</xref> provides the lower-bound number of samples when we filter for mutations. “maybe” queries allow us to obtain the corresponding upper bound. For the A5G example, sequences with a N, X, R, S, V, D and B at position 5 will also be included. Maybe queries are part of the advanced variant queries. For example, we can query maybe(5 G) &amp; maybe(6T). In fact, we can write arbitrary variant query expressions in a maybe() clause. Equivalent to the previous example, we can write maybe(5 G &amp; 6T). A more complex example would be maybe((S:10K &amp; !S:11 H) &amp; [2-of: 100A, 101T, 102 G]).</p>
        <p id="Par23">While the previous examples appear simple and intuitive, it is not always straightforward to determine the semantics of a maybe query. Let us consider the nucleotide sequence ATGCNT. It has one unknown at position 5. The sequence would neither match the query 5A nor 5C but it would match maybe(5A) and it would also match maybe(5C). What’s about maybe(5A) &amp; maybe(5C)? From a Boolean logic perspective, if we consider maybe(5A) and maybe(5C) to be true, then their conjunction must be true as well. On the other hand, a sequence cannot have two different bases at the same position; thus, shouldn’t maybe(5A) &amp; maybe(5C) be a contradiction and unconditionally false? LAPIS would evaluate maybe(5A) &amp; maybe(5C) for the aforementioned sequence to be true. The main reason we decided on this semantic is that it is possible to evaluate it efficiently.<xref ref-type="fn" rid="Fn3">3</xref></p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Performance</title>
      <p id="Par24">LAPIS is computationally efficient. It has proven capable of reliably processing millions of requests per day with most response times within a few hundred milliseconds as the backend to our CoV-Spectrum dashboard.</p>
      <p id="Par25">We currently run the LAPIS instance for SARS-CoV-2 data from GISAID on an AWS r5.8xlarge server (256 GB RAM, 32 vCPUs).<xref ref-type="fn" rid="Fn4">4</xref> Between 25 January<xref ref-type="fn" rid="Fn5">5</xref> and 4 February 2023, it processed over 20 million requests with a mean response time of 411 ms and a median response time of 1 ms (Table <xref rid="Tab2" ref-type="table">2</xref>). This low median response time was possible because 72% of all responses had been cached (“section <xref rid="Sec19" ref-type="sec">Caching</xref>”), which greatly reduces response time (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). Altogether, 83% of requests to the SARS-CoV-2 instance of LAPIS were processed within 500 ms.</p>
      <p id="Par26">LAPIS often has to process many requests in parallel. It is quite common to have very few requests in one minute and over a thousand in the next (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). The CoV-Spectrum collections are a major reason for that. In the user-defined collections, users can see information about many variants simultaneously. When a collection page is opened, the web application sends one request per variant to the server at the same time, and some collections (e.g., collection 24<xref ref-type="fn" rid="Fn6">6</xref>) have hundreds of variants. When we consider only requests that were executed when the server had less than 100 parallel requests (that is the case for 79% of the requests), 97% of the requests were processed within 500 ms (Fig. <xref rid="Fig5" ref-type="fig">﻿5</xref>).</p>
      <p id="Par27">In summary, the computational efficiency of LAPIS makes it suitable as a back-end for other tools and websites, including responsive and interactive dashboards and workflows. LAPIS achieves computational efficiency through a newly-developed data processing engine (see “section <xref rid="Sec13" ref-type="sec">Data query engine</xref>”) that is optimized for genomic data. It can perform common operations like searching for nucleotide mutations and amino acid changes in millions of sequences and hundreds of gigabytes of data within tens to hundreds of milliseconds.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Empirical data on the usage and performance of the endpoints</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Endpoint</th><th align="left">Number of requests</th><th align="left">Cache hit</th><th align="left">Response time (mean/median, in ms)</th></tr></thead><tbody><tr><td align="left">aa-insertions</td><td align="left">34,212 (0.17%)</td><td align="left">14.19%</td><td align="left">654/254</td></tr><tr><td align="left">aa-mutations</td><td align="left">101,346 (0.49%)</td><td align="left">20.86%</td><td align="left">1050/267</td></tr><tr><td align="left">aggregated</td><td align="left">20,302,815 (98.85%)</td><td align="left">72.66%</td><td align="left">404/1</td></tr><tr><td align="left">nuc-insertions</td><td align="left">34,221 (0.17%)</td><td align="left">14.20%</td><td align="left">639/252</td></tr><tr><td align="left">nuc-mutations</td><td align="left">66,731 (0.32%)</td><td align="left">24.32%</td><td align="left">1203/266</td></tr></tbody></table></table-wrap></p>
      <p id="Par28">
        <fig id="Fig3">
          <label>Fig. 3</label>
          <caption>
            <p>Number of requests within a day. Each bar represents one minute. In total, there were 208249 requests</p>
          </caption>
          <graphic xlink:href="12859_2023_5364_Fig3_HTML" id="MO3"/>
        </fig>
        <fig id="Fig4">
          <label>Fig. 4</label>
          <caption>
            <p>Proportion of requests for the different response time bins, stratified by cache status</p>
          </caption>
          <graphic xlink:href="12859_2023_5364_Fig4_HTML" id="MO4"/>
        </fig>
        <fig id="Fig5">
          <label>Fig. 5</label>
          <caption>
            <p>Same as Fig. <xref rid="Fig4" ref-type="fig">4</xref> but only for requests executed when the server has less than 100 parallel requests</p>
          </caption>
          <graphic xlink:href="12859_2023_5364_Fig5_HTML" id="MO5"/>
        </fig>
      </p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Discussion</title>
    <p id="Par29">The unique filtering, aggregation, and download functionalities supported by LAPIS, coupled with high computational efficiency, make LAPIS a key resource for the real-time analysis of genomic sequencing data from ongoing outbreaks. LAPIS is currently available for all openly accessible SARS-CoV-2<xref ref-type="fn" rid="Fn7">7</xref> and mpox<xref ref-type="fn" rid="Fn8">8</xref> sequencing data on GenBank [<xref ref-type="bibr" rid="CR3">3</xref>]. We also maintain a private SARS-CoV-2 instance with sequencing data from GISAID [<xref ref-type="bibr" rid="CR11">11</xref>], which serves as the backend for our CoV-Spectrum dashboard.<xref ref-type="fn" rid="Fn9">9</xref></p>
    <p id="Par30">LAPIS’ SARS-CoV-2 instances highlight the value of this approach as dataset size grows. As of January 2023, more than 14,500,000 SARS-CoV-2 sequences are available on GISAID, reaching a size of over 400 GB. LAPIS is capable of querying this entire dataset efficiently, supporting an interactive user experience on our CoV-Spectrum dashboard. CoV-Spectrum mainly presents aggregated data: it visualizes temporal, geographic, and mutational distributions of variants through a large variety of charts, tables, and maps. It solely uses LAPIS for retrieving genomic data and thanks to the flexibility of LAPIS, it was possible to develop new features in CoV-Spectrum without the need of extending or adapting LAPIS.</p>
    <p id="Par31">With LAPIS’ mpox instance, we demonstrated the adaptability of the API approach. At the start of the mpox outbreak in 2022, within a few days of the release of the first sequence, we set up a LAPIS instance to support rapid sharing and easy access to open genomic data. It was accompanied by the MpoxSpectrum dashboard<xref ref-type="fn" rid="Fn10">10</xref> which, in addition to providing overview plots, enabled users to look up samples, download pre-processed metadata and aligned sequences, and open them in the Nextclade tool. To use the Nextclade integration feature, users can select sequences of interest on the MpoxSpectrum dashboard and Nextclade will download the sequences from LAPIS for quality analysis. Further, just four hours after we publicized LAPIS for mpox on Twitter, Taxonium announced the launch of a mpox service using LAPIS data as data source [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>].</p>
    <p id="Par32">These successes highlight that LAPIS fills a necessary role in addressing common challenges for accessing and analyzing genomic sequencing data. As demonstrated with mpox, LAPIS is easily extendable to other organisms. While supporting a new pathogen currently requires changes to the code base, we are actively working to generalize the LAPIS code to enable users to deploy instances with their own data and for other pathogens, possibly containing additional private metadata, via a configuration file. This will allow independent groups to run LAPIS instances for different use cases, akin to how Nextstrain publishes phylogenetic analyses for a limited number of pathogens but also provides the same analysis tools as an open-source resource for researchers to set up their own analyses. We hope to increase the incentive for data sharing in the public domain with this open-source philosophy: with the support of the API, researchers can directly analyze their own shared data within the global genomic context.</p>
    <p id="Par33">Going forward, we see great potential for database platforms such as GenBank to directly integrate APIs with functionalities like LAPIS’s into their framework. This avoids the necessity of hosting data in a second database and allows researchers to benefit from functionality provided by an API such as LAPIS for many different organisms. On the research side, this requires developing techniques for efficiently querying even larger genomic data sets. The current implementation of LAPIS is capable of supporting up to around 20 to 30 million sequences of length 30kBp. We are working on better algorithms to push this boundary.</p>
  </sec>
  <sec id="Sec10">
    <title>Conclusions</title>
    <p id="Par34">In summary, we introduce an in-memory database engine for genomic sequencing data which can be accessed through an API. This framework facilitates the analysis of millions of sequences in real time, meaning users can interactively query and filter sequencing data. In particular, our framework supports the analysis of open genomic sequencing data and enables researchers and authorities to rapidly analyze the evolution and epidemiology of pathogens for evidence-based public health response.</p>
  </sec>
  <sec id="Sec11">
    <title>Methods</title>
    <sec id="Sec12">
      <title>Data pre-processing</title>
      <p id="Par35">For the three LAPIS instances we currently maintain, we download the raw data from GISAID (SARS-CoV-2) or Nextstrain which retrieved it from GenBank (SARS-CoV-2 and mpox). The raw data contain the genomic (consensus) sequences and corresponding metadata. We pre-process the data in two steps. During the first step, we clean up the metadata, align the sequences to a reference genome, and translate the nucleotide sequences to protein amino acid sequences. For the alignment and translation, we use Nextclade [<xref ref-type="bibr" rid="CR2">2</xref>] but other tools are equally applicable. The first step is not specific to LAPIS and can be replaced by alternative pipelines that produce an alignment and protein sequences. During the second step, we perform LAPIS-specific transformations and generate compressed columnar sequences (“section <xref rid="Sec14" ref-type="sec">Column-wise storage</xref>” and “<xref rid="Sec20" ref-type="sec">Compression</xref>”). The pre-processed data are loaded into the in-memory database (“section <xref rid="Sec13" ref-type="sec">Data query engine</xref>”) and exposed through a REST API. Figure <xref rid="Fig6" ref-type="fig">6</xref> illustrates the workflow.<fig id="Fig6"><label>Fig. 6</label><caption><p>Data pre-processing workflow</p></caption><graphic xlink:href="12859_2023_5364_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par36">We store the pre-processed data – both after the first and after the second step – in a PostgreSQL database. Hereby, the PostgreSQL database only serves as a background storage and can be easily replaced by the file system or a different database system. It is not crucial to the performance of LAPIS outside of the pre-processing pipeline because the in-memory database is used for evaluating the queries.</p>
    </sec>
    <sec id="Sec13">
      <title>Data query engine</title>
      <p id="Par37">We developed a novel data query engine for our public web API that is tailored to support real-time, interactive genomic surveillance and genomic epidemiology. Specifically, it is designed to support high numbers of requests and fast query processing of genomic sequencing data. Our internal SARS-CoV-2 LAPIS instance based on GISAID data currently receives hundreds of thousands of requests per day, mostly from users of CoV-Spectrum. At the same time, it must support interactive and exploratory analyses where the user is able to switch quickly between different variants, countries, and time periods by responding to most requests within tens to hundreds of milliseconds. Existing database systems are not sufficient for this task.</p>
      <sec id="Sec14">
        <title>Column-wise storage</title>
        <p id="Par38">Our approach is based on techniques developed for column-oriented database systems [<xref ref-type="bibr" rid="CR1">1</xref>]. In the pre-processing step, we transform the sequencing data into a columnar format. For each position in the aligned nucleotide sequence or in the aligned amino acid sequence, we construct a string with the characters of all sequences at that position (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). The <italic>i</italic>-th character in the new, columnar sequence corresponds to the sequence with the ID <italic>i</italic>. To find sequences with a mutation at a given position, we then only need to read a single string and not filter through each sequence. The columnar sequences are easy to compress (“section <xref rid="Sec20" ref-type="sec">Compression</xref>”), and by compressing them, we can cache them in memory and eliminate any disk and round-trip time to the database.<fig id="Fig7"><label>Fig. 7</label><caption><p>Transformation of sequences to the columnar format: The row-oriented storage maintains one string per sequence; in contrast, the column-oriented storage keeps one string per position</p></caption><graphic xlink:href="12859_2023_5364_Fig7_HTML" id="MO7"/></fig></p>
      </sec>
      <sec id="Sec15">
        <title>Filter insertions</title>
        <p id="Par39">The column store as described in the previous subsection can only store the aligned sequences. It has one column for each base of the reference genome but it cannot store insertions which are parts of a sequence that cannot be directly linked to the positions of the reference. To filter for insertions, LAPIS uses a dedicated insertion store which maintains for each position of the reference genome a mapping of inserted values to sequences with the insertion. E.g., a mapping of AATGGC at position 1000 to {sequence1, sequence2, sequence3} means that there are three sequences that have the insertion AATGGC between position 1000 and 1001.</p>
        <p id="Par40">To evaluate a query such as ins:1000:AAT? as described in “section <xref rid="Sec6" ref-type="sec">Filters and advanced variant queries</xref>”, LAPIS looks up the insertions at position 1000 and matches them against the requested pattern. For the SARS-CoV-2 data, this approach works well because insertions are rare, short, and not very diverse. For genomic data with many long and diverse insertions, this method is not very efficient.</p>
      </sec>
      <sec id="Sec16">
        <title>Sequence downloads</title>
        <p id="Par41">To download whole sequences, LAPIS first filters the sequences with the in-memory query engine, fetches compressed sequences (“section <xref rid="Sec20" ref-type="sec">Compression</xref>”) from the background storage (“section <xref rid="Sec12" ref-type="sec">Data pre-processing</xref>”), and decompresses them. If a large set of sequences should be downloaded, it fetches the sequences in small batches and streams them to the user to ensure a low memory footprint.</p>
      </sec>
      <sec id="Sec17">
        <title>Discussion</title>
        <p id="Par42">The data engine was first deployed when there were around one million genomic sequences for SARS-CoV-2, and it still performs well for 15 million sequences today. It is a significant improvement to using common relational database systems which are not optimized for genomic sequencing data. The current algorithm is simple and easy to implement. However, it is also rather naive and not using state-of-the-art database engineering techniques. We are working on an improved version with reduced response times and higher throughput and look forward to sharing our results in the near future.</p>
      </sec>
    </sec>
    <sec id="Sec18">
      <title>Data versions</title>
      <p id="Par43">To allow the user to use consistent data, each response of LAPIS contains the version of the data. The user can then check if the data versions of multiple requests are the same, and reload if that is not the case. The data version is provided in the HTTP response header LAPIS-Data-Version. For JSON responses, the data version is further given in the dataVersion field.</p>
      <p id="Par44">For example, this is relevant to compute the proportion of a variant in the sequencing data. For the calculation, we would fetch the number of sequences of the variant and the total number of sequences; that means that two API calls are required. In this case, data could be updated between the two calls which would lead to wrong results because the nominator and denominator to calculate the proportion are incompatible. Comparing the data versions of the two requests would prevent an error.</p>
    </sec>
    <sec id="Sec19">
      <title>Caching</title>
      <p id="Par45">To minimize the response time for common requests, LAPIS caches the results of previously evaluated queries in a Redis database. Caching is usually a difficult task due to the complexity to determine when a cache entry is stale. In the case of LAPIS, however, we have the advantage that we do not have a continuous stream of small data changes but perform rare (e.g., once a day) but big updates. This allows us to distinguish different versions of the data (“section <xref rid="Sec18" ref-type="sec">Data versions</xref>”).</p>
      <p id="Par46">Each cached result is linked to a data version. If the user defines a data version in a request, and the result generated from the data of the specified version is in the cache, it can be returned immediately. If the user does not define a data version, LAPIS will check if the result for the most recent data version is cached. Figures <xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref> and Table <xref rid="Tab2" ref-type="table">2</xref> show the proportions of cache hits.</p>
    </sec>
    <sec id="Sec20">
      <title>Compression</title>
      <p id="Par47">We compress the genome sequences before inserting them into the database. We use Zstd (level 3) [<xref ref-type="bibr" rid="CR10">10</xref>] which gives us a good balance between compression ratio and speed. For the compression of the whole nucleotide and amino acid sequences, we use the respective reference sequence as the pre-defined dictionary to improve the compression ratio. For the columnar sequences, a pre-defined dictionary is not needed for a good compression ratio as it is intrinsically easy to compress. We achieve a compression ratio of 94% for the unaligned sequences, 99.3% for the aligned sequences, and 96% for the sequences stored in the column-oriented format.</p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>API</term>
        <def>
          <p id="Par4">Application programming interface</p>
        </def>
      </def-item>
      <def-item>
        <term>CDC</term>
        <def>
          <p id="Par5">Centers for Disease Control and Prevention</p>
        </def>
      </def-item>
      <def-item>
        <term>LAPIS</term>
        <def>
          <p id="Par6">Lightweight API for Sequences</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p id="Par51"><ext-link ext-link-type="uri" xlink:href="https://cov-spectrum.org/collections">https://cov-spectrum.org/collections</ext-link>.</p>
    </fn>
    <fn id="Fn2">
      <label>2</label>
      <p id="Par52">There is an exception for queries that contain a negation.</p>
    </fn>
    <fn id="Fn3">
      <label>3</label>
      <p id="Par53">Although the alternative might appear more intuitive in some cases, we believe that it cannot be efficiently computed. We have not proven it formally but we think that the complexity of the alternative semantics grows exponentially with the length of the query.</p>
    </fn>
    <fn id="Fn4">
      <label>4</label>
      <p id="Par54"><ext-link ext-link-type="uri" xlink:href="https://aws.amazon.com/ec2/instance-types/">https://aws.amazon.com/ec2/instance-types/</ext-link>.</p>
    </fn>
    <fn id="Fn5">
      <label>5</label>
      <p id="Par55">We only started logging the response times in the afternoon of 24 January 2023.</p>
    </fn>
    <fn id="Fn6">
      <label>6</label>
      <p id="Par56"><ext-link ext-link-type="uri" xlink:href="https://cov-spectrum.org/collections/24">https://cov-spectrum.org/collections/24</ext-link>.</p>
    </fn>
    <fn id="Fn7">
      <label>7</label>
      <p id="Par57"><ext-link ext-link-type="uri" xlink:href="https://lapis.cov-spectrum.org/open">https://lapis.cov-spectrum.org/open</ext-link>.</p>
    </fn>
    <fn id="Fn8">
      <label>8</label>
      <p id="Par58"><ext-link ext-link-type="uri" xlink:href="https://mpox-lapis.genspectrum.org">https://mpox-lapis.genspectrum.org</ext-link>.</p>
    </fn>
    <fn id="Fn9">
      <label>9</label>
      <p id="Par59"><ext-link ext-link-type="uri" xlink:href="https://cov-spectrum.org">https://cov-spectrum.org</ext-link>.</p>
    </fn>
    <fn id="Fn10">
      <label>10</label>
      <p id="Par60"><ext-link ext-link-type="uri" xlink:href="https://mpox.genspectrum.org">https://mpox.genspectrum.org</ext-link>.</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We acknowledge all labs for the timely submission of their SARS-CoV-2 and mpox sequencing data to the ISNDC (GenBank, ENA, and DDBJ) and GISAID. We acknowledge the Nextstrain team for pre-processing the GenBank data. These efforts are core for LAPIS to share sequencing data from outbreaks as they are generated. We thank Sarah Nadeau for valuable discussions and feedback on the manuscript. We thank François Bienvenu for valuable discussions on the “maybe” queries.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>CC: Conceptualization, Data curation, Formal Analysis, Investigation, Methodology, Software, Visualization, Supervision, Writing—original draft. AT: Methodology, Software, Writing—review &amp; editing. FE: Software, Writing—review &amp; editing. JK: Software, Writing—review &amp; editing. CR: Conceptualization, Writing—review &amp; editing. TS: Conceptualization, Funding acquisition, Resources, Supervision, Writing—original draft. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Open access funding provided by Swiss Federal Institute of Technology Zurich. The authors acknowledge funding through the Swiss National Science Foundation (31CA30_196267), the Federal Office of Public Health, Switzerland (Dienstleistungsvertrag “Analysen zur Überwachung von SARS-CoV-2: Varianten-Monitoring und now-casting Hospitalisationen mit Zusatzoption Ad-hoc Analysen”), and ETH Zürich.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The code is released under the GPL-3.0 license at <ext-link ext-link-type="uri" xlink:href="https://github.com/GenSpectrum/LAPIS">https://github.com/GenSpectrum/LAPIS</ext-link>. The current study did not generate new genomic sequencing data. Part of the analyzed data is publicly available in the INSDC (GenBank/ENA/DDBJ) repositories (<ext-link ext-link-type="uri" xlink:href="https://www.insdc.org/">https://www.insdc.org/</ext-link>). The remaining part of the analyzed SARS-CoV-2 data is available in GISAID (<ext-link ext-link-type="uri" xlink:href="https://gisaid.org/">https://gisaid.org/</ext-link>) to which users with a GISAID account ﻿may have access.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par48">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par49">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par50">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abadi</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The design and implementation of modern column-oriented database systems</article-title>
        <source>Found Trends® Databases</source>
        <year>2012</year>
        <volume>5</volume>
        <issue>3</issue>
        <fpage>197</fpage>
        <lpage>280</lpage>
        <pub-id pub-id-type="doi">10.1561/1900000024</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aksamentov</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Roemer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hodcroft</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Neher</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Nextclade: clade assignment, mutation calling and quality control for viral genomes</article-title>
        <source>J Open Source Softw</source>
        <year>2021</year>
        <volume>6</volume>
        <issue>67</issue>
        <fpage>3773</fpage>
        <pub-id pub-id-type="doi">10.21105/joss.03773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benson</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Cavanaugh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Karsch-Mizrachi</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Ostell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pruitt</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Sayers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>GenBank</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>46</volume>
        <issue>D1</issue>
        <fpage>D41</fpage>
        <lpage>D47</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx1094</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Black</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>MacCannell</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Sibley</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Bedford</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Ten recommendations for supporting open pathogen genomic analysis in public health</article-title>
        <source>Nat Med</source>
        <year>2020</year>
        <volume>26</volume>
        <issue>6</issue>
        <fpage>832</fpage>
        <lpage>841</lpage>
        <pub-id pub-id-type="doi">10.1038/s41591-020-0935-z</pub-id>
        <?supplied-pmid 32528156?>
        <pub-id pub-id-type="pmid">32528156</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Callaway</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>COVID ‘variant soup’ is making winter surges hard to predict</article-title>
        <source>Nature</source>
        <year>2022</year>
        <volume>611</volume>
        <issue>7935</issue>
        <fpage>213</fpage>
        <lpage>214</lpage>
        <pub-id pub-id-type="doi">10.1038/d41586-022-03445-6</pub-id>
        <?supplied-pmid 36307585?>
        <pub-id pub-id-type="pmid">36307585</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Centers for Disease Control and Prevention. Cdc covid data tracker (2023).</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nadeau</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Topolsky</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Advancing genomic epidemiology by addressing the bioinformatics bottleneck: challenges, design principles, and a swiss example</article-title>
        <source>Epidemics</source>
        <year>2022</year>
        <volume>39</volume>
        <fpage>100576</fpage>
        <pub-id pub-id-type="doi">10.1016/j.epidem.2022.100576</pub-id>
        <?supplied-pmid 35605437?>
        <pub-id pub-id-type="pmid">35605437</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nadeau</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yared</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Voinov</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Roemer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>CoV-spectrum: analysis of globally shared SARS-CoV-2 data to identify and characterize new variants</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>38</volume>
        <issue>6</issue>
        <fpage>1735</fpage>
        <lpage>1737</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab856</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nadeau</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Topolsky</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Manceau</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huisman</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Jablonski</surname>
            <given-names>KP</given-names>
          </name>
          <name>
            <surname>Fuhrmann</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Dreifuss</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jahn</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Beckmann</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Redondo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Noppen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Risch</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Risch</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wohlwend</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kas</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bodmer</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Roloff</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Stange</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Egli</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eckerle</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kaiser</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Denes</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Feldkamp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nissen</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Santacroce</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Burcklen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Aquino</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>de Gouvea</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Moccia</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Grüter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sykes</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Opitz</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Neff</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Popovic</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Patrignani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tracy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schlapbach</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dermitzakis</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Harshman</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Xenarios</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Pegeot</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cerutti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Penet</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Blin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Elies</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Althaus</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Beisel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ackermann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Quantification of the spread of SARS-CoV-2 variant B.1.1.7 in Switzerland</article-title>
        <source>Epidemics</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>100480</fpage>
        <pub-id pub-id-type="doi">10.1016/j.epidem.2021.100480</pub-id>
        <?supplied-pmid 34488035?>
        <pub-id pub-id-type="pmid">34488035</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Collet, Y. Rfc 8878: Zstandard compression and the ’application/zstd’ media type (2021).</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elbe</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Buckland-Merrett</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Data, disease and diplomacy: GISAID’s innovative contribution to global health</article-title>
        <source>Global Chall</source>
        <year>2017</year>
        <volume>1</volume>
        <issue>1</issue>
        <fpage>33</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="doi">10.1002/gch2.1018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Gangavarapu K, Latif AA, Mullen JL, Alkuzweny M, Hufbauer E, Tsueng G, Haag E, Zeller M, Aceves CM, Zaiets K, Cano M, Zhou X, Qian Z, Sattler R, Matteson NL, Levy JI, Lee RTC, Freitas L, Maurer-Stroh S, GISAID Core and Curation Team, Suchard MA, Wu C, Su AI, Andersen KG, Hughes LD. Outbreak.info genomic reports: scalable and dynamic surveillance of SARS-CoV-2 variants and mutations. Nat Methods. 2023.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Hodcroft EB. Covariants: Sars-cov-2 mutations and variants of interest (2021).</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hodcroft</surname>
            <given-names>EB</given-names>
          </name>
          <name>
            <surname>Maio</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Lanfear</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>MacCannell</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dessimoz</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Want to track pandemic variants faster? Fix the bioinformatics bottleneck</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>591</volume>
        <issue>7848</issue>
        <fpage>30</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1038/d41586-021-00525-x</pub-id>
        <?supplied-pmid 33649511?>
        <pub-id pub-id-type="pmid">33649511</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Knyazev S, Chhugani K, Sarwal V, Ayyala R, Singh H, Karthikeyan S, Deshpande D, Baykal PI, Comarova Z, Lu A, Porozov Y, Vasylyeva TI, Wertheim JO, Tierney BT, Chiu CY, Sun R, Wu A, Abedalthagafi MS, Pak VM, Nagaraj SH, Smith AL, Skums P, Pasaniuc B, Komissarov A, Mason CE, Bortz E, Lemey P, Kondrashov F, Beerenwinkel N, Lam TT-Y, Wu NC, Zelikovsky A, Knight R, Crandall KA, Mangul S. Unlocking capacities of genomics for the COVID-19 response and future pandemics. Nat Methods. 2022.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>GF</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>The emergence, genomic diversity and global spread of SARS-CoV-2</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>600</volume>
        <issue>7889</issue>
        <fpage>408</fpage>
        <lpage>418</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-04188-6</pub-id>
        <?supplied-pmid 34880490?>
        <pub-id pub-id-type="pmid">34880490</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanderson</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Taxonium, a web-based tool for exploring large phylogenetic trees</article-title>
        <source>eLife</source>
        <year>2022</year>
        <volume>11</volume>
        <fpage>e82392</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.82392</pub-id>
        <?supplied-pmid 36377483?>
        <pub-id pub-id-type="pmid">36377483</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Sanderson, T. Tweet (2022).</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Tegally H, Moir M, Everatt J, Giovanetti M, Scheepers C, Wilkinson E, Subramoney K, Moyo S, Amoako DG, Baxter C, Althaus CL, Anyaneji UJ, Kekana D, Viana R, Giandhari J, Lessells RJ, Maponga T, Maruapula D, Choga W, Matshaba M, Mayaphi S, Mbhele N, Mbulawa MB, Msomi N, Naidoo Y, Pillay S, Sanko TJ, San JE, Scott L, Singh L, Magini NA, Smith-Lawrence P, Stevens W, Dor G, Tshiabuila D, Wolter N, Preiser W, Treurnicht FK, Venter M, Davids M, Chiloane G, Mendes A, McIntyre C, O’Toole A, Ruis C, Peacock TP, Roemer C, Williamson C, Pybus OG, Bhiman J, Glass A, Martin DP, Rambaut A, Gaseitsiwe S, von Gottberg A, de Oliveira T. Continued emergence and evolution of omicron in South Africa: new BA.4 and BA.5 lineages. 2022.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Viana</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Moyo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Amoako</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Tegally</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Scheepers</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Althaus</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Anyaneji</surname>
            <given-names>UJ</given-names>
          </name>
          <name>
            <surname>Bester</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Boni</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Chand</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Choga</surname>
            <given-names>WT</given-names>
          </name>
          <name>
            <surname>Colquhoun</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Davids</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deforche</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Doolabh</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>du Plessis</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Engelbrecht</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Everatt</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Giandhari</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Giovanetti</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hardie</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hsiao</surname>
            <given-names>N-Y</given-names>
          </name>
          <name>
            <surname>Iranzadeh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ismail</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Joseph</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Joseph</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Koopile</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pond</surname>
            <given-names>SLK</given-names>
          </name>
          <name>
            <surname>Kraemer</surname>
            <given-names>MUG</given-names>
          </name>
          <name>
            <surname>Kuate-Lere</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Laguda-Akingba</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Lesetedi-Mafoko</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Lessells</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Lockman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lucaci</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Maharaj</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mahlangu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Maponga</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mahlakwane</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Makatini</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Marais</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Maruapula</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Masupu</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Matshaba</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mayaphi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mbhele</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mbulawa</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Mendes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mlisana</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mnguni</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mohale</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Moir</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moruisi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mosepele</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Motsatsi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Motswaledi</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Mphoyakgosi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Msomi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mwangi</surname>
            <given-names>PN</given-names>
          </name>
          <name>
            <surname>Naidoo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ntuli</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nyaga</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Olubayo</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pillay</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Radibe</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ramphal</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ramphal</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>San</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Shapiro</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Smith-Lawrence</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stevens</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Strydom</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Subramoney</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tebeila</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tshiabuila</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Tsui</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>van Wyk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Weaver</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wibmer</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Wilkinson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Wolter</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Zarebski</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Zuze</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Goedhals</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Preiser</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Treurnicht</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Venter</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Williamson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pybus</surname>
            <given-names>OG</given-names>
          </name>
          <name>
            <surname>Bhiman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Glass</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gaseitsiwe</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>von Gottberg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>de Oliveira</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Rapid epidemic expansion of the SARS-CoV-2 omicron variant in Southern Africa</article-title>
        <source>Nature</source>
        <year>2022</year>
        <volume>603</volume>
        <issue>7902</issue>
        <fpage>679</fpage>
        <lpage>686</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-022-04411-y</pub-id>
        <?supplied-pmid 35042229?>
        <pub-id pub-id-type="pmid">35042229</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10240112</article-id>
    <article-id pub-id-type="publisher-id">5364</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05364-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>LAPIS is a fast web API for massive open virus sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8763-2937</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Chaoran</given-names>
        </name>
        <address>
          <email>chaoran.chen@bsse.ethz.ch</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2177-7092</contrib-id>
        <name>
          <surname>Taepper</surname>
          <given-names>Alexander</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2693-084X</contrib-id>
        <name>
          <surname>Engelniederhammer</surname>
          <given-names>Fabian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8033-2811</contrib-id>
        <name>
          <surname>Kellerer</surname>
          <given-names>Jonas</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6138-6539</contrib-id>
        <name>
          <surname>Roemer</surname>
          <given-names>Cornelius</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6431-535X</contrib-id>
        <name>
          <surname>Stadler</surname>
          <given-names>Tanja</given-names>
        </name>
        <address>
          <email>tanja.stadler@bsse.ethz.ch</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5801.c</institution-id><institution-id institution-id-type="ISNI">0000 0001 2156 2780</institution-id><institution>Department of Biosystems Science and Engineering, </institution><institution>ETH Zürich, </institution></institution-wrap>Basel, Switzerland </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.419765.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 2223 3006</institution-id><institution>Swiss Institute of Bioinformatics, </institution></institution-wrap>Basel, Switzerland </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.6936.a</institution-id><institution-id institution-id-type="ISNI">0000000123222966</institution-id><institution>School of Computation, Information and Technology - Informatics, </institution><institution>TU Munich, </institution></institution-wrap>Munich, Germany </aff>
      <aff id="Aff4"><label>4</label>TNG Technology Consulting GmbH, Unterföhring, Germany </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.6612.3</institution-id><institution-id institution-id-type="ISNI">0000 0004 1937 0642</institution-id><institution>Biozentrum, University of Basel, </institution></institution-wrap>Basel, Switzerland </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>5</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>232</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Recent epidemic outbreaks such as the SARS-CoV-2 pandemic and the mpox outbreak in 2022 have demonstrated the value of genomic sequencing data for tracking the origin and spread of pathogens. Laboratories around the globe generated new sequences at unprecedented speed and volume and bioinformaticians developed new tools and dashboards to analyze this wealth of data. However, a major challenge that remains is the lack of simple and efficient approaches for accessing and processing sequencing data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">The Lightweight API for Sequences (LAPIS) facilitates rapid retrieval and analysis of genomic sequencing data through a REST API. It supports complex mutation- and metadata-based queries and can perform aggregation operations on massive datasets. LAPIS is optimized for typical questions relevant to genomic epidemiology. Using a newly-developed in-memory database engine, it has a high speed and throughput: between 25 January and 4 February 2023, the SARS-CoV-2 instance of LAPIS, which contains 14.5 million sequences, processed over 20 million requests with a mean response time of 411 ms and a median response time of 1 ms. LAPIS is the core engine behind our dashboards on genspectrum.org and we currently maintain public LAPIS instances for SARS-CoV-2 and mpox.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Powered by an optimized database engine and available through a web API, LAPIS enhances the accessibility of genomic sequencing data. It is designed to serve as a common backend for dashboards and analyses with the potential to be integrated into common database platforms such as GenBank.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001711</institution-id>
            <institution>Schweizerischer Nationalfonds zur Förderung der Wissenschaftlichen Forschung</institution>
          </institution-wrap>
        </funding-source>
        <award-id>31CA30_196267</award-id>
        <principal-award-recipient>
          <name>
            <surname>Stadler</surname>
            <given-names>Tanja</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Swiss Federal Institute of Technology Zurich</institution>
        </funding-source>
      </award-group>
      <open-access>
        <p>Open access funding provided by Swiss Federal Institute of Technology Zurich</p>
      </open-access>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par7">Pathogen genomic sequencing data are a key public health resource for responding to epidemic outbreaks. During the early stages of an outbreak, genomic sequencing data are essential for understanding the origin, evolution, and extent of spread of the pathogen [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. At later stages, sequencing data are the primary early indicator of evolutionary and epidemiological changes, as demonstrated repeatedly with SARS-CoV-2 variants [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. Rapid analysis of sequencing data is therefore a crucial component for evidence-based public health responses. Although a lot of infrastructure for generating and analyzing genomic sequencing data in real-time was established during the SARS-CoV-2 pandemic, major challenges remain [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>].</p>
    <p id="Par8">The unprecedented scale of SARS-CoV-2 sequence generation, coupled with enormous popular interest in these data, highlights a need for user-friendly tools for analyzing massive sequence data sets. One such category of tools is web dashboards. Once set up, these can be used by a wide audience without requiring programming and data science knowledge. Examples of popular dashboards that digest massive SARS-CoV-2 data sets include the CDC’s COVID Data Tracker [<xref ref-type="bibr" rid="CR6">6</xref>], CoVariants [<xref ref-type="bibr" rid="CR13">13</xref>], Outbreak.info [<xref ref-type="bibr" rid="CR12">12</xref>], and our own CoV-Spectrum dashboard [<xref ref-type="bibr" rid="CR8">8</xref>]. Another category of tools that facilitate quick, ad-hoc analyses are “notebooks” like Jupyter Notebooks and R Markdown scripts. Notebooks are useful to data scientists with programming knowledge to quickly perform their own statistical analyses and generate their own plots. Combined, dashboards and notebooks allow different users to access different visualizations and focus on different aspects of the data. In this way, everyone from experts like scientists and public health agencies to the general public can benefit from sequence data.</p>
    <p id="Par9">Many of these tools for sequence data analysis require common operations on sequence data like filtering, stratification, and aggregation. For instance, filtering for sequences with certain mutations and calculating the relative frequency of mutations are commonly performed operations for genome sequencing data. Although these operations are simple in principle, the gigantic size of modern genome sequence data sets makes them non-trivial. Over 14 million SARS-CoV-2 sequences are available, and up to hundreds of thousands of new sequences are added weekly. General-purpose database systems such as PostgreSQL are not optimized for genomic sequence analysis on this scale.</p>
    <p id="Par10">Our resource LAPIS (Lightweight API for Sequences) is designed to perform common data operations on millions of genomic sequences within milliseconds, facilitating interactive data exploration. Using a self-written in-memory database engine, it is optimized for filtering and aggregating large genomic sequencing data sets. Accessible through a web API (application programming interface), we believe that LAPIS can serve as a common backend for many dashboards and analyses (e.g., through notebooks). This would relieve scientists and dashboard builders from the costly but boring task of developing their own databases and implementing common basic operations. Instead, they would be free to focus on analysis and visualization tasks. Furthermore, LAPIS streamlines the direct download of cleaned and pre-processed data including aligned and unaligned sequences.</p>
    <p id="Par11">In contrast to data repositories like GenBank [<xref ref-type="bibr" rid="CR3">3</xref>], LAPIS is not a broad database but a targeted data service. While GenBank contains sequences from more than 400,000 species and aims to provide a general and stable data source, LAPIS supports features specific to an outbreak species like lineage/clade annotation and filtering by mutations from a reference genome. In this way, LAPIS aims to support answering current research and public health questions about emerging pathogen threats.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Functionalities</title>
      <p id="Par12">LAPIS implements many of the same functionalities as GenBank and additionally supports novel download, filter, and aggregation functionalities to support outbreak analysis (Table <xref rid="Tab1" ref-type="table">1</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Feature comparisons between GenBank and LAPIS</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Feature</th><th align="left">GenBank</th><th align="left">LAPIS</th></tr></thead><tbody><tr><td align="left">Download metadata</td><td align="left"><inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M2"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq1.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M4"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq2.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Download unaligned sequences</td><td align="left"><inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M6"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq3.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M8"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq4.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Download aligned sequences</td><td align="left"><inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M10"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq5.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M12"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq6.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Download protein amino acid sequences</td><td align="left"><inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M14"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq7.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M16"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq8.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Download mutations</td><td align="left"><inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M18"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq9.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M20"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq10.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Filter by basic metadata (country, date, etc.)</td><td align="left"><inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M22"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq11.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M24"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq12.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Filter by lineage/clade</td><td align="left"><inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M26"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq13.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M28"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq14.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Filter by mutations</td><td align="left"><inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M30"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq15.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M32"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq16.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Perform aggregation</td><td align="left"><inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M34"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq17.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\checkmark$$\end{document}</tex-math><mml:math id="M36"><mml:mo stretchy="false">✓</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq18.gif"/></alternatives></inline-formula></td></tr></tbody></table></table-wrap></p>
      <p id="Par13">The simplest way to use LAPIS is to encode a query in a URL prefixed with a particular LAPIS endpoint. Each LAPIS endpoint supports a different type of query and returns a different type of data (e.g., aggregated data, sequence data, mutations, etc.). Figure <xref rid="Fig1" ref-type="fig">1</xref> illustrates a URL query structure. In the following sections, we explain the different parts of a query in more detail.<fig id="Fig1"><label>Fig. 1</label><caption><p>Components of a query link</p></caption><graphic xlink:href="12859_2023_5364_Fig1_HTML" id="MO1"/></fig></p>
      <sec id="Sec4">
        <title>Aggregation and stratification</title>
        <p id="Par14">LAPIS implements two types of endpoints: endpoints that provide aggregated data and endpoints that provide per-sample data. We describe the first type in this section and the second type in the next.</p>
        <p id="Par15">The aggregated endpoint counts the number of samples that fulfill user-defined filters in a query. If the fields parameter is not set, it returns the total number of samples. By setting fields, we can stratify the data. E.g., /aggregated?fields=pangoLineage,country will return the number of samples per Pango lineage and country. The fields parameter accepts all metadata and lineage-defining fields but not mutations or insertions.</p>
        <p id="Par16">To calculate the distribution of mutations and insertions, LAPIS offers the endpoints nuc-mutations, aa-mutations, nuc-insertions, and aa-insertions. They return the number of occurrences of mutations in a set of samples and their proportions. When calculating the proportions, the unknown or ambiguous bases are excluded. For example, if there are 10 sequences, 3 sequences have a mutation from A to G at position 5, 3 sequences have the reference base A, and 4 sequences have an N (i.e., unknown) at position 5, the proportion of the mutation A5G is <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{3}{6} = 0.5$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mn>6</mml:mn></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq19.gif"/></alternatives></inline-formula> (and not <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{3}{10} = 0.3$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mn>10</mml:mn></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5364_Article_IEq20.gif"/></alternatives></inline-formula>).</p>
      </sec>
      <sec id="Sec5">
        <title>Data download</title>
        <p id="Par17">LAPIS can also be used to obtain non-aggregated data. The details endpoint returns the metadata and supports an optional fields parameter that can be used to limit the desired metadata fields. The nuc-sequence and nuc-sequence-aligned endpoints return the original and aligned nucleotide sequences, respectively. Finally, the aa-sequence-aligned/gene endpoint (e.g., aa-sequence-aligned/S for the SARS-CoV-2 Spike protein) returns the aligned amino acid sequences.</p>
      </sec>
      <sec id="Sec6">
        <title>Filters and advanced variant queries</title>
        <p id="Par18">By default (i.e., without specifying additional parameters), a query is evaluated on the whole set of sequences. To query a subset of sequences, a wide range of filters is available. It includes filtering by metadata, lineage names, and mutations. As shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, filters can be set by adding request parameters to the end of the URL. If multiple filters are set, the samples that fulfill all of them will be selected.</p>
        <p id="Par19">For ordinal data like dates, there are two available filters: one with a From-suffix for the lower bound and one with a To-suffix for the upper bound. E.g., dateFrom=2023-01-01 &amp;dateTo=2023-01-31 will filter for samples from January 2023.</p>
        <p id="Par20">LAPIS additionally supports two different ways to specify a variant. The simple approach is similar to the metadata filters and can be used to filter samples that fulfill all of a list of conditions. Possible parameters for the SARS-CoV-2 instance include pangoLineage, aaMutations, nucMutations, aaInsertions, etc. For the mutations/insertions, it is possible to use a comma-separated list. An example of a simple variant filter would be pangoLineage=XBB.1* &amp;aaMutations=S:E484R,S:K417T. The * behind XBB.1 means all sub-lineages of the Pango lineage XBB.1 will also be included in the query. Insertion queries may contain wildcards, for instance, ins:1000:AAT?. This filters for all sequences with an insertion that starts with AAT between positions 1000 and 1001.</p>
        <p id="Par21">The second approach is using advanced variant queries. Advanced variant queries support more than the conjunction of a list of conditions – they also allow Boolean logic and threshold queries. One example is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. Examples of real-world, user-defined advanced variant queries can be found in the CoV-Spectrum Collections<xref ref-type="fn" rid="Fn1">1</xref> where users can define and monitor sets of variants specified by advanced variant queries. In particular, the threshold queries have proven highly valuable. For example, they have been recently used to group sequences that share the same number of mutations in the receptor binding domain (RBD) [<xref ref-type="bibr" rid="CR5">5</xref>].<fig id="Fig2"><label>Fig. 2</label><caption><p>Components of an advanced variant query</p></caption><graphic xlink:href="12859_2023_5364_Fig2_HTML" id="MO2"/></fig></p>
      </sec>
      <sec id="Sec7">
        <title>“Maybe” queries</title>
        <p id="Par22">Advanced variant queries further support “maybe” queries. These queries find sequences that <italic>might</italic> have a certain mutation instead of definitely having a certain mutation. By default, when filtering for a mutation, LAPIS returns sequences for which the mutation is confirmed. E.g., the query A5G selects sequences with a G at position 5. This is a conservative way of filtering. In practice, we don’t know the values at every position of every sequence: for some sequences, we might have a N (=unknown/everything is possible) or another ambiguity code that includes G such as K (=G or T) at position 5. For those samples, it is possible that, in reality, they do have the mutation A5G. This implies that the aggregated endpoint usually<xref ref-type="fn" rid="Fn2">2</xref> provides the lower-bound number of samples when we filter for mutations. “maybe” queries allow us to obtain the corresponding upper bound. For the A5G example, sequences with a N, X, R, S, V, D and B at position 5 will also be included. Maybe queries are part of the advanced variant queries. For example, we can query maybe(5 G) &amp; maybe(6T). In fact, we can write arbitrary variant query expressions in a maybe() clause. Equivalent to the previous example, we can write maybe(5 G &amp; 6T). A more complex example would be maybe((S:10K &amp; !S:11 H) &amp; [2-of: 100A, 101T, 102 G]).</p>
        <p id="Par23">While the previous examples appear simple and intuitive, it is not always straightforward to determine the semantics of a maybe query. Let us consider the nucleotide sequence ATGCNT. It has one unknown at position 5. The sequence would neither match the query 5A nor 5C but it would match maybe(5A) and it would also match maybe(5C). What’s about maybe(5A) &amp; maybe(5C)? From a Boolean logic perspective, if we consider maybe(5A) and maybe(5C) to be true, then their conjunction must be true as well. On the other hand, a sequence cannot have two different bases at the same position; thus, shouldn’t maybe(5A) &amp; maybe(5C) be a contradiction and unconditionally false? LAPIS would evaluate maybe(5A) &amp; maybe(5C) for the aforementioned sequence to be true. The main reason we decided on this semantic is that it is possible to evaluate it efficiently.<xref ref-type="fn" rid="Fn3">3</xref></p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Performance</title>
      <p id="Par24">LAPIS is computationally efficient. It has proven capable of reliably processing millions of requests per day with most response times within a few hundred milliseconds as the backend to our CoV-Spectrum dashboard.</p>
      <p id="Par25">We currently run the LAPIS instance for SARS-CoV-2 data from GISAID on an AWS r5.8xlarge server (256 GB RAM, 32 vCPUs).<xref ref-type="fn" rid="Fn4">4</xref> Between 25 January<xref ref-type="fn" rid="Fn5">5</xref> and 4 February 2023, it processed over 20 million requests with a mean response time of 411 ms and a median response time of 1 ms (Table <xref rid="Tab2" ref-type="table">2</xref>). This low median response time was possible because 72% of all responses had been cached (“section <xref rid="Sec19" ref-type="sec">Caching</xref>”), which greatly reduces response time (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). Altogether, 83% of requests to the SARS-CoV-2 instance of LAPIS were processed within 500 ms.</p>
      <p id="Par26">LAPIS often has to process many requests in parallel. It is quite common to have very few requests in one minute and over a thousand in the next (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). The CoV-Spectrum collections are a major reason for that. In the user-defined collections, users can see information about many variants simultaneously. When a collection page is opened, the web application sends one request per variant to the server at the same time, and some collections (e.g., collection 24<xref ref-type="fn" rid="Fn6">6</xref>) have hundreds of variants. When we consider only requests that were executed when the server had less than 100 parallel requests (that is the case for 79% of the requests), 97% of the requests were processed within 500 ms (Fig. <xref rid="Fig5" ref-type="fig">﻿5</xref>).</p>
      <p id="Par27">In summary, the computational efficiency of LAPIS makes it suitable as a back-end for other tools and websites, including responsive and interactive dashboards and workflows. LAPIS achieves computational efficiency through a newly-developed data processing engine (see “section <xref rid="Sec13" ref-type="sec">Data query engine</xref>”) that is optimized for genomic data. It can perform common operations like searching for nucleotide mutations and amino acid changes in millions of sequences and hundreds of gigabytes of data within tens to hundreds of milliseconds.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Empirical data on the usage and performance of the endpoints</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Endpoint</th><th align="left">Number of requests</th><th align="left">Cache hit</th><th align="left">Response time (mean/median, in ms)</th></tr></thead><tbody><tr><td align="left">aa-insertions</td><td align="left">34,212 (0.17%)</td><td align="left">14.19%</td><td align="left">654/254</td></tr><tr><td align="left">aa-mutations</td><td align="left">101,346 (0.49%)</td><td align="left">20.86%</td><td align="left">1050/267</td></tr><tr><td align="left">aggregated</td><td align="left">20,302,815 (98.85%)</td><td align="left">72.66%</td><td align="left">404/1</td></tr><tr><td align="left">nuc-insertions</td><td align="left">34,221 (0.17%)</td><td align="left">14.20%</td><td align="left">639/252</td></tr><tr><td align="left">nuc-mutations</td><td align="left">66,731 (0.32%)</td><td align="left">24.32%</td><td align="left">1203/266</td></tr></tbody></table></table-wrap></p>
      <p id="Par28">
        <fig id="Fig3">
          <label>Fig. 3</label>
          <caption>
            <p>Number of requests within a day. Each bar represents one minute. In total, there were 208249 requests</p>
          </caption>
          <graphic xlink:href="12859_2023_5364_Fig3_HTML" id="MO3"/>
        </fig>
        <fig id="Fig4">
          <label>Fig. 4</label>
          <caption>
            <p>Proportion of requests for the different response time bins, stratified by cache status</p>
          </caption>
          <graphic xlink:href="12859_2023_5364_Fig4_HTML" id="MO4"/>
        </fig>
        <fig id="Fig5">
          <label>Fig. 5</label>
          <caption>
            <p>Same as Fig. <xref rid="Fig4" ref-type="fig">4</xref> but only for requests executed when the server has less than 100 parallel requests</p>
          </caption>
          <graphic xlink:href="12859_2023_5364_Fig5_HTML" id="MO5"/>
        </fig>
      </p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Discussion</title>
    <p id="Par29">The unique filtering, aggregation, and download functionalities supported by LAPIS, coupled with high computational efficiency, make LAPIS a key resource for the real-time analysis of genomic sequencing data from ongoing outbreaks. LAPIS is currently available for all openly accessible SARS-CoV-2<xref ref-type="fn" rid="Fn7">7</xref> and mpox<xref ref-type="fn" rid="Fn8">8</xref> sequencing data on GenBank [<xref ref-type="bibr" rid="CR3">3</xref>]. We also maintain a private SARS-CoV-2 instance with sequencing data from GISAID [<xref ref-type="bibr" rid="CR11">11</xref>], which serves as the backend for our CoV-Spectrum dashboard.<xref ref-type="fn" rid="Fn9">9</xref></p>
    <p id="Par30">LAPIS’ SARS-CoV-2 instances highlight the value of this approach as dataset size grows. As of January 2023, more than 14,500,000 SARS-CoV-2 sequences are available on GISAID, reaching a size of over 400 GB. LAPIS is capable of querying this entire dataset efficiently, supporting an interactive user experience on our CoV-Spectrum dashboard. CoV-Spectrum mainly presents aggregated data: it visualizes temporal, geographic, and mutational distributions of variants through a large variety of charts, tables, and maps. It solely uses LAPIS for retrieving genomic data and thanks to the flexibility of LAPIS, it was possible to develop new features in CoV-Spectrum without the need of extending or adapting LAPIS.</p>
    <p id="Par31">With LAPIS’ mpox instance, we demonstrated the adaptability of the API approach. At the start of the mpox outbreak in 2022, within a few days of the release of the first sequence, we set up a LAPIS instance to support rapid sharing and easy access to open genomic data. It was accompanied by the MpoxSpectrum dashboard<xref ref-type="fn" rid="Fn10">10</xref> which, in addition to providing overview plots, enabled users to look up samples, download pre-processed metadata and aligned sequences, and open them in the Nextclade tool. To use the Nextclade integration feature, users can select sequences of interest on the MpoxSpectrum dashboard and Nextclade will download the sequences from LAPIS for quality analysis. Further, just four hours after we publicized LAPIS for mpox on Twitter, Taxonium announced the launch of a mpox service using LAPIS data as data source [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>].</p>
    <p id="Par32">These successes highlight that LAPIS fills a necessary role in addressing common challenges for accessing and analyzing genomic sequencing data. As demonstrated with mpox, LAPIS is easily extendable to other organisms. While supporting a new pathogen currently requires changes to the code base, we are actively working to generalize the LAPIS code to enable users to deploy instances with their own data and for other pathogens, possibly containing additional private metadata, via a configuration file. This will allow independent groups to run LAPIS instances for different use cases, akin to how Nextstrain publishes phylogenetic analyses for a limited number of pathogens but also provides the same analysis tools as an open-source resource for researchers to set up their own analyses. We hope to increase the incentive for data sharing in the public domain with this open-source philosophy: with the support of the API, researchers can directly analyze their own shared data within the global genomic context.</p>
    <p id="Par33">Going forward, we see great potential for database platforms such as GenBank to directly integrate APIs with functionalities like LAPIS’s into their framework. This avoids the necessity of hosting data in a second database and allows researchers to benefit from functionality provided by an API such as LAPIS for many different organisms. On the research side, this requires developing techniques for efficiently querying even larger genomic data sets. The current implementation of LAPIS is capable of supporting up to around 20 to 30 million sequences of length 30kBp. We are working on better algorithms to push this boundary.</p>
  </sec>
  <sec id="Sec10">
    <title>Conclusions</title>
    <p id="Par34">In summary, we introduce an in-memory database engine for genomic sequencing data which can be accessed through an API. This framework facilitates the analysis of millions of sequences in real time, meaning users can interactively query and filter sequencing data. In particular, our framework supports the analysis of open genomic sequencing data and enables researchers and authorities to rapidly analyze the evolution and epidemiology of pathogens for evidence-based public health response.</p>
  </sec>
  <sec id="Sec11">
    <title>Methods</title>
    <sec id="Sec12">
      <title>Data pre-processing</title>
      <p id="Par35">For the three LAPIS instances we currently maintain, we download the raw data from GISAID (SARS-CoV-2) or Nextstrain which retrieved it from GenBank (SARS-CoV-2 and mpox). The raw data contain the genomic (consensus) sequences and corresponding metadata. We pre-process the data in two steps. During the first step, we clean up the metadata, align the sequences to a reference genome, and translate the nucleotide sequences to protein amino acid sequences. For the alignment and translation, we use Nextclade [<xref ref-type="bibr" rid="CR2">2</xref>] but other tools are equally applicable. The first step is not specific to LAPIS and can be replaced by alternative pipelines that produce an alignment and protein sequences. During the second step, we perform LAPIS-specific transformations and generate compressed columnar sequences (“section <xref rid="Sec14" ref-type="sec">Column-wise storage</xref>” and “<xref rid="Sec20" ref-type="sec">Compression</xref>”). The pre-processed data are loaded into the in-memory database (“section <xref rid="Sec13" ref-type="sec">Data query engine</xref>”) and exposed through a REST API. Figure <xref rid="Fig6" ref-type="fig">6</xref> illustrates the workflow.<fig id="Fig6"><label>Fig. 6</label><caption><p>Data pre-processing workflow</p></caption><graphic xlink:href="12859_2023_5364_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par36">We store the pre-processed data – both after the first and after the second step – in a PostgreSQL database. Hereby, the PostgreSQL database only serves as a background storage and can be easily replaced by the file system or a different database system. It is not crucial to the performance of LAPIS outside of the pre-processing pipeline because the in-memory database is used for evaluating the queries.</p>
    </sec>
    <sec id="Sec13">
      <title>Data query engine</title>
      <p id="Par37">We developed a novel data query engine for our public web API that is tailored to support real-time, interactive genomic surveillance and genomic epidemiology. Specifically, it is designed to support high numbers of requests and fast query processing of genomic sequencing data. Our internal SARS-CoV-2 LAPIS instance based on GISAID data currently receives hundreds of thousands of requests per day, mostly from users of CoV-Spectrum. At the same time, it must support interactive and exploratory analyses where the user is able to switch quickly between different variants, countries, and time periods by responding to most requests within tens to hundreds of milliseconds. Existing database systems are not sufficient for this task.</p>
      <sec id="Sec14">
        <title>Column-wise storage</title>
        <p id="Par38">Our approach is based on techniques developed for column-oriented database systems [<xref ref-type="bibr" rid="CR1">1</xref>]. In the pre-processing step, we transform the sequencing data into a columnar format. For each position in the aligned nucleotide sequence or in the aligned amino acid sequence, we construct a string with the characters of all sequences at that position (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). The <italic>i</italic>-th character in the new, columnar sequence corresponds to the sequence with the ID <italic>i</italic>. To find sequences with a mutation at a given position, we then only need to read a single string and not filter through each sequence. The columnar sequences are easy to compress (“section <xref rid="Sec20" ref-type="sec">Compression</xref>”), and by compressing them, we can cache them in memory and eliminate any disk and round-trip time to the database.<fig id="Fig7"><label>Fig. 7</label><caption><p>Transformation of sequences to the columnar format: The row-oriented storage maintains one string per sequence; in contrast, the column-oriented storage keeps one string per position</p></caption><graphic xlink:href="12859_2023_5364_Fig7_HTML" id="MO7"/></fig></p>
      </sec>
      <sec id="Sec15">
        <title>Filter insertions</title>
        <p id="Par39">The column store as described in the previous subsection can only store the aligned sequences. It has one column for each base of the reference genome but it cannot store insertions which are parts of a sequence that cannot be directly linked to the positions of the reference. To filter for insertions, LAPIS uses a dedicated insertion store which maintains for each position of the reference genome a mapping of inserted values to sequences with the insertion. E.g., a mapping of AATGGC at position 1000 to {sequence1, sequence2, sequence3} means that there are three sequences that have the insertion AATGGC between position 1000 and 1001.</p>
        <p id="Par40">To evaluate a query such as ins:1000:AAT? as described in “section <xref rid="Sec6" ref-type="sec">Filters and advanced variant queries</xref>”, LAPIS looks up the insertions at position 1000 and matches them against the requested pattern. For the SARS-CoV-2 data, this approach works well because insertions are rare, short, and not very diverse. For genomic data with many long and diverse insertions, this method is not very efficient.</p>
      </sec>
      <sec id="Sec16">
        <title>Sequence downloads</title>
        <p id="Par41">To download whole sequences, LAPIS first filters the sequences with the in-memory query engine, fetches compressed sequences (“section <xref rid="Sec20" ref-type="sec">Compression</xref>”) from the background storage (“section <xref rid="Sec12" ref-type="sec">Data pre-processing</xref>”), and decompresses them. If a large set of sequences should be downloaded, it fetches the sequences in small batches and streams them to the user to ensure a low memory footprint.</p>
      </sec>
      <sec id="Sec17">
        <title>Discussion</title>
        <p id="Par42">The data engine was first deployed when there were around one million genomic sequences for SARS-CoV-2, and it still performs well for 15 million sequences today. It is a significant improvement to using common relational database systems which are not optimized for genomic sequencing data. The current algorithm is simple and easy to implement. However, it is also rather naive and not using state-of-the-art database engineering techniques. We are working on an improved version with reduced response times and higher throughput and look forward to sharing our results in the near future.</p>
      </sec>
    </sec>
    <sec id="Sec18">
      <title>Data versions</title>
      <p id="Par43">To allow the user to use consistent data, each response of LAPIS contains the version of the data. The user can then check if the data versions of multiple requests are the same, and reload if that is not the case. The data version is provided in the HTTP response header LAPIS-Data-Version. For JSON responses, the data version is further given in the dataVersion field.</p>
      <p id="Par44">For example, this is relevant to compute the proportion of a variant in the sequencing data. For the calculation, we would fetch the number of sequences of the variant and the total number of sequences; that means that two API calls are required. In this case, data could be updated between the two calls which would lead to wrong results because the nominator and denominator to calculate the proportion are incompatible. Comparing the data versions of the two requests would prevent an error.</p>
    </sec>
    <sec id="Sec19">
      <title>Caching</title>
      <p id="Par45">To minimize the response time for common requests, LAPIS caches the results of previously evaluated queries in a Redis database. Caching is usually a difficult task due to the complexity to determine when a cache entry is stale. In the case of LAPIS, however, we have the advantage that we do not have a continuous stream of small data changes but perform rare (e.g., once a day) but big updates. This allows us to distinguish different versions of the data (“section <xref rid="Sec18" ref-type="sec">Data versions</xref>”).</p>
      <p id="Par46">Each cached result is linked to a data version. If the user defines a data version in a request, and the result generated from the data of the specified version is in the cache, it can be returned immediately. If the user does not define a data version, LAPIS will check if the result for the most recent data version is cached. Figures <xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref> and Table <xref rid="Tab2" ref-type="table">2</xref> show the proportions of cache hits.</p>
    </sec>
    <sec id="Sec20">
      <title>Compression</title>
      <p id="Par47">We compress the genome sequences before inserting them into the database. We use Zstd (level 3) [<xref ref-type="bibr" rid="CR10">10</xref>] which gives us a good balance between compression ratio and speed. For the compression of the whole nucleotide and amino acid sequences, we use the respective reference sequence as the pre-defined dictionary to improve the compression ratio. For the columnar sequences, a pre-defined dictionary is not needed for a good compression ratio as it is intrinsically easy to compress. We achieve a compression ratio of 94% for the unaligned sequences, 99.3% for the aligned sequences, and 96% for the sequences stored in the column-oriented format.</p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>API</term>
        <def>
          <p id="Par4">Application programming interface</p>
        </def>
      </def-item>
      <def-item>
        <term>CDC</term>
        <def>
          <p id="Par5">Centers for Disease Control and Prevention</p>
        </def>
      </def-item>
      <def-item>
        <term>LAPIS</term>
        <def>
          <p id="Par6">Lightweight API for Sequences</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p id="Par51"><ext-link ext-link-type="uri" xlink:href="https://cov-spectrum.org/collections">https://cov-spectrum.org/collections</ext-link>.</p>
    </fn>
    <fn id="Fn2">
      <label>2</label>
      <p id="Par52">There is an exception for queries that contain a negation.</p>
    </fn>
    <fn id="Fn3">
      <label>3</label>
      <p id="Par53">Although the alternative might appear more intuitive in some cases, we believe that it cannot be efficiently computed. We have not proven it formally but we think that the complexity of the alternative semantics grows exponentially with the length of the query.</p>
    </fn>
    <fn id="Fn4">
      <label>4</label>
      <p id="Par54"><ext-link ext-link-type="uri" xlink:href="https://aws.amazon.com/ec2/instance-types/">https://aws.amazon.com/ec2/instance-types/</ext-link>.</p>
    </fn>
    <fn id="Fn5">
      <label>5</label>
      <p id="Par55">We only started logging the response times in the afternoon of 24 January 2023.</p>
    </fn>
    <fn id="Fn6">
      <label>6</label>
      <p id="Par56"><ext-link ext-link-type="uri" xlink:href="https://cov-spectrum.org/collections/24">https://cov-spectrum.org/collections/24</ext-link>.</p>
    </fn>
    <fn id="Fn7">
      <label>7</label>
      <p id="Par57"><ext-link ext-link-type="uri" xlink:href="https://lapis.cov-spectrum.org/open">https://lapis.cov-spectrum.org/open</ext-link>.</p>
    </fn>
    <fn id="Fn8">
      <label>8</label>
      <p id="Par58"><ext-link ext-link-type="uri" xlink:href="https://mpox-lapis.genspectrum.org">https://mpox-lapis.genspectrum.org</ext-link>.</p>
    </fn>
    <fn id="Fn9">
      <label>9</label>
      <p id="Par59"><ext-link ext-link-type="uri" xlink:href="https://cov-spectrum.org">https://cov-spectrum.org</ext-link>.</p>
    </fn>
    <fn id="Fn10">
      <label>10</label>
      <p id="Par60"><ext-link ext-link-type="uri" xlink:href="https://mpox.genspectrum.org">https://mpox.genspectrum.org</ext-link>.</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We acknowledge all labs for the timely submission of their SARS-CoV-2 and mpox sequencing data to the ISNDC (GenBank, ENA, and DDBJ) and GISAID. We acknowledge the Nextstrain team for pre-processing the GenBank data. These efforts are core for LAPIS to share sequencing data from outbreaks as they are generated. We thank Sarah Nadeau for valuable discussions and feedback on the manuscript. We thank François Bienvenu for valuable discussions on the “maybe” queries.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>CC: Conceptualization, Data curation, Formal Analysis, Investigation, Methodology, Software, Visualization, Supervision, Writing—original draft. AT: Methodology, Software, Writing—review &amp; editing. FE: Software, Writing—review &amp; editing. JK: Software, Writing—review &amp; editing. CR: Conceptualization, Writing—review &amp; editing. TS: Conceptualization, Funding acquisition, Resources, Supervision, Writing—original draft. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Open access funding provided by Swiss Federal Institute of Technology Zurich. The authors acknowledge funding through the Swiss National Science Foundation (31CA30_196267), the Federal Office of Public Health, Switzerland (Dienstleistungsvertrag “Analysen zur Überwachung von SARS-CoV-2: Varianten-Monitoring und now-casting Hospitalisationen mit Zusatzoption Ad-hoc Analysen”), and ETH Zürich.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The code is released under the GPL-3.0 license at <ext-link ext-link-type="uri" xlink:href="https://github.com/GenSpectrum/LAPIS">https://github.com/GenSpectrum/LAPIS</ext-link>. The current study did not generate new genomic sequencing data. Part of the analyzed data is publicly available in the INSDC (GenBank/ENA/DDBJ) repositories (<ext-link ext-link-type="uri" xlink:href="https://www.insdc.org/">https://www.insdc.org/</ext-link>). The remaining part of the analyzed SARS-CoV-2 data is available in GISAID (<ext-link ext-link-type="uri" xlink:href="https://gisaid.org/">https://gisaid.org/</ext-link>) to which users with a GISAID account ﻿may have access.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par48">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par49">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par50">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abadi</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The design and implementation of modern column-oriented database systems</article-title>
        <source>Found Trends® Databases</source>
        <year>2012</year>
        <volume>5</volume>
        <issue>3</issue>
        <fpage>197</fpage>
        <lpage>280</lpage>
        <pub-id pub-id-type="doi">10.1561/1900000024</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aksamentov</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Roemer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hodcroft</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Neher</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Nextclade: clade assignment, mutation calling and quality control for viral genomes</article-title>
        <source>J Open Source Softw</source>
        <year>2021</year>
        <volume>6</volume>
        <issue>67</issue>
        <fpage>3773</fpage>
        <pub-id pub-id-type="doi">10.21105/joss.03773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benson</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Cavanaugh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Karsch-Mizrachi</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Ostell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pruitt</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Sayers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>GenBank</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>46</volume>
        <issue>D1</issue>
        <fpage>D41</fpage>
        <lpage>D47</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx1094</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Black</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>MacCannell</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Sibley</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Bedford</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Ten recommendations for supporting open pathogen genomic analysis in public health</article-title>
        <source>Nat Med</source>
        <year>2020</year>
        <volume>26</volume>
        <issue>6</issue>
        <fpage>832</fpage>
        <lpage>841</lpage>
        <pub-id pub-id-type="doi">10.1038/s41591-020-0935-z</pub-id>
        <?supplied-pmid 32528156?>
        <pub-id pub-id-type="pmid">32528156</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Callaway</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>COVID ‘variant soup’ is making winter surges hard to predict</article-title>
        <source>Nature</source>
        <year>2022</year>
        <volume>611</volume>
        <issue>7935</issue>
        <fpage>213</fpage>
        <lpage>214</lpage>
        <pub-id pub-id-type="doi">10.1038/d41586-022-03445-6</pub-id>
        <?supplied-pmid 36307585?>
        <pub-id pub-id-type="pmid">36307585</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Centers for Disease Control and Prevention. Cdc covid data tracker (2023).</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nadeau</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Topolsky</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Advancing genomic epidemiology by addressing the bioinformatics bottleneck: challenges, design principles, and a swiss example</article-title>
        <source>Epidemics</source>
        <year>2022</year>
        <volume>39</volume>
        <fpage>100576</fpage>
        <pub-id pub-id-type="doi">10.1016/j.epidem.2022.100576</pub-id>
        <?supplied-pmid 35605437?>
        <pub-id pub-id-type="pmid">35605437</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nadeau</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yared</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Voinov</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Roemer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>CoV-spectrum: analysis of globally shared SARS-CoV-2 data to identify and characterize new variants</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>38</volume>
        <issue>6</issue>
        <fpage>1735</fpage>
        <lpage>1737</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab856</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nadeau</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Topolsky</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Manceau</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huisman</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Jablonski</surname>
            <given-names>KP</given-names>
          </name>
          <name>
            <surname>Fuhrmann</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Dreifuss</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jahn</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Beckmann</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Redondo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Noppen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Risch</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Risch</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wohlwend</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kas</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bodmer</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Roloff</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Stange</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Egli</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eckerle</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kaiser</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Denes</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Feldkamp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nissen</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Santacroce</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Burcklen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Aquino</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>de Gouvea</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Moccia</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Grüter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sykes</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Opitz</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Neff</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Popovic</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Patrignani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tracy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schlapbach</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dermitzakis</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Harshman</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Xenarios</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Pegeot</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cerutti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Penet</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Blin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Elies</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Althaus</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Beisel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ackermann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Quantification of the spread of SARS-CoV-2 variant B.1.1.7 in Switzerland</article-title>
        <source>Epidemics</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>100480</fpage>
        <pub-id pub-id-type="doi">10.1016/j.epidem.2021.100480</pub-id>
        <?supplied-pmid 34488035?>
        <pub-id pub-id-type="pmid">34488035</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Collet, Y. Rfc 8878: Zstandard compression and the ’application/zstd’ media type (2021).</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elbe</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Buckland-Merrett</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Data, disease and diplomacy: GISAID’s innovative contribution to global health</article-title>
        <source>Global Chall</source>
        <year>2017</year>
        <volume>1</volume>
        <issue>1</issue>
        <fpage>33</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="doi">10.1002/gch2.1018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Gangavarapu K, Latif AA, Mullen JL, Alkuzweny M, Hufbauer E, Tsueng G, Haag E, Zeller M, Aceves CM, Zaiets K, Cano M, Zhou X, Qian Z, Sattler R, Matteson NL, Levy JI, Lee RTC, Freitas L, Maurer-Stroh S, GISAID Core and Curation Team, Suchard MA, Wu C, Su AI, Andersen KG, Hughes LD. Outbreak.info genomic reports: scalable and dynamic surveillance of SARS-CoV-2 variants and mutations. Nat Methods. 2023.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Hodcroft EB. Covariants: Sars-cov-2 mutations and variants of interest (2021).</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hodcroft</surname>
            <given-names>EB</given-names>
          </name>
          <name>
            <surname>Maio</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Lanfear</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>MacCannell</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Minh</surname>
            <given-names>BQ</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dessimoz</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Want to track pandemic variants faster? Fix the bioinformatics bottleneck</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>591</volume>
        <issue>7848</issue>
        <fpage>30</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1038/d41586-021-00525-x</pub-id>
        <?supplied-pmid 33649511?>
        <pub-id pub-id-type="pmid">33649511</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Knyazev S, Chhugani K, Sarwal V, Ayyala R, Singh H, Karthikeyan S, Deshpande D, Baykal PI, Comarova Z, Lu A, Porozov Y, Vasylyeva TI, Wertheim JO, Tierney BT, Chiu CY, Sun R, Wu A, Abedalthagafi MS, Pak VM, Nagaraj SH, Smith AL, Skums P, Pasaniuc B, Komissarov A, Mason CE, Bortz E, Lemey P, Kondrashov F, Beerenwinkel N, Lam TT-Y, Wu NC, Zelikovsky A, Knight R, Crandall KA, Mangul S. Unlocking capacities of genomics for the COVID-19 response and future pandemics. Nat Methods. 2022.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>GF</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>The emergence, genomic diversity and global spread of SARS-CoV-2</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>600</volume>
        <issue>7889</issue>
        <fpage>408</fpage>
        <lpage>418</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-04188-6</pub-id>
        <?supplied-pmid 34880490?>
        <pub-id pub-id-type="pmid">34880490</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanderson</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Taxonium, a web-based tool for exploring large phylogenetic trees</article-title>
        <source>eLife</source>
        <year>2022</year>
        <volume>11</volume>
        <fpage>e82392</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.82392</pub-id>
        <?supplied-pmid 36377483?>
        <pub-id pub-id-type="pmid">36377483</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Sanderson, T. Tweet (2022).</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Tegally H, Moir M, Everatt J, Giovanetti M, Scheepers C, Wilkinson E, Subramoney K, Moyo S, Amoako DG, Baxter C, Althaus CL, Anyaneji UJ, Kekana D, Viana R, Giandhari J, Lessells RJ, Maponga T, Maruapula D, Choga W, Matshaba M, Mayaphi S, Mbhele N, Mbulawa MB, Msomi N, Naidoo Y, Pillay S, Sanko TJ, San JE, Scott L, Singh L, Magini NA, Smith-Lawrence P, Stevens W, Dor G, Tshiabuila D, Wolter N, Preiser W, Treurnicht FK, Venter M, Davids M, Chiloane G, Mendes A, McIntyre C, O’Toole A, Ruis C, Peacock TP, Roemer C, Williamson C, Pybus OG, Bhiman J, Glass A, Martin DP, Rambaut A, Gaseitsiwe S, von Gottberg A, de Oliveira T. Continued emergence and evolution of omicron in South Africa: new BA.4 and BA.5 lineages. 2022.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Viana</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Moyo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Amoako</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Tegally</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Scheepers</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Althaus</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Anyaneji</surname>
            <given-names>UJ</given-names>
          </name>
          <name>
            <surname>Bester</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Boni</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Chand</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Choga</surname>
            <given-names>WT</given-names>
          </name>
          <name>
            <surname>Colquhoun</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Davids</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deforche</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Doolabh</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>du Plessis</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Engelbrecht</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Everatt</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Giandhari</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Giovanetti</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hardie</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hsiao</surname>
            <given-names>N-Y</given-names>
          </name>
          <name>
            <surname>Iranzadeh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ismail</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Joseph</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Joseph</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Koopile</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pond</surname>
            <given-names>SLK</given-names>
          </name>
          <name>
            <surname>Kraemer</surname>
            <given-names>MUG</given-names>
          </name>
          <name>
            <surname>Kuate-Lere</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Laguda-Akingba</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Lesetedi-Mafoko</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Lessells</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Lockman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lucaci</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Maharaj</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mahlangu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Maponga</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mahlakwane</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Makatini</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Marais</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Maruapula</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Masupu</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Matshaba</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mayaphi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mbhele</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mbulawa</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Mendes</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mlisana</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mnguni</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mohale</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Moir</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moruisi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mosepele</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Motsatsi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Motswaledi</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Mphoyakgosi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Msomi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mwangi</surname>
            <given-names>PN</given-names>
          </name>
          <name>
            <surname>Naidoo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ntuli</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nyaga</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Olubayo</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pillay</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Radibe</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ramphal</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ramphal</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>San</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Shapiro</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Smith-Lawrence</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stevens</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Strydom</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Subramoney</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tebeila</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tshiabuila</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Tsui</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>van Wyk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Weaver</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wibmer</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Wilkinson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Wolter</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Zarebski</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Zuze</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Goedhals</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Preiser</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Treurnicht</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Venter</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Williamson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pybus</surname>
            <given-names>OG</given-names>
          </name>
          <name>
            <surname>Bhiman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Glass</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gaseitsiwe</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>von Gottberg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>de Oliveira</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Rapid epidemic expansion of the SARS-CoV-2 omicron variant in Southern Africa</article-title>
        <source>Nature</source>
        <year>2022</year>
        <volume>603</volume>
        <issue>7902</issue>
        <fpage>679</fpage>
        <lpage>686</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-022-04411-y</pub-id>
        <?supplied-pmid 35042229?>
        <pub-id pub-id-type="pmid">35042229</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
