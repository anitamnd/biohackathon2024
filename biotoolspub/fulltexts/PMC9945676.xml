<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9945676</article-id>
    <article-id pub-id-type="publisher-id">5174</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05174-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>LuxHMM: DNA methylation analysis with genome segmentation via hidden Markov model</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Malonzo</surname>
          <given-names>Maia H.</given-names>
        </name>
        <address>
          <email>maia.malonzo@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lähdesmäki</surname>
          <given-names>Harri</given-names>
        </name>
        <address>
          <email>harri.lahdesmaki@aalto.fi</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.5373.2</institution-id><institution-id institution-id-type="ISNI">0000000108389418</institution-id><institution>Department of Computer Science, </institution><institution>Aalto University, </institution></institution-wrap>00076 Espoo, Finland </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>58</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>6</day>
        <month>2</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">DNA methylation plays an important role in studying the epigenetics of various biological processes including many diseases. Although differential methylation of individual cytosines can be informative, given that methylation of neighboring CpGs are typically correlated, analysis of differentially methylated regions is often of more interest.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We have developed a probabilistic method and software, LuxHMM, that uses hidden Markov model (HMM) to segment the genome into regions and a Bayesian regression model, which allows handling of multiple covariates, to infer differential methylation of regions. Moreover, our model includes experimental parameters that describe the underlying biochemistry in bisulfite sequencing and model inference is done using either variational inference for efficient genome-scale analysis or Hamiltonian Monte Carlo (HMC).</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Analyses of real and simulated bisulfite sequencing data demonstrate the competitive performance of LuxHMM compared with other published differential methylation analysis methods.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05174-7.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Methylation</kwd>
      <kwd>Bisulfite sequencing</kwd>
      <kwd>Probabilistic</kwd>
      <kwd>HMM</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003502</institution-id>
            <institution>Ella ja Georg Ehrnroothin Säätiö</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002341</institution-id>
            <institution>Academy of Finland</institution>
          </institution-wrap>
        </funding-source>
        <award-id>314445</award-id>
        <principal-award-recipient>
          <name>
            <surname>Lähdesmäki</surname>
            <given-names>Harri</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par7">DNA methylation is an important epigenetic modification associated with many biological processes including various diseases. In promoters, DNA methylation tends to repress gene expression whereas in intragenic locations they tend to upregulate expression [<xref ref-type="bibr" rid="CR1">1</xref>]. Bisulfite sequencing, whether whole genome (WGBS) or reduced representation (RRBS) bisulfite sequencing, allows for interrogation of DNA methylation at the level of individual CpGs. Moreover, decreasing costs of sequencing have increased the use of these methods. DNA methylation are often studied by analyzing differentially methylated loci (DML) or regions (DMR). Although single differentially methylated CpGs are informative, often DMRs are of more interest [<xref ref-type="bibr" rid="CR2">2</xref>]. Further, analyzing the combined methylation differences of CpGs within regions increase the statistical power of differential methylation detection.</p>
    <p id="Par8">Given such interest in DMRs, several methods have been developed for identifying them (Table  <xref rid="Tab1" ref-type="table">1</xref>). RADMeth uses the beta-binomial regression method in handling complex experimental designs [<xref ref-type="bibr" rid="CR3">3</xref>]. Beta-binomial regression is used to individually fit single cytosines and then measures the significance of differential methylation using the log-likelihood ratio test between the full and reduced models which generates <italic>p</italic>-values. To combine information from neighboring cytosines into regions it transforms <italic>p</italic>-values using the weighted Z-test which then determines which cytosines are combined into regions using an FDR threshold. A method called metilene first recursively segments the genome into regions using the circular binary segmentation algorithm which generates regions that maximizes the difference of CpG-wise mean methylation levels [<xref ref-type="bibr" rid="CR4">4</xref>]. Then, it calculates <italic>p</italic>-values using a version of the Kolmogorov–Smirnov test which tests the significance of potential DMRs. HMM-DM uses hidden Markov model (HMM) to segment the genome into regions and Bayesian methods to infer model parameters. It then uses MCMC to compute the posterior probability of each state: hypermethylated, equally methylated or hypomethylated. To identify DMRs, it joins hypermethylated or hypomethylated CpGs into regions. In DMRcate, standard linear modelling is performed using limma which generates a signed statistic for measuring the difference between treatment effects per CpG site [<xref ref-type="bibr" rid="CR5">5</xref>]. The square of this value is then applied to a Gaussian smoother. It then uses an approximation that generates a value for which a <italic>p</italic>-value is computed by comparison to a chi-square distribution. Individual sites below a given <italic>p</italic>-value threshold are selected and grouped into regions that are separated by, at most, a threshold number of nucleotides. DSS models the methylation counts by a beta-binomial distribution with an arcsine link function and fits the transformed methylation levels with a generalized least squares procedure from which it obtains estimates of the model coefficients at each CpG site [<xref ref-type="bibr" rid="CR6">6</xref>]. Hypothesis testing is performed using Wald test on the coefficient estimates. After detection of statistically significant CpG sites, DSS merges nearby loci into regions.</p>
    <p id="Par9">LuxGLM [<xref ref-type="bibr" rid="CR7">7</xref>] and LuxUS [<xref ref-type="bibr" rid="CR8">8</xref>] use extended versions of generalized linear model (GLM) to analyze methylation data with complex experimental designs and incorporate estimation of experimental parameters that describe the underlying biochemistry in methylation sequencing data. LuxGLM uses matrix normal distribution to handle multiple methylation modifications. LuxUS uses a generalized linear mixed model (GLMM) to analyze cytosines within a genomic window simultaneously. To analyze the spatial correlation of cytosines it uses a random effect correlation structure. It also analyzes the variation of individual replicates using a replicate random effect. Features of previous methods as well as the proposed method, LuxHMM, are contrasted in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Methods comparison</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Method</th><th align="left">Methylation model</th><th align="left">Algorithm for CpG correlation</th></tr></thead><tbody><tr><td align="left">RADMeth</td><td align="left">Beta-binomial</td><td align="left">Weighted Z-test</td></tr><tr><td align="left">Metilene</td><td align="left">Kolmogorov–Smirnov</td><td align="left">Circular binary segmentation</td></tr><tr><td align="left">HMM-DM</td><td align="left">Bayesian HMM</td><td align="left">HMM</td></tr><tr><td align="left">DMRcate</td><td align="left">Linear Gaussian (limma)</td><td align="left">Kernel smoothing</td></tr><tr><td align="left">DSS</td><td align="left">Beta-binomial</td><td align="left">Smoothing via moving average</td></tr><tr><td align="left">LuxUS</td><td align="left">Bayesian GLMM</td><td align="left">Random effect correlation structure</td></tr><tr><td align="left">LuxHMM</td><td align="left">Bayesian GLM</td><td align="left">HMM</td></tr></tbody></table></table-wrap></p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par10">Bisulfite sequencing data consists of DNA where unmethylated cytosines are converted into uracil by bisulfite treatment and sequenced as thymine to differentiate it from methylated cytosine which are not converted and sequenced as cytosine.</p>
    <p id="Par11">A commonly used methylation level estimate is obtained by taking the ratio of methylated cytosine to the sum of methylated and unmethylated cytosine, <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu =N_{\text {BS,C}}/N_{\text {BS}}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mtext>BS,C</mml:mtext></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mtext>BS</mml:mtext></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq1.gif"/></alternatives></inline-formula>. To infer differential methylation, the methylation levels between groups are compared. Hypermethylation occurs when the methylation level for a comparison (or treatment) group is generally higher compared to a reference (or control) group, and hypomethylation when it is lower. We are interested in modeling methylation levels and differential methylation across <italic>T</italic> cytosines <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_1,c_2,\ldots ,c_T$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq2.gif"/></alternatives></inline-formula>. Differentially methylated regions are often of more interest than single cytosines due to their combined effect compared to the individual effect of a single cytosine. A methylated region <italic>C</italic> consists of consecutive CpGs <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_t$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq3.gif"/></alternatives></inline-formula>s that are hypermethylated, hypomethylated or have equal methylation (<inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_j$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq4.gif"/></alternatives></inline-formula>), <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C = \{c_t \mid c_t \in M_j\}$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq5.gif"/></alternatives></inline-formula>. A region is differentially methylated when it is either hypermethylated or hypomethylated.</p>
    <p id="Par12">Our method consists of two modules: (1) genome segmentation via HMM, and (2) estimation of methylation levels and inference of differential methylation using Bayesian GLM. In inference of differential methylation, significance of explanatory variable is measured by Bayes factors.</p>
    <sec id="Sec3">
      <title>Genome segmentation via HMM</title>
      <p id="Par13">To extract regions from a sequence of cytosines, we use hidden Markov model (HMM). HMM is a statistical model that infers a sequence of hidden states from a sequence of observations. In this work, the hidden states <italic>x</italic> are the methylation states, specifically: (1) hypermethylation, (2) hypomethylation, and (3) equal methylation between two groups. For each cytosine, the observations <italic>y</italic> are the differences in the mean methylation levels between groups, <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y={\overline{\mu }}_1-{\overline{\mu }}_2$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mover><mml:mi>μ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover><mml:mi>μ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq6.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{\mu }}_1$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mover><mml:mi>μ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq7.gif"/></alternatives></inline-formula> is the mean methylation level for one group and <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{\mu }}_2$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mover><mml:mi>μ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq8.gif"/></alternatives></inline-formula> for another.<fig id="Fig1"><label>Fig. 1</label><caption><p>Diagram of emission and transition probabilities. The top-most row (<italic>C</italic>) indicates the cytosine position, the second row (<italic>X</italic>) denotes the hidden methylation states and the bottom row (<italic>Y</italic>) represents the observed differences in methylation levels between groups. <italic>A</italic> denotes the state transition probabilities and <italic>B</italic> the observation emission probabilities</p></caption><graphic xlink:href="12859_2023_5174_Fig1_HTML" id="MO1"/></fig><fig id="Fig2"><label>Fig. 2</label><caption><p>Probability tree of observing “C” readout when the true methylation state is methylated or unmethylated</p></caption><graphic xlink:href="12859_2023_5174_Fig2_HTML" id="MO2"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>Plate diagram of the LuxHMM model for analyzing experimental parameters and methylation levels. The circles represent latent (white) and observed (gray) variables and the unbordered nodes represent hyperparameters and constant values</p></caption><graphic xlink:href="12859_2023_5174_Fig3_HTML" id="MO3"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>Distribution of methylation differences with three and four hidden states when the emission distributions are not specified</p></caption><graphic xlink:href="12859_2023_5174_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par14">HMM is parameterized by two distributions: the observation emission probabilities and the state transition probabilities (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The observation emission probabilities, <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(y_t | x_t)$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq9.gif"/></alternatives></inline-formula>, give the probability of observing <italic>y</italic> at cytosine position <italic>t</italic> given the underlying hidden state <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_t$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq10.gif"/></alternatives></inline-formula>, i.e. the probability of observing the differences in methylation levels between two groups given the underlying methylation states <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_j$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq11.gif"/></alternatives></inline-formula> (hypermethylation, hypomethylation or equal methylation). The state transition probabilities, <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(x_t|x_{t-1})$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq12.gif"/></alternatives></inline-formula>, give the probability of hidden state <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{t-1}$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq13.gif"/></alternatives></inline-formula> moving to <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_t$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq14.gif"/></alternatives></inline-formula> in a sequence, i.e. the probability of moving from one methylation state to another (or remaining the same) between two consecutive CpGs.</p>
      <p id="Par15">For a given hidden state sequence <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X=x_1,x_2,\ldots ,x_T$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq15.gif"/></alternatives></inline-formula> and observation sequence <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y=y_1,y_2,\ldots ,y_T$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq16.gif"/></alternatives></inline-formula>, the observation sequence likelihood is<disp-formula id="Equ4"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P(Y|X)=\prod _{t=1}^{T}P(y_t|x_t). \end{aligned}$$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5174_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>It is straightforward to compute the joint probability of a given sequence of methylation states and a sequence of observed methylation differences<disp-formula id="Equ5"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P(Y,X)=P(Y|X) P(X)=\prod _{t=1}^{T}P(y_t|x_t) \prod _{t=1}^{T}P(x_t|x_{t-1}). \end{aligned}$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5174_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>The total probability of the observed methylation differences can then be obtained by summing over the hidden states<disp-formula id="Equ6"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P(Y)=\sum _X P(Y,X)=\sum _X P(Y|X)P(X). \end{aligned}$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>X</mml:mi></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>X</mml:mi></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5174_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>With these definitions we can select the hidden state sequence that maximizes the observation likelihood. However, this is infeasible due to the high number of possible state sequences. Instead a dynamic programming algorithm like the Viterbi algorithm recursively computes <inline-formula id="IEq17"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_t(j)$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq17.gif"/></alternatives></inline-formula> which denotes the probability of being in state <italic>j</italic> given the observations for the first <italic>t</italic> cytosines. For a given state <inline-formula id="IEq18"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_j$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq18.gif"/></alternatives></inline-formula> at cytosine position <italic>t</italic>, <inline-formula id="IEq19"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_t(j)$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq19.gif"/></alternatives></inline-formula> is computed by<disp-formula id="Equ7"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} v_t(j)=\text{max}_{i}v_{t-1}(i)a_{ij}b_j(x_t) \end{aligned}$$\end{document}</tex-math><mml:math id="M46" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mtext>max</mml:mtext><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5174_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq20"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{t-1}(i)$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq20.gif"/></alternatives></inline-formula> is the previous Viterbi path probability from the previous time step, <inline-formula id="IEq21"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_{ij}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq21.gif"/></alternatives></inline-formula> is the transition probability from previous state <inline-formula id="IEq22"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_i$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq22.gif"/></alternatives></inline-formula> to current state <inline-formula id="IEq23"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_j$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq23.gif"/></alternatives></inline-formula> and <inline-formula id="IEq24"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_j(y_t)$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq24.gif"/></alternatives></inline-formula> is the emission probability of the observation <inline-formula id="IEq25"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_t$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq25.gif"/></alternatives></inline-formula> given state <italic>j</italic> [<xref ref-type="bibr" rid="CR9">9</xref>].</p>
      <p id="Par16">To learn the most likely transition, <inline-formula id="IEq26"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{A}}=\{a_{ij}\}$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mi mathvariant="bold">A</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq26.gif"/></alternatives></inline-formula>, and emission, <inline-formula id="IEq27"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{B}}=\{b_j(y_t)\}$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq27.gif"/></alternatives></inline-formula>, probabilities and initial state distribution <inline-formula id="IEq28"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi _{i}=P(X_{1}=i)$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq28.gif"/></alternatives></inline-formula>, the Baum-Welch algorithm, another dynamic programming algorithm, finds a (local) maximum of <inline-formula id="IEq29"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta^* = \text{arg}\,\text{max}_{\eta }P(Y\mid \eta )$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:msup><mml:mi>η</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mtext>arg</mml:mtext><mml:mspace width="0.166667em"/><mml:msub><mml:mtext>max</mml:mtext><mml:mi>η</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo>∣</mml:mo><mml:mi>η</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq29.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq30"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta =(A,B,\pi )$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq30.gif"/></alternatives></inline-formula>, using the expectation-maximization (EM) algorithm [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
      <p id="Par17">In this work we use pomegranate, a Python package that implements probabilistic models, including HMMs [<xref ref-type="bibr" rid="CR11">11</xref>]. The model is initialized with state and transition probabilities. We assume the emission distributions follow a Gaussian distribution <inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {N}}(\psi ,\sigma )$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ψ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq31.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi$$\end{document}</tex-math><mml:math id="M72"><mml:mi>ψ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq32.gif"/></alternatives></inline-formula> and <inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M74"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq33.gif"/></alternatives></inline-formula> are set to 0 and 0.08 (equal methylation), 0.3 and 0.06 (hypermethylation) and <inline-formula id="IEq34"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-$$\end{document}</tex-math><mml:math id="M76"><mml:mo>-</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq34.gif"/></alternatives></inline-formula>0.3 and 0.06 (hypomethylation). The transition probabilities were optimized using the Baum-Welch algorithm using the initial values shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 1</p>
      <p id="Par18">To determine the most likely sequence of hidden states, i.e. the sequence of methylation states, we use the Viterbi algorithm implemented in the package. To learn the most likely emission and transition probabilities given the sequence of observations we use the Baum-Welch algorithm, also supported by pomegranate. After learning the hidden methylation states, adjacent cytosines with the same methylation state are combined into regions, as well as the total read counts <inline-formula id="IEq35"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N^{\text {BS}}_{ir}=\sum _{k=1}^{W_{ir}} N^{\text {BS}}_{irk}$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">ir</mml:mi></mml:mrow><mml:mtext>BS</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">ir</mml:mi></mml:mrow></mml:msub></mml:msubsup><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">irk</mml:mi></mml:mrow><mml:mtext>BS</mml:mtext></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq35.gif"/></alternatives></inline-formula>, where <italic>k</italic> is the <italic>k</italic>th CpG in <inline-formula id="IEq36"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{ir}$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">ir</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq36.gif"/></alternatives></inline-formula> and <inline-formula id="IEq37"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{ir}=|C_{ir}|$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">ir</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">ir</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq37.gif"/></alternatives></inline-formula> is the number of consecutive CpGs with the same methylation state in the <italic>i</italic>th sample and the <italic>r</italic>th region and, similarly for methylated read counts, <inline-formula id="IEq38"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N^{\text {BS,C}}_{ir}=\sum _{k=1}^{W_{ir}} N^\text {BS,C}_{irk}$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">ir</mml:mi></mml:mrow><mml:mtext>BS,C</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi mathvariant="italic">ir</mml:mi></mml:mrow></mml:msub></mml:msubsup><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="italic">irk</mml:mi></mml:mrow><mml:mtext>BS,C</mml:mtext></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq38.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec4">
      <title>Estimation of methylation levels and differential methylation</title>
      <p id="Par19">We briefly review the underlying statistical model for the experimental parameters [<xref ref-type="bibr" rid="CR7">7</xref>]. Experimental parameters that define the underlying biochemistry in bisulfite sequencing should be considered in estimation of methylation levels. Bisulfite conversion rate (<inline-formula id="IEq39"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {BS_{eff}}$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq39.gif"/></alternatives></inline-formula>), sequencing error (<inline-formula id="IEq40"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {seq_{err}}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq40.gif"/></alternatives></inline-formula>) and incorrect bisulfite conversion rate (<inline-formula id="IEq41"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {BS^*_{eff}}$$\end{document}</tex-math><mml:math id="M90"><mml:msubsup><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq41.gif"/></alternatives></inline-formula>) can significantly affect methylation estimates. Low <inline-formula id="IEq42"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {BS_{eff}}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq42.gif"/></alternatives></inline-formula> causes overestimation of methylation levels whereas high <inline-formula id="IEq43"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {BS^*_{eff}}$$\end{document}</tex-math><mml:math id="M94"><mml:msubsup><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq43.gif"/></alternatives></inline-formula> results in underestimation. On the other hand, high <inline-formula id="IEq44"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {seq_{err}}$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq44.gif"/></alternatives></inline-formula> can lead to either overestimation or underestimation.</p>
      <p id="Par20"><inline-formula id="IEq45"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {BS_{eff}}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq45.gif"/></alternatives></inline-formula> can be estimated by using the lambda phage genome. Since the lambda phage genome is unmethylated, <inline-formula id="IEq46"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {BS_{eff}}$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq46.gif"/></alternatives></inline-formula> can be estimated by taking the ratio of all cytosine reads converted into thymine over the total number of reads. Similarly, <inline-formula id="IEq47"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {BS^*_{eff}}$$\end{document}</tex-math><mml:math id="M102"><mml:msubsup><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq47.gif"/></alternatives></inline-formula> can be estimated with spike-ins of oligonucleotides where all the cytosines are methylated. On the other hand, <inline-formula id="IEq48"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {seq_{err}}$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq48.gif"/></alternatives></inline-formula> can be estimated using Phred scores <italic>Q</italic> by converting them to base-calling error probabilities <inline-formula id="IEq49"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P=10^{\frac{-Q}{10}}$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mfrac><mml:mrow><mml:mo>-</mml:mo><mml:mi>Q</mml:mi></mml:mrow><mml:mn>10</mml:mn></mml:mfrac></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq49.gif"/></alternatives></inline-formula>.</p>
      <p id="Par21">Given the above definitions, <inline-formula id="IEq50"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {BS_{eff}}$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq50.gif"/></alternatives></inline-formula>, <inline-formula id="IEq51"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {BS_{eff}^*}$$\end{document}</tex-math><mml:math id="M110"><mml:msubsup><mml:mi mathvariant="normal">BS</mml:mi><mml:mrow><mml:mi mathvariant="normal">eff</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq51.gif"/></alternatives></inline-formula> and <inline-formula id="IEq52"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {seq_{err}}$$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq52.gif"/></alternatives></inline-formula> determine the conditional probability of a sequencing readout being “C”, given that the cytosine is methylated or unmethylated (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Specifically, since <inline-formula id="IEq53"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {BS_{eff}}$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq53.gif"/></alternatives></inline-formula> is the probability of an unmethylated cytosine being converted into uracil, <inline-formula id="IEq54"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1-\mathrm {BS_{eff}}$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq54.gif"/></alternatives></inline-formula> is the probability of an unmethylated cytosine incorrectly not converted into uracil. If an unmethylated cytosine is correctly converted into uracil it still has <inline-formula id="IEq55"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {seq_{err}}$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq55.gif"/></alternatives></inline-formula> probability of being incorrectly sequenced as “C”. Whereas, if it is incorrectly not converted to uracil and remains a cytosine, it has <inline-formula id="IEq56"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1-\mathrm {seq_{err}}$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq56.gif"/></alternatives></inline-formula> probability of being correctly sequenced as “C”. Put together, the conditional probability of sequencing “C” given the cytosine is unmethylated is<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} p_{\text{BS}}(\mathrm {``C''|C})=(1-\mathrm {BS_{eff}})(1-\mathrm {seq_{err}}) + \mathrm {BS_{eff}} \mathrm {seq_{err}}. \end{aligned}$$\end{document}</tex-math><mml:math id="M122" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>BS</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>`</mml:mo><mml:mo>`</mml:mo><mml:msup><mml:mi mathvariant="normal">C</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5174_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>On the other hand, if a cytosine is methylated, the probability that it is correctly not converted to uracil is <inline-formula id="IEq57"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1-\mathrm {BS^*_{eff}}$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq57.gif"/></alternatives></inline-formula> and the probability that it is correctly sequenced as “C” is <inline-formula id="IEq58"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1-\mathrm {seq_{err}}$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq58.gif"/></alternatives></inline-formula>. The probability that the unmethylated cytosine is incorrectly converted to uracil and incorrectly sequenced as “C” are, respectively, <inline-formula id="IEq59"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {BS^*_{eff}}$$\end{document}</tex-math><mml:math id="M128"><mml:msubsup><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq59.gif"/></alternatives></inline-formula> and <inline-formula id="IEq60"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {seq_{err}}$$\end{document}</tex-math><mml:math id="M130"><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq60.gif"/></alternatives></inline-formula>. Thus, the conditional probability of sequencing “C” given the cytosine is methylated is<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} p_{\text{BS}}(\mathrm {``C''|5mC}) = (1-\mathrm {BS^*_{eff}})(1-\mathrm {seq_{err}}) + \mathrm {BS^*_{eff}} \mathrm {seq_{err}}. \end{aligned}$$\end{document}</tex-math><mml:math id="M132" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>BS</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>`</mml:mo><mml:mo>`</mml:mo><mml:msup><mml:mi mathvariant="normal">C</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mn>5</mml:mn><mml:mi mathvariant="normal">mC</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="normal">BS</mml:mi><mml:mi mathvariant="normal">eff</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:msub><mml:mi mathvariant="normal">seq</mml:mi><mml:mi mathvariant="normal">err</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5174_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>Thus far we have described individual cytosines. However, this description can be generalized to DNA regions. Let <inline-formula id="IEq61"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta \in [0,1]$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq61.gif"/></alternatives></inline-formula> represent the unknown fraction (or probability) of methylated DNA. Following Eqs. <xref rid="Equ1" ref-type="disp-formula">1</xref> and <xref rid="Equ2" ref-type="disp-formula">2</xref>, the probability of observing “C” readouts for a given region is <inline-formula id="IEq62"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p_{\text{BS}}(\mathrm {``C''}) = p_\text{BS}(\mathrm {``C''} | \text{5mC})\theta + p_\text{BS}(\mathrm {``C''} | \text{C})(1-\theta )}$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>BS</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>`</mml:mo><mml:mo>`</mml:mo><mml:msup><mml:mi mathvariant="normal">C</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mtext>BS</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>`</mml:mo><mml:mo>`</mml:mo><mml:msup><mml:mi mathvariant="normal">C</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mtext>5mC</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mtext>BS</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>`</mml:mo><mml:mo>`</mml:mo><mml:msup><mml:mi mathvariant="normal">C</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mtext>C</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq62.gif"/></alternatives></inline-formula>. Finally, the total number of “C” readouts is binomially distributed,<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} N_{\text{BS,C}} \sim \text {Bin}(N_\text{BS},p_{\text{BS}}\mathrm {(``C'')}), \end{aligned}$$\end{document}</tex-math><mml:math id="M138" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>BS,C</mml:mtext></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Bin</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mtext>BS</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mtext>BS</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>`</mml:mo><mml:mo>`</mml:mo><mml:msup><mml:mi mathvariant="normal">C</mml:mi><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5174_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq63"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{\text{BS}}$$\end{document}</tex-math><mml:math id="M140"><mml:msub><mml:mi>N</mml:mi><mml:mtext>BS</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq63.gif"/></alternatives></inline-formula> is the total number of reads. See Fig. <xref rid="Fig3" ref-type="fig">3</xref> for the plate diagram of the model.</p>
      <p id="Par22">To incorporate complex experimental designs to the model, we simplify the method proposed in [<xref ref-type="bibr" rid="CR8">8</xref>] by doing away with the spatial correlation component and use generalized linear regression,<disp-formula id="Equ8"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textbf{b}}&amp;\sim {\mathcal {N}}({\textbf{0}},\sigma _{{\textbf{b}}}^{2}{\textbf{I}}) \\ \sigma _E^2&amp;\sim \text {Gamma}(\alpha _E,\beta _E)\\ {\textbf{Y}}&amp;\sim {\mathcal {N}}({\textbf{D}}{\textbf{b}},\sigma _E^2), \end{aligned}$$\end{document}</tex-math><mml:math id="M142" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi mathvariant="bold">b</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mi mathvariant="bold">I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">D</mml:mi><mml:mi mathvariant="bold">b</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5174_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq64"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{b}} \in {\mathbb {R}}^{N_p}$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:mi mathvariant="bold">b</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq64.gif"/></alternatives></inline-formula> (where <inline-formula id="IEq65"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_p$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq65.gif"/></alternatives></inline-formula> is the number of covariates, possibly including the intercept) is the vector of regression coefficients, <inline-formula id="IEq66"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{D}} \in {\mathbb {R}}^{N \times Np}$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:mi mathvariant="bold">D</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq66.gif"/></alternatives></inline-formula> is the design matrix, and <inline-formula id="IEq67"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Y}} \in {\mathbb {R}}^N$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq67.gif"/></alternatives></inline-formula>. The values of the hyperparameters are <inline-formula id="IEq68"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _B^2=15$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq68.gif"/></alternatives></inline-formula>, <inline-formula id="IEq69"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _E=5$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq69.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq70"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _E=5$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq70.gif"/></alternatives></inline-formula>, and were taken from [<xref ref-type="bibr" rid="CR8">8</xref>]. We apply this model to regions instead of single CpGs to speed up computation. Finally, we use the sigmoid link function<disp-formula id="Equ9"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \theta =\sigma ({\textbf{Y}}). \end{aligned}$$\end{document}</tex-math><mml:math id="M158" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5174_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>The model is implemented using the probabilistic programming language Stan [<xref ref-type="bibr" rid="CR12">12</xref>], and model inference is done using either Hamiltonian Monte Carlo (HMC) or automatic differentiation variational inference (ADVI) for faster estimation of the model parameters [<xref ref-type="bibr" rid="CR13">13</xref>], both built-in features of Stan. Stan uses a locally adaptive version of dynamic HMC sampling. In variational inference (VI) the posterior <inline-formula id="IEq71"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p(\phi |D)$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq71.gif"/></alternatives></inline-formula> of all unknowns <inline-formula id="IEq72"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M162"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq72.gif"/></alternatives></inline-formula> given observed data <italic>D</italic> is approximated with a simpler distribution <inline-formula id="IEq73"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q(\phi ;\rho )$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>;</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq73.gif"/></alternatives></inline-formula>, which is selected from a chosen family of distributions by minimizing divergence between <inline-formula id="IEq74"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p(\phi |D)$$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq74.gif"/></alternatives></inline-formula> and <inline-formula id="IEq75"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q(\phi ;\rho )$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>;</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq75.gif"/></alternatives></inline-formula>.</p>
      <p id="Par23">To detect differential methylation w.r.t. any of the <inline-formula id="IEq76"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_p$$\end{document}</tex-math><mml:math id="M170"><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq76.gif"/></alternatives></inline-formula> covariates in <inline-formula id="IEq77"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{D}}$$\end{document}</tex-math><mml:math id="M172"><mml:mi mathvariant="bold">D</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq77.gif"/></alternatives></inline-formula>, hypothesis testing was done using Bayes factors via the Savage-Dickey density ratio method as implemented in [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Results</title>
    <p id="Par24">To demonstrate the performance of LuxHMM and how well it performs compared to other methods, we analyze real and simulated BS-seq datasets. The first dataset is a simulated dataset based on real BS-seq data. The second is a simulated BS-seq dataset generated using a general experimental design. Lastly, we use a real BS-seq dataset with confounding covariates. We compare the performance of LuxHMM with RADMeth, metilene, HMM-DM, DMRcate and DSS.</p>
    <sec id="Sec6">
      <title>Comparison of performance on simulated dataset based on real BS-seq data</title>
      <p id="Par25">To assess the accuracy of our method compared to other published methods we used a simulated dataset by [<xref ref-type="bibr" rid="CR14">14</xref>]. Bisulfite sequencing data was obtained from real CpG islands which allowed variance and correlation to be incorporated into the simulated dataset. The dataset was derived from 12 individuals which were divided into 6 controls and 6 cases. The dataset was divided into two sets wherein 10,000 DMRs were incorporated into one set. Methylation counts were added to or substracted from the case samples so that the methylation differences were 0.1, 0.2, 0.3 or 0.4.</p>
      <p id="Par26">In LuxHMM, either all regions or only candidate hypo- and hypermethylated regions, as classified by HMM, were used as input in determining DMRs. Parameter settings for competing methods are described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 2.</p>
      <p id="Par27">The area under the receiver operating curve (AUROC) and the average precision (AP), to handle the imbalance in the dataset given that there are much more negative than positive samples, were computed (Table <xref rid="Tab2" ref-type="table">2</xref>). For AP, the baseline is 0.11 which is the fraction of the number of true positives over the total number tests. True positives are differentially methylated cytosines whereas negatives are non-differentially methylated cytosines. In all methods, cytosines which are not covered by the returned regions are given a score of zero. The highest AUROC and AP were generated by LuxHMM used with all regions. The higher recall suggests that the state assignment of HMM misses differentially methylated regions which are inaccurately classified as regions with equal methylation between two groups. This also demonstrates that LuxHMM more accurately detects DMRs compared to the other methods used. Another notable result is that DMRcate has a relatively high AUROC and a low AP. This could be caused by a high false positive rate which is masked in AUROC due to a high number of true negative samples. As true negative samples are excluded in the computation of AP, the high false positive rate results in a low AP.<table-wrap id="Tab2"><label>Table 2</label><caption><p>AUROC and AP for simulated dataset from [<xref ref-type="bibr" rid="CR14">14</xref>]</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Method</th><th align="left">AUROC</th><th align="left">AP</th></tr></thead><tbody><tr><td align="left">LuxHMM <inline-formula id="IEq78"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{1}$$\end{document}</tex-math><mml:math id="M174"><mml:msup><mml:mrow/><mml:mn>1</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq78.gif"/></alternatives></inline-formula></td><td char="." align="char"><bold>0.945</bold></td><td char="." align="char"><bold>0.852</bold></td></tr><tr><td align="left">LuxHMM <inline-formula id="IEq79"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{2}$$\end{document}</tex-math><mml:math id="M176"><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq79.gif"/></alternatives></inline-formula></td><td char="." align="char">0.935</td><td char="." align="char">0.830</td></tr><tr><td align="left">LuxUS</td><td char="." align="char">0.900</td><td char="." align="char">0.601</td></tr><tr><td align="left">RADMeth</td><td char="." align="char">0.831</td><td char="." align="char">0.644</td></tr><tr><td align="left">Metilene</td><td char="." align="char">0.834</td><td char="." align="char">0.674</td></tr><tr><td align="left">HMM-DM</td><td char="." align="char">0.626</td><td char="." align="char">0.315</td></tr><tr><td align="left">DMRcate</td><td char="." align="char">0.621</td><td char="." align="char">0.182</td></tr><tr><td align="left">DSS</td><td char="." align="char">0.857</td><td char="." align="char">0.712</td></tr></tbody></table><table-wrap-foot><p>Bold represent the highest values in each column</p><p>1 All regions</p><p>2 Hypo- and hypermethylated regions</p></table-wrap-foot></table-wrap></p>
      <sec id="Sec7">
        <title>Alternative emission probabilities</title>
        <p id="Par28">To test the sensitivity of the proposed model to different emission distribution parameters, we tested various parameter values on the [<xref ref-type="bibr" rid="CR14">14</xref>] dataset using all regions. Table <xref rid="Tab3" ref-type="table">3</xref> shows that the model is not sensitive to different values of standard deviation but is sensitive to the means, with the highest AP when using means <inline-formula id="IEq80"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-$$\end{document}</tex-math><mml:math id="M178"><mml:mo>-</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq80.gif"/></alternatives></inline-formula>0.3 and 0.3.<table-wrap id="Tab3"><label>Table 3</label><caption><p>AUROC and AP for different emission distributions</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Equal mean</th><th align="left">Std. dev.</th><th align="left">Hypo mean</th><th align="left">Std. dev.</th><th align="left">Hyper mean</th><th align="left">Std. dev.</th><th align="left">AUROC</th><th align="left">AP</th></tr></thead><tbody><tr><td align="left">0</td><td char="." align="char">0.08</td><td char="." align="char">− 0.1</td><td char="." align="char">0.06</td><td char="." align="char">0.1</td><td char="." align="char">0.06</td><td char="." align="char">0.930</td><td char="." align="char">0.730</td></tr><tr><td align="left">0</td><td char="." align="char">0.06</td><td char="." align="char">− 0.3</td><td char="." align="char">0.04</td><td char="." align="char">0.3</td><td char="." align="char">0.04</td><td char="." align="char">0.945</td><td char="." align="char">0.852</td></tr><tr><td align="left">0</td><td char="." align="char">0.06</td><td char="." align="char">− 0.3</td><td char="." align="char">0.05</td><td char="." align="char">0.3</td><td char="." align="char">0.05</td><td char="." align="char">0.945</td><td char="." align="char">0.852</td></tr><tr><td align="left">0</td><td char="." align="char">0.08</td><td char="." align="char">− 0.3</td><td char="." align="char">0.06</td><td char="." align="char">0.3</td><td char="." align="char">0.06</td><td char="." align="char">0.945</td><td char="." align="char">0.852</td></tr><tr><td align="left">0</td><td char="." align="char">0.1</td><td char="." align="char">− 0.3</td><td char="." align="char">0.07</td><td char="." align="char">0.3</td><td char="." align="char">0.07</td><td char="." align="char">0.945</td><td char="." align="char">0.852</td></tr><tr><td align="left">0</td><td char="." align="char">0.1</td><td char="." align="char">− 0.3</td><td char="." align="char">0.08</td><td char="." align="char">0.3</td><td char="." align="char">0.08</td><td char="." align="char">0.945</td><td char="." align="char">0.852</td></tr><tr><td align="left">0</td><td char="." align="char">0.1</td><td char="." align="char">− 0.3</td><td char="." align="char">0.1</td><td char="." align="char">0.3</td><td char="." align="char">0.1</td><td char="." align="char">0.945</td><td char="." align="char">0.852</td></tr><tr><td align="left">0</td><td char="." align="char">0.08</td><td char="." align="char">− 0.5</td><td char="." align="char">0.06</td><td char="." align="char">0.5</td><td char="." align="char">0.06</td><td char="." align="char">0.893</td><td char="." align="char">0.775</td></tr><tr><td align="left">0</td><td char="." align="char">0.1</td><td char="." align="char">− 0.5</td><td char="." align="char">0.07</td><td char="." align="char">0.5</td><td char="." align="char">0.07</td><td char="." align="char">0.892</td><td char="." align="char">0.774</td></tr></tbody></table></table-wrap></p>
        <p id="Par29">We also tested using five hidden states with two hidden states each for the hypo- and hypermethylated regions (Table  <xref rid="Tab4" ref-type="table">4</xref>). The AUROC and AP are, respectively, 0.946 and 0.844, indicating that increasing the number of hidden states from three to five does not increase accuracy.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Emission parameters for a HMM model with five hidden states</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">State</th><th align="left">Mean</th><th align="left">Std. dev.</th></tr></thead><tbody><tr><td align="left"><inline-formula id="IEq81"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{Equal}$$\end{document}</tex-math><mml:math id="M180"><mml:mtext>Equal</mml:mtext></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq81.gif"/></alternatives></inline-formula></td><td char="." align="char">0</td><td char="." align="char">0.08</td></tr><tr><td align="left"><inline-formula id="IEq82"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {Hypo_1}$$\end{document}</tex-math><mml:math id="M182"><mml:msub><mml:mi mathvariant="normal">Hypo</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq82.gif"/></alternatives></inline-formula></td><td char="." align="char">− 0.25</td><td char="." align="char">0.06</td></tr><tr><td align="left"><inline-formula id="IEq83"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {Hypo_2}$$\end{document}</tex-math><mml:math id="M184"><mml:msub><mml:mi mathvariant="normal">Hypo</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq83.gif"/></alternatives></inline-formula></td><td char="." align="char">− 0.5</td><td char="." align="char">0.06</td></tr><tr><td align="left"><inline-formula id="IEq84"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {Hyper_1}$$\end{document}</tex-math><mml:math id="M186"><mml:msub><mml:mi mathvariant="normal">Hyper</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq84.gif"/></alternatives></inline-formula></td><td char="." align="char">0.25</td><td char="." align="char">0.06</td></tr><tr><td align="left"><inline-formula id="IEq85"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm {Hyper_2}$$\end{document}</tex-math><mml:math id="M188"><mml:msub><mml:mi mathvariant="normal">Hyper</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq85.gif"/></alternatives></inline-formula></td><td char="." align="char">0.5</td><td char="." align="char">0.06</td></tr></tbody></table></table-wrap></p>
        <p id="Par30">When not specifying the emission distributions and letting pomegranate instead estimate the emission distributions we obtain a higher AUROC and a lower AP (Table  <xref rid="Tab5" ref-type="table">5</xref>). We prioritize AP as it takes into account the imbalanced dataset. Genome segmentation was based on Fig. <xref rid="Fig4" ref-type="fig">4</xref>. For three hidden states, we used <italic>s</italic>1 as candidate hypo- and hypermethylated states (with <italic>s</italic>0 and <italic>s</italic>2 as states with no difference between groups), whereas with four hidden states we used <italic>s</italic>1 and <italic>s</italic>2 as candidate hypo- and hypermethylated states (with <italic>s</italic>0 and <italic>s</italic>3 as states with no difference between groups). In computing AUROC and AP we used either all hidden states (including state with no difference between groups) or just candidate hypo- and hypermethylated states.<table-wrap id="Tab5"><label>Table 5</label><caption><p>AUROC and AP when not specifying state distributions</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Number of states</th><th align="left">AUROC</th><th align="left">AP</th></tr></thead><tbody><tr><td align="left">3<inline-formula id="IEq86"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{1}$$\end{document}</tex-math><mml:math id="M190"><mml:msup><mml:mrow/><mml:mn>1</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq86.gif"/></alternatives></inline-formula></td><td align="left">0.939</td><td align="left">0.784</td></tr><tr><td align="left">4<inline-formula id="IEq87"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{1}$$\end{document}</tex-math><mml:math id="M192"><mml:msup><mml:mrow/><mml:mn>1</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq87.gif"/></alternatives></inline-formula></td><td align="left">0.930</td><td align="left">0.761</td></tr><tr><td align="left">3<inline-formula id="IEq88"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{2}$$\end{document}</tex-math><mml:math id="M194"><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq88.gif"/></alternatives></inline-formula></td><td align="left">0.959</td><td align="left">0.764</td></tr><tr><td align="left">4<inline-formula id="IEq89"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{2}$$\end{document}</tex-math><mml:math id="M196"><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq89.gif"/></alternatives></inline-formula></td><td align="left">0.947</td><td align="left">0.772</td></tr></tbody></table><table-wrap-foot><p>1 All regions</p><p>2 Hypo- and hypermethylated regions</p></table-wrap-foot></table-wrap></p>
      </sec>
      <sec id="Sec8">
        <title>Comparing beta-values and M-values</title>
        <p id="Par31">We used the beta-value representation for methylation levels as they allow a more intuitive interpretation. However, the emission distributions used for the beta-values are normal distributions which are better suited with the support of M-values which is the set of real numbers. As such, we tested the method using M-values instead of beta-values for analyzing the dataset from [<xref ref-type="bibr" rid="CR14">14</xref>] using as input candidate hypo- and hypermethylated regions. For the mean values of the emission distribution we used values that are roughly equivalent to a methylation difference of <inline-formula id="IEq90"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-$$\end{document}</tex-math><mml:math id="M198"><mml:mo>-</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq90.gif"/></alternatives></inline-formula>0.3 and 0.3 to be comparable with the analysis using beta-values (Table  <xref rid="Tab6" ref-type="table">6</xref>). The highest AUROC and AP generated were obtained using means <inline-formula id="IEq91"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-$$\end{document}</tex-math><mml:math id="M200"><mml:mo>-</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq91.gif"/></alternatives></inline-formula>1.2 (hypomethylated) and 1.2 (hypermethylated) and <inline-formula id="IEq92"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-$$\end{document}</tex-math><mml:math id="M202"><mml:mo>-</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq92.gif"/></alternatives></inline-formula>1.7 and 1.7, respectively. The AUROC was higher using M-values (0.942 vs. 0.935) but the AP was higher using beta-values (0.820 vs. 0.830). We prioritize the higher AP over AUROC as it controls for the imbalance in the dataset. This indicates that although the range of values of methylation difference using beta-values is <inline-formula id="IEq93"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[-1,1]$$\end{document}</tex-math><mml:math id="M204"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq93.gif"/></alternatives></inline-formula>, the normal distributions we used for the emission probabilities is able to sufficiently approximate the distribution of methylation differences.<table-wrap id="Tab6"><label>Table 6</label><caption><p>AUROC and AP for different emission distributions using M-values</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Equal mean</th><th align="left">Std. dev.</th><th align="left">Hypo mean</th><th align="left">Std. dev.</th><th align="left">Hyper mean</th><th align="left">Std. dev.</th><th align="left">AUROC</th><th align="left">AP</th></tr></thead><tbody><tr><td align="left">0</td><td char="." align="char">0.5</td><td char="." align="char">− 1.2</td><td char="." align="char">0.5</td><td char="." align="char">1.2</td><td char="." align="char">0.5</td><td char="," align="char"><bold>0.942</bold></td><td char="." align="char">0.810</td></tr><tr><td align="left">0</td><td char="." align="char">0.5</td><td char="." align="char">− 1.7</td><td char="." align="char">0.5</td><td char="." align="char">1.7</td><td char="." align="char">0.5</td><td char="," align="char">0.936</td><td char="." align="char"><bold>0.820</bold></td></tr><tr><td align="left">0</td><td char="." align="char">0.5</td><td char="." align="char">− 2.2</td><td char="." align="char">0.5</td><td char="." align="char">2.2</td><td char="." align="char">0.5</td><td char="," align="char">0.927</td><td char="." align="char">0.816</td></tr></tbody></table><table-wrap-foot><p>Bold represent the highest values in each column</p></table-wrap-foot></table-wrap></p>
      </sec>
      <sec id="Sec9">
        <title>Running time</title>
        <p id="Par32">We measured the time it takes to run the analysis using as input chromosome 1 from the dataset by [<xref ref-type="bibr" rid="CR14">14</xref>] using a single CPU. For comparison we also used as input only the first half of chromosome 1. The running time for the HMM step was negligible hence we only show here the computational times for the Bayesian analysis. We also compared the running times when using all regions and when only using candidate hypo- and hypermethylated regions. As shown in Table <xref rid="Tab7" ref-type="table">7</xref>, using ADVI for posterior inference significantly reduces running time compared to HMC. Also, when using all regions the running time is significantly increased in comparison to just using candidate hypo- and hypermethylated regions. As expected, the running times are proportional to the number of CpGs analyzed such that halving the number of CpG sites (and DMRs) approximately halves running time. The number of DMRs also affects running time by increasing it.<table-wrap id="Tab7"><label>Table 7</label><caption><p>Running times</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">No. of CpGs</th><th align="left">No. of DMRs</th><th align="left">Method</th><th align="left">Input</th><th align="left">Time (minutes)</th></tr></thead><tbody><tr><td align="left">214,878</td><td align="left">910</td><td align="left">HMC</td><td align="left">All regions</td><td char="." align="char">89</td></tr><tr><td align="left">214,878</td><td align="left">910</td><td align="left">ADVI</td><td align="left">All regions</td><td char="." align="char">34</td></tr><tr><td align="left">214,878</td><td align="left">910</td><td align="left">ADVI</td><td align="left">Hypo/hyper</td><td char="." align="char">4</td></tr><tr><td align="left">107,439</td><td align="left">450</td><td align="left">ADVI</td><td align="left">Hypo/Hyper</td><td char="." align="char">2</td></tr><tr><td align="left">107,439</td><td align="left">910</td><td align="left">ADVI</td><td align="left">Hypo/hyper</td><td char="." align="char">3</td></tr></tbody></table></table-wrap></p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Comparison of performance on simulated dataset with confounding covariates</title>
      <p id="Par33">To test the performance of LuxHMM in datasets with general experimental design we simulated a dataset with multiple covariates: (1) binary case/control, (2) arbitrary binary, (3) arbitrary continuous. The design matrix <inline-formula id="IEq94"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{D}}$$\end{document}</tex-math><mml:math id="M206"><mml:mi mathvariant="bold">D</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq94.gif"/></alternatives></inline-formula> is shown in Table  <xref rid="Tab8" ref-type="table">8</xref>. This simulation was modified from [<xref ref-type="bibr" rid="CR5">5</xref>].<table-wrap id="Tab8"><label>Table 8</label><caption><p>Design matrix for simulated data</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Intercept</th><th align="left">Case/control</th><th align="left">Binary</th><th align="left">Continuous</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">0</td><td align="left">0</td><td align="left">0.3</td></tr><tr><td align="left">1</td><td align="left">0</td><td align="left">1</td><td align="left">0.5</td></tr><tr><td align="left">1</td><td align="left">0</td><td align="left">0</td><td align="left">0.7</td></tr><tr><td align="left">1</td><td align="left">1</td><td align="left">1</td><td align="left">0.3</td></tr><tr><td align="left">1</td><td align="left">1</td><td align="left">0</td><td align="left">0.5</td></tr><tr><td align="left">1</td><td align="left">1</td><td align="left">1</td><td align="left">0.7</td></tr></tbody></table></table-wrap></p>
      <p id="Par34">To model the varying lengths of methylated regions, the length <italic>L</italic> of the regions in terms of number of CpGs was sampled from <inline-formula id="IEq95"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L \sim \text {ceiling}(\text {gamma}(\text {shape}=4,\text {rate}=0.2))$$\end{document}</tex-math><mml:math id="M208"><mml:mrow><mml:mi>L</mml:mi><mml:mo>∼</mml:mo><mml:mtext>ceiling</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext>gamma</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext>shape</mml:mtext><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mtext>rate</mml:mtext><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq95.gif"/></alternatives></inline-formula>. The genomic coordinates were taken from the hg19 build. To model the varying differences in methylation levels, the covariate coefficients <inline-formula id="IEq96"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{b}}$$\end{document}</tex-math><mml:math id="M210"><mml:mi mathvariant="bold">b</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq96.gif"/></alternatives></inline-formula> were sampled from <inline-formula id="IEq97"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{b}} \sim {\mathcal {N}}(\mu =0,\sigma ^2=5)$$\end{document}</tex-math><mml:math id="M212"><mml:mrow><mml:mi mathvariant="bold">b</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq97.gif"/></alternatives></inline-formula>. For non-differentially methylated regions, the coefficient corresponding to the covariate of interest was set to zero. Conversely, for differentially methylated regions, the coefficient corresponding to the covariate of interest <italic>b</italic> was set so that <inline-formula id="IEq98"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b &lt; -3$$\end{document}</tex-math><mml:math id="M214"><mml:mrow><mml:mi>b</mml:mi><mml:mo>&lt;</mml:mo><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq98.gif"/></alternatives></inline-formula> or <inline-formula id="IEq99"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b &gt; 3$$\end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:mi>b</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq99.gif"/></alternatives></inline-formula> to ensure significant differential methylation. Finally, <inline-formula id="IEq100"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {\theta }=\sigma ({\textbf{Y}})$$\end{document}</tex-math><mml:math id="M218"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq100.gif"/></alternatives></inline-formula> where <inline-formula id="IEq101"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Y}} \sim {\mathcal {N}}({\textbf{D}}{\textbf{b}},\sigma _E^2)$$\end{document}</tex-math><mml:math id="M220"><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">D</mml:mi><mml:mi mathvariant="bold">b</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq101.gif"/></alternatives></inline-formula> where <inline-formula id="IEq102"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _E^2 \sim \text {gamma}(\text {shape}=0.5,\text {scale}=1)$$\end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>gamma</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>shape</mml:mtext><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mtext>scale</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq102.gif"/></alternatives></inline-formula>. Around 1700 DMRs were added to the genome.</p>
      <p id="Par35">In LuxHMM, either all regions or only candidate hypo- and hypermethylated regions, as classified by HMM, were used as input in determining DMRs. Parameter settings for competing methods are described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 3.</p>
      <p id="Par36">AUROC and AP, to handle the imbalance in the dataset given that there are much more negative than positive samples, were computed (Table <xref rid="Tab9" ref-type="table">9</xref>). For AP, the baseline is 0.0014. LuxHMM using all regions generated the highest AUROC and LuxHMM using just candidate hypo- and hypermethylated regions generated the highest AP. This indicates that, like in Section  <xref rid="Sec6" ref-type="sec">3.1</xref>, using LuxHMM with all regions has a higher recall whereas using LuxHMM with just candidate hypo- and hypermethylated regions has a higher precision. This also shows that LuxHMM is able to more accurately detect DMRs from a dataset with confounding covariates.<table-wrap id="Tab9"><label>Table 9</label><caption><p>AUROC and AP for simulated dataset with confounding covariates</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Method</th><th align="left">AUROC</th><th align="left">AP</th></tr></thead><tbody><tr><td align="left">LuxHMM <inline-formula id="IEq103"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{1}$$\end{document}</tex-math><mml:math id="M224"><mml:msup><mml:mrow/><mml:mn>1</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq103.gif"/></alternatives></inline-formula></td><td align="left"><bold>0.823</bold></td><td align="left">0.536</td></tr><tr><td align="left">LuxHMM <inline-formula id="IEq104"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{2}$$\end{document}</tex-math><mml:math id="M226"><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq104.gif"/></alternatives></inline-formula></td><td align="left">0.756</td><td align="left"><bold>0.549</bold></td></tr><tr><td align="left">LuxUS</td><td align="left">0.679</td><td align="left">0.321</td></tr><tr><td align="left">RADMeth</td><td align="left">0.644</td><td align="left">0.246</td></tr><tr><td align="left">metilene</td><td align="left">0.714</td><td align="left">0.348</td></tr><tr><td align="left">HMM-DM</td><td align="left">0.616</td><td align="left">0.180</td></tr><tr><td align="left">DMRcate</td><td align="left">0.658</td><td align="left">0.065</td></tr><tr><td align="left">DSS</td><td align="left">0.672</td><td align="left">0.339</td></tr></tbody></table><table-wrap-foot><p>Bold represent the highest values in each column</p><p>1 All regions</p><p>2 Hypo- and hypermethylated regions</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec11">
      <title>Comparison of performance on real BS-seq data with confounding covariates</title>
      <p id="Par37">To test the performance of LuxHMM on real BS-seq data with multiple covariates we evaluated the different statistical methods in terms of gene set enrichment using the webtool GREAT [<xref ref-type="bibr" rid="CR15">15</xref>] on the dataset with GEO accession number GSE47966 as originally performed by [<xref ref-type="bibr" rid="CR16">16</xref>]. The dataset consists of samples taken from mice brain tissue (WGBS). Three samples consisted of neuron cells and three consisted of non-neuron cells. In addition, the samples were divided into male and female mice and different ages (6 week and 12 month old females, and 7 week old males). DMRs between neurons and non-neurons were identified using the different methods and then gene ontology (GO) enrichment were performed to test the ability of the various methods to identify biologically relevant regions. The top 25 and 60 enriched GO terms based on binomial ranking were taken and the percentage of GO terms related to the neural system were determined. Gene set enrichment analysis were performed with mouse phenotype annotations.</p>
      <p id="Par38">In LuxHMM, candidate hypo- and hypermethylated regions, as determined by HMM, were used as input in determining differentially methylated regions. HMC was used to sample from the posterior distribution with four chains, 1000 iterations for warmup for each chain and a total of 1000 iterations for sampling. In addition, as in [<xref ref-type="bibr" rid="CR16">16</xref>], for the regions, a threshold of <inline-formula id="IEq105"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt; 25$$\end{document}</tex-math><mml:math id="M228"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq105.gif"/></alternatives></inline-formula> CpGs was used. To make a comparable assessment, the top 10,000 to 15,000 DMRs from all methods were used as input to GREAT. Parameter settings for competing methods are described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section 4.</p>
      <p id="Par39">As shown in Table <xref rid="Tab10" ref-type="table">10</xref>, HMM-DM generated the highest percentages of enriched GO terms related to the neural system in both the top 25 and top 60 enriched GO terms. In the top 25 enriched GO terms, LuxHMM generated the second highest number of enriched GO terms related to the neural system and in the top 60 LuxHMM was fourth highest after DSS and LuxUS (Additional file <xref rid="MOESM2" ref-type="media">2</xref>). This shows that LuxHMM performs comparatively well in finding biologically relevant regions relative to other methods tested.<table-wrap id="Tab10"><label>Table 10</label><caption><p>Enriched GO terms related to the neural system</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Method</th><th align="left">Top 25 (%)</th><th align="left">Top 60 (%)</th></tr></thead><tbody><tr><td align="left">LuxHMM <inline-formula id="IEq106"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{1}$$\end{document}</tex-math><mml:math id="M230"><mml:msup><mml:mrow/><mml:mn>1</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5174_Article_IEq106.gif"/></alternatives></inline-formula></td><td align="left">92</td><td align="left">83</td></tr><tr><td align="left">LuxUS</td><td align="left">88</td><td align="left">85</td></tr><tr><td align="left">RADMeth</td><td align="left">88</td><td align="left">80</td></tr><tr><td align="left">Metilene</td><td align="left">20</td><td align="left">32</td></tr><tr><td align="left">HMM-DM</td><td align="left"><bold>96</bold></td><td align="left"><bold>93</bold></td></tr><tr><td align="left">DMRcate</td><td align="left">84</td><td align="left">68</td></tr><tr><td align="left">DSS</td><td align="left">88</td><td align="left">87</td></tr></tbody></table><table-wrap-foot><p>Bold represent the highest values in each column</p><p>1 Hypo- and hypermethylated regions</p></table-wrap-foot></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Conclusions</title>
    <p id="Par40">We propose the tool LuxHMM for detecting differentially methylated regions. This tool uses HMM to segment the genome into regions with hypomethylation, hypermethylation and equal methylation between two groups and Bayesian regression for evaluating differential methylation. Further, model inference is done using either variational inference for efficient genome-scale analysis or HMC.</p>
    <p id="Par41">We show using simulated and real BS-seq data with general experimental designs that LuxHMM outperforms other published methods in detecting differentially methylated regions from simulated datasets and performs comparatively well in a real dataset.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec13">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5174_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold>: Description of data: (i) Initial state transition probabiliites, (ii) Parameter settings for competing methods on simulated dataset based on real BS-seq data, (iii) Parameter settings for competing methods on simulated dataset with confounding covariates, and (iv) Parameter settings for competing methods on real BS-seq data with confounding covariates</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2023_5174_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2</bold>: Enriched GO terms using Mouse Phenotype</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>ADVI:</term>
        <def>
          <p id="Par4">Automatic differentiation variational inference</p>
        </def>
      </def-item>
      <def-item>
        <term>HMC:</term>
        <def>
          <p id="Par5">Hamiltonian Monte Carlo</p>
        </def>
      </def-item>
      <def-item>
        <term>BS-seq:</term>
        <def>
          <p id="Par6">Bisulfite sequencing</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We acknowledge the computational resources provided by the Aalto Science-IT project.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author Contributions</title>
    <p>MM and HL developed the method. MM implemented the method. MM and HL wrote the manuscript. Both authors read and approved the final version of the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the Ella and Georg Ehrnrooth Foundation and the Academy of Finland (grant number 314445). The funding body played no role in the design of the study, the collection, analysis, interpretation of data, or in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>LuxHMM is open source and freely available from <ext-link ext-link-type="uri" xlink:href="https://github.com/malonzm1/LuxHMM">https://github.com/malonzm1/LuxHMM</ext-link>. Project name: LuxHMM. Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/malonzm1/LuxHMM">https://github.com/malonzm1/LuxHMM</ext-link>. Operating system(s): Linux. Programming language: Python, Stan. Other requirements: CmdStan (tested on version 2.29.0), Python (tested on version 3.8.12), pomegranate (tested on version 0.14.8), pystan (tested on version 3.1.1), Numpy (tested on version 1.22.2), Scipy (tested on version 1.8.0), cmdstanpy (tested on version 1.0.1). LuxHMM is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/malonzm1/LuxHMM">https://github.com/malonzm1/LuxHMM</ext-link> along with documentation. License: GNU GPL Any restrictions to use by non-academics: Not applicable.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par42">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent to publication</title>
      <p id="Par43">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interest</title>
      <p id="Par44">The authors declare that they have no financial or non-financial competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeschke</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Evelyne</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Francois</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Dna methylome profiling beyond promoters-taking an epigenetic snapshot of the breast tumor microenvironment</article-title>
        <source>FEBS J</source>
        <year>2015</year>
        <volume>282</volume>
        <fpage>1801</fpage>
        <lpage>1814</lpage>
        <pub-id pub-id-type="doi">10.1111/febs.13125</pub-id>
        <?supplied-pmid 25331982?>
        <pub-id pub-id-type="pmid">25331982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Kahraman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Law</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Lindsay</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nowicka</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Statistical methods for detecting differentially methylated loci and regions</article-title>
        <source>Front Genet</source>
        <year>2014</year>
        <volume>5</volume>
        <fpage>324</fpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2014.00324</pub-id>
        <?supplied-pmid 25278959?>
        <pub-id pub-id-type="pmid">25278959</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dolzhenko</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>AD</given-names>
          </name>
        </person-group>
        <article-title>Using beta-binomial regression for high-precision differential methylation analysis in multifactor whole-genome bisulfite sequencing experiments</article-title>
        <source>BMC Bioinf</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>1</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-15-215</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Juhling</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kretzmer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bernhart</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Otto</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Hoffmann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Metilene: fast and sensitive calling of differentially methylated regions from bisulfite sequencing data</article-title>
        <source>Genome Res</source>
        <year>2016</year>
        <volume>26</volume>
        <fpage>256</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.196394.115</pub-id>
        <?supplied-pmid 26631489?>
        <pub-id pub-id-type="pmid">26631489</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peters</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Buckley</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Statham</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Pidsley</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Samaras</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lord</surname>
            <given-names>RV</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Molloy</surname>
            <given-names>PL</given-names>
          </name>
        </person-group>
        <article-title>De novo identification of differentially methylated regions in the human genome</article-title>
        <source>Epigenet Chromatin</source>
        <year>2015</year>
        <volume>8</volume>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1186/1756-8935-8-6</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Park</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Differential methylation analysis for bs-seq data under general experimental design</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>1446</fpage>
        <lpage>1453</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw026</pub-id>
        <?supplied-pmid 26819470?>
        <pub-id pub-id-type="pmid">26819470</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Äijö</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lähdesmäki</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Luxglm: a probabilistic covariate model for quantification of dna methylation modifications with complex experimental designs</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>511</fpage>
        <lpage>519</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw468</pub-id>
        <pub-id pub-id-type="pmid">26515819</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Halla-Aho</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Lähdesmäki</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Luxus: Dna methylation analysis using generalized linear mixed model with spatial correlation</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>4535</fpage>
        <lpage>4543</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa539</pub-id>
        <?supplied-pmid 32484876?>
        <pub-id pub-id-type="pmid">32484876</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jurafsky</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <source>Speech and language processing</source>
        <year>2021</year>
        <edition>2</edition>
        <publisher-loc>Upper Saddle River, NJ</publisher-loc>
        <publisher-name>Prentice-Hall, Inc.</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bilmes</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <source>A gentle tutorial of the EM algorithm and its application to parameter estimation for Gaussian mixture and hidden Markov models</source>
        <year>1998</year>
        <publisher-loc>Berkeley, CA</publisher-loc>
        <publisher-name>International Computer Science Institute, Berkely, CA</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schreiber</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Pomegranate: fast and flexible probabilistic modeling in python</article-title>
        <source>J Mach Learn Res</source>
        <year>2018</year>
        <volume>18</volume>
        <fpage>1</fpage>
        <lpage>6</lpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carpenter</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gelman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Goodrich</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Betancourt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Brubaker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Riddell</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Stan: A probabilistic programming language</article-title>
        <source>J Stat Softw</source>
        <year>2017</year>
        <volume>76</volume>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.18637/jss.v076.i01</pub-id>
        <?supplied-pmid 36568334?>
        <pub-id pub-id-type="pmid">36568334</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Kucukelbir A, Ranganath R, Gelman A, Blei D. Automatic variational inference in stan. In: Cortes C, Lee DD, Sugiyama M, editors. Advances in neural information processing systems 28 (NIPS 2015), neural information processing systems. 2015;pp. 568–576.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>HU</given-names>
          </name>
          <name>
            <surname>Hebestreit</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>An evaluation of methods to test predefined genomic regions for differential methylation in bisulfite sequencing data</article-title>
        <source>Brief Bioinf</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>796</fpage>
        <lpage>807</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbv095</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McLean</surname>
            <given-names>CY</given-names>
          </name>
          <name>
            <surname>Bristor</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hiller</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Schaar</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Lowe</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Wenger</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Bejerano</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Great improves functional interpretation of cis-regulatory regions</article-title>
        <source>Nature Biotechnol</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>495</fpage>
        <lpage>501</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1630</pub-id>
        <pub-id pub-id-type="pmid">20436461</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Detection of differentially methylated regions in whole genome bisulfite sequencing data using local getis-ord statistics</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>3396</fpage>
        <lpage>3404</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw497</pub-id>
        <?supplied-pmid 27493194?>
        <pub-id pub-id-type="pmid">27493194</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
