<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8762856</article-id>
    <article-id pub-id-type="publisher-id">4574</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-04574-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scAnnotatR: framework to accurately classify cell types in single-cell RNA-sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Nguyen</surname>
          <given-names>Vy</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2206-9511</contrib-id>
        <name>
          <surname>Griss</surname>
          <given-names>Johannes</given-names>
        </name>
        <address>
          <email>johannes.griss@meduniwien.ac.at</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.22937.3d</institution-id><institution-id institution-id-type="ISNI">0000 0000 9259 8492</institution-id><institution>Department of Dermatology, </institution><institution>Medical University of Vienna, </institution></institution-wrap>Währinger Gürtel 18-20, 1090 Vienna, Austria </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>44</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>1</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Automatic cell type identification is essential to alleviate a key bottleneck in scRNA-seq data analysis. While most existing classification tools show good sensitivity and specificity, they often fail to adequately not-classify cells that are missing in the used reference. Additionally, many tools do not scale to the continuously increasing size of current scRNA-seq datasets. Therefore, additional tools are needed to solve these challenges.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">scAnnotatR is a novel R package that provides a complete framework to classify cells in scRNA-seq datasets using pre-trained classifiers. It supports both Seurat and Bioconductor’s SingleCellExperiment and is thereby compatible with the vast majority of R-based analysis workflows. scAnnotatR uses hierarchically organised SVMs to distinguish a specific cell type versus all others. It shows comparable or even superior accuracy, sensitivity and specificity compared to existing tools while being able to not-classify unknown cell types. Moreover, scAnnotatR is the only of the best performing tools able to process datasets containing more than 600,000 cells.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">scAnnotatR is freely available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/grisslab/scAnnotatR">https://github.com/grisslab/scAnnotatR</ext-link>) and through Bioconductor (from version 3.14). It is consistently among the best performing tools in terms of classification accuracy while scaling to the largest datasets.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-022-04574-5.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>scAnnotatR</kwd>
      <kwd>Cell classification</kwd>
      <kwd>scRNAseq</kwd>
      <kwd>Machine learning</kwd>
      <kwd>SVM</kwd>
      <kwd>R</kwd>
      <kwd>Bioconductor</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002428</institution-id>
            <institution>austrian science fund</institution>
          </institution-wrap>
        </funding-source>
        <award-id>P30325-B28</award-id>
        <award-id>P31127-B28</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par17">Single-cell RNA-sequencing (scRNA-seq) has become a key tool for biomedical research. One of the main steps in analyzing scRNA-seq data is to classify the observed cell types.</p>
    <p id="Par18">The most common approach to annotate cell types is using cell clustering and canonical cell type-specific marker genes. However, this has several major drawbacks. First, it requires profound knowledge of a wide range of cell populations. The situation becomes more complicated if a dataset contains highly similar cell types such as T cells, ILC, and NK cells. Second, cell clusters may not be “pure” but may contain mixtures of multiple cell types. Such cases are often missed when only focusing on cluster-specific marker genes. Finally, this manual approach does not efficiently scale to large-scale studies or data reanalysis and is inherently hard to reproduce. Therefore, automated methods are needed to identify cell types in scRNA-seq data.
</p>
    <p id="Par19">In recent years, several computational methods were developed to automatically identify cells. This includes methods that identify cell types by projecting cells to cell type landmarks, then inferring unknown cells close to already known cell types in the embedded space (northstar [<xref ref-type="bibr" rid="CR1">1</xref>], scmap [<xref ref-type="bibr" rid="CR2">2</xref>], MARS [<xref ref-type="bibr" rid="CR3">3</xref>]). A further approach is to correlate gene expression in annotated groups/clusters of cells with unannotated populations (scCATCH [<xref ref-type="bibr" rid="CR4">4</xref>], SingleR [<xref ref-type="bibr" rid="CR5">5</xref>], CIPR [<xref ref-type="bibr" rid="CR6">6</xref>], clustifyr [<xref ref-type="bibr" rid="CR7">7</xref>], scMatch [<xref ref-type="bibr" rid="CR8">8</xref>]). Without using annotated datasets, DigitalCellSorter [<xref ref-type="bibr" rid="CR9">9</xref>] classifies cells based on the expression of high impact biomarkers, where the impact of the biomarkers depends on their unicity to particular cell types. A large number of algorithms use machine learning (CellAssign [<xref ref-type="bibr" rid="CR10">10</xref>], SciBet [<xref ref-type="bibr" rid="CR11">11</xref>], Garnett [<xref ref-type="bibr" rid="CR12">12</xref>], CHETAH [<xref ref-type="bibr" rid="CR13">13</xref>], SCINA [<xref ref-type="bibr" rid="CR14">14</xref>], scPred [<xref ref-type="bibr" rid="CR15">15</xref>], scID [<xref ref-type="bibr" rid="CR16">16</xref>], scClassify [<xref ref-type="bibr" rid="CR17">17</xref>]), or neural networks (ACTINN [<xref ref-type="bibr" rid="CR18">18</xref>], MARS [<xref ref-type="bibr" rid="CR3">3</xref>]) to automatically learn mapping functions from gene expression of annotated cells to classes of those cells. Despite this large number of cell classification approaches, several approaches show weaknesses that prevent their easy implementation into existing workflows.</p>
    <p id="Par20">We classified existing tools based on key features that we feel are required to automatically classify cell types (Table <xref rid="Tab1" ref-type="table">1</xref>). Classifying individual cells instead of whole clusters can be used to cross-validate the clustering results. We only identified four tools that report ambiguous cell type assignments: MARS, DigitalCellSorter, scClassify and CHETAH. This is crucial since many cell types are closely related, such as monocytes, macrophages, and dendritic cells, which can easily lead to incorrect classification results. scClassify, CHETAH, and Garnett are the few tools classifying cells based on a hierarchical structure. This concept was also proposed by Alquicira-Hernandez et al., although it is not implemented in scPred. Hierarchical classification has the advantage that models can use features that are well suited to differentiate closely related subtypes, but might not be ideal to classify the whole lineage. Additionally, several tools are unable to not-classify cells missing in the used reference (unknown population detection). Finally, many tools fail to process large datasets as they convert the sparse matrix (where “0” values do not require memory) into a full matrix during the classification process (scClassify, SCINA, scmap-cell, and scmap-cluster). CHETAH was the only R based tool we evaluated that contains all features which we feel are necessary for accurate cell type classification. However, the confidence score reported by CHETAH is challenging to interpret and the prediction output as ‘nodes' is inconvenient for further automated analyses. Therefore, we found no R-based tool that fulfills all our criteria.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Structured list of existing tools to automatically classify cell types in scRNA-seq datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Tools</th><th align="left">Usage language</th><th align="left">Level of assignment</th><th align="left">Reference source</th><th align="left">Prediction score</th><th align="left">Ambiguous assignment</th><th align="left">Unknown population detection</th></tr></thead><tbody><tr><td align="left">northstar</td><td align="left">Python</td><td align="left">Cluster</td><td align="left">Dataset</td><td align="left">No info</td><td align="left">No info</td><td align="left">Yes</td></tr><tr><td align="left">scmap</td><td align="left">R</td><td align="left">Both</td><td align="left">Dataset</td><td align="left">Yes</td><td align="left">No</td><td align="left">Yes</td></tr><tr><td align="left">MARS</td><td align="left">Python</td><td align="left">Cell</td><td align="left">Dataset</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">Yes</td></tr><tr><td align="left">scCATCH</td><td align="left">R</td><td align="left">Cluster</td><td align="left">Database</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">No</td></tr><tr><td align="left">SingleR</td><td align="left">R</td><td align="left">Cell</td><td align="left">Dataset</td><td align="left">Yes</td><td align="left">No</td><td align="left">Yes</td></tr><tr><td align="left">CIPR</td><td align="left">R</td><td align="left">Cluster</td><td align="left">Dataset</td><td align="left">Yes</td><td align="left">No</td><td align="left">Yes</td></tr><tr><td align="left">clustifyr</td><td align="left">R</td><td align="left">Both</td><td align="left">Dataset</td><td align="left">Yes</td><td align="left">No</td><td align="left">Yes</td></tr><tr><td align="left">scMatch</td><td align="left">Python</td><td align="left">Cell</td><td align="left">Dataset</td><td align="left">Yes</td><td align="left">No</td><td align="left">No info</td></tr><tr><td align="left">DigitalCellSorter</td><td align="left">Python</td><td align="left">Cluster</td><td align="left">Markers</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">Yes</td></tr><tr><td align="left">CellAssign</td><td align="left">R</td><td align="left">Cell</td><td align="left">Markers</td><td align="left">Yes</td><td align="left">No</td><td align="left">Yes</td></tr><tr><td align="left">SciBet</td><td align="left">R</td><td align="left">Cell</td><td align="left">Dataset</td><td align="left">Yes, but with additional process</td><td align="left">No</td><td align="left">Yes, but with additional process</td></tr><tr><td align="left">Garnett</td><td align="left">R</td><td align="left">Cell</td><td align="left">Markers and datasets</td><td align="left">No</td><td align="left">No</td><td align="left">Yes</td></tr><tr><td align="left">CHETAH</td><td align="left">R</td><td align="left">Cell</td><td align="left">Dataset</td><td align="left">Yes</td><td align="left">Yes</td><td align="left">Yes</td></tr><tr><td align="left">SCINA</td><td align="left">R</td><td align="left">Cell</td><td align="left">Markers</td><td align="left">Yes</td><td align="left">No</td><td align="left">Yes</td></tr><tr><td align="left">scPred</td><td align="left">R</td><td align="left">Cell</td><td align="left">Dataset</td><td align="left">Yes</td><td align="left">No</td><td align="left">Yes</td></tr><tr><td align="left">scID</td><td align="left">R</td><td align="left">Cell</td><td align="left">Dataset</td><td align="left">Yes</td><td align="left">No</td><td align="left">Yes</td></tr><tr><td align="left">scClassify</td><td align="left">R</td><td align="left">Cell</td><td align="left">Dataset</td><td align="left">No</td><td align="left">Yes</td><td align="left">Yes</td></tr><tr><td align="left">ACTINN</td><td align="left">Python</td><td align="left">Cell</td><td align="left">Dataset</td><td align="left">Yes</td><td align="left">No</td><td align="left">No</td></tr><tr><td align="left">Superscan</td><td align="left">Python</td><td align="left">Cell</td><td align="left">Dataset</td><td align="left">Yes</td><td align="left">No</td><td align="left">Yes</td></tr></tbody></table></table-wrap></p>
    <p id="Par21">Here we present scAnnotatR, a novel R/Bioconductor package to automatically classify cells in scRNA-seq datasets. scAnnotatR ships with predefined models for several cell types that can easily be extended by the user. The package uses support vector machines (SVMs) classifiers organised in a tree-like structure to improve the classification of closely related cell types. Most importantly, scAnnotatR reports classification probabilities for every cell type as well as ambiguous classification results. Therefore, scAnnotatR fills an important need in the automatic classification of cell types in scRNA-seq experiments.</p>
    <sec id="Sec2">
      <title>Implementation</title>
      <p id="Par22">scAnnotatR is an R Bioconductor package to classify cell types using pre-trained classifiers in scRNA-seq datasets. The package revolves around an S4 class called scAnnotatR. Each object of the class defines a classifier of a cell type wrapping 5 pieces of information: the classified cell type corresponding to the name of the classifier, a support vector machine (SVM)-based model returned by the caret package [<xref ref-type="bibr" rid="CR19">19</xref>], a feature set on which the model was trained, a prediction probability threshold and the parent of the classified cell type (if available). Trained models are stored in a named list which are referred to as a classifier database. The package ships with built-in classifiers which can easily be extended or even replaced by the user (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><p>Functional structure of the package. The package supports two basic pipelines: (1) classifying cells using pre-trained models, and (2) training new classification models to extend the existing classifier database. These models can be automatically evaluated using dedicated in-built functions</p></caption><graphic xlink:href="12859_2022_4574_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par23">Similar to Abdelaal et al. [<xref ref-type="bibr" rid="CR20">20</xref>], we found that linear kernels outperform other more sophisticated kernels throughout our initial benchmark (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). To support the rejection of unknown cell types, one classification model is responsible for one cell type, identifying cells belonging to a specific cell type versus all other cells. Classifiers are stored in a hierarchical tree-based structure allowing the definition of “parent” and “child” classifiers. In such cases, cells are first classified using the parent classifier. Only cells identified as that specific cell type are then further classified using the respective child classifier.</p>
      <p id="Par24">scAnnotatR is compatible with both Seurat [<xref ref-type="bibr" rid="CR21">21</xref>] and Bioconductor’s SingleCellExperiment [<xref ref-type="bibr" rid="CR22">22</xref>] object. It ships with pre-trained models for most basic immune cells. Therefore, it can easily be integrated into the vast majority of existing scRNA-seq workflows.</p>
      <p id="Par25">Finally, scAnnotatR offers a user-friendly environment to train and test new cell classifiers. All functional parameters are adjustable and configurable, which gives the user full control during the training process. Thereby, scAnnotatR offers a complete framework for the automatic classification of cell types in scRNA-seq datasets.</p>
    </sec>
  </sec>
  <sec id="Sec3">
    <title>Results</title>
    <sec id="Sec4">
      <title>Hierarchical classification models help identify unrecognized sub-populations</title>
      <p id="Par26">A key challenge in the characterisation of cell types in scRNA-seq datasets is to what level of detail cell types should be classified. Several research questions focus on very specific subtypes, for example specific B cell phenotypes. At the same time, other B cell subtypes may be of less interest—or be unexpected at all. In tools that do not support hierarchical classification models researchers have to either classify all B cells at the same level of detail (with the danger of missing rare subtypes) or leave a large portion of cells unclassified.</p>
      <p id="Par27">scAnnotatR’s hierarchical organisation of cell classification models is ideally suited for such targeted cell classification approaches. First, researchers can train a parent classifier to identify all cells belonging to the general cell type of interest. In a second step, they can now create a child classifier(s) to focus on their subtype(s) of interest. Figure <xref rid="Fig2" ref-type="fig">2</xref> highlights these two approaches. scAnnotatR’s inbuilt classifiers contain a hierarchical model for overall “B cells” and its child terminally differentiated “plasma cells”. Figure <xref rid="Fig2" ref-type="fig">2</xref>a highlights that the dataset contains several plasma cells, but a large portion of the general “B cells” is only captured by the parent classifier. More importantly, a group of cancer-associated fibroblasts (lower left group of cells, Fig. <xref rid="Fig2" ref-type="fig">2</xref>b) were misclassified as plasma cells. These express SDC1, a sensitive but not specific plasma cell marker. Due to their additional expression of FAP, PDGFRA, PDGFRB, TAGLN, and COL1A1 we can be certain that they are not plasma cells. The general B cell classifier was able to correctly distinguish these cells (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). This example highlights how the hierarchical structure of classifiers can increase classification accuracy.<fig id="Fig2"><label>Fig. 2</label><caption><p>UMAP plot showing the classification results in the Jerby-Arnon melanoma dataset. <bold>a</bold> Classification results of a plasma cell classifier as a child of the more general B cell classifier. <bold>b</bold> Classification results of a plasma cell classifier trained separately without any parent classifier</p></caption><graphic xlink:href="12859_2022_4574_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>scAnnotatR outperforms existing tools in terms of accuracy, sensitivity, and the detection of unknown cell types</title>
      <p id="Par28">We compared scAnnotatR’s performance against existing tools using two benchmarks: first, a group of datasets containing discrete cell populations and second a group with closely related immune cell populations. The benchmarks included ten other existing tools. SingleR [<xref ref-type="bibr" rid="CR5">5</xref>] selects the most variable genes for each cell type in an annotated dataset. Then, cell types are identified in an unlabelled dataset by correlating the expression values. CHETAH [<xref ref-type="bibr" rid="CR13">13</xref>] selects the top differentially expressed genes (DEG) and finds the distribution of correlation between cells in each cell type; unknown cells are then classified by the high cumulative density of a cell type correlation distribution. scmap-cluster and scmap-cell calculates the cosine similarity and Pearson and Spearman correlations between the unidentified cells and the reference cell/clusters to infer the closest populations. scClassify uses a combination of feature selection methods (mainly limma) to train one or multiple classifiers, then uses one or multiple classifiers to classify cells and has those classifiers vote for cell identification. SciBet [<xref ref-type="bibr" rid="CR11">11</xref>] retrieves cell type markers and eliminates noisy genes using the E-test. For each cell type, SciBet learns a multinomial model to form a likelihood function defining the probability of each cell to belong to a cell type, hence cell annotation relies on a likelihood maximization process. Garnett [<xref ref-type="bibr" rid="CR12">12</xref>] requires a list of marker genes as input to choose a set of representative cells and train multinomial classifiers. clustifyr [<xref ref-type="bibr" rid="CR7">7</xref>] is the only tool working on the cluster level. It identifies cell types through the correlation of cluster gene expression with annotated cell expression values. SCINA [<xref ref-type="bibr" rid="CR14">14</xref>] relies on user-supplied marker genes. It uses a bimodal distribution to identify cells where the marker genes are higher or lower expressed. It then uses the Expectation–Maximization (EM) algorithm to calculate the likelihood of one cell belonging to a cell type. Similar to scAnnotatR, scPred [<xref ref-type="bibr" rid="CR15">15</xref>] trains machine learning models for each cell type in the reference dataset, with two differences: 1- principal components are used as features in the machine learning models instead of individual genes and 2- classification models are not organised in a hierarchical structure. This explains the difference in performance between scPred and scAnnotatR. This wide collection of existing tools ensures that we arrive at a comprehensive assessment of scAnnotatR’s performance in comparison to the state-of-the-art.</p>
      <p id="Par29">The benchmark evaluates the accuracy calculated on the dataset level, and the average sensitivity, and specificity across all cell types in the tested datasets. Additionally, the ability to correctly deal with unknown cells is a key aspect in the automatic classification of cell types. Reference datasets may always be incomplete. Therefore, tools need to be able to recognize such unknown cells to avoid a misinterpretation of the data. To assess this ability, we calculated the unknown population detection rate, which is defined as the number of correctly unassigned cells over the total number of cells that are not present in the reference. Thereby, we arrive at a comprehensive overview of the tools’ performance.</p>
      <sec id="Sec6">
        <title>Classifying discrete cell populations</title>
        <p id="Par30">We performed the benchmark using a sixfold cross-validation scheme with six pancreas datasets [<xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR27">27</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). In each fold, one of the six datasets was used for training, the other five for testing. scAnnotatR, CHETAH, and scClassify are the only evaluated tools able to return ambiguous/intermediate cell type assignments. In order to ensure a fair comparison, the accuracy, sensitivity and specificity was calculated using two methods for these tools. Once, a correct intermediate assignment was accepted as correct classification (marked with a star (*) after the name). In the second approach only unambiguous classifications were counted as correct (see Additional file <xref rid="MOESM1" ref-type="media">1</xref> for details). This sixfold cross-validation benchmark thereby ensures that we arrive at an accurate and comparable estimate of each tool’s performance.</p>
        <p id="Par31">Throughout all iterations, scAnnotatR was consistently among the tools with the highest accuracy, sensitivity, and specificity (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a–c). As expected, accepting ambiguous results as correct improved the performance of the respective tools. Only scAnnotatR and SCINA were able to reach a good accuracy, sensitivity, and specificity while being able to correctly not-classify unknown cell types (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, b, d). While SingleR, scClassify, SciBet (default settings), and clustifyr, showed high accuracy and sensitivity, they failed in not-classifying unknown cells (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). The increased detection of unknown cells by scmap-cell, scmap-cluster, Garnett, and scibet-rej comes at the cost of reduced sensitivity and accuracy. scPred’s comparably low performance may be due to the fact that the training and testing datasets were processed using different workflows (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a–d). Its default RBF training kernels seemed to overfit the data. Nevertheless, even when processing all datasets using the same workflow and manually optimising the used kernels, scPred’s performed worse than scAnnotatR (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3). Meanwhile, that fact that clustifyr works on the cluster level leads to a win all or lose all scenario. In datasets where the clustering results were suboptimal, clustifyr’s performance decreases dramatically. Altogether, scAnnotatR showed the highest accuracy while still being able to not classify unknown cells.<fig id="Fig3"><label>Fig. 3</label><caption><p>Benchmark results when classifying distinct cell populations in six pancreas datasets. The benchmark was performed in a sixfold cross-validation scheme where one dataset was used for training and the other five for testing. All metrics were ordered by the tools’ mean accuracy. (*) indicates results where ambiguous classifications were accepted as correct. Garnett-markers and Garnett-DEG are two evaluations of Garnett, one using the same markers as scAnnotatR (Garnett-markers) and one using top 10 DEG (Garnett-DEG). scibet-rej evaluates SciBet’s performance using a confidence threshold of 0.4. <bold>a</bold> The prediction accuracy in each training and test set for all tools. <bold>b</bold> Average sensitivity and <bold>c</bold> specificity as the mean sensitivity and specificity, respectively, across all classified cell types for each dataset and iteration. <bold>d</bold> Proportion of cells not present in the training data, that were correctly not-classified</p></caption><graphic xlink:href="12859_2022_4574_Fig3_HTML" id="MO3"/></fig></p>
      </sec>
      <sec id="Sec7">
        <title>Closely related populations</title>
        <p id="Par32">Our second benchmark tested the differentiation of closely related immune cell types. The benchmark was performed in a multiple-fold cross-validation scheme using two levels of cell annotations with ten annotated datasets: the PBMC 3 k dataset as analyzed in the Seurat v3.1 tutorial [<xref ref-type="bibr" rid="CR28">28</xref>], the PBMC 500 dataset analyzed by ILoReg v1.0 tutorial [<xref ref-type="bibr" rid="CR29">29</xref>], the seven subsets in the PBMC dataset by Ding et al. [<xref ref-type="bibr" rid="CR30">30</xref>], and the SCP345 PBMC dataset [<xref ref-type="bibr" rid="CR31">31</xref>]. The SCP345 PBMC dataset could not be included in the second level annotation benchmark as it lacks detailed cell annotations. This selection of datasets ensures that we can assess the classification performance in closely related cell types.</p>
        <p id="Par33">In the first level of cell annotations, scAnnotatR used the same markers as the in-built classifiers for T cells, B cells, NK cells, monocytes (macrophages), and dendritic cells to train the classifiers on the corresponding training set. In the second level of the benchmark, scAnnotatR used additional markers from the in-built classifiers for CD4+ T cells, CD8+ T cells, CD14+ monocytes and CD16+ monocytes. Garnett and SCINA used the top 10 differentially expressed genes of each cell type in the corresponding training set. For Garnett and scAnnotatR, the hierarchical structure of cell types is a predefined input.</p>
        <p id="Par34">Additionally, we assessed the influence of an adapted prediction threshold for scAnntotaR. Next to the trained model, scAnnotatR’s classifiers use a prediction threshold before classifying a cell. This threshold can be adapted without retraining the classifiers. Therefore, we once evaluated scAnntotatR with its default thresholds of 0.5, and once with adapted thresholds to increase sensitivity. This highlights how scAnnotatR can easily be optimised for different use cases.</p>
        <p id="Par35">In general, the performance of all tested tools was worse when classifying closely related cell types (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). The ranking of tools did not change dramatically, except for scPred which increased its rank to the middle-top (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). Optimising scPred’s classifiers again improved its performance, which was still lower than scAnnotatoR’s (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3). scAnnotatR was again the only top-performing tool with an acceptable unknown population detection rate. scClassify, SingleR, SciBet, scPred, and SCINA had high accuracy and/or sensitivity but low unknown population detection rates, while clustifyr, scmap-cell, scmap-cluster, and Garnett had a higher unknown population at the cost of decreased sensitivity. When using the more detailed cell annotations both scibet’s, scPred's and scClassify’s performance decreased compared to scAnnotatR (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). Compared to the previous benchmark, SCINA's ability to not classify unknown cells decreased. As SCINA relies on lists of positive-only marker genes, closely related cell types are more difficult to distinguish. In both levels of cell annotations, the performance of clustifyr was highly variable, depending on the clustering results. As expected, the classification tools supporting ambiguous cell identification (scAnnotatR, CHETAH, scClassify) generally had better performance in the intermediate assignment-accepted scenario than in the normal one. Overall, scAnnotatoR showed a consistently good performance when classifying closely related immune cell types.<fig id="Fig4"><label>Fig. 4</label><caption><p>Benchmark evaluating the classification accuracy for closely related immune cell types in ten datasets using the more general (level 1) annotations. The benchmark was performed in a tenfold cross-validation scheme where one dataset was used for training and the other five for testing. All metrics were ordered by the tools’ mean accuracy. (*) indicates results where intermediate/ambiguous classifications were accepted. scibet-rej represents SciBet with a confidence threshold of 0.4. Blank areas indicate comparisons that could not be performed with the respective tool. <bold>a</bold> The prediction accuracy in each training set and test set for all tools. Panels show the sensitivity (<bold>b</bold>), specificity (<bold>d</bold>). The shown values (points) represent the mean sensitivity and specificity, respectively, across all classified cell types across the five evaluated datasets per iteration. Panel (<bold>c</bold>) shows the proportion of cells not present in the training data, that were correctly not-classified</p></caption><graphic xlink:href="12859_2022_4574_Fig4_HTML" id="MO4"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>Benchmark evaluating the classification accuracy for closely related immune cell types in nine datasets using the detailed cell annotations (level 2). The benchmark was performed in a ninefold cross-validation scheme where one dataset was used for training and the other eight for testing. All metrics were ordered by the tools’ mean accuracy. (*) indicates results where intermediate/ambiguous classifications were accepted. scibet-rej represents SciBet with a confidence threshold of 0.4. Blank areas indicate comparisons that could not be performed with the respective tool. <bold>a</bold> The prediction accuracy in each training set and test set for all tools. Panels show the sensitivity (<bold>b</bold>), specificity (<bold>d</bold>). The shown values (points) represent the mean sensitivity and specificity, respectively, across all classified cell types across the five evaluated datasets per iteration. Panel (<bold>c</bold>) shows the proportion of cells not present in the training data, that were correctly not-classified</p></caption><graphic xlink:href="12859_2022_4574_Fig5_HTML" id="MO5"/></fig></p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>scAnnotatR scales to large datasets</title>
      <p id="Par36">We evaluated the scalability of all applications on five large datasets (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). SCINA, scClassify, and scmap (both versions) were unable to process the largest studies. These tools convert the sparse matrix into a full expression matrix which dramatically increases memory usage. Even though our machine was equipped with 200 GB of RAM, this was not enough. SciBet and clustifyr were the fastest evaluated tools, followed by CHETAH, Garnett, scPred and scAnnotatR who processed the two largest datasets in hours. SingleR was significantly slower than the other tools and needed several days to process the three largest datasets. Among the top performing tools, scAnnotatR was the only one able to process the largest datasets in a reasonable amount of time.<fig id="Fig6"><label>Fig. 6</label><caption><p>Prediction runtime of all tools measured over five large datasets</p></caption><graphic xlink:href="12859_2022_4574_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Discussion</title>
    <p id="Par37">Automatic cell type identification in scRNA-seq datasets has become a highly active field and is an essential method to alleviate a key bottleneck in scRNA-seq data analysis. Our benchmarks showed that many of the available tools experience a tradeoff between the accuracy/sensitivity and the unknown population detection rate. In our benchmarks, scAnnotatR, scClassify, and SingleR were able to consistently achieve a high accuracy and sensitivity in both benchmarks, but only scAnnotatR was able to accurately detect unknown populations. Finally, a surprisingly large number of well performing tools were unable to process increasingly common large datasets. Overall, scAnnotatR was the only assessed tool with consistently high classification performance able to process large datasets.
</p>
    <p id="Par38">A large group of algorithms, such as MARS [<xref ref-type="bibr" rid="CR3">3</xref>] or SingleR [<xref ref-type="bibr" rid="CR5">5</xref>], rely on a single annotated reference dataset. In our experience, this approach is often limited since a single dataset may not contain all cell types of interest. When multiple datasets have to be merged, data size and computationally cost quickly increase dramatically as shown for SingleR in our benchmark. Additionally, sharing annotated reference datasets is complicated by their size. The advantage of scAnnotatR and other related tools is that the cell type’s properties are learned from a reference dataset, but the reference dataset is no longer necessary to apply the model. This makes the learned models easily transferable, shareable, and reproducible as highlighted by the models shipped as part of scAnnotatR.</p>
    <p id="Par39">scAnnotatR was developed to offer full control and detailed information related to the cell annotation. Additionally, it is among the few tools to provide a dedicated infrastructure to train new cell classifiers. It is impossible to create references that suit all experimental designs. We explicitly provide functions that greatly simplify the training and, most importantly, evaluation of new cell types. Plans are under way to support a GitHub-based central repository for cell type classifiers that also supports multiple species. This will help researchers to quickly share their own classifiers. scAnnotatR therefore is a scalable, accurate and reproducible method to automatically classify cell types in scRNA-seq datasets.
</p>
  </sec>
  <sec id="Sec10">
    <title>Conclusions</title>
    <p id="Par40">scAnnotatR is among the most accurate and scalable methods to classify cells in scRNA-seq datasets. Most importantly, it is able to correctly not-classify unknown cell types. scAnnotatR provides a complete framework to train, test, and store new classifiers and is compatible with both Seurat and Bioconductor’s SingleCellExperiment class. Thereby, it can be quickly incorporated in virtually all R-based scRNA-seq workflows.</p>
    <sec id="Sec11">
      <title>Availability and requirements</title>
      <p id="Par41">
        <list list-type="bullet">
          <list-item>
            <p id="Par42">Project name: scAnnotatR.</p>
          </list-item>
          <list-item>
            <p id="Par43">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/grisslab/scAnnotatR">https://github.com/grisslab/scAnnotatR</ext-link>.</p>
          </list-item>
          <list-item>
            <p id="Par44">Operating system(s): Platform independent.</p>
          </list-item>
          <list-item>
            <p id="Par45">Programming language: R.</p>
          </list-item>
          <list-item>
            <p id="Par46">Other requirements: R packages (dplyr, ggplot2, caret, ROCR, pROC, data.tree, methods, stats, e1071, ape, kernlab, utils, AnnotationHub).</p>
          </list-item>
          <list-item>
            <p id="Par47">License: MIT + file LICENSE.</p>
          </list-item>
          <list-item>
            <p id="Par48">Any restrictions to use by non-academics: no.</p>
          </list-item>
        </list>
      </p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec12">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2022_4574_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary methods and figures.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>scRNA-seq</term>
        <def>
          <p id="Par4">Single cell RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>WKNN</term>
        <def>
          <p id="Par5">Weighted k-nearest neighbors</p>
        </def>
      </def-item>
      <def-item>
        <term>KNN</term>
        <def>
          <p id="Par6">k-nearest neighbors</p>
        </def>
      </def-item>
      <def-item>
        <term>SCE</term>
        <def>
          <p id="Par7">SingleCellExperiment</p>
        </def>
      </def-item>
      <def-item>
        <term>NK</term>
        <def>
          <p id="Par8">Natural killers</p>
        </def>
      </def-item>
      <def-item>
        <term>DC</term>
        <def>
          <p id="Par9">Dendritic cells</p>
        </def>
      </def-item>
      <def-item>
        <term>pDC</term>
        <def>
          <p id="Par10">Plasmacytoid dendritic cells</p>
        </def>
      </def-item>
      <def-item>
        <term>DEG</term>
        <def>
          <p id="Par11">Differentially expressed genes</p>
        </def>
      </def-item>
      <def-item>
        <term>PBMC</term>
        <def>
          <p id="Par12">Peripheral blood mononuclear cell</p>
        </def>
      </def-item>
      <def-item>
        <term>HIV</term>
        <def>
          <p id="Par13">Human immunodeficiency virus</p>
        </def>
      </def-item>
      <def-item>
        <term>SVM</term>
        <def>
          <p id="Par14">Support vector machine</p>
        </def>
      </def-item>
      <def-item>
        <term>HCA</term>
        <def>
          <p id="Par15">The Human Cell Atlas</p>
        </def>
      </def-item>
      <def-item>
        <term>UMAP</term>
        <def>
          <p id="Par16">Uniform Manifold Approximation and Projection</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>VN: software development, data analysis, writing initial draft, JG: initial concept, supervision, funding. Both authors read, revised, and approved the final version of the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by FWF-Austrian Science Fund (projects P30325-B28 and P31127-B28). The funding agency did not play any role in the design of the study, collection, analysis, and interpretation of data or in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>scAnnotatR is freely available as open source software on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/grisslab/scAnnotatR">https://github.com/grisslab/scAnnotatR</ext-link> and through Bioconductor since version 3.14 at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/bioc/html/scAnnotatR.html">https://bioconductor.org/packages/release/bioc/html/scAnnotatR.html</ext-link>. The complete code to perform and analyse the benchmarks and to create all figures is available on CodeOcean at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.24433/CO.8414972.v1">https://doi.org/10.24433/CO.8414972.v1</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par49">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par50">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par51">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zanini</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Berghuis</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>di Robilant</surname>
            <given-names>BN</given-names>
          </name>
          <name>
            <surname>Nong</surname>
            <given-names>RY</given-names>
          </name>
          <name>
            <surname>Norton</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Northstar enables automatic classification of known and novel cell types from tumor samples</article-title>
        <source>Cold Spring Harbor Lab</source>
        <year>2020</year>
        <volume>10</volume>
        <fpage>820928</fpage>
        <pub-id pub-id-type="doi">10.1101/820928</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>scmap: projection of single-cell RNA-seq data across data sets</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>359</fpage>
        <lpage>362</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4644</pub-id>
        <pub-id pub-id-type="pmid">29608555</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brbić</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zitnik</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pisco</surname>
            <given-names>AO</given-names>
          </name>
          <name>
            <surname>Altman</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Darmanis</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MARS: discovering novel cell types across heterogeneous single-cell experiments</article-title>
        <source>Nat Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>1200</fpage>
        <lpage>1206</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-00979-3</pub-id>
        <pub-id pub-id-type="pmid">33077966</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Xue</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ai</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>scCATCH: automatic annotation on cell types of clusters from single-cell RNA sequencing data</article-title>
        <source>IScience</source>
        <year>2020</year>
        <volume>23</volume>
        <fpage>100882</fpage>
        <pub-id pub-id-type="doi">10.1016/j.isci.2020.100882</pub-id>
        <?supplied-pmid 32062421?>
        <pub-id pub-id-type="pmid">32062421</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aran</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Looney</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Fong</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hsu</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>
        <source>Nat Immunol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>163</fpage>
        <lpage>172</lpage>
        <pub-id pub-id-type="doi">10.1038/s41590-018-0276-y</pub-id>
        <pub-id pub-id-type="pmid">30643263</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Atakan Ekiz</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Conley</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Zac Stephens</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>O’Connell</surname>
            <given-names>RM</given-names>
          </name>
        </person-group>
        <article-title>CIPR: a web-based R/shiny app and R package to annotate cell clusters in single cell RNA sequencing experiments</article-title>
        <source>BMC Bioinform</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>191</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-020-3538-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gillen</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Sheridan</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Daya</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>clustifyr: an R package for automated single-cell RNA sequencing cluster classification</article-title>
        <source>F1000Res</source>
        <year>2020</year>
        <volume>9</volume>
        <fpage>223</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.22969.2</pub-id>
        <pub-id pub-id-type="pmid">32765839</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hou</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Denisenko</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Forrest</surname>
            <given-names>ARR</given-names>
          </name>
        </person-group>
        <article-title>scMatch: a single-cell gene expression profile annotation tool using reference datasets</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>4688</fpage>
        <lpage>4695</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz292</pub-id>
        <pub-id pub-id-type="pmid">31028376</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Domanskyi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Szedlak</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hawkins</surname>
            <given-names>NT</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Paternostro</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Piermarocchi</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Polled digital cell sorter (p-DCS): automatic identification of hematological cell types from single cell RNA-sequencing clusters</article-title>
        <source>BMC Bioinform</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-019-2951-x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>O’Flanagan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chavez</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>JLP</given-names>
          </name>
          <name>
            <surname>Ceglia</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Probabilistic cell-type assignment of single-cell RNA-seq for tumor microenvironment profiling</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>1007</fpage>
        <lpage>1015</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0529-1</pub-id>
        <pub-id pub-id-type="pmid">31501550</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SciBet as a portable and fast single cell type identifier</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>1818</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-15523-2</pub-id>
        <pub-id pub-id-type="pmid">32286268</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pliner</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Supervised classification enables rapid annotation of cell atlases</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>983</fpage>
        <lpage>986</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0535-3</pub-id>
        <pub-id pub-id-type="pmid">31501545</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Kanter</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Lijnzaad</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Candelli</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Margaritis</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Holstege</surname>
            <given-names>FCP</given-names>
          </name>
        </person-group>
        <article-title>CHETAH: a selective, hierarchical cell type identification method for single-cell RNA sequencing</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>e95</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz543</pub-id>
        <pub-id pub-id-type="pmid">31226206</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zhong</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SCINA: a semi-supervised subtyping algorithm of single cells and bulk samples</article-title>
        <source>Genes</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>531</fpage>
        <pub-id pub-id-type="doi">10.3390/genes10070531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alquicira-Hernandez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sathe</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Powell</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <article-title>scPred: accurate supervised method for cell-type classification from single-cell RNA-seq data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>264</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1862-5</pub-id>
        <pub-id pub-id-type="pmid">31829268</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boufea</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Seth</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Batada</surname>
            <given-names>NN</given-names>
          </name>
        </person-group>
        <article-title>scID uses discriminant analysis to identify transcriptionally equivalent cell types across single-cell RNA-Seq data with batch effect</article-title>
        <source>IScience.</source>
        <year>2020</year>
        <volume>23</volume>
        <fpage>100914</fpage>
        <pub-id pub-id-type="doi">10.1016/j.isci.2020.100914</pub-id>
        <?supplied-pmid 32151972?>
        <pub-id pub-id-type="pmid">32151972</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Salim</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>DM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>scClassify: sample size estimation and multiscale classification of cells using single and multiple reference</article-title>
        <source>Mol Syst Biol</source>
        <year>2020</year>
        <volume>16</volume>
        <fpage>e9389</fpage>
        <pub-id pub-id-type="doi">10.15252/msb.20199389</pub-id>
        <pub-id pub-id-type="pmid">32567229</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Pellegrini</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>ACTINN: automated identification of cell types in single cell RNA sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>36</volume>
        <fpage>533</fpage>
        <lpage>538</lpage>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuhn</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Building predictive models in R using the caret package</article-title>
        <source>J Stat Softw</source>
        <year>2008</year>
        <volume>28</volume>
        <fpage>1</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v028.i05</pub-id>
        <pub-id pub-id-type="pmid">27774042</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdelaal</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Michielsen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cats</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hoogduin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mei</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Reinders</surname>
            <given-names>MJT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>1</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1795-z</pub-id>
        <pub-id pub-id-type="pmid">30606230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hafemeister</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mauck</surname>
            <given-names>WM</given-names>
            <suffix>3rd</suffix>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive integration of single-cell data</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <fpage>1888</fpage>
        <lpage>1902.e21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amezquita</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Lun</surname>
            <given-names>ATL</given-names>
          </name>
          <name>
            <surname>Becht</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Carpp</surname>
            <given-names>LN</given-names>
          </name>
          <name>
            <surname>Geistlinger</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Orchestrating single-cell analysis with Bioconductor</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>17</volume>
        <fpage>137</fpage>
        <lpage>145</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0654-x</pub-id>
        <pub-id pub-id-type="pmid">31792435</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baron</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Veres</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wolock</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Faust</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Gaujoux</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vetere</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A Single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure</article-title>
        <source>Cell Syst</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>346</fpage>
        <lpage>360.e4</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.08.011</pub-id>
        <?supplied-pmid 27667365?>
        <pub-id pub-id-type="pmid">27667365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muraro</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Dharmadhikari</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Grün</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Groen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dielen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Jansen</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptome atlas of the human pancreas</article-title>
        <source>Cell Syst</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>385</fpage>
        <lpage>394.e3</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.09.002</pub-id>
        <?supplied-pmid 27693023?>
        <pub-id pub-id-type="pmid">27693023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segerstolpe</surname>
            <given-names>Å</given-names>
          </name>
          <name>
            <surname>Palasantza</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eliasson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>E-M</given-names>
          </name>
          <name>
            <surname>Andréasson</surname>
            <given-names>A-C</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title>
        <source>Cell Metab</source>
        <year>2016</year>
        <volume>24</volume>
        <fpage>593</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cmet.2016.08.020</pub-id>
        <pub-id pub-id-type="pmid">27667667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>YJ</given-names>
          </name>
          <name>
            <surname>Schug</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Won</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Naji</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Avrahami</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomics of the human endocrine pancreas</article-title>
        <source>Diabetes</source>
        <year>2016</year>
        <volume>65</volume>
        <fpage>3028</fpage>
        <lpage>3038</lpage>
        <pub-id pub-id-type="doi">10.2337/db16-0405</pub-id>
        <?supplied-pmid 27364731?>
        <pub-id pub-id-type="pmid">27364731</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Okamoto</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ni</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Adler</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA sequencing of single human islet cells reveals type 2 diabetes genes</article-title>
        <source>Cell Metab</source>
        <year>2016</year>
        <volume>24</volume>
        <fpage>608</fpage>
        <lpage>615</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmet.2016.08.018</pub-id>
        <?supplied-pmid 27667665?>
        <pub-id pub-id-type="pmid">27667665</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Satija Lab. [Cited 23 Nov 2020]. Available: <ext-link ext-link-type="uri" xlink:href="https://satijalab.org/seurat/v3.1/pbmc3k_tutorial.html">https://satijalab.org/seurat/v3.1/pbmc3k_tutorial.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Smolander J. ILoReg package manual. 27 Oct 2020 [cited 7 Dec 2020]. Available: <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/bioc/vignettes/ILoReg/inst/doc/ILoReg.html">https://bioconductor.org/packages/release/bioc/vignettes/ILoReg/inst/doc/ILoReg.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Adiconis</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Simmons</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Kowalczyk</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Hession</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Marjanovic</surname>
            <given-names>ND</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systematic comparative analysis of single cell RNA-sequencing methods</article-title>
        <source>Cold Spring Harbor Lab</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>632216</fpage>
        <pub-id pub-id-type="doi">10.1101/632216</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Single Cell Portal. [Cited 1 Jul 2021]. Available: <ext-link ext-link-type="uri" xlink:href="https://singlecell.broadinstitute.org/single_cell/study/SCP345/ica-blood-mononuclear-cells-2-donors-2-sites">https://singlecell.broadinstitute.org/single_cell/study/SCP345/ica-blood-mononuclear-cells-2-donors-2-sites</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
